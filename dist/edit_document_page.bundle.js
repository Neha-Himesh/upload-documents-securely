/*! For license information please see edit_document_page.bundle.js.LICENSE.txt */
(()=>{"use strict";var t={36:(t,e,n)=>{n.d(e,{Ao:()=>ui,Bx:()=>hi,Jh:()=>di,O4:()=>li,ZS:()=>mi,_L:()=>pi,fF:()=>ci,iO:()=>gi,ro:()=>fi});var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},i(t,e)};function r(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var s,o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{},a=a||{},c=o||self;function u(){}function l(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function h(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var d="closure_uid_"+(1e9*Math.random()>>>0),f=0;function p(t,e,n){return t.call.apply(t.bind,arguments)}function g(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function m(t,e,n){return(m=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?p:g).apply(null,arguments)}function y(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function v(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(t,n,i){for(var r=Array(arguments.length-2),s=2;s<arguments.length;s++)r[s-2]=arguments[s];return e.prototype[n].apply(t,r)}}function w(){this.s=this.s,this.o=this.o}var b={};w.prototype.s=!1,w.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var t=function(t){return Object.prototype.hasOwnProperty.call(t,d)&&t[d]||(t[d]=++f)}(this);delete b[t]}},w.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var _=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},I=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var i=t.length,r="string"==typeof t?t.split(""):t,s=0;s<i;s++)s in r&&e.call(n,r[s],s,t)};function T(t){return Array.prototype.concat.apply([],arguments)}function E(t){var e=t.length;if(0<e){for(var n=Array(e),i=0;i<e;i++)n[i]=t[i];return n}return[]}function S(t){return/^[\s\xa0]*$/.test(t)}var A,k=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function R(t,e){return-1!=t.indexOf(e)}function N(t,e){return t<e?-1:t>e?1:0}t:{var C=c.navigator;if(C){var O=C.userAgent;if(O){A=O;break t}}A=""}function D(t,e,n){for(var i in t)e.call(n,t[i],i,t)}function P(t){var e={};for(var n in t)e[n]=t[n];return e}var L="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function x(t,e){for(var n,i,r=1;r<arguments.length;r++){for(n in i=arguments[r])t[n]=i[n];for(var s=0;s<L.length;s++)n=L[s],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function M(t){return M[" "](t),t}M[" "]=u;var U,F,V=R(A,"Opera"),j=R(A,"Trident")||R(A,"MSIE"),B=R(A,"Edge"),H=B||j,K=R(A,"Gecko")&&!(R(A.toLowerCase(),"webkit")&&!R(A,"Edge"))&&!(R(A,"Trident")||R(A,"MSIE"))&&!R(A,"Edge"),q=R(A.toLowerCase(),"webkit")&&!R(A,"Edge");function z(){var t=c.document;return t?t.documentMode:void 0}t:{var $="",G=(F=A,K?/rv:([^\);]+)(\)|;)/.exec(F):B?/Edge\/([\d\.]+)/.exec(F):j?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(F):q?/WebKit\/(\S+)/.exec(F):V?/(?:Version)[ \/]?(\S+)/.exec(F):void 0);if(G&&($=G?G[1]:""),j){var W=z();if(null!=W&&W>parseFloat($)){U=String(W);break t}}U=$}var X,Q={};function J(){return t=Q,Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=function(){for(var t=0,e=k(String(U)).split("."),n=k("9").split("."),i=Math.max(e.length,n.length),r=0;0==t&&r<i;r++){var s=e[r]||"",o=n[r]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],0==s[0].length&&0==o[0].length)break;t=N(0==s[1].length?0:parseInt(s[1],10),0==o[1].length?0:parseInt(o[1],10))||N(0==s[2].length,0==o[2].length)||N(s[2],o[2]),s=s[3],o=o[3]}while(0==t)}return 0<=t}();var t}c.document&&j?X=z()||parseInt(U,10)||void 0:X=void 0;var Y=X,Z=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{c.addEventListener("test",u,e),c.removeEventListener("test",u,e)}catch(t){}return t}();function tt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}function et(t,e){if(tt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(K){t:{try{M(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:nt[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&et.Z.h.call(this)}}tt.prototype.h=function(){this.defaultPrevented=!0},v(et,tt);var nt={2:"touch",3:"pen",4:"mouse"};et.prototype.h=function(){et.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var it="closure_listenable_"+(1e6*Math.random()|0),rt=0;function st(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.ia=r,this.key=++rt,this.ca=this.fa=!1}function ot(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function at(t){this.src=t,this.g={},this.h=0}function ct(t,e){var n=e.type;if(n in t.g){var i,r=t.g[n],s=_(r,e);(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(ot(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function ut(t,e,n,i){for(var r=0;r<t.length;++r){var s=t[r];if(!s.ca&&s.listener==e&&s.capture==!!n&&s.ia==i)return r}return-1}at.prototype.add=function(t,e,n,i,r){var s=t.toString();(t=this.g[s])||(t=this.g[s]=[],this.h++);var o=ut(t,e,i,r);return-1<o?(e=t[o],n||(e.fa=!1)):((e=new st(e,this.src,s,!!i,r)).fa=n,t.push(e)),e};var lt="closure_lm_"+(1e6*Math.random()|0),ht={};function dt(t,e,n,i,r){if(i&&i.once)return pt(t,e,n,i,r);if(Array.isArray(e)){for(var s=0;s<e.length;s++)dt(t,e[s],n,i,r);return null}return n=_t(n),t&&t[it]?t.N(e,n,h(i)?!!i.capture:!!i,r):ft(t,e,n,!1,i,r)}function ft(t,e,n,i,r,s){if(!e)throw Error("Invalid event type");var o=h(r)?!!r.capture:!!r,a=wt(t);if(a||(t[lt]=a=new at(t)),(n=a.add(e,n,i,o,s)).proxy)return n;if(i=function(){var t=vt;return function e(n){return t.call(e.src,e.listener,n)}}(),n.proxy=i,i.src=t,i.listener=n,t.addEventListener)Z||(r=o),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(yt(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function pt(t,e,n,i,r){if(Array.isArray(e)){for(var s=0;s<e.length;s++)pt(t,e[s],n,i,r);return null}return n=_t(n),t&&t[it]?t.O(e,n,h(i)?!!i.capture:!!i,r):ft(t,e,n,!0,i,r)}function gt(t,e,n,i,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)gt(t,e[s],n,i,r);else i=h(i)?!!i.capture:!!i,n=_t(n),t&&t[it]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=ut(s=t.g[e],n,i,r))&&(ot(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete t.g[e],t.h--))):t&&(t=wt(t))&&(e=t.g[e.toString()],t=-1,e&&(t=ut(e,n,i,r)),(n=-1<t?e[t]:null)&&mt(n))}function mt(t){if("number"!=typeof t&&t&&!t.ca){var e=t.src;if(e&&e[it])ct(e.i,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(yt(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=wt(e))?(ct(n,t),0==n.h&&(n.src=null,e[lt]=null)):ot(t)}}}function yt(t){return t in ht?ht[t]:ht[t]="on"+t}function vt(t,e){if(t.ca)t=!0;else{e=new et(e,this);var n=t.listener,i=t.ia||t.src;t.fa&&mt(t),t=n.call(i,e)}return t}function wt(t){return(t=t[lt])instanceof at?t:null}var bt="__closure_events_fn_"+(1e9*Math.random()>>>0);function _t(t){return"function"==typeof t?t:(t[bt]||(t[bt]=function(e){return t.handleEvent(e)}),t[bt])}function It(){w.call(this),this.i=new at(this),this.P=this,this.I=null}function Tt(t,e){var n,i=t.I;if(i)for(n=[];i;i=i.I)n.push(i);if(t=t.P,i=e.type||e,"string"==typeof e)e=new tt(e,t);else if(e instanceof tt)e.target=e.target||t;else{var r=e;x(e=new tt(i,t),r)}if(r=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];r=Et(o,i,!0,e)&&r}if(r=Et(o=e.g=t,i,!0,e)&&r,r=Et(o,i,!1,e)&&r,n)for(s=0;s<n.length;s++)r=Et(o=e.g=n[s],i,!1,e)&&r}function Et(t,e,n,i){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var r=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.ca&&o.capture==n){var a=o.listener,c=o.ia||o.src;o.fa&&ct(t.i,o),r=!1!==a.call(c,i)&&r}}return r&&!i.defaultPrevented}v(It,w),It.prototype[it]=!0,It.prototype.removeEventListener=function(t,e,n,i){gt(this,t,e,n,i)},It.prototype.M=function(){if(It.Z.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],i=0;i<n.length;i++)ot(n[i]);delete e.g[t],e.h--}}this.I=null},It.prototype.N=function(t,e,n,i){return this.i.add(String(t),e,!1,n,i)},It.prototype.O=function(t,e,n,i){return this.i.add(String(t),e,!0,n,i)};var St=c.JSON.stringify;function At(){var t=Lt,e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var kt,Rt=function(){function t(){this.h=this.g=null}return t.prototype.add=function(t,e){var n=Nt.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n},t}(),Nt=new(function(){function t(t,e){this.i=t,this.j=e,this.h=0,this.g=null}return t.prototype.get=function(){var t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t},t}())((function(){return new Ct}),(function(t){return t.reset()})),Ct=function(){function t(){this.next=this.g=this.h=null}return t.prototype.set=function(t,e){this.h=t,this.g=e,this.next=null},t.prototype.reset=function(){this.next=this.g=this.h=null},t}();function Ot(t){c.setTimeout((function(){throw t}),0)}function Dt(t,e){kt||function(){var t=c.Promise.resolve(void 0);kt=function(){t.then(xt)}}(),Pt||(kt(),Pt=!0),Lt.add(t,e)}var Pt=!1,Lt=new Rt;function xt(){for(var t;t=At();){try{t.h.call(t.g)}catch(t){Ot(t)}var e=Nt;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Pt=!1}function Mt(t,e){It.call(this),this.h=t||1,this.g=e||c,this.j=m(this.kb,this),this.l=Date.now()}function Ut(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}function Ft(t,e,n){if("function"==typeof t)n&&(t=m(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=m(t.handleEvent,t)}return 2147483647<Number(e)?-1:c.setTimeout(t,e||0)}function Vt(t){t.g=Ft((function(){t.g=null,t.i&&(t.i=!1,Vt(t))}),t.j);var e=t.h;t.h=null,t.m.apply(null,e)}v(Mt,It),(s=Mt.prototype).da=!1,s.S=null,s.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Tt(this,"tick"),this.da&&(Ut(this),this.start()))}},s.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},s.M=function(){Mt.Z.M.call(this),Ut(this),delete this.g};var jt=function(t){function e(e,n){var i=t.call(this)||this;return i.m=e,i.j=n,i.h=null,i.i=!1,i.g=null,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.l=function(t){this.h=arguments,this.g?this.i=!0:Vt(this)},e.prototype.M=function(){t.prototype.M.call(this),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},e}(w);function Bt(t){w.call(this),this.h=t,this.g={}}v(Bt,w);var Ht=[];function Kt(t,e,n,i){Array.isArray(n)||(n&&(Ht[0]=n.toString()),n=Ht);for(var r=0;r<n.length;r++){var s=dt(e,n[r],i||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function qt(t){D(t.g,(function(t,e){this.g.hasOwnProperty(e)&&mt(t)}),t),t.g={}}function zt(){this.g=!0}function $t(t,e,n,i){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var i=n[t];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<r.length;o++)r[o]=""}}}return St(n)}catch(t){return e}}(t,n)+(i?" "+i:"")}))}Bt.prototype.M=function(){Bt.Z.M.call(this),qt(this)},Bt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},zt.prototype.Aa=function(){this.g=!1},zt.prototype.info=function(){};var Gt={},Wt=null;function Xt(){return Wt=Wt||new It}function Qt(t){tt.call(this,Gt.Ma,t)}function Jt(t){var e=Xt();Tt(e,new Qt(e,t))}function Yt(t,e){tt.call(this,Gt.STAT_EVENT,t),this.stat=e}function Zt(t){var e=Xt();Tt(e,new Yt(e,t))}function te(t,e){tt.call(this,Gt.Na,t),this.size=e}function ee(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return c.setTimeout((function(){t()}),e)}Gt.Ma="serverreachability",v(Qt,tt),Gt.STAT_EVENT="statevent",v(Yt,tt),Gt.Na="timingevent",v(te,tt);var ne={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},ie={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function re(){}function se(t){return t.h||(t.h=t.i())}function oe(){}re.prototype.h=null;var ae,ce={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function ue(){tt.call(this,"d")}function le(){tt.call(this,"c")}function he(){}function de(t,e,n,i){this.l=t,this.j=e,this.m=n,this.X=i||1,this.V=new Bt(this),this.P=pe,t=H?125:void 0,this.W=new Mt(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new fe}function fe(){this.i=null,this.g="",this.h=!1}v(ue,tt),v(le,tt),v(he,re),he.prototype.g=function(){return new XMLHttpRequest},he.prototype.i=function(){return{}},ae=new he;var pe=45e3,ge={},me={};function ye(t,e,n){t.K=1,t.v=je(Le(e)),t.s=n,t.U=!0,ve(t,null)}function ve(t,e){t.F=Date.now(),Ie(t),t.A=Le(t.v);var n=t.A,i=t.X;Array.isArray(i)||(i=[String(i)]),Ze(n.h,"t",i),t.C=0,n=t.l.H,t.h=new fe,t.g=ei(t.l,n?e:null,!t.s),0<t.O&&(t.L=new jt(m(t.Ia,t,t.g),t.O)),Kt(t.V,t.g,"readystatechange",t.gb),e=t.H?P(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),Jt(1),function(t,e,n,i,r,s){t.info((function(){if(t.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+u+"&":o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+e+"\n"+n+"\n"+o}))}(t.j,t.u,t.A,t.m,t.X,t.s)}function we(t){return!!t.g&&"GET"==t.u&&2!=t.K&&t.l.Ba}function be(t,e,n){for(var i,r=!0;!t.I&&t.C<n.length;){if((i=_e(t,n))==me){4==e&&(t.o=4,Zt(14),r=!1),$t(t.j,t.m,null,"[Incomplete Response]");break}if(i==ge){t.o=4,Zt(15),$t(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}$t(t.j,t.m,i,null),ke(t,i)}we(t)&&i!=me&&i!=ge&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,Zt(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.aa&&(t.aa=!0,(e=t.l).g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),Gn(e),e.L=!0,Zt(11))):($t(t.j,t.m,n,"[Invalid Chunked Response]"),Ae(t),Se(t))}function _e(t,e){var n=t.C,i=e.indexOf("\n",n);return-1==i?me:(n=Number(e.substring(n,i)),isNaN(n)?ge:(i+=1)+n>e.length?me:(e=e.substr(i,n),t.C=i+n,e))}function Ie(t){t.Y=Date.now()+t.P,Te(t,t.P)}function Te(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=ee(m(t.eb,t),e)}function Ee(t){t.B&&(c.clearTimeout(t.B),t.B=null)}function Se(t){0==t.l.G||t.I||Qn(t.l,t)}function Ae(t){Ee(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,Ut(t.W),qt(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function ke(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||an(n.i,t)))if(n.I=t.N,!t.J&&an(n.i,t)&&3==n.G){try{var i=n.Ca.g.parse(e)}catch(s){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;Xn(n),Fn(n)}$n(n),Zt(18)}}else n.ta=r[1],0<n.ta-n.U&&37500>r[2]&&n.N&&0==n.A&&!n.v&&(n.v=ee(m(n.ab,n),6e3));if(1>=on(n.i)&&n.ka){try{n.ka()}catch(s){}n.ka=void 0}}else Yn(n,11)}else if((t.J||n.g==t)&&Xn(n),!S(e))for(r=n.Ca.g.parse(e),e=0;e<r.length;e++){var s=r[e];if(n.U=s[0],s=s[1],2==n.G)if("c"==s[0]){n.J=s[1],n.la=s[2];var o=s[3];null!=o&&(n.ma=o,n.h.info("VER="+n.ma));var a=s[4];null!=a&&(n.za=a,n.h.info("SVER="+n.za));var c=s[5];null!=c&&"number"==typeof c&&0<c&&(i=1.5*c,n.K=i,n.h.info("backChannelRequestTimeoutMs_="+i)),i=n;var u=t.g;if(u){var l=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=i.i;!h.g&&(R(l,"spdy")||R(l,"quic")||R(l,"h2"))&&(h.j=h.l,h.g=new Set,h.h&&(cn(h,h.h),h.h=null))}if(i.D){var d=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null;d&&(i.sa=d,Ve(i.F,i.D,d))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms"));var f=t;if((i=n).oa=ti(i,i.H?i.la:null,i.W),f.J){un(i.i,f);var p=f,g=i.K;g&&p.setTimeout(g),p.B&&(Ee(p),Ie(p)),i.g=f}else zn(i);0<n.l.length&&Bn(n)}else"stop"!=s[0]&&"close"!=s[0]||Yn(n,7);else 3==n.G&&("stop"==s[0]||"close"==s[0]?"stop"==s[0]?Yn(n,7):Un(n):"noop"!=s[0]&&n.j&&n.j.wa(s),n.A=0)}Jt(4)}catch(s){}}function Re(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(l(t)||"string"==typeof t)I(t,e,void 0);else{if(t.T&&"function"==typeof t.T)var n=t.T();else if(t.R&&"function"==typeof t.R)n=void 0;else if(l(t)||"string"==typeof t){n=[];for(var i=t.length,r=0;r<i;r++)n.push(r)}else for(r in n=[],i=0,t)n[i++]=r;i=function(t){if(t.R&&"function"==typeof t.R)return t.R();if("string"==typeof t)return t.split("");if(l(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t),r=i.length;for(var s=0;s<r;s++)e.call(void 0,i[s],n&&n[s],t)}}function Ne(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof Ne)for(n=t.T(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function Ce(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var i=t.g[e];Oe(t.h,i)&&(t.g[n++]=i),e++}t.g.length=n}if(t.i!=t.g.length){var r={};for(n=e=0;e<t.g.length;)Oe(r,i=t.g[e])||(t.g[n++]=i,r[i]=1),e++;t.g.length=n}}function Oe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(s=de.prototype).setTimeout=function(t){this.P=t},s.gb=function(t){t=t.target;var e=this.L;e&&3==Dn(t)?e.l():this.Ia(t)},s.Ia=function(t){try{if(t==this.g)t:{var e=Dn(this.g),n=this.g.Da(),i=this.g.ba();if(!(3>e)&&(3!=e||H||this.g&&(this.h.h||this.g.ga()||Pn(this.g)))){this.I||4!=e||7==n||Jt(8==n||0>=i?3:2),Ee(this);var r=this.g.ba();this.N=r;e:if(we(this)){var s=Pn(this.g);t="";var o=s.length,a=4==Dn(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Ae(this),Se(this);var u="";break e}this.h.i=new c.TextDecoder}for(n=0;n<o;n++)this.h.h=!0,t+=this.h.i.decode(s[n],{stream:a&&n==o-1});s.splice(0,o),this.h.g+=t,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==r,function(t,e,n,i,r,s,o){t.info((function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+e+"\n"+n+"\n"+s+" "+o}))}(this.j,this.u,this.A,this.m,this.X,e,r),this.i){if(this.$&&!this.J){e:{if(this.g){var l,h=this.g;if((l=h.g?h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!S(l)){var d=l;break e}}d=null}if(!(r=d)){this.i=!1,this.o=3,Zt(12),Ae(this),Se(this);break t}$t(this.j,this.m,r,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,ke(this,r)}this.U?(be(this,e,u),H&&this.i&&3==e&&(Kt(this.V,this.W,"tick",this.fb),this.W.start())):($t(this.j,this.m,u,null),ke(this,u)),4==e&&Ae(this),this.i&&!this.I&&(4==e?Qn(this.l,this):(this.i=!1,Ie(this)))}else 400==r&&0<u.indexOf("Unknown SID")?(this.o=3,Zt(12)):(this.o=0,Zt(13)),Ae(this),Se(this)}}}catch(e){}},s.fb=function(){if(this.g){var t=Dn(this.g),e=this.g.ga();this.C<e.length&&(Ee(this),be(this,t,e),this.i&&4!=t&&Ie(this))}},s.cancel=function(){this.I=!0,Ae(this)},s.eb=function(){this.B=null;var t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.K&&(Jt(3),Zt(17)),Ae(this),this.o=2,Se(this)):Te(this,this.Y-t)},(s=Ne.prototype).R=function(){Ce(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t},s.T=function(){return Ce(this),this.g.concat()},s.get=function(t,e){return Oe(this.h,t)?this.h[t]:e},s.set=function(t,e){Oe(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e},s.forEach=function(t,e){for(var n=this.T(),i=0;i<n.length;i++){var r=n[i],s=this.get(r);t.call(e,s,r,this)}};var De=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Pe(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof Pe){this.g=void 0!==e?e:t.g,xe(this,t.j),this.s=t.s,Me(this,t.i),Ue(this,t.m),this.l=t.l,e=t.h;var n=new Xe;n.i=e.i,e.g&&(n.g=new Ne(e.g),n.h=e.h),Fe(this,n),this.o=t.o}else t&&(n=String(t).match(De))?(this.g=!!e,xe(this,n[1]||"",!0),this.s=Be(n[2]||""),Me(this,n[3]||"",!0),Ue(this,n[4]),this.l=Be(n[5]||"",!0),Fe(this,n[6]||"",!0),this.o=Be(n[7]||"")):(this.g=!!e,this.h=new Xe(null,this.g))}function Le(t){return new Pe(t)}function xe(t,e,n){t.j=n?Be(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Me(t,e,n){t.i=n?Be(e,!0):e}function Ue(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Fe(t,e,n){e instanceof Xe?(t.h=e,function(t,e){e&&!t.j&&(Qe(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Je(this,e),Ze(this,n,t))}),t)),t.j=e}(t.h,t.g)):(n||(e=He(e,Ge)),t.h=new Xe(e,t.g))}function Ve(t,e,n){t.h.set(e,n)}function je(t){return Ve(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Be(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function He(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Ke),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Ke(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Pe.prototype.toString=function(){var t=[],e=this.j;e&&t.push(He(e,qe,!0),":");var n=this.i;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(He(e,qe,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&t.push("/"),t.push(He(n,"/"==n.charAt(0)?$e:ze,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",He(n,We)),t.join("")};var qe=/[#\/\?@]/g,ze=/[#\?:]/g,$e=/[#\?]/g,Ge=/[#\?@]/g,We=/#/g;function Xe(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Qe(t){t.g||(t.g=new Ne,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var s=t[n].substring(0,i);r=t[n].substring(i+1)}else s=t[n];e(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Je(t,e){Qe(t),e=tn(t,e),Oe(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,Oe((t=t.g).h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&Ce(t)))}function Ye(t,e){return Qe(t),e=tn(t,e),Oe(t.g.h,e)}function Ze(t,e,n){Je(t,e),0<n.length&&(t.i=null,t.g.set(tn(t,e),E(n)),t.h+=n.length)}function tn(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(s=Xe.prototype).add=function(t,e){Qe(this),this.i=null,t=tn(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},s.forEach=function(t,e){Qe(this),this.g.forEach((function(n,i){I(n,(function(n){t.call(e,n,i,this)}),this)}),this)},s.T=function(){Qe(this);for(var t=this.g.R(),e=this.g.T(),n=[],i=0;i<e.length;i++)for(var r=t[i],s=0;s<r.length;s++)n.push(e[i]);return n},s.R=function(t){Qe(this);var e=[];if("string"==typeof t)Ye(this,t)&&(e=T(e,this.g.get(tn(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=T(e,t[n])}return e},s.set=function(t,e){return Qe(this),this.i=null,Ye(this,t=tn(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},s.get=function(t,e){return t&&0<(t=this.R(t)).length?String(t[0]):e},s.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var i=e[n],r=encodeURIComponent(String(i));i=this.R(i);for(var s=0;s<i.length;s++){var o=r;""!==i[s]&&(o+="="+encodeURIComponent(String(i[s]))),t.push(o)}}return this.i=t.join("&")};var en=function(t,e){this.h=t,this.g=e};function nn(t){this.l=t||rn,t=c.PerformanceNavigationTiming?0<(t=c.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(c.g&&c.g.Ea&&c.g.Ea()&&c.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var rn=10;function sn(t){return!!t.h||!!t.g&&t.g.size>=t.j}function on(t){return t.h?1:t.g?t.g.size:0}function an(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function cn(t,e){t.g?t.g.add(e):t.h=e}function un(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function ln(t){var e,n;if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){var i=t.i;try{for(var s=r(t.g.values()),o=s.next();!o.done;o=s.next()){var a=o.value;i=i.concat(a.D)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return i}return E(t.i)}function hn(){}function dn(){this.g=new hn}function fn(t,e,n){var i=n||"";try{Re(t,(function(t,n){var r=t;h(t)&&(r=St(t)),e.push(i+n+"="+encodeURIComponent(r))}))}catch(t){throw e.push(i+"type="+encodeURIComponent("_badmap")),t}}function pn(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(t){}}function gn(t){this.l=t.$b||null,this.j=t.ib||!1}function mn(t,e){It.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=yn,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}nn.prototype.cancel=function(){var t,e;if(this.i=ln(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){try{for(var n=r(this.g.values()),i=n.next();!i.done;i=n.next())i.value.cancel()}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.g.clear()}},hn.prototype.stringify=function(t){return c.JSON.stringify(t,void 0)},hn.prototype.parse=function(t){return c.JSON.parse(t,void 0)},v(gn,re),gn.prototype.g=function(){return new mn(this.l,this.j)},gn.prototype.i=function(t){return function(){return t}}({}),v(mn,It);var yn=0;function vn(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}function wn(t){t.readyState=4,t.l=null,t.j=null,t.A=null,bn(t)}function bn(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(s=mn.prototype).open=function(t,e){if(this.readyState!=yn)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,bn(this)},s.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||c).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},s.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,wn(this)),this.readyState=yn},s.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,bn(this)),this.g&&(this.readyState=3,bn(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==c.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;vn(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))},s.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?wn(this):bn(this),3==this.readyState&&vn(this)}},s.Ua=function(t){this.g&&(this.response=this.responseText=t,wn(this))},s.Ta=function(t){this.g&&(this.response=t,wn(this))},s.ha=function(){this.g&&wn(this)},s.setRequestHeader=function(t,e){this.v.append(t,e)},s.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";for(var t=[],e=this.h.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(mn.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var _n=c.JSON.parse;function In(t){It.call(this),this.headers=new Ne,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Tn,this.K=this.L=!1}v(In,It);var Tn="",En=/^https?$/i,Sn=["POST","PUT"];function An(t){return"content-type"==t.toLowerCase()}function kn(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Rn(t),Cn(t)}function Rn(t){t.D||(t.D=!0,Tt(t,"complete"),Tt(t,"error"))}function Nn(t){if(t.h&&void 0!==a&&(!t.C[1]||4!=Dn(t)||2!=t.ba()))if(t.v&&4==Dn(t))Ft(t.Fa,0,t);else if(Tt(t,"readystatechange"),4==Dn(t)){t.h=!1;try{var e,n=t.ba();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var i=!0;break t;default:i=!1}if(!(e=i)){var r;if(r=0===n){var s=String(t.H).match(De)[1]||null;if(!s&&c.self&&c.self.location){var o=c.self.location.protocol;s=o.substr(0,o.length-1)}r=!En.test(s?s.toLowerCase():"")}e=r}if(e)Tt(t,"complete"),Tt(t,"success");else{t.m=6;try{var u=2<Dn(t)?t.g.statusText:""}catch(t){u=""}t.j=u+" ["+t.ba()+"]",Rn(t)}}finally{Cn(t)}}}function Cn(t,e){if(t.g){On(t);var n=t.g,i=t.C[0]?u:null;t.g=null,t.C=null,e||Tt(t,"ready");try{n.onreadystatechange=i}catch(t){}}}function On(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(c.clearTimeout(t.A),t.A=null)}function Dn(t){return t.g?t.g.readyState:0}function Pn(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case Tn:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Ln(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}i||(n=function(t){var e="";return D(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Ve(t,e,n))}function xn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Mn(t){this.za=0,this.l=[],this.h=new zt,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=xn("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=xn("baseRetryDelayMs",5e3,t),this.$a=xn("retryDelaySeedMs",1e4,t),this.Ya=xn("forwardChannelMaxRetries",2,t),this.ra=xn("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new nn(t&&t.concurrentRequestLimit),this.Ca=new dn,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||!1!==t.Xb}function Un(t){if(Vn(t),3==t.G){var e=t.V++,n=Le(t.F);Ve(n,"SID",t.J),Ve(n,"RID",e),Ve(n,"TYPE","terminate"),Kn(t,n),(e=new de(t,t.h,e,void 0)).K=2,e.v=je(Le(n)),n=!1,c.navigator&&c.navigator.sendBeacon&&(n=c.navigator.sendBeacon(e.v.toString(),"")),!n&&c.Image&&((new Image).src=e.v,n=!0),n||(e.g=ei(e.l,null),e.g.ea(e.v)),e.F=Date.now(),Ie(e)}Zn(t)}function Fn(t){t.g&&(Gn(t),t.g.cancel(),t.g=null)}function Vn(t){Fn(t),t.u&&(c.clearTimeout(t.u),t.u=null),Xn(t),t.i.cancel(),t.m&&("number"==typeof t.m&&c.clearTimeout(t.m),t.m=null)}function jn(t,e){t.l.push(new en(t.Za++,e)),3==t.G&&Bn(t)}function Bn(t){sn(t.i)||t.m||(t.m=!0,Dt(t.Ha,t),t.C=0)}function Hn(t,e){var n;n=e?e.m:t.V++;var i=Le(t.F);Ve(i,"SID",t.J),Ve(i,"RID",n),Ve(i,"AID",t.U),Kn(t,i),t.o&&t.s&&Ln(i,t.o,t.s),n=new de(t,t.h,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=qn(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),cn(t.i,n),ye(n,i,e)}function Kn(t,e){t.j&&Re({},(function(t,n){Ve(e,n,t)}))}function qn(t,e,n){n=Math.min(t.l.length,n);var i=t.j?m(t.j.Oa,t.j,t):null;t:for(var r=t.l,s=-1;;){var o=["count="+n];-1==s?0<n?(s=r[0].h,o.push("ofs="+s)):s=0:o.push("ofs="+s);for(var a=!0,c=0;c<n;c++){var u=r[c].h,l=r[c].g;if(0>(u-=s))s=Math.max(0,r[c].h-100),a=!1;else try{fn(l,o,"req"+u+"_")}catch(t){i&&i(l)}}if(a){i=o.join("&");break t}}return t=t.l.splice(0,n),e.D=t,i}function zn(t){t.g||t.u||(t.Y=1,Dt(t.Ga,t),t.A=0)}function $n(t){return!(t.g||t.u||3<=t.A||(t.Y++,t.u=ee(m(t.Ga,t),Jn(t,t.A)),t.A++,0))}function Gn(t){null!=t.B&&(c.clearTimeout(t.B),t.B=null)}function Wn(t){t.g=new de(t,t.h,"rpc",t.Y),null===t.o&&(t.g.H=t.s),t.g.O=0;var e=Le(t.oa);Ve(e,"RID","rpc"),Ve(e,"SID",t.J),Ve(e,"CI",t.N?"0":"1"),Ve(e,"AID",t.U),Kn(t,e),Ve(e,"TYPE","xmlhttp"),t.o&&t.s&&Ln(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=je(Le(e)),n.s=null,n.U=!0,ve(n,t)}function Xn(t){null!=t.v&&(c.clearTimeout(t.v),t.v=null)}function Qn(t,e){var n=null;if(t.g==e){Xn(t),Gn(t),t.g=null;var i=2}else{if(!an(t.i,e))return;n=e.D,un(t.i,e),i=1}if(t.I=e.N,0!=t.G)if(e.i)if(1==i){n=e.s?e.s.length:0,e=Date.now()-e.F;var r=t.C;Tt(i=Xt(),new te(i,n,e,r)),Bn(t)}else zn(t);else if(3==(r=e.o)||0==r&&0<t.I||!(1==i&&function(t,e){return!(on(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.l=e.D.concat(t.l),0):1==t.G||2==t.G||t.C>=(t.Xa?0:t.Ya)||(t.m=ee(m(t.Ha,t,e),Jn(t,t.C)),t.C++,0)))}(t,e)||2==i&&$n(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),r){case 1:Yn(t,5);break;case 4:Yn(t,10);break;case 3:Yn(t,6);break;default:Yn(t,2)}}function Jn(t,e){var n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function Yn(t,e){if(t.h.info("Error code "+e),2==e){var n=null;t.j&&(n=null);var i=m(t.jb,t);n||(n=new Pe("//www.google.com/images/cleardot.gif"),c.location&&"http"==c.location.protocol||xe(n,"https"),je(n)),function(t,e){var n=new zt;if(c.Image){var i=new Image;i.onload=y(pn,n,i,"TestLoadImage: loaded",!0,e),i.onerror=y(pn,n,i,"TestLoadImage: error",!1,e),i.onabort=y(pn,n,i,"TestLoadImage: abort",!1,e),i.ontimeout=y(pn,n,i,"TestLoadImage: timeout",!1,e),c.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=t}else e(!1)}(n.toString(),i)}else Zt(2);t.G=0,t.j&&t.j.va(e),Zn(t),Vn(t)}function Zn(t){t.G=0,t.I=-1,t.j&&(0==ln(t.i).length&&0==t.l.length||(t.i.i.length=0,E(t.l),t.l.length=0),t.j.ua())}function ti(t,e,n){var i=function(t){return t instanceof Pe?Le(t):new Pe(t,void 0)}(n);if(""!=i.i)e&&Me(i,e+"."+i.i),Ue(i,i.m);else{var r=c.location;i=function(t,e,n,i){var r=new Pe(null,void 0);return t&&xe(r,t),e&&Me(r,e),n&&Ue(r,n),i&&(r.l=i),r}(r.protocol,e?e+"."+r.hostname:r.hostname,+r.port,n)}return t.aa&&D(t.aa,(function(t,e){Ve(i,e,t)})),e=t.D,n=t.sa,e&&n&&Ve(i,e,n),Ve(i,"VER",t.ma),Kn(t,i),i}function ei(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Ba&&!t.qa?new In(new gn({ib:!0})):new In(t.qa)).L=t.H,e}function ni(){}function ii(){if(j&&!(10<=Number(Y)))throw Error("Environmental error: no available transport.")}function ri(t,e){It.call(this),this.g=new Mn(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!S(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!S(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new ai(this)}function si(t){ue.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function oi(){le.call(this),this.status=1}function ai(t){this.g=t}(s=In.prototype).ea=function(t,e,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():ae.g(),this.C=this.u?se(this.u):se(ae),this.g.onreadystatechange=m(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(t){return void kn(this,t)}t=n||"";var r=new Ne(this.headers);i&&Re(i,(function(t,e){r.set(e,t)})),i=function(t){t:{for(var e=An,n=t.length,i="string"==typeof t?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t)){e=r;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(r.T()),n=c.FormData&&t instanceof c.FormData,!(0<=_(Sn,e))||i||n||r.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),r.forEach((function(t,e){this.g.setRequestHeader(e,t)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{On(this),0<this.B&&((this.K=function(t){return j&&J()&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=m(this.pa,this)):this.A=Ft(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){kn(this,t)}},s.pa=function(){void 0!==a&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Tt(this,"timeout"),this.abort(8))},s.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Tt(this,"complete"),Tt(this,"abort"),Cn(this))},s.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Cn(this,!0)),In.Z.M.call(this)},s.Fa=function(){this.s||(this.F||this.v||this.l?Nn(this):this.cb())},s.cb=function(){Nn(this)},s.ba=function(){try{return 2<Dn(this)?this.g.status:-1}catch(t){return-1}},s.ga=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},s.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),_n(e)}},s.Da=function(){return this.m},s.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(s=Mn.prototype).ma=8,s.G=1,s.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch(t){}},s.Ha=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;var e=new de(this,this.h,t,void 0),n=this.s;if(this.P&&(n?x(n=P(n),this.P):n=this.P),null===this.o&&(e.H=n),this.ja)t:{for(var i=0,r=0;r<this.l.length;r++){var s=this.l[r];if(void 0===(s="__data__"in s.g&&"string"==typeof(s=s.g.__data__)?s.length:void 0))break;if(4096<(i+=s)){i=r;break t}if(4096===i||r===this.l.length-1){i=r+1;break t}}i=1e3}else i=1e3;i=qn(this,e,i),Ve(r=Le(this.F),"RID",t),Ve(r,"CVER",22),this.D&&Ve(r,"X-HTTP-Session-Id",this.D),Kn(this,r),this.o&&n&&Ln(r,this.o,n),cn(this.i,e),this.Ra&&Ve(r,"TYPE","init"),this.ja?(Ve(r,"$req",i),Ve(r,"SID","null"),e.$=!0,ye(e,r,null)):ye(e,r,i),this.G=2}}else 3==this.G&&(t?Hn(this,t):0==this.l.length||sn(this.i)||Hn(this))},s.Ga=function(){if(this.u=null,Wn(this),this.$&&!(this.L||null==this.g||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=ee(m(this.bb,this),t)}},s.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,Zt(10),Fn(this),Wn(this))},s.ab=function(){null!=this.v&&(this.v=null,Fn(this),$n(this),Zt(19))},s.jb=function(t){t?(this.h.info("Successfully pinged google.com"),Zt(2)):(this.h.info("Failed to ping google.com"),Zt(1))},(s=ni.prototype).xa=function(){},s.wa=function(){},s.va=function(){},s.ua=function(){},s.Oa=function(){},ii.prototype.g=function(t,e){return new ri(t,e)},v(ri,It),ri.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),Dt(m(t.hb,t,e))),Zt(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=ti(t,null,t.W),Bn(t)},ri.prototype.close=function(){Un(this.g)},ri.prototype.u=function(t){if("string"==typeof t){var e={};e.__data__=t,jn(this.g,e)}else this.v?((e={}).__data__=St(t),jn(this.g,e)):jn(this.g,t)},ri.prototype.M=function(){this.g.j=null,delete this.j,Un(this.g),delete this.g,ri.Z.M.call(this)},v(si,ue),v(oi,le),v(ai,ni),ai.prototype.xa=function(){Tt(this.g,"a")},ai.prototype.wa=function(t){Tt(this.g,new si(t))},ai.prototype.va=function(t){Tt(this.g,new oi(t))},ai.prototype.ua=function(){Tt(this.g,"b")},ii.prototype.createWebChannel=ii.prototype.g,ri.prototype.send=ri.prototype.u,ri.prototype.open=ri.prototype.m,ri.prototype.close=ri.prototype.close,ne.NO_ERROR=0,ne.TIMEOUT=8,ne.HTTP_ERROR=6,ie.COMPLETE="complete",oe.EventType=ce,ce.OPEN="a",ce.CLOSE="b",ce.ERROR="c",ce.MESSAGE="d",It.prototype.listen=It.prototype.N,In.prototype.listenOnce=In.prototype.O,In.prototype.getLastError=In.prototype.La,In.prototype.getLastErrorCode=In.prototype.Da,In.prototype.getStatus=In.prototype.ba,In.prototype.getResponseJson=In.prototype.Qa,In.prototype.getResponseText=In.prototype.ga,In.prototype.send=In.prototype.ea;var ci=function(){return new ii},ui=function(){return Xt()},li=ne,hi=ie,di=Gt,fi={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},pi=gn,gi=oe,mi=In},106:(t,e,n)=>{function i(){const t=document.querySelectorAll(".custom-navbar .nav-link"),e=window.location.pathname.split("/").pop();t.forEach((t=>{const n=t.getAttribute("href");n===e||"#"===n&&e.includes("faq")?t.classList.add("active"):t.classList.remove("active")}))}n.d(e,{S:()=>i})},134:(t,e,n)=>{n.d(e,{h1:()=>c,uA:()=>s});var i=n(635),r=n(625),s=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},t}(),o="[DEFAULT]",a=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return t.prototype.get=function(t){var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new r.cY;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{var i=this.getOrInitializeService({instanceIdentifier:e});i&&n.resolve(i)}catch(t){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e,n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),i=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(i)return null;throw t}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:o})}catch(t){}try{for(var r=(0,i.Ju)(this.instancesDeferred.entries()),s=r.next();!s.done;s=r.next()){var a=(0,i.zs)(s.value,2),c=a[0],u=a[1],l=this.normalizeInstanceIdentifier(c);try{var h=this.getOrInitializeService({instanceIdentifier:l});u.resolve(h)}catch(t){}}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}},t.prototype.clearInstance=function(t){void 0===t&&(t=o),this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return(0,i.sH)(this,void 0,void 0,(function(){var t;return(0,i.YH)(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all((0,i.fX)((0,i.fX)([],(0,i.zs)(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))),(0,i.zs)(t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()})))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.isInitialized=function(t){return void 0===t&&(t=o),this.instances.has(t)},t.prototype.getOptions=function(t){return void 0===t&&(t=o),this.instancesOptions.get(t)||{}},t.prototype.initialize=function(t){var e,n;void 0===t&&(t={});var r=t.options,s=void 0===r?{}:r,o=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(o))throw Error(this.name+"("+o+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var a=this.getOrInitializeService({instanceIdentifier:o,options:s});try{for(var c=(0,i.Ju)(this.instancesDeferred.entries()),u=c.next();!u.done;u=c.next()){var l=(0,i.zs)(u.value,2),h=l[0],d=l[1];o===this.normalizeInstanceIdentifier(h)&&d.resolve(a)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(e)throw e.error}}return a},t.prototype.onInit=function(t,e){var n,i=this.normalizeInstanceIdentifier(e),r=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;r.add(t),this.onInitCallbacks.set(i,r);var s=this.instances.get(i);return s&&t(s,i),function(){r.delete(t)}},t.prototype.invokeOnInitCallbacks=function(t,e){var n,r,s=this.onInitCallbacks.get(e);if(s)try{for(var o=(0,i.Ju)(s),a=o.next();!a.done;a=o.next()){var c=a.value;try{c(t,e)}catch(t){}}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},t.prototype.getOrInitializeService=function(t){var e,n=t.instanceIdentifier,i=t.options,r=void 0===i?{}:i,s=this.instances.get(n);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:(e=n,e===o?void 0:e),options:r}),this.instances.set(n,s),this.instancesOptions.set(n,r),this.invokeOnInitCallbacks(s,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,s)}catch(t){}return s||null},t.prototype.normalizeInstanceIdentifier=function(t){return void 0===t&&(t=o),this.component?this.component.multipleInstances?t:o:t},t.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},t}(),c=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new a(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}()},137:(t,e,n)=>{n.d(e,{n:()=>Ae});var i=n(625),r=n(468),s=n(635),o=n(477),a=n(134);const c=new i.FA("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),u=new o.Vy("@firebase/auth");function l(t,...e){u.logLevel<=o.$b.ERROR&&u.error(`Auth (${r.MF}): ${t}`,...e)}function h(t,...e){throw f(t,...e)}function d(t,...e){return f(t,...e)}function f(t,...e){if("string"!=typeof t){const n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(n,...i)}return c.create(t,...e)}function p(t,e,...n){if(!t)throw f(e,...n)}function g(t){const e="INTERNAL ASSERTION FAILED: "+t;throw l(e),new Error(e)}function m(t,e){t||g(e)}const y=new Map;function v(t){m(t instanceof Function,"Expected a class definition");let e=y.get(t);return e?(m(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,y.set(t,e),e)}function w(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.href)||""}function b(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.protocol)||null}class _{constructor(t,e){this.shortDelay=t,this.longDelay=e,m(e>t,"Short delay should be less than long delay!"),this.isMobile=(0,i.jZ)()||(0,i.lV)()}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===b()||"https:"===b()||(0,i.sr)()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function I(t,e){m(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class T{static initialize(t,e,n){this.fetchImpl=t,e&&(this.headersImpl=e),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void g("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void g("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void g("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const E={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded"},S=new _(3e4,6e4);function A(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function k(t,e,n,r,s={}){return R(t,s,(()=>{let s={},o={};r&&("GET"===e?o=r:s={body:JSON.stringify(r)});const a=(0,i.Am)(Object.assign({key:t.config.apiKey},o)).slice(1),c=new(T.headers());return c.set("Content-Type","application/json"),c.set("X-Client-Version",t._getSdkClientVersion()),t.languageCode&&c.set("X-Firebase-Locale",t.languageCode),T.fetch()(C(t,t.config.apiHost,n,a),Object.assign({method:e,headers:c,referrerPolicy:"no-referrer"},s))}))}async function R(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},E),e);try{const e=new O(t),i=await Promise.race([n(),e.promise]);e.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw D(t,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const e=(i.ok?s.errorMessage:s.error.message).split(" : ")[0];if("FEDERATED_USER_ID_ALREADY_LINKED"===e)throw D(t,"credential-already-in-use",s);if("EMAIL_EXISTS"===e)throw D(t,"email-already-in-use",s);h(t,r[e]||e.toLowerCase().replace(/[_\s]+/g,"-"))}}catch(e){if(e instanceof i.g)throw e;h(t,"network-request-failed")}}async function N(t,e,n,i,r={}){const s=await k(t,e,n,i,r);return"mfaPendingCredential"in s&&h(t,"multi-factor-auth-required",{serverResponse:s}),s}function C(t,e,n,i){const r=`${e}${n}?${i}`;return t.config.emulator?I(t.config,r):`${t.config.apiScheme}://${r}`}class O{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise(((t,e)=>{this.timer=setTimeout((()=>e(d(this.auth,"timeout"))),S.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function D(t,e,n){const i={appName:t.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=d(t,e,i);return r.customData._tokenResponse=n,r}function P(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch(t){}}function L(t){return 1e3*Number(t)}function x(t){const[e,n,r]=t.split(".");if(void 0===e||void 0===n||void 0===r)return l("JWT malformed, contained fewer than 3 sections"),null;try{const t=(0,i.u)(n);return t?JSON.parse(t):(l("Failed to decode base64 JWT payload"),null)}catch(t){return l("Caught error parsing JWT payload as JSON",t),null}}async function M(t,e,n=!1){if(n)return e;try{return await e}catch(e){throw e instanceof i.g&&function({code:t}){return"auth/user-disabled"===t||"auth/user-token-expired"===t}(e)&&t.auth.currentUser===t&&await t.auth.signOut(),e}}class U{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(t){var e;if(t){const t=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),t}{this.errorBackoff=3e4;const t=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,t)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout((async()=>{await this.iteration()}),e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){return void("auth/network-request-failed"===t.code&&this.schedule(!0))}this.schedule()}}class F{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=P(this.lastLoginAt),this.creationTime=P(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function V(t){var e;const n=t.auth,i=await t.getIdToken(),r=await M(t,async function(t,e){return k(t,"POST","/v1/accounts:lookup",e)}(n,{idToken:i}));p(null==r?void 0:r.users.length,n,"internal-error");const o=r.users[0];t._notifyReloadListener(o);const a=(null===(e=o.providerUserInfo)||void 0===e?void 0:e.length)?o.providerUserInfo.map((t=>{var{providerId:e}=t,n=(0,s.Tt)(t,["providerId"]);return{providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[],c=(u=t.providerData,l=a,[...u.filter((t=>!l.some((e=>e.providerId===t.providerId)))),...l]);var u,l;const h=t.isAnonymous,d=!(t.email&&o.passwordHash||(null==c?void 0:c.length)),f=!!h&&d,g={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:c,metadata:new F(o.createdAt,o.lastLoginAt),isAnonymous:f};Object.assign(t,g)}class j{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){p(t.idToken,"internal-error"),p(void 0!==t.idToken,"internal-error"),p(void 0!==t.refreshToken,"internal-error");const e="expiresIn"in t&&void 0!==t.expiresIn?Number(t.expiresIn):function(t){const e=x(t);return p(e,"internal-error"),p(void 0!==e.exp,"internal-error"),p(void 0!==e.iat,"internal-error"),Number(e.exp)-Number(e.iat)}(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}async getToken(t,e=!1){return p(!this.accessToken||this.refreshToken,t,"user-token-expired"),e||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:n,refreshToken:r,expiresIn:s}=await async function(t,e){const n=await R(t,{},(()=>{const n=(0,i.Am)({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=t.config,o=C(t,r,"/v1/token",`key=${s}`);return T.fetch()(o,{method:"POST",headers:{"X-Client-Version":t._getSdkClientVersion(),"Content-Type":"application/x-www-form-urlencoded"},body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(t,e);this.updateTokensAndExpiration(n,r,Number(s))}updateTokensAndExpiration(t,e,n){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(t,e){const{refreshToken:n,accessToken:i,expirationTime:r}=e,s=new j;return n&&(p("string"==typeof n,"internal-error",{appName:t}),s.refreshToken=n),i&&(p("string"==typeof i,"internal-error",{appName:t}),s.accessToken=i),r&&(p("number"==typeof r,"internal-error",{appName:t}),s.expirationTime=r),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new j,this.toJSON())}_performRefresh(){return g("not implemented")}}function B(t,e){p("string"==typeof t||void 0===t,"internal-error",{appName:e})}class H{constructor(t){var{uid:e,auth:n,stsTokenManager:i}=t,r=(0,s.Tt)(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.emailVerified=!1,this.isAnonymous=!1,this.tenantId=null,this.providerData=[],this.proactiveRefresh=new U(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.metadata=new F(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(t){const e=await M(this,this.stsTokenManager.getToken(this.auth,t));return p(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return async function(t,e=!1){const n=(0,i.Ku)(t),r=await n.getIdToken(e),s=x(r);p(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const o="object"==typeof s.firebase?s.firebase:void 0,a=null==o?void 0:o.sign_in_provider;return{claims:s,token:r,authTime:P(L(s.auth_time)),issuedAtTime:P(L(s.iat)),expirationTime:P(L(s.exp)),signInProvider:a||null,signInSecondFactor:(null==o?void 0:o.sign_in_second_factor)||null}}(this,t)}reload(){return async function(t){const e=(0,i.Ku)(t);await V(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}(this)}_assign(t){this!==t&&(p(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map((t=>Object.assign({},t))),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){return new H(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(t){p(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),e&&await V(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const t=await this.getIdToken();return await M(this,async function(t,e){return k(t,"POST","/v1/accounts:delete",e)}(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((t=>Object.assign({},t))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var n,i,r,s,o,a,c,u;const l=null!==(n=e.displayName)&&void 0!==n?n:void 0,h=null!==(i=e.email)&&void 0!==i?i:void 0,d=null!==(r=e.phoneNumber)&&void 0!==r?r:void 0,f=null!==(s=e.photoURL)&&void 0!==s?s:void 0,g=null!==(o=e.tenantId)&&void 0!==o?o:void 0,m=null!==(a=e._redirectEventId)&&void 0!==a?a:void 0,y=null!==(c=e.createdAt)&&void 0!==c?c:void 0,v=null!==(u=e.lastLoginAt)&&void 0!==u?u:void 0,{uid:w,emailVerified:b,isAnonymous:_,providerData:I,stsTokenManager:T}=e;p(w&&T,t,"internal-error");const E=j.fromJSON(this.name,T);p("string"==typeof w,t,"internal-error"),B(l,t.name),B(h,t.name),p("boolean"==typeof b,t,"internal-error"),p("boolean"==typeof _,t,"internal-error"),B(d,t.name),B(f,t.name),B(g,t.name),B(m,t.name),B(y,t.name),B(v,t.name);const S=new H({uid:w,auth:t,email:h,emailVerified:b,displayName:l,isAnonymous:_,photoURL:f,phoneNumber:d,tenantId:g,stsTokenManager:E,createdAt:y,lastLoginAt:v});return I&&Array.isArray(I)&&(S.providerData=I.map((t=>Object.assign({},t)))),m&&(S._redirectEventId=m),S}static async _fromIdTokenResponse(t,e,n=!1){const i=new j;i.updateFromServerResponse(e);const r=new H({uid:e.localId,auth:t,stsTokenManager:i,isAnonymous:n});return await V(r),r}}class K{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return void 0===e?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}K.type="NONE";const q=K;function z(t,e,n){return`firebase:${t}:${e}:${n}`}class ${constructor(t,e,n){this.persistence=t,this.auth=e,this.userKey=n;const{config:i,name:r}=this.auth;this.fullUserKey=z(this.userKey,i.apiKey,r),this.fullPersistenceKey=z("persistence",i.apiKey,r),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);return t?H._fromJSON(this.auth,t):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=t,e?this.setCurrentUser(e):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,n="authUser"){if(!e.length)return new $(v(q),t,n);const i=(await Promise.all(e.map((async t=>{if(await t._isAvailable())return t})))).filter((t=>t));let r=i[0]||v(q);const s=z(n,t.config.apiKey,t.name);let o=null;for(const n of e)try{const e=await n._get(s);if(e){const i=H._fromJSON(t,e);n!==r&&(o=i),r=n;break}}catch(t){}const a=i.filter((t=>t._shouldAllowMigration));return r._shouldAllowMigration&&a.length?(r=a[0],o&&await r._set(s,o.toJSON()),await Promise.all(e.map((async t=>{if(t!==r)try{await t._remove(s)}catch(t){}}))),new $(r,t,n)):new $(r,t,n)}}function G(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(J(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(W(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Z(e))return"Blackberry";if(tt(e))return"Webos";if(X(e))return"Safari";if((e.includes("chrome/")||Q(e))&&!e.includes("edge/"))return"Chrome";if(Y(e))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(e);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function W(t=(0,i.ZQ)()){return/firefox\//i.test(t)}function X(t=(0,i.ZQ)()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Q(t=(0,i.ZQ)()){return/crios\//i.test(t)}function J(t=(0,i.ZQ)()){return/iemobile/i.test(t)}function Y(t=(0,i.ZQ)()){return/android/i.test(t)}function Z(t=(0,i.ZQ)()){return/blackberry/i.test(t)}function tt(t=(0,i.ZQ)()){return/webos/i.test(t)}function et(t=(0,i.ZQ)()){return/iphone|ipad|ipod/i.test(t)}function nt(t=(0,i.ZQ)()){return et(t)||Y(t)||tt(t)||Z(t)||/windows phone/i.test(t)||J(t)}function it(t,e=[]){let n;switch(t){case"Browser":n=G((0,i.ZQ)());break;case"Worker":n=`${G((0,i.ZQ)())}-${t}`;break;default:n=t}const s=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${r.MF}/${s}`}class rt{constructor(t,e){this.app=t,this.config=e,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ot(this),this.idTokenSubscription=new ot(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=c,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=e.sdkClientVersion}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=v(e)),this._initializationPromise=this.queue((async()=>{var n;this._deleted||(this.persistenceManager=await $.create(this,t),this._deleted||((null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)&&await this._popupRedirectResolver._initialize(this),await this.initializeCurrentUser(e),this._deleted||(this._isInitialized=!0)))})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();return this.currentUser||t?this.currentUser&&t&&this.currentUser.uid===t.uid?(this._currentUser._assign(t),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(t):void 0}async initializeCurrentUser(t){var e;let n=await this.assertedPersistence.getCurrentUser();if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=null===(e=this.redirectUser)||void 0===e?void 0:e._redirectEventId,r=null==n?void 0:n._redirectEventId,s=await this.tryRedirectSignIn(t);i&&i!==r||!(null==s?void 0:s.user)||(n=s.user)}return n?n._redirectEventId?(p(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)):this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch(t){await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await V(t)}catch(t){if("auth/network-request-failed"!==t.code)return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(t){const e=t?(0,i.Ku)(t):null;return e&&p(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t){if(!this._deleted)return t&&p(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),this.queue((async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()}))}async signOut(){return(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null)}setPersistence(t){return this.queue((async()=>{await this.assertedPersistence.setPersistence(v(t))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new i.FA("auth","Firebase",t())}onAuthStateChanged(t,e,n){return this.registerStateListener(this.authStateSubscription,t,e,n)}onIdTokenChanged(t,e,n){return this.registerStateListener(this.idTokenSubscription,t,e,n)}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}}async _setRedirectUser(t,e){const n=await this.getOrInitRedirectPersistenceManager(e);return null===t?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&v(t)||this._popupRedirectResolver;p(e,this,"argument-error"),this.redirectPersistenceManager=await $.create(this,[v(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var e,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(e=this._currentUser)||void 0===e?void 0:e._redirectEventId)===t?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(t)))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,n,i){if(this._deleted)return()=>{};const r="function"==typeof e?e:e.next.bind(e),s=this._isInitialized?Promise.resolve():this._initializationPromise;return p(s,this,"internal-error"),s.then((()=>r(this.currentUser))),"function"==typeof e?t.addObserver(e,n,i):t.addObserver(e)}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&(this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh()),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return p(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){t&&!this.frameworks.includes(t)&&(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=it(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getSdkClientVersion(){return this.clientVersion}}function st(t){return(0,i.Ku)(t)}class ot{constructor(t){this.auth=t,this.observer=null,this.addObserver=(0,i.tD)((t=>this.observer=t))}get next(){return p(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}class at{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return g("not implemented")}_getIdTokenResponse(t){return g("not implemented")}_linkToIdToken(t,e){return g("not implemented")}_getReauthenticationResolver(t){return g("not implemented")}}class ct extends at{constructor(t,e,n,i=null){super("password",n),this._email=t,this._password=e,this._tenantId=i}static _fromEmailAndPassword(t,e){return new ct(t,e,"password")}static _fromEmailAndCode(t,e,n=null){return new ct(t,e,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t;if((null==e?void 0:e.email)&&(null==e?void 0:e.password)){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":return async function(t,e){return N(t,"POST","/v1/accounts:signInWithPassword",A(t,e))}(t,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(t,e){return N(t,"POST","/v1/accounts:signInWithEmailLink",A(t,e))}(t,{email:this._email,oobCode:this._password});default:h(t,"internal-error")}}async _linkToIdToken(t,e){switch(this.signInMethod){case"password":return async function(t,e){return k(t,"POST","/v1/accounts:update",e)}(t,{idToken:e,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(t,e){return N(t,"POST","/v1/accounts:signInWithEmailLink",A(t,e))}(t,{idToken:e,email:this._email,oobCode:this._password});default:h(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}async function ut(t,e){return N(t,"POST","/v1/accounts:signInWithIdp",A(t,e))}class lt extends at{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new lt(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):h("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t,{providerId:n,signInMethod:i}=e,r=(0,s.Tt)(e,["providerId","signInMethod"]);if(!n||!i)return null;const o=new lt(n,i);return Object.assign(o,r),o}_getIdTokenResponse(t){return ut(t,this.buildRequest())}_linkToIdToken(t,e){const n=this.buildRequest();return n.idToken=e,ut(t,n)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,ut(t,e)}buildRequest(){const t={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=(0,i.Am)(e)}return t}}const ht={USER_NOT_FOUND:"user-not-found"};class dt extends at{constructor(t){super("phone","phone"),this.params=t}static _fromVerification(t,e){return new dt({verificationId:t,verificationCode:e})}static _fromTokenResponse(t,e){return new dt({phoneNumber:t,temporaryProof:e})}_getIdTokenResponse(t){return async function(t,e){return N(t,"POST","/v1/accounts:signInWithPhoneNumber",A(t,e))}(t,this._makeVerificationRequest())}_linkToIdToken(t,e){return async function(t,e){const n=await N(t,"POST","/v1/accounts:signInWithPhoneNumber",A(t,e));if(n.temporaryProof)throw D(t,"account-exists-with-different-credential",n);return n}(t,Object.assign({idToken:e},this._makeVerificationRequest()))}_getReauthenticationResolver(t){return async function(t,e){return N(t,"POST","/v1/accounts:signInWithPhoneNumber",A(t,Object.assign(Object.assign({},e),{operation:"REAUTH"})),ht)}(t,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:t,phoneNumber:e,verificationId:n,verificationCode:i}=this.params;return t&&e?{temporaryProof:t,phoneNumber:e}:{sessionInfo:n,code:i}}toJSON(){const t={providerId:this.providerId};return this.params.phoneNumber&&(t.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(t.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(t.verificationCode=this.params.verificationCode),this.params.verificationId&&(t.verificationId=this.params.verificationId),t}static fromJSON(t){"string"==typeof t&&(t=JSON.parse(t));const{verificationId:e,verificationCode:n,phoneNumber:i,temporaryProof:r}=t;return n||e||i||r?new dt({verificationId:e,verificationCode:n,phoneNumber:i,temporaryProof:r}):null}}class ft{constructor(t){var e,n,r,s,o,a;const c=(0,i.I9)((0,i.hp)(t)),u=null!==(e=c.apiKey)&&void 0!==e?e:null,l=null!==(n=c.oobCode)&&void 0!==n?n:null,h=function(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=c.mode)&&void 0!==r?r:null);p(u&&l&&h,"argument-error"),this.apiKey=u,this.operation=h,this.code=l,this.continueUrl=null!==(s=c.continueUrl)&&void 0!==s?s:null,this.languageCode=null!==(o=c.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(a=c.tenantId)&&void 0!==a?a:null}static parseLink(t){const e=function(t){const e=(0,i.I9)((0,i.hp)(t)).link,n=e?(0,i.I9)((0,i.hp)(e)).deep_link_id:null,r=(0,i.I9)((0,i.hp)(t)).deep_link_id;return(r?(0,i.I9)((0,i.hp)(r)).link:null)||r||n||e||t}(t);try{return new ft(e)}catch(t){return null}}}class pt{constructor(){this.providerId=pt.PROVIDER_ID}static credential(t,e){return ct._fromEmailAndPassword(t,e)}static credentialWithLink(t,e){const n=ft.parseLink(e);return p(n,"argument-error"),ct._fromEmailAndCode(t,n.code,n.tenantId)}}pt.PROVIDER_ID="password",pt.EMAIL_PASSWORD_SIGN_IN_METHOD="password",pt.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class gt{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class mt extends gt{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class yt extends mt{constructor(){super("facebook.com")}static credential(t){return lt._fromParams({providerId:yt.PROVIDER_ID,signInMethod:yt.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return yt.credentialFromTaggedObject(t)}static credentialFromError(t){return yt.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return yt.credential(t.oauthAccessToken)}catch(t){return null}}}yt.FACEBOOK_SIGN_IN_METHOD="facebook.com",yt.PROVIDER_ID="facebook.com";class vt extends mt{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return lt._fromParams({providerId:vt.PROVIDER_ID,signInMethod:vt.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return vt.credentialFromTaggedObject(t)}static credentialFromError(t){return vt.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:n}=t;if(!e&&!n)return null;try{return vt.credential(e,n)}catch(t){return null}}}vt.GOOGLE_SIGN_IN_METHOD="google.com",vt.PROVIDER_ID="google.com";class wt extends mt{constructor(){super("github.com")}static credential(t){return lt._fromParams({providerId:wt.PROVIDER_ID,signInMethod:wt.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return wt.credentialFromTaggedObject(t)}static credentialFromError(t){return wt.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return wt.credential(t.oauthAccessToken)}catch(t){return null}}}wt.GITHUB_SIGN_IN_METHOD="github.com",wt.PROVIDER_ID="github.com";class bt extends mt{constructor(){super("twitter.com")}static credential(t,e){return lt._fromParams({providerId:bt.PROVIDER_ID,signInMethod:bt.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return bt.credentialFromTaggedObject(t)}static credentialFromError(t){return bt.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:n}=t;if(!e||!n)return null;try{return bt.credential(e,n)}catch(t){return null}}}bt.TWITTER_SIGN_IN_METHOD="twitter.com",bt.PROVIDER_ID="twitter.com";class _t{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,n,i=!1){const r=await H._fromIdTokenResponse(t,n,i),s=It(n);return new _t({user:r,providerId:s,_tokenResponse:n,operationType:e})}static async _forOperation(t,e,n){await t._updateTokensIfNecessary(n,!0);const i=It(n);return new _t({user:t,providerId:i,_tokenResponse:n,operationType:e})}}function It(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class Tt extends i.g{constructor(t,e,n,i){var r;super(e.code,e.message),this.operationType=n,this.user=i,this.name="FirebaseError",Object.setPrototypeOf(this,Tt.prototype),this.appName=t.name,this.code=e.code,this.tenantId=null!==(r=t.tenantId)&&void 0!==r?r:void 0,this.serverResponse=e.customData.serverResponse}static _fromErrorAndOperation(t,e,n,i){return new Tt(t,e,n,i)}}function Et(t,e,n,i){return("reauthenticate"===e?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw Tt._fromErrorAndOperation(t,n,e,i);throw n}))}new WeakMap;const St="__sak";class At{constructor(t,e){this.storage=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(St,"1"),this.storage.removeItem(St),Promise.resolve(!0)):Promise.resolve(!1)}catch(t){return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}}class kt extends At{constructor(){super(window.localStorage,"LOCAL"),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const t=(0,i.ZQ)();return X(t)||et(t)}()&&function(){try{return!(!window||window===window.top)}catch(t){return!1}}(),this.fallbackToPolling=nt(),this._shouldAllowMigration=!0,this.boundEventHandler=this.onStorageEvent.bind(this)}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const n=this.storage.getItem(e),i=this.localCache[e];n!==i&&t(e,i,n)}}onStorageEvent(t,e=!1){if(!t.key)return void this.forAllChangedKeys(((t,e,n)=>{this.notifyListeners(t,n)}));const n=t.key;if(e?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(n);if(t.newValue!==i)null!==t.newValue?this.storage.setItem(n,t.newValue):this.storage.removeItem(n);else if(this.localCache[n]===t.newValue&&!e)return}const r=()=>{const t=this.storage.getItem(n);(e||this.localCache[n]!==t)&&this.notifyListeners(n,t)},s=this.storage.getItem(n);(0,i.lT)()&&10===document.documentMode&&s!==t.newValue&&t.newValue!==t.oldValue?setTimeout(r,10):r()}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e?JSON.parse(e):e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((t,e,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}kt.type="LOCAL";const Rt=kt;class Nt extends At{constructor(){super(window.sessionStorage,"SESSION")}_addListener(t,e){}_removeListener(t,e){}}Nt.type="SESSION";const Ct=Nt;class Ot{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find((e=>e.isListeningto(t)));if(e)return e;const n=new Ot(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:n,eventType:i,data:r}=e.data,s=this.handlersMap[i];if(!(null==s?void 0:s.size))return;e.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(s).map((async t=>t(e.origin,r))),a=await function(t){return Promise.all(t.map((async t=>{try{return{fulfilled:!0,value:await t}}catch(t){return{fulfilled:!1,reason:t}}})))}(o);e.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:a})}_subscribe(t,e){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),e&&0!==this.handlersMap[t].size||delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Dt(t="",e=10){let n="";for(let t=0;t<e;t++)n+=Math.floor(10*Math.random());return t+n}Ot.receivers=[];class Pt{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,n=50){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,s;return new Promise(((o,a)=>{const c=Dt("",20);i.port1.start();const u=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:i,onMessage(t){const e=t;if(e.data.eventId===c)switch(e.data.status){case"ack":clearTimeout(u),r=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(r),o(e.data.response);break;default:clearTimeout(u),clearTimeout(r),a(new Error("invalid_response"))}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:t,eventId:c,data:e},[i.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function Lt(){return window}function xt(){return void 0!==Lt().WorkerGlobalScope&&"function"==typeof Lt().importScripts}const Mt="firebaseLocalStorageDb",Ut="firebaseLocalStorage",Ft="fbase_key";class Vt{constructor(t){this.request=t}toPromise(){return new Promise(((t,e)=>{this.request.addEventListener("success",(()=>{t(this.request.result)})),this.request.addEventListener("error",(()=>{e(this.request.error)}))}))}}function jt(t,e){return t.transaction([Ut],e?"readwrite":"readonly").objectStore(Ut)}function Bt(){const t=indexedDB.open(Mt,1);return new Promise(((e,n)=>{t.addEventListener("error",(()=>{n(t.error)})),t.addEventListener("upgradeneeded",(()=>{const e=t.result;try{e.createObjectStore(Ut,{keyPath:Ft})}catch(t){n(t)}})),t.addEventListener("success",(async()=>{const n=t.result;n.objectStoreNames.contains(Ut)?e(n):(n.close(),await function(){const t=indexedDB.deleteDatabase(Mt);return new Vt(t).toPromise()}(),e(await Bt()))}))}))}async function Ht(t,e,n){const i=jt(t,!0).put({[Ft]:e,value:n});return new Vt(i).toPromise()}function Kt(t,e){const n=jt(t,!0).delete(e);return new Vt(n).toPromise()}class qt{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await Bt()),this.db}async _withRetries(t){let e=0;for(;;)try{const e=await this._openDb();return await t(e)}catch(t){if(e++>3)throw t;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return xt()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ot._getInstance(xt()?self:null),this.receiver._subscribe("keyChanged",(async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)}))),this.receiver._subscribe("ping",(async(t,e)=>["keyChanged"]))}async initializeSender(){var t,e;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(t){return null}}(),!this.activeServiceWorker)return;this.sender=new Pt(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(t=n[0])||void 0===t?void 0:t.fulfilled)&&(null===(e=n[0])||void 0===e?void 0:e.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){var e;if(this.sender&&this.activeServiceWorker&&((null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch(e){}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await Bt();return await Ht(t,St,"1"),await Kt(t,St),!0}catch(t){}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite((async()=>(await this._withRetries((n=>Ht(n,t,e))),this.localCache[t]=e,this.notifyServiceWorker(t))))}async _get(t){const e=await this._withRetries((e=>async function(t,e){const n=jt(t,!1).get(e),i=await new Vt(n).toPromise();return void 0===i?null:i.value}(e,t)));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite((async()=>(await this._withRetries((e=>Kt(e,t))),delete this.localCache[t],this.notifyServiceWorker(t))))}async _poll(){const t=await this._withRetries((t=>{const e=jt(t,!1).getAll();return new Vt(e).toPromise()}));if(!t)return[];if(0!==this.pendingWrites)return[];const e=[],n=new Set;for(const{fbase_key:i,value:r}of t)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),e.push(i));for(const t of Object.keys(this.localCache))this.localCache[t]&&!n.has(t)&&(this.notifyListeners(t,null),e.push(t));return e}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&this.stopPolling()}}qt.type="LOCAL";const zt=qt;function $t(t){return`__${t}${Math.floor(1e6*Math.random())}`}$t("rcb"),new _(3e4,6e4);class Gt{constructor(t){this.providerId=Gt.PROVIDER_ID,this.auth=st(t)}verifyPhoneNumber(t,e){return async function(t,e,n){var i;const r=await n.verify();try{let s;if(p("string"==typeof r,t,"argument-error"),p("recaptcha"===n.type,t,"argument-error"),s="string"==typeof e?{phoneNumber:e}:e,"session"in s){const e=s.session;if("phoneNumber"in s){p("enroll"===e.type,t,"internal-error");const n=await function(t,e){return k(t,"POST","/v2/accounts/mfaEnrollment:start",Object.assign({tenantId:t.tenantId},e))}(t,{idToken:e.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:r}});return n.phoneSessionInfo.sessionInfo}{p("signin"===e.type,t,"internal-error");const n=(null===(i=s.multiFactorHint)||void 0===i?void 0:i.uid)||s.multiFactorUid;p(n,t,"missing-multi-factor-info");const o=await function(t,e){return k(t,"POST","/v2/accounts/mfaSignIn:start",Object.assign({tenantId:t.tenantId},e))}(t,{mfaPendingCredential:e.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:r}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:e}=await async function(t,e){return k(t,"POST","/v1/accounts:sendVerificationCode",A(t,e))}(t,{phoneNumber:s.phoneNumber,recaptchaToken:r});return e}}finally{n._reset()}}(this.auth,t,(0,i.Ku)(e))}static credential(t,e){return dt._fromVerification(t,e)}static credentialFromResult(t){const e=t;return Gt.credentialFromTaggedObject(e)}static credentialFromError(t){return Gt.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{phoneNumber:e,temporaryProof:n}=t;return e&&n?dt._fromTokenResponse(e,n):null}}Gt.PROVIDER_ID="phone",Gt.PHONE_SIGN_IN_METHOD="phone";class Wt extends at{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return ut(t,this._buildIdpRequest())}_linkToIdToken(t,e){return ut(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return ut(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function Xt(t){return async function(t,e,n=!1){const i="signIn",r=await Et(t,i,e),s=await _t._fromIdTokenResponse(t,i,r);return n||await t._updateCurrentUser(s.user),s}(t.auth,new Wt(t),t.bypassAuthState)}function Qt(t){const{auth:e,user:n}=t;return p(n,e,"internal-error"),async function(t,e,n=!1){const{auth:i}=t,r="reauthenticate";try{const s=await M(t,Et(i,r,e,t),n);p(s.idToken,i,"internal-error");const o=x(s.idToken);p(o,i,"internal-error");const{sub:a}=o;return p(t.uid===a,i,"user-mismatch"),_t._forOperation(t,r,s)}catch(t){throw"auth/user-not-found"===(null==t?void 0:t.code)&&h(i,"user-mismatch"),t}}(n,new Wt(t),t.bypassAuthState)}async function Jt(t){const{auth:e,user:n}=t;return p(n,e,"internal-error"),async function(t,e,n=!1){const i=await M(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return _t._forOperation(t,"link",i)}(n,new Wt(t),t.bypassAuthState)}class Yt{constructor(t,e,n,i,r=!1){this.auth=t,this.resolver=n,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise((async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(t){this.reject(t)}}))}async onAuthEvent(t){const{urlResponse:e,sessionId:n,postBody:i,tenantId:r,error:s,type:o}=t;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:e,sessionId:n,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(t){this.reject(t)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return Xt;case"linkViaPopup":case"linkViaRedirect":return Jt;case"reauthViaPopup":case"reauthViaRedirect":return Qt;default:h(this.auth,"internal-error")}}resolve(t){m(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){m(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Zt=new _(2e3,1e4);class te extends Yt{constructor(t,e,n,i,r){super(t,e,i,r),this.provider=n,this.authWindow=null,this.pollId=null,te.currentPopupAction&&te.currentPopupAction.cancel(),te.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return p(t,this.auth,"internal-error"),t}async onExecution(){m(1===this.filter.length,"Popup operations only handle one event");const t=Dt();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch((t=>{this.reject(t)})),this.resolver._isIframeWebStorageSupported(this.auth,(t=>{t||this.reject(d(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null}cancel(){this.reject(d(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,te.currentPopupAction=null}pollUserCancellation(){const t=()=>{var e,n;(null===(n=null===(e=this.authWindow)||void 0===e?void 0:e.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(d(this.auth,"popup-closed-by-user"))}),2e3):this.pollId=window.setTimeout(t,Zt.get())};t()}}te.currentPopupAction=null;const ee=new Map;class ne extends Yt{constructor(t,e,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,n),this.eventId=null}async execute(){let t=ee.get(this.auth._key());if(!t){try{const e=await async function(t,e){const n=function(t){return z("pendingRedirect",t.config.apiKey,t.name)}(e),i="true"===await ie(t)._get(n);return await ie(t)._remove(n),i}(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(e)}catch(e){t=()=>Promise.reject(e)}ee.set(this.auth._key(),t)}return t()}async onAuthEvent(t){if("signInViaRedirect"===t.type)return super.onAuthEvent(t);if("unknown"!==t.type){if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function ie(t){return v(t._redirectPersistence)}async function re(t,e,n=!1){const i=st(t),r=function(t,e){return e?v(e):(p(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}(i,e),s=new ne(i,r,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}class se{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(t,n)&&(e=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))})),this.hasHandledPotentialRedirect||!function(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ae(t);default:return!1}}(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){var n;if(t.error&&!ae(t)){const i=(null===(n=t.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";e.onError(d(this.auth,i))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const n=null===e.eventId||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(oe(t))}saveEventToCache(t){this.cachedEventUids.add(oe(t)),this.lastProcessedEventTime=Date.now()}}function oe(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter((t=>t)).join("-")}function ae({type:t,error:e}){return"unknown"===t&&"auth/no-auth-event"===(null==e?void 0:e.code)}const ce=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ue=/^https?/;function le(t){const e=w(),{protocol:n,hostname:i}=new URL(e);if(t.startsWith("chrome-extension://")){const r=new URL(t);return""===r.hostname&&""===i?"chrome-extension:"===n&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===n&&r.hostname===i}if(!ue.test(n))return!1;if(ce.test(t))return i===t;const r=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const he=new _(3e4,6e4);function de(){const t=Lt().___jsl;if(null==t?void 0:t.H)for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let e=0;e<t.CP.length;e++)t.CP[e]=null}let fe=null;function pe(t){return fe=fe||function(t){return new Promise(((e,n)=>{var i,r,s,o;function a(){de(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{de(),n(d(t,"network-request-failed"))},timeout:he.get()})}if(null===(r=null===(i=Lt().gapi)||void 0===i?void 0:i.iframes)||void 0===r?void 0:r.Iframe)e(gapi.iframes.getContext());else{if(!(null===(s=Lt().gapi)||void 0===s?void 0:s.load)){const e=$t("iframefcb");return Lt()[e]=()=>{gapi.load?a():n(d(t,"network-request-failed"))},o=`https://apis.google.com/js/api.js?onload=${e}`,new Promise(((t,e)=>{const n=document.createElement("script");var i,r;n.setAttribute("src",o),n.onload=t,n.onerror=t=>{const n=d("internal-error");n.customData=t,e(n)},n.type="text/javascript",n.charset="UTF-8",(null!==(r=null===(i=document.getElementsByTagName("head"))||void 0===i?void 0:i[0])&&void 0!==r?r:document).appendChild(n)}))}a()}})).catch((t=>{throw fe=null,t}))}(t),fe}const ge=new _(5e3,15e3),me={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},ye=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function ve(t){const e=t.config;p(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?I(e,"emulator/auth/iframe"):`https://${t.config.authDomain}/__/auth/iframe`,s={apiKey:e.apiKey,appName:t.name,v:r.MF},o=ye.get(t.config.apiHost);o&&(s.eid=o);const a=t._getFrameworks();return a.length&&(s.fw=a.join(",")),`${n}?${(0,i.Am)(s).slice(1)}`}const we={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class be{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(t){}}}function _e(t,e,n,s,o,a){p(t.config.authDomain,t,"auth-domain-config-required"),p(t.config.apiKey,t,"invalid-api-key");const c={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:s,v:r.MF,eventId:o};if(e instanceof gt){e.setDefaultLanguage(t.languageCode),c.providerId=e.providerId||"",(0,i.Im)(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[t,e]of Object.entries(a||{}))c[t]=e}if(e instanceof mt){const t=e.getScopes().filter((t=>""!==t));t.length>0&&(c.scopes=t.join(","))}t.tenantId&&(c.tid=t.tenantId);const u=c;for(const t of Object.keys(u))void 0===u[t]&&delete u[t];return`${function({config:t}){return t.emulator?I(t,"emulator/auth/handler"):`https://${t.authDomain}/__/auth/handler`}(t)}?${(0,i.Am)(u).slice(1)}`}const Ie="webStorageSupport",Te=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ct,this._completeRedirectFn=re}async _openPopup(t,e,n,r){var s;return m(null===(s=this.eventManagers[t._key()])||void 0===s?void 0:s.manager,"_initialize() not called before _openPopup()"),function(t,e,n,r=500,s=600){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u=Object.assign(Object.assign({},we),{width:r.toString(),height:s.toString(),top:o,left:a}),l=(0,i.ZQ)().toLowerCase();n&&(c=Q(l)?"_blank":n),W(l)&&(e=e||"http://localhost",u.scrollbars="yes");const h=Object.entries(u).reduce(((t,[e,n])=>`${t}${e}=${n},`),"");if(function(t=(0,i.ZQ)()){var e;return et(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(l)&&"_self"!==c)return function(t,e){const n=document.createElement("a");n.href=t,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}(e||"",c),new be(null);const d=window.open(e||"",c,h);p(d,t,"popup-blocked");try{d.focus()}catch(t){}return new be(d)}(t,_e(t,e,n,w(),r),Dt())}async _openRedirect(t,e,n,i){var r;return await this._originValidation(t),r=_e(t,e,n,w(),i),Lt().location.href=r,new Promise((()=>{}))}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:t,promise:n}=this.eventManagers[e];return t?Promise.resolve(t):(m(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(t);return this.eventManagers[e]={promise:n},n}async initAndGetManager(t){const e=await async function(t){const e=await pe(t),n=Lt().gapi;return p(n,t,"internal-error"),e.open({where:document.body,url:ve(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:me,dontclear:!0},(e=>new Promise((async(n,i)=>{await e.restyle({setHideOnLeave:!1});const r=d(t,"network-request-failed"),s=Lt().setTimeout((()=>{i(r)}),ge.get());function o(){Lt().clearTimeout(s),n(e)}e.ping(o).then(o,(()=>{i(r)}))}))))}(t),n=new se(t);return e.register("authEvent",(e=>(p(null==e?void 0:e.authEvent,t,"invalid-auth-event"),{status:n.onEvent(e.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=e,n}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(Ie,{type:Ie},(n=>{var i;const r=null===(i=null==n?void 0:n[0])||void 0===i?void 0:i[Ie];void 0!==r&&e(!!r),h(t,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=async function(t){if(t.config.emulator)return;const{authorizedDomains:e}=await async function(t,e={}){return k(t,"GET","/v1/projects",e)}(t);for(const t of e)try{if(le(t))return}catch(t){}h(t,"unauthorized-domain")}(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return nt()||X()||et()}};var Ee;class Se{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged((e=>{var n;t((null===(n=e)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)}));this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){p(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Ae(t=(0,r.Sx)()){const e=(0,r.j6)(t,"auth");return e.isInitialized()?e.getImmediate():function(t,e){const n=(0,r.j6)(t,"auth");if(n.isInitialized()){const t=n.getImmediate(),r=n.getOptions();if((0,i.bD)(r,null!=e?e:{}))return t;h(t,"already-initialized")}return n.initialize({options:e})}(t,{popupRedirectResolver:Te,persistence:[zt,Rt,Ct]})}Ee="Browser",(0,r.om)(new a.uA("auth",((t,{options:e})=>{const n=t.getProvider("app").getImmediate(),{apiKey:i,authDomain:r}=n.options;return(t=>{p(i&&!i.includes(":"),"invalid-api-key",{appName:t.name}),p(!(null==r?void 0:r.includes(":")),"argument-error",{appName:t.name});const n={apiKey:i,authDomain:r,clientPlatform:Ee,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:it(Ee)},s=new rt(t,n);return function(t,e){const n=(null==e?void 0:e.persistence)||[],i=(Array.isArray(n)?n:[n]).map(v);(null==e?void 0:e.errorMap)&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,null==e?void 0:e.popupRedirectResolver)}(s,e),s})(n)}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((t,e,n)=>{t.getProvider("auth-internal").initialize()}))),(0,r.om)(new a.uA("auth-internal",(t=>{return e=st(t.getProvider("auth").getImmediate()),new Se(e);var e}),"PRIVATE").setInstantiationMode("EXPLICIT")),(0,r.KO)("@firebase/auth","0.17.1",function(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(Ee))},226:(t,e,n)=>{n.d(e,{D:()=>i.D,KR:()=>i.KR,c7:()=>i.c7,qk:()=>i.qk});var i=n(334)},237:(t,e,n)=>{n.d(e,{xI:()=>i.xI});var i=n(440)},334:(t,e,n)=>{n.d(e,{D:()=>et,KR:()=>it,c7:()=>rt,qk:()=>nt});var i,r=n(468),s=n(625),o=n(134);!function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"}(i||(i={}));const a="firebasestorage.googleapis.com",c="storageBucket";class u extends s.g{constructor(t,e){super(l(t),`Firebase Storage: ${e} (${l(t)})`),this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,u.prototype)}_codeEquals(t){return l(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}}function l(t){return"storage/"+t}function h(){return new u("unknown","An unknown error occurred, please check the error payload for server response.")}function d(t){return new u("invalid-argument",t)}function f(){return new u("app-deleted","The Firebase app was deleted.")}function p(t,e){return new u("invalid-format","String does not match format '"+t+"': "+e)}function g(t){throw new u("internal-error","Internal error: "+t)}class m{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=i.NO_ERROR,this.sendPromise_=new Promise((t=>{this.xhr_.addEventListener("abort",(()=>{this.errorCode_=i.ABORT,t()})),this.xhr_.addEventListener("error",(()=>{this.errorCode_=i.NETWORK_ERROR,t()})),this.xhr_.addEventListener("load",(()=>{t()}))}))}send(t,e,n,i){if(this.sent_)throw g("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(e,t,!0),void 0!==i)for(const t in i)i.hasOwnProperty(t)&&this.xhr_.setRequestHeader(t,i[t].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw g("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw g("cannot .getStatus() before sending");try{return this.xhr_.status}catch(t){return-1}}getResponseText(){if(!this.sent_)throw g("cannot .getResponseText() before sending");return this.xhr_.responseText}abort(){this.xhr_.abort()}getResponseHeader(t){return this.xhr_.getResponseHeader(t)}addUploadProgressListener(t){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",t)}removeUploadProgressListener(t){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",t)}}class y{createConnection(){return new m}}class v{constructor(t,e){this.bucket=t,this.path_=e}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,e){let n;try{n=v.makeFromUrl(t,e)}catch(e){return new v(t,"")}if(""===n.path)return n;throw new u("invalid-default-bucket","Invalid default bucket '"+t+"'.")}static makeFromUrl(t,e){let n=null;const i="([A-Za-z0-9.\\-_]+)",r=new RegExp("^gs://"+i+"(/(.*))?$","i");function s(t){t.path_=decodeURIComponent(t.path)}const o=e.replace(/[.]/g,"\\."),c=[{regex:r,indices:{bucket:1,path:3},postModify:function(t){"/"===t.path.charAt(t.path.length-1)&&(t.path_=t.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${o}/v[A-Za-z0-9_]+/b/${i}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:s},{regex:new RegExp(`^https?://${e===a?"(?:storage.googleapis.com|storage.cloud.google.com)":e}/${i}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:s}];for(let e=0;e<c.length;e++){const i=c[e],r=i.regex.exec(t);if(r){const t=r[i.indices.bucket];let e=r[i.indices.path];e||(e=""),n=new v(t,e),i.postModify(n);break}}if(null==n)throw function(t){return new u("invalid-url","Invalid URL '"+t+"'.")}(t);return n}}class w{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}function b(t){return"string"==typeof t||t instanceof String}function _(t){return I()&&t instanceof Blob}function I(){return"undefined"!=typeof Blob}function T(t,e,n,i){if(i<e)throw d(`Invalid value for '${t}'. Expected ${e} or greater.`);if(i>n)throw d(`Invalid value for '${t}'. Expected ${n} or less.`)}function E(t,e){const n=e.match(/^(\w+):\/\/.+/);let i=e;return null==(null==n?void 0:n[1])&&(i=`https://${e}`),`${i}/v0${t}`}function S(t){const e=encodeURIComponent;let n="?";for(const i in t)t.hasOwnProperty(i)&&(n=n+(e(i)+"=")+e(t[i])+"&");return n=n.slice(0,-1),n}class A{constructor(t,e,n,i,r,s,o,a,c,u,l){this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=t,this.method_=e,this.headers_=n,this.body_=i,this.successCodes_=r.slice(),this.additionalRetryCodes_=s.slice(),this.callback_=o,this.errorCallback_=a,this.progressCallback_=u,this.timeout_=c,this.pool_=l,this.promise_=new Promise(((t,e)=>{this.resolve_=t,this.reject_=e,this.start_()}))}start_(){const t=this;function e(e,n){const i=t.resolve_,r=t.reject_,s=n.connection;if(n.wasSuccessCode)try{const e=t.callback_(s,s.getResponseText());void 0===e?i():i(e)}catch(t){r(t)}else if(null!==s){const e=h();e.serverResponse=s.getResponseText(),t.errorCallback_?r(t.errorCallback_(s,e)):r(e)}else n.canceled?r(t.appDelete_?f():new u("canceled","User canceled the upload/download.")):r(new u("retry-limit-exceeded","Max retry time for operation exceeded, please try again."))}this.canceled_?e(0,new k(!1,null,!0)):this.backoffId_=function(e,n,r){let s=1,o=null,a=!1,c=0;function u(){return 2===c}let l=!1;function h(...t){l||(l=!0,n.apply(null,t))}function d(e){o=setTimeout((()=>{o=null,function(e,n){if(n)return void e(!1,new k(!1,null,!0));const r=t.pool_.createConnection();function s(e){const n=e.loaded,i=e.lengthComputable?e.total:-1;null!==t.progressCallback_&&t.progressCallback_(n,i)}t.pendingConnection_=r,null!==t.progressCallback_&&r.addUploadProgressListener(s),r.send(t.url_,t.method_,t.body_,t.headers_).then((()=>{null!==t.progressCallback_&&r.removeUploadProgressListener(s),t.pendingConnection_=null;const n=r.getErrorCode()===i.NO_ERROR,o=r.getStatus();if(!n||t.isRetryStatusCode_(o)){const t=r.getErrorCode()===i.ABORT;return void e(!1,new k(!1,null,t))}const a=-1!==t.successCodes_.indexOf(o);e(!0,new k(a,r))}))}(f,u())}),e)}function f(t,...e){if(l)return;if(t)return void h.call(null,t,...e);if(u()||a)return void h.call(null,t,...e);let n;s<64&&(s*=2),1===c?(c=2,n=0):n=1e3*(s+Math.random()),d(n)}let p=!1;function g(t){p||(p=!0,l||(null!==o?(t||(c=2),clearTimeout(o),d(0)):t||(c=1)))}return d(0),setTimeout((()=>{a=!0,g(!0)}),r),g}(0,e,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()}isRetryStatusCode_(t){const e=t>=500&&t<600,n=-1!==[408,429].indexOf(t),i=-1!==this.additionalRetryCodes_.indexOf(t);return e||n||i}}class k{constructor(t,e,n){this.wasSuccessCode=t,this.connection=e,this.canceled=!!n}}function R(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function N(...t){const e=R();if(void 0!==e){const n=new e;for(let e=0;e<t.length;e++)n.append(t[e]);return n.getBlob()}if(I())return new Blob(t);throw new u("unsupported-environment","This browser doesn't seem to support creating Blobs")}const C="base64",O="base64url",D="data_url";class P{constructor(t,e){this.data=t,this.contentType=e||null}}function L(t){const e=[];for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<=127?e.push(i):i<=2047?e.push(192|i>>6,128|63&i):55296==(64512&i)?n<t.length-1&&56320==(64512&t.charCodeAt(n+1))?(i=65536|(1023&i)<<10|1023&t.charCodeAt(++n),e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i)):e.push(239,191,189):56320==(64512&i)?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|63&i)}return new Uint8Array(e)}function x(t,e){switch(t){case C:{const n=-1!==e.indexOf("-"),i=-1!==e.indexOf("_");if(n||i)throw p(t,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break}case O:{const n=-1!==e.indexOf("+"),i=-1!==e.indexOf("/");if(n||i)throw p(t,"Invalid character '"+(n?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=atob(e)}catch(e){throw p(t,"Invalid character found")}const i=new Uint8Array(n.length);for(let t=0;t<n.length;t++)i[t]=n.charCodeAt(t);return i}class M{constructor(t){this.base64=!1,this.contentType=null;const e=t.match(/^data:([^,]+)?,/);if(null===e)throw p(D,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=e[1]||null;var i,r;null!=n&&(this.base64=(r=";base64",(i=n).length>=7&&i.substring(i.length-7)===r),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=t.substring(t.indexOf(",")+1)}}class U{constructor(t,e){let n=0,i="";_(t)?(this.data_=t,n=t.size,i=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=i}size(){return this.size_}type(){return this.type_}slice(t,e){if(_(this.data_)){const s=(n=this.data_,i=t,r=e,n.webkitSlice?n.webkitSlice(i,r):n.mozSlice?n.mozSlice(i,r):n.slice?n.slice(i,r):null);return null===s?null:new U(s)}var n,i,r;{const n=new Uint8Array(this.data_.buffer,t,e-t);return new U(n,!0)}}static getBlob(...t){if(I()){const e=t.map((t=>t instanceof U?t.data_:t));return new U(N.apply(null,e))}{const e=t.map((t=>b(t)?function(t,e){switch(t){case"raw":return new P(L(e));case C:case O:return new P(x(t,e));case D:return new P(function(t){const e=new M(t);return e.base64?x(C,e.rest):function(t){let e;try{e=decodeURIComponent(t)}catch(t){throw p(D,"Malformed data URL.")}return L(e)}(e.rest)}(e),new M(e).contentType)}throw h()}("raw",t).data:t.data_));let n=0;e.forEach((t=>{n+=t.byteLength}));const i=new Uint8Array(n);let r=0;return e.forEach((t=>{for(let e=0;e<t.length;e++)i[r++]=t[e]})),new U(i,!0)}}uploadData(){return this.data_}}function F(t){let e;try{e=JSON.parse(t)}catch(t){return null}return"object"!=typeof(n=e)||Array.isArray(n)?null:e;var n}function V(t){const e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}function j(t,e){return e}class B{constructor(t,e,n,i){this.server=t,this.local=e||t,this.writable=!!n,this.xform=i||j}}let H=null;function K(){if(H)return H;const t=[];t.push(new B("bucket")),t.push(new B("generation")),t.push(new B("metageneration")),t.push(new B("name","fullPath",!0));const e=new B("name");e.xform=function(t,e){return function(t){return!b(t)||t.length<2?t:V(t)}(e)},t.push(e);const n=new B("size");return n.xform=function(t,e){return void 0!==e?Number(e):e},t.push(n),t.push(new B("timeCreated")),t.push(new B("updated")),t.push(new B("md5Hash",null,!0)),t.push(new B("cacheControl",null,!0)),t.push(new B("contentDisposition",null,!0)),t.push(new B("contentEncoding",null,!0)),t.push(new B("contentLanguage",null,!0)),t.push(new B("contentType",null,!0)),t.push(new B("metadata","customMetadata",!0)),H=t,H}function q(t,e,n){const i=F(e);return null===i?null:function(t,e,n){const i={type:"file"},r=n.length;for(let t=0;t<r;t++){const r=n[t];i[r.local]=r.xform(i,e[r.server])}return function(t,e){Object.defineProperty(t,"ref",{get:function(){const n=t.bucket,i=t.fullPath,r=new v(n,i);return e._makeStorageReference(r)}})}(i,t),i}(t,i,n)}class z{constructor(t,e,n,i){this.url=t,this.method=e,this.handler=n,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function $(t){if(!t)throw h()}function G(t){return function(e,n){let i;var r,s;return 401===e.getStatus()?i=e.getResponseText().includes("Firebase App Check token is invalid")?new u("unauthorized-app","This app does not have permission to access Firebase Storage on this project."):new u("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again."):402===e.getStatus()?(s=t.bucket,i=new u("quota-exceeded","Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===e.getStatus()?(r=t.path,i=new u("unauthorized","User does not have permission to access '"+r+"'.")):i=n,i.serverResponse=n.serverResponse,i}}function W(t,e,n,i,r){const s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"},a=function(){let t="";for(let e=0;e<2;e++)t+=Math.random().toString().slice(2);return t}();o["Content-Type"]="multipart/related; boundary="+a;const c=function(t,e,n){const i=Object.assign({},n);return i.fullPath=t.path,i.size=e.size(),i.contentType||(i.contentType=function(t,e){return e&&e.type()||"application/octet-stream"}(0,e)),i}(e,i,r),l="--"+a+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+function(t,e){const n={},i=e.length;for(let r=0;r<i;r++){const i=e[r];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}(c,n)+"\r\n--"+a+"\r\nContent-Type: "+c.contentType+"\r\n\r\n",h="\r\n--"+a+"--",d=U.getBlob(l,i,h);if(null===d)throw new u("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.");const f={name:c.fullPath},p=E(s,t.host),g=t.maxUploadRetryTime,m=new z(p,"POST",function(t,e){return function(n,i){const r=q(t,i,e);return $(null!==r),r}}(t,n),g);return m.urlParams=f,m.headers=o,m.body=d.uploadData(),m.errorHandler=G(e),m}class X{constructor(t,e){this._service=t,this._location=e instanceof v?e:v.makeFromUrl(e,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,e){return new X(t,e)}get root(){const t=new v(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return V(this._location.path)}get storage(){return this._service}get parent(){const t=function(t){if(0===t.length)return null;const e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}(this._location.path);if(null===t)return null;const e=new v(this._location.bucket,t);return new X(this._service,e)}_throwIfRoot(t){if(""===this._location.path)throw function(t){return new u("invalid-root-operation","The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(t)}}async function Q(t){t._throwIfRoot("getDownloadURL");const e=function(t,e,n){const i=E(e.fullServerUrl(),t.host),r=t.maxOperationRetryTime,s=new z(i,"GET",function(t,e){return function(n,i){const r=q(t,i,e);return $(null!==r),function(t,e,n){const i=F(e);if(null===i)return null;if(!b(i.downloadTokens))return null;const r=i.downloadTokens;if(0===r.length)return null;const s=encodeURIComponent;return r.split(",").map((e=>{const i=t.bucket,r=t.fullPath;return E("/b/"+s(i)+"/o/"+s(r),n)+S({alt:"media",token:e})}))[0]}(r,i,t.host)}}(t,n),r);return s.errorHandler=function(t){const e=G(t);return function(n,i){let r=e(n,i);var s;return 404===n.getStatus()&&(s=t.path,r=new u("object-not-found","Object '"+s+"' does not exist.")),r.serverResponse=i.serverResponse,r}}(e),s}(t.storage,t._location,K());return(await t.storage.makeRequestWithTokens(e)).getPromise().then((t=>{if(null===t)throw new u("no-download-url","The given file does not have any download URLs.");return t}))}function J(t,e){if(t instanceof Z){const n=t;if(null==n._bucket)throw new u("no-default-bucket","No default bucket found. Did you set the '"+c+"' property when initializing the app?");const i=new X(n,n._bucket);return null!=e?J(i,e):i}return void 0!==e?function(t,e){const n=function(t,e){const n=e.split("/").filter((t=>t.length>0)).join("/");return 0===t.length?n:t+"/"+n}(t._location.path,e),i=new v(t._location.bucket,n);return new X(t.storage,i)}(t,e):t}function Y(t,e){const n=null==e?void 0:e[c];return null==n?null:v.makeFromBucketSpec(n,t)}class Z{constructor(t,e,n,i,r,s){this.app=t,this._authProvider=e,this._appCheckProvider=n,this._pool=i,this._url=r,this._firebaseVersion=s,this._bucket=null,this._host=a,this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=r?v.makeFromBucketSpec(r,this._host):Y(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,null!=this._url?this._bucket=v.makeFromBucketSpec(this._url,t):this._bucket=Y(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){T("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){T("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const e=await t.getToken();if(null!==e)return e.accessToken}return null}async _getAppCheckToken(){const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach((t=>t.cancel())),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new X(this,t)}_makeRequest(t,e,n){if(this._deleted)return new w(f());{const i=function(t,e,n,i,r,s){const o=S(t.urlParams),a=t.url+o,c=Object.assign({},t.headers);return function(t,e){e&&(t["X-Firebase-GMPID"]=e)}(c,e),function(t,e){null!==e&&e.length>0&&(t.Authorization="Firebase "+e)}(c,n),function(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(null!=e?e:"AppManager")}(c,s),function(t,e){null!==e&&(t["X-Firebase-AppCheck"]=e)}(c,i),new A(a,t.method,c,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,r)}(t,this._appId,e,n,this._pool,this._firebaseVersion);return this._requests.add(i),i.getPromise().then((()=>this._requests.delete(i)),(()=>this._requests.delete(i))),i}}async makeRequestWithTokens(t){const[e,n]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,e,n)}}const tt="storage";function et(t,e,n){return function(t,e,n){t._throwIfRoot("uploadBytes");const i=W(t.storage,t._location,K(),new U(e,!0),n);return t.storage.makeRequestWithTokens(i).then((t=>t.getPromise())).then((e=>({metadata:e,ref:t})))}(t=(0,s.Ku)(t),e,n)}function nt(t){return Q(t=(0,s.Ku)(t))}function it(t,e){return function(t,e){if(e&&/^[A-Za-z]+:\/\//.test(e)){if(t instanceof Z)return new X(t,e);throw d("To use ref(service, url), the first argument must be a Storage instance.")}return J(t,e)}(t=(0,s.Ku)(t),e)}function rt(t=(0,r.Sx)(),e){return t=(0,s.Ku)(t),(0,r.j6)(t,tt).getImmediate({identifier:e})}(0,r.om)(new o.uA(tt,(function(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new Z(n,i,s,new y,e,r.MF)}),"PUBLIC").setMultipleInstances(!0)),(0,r.KO)("@firebase/storage","0.8.1")},440:(t,e,n)=>{n.d(e,{xI:()=>i.n});var i=n(137);n(625),n(468),n(477),n(134)},468:(t,e,n)=>{n.d(e,{KO:()=>z,MF:()=>H,Sx:()=>q,Wp:()=>K,j6:()=>V,om:()=>F});var i=n(134),r=n(477),s=n(625);class o{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const a="@firebase/app",c=new r.Vy("@firebase/app"),u="@firebase/app-compat",l="@firebase/analytics-compat",h="@firebase/analytics",d="@firebase/app-check-compat",f="@firebase/app-check",p="@firebase/auth",g="@firebase/auth-compat",m="@firebase/database",y="@firebase/database-compat",v="@firebase/functions",w="@firebase/functions-compat",b="@firebase/installations",_="@firebase/installations-compat",I="@firebase/messaging",T="@firebase/messaging-compat",E="@firebase/performance",S="@firebase/performance-compat",A="@firebase/remote-config",k="@firebase/remote-config-compat",R="@firebase/storage",N="@firebase/storage-compat",C="@firebase/firestore",O="@firebase/firestore-compat",D="firebase",P="[DEFAULT]",L={[a]:"fire-core",[u]:"fire-core-compat",[h]:"fire-analytics",[l]:"fire-analytics-compat",[f]:"fire-app-check",[d]:"fire-app-check-compat",[p]:"fire-auth",[g]:"fire-auth-compat",[m]:"fire-rtdb",[y]:"fire-rtdb-compat",[v]:"fire-fn",[w]:"fire-fn-compat",[b]:"fire-iid",[_]:"fire-iid-compat",[I]:"fire-fcm",[T]:"fire-fcm-compat",[E]:"fire-perf",[S]:"fire-perf-compat",[A]:"fire-rc",[k]:"fire-rc-compat",[R]:"fire-gcs",[N]:"fire-gcs-compat",[C]:"fire-fst",[O]:"fire-fst-compat","fire-js":"fire-js",[D]:"fire-js-all"},x=new Map,M=new Map;function U(t,e){try{t.container.addComponent(e)}catch(n){c.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function F(t){const e=t.name;if(M.has(e))return c.debug(`There were multiple attempts to register component ${e}.`),!1;M.set(e,t);for(const e of x.values())U(e,t);return!0}function V(t,e){return t.container.getProvider(e)}const j=new s.FA("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function."});class B{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new i.uA("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw j.create("app-deleted",{appName:this._name})}}const H="9.0.0";function K(t,e={}){"object"!=typeof e&&(e={name:e});const n=Object.assign({name:P,automaticDataCollectionEnabled:!1},e),r=n.name;if("string"!=typeof r||!r)throw j.create("bad-app-name",{appName:String(r)});const o=x.get(r);if(o){if((0,s.bD)(t,o.options)&&(0,s.bD)(n,o.config))return o;throw j.create("duplicate-app",{appName:r})}const a=new i.h1(r);for(const t of M.values())a.addComponent(t);const c=new B(t,n,a);return x.set(r,c),c}function q(t=P){const e=x.get(t);if(!e)throw j.create("no-app",{appName:t});return e}function z(t,e,n){var r;let s=null!==(r=L[t])&&void 0!==r?r:t;n&&(s+=`-${n}`);const o=s.match(/\s|\//),a=e.match(/\s|\//);if(o||a){const t=[`Unable to register library "${s}" with version "${e}":`];return o&&t.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&a&&t.push("and"),a&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void c.warn(t.join(" "))}F(new i.uA(`${s}-version`,(()=>({library:s,version:e})),"VERSION"))}F(new i.uA("platform-logger",(t=>new o(t)),"PRIVATE")),z(a,"0.7.0",undefined),z("fire-js","")},477:(t,e,n)=>{function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,r++)i[r]=s[o];return i}var r;n.d(e,{$b:()=>s,Vy:()=>h});var s,o=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(s||(s={}));var a={debug:s.DEBUG,verbose:s.VERBOSE,info:s.INFO,warn:s.WARN,error:s.ERROR,silent:s.SILENT},c=s.INFO,u=((r={})[s.DEBUG]="log",r[s.VERBOSE]="log",r[s.INFO]="info",r[s.WARN]="warn",r[s.ERROR]="error",r),l=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var s=(new Date).toISOString(),o=u[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,i(["["+s+"]  "+t.name+":"],n))}},h=function(){function t(t){this.name=t,this._logLevel=c,this._logHandler=l,this._userLogHandler=null,o.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in s))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?a[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,i([this,s.DEBUG],t)),this._logHandler.apply(this,i([this,s.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,i([this,s.VERBOSE],t)),this._logHandler.apply(this,i([this,s.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,i([this,s.INFO],t)),this._logHandler.apply(this,i([this,s.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,i([this,s.WARN],t)),this._logHandler.apply(this,i([this,s.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,i([this,s.ERROR],t)),this._logHandler.apply(this,i([this,s.ERROR],t))},t}()},625:(t,e,n)=>{n.d(e,{Am:()=>_,FA:()=>m,I9:()=>I,Im:()=>v,Ku:()=>k,ZQ:()=>a,b8:()=>h,bD:()=>w,cY:()=>o,g:()=>g,hp:()=>T,jZ:()=>c,lT:()=>d,lV:()=>l,n4:()=>f,nr:()=>p,sr:()=>u,tD:()=>E,u:()=>s});var i=n(635),r={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[],r=0;r<t.length;r+=3){var s=t[r],o=r+1<t.length,a=o?t[r+1]:0,c=r+2<t.length,u=c?t[r+2]:0,l=s>>2,h=(3&s)<<4|a>>4,d=(15&a)<<2|u>>6,f=63&u;c||(f=64,o||(d=64)),i.push(n[l],n[h],n[d],n[f])}return i.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(function(t){for(var e=[],n=0,i=0;i<t.length;i++){var r=t.charCodeAt(i);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=63&r|128):55296==(64512&r)&&i+1<t.length&&56320==(64512&t.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&t.charCodeAt(++i)),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=63&r|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=63&r|128)}return e}(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,i=0;n<t.length;){var r=t[n++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){var s=t[n++];e[i++]=String.fromCharCode((31&r)<<6|63&s)}else if(r>239&&r<365){var o=((7&r)<<18|(63&(s=t[n++]))<<12|(63&(a=t[n++]))<<6|63&t[n++])-65536;e[i++]=String.fromCharCode(55296+(o>>10)),e[i++]=String.fromCharCode(56320+(1023&o))}else{s=t[n++];var a=t[n++];e[i++]=String.fromCharCode((15&r)<<12|(63&s)<<6|63&a)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[],r=0;r<t.length;){var s=n[t.charAt(r++)],o=r<t.length?n[t.charAt(r)]:0,a=++r<t.length?n[t.charAt(r)]:64,c=++r<t.length?n[t.charAt(r)]:64;if(++r,null==s||null==o||null==a||null==c)throw Error();var u=s<<2|o>>4;if(i.push(u),64!==a){var l=o<<4&240|a>>2;if(i.push(l),64!==c){var h=a<<6&192|c;i.push(h)}}}return i},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},s=function(t){try{return r.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null},o=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,i){n?e.reject(n):e.resolve(i),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,i))}},t}();function a(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function c(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(a())}function u(){var t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function l(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function h(){return a().indexOf("Electron/")>=0}function d(){var t=a();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function f(){return a().indexOf("MSAppHost/")>=0}function p(){return!function(){try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(t){return!1}}()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}var g=function(t){function e(n,i,r){var s=t.call(this,i)||this;return s.code=n,s.customData=r,s.name="FirebaseError",Object.setPrototypeOf(s,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(s,m.prototype.create),s}return(0,i.C6)(e,t),e}(Error),m=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var i=e[0]||{},r=this.service+"/"+t,s=this.errors[t],o=s?function(t,e){return t.replace(y,(function(t,n){var i=e[n];return null!=i?String(i):"<"+n+"?>"}))}(s,i):"Error",a=this.serviceName+": "+o+" ("+r+").";return new g(r,a,i)},t}(),y=/\{\$([^}]+)}/g;function v(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function w(t,e){if(t===e)return!0;for(var n=Object.keys(t),i=Object.keys(e),r=0,s=n;r<s.length;r++){var o=s[r];if(!i.includes(o))return!1;var a=t[o],c=e[o];if(b(a)&&b(c)){if(!w(a,c))return!1}else if(a!==c)return!1}for(var u=0,l=i;u<l.length;u++)if(o=l[u],!n.includes(o))return!1;return!0}function b(t){return null!==t&&"object"==typeof t}function _(t){for(var e=[],n=function(t,n){Array.isArray(n)?n.forEach((function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))})):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))},i=0,r=Object.entries(t);i<r.length;i++){var s=r[i];n(s[0],s[1])}return e.length?"&"+e.join("&"):""}function I(t){var e={};return t.replace(/^\?/,"").split("&").forEach((function(t){if(t){var n=t.split("="),i=n[0],r=n[1];e[decodeURIComponent(i)]=decodeURIComponent(r)}})),e}function T(t){var e=t.indexOf("?");if(!e)return"";var n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function E(t,e){var n=new S(t,e);return n.subscribe.bind(n)}!function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var i=0;i<16;i++)n[i]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(i=0;i<16;i++)n[i]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(i=16;i<80;i++){var r=n[i-3]^n[i-8]^n[i-14]^n[i-16];n[i]=4294967295&(r<<1|r>>>31)}var s,o,a=this.chain_[0],c=this.chain_[1],u=this.chain_[2],l=this.chain_[3],h=this.chain_[4];for(i=0;i<80;i++)i<40?i<20?(s=l^c&(u^l),o=1518500249):(s=c^u^l,o=1859775393):i<60?(s=c&u|l&(c|u),o=2400959708):(s=c^u^l,o=3395469782),r=(a<<5|a>>>27)+s+h+o+n[i]&4294967295,h=l,l=u,u=4294967295&(c<<30|c>>>2),c=a,a=r;this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+c&4294967295,this.chain_[2]=this.chain_[2]+u&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,i=0,r=this.buf_,s=this.inbuf_;i<e;){if(0===s)for(;i<=n;)this.compress_(t,i),i+=this.blockSize;if("string"==typeof t){for(;i<e;)if(r[s]=t.charCodeAt(i),++i,++s===this.blockSize){this.compress_(r),s=0;break}}else for(;i<e;)if(r[s]=t[i],++i,++s===this.blockSize){this.compress_(r),s=0;break}}this.inbuf_=s,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var i=0;for(n=0;n<5;n++)for(var r=24;r>=0;r-=8)t[i]=this.chain_[n]>>r&255,++i;return t}}();var S=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var i,r=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(i=function(t){if("object"!=typeof t||null===t)return!1;for(var e=0,n=["next","error","complete"];e<n.length;e++){var i=n[e];if(i in t&&"function"==typeof t[i])return!0}return!1}(t)?t:{next:t,error:e,complete:n}).next&&(i.next=A),void 0===i.error&&(i.error=A),void 0===i.complete&&(i.complete=A);var s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{r.finalError?i.error(r.finalError):i.complete()}catch(t){}})),this.observers.push(i),s},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function A(){}function k(t){return t&&t._delegate?t._delegate:t}},635:(t,e,n)=>{n.d(e,{C6:()=>r,Ju:()=>c,Tt:()=>s,YH:()=>a,fX:()=>l,sH:()=>o,zs:()=>u});var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},i(t,e)};function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function s(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}function o(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))}function a(t,e){var n,i,r,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=a(0),o.throw=a(1),o.return=a(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,i=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(6===a[0]&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(t,s)}catch(t){a=[6,t],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}function c(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function u(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,s=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(i=s.next()).done;)o.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return o}function l(t,e,n){if(n||2===arguments.length)for(var i,r=0,s=e.length;r<s;r++)!i&&r in e||(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError},790:(t,e,n)=>{n.d(e,{H9:()=>zi,O5:()=>mr,aU:()=>Wi,mZ:()=>gr});var i=n(468),r=n(134),s=n(477),o=n(625),a=n(36);class c{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}c.UNAUTHENTICATED=new c(null),c.GOOGLE_CREDENTIALS=new c("google-credentials-uid"),c.FIRST_PARTY=new c("first-party-uid"),c.MOCK_USER=new c("mock-user");let u="9.0.1";const l=new s.Vy("@firebase/firestore");function h(){return l.logLevel}function d(t,...e){if(l.logLevel<=s.$b.DEBUG){const n=e.map(g);l.debug(`Firestore (${u}): ${t}`,...n)}}function f(t,...e){if(l.logLevel<=s.$b.ERROR){const n=e.map(g);l.error(`Firestore (${u}): ${t}`,...n)}}function p(t,...e){if(l.logLevel<=s.$b.WARN){const n=e.map(g);l.warn(`Firestore (${u}): ${t}`,...n)}}function g(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function m(t="Unexpected state"){const e=`FIRESTORE (${u}) INTERNAL ASSERTION FAILED: `+t;throw f(e),new Error(e)}function y(t,e){t||m()}function v(t,e){return t}const w={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class b extends Error{constructor(t,e){super(e),this.code=t,this.message=e,this.name="FirebaseError",this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class _{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class I{constructor(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization=`Bearer ${t}`}}class T{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(c.UNAUTHENTICATED)))}shutdown(){}}class E{constructor(t){this.t=t,this.currentUser=c.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let n=this.i;const i=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let r=new _;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new _,t.enqueueRetryable((()=>i(this.currentUser)))};const s=e=>{t.enqueueRetryable((async()=>{d("FirebaseCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),await r.promise,await i(this.currentUser)}))};this.t.onInit((t=>s(t))),setTimeout((()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?s(t):(d("FirebaseCredentialsProvider","Auth not yet detected"),r.resolve(),r=new _)}}),0),t.enqueueRetryable((async()=>{0===this.i&&(await r.promise,await i(this.currentUser))}))}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((e=>this.i!==t?(d("FirebaseCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(y("string"==typeof e.accessToken),new I(e.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return y(null===t||"string"==typeof t),new c(t)}}class S{constructor(t,e,n){this.h=t,this.l=e,this.m=n,this.type="FirstParty",this.user=c.FIRST_PARTY}get authHeaders(){const t={"X-Goog-AuthUser":this.l},e=this.h.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.m&&(t["X-Goog-Iam-Authorization-Token"]=this.m),t}}class A{constructor(t,e,n){this.h=t,this.l=e,this.m=n}getToken(){return Promise.resolve(new S(this.h,this.l,this.m))}start(t,e){t.enqueueRetryable((()=>e(c.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class k{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.g(t),this.p=t=>e.writeSequenceNumber(t))}g(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.p&&this.p(t),t}}function R(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}k.T=-1;class N{static I(){const t=62*Math.floor(256/62);let e="";for(;e.length<20;){const n=R(40);for(let i=0;i<n.length;++i)e.length<20&&n[i]<t&&(e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[i]%62))}return e}}function C(t,e){return t<e?-1:t>e?1:0}function O(t,e,n){return t.length===e.length&&t.every(((t,i)=>n(t,e[i])))}class D{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new b(w.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new b(w.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new b(w.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new b(w.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return D.fromMillis(Date.now())}static fromDate(t){return D.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*e));return new D(e,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?C(this.nanoseconds,t.nanoseconds):C(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class P{constructor(t){this.timestamp=t}static fromTimestamp(t){return new P(t)}static min(){return new P(new D(0,0))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}function L(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function x(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function M(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class U{constructor(t,e,n){void 0===e?e=0:e>t.length&&m(),void 0===n?n=t.length-e:n>t.length-e&&m(),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===U.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof U?t.forEach((t=>{e.push(t)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const n=t.get(i),r=e.get(i);if(n<r)return-1;if(n>r)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class F extends U{construct(t,e,n){return new F(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new b(w.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((t=>t.length>0)))}return new F(e)}static emptyPath(){return new F([])}}const V=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class j extends U{construct(t,e,n){return new j(t,e,n)}static isValidIdentifier(t){return V.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),j.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new j(["__name__"])}static fromServerFormat(t){const e=[];let n="",i=0;const r=()=>{if(0===n.length)throw new b(w.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let s=!1;for(;i<t.length;){const e=t[i];if("\\"===e){if(i+1===t.length)throw new b(w.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[i+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new b(w.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,i+=2}else"`"===e?(s=!s,i++):"."!==e||s?(n+=e,i++):(r(),i++)}if(r(),s)throw new b(w.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new j(e)}static emptyPath(){return new j([])}}class B{constructor(t){this.fields=t,t.sort(j.comparator)}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return O(this.fields,t.fields,((t,e)=>t.isEqual(e)))}}class H{constructor(t){this.binaryString=t}static fromBase64String(t){const e=atob(t);return new H(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new H(e)}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return C(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}H.EMPTY_BYTE_STRING=new H("");const K=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function q(t){if(y(!!t),"string"==typeof t){let e=0;const n=K.exec(t);if(y(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:z(t.seconds),nanos:z(t.nanos)}}function z(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function $(t){return"string"==typeof t?H.fromBase64String(t):H.fromUint8Array(t)}function G(t){const e=q(t.mapValue.fields.__local_write_time__.timestampValue);return new D(e.seconds,e.nanos)}function W(t){return null==t}function X(t){return 0===t&&1/t==-1/0}class Q{constructor(t){this.path=t}static fromPath(t){return new Q(F.fromString(t))}static fromName(t){return new Q(F.fromString(t).popFirst(5))}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}isEqual(t){return null!==t&&0===F.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return F.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Q(new F(t.slice()))}}function J(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?function(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}(t)?4:10:m()}function Y(t,e){const n=J(t);if(n!==J(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return G(t).isEqual(G(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=q(t.timestampValue),i=q(e.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return $(t.bytesValue).isEqual($(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return z(t.geoPointValue.latitude)===z(e.geoPointValue.latitude)&&z(t.geoPointValue.longitude)===z(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return z(t.integerValue)===z(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=z(t.doubleValue),i=z(e.doubleValue);return n===i?X(n)===X(i):isNaN(n)&&isNaN(i)}return!1}(t,e);case 9:return O(t.arrayValue.values||[],e.arrayValue.values||[],Y);case 10:return function(t,e){const n=t.mapValue.fields||{},i=e.mapValue.fields||{};if(L(n)!==L(i))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===i[t]||!Y(n[t],i[t])))return!1;return!0}(t,e);default:return m()}}function Z(t,e){return void 0!==(t.values||[]).find((t=>Y(t,e)))}function tt(t,e){const n=J(t),i=J(e);if(n!==i)return C(n,i);switch(n){case 0:return 0;case 1:return C(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=z(t.integerValue||t.doubleValue),i=z(e.integerValue||e.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(t,e);case 3:return et(t.timestampValue,e.timestampValue);case 4:return et(G(t),G(e));case 5:return C(t.stringValue,e.stringValue);case 6:return function(t,e){const n=$(t),i=$(e);return n.compareTo(i)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),i=e.split("/");for(let t=0;t<n.length&&t<i.length;t++){const e=C(n[t],i[t]);if(0!==e)return e}return C(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=C(z(t.latitude),z(e.latitude));return 0!==n?n:C(z(t.longitude),z(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],i=e.values||[];for(let t=0;t<n.length&&t<i.length;++t){const e=tt(n[t],i[t]);if(e)return e}return C(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){const n=t.fields||{},i=Object.keys(n),r=e.fields||{},s=Object.keys(r);i.sort(),s.sort();for(let t=0;t<i.length&&t<s.length;++t){const e=C(i[t],s[t]);if(0!==e)return e;const o=tt(n[i[t]],r[s[t]]);if(0!==o)return o}return C(i.length,s.length)}(t.mapValue,e.mapValue);default:throw m()}}function et(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return C(t,e);const n=q(t),i=q(e),r=C(n.seconds,i.seconds);return 0!==r?r:C(n.nanos,i.nanos)}function nt(t){return it(t)}function it(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=q(t);return`time(${e.seconds},${e.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?$(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,Q.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(t){let e="[",n=!0;for(const i of t.values||[])n?n=!1:e+=",",e+=it(i);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",i=!0;for(const r of e)i?i=!1:n+=",",n+=`${r}:${it(t.fields[r])}`;return n+"}"}(t.mapValue):m();var e,n}function rt(t){return!!t&&"integerValue"in t}function st(t){return!!t&&"arrayValue"in t}function ot(t){return!!t&&"mapValue"in t}function at(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return x(t.mapValue.fields,((t,n)=>e.mapValue.fields[t]=at(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=at(t.arrayValue.values[n]);return e}return Object.assign({},t)}class ct{constructor(t){this.value=t}static empty(){return new ct({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!ot(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=at(e)}setAll(t){let e=j.emptyPath(),n={},i=[];t.forEach(((t,r)=>{if(!e.isImmediateParentOf(r)){const t=this.getFieldsMap(e);this.applyChanges(t,n,i),n={},i=[],e=r.popLast()}t?n[r.lastSegment()]=at(t):i.push(r.lastSegment())}));const r=this.getFieldsMap(e);this.applyChanges(r,n,i)}delete(t){const e=this.field(t.popLast());ot(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Y(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let i=e.mapValue.fields[t.get(n)];ot(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,n){x(e,((e,n)=>t[e]=n));for(const e of n)delete t[e]}clone(){return new ct(at(this.value))}}function ut(t){const e=[];return x(t.fields,((t,n)=>{const i=new j([t]);if(ot(n)){const t=ut(n.mapValue).fields;if(0===t.length)e.push(i);else for(const n of t)e.push(i.child(n))}else e.push(i)})),new B(e)}class lt{constructor(t,e,n,i,r){this.key=t,this.documentType=e,this.version=n,this.data=i,this.documentState=r}static newInvalidDocument(t){return new lt(t,0,P.min(),ct.empty(),0)}static newFoundDocument(t,e,n){return new lt(t,1,e,n,0)}static newNoDocument(t,e){return new lt(t,2,e,ct.empty(),0)}static newUnknownDocument(t,e){return new lt(t,3,e,ct.empty(),2)}convertToFoundDocument(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=ct.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=ct.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof lt&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}clone(){return new lt(this.key,this.documentType,this.version,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class ht{constructor(t,e=null,n=[],i=[],r=null,s=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=s,this.endAt=o,this.A=null}}function dt(t,e=null,n=[],i=[],r=null,s=null,o=null){return new ht(t,e,n,i,r,s,o)}function ft(t){const e=v(t);if(null===e.A){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((t=>function(t){return t.field.canonicalString()+t.op.toString()+nt(t.value)}(t))).join(","),t+="|ob:",t+=e.orderBy.map((t=>function(t){return t.field.canonicalString()+t.dir}(t))).join(","),W(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=St(e.startAt)),e.endAt&&(t+="|ub:",t+=St(e.endAt)),e.A=t}return e.A}function pt(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!kt(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(n=t.filters[r],i=e.filters[r],n.op!==i.op||!n.field.isEqual(i.field)||!Y(n.value,i.value))return!1;var n,i;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Nt(t.startAt,e.startAt)&&Nt(t.endAt,e.endAt)}class gt extends class{}{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.R(t,e,n):new mt(t,e,n):"array-contains"===e?new bt(t,n):"in"===e?new _t(t,n):"not-in"===e?new It(t,n):"array-contains-any"===e?new Tt(t,n):new gt(t,e,n)}static R(t,e,n){return"in"===e?new yt(t,n):new vt(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.P(tt(e,this.value)):null!==e&&J(this.value)===J(e)&&this.P(tt(e,this.value))}P(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return m()}}v(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class mt extends gt{constructor(t,e,n){super(t,e,n),this.key=Q.fromName(n.referenceValue)}matches(t){const e=Q.comparator(t.key,this.key);return this.P(e)}}class yt extends gt{constructor(t,e){super(t,"in",e),this.keys=wt(0,e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class vt extends gt{constructor(t,e){super(t,"not-in",e),this.keys=wt(0,e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function wt(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((t=>Q.fromName(t.referenceValue)))}class bt extends gt{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return st(e)&&Z(e.arrayValue,this.value)}}class _t extends gt{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&Z(this.value.arrayValue,e)}}class It extends gt{constructor(t,e){super(t,"not-in",e)}matches(t){if(Z(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!Z(this.value.arrayValue,e)}}class Tt extends gt{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!st(e)||!e.arrayValue.values)&&e.arrayValue.values.some((t=>Z(this.value.arrayValue,t)))}}class Et{constructor(t,e){this.position=t,this.before=e}}function St(t){return`${t.before?"b":"a"}:${t.position.map((t=>nt(t))).join(",")}`}class At{constructor(t,e="asc"){this.field=t,this.dir=e}}function kt(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function Rt(t,e,n){let i=0;for(let r=0;r<t.position.length;r++){const s=e[r],o=t.position[r];if(i=s.field.isKeyField()?Q.comparator(Q.fromName(o.referenceValue),n.key):tt(o,n.data.field(s.field)),"desc"===s.dir&&(i*=-1),0!==i)break}return t.before?i<=0:i<0}function Nt(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Y(t.position[n],e.position[n]))return!1;return!0}class Ct{constructor(t,e=null,n=[],i=[],r=null,s="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=i,this.limit=r,this.limitType=s,this.startAt=o,this.endAt=a,this.V=null,this.S=null,this.startAt,this.endAt}}function Ot(t){const e=v(t);if(null===e.V){e.V=[];const t=function(t){for(const e of t.filters)if(e.v())return e.field;return null}(e),n=function(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}(e);if(null!==t&&null===n)t.isKeyField()||e.V.push(new At(t)),e.V.push(new At(j.keyField(),"asc"));else{let t=!1;for(const n of e.explicitOrderBy)e.V.push(n),n.field.isKeyField()&&(t=!0);if(!t){const t=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.V.push(new At(j.keyField(),t))}}}return e.V}function Dt(t){const e=v(t);if(!e.S)if("F"===e.limitType)e.S=dt(e.path,e.collectionGroup,Ot(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const n of Ot(e)){const e="desc"===n.dir?"asc":"desc";t.push(new At(n.field,e))}const n=e.endAt?new Et(e.endAt.position,!e.endAt.before):null,i=e.startAt?new Et(e.startAt.position,!e.startAt.before):null;e.S=dt(e.path,e.collectionGroup,t,e.filters,e.limit,n,i)}return e.S}function Pt(t,e){return pt(Dt(t),Dt(e))&&t.limitType===e.limitType}function Lt(t){return`${ft(Dt(t))}|lt:${t.limitType}`}function xt(t){return`Query(target=${function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map((t=>{return`${(e=t).field.canonicalString()} ${e.op} ${nt(e.value)}`;var e})).join(", ")}]`),W(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map((t=>function(t){return`${t.field.canonicalString()} (${t.dir})`}(t))).join(", ")}]`),t.startAt&&(e+=", startAt: "+St(t.startAt)),t.endAt&&(e+=", endAt: "+St(t.endAt)),`Target(${e})`}(Dt(t))}; limitType=${t.limitType})`}function Mt(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):Q.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of t.explicitOrderBy)if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!Rt(t.startAt,Ot(t),e)||t.endAt&&Rt(t.endAt,Ot(t),e))}(t,e)}function Ut(t,e,n){const i=t.field.isKeyField()?Q.comparator(e.key,n.key):function(t,e,n){const i=e.data.field(t),r=n.data.field(t);return null!==i&&null!==r?tt(i,r):m()}(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return m()}}function Ft(t,e){if(t.D){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:X(e)?"-0":e}}function Vt(t){return{integerValue:""+t}}function jt(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!X(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?Vt(e):Ft(t,e)}class Bt{constructor(){this._=void 0}}function Ht(t,e,n){return t instanceof zt?function(t,e){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof $t?Gt(t,e):t instanceof Wt?Xt(t,e):function(t,e){const n=qt(t,e),i=Jt(n)+Jt(t.C);return rt(n)&&rt(t.C)?Vt(i):Ft(t.N,i)}(t,e)}function Kt(t,e,n){return t instanceof $t?Gt(t,e):t instanceof Wt?Xt(t,e):n}function qt(t,e){return t instanceof Qt?rt(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}class zt extends Bt{}class $t extends Bt{constructor(t){super(),this.elements=t}}function Gt(t,e){const n=Yt(e);for(const e of t.elements)n.some((t=>Y(t,e)))||n.push(e);return{arrayValue:{values:n}}}class Wt extends Bt{constructor(t){super(),this.elements=t}}function Xt(t,e){let n=Yt(e);for(const e of t.elements)n=n.filter((t=>!Y(t,e)));return{arrayValue:{values:n}}}class Qt extends Bt{constructor(t,e){super(),this.N=t,this.C=e}}function Jt(t){return z(t.integerValue||t.doubleValue)}function Yt(t){return st(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class Zt{constructor(t,e){this.field=t,this.transform=e}}class te{constructor(t,e){this.version=t,this.transformResults=e}}class ee{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new ee}static exists(t){return new ee(void 0,t)}static updateTime(t){return new ee(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function ne(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class ie{}function re(t,e,n){t instanceof ue?function(t,e,n){const i=t.value.clone(),r=de(t.fieldTransforms,e,n.transformResults);i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(t,e,n):t instanceof le?function(t,e,n){if(!ne(t.precondition,e))return void e.convertToUnknownDocument(n.version);const i=de(t.fieldTransforms,e,n.transformResults),r=e.data;r.setAll(he(t)),r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function se(t,e,n){t instanceof ue?function(t,e,n){if(!ne(t.precondition,e))return;const i=t.value.clone(),r=fe(t.fieldTransforms,n,e);i.setAll(r),e.convertToFoundDocument(ce(e),i).setHasLocalMutations()}(t,e,n):t instanceof le?function(t,e,n){if(!ne(t.precondition,e))return;const i=fe(t.fieldTransforms,n,e),r=e.data;r.setAll(he(t)),r.setAll(i),e.convertToFoundDocument(ce(e),r).setHasLocalMutations()}(t,e,n):function(t,e){ne(t.precondition,e)&&e.convertToNoDocument(P.min())}(t,e)}function oe(t,e){let n=null;for(const i of t.fieldTransforms){const t=e.data.field(i.field),r=qt(i.transform,t||null);null!=r&&(null==n&&(n=ct.empty()),n.set(i.field,r))}return n||null}function ae(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&O(t,e,((t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof $t&&e instanceof $t||t instanceof Wt&&e instanceof Wt?O(t.elements,e.elements,Y):t instanceof Qt&&e instanceof Qt?Y(t.C,e.C):t instanceof zt&&e instanceof zt}(t.transform,e.transform)}(t,e)))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function ce(t){return t.isFoundDocument()?t.version:P.min()}class ue extends ie{constructor(t,e,n,i=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=i,this.type=0}}class le extends ie{constructor(t,e,n,i,r=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=i,this.fieldTransforms=r,this.type=1}}function he(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}})),e}function de(t,e,n){const i=new Map;y(t.length===n.length);for(let r=0;r<n.length;r++){const s=t[r],o=s.transform,a=e.data.field(s.field);i.set(s.field,Kt(o,a,n[r]))}return i}function fe(t,e,n){const i=new Map;for(const r of t){const t=r.transform,s=n.data.field(r.field);i.set(r.field,Ht(t,s,e))}return i}class pe extends ie{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}}class ge extends ie{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}}var me,ye;(ye=me||(me={}))[ye.OK=0]="OK",ye[ye.CANCELLED=1]="CANCELLED",ye[ye.UNKNOWN=2]="UNKNOWN",ye[ye.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ye[ye.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ye[ye.NOT_FOUND=5]="NOT_FOUND",ye[ye.ALREADY_EXISTS=6]="ALREADY_EXISTS",ye[ye.PERMISSION_DENIED=7]="PERMISSION_DENIED",ye[ye.UNAUTHENTICATED=16]="UNAUTHENTICATED",ye[ye.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ye[ye.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ye[ye.ABORTED=10]="ABORTED",ye[ye.OUT_OF_RANGE=11]="OUT_OF_RANGE",ye[ye.UNIMPLEMENTED=12]="UNIMPLEMENTED",ye[ye.INTERNAL=13]="INTERNAL",ye[ye.UNAVAILABLE=14]="UNAVAILABLE",ye[ye.DATA_LOSS=15]="DATA_LOSS";class ve{constructor(t,e){this.comparator=t,this.root=e||be.EMPTY}insert(t,e){return new ve(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,be.BLACK,null,null))}remove(t){return new ve(this.comparator,this.root.remove(t,this.comparator).copy(null,null,be.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(0===i)return e+n.left.size;i<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new we(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new we(this.root,t,this.comparator,!1)}getReverseIterator(){return new we(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new we(this.root,t,this.comparator,!0)}}class we{constructor(t,e,n,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!t.isEmpty();)if(r=e?n(t.key,e):1,i&&(r*=-1),r<0)t=this.isReverse?t.left:t.right;else{if(0===r){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class be{constructor(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:be.RED,this.left=null!=i?i:be.EMPTY,this.right=null!=r?r:be.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,i,r){return new be(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let i=this;const r=n(t,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return be.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===e(t,i.key)){if(i.right.isEmpty())return be.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,be.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,be.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw m();if(this.right.isRed())throw m();const t=this.left.check();if(t!==this.right.check())throw m();return t+(this.isRed()?0:1)}}be.EMPTY=null,be.RED=!0,be.BLACK=!1,be.EMPTY=new class{constructor(){this.size=0}get key(){throw m()}get value(){throw m()}get color(){throw m()}get left(){throw m()}get right(){throw m()}copy(t,e,n,i,r){return this}insert(t,e,n){return new be(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class _e{constructor(t){this.comparator=t,this.data=new ve(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new Ie(this.data.getIterator())}getIteratorFrom(t){return new Ie(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((t=>{e=e.add(t)})),e}isEqual(t){if(!(t instanceof _e))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(0!==this.comparator(t,i))return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new _e(this.comparator);return e.data=t,e}}class Ie{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}const Te=new ve(Q.comparator);function Ee(){return Te}const Se=new ve(Q.comparator);function Ae(){return Se}const ke=new ve(Q.comparator);const Re=new _e(Q.comparator);function Ne(...t){let e=Re;for(const n of t)e=e.add(n);return e}const Ce=new _e(C);class Oe{constructor(t,e){this.databaseId=t,this.D=e}}function De(t,e){return t.D?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Pe(t,e){return t.D?e.toBase64():e.toUint8Array()}function Le(t,e){return De(t,e.toTimestamp())}function xe(t){return y(!!t),P.fromTimestamp(function(t){const e=q(t);return new D(e.seconds,e.nanos)}(t))}function Me(t,e){return function(t){return new F(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function Ue(t,e){return Me(t.databaseId,e.path)}function Fe(t){const e=function(t){const e=F.fromString(t);return y(function(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}(e)),e}(t);return 4===e.length?F.emptyPath():function(t){return y(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}(e)}function Ve(t,e,n){return{name:Ue(t,e),fields:n.value.mapValue.fields}}function je(t){let e=Fe(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){y(1===i);const t=n.from[0];t.allDescendants?r=t.collectionId:e=e.child(t.collectionId)}let s=[];n.where&&(s=Be(n.where));let o=[];n.orderBy&&(o=n.orderBy.map((t=>function(t){return new At(Ke(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t))));let a=null;n.limit&&(a=function(t){let e;return e="object"==typeof t?t.value:t,W(e)?null:e}(n.limit));let c=null;n.startAt&&(c=He(n.startAt));let u=null;return n.endAt&&(u=He(n.endAt)),function(t,e,n,i,r,s,o,a){return new Ct(t,e,n,i,r,s,o,a)}(e,r,o,s,a,"F",c,u)}function Be(t){return t?void 0!==t.unaryFilter?[ze(t)]:void 0!==t.fieldFilter?[qe(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((t=>Be(t))).reduce(((t,e)=>t.concat(e))):m():[]}function He(t){const e=!!t.before,n=t.values||[];return new Et(n,e)}function Ke(t){return j.fromServerFormat(t.fieldPath)}function qe(t){return gt.create(Ke(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return m()}}(t.fieldFilter.op),t.fieldFilter.value)}function ze(t){switch(t.unaryFilter.op){case"IS_NAN":const e=Ke(t.unaryFilter.field);return gt.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=Ke(t.unaryFilter.field);return gt.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Ke(t.unaryFilter.field);return gt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=Ke(t.unaryFilter.field);return gt.create(r,"!=",{nullValue:"NULL_VALUE"});default:return m()}}function $e(t){const e=[];return t.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Ge(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=Xe(e)),e=We(t.get(n),e);return Xe(e)}function We(t,e){let n=e;const i=t.length;for(let e=0;e<i;e++){const i=t.charAt(e);switch(i){case"\0":n+="";break;case"":n+="";break;default:n+=i}}return n}function Xe(t){return t+""}class Qe{constructor(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n}}Qe.store="owner",Qe.key="owner";class Je{constructor(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}}Je.store="mutationQueues",Je.keyPath="userId";class Ye{constructor(t,e,n,i,r){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=i,this.mutations=r}}Ye.store="mutations",Ye.keyPath="batchId",Ye.userMutationsIndex="userMutationsIndex",Ye.userMutationsKeyPath=["userId","batchId"];class Ze{constructor(){}static prefixForUser(t){return[t]}static prefixForPath(t,e){return[t,Ge(e)]}static key(t,e,n){return[t,Ge(e),n]}}Ze.store="documentMutations",Ze.PLACEHOLDER=new Ze;class tn{constructor(t,e,n,i,r,s){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=i,this.readTime=r,this.parentPath=s}}tn.store="remoteDocuments",tn.readTimeIndex="readTimeIndex",tn.readTimeIndexPath="readTime",tn.collectionReadTimeIndex="collectionReadTimeIndex",tn.collectionReadTimeIndexPath=["parentPath","readTime"];class en{constructor(t){this.byteSize=t}}en.store="remoteDocumentGlobal",en.key="remoteDocumentGlobalKey";class nn{constructor(t,e,n,i,r,s,o){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=i,this.lastListenSequenceNumber=r,this.lastLimboFreeSnapshotVersion=s,this.query=o}}nn.store="targets",nn.keyPath="targetId",nn.queryTargetsIndexName="queryTargetsIndex",nn.queryTargetsKeyPath=["canonicalId","targetId"];class rn{constructor(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n}}rn.store="targetDocuments",rn.keyPath=["targetId","path"],rn.documentTargetsIndex="documentTargetsIndex",rn.documentTargetsKeyPath=["path","targetId"];class sn{constructor(t,e,n,i){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=i}}sn.key="targetGlobalKey",sn.store="targetGlobal";class on{constructor(t,e){this.collectionId=t,this.parent=e}}on.store="collectionParents",on.keyPath=["collectionId","parent"];class an{constructor(t,e,n,i){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=i}}an.store="clientMetadata",an.keyPath="clientId";class cn{constructor(t,e,n){this.bundleId=t,this.createTime=e,this.version=n}}cn.store="bundles",cn.keyPath="bundleId";class un{constructor(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n}}un.store="namedQueries",un.keyPath="name",Je.store,Ye.store,Ze.store,tn.store,nn.store,Qe.store,sn.store,rn.store,an.store,en.store,on.store,cn.store,un.store;const ln="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class hn{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}class dn{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&m(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new dn(((n,i)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,i)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,i)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof dn?e:dn.resolve(e)}catch(t){return dn.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):dn.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):dn.reject(e)}static resolve(t){return new dn(((e,n)=>{e(t)}))}static reject(t){return new dn(((e,n)=>{n(t)}))}static waitFor(t){return new dn(((e,n)=>{let i=0,r=0,s=!1;t.forEach((t=>{++i,t.next((()=>{++r,s&&r===i&&e()}),(t=>n(t)))})),s=!0,r===i&&e()}))}static or(t){let e=dn.resolve(!1);for(const n of t)e=e.next((t=>t?dn.resolve(t):n()));return e}static forEach(t,e){const n=[];return t.forEach(((t,i)=>{n.push(e.call(this,t,i))})),this.waitFor(n)}}function fn(t){return"IndexedDbTransactionError"===t.name}class pn{constructor(t,e,n,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let e=0;e<this.mutations.length;e++){const i=this.mutations[e];i.key.isEqual(t.key)&&re(i,t,n[e])}}applyToLocalView(t){for(const e of this.baseMutations)e.key.isEqual(t.key)&&se(e,t,this.localWriteTime);for(const e of this.mutations)e.key.isEqual(t.key)&&se(e,t,this.localWriteTime)}applyToLocalDocumentSet(t){this.mutations.forEach((e=>{const n=t.get(e.key),i=n;this.applyToLocalView(i),n.isValidDocument()||i.convertToNoDocument(P.min())}))}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),Ne())}isEqual(t){return this.batchId===t.batchId&&O(this.mutations,t.mutations,((t,e)=>ae(t,e)))&&O(this.baseMutations,t.baseMutations,((t,e)=>ae(t,e)))}}class gn{constructor(t,e,n,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=i}static from(t,e,n){y(t.mutations.length===n.length);let i=ke;const r=t.mutations;for(let t=0;t<r.length;t++)i=i.insert(r[t].key,n[t].version);return new gn(t,e,n,i)}}class mn{constructor(t){this.Wt=t}}function yn(t){const e=je({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?function(t,e,n){return new Ct(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}(e,e.limit,"L"):e}class vn{constructor(){this.Gt=new wn}addToCollectionParentIndex(t,e){return this.Gt.add(e),dn.resolve()}getCollectionParents(t,e){return dn.resolve(this.Gt.getEntries(e))}}class wn{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e]||new _e(F.comparator),r=!i.has(n);return this.index[e]=i.add(n),r}has(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e];return i&&i.has(n)}getEntries(t){return(this.index[t]||new _e(F.comparator)).toArray()}}class bn{constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}static withCacheSize(t){return new bn(t,bn.DEFAULT_COLLECTION_PERCENTILE,bn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}bn.DEFAULT_COLLECTION_PERCENTILE=10,bn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,bn.DEFAULT=new bn(41943040,bn.DEFAULT_COLLECTION_PERCENTILE,bn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),bn.DISABLED=new bn(-1,0,0);class _n{constructor(t){this.ne=t}next(){return this.ne+=2,this.ne}static se(){return new _n(0)}static ie(){return new _n(-1)}}async function In(t){if(t.code!==w.FAILED_PRECONDITION||t.message!==ln)throw t;d("LocalStore","Unexpectedly lost primary lease")}class Tn{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[e,i]of n)if(this.equalsFn(e,t))return i}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),i=this.inner[n];if(void 0!==i){for(let n=0;n<i.length;n++)if(this.equalsFn(i[n][0],t))return void(i[n]=[t,e]);i.push([t,e])}else this.inner[n]=[[t,e]]}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return 1===n.length?delete this.inner[e]:n.splice(i,1),!0;return!1}forEach(t){x(this.inner,((e,n)=>{for(const[e,i]of n)t(e,i)}))}isEmpty(){return M(this.inner)}}class En{constructor(){this.changes=new Tn((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}getReadTime(t){const e=this.changes.get(t);return e?e.readTime:P.min()}addEntry(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})}removeEntry(t,e=null){this.assertNotApplied(),this.changes.set(t,{document:lt.newInvalidDocument(t),readTime:e})}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?dn.resolve(n.document):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class Sn{constructor(t,e,n){this.He=t,this.In=e,this.Ht=n}An(t,e){return this.In.getAllMutationBatchesAffectingDocumentKey(t,e).next((n=>this.Rn(t,e,n)))}Rn(t,e,n){return this.He.getEntry(t,e).next((t=>{for(const e of n)e.applyToLocalView(t);return t}))}Pn(t,e){t.forEach(((t,n)=>{for(const t of e)t.applyToLocalView(n)}))}bn(t,e){return this.He.getEntries(t,e).next((e=>this.vn(t,e).next((()=>e))))}vn(t,e){return this.In.getAllMutationBatchesAffectingDocumentKeys(t,e).next((t=>this.Pn(e,t)))}getDocumentsMatchingQuery(t,e,n){return function(t){return Q.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Vn(t,e.path):function(t){return null!==t.collectionGroup}(e)?this.Sn(t,e,n):this.Dn(t,e,n)}Vn(t,e){return this.An(t,new Q(e)).next((t=>{let e=Ae();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))}Sn(t,e,n){const i=e.collectionGroup;let r=Ae();return this.Ht.getCollectionParents(t,i).next((s=>dn.forEach(s,(s=>{const o=function(t,e){return new Ct(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return this.Dn(t,o,n).next((t=>{t.forEach(((t,e)=>{r=r.insert(t,e)}))}))})).next((()=>r))))}Dn(t,e,n){let i,r;return this.He.getDocumentsMatchingQuery(t,e,n).next((n=>(i=n,this.In.getAllMutationBatchesAffectingQuery(t,e)))).next((e=>(r=e,this.Cn(t,r,i).next((t=>{i=t;for(const t of r)for(const e of t.mutations){const n=e.key;let r=i.get(n);null==r&&(r=lt.newInvalidDocument(n),i=i.insert(n,r)),se(e,r,t.localWriteTime),r.isFoundDocument()||(i=i.remove(n))}}))))).next((()=>(i.forEach(((t,n)=>{Mt(e,n)||(i=i.remove(t))})),i)))}Cn(t,e,n){let i=Ne();for(const t of e)for(const e of t.mutations)e instanceof le&&null===n.get(e.key)&&(i=i.add(e.key));let r=n;return this.He.getEntries(t,i).next((t=>(t.forEach(((t,e)=>{e.isFoundDocument()&&(r=r.insert(t,e))})),r)))}}class An{constructor(t,e,n,i){this.targetId=t,this.fromCache=e,this.Nn=n,this.xn=i}static kn(t,e){let n=Ne(),i=Ne();for(const t of e.docChanges)switch(t.type){case 0:n=n.add(t.doc.key);break;case 1:i=i.add(t.doc.key)}return new An(t,e.fromCache,n,i)}}class kn{$n(t){this.On=t}getDocumentsMatchingQuery(t,e,n,i){return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(P.min())?this.Fn(t,e):this.On.bn(t,i).next((r=>{const o=this.Mn(e,r);return(function(t){return!W(t.limit)&&"F"===t.limitType}(e)||function(t){return!W(t.limit)&&"L"===t.limitType}(e))&&this.Ln(e.limitType,o,i,n)?this.Fn(t,e):(h()<=s.$b.DEBUG&&d("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),xt(e)),this.On.getDocumentsMatchingQuery(t,e,n).next((t=>(o.forEach((e=>{t=t.insert(e.key,e)})),t))))}))}Mn(t,e){let n=new _e(function(t){return(e,n)=>{let i=!1;for(const r of Ot(t)){const t=Ut(r,e,n);if(0!==t)return t;i=i||r.field.isKeyField()}return 0}}(t));return e.forEach(((e,i)=>{Mt(t,i)&&(n=n.add(i))})),n}Ln(t,e,n,i){if(n.size!==e.size)return!0;const r="F"===t?e.last():e.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}Fn(t,e){return h()<=s.$b.DEBUG&&d("QueryEngine","Using full collection scan to execute query:",xt(e)),this.On.getDocumentsMatchingQuery(t,e,P.min())}}class Rn{constructor(t,e,n,i){this.persistence=t,this.Bn=e,this.N=i,this.Un=new ve(C),this.qn=new Tn((t=>ft(t)),pt),this.Kn=P.min(),this.In=t.getMutationQueue(n),this.jn=t.getRemoteDocumentCache(),this.ze=t.getTargetCache(),this.Qn=new Sn(this.jn,this.In,this.persistence.getIndexManager()),this.Je=t.getBundleCache(),this.Bn.$n(this.Qn)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.Un)))}}async function Nn(t,e){const n=v(t);let i=n.In,r=n.Qn;const s=await n.persistence.runTransaction("Handle user change","readonly",(t=>{let s;return n.In.getAllMutationBatches(t).next((o=>(s=o,i=n.persistence.getMutationQueue(e),r=new Sn(n.jn,i,n.persistence.getIndexManager()),i.getAllMutationBatches(t)))).next((e=>{const n=[],i=[];let o=Ne();for(const t of s){n.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}for(const t of e){i.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}return r.bn(t,o).next((t=>({Wn:t,removedBatchIds:n,addedBatchIds:i})))}))}));return n.In=i,n.Qn=r,n.Bn.$n(n.Qn),s}function Cn(t,e){const n=v(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(t=>(void 0===e&&(e=-1),n.In.getNextMutationBatchAfterBatchId(t,e))))}class On{constructor(t){this.N=t,this.Yn=new Map,this.Xn=new Map}getBundleMetadata(t,e){return dn.resolve(this.Yn.get(e))}saveBundleMetadata(t,e){var n;return this.Yn.set(e.id,{id:(n=e).id,version:n.version,createTime:xe(n.createTime)}),dn.resolve()}getNamedQuery(t,e){return dn.resolve(this.Xn.get(e))}saveNamedQuery(t,e){return this.Xn.set(e.name,function(t){return{name:t.name,query:yn(t.bundledQuery),readTime:xe(t.readTime)}}(e)),dn.resolve()}}class Dn{constructor(){this.Zn=new _e(Pn.ts),this.es=new _e(Pn.ns)}isEmpty(){return this.Zn.isEmpty()}addReference(t,e){const n=new Pn(t,e);this.Zn=this.Zn.add(n),this.es=this.es.add(n)}ss(t,e){t.forEach((t=>this.addReference(t,e)))}removeReference(t,e){this.rs(new Pn(t,e))}os(t,e){t.forEach((t=>this.removeReference(t,e)))}cs(t){const e=new Q(new F([])),n=new Pn(e,t),i=new Pn(e,t+1),r=[];return this.es.forEachInRange([n,i],(t=>{this.rs(t),r.push(t.key)})),r}us(){this.Zn.forEach((t=>this.rs(t)))}rs(t){this.Zn=this.Zn.delete(t),this.es=this.es.delete(t)}hs(t){const e=new Q(new F([])),n=new Pn(e,t),i=new Pn(e,t+1);let r=Ne();return this.es.forEachInRange([n,i],(t=>{r=r.add(t.key)})),r}containsKey(t){const e=new Pn(t,0),n=this.Zn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class Pn{constructor(t,e){this.key=t,this.ls=e}static ts(t,e){return Q.comparator(t.key,e.key)||C(t.ls,e.ls)}static ns(t,e){return C(t.ls,e.ls)||Q.comparator(t.key,e.key)}}class Ln{constructor(t,e){this.Ht=t,this.referenceDelegate=e,this.In=[],this.fs=1,this.ds=new _e(Pn.ts)}checkEmpty(t){return dn.resolve(0===this.In.length)}addMutationBatch(t,e,n,i){const r=this.fs;this.fs++,this.In.length>0&&this.In[this.In.length-1];const s=new pn(r,e,n,i);this.In.push(s);for(const e of i)this.ds=this.ds.add(new Pn(e.key,r)),this.Ht.addToCollectionParentIndex(t,e.key.path.popLast());return dn.resolve(s)}lookupMutationBatch(t,e){return dn.resolve(this.ws(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,i=this._s(n),r=i<0?0:i;return dn.resolve(this.In.length>r?this.In[r]:null)}getHighestUnacknowledgedBatchId(){return dn.resolve(0===this.In.length?-1:this.fs-1)}getAllMutationBatches(t){return dn.resolve(this.In.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new Pn(e,0),i=new Pn(e,Number.POSITIVE_INFINITY),r=[];return this.ds.forEachInRange([n,i],(t=>{const e=this.ws(t.ls);r.push(e)})),dn.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new _e(C);return e.forEach((t=>{const e=new Pn(t,0),i=new Pn(t,Number.POSITIVE_INFINITY);this.ds.forEachInRange([e,i],(t=>{n=n.add(t.ls)}))})),dn.resolve(this.gs(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,i=n.length+1;let r=n;Q.isDocumentKey(r)||(r=r.child(""));const s=new Pn(new Q(r),0);let o=new _e(C);return this.ds.forEachWhile((t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===i&&(o=o.add(t.ls)),!0)}),s),dn.resolve(this.gs(o))}gs(t){const e=[];return t.forEach((t=>{const n=this.ws(t);null!==n&&e.push(n)})),e}removeMutationBatch(t,e){y(0===this.ys(e.batchId,"removed")),this.In.shift();let n=this.ds;return dn.forEach(e.mutations,(i=>{const r=new Pn(i.key,e.batchId);return n=n.delete(r),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((()=>{this.ds=n}))}te(t){}containsKey(t,e){const n=new Pn(e,0),i=this.ds.firstAfterOrEqual(n);return dn.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return this.In.length,dn.resolve()}ys(t,e){return this._s(t)}_s(t){return 0===this.In.length?0:t-this.In[0].batchId}ws(t){const e=this._s(t);return e<0||e>=this.In.length?null:this.In[e]}}class xn{constructor(t,e){this.Ht=t,this.ps=e,this.docs=new ve(Q.comparator),this.size=0}addEntry(t,e,n){const i=e.key,r=this.docs.get(i),s=r?r.size:0,o=this.ps(e);return this.docs=this.docs.insert(i,{document:e.clone(),size:o,readTime:n}),this.size+=o-s,this.Ht.addToCollectionParentIndex(t,i.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return dn.resolve(n?n.document.clone():lt.newInvalidDocument(e))}getEntries(t,e){let n=Ee();return e.forEach((t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.clone():lt.newInvalidDocument(t))})),dn.resolve(n)}getDocumentsMatchingQuery(t,e,n){let i=Ee();const r=new Q(e.path.child("")),s=this.docs.getIteratorFrom(r);for(;s.hasNext();){const{key:t,value:{document:r,readTime:o}}=s.getNext();if(!e.path.isPrefixOf(t.path))break;o.compareTo(n)<=0||Mt(e,r)&&(i=i.insert(r.key,r.clone()))}return dn.resolve(i)}Es(t,e){return dn.forEach(this.docs,(t=>e(t)))}newChangeBuffer(t){return new Mn(this)}getSize(t){return dn.resolve(this.size)}}class Mn extends En{constructor(t){super(),this.Se=t}applyChanges(t){const e=[];return this.changes.forEach(((n,i)=>{i.document.isValidDocument()?e.push(this.Se.addEntry(t,i.document,this.getReadTime(n))):this.Se.removeEntry(n)})),dn.waitFor(e)}getFromCache(t,e){return this.Se.getEntry(t,e)}getAllFromCache(t,e){return this.Se.getEntries(t,e)}}class Un{constructor(t){this.persistence=t,this.Ts=new Tn((t=>ft(t)),pt),this.lastRemoteSnapshotVersion=P.min(),this.highestTargetId=0,this.Is=0,this.As=new Dn,this.targetCount=0,this.Rs=_n.se()}forEachTarget(t,e){return this.Ts.forEach(((t,n)=>e(n))),dn.resolve()}getLastRemoteSnapshotVersion(t){return dn.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return dn.resolve(this.Is)}allocateTargetId(t){return this.highestTargetId=this.Rs.next(),dn.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Is&&(this.Is=e),dn.resolve()}ae(t){this.Ts.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.Rs=new _n(e),this.highestTargetId=e),t.sequenceNumber>this.Is&&(this.Is=t.sequenceNumber)}addTargetData(t,e){return this.ae(e),this.targetCount+=1,dn.resolve()}updateTargetData(t,e){return this.ae(e),dn.resolve()}removeTargetData(t,e){return this.Ts.delete(e.target),this.As.cs(e.targetId),this.targetCount-=1,dn.resolve()}removeTargets(t,e,n){let i=0;const r=[];return this.Ts.forEach(((s,o)=>{o.sequenceNumber<=e&&null===n.get(o.targetId)&&(this.Ts.delete(s),r.push(this.removeMatchingKeysForTargetId(t,o.targetId)),i++)})),dn.waitFor(r).next((()=>i))}getTargetCount(t){return dn.resolve(this.targetCount)}getTargetData(t,e){const n=this.Ts.get(e)||null;return dn.resolve(n)}addMatchingKeys(t,e,n){return this.As.ss(e,n),dn.resolve()}removeMatchingKeys(t,e,n){this.As.os(e,n);const i=this.persistence.referenceDelegate,r=[];return i&&e.forEach((e=>{r.push(i.markPotentiallyOrphaned(t,e))})),dn.waitFor(r)}removeMatchingKeysForTargetId(t,e){return this.As.cs(e),dn.resolve()}getMatchingKeysForTargetId(t,e){const n=this.As.hs(e);return dn.resolve(n)}containsKey(t,e){return dn.resolve(this.As.containsKey(e))}}class Fn{constructor(t,e){this.Ps={},this.Le=new k(0),this.Be=!1,this.Be=!0,this.referenceDelegate=t(this),this.ze=new Un(this),this.Ht=new vn,this.He=function(t,e){return new xn(t,e)}(this.Ht,(t=>this.referenceDelegate.bs(t))),this.N=new mn(e),this.Je=new On(this.N)}start(){return Promise.resolve()}shutdown(){return this.Be=!1,Promise.resolve()}get started(){return this.Be}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(){return this.Ht}getMutationQueue(t){let e=this.Ps[t.toKey()];return e||(e=new Ln(this.Ht,this.referenceDelegate),this.Ps[t.toKey()]=e),e}getTargetCache(){return this.ze}getRemoteDocumentCache(){return this.He}getBundleCache(){return this.Je}runTransaction(t,e,n){d("MemoryPersistence","Starting transaction:",t);const i=new Vn(this.Le.next());return this.referenceDelegate.vs(),n(i).next((t=>this.referenceDelegate.Vs(i).next((()=>t)))).toPromise().then((t=>(i.raiseOnCommittedEvent(),t)))}Ss(t,e){return dn.or(Object.values(this.Ps).map((n=>()=>n.containsKey(t,e))))}}class Vn extends hn{constructor(t){super(),this.currentSequenceNumber=t}}class jn{constructor(t){this.persistence=t,this.Ds=new Dn,this.Cs=null}static Ns(t){return new jn(t)}get xs(){if(this.Cs)return this.Cs;throw m()}addReference(t,e,n){return this.Ds.addReference(n,e),this.xs.delete(n.toString()),dn.resolve()}removeReference(t,e,n){return this.Ds.removeReference(n,e),this.xs.add(n.toString()),dn.resolve()}markPotentiallyOrphaned(t,e){return this.xs.add(e.toString()),dn.resolve()}removeTarget(t,e){this.Ds.cs(e.targetId).forEach((t=>this.xs.add(t.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((t=>{t.forEach((t=>this.xs.add(t.toString())))})).next((()=>n.removeTargetData(t,e)))}vs(){this.Cs=new Set}Vs(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return dn.forEach(this.xs,(n=>{const i=Q.fromPath(n);return this.ks(t,i).next((t=>{t||e.removeEntry(i)}))})).next((()=>(this.Cs=null,e.apply(t))))}updateLimboDocument(t,e){return this.ks(t,e).next((t=>{t?this.xs.delete(e.toString()):this.xs.add(e.toString())}))}bs(t){return 0}ks(t,e){return dn.or([()=>dn.resolve(this.Ds.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ss(t,e)])}}class Bn{constructor(){this.activeTargetIds=Ce}Fs(t){this.activeTargetIds=this.activeTargetIds.add(t)}Ms(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Os(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class Hn{constructor(){this.yi=new Bn,this.pi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t){return this.yi.Fs(t),this.pi[t]||"not-current"}updateQueryState(t,e,n){this.pi[t]=e}removeLocalQueryTarget(t){this.yi.Ms(t)}isLocalQueryTarget(t){return this.yi.activeTargetIds.has(t)}clearQueryState(t){delete this.pi[t]}getAllActiveQueryTargets(){return this.yi.activeTargetIds}isActiveQueryTarget(t){return this.yi.activeTargetIds.has(t)}start(){return this.yi=new Bn,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(){}}class Kn{Ei(t){}shutdown(){}}class qn{constructor(){this.Ti=()=>this.Ii(),this.Ai=()=>this.Ri(),this.Pi=[],this.bi()}Ei(t){this.Pi.push(t)}shutdown(){window.removeEventListener("online",this.Ti),window.removeEventListener("offline",this.Ai)}bi(){window.addEventListener("online",this.Ti),window.addEventListener("offline",this.Ai)}Ii(){d("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.Pi)t(0)}Ri(){d("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.Pi)t(1)}static Pt(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const zn={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class $n{constructor(t){this.vi=t.vi,this.Vi=t.Vi}Si(t){this.Di=t}Ci(t){this.Ni=t}onMessage(t){this.xi=t}close(){this.Vi()}send(t){this.vi(t)}ki(){this.Di()}$i(t){this.Ni(t)}Oi(t){this.xi(t)}}class Gn extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http";this.Fi=e+"://"+t.host,this.Mi="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}Li(t,e,n,i){const r=this.Bi(t,e);d("RestConnection","Sending: ",r,n);const s={};return this.Ui(s,i),this.qi(t,r,s,n).then((t=>(d("RestConnection","Received: ",t),t)),(e=>{throw p("RestConnection",`${t} failed with error: `,e,"url: ",r,"request:",n),e}))}Ki(t,e,n,i){return this.Li(t,e,n,i)}Ui(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/"+u,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(const n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])}Bi(t,e){const n=zn[t];return`${this.Fi}/v1/${e}:${n}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams}qi(t,e,n,i){return new Promise(((r,s)=>{const o=new a.ZS;o.listenOnce(a.Bx.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case a.O4.NO_ERROR:const e=o.getResponseJson();d("Connection","XHR received:",JSON.stringify(e)),r(e);break;case a.O4.TIMEOUT:d("Connection",'RPC "'+t+'" timed out'),s(new b(w.DEADLINE_EXCEEDED,"Request time out"));break;case a.O4.HTTP_ERROR:const n=o.getStatus();if(d("Connection",'RPC "'+t+'" failed with status:',n,"response text:",o.getResponseText()),n>0){const t=o.getResponseJson().error;if(t&&t.status&&t.message){const e=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(w).indexOf(e)>=0?e:w.UNKNOWN}(t.status);s(new b(e,t.message))}else s(new b(w.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new b(w.UNAVAILABLE,"Connection failed."));break;default:m()}}finally{d("Connection",'RPC "'+t+'" completed.')}}));const c=JSON.stringify(i);o.send(e,"POST",c,n,15)}))}ji(t,e){const n=[this.Fi,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=(0,a.fF)(),r=(0,a.Ao)(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(s.xmlHttpFactory=new a._L({})),this.Ui(s.initMessageHeaders,e),(0,o.jZ)()||(0,o.lV)()||(0,o.b8)()||(0,o.lT)()||(0,o.n4)()||(0,o.sr)()||(s.httpHeadersOverwriteParam="$httpHeaders");const c=n.join("");d("Connection","Creating WebChannel: "+c,s);const u=i.createWebChannel(c,s);let l=!1,h=!1;const g=new $n({vi:t=>{h?d("Connection","Not sending because WebChannel is closed:",t):(l||(d("Connection","Opening WebChannel transport."),u.open(),l=!0),d("Connection","WebChannel sending:",t),u.send(t))},Vi:()=>u.close()}),v=(t,e,n)=>{t.listen(e,(t=>{try{n(t)}catch(t){setTimeout((()=>{throw t}),0)}}))};return v(u,a.iO.EventType.OPEN,(()=>{h||d("Connection","WebChannel transport opened.")})),v(u,a.iO.EventType.CLOSE,(()=>{h||(h=!0,d("Connection","WebChannel transport closed"),g.$i())})),v(u,a.iO.EventType.ERROR,(t=>{h||(h=!0,p("Connection","WebChannel transport errored:",t),g.$i(new b(w.UNAVAILABLE,"The operation could not be completed")))})),v(u,a.iO.EventType.MESSAGE,(t=>{var e;if(!h){const n=t.data[0];y(!!n);const i=n,r=i.error||(null===(e=i[0])||void 0===e?void 0:e.error);if(r){d("Connection","WebChannel received error:",r);const t=r.status;let e=function(t){const e=me[t];if(void 0!==e)return function(t){if(void 0===t)return f("GRPC error has no .code"),w.UNKNOWN;switch(t){case me.OK:return w.OK;case me.CANCELLED:return w.CANCELLED;case me.UNKNOWN:return w.UNKNOWN;case me.DEADLINE_EXCEEDED:return w.DEADLINE_EXCEEDED;case me.RESOURCE_EXHAUSTED:return w.RESOURCE_EXHAUSTED;case me.INTERNAL:return w.INTERNAL;case me.UNAVAILABLE:return w.UNAVAILABLE;case me.UNAUTHENTICATED:return w.UNAUTHENTICATED;case me.INVALID_ARGUMENT:return w.INVALID_ARGUMENT;case me.NOT_FOUND:return w.NOT_FOUND;case me.ALREADY_EXISTS:return w.ALREADY_EXISTS;case me.PERMISSION_DENIED:return w.PERMISSION_DENIED;case me.FAILED_PRECONDITION:return w.FAILED_PRECONDITION;case me.ABORTED:return w.ABORTED;case me.OUT_OF_RANGE:return w.OUT_OF_RANGE;case me.UNIMPLEMENTED:return w.UNIMPLEMENTED;case me.DATA_LOSS:return w.DATA_LOSS;default:return m()}}(e)}(t),n=r.message;void 0===e&&(e=w.INTERNAL,n="Unknown error status: "+t+" with message "+r.message),h=!0,g.$i(new b(e,n)),u.close()}else d("Connection","WebChannel received:",n),g.Oi(n)}})),v(r,a.Jh.STAT_EVENT,(t=>{t.stat===a.ro.PROXY?d("Connection","Detected buffering proxy"):t.stat===a.ro.NOPROXY&&d("Connection","Detected no buffering proxy")})),setTimeout((()=>{g.ki()}),0),g}}function Wn(){return"undefined"!=typeof document?document:null}function Xn(t){return new Oe(t,!0)}class Qn{constructor(t,e,n=1e3,i=1.5,r=6e4){this.Oe=t,this.timerId=e,this.Qi=n,this.Wi=i,this.Gi=r,this.zi=0,this.Hi=null,this.Ji=Date.now(),this.reset()}reset(){this.zi=0}Yi(){this.zi=this.Gi}Xi(t){this.cancel();const e=Math.floor(this.zi+this.Zi()),n=Math.max(0,Date.now()-this.Ji),i=Math.max(0,e-n);i>0&&d("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.zi} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.Hi=this.Oe.enqueueAfterDelay(this.timerId,i,(()=>(this.Ji=Date.now(),t()))),this.zi*=this.Wi,this.zi<this.Qi&&(this.zi=this.Qi),this.zi>this.Gi&&(this.zi=this.Gi)}tr(){null!==this.Hi&&(this.Hi.skipDelay(),this.Hi=null)}cancel(){null!==this.Hi&&(this.Hi.cancel(),this.Hi=null)}Zi(){return(Math.random()-.5)*this.zi}}class Jn{constructor(t,e,n,i,r,s){this.Oe=t,this.er=n,this.nr=i,this.credentialsProvider=r,this.listener=s,this.state=0,this.sr=0,this.ir=null,this.stream=null,this.rr=new Qn(t,e)}ar(){return 1===this.state||2===this.state||4===this.state}cr(){return 2===this.state}start(){3!==this.state?this.auth():this.ur()}async stop(){this.ar()&&await this.close(0)}hr(){this.state=0,this.rr.reset()}lr(){this.cr()&&null===this.ir&&(this.ir=this.Oe.enqueueAfterDelay(this.er,6e4,(()=>this.dr())))}wr(t){this._r(),this.stream.send(t)}async dr(){if(this.cr())return this.close(0)}_r(){this.ir&&(this.ir.cancel(),this.ir=null)}async close(t,e){this._r(),this.rr.cancel(),this.sr++,3!==t?this.rr.reset():e&&e.code===w.RESOURCE_EXHAUSTED?(f(e.toString()),f("Using maximum backoff delay to prevent overloading the backend."),this.rr.Yi()):e&&e.code===w.UNAUTHENTICATED&&this.credentialsProvider.invalidateToken(),null!==this.stream&&(this.mr(),this.stream.close(),this.stream=null),this.state=t,await this.listener.Ci(e)}mr(){}auth(){this.state=1;const t=this.gr(this.sr),e=this.sr;this.credentialsProvider.getToken().then((t=>{this.sr===e&&this.yr(t)}),(e=>{t((()=>{const t=new b(w.UNKNOWN,"Fetching auth token failed: "+e.message);return this.pr(t)}))}))}yr(t){const e=this.gr(this.sr);this.stream=this.Er(t),this.stream.Si((()=>{e((()=>(this.state=2,this.listener.Si())))})),this.stream.Ci((t=>{e((()=>this.pr(t)))})),this.stream.onMessage((t=>{e((()=>this.onMessage(t)))}))}ur(){this.state=4,this.rr.Xi((async()=>{this.state=0,this.start()}))}pr(t){return d("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(3,t)}gr(t){return e=>{this.Oe.enqueueAndForget((()=>this.sr===t?e():(d("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Yn extends Jn{constructor(t,e,n,i,r){super(t,"write_stream_connection_backoff","write_stream_idle",e,n,r),this.N=i,this.Rr=!1}get Pr(){return this.Rr}start(){this.Rr=!1,this.lastStreamToken=void 0,super.start()}mr(){this.Rr&&this.br([])}Er(t){return this.nr.ji("Write",t)}onMessage(t){if(y(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Rr){this.rr.reset();const e=function(t,e){return t&&t.length>0?(y(void 0!==e),t.map((t=>function(t,e){let n=t.updateTime?xe(t.updateTime):xe(e);return n.isEqual(P.min())&&(n=xe(e)),new te(n,t.transformResults||[])}(t,e)))):[]}(t.writeResults,t.commitTime),n=xe(t.commitTime);return this.listener.vr(n,e)}return y(!t.writeResults||0===t.writeResults.length),this.Rr=!0,this.listener.Vr()}Sr(){const t={};t.database=function(t){return new F(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}(this.N),this.wr(t)}br(t){const e={streamToken:this.lastStreamToken,writes:t.map((t=>function(t,e){let n;if(e instanceof ue)n={update:Ve(t,e.key,e.value)};else if(e instanceof pe)n={delete:Ue(t,e.key)};else if(e instanceof le)n={update:Ve(t,e.key,e.data),updateMask:$e(e.fieldMask)};else{if(!(e instanceof ge))return m();n={verify:Ue(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((t=>function(t,e){const n=e.transform;if(n instanceof zt)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof $t)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Wt)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Qt)return{fieldPath:e.field.canonicalString(),increment:n.C};throw m()}(0,t)))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Le(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:m()}(t,e.precondition)),n}(this.N,t)))};this.wr(e)}}class Zn extends class{}{constructor(t,e,n){super(),this.credentials=t,this.nr=e,this.N=n,this.Dr=!1}Cr(){if(this.Dr)throw new b(w.FAILED_PRECONDITION,"The client has already been terminated.")}Li(t,e,n){return this.Cr(),this.credentials.getToken().then((i=>this.nr.Li(t,e,n,i))).catch((t=>{throw"FirebaseError"===t.name?(t.code===w.UNAUTHENTICATED&&this.credentials.invalidateToken(),t):new b(w.UNKNOWN,t.toString())}))}Ki(t,e,n){return this.Cr(),this.credentials.getToken().then((i=>this.nr.Ki(t,e,n,i))).catch((t=>{throw"FirebaseError"===t.name?(t.code===w.UNAUTHENTICATED&&this.credentials.invalidateToken(),t):new b(w.UNKNOWN,t.toString())}))}terminate(){this.Dr=!0}}class ti{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.Nr=0,this.kr=null,this.$r=!0}Or(){0===this.Nr&&(this.Fr("Unknown"),this.kr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.kr=null,this.Mr("Backend didn't respond within 10 seconds."),this.Fr("Offline"),Promise.resolve()))))}Lr(t){"Online"===this.state?this.Fr("Unknown"):(this.Nr++,this.Nr>=1&&(this.Br(),this.Mr(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.Fr("Offline")))}set(t){this.Br(),this.Nr=0,"Online"===t&&(this.$r=!1),this.Fr(t)}Fr(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}Mr(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.$r?(f(e),this.$r=!1):d("OnlineStateTracker",e)}Br(){null!==this.kr&&(this.kr.cancel(),this.kr=null)}}class ei{constructor(t,e,n,i,r){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.Ur=[],this.qr=new Map,this.Kr=new Set,this.jr=[],this.Qr=r,this.Qr.Ei((t=>{n.enqueueAndForget((async()=>{ri(this)&&(d("RemoteStore","Restarting streams for network reachability change."),await async function(t){const e=v(t);e.Kr.add(4),await ii(e),e.Wr.set("Unknown"),e.Kr.delete(4),await ni(e)}(this))}))})),this.Wr=new ti(n,i)}}async function ni(t){if(ri(t))for(const e of t.jr)await e(!0)}async function ii(t){for(const e of t.jr)await e(!1)}function ri(t){return 0===v(t).Kr.size}async function si(t,e,n){if(!fn(e))throw e;t.Kr.add(1),await ii(t),t.Wr.set("Offline"),n||(n=()=>function(t){const e=v(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.ze.getLastRemoteSnapshotVersion(t)))}(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{d("RemoteStore","Retrying IndexedDB access"),await n(),t.Kr.delete(1),await ni(t)}))}function oi(t,e){return e().catch((n=>si(t,n,e)))}async function ai(t){const e=v(t),n=mi(e);let i=e.Ur.length>0?e.Ur[e.Ur.length-1].batchId:-1;for(;ci(e);)try{const t=await Cn(e.localStore,i);if(null===t){0===e.Ur.length&&n.lr();break}i=t.batchId,ui(e,t)}catch(t){await si(e,t)}li(e)&&hi(e)}function ci(t){return ri(t)&&t.Ur.length<10}function ui(t,e){t.Ur.push(e);const n=mi(t);n.cr()&&n.Pr&&n.br(e.mutations)}function li(t){return ri(t)&&!mi(t).ar()&&t.Ur.length>0}function hi(t){mi(t).start()}async function di(t){mi(t).Sr()}async function fi(t){const e=mi(t);for(const n of t.Ur)e.br(n.mutations)}async function pi(t,e,n){const i=t.Ur.shift(),r=gn.from(i,e,n);await oi(t,(()=>t.remoteSyncer.applySuccessfulWrite(r))),await ai(t)}async function gi(t,e){e&&mi(t).Pr&&await async function(t,e){if(function(t){switch(t){case w.OK:return m();case w.CANCELLED:case w.UNKNOWN:case w.DEADLINE_EXCEEDED:case w.RESOURCE_EXHAUSTED:case w.INTERNAL:case w.UNAVAILABLE:case w.UNAUTHENTICATED:return!1;case w.INVALID_ARGUMENT:case w.NOT_FOUND:case w.ALREADY_EXISTS:case w.PERMISSION_DENIED:case w.FAILED_PRECONDITION:case w.ABORTED:case w.OUT_OF_RANGE:case w.UNIMPLEMENTED:case w.DATA_LOSS:return!0;default:return m()}}(n=e.code)&&n!==w.ABORTED){const n=t.Ur.shift();mi(t).hr(),await oi(t,(()=>t.remoteSyncer.rejectFailedWrite(n.batchId,e))),await ai(t)}var n}(t,e),li(t)&&hi(t)}function mi(t){return t.Hr||(t.Hr=function(t,e,n){const i=v(t);return i.Cr(),new Yn(e,i.nr,i.credentials,i.N,n)}(t.datastore,t.asyncQueue,{Si:di.bind(null,t),Ci:gi.bind(null,t),Vr:fi.bind(null,t),vr:pi.bind(null,t)}),t.jr.push((async e=>{e?(t.Hr.hr(),await ai(t)):(await t.Hr.stop(),t.Ur.length>0&&(d("RemoteStore",`Stopping write stream with ${t.Ur.length} pending writes`),t.Ur=[]))}))),t.Hr}class yi{constructor(t,e,n,i,r){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=i,this.removalCallback=r,this.deferred=new _,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((t=>{}))}static createAndSchedule(t,e,n,i,r){const s=Date.now()+n,o=new yi(t,e,s,i,r);return o.start(n),o}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new b(w.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function vi(t,e){if(f("AsyncQueue",`${e}: ${t}`),fn(t))return new b(w.UNAVAILABLE,`${e}: ${t}`);throw t}class wi{constructor(){this.queries=new Tn((t=>Lt(t)),Pt),this.onlineState="Unknown",this.Zr=new Set}}class bi{constructor(t,e,n,i,r,s){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=s,this.No={},this.xo=new Tn((t=>Lt(t)),Pt),this.ko=new Map,this.$o=new Set,this.Oo=new ve(Q.comparator),this.Fo=new Map,this.Mo=new Dn,this.Lo={},this.Bo=new Map,this.Uo=_n.ie(),this.onlineState="Unknown",this.qo=void 0}get isPrimaryClient(){return!0===this.qo}}function _i(t,e,n){const i=v(t);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const t=[];i.xo.forEach(((n,i)=>{const r=i.view.eo(e);r.snapshot&&t.push(r.snapshot)})),function(t,e){const n=v(t);n.onlineState=e;let i=!1;n.queries.forEach(((t,n)=>{for(const t of n.listeners)t.eo(e)&&(i=!0)})),i&&function(t){t.Zr.forEach((t=>{t.next()}))}(n)}(i.eventManager,e),t.length&&i.No.Tr(t),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function Ii(t,e){const n=v(t),i=e.batch.batchId;try{const t=await function(t,e){const n=v(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(t=>{const i=e.batch.keys(),r=n.jn.newChangeBuffer({trackRemovals:!0});return function(t,e,n,i){const r=n.batch,s=r.keys();let o=dn.resolve();return s.forEach((t=>{o=o.next((()=>i.getEntry(e,t))).next((e=>{const s=n.docVersions.get(t);y(null!==s),e.version.compareTo(s)<0&&(r.applyToRemoteDocument(e,n),e.isValidDocument()&&i.addEntry(e,n.commitVersion))}))})),o.next((()=>t.In.removeMutationBatch(e,r)))}(n,t,e,r).next((()=>r.apply(t))).next((()=>n.In.performConsistencyCheck(t))).next((()=>n.Qn.bn(t,i)))}))}(n.localStore,e);Si(n,i,null),Ei(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await Ai(n,t)}catch(t){await In(t)}}async function Ti(t,e,n){const i=v(t);try{const t=await function(t,e){const n=v(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(t=>{let i;return n.In.lookupMutationBatch(t,e).next((e=>(y(null!==e),i=e.keys(),n.In.removeMutationBatch(t,e)))).next((()=>n.In.performConsistencyCheck(t))).next((()=>n.Qn.bn(t,i)))}))}(i.localStore,e);Si(i,e,n),Ei(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await Ai(i,t)}catch(n){await In(n)}}function Ei(t,e){(t.Bo.get(e)||[]).forEach((t=>{t.resolve()})),t.Bo.delete(e)}function Si(t,e,n){const i=v(t);let r=i.Lo[i.currentUser.toKey()];if(r){const t=r.get(e);t&&(n?t.reject(n):t.resolve(),r=r.remove(e)),i.Lo[i.currentUser.toKey()]=r}}async function Ai(t,e,n){const i=v(t),r=[],s=[],o=[];i.xo.isEmpty()||(i.xo.forEach(((t,a)=>{o.push(i.Ko(a,e,n).then((t=>{if(t){i.isPrimaryClient&&i.sharedClientState.updateQueryState(a.targetId,t.fromCache?"not-current":"current"),r.push(t);const e=An.kn(a.targetId,t);s.push(e)}})))})),await Promise.all(o),i.No.Tr(r),await async function(t,e){const n=v(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(t=>dn.forEach(e,(e=>dn.forEach(e.Nn,(i=>n.persistence.referenceDelegate.addReference(t,e.targetId,i))).next((()=>dn.forEach(e.xn,(i=>n.persistence.referenceDelegate.removeReference(t,e.targetId,i)))))))))}catch(t){if(!fn(t))throw t;d("LocalStore","Failed to update sequence numbers: "+t)}for(const t of e){const e=t.targetId;if(!t.fromCache){const t=n.Un.get(e),i=t.snapshotVersion,r=t.withLastLimboFreeSnapshotVersion(i);n.Un=n.Un.insert(e,r)}}}(i.localStore,s))}async function ki(t,e){const n=v(t);if(!n.currentUser.isEqual(e)){d("SyncEngine","User change. New user:",e.toKey());const t=await Nn(n.localStore,e);n.currentUser=e,function(t){t.Bo.forEach((t=>{t.forEach((t=>{t.reject(new b(w.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Bo.clear()}(n),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await Ai(n,t.Wn)}}function Ri(t){const e=v(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Ii.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Ti.bind(null,e),e}class Ni{constructor(){this.synchronizeTabs=!1}async initialize(t){this.N=Xn(t.databaseInfo.databaseId),this.sharedClientState=this.Wo(t),this.persistence=this.Go(t),await this.persistence.start(),this.gcScheduler=this.zo(t),this.localStore=this.Ho(t)}zo(t){return null}Ho(t){return function(t,e,n,i){return new Rn(t,e,n,i)}(this.persistence,new kn,t.initialUser,this.N)}Go(t){return new Fn(jn.Ns,this.N)}Wo(t){return new Hn}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Ci{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>_i(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=ki.bind(null,this.syncEngine),await async function(t,e){const n=v(t);e?(n.Kr.delete(2),await ni(n)):e||(n.Kr.add(2),await ii(n),n.Wr.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new wi}createDatastore(t){const e=Xn(t.databaseInfo.databaseId),n=(i=t.databaseInfo,new Gn(i));var i;return function(t,e,n){return new Zn(t,e,n)}(t.credentials,n,e)}createRemoteStore(t){return e=this.localStore,n=this.datastore,i=t.asyncQueue,r=t=>_i(this.syncEngine,t,0),s=qn.Pt()?new qn:new Kn,new ei(e,n,i,r,s);var e,n,i,r,s}createSyncEngine(t,e){return function(t,e,n,i,r,s,o){const a=new bi(t,e,n,i,r,s);return o&&(a.qo=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}terminate(){return async function(t){const e=v(t);d("RemoteStore","RemoteStore shutting down."),e.Kr.add(5),await ii(e),e.Qr.shutdown(),e.Wr.set("Unknown")}(this.remoteStore)}}class Oi{constructor(t,e,n){this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=c.UNAUTHENTICATED,this.clientId=N.I(),this.credentialListener=()=>Promise.resolve(),this.credentials.start(e,(async t=>{d("FirestoreClient","Received user=",t.uid),await this.credentialListener(t),this.user=t}))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.credentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new b(w.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new _;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.credentials.shutdown(),t.resolve()}catch(e){const n=vi(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function Di(t,e){t.asyncQueue.verifyOperationInProgress();const n=await async function(t){return t.offlineComponents||(d("FirestoreClient","Using default OfflineComponentProvider"),await async function(t,e){t.asyncQueue.verifyOperationInProgress(),d("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener((async t=>{i.isEqual(t)||(await Nn(e.localStore,t),i=t)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t.offlineComponents=e}(t,new Ni)),t.offlineComponents}(t);d("FirestoreClient","Initializing OnlineComponentProvider");const i=await t.getConfiguration();await e.initialize(n,i),t.setCredentialChangeListener((t=>async function(t,e){const n=v(t);n.asyncQueue.verifyOperationInProgress(),d("RemoteStore","RemoteStore received new credentials");const i=ri(n);n.Kr.add(3),await ii(n),i&&n.Wr.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Kr.delete(3),await ni(n)}(e.remoteStore,t))),t.onlineComponents=e}function Pi(t){return async function(t){return t.onlineComponents||(d("FirestoreClient","Using default OnlineComponentProvider"),await Di(t,new Ci)),t.onlineComponents}(t).then((t=>t.syncEngine))}class Li{constructor(t,e,n,i,r,s,o,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=i,this.ssl=r,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.useFetchStreams=a}}class xi{constructor(t,e){this.projectId=t,this.database=e||"(default)"}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof xi&&t.projectId===this.projectId&&t.database===this.database}}const Mi=new Map;function Ui(t){if(!Q.isDocumentKey(t))throw new b(w.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Fi(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){if(t.constructor){const e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":m()}function Vi(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new b(w.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Fi(t);throw new b(w.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}class ji{constructor(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new b(w.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new b(w.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,function(t,e,n,i){if(!0===e&&!0===i)throw new b(w.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling)}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Bi{constructor(t,e){this._credentials=e,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ji({}),this._settingsFrozen=!1,t instanceof xi?this._databaseId=t:(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new b(w.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new xi(t.options.projectId)}(t))}get app(){if(!this._app)throw new b(w.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new b(w.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ji(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new T;switch(t.type){case"gapi":const e=t.client;return y(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new A(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new b(w.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=Mi.get(t);e&&(d("ComponentProvider","Removing Datastore"),Mi.delete(t),e.terminate())}(this),Promise.resolve()}}class Hi{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new qi(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Hi(this.firestore,t,this._key)}}class Ki{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new Ki(this.firestore,t,this._query)}}class qi extends Ki{constructor(t,e,n){super(t,e,function(t){return new Ct(t)}(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Hi(this.firestore,null,new Q(t))}withConverter(t){return new qi(this.firestore,t,this._path)}}function zi(t,e,...n){if(t=(0,o.Ku)(t),1===arguments.length&&(e=N.I()),function(t,e,n){if(!n)throw new b(w.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}("doc","path",e),t instanceof Bi){const i=F.fromString(e,...n);return Ui(i),new Hi(t,null,new Q(i))}{if(!(t instanceof Hi||t instanceof qi))throw new b(w.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(F.fromString(e,...n));return Ui(i),new Hi(t.firestore,t instanceof qi?t.converter:null,new Q(i))}}class $i{constructor(){this.fa=Promise.resolve(),this.da=[],this.wa=!1,this._a=[],this.ma=null,this.ga=!1,this.ya=!1,this.pa=[],this.rr=new Qn(this,"async_queue_retry"),this.Ea=()=>{const t=Wn();t&&d("AsyncQueue","Visibility state changed to "+t.visibilityState),this.rr.tr()};const t=Wn();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Ea)}get isShuttingDown(){return this.wa}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.Ta(),this.Ia(t)}enterRestrictedMode(t){if(!this.wa){this.wa=!0,this.ya=t||!1;const e=Wn();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Ea)}}enqueue(t){if(this.Ta(),this.wa)return new Promise((()=>{}));const e=new _;return this.Ia((()=>this.wa&&this.ya?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.da.push(t),this.Aa())))}async Aa(){if(0!==this.da.length){try{await this.da[0](),this.da.shift(),this.rr.reset()}catch(t){if(!fn(t))throw t;d("AsyncQueue","Operation failed with retryable error: "+t)}this.da.length>0&&this.rr.Xi((()=>this.Aa()))}}Ia(t){const e=this.fa.then((()=>(this.ga=!0,t().catch((t=>{throw this.ma=t,this.ga=!1,f("INTERNAL UNHANDLED ERROR: ",function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((t=>(this.ga=!1,t))))));return this.fa=e,e}enqueueAfterDelay(t,e,n){this.Ta(),this.pa.indexOf(t)>-1&&(e=0);const i=yi.createAndSchedule(this,t,e,n,(t=>this.Ra(t)));return this._a.push(i),i}Ta(){this.ma&&m()}verifyOperationInProgress(){}async Pa(){let t;do{t=this.fa,await t}while(t!==this.fa)}ba(t){for(const e of this._a)if(e.timerId===t)return!0;return!1}va(t){return this.Pa().then((()=>{this._a.sort(((t,e)=>t.targetTimeMs-e.targetTimeMs));for(const e of this._a)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.Pa()}))}Va(t){this.pa.push(t)}Ra(t){const e=this._a.indexOf(t);this._a.splice(e,1)}}class Gi extends Bi{constructor(t,e){super(t,e),this.type="firestore",this._queue=new $i,this._persistenceKey="name"in t?t.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||Xi(this),this._firestoreClient.terminate()}}function Wi(t=(0,i.Sx)()){return(0,i.j6)(t,"firestore").getImmediate()}function Xi(t){var e;const n=t._freezeSettings(),i=function(t,e,n,i){return new Li(t,e,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,i.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new Oi(t._credentials,t._queue,i)}class Qi{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new b(w.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new j(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class Ji{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Ji(H.fromBase64String(t))}catch(t){throw new b(w.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new Ji(H.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class Yi{constructor(t){this._methodName=t}}class Zi{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new b(w.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new b(w.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return C(this._lat,t._lat)||C(this._long,t._long)}}const tr=/^__.*__$/;class er{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return new le(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function nr(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw m()}}class ir{constructor(t,e,n,i,r,s){this.settings=t,this.databaseId=e,this.N=n,this.ignoreUndefinedProperties=i,void 0===r&&this.Sa(),this.fieldTransforms=r||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Da(){return this.settings.Da}Ca(t){return new ir(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.N,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Na(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Ca({path:n,xa:!1});return i.ka(t),i}$a(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Ca({path:n,xa:!1});return i.Sa(),i}Oa(t){return this.Ca({path:void 0,xa:!0})}Fa(t){return fr(t,this.settings.methodName,this.settings.Ma||!1,this.path,this.settings.La)}contains(t){return void 0!==this.fieldMask.find((e=>t.isPrefixOf(e)))||void 0!==this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))}Sa(){if(this.path)for(let t=0;t<this.path.length;t++)this.ka(this.path.get(t))}ka(t){if(0===t.length)throw this.Fa("Document fields must not be empty");if(nr(this.Da)&&tr.test(t))throw this.Fa('Document fields cannot begin and end with "__"')}}class rr{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.N=n||Xn(t)}Ba(t,e,n,i=!1){return new ir({Da:t,methodName:e,La:n,path:j.emptyPath(),xa:!1,Ma:i},this.databaseId,this.N,this.ignoreUndefinedProperties)}}class sr extends Yi{_toFieldTransform(t){if(2!==t.Da)throw 1===t.Da?t.Fa(`${this._methodName}() can only appear at the top level of your update data`):t.Fa(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof sr}}class or extends Yi{_toFieldTransform(t){return new Zt(t.path,new zt)}isEqual(t){return t instanceof or}}function ar(t,e){if(cr(t=(0,o.Ku)(t)))return ur("Unsupported field value:",e,t),function(t,e){const n={};return M(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):x(t,((t,i)=>{const r=ar(i,e.Na(t));null!=r&&(n[t]=r)})),{mapValue:{fields:n}}}(t,e);if(t instanceof Yi)return function(t,e){if(!nr(e.Da))throw e.Fa(`${t._methodName}() can only be used with update() and set()`);if(!e.path)throw e.Fa(`${t._methodName}() is not currently supported inside arrays`);const n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xa&&4!==e.Da)throw e.Fa("Nested arrays are not supported");return function(t,e){const n=[];let i=0;for(const r of t){let t=ar(r,e.Oa(i));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),i++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=(0,o.Ku)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return jt(e.N,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=D.fromDate(t);return{timestampValue:De(e.N,n)}}if(t instanceof D){const n=new D(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:De(e.N,n)}}if(t instanceof Zi)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Ji)return{bytesValue:Pe(e.N,t._byteString)};if(t instanceof Hi){const n=e.databaseId,i=t.firestore._databaseId;if(!i.isEqual(n))throw e.Fa(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Me(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Fa(`Unsupported field value: ${Fi(t)}`)}(t,e)}function cr(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof D||t instanceof Zi||t instanceof Ji||t instanceof Hi||t instanceof Yi)}function ur(t,e,n){if(!cr(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){const i=Fi(n);throw"an object"===i?e.Fa(t+" a custom object"):e.Fa(t+" "+i)}}function lr(t,e,n){if((e=(0,o.Ku)(e))instanceof Qi)return e._internalPath;if("string"==typeof e)return dr(t,e);throw fr("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}const hr=new RegExp("[~\\*/\\[\\]]");function dr(t,e,n){if(e.search(hr)>=0)throw fr(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Qi(...e.split("."))._internalPath}catch(i){throw fr(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function fr(t,e,n,i,r){const s=i&&!i.isEmpty(),o=void 0!==r;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${i}`),o&&(c+=` in document ${r}`),c+=")"),new b(w.INVALID_ARGUMENT,a+t+c)}function pr(t,e){return t.some((t=>t.isEqual(e)))}function gr(t,e,n,...i){t=Vi(t,Hi);const r=Vi(t.firestore,Gi),s=function(t){const e=t._freezeSettings(),n=Xn(t._databaseId);return new rr(t._databaseId,!!e.ignoreUndefinedProperties,n)}(r);let a;return a="string"==typeof(e=(0,o.Ku)(e))||e instanceof Qi?function(t,e,n,i,r,s){const a=t.Ba(1,e,n),c=[lr(e,i,n)],u=[r];if(s.length%2!=0)throw new b(w.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let t=0;t<s.length;t+=2)c.push(lr(e,s[t])),u.push(s[t+1]);const l=[],h=ct.empty();for(let t=c.length-1;t>=0;--t)if(!pr(l,c[t])){const e=c[t];let n=u[t];n=(0,o.Ku)(n);const i=a.$a(e);if(n instanceof sr)l.push(e);else{const t=ar(n,i);null!=t&&(l.push(e),h.set(e,t))}}const d=new B(l);return new er(h,d,a.fieldTransforms)}(s,"updateDoc",t._key,e,n,i):function(t,e,n,i){const r=t.Ba(1,e,n);ur("Data must be an object, but it was:",r,i);const s=[],a=ct.empty();x(i,((t,i)=>{const c=dr(e,t,n);i=(0,o.Ku)(i);const u=r.$a(c);if(i instanceof sr)s.push(c);else{const t=ar(i,u);null!=t&&(s.push(c),a.set(c,t))}}));const c=new B(s);return new er(a,c,r.fieldTransforms)}(s,"updateDoc",t._key,e),function(t,e){return function(t,e){const n=new _;return t.asyncQueue.enqueueAndForget((async()=>async function(t,e,n){const i=Ri(t);try{const t=await function(t,e){const n=v(t),i=D.now(),r=e.reduce(((t,e)=>t.add(e.key)),Ne());let s;return n.persistence.runTransaction("Locally write mutations","readwrite",(t=>n.Qn.bn(t,r).next((r=>{s=r;const o=[];for(const t of e){const e=oe(t,s.get(t.key));null!=e&&o.push(new le(t.key,e,ut(e.value.mapValue),ee.exists(!0)))}return n.In.addMutationBatch(t,i,o,e)})))).then((t=>(t.applyToLocalDocumentSet(s),{batchId:t.batchId,changes:s})))}(i.localStore,e);i.sharedClientState.addPendingMutation(t.batchId),function(t,e,n){let i=t.Lo[t.currentUser.toKey()];i||(i=new ve(C)),i=i.insert(e,n),t.Lo[t.currentUser.toKey()]=i}(i,t.batchId,n),await Ai(i,t.changes),await ai(i.remoteStore)}catch(t){const e=vi(t,"Failed to persist write");n.reject(e)}}(await Pi(t),e,n))),n.promise}(function(t){return t._firestoreClient||Xi(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}(t),e)}(r,[a.toMutation(t._key,ee.exists(!0))])}function mr(){return new or("serverTimestamp")}var yr;yr=i.MF,u=yr,(0,i.om)(new r.uA("firestore",((t,{options:e})=>{const n=t.getProvider("app").getImmediate(),i=new Gi(n,new E(t.getProvider("auth-internal")));return e=Object.assign({useFetchStreams:!0},e),i._setSettings(e),i}),"PUBLIC")),(0,i.KO)("@firebase/firestore","3.0.1",void 0)},923:(t,e,n)=>{n.d(e,{IG:()=>u,db:()=>c});var i=n(944),r=n(237),s=n(982),o=n(226);const a=(0,i.Wp)({apiKey:"AIzaSyDEbX-gQ6FwJD5oZGnaoiJu9qIaAG2LZ0M",authDomain:"upload-25f01.firebaseapp.com",projectId:"upload-25f01",storageBucket:"upload-25f01.firebasestorage.app",messagingSenderId:"97167487690",appId:"1:97167487690:web:88409aded0a1dd13f87a33",measurementId:"G-3Y94K1XCBK"}),c=((0,r.xI)(a),(0,s.aU)(a)),u=(0,o.c7)(a)},944:(t,e,n)=>{n.d(e,{Wp:()=>i.Wp});var i=n(468);(0,i.KO)("firebase","9.0.1","app")},982:(t,e,n)=>{n.d(e,{H9:()=>i.H9,O5:()=>i.O5,aU:()=>i.aU,mZ:()=>i.mZ});var i=n(790)}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var s=e[i]={exports:{}};return t[i](s,s.exports,n),s.exports}n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var i=n(923),r=n(226),s=n(982),o=n(106);window.onload=function(){const t=JSON.parse(sessionStorage.getItem("userData"));if(!t||!t.phone)return alert("User session expired. Please log in again."),void(window.location.href="index.html");const e=localStorage.getItem("documentToBeEdited");e?function(t){document.getElementById("edit-document-page-container").innerHTML=` \n    <div class="container">\n        <div class="row m-3">\n            <div class="col-12 row mb-5 align-items-center justify-content-center">\n                <div id="edit-document-form-wrapper" class="col-lg-7 col-md-10 col-12 my-3 p-md-5 p-3 border border-2 rounded shadow">\n                    <h2 class="text-center mb-4">Edit Document</h2>\n                    <form action="" id="edit-document-page-form">\n                        \x3c!-- Document Name --\x3e\n                        <div class="mb-4">\n                            <label for="edit-document-page-document-name" class="form-label">Enter name of the document</label>\n                            <input type="text" class="form-control" id="edit-document-page-document-name" value="${t.documentName}">\n                        </div>\n\n                        \x3c!-- Document Type --\x3e\n                        <div class="mb-4">\n                            <label for="edit-document-page-type-of-document" class="form-label">Select the type of the document</label>\n                            <select class="form-select" id="edit-document-page-type-of-document">\n                                <option selected>Select the type of document</option>\n                                <option value="1">Aadhaar card</option>\n                                <option value="2">Arms license</option>\n                                <option value="3">Bank passbook</option>\n                                <option value="4">Bank statements</option>\n                                <option value="5">Birth certificate</option>\n                                <option value="6">Domicile certificate issued by government</option>\n                                <option value="7">Driving License</option>\n                                <option value="8">Educational certificate</option>\n                                <option value="9">Electors photo identity card</option>\n                                <option value="10">Electricity bill</option>\n                                <option value="11">Gazetted officer issued documents</option>\n                                <option value="12">Gas connection details</option>\n                                <option value="13">Letter from employer</option>\n                                <option value="14">Marriage certificate</option>\n                                <option value="15">MNREGA Job card</option>\n                                <option value="16">PAN card</option>\n                                <option value="17">Passport</option>\n                                <option value="18">Pension card</option>\n                                <option value="19">Photo credit card</option>\n                                <option value="20">Rent agreement</option>\n                                <option value="21">Ration card</option>\n                                <option value="22">Tax card</option>\n                                <option value="23">Telephone bill</option>\n                                <option value="24">Voter ID</option>\n                            </select>\n                        </div>\n\n                        \x3c!-- File Upload --\x3e\n                        <div class="mb-4">\n                            ${t.fileUrl?`<p>Already uploaded: <a href="${t.fileUrl}" target="_blank">${t.documentName}</a></p>`:""}\n                            <label for="edit-document-page-document-upload" class="form-label">Upload your new document</label>\n                            <input type="file" class="form-control" id="edit-document-page-document-upload" name="document" accept="application/pdf, image/*">\n                        </div>\n\n                        \x3c!-- Submit Button --\x3e\n                        <div class="d-grid">\n                            <button id="edit-document-page-submit-button" type="submit" class="btn btn-primary btn-lg">\n                                Submit\n                            </button>\n                        </div>\n                    </form>\n                </div>\n            </div>\n        </div>\n    </div>`;const e=document.getElementById("edit-document-page-type-of-document"),n=e.options,o=document.getElementById("edit-document-page-form");for(let i=0;i<n.length;i++)if(n[i].text===t.documentType){e.selectedIndex=i;break}o.addEventListener("submit",(async function(t){t.preventDefault();const e=localStorage.getItem("editDoc");if(!e)return void alert("No document to edit.");const n=document.getElementById("edit-document-page-document-name").value,o=document.getElementById("edit-document-page-type-of-document"),a=o.options[o.selectedIndex].text,c=JSON.parse(e);let u=c.fileUrl;const l=document.getElementById("edit-document-page-document-upload");var h;if(l.files.length){if((h=l.files[0]).size>2097152)return void alert("File size must be less than 2MB.");const t=(0,r.KR)(i.IG,`documents/${h.name}_${Date.now()}`);await(0,r.D)(t,h),u=await(0,r.qk)(t)}const d=(0,s.H9)(i.db,"documents",c.id);await(0,s.mZ)(d,{documentName:n,documentType:a,fileName:h?h.name:c.fileName,fileType:h?h.type:c.fileType,fileSize:h?h.size:c.fileSize,fileUrl:u,updatedAt:(0,s.O5)()}),alert("Document updated successfully!"),window.location.href="view_documents_page.html"}))}(JSON.parse(e)):alert("No document found to edit!")},document.addEventListener("DOMContentLoaded",(()=>{(0,o.S)()}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixNQUFNLGtDQUNOL21GLE9BQU9vWixTQUFTOEwsS0FBTywwQkFDM0IsR0FFSixDQTdJUW9qRSxDQURZbCtFLEtBQUs0QyxNQUFNZzZFLElBR3ZCRCxNQUFNLDZCQUVkLEVBRUFuaUYsU0FBU2EsaUJBQWlCLG9CQUFvQixNQUMxQyxRQUFvQiIsInNvdXJjZXMiOlsid2VicGFjazovL3NlY3VyZS1kb2N1bWVudC11cGxvYWQvLi9ub2RlX21vZHVsZXMvQGZpcmViYXNlL3dlYmNoYW5uZWwtd3JhcHBlci9kaXN0L2luZGV4LmVzbS5qcyIsIndlYnBhY2s6Ly9zZWN1cmUtZG9jdW1lbnQtdXBsb2FkLy4vc3JjL2pzL25hdmJhci5qcyIsIndlYnBhY2s6Ly9zZWN1cmUtZG9jdW1lbnQtdXBsb2FkLy4vbm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9jb21wb25lbnQvZGlzdC9pbmRleC5lc20uanMiLCJ3ZWJwYWNrOi8vc2VjdXJlLWRvY3VtZW50LXVwbG9hZC8uL25vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9kaXN0L2VzbTIwMTcvaW5kZXgtOWZmMGZhOWMuanMiLCJ3ZWJwYWNrOi8vc2VjdXJlLWRvY3VtZW50LXVwbG9hZC8uL25vZGVfbW9kdWxlcy9AZmlyZWJhc2Uvc3RvcmFnZS9kaXN0L2luZGV4LmVzbTIwMTcuanMiLCJ3ZWJwYWNrOi8vc2VjdXJlLWRvY3VtZW50LXVwbG9hZC8uL25vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXBwL2Rpc3QvaW5kZXguZXNtMjAxNy5qcyIsIndlYnBhY2s6Ly9zZWN1cmUtZG9jdW1lbnQtdXBsb2FkLy4vbm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9sb2dnZXIvZGlzdC9pbmRleC5lc20uanMiLCJ3ZWJwYWNrOi8vc2VjdXJlLWRvY3VtZW50LXVwbG9hZC8uL25vZGVfbW9kdWxlcy9AZmlyZWJhc2UvdXRpbC9kaXN0L2luZGV4LmVzbS5qcyIsIndlYnBhY2s6Ly9zZWN1cmUtZG9jdW1lbnQtdXBsb2FkLy4vbm9kZV9tb2R1bGVzL3RzbGliL3RzbGliLmVzNi5tanMiLCJ3ZWJwYWNrOi8vc2VjdXJlLWRvY3VtZW50LXVwbG9hZC8uL25vZGVfbW9kdWxlcy9AZmlyZWJhc2UvZmlyZXN0b3JlL2Rpc3QvaW5kZXguZXNtMjAxNy5qcyIsIndlYnBhY2s6Ly9zZWN1cmUtZG9jdW1lbnQtdXBsb2FkLy4vc3JjL2pzL3NldHVwLmpzIiwid2VicGFjazovL3NlY3VyZS1kb2N1bWVudC11cGxvYWQvLi9ub2RlX21vZHVsZXMvZmlyZWJhc2UvYXBwL2Rpc3QvaW5kZXguZXNtLmpzIiwid2VicGFjazovL3NlY3VyZS1kb2N1bWVudC11cGxvYWQvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vc2VjdXJlLWRvY3VtZW50LXVwbG9hZC93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vc2VjdXJlLWRvY3VtZW50LXVwbG9hZC93ZWJwYWNrL3J1bnRpbWUvZ2xvYmFsIiwid2VicGFjazovL3NlY3VyZS1kb2N1bWVudC11cGxvYWQvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9zZWN1cmUtZG9jdW1lbnQtdXBsb2FkLy4vc3JjL2pzL2VkaXRfZG9jdW1lbnRfcGFnZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uXHJcblxyXG5QZXJtaXNzaW9uIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBhbmQvb3IgZGlzdHJpYnV0ZSB0aGlzIHNvZnR3YXJlIGZvciBhbnlcclxucHVycG9zZSB3aXRoIG9yIHdpdGhvdXQgZmVlIGlzIGhlcmVieSBncmFudGVkLlxyXG5cclxuVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiBBTkQgVEhFIEFVVEhPUiBESVNDTEFJTVMgQUxMIFdBUlJBTlRJRVMgV0lUSFxyXG5SRUdBUkQgVE8gVEhJUyBTT0ZUV0FSRSBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFlcclxuQU5EIEZJVE5FU1MuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1IgQkUgTElBQkxFIEZPUiBBTlkgU1BFQ0lBTCwgRElSRUNULFxyXG5JTkRJUkVDVCwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTIE9SIEFOWSBEQU1BR0VTIFdIQVRTT0VWRVIgUkVTVUxUSU5HIEZST01cclxuTE9TUyBPRiBVU0UsIERBVEEgT1IgUFJPRklUUywgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIE5FR0xJR0VOQ0UgT1JcclxuT1RIRVIgVE9SVElPVVMgQUNUSU9OLCBBUklTSU5HIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUlxyXG5QRVJGT1JNQU5DRSBPRiBUSElTIFNPRlRXQVJFLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG4vKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSAqL1xyXG5cclxudmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbihkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XHJcbiAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxufTtcclxuXHJcbmZ1bmN0aW9uIF9fZXh0ZW5kcyhkLCBiKSB7XHJcbiAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxyXG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcclxuICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxufVxyXG5cclxuZnVuY3Rpb24gX192YWx1ZXMobykge1xyXG4gICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDtcclxuICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pO1xyXG4gICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSBcIm51bWJlclwiKSByZXR1cm4ge1xyXG4gICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDtcclxuICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyBcIk9iamVjdCBpcyBub3QgaXRlcmFibGUuXCIgOiBcIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbn1cblxudmFyIGNvbW1vbmpzR2xvYmFsID0gdHlwZW9mIGdsb2JhbFRoaXMgIT09ICd1bmRlZmluZWQnID8gZ2xvYmFsVGhpcyA6IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnID8gd2luZG93IDogdHlwZW9mIGdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcgPyBnbG9iYWwgOiB0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcgPyBzZWxmIDoge307XG5cbnZhciBrLCBnb29nID0gZ29vZyB8fCB7fSwgbCA9IGNvbW1vbmpzR2xvYmFsIHx8IHNlbGY7XHJcbmZ1bmN0aW9uIGFhKCkgeyB9XHJcbmZ1bmN0aW9uIGJhKGEpIHsgdmFyIGIgPSB0eXBlb2YgYTsgYiA9IFwib2JqZWN0XCIgIT0gYiA/IGIgOiBhID8gQXJyYXkuaXNBcnJheShhKSA/IFwiYXJyYXlcIiA6IGIgOiBcIm51bGxcIjsgcmV0dXJuIFwiYXJyYXlcIiA9PSBiIHx8IFwib2JqZWN0XCIgPT0gYiAmJiBcIm51bWJlclwiID09IHR5cGVvZiBhLmxlbmd0aDsgfVxyXG5mdW5jdGlvbiBwKGEpIHsgdmFyIGIgPSB0eXBlb2YgYTsgcmV0dXJuIFwib2JqZWN0XCIgPT0gYiAmJiBudWxsICE9IGEgfHwgXCJmdW5jdGlvblwiID09IGI7IH1cclxuZnVuY3Rpb24gZGEoYSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGEsIGVhKSAmJiBhW2VhXSB8fCAoYVtlYV0gPSArK2ZhKTsgfVxyXG52YXIgZWEgPSBcImNsb3N1cmVfdWlkX1wiICsgKDFFOSAqIE1hdGgucmFuZG9tKCkgPj4+IDApLCBmYSA9IDA7XHJcbmZ1bmN0aW9uIGhhKGEsIGIsIGMpIHsgcmV0dXJuIGEuY2FsbC5hcHBseShhLmJpbmQsIGFyZ3VtZW50cyk7IH1cclxuZnVuY3Rpb24gaWEoYSwgYiwgYykgeyBpZiAoIWEpXHJcbiAgICB0aHJvdyBFcnJvcigpOyBpZiAoMiA8IGFyZ3VtZW50cy5sZW5ndGgpIHtcclxuICAgIHZhciBkID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKTtcclxuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7IHZhciBlID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKTsgQXJyYXkucHJvdG90eXBlLnVuc2hpZnQuYXBwbHkoZSwgZCk7IHJldHVybiBhLmFwcGx5KGIsIGUpOyB9O1xyXG59IHJldHVybiBmdW5jdGlvbiAoKSB7IHJldHVybiBhLmFwcGx5KGIsIGFyZ3VtZW50cyk7IH07IH1cclxuZnVuY3Rpb24gcShhLCBiLCBjKSB7IEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kICYmIC0xICE9IEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kLnRvU3RyaW5nKCkuaW5kZXhPZihcIm5hdGl2ZSBjb2RlXCIpID8gcSA9IGhhIDogcSA9IGlhOyByZXR1cm4gcS5hcHBseShudWxsLCBhcmd1bWVudHMpOyB9XHJcbmZ1bmN0aW9uIGphKGEsIGIpIHsgdmFyIGMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpOyByZXR1cm4gZnVuY3Rpb24gKCkgeyB2YXIgZCA9IGMuc2xpY2UoKTsgZC5wdXNoLmFwcGx5KGQsIGFyZ3VtZW50cyk7IHJldHVybiBhLmFwcGx5KHRoaXMsIGQpOyB9OyB9XHJcbmZ1bmN0aW9uIHQoYSwgYikgeyBmdW5jdGlvbiBjKCkgeyB9IGMucHJvdG90eXBlID0gYi5wcm90b3R5cGU7IGEuWiA9IGIucHJvdG90eXBlOyBhLnByb3RvdHlwZSA9IG5ldyBjOyBhLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IGE7IGEuVmIgPSBmdW5jdGlvbiAoZCwgZSwgZikgeyBmb3IgKHZhciBoID0gQXJyYXkoYXJndW1lbnRzLmxlbmd0aCAtIDIpLCBuID0gMjsgbiA8IGFyZ3VtZW50cy5sZW5ndGg7IG4rKylcclxuICAgIGhbbiAtIDJdID0gYXJndW1lbnRzW25dOyByZXR1cm4gYi5wcm90b3R5cGVbZV0uYXBwbHkoZCwgaCk7IH07IH1cclxuZnVuY3Rpb24gdigpIHsgdGhpcy5zID0gdGhpcy5zOyB0aGlzLm8gPSB0aGlzLm87IH1cclxudmFyIGthID0gMCwgbGEgPSB7fTtcclxudi5wcm90b3R5cGUucyA9ICExO1xyXG52LnByb3RvdHlwZS5uYSA9IGZ1bmN0aW9uICgpIHsgaWYgKCF0aGlzLnMgJiYgKHRoaXMucyA9ICEwLCB0aGlzLk0oKSwgMCAhPSBrYSkpIHtcclxuICAgIHZhciBhID0gZGEodGhpcyk7XHJcbiAgICBkZWxldGUgbGFbYV07XHJcbn0gfTtcclxudi5wcm90b3R5cGUuTSA9IGZ1bmN0aW9uICgpIHsgaWYgKHRoaXMubylcclxuICAgIGZvciAoOyB0aGlzLm8ubGVuZ3RoOylcclxuICAgICAgICB0aGlzLm8uc2hpZnQoKSgpOyB9O1xyXG52YXIgbWEgPSBBcnJheS5wcm90b3R5cGUuaW5kZXhPZiA/IGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKGEsIGIsIHZvaWQgMCk7IH0gOiBmdW5jdGlvbiAoYSwgYikgeyBpZiAoXCJzdHJpbmdcIiA9PT0gdHlwZW9mIGEpXHJcbiAgICByZXR1cm4gXCJzdHJpbmdcIiAhPT0gdHlwZW9mIGIgfHwgMSAhPSBiLmxlbmd0aCA/IC0xIDogYS5pbmRleE9mKGIsIDApOyBmb3IgKHZhciBjID0gMDsgYyA8IGEubGVuZ3RoOyBjKyspXHJcbiAgICBpZiAoYyBpbiBhICYmIGFbY10gPT09IGIpXHJcbiAgICAgICAgcmV0dXJuIGM7IHJldHVybiAtMTsgfSwgbmEgPSBBcnJheS5wcm90b3R5cGUuZm9yRWFjaCA/IGZ1bmN0aW9uIChhLCBiLCBjKSB7IEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoYSwgYiwgYyk7IH0gOiBmdW5jdGlvbiAoYSwgYiwgYykgeyB2YXIgZCA9IGEubGVuZ3RoLCBlID0gXCJzdHJpbmdcIiA9PT0gdHlwZW9mIGEgPyBhLnNwbGl0KFwiXCIpIDogYTsgZm9yICh2YXIgZiA9IDA7IGYgPCBkOyBmKyspXHJcbiAgICBmIGluIGUgJiYgYi5jYWxsKGMsIGVbZl0sIGYsIGEpOyB9O1xyXG5mdW5jdGlvbiBvYShhKSB7IGE6IHtcclxuICAgIHZhciBiID0gcGE7XHJcbiAgICB2YXIgYyA9IGEubGVuZ3RoLCBkID0gXCJzdHJpbmdcIiA9PT0gdHlwZW9mIGEgPyBhLnNwbGl0KFwiXCIpIDogYTtcclxuICAgIGZvciAodmFyIGUgPSAwOyBlIDwgYzsgZSsrKVxyXG4gICAgICAgIGlmIChlIGluIGQgJiYgYi5jYWxsKHZvaWQgMCwgZFtlXSwgZSwgYSkpIHtcclxuICAgICAgICAgICAgYiA9IGU7XHJcbiAgICAgICAgICAgIGJyZWFrIGE7XHJcbiAgICAgICAgfVxyXG4gICAgYiA9IC0xO1xyXG59IHJldHVybiAwID4gYiA/IG51bGwgOiBcInN0cmluZ1wiID09PSB0eXBlb2YgYSA/IGEuY2hhckF0KGIpIDogYVtiXTsgfVxyXG5mdW5jdGlvbiBxYShhKSB7IHJldHVybiBBcnJheS5wcm90b3R5cGUuY29uY2F0LmFwcGx5KFtdLCBhcmd1bWVudHMpOyB9XHJcbmZ1bmN0aW9uIHJhKGEpIHsgdmFyIGIgPSBhLmxlbmd0aDsgaWYgKDAgPCBiKSB7XHJcbiAgICB2YXIgYyA9IEFycmF5KGIpO1xyXG4gICAgZm9yICh2YXIgZCA9IDA7IGQgPCBiOyBkKyspXHJcbiAgICAgICAgY1tkXSA9IGFbZF07XHJcbiAgICByZXR1cm4gYztcclxufSByZXR1cm4gW107IH1cclxuZnVuY3Rpb24gc2EoYSkgeyByZXR1cm4gL15bXFxzXFx4YTBdKiQvLnRlc3QoYSk7IH1cclxudmFyIHRhID0gU3RyaW5nLnByb3RvdHlwZS50cmltID8gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGEudHJpbSgpOyB9IDogZnVuY3Rpb24gKGEpIHsgcmV0dXJuIC9eW1xcc1xceGEwXSooW1xcc1xcU10qPylbXFxzXFx4YTBdKiQvLmV4ZWMoYSlbMV07IH07XHJcbmZ1bmN0aW9uIHcoYSwgYikgeyByZXR1cm4gLTEgIT0gYS5pbmRleE9mKGIpOyB9XHJcbmZ1bmN0aW9uIHVhKGEsIGIpIHsgcmV0dXJuIGEgPCBiID8gLTEgOiBhID4gYiA/IDEgOiAwOyB9XHJcbnZhciB4O1xyXG5hOiB7XHJcbiAgICB2YXIgdmEgPSBsLm5hdmlnYXRvcjtcclxuICAgIGlmICh2YSkge1xyXG4gICAgICAgIHZhciB3YSA9IHZhLnVzZXJBZ2VudDtcclxuICAgICAgICBpZiAod2EpIHtcclxuICAgICAgICAgICAgeCA9IHdhO1xyXG4gICAgICAgICAgICBicmVhayBhO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHggPSBcIlwiO1xyXG59XHJcbmZ1bmN0aW9uIHhhKGEsIGIsIGMpIHsgZm9yICh2YXIgZCBpbiBhKVxyXG4gICAgYi5jYWxsKGMsIGFbZF0sIGQsIGEpOyB9XHJcbmZ1bmN0aW9uIHlhKGEpIHsgdmFyIGIgPSB7fTsgZm9yICh2YXIgYyBpbiBhKVxyXG4gICAgYltjXSA9IGFbY107IHJldHVybiBiOyB9XHJcbnZhciB6YSA9IFwiY29uc3RydWN0b3IgaGFzT3duUHJvcGVydHkgaXNQcm90b3R5cGVPZiBwcm9wZXJ0eUlzRW51bWVyYWJsZSB0b0xvY2FsZVN0cmluZyB0b1N0cmluZyB2YWx1ZU9mXCIuc3BsaXQoXCIgXCIpO1xyXG5mdW5jdGlvbiBBYShhLCBiKSB7IHZhciBjLCBkOyBmb3IgKHZhciBlID0gMTsgZSA8IGFyZ3VtZW50cy5sZW5ndGg7IGUrKykge1xyXG4gICAgZCA9IGFyZ3VtZW50c1tlXTtcclxuICAgIGZvciAoYyBpbiBkKVxyXG4gICAgICAgIGFbY10gPSBkW2NdO1xyXG4gICAgZm9yICh2YXIgZiA9IDA7IGYgPCB6YS5sZW5ndGg7IGYrKylcclxuICAgICAgICBjID0gemFbZl0sIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChkLCBjKSAmJiAoYVtjXSA9IGRbY10pO1xyXG59IH1cclxuZnVuY3Rpb24gQ2EoYSkgeyBDYVtcIiBcIl0oYSk7IHJldHVybiBhOyB9XHJcbkNhW1wiIFwiXSA9IGFhO1xyXG5mdW5jdGlvbiBGYShhKSB7IHZhciBiID0gR2E7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgOSkgPyBiWzldIDogYls5XSA9IGEoOSk7IH1cclxudmFyIEhhID0gdyh4LCBcIk9wZXJhXCIpLCB5ID0gdyh4LCBcIlRyaWRlbnRcIikgfHwgdyh4LCBcIk1TSUVcIiksIElhID0gdyh4LCBcIkVkZ2VcIiksIEphID0gSWEgfHwgeSwgS2EgPSB3KHgsIFwiR2Vja29cIikgJiYgISh3KHgudG9Mb3dlckNhc2UoKSwgXCJ3ZWJraXRcIikgJiYgIXcoeCwgXCJFZGdlXCIpKSAmJiAhKHcoeCwgXCJUcmlkZW50XCIpIHx8IHcoeCwgXCJNU0lFXCIpKSAmJiAhdyh4LCBcIkVkZ2VcIiksIExhID0gdyh4LnRvTG93ZXJDYXNlKCksIFwid2Via2l0XCIpICYmICF3KHgsIFwiRWRnZVwiKTtcclxuZnVuY3Rpb24gTWEoKSB7IHZhciBhID0gbC5kb2N1bWVudDsgcmV0dXJuIGEgPyBhLmRvY3VtZW50TW9kZSA6IHZvaWQgMDsgfVxyXG52YXIgTmE7XHJcbmE6IHtcclxuICAgIHZhciBPYSA9IFwiXCIsIFBhID0gZnVuY3Rpb24gKCkgeyB2YXIgYSA9IHg7IGlmIChLYSlcclxuICAgICAgICByZXR1cm4gL3J2OihbXlxcKTtdKykoXFwpfDspLy5leGVjKGEpOyBpZiAoSWEpXHJcbiAgICAgICAgcmV0dXJuIC9FZGdlXFwvKFtcXGRcXC5dKykvLmV4ZWMoYSk7IGlmICh5KVxyXG4gICAgICAgIHJldHVybiAvXFxiKD86TVNJRXxydilbOiBdKFteXFwpO10rKShcXCl8OykvLmV4ZWMoYSk7IGlmIChMYSlcclxuICAgICAgICByZXR1cm4gL1dlYktpdFxcLyhcXFMrKS8uZXhlYyhhKTsgaWYgKEhhKVxyXG4gICAgICAgIHJldHVybiAvKD86VmVyc2lvbilbIFxcL10/KFxcUyspLy5leGVjKGEpOyB9KCk7XHJcbiAgICBQYSAmJiAoT2EgPSBQYSA/IFBhWzFdIDogXCJcIik7XHJcbiAgICBpZiAoeSkge1xyXG4gICAgICAgIHZhciBRYSA9IE1hKCk7XHJcbiAgICAgICAgaWYgKG51bGwgIT0gUWEgJiYgUWEgPiBwYXJzZUZsb2F0KE9hKSkge1xyXG4gICAgICAgICAgICBOYSA9IFN0cmluZyhRYSk7XHJcbiAgICAgICAgICAgIGJyZWFrIGE7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgTmEgPSBPYTtcclxufVxyXG52YXIgR2EgPSB7fTtcclxuZnVuY3Rpb24gUmEoKSB7IHJldHVybiBGYShmdW5jdGlvbiAoKSB7IHZhciBhID0gMDsgdmFyIGIgPSB0YShTdHJpbmcoTmEpKS5zcGxpdChcIi5cIiksIGMgPSB0YShcIjlcIikuc3BsaXQoXCIuXCIpLCBkID0gTWF0aC5tYXgoYi5sZW5ndGgsIGMubGVuZ3RoKTsgZm9yICh2YXIgaCA9IDA7IDAgPT0gYSAmJiBoIDwgZDsgaCsrKSB7XHJcbiAgICB2YXIgZSA9IGJbaF0gfHwgXCJcIiwgZiA9IGNbaF0gfHwgXCJcIjtcclxuICAgIGRvIHtcclxuICAgICAgICBlID0gLyhcXGQqKShcXEQqKSguKikvLmV4ZWMoZSkgfHwgW1wiXCIsIFwiXCIsIFwiXCIsIFwiXCJdO1xyXG4gICAgICAgIGYgPSAvKFxcZCopKFxcRCopKC4qKS8uZXhlYyhmKSB8fCBbXCJcIiwgXCJcIiwgXCJcIiwgXCJcIl07XHJcbiAgICAgICAgaWYgKDAgPT0gZVswXS5sZW5ndGggJiYgMCA9PSBmWzBdLmxlbmd0aClcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgYSA9IHVhKDAgPT0gZVsxXS5sZW5ndGggPyAwIDogcGFyc2VJbnQoZVsxXSwgMTApLCAwID09IGZbMV0ubGVuZ3RoID8gMCA6IHBhcnNlSW50KGZbMV0sIDEwKSkgfHwgdWEoMCA9PSBlWzJdLmxlbmd0aCwgMCA9PSBmWzJdLmxlbmd0aCkgfHwgdWEoZVsyXSwgZlsyXSk7XHJcbiAgICAgICAgZSA9IGVbM107XHJcbiAgICAgICAgZiA9IGZbM107XHJcbiAgICB9IHdoaWxlICgwID09IGEpO1xyXG59IHJldHVybiAwIDw9IGE7IH0pOyB9XHJcbnZhciBTYTtcclxuaWYgKGwuZG9jdW1lbnQgJiYgeSkge1xyXG4gICAgdmFyIFRhID0gTWEoKTtcclxuICAgIFNhID0gVGEgPyBUYSA6IHBhcnNlSW50KE5hLCAxMCkgfHwgdm9pZCAwO1xyXG59XHJcbmVsc2VcclxuICAgIFNhID0gdm9pZCAwO1xyXG52YXIgVWEgPSBTYTtcclxudmFyIFZhID0gZnVuY3Rpb24gKCkgeyBpZiAoIWwuYWRkRXZlbnRMaXN0ZW5lciB8fCAhT2JqZWN0LmRlZmluZVByb3BlcnR5KVxyXG4gICAgcmV0dXJuICExOyB2YXIgYSA9ICExLCBiID0gT2JqZWN0LmRlZmluZVByb3BlcnR5KHt9LCBcInBhc3NpdmVcIiwgeyBnZXQ6IGZ1bmN0aW9uICgpIHsgYSA9ICEwOyB9IH0pOyB0cnkge1xyXG4gICAgbC5hZGRFdmVudExpc3RlbmVyKFwidGVzdFwiLCBhYSwgYiksIGwucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInRlc3RcIiwgYWEsIGIpO1xyXG59XHJcbmNhdGNoIChjKSB7IH0gcmV0dXJuIGE7IH0oKTtcclxuZnVuY3Rpb24geihhLCBiKSB7IHRoaXMudHlwZSA9IGE7IHRoaXMuZyA9IHRoaXMudGFyZ2V0ID0gYjsgdGhpcy5kZWZhdWx0UHJldmVudGVkID0gITE7IH1cclxuei5wcm90b3R5cGUuaCA9IGZ1bmN0aW9uICgpIHsgdGhpcy5kZWZhdWx0UHJldmVudGVkID0gITA7IH07XHJcbmZ1bmN0aW9uIEEoYSwgYikge1xyXG4gICAgei5jYWxsKHRoaXMsIGEgPyBhLnR5cGUgOiBcIlwiKTtcclxuICAgIHRoaXMucmVsYXRlZFRhcmdldCA9IHRoaXMuZyA9IHRoaXMudGFyZ2V0ID0gbnVsbDtcclxuICAgIHRoaXMuYnV0dG9uID0gdGhpcy5zY3JlZW5ZID0gdGhpcy5zY3JlZW5YID0gdGhpcy5jbGllbnRZID0gdGhpcy5jbGllbnRYID0gMDtcclxuICAgIHRoaXMua2V5ID0gXCJcIjtcclxuICAgIHRoaXMubWV0YUtleSA9IHRoaXMuc2hpZnRLZXkgPSB0aGlzLmFsdEtleSA9IHRoaXMuY3RybEtleSA9ICExO1xyXG4gICAgdGhpcy5zdGF0ZSA9IG51bGw7XHJcbiAgICB0aGlzLnBvaW50ZXJJZCA9IDA7XHJcbiAgICB0aGlzLnBvaW50ZXJUeXBlID0gXCJcIjtcclxuICAgIHRoaXMuaSA9IG51bGw7XHJcbiAgICBpZiAoYSkge1xyXG4gICAgICAgIHZhciBjID0gdGhpcy50eXBlID0gYS50eXBlLCBkID0gYS5jaGFuZ2VkVG91Y2hlcyAmJiBhLmNoYW5nZWRUb3VjaGVzLmxlbmd0aCA/IGEuY2hhbmdlZFRvdWNoZXNbMF0gOiBudWxsO1xyXG4gICAgICAgIHRoaXMudGFyZ2V0ID0gYS50YXJnZXQgfHwgYS5zcmNFbGVtZW50O1xyXG4gICAgICAgIHRoaXMuZyA9IGI7XHJcbiAgICAgICAgaWYgKGIgPSBhLnJlbGF0ZWRUYXJnZXQpIHtcclxuICAgICAgICAgICAgaWYgKEthKSB7XHJcbiAgICAgICAgICAgICAgICBhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgQ2EoYi5ub2RlTmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlID0gITA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrIGE7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNhdGNoIChmKSB7IH1cclxuICAgICAgICAgICAgICAgICAgICBlID1cclxuICAgICAgICAgICAgICAgICAgICAgICAgITE7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlIHx8IChiID0gbnVsbCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICBcIm1vdXNlb3ZlclwiID09IGMgPyBiID0gYS5mcm9tRWxlbWVudCA6IFwibW91c2VvdXRcIiA9PSBjICYmIChiID0gYS50b0VsZW1lbnQpO1xyXG4gICAgICAgIHRoaXMucmVsYXRlZFRhcmdldCA9IGI7XHJcbiAgICAgICAgZCA/ICh0aGlzLmNsaWVudFggPSB2b2lkIDAgIT09IGQuY2xpZW50WCA/IGQuY2xpZW50WCA6IGQucGFnZVgsIHRoaXMuY2xpZW50WSA9IHZvaWQgMCAhPT0gZC5jbGllbnRZID8gZC5jbGllbnRZIDogZC5wYWdlWSwgdGhpcy5zY3JlZW5YID0gZC5zY3JlZW5YIHx8IDAsIHRoaXMuc2NyZWVuWSA9IGQuc2NyZWVuWSB8fCAwKSA6ICh0aGlzLmNsaWVudFggPSB2b2lkIDAgIT09IGEuY2xpZW50WCA/IGEuY2xpZW50WCA6IGEucGFnZVgsIHRoaXMuY2xpZW50WSA9IHZvaWQgMCAhPT0gYS5jbGllbnRZID8gYS5jbGllbnRZIDogYS5wYWdlWSwgdGhpcy5zY3JlZW5YID0gYS5zY3JlZW5YIHx8IDAsIHRoaXMuc2NyZWVuWSA9IGEuc2NyZWVuWSB8fCAwKTtcclxuICAgICAgICB0aGlzLmJ1dHRvbiA9IGEuYnV0dG9uO1xyXG4gICAgICAgIHRoaXMua2V5ID0gYS5rZXkgfHwgXCJcIjtcclxuICAgICAgICB0aGlzLmN0cmxLZXkgPSBhLmN0cmxLZXk7XHJcbiAgICAgICAgdGhpcy5hbHRLZXkgPSBhLmFsdEtleTtcclxuICAgICAgICB0aGlzLnNoaWZ0S2V5ID1cclxuICAgICAgICAgICAgYS5zaGlmdEtleTtcclxuICAgICAgICB0aGlzLm1ldGFLZXkgPSBhLm1ldGFLZXk7XHJcbiAgICAgICAgdGhpcy5wb2ludGVySWQgPSBhLnBvaW50ZXJJZCB8fCAwO1xyXG4gICAgICAgIHRoaXMucG9pbnRlclR5cGUgPSBcInN0cmluZ1wiID09PSB0eXBlb2YgYS5wb2ludGVyVHlwZSA/IGEucG9pbnRlclR5cGUgOiBXYVthLnBvaW50ZXJUeXBlXSB8fCBcIlwiO1xyXG4gICAgICAgIHRoaXMuc3RhdGUgPSBhLnN0YXRlO1xyXG4gICAgICAgIHRoaXMuaSA9IGE7XHJcbiAgICAgICAgYS5kZWZhdWx0UHJldmVudGVkICYmIEEuWi5oLmNhbGwodGhpcyk7XHJcbiAgICB9XHJcbn1cclxudChBLCB6KTtcclxudmFyIFdhID0geyAyOiBcInRvdWNoXCIsIDM6IFwicGVuXCIsIDQ6IFwibW91c2VcIiB9O1xyXG5BLnByb3RvdHlwZS5oID0gZnVuY3Rpb24gKCkgeyBBLlouaC5jYWxsKHRoaXMpOyB2YXIgYSA9IHRoaXMuaTsgYS5wcmV2ZW50RGVmYXVsdCA/IGEucHJldmVudERlZmF1bHQoKSA6IGEucmV0dXJuVmFsdWUgPSAhMTsgfTtcclxudmFyIEIgPSBcImNsb3N1cmVfbGlzdGVuYWJsZV9cIiArICgxRTYgKiBNYXRoLnJhbmRvbSgpIHwgMCk7XHJcbnZhciBYYSA9IDA7XHJcbmZ1bmN0aW9uIFlhKGEsIGIsIGMsIGQsIGUpIHsgdGhpcy5saXN0ZW5lciA9IGE7IHRoaXMucHJveHkgPSBudWxsOyB0aGlzLnNyYyA9IGI7IHRoaXMudHlwZSA9IGM7IHRoaXMuY2FwdHVyZSA9ICEhZDsgdGhpcy5pYSA9IGU7IHRoaXMua2V5ID0gKytYYTsgdGhpcy5jYSA9IHRoaXMuZmEgPSAhMTsgfVxyXG5mdW5jdGlvbiBaYShhKSB7IGEuY2EgPSAhMDsgYS5saXN0ZW5lciA9IG51bGw7IGEucHJveHkgPSBudWxsOyBhLnNyYyA9IG51bGw7IGEuaWEgPSBudWxsOyB9XHJcbmZ1bmN0aW9uICRhKGEpIHsgdGhpcy5zcmMgPSBhOyB0aGlzLmcgPSB7fTsgdGhpcy5oID0gMDsgfVxyXG4kYS5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24gKGEsIGIsIGMsIGQsIGUpIHsgdmFyIGYgPSBhLnRvU3RyaW5nKCk7IGEgPSB0aGlzLmdbZl07IGEgfHwgKGEgPSB0aGlzLmdbZl0gPSBbXSwgdGhpcy5oKyspOyB2YXIgaCA9IGFiKGEsIGIsIGQsIGUpOyAtMSA8IGggPyAoYiA9IGFbaF0sIGMgfHwgKGIuZmEgPSAhMSkpIDogKGIgPSBuZXcgWWEoYiwgdGhpcy5zcmMsIGYsICEhZCwgZSksIGIuZmEgPSBjLCBhLnB1c2goYikpOyByZXR1cm4gYjsgfTtcclxuZnVuY3Rpb24gYmIoYSwgYikgeyB2YXIgYyA9IGIudHlwZTsgaWYgKGMgaW4gYS5nKSB7XHJcbiAgICB2YXIgZCA9IGEuZ1tjXSwgZSA9IG1hKGQsIGIpLCBmO1xyXG4gICAgKGYgPSAwIDw9IGUpICYmIEFycmF5LnByb3RvdHlwZS5zcGxpY2UuY2FsbChkLCBlLCAxKTtcclxuICAgIGYgJiYgKFphKGIpLCAwID09IGEuZ1tjXS5sZW5ndGggJiYgKGRlbGV0ZSBhLmdbY10sIGEuaC0tKSk7XHJcbn0gfVxyXG5mdW5jdGlvbiBhYihhLCBiLCBjLCBkKSB7IGZvciAodmFyIGUgPSAwOyBlIDwgYS5sZW5ndGg7ICsrZSkge1xyXG4gICAgdmFyIGYgPSBhW2VdO1xyXG4gICAgaWYgKCFmLmNhICYmIGYubGlzdGVuZXIgPT0gYiAmJiBmLmNhcHR1cmUgPT0gISFjICYmIGYuaWEgPT0gZClcclxuICAgICAgICByZXR1cm4gZTtcclxufSByZXR1cm4gLTE7IH1cclxudmFyIGNiID0gXCJjbG9zdXJlX2xtX1wiICsgKDFFNiAqIE1hdGgucmFuZG9tKCkgfCAwKSwgZGIgPSB7fTtcclxuZnVuY3Rpb24gZmIoYSwgYiwgYywgZCwgZSkgeyBpZiAoZCAmJiBkLm9uY2UpXHJcbiAgICByZXR1cm4gZ2IoYSwgYiwgYywgZCwgZSk7IGlmIChBcnJheS5pc0FycmF5KGIpKSB7XHJcbiAgICBmb3IgKHZhciBmID0gMDsgZiA8IGIubGVuZ3RoOyBmKyspXHJcbiAgICAgICAgZmIoYSwgYltmXSwgYywgZCwgZSk7XHJcbiAgICByZXR1cm4gbnVsbDtcclxufSBjID0gaGIoYyk7IHJldHVybiBhICYmIGFbQl0gPyBhLk4oYiwgYywgcChkKSA/ICEhZC5jYXB0dXJlIDogISFkLCBlKSA6IGliKGEsIGIsIGMsICExLCBkLCBlKTsgfVxyXG5mdW5jdGlvbiBpYihhLCBiLCBjLCBkLCBlLCBmKSB7IGlmICghYilcclxuICAgIHRocm93IEVycm9yKFwiSW52YWxpZCBldmVudCB0eXBlXCIpOyB2YXIgaCA9IHAoZSkgPyAhIWUuY2FwdHVyZSA6ICEhZSwgbiA9IGpiKGEpOyBuIHx8IChhW2NiXSA9IG4gPSBuZXcgJGEoYSkpOyBjID0gbi5hZGQoYiwgYywgZCwgaCwgZik7IGlmIChjLnByb3h5KVxyXG4gICAgcmV0dXJuIGM7IGQgPSBrYigpOyBjLnByb3h5ID0gZDsgZC5zcmMgPSBhOyBkLmxpc3RlbmVyID0gYzsgaWYgKGEuYWRkRXZlbnRMaXN0ZW5lcilcclxuICAgIFZhIHx8IChlID0gaCksIHZvaWQgMCA9PT0gZSAmJiAoZSA9ICExKSwgYS5hZGRFdmVudExpc3RlbmVyKGIudG9TdHJpbmcoKSwgZCwgZSk7XHJcbmVsc2UgaWYgKGEuYXR0YWNoRXZlbnQpXHJcbiAgICBhLmF0dGFjaEV2ZW50KGxiKGIudG9TdHJpbmcoKSksIGQpO1xyXG5lbHNlIGlmIChhLmFkZExpc3RlbmVyICYmIGEucmVtb3ZlTGlzdGVuZXIpXHJcbiAgICBhLmFkZExpc3RlbmVyKGQpO1xyXG5lbHNlXHJcbiAgICB0aHJvdyBFcnJvcihcImFkZEV2ZW50TGlzdGVuZXIgYW5kIGF0dGFjaEV2ZW50IGFyZSB1bmF2YWlsYWJsZS5cIik7IHJldHVybiBjOyB9XHJcbmZ1bmN0aW9uIGtiKCkgeyBmdW5jdGlvbiBhKGMpIHsgcmV0dXJuIGIuY2FsbChhLnNyYywgYS5saXN0ZW5lciwgYyk7IH0gdmFyIGIgPSBtYjsgcmV0dXJuIGE7IH1cclxuZnVuY3Rpb24gZ2IoYSwgYiwgYywgZCwgZSkgeyBpZiAoQXJyYXkuaXNBcnJheShiKSkge1xyXG4gICAgZm9yICh2YXIgZiA9IDA7IGYgPCBiLmxlbmd0aDsgZisrKVxyXG4gICAgICAgIGdiKGEsIGJbZl0sIGMsIGQsIGUpO1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbn0gYyA9IGhiKGMpOyByZXR1cm4gYSAmJiBhW0JdID8gYS5PKGIsIGMsIHAoZCkgPyAhIWQuY2FwdHVyZSA6ICEhZCwgZSkgOiBpYihhLCBiLCBjLCAhMCwgZCwgZSk7IH1cclxuZnVuY3Rpb24gbmIoYSwgYiwgYywgZCwgZSkgeyBpZiAoQXJyYXkuaXNBcnJheShiKSlcclxuICAgIGZvciAodmFyIGYgPSAwOyBmIDwgYi5sZW5ndGg7IGYrKylcclxuICAgICAgICBuYihhLCBiW2ZdLCBjLCBkLCBlKTtcclxuZWxzZVxyXG4gICAgKGQgPSBwKGQpID8gISFkLmNhcHR1cmUgOiAhIWQsIGMgPSBoYihjKSwgYSAmJiBhW0JdKSA/IChhID0gYS5pLCBiID0gU3RyaW5nKGIpLnRvU3RyaW5nKCksIGIgaW4gYS5nICYmIChmID0gYS5nW2JdLCBjID0gYWIoZiwgYywgZCwgZSksIC0xIDwgYyAmJiAoWmEoZltjXSksIEFycmF5LnByb3RvdHlwZS5zcGxpY2UuY2FsbChmLCBjLCAxKSwgMCA9PSBmLmxlbmd0aCAmJiAoZGVsZXRlIGEuZ1tiXSwgYS5oLS0pKSkpIDogYSAmJiAoYSA9IGpiKGEpKSAmJiAoYiA9IGEuZ1tiLnRvU3RyaW5nKCldLCBhID0gLTEsIGIgJiYgKGEgPSBhYihiLCBjLCBkLCBlKSksIChjID0gLTEgPCBhID8gYlthXSA6IG51bGwpICYmIG9iKGMpKTsgfVxyXG5mdW5jdGlvbiBvYihhKSB7IGlmIChcIm51bWJlclwiICE9PSB0eXBlb2YgYSAmJiBhICYmICFhLmNhKSB7XHJcbiAgICB2YXIgYiA9IGEuc3JjO1xyXG4gICAgaWYgKGIgJiYgYltCXSlcclxuICAgICAgICBiYihiLmksIGEpO1xyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgdmFyIGMgPSBhLnR5cGUsIGQgPSBhLnByb3h5O1xyXG4gICAgICAgIGIucmVtb3ZlRXZlbnRMaXN0ZW5lciA/IGIucmVtb3ZlRXZlbnRMaXN0ZW5lcihjLCBkLCBhLmNhcHR1cmUpIDogYi5kZXRhY2hFdmVudCA/IGIuZGV0YWNoRXZlbnQobGIoYyksIGQpIDogYi5hZGRMaXN0ZW5lciAmJiBiLnJlbW92ZUxpc3RlbmVyICYmIGIucmVtb3ZlTGlzdGVuZXIoZCk7XHJcbiAgICAgICAgKGMgPSBqYihiKSkgPyAoYmIoYywgYSksIDAgPT0gYy5oICYmIChjLnNyYyA9IG51bGwsIGJbY2JdID0gbnVsbCkpIDogWmEoYSk7XHJcbiAgICB9XHJcbn0gfVxyXG5mdW5jdGlvbiBsYihhKSB7IHJldHVybiBhIGluIGRiID8gZGJbYV0gOiBkYlthXSA9IFwib25cIiArIGE7IH1cclxuZnVuY3Rpb24gbWIoYSwgYikgeyBpZiAoYS5jYSlcclxuICAgIGEgPSAhMDtcclxuZWxzZSB7XHJcbiAgICBiID0gbmV3IEEoYiwgdGhpcyk7XHJcbiAgICB2YXIgYyA9IGEubGlzdGVuZXIsIGQgPSBhLmlhIHx8IGEuc3JjO1xyXG4gICAgYS5mYSAmJiBvYihhKTtcclxuICAgIGEgPSBjLmNhbGwoZCwgYik7XHJcbn0gcmV0dXJuIGE7IH1cclxuZnVuY3Rpb24gamIoYSkgeyBhID0gYVtjYl07IHJldHVybiBhIGluc3RhbmNlb2YgJGEgPyBhIDogbnVsbDsgfVxyXG52YXIgcGIgPSBcIl9fY2xvc3VyZV9ldmVudHNfZm5fXCIgKyAoMUU5ICogTWF0aC5yYW5kb20oKSA+Pj4gMCk7XHJcbmZ1bmN0aW9uIGhiKGEpIHsgaWYgKFwiZnVuY3Rpb25cIiA9PT0gdHlwZW9mIGEpXHJcbiAgICByZXR1cm4gYTsgYVtwYl0gfHwgKGFbcGJdID0gZnVuY3Rpb24gKGIpIHsgcmV0dXJuIGEuaGFuZGxlRXZlbnQoYik7IH0pOyByZXR1cm4gYVtwYl07IH1cclxuZnVuY3Rpb24gQygpIHsgdi5jYWxsKHRoaXMpOyB0aGlzLmkgPSBuZXcgJGEodGhpcyk7IHRoaXMuUCA9IHRoaXM7IHRoaXMuSSA9IG51bGw7IH1cclxudChDLCB2KTtcclxuQy5wcm90b3R5cGVbQl0gPSAhMDtcclxuQy5wcm90b3R5cGUucmVtb3ZlRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uIChhLCBiLCBjLCBkKSB7IG5iKHRoaXMsIGEsIGIsIGMsIGQpOyB9O1xyXG5mdW5jdGlvbiBEKGEsIGIpIHsgdmFyIGMsIGQgPSBhLkk7IGlmIChkKVxyXG4gICAgZm9yIChjID0gW107IGQ7IGQgPSBkLkkpXHJcbiAgICAgICAgYy5wdXNoKGQpOyBhID0gYS5QOyBkID0gYi50eXBlIHx8IGI7IGlmIChcInN0cmluZ1wiID09PSB0eXBlb2YgYilcclxuICAgIGIgPSBuZXcgeihiLCBhKTtcclxuZWxzZSBpZiAoYiBpbnN0YW5jZW9mIHopXHJcbiAgICBiLnRhcmdldCA9IGIudGFyZ2V0IHx8IGE7XHJcbmVsc2Uge1xyXG4gICAgdmFyIGUgPSBiO1xyXG4gICAgYiA9IG5ldyB6KGQsIGEpO1xyXG4gICAgQWEoYiwgZSk7XHJcbn0gZSA9ICEwOyBpZiAoYylcclxuICAgIGZvciAodmFyIGYgPSBjLmxlbmd0aCAtIDE7IDAgPD0gZjsgZi0tKSB7XHJcbiAgICAgICAgdmFyIGggPSBiLmcgPSBjW2ZdO1xyXG4gICAgICAgIGUgPSBxYihoLCBkLCAhMCwgYikgJiYgZTtcclxuICAgIH0gaCA9IGIuZyA9IGE7IGUgPSBxYihoLCBkLCAhMCwgYikgJiYgZTsgZSA9IHFiKGgsIGQsICExLCBiKSAmJiBlOyBpZiAoYylcclxuICAgIGZvciAoZiA9IDA7IGYgPCBjLmxlbmd0aDsgZisrKVxyXG4gICAgICAgIGggPSBiLmcgPSBjW2ZdLCBlID0gcWIoaCwgZCwgITEsIGIpICYmIGU7IH1cclxuQy5wcm90b3R5cGUuTSA9IGZ1bmN0aW9uICgpIHsgQy5aLk0uY2FsbCh0aGlzKTsgaWYgKHRoaXMuaSkge1xyXG4gICAgdmFyIGEgPSB0aGlzLmksIGM7XHJcbiAgICBmb3IgKGMgaW4gYS5nKSB7XHJcbiAgICAgICAgZm9yICh2YXIgZCA9IGEuZ1tjXSwgZSA9IDA7IGUgPCBkLmxlbmd0aDsgZSsrKVxyXG4gICAgICAgICAgICBaYShkW2VdKTtcclxuICAgICAgICBkZWxldGUgYS5nW2NdO1xyXG4gICAgICAgIGEuaC0tO1xyXG4gICAgfVxyXG59IHRoaXMuSSA9IG51bGw7IH07XHJcbkMucHJvdG90eXBlLk4gPSBmdW5jdGlvbiAoYSwgYiwgYywgZCkgeyByZXR1cm4gdGhpcy5pLmFkZChTdHJpbmcoYSksIGIsICExLCBjLCBkKTsgfTtcclxuQy5wcm90b3R5cGUuTyA9IGZ1bmN0aW9uIChhLCBiLCBjLCBkKSB7IHJldHVybiB0aGlzLmkuYWRkKFN0cmluZyhhKSwgYiwgITAsIGMsIGQpOyB9O1xyXG5mdW5jdGlvbiBxYihhLCBiLCBjLCBkKSB7IGIgPSBhLmkuZ1tTdHJpbmcoYildOyBpZiAoIWIpXHJcbiAgICByZXR1cm4gITA7IGIgPSBiLmNvbmNhdCgpOyBmb3IgKHZhciBlID0gITAsIGYgPSAwOyBmIDwgYi5sZW5ndGg7ICsrZikge1xyXG4gICAgdmFyIGggPSBiW2ZdO1xyXG4gICAgaWYgKGggJiYgIWguY2EgJiYgaC5jYXB0dXJlID09IGMpIHtcclxuICAgICAgICB2YXIgbiA9IGgubGlzdGVuZXIsIHUgPSBoLmlhIHx8IGguc3JjO1xyXG4gICAgICAgIGguZmEgJiYgYmIoYS5pLCBoKTtcclxuICAgICAgICBlID0gITEgIT09IG4uY2FsbCh1LCBkKSAmJiBlO1xyXG4gICAgfVxyXG59IHJldHVybiBlICYmICFkLmRlZmF1bHRQcmV2ZW50ZWQ7IH1cclxudmFyIHJiID0gbC5KU09OLnN0cmluZ2lmeTtcclxuZnVuY3Rpb24gc2IoKSB7IHZhciBhID0gdGI7IHZhciBiID0gbnVsbDsgYS5nICYmIChiID0gYS5nLCBhLmcgPSBhLmcubmV4dCwgYS5nIHx8IChhLmggPSBudWxsKSwgYi5uZXh0ID0gbnVsbCk7IHJldHVybiBiOyB9XHJcbnZhciB1YiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIHViKCkge1xyXG4gICAgICAgIHRoaXMuaCA9IHRoaXMuZyA9IG51bGw7XHJcbiAgICB9XHJcbiAgICB1Yi5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24gKGEsIGIpIHsgdmFyIGMgPSB2Yi5nZXQoKTsgYy5zZXQoYSwgYik7IHRoaXMuaCA/IHRoaXMuaC5uZXh0ID0gYyA6IHRoaXMuZyA9IGM7IHRoaXMuaCA9IGM7IH07XHJcbiAgICByZXR1cm4gdWI7XHJcbn0oKSk7XHJcbnZhciB2YiA9IG5ldyAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBjbGFzc18yKGEsIGIpIHtcclxuICAgICAgICB0aGlzLmkgPSBhO1xyXG4gICAgICAgIHRoaXMuaiA9IGI7XHJcbiAgICAgICAgdGhpcy5oID0gMDtcclxuICAgICAgICB0aGlzLmcgPSBudWxsO1xyXG4gICAgfVxyXG4gICAgY2xhc3NfMi5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKCkgeyB2YXIgYTsgMCA8IHRoaXMuaCA/ICh0aGlzLmgtLSwgYSA9IHRoaXMuZywgdGhpcy5nID0gYS5uZXh0LCBhLm5leHQgPSBudWxsKSA6IGEgPSB0aGlzLmkoKTsgcmV0dXJuIGE7IH07XHJcbiAgICByZXR1cm4gY2xhc3NfMjtcclxufSgpKShmdW5jdGlvbiAoKSB7IHJldHVybiBuZXcgd2I7IH0sIGZ1bmN0aW9uIChhKSB7IHJldHVybiBhLnJlc2V0KCk7IH0pO1xyXG52YXIgd2IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiB3YigpIHtcclxuICAgICAgICB0aGlzLm5leHQgPSB0aGlzLmcgPSB0aGlzLmggPSBudWxsO1xyXG4gICAgfVxyXG4gICAgd2IucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uIChhLCBiKSB7IHRoaXMuaCA9IGE7IHRoaXMuZyA9IGI7IHRoaXMubmV4dCA9IG51bGw7IH07XHJcbiAgICB3Yi5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbiAoKSB7IHRoaXMubmV4dCA9IHRoaXMuZyA9IHRoaXMuaCA9IG51bGw7IH07XHJcbiAgICByZXR1cm4gd2I7XHJcbn0oKSk7XHJcbmZ1bmN0aW9uIHliKGEpIHsgbC5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgdGhyb3cgYTsgfSwgMCk7IH1cclxuZnVuY3Rpb24gemIoYSwgYikgeyBBYiB8fCBCYigpOyBDYiB8fCAoQWIoKSwgQ2IgPSAhMCk7IHRiLmFkZChhLCBiKTsgfVxyXG52YXIgQWI7XHJcbmZ1bmN0aW9uIEJiKCkgeyB2YXIgYSA9IGwuUHJvbWlzZS5yZXNvbHZlKHZvaWQgMCk7IEFiID0gZnVuY3Rpb24gKCkgeyBhLnRoZW4oRGIpOyB9OyB9XHJcbnZhciBDYiA9ICExLCB0YiA9IG5ldyB1YjtcclxuZnVuY3Rpb24gRGIoKSB7IGZvciAodmFyIGE7IGEgPSBzYigpOykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBhLmguY2FsbChhLmcpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGMpIHtcclxuICAgICAgICB5YihjKTtcclxuICAgIH1cclxuICAgIHZhciBiID0gdmI7XHJcbiAgICBiLmooYSk7XHJcbiAgICAxMDAgPiBiLmggJiYgKGIuaCsrLCBhLm5leHQgPSBiLmcsIGIuZyA9IGEpO1xyXG59IENiID0gITE7IH1cclxuZnVuY3Rpb24gRWIoYSwgYikgeyBDLmNhbGwodGhpcyk7IHRoaXMuaCA9IGEgfHwgMTsgdGhpcy5nID0gYiB8fCBsOyB0aGlzLmogPSBxKHRoaXMua2IsIHRoaXMpOyB0aGlzLmwgPSBEYXRlLm5vdygpOyB9XHJcbnQoRWIsIEMpO1xyXG5rID0gRWIucHJvdG90eXBlO1xyXG5rLmRhID0gITE7XHJcbmsuUyA9IG51bGw7XHJcbmsua2IgPSBmdW5jdGlvbiAoKSB7IGlmICh0aGlzLmRhKSB7XHJcbiAgICB2YXIgYSA9IERhdGUubm93KCkgLSB0aGlzLmw7XHJcbiAgICAwIDwgYSAmJiBhIDwgLjggKiB0aGlzLmggPyB0aGlzLlMgPSB0aGlzLmcuc2V0VGltZW91dCh0aGlzLmosIHRoaXMuaCAtIGEpIDogKHRoaXMuUyAmJiAodGhpcy5nLmNsZWFyVGltZW91dCh0aGlzLlMpLCB0aGlzLlMgPSBudWxsKSwgRCh0aGlzLCBcInRpY2tcIiksIHRoaXMuZGEgJiYgKEZiKHRoaXMpLCB0aGlzLnN0YXJ0KCkpKTtcclxufSB9O1xyXG5rLnN0YXJ0ID0gZnVuY3Rpb24gKCkgeyB0aGlzLmRhID0gITA7IHRoaXMuUyB8fCAodGhpcy5TID0gdGhpcy5nLnNldFRpbWVvdXQodGhpcy5qLCB0aGlzLmgpLCB0aGlzLmwgPSBEYXRlLm5vdygpKTsgfTtcclxuZnVuY3Rpb24gRmIoYSkgeyBhLmRhID0gITE7IGEuUyAmJiAoYS5nLmNsZWFyVGltZW91dChhLlMpLCBhLlMgPSBudWxsKTsgfVxyXG5rLk0gPSBmdW5jdGlvbiAoKSB7IEViLlouTS5jYWxsKHRoaXMpOyBGYih0aGlzKTsgZGVsZXRlIHRoaXMuZzsgfTtcclxuZnVuY3Rpb24gR2IoYSwgYiwgYykgeyBpZiAoXCJmdW5jdGlvblwiID09PSB0eXBlb2YgYSlcclxuICAgIGMgJiYgKGEgPSBxKGEsIGMpKTtcclxuZWxzZSBpZiAoYSAmJiBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIGEuaGFuZGxlRXZlbnQpXHJcbiAgICBhID0gcShhLmhhbmRsZUV2ZW50LCBhKTtcclxuZWxzZVxyXG4gICAgdGhyb3cgRXJyb3IoXCJJbnZhbGlkIGxpc3RlbmVyIGFyZ3VtZW50XCIpOyByZXR1cm4gMjE0NzQ4MzY0NyA8IE51bWJlcihiKSA/IC0xIDogbC5zZXRUaW1lb3V0KGEsIGIgfHwgMCk7IH1cclxuZnVuY3Rpb24gSGIoYSkgeyBhLmcgPSBHYihmdW5jdGlvbiAoKSB7IGEuZyA9IG51bGw7IGEuaSAmJiAoYS5pID0gITEsIEhiKGEpKTsgfSwgYS5qKTsgdmFyIGIgPSBhLmg7IGEuaCA9IG51bGw7IGEubS5hcHBseShudWxsLCBiKTsgfVxyXG52YXIgSWIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICBfX2V4dGVuZHMoSWIsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBJYihhLCBiKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5tID0gYTtcclxuICAgICAgICBfdGhpcy5qID0gYjtcclxuICAgICAgICBfdGhpcy5oID0gbnVsbDtcclxuICAgICAgICBfdGhpcy5pID0gITE7XHJcbiAgICAgICAgX3RoaXMuZyA9IG51bGw7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgSWIucHJvdG90eXBlLmwgPSBmdW5jdGlvbiAoYSkgeyB0aGlzLmggPSBhcmd1bWVudHM7IHRoaXMuZyA/IHRoaXMuaSA9ICEwIDogSGIodGhpcyk7IH07XHJcbiAgICBJYi5wcm90b3R5cGUuTSA9IGZ1bmN0aW9uICgpIHsgX3N1cGVyLnByb3RvdHlwZS5NLmNhbGwodGhpcyk7IHRoaXMuZyAmJiAobC5jbGVhclRpbWVvdXQodGhpcy5nKSwgdGhpcy5nID0gbnVsbCwgdGhpcy5pID0gITEsIHRoaXMuaCA9IG51bGwpOyB9O1xyXG4gICAgcmV0dXJuIEliO1xyXG59KHYpKTtcclxuZnVuY3Rpb24gRShhKSB7IHYuY2FsbCh0aGlzKTsgdGhpcy5oID0gYTsgdGhpcy5nID0ge307IH1cclxudChFLCB2KTtcclxudmFyIEpiID0gW107XHJcbmZ1bmN0aW9uIEtiKGEsIGIsIGMsIGQpIHsgQXJyYXkuaXNBcnJheShjKSB8fCAoYyAmJiAoSmJbMF0gPSBjLnRvU3RyaW5nKCkpLCBjID0gSmIpOyBmb3IgKHZhciBlID0gMDsgZSA8IGMubGVuZ3RoOyBlKyspIHtcclxuICAgIHZhciBmID0gZmIoYiwgY1tlXSwgZCB8fCBhLmhhbmRsZUV2ZW50LCAhMSwgYS5oIHx8IGEpO1xyXG4gICAgaWYgKCFmKVxyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgYS5nW2Yua2V5XSA9IGY7XHJcbn0gfVxyXG5mdW5jdGlvbiBMYihhKSB7IHhhKGEuZywgZnVuY3Rpb24gKGIsIGMpIHsgdGhpcy5nLmhhc093blByb3BlcnR5KGMpICYmIG9iKGIpOyB9LCBhKTsgYS5nID0ge307IH1cclxuRS5wcm90b3R5cGUuTSA9IGZ1bmN0aW9uICgpIHsgRS5aLk0uY2FsbCh0aGlzKTsgTGIodGhpcyk7IH07XHJcbkUucHJvdG90eXBlLmhhbmRsZUV2ZW50ID0gZnVuY3Rpb24gKCkgeyB0aHJvdyBFcnJvcihcIkV2ZW50SGFuZGxlci5oYW5kbGVFdmVudCBub3QgaW1wbGVtZW50ZWRcIik7IH07XHJcbmZ1bmN0aW9uIE1iKCkgeyB0aGlzLmcgPSAhMDsgfVxyXG5NYi5wcm90b3R5cGUuQWEgPSBmdW5jdGlvbiAoKSB7IHRoaXMuZyA9ICExOyB9O1xyXG5mdW5jdGlvbiBOYihhLCBiLCBjLCBkLCBlLCBmKSB7IGEuaW5mbyhmdW5jdGlvbiAoKSB7IGlmIChhLmcpXHJcbiAgICBpZiAoZikge1xyXG4gICAgICAgIHZhciBoID0gXCJcIjtcclxuICAgICAgICBmb3IgKHZhciBuID0gZi5zcGxpdChcIiZcIiksIHUgPSAwOyB1IDwgbi5sZW5ndGg7IHUrKykge1xyXG4gICAgICAgICAgICB2YXIgbSA9IG5bdV0uc3BsaXQoXCI9XCIpO1xyXG4gICAgICAgICAgICBpZiAoMSA8IG0ubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgciA9IG1bMF07XHJcbiAgICAgICAgICAgICAgICBtID0gbVsxXTtcclxuICAgICAgICAgICAgICAgIHZhciBHID0gci5zcGxpdChcIl9cIik7XHJcbiAgICAgICAgICAgICAgICBoID0gMiA8PSBHLmxlbmd0aCAmJiBcInR5cGVcIiA9PSBHWzFdID8gaCArIChyICsgXCI9XCIgKyBtICsgXCImXCIpIDogaCArIChyICsgXCI9cmVkYWN0ZWQmXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZVxyXG4gICAgICAgIGggPSBudWxsO1xyXG5lbHNlXHJcbiAgICBoID0gZjsgcmV0dXJuIFwiWE1MSFRUUCBSRVEgKFwiICsgZCArIFwiKSBbYXR0ZW1wdCBcIiArIGUgKyBcIl06IFwiICsgYiArIFwiXFxuXCIgKyBjICsgXCJcXG5cIiArIGg7IH0pOyB9XHJcbmZ1bmN0aW9uIE9iKGEsIGIsIGMsIGQsIGUsIGYsIGgpIHsgYS5pbmZvKGZ1bmN0aW9uICgpIHsgcmV0dXJuIFwiWE1MSFRUUCBSRVNQIChcIiArIGQgKyBcIikgWyBhdHRlbXB0IFwiICsgZSArIFwiXTogXCIgKyBiICsgXCJcXG5cIiArIGMgKyBcIlxcblwiICsgZiArIFwiIFwiICsgaDsgfSk7IH1cclxuZnVuY3Rpb24gRihhLCBiLCBjLCBkKSB7IGEuaW5mbyhmdW5jdGlvbiAoKSB7IHJldHVybiBcIlhNTEhUVFAgVEVYVCAoXCIgKyBiICsgXCIpOiBcIiArIFBiKGEsIGMpICsgKGQgPyBcIiBcIiArIGQgOiBcIlwiKTsgfSk7IH1cclxuZnVuY3Rpb24gUWIoYSwgYikgeyBhLmluZm8oZnVuY3Rpb24gKCkgeyByZXR1cm4gXCJUSU1FT1VUOiBcIiArIGI7IH0pOyB9XHJcbk1iLnByb3RvdHlwZS5pbmZvID0gZnVuY3Rpb24gKCkgeyB9O1xyXG5mdW5jdGlvbiBQYihhLCBiKSB7IGlmICghYS5nKVxyXG4gICAgcmV0dXJuIGI7IGlmICghYilcclxuICAgIHJldHVybiBudWxsOyB0cnkge1xyXG4gICAgdmFyIGMgPSBKU09OLnBhcnNlKGIpO1xyXG4gICAgaWYgKGMpXHJcbiAgICAgICAgZm9yIChhID0gMDsgYSA8IGMubGVuZ3RoOyBhKyspXHJcbiAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGNbYV0pKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZCA9IGNbYV07XHJcbiAgICAgICAgICAgICAgICBpZiAoISgyID4gZC5sZW5ndGgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSBkWzFdO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGUpICYmICEoMSA+IGUubGVuZ3RoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZiA9IGVbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChcIm5vb3BcIiAhPSBmICYmIFwic3RvcFwiICE9IGYgJiYgXCJjbG9zZVwiICE9IGYpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBoID0gMTsgaCA8IGUubGVuZ3RoOyBoKyspXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZVtoXSA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICByZXR1cm4gcmIoYyk7XHJcbn1cclxuY2F0Y2ggKG4pIHtcclxuICAgIHJldHVybiBiO1xyXG59IH1cclxudmFyIEggPSB7fSwgUmIgPSBudWxsO1xyXG5mdW5jdGlvbiBTYigpIHsgcmV0dXJuIFJiID0gUmIgfHwgbmV3IEM7IH1cclxuSC5NYSA9IFwic2VydmVycmVhY2hhYmlsaXR5XCI7XHJcbmZ1bmN0aW9uIFRiKGEpIHsgei5jYWxsKHRoaXMsIEguTWEsIGEpOyB9XHJcbnQoVGIsIHopO1xyXG5mdW5jdGlvbiBJKGEpIHsgdmFyIGIgPSBTYigpOyBEKGIsIG5ldyBUYihiLCBhKSk7IH1cclxuSC5TVEFUX0VWRU5UID0gXCJzdGF0ZXZlbnRcIjtcclxuZnVuY3Rpb24gVWIoYSwgYikgeyB6LmNhbGwodGhpcywgSC5TVEFUX0VWRU5ULCBhKTsgdGhpcy5zdGF0ID0gYjsgfVxyXG50KFViLCB6KTtcclxuZnVuY3Rpb24gSihhKSB7IHZhciBiID0gU2IoKTsgRChiLCBuZXcgVWIoYiwgYSkpOyB9XHJcbkguTmEgPSBcInRpbWluZ2V2ZW50XCI7XHJcbmZ1bmN0aW9uIFZiKGEsIGIpIHsgei5jYWxsKHRoaXMsIEguTmEsIGEpOyB0aGlzLnNpemUgPSBiOyB9XHJcbnQoVmIsIHopO1xyXG5mdW5jdGlvbiBLKGEsIGIpIHsgaWYgKFwiZnVuY3Rpb25cIiAhPT0gdHlwZW9mIGEpXHJcbiAgICB0aHJvdyBFcnJvcihcIkZuIG11c3Qgbm90IGJlIG51bGwgYW5kIG11c3QgYmUgYSBmdW5jdGlvblwiKTsgcmV0dXJuIGwuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IGEoKTsgfSwgYik7IH1cclxudmFyIFdiID0geyBOT19FUlJPUjogMCwgbGI6IDEsIHliOiAyLCB4YjogMywgc2I6IDQsIHdiOiA1LCB6YjogNiwgSmE6IDcsIFRJTUVPVVQ6IDgsIENiOiA5IH07XHJcbnZhciBYYiA9IHsgcWI6IFwiY29tcGxldGVcIiwgTWI6IFwic3VjY2Vzc1wiLCBLYTogXCJlcnJvclwiLCBKYTogXCJhYm9ydFwiLCBFYjogXCJyZWFkeVwiLCBGYjogXCJyZWFkeXN0YXRlY2hhbmdlXCIsIFRJTUVPVVQ6IFwidGltZW91dFwiLCBBYjogXCJpbmNyZW1lbnRhbGRhdGFcIiwgRGI6IFwicHJvZ3Jlc3NcIiwgdGI6IFwiZG93bmxvYWRwcm9ncmVzc1wiLCBVYjogXCJ1cGxvYWRwcm9ncmVzc1wiIH07XHJcbmZ1bmN0aW9uIFliKCkgeyB9XHJcblliLnByb3RvdHlwZS5oID0gbnVsbDtcclxuZnVuY3Rpb24gWmIoYSkgeyByZXR1cm4gYS5oIHx8IChhLmggPSBhLmkoKSk7IH1cclxuZnVuY3Rpb24gJGIoKSB7IH1cclxudmFyIEwgPSB7IE9QRU46IFwiYVwiLCBwYjogXCJiXCIsIEthOiBcImNcIiwgQmI6IFwiZFwiIH07XHJcbmZ1bmN0aW9uIGFjKCkgeyB6LmNhbGwodGhpcywgXCJkXCIpOyB9XHJcbnQoYWMsIHopO1xyXG5mdW5jdGlvbiBiYygpIHsgei5jYWxsKHRoaXMsIFwiY1wiKTsgfVxyXG50KGJjLCB6KTtcclxudmFyIGNjO1xyXG5mdW5jdGlvbiBkYygpIHsgfVxyXG50KGRjLCBZYik7XHJcbmRjLnByb3RvdHlwZS5nID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gbmV3IFhNTEh0dHBSZXF1ZXN0OyB9O1xyXG5kYy5wcm90b3R5cGUuaSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHt9OyB9O1xyXG5jYyA9IG5ldyBkYztcclxuZnVuY3Rpb24gTShhLCBiLCBjLCBkKSB7IHRoaXMubCA9IGE7IHRoaXMuaiA9IGI7IHRoaXMubSA9IGM7IHRoaXMuWCA9IGQgfHwgMTsgdGhpcy5WID0gbmV3IEUodGhpcyk7IHRoaXMuUCA9IGVjOyBhID0gSmEgPyAxMjUgOiB2b2lkIDA7IHRoaXMuVyA9IG5ldyBFYihhKTsgdGhpcy5IID0gbnVsbDsgdGhpcy5pID0gITE7IHRoaXMucyA9IHRoaXMuQSA9IHRoaXMudiA9IHRoaXMuSyA9IHRoaXMuRiA9IHRoaXMuWSA9IHRoaXMuQiA9IG51bGw7IHRoaXMuRCA9IFtdOyB0aGlzLmcgPSBudWxsOyB0aGlzLkMgPSAwOyB0aGlzLm8gPSB0aGlzLnUgPSBudWxsOyB0aGlzLk4gPSAtMTsgdGhpcy5JID0gITE7IHRoaXMuTyA9IDA7IHRoaXMuTCA9IG51bGw7IHRoaXMuYWEgPSB0aGlzLkogPSB0aGlzLiQgPSB0aGlzLlUgPSAhMTsgdGhpcy5oID0gbmV3IGZjOyB9XHJcbmZ1bmN0aW9uIGZjKCkgeyB0aGlzLmkgPSBudWxsOyB0aGlzLmcgPSBcIlwiOyB0aGlzLmggPSAhMTsgfVxyXG52YXIgZWMgPSA0NUUzLCBnYyA9IHt9LCBoYyA9IHt9O1xyXG5rID0gTS5wcm90b3R5cGU7XHJcbmsuc2V0VGltZW91dCA9IGZ1bmN0aW9uIChhKSB7IHRoaXMuUCA9IGE7IH07XHJcbmZ1bmN0aW9uIGljKGEsIGIsIGMpIHsgYS5LID0gMTsgYS52ID0gamMoTihiKSk7IGEucyA9IGM7IGEuVSA9ICEwOyBrYyhhLCBudWxsKTsgfVxyXG5mdW5jdGlvbiBrYyhhLCBiKSB7IGEuRiA9IERhdGUubm93KCk7IGxjKGEpOyBhLkEgPSBOKGEudik7IHZhciBjID0gYS5BLCBkID0gYS5YOyBBcnJheS5pc0FycmF5KGQpIHx8IChkID0gW1N0cmluZyhkKV0pOyBtYyhjLmgsIFwidFwiLCBkKTsgYS5DID0gMDsgYyA9IGEubC5IOyBhLmggPSBuZXcgZmM7IGEuZyA9IG5jKGEubCwgYyA/IGIgOiBudWxsLCAhYS5zKTsgMCA8IGEuTyAmJiAoYS5MID0gbmV3IEliKHEoYS5JYSwgYSwgYS5nKSwgYS5PKSk7IEtiKGEuViwgYS5nLCBcInJlYWR5c3RhdGVjaGFuZ2VcIiwgYS5nYik7IGIgPSBhLkggPyB5YShhLkgpIDoge307IGEucyA/IChhLnUgfHwgKGEudSA9IFwiUE9TVFwiKSwgYltcIkNvbnRlbnQtVHlwZVwiXSA9IFwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkXCIsIGEuZy5lYShhLkEsIGEudSwgYS5zLCBiKSkgOiAoYS51ID0gXCJHRVRcIiwgYS5nLmVhKGEuQSwgYS51LCBudWxsLCBiKSk7IEkoMSk7IE5iKGEuaiwgYS51LCBhLkEsIGEubSwgYS5YLCBhLnMpOyB9XHJcbmsuZ2IgPSBmdW5jdGlvbiAoYSkgeyBhID0gYS50YXJnZXQ7IHZhciBiID0gdGhpcy5MOyBiICYmIDMgPT0gTyhhKSA/IGIubCgpIDogdGhpcy5JYShhKTsgfTtcclxuay5JYSA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGlmIChhID09IHRoaXMuZylcclxuICAgICAgICAgICAgYToge1xyXG4gICAgICAgICAgICAgICAgdmFyIHIgPSBPKHRoaXMuZyk7XHJcbiAgICAgICAgICAgICAgICB2YXIgYiA9IHRoaXMuZy5EYSgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIEcgPSB0aGlzLmcuYmEoKTtcclxuICAgICAgICAgICAgICAgIGlmICghKDMgPiByKSAmJiAoMyAhPSByIHx8IEphIHx8IHRoaXMuZyAmJiAodGhpcy5oLmggfHwgdGhpcy5nLmdhKCkgfHwgb2ModGhpcy5nKSkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5JIHx8IDQgIT0gciB8fCA3ID09IGIgfHwgKDggPT0gYiB8fCAwID49IEcgPyBJKDMpIDogSSgyKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcGModGhpcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSB0aGlzLmcuYmEoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLk4gPSBjO1xyXG4gICAgICAgICAgICAgICAgICAgIGI6IGlmIChxYyh0aGlzKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IG9jKHRoaXMuZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGEgPSBcIlwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IGQubGVuZ3RoLCBmID0gNCA9PSBPKHRoaXMuZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5oLmkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChcInVuZGVmaW5lZFwiID09PSB0eXBlb2YgVGV4dERlY29kZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJjKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoID0gXCJcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhayBiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oLmkgPSBuZXcgbC5UZXh0RGVjb2RlcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGIgPSAwOyBiIDwgZTsgYisrKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oLmggPSAhMCwgYSArPSB0aGlzLmguaS5kZWNvZGUoZFtiXSwgeyBzdHJlYW06IGYgJiYgYiA9PSBlIC0gMSB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZC5zcGxpY2UoMCwgZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaC5nICs9IGE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuQyA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGggPSB0aGlzLmguZztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBoID0gdGhpcy5nLmdhKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pID0gMjAwID09IGM7XHJcbiAgICAgICAgICAgICAgICAgICAgT2IodGhpcy5qLCB0aGlzLnUsIHRoaXMuQSwgdGhpcy5tLCB0aGlzLlgsIHIsIGMpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuJCAmJiAhdGhpcy5KKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbiwgdSA9IHRoaXMuZztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChuID0gdS5nID8gdS5nLmdldFJlc3BvbnNlSGVhZGVyKFwiWC1IVFRQLUluaXRpYWwtUmVzcG9uc2VcIikgOiBudWxsKSAmJiAhc2EobikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtID0gbjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrIGI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYyA9IG0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRih0aGlzLmosIHRoaXMubSwgYywgXCJJbml0aWFsIGhhbmRzaGFrZSByZXNwb25zZSB2aWEgWC1IVFRQLUluaXRpYWwtUmVzcG9uc2VcIiksIHRoaXMuSiA9ICEwLCBzYyh0aGlzLCBjKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaSA9ICExO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubyA9IDM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSigxMik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUCh0aGlzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYyh0aGlzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhayBhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuVSA/ICh0Yyh0aGlzLCByLCBoKSwgSmEgJiYgdGhpcy5pICYmIDMgPT0gciAmJiAoS2IodGhpcy5WLCB0aGlzLlcsIFwidGlja1wiLCB0aGlzLmZiKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuVy5zdGFydCgpKSkgOiAoRih0aGlzLmosIHRoaXMubSwgaCwgbnVsbCksIHNjKHRoaXMsIGgpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgNCA9PSByICYmIFAodGhpcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaSAmJiAhdGhpcy5JICYmICg0ID09IHIgPyB1Yyh0aGlzLmwsIHRoaXMpIDogKHRoaXMuaSA9ICExLCBsYyh0aGlzKSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDQwMCA9PSBjICYmIDAgPCBoLmluZGV4T2YoXCJVbmtub3duIFNJRFwiKSA/ICh0aGlzLm8gPSAzLCBKKDEyKSkgOiAodGhpcy5vID0gMCwgSigxMykpLCBQKHRoaXMpLCByYyh0aGlzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgY2F0Y2ggKHIpIHsgfVxyXG4gICAgZmluYWxseSB7IH1cclxufTtcclxuZnVuY3Rpb24gcWMoYSkgeyByZXR1cm4gYS5nID8gXCJHRVRcIiA9PSBhLnUgJiYgMiAhPSBhLksgJiYgYS5sLkJhIDogITE7IH1cclxuZnVuY3Rpb24gdGMoYSwgYiwgYykge1xyXG4gICAgdmFyIGQgPSAhMCwgZTtcclxuICAgIGZvciAoOyAhYS5JICYmIGEuQyA8IGMubGVuZ3RoOylcclxuICAgICAgICBpZiAoZSA9IHZjKGEsIGMpLCBlID09IGhjKSB7XHJcbiAgICAgICAgICAgIDQgPT0gYiAmJiAoYS5vID0gNCwgSigxNCksIGQgPSAhMSk7XHJcbiAgICAgICAgICAgIEYoYS5qLCBhLm0sIG51bGwsIFwiW0luY29tcGxldGUgUmVzcG9uc2VdXCIpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoZSA9PSBnYykge1xyXG4gICAgICAgICAgICBhLm8gPSA0O1xyXG4gICAgICAgICAgICBKKDE1KTtcclxuICAgICAgICAgICAgRihhLmosIGEubSwgYywgXCJbSW52YWxpZCBDaHVua11cIik7XHJcbiAgICAgICAgICAgIGQgPSAhMTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgRihhLmosIGEubSwgZSwgbnVsbCksIHNjKGEsIGUpO1xyXG4gICAgcWMoYSkgJiYgZSAhPSBoYyAmJiBlICE9IGdjICYmIChhLmguZyA9IFwiXCIsIGEuQyA9IDApO1xyXG4gICAgNCAhPSBiIHx8IDAgIT0gYy5sZW5ndGggfHwgYS5oLmggfHwgKGEubyA9IDEsIEooMTYpLCBkID0gITEpO1xyXG4gICAgYS5pID0gYS5pICYmIGQ7XHJcbiAgICBkID8gMCA8IGMubGVuZ3RoICYmICFhLmFhICYmIChhLmFhID0gITAsIGIgPSBhLmwsIGIuZyA9PSBhICYmIGIuJCAmJiAhYi5MICYmIChiLmguaW5mbyhcIkdyZWF0LCBubyBidWZmZXJpbmcgcHJveHkgZGV0ZWN0ZWQuIEJ5dGVzIHJlY2VpdmVkOiBcIiArIGMubGVuZ3RoKSwgd2MoYiksIGIuTCA9ICEwLCBKKDExKSkpIDogKEYoYS5qLCBhLm0sIGMsIFwiW0ludmFsaWQgQ2h1bmtlZCBSZXNwb25zZV1cIiksIFAoYSksIHJjKGEpKTtcclxufVxyXG5rLmZiID0gZnVuY3Rpb24gKCkgeyBpZiAodGhpcy5nKSB7XHJcbiAgICB2YXIgYSA9IE8odGhpcy5nKSwgYiA9IHRoaXMuZy5nYSgpO1xyXG4gICAgdGhpcy5DIDwgYi5sZW5ndGggJiYgKHBjKHRoaXMpLCB0Yyh0aGlzLCBhLCBiKSwgdGhpcy5pICYmIDQgIT0gYSAmJiBsYyh0aGlzKSk7XHJcbn0gfTtcclxuZnVuY3Rpb24gdmMoYSwgYikgeyB2YXIgYyA9IGEuQywgZCA9IGIuaW5kZXhPZihcIlxcblwiLCBjKTsgaWYgKC0xID09IGQpXHJcbiAgICByZXR1cm4gaGM7IGMgPSBOdW1iZXIoYi5zdWJzdHJpbmcoYywgZCkpOyBpZiAoaXNOYU4oYykpXHJcbiAgICByZXR1cm4gZ2M7IGQgKz0gMTsgaWYgKGQgKyBjID4gYi5sZW5ndGgpXHJcbiAgICByZXR1cm4gaGM7IGIgPSBiLnN1YnN0cihkLCBjKTsgYS5DID0gZCArIGM7IHJldHVybiBiOyB9XHJcbmsuY2FuY2VsID0gZnVuY3Rpb24gKCkgeyB0aGlzLkkgPSAhMDsgUCh0aGlzKTsgfTtcclxuZnVuY3Rpb24gbGMoYSkgeyBhLlkgPSBEYXRlLm5vdygpICsgYS5QOyB4YyhhLCBhLlApOyB9XHJcbmZ1bmN0aW9uIHhjKGEsIGIpIHsgaWYgKG51bGwgIT0gYS5CKVxyXG4gICAgdGhyb3cgRXJyb3IoXCJXYXRjaERvZyB0aW1lciBub3QgbnVsbFwiKTsgYS5CID0gSyhxKGEuZWIsIGEpLCBiKTsgfVxyXG5mdW5jdGlvbiBwYyhhKSB7IGEuQiAmJiAobC5jbGVhclRpbWVvdXQoYS5CKSwgYS5CID0gbnVsbCk7IH1cclxuay5lYiA9IGZ1bmN0aW9uICgpIHsgdGhpcy5CID0gbnVsbDsgdmFyIGEgPSBEYXRlLm5vdygpOyAwIDw9IGEgLSB0aGlzLlkgPyAoUWIodGhpcy5qLCB0aGlzLkEpLCAyICE9IHRoaXMuSyAmJiAoSSgzKSwgSigxNykpLCBQKHRoaXMpLCB0aGlzLm8gPSAyLCByYyh0aGlzKSkgOiB4Yyh0aGlzLCB0aGlzLlkgLSBhKTsgfTtcclxuZnVuY3Rpb24gcmMoYSkgeyAwID09IGEubC5HIHx8IGEuSSB8fCB1YyhhLmwsIGEpOyB9XHJcbmZ1bmN0aW9uIFAoYSkgeyBwYyhhKTsgdmFyIGIgPSBhLkw7IGIgJiYgXCJmdW5jdGlvblwiID09IHR5cGVvZiBiLm5hICYmIGIubmEoKTsgYS5MID0gbnVsbDsgRmIoYS5XKTsgTGIoYS5WKTsgYS5nICYmIChiID0gYS5nLCBhLmcgPSBudWxsLCBiLmFib3J0KCksIGIubmEoKSk7IH1cclxuZnVuY3Rpb24gc2MoYSwgYikge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICB2YXIgYyA9IGEubDtcclxuICAgICAgICBpZiAoMCAhPSBjLkcgJiYgKGMuZyA9PSBhIHx8IHljKGMuaSwgYSkpKVxyXG4gICAgICAgICAgICBpZiAoYy5JID0gYS5OLCAhYS5KICYmIHljKGMuaSwgYSkgJiYgMyA9PSBjLkcpIHtcclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSBjLkNhLmcucGFyc2UoYik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYXRjaCAobSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZCkgJiYgMyA9PSBkLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBlID0gZDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoMCA9PSBlWzBdKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWMudSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjLmcpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjLmcuRiArIDNFMyA8IGEuRilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHpjKGMpLCBBYyhjKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsgYTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBCYyhjKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBKKDE4KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgYy50YSA9IGVbMV0sIDAgPCBjLnRhIC0gYy5VICYmIDM3NTAwID4gZVsyXSAmJiBjLk4gJiYgMCA9PSBjLkEgJiYgIWMudiAmJiAoYy52ID0gSyhxKGMuYWIsIGMpLCA2RTMpKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoMSA+PSBDYyhjLmkpICYmIGMua2EpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMua2EoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAobSkgeyB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGMua2EgPSB2b2lkIDA7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIFEoYywgMTEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKChhLkogfHwgYy5nID09IGEpICYmIHpjKGMpLCAhc2EoYikpXHJcbiAgICAgICAgICAgICAgICBmb3IgKGUgPSBjLkNhLmcucGFyc2UoYiksIGIgPSAwOyBiIDwgZS5sZW5ndGg7IGIrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBtID0gZVtiXTtcclxuICAgICAgICAgICAgICAgICAgICBjLlUgPSBtWzBdO1xyXG4gICAgICAgICAgICAgICAgICAgIG0gPSBtWzFdO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgyID09IGMuRylcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFwiY1wiID09IG1bMF0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMuSiA9IG1bMV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjLmxhID0gbVsyXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByID0gbVszXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bGwgIT0gciAmJiAoYy5tYSA9IHIsIGMuaC5pbmZvKFwiVkVSPVwiICsgYy5tYSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIEcgPSBtWzRdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVsbCAhPSBHICYmIChjLnphID0gRywgYy5oLmluZm8oXCJTVkVSPVwiICsgYy56YSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIERhID0gbVs1XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bGwgIT0gRGEgJiYgXCJudW1iZXJcIiA9PT0gdHlwZW9mIERhICYmIDAgPCBEYSAmJiAoZCA9IDEuNSAqIERhLCBjLksgPSBkLCBjLmguaW5mbyhcImJhY2tDaGFubmVsUmVxdWVzdFRpbWVvdXRNc189XCIgKyBkKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkID0gYztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYSA9IGEuZztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjYSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBFYSA9IGNhLmcgPyBjYS5nLmdldFJlc3BvbnNlSGVhZGVyKFwiWC1DbGllbnQtV2lyZS1Qcm90b2NvbFwiKSA6IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEVhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmID0gZC5pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAhZi5nICYmICh3KEVhLCBcInNwZHlcIikgfHwgdyhFYSwgXCJxdWljXCIpIHx8IHcoRWEsIFwiaDJcIikpICYmIChmLmogPSBmLmwsIGYuZyA9IG5ldyBTZXQsIGYuaCAmJiAoRGMoZiwgZi5oKSwgZi5oID0gbnVsbCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5EKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4YiA9IGNhLmcgPyBjYS5nLmdldFJlc3BvbnNlSGVhZGVyKFwiWC1IVFRQLVNlc3Npb24tSWRcIikgOiBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4YiAmJiAoZC5zYSA9IHhiLCBSKGQuRiwgZC5ELCB4YikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMuRyA9IDM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjLmogJiYgYy5qLnhhKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjLiQgJiYgKGMuTyA9IERhdGUubm93KCkgLSBhLkYsIGMuaC5pbmZvKFwiSGFuZHNoYWtlIFJUVDogXCIgKyBjLk8gKyBcIm1zXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQgPSBjO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGggPSBhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5vYSA9IEVjKGQsIGQuSCA/IGQubGEgOiBudWxsLCBkLlcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGguSikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZjKGQuaSwgaCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG4gPSBoLCB1ID0gZC5LO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHUgJiYgbi5zZXRUaW1lb3V0KHUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4uQiAmJiAocGMobiksIGxjKG4pKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLmcgPSBoO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdjKGQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgMCA8IGMubC5sZW5ndGggJiYgSGMoYyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdG9wXCIgIT0gbVswXSAmJiBcImNsb3NlXCIgIT0gbVswXSB8fCBRKGMsIDcpO1xyXG4gICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgMyA9PSBjLkcgJiYgKFwic3RvcFwiID09IG1bMF0gfHwgXCJjbG9zZVwiID09IG1bMF0gPyBcInN0b3BcIiA9PSBtWzBdID8gUShjLCA3KSA6IEljKGMpIDogXCJub29wXCIgIT0gbVswXSAmJiBjLmogJiYgYy5qLndhKG0pLCBjLkEgPSAwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICBJKDQpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKG0pIHsgfVxyXG59XHJcbmZ1bmN0aW9uIEpjKGEpIHsgaWYgKGEuUiAmJiBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIGEuUilcclxuICAgIHJldHVybiBhLlIoKTsgaWYgKFwic3RyaW5nXCIgPT09IHR5cGVvZiBhKVxyXG4gICAgcmV0dXJuIGEuc3BsaXQoXCJcIik7IGlmIChiYShhKSkge1xyXG4gICAgZm9yICh2YXIgYiA9IFtdLCBjID0gYS5sZW5ndGgsIGQgPSAwOyBkIDwgYzsgZCsrKVxyXG4gICAgICAgIGIucHVzaChhW2RdKTtcclxuICAgIHJldHVybiBiO1xyXG59IGIgPSBbXTsgYyA9IDA7IGZvciAoZCBpbiBhKVxyXG4gICAgYltjKytdID0gYVtkXTsgcmV0dXJuIGI7IH1cclxuZnVuY3Rpb24gS2MoYSwgYikgeyBpZiAoYS5mb3JFYWNoICYmIFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgYS5mb3JFYWNoKVxyXG4gICAgYS5mb3JFYWNoKGIsIHZvaWQgMCk7XHJcbmVsc2UgaWYgKGJhKGEpIHx8IFwic3RyaW5nXCIgPT09IHR5cGVvZiBhKVxyXG4gICAgbmEoYSwgYiwgdm9pZCAwKTtcclxuZWxzZSB7XHJcbiAgICBpZiAoYS5UICYmIFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgYS5UKVxyXG4gICAgICAgIHZhciBjID0gYS5UKCk7XHJcbiAgICBlbHNlIGlmIChhLlIgJiYgXCJmdW5jdGlvblwiID09IHR5cGVvZiBhLlIpXHJcbiAgICAgICAgYyA9IHZvaWQgMDtcclxuICAgIGVsc2UgaWYgKGJhKGEpIHx8IFwic3RyaW5nXCIgPT09IHR5cGVvZiBhKSB7XHJcbiAgICAgICAgYyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIGQgPSBhLmxlbmd0aCwgZSA9IDA7IGUgPCBkOyBlKyspXHJcbiAgICAgICAgICAgIGMucHVzaChlKTtcclxuICAgIH1cclxuICAgIGVsc2VcclxuICAgICAgICBmb3IgKGUgaW4gYyA9IFtdLCBkID0gMCwgYSlcclxuICAgICAgICAgICAgY1tkKytdID0gZTtcclxuICAgIGQgPSBKYyhhKTtcclxuICAgIGUgPSBkLmxlbmd0aDtcclxuICAgIGZvciAodmFyIGYgPSAwOyBmIDwgZTsgZisrKVxyXG4gICAgICAgIGIuY2FsbCh2b2lkIDAsIGRbZl0sIGMgJiYgY1tmXSwgYSk7XHJcbn0gfVxyXG5mdW5jdGlvbiBTKGEsIGIpIHsgdGhpcy5oID0ge307IHRoaXMuZyA9IFtdOyB0aGlzLmkgPSAwOyB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGg7IGlmICgxIDwgYykge1xyXG4gICAgaWYgKGMgJSAyKVxyXG4gICAgICAgIHRocm93IEVycm9yKFwiVW5ldmVuIG51bWJlciBvZiBhcmd1bWVudHNcIik7XHJcbiAgICBmb3IgKHZhciBkID0gMDsgZCA8IGM7IGQgKz0gMilcclxuICAgICAgICB0aGlzLnNldChhcmd1bWVudHNbZF0sIGFyZ3VtZW50c1tkICsgMV0pO1xyXG59XHJcbmVsc2UgaWYgKGEpXHJcbiAgICBpZiAoYSBpbnN0YW5jZW9mIFMpXHJcbiAgICAgICAgZm9yIChjID0gYS5UKCksIGQgPSAwOyBkIDwgYy5sZW5ndGg7IGQrKylcclxuICAgICAgICAgICAgdGhpcy5zZXQoY1tkXSwgYS5nZXQoY1tkXSkpO1xyXG4gICAgZWxzZVxyXG4gICAgICAgIGZvciAoZCBpbiBhKVxyXG4gICAgICAgICAgICB0aGlzLnNldChkLCBhW2RdKTsgfVxyXG5rID0gUy5wcm90b3R5cGU7XHJcbmsuUiA9IGZ1bmN0aW9uICgpIHsgTGModGhpcyk7IGZvciAodmFyIGEgPSBbXSwgYiA9IDA7IGIgPCB0aGlzLmcubGVuZ3RoOyBiKyspXHJcbiAgICBhLnB1c2godGhpcy5oW3RoaXMuZ1tiXV0pOyByZXR1cm4gYTsgfTtcclxuay5UID0gZnVuY3Rpb24gKCkgeyBMYyh0aGlzKTsgcmV0dXJuIHRoaXMuZy5jb25jYXQoKTsgfTtcclxuZnVuY3Rpb24gTGMoYSkgeyBpZiAoYS5pICE9IGEuZy5sZW5ndGgpIHtcclxuICAgIGZvciAodmFyIGIgPSAwLCBjID0gMDsgYiA8IGEuZy5sZW5ndGg7KSB7XHJcbiAgICAgICAgdmFyIGQgPSBhLmdbYl07XHJcbiAgICAgICAgVChhLmgsIGQpICYmIChhLmdbYysrXSA9IGQpO1xyXG4gICAgICAgIGIrKztcclxuICAgIH1cclxuICAgIGEuZy5sZW5ndGggPSBjO1xyXG59IGlmIChhLmkgIT0gYS5nLmxlbmd0aCkge1xyXG4gICAgdmFyIGUgPSB7fTtcclxuICAgIGZvciAoYyA9IGIgPSAwOyBiIDwgYS5nLmxlbmd0aDspXHJcbiAgICAgICAgZCA9IGEuZ1tiXSwgVChlLCBkKSB8fCAoYS5nW2MrK10gPSBkLCBlW2RdID0gMSksIGIrKztcclxuICAgIGEuZy5sZW5ndGggPSBjO1xyXG59IH1cclxuay5nZXQgPSBmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gVCh0aGlzLmgsIGEpID8gdGhpcy5oW2FdIDogYjsgfTtcclxuay5zZXQgPSBmdW5jdGlvbiAoYSwgYikgeyBUKHRoaXMuaCwgYSkgfHwgKHRoaXMuaSsrLCB0aGlzLmcucHVzaChhKSk7IHRoaXMuaFthXSA9IGI7IH07XHJcbmsuZm9yRWFjaCA9IGZ1bmN0aW9uIChhLCBiKSB7IGZvciAodmFyIGMgPSB0aGlzLlQoKSwgZCA9IDA7IGQgPCBjLmxlbmd0aDsgZCsrKSB7XHJcbiAgICB2YXIgZSA9IGNbZF0sIGYgPSB0aGlzLmdldChlKTtcclxuICAgIGEuY2FsbChiLCBmLCBlLCB0aGlzKTtcclxufSB9O1xyXG5mdW5jdGlvbiBUKGEsIGIpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChhLCBiKTsgfVxyXG52YXIgTWMgPSAvXig/OihbXjovPyMuXSspOik/KD86XFwvXFwvKD86KFteXFxcXC8/I10qKUApPyhbXlxcXFwvPyNdKj8pKD86OihbMC05XSspKT8oPz1bXFxcXC8/I118JCkpPyhbXj8jXSspPyg/OlxcPyhbXiNdKikpPyg/OiMoW1xcc1xcU10qKSk/JC87XHJcbmZ1bmN0aW9uIE5jKGEsIGIpIHsgaWYgKGEpIHtcclxuICAgIGEgPSBhLnNwbGl0KFwiJlwiKTtcclxuICAgIGZvciAodmFyIGMgPSAwOyBjIDwgYS5sZW5ndGg7IGMrKykge1xyXG4gICAgICAgIHZhciBkID0gYVtjXS5pbmRleE9mKFwiPVwiKSwgZSA9IG51bGw7XHJcbiAgICAgICAgaWYgKDAgPD0gZCkge1xyXG4gICAgICAgICAgICB2YXIgZiA9IGFbY10uc3Vic3RyaW5nKDAsIGQpO1xyXG4gICAgICAgICAgICBlID0gYVtjXS5zdWJzdHJpbmcoZCArIDEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIGYgPSBhW2NdO1xyXG4gICAgICAgIGIoZiwgZSA/IGRlY29kZVVSSUNvbXBvbmVudChlLnJlcGxhY2UoL1xcKy9nLCBcIiBcIikpIDogXCJcIik7XHJcbiAgICB9XHJcbn0gfVxyXG5mdW5jdGlvbiBVKGEsIGIpIHsgdGhpcy5pID0gdGhpcy5zID0gdGhpcy5qID0gXCJcIjsgdGhpcy5tID0gbnVsbDsgdGhpcy5vID0gdGhpcy5sID0gXCJcIjsgdGhpcy5nID0gITE7IGlmIChhIGluc3RhbmNlb2YgVSkge1xyXG4gICAgdGhpcy5nID0gdm9pZCAwICE9PSBiID8gYiA6IGEuZztcclxuICAgIE9jKHRoaXMsIGEuaik7XHJcbiAgICB0aGlzLnMgPSBhLnM7XHJcbiAgICBQYyh0aGlzLCBhLmkpO1xyXG4gICAgUWModGhpcywgYS5tKTtcclxuICAgIHRoaXMubCA9IGEubDtcclxuICAgIGIgPSBhLmg7XHJcbiAgICB2YXIgYyA9IG5ldyBSYztcclxuICAgIGMuaSA9IGIuaTtcclxuICAgIGIuZyAmJiAoYy5nID0gbmV3IFMoYi5nKSwgYy5oID0gYi5oKTtcclxuICAgIFNjKHRoaXMsIGMpO1xyXG4gICAgdGhpcy5vID0gYS5vO1xyXG59XHJcbmVsc2VcclxuICAgIGEgJiYgKGMgPSBTdHJpbmcoYSkubWF0Y2goTWMpKSA/ICh0aGlzLmcgPSAhIWIsIE9jKHRoaXMsIGNbMV0gfHwgXCJcIiwgITApLCB0aGlzLnMgPSBUYyhjWzJdIHx8IFwiXCIpLCBQYyh0aGlzLCBjWzNdIHx8IFwiXCIsICEwKSwgUWModGhpcywgY1s0XSksIHRoaXMubCA9IFRjKGNbNV0gfHwgXCJcIiwgITApLCBTYyh0aGlzLCBjWzZdIHx8IFwiXCIsICEwKSwgdGhpcy5vID0gVGMoY1s3XSB8fCBcIlwiKSkgOiAodGhpcy5nID0gISFiLCB0aGlzLmggPSBuZXcgUmMobnVsbCwgdGhpcy5nKSk7IH1cclxuVS5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7IHZhciBhID0gW10sIGIgPSB0aGlzLmo7IGIgJiYgYS5wdXNoKFVjKGIsIFZjLCAhMCksIFwiOlwiKTsgdmFyIGMgPSB0aGlzLmk7IGlmIChjIHx8IFwiZmlsZVwiID09IGIpXHJcbiAgICBhLnB1c2goXCIvL1wiKSwgKGIgPSB0aGlzLnMpICYmIGEucHVzaChVYyhiLCBWYywgITApLCBcIkBcIiksIGEucHVzaChlbmNvZGVVUklDb21wb25lbnQoU3RyaW5nKGMpKS5yZXBsYWNlKC8lMjUoWzAtOWEtZkEtRl17Mn0pL2csIFwiJSQxXCIpKSwgYyA9IHRoaXMubSwgbnVsbCAhPSBjICYmIGEucHVzaChcIjpcIiwgU3RyaW5nKGMpKTsgaWYgKGMgPSB0aGlzLmwpXHJcbiAgICB0aGlzLmkgJiYgXCIvXCIgIT0gYy5jaGFyQXQoMCkgJiYgYS5wdXNoKFwiL1wiKSwgYS5wdXNoKFVjKGMsIFwiL1wiID09IGMuY2hhckF0KDApID8gV2MgOiBYYywgITApKTsgKGMgPSB0aGlzLmgudG9TdHJpbmcoKSkgJiYgYS5wdXNoKFwiP1wiLCBjKTsgKGMgPSB0aGlzLm8pICYmIGEucHVzaChcIiNcIiwgVWMoYywgWWMpKTsgcmV0dXJuIGEuam9pbihcIlwiKTsgfTtcclxuZnVuY3Rpb24gTihhKSB7IHJldHVybiBuZXcgVShhKTsgfVxyXG5mdW5jdGlvbiBPYyhhLCBiLCBjKSB7IGEuaiA9IGMgPyBUYyhiLCAhMCkgOiBiOyBhLmogJiYgKGEuaiA9IGEuai5yZXBsYWNlKC86JC8sIFwiXCIpKTsgfVxyXG5mdW5jdGlvbiBQYyhhLCBiLCBjKSB7IGEuaSA9IGMgPyBUYyhiLCAhMCkgOiBiOyB9XHJcbmZ1bmN0aW9uIFFjKGEsIGIpIHsgaWYgKGIpIHtcclxuICAgIGIgPSBOdW1iZXIoYik7XHJcbiAgICBpZiAoaXNOYU4oYikgfHwgMCA+IGIpXHJcbiAgICAgICAgdGhyb3cgRXJyb3IoXCJCYWQgcG9ydCBudW1iZXIgXCIgKyBiKTtcclxuICAgIGEubSA9IGI7XHJcbn1cclxuZWxzZVxyXG4gICAgYS5tID0gbnVsbDsgfVxyXG5mdW5jdGlvbiBTYyhhLCBiLCBjKSB7IGIgaW5zdGFuY2VvZiBSYyA/IChhLmggPSBiLCBaYyhhLmgsIGEuZykpIDogKGMgfHwgKGIgPSBVYyhiLCAkYykpLCBhLmggPSBuZXcgUmMoYiwgYS5nKSk7IH1cclxuZnVuY3Rpb24gUihhLCBiLCBjKSB7IGEuaC5zZXQoYiwgYyk7IH1cclxuZnVuY3Rpb24gamMoYSkgeyBSKGEsIFwienhcIiwgTWF0aC5mbG9vcigyMTQ3NDgzNjQ4ICogTWF0aC5yYW5kb20oKSkudG9TdHJpbmcoMzYpICsgTWF0aC5hYnMoTWF0aC5mbG9vcigyMTQ3NDgzNjQ4ICogTWF0aC5yYW5kb20oKSkgXiBEYXRlLm5vdygpKS50b1N0cmluZygzNikpOyByZXR1cm4gYTsgfVxyXG5mdW5jdGlvbiBhZChhKSB7IHJldHVybiBhIGluc3RhbmNlb2YgVSA/IE4oYSkgOiBuZXcgVShhLCB2b2lkIDApOyB9XHJcbmZ1bmN0aW9uIGJkKGEsIGIsIGMsIGQpIHsgdmFyIGUgPSBuZXcgVShudWxsLCB2b2lkIDApOyBhICYmIE9jKGUsIGEpOyBiICYmIFBjKGUsIGIpOyBjICYmIFFjKGUsIGMpOyBkICYmIChlLmwgPSBkKTsgcmV0dXJuIGU7IH1cclxuZnVuY3Rpb24gVGMoYSwgYikgeyByZXR1cm4gYSA/IGIgPyBkZWNvZGVVUkkoYS5yZXBsYWNlKC8lMjUvZywgXCIlMjUyNVwiKSkgOiBkZWNvZGVVUklDb21wb25lbnQoYSkgOiBcIlwiOyB9XHJcbmZ1bmN0aW9uIFVjKGEsIGIsIGMpIHsgcmV0dXJuIFwic3RyaW5nXCIgPT09IHR5cGVvZiBhID8gKGEgPSBlbmNvZGVVUkkoYSkucmVwbGFjZShiLCBjZCksIGMgJiYgKGEgPSBhLnJlcGxhY2UoLyUyNShbMC05YS1mQS1GXXsyfSkvZywgXCIlJDFcIikpLCBhKSA6IG51bGw7IH1cclxuZnVuY3Rpb24gY2QoYSkgeyBhID0gYS5jaGFyQ29kZUF0KDApOyByZXR1cm4gXCIlXCIgKyAoYSA+PiA0ICYgMTUpLnRvU3RyaW5nKDE2KSArIChhICYgMTUpLnRvU3RyaW5nKDE2KTsgfVxyXG52YXIgVmMgPSAvWyNcXC9cXD9AXS9nLCBYYyA9IC9bI1xcPzpdL2csIFdjID0gL1sjXFw/XS9nLCAkYyA9IC9bI1xcP0BdL2csIFljID0gLyMvZztcclxuZnVuY3Rpb24gUmMoYSwgYikgeyB0aGlzLmggPSB0aGlzLmcgPSBudWxsOyB0aGlzLmkgPSBhIHx8IG51bGw7IHRoaXMuaiA9ICEhYjsgfVxyXG5mdW5jdGlvbiBWKGEpIHsgYS5nIHx8IChhLmcgPSBuZXcgUywgYS5oID0gMCwgYS5pICYmIE5jKGEuaSwgZnVuY3Rpb24gKGIsIGMpIHsgYS5hZGQoZGVjb2RlVVJJQ29tcG9uZW50KGIucmVwbGFjZSgvXFwrL2csIFwiIFwiKSksIGMpOyB9KSk7IH1cclxuayA9IFJjLnByb3RvdHlwZTtcclxuay5hZGQgPSBmdW5jdGlvbiAoYSwgYikgeyBWKHRoaXMpOyB0aGlzLmkgPSBudWxsOyBhID0gVyh0aGlzLCBhKTsgdmFyIGMgPSB0aGlzLmcuZ2V0KGEpOyBjIHx8IHRoaXMuZy5zZXQoYSwgYyA9IFtdKTsgYy5wdXNoKGIpOyB0aGlzLmggKz0gMTsgcmV0dXJuIHRoaXM7IH07XHJcbmZ1bmN0aW9uIGRkKGEsIGIpIHsgVihhKTsgYiA9IFcoYSwgYik7IFQoYS5nLmgsIGIpICYmIChhLmkgPSBudWxsLCBhLmggLT0gYS5nLmdldChiKS5sZW5ndGgsIGEgPSBhLmcsIFQoYS5oLCBiKSAmJiAoZGVsZXRlIGEuaFtiXSwgYS5pLS0sIGEuZy5sZW5ndGggPiAyICogYS5pICYmIExjKGEpKSk7IH1cclxuZnVuY3Rpb24gZWQoYSwgYikgeyBWKGEpOyBiID0gVyhhLCBiKTsgcmV0dXJuIFQoYS5nLmgsIGIpOyB9XHJcbmsuZm9yRWFjaCA9IGZ1bmN0aW9uIChhLCBiKSB7IFYodGhpcyk7IHRoaXMuZy5mb3JFYWNoKGZ1bmN0aW9uIChjLCBkKSB7IG5hKGMsIGZ1bmN0aW9uIChlKSB7IGEuY2FsbChiLCBlLCBkLCB0aGlzKTsgfSwgdGhpcyk7IH0sIHRoaXMpOyB9O1xyXG5rLlQgPSBmdW5jdGlvbiAoKSB7IFYodGhpcyk7IGZvciAodmFyIGEgPSB0aGlzLmcuUigpLCBiID0gdGhpcy5nLlQoKSwgYyA9IFtdLCBkID0gMDsgZCA8IGIubGVuZ3RoOyBkKyspXHJcbiAgICBmb3IgKHZhciBlID0gYVtkXSwgZiA9IDA7IGYgPCBlLmxlbmd0aDsgZisrKVxyXG4gICAgICAgIGMucHVzaChiW2RdKTsgcmV0dXJuIGM7IH07XHJcbmsuUiA9IGZ1bmN0aW9uIChhKSB7IFYodGhpcyk7IHZhciBiID0gW107IGlmIChcInN0cmluZ1wiID09PSB0eXBlb2YgYSlcclxuICAgIGVkKHRoaXMsIGEpICYmIChiID0gcWEoYiwgdGhpcy5nLmdldChXKHRoaXMsIGEpKSkpO1xyXG5lbHNlIHtcclxuICAgIGEgPSB0aGlzLmcuUigpO1xyXG4gICAgZm9yICh2YXIgYyA9IDA7IGMgPCBhLmxlbmd0aDsgYysrKVxyXG4gICAgICAgIGIgPSBxYShiLCBhW2NdKTtcclxufSByZXR1cm4gYjsgfTtcclxuay5zZXQgPSBmdW5jdGlvbiAoYSwgYikgeyBWKHRoaXMpOyB0aGlzLmkgPSBudWxsOyBhID0gVyh0aGlzLCBhKTsgZWQodGhpcywgYSkgJiYgKHRoaXMuaCAtPSB0aGlzLmcuZ2V0KGEpLmxlbmd0aCk7IHRoaXMuZy5zZXQoYSwgW2JdKTsgdGhpcy5oICs9IDE7IHJldHVybiB0aGlzOyB9O1xyXG5rLmdldCA9IGZ1bmN0aW9uIChhLCBiKSB7IGlmICghYSlcclxuICAgIHJldHVybiBiOyBhID0gdGhpcy5SKGEpOyByZXR1cm4gMCA8IGEubGVuZ3RoID8gU3RyaW5nKGFbMF0pIDogYjsgfTtcclxuZnVuY3Rpb24gbWMoYSwgYiwgYykgeyBkZChhLCBiKTsgMCA8IGMubGVuZ3RoICYmIChhLmkgPSBudWxsLCBhLmcuc2V0KFcoYSwgYiksIHJhKGMpKSwgYS5oICs9IGMubGVuZ3RoKTsgfVxyXG5rLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgeyBpZiAodGhpcy5pKVxyXG4gICAgcmV0dXJuIHRoaXMuaTsgaWYgKCF0aGlzLmcpXHJcbiAgICByZXR1cm4gXCJcIjsgZm9yICh2YXIgYSA9IFtdLCBiID0gdGhpcy5nLlQoKSwgYyA9IDA7IGMgPCBiLmxlbmd0aDsgYysrKSB7XHJcbiAgICB2YXIgZCA9IGJbY10sIGUgPSBlbmNvZGVVUklDb21wb25lbnQoU3RyaW5nKGQpKTtcclxuICAgIGQgPSB0aGlzLlIoZCk7XHJcbiAgICBmb3IgKHZhciBmID0gMDsgZiA8IGQubGVuZ3RoOyBmKyspIHtcclxuICAgICAgICB2YXIgaCA9IGU7XHJcbiAgICAgICAgXCJcIiAhPT0gZFtmXSAmJiAoaCArPSBcIj1cIiArIGVuY29kZVVSSUNvbXBvbmVudChTdHJpbmcoZFtmXSkpKTtcclxuICAgICAgICBhLnB1c2goaCk7XHJcbiAgICB9XHJcbn0gcmV0dXJuIHRoaXMuaSA9IGEuam9pbihcIiZcIik7IH07XHJcbmZ1bmN0aW9uIFcoYSwgYikgeyBiID0gU3RyaW5nKGIpOyBhLmogJiYgKGIgPSBiLnRvTG93ZXJDYXNlKCkpOyByZXR1cm4gYjsgfVxyXG5mdW5jdGlvbiBaYyhhLCBiKSB7IGIgJiYgIWEuaiAmJiAoVihhKSwgYS5pID0gbnVsbCwgYS5nLmZvckVhY2goZnVuY3Rpb24gKGMsIGQpIHsgdmFyIGUgPSBkLnRvTG93ZXJDYXNlKCk7IGQgIT0gZSAmJiAoZGQodGhpcywgZCksIG1jKHRoaXMsIGUsIGMpKTsgfSwgYSkpOyBhLmogPSBiOyB9XHJcbnZhciBmZCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIGZkKGEsIGIpIHtcclxuICAgICAgICB0aGlzLmggPSBhO1xyXG4gICAgICAgIHRoaXMuZyA9IGI7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZmQ7XHJcbn0oKSk7XHJcbmZ1bmN0aW9uIGdkKGEpIHsgdGhpcy5sID0gYSB8fCBoZDsgbC5QZXJmb3JtYW5jZU5hdmlnYXRpb25UaW1pbmcgPyAoYSA9IGwucGVyZm9ybWFuY2UuZ2V0RW50cmllc0J5VHlwZShcIm5hdmlnYXRpb25cIiksIGEgPSAwIDwgYS5sZW5ndGggJiYgKFwiaHFcIiA9PSBhWzBdLm5leHRIb3BQcm90b2NvbCB8fCBcImgyXCIgPT0gYVswXS5uZXh0SG9wUHJvdG9jb2wpKSA6IGEgPSAhIShsLmcgJiYgbC5nLkVhICYmIGwuZy5FYSgpICYmIGwuZy5FYSgpLlpiKTsgdGhpcy5qID0gYSA/IHRoaXMubCA6IDE7IHRoaXMuZyA9IG51bGw7IDEgPCB0aGlzLmogJiYgKHRoaXMuZyA9IG5ldyBTZXQpOyB0aGlzLmggPSBudWxsOyB0aGlzLmkgPSBbXTsgfVxyXG52YXIgaGQgPSAxMDtcclxuZnVuY3Rpb24gaWQoYSkgeyByZXR1cm4gYS5oID8gITAgOiBhLmcgPyBhLmcuc2l6ZSA+PSBhLmogOiAhMTsgfVxyXG5mdW5jdGlvbiBDYyhhKSB7IHJldHVybiBhLmggPyAxIDogYS5nID8gYS5nLnNpemUgOiAwOyB9XHJcbmZ1bmN0aW9uIHljKGEsIGIpIHsgcmV0dXJuIGEuaCA/IGEuaCA9PSBiIDogYS5nID8gYS5nLmhhcyhiKSA6ICExOyB9XHJcbmZ1bmN0aW9uIERjKGEsIGIpIHsgYS5nID8gYS5nLmFkZChiKSA6IGEuaCA9IGI7IH1cclxuZnVuY3Rpb24gRmMoYSwgYikgeyBhLmggJiYgYS5oID09IGIgPyBhLmggPSBudWxsIDogYS5nICYmIGEuZy5oYXMoYikgJiYgYS5nLmRlbGV0ZShiKTsgfVxyXG5nZC5wcm90b3R5cGUuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGVfMSwgX2E7XHJcbiAgICB0aGlzLmkgPSBqZCh0aGlzKTtcclxuICAgIGlmICh0aGlzLmgpXHJcbiAgICAgICAgdGhpcy5oLmNhbmNlbCgpLCB0aGlzLmggPSBudWxsO1xyXG4gICAgZWxzZSBpZiAodGhpcy5nICYmIDAgIT09IHRoaXMuZy5zaXplKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgZm9yICh2YXIgX2IgPSBfX3ZhbHVlcyh0aGlzLmcudmFsdWVzKCkpLCBfYyA9IF9iLm5leHQoKTsgIV9jLmRvbmU7IF9jID0gX2IubmV4dCgpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYSA9IF9jLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgYS5jYW5jZWwoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfVxyXG4gICAgICAgIGZpbmFsbHkge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgaWYgKF9jICYmICFfYy5kb25lICYmIChfYSA9IF9iLnJldHVybikpIF9hLmNhbGwoX2IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5nLmNsZWFyKCk7XHJcbiAgICB9XHJcbn07XHJcbmZ1bmN0aW9uIGpkKGEpIHtcclxuICAgIHZhciBlXzIsIF9hO1xyXG4gICAgaWYgKG51bGwgIT0gYS5oKVxyXG4gICAgICAgIHJldHVybiBhLmkuY29uY2F0KGEuaC5EKTtcclxuICAgIGlmIChudWxsICE9IGEuZyAmJiAwICE9PSBhLmcuc2l6ZSkge1xyXG4gICAgICAgIHZhciBiID0gYS5pO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIF9iID0gX192YWx1ZXMoYS5nLnZhbHVlcygpKSwgX2MgPSBfYi5uZXh0KCk7ICFfYy5kb25lOyBfYyA9IF9iLm5leHQoKSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGMgPSBfYy52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGIgPSBiLmNvbmNhdChjLkQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChlXzJfMSkgeyBlXzIgPSB7IGVycm9yOiBlXzJfMSB9OyB9XHJcbiAgICAgICAgZmluYWxseSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoX2MgJiYgIV9jLmRvbmUgJiYgKF9hID0gX2IucmV0dXJuKSkgX2EuY2FsbChfYik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZmluYWxseSB7IGlmIChlXzIpIHRocm93IGVfMi5lcnJvcjsgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYjtcclxuICAgIH1cclxuICAgIHJldHVybiByYShhLmkpO1xyXG59XHJcbmZ1bmN0aW9uIGtkKCkgeyB9XHJcbmtkLnByb3RvdHlwZS5zdHJpbmdpZnkgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gbC5KU09OLnN0cmluZ2lmeShhLCB2b2lkIDApOyB9O1xyXG5rZC5wcm90b3R5cGUucGFyc2UgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gbC5KU09OLnBhcnNlKGEsIHZvaWQgMCk7IH07XHJcbmZ1bmN0aW9uIGxkKCkgeyB0aGlzLmcgPSBuZXcga2Q7IH1cclxuZnVuY3Rpb24gbWQoYSwgYiwgYykgeyB2YXIgZCA9IGMgfHwgXCJcIjsgdHJ5IHtcclxuICAgIEtjKGEsIGZ1bmN0aW9uIChlLCBmKSB7IHZhciBoID0gZTsgcChlKSAmJiAoaCA9IHJiKGUpKTsgYi5wdXNoKGQgKyBmICsgXCI9XCIgKyBlbmNvZGVVUklDb21wb25lbnQoaCkpOyB9KTtcclxufVxyXG5jYXRjaCAoZSkge1xyXG4gICAgdGhyb3cgYi5wdXNoKGQgKyBcInR5cGU9XCIgKyBlbmNvZGVVUklDb21wb25lbnQoXCJfYmFkbWFwXCIpKSwgZTtcclxufSB9XHJcbmZ1bmN0aW9uIG5kKGEsIGIpIHsgdmFyIGMgPSBuZXcgTWI7IGlmIChsLkltYWdlKSB7XHJcbiAgICB2YXIgZF8xID0gbmV3IEltYWdlO1xyXG4gICAgZF8xLm9ubG9hZCA9IGphKG9kLCBjLCBkXzEsIFwiVGVzdExvYWRJbWFnZTogbG9hZGVkXCIsICEwLCBiKTtcclxuICAgIGRfMS5vbmVycm9yID0gamEob2QsIGMsIGRfMSwgXCJUZXN0TG9hZEltYWdlOiBlcnJvclwiLCAhMSwgYik7XHJcbiAgICBkXzEub25hYm9ydCA9IGphKG9kLCBjLCBkXzEsIFwiVGVzdExvYWRJbWFnZTogYWJvcnRcIiwgITEsIGIpO1xyXG4gICAgZF8xLm9udGltZW91dCA9IGphKG9kLCBjLCBkXzEsIFwiVGVzdExvYWRJbWFnZTogdGltZW91dFwiLCAhMSwgYik7XHJcbiAgICBsLnNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyBpZiAoZF8xLm9udGltZW91dClcclxuICAgICAgICBkXzEub250aW1lb3V0KCk7IH0sIDFFNCk7XHJcbiAgICBkXzEuc3JjID0gYTtcclxufVxyXG5lbHNlXHJcbiAgICBiKCExKTsgfVxyXG5mdW5jdGlvbiBvZChhLCBiLCBjLCBkLCBlKSB7IHRyeSB7XHJcbiAgICBiLm9ubG9hZCA9IG51bGwsIGIub25lcnJvciA9IG51bGwsIGIub25hYm9ydCA9IG51bGwsIGIub250aW1lb3V0ID0gbnVsbCwgZShkKTtcclxufVxyXG5jYXRjaCAoZikgeyB9IH1cclxuZnVuY3Rpb24gcGQoYSkgeyB0aGlzLmwgPSBhLiRiIHx8IG51bGw7IHRoaXMuaiA9IGEuaWIgfHwgITE7IH1cclxudChwZCwgWWIpO1xyXG5wZC5wcm90b3R5cGUuZyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5ldyBxZCh0aGlzLmwsIHRoaXMuaik7IH07XHJcbnBkLnByb3RvdHlwZS5pID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGZ1bmN0aW9uICgpIHsgcmV0dXJuIGE7IH07IH0oe30pO1xyXG5mdW5jdGlvbiBxZChhLCBiKSB7IEMuY2FsbCh0aGlzKTsgdGhpcy5EID0gYTsgdGhpcy51ID0gYjsgdGhpcy5tID0gdm9pZCAwOyB0aGlzLnJlYWR5U3RhdGUgPSByZDsgdGhpcy5zdGF0dXMgPSAwOyB0aGlzLnJlc3BvbnNlVHlwZSA9IHRoaXMucmVzcG9uc2VUZXh0ID0gdGhpcy5yZXNwb25zZSA9IHRoaXMuc3RhdHVzVGV4dCA9IFwiXCI7IHRoaXMub25yZWFkeXN0YXRlY2hhbmdlID0gbnVsbDsgdGhpcy52ID0gbmV3IEhlYWRlcnM7IHRoaXMuaCA9IG51bGw7IHRoaXMuQyA9IFwiR0VUXCI7IHRoaXMuQiA9IFwiXCI7IHRoaXMuZyA9ICExOyB0aGlzLkEgPSB0aGlzLmogPSB0aGlzLmwgPSBudWxsOyB9XHJcbnQocWQsIEMpO1xyXG52YXIgcmQgPSAwO1xyXG5rID0gcWQucHJvdG90eXBlO1xyXG5rLm9wZW4gPSBmdW5jdGlvbiAoYSwgYikgeyBpZiAodGhpcy5yZWFkeVN0YXRlICE9IHJkKVxyXG4gICAgdGhyb3cgdGhpcy5hYm9ydCgpLCBFcnJvcihcIkVycm9yIHJlb3BlbmluZyBhIGNvbm5lY3Rpb25cIik7IHRoaXMuQyA9IGE7IHRoaXMuQiA9IGI7IHRoaXMucmVhZHlTdGF0ZSA9IDE7IHNkKHRoaXMpOyB9O1xyXG5rLnNlbmQgPSBmdW5jdGlvbiAoYSkgeyBpZiAoMSAhPSB0aGlzLnJlYWR5U3RhdGUpXHJcbiAgICB0aHJvdyB0aGlzLmFib3J0KCksIEVycm9yKFwibmVlZCB0byBjYWxsIG9wZW4oKSBmaXJzdC4gXCIpOyB0aGlzLmcgPSAhMDsgdmFyIGIgPSB7IGhlYWRlcnM6IHRoaXMudiwgbWV0aG9kOiB0aGlzLkMsIGNyZWRlbnRpYWxzOiB0aGlzLm0sIGNhY2hlOiB2b2lkIDAgfTsgYSAmJiAoYi5ib2R5ID0gYSk7ICh0aGlzLkQgfHwgbCkuZmV0Y2gobmV3IFJlcXVlc3QodGhpcy5CLCBiKSkudGhlbih0aGlzLlZhLmJpbmQodGhpcyksIHRoaXMuaGEuYmluZCh0aGlzKSk7IH07XHJcbmsuYWJvcnQgPSBmdW5jdGlvbiAoKSB7IHRoaXMucmVzcG9uc2UgPSB0aGlzLnJlc3BvbnNlVGV4dCA9IFwiXCI7IHRoaXMudiA9IG5ldyBIZWFkZXJzOyB0aGlzLnN0YXR1cyA9IDA7IHRoaXMuaiAmJiB0aGlzLmouY2FuY2VsKFwiUmVxdWVzdCB3YXMgYWJvcnRlZC5cIik7IDEgPD0gdGhpcy5yZWFkeVN0YXRlICYmIHRoaXMuZyAmJiA0ICE9IHRoaXMucmVhZHlTdGF0ZSAmJiAodGhpcy5nID0gITEsIHRkKHRoaXMpKTsgdGhpcy5yZWFkeVN0YXRlID0gcmQ7IH07XHJcbmsuVmEgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgaWYgKHRoaXMuZyAmJiAodGhpcy5sID0gYSwgdGhpcy5oIHx8ICh0aGlzLnN0YXR1cyA9IHRoaXMubC5zdGF0dXMsIHRoaXMuc3RhdHVzVGV4dCA9IHRoaXMubC5zdGF0dXNUZXh0LCB0aGlzLmggPSBhLmhlYWRlcnMsIHRoaXMucmVhZHlTdGF0ZSA9IDIsIHNkKHRoaXMpKSwgdGhpcy5nICYmICh0aGlzLnJlYWR5U3RhdGUgPSAzLCBzZCh0aGlzKSwgdGhpcy5nKSkpXHJcbiAgICAgICAgaWYgKFwiYXJyYXlidWZmZXJcIiA9PT0gdGhpcy5yZXNwb25zZVR5cGUpXHJcbiAgICAgICAgICAgIGEuYXJyYXlCdWZmZXIoKS50aGVuKHRoaXMuVGEuYmluZCh0aGlzKSwgdGhpcy5oYS5iaW5kKHRoaXMpKTtcclxuICAgICAgICBlbHNlIGlmIChcInVuZGVmaW5lZFwiICE9PSB0eXBlb2YgbC5SZWFkYWJsZVN0cmVhbSAmJiBcImJvZHlcIiBpbiBhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaiA9IGEuYm9keS5nZXRSZWFkZXIoKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMudSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucmVzcG9uc2VUeXBlKVxyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IEVycm9yKCdyZXNwb25zZVR5cGUgbXVzdCBiZSBlbXB0eSBmb3IgXCJzdHJlYW1CaW5hcnlDaHVua3NcIiBtb2RlIHJlc3BvbnNlcy4nKTtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVzcG9uc2UgPVxyXG4gICAgICAgICAgICAgICAgICAgIFtdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIHRoaXMucmVzcG9uc2UgPSB0aGlzLnJlc3BvbnNlVGV4dCA9IFwiXCIsIHRoaXMuQSA9IG5ldyBUZXh0RGVjb2RlcjtcclxuICAgICAgICAgICAgdWQodGhpcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgYS50ZXh0KCkudGhlbih0aGlzLlVhLmJpbmQodGhpcyksIHRoaXMuaGEuYmluZCh0aGlzKSk7XHJcbn07XHJcbmZ1bmN0aW9uIHVkKGEpIHsgYS5qLnJlYWQoKS50aGVuKGEuU2EuYmluZChhKSkuY2F0Y2goYS5oYS5iaW5kKGEpKTsgfVxyXG5rLlNhID0gZnVuY3Rpb24gKGEpIHsgaWYgKHRoaXMuZykge1xyXG4gICAgaWYgKHRoaXMudSAmJiBhLnZhbHVlKVxyXG4gICAgICAgIHRoaXMucmVzcG9uc2UucHVzaChhLnZhbHVlKTtcclxuICAgIGVsc2UgaWYgKCF0aGlzLnUpIHtcclxuICAgICAgICB2YXIgYiA9IGEudmFsdWUgPyBhLnZhbHVlIDogbmV3IFVpbnQ4QXJyYXkoMCk7XHJcbiAgICAgICAgaWYgKGIgPSB0aGlzLkEuZGVjb2RlKGIsIHsgc3RyZWFtOiAhYS5kb25lIH0pKVxyXG4gICAgICAgICAgICB0aGlzLnJlc3BvbnNlID0gdGhpcy5yZXNwb25zZVRleHQgKz0gYjtcclxuICAgIH1cclxuICAgIGEuZG9uZSA/IHRkKHRoaXMpIDogc2QodGhpcyk7XHJcbiAgICAzID09IHRoaXMucmVhZHlTdGF0ZSAmJiB1ZCh0aGlzKTtcclxufSB9O1xyXG5rLlVhID0gZnVuY3Rpb24gKGEpIHsgdGhpcy5nICYmICh0aGlzLnJlc3BvbnNlID0gdGhpcy5yZXNwb25zZVRleHQgPSBhLCB0ZCh0aGlzKSk7IH07XHJcbmsuVGEgPSBmdW5jdGlvbiAoYSkgeyB0aGlzLmcgJiYgKHRoaXMucmVzcG9uc2UgPSBhLCB0ZCh0aGlzKSk7IH07XHJcbmsuaGEgPSBmdW5jdGlvbiAoKSB7IHRoaXMuZyAmJiB0ZCh0aGlzKTsgfTtcclxuZnVuY3Rpb24gdGQoYSkgeyBhLnJlYWR5U3RhdGUgPSA0OyBhLmwgPSBudWxsOyBhLmogPSBudWxsOyBhLkEgPSBudWxsOyBzZChhKTsgfVxyXG5rLnNldFJlcXVlc3RIZWFkZXIgPSBmdW5jdGlvbiAoYSwgYikgeyB0aGlzLnYuYXBwZW5kKGEsIGIpOyB9O1xyXG5rLmdldFJlc3BvbnNlSGVhZGVyID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIHRoaXMuaCA/IHRoaXMuaC5nZXQoYS50b0xvd2VyQ2FzZSgpKSB8fCBcIlwiIDogXCJcIjsgfTtcclxuay5nZXRBbGxSZXNwb25zZUhlYWRlcnMgPSBmdW5jdGlvbiAoKSB7IGlmICghdGhpcy5oKVxyXG4gICAgcmV0dXJuIFwiXCI7IHZhciBhID0gW10sIGIgPSB0aGlzLmguZW50cmllcygpOyBmb3IgKHZhciBjID0gYi5uZXh0KCk7ICFjLmRvbmU7KVxyXG4gICAgYyA9IGMudmFsdWUsIGEucHVzaChjWzBdICsgXCI6IFwiICsgY1sxXSksIGMgPSBiLm5leHQoKTsgcmV0dXJuIGEuam9pbihcIlxcclxcblwiKTsgfTtcclxuZnVuY3Rpb24gc2QoYSkgeyBhLm9ucmVhZHlzdGF0ZWNoYW5nZSAmJiBhLm9ucmVhZHlzdGF0ZWNoYW5nZS5jYWxsKGEpOyB9XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShxZC5wcm90b3R5cGUsIFwid2l0aENyZWRlbnRpYWxzXCIsIHsgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBcImluY2x1ZGVcIiA9PT0gdGhpcy5tOyB9LCBzZXQ6IGZ1bmN0aW9uIChhKSB7IHRoaXMubSA9IGEgPyBcImluY2x1ZGVcIiA6IFwic2FtZS1vcmlnaW5cIjsgfSB9KTtcclxudmFyIHZkID0gbC5KU09OLnBhcnNlO1xyXG5mdW5jdGlvbiBYKGEpIHsgQy5jYWxsKHRoaXMpOyB0aGlzLmhlYWRlcnMgPSBuZXcgUzsgdGhpcy51ID0gYSB8fCBudWxsOyB0aGlzLmggPSAhMTsgdGhpcy5DID0gdGhpcy5nID0gbnVsbDsgdGhpcy5IID0gXCJcIjsgdGhpcy5tID0gMDsgdGhpcy5qID0gXCJcIjsgdGhpcy5sID0gdGhpcy5GID0gdGhpcy52ID0gdGhpcy5EID0gITE7IHRoaXMuQiA9IDA7IHRoaXMuQSA9IG51bGw7IHRoaXMuSiA9IHdkOyB0aGlzLksgPSB0aGlzLkwgPSAhMTsgfVxyXG50KFgsIEMpO1xyXG52YXIgd2QgPSBcIlwiLCB4ZCA9IC9eaHR0cHM/JC9pLCB5ZCA9IFtcIlBPU1RcIiwgXCJQVVRcIl07XHJcbmsgPSBYLnByb3RvdHlwZTtcclxuay5lYSA9IGZ1bmN0aW9uIChhLCBiLCBjLCBkKSB7XHJcbiAgICBpZiAodGhpcy5nKVxyXG4gICAgICAgIHRocm93IEVycm9yKFwiW2dvb2cubmV0LlhocklvXSBPYmplY3QgaXMgYWN0aXZlIHdpdGggYW5vdGhlciByZXF1ZXN0PVwiICsgdGhpcy5IICsgXCI7IG5ld1VyaT1cIiArIGEpO1xyXG4gICAgYiA9IGIgPyBiLnRvVXBwZXJDYXNlKCkgOiBcIkdFVFwiO1xyXG4gICAgdGhpcy5IID0gYTtcclxuICAgIHRoaXMuaiA9IFwiXCI7XHJcbiAgICB0aGlzLm0gPSAwO1xyXG4gICAgdGhpcy5EID0gITE7XHJcbiAgICB0aGlzLmggPSAhMDtcclxuICAgIHRoaXMuZyA9IHRoaXMudSA/IHRoaXMudS5nKCkgOiBjYy5nKCk7XHJcbiAgICB0aGlzLkMgPSB0aGlzLnUgPyBaYih0aGlzLnUpIDogWmIoY2MpO1xyXG4gICAgdGhpcy5nLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IHEodGhpcy5GYSwgdGhpcyk7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHRoaXMuRiA9ICEwLCB0aGlzLmcub3BlbihiLCBTdHJpbmcoYSksICEwKSwgdGhpcy5GID0gITE7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZikge1xyXG4gICAgICAgIHpkKHRoaXMsIGYpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGEgPSBjIHx8IFwiXCI7XHJcbiAgICB2YXIgZSA9IG5ldyBTKHRoaXMuaGVhZGVycyk7XHJcbiAgICBkICYmIEtjKGQsIGZ1bmN0aW9uIChmLCBoKSB7IGUuc2V0KGgsIGYpOyB9KTtcclxuICAgIGQgPSBvYShlLlQoKSk7XHJcbiAgICBjID0gbC5Gb3JtRGF0YSAmJiBhIGluc3RhbmNlb2YgbC5Gb3JtRGF0YTtcclxuICAgICEoMCA8PSBtYSh5ZCwgYikpIHx8IGQgfHwgYyB8fCBlLnNldChcIkNvbnRlbnQtVHlwZVwiLCBcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDtjaGFyc2V0PXV0Zi04XCIpO1xyXG4gICAgZS5mb3JFYWNoKGZ1bmN0aW9uIChmLCBoKSB7IHRoaXMuZy5zZXRSZXF1ZXN0SGVhZGVyKGgsIGYpOyB9LCB0aGlzKTtcclxuICAgIHRoaXMuSiAmJiAodGhpcy5nLnJlc3BvbnNlVHlwZSA9IHRoaXMuSik7XHJcbiAgICBcIndpdGhDcmVkZW50aWFsc1wiIGluIHRoaXMuZyAmJiB0aGlzLmcud2l0aENyZWRlbnRpYWxzICE9PSB0aGlzLkwgJiYgKHRoaXMuZy53aXRoQ3JlZGVudGlhbHMgPSB0aGlzLkwpO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBBZCh0aGlzKSwgMCA8IHRoaXMuQiAmJiAoKHRoaXMuSyA9IEJkKHRoaXMuZykpID8gKHRoaXMuZy50aW1lb3V0ID0gdGhpcy5CLCB0aGlzLmcub250aW1lb3V0ID0gcSh0aGlzLnBhLCB0aGlzKSkgOiB0aGlzLkEgPSBHYih0aGlzLnBhLCB0aGlzLkIsIHRoaXMpKSwgdGhpcy52ID0gITAsIHRoaXMuZy5zZW5kKGEpLCB0aGlzLnYgPSAhMTtcclxuICAgIH1cclxuICAgIGNhdGNoIChmKSB7XHJcbiAgICAgICAgemQodGhpcywgZik7XHJcbiAgICB9XHJcbn07XHJcbmZ1bmN0aW9uIEJkKGEpIHsgcmV0dXJuIHkgJiYgUmEoKSAmJiBcIm51bWJlclwiID09PSB0eXBlb2YgYS50aW1lb3V0ICYmIHZvaWQgMCAhPT0gYS5vbnRpbWVvdXQ7IH1cclxuZnVuY3Rpb24gcGEoYSkgeyByZXR1cm4gXCJjb250ZW50LXR5cGVcIiA9PSBhLnRvTG93ZXJDYXNlKCk7IH1cclxuay5wYSA9IGZ1bmN0aW9uICgpIHsgXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgZ29vZyAmJiB0aGlzLmcgJiYgKHRoaXMuaiA9IFwiVGltZWQgb3V0IGFmdGVyIFwiICsgdGhpcy5CICsgXCJtcywgYWJvcnRpbmdcIiwgdGhpcy5tID0gOCwgRCh0aGlzLCBcInRpbWVvdXRcIiksIHRoaXMuYWJvcnQoOCkpOyB9O1xyXG5mdW5jdGlvbiB6ZChhLCBiKSB7IGEuaCA9ICExOyBhLmcgJiYgKGEubCA9ICEwLCBhLmcuYWJvcnQoKSwgYS5sID0gITEpOyBhLmogPSBiOyBhLm0gPSA1OyBDZChhKTsgRGQoYSk7IH1cclxuZnVuY3Rpb24gQ2QoYSkgeyBhLkQgfHwgKGEuRCA9ICEwLCBEKGEsIFwiY29tcGxldGVcIiksIEQoYSwgXCJlcnJvclwiKSk7IH1cclxuay5hYm9ydCA9IGZ1bmN0aW9uIChhKSB7IHRoaXMuZyAmJiB0aGlzLmggJiYgKHRoaXMuaCA9ICExLCB0aGlzLmwgPSAhMCwgdGhpcy5nLmFib3J0KCksIHRoaXMubCA9ICExLCB0aGlzLm0gPSBhIHx8IDcsIEQodGhpcywgXCJjb21wbGV0ZVwiKSwgRCh0aGlzLCBcImFib3J0XCIpLCBEZCh0aGlzKSk7IH07XHJcbmsuTSA9IGZ1bmN0aW9uICgpIHsgdGhpcy5nICYmICh0aGlzLmggJiYgKHRoaXMuaCA9ICExLCB0aGlzLmwgPSAhMCwgdGhpcy5nLmFib3J0KCksIHRoaXMubCA9ICExKSwgRGQodGhpcywgITApKTsgWC5aLk0uY2FsbCh0aGlzKTsgfTtcclxuay5GYSA9IGZ1bmN0aW9uICgpIHsgdGhpcy5zIHx8ICh0aGlzLkYgfHwgdGhpcy52IHx8IHRoaXMubCA/IEVkKHRoaXMpIDogdGhpcy5jYigpKTsgfTtcclxuay5jYiA9IGZ1bmN0aW9uICgpIHsgRWQodGhpcyk7IH07XHJcbmZ1bmN0aW9uIEVkKGEpIHtcclxuICAgIGlmIChhLmggJiYgXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgZ29vZyAmJiAoIWEuQ1sxXSB8fCA0ICE9IE8oYSkgfHwgMiAhPSBhLmJhKCkpKVxyXG4gICAgICAgIGlmIChhLnYgJiYgNCA9PSBPKGEpKVxyXG4gICAgICAgICAgICBHYihhLkZhLCAwLCBhKTtcclxuICAgICAgICBlbHNlIGlmIChEKGEsIFwicmVhZHlzdGF0ZWNoYW5nZVwiKSwgNCA9PSBPKGEpKSB7XHJcbiAgICAgICAgICAgIGEuaCA9ICExO1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG4gPSBhLmJhKCk7XHJcbiAgICAgICAgICAgICAgICBhOiBzd2l0Y2ggKG4pIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDIwMDpcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDIwMTpcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDIwMjpcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDIwNDpcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDIwNjpcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDMwNDpcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDEyMjM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiID0gITA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrIGE7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDogYiA9ICExO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIGM7XHJcbiAgICAgICAgICAgICAgICBpZiAoIShjID0gYikpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZCA9IDAgPT09IG4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSBTdHJpbmcoYS5IKS5tYXRjaChNYylbMV0gfHwgbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlICYmIGwuc2VsZiAmJiBsLnNlbGYubG9jYXRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmID0gbC5zZWxmLmxvY2F0aW9uLnByb3RvY29sO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZSA9IGYuc3Vic3RyKDAsIGYubGVuZ3RoIC0gMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZCA9ICF4ZC50ZXN0KGUgPyBlLnRvTG93ZXJDYXNlKCkgOiBcIlwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYyA9IGQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoYylcclxuICAgICAgICAgICAgICAgICAgICBEKGEsIFwiY29tcGxldGVcIiksIEQoYSwgXCJzdWNjZXNzXCIpO1xyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYS5tID0gNjtcclxuICAgICAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaCA9IDIgPCBPKGEpID8gYS5nLnN0YXR1c1RleHQgOiBcIlwiO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjYXRjaCAodSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBoID0gXCJcIjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYS5qID0gaCArIFwiIFtcIiArIGEuYmEoKSArIFwiXVwiO1xyXG4gICAgICAgICAgICAgICAgICAgIENkKGEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZpbmFsbHkge1xyXG4gICAgICAgICAgICAgICAgRGQoYSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbn1cclxuZnVuY3Rpb24gRGQoYSwgYikgeyBpZiAoYS5nKSB7XHJcbiAgICBBZChhKTtcclxuICAgIHZhciBjID0gYS5nLCBkID0gYS5DWzBdID8gYWEgOiBudWxsO1xyXG4gICAgYS5nID0gbnVsbDtcclxuICAgIGEuQyA9IG51bGw7XHJcbiAgICBiIHx8IEQoYSwgXCJyZWFkeVwiKTtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYy5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBkO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGUpIHsgfVxyXG59IH1cclxuZnVuY3Rpb24gQWQoYSkgeyBhLmcgJiYgYS5LICYmIChhLmcub250aW1lb3V0ID0gbnVsbCk7IGEuQSAmJiAobC5jbGVhclRpbWVvdXQoYS5BKSwgYS5BID0gbnVsbCk7IH1cclxuZnVuY3Rpb24gTyhhKSB7IHJldHVybiBhLmcgPyBhLmcucmVhZHlTdGF0ZSA6IDA7IH1cclxuay5iYSA9IGZ1bmN0aW9uICgpIHsgdHJ5IHtcclxuICAgIHJldHVybiAyIDwgTyh0aGlzKSA/IHRoaXMuZy5zdGF0dXMgOiAtMTtcclxufVxyXG5jYXRjaCAoYSkge1xyXG4gICAgcmV0dXJuIC0xO1xyXG59IH07XHJcbmsuZ2EgPSBmdW5jdGlvbiAoKSB7IHRyeSB7XHJcbiAgICByZXR1cm4gdGhpcy5nID8gdGhpcy5nLnJlc3BvbnNlVGV4dCA6IFwiXCI7XHJcbn1cclxuY2F0Y2ggKGEpIHtcclxuICAgIHJldHVybiBcIlwiO1xyXG59IH07XHJcbmsuUWEgPSBmdW5jdGlvbiAoYSkgeyBpZiAodGhpcy5nKSB7XHJcbiAgICB2YXIgYiA9IHRoaXMuZy5yZXNwb25zZVRleHQ7XHJcbiAgICBhICYmIDAgPT0gYi5pbmRleE9mKGEpICYmIChiID0gYi5zdWJzdHJpbmcoYS5sZW5ndGgpKTtcclxuICAgIHJldHVybiB2ZChiKTtcclxufSB9O1xyXG5mdW5jdGlvbiBvYyhhKSB7IHRyeSB7XHJcbiAgICBpZiAoIWEuZylcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIGlmIChcInJlc3BvbnNlXCIgaW4gYS5nKVxyXG4gICAgICAgIHJldHVybiBhLmcucmVzcG9uc2U7XHJcbiAgICBzd2l0Y2ggKGEuSikge1xyXG4gICAgICAgIGNhc2Ugd2Q6XHJcbiAgICAgICAgY2FzZSBcInRleHRcIjogcmV0dXJuIGEuZy5yZXNwb25zZVRleHQ7XHJcbiAgICAgICAgY2FzZSBcImFycmF5YnVmZmVyXCI6IGlmIChcIm1velJlc3BvbnNlQXJyYXlCdWZmZXJcIiBpbiBhLmcpXHJcbiAgICAgICAgICAgIHJldHVybiBhLmcubW96UmVzcG9uc2VBcnJheUJ1ZmZlcjtcclxuICAgIH1cclxuICAgIHJldHVybiBudWxsO1xyXG59XHJcbmNhdGNoIChiKSB7XHJcbiAgICByZXR1cm4gbnVsbDtcclxufSB9XHJcbmsuRGEgPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLm07IH07XHJcbmsuTGEgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBcInN0cmluZ1wiID09PSB0eXBlb2YgdGhpcy5qID8gdGhpcy5qIDogU3RyaW5nKHRoaXMuaik7IH07XHJcbmZ1bmN0aW9uIEZkKGEpIHsgdmFyIGIgPSBcIlwiOyB4YShhLCBmdW5jdGlvbiAoYywgZCkgeyBiICs9IGQ7IGIgKz0gXCI6XCI7IGIgKz0gYzsgYiArPSBcIlxcclxcblwiOyB9KTsgcmV0dXJuIGI7IH1cclxuZnVuY3Rpb24gR2QoYSwgYiwgYykgeyBhOiB7XHJcbiAgICBmb3IgKGQgaW4gYykge1xyXG4gICAgICAgIHZhciBkID0gITE7XHJcbiAgICAgICAgYnJlYWsgYTtcclxuICAgIH1cclxuICAgIGQgPSAhMDtcclxufSBkIHx8IChjID0gRmQoYyksIFwic3RyaW5nXCIgPT09IHR5cGVvZiBhID8gKG51bGwgIT0gYyAmJiBlbmNvZGVVUklDb21wb25lbnQoU3RyaW5nKGMpKSkgOiBSKGEsIGIsIGMpKTsgfVxyXG5mdW5jdGlvbiBIZChhLCBiLCBjKSB7IHJldHVybiBjICYmIGMuaW50ZXJuYWxDaGFubmVsUGFyYW1zID8gYy5pbnRlcm5hbENoYW5uZWxQYXJhbXNbYV0gfHwgYiA6IGI7IH1cclxuZnVuY3Rpb24gSWQoYSkge1xyXG4gICAgdGhpcy56YSA9IDA7XHJcbiAgICB0aGlzLmwgPSBbXTtcclxuICAgIHRoaXMuaCA9IG5ldyBNYjtcclxuICAgIHRoaXMubGEgPSB0aGlzLm9hID0gdGhpcy5GID0gdGhpcy5XID0gdGhpcy5nID0gdGhpcy5zYSA9IHRoaXMuRCA9IHRoaXMuYWEgPSB0aGlzLm8gPSB0aGlzLlAgPSB0aGlzLnMgPSBudWxsO1xyXG4gICAgdGhpcy5aYSA9IHRoaXMuViA9IDA7XHJcbiAgICB0aGlzLlhhID0gSGQoXCJmYWlsRmFzdFwiLCAhMSwgYSk7XHJcbiAgICB0aGlzLk4gPSB0aGlzLnYgPSB0aGlzLnUgPSB0aGlzLm0gPSB0aGlzLmogPSBudWxsO1xyXG4gICAgdGhpcy5YID0gITA7XHJcbiAgICB0aGlzLkkgPSB0aGlzLnRhID0gdGhpcy5VID0gLTE7XHJcbiAgICB0aGlzLlkgPSB0aGlzLkEgPSB0aGlzLkMgPSAwO1xyXG4gICAgdGhpcy5QYSA9IEhkKFwiYmFzZVJldHJ5RGVsYXlNc1wiLCA1RTMsIGEpO1xyXG4gICAgdGhpcy4kYSA9IEhkKFwicmV0cnlEZWxheVNlZWRNc1wiLCAxRTQsIGEpO1xyXG4gICAgdGhpcy5ZYSA9IEhkKFwiZm9yd2FyZENoYW5uZWxNYXhSZXRyaWVzXCIsIDIsIGEpO1xyXG4gICAgdGhpcy5yYSA9IEhkKFwiZm9yd2FyZENoYW5uZWxSZXF1ZXN0VGltZW91dE1zXCIsIDJFNCwgYSk7XHJcbiAgICB0aGlzLnFhID0gYSAmJiBhLnhtbEh0dHBGYWN0b3J5IHx8IHZvaWQgMDtcclxuICAgIHRoaXMuQmEgPSBhICYmIGEuWWIgfHwgITE7XHJcbiAgICB0aGlzLksgPSB2b2lkIDA7XHJcbiAgICB0aGlzLkggPSBhICYmIGEuc3VwcG9ydHNDcm9zc0RvbWFpblhociB8fCAhMTtcclxuICAgIHRoaXMuSiA9IFwiXCI7XHJcbiAgICB0aGlzLmkgPSBuZXcgZ2QoYSAmJiBhLmNvbmN1cnJlbnRSZXF1ZXN0TGltaXQpO1xyXG4gICAgdGhpcy5DYSA9IG5ldyBsZDtcclxuICAgIHRoaXMuamEgPSBhICYmIGEuZmFzdEhhbmRzaGFrZSB8fCAhMTtcclxuICAgIHRoaXMuUmEgPSBhICYmIGEuV2IgfHwgITE7XHJcbiAgICBhICYmIGEuQWEgJiYgdGhpcy5oLkFhKCk7XHJcbiAgICBhICYmIGEuZm9yY2VMb25nUG9sbGluZyAmJiAodGhpcy5YID0gITEpO1xyXG4gICAgdGhpcy4kID0gIXRoaXMuamEgJiYgdGhpcy5YICYmIGEgJiYgYS5kZXRlY3RCdWZmZXJpbmdQcm94eSB8fCAhMTtcclxuICAgIHRoaXMua2EgPSB2b2lkIDA7XHJcbiAgICB0aGlzLk8gPSAwO1xyXG4gICAgdGhpcy5MID0gITE7XHJcbiAgICB0aGlzLkIgPSBudWxsO1xyXG4gICAgdGhpcy5XYSA9ICFhIHx8ICExICE9PSBhLlhiO1xyXG59XHJcbmsgPSBJZC5wcm90b3R5cGU7XHJcbmsubWEgPSA4O1xyXG5rLkcgPSAxO1xyXG5mdW5jdGlvbiBJYyhhKSB7IEpkKGEpOyBpZiAoMyA9PSBhLkcpIHtcclxuICAgIHZhciBiID0gYS5WKyssIGMgPSBOKGEuRik7XHJcbiAgICBSKGMsIFwiU0lEXCIsIGEuSik7XHJcbiAgICBSKGMsIFwiUklEXCIsIGIpO1xyXG4gICAgUihjLCBcIlRZUEVcIiwgXCJ0ZXJtaW5hdGVcIik7XHJcbiAgICBLZChhLCBjKTtcclxuICAgIGIgPSBuZXcgTShhLCBhLmgsIGIsIHZvaWQgMCk7XHJcbiAgICBiLksgPSAyO1xyXG4gICAgYi52ID0gamMoTihjKSk7XHJcbiAgICBjID0gITE7XHJcbiAgICBsLm5hdmlnYXRvciAmJiBsLm5hdmlnYXRvci5zZW5kQmVhY29uICYmIChjID0gbC5uYXZpZ2F0b3Iuc2VuZEJlYWNvbihiLnYudG9TdHJpbmcoKSwgXCJcIikpO1xyXG4gICAgIWMgJiYgbC5JbWFnZSAmJiAoKG5ldyBJbWFnZSkuc3JjID0gYi52LCBjID0gITApO1xyXG4gICAgYyB8fCAoYi5nID0gbmMoYi5sLCBudWxsKSwgYi5nLmVhKGIudikpO1xyXG4gICAgYi5GID0gRGF0ZS5ub3coKTtcclxuICAgIGxjKGIpO1xyXG59IExkKGEpOyB9XHJcbmsuaGIgPSBmdW5jdGlvbiAoYSkgeyB0cnkge1xyXG4gICAgdGhpcy5oLmluZm8oXCJPcmlnaW4gVHJpYWxzIGludm9rZWQ6IFwiICsgYSk7XHJcbn1cclxuY2F0Y2ggKGIpIHsgfSB9O1xyXG5mdW5jdGlvbiBBYyhhKSB7IGEuZyAmJiAod2MoYSksIGEuZy5jYW5jZWwoKSwgYS5nID0gbnVsbCk7IH1cclxuZnVuY3Rpb24gSmQoYSkgeyBBYyhhKTsgYS51ICYmIChsLmNsZWFyVGltZW91dChhLnUpLCBhLnUgPSBudWxsKTsgemMoYSk7IGEuaS5jYW5jZWwoKTsgYS5tICYmIChcIm51bWJlclwiID09PSB0eXBlb2YgYS5tICYmIGwuY2xlYXJUaW1lb3V0KGEubSksIGEubSA9IG51bGwpOyB9XHJcbmZ1bmN0aW9uIE1kKGEsIGIpIHsgYS5sLnB1c2gobmV3IGZkKGEuWmErKywgYikpOyAzID09IGEuRyAmJiBIYyhhKTsgfVxyXG5mdW5jdGlvbiBIYyhhKSB7IGlkKGEuaSkgfHwgYS5tIHx8IChhLm0gPSAhMCwgemIoYS5IYSwgYSksIGEuQyA9IDApOyB9XHJcbmZ1bmN0aW9uIE5kKGEsIGIpIHsgaWYgKENjKGEuaSkgPj0gYS5pLmogLSAoYS5tID8gMSA6IDApKVxyXG4gICAgcmV0dXJuICExOyBpZiAoYS5tKVxyXG4gICAgcmV0dXJuIGEubCA9IGIuRC5jb25jYXQoYS5sKSwgITA7IGlmICgxID09IGEuRyB8fCAyID09IGEuRyB8fCBhLkMgPj0gKGEuWGEgPyAwIDogYS5ZYSkpXHJcbiAgICByZXR1cm4gITE7IGEubSA9IEsocShhLkhhLCBhLCBiKSwgT2QoYSwgYS5DKSk7IGEuQysrOyByZXR1cm4gITA7IH1cclxuay5IYSA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICBpZiAodGhpcy5tKVxyXG4gICAgICAgIGlmICh0aGlzLm0gPSBudWxsLCAxID09IHRoaXMuRykge1xyXG4gICAgICAgICAgICBpZiAoIWEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuViA9IE1hdGguZmxvb3IoMUU1ICogTWF0aC5yYW5kb20oKSk7XHJcbiAgICAgICAgICAgICAgICBhID0gdGhpcy5WKys7XHJcbiAgICAgICAgICAgICAgICB2YXIgZSA9IG5ldyBNKHRoaXMsIHRoaXMuaCwgYSwgdm9pZCAwKTtcclxuICAgICAgICAgICAgICAgIHZhciBmID0gdGhpcy5zO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5QICYmIChmID8gKGYgPSB5YShmKSwgQWEoZiwgdGhpcy5QKSkgOiBmID0gdGhpcy5QKTtcclxuICAgICAgICAgICAgICAgIG51bGwgPT09IHRoaXMubyAmJiAoZS5IID0gZik7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5qYSlcclxuICAgICAgICAgICAgICAgICAgICBhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYyA9IDA7IGMgPCB0aGlzLmwubGVuZ3RoOyBjKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IHRoaXMubFtjXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoXCJfX2RhdGFfX1wiIGluIGQuZyAmJiAoZCA9IGQuZy5fX2RhdGFfXywgXCJzdHJpbmdcIiA9PT0gdHlwZW9mIGQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQgPSBkLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsgYjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZCA9IHZvaWQgMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2b2lkIDAgPT09IGQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiICs9IGQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoNDA5NiA8IGIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiID0gYztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhayBhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKDQwOTYgPT09IGIgfHwgYyA9PT0gdGhpcy5sLmxlbmd0aCAtIDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiID0gYyArIDE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsgYTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBiID0gMUUzO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICBiID0gMUUzO1xyXG4gICAgICAgICAgICAgICAgYiA9XHJcbiAgICAgICAgICAgICAgICAgICAgUGQodGhpcywgZSwgYik7XHJcbiAgICAgICAgICAgICAgICBjID0gTih0aGlzLkYpO1xyXG4gICAgICAgICAgICAgICAgUihjLCBcIlJJRFwiLCBhKTtcclxuICAgICAgICAgICAgICAgIFIoYywgXCJDVkVSXCIsIDIyKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuRCAmJiBSKGMsIFwiWC1IVFRQLVNlc3Npb24tSWRcIiwgdGhpcy5EKTtcclxuICAgICAgICAgICAgICAgIEtkKHRoaXMsIGMpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vICYmIGYgJiYgR2QoYywgdGhpcy5vLCBmKTtcclxuICAgICAgICAgICAgICAgIERjKHRoaXMuaSwgZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLlJhICYmIFIoYywgXCJUWVBFXCIsIFwiaW5pdFwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuamEgPyAoUihjLCBcIiRyZXFcIiwgYiksIFIoYywgXCJTSURcIiwgXCJudWxsXCIpLCBlLiQgPSAhMCwgaWMoZSwgYywgbnVsbCkpIDogaWMoZSwgYywgYik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLkcgPSAyO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgMyA9PSB0aGlzLkcgJiYgKGEgPyBRZCh0aGlzLCBhKSA6IDAgPT0gdGhpcy5sLmxlbmd0aCB8fCBpZCh0aGlzLmkpIHx8IFFkKHRoaXMpKTtcclxufTtcclxuZnVuY3Rpb24gUWQoYSwgYikgeyB2YXIgYzsgYiA/IGMgPSBiLm0gOiBjID0gYS5WKys7IHZhciBkID0gTihhLkYpOyBSKGQsIFwiU0lEXCIsIGEuSik7IFIoZCwgXCJSSURcIiwgYyk7IFIoZCwgXCJBSURcIiwgYS5VKTsgS2QoYSwgZCk7IGEubyAmJiBhLnMgJiYgR2QoZCwgYS5vLCBhLnMpOyBjID0gbmV3IE0oYSwgYS5oLCBjLCBhLkMgKyAxKTsgbnVsbCA9PT0gYS5vICYmIChjLkggPSBhLnMpOyBiICYmIChhLmwgPSBiLkQuY29uY2F0KGEubCkpOyBiID0gUGQoYSwgYywgMUUzKTsgYy5zZXRUaW1lb3V0KE1hdGgucm91bmQoLjUgKiBhLnJhKSArIE1hdGgucm91bmQoLjUgKiBhLnJhICogTWF0aC5yYW5kb20oKSkpOyBEYyhhLmksIGMpOyBpYyhjLCBkLCBiKTsgfVxyXG5mdW5jdGlvbiBLZChhLCBiKSB7IGEuaiAmJiBLYyh7fSwgZnVuY3Rpb24gKGMsIGQpIHsgUihiLCBkLCBjKTsgfSk7IH1cclxuZnVuY3Rpb24gUGQoYSwgYiwgYykgeyBjID0gTWF0aC5taW4oYS5sLmxlbmd0aCwgYyk7IHZhciBkID0gYS5qID8gcShhLmouT2EsIGEuaiwgYSkgOiBudWxsOyBhOiB7XHJcbiAgICB2YXIgZSA9IGEubDtcclxuICAgIHZhciBmID0gLTE7XHJcbiAgICBmb3IgKDs7KSB7XHJcbiAgICAgICAgdmFyIGggPSBbXCJjb3VudD1cIiArIGNdO1xyXG4gICAgICAgIC0xID09IGYgPyAwIDwgYyA/IChmID0gZVswXS5oLCBoLnB1c2goXCJvZnM9XCIgKyBmKSkgOiBmID0gMCA6IGgucHVzaChcIm9mcz1cIiArIGYpO1xyXG4gICAgICAgIHZhciBuID0gITA7XHJcbiAgICAgICAgZm9yICh2YXIgdSA9IDA7IHUgPCBjOyB1KyspIHtcclxuICAgICAgICAgICAgdmFyIG0gPSBlW3VdLmg7XHJcbiAgICAgICAgICAgIHZhciByID0gZVt1XS5nO1xyXG4gICAgICAgICAgICBtIC09IGY7XHJcbiAgICAgICAgICAgIGlmICgwID4gbSlcclxuICAgICAgICAgICAgICAgIGYgPSBNYXRoLm1heCgwLCBlW3VdLmggLSAxMDApLCBuID0gITE7XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWQociwgaCwgXCJyZXFcIiArIG0gKyBcIl9cIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYXRjaCAoRykge1xyXG4gICAgICAgICAgICAgICAgICAgIGQgJiYgZChyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKG4pIHtcclxuICAgICAgICAgICAgZCA9IGguam9pbihcIiZcIik7XHJcbiAgICAgICAgICAgIGJyZWFrIGE7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IGEgPSBhLmwuc3BsaWNlKDAsIGMpOyBiLkQgPSBhOyByZXR1cm4gZDsgfVxyXG5mdW5jdGlvbiBHYyhhKSB7IGEuZyB8fCBhLnUgfHwgKGEuWSA9IDEsIHpiKGEuR2EsIGEpLCBhLkEgPSAwKTsgfVxyXG5mdW5jdGlvbiBCYyhhKSB7IGlmIChhLmcgfHwgYS51IHx8IDMgPD0gYS5BKVxyXG4gICAgcmV0dXJuICExOyBhLlkrKzsgYS51ID0gSyhxKGEuR2EsIGEpLCBPZChhLCBhLkEpKTsgYS5BKys7IHJldHVybiAhMDsgfVxyXG5rLkdhID0gZnVuY3Rpb24gKCkgeyB0aGlzLnUgPSBudWxsOyBSZCh0aGlzKTsgaWYgKHRoaXMuJCAmJiAhKHRoaXMuTCB8fCBudWxsID09IHRoaXMuZyB8fCAwID49IHRoaXMuTykpIHtcclxuICAgIHZhciBhID0gMiAqIHRoaXMuTztcclxuICAgIHRoaXMuaC5pbmZvKFwiQlAgZGV0ZWN0aW9uIHRpbWVyIGVuYWJsZWQ6IFwiICsgYSk7XHJcbiAgICB0aGlzLkIgPSBLKHEodGhpcy5iYiwgdGhpcyksIGEpO1xyXG59IH07XHJcbmsuYmIgPSBmdW5jdGlvbiAoKSB7IHRoaXMuQiAmJiAodGhpcy5CID0gbnVsbCwgdGhpcy5oLmluZm8oXCJCUCBkZXRlY3Rpb24gdGltZW91dCByZWFjaGVkLlwiKSwgdGhpcy5oLmluZm8oXCJCdWZmZXJpbmcgcHJveHkgZGV0ZWN0ZWQgYW5kIHN3aXRjaCB0byBsb25nLXBvbGxpbmchXCIpLCB0aGlzLk4gPSAhMSwgdGhpcy5MID0gITAsIEooMTApLCBBYyh0aGlzKSwgUmQodGhpcykpOyB9O1xyXG5mdW5jdGlvbiB3YyhhKSB7IG51bGwgIT0gYS5CICYmIChsLmNsZWFyVGltZW91dChhLkIpLCBhLkIgPSBudWxsKTsgfVxyXG5mdW5jdGlvbiBSZChhKSB7IGEuZyA9IG5ldyBNKGEsIGEuaCwgXCJycGNcIiwgYS5ZKTsgbnVsbCA9PT0gYS5vICYmIChhLmcuSCA9IGEucyk7IGEuZy5PID0gMDsgdmFyIGIgPSBOKGEub2EpOyBSKGIsIFwiUklEXCIsIFwicnBjXCIpOyBSKGIsIFwiU0lEXCIsIGEuSik7IFIoYiwgXCJDSVwiLCBhLk4gPyBcIjBcIiA6IFwiMVwiKTsgUihiLCBcIkFJRFwiLCBhLlUpOyBLZChhLCBiKTsgUihiLCBcIlRZUEVcIiwgXCJ4bWxodHRwXCIpOyBhLm8gJiYgYS5zICYmIEdkKGIsIGEubywgYS5zKTsgYS5LICYmIGEuZy5zZXRUaW1lb3V0KGEuSyk7IHZhciBjID0gYS5nOyBhID0gYS5sYTsgYy5LID0gMTsgYy52ID0gamMoTihiKSk7IGMucyA9IG51bGw7IGMuVSA9ICEwOyBrYyhjLCBhKTsgfVxyXG5rLmFiID0gZnVuY3Rpb24gKCkgeyBudWxsICE9IHRoaXMudiAmJiAodGhpcy52ID0gbnVsbCwgQWModGhpcyksIEJjKHRoaXMpLCBKKDE5KSk7IH07XHJcbmZ1bmN0aW9uIHpjKGEpIHsgbnVsbCAhPSBhLnYgJiYgKGwuY2xlYXJUaW1lb3V0KGEudiksIGEudiA9IG51bGwpOyB9XHJcbmZ1bmN0aW9uIHVjKGEsIGIpIHsgdmFyIGMgPSBudWxsOyBpZiAoYS5nID09IGIpIHtcclxuICAgIHpjKGEpO1xyXG4gICAgd2MoYSk7XHJcbiAgICBhLmcgPSBudWxsO1xyXG4gICAgdmFyIGQgPSAyO1xyXG59XHJcbmVsc2UgaWYgKHljKGEuaSwgYikpXHJcbiAgICBjID0gYi5ELCBGYyhhLmksIGIpLCBkID0gMTtcclxuZWxzZVxyXG4gICAgcmV0dXJuOyBhLkkgPSBiLk47IGlmICgwICE9IGEuRylcclxuICAgIGlmIChiLmkpXHJcbiAgICAgICAgaWYgKDEgPT0gZCkge1xyXG4gICAgICAgICAgICBjID0gYi5zID8gYi5zLmxlbmd0aCA6IDA7XHJcbiAgICAgICAgICAgIGIgPSBEYXRlLm5vdygpIC0gYi5GO1xyXG4gICAgICAgICAgICB2YXIgZSA9IGEuQztcclxuICAgICAgICAgICAgZCA9IFNiKCk7XHJcbiAgICAgICAgICAgIEQoZCwgbmV3IFZiKGQsIGMsIGIsIGUpKTtcclxuICAgICAgICAgICAgSGMoYSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgR2MoYSk7XHJcbiAgICBlbHNlIGlmIChlID0gYi5vLCAzID09IGUgfHwgMCA9PSBlICYmIDAgPCBhLkkgfHwgISgxID09IGQgJiYgTmQoYSwgYikgfHwgMiA9PSBkICYmIEJjKGEpKSlcclxuICAgICAgICBzd2l0Y2ggKGMgJiYgMCA8IGMubGVuZ3RoICYmIChiID0gYS5pLCBiLmkgPSBiLmkuY29uY2F0KGMpKSwgZSkge1xyXG4gICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICBRKGEsIDUpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgNDpcclxuICAgICAgICAgICAgICAgIFEoYSwgMTApO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgICAgIFEoYSwgNik7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgZGVmYXVsdDogUShhLCAyKTtcclxuICAgICAgICB9IH1cclxuZnVuY3Rpb24gT2QoYSwgYikgeyB2YXIgYyA9IGEuUGEgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBhLiRhKTsgYS5qIHx8IChjICo9IDIpOyByZXR1cm4gYyAqIGI7IH1cclxuZnVuY3Rpb24gUShhLCBiKSB7IGEuaC5pbmZvKFwiRXJyb3IgY29kZSBcIiArIGIpOyBpZiAoMiA9PSBiKSB7XHJcbiAgICB2YXIgYyA9IG51bGw7XHJcbiAgICBhLmogJiYgKGMgPSBudWxsKTtcclxuICAgIHZhciBkID0gcShhLmpiLCBhKTtcclxuICAgIGMgfHwgKGMgPSBuZXcgVShcIi8vd3d3Lmdvb2dsZS5jb20vaW1hZ2VzL2NsZWFyZG90LmdpZlwiKSwgbC5sb2NhdGlvbiAmJiBcImh0dHBcIiA9PSBsLmxvY2F0aW9uLnByb3RvY29sIHx8IE9jKGMsIFwiaHR0cHNcIiksIGpjKGMpKTtcclxuICAgIG5kKGMudG9TdHJpbmcoKSwgZCk7XHJcbn1cclxuZWxzZVxyXG4gICAgSigyKTsgYS5HID0gMDsgYS5qICYmIGEuai52YShiKTsgTGQoYSk7IEpkKGEpOyB9XHJcbmsuamIgPSBmdW5jdGlvbiAoYSkgeyBhID8gKHRoaXMuaC5pbmZvKFwiU3VjY2Vzc2Z1bGx5IHBpbmdlZCBnb29nbGUuY29tXCIpLCBKKDIpKSA6ICh0aGlzLmguaW5mbyhcIkZhaWxlZCB0byBwaW5nIGdvb2dsZS5jb21cIiksIEooMSkpOyB9O1xyXG5mdW5jdGlvbiBMZChhKSB7IGEuRyA9IDA7IGEuSSA9IC0xOyBpZiAoYS5qKSB7XHJcbiAgICBpZiAoMCAhPSBqZChhLmkpLmxlbmd0aCB8fCAwICE9IGEubC5sZW5ndGgpXHJcbiAgICAgICAgYS5pLmkubGVuZ3RoID0gMCwgcmEoYS5sKSwgYS5sLmxlbmd0aCA9IDA7XHJcbiAgICBhLmoudWEoKTtcclxufSB9XHJcbmZ1bmN0aW9uIEVjKGEsIGIsIGMpIHsgdmFyIGQgPSBhZChjKTsgaWYgKFwiXCIgIT0gZC5pKVxyXG4gICAgYiAmJiBQYyhkLCBiICsgXCIuXCIgKyBkLmkpLCBRYyhkLCBkLm0pO1xyXG5lbHNlIHtcclxuICAgIHZhciBlID0gbC5sb2NhdGlvbjtcclxuICAgIGQgPSBiZChlLnByb3RvY29sLCBiID8gYiArIFwiLlwiICsgZS5ob3N0bmFtZSA6IGUuaG9zdG5hbWUsICtlLnBvcnQsIGMpO1xyXG59IGEuYWEgJiYgeGEoYS5hYSwgZnVuY3Rpb24gKGUsIGYpIHsgUihkLCBmLCBlKTsgfSk7IGIgPSBhLkQ7IGMgPSBhLnNhOyBiICYmIGMgJiYgUihkLCBiLCBjKTsgUihkLCBcIlZFUlwiLCBhLm1hKTsgS2QoYSwgZCk7IHJldHVybiBkOyB9XHJcbmZ1bmN0aW9uIG5jKGEsIGIsIGMpIHsgaWYgKGIgJiYgIWEuSClcclxuICAgIHRocm93IEVycm9yKFwiQ2FuJ3QgY3JlYXRlIHNlY29uZGFyeSBkb21haW4gY2FwYWJsZSBYaHJJbyBvYmplY3QuXCIpOyBiID0gYyAmJiBhLkJhICYmICFhLnFhID8gbmV3IFgobmV3IHBkKHsgaWI6ICEwIH0pKSA6IG5ldyBYKGEucWEpOyBiLkwgPSBhLkg7IHJldHVybiBiOyB9XHJcbmZ1bmN0aW9uIFNkKCkgeyB9XHJcbmsgPSBTZC5wcm90b3R5cGU7XHJcbmsueGEgPSBmdW5jdGlvbiAoKSB7IH07XHJcbmsud2EgPSBmdW5jdGlvbiAoKSB7IH07XHJcbmsudmEgPSBmdW5jdGlvbiAoKSB7IH07XHJcbmsudWEgPSBmdW5jdGlvbiAoKSB7IH07XHJcbmsuT2EgPSBmdW5jdGlvbiAoKSB7IH07XHJcbmZ1bmN0aW9uIFRkKCkgeyBpZiAoeSAmJiAhKDEwIDw9IE51bWJlcihVYSkpKVxyXG4gICAgdGhyb3cgRXJyb3IoXCJFbnZpcm9ubWVudGFsIGVycm9yOiBubyBhdmFpbGFibGUgdHJhbnNwb3J0LlwiKTsgfVxyXG5UZC5wcm90b3R5cGUuZyA9IGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBuZXcgWShhLCBiKTsgfTtcclxuZnVuY3Rpb24gWShhLCBiKSB7XHJcbiAgICBDLmNhbGwodGhpcyk7XHJcbiAgICB0aGlzLmcgPSBuZXcgSWQoYik7XHJcbiAgICB0aGlzLmwgPSBhO1xyXG4gICAgdGhpcy5oID0gYiAmJiBiLm1lc3NhZ2VVcmxQYXJhbXMgfHwgbnVsbDtcclxuICAgIGEgPSBiICYmIGIubWVzc2FnZUhlYWRlcnMgfHwgbnVsbDtcclxuICAgIGIgJiYgYi5jbGllbnRQcm90b2NvbEhlYWRlclJlcXVpcmVkICYmIChhID8gYVtcIlgtQ2xpZW50LVByb3RvY29sXCJdID0gXCJ3ZWJjaGFubmVsXCIgOiBhID0geyBcIlgtQ2xpZW50LVByb3RvY29sXCI6IFwid2ViY2hhbm5lbFwiIH0pO1xyXG4gICAgdGhpcy5nLnMgPSBhO1xyXG4gICAgYSA9IGIgJiYgYi5pbml0TWVzc2FnZUhlYWRlcnMgfHwgbnVsbDtcclxuICAgIGIgJiYgYi5tZXNzYWdlQ29udGVudFR5cGUgJiYgKGEgPyBhW1wiWC1XZWJDaGFubmVsLUNvbnRlbnQtVHlwZVwiXSA9IGIubWVzc2FnZUNvbnRlbnRUeXBlIDogYSA9IHsgXCJYLVdlYkNoYW5uZWwtQ29udGVudC1UeXBlXCI6IGIubWVzc2FnZUNvbnRlbnRUeXBlIH0pO1xyXG4gICAgYiAmJiBiLnlhICYmIChhID8gYVtcIlgtV2ViQ2hhbm5lbC1DbGllbnQtUHJvZmlsZVwiXSA9IGIueWEgOiBhID0geyBcIlgtV2ViQ2hhbm5lbC1DbGllbnQtUHJvZmlsZVwiOiBiLnlhIH0pO1xyXG4gICAgdGhpcy5nLlAgPVxyXG4gICAgICAgIGE7XHJcbiAgICAoYSA9IGIgJiYgYi5odHRwSGVhZGVyc092ZXJ3cml0ZVBhcmFtKSAmJiAhc2EoYSkgJiYgKHRoaXMuZy5vID0gYSk7XHJcbiAgICB0aGlzLkEgPSBiICYmIGIuc3VwcG9ydHNDcm9zc0RvbWFpblhociB8fCAhMTtcclxuICAgIHRoaXMudiA9IGIgJiYgYi5zZW5kUmF3SnNvbiB8fCAhMTtcclxuICAgIChiID0gYiAmJiBiLmh0dHBTZXNzaW9uSWRQYXJhbSkgJiYgIXNhKGIpICYmICh0aGlzLmcuRCA9IGIsIGEgPSB0aGlzLmgsIG51bGwgIT09IGEgJiYgYiBpbiBhICYmIChhID0gdGhpcy5oLCBiIGluIGEgJiYgZGVsZXRlIGFbYl0pKTtcclxuICAgIHRoaXMuaiA9IG5ldyBaKHRoaXMpO1xyXG59XHJcbnQoWSwgQyk7XHJcblkucHJvdG90eXBlLm0gPSBmdW5jdGlvbiAoKSB7IHRoaXMuZy5qID0gdGhpcy5qOyB0aGlzLkEgJiYgKHRoaXMuZy5IID0gITApOyB2YXIgYSA9IHRoaXMuZywgYiA9IHRoaXMubCwgYyA9IHRoaXMuaCB8fCB2b2lkIDA7IGEuV2EgJiYgKGEuaC5pbmZvKFwiT3JpZ2luIFRyaWFscyBlbmFibGVkLlwiKSwgemIocShhLmhiLCBhLCBiKSkpOyBKKDApOyBhLlcgPSBiOyBhLmFhID0gYyB8fCB7fTsgYS5OID0gYS5YOyBhLkYgPSBFYyhhLCBudWxsLCBhLlcpOyBIYyhhKTsgfTtcclxuWS5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiAoKSB7IEljKHRoaXMuZyk7IH07XHJcblkucHJvdG90eXBlLnUgPSBmdW5jdGlvbiAoYSkgeyBpZiAoXCJzdHJpbmdcIiA9PT0gdHlwZW9mIGEpIHtcclxuICAgIHZhciBiID0ge307XHJcbiAgICBiLl9fZGF0YV9fID0gYTtcclxuICAgIE1kKHRoaXMuZywgYik7XHJcbn1cclxuZWxzZVxyXG4gICAgdGhpcy52ID8gKGIgPSB7fSwgYi5fX2RhdGFfXyA9IHJiKGEpLCBNZCh0aGlzLmcsIGIpKSA6IE1kKHRoaXMuZywgYSk7IH07XHJcblkucHJvdG90eXBlLk0gPSBmdW5jdGlvbiAoKSB7IHRoaXMuZy5qID0gbnVsbDsgZGVsZXRlIHRoaXMuajsgSWModGhpcy5nKTsgZGVsZXRlIHRoaXMuZzsgWS5aLk0uY2FsbCh0aGlzKTsgfTtcclxuZnVuY3Rpb24gVWQoYSkgeyBhYy5jYWxsKHRoaXMpOyB2YXIgYiA9IGEuX19zbV9fOyBpZiAoYikge1xyXG4gICAgYToge1xyXG4gICAgICAgIGZvciAodmFyIGMgaW4gYikge1xyXG4gICAgICAgICAgICBhID0gYztcclxuICAgICAgICAgICAgYnJlYWsgYTtcclxuICAgICAgICB9XHJcbiAgICAgICAgYSA9IHZvaWQgMDtcclxuICAgIH1cclxuICAgIGlmICh0aGlzLmkgPSBhKVxyXG4gICAgICAgIGEgPSB0aGlzLmksIGIgPSBudWxsICE9PSBiICYmIGEgaW4gYiA/IGJbYV0gOiB2b2lkIDA7XHJcbiAgICB0aGlzLmRhdGEgPSBiO1xyXG59XHJcbmVsc2VcclxuICAgIHRoaXMuZGF0YSA9IGE7IH1cclxudChVZCwgYWMpO1xyXG5mdW5jdGlvbiBWZCgpIHsgYmMuY2FsbCh0aGlzKTsgdGhpcy5zdGF0dXMgPSAxOyB9XHJcbnQoVmQsIGJjKTtcclxuZnVuY3Rpb24gWihhKSB7IHRoaXMuZyA9IGE7IH1cclxudChaLCBTZCk7XHJcbloucHJvdG90eXBlLnhhID0gZnVuY3Rpb24gKCkgeyBEKHRoaXMuZywgXCJhXCIpOyB9O1xyXG5aLnByb3RvdHlwZS53YSA9IGZ1bmN0aW9uIChhKSB7IEQodGhpcy5nLCBuZXcgVWQoYSkpOyB9O1xyXG5aLnByb3RvdHlwZS52YSA9IGZ1bmN0aW9uIChhKSB7IEQodGhpcy5nLCBuZXcgVmQoYSkpOyB9O1xyXG5aLnByb3RvdHlwZS51YSA9IGZ1bmN0aW9uICgpIHsgRCh0aGlzLmcsIFwiYlwiKTsgfTsgLypcclxuXG4gQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG5cbiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4geW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcblxuICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcblxuIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiovXHJcblRkLnByb3RvdHlwZS5jcmVhdGVXZWJDaGFubmVsID0gVGQucHJvdG90eXBlLmc7XHJcblkucHJvdG90eXBlLnNlbmQgPSBZLnByb3RvdHlwZS51O1xyXG5ZLnByb3RvdHlwZS5vcGVuID0gWS5wcm90b3R5cGUubTtcclxuWS5wcm90b3R5cGUuY2xvc2UgPSBZLnByb3RvdHlwZS5jbG9zZTtcclxuV2IuTk9fRVJST1IgPSAwO1xyXG5XYi5USU1FT1VUID0gODtcclxuV2IuSFRUUF9FUlJPUiA9IDY7XHJcblhiLkNPTVBMRVRFID0gXCJjb21wbGV0ZVwiO1xyXG4kYi5FdmVudFR5cGUgPSBMO1xyXG5MLk9QRU4gPSBcImFcIjtcclxuTC5DTE9TRSA9IFwiYlwiO1xyXG5MLkVSUk9SID0gXCJjXCI7XHJcbkwuTUVTU0FHRSA9IFwiZFwiO1xyXG5DLnByb3RvdHlwZS5saXN0ZW4gPSBDLnByb3RvdHlwZS5OO1xyXG5YLnByb3RvdHlwZS5saXN0ZW5PbmNlID0gWC5wcm90b3R5cGUuTztcclxuWC5wcm90b3R5cGUuZ2V0TGFzdEVycm9yID0gWC5wcm90b3R5cGUuTGE7XHJcblgucHJvdG90eXBlLmdldExhc3RFcnJvckNvZGUgPSBYLnByb3RvdHlwZS5EYTtcclxuWC5wcm90b3R5cGUuZ2V0U3RhdHVzID0gWC5wcm90b3R5cGUuYmE7XHJcblgucHJvdG90eXBlLmdldFJlc3BvbnNlSnNvbiA9IFgucHJvdG90eXBlLlFhO1xyXG5YLnByb3RvdHlwZS5nZXRSZXNwb25zZVRleHQgPSBYLnByb3RvdHlwZS5nYTtcclxuWC5wcm90b3R5cGUuc2VuZCA9IFgucHJvdG90eXBlLmVhO1xyXG52YXIgY3JlYXRlV2ViQ2hhbm5lbFRyYW5zcG9ydCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5ldyBUZDsgfTtcclxudmFyIGdldFN0YXRFdmVudFRhcmdldCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIFNiKCk7IH07XHJcbnZhciBFcnJvckNvZGUgPSBXYjtcclxudmFyIEV2ZW50VHlwZSA9IFhiO1xyXG52YXIgRXZlbnQgPSBIO1xyXG52YXIgU3RhdCA9IHsgcmI6IDAsIHViOiAxLCB2YjogMiwgT2I6IDMsIFRiOiA0LCBRYjogNSwgUmI6IDYsIFBiOiA3LCBOYjogOCwgU2I6IDksIFBST1hZOiAxMCwgTk9QUk9YWTogMTEsIExiOiAxMiwgSGI6IDEzLCBJYjogMTQsIEdiOiAxNSwgSmI6IDE2LCBLYjogMTcsIG5iOiAxOCwgbWI6IDE5LCBvYjogMjAgfTtcclxudmFyIEZldGNoWG1sSHR0cEZhY3RvcnkgPSBwZDtcclxudmFyIFdlYkNoYW5uZWwgPSAkYjtcclxudmFyIFhocklvID0gWDtcclxuXHJcbnZhciBlc20gPSB7XHJcbiAgICBjcmVhdGVXZWJDaGFubmVsVHJhbnNwb3J0OiBjcmVhdGVXZWJDaGFubmVsVHJhbnNwb3J0LFxyXG4gICAgZ2V0U3RhdEV2ZW50VGFyZ2V0OiBnZXRTdGF0RXZlbnRUYXJnZXQsXHJcbiAgICBFcnJvckNvZGU6IEVycm9yQ29kZSxcclxuICAgIEV2ZW50VHlwZTogRXZlbnRUeXBlLFxyXG4gICAgRXZlbnQ6IEV2ZW50LFxyXG4gICAgU3RhdDogU3RhdCxcclxuICAgIEZldGNoWG1sSHR0cEZhY3Rvcnk6IEZldGNoWG1sSHR0cEZhY3RvcnksXHJcbiAgICBXZWJDaGFubmVsOiBXZWJDaGFubmVsLFxyXG4gICAgWGhySW86IFhocklvXHJcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGVzbTtcbmV4cG9ydCB7IEVycm9yQ29kZSwgRXZlbnQsIEV2ZW50VHlwZSwgRmV0Y2hYbWxIdHRwRmFjdG9yeSwgU3RhdCwgV2ViQ2hhbm5lbCwgWGhySW8sIGNyZWF0ZVdlYkNoYW5uZWxUcmFuc3BvcnQsIGdldFN0YXRFdmVudFRhcmdldCB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguZXNtLmpzLm1hcFxuIiwiZXhwb3J0IGZ1bmN0aW9uIGhpZ2hsaWdodEFjdGl2ZU5hdigpIHtcbiAgICBjb25zdCBuYXZMaW5rcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY3VzdG9tLW5hdmJhciAubmF2LWxpbmtcIik7XG4gICAgY29uc3QgY3VycmVudFBhdGggPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUuc3BsaXQoXCIvXCIpLnBvcCgpO1xuICBcbiAgICBuYXZMaW5rcy5mb3JFYWNoKChsaW5rKSA9PiB7XG4gICAgICBjb25zdCBsaW5rUGF0aCA9IGxpbmsuZ2V0QXR0cmlidXRlKFwiaHJlZlwiKTtcbiAgICAgIGlmIChsaW5rUGF0aCA9PT0gY3VycmVudFBhdGggfHwgKGxpbmtQYXRoID09PSBcIiNcIiAmJiBjdXJyZW50UGF0aC5pbmNsdWRlcyhcImZhcVwiKSkpIHtcbiAgICAgICAgbGluay5jbGFzc0xpc3QuYWRkKFwiYWN0aXZlXCIpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbGluay5jbGFzc0xpc3QucmVtb3ZlKFwiYWN0aXZlXCIpO1xuICAgICAgfVxuICAgIH0pO1xufSIsImltcG9ydCB7IF9fdmFsdWVzLCBfX3JlYWQsIF9fYXdhaXRlciwgX19nZW5lcmF0b3IsIF9fc3ByZWFkQXJyYXkgfSBmcm9tICd0c2xpYic7XG5pbXBvcnQgeyBEZWZlcnJlZCB9IGZyb20gJ0BmaXJlYmFzZS91dGlsJztcblxuLyoqXHJcbiAqIENvbXBvbmVudCBmb3Igc2VydmljZSBuYW1lIFQsIGUuZy4gYGF1dGhgLCBgYXV0aC1pbnRlcm5hbGBcclxuICovXHJcbnZhciBDb21wb25lbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICAvKipcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gbmFtZSBUaGUgcHVibGljIHNlcnZpY2UgbmFtZSwgZS5nLiBhcHAsIGF1dGgsIGZpcmVzdG9yZSwgZGF0YWJhc2VcclxuICAgICAqIEBwYXJhbSBpbnN0YW5jZUZhY3RvcnkgU2VydmljZSBmYWN0b3J5IHJlc3BvbnNpYmxlIGZvciBjcmVhdGluZyB0aGUgcHVibGljIGludGVyZmFjZVxyXG4gICAgICogQHBhcmFtIHR5cGUgd2hldGhlciB0aGUgc2VydmljZSBwcm92aWRlZCBieSB0aGUgY29tcG9uZW50IGlzIHB1YmxpYyBvciBwcml2YXRlXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIENvbXBvbmVudChuYW1lLCBpbnN0YW5jZUZhY3RvcnksIHR5cGUpIHtcclxuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMuaW5zdGFuY2VGYWN0b3J5ID0gaW5zdGFuY2VGYWN0b3J5O1xyXG4gICAgICAgIHRoaXMudHlwZSA9IHR5cGU7XHJcbiAgICAgICAgdGhpcy5tdWx0aXBsZUluc3RhbmNlcyA9IGZhbHNlO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFByb3BlcnRpZXMgdG8gYmUgYWRkZWQgdG8gdGhlIHNlcnZpY2UgbmFtZXNwYWNlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5zZXJ2aWNlUHJvcHMgPSB7fTtcclxuICAgICAgICB0aGlzLmluc3RhbnRpYXRpb25Nb2RlID0gXCJMQVpZXCIgLyogTEFaWSAqLztcclxuICAgICAgICB0aGlzLm9uSW5zdGFuY2VDcmVhdGVkID0gbnVsbDtcclxuICAgIH1cclxuICAgIENvbXBvbmVudC5wcm90b3R5cGUuc2V0SW5zdGFudGlhdGlvbk1vZGUgPSBmdW5jdGlvbiAobW9kZSkge1xyXG4gICAgICAgIHRoaXMuaW5zdGFudGlhdGlvbk1vZGUgPSBtb2RlO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuICAgIENvbXBvbmVudC5wcm90b3R5cGUuc2V0TXVsdGlwbGVJbnN0YW5jZXMgPSBmdW5jdGlvbiAobXVsdGlwbGVJbnN0YW5jZXMpIHtcclxuICAgICAgICB0aGlzLm11bHRpcGxlSW5zdGFuY2VzID0gbXVsdGlwbGVJbnN0YW5jZXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9O1xyXG4gICAgQ29tcG9uZW50LnByb3RvdHlwZS5zZXRTZXJ2aWNlUHJvcHMgPSBmdW5jdGlvbiAocHJvcHMpIHtcclxuICAgICAgICB0aGlzLnNlcnZpY2VQcm9wcyA9IHByb3BzO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuICAgIENvbXBvbmVudC5wcm90b3R5cGUuc2V0SW5zdGFuY2VDcmVhdGVkQ2FsbGJhY2sgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcclxuICAgICAgICB0aGlzLm9uSW5zdGFuY2VDcmVhdGVkID0gY2FsbGJhY2s7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIENvbXBvbmVudDtcclxufSgpKTtcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIERFRkFVTFRfRU5UUllfTkFNRSA9ICdbREVGQVVMVF0nO1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogUHJvdmlkZXIgZm9yIGluc3RhbmNlIGZvciBzZXJ2aWNlIG5hbWUgVCwgZS5nLiAnYXV0aCcsICdhdXRoLWludGVybmFsJ1xyXG4gKiBOYW1lU2VydmljZU1hcHBpbmdbVF0gaXMgYW4gYWxpYXMgZm9yIHRoZSB0eXBlIG9mIHRoZSBpbnN0YW5jZVxyXG4gKi9cclxudmFyIFByb3ZpZGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gUHJvdmlkZXIobmFtZSwgY29udGFpbmVyKSB7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcclxuICAgICAgICB0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcclxuICAgICAgICB0aGlzLmNvbXBvbmVudCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5pbnN0YW5jZXMgPSBuZXcgTWFwKCk7XHJcbiAgICAgICAgdGhpcy5pbnN0YW5jZXNEZWZlcnJlZCA9IG5ldyBNYXAoKTtcclxuICAgICAgICB0aGlzLmluc3RhbmNlc09wdGlvbnMgPSBuZXcgTWFwKCk7XHJcbiAgICAgICAgdGhpcy5vbkluaXRDYWxsYmFja3MgPSBuZXcgTWFwKCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEBwYXJhbSBpZGVudGlmaWVyIEEgcHJvdmlkZXIgY2FuIHByb3ZpZGUgbXVsaXRwbGUgaW5zdGFuY2VzIG9mIGEgc2VydmljZVxyXG4gICAgICogaWYgdGhpcy5jb21wb25lbnQubXVsdGlwbGVJbnN0YW5jZXMgaXMgdHJ1ZS5cclxuICAgICAqL1xyXG4gICAgUHJvdmlkZXIucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIChpZGVudGlmaWVyKSB7XHJcbiAgICAgICAgLy8gaWYgbXVsdGlwbGVJbnN0YW5jZXMgaXMgbm90IHN1cHBvcnRlZCwgdXNlIHRoZSBkZWZhdWx0IG5hbWVcclxuICAgICAgICB2YXIgbm9ybWFsaXplZElkZW50aWZpZXIgPSB0aGlzLm5vcm1hbGl6ZUluc3RhbmNlSWRlbnRpZmllcihpZGVudGlmaWVyKTtcclxuICAgICAgICBpZiAoIXRoaXMuaW5zdGFuY2VzRGVmZXJyZWQuaGFzKG5vcm1hbGl6ZWRJZGVudGlmaWVyKSkge1xyXG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSBuZXcgRGVmZXJyZWQoKTtcclxuICAgICAgICAgICAgdGhpcy5pbnN0YW5jZXNEZWZlcnJlZC5zZXQobm9ybWFsaXplZElkZW50aWZpZXIsIGRlZmVycmVkKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuaXNJbml0aWFsaXplZChub3JtYWxpemVkSWRlbnRpZmllcikgfHxcclxuICAgICAgICAgICAgICAgIHRoaXMuc2hvdWxkQXV0b0luaXRpYWxpemUoKSkge1xyXG4gICAgICAgICAgICAgICAgLy8gaW5pdGlhbGl6ZSB0aGUgc2VydmljZSBpZiBpdCBjYW4gYmUgYXV0by1pbml0aWFsaXplZFxyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5zdGFuY2UgPSB0aGlzLmdldE9ySW5pdGlhbGl6ZVNlcnZpY2Uoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZUlkZW50aWZpZXI6IG5vcm1hbGl6ZWRJZGVudGlmaWVyXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluc3RhbmNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoaW5zdGFuY2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gd2hlbiB0aGUgaW5zdGFuY2UgZmFjdG9yeSB0aHJvd3MgYW4gZXhjZXB0aW9uIGR1cmluZyBnZXQoKSwgaXQgc2hvdWxkIG5vdCBjYXVzZVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGEgZmF0YWwgZXJyb3IuIFdlIGp1c3QgcmV0dXJuIHRoZSB1bnJlc29sdmVkIHByb21pc2UgaW4gdGhpcyBjYXNlLlxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmluc3RhbmNlc0RlZmVycmVkLmdldChub3JtYWxpemVkSWRlbnRpZmllcikucHJvbWlzZTtcclxuICAgIH07XHJcbiAgICBQcm92aWRlci5wcm90b3R5cGUuZ2V0SW1tZWRpYXRlID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcclxuICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgLy8gaWYgbXVsdGlwbGVJbnN0YW5jZXMgaXMgbm90IHN1cHBvcnRlZCwgdXNlIHRoZSBkZWZhdWx0IG5hbWVcclxuICAgICAgICB2YXIgbm9ybWFsaXplZElkZW50aWZpZXIgPSB0aGlzLm5vcm1hbGl6ZUluc3RhbmNlSWRlbnRpZmllcihvcHRpb25zID09PSBudWxsIHx8IG9wdGlvbnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG9wdGlvbnMuaWRlbnRpZmllcik7XHJcbiAgICAgICAgdmFyIG9wdGlvbmFsID0gKF9hID0gb3B0aW9ucyA9PT0gbnVsbCB8fCBvcHRpb25zID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcHRpb25zLm9wdGlvbmFsKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiBmYWxzZTtcclxuICAgICAgICBpZiAodGhpcy5pc0luaXRpYWxpemVkKG5vcm1hbGl6ZWRJZGVudGlmaWVyKSB8fFxyXG4gICAgICAgICAgICB0aGlzLnNob3VsZEF1dG9Jbml0aWFsaXplKCkpIHtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldE9ySW5pdGlhbGl6ZVNlcnZpY2Uoe1xyXG4gICAgICAgICAgICAgICAgICAgIGluc3RhbmNlSWRlbnRpZmllcjogbm9ybWFsaXplZElkZW50aWZpZXJcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9uYWwpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IGU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIEluIGNhc2UgYSBjb21wb25lbnQgaXMgbm90IGluaXRpYWxpemVkIGFuZCBzaG91bGQvY2FuIG5vdCBiZSBhdXRvLWluaXRpYWxpemVkIGF0IHRoZSBtb21lbnQsIHJldHVybiBudWxsIGlmIHRoZSBvcHRpb25hbCBmbGFnIGlzIHNldCwgb3IgdGhyb3dcclxuICAgICAgICAgICAgaWYgKG9wdGlvbmFsKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRocm93IEVycm9yKFwiU2VydmljZSBcIiArIHRoaXMubmFtZSArIFwiIGlzIG5vdCBhdmFpbGFibGVcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgUHJvdmlkZXIucHJvdG90eXBlLmdldENvbXBvbmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jb21wb25lbnQ7XHJcbiAgICB9O1xyXG4gICAgUHJvdmlkZXIucHJvdG90eXBlLnNldENvbXBvbmVudCA9IGZ1bmN0aW9uIChjb21wb25lbnQpIHtcclxuICAgICAgICB2YXIgZV8xLCBfYTtcclxuICAgICAgICBpZiAoY29tcG9uZW50Lm5hbWUgIT09IHRoaXMubmFtZSkge1xyXG4gICAgICAgICAgICB0aHJvdyBFcnJvcihcIk1pc21hdGNoaW5nIENvbXBvbmVudCBcIiArIGNvbXBvbmVudC5uYW1lICsgXCIgZm9yIFByb3ZpZGVyIFwiICsgdGhpcy5uYW1lICsgXCIuXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5jb21wb25lbnQpIHtcclxuICAgICAgICAgICAgdGhyb3cgRXJyb3IoXCJDb21wb25lbnQgZm9yIFwiICsgdGhpcy5uYW1lICsgXCIgaGFzIGFscmVhZHkgYmVlbiBwcm92aWRlZFwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jb21wb25lbnQgPSBjb21wb25lbnQ7XHJcbiAgICAgICAgLy8gcmV0dXJuIGVhcmx5IHdpdGhvdXQgYXR0ZW1wdGluZyB0byBpbml0aWFsaXplIHRoZSBjb21wb25lbnQgaWYgdGhlIGNvbXBvbmVudCByZXF1aXJlcyBleHBsaWNpdCBpbml0aWFsaXphdGlvbiAoY2FsbGluZyBgUHJvdmlkZXIuaW5pdGlhbGl6ZSgpYClcclxuICAgICAgICBpZiAoIXRoaXMuc2hvdWxkQXV0b0luaXRpYWxpemUoKSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGlmIHRoZSBzZXJ2aWNlIGlzIGVhZ2VyLCBpbml0aWFsaXplIHRoZSBkZWZhdWx0IGluc3RhbmNlXHJcbiAgICAgICAgaWYgKGlzQ29tcG9uZW50RWFnZXIoY29tcG9uZW50KSkge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5nZXRPckluaXRpYWxpemVTZXJ2aWNlKHsgaW5zdGFuY2VJZGVudGlmaWVyOiBERUZBVUxUX0VOVFJZX05BTUUgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgIC8vIHdoZW4gdGhlIGluc3RhbmNlIGZhY3RvcnkgZm9yIGFuIGVhZ2VyIENvbXBvbmVudCB0aHJvd3MgYW4gZXhjZXB0aW9uIGR1cmluZyB0aGUgZWFnZXJcclxuICAgICAgICAgICAgICAgIC8vIGluaXRpYWxpemF0aW9uLCBpdCBzaG91bGQgbm90IGNhdXNlIGEgZmF0YWwgZXJyb3IuXHJcbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBJbnZlc3RpZ2F0ZSBpZiB3ZSBuZWVkIHRvIG1ha2UgaXQgY29uZmlndXJhYmxlLCBiZWNhdXNlIHNvbWUgY29tcG9uZW50IG1heSB3YW50IHRvIGNhdXNlXHJcbiAgICAgICAgICAgICAgICAvLyBhIGZhdGFsIGVycm9yIGluIHRoaXMgY2FzZT9cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAvLyBDcmVhdGUgc2VydmljZSBpbnN0YW5jZXMgZm9yIHRoZSBwZW5kaW5nIHByb21pc2VzIGFuZCByZXNvbHZlIHRoZW1cclxuICAgICAgICAgICAgLy8gTk9URTogaWYgdGhpcy5tdWx0aXBsZUluc3RhbmNlcyBpcyBmYWxzZSwgb25seSB0aGUgZGVmYXVsdCBpbnN0YW5jZSB3aWxsIGJlIGNyZWF0ZWRcclxuICAgICAgICAgICAgLy8gYW5kIGFsbCBwcm9taXNlcyB3aXRoIHJlc29sdmUgd2l0aCBpdCByZWdhcmRsZXNzIG9mIHRoZSBpZGVudGlmaWVyLlxyXG4gICAgICAgICAgICBmb3IgKHZhciBfYiA9IF9fdmFsdWVzKHRoaXMuaW5zdGFuY2VzRGVmZXJyZWQuZW50cmllcygpKSwgX2MgPSBfYi5uZXh0KCk7ICFfYy5kb25lOyBfYyA9IF9iLm5leHQoKSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIF9kID0gX19yZWFkKF9jLnZhbHVlLCAyKSwgaW5zdGFuY2VJZGVudGlmaWVyID0gX2RbMF0sIGluc3RhbmNlRGVmZXJyZWQgPSBfZFsxXTtcclxuICAgICAgICAgICAgICAgIHZhciBub3JtYWxpemVkSWRlbnRpZmllciA9IHRoaXMubm9ybWFsaXplSW5zdGFuY2VJZGVudGlmaWVyKGluc3RhbmNlSWRlbnRpZmllcik7XHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGBnZXRPckluaXRpYWxpemVTZXJ2aWNlKClgIHNob3VsZCBhbHdheXMgcmV0dXJuIGEgdmFsaWQgaW5zdGFuY2Ugc2luY2UgYSBjb21wb25lbnQgaXMgZ3VhcmFudGVlZC4gdXNlICEgdG8gbWFrZSB0eXBlc2NyaXB0IGhhcHB5LlxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbnN0YW5jZSA9IHRoaXMuZ2V0T3JJbml0aWFsaXplU2VydmljZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbmNlSWRlbnRpZmllcjogbm9ybWFsaXplZElkZW50aWZpZXJcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZURlZmVycmVkLnJlc29sdmUoaW5zdGFuY2UpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyB3aGVuIHRoZSBpbnN0YW5jZSBmYWN0b3J5IHRocm93cyBhbiBleGNlcHRpb24sIGl0IHNob3VsZCBub3QgY2F1c2VcclxuICAgICAgICAgICAgICAgICAgICAvLyBhIGZhdGFsIGVycm9yLiBXZSBqdXN0IGxlYXZlIHRoZSBwcm9taXNlIHVucmVzb2x2ZWQuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH1cclxuICAgICAgICBmaW5hbGx5IHtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIGlmIChfYyAmJiAhX2MuZG9uZSAmJiAoX2EgPSBfYi5yZXR1cm4pKSBfYS5jYWxsKF9iKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFByb3ZpZGVyLnByb3RvdHlwZS5jbGVhckluc3RhbmNlID0gZnVuY3Rpb24gKGlkZW50aWZpZXIpIHtcclxuICAgICAgICBpZiAoaWRlbnRpZmllciA9PT0gdm9pZCAwKSB7IGlkZW50aWZpZXIgPSBERUZBVUxUX0VOVFJZX05BTUU7IH1cclxuICAgICAgICB0aGlzLmluc3RhbmNlc0RlZmVycmVkLmRlbGV0ZShpZGVudGlmaWVyKTtcclxuICAgICAgICB0aGlzLmluc3RhbmNlc09wdGlvbnMuZGVsZXRlKGlkZW50aWZpZXIpO1xyXG4gICAgICAgIHRoaXMuaW5zdGFuY2VzLmRlbGV0ZShpZGVudGlmaWVyKTtcclxuICAgIH07XHJcbiAgICAvLyBhcHAuZGVsZXRlKCkgd2lsbCBjYWxsIHRoaXMgbWV0aG9kIG9uIGV2ZXJ5IHByb3ZpZGVyIHRvIGRlbGV0ZSB0aGUgc2VydmljZXNcclxuICAgIC8vIFRPRE86IHNob3VsZCB3ZSBtYXJrIHRoZSBwcm92aWRlciBhcyBkZWxldGVkP1xyXG4gICAgUHJvdmlkZXIucHJvdG90eXBlLmRlbGV0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBzZXJ2aWNlcztcclxuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VydmljZXMgPSBBcnJheS5mcm9tKHRoaXMuaW5zdGFuY2VzLnZhbHVlcygpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgUHJvbWlzZS5hbGwoX19zcHJlYWRBcnJheShfX3NwcmVhZEFycmF5KFtdLCBfX3JlYWQoc2VydmljZXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChzZXJ2aWNlKSB7IHJldHVybiAnSU5URVJOQUwnIGluIHNlcnZpY2U7IH0pIC8vIGxlZ2FjeSBzZXJ2aWNlc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAoc2VydmljZSkgeyByZXR1cm4gc2VydmljZS5JTlRFUk5BTC5kZWxldGUoKTsgfSkpKSwgX19yZWFkKHNlcnZpY2VzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoc2VydmljZSkgeyByZXR1cm4gJ19kZWxldGUnIGluIHNlcnZpY2U7IH0pIC8vIG1vZHVsYXJpemVkIHNlcnZpY2VzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChzZXJ2aWNlKSB7IHJldHVybiBzZXJ2aWNlLl9kZWxldGUoKTsgfSkpKSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFByb3ZpZGVyLnByb3RvdHlwZS5pc0NvbXBvbmVudFNldCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jb21wb25lbnQgIT0gbnVsbDtcclxuICAgIH07XHJcbiAgICBQcm92aWRlci5wcm90b3R5cGUuaXNJbml0aWFsaXplZCA9IGZ1bmN0aW9uIChpZGVudGlmaWVyKSB7XHJcbiAgICAgICAgaWYgKGlkZW50aWZpZXIgPT09IHZvaWQgMCkgeyBpZGVudGlmaWVyID0gREVGQVVMVF9FTlRSWV9OQU1FOyB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5zdGFuY2VzLmhhcyhpZGVudGlmaWVyKTtcclxuICAgIH07XHJcbiAgICBQcm92aWRlci5wcm90b3R5cGUuZ2V0T3B0aW9ucyA9IGZ1bmN0aW9uIChpZGVudGlmaWVyKSB7XHJcbiAgICAgICAgaWYgKGlkZW50aWZpZXIgPT09IHZvaWQgMCkgeyBpZGVudGlmaWVyID0gREVGQVVMVF9FTlRSWV9OQU1FOyB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5zdGFuY2VzT3B0aW9ucy5nZXQoaWRlbnRpZmllcikgfHwge307XHJcbiAgICB9O1xyXG4gICAgUHJvdmlkZXIucHJvdG90eXBlLmluaXRpYWxpemUgPSBmdW5jdGlvbiAob3B0cykge1xyXG4gICAgICAgIHZhciBlXzIsIF9hO1xyXG4gICAgICAgIGlmIChvcHRzID09PSB2b2lkIDApIHsgb3B0cyA9IHt9OyB9XHJcbiAgICAgICAgdmFyIF9iID0gb3B0cy5vcHRpb25zLCBvcHRpb25zID0gX2IgPT09IHZvaWQgMCA/IHt9IDogX2I7XHJcbiAgICAgICAgdmFyIG5vcm1hbGl6ZWRJZGVudGlmaWVyID0gdGhpcy5ub3JtYWxpemVJbnN0YW5jZUlkZW50aWZpZXIob3B0cy5pbnN0YW5jZUlkZW50aWZpZXIpO1xyXG4gICAgICAgIGlmICh0aGlzLmlzSW5pdGlhbGl6ZWQobm9ybWFsaXplZElkZW50aWZpZXIpKSB7XHJcbiAgICAgICAgICAgIHRocm93IEVycm9yKHRoaXMubmFtZSArIFwiKFwiICsgbm9ybWFsaXplZElkZW50aWZpZXIgKyBcIikgaGFzIGFscmVhZHkgYmVlbiBpbml0aWFsaXplZFwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzQ29tcG9uZW50U2V0KCkpIHtcclxuICAgICAgICAgICAgdGhyb3cgRXJyb3IoXCJDb21wb25lbnQgXCIgKyB0aGlzLm5hbWUgKyBcIiBoYXMgbm90IGJlZW4gcmVnaXN0ZXJlZCB5ZXRcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBpbnN0YW5jZSA9IHRoaXMuZ2V0T3JJbml0aWFsaXplU2VydmljZSh7XHJcbiAgICAgICAgICAgIGluc3RhbmNlSWRlbnRpZmllcjogbm9ybWFsaXplZElkZW50aWZpZXIsXHJcbiAgICAgICAgICAgIG9wdGlvbnM6IG9wdGlvbnNcclxuICAgICAgICB9KTtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAvLyByZXNvbHZlIGFueSBwZW5kaW5nIHByb21pc2Ugd2FpdGluZyBmb3IgdGhlIHNlcnZpY2UgaW5zdGFuY2VcclxuICAgICAgICAgICAgZm9yICh2YXIgX2MgPSBfX3ZhbHVlcyh0aGlzLmluc3RhbmNlc0RlZmVycmVkLmVudHJpZXMoKSksIF9kID0gX2MubmV4dCgpOyAhX2QuZG9uZTsgX2QgPSBfYy5uZXh0KCkpIHtcclxuICAgICAgICAgICAgICAgIHZhciBfZSA9IF9fcmVhZChfZC52YWx1ZSwgMiksIGluc3RhbmNlSWRlbnRpZmllciA9IF9lWzBdLCBpbnN0YW5jZURlZmVycmVkID0gX2VbMV07XHJcbiAgICAgICAgICAgICAgICB2YXIgbm9ybWFsaXplZERlZmVycmVkSWRlbnRpZmllciA9IHRoaXMubm9ybWFsaXplSW5zdGFuY2VJZGVudGlmaWVyKGluc3RhbmNlSWRlbnRpZmllcik7XHJcbiAgICAgICAgICAgICAgICBpZiAobm9ybWFsaXplZElkZW50aWZpZXIgPT09IG5vcm1hbGl6ZWREZWZlcnJlZElkZW50aWZpZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZURlZmVycmVkLnJlc29sdmUoaW5zdGFuY2UpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChlXzJfMSkgeyBlXzIgPSB7IGVycm9yOiBlXzJfMSB9OyB9XHJcbiAgICAgICAgZmluYWxseSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoX2QgJiYgIV9kLmRvbmUgJiYgKF9hID0gX2MucmV0dXJuKSkgX2EuY2FsbChfYyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZmluYWxseSB7IGlmIChlXzIpIHRocm93IGVfMi5lcnJvcjsgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gaW5zdGFuY2U7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGNhbGxiYWNrIC0gYSBmdW5jdGlvbiB0aGF0IHdpbGwgYmUgaW52b2tlZCAgYWZ0ZXIgdGhlIHByb3ZpZGVyIGhhcyBiZWVuIGluaXRpYWxpemVkIGJ5IGNhbGxpbmcgcHJvdmlkZXIuaW5pdGlhbGl6ZSgpLlxyXG4gICAgICogVGhlIGZ1bmN0aW9uIGlzIGludm9rZWQgU1lOQ0hST05PVVNMWSwgc28gaXQgc2hvdWxkIG5vdCBleGVjdXRlIGFueSBsb25ncnVubmluZyB0YXNrcyBpbiBvcmRlciB0byBub3QgYmxvY2sgdGhlIHByb2dyYW0uXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGlkZW50aWZpZXIgQW4gb3B0aW9uYWwgaW5zdGFuY2UgaWRlbnRpZmllclxyXG4gICAgICogQHJldHVybnMgYSBmdW5jdGlvbiB0byB1bnJlZ2lzdGVyIHRoZSBjYWxsYmFja1xyXG4gICAgICovXHJcbiAgICBQcm92aWRlci5wcm90b3R5cGUub25Jbml0ID0gZnVuY3Rpb24gKGNhbGxiYWNrLCBpZGVudGlmaWVyKSB7XHJcbiAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgIHZhciBub3JtYWxpemVkSWRlbnRpZmllciA9IHRoaXMubm9ybWFsaXplSW5zdGFuY2VJZGVudGlmaWVyKGlkZW50aWZpZXIpO1xyXG4gICAgICAgIHZhciBleGlzdGluZ0NhbGxiYWNrcyA9IChfYSA9IHRoaXMub25Jbml0Q2FsbGJhY2tzLmdldChub3JtYWxpemVkSWRlbnRpZmllcikpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IG5ldyBTZXQoKTtcclxuICAgICAgICBleGlzdGluZ0NhbGxiYWNrcy5hZGQoY2FsbGJhY2spO1xyXG4gICAgICAgIHRoaXMub25Jbml0Q2FsbGJhY2tzLnNldChub3JtYWxpemVkSWRlbnRpZmllciwgZXhpc3RpbmdDYWxsYmFja3MpO1xyXG4gICAgICAgIHZhciBleGlzdGluZ0luc3RhbmNlID0gdGhpcy5pbnN0YW5jZXMuZ2V0KG5vcm1hbGl6ZWRJZGVudGlmaWVyKTtcclxuICAgICAgICBpZiAoZXhpc3RpbmdJbnN0YW5jZSkge1xyXG4gICAgICAgICAgICBjYWxsYmFjayhleGlzdGluZ0luc3RhbmNlLCBub3JtYWxpemVkSWRlbnRpZmllcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGV4aXN0aW5nQ2FsbGJhY2tzLmRlbGV0ZShjYWxsYmFjayk7XHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEludm9rZSBvbkluaXQgY2FsbGJhY2tzIHN5bmNocm9ub3VzbHlcclxuICAgICAqIEBwYXJhbSBpbnN0YW5jZSB0aGUgc2VydmljZSBpbnN0YW5jZWBcclxuICAgICAqL1xyXG4gICAgUHJvdmlkZXIucHJvdG90eXBlLmludm9rZU9uSW5pdENhbGxiYWNrcyA9IGZ1bmN0aW9uIChpbnN0YW5jZSwgaWRlbnRpZmllcikge1xyXG4gICAgICAgIHZhciBlXzMsIF9hO1xyXG4gICAgICAgIHZhciBjYWxsYmFja3MgPSB0aGlzLm9uSW5pdENhbGxiYWNrcy5nZXQoaWRlbnRpZmllcik7XHJcbiAgICAgICAgaWYgKCFjYWxsYmFja3MpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBjYWxsYmFja3NfMSA9IF9fdmFsdWVzKGNhbGxiYWNrcyksIGNhbGxiYWNrc18xXzEgPSBjYWxsYmFja3NfMS5uZXh0KCk7ICFjYWxsYmFja3NfMV8xLmRvbmU7IGNhbGxiYWNrc18xXzEgPSBjYWxsYmFja3NfMS5uZXh0KCkpIHtcclxuICAgICAgICAgICAgICAgIHZhciBjYWxsYmFjayA9IGNhbGxiYWNrc18xXzEudmFsdWU7XHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKGluc3RhbmNlLCBpZGVudGlmaWVyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNhdGNoIChfYikge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGlnbm9yZSBlcnJvcnMgaW4gdGhlIG9uSW5pdCBjYWxsYmFja1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChlXzNfMSkgeyBlXzMgPSB7IGVycm9yOiBlXzNfMSB9OyB9XHJcbiAgICAgICAgZmluYWxseSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2tzXzFfMSAmJiAhY2FsbGJhY2tzXzFfMS5kb25lICYmIChfYSA9IGNhbGxiYWNrc18xLnJldHVybikpIF9hLmNhbGwoY2FsbGJhY2tzXzEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8zKSB0aHJvdyBlXzMuZXJyb3I7IH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgUHJvdmlkZXIucHJvdG90eXBlLmdldE9ySW5pdGlhbGl6ZVNlcnZpY2UgPSBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICB2YXIgaW5zdGFuY2VJZGVudGlmaWVyID0gX2EuaW5zdGFuY2VJZGVudGlmaWVyLCBfYiA9IF9hLm9wdGlvbnMsIG9wdGlvbnMgPSBfYiA9PT0gdm9pZCAwID8ge30gOiBfYjtcclxuICAgICAgICB2YXIgaW5zdGFuY2UgPSB0aGlzLmluc3RhbmNlcy5nZXQoaW5zdGFuY2VJZGVudGlmaWVyKTtcclxuICAgICAgICBpZiAoIWluc3RhbmNlICYmIHRoaXMuY29tcG9uZW50KSB7XHJcbiAgICAgICAgICAgIGluc3RhbmNlID0gdGhpcy5jb21wb25lbnQuaW5zdGFuY2VGYWN0b3J5KHRoaXMuY29udGFpbmVyLCB7XHJcbiAgICAgICAgICAgICAgICBpbnN0YW5jZUlkZW50aWZpZXI6IG5vcm1hbGl6ZUlkZW50aWZpZXJGb3JGYWN0b3J5KGluc3RhbmNlSWRlbnRpZmllciksXHJcbiAgICAgICAgICAgICAgICBvcHRpb25zOiBvcHRpb25zXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLmluc3RhbmNlcy5zZXQoaW5zdGFuY2VJZGVudGlmaWVyLCBpbnN0YW5jZSk7XHJcbiAgICAgICAgICAgIHRoaXMuaW5zdGFuY2VzT3B0aW9ucy5zZXQoaW5zdGFuY2VJZGVudGlmaWVyLCBvcHRpb25zKTtcclxuICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAqIEludm9rZSBvbkluaXQgbGlzdGVuZXJzLlxyXG4gICAgICAgICAgICAgKiBOb3RlIHRoaXMuY29tcG9uZW50Lm9uSW5zdGFuY2VDcmVhdGVkIGlzIGRpZmZlcmVudCwgd2hpY2ggaXMgdXNlZCBieSB0aGUgY29tcG9uZW50IGNyZWF0b3IsXHJcbiAgICAgICAgICAgICAqIHdoaWxlIG9uSW5pdCBsaXN0ZW5lcnMgYXJlIHJlZ2lzdGVyZWQgYnkgY29uc3VtZXJzIG9mIHRoZSBwcm92aWRlci5cclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIHRoaXMuaW52b2tlT25Jbml0Q2FsbGJhY2tzKGluc3RhbmNlLCBpbnN0YW5jZUlkZW50aWZpZXIpO1xyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICogT3JkZXIgaXMgaW1wb3J0YW50XHJcbiAgICAgICAgICAgICAqIG9uSW5zdGFuY2VDcmVhdGVkKCkgc2hvdWxkIGJlIGNhbGxlZCBhZnRlciB0aGlzLmluc3RhbmNlcy5zZXQoaW5zdGFuY2VJZGVudGlmaWVyLCBpbnN0YW5jZSk7IHdoaWNoXHJcbiAgICAgICAgICAgICAqIG1ha2VzIGBpc0luaXRpYWxpemVkKClgIHJldHVybiB0cnVlLlxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgaWYgKHRoaXMuY29tcG9uZW50Lm9uSW5zdGFuY2VDcmVhdGVkKSB7XHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcG9uZW50Lm9uSW5zdGFuY2VDcmVhdGVkKHRoaXMuY29udGFpbmVyLCBpbnN0YW5jZUlkZW50aWZpZXIsIGluc3RhbmNlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNhdGNoIChfYykge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGlnbm9yZSBlcnJvcnMgaW4gdGhlIG9uSW5zdGFuY2VDcmVhdGVkQ2FsbGJhY2tcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gaW5zdGFuY2UgfHwgbnVsbDtcclxuICAgIH07XHJcbiAgICBQcm92aWRlci5wcm90b3R5cGUubm9ybWFsaXplSW5zdGFuY2VJZGVudGlmaWVyID0gZnVuY3Rpb24gKGlkZW50aWZpZXIpIHtcclxuICAgICAgICBpZiAoaWRlbnRpZmllciA9PT0gdm9pZCAwKSB7IGlkZW50aWZpZXIgPSBERUZBVUxUX0VOVFJZX05BTUU7IH1cclxuICAgICAgICBpZiAodGhpcy5jb21wb25lbnQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29tcG9uZW50Lm11bHRpcGxlSW5zdGFuY2VzID8gaWRlbnRpZmllciA6IERFRkFVTFRfRU5UUllfTkFNRTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBpZGVudGlmaWVyOyAvLyBhc3N1bWUgbXVsdGlwbGUgaW5zdGFuY2VzIGFyZSBzdXBwb3J0ZWQgYmVmb3JlIHRoZSBjb21wb25lbnQgaXMgcHJvdmlkZWQuXHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFByb3ZpZGVyLnByb3RvdHlwZS5zaG91bGRBdXRvSW5pdGlhbGl6ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gKCEhdGhpcy5jb21wb25lbnQgJiZcclxuICAgICAgICAgICAgdGhpcy5jb21wb25lbnQuaW5zdGFudGlhdGlvbk1vZGUgIT09IFwiRVhQTElDSVRcIiAvKiBFWFBMSUNJVCAqLyk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFByb3ZpZGVyO1xyXG59KCkpO1xyXG4vLyB1bmRlZmluZWQgc2hvdWxkIGJlIHBhc3NlZCB0byB0aGUgc2VydmljZSBmYWN0b3J5IGZvciB0aGUgZGVmYXVsdCBpbnN0YW5jZVxyXG5mdW5jdGlvbiBub3JtYWxpemVJZGVudGlmaWVyRm9yRmFjdG9yeShpZGVudGlmaWVyKSB7XHJcbiAgICByZXR1cm4gaWRlbnRpZmllciA9PT0gREVGQVVMVF9FTlRSWV9OQU1FID8gdW5kZWZpbmVkIDogaWRlbnRpZmllcjtcclxufVxyXG5mdW5jdGlvbiBpc0NvbXBvbmVudEVhZ2VyKGNvbXBvbmVudCkge1xyXG4gICAgcmV0dXJuIGNvbXBvbmVudC5pbnN0YW50aWF0aW9uTW9kZSA9PT0gXCJFQUdFUlwiIC8qIEVBR0VSICovO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBDb21wb25lbnRDb250YWluZXIgdGhhdCBwcm92aWRlcyBQcm92aWRlcnMgZm9yIHNlcnZpY2UgbmFtZSBULCBlLmcuIGBhdXRoYCwgYGF1dGgtaW50ZXJuYWxgXHJcbiAqL1xyXG52YXIgQ29tcG9uZW50Q29udGFpbmVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQ29tcG9uZW50Q29udGFpbmVyKG5hbWUpIHtcclxuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMucHJvdmlkZXJzID0gbmV3IE1hcCgpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGNvbXBvbmVudCBDb21wb25lbnQgYmVpbmcgYWRkZWRcclxuICAgICAqIEBwYXJhbSBvdmVyd3JpdGUgV2hlbiBhIGNvbXBvbmVudCB3aXRoIHRoZSBzYW1lIG5hbWUgaGFzIGFscmVhZHkgYmVlbiByZWdpc3RlcmVkLFxyXG4gICAgICogaWYgb3ZlcndyaXRlIGlzIHRydWU6IG92ZXJ3cml0ZSB0aGUgZXhpc3RpbmcgY29tcG9uZW50IHdpdGggdGhlIG5ldyBjb21wb25lbnQgYW5kIGNyZWF0ZSBhIG5ld1xyXG4gICAgICogcHJvdmlkZXIgd2l0aCB0aGUgbmV3IGNvbXBvbmVudC4gSXQgY2FuIGJlIHVzZWZ1bCBpbiB0ZXN0cyB3aGVyZSB5b3Ugd2FudCB0byB1c2UgZGlmZmVyZW50IG1vY2tzXHJcbiAgICAgKiBmb3IgZGlmZmVyZW50IHRlc3RzLlxyXG4gICAgICogaWYgb3ZlcndyaXRlIGlzIGZhbHNlOiB0aHJvdyBhbiBleGNlcHRpb25cclxuICAgICAqL1xyXG4gICAgQ29tcG9uZW50Q29udGFpbmVyLnByb3RvdHlwZS5hZGRDb21wb25lbnQgPSBmdW5jdGlvbiAoY29tcG9uZW50KSB7XHJcbiAgICAgICAgdmFyIHByb3ZpZGVyID0gdGhpcy5nZXRQcm92aWRlcihjb21wb25lbnQubmFtZSk7XHJcbiAgICAgICAgaWYgKHByb3ZpZGVyLmlzQ29tcG9uZW50U2V0KCkpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ29tcG9uZW50IFwiICsgY29tcG9uZW50Lm5hbWUgKyBcIiBoYXMgYWxyZWFkeSBiZWVuIHJlZ2lzdGVyZWQgd2l0aCBcIiArIHRoaXMubmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHByb3ZpZGVyLnNldENvbXBvbmVudChjb21wb25lbnQpO1xyXG4gICAgfTtcclxuICAgIENvbXBvbmVudENvbnRhaW5lci5wcm90b3R5cGUuYWRkT3JPdmVyd3JpdGVDb21wb25lbnQgPSBmdW5jdGlvbiAoY29tcG9uZW50KSB7XHJcbiAgICAgICAgdmFyIHByb3ZpZGVyID0gdGhpcy5nZXRQcm92aWRlcihjb21wb25lbnQubmFtZSk7XHJcbiAgICAgICAgaWYgKHByb3ZpZGVyLmlzQ29tcG9uZW50U2V0KCkpIHtcclxuICAgICAgICAgICAgLy8gZGVsZXRlIHRoZSBleGlzdGluZyBwcm92aWRlciBmcm9tIHRoZSBjb250YWluZXIsIHNvIHdlIGNhbiByZWdpc3RlciB0aGUgbmV3IGNvbXBvbmVudFxyXG4gICAgICAgICAgICB0aGlzLnByb3ZpZGVycy5kZWxldGUoY29tcG9uZW50Lm5hbWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmFkZENvbXBvbmVudChjb21wb25lbnQpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogZ2V0UHJvdmlkZXIgcHJvdmlkZXMgYSB0eXBlIHNhZmUgaW50ZXJmYWNlIHdoZXJlIGl0IGNhbiBvbmx5IGJlIGNhbGxlZCB3aXRoIGEgZmllbGQgbmFtZVxyXG4gICAgICogcHJlc2VudCBpbiBOYW1lU2VydmljZU1hcHBpbmcgaW50ZXJmYWNlLlxyXG4gICAgICpcclxuICAgICAqIEZpcmViYXNlIFNES3MgcHJvdmlkaW5nIHNlcnZpY2VzIHNob3VsZCBleHRlbmQgTmFtZVNlcnZpY2VNYXBwaW5nIGludGVyZmFjZSB0byByZWdpc3RlclxyXG4gICAgICogdGhlbXNlbHZlcy5cclxuICAgICAqL1xyXG4gICAgQ29tcG9uZW50Q29udGFpbmVyLnByb3RvdHlwZS5nZXRQcm92aWRlciA9IGZ1bmN0aW9uIChuYW1lKSB7XHJcbiAgICAgICAgaWYgKHRoaXMucHJvdmlkZXJzLmhhcyhuYW1lKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm92aWRlcnMuZ2V0KG5hbWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBjcmVhdGUgYSBQcm92aWRlciBmb3IgYSBzZXJ2aWNlIHRoYXQgaGFzbid0IHJlZ2lzdGVyZWQgd2l0aCBGaXJlYmFzZVxyXG4gICAgICAgIHZhciBwcm92aWRlciA9IG5ldyBQcm92aWRlcihuYW1lLCB0aGlzKTtcclxuICAgICAgICB0aGlzLnByb3ZpZGVycy5zZXQobmFtZSwgcHJvdmlkZXIpO1xyXG4gICAgICAgIHJldHVybiBwcm92aWRlcjtcclxuICAgIH07XHJcbiAgICBDb21wb25lbnRDb250YWluZXIucHJvdG90eXBlLmdldFByb3ZpZGVycyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLnByb3ZpZGVycy52YWx1ZXMoKSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIENvbXBvbmVudENvbnRhaW5lcjtcclxufSgpKTtcblxuZXhwb3J0IHsgQ29tcG9uZW50LCBDb21wb25lbnRDb250YWluZXIsIFByb3ZpZGVyIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5lc20uanMubWFwXG4iLCJpbXBvcnQgeyBFcnJvckZhY3RvcnksIGRlZXBFcXVhbCwgaXNCcm93c2VyRXh0ZW5zaW9uLCBpc01vYmlsZUNvcmRvdmEsIGlzUmVhY3ROYXRpdmUsIEZpcmViYXNlRXJyb3IsIHF1ZXJ5c3RyaW5nLCBnZXRNb2R1bGFySW5zdGFuY2UsIGJhc2U2NERlY29kZSwgZ2V0VUEsIGlzSUUsIGNyZWF0ZVN1YnNjcmliZSwgcXVlcnlzdHJpbmdEZWNvZGUsIGV4dHJhY3RRdWVyeXN0cmluZywgaXNFbXB0eSB9IGZyb20gJ0BmaXJlYmFzZS91dGlsJztcbmltcG9ydCB7IFNES19WRVJTSU9OLCBfZ2V0UHJvdmlkZXIsIF9yZWdpc3RlckNvbXBvbmVudCwgcmVnaXN0ZXJWZXJzaW9uLCBnZXRBcHAgfSBmcm9tICdAZmlyZWJhc2UvYXBwJztcbmltcG9ydCB7IF9fcmVzdCB9IGZyb20gJ3RzbGliJztcbmltcG9ydCB7IExvZ2dlciwgTG9nTGV2ZWwgfSBmcm9tICdAZmlyZWJhc2UvbG9nZ2VyJztcbmltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gJ0BmaXJlYmFzZS9jb21wb25lbnQnO1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjEgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogQW4gZW51bSBvZiBmYWN0b3JzIHRoYXQgbWF5IGJlIHVzZWQgZm9yIG11bHRpZmFjdG9yIGF1dGhlbnRpY2F0aW9uLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5jb25zdCBGYWN0b3JJZCA9IHtcclxuICAgIC8qKiBQaG9uZSBhcyBzZWNvbmQgZmFjdG9yICovXHJcbiAgICBQSE9ORTogJ3Bob25lJ1xyXG59O1xyXG4vKipcclxuICogRW51bWVyYXRpb24gb2Ygc3VwcG9ydGVkIHByb3ZpZGVycy5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuY29uc3QgUHJvdmlkZXJJZCA9IHtcclxuICAgIC8qKiBGYWNlYm9vayBwcm92aWRlciBJRCAqL1xyXG4gICAgRkFDRUJPT0s6ICdmYWNlYm9vay5jb20nLFxyXG4gICAgLyoqIEdpdEh1YiBwcm92aWRlciBJRCAqL1xyXG4gICAgR0lUSFVCOiAnZ2l0aHViLmNvbScsXHJcbiAgICAvKiogR29vZ2xlIHByb3ZpZGVyIElEICovXHJcbiAgICBHT09HTEU6ICdnb29nbGUuY29tJyxcclxuICAgIC8qKiBQYXNzd29yZCBwcm92aWRlciAqL1xyXG4gICAgUEFTU1dPUkQ6ICdwYXNzd29yZCcsXHJcbiAgICAvKiogUGhvbmUgcHJvdmlkZXIgKi9cclxuICAgIFBIT05FOiAncGhvbmUnLFxyXG4gICAgLyoqIFR3aXR0ZXIgcHJvdmlkZXIgSUQgKi9cclxuICAgIFRXSVRURVI6ICd0d2l0dGVyLmNvbSdcclxufTtcclxuLyoqXHJcbiAqIEVudW1lcmF0aW9uIG9mIHN1cHBvcnRlZCBzaWduLWluIG1ldGhvZHMuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmNvbnN0IFNpZ25Jbk1ldGhvZCA9IHtcclxuICAgIC8qKiBFbWFpbCBsaW5rIHNpZ24gaW4gbWV0aG9kICovXHJcbiAgICBFTUFJTF9MSU5LOiAnZW1haWxMaW5rJyxcclxuICAgIC8qKiBFbWFpbC9wYXNzd29yZCBzaWduIGluIG1ldGhvZCAqL1xyXG4gICAgRU1BSUxfUEFTU1dPUkQ6ICdwYXNzd29yZCcsXHJcbiAgICAvKiogRmFjZWJvb2sgc2lnbiBpbiBtZXRob2QgKi9cclxuICAgIEZBQ0VCT09LOiAnZmFjZWJvb2suY29tJyxcclxuICAgIC8qKiBHaXRIdWIgc2lnbiBpbiBtZXRob2QgKi9cclxuICAgIEdJVEhVQjogJ2dpdGh1Yi5jb20nLFxyXG4gICAgLyoqIEdvb2dsZSBzaWduIGluIG1ldGhvZCAqL1xyXG4gICAgR09PR0xFOiAnZ29vZ2xlLmNvbScsXHJcbiAgICAvKiogUGhvbmUgc2lnbiBpbiBtZXRob2QgKi9cclxuICAgIFBIT05FOiAncGhvbmUnLFxyXG4gICAgLyoqIFR3aXR0ZXIgc2lnbiBpbiBtZXRob2QgKi9cclxuICAgIFRXSVRURVI6ICd0d2l0dGVyLmNvbSdcclxufTtcclxuLyoqXHJcbiAqIEVudW1lcmF0aW9uIG9mIHN1cHBvcnRlZCBvcGVyYXRpb24gdHlwZXMuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmNvbnN0IE9wZXJhdGlvblR5cGUgPSB7XHJcbiAgICAvKiogT3BlcmF0aW9uIGludm9sdmluZyBsaW5raW5nIGFuIGFkZGl0aW9uYWwgcHJvdmlkZXIgdG8gYW4gYWxyZWFkeSBzaWduZWQtaW4gdXNlci4gKi9cclxuICAgIExJTks6ICdsaW5rJyxcclxuICAgIC8qKiBPcGVyYXRpb24gaW52b2x2aW5nIHVzaW5nIGEgcHJvdmlkZXIgdG8gcmVhdXRoZW50aWNhdGUgYW4gYWxyZWFkeSBzaWduZWQtaW4gdXNlci4gKi9cclxuICAgIFJFQVVUSEVOVElDQVRFOiAncmVhdXRoZW50aWNhdGUnLFxyXG4gICAgLyoqIE9wZXJhdGlvbiBpbnZvbHZpbmcgc2lnbmluZyBpbiBhIHVzZXIuICovXHJcbiAgICBTSUdOX0lOOiAnc2lnbkluJ1xyXG59O1xyXG4vKipcclxuICogQW4gZW51bWVyYXRpb24gb2YgdGhlIHBvc3NpYmxlIGVtYWlsIGFjdGlvbiB0eXBlcy5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuY29uc3QgQWN0aW9uQ29kZU9wZXJhdGlvbiA9IHtcclxuICAgIC8qKiBUaGUgZW1haWwgbGluayBzaWduLWluIGFjdGlvbi4gKi9cclxuICAgIEVNQUlMX1NJR05JTjogJ0VNQUlMX1NJR05JTicsXHJcbiAgICAvKiogVGhlIHBhc3N3b3JkIHJlc2V0IGFjdGlvbi4gKi9cclxuICAgIFBBU1NXT1JEX1JFU0VUOiAnUEFTU1dPUkRfUkVTRVQnLFxyXG4gICAgLyoqIFRoZSBlbWFpbCByZXZvY2F0aW9uIGFjdGlvbi4gKi9cclxuICAgIFJFQ09WRVJfRU1BSUw6ICdSRUNPVkVSX0VNQUlMJyxcclxuICAgIC8qKiBUaGUgcmV2ZXJ0IHNlY29uZCBmYWN0b3IgYWRkaXRpb24gZW1haWwgYWN0aW9uLiAqL1xyXG4gICAgUkVWRVJUX1NFQ09ORF9GQUNUT1JfQURESVRJT046ICdSRVZFUlRfU0VDT05EX0ZBQ1RPUl9BRERJVElPTicsXHJcbiAgICAvKiogVGhlIHJldmVydCBzZWNvbmQgZmFjdG9yIGFkZGl0aW9uIGVtYWlsIGFjdGlvbi4gKi9cclxuICAgIFZFUklGWV9BTkRfQ0hBTkdFX0VNQUlMOiAnVkVSSUZZX0FORF9DSEFOR0VfRU1BSUwnLFxyXG4gICAgLyoqIFRoZSBlbWFpbCB2ZXJpZmljYXRpb24gYWN0aW9uLiAqL1xyXG4gICAgVkVSSUZZX0VNQUlMOiAnVkVSSUZZX0VNQUlMJ1xyXG59O1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5mdW5jdGlvbiBfZGVidWdFcnJvck1hcCgpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgW1wiYWRtaW4tcmVzdHJpY3RlZC1vcGVyYXRpb25cIiAvKiBBRE1JTl9PTkxZX09QRVJBVElPTiAqL106ICdUaGlzIG9wZXJhdGlvbiBpcyByZXN0cmljdGVkIHRvIGFkbWluaXN0cmF0b3JzIG9ubHkuJyxcclxuICAgICAgICBbXCJhcmd1bWVudC1lcnJvclwiIC8qIEFSR1VNRU5UX0VSUk9SICovXTogJycsXHJcbiAgICAgICAgW1wiYXBwLW5vdC1hdXRob3JpemVkXCIgLyogQVBQX05PVF9BVVRIT1JJWkVEICovXTogXCJUaGlzIGFwcCwgaWRlbnRpZmllZCBieSB0aGUgZG9tYWluIHdoZXJlIGl0J3MgaG9zdGVkLCBpcyBub3QgXCIgK1xyXG4gICAgICAgICAgICAnYXV0aG9yaXplZCB0byB1c2UgRmlyZWJhc2UgQXV0aGVudGljYXRpb24gd2l0aCB0aGUgcHJvdmlkZWQgQVBJIGtleS4gJyArXHJcbiAgICAgICAgICAgICdSZXZpZXcgeW91ciBrZXkgY29uZmlndXJhdGlvbiBpbiB0aGUgR29vZ2xlIEFQSSBjb25zb2xlLicsXHJcbiAgICAgICAgW1wiYXBwLW5vdC1pbnN0YWxsZWRcIiAvKiBBUFBfTk9UX0lOU1RBTExFRCAqL106ICdUaGUgcmVxdWVzdGVkIG1vYmlsZSBhcHBsaWNhdGlvbiBjb3JyZXNwb25kaW5nIHRvIHRoZSBpZGVudGlmaWVyICgnICtcclxuICAgICAgICAgICAgJ0FuZHJvaWQgcGFja2FnZSBuYW1lIG9yIGlPUyBidW5kbGUgSUQpIHByb3ZpZGVkIGlzIG5vdCBpbnN0YWxsZWQgb24gJyArXHJcbiAgICAgICAgICAgICd0aGlzIGRldmljZS4nLFxyXG4gICAgICAgIFtcImNhcHRjaGEtY2hlY2stZmFpbGVkXCIgLyogQ0FQVENIQV9DSEVDS19GQUlMRUQgKi9dOiAnVGhlIHJlQ0FQVENIQSByZXNwb25zZSB0b2tlbiBwcm92aWRlZCBpcyBlaXRoZXIgaW52YWxpZCwgZXhwaXJlZCwgJyArXHJcbiAgICAgICAgICAgICdhbHJlYWR5IHVzZWQgb3IgdGhlIGRvbWFpbiBhc3NvY2lhdGVkIHdpdGggaXQgZG9lcyBub3QgbWF0Y2ggdGhlIGxpc3QgJyArXHJcbiAgICAgICAgICAgICdvZiB3aGl0ZWxpc3RlZCBkb21haW5zLicsXHJcbiAgICAgICAgW1wiY29kZS1leHBpcmVkXCIgLyogQ09ERV9FWFBJUkVEICovXTogJ1RoZSBTTVMgY29kZSBoYXMgZXhwaXJlZC4gUGxlYXNlIHJlLXNlbmQgdGhlIHZlcmlmaWNhdGlvbiBjb2RlIHRvIHRyeSAnICtcclxuICAgICAgICAgICAgJ2FnYWluLicsXHJcbiAgICAgICAgW1wiY29yZG92YS1ub3QtcmVhZHlcIiAvKiBDT1JET1ZBX05PVF9SRUFEWSAqL106ICdDb3Jkb3ZhIGZyYW1ld29yayBpcyBub3QgcmVhZHkuJyxcclxuICAgICAgICBbXCJjb3JzLXVuc3VwcG9ydGVkXCIgLyogQ09SU19VTlNVUFBPUlRFRCAqL106ICdUaGlzIGJyb3dzZXIgaXMgbm90IHN1cHBvcnRlZC4nLFxyXG4gICAgICAgIFtcImNyZWRlbnRpYWwtYWxyZWFkeS1pbi11c2VcIiAvKiBDUkVERU5USUFMX0FMUkVBRFlfSU5fVVNFICovXTogJ1RoaXMgY3JlZGVudGlhbCBpcyBhbHJlYWR5IGFzc29jaWF0ZWQgd2l0aCBhIGRpZmZlcmVudCB1c2VyIGFjY291bnQuJyxcclxuICAgICAgICBbXCJjdXN0b20tdG9rZW4tbWlzbWF0Y2hcIiAvKiBDUkVERU5USUFMX01JU01BVENIICovXTogJ1RoZSBjdXN0b20gdG9rZW4gY29ycmVzcG9uZHMgdG8gYSBkaWZmZXJlbnQgYXVkaWVuY2UuJyxcclxuICAgICAgICBbXCJyZXF1aXJlcy1yZWNlbnQtbG9naW5cIiAvKiBDUkVERU5USUFMX1RPT19PTERfTE9HSU5fQUdBSU4gKi9dOiAnVGhpcyBvcGVyYXRpb24gaXMgc2Vuc2l0aXZlIGFuZCByZXF1aXJlcyByZWNlbnQgYXV0aGVudGljYXRpb24uIExvZyBpbiAnICtcclxuICAgICAgICAgICAgJ2FnYWluIGJlZm9yZSByZXRyeWluZyB0aGlzIHJlcXVlc3QuJyxcclxuICAgICAgICBbXCJkZXBlbmRlbnQtc2RrLWluaXRpYWxpemVkLWJlZm9yZS1hdXRoXCIgLyogREVQRU5ERU5UX1NES19JTklUX0JFRk9SRV9BVVRIICovXTogJ0Fub3RoZXIgRmlyZWJhc2UgU0RLIHdhcyBpbml0aWFsaXplZCBhbmQgaXMgdHJ5aW5nIHRvIHVzZSBBdXRoIGJlZm9yZSBBdXRoIGlzICcgK1xyXG4gICAgICAgICAgICAnaW5pdGlhbGl6ZWQuIFBsZWFzZSBiZSBzdXJlIHRvIGNhbGwgYGluaXRpYWxpemVBdXRoYCBvciBgZ2V0QXV0aGAgYmVmb3JlICcgK1xyXG4gICAgICAgICAgICAnc3RhcnRpbmcgYW55IG90aGVyIEZpcmViYXNlIFNESy4nLFxyXG4gICAgICAgIFtcImR5bmFtaWMtbGluay1ub3QtYWN0aXZhdGVkXCIgLyogRFlOQU1JQ19MSU5LX05PVF9BQ1RJVkFURUQgKi9dOiAnUGxlYXNlIGFjdGl2YXRlIER5bmFtaWMgTGlua3MgaW4gdGhlIEZpcmViYXNlIENvbnNvbGUgYW5kIGFncmVlIHRvIHRoZSB0ZXJtcyBhbmQgJyArXHJcbiAgICAgICAgICAgICdjb25kaXRpb25zLicsXHJcbiAgICAgICAgW1wiZW1haWwtY2hhbmdlLW5lZWRzLXZlcmlmaWNhdGlvblwiIC8qIEVNQUlMX0NIQU5HRV9ORUVEU19WRVJJRklDQVRJT04gKi9dOiAnTXVsdGktZmFjdG9yIHVzZXJzIG11c3QgYWx3YXlzIGhhdmUgYSB2ZXJpZmllZCBlbWFpbC4nLFxyXG4gICAgICAgIFtcImVtYWlsLWFscmVhZHktaW4tdXNlXCIgLyogRU1BSUxfRVhJU1RTICovXTogJ1RoZSBlbWFpbCBhZGRyZXNzIGlzIGFscmVhZHkgaW4gdXNlIGJ5IGFub3RoZXIgYWNjb3VudC4nLFxyXG4gICAgICAgIFtcImVtdWxhdG9yLWNvbmZpZy1mYWlsZWRcIiAvKiBFTVVMQVRPUl9DT05GSUdfRkFJTEVEICovXTogJ0F1dGggaW5zdGFuY2UgaGFzIGFscmVhZHkgYmVlbiB1c2VkIHRvIG1ha2UgYSBuZXR3b3JrIGNhbGwuIEF1dGggY2FuICcgK1xyXG4gICAgICAgICAgICAnbm8gbG9uZ2VyIGJlIGNvbmZpZ3VyZWQgdG8gdXNlIHRoZSBlbXVsYXRvci4gVHJ5IGNhbGxpbmcgJyArXHJcbiAgICAgICAgICAgICdcImNvbm5lY3RBdXRoRW11bGF0b3IoKVwiIHNvb25lci4nLFxyXG4gICAgICAgIFtcImV4cGlyZWQtYWN0aW9uLWNvZGVcIiAvKiBFWFBJUkVEX09PQl9DT0RFICovXTogJ1RoZSBhY3Rpb24gY29kZSBoYXMgZXhwaXJlZC4nLFxyXG4gICAgICAgIFtcImNhbmNlbGxlZC1wb3B1cC1yZXF1ZXN0XCIgLyogRVhQSVJFRF9QT1BVUF9SRVFVRVNUICovXTogJ1RoaXMgb3BlcmF0aW9uIGhhcyBiZWVuIGNhbmNlbGxlZCBkdWUgdG8gYW5vdGhlciBjb25mbGljdGluZyBwb3B1cCBiZWluZyBvcGVuZWQuJyxcclxuICAgICAgICBbXCJpbnRlcm5hbC1lcnJvclwiIC8qIElOVEVSTkFMX0VSUk9SICovXTogJ0FuIGludGVybmFsIEF1dGhFcnJvciBoYXMgb2NjdXJyZWQuJyxcclxuICAgICAgICBbXCJpbnZhbGlkLWFwcC1jcmVkZW50aWFsXCIgLyogSU5WQUxJRF9BUFBfQ1JFREVOVElBTCAqL106ICdUaGUgcGhvbmUgdmVyaWZpY2F0aW9uIHJlcXVlc3QgY29udGFpbnMgYW4gaW52YWxpZCBhcHBsaWNhdGlvbiB2ZXJpZmllci4nICtcclxuICAgICAgICAgICAgJyBUaGUgcmVDQVBUQ0hBIHRva2VuIHJlc3BvbnNlIGlzIGVpdGhlciBpbnZhbGlkIG9yIGV4cGlyZWQuJyxcclxuICAgICAgICBbXCJpbnZhbGlkLWFwcC1pZFwiIC8qIElOVkFMSURfQVBQX0lEICovXTogJ1RoZSBtb2JpbGUgYXBwIGlkZW50aWZpZXIgaXMgbm90IHJlZ2lzdGVkIGZvciB0aGUgY3VycmVudCBwcm9qZWN0LicsXHJcbiAgICAgICAgW1wiaW52YWxpZC11c2VyLXRva2VuXCIgLyogSU5WQUxJRF9BVVRIICovXTogXCJUaGlzIHVzZXIncyBjcmVkZW50aWFsIGlzbid0IHZhbGlkIGZvciB0aGlzIHByb2plY3QuIFRoaXMgY2FuIGhhcHBlbiBcIiArXHJcbiAgICAgICAgICAgIFwiaWYgdGhlIHVzZXIncyB0b2tlbiBoYXMgYmVlbiB0YW1wZXJlZCB3aXRoLCBvciBpZiB0aGUgdXNlciBpc24ndCBmb3IgXCIgK1xyXG4gICAgICAgICAgICAndGhlIHByb2plY3QgYXNzb2NpYXRlZCB3aXRoIHRoaXMgQVBJIGtleS4nLFxyXG4gICAgICAgIFtcImludmFsaWQtYXV0aC1ldmVudFwiIC8qIElOVkFMSURfQVVUSF9FVkVOVCAqL106ICdBbiBpbnRlcm5hbCBBdXRoRXJyb3IgaGFzIG9jY3VycmVkLicsXHJcbiAgICAgICAgW1wiaW52YWxpZC12ZXJpZmljYXRpb24tY29kZVwiIC8qIElOVkFMSURfQ09ERSAqL106ICdUaGUgU01TIHZlcmlmaWNhdGlvbiBjb2RlIHVzZWQgdG8gY3JlYXRlIHRoZSBwaG9uZSBhdXRoIGNyZWRlbnRpYWwgaXMgJyArXHJcbiAgICAgICAgICAgICdpbnZhbGlkLiBQbGVhc2UgcmVzZW5kIHRoZSB2ZXJpZmljYXRpb24gY29kZSBzbXMgYW5kIGJlIHN1cmUgdG8gdXNlIHRoZSAnICtcclxuICAgICAgICAgICAgJ3ZlcmlmaWNhdGlvbiBjb2RlIHByb3ZpZGVkIGJ5IHRoZSB1c2VyLicsXHJcbiAgICAgICAgW1wiaW52YWxpZC1jb250aW51ZS11cmlcIiAvKiBJTlZBTElEX0NPTlRJTlVFX1VSSSAqL106ICdUaGUgY29udGludWUgVVJMIHByb3ZpZGVkIGluIHRoZSByZXF1ZXN0IGlzIGludmFsaWQuJyxcclxuICAgICAgICBbXCJpbnZhbGlkLWNvcmRvdmEtY29uZmlndXJhdGlvblwiIC8qIElOVkFMSURfQ09SRE9WQV9DT05GSUdVUkFUSU9OICovXTogJ1RoZSBmb2xsb3dpbmcgQ29yZG92YSBwbHVnaW5zIG11c3QgYmUgaW5zdGFsbGVkIHRvIGVuYWJsZSBPQXV0aCBzaWduLWluOiAnICtcclxuICAgICAgICAgICAgJ2NvcmRvdmEtcGx1Z2luLWJ1aWxkaW5mbywgY29yZG92YS11bml2ZXJzYWwtbGlua3MtcGx1Z2luLCAnICtcclxuICAgICAgICAgICAgJ2NvcmRvdmEtcGx1Z2luLWJyb3dzZXJ0YWIsIGNvcmRvdmEtcGx1Z2luLWluYXBwYnJvd3NlciBhbmQgJyArXHJcbiAgICAgICAgICAgICdjb3Jkb3ZhLXBsdWdpbi1jdXN0b211cmxzY2hlbWUuJyxcclxuICAgICAgICBbXCJpbnZhbGlkLWN1c3RvbS10b2tlblwiIC8qIElOVkFMSURfQ1VTVE9NX1RPS0VOICovXTogJ1RoZSBjdXN0b20gdG9rZW4gZm9ybWF0IGlzIGluY29ycmVjdC4gUGxlYXNlIGNoZWNrIHRoZSBkb2N1bWVudGF0aW9uLicsXHJcbiAgICAgICAgW1wiaW52YWxpZC1keW5hbWljLWxpbmstZG9tYWluXCIgLyogSU5WQUxJRF9EWU5BTUlDX0xJTktfRE9NQUlOICovXTogJ1RoZSBwcm92aWRlZCBkeW5hbWljIGxpbmsgZG9tYWluIGlzIG5vdCBjb25maWd1cmVkIG9yIGF1dGhvcml6ZWQgZm9yIHRoZSBjdXJyZW50IHByb2plY3QuJyxcclxuICAgICAgICBbXCJpbnZhbGlkLWVtYWlsXCIgLyogSU5WQUxJRF9FTUFJTCAqL106ICdUaGUgZW1haWwgYWRkcmVzcyBpcyBiYWRseSBmb3JtYXR0ZWQuJyxcclxuICAgICAgICBbXCJpbnZhbGlkLWVtdWxhdG9yLXNjaGVtZVwiIC8qIElOVkFMSURfRU1VTEFUT1JfU0NIRU1FICovXTogJ0VtdWxhdG9yIFVSTCBtdXN0IHN0YXJ0IHdpdGggYSB2YWxpZCBzY2hlbWUgKGh0dHA6Ly8gb3IgaHR0cHM6Ly8pLicsXHJcbiAgICAgICAgW1wiaW52YWxpZC1hcGkta2V5XCIgLyogSU5WQUxJRF9BUElfS0VZICovXTogJ1lvdXIgQVBJIGtleSBpcyBpbnZhbGlkLCBwbGVhc2UgY2hlY2sgeW91IGhhdmUgY29waWVkIGl0IGNvcnJlY3RseS4nLFxyXG4gICAgICAgIFtcImludmFsaWQtY2VydC1oYXNoXCIgLyogSU5WQUxJRF9DRVJUX0hBU0ggKi9dOiAnVGhlIFNIQS0xIGNlcnRpZmljYXRlIGhhc2ggcHJvdmlkZWQgaXMgaW52YWxpZC4nLFxyXG4gICAgICAgIFtcImludmFsaWQtY3JlZGVudGlhbFwiIC8qIElOVkFMSURfSURQX1JFU1BPTlNFICovXTogJ1RoZSBzdXBwbGllZCBhdXRoIGNyZWRlbnRpYWwgaXMgbWFsZm9ybWVkIG9yIGhhcyBleHBpcmVkLicsXHJcbiAgICAgICAgW1wiaW52YWxpZC1tZXNzYWdlLXBheWxvYWRcIiAvKiBJTlZBTElEX01FU1NBR0VfUEFZTE9BRCAqL106ICdUaGUgZW1haWwgdGVtcGxhdGUgY29ycmVzcG9uZGluZyB0byB0aGlzIGFjdGlvbiBjb250YWlucyBpbnZhbGlkIGNoYXJhY3RlcnMgaW4gaXRzIG1lc3NhZ2UuICcgK1xyXG4gICAgICAgICAgICAnUGxlYXNlIGZpeCBieSBnb2luZyB0byB0aGUgQXV0aCBlbWFpbCB0ZW1wbGF0ZXMgc2VjdGlvbiBpbiB0aGUgRmlyZWJhc2UgQ29uc29sZS4nLFxyXG4gICAgICAgIFtcImludmFsaWQtbXVsdGktZmFjdG9yLXNlc3Npb25cIiAvKiBJTlZBTElEX01GQV9TRVNTSU9OICovXTogJ1RoZSByZXF1ZXN0IGRvZXMgbm90IGNvbnRhaW4gYSB2YWxpZCBwcm9vZiBvZiBmaXJzdCBmYWN0b3Igc3VjY2Vzc2Z1bCBzaWduLWluLicsXHJcbiAgICAgICAgW1wiaW52YWxpZC1vYXV0aC1wcm92aWRlclwiIC8qIElOVkFMSURfT0FVVEhfUFJPVklERVIgKi9dOiAnRW1haWxBdXRoUHJvdmlkZXIgaXMgbm90IHN1cHBvcnRlZCBmb3IgdGhpcyBvcGVyYXRpb24uIFRoaXMgb3BlcmF0aW9uICcgK1xyXG4gICAgICAgICAgICAnb25seSBzdXBwb3J0cyBPQXV0aCBwcm92aWRlcnMuJyxcclxuICAgICAgICBbXCJpbnZhbGlkLW9hdXRoLWNsaWVudC1pZFwiIC8qIElOVkFMSURfT0FVVEhfQ0xJRU5UX0lEICovXTogJ1RoZSBPQXV0aCBjbGllbnQgSUQgcHJvdmlkZWQgaXMgZWl0aGVyIGludmFsaWQgb3IgZG9lcyBub3QgbWF0Y2ggdGhlICcgK1xyXG4gICAgICAgICAgICAnc3BlY2lmaWVkIEFQSSBrZXkuJyxcclxuICAgICAgICBbXCJ1bmF1dGhvcml6ZWQtZG9tYWluXCIgLyogSU5WQUxJRF9PUklHSU4gKi9dOiAnVGhpcyBkb21haW4gaXMgbm90IGF1dGhvcml6ZWQgZm9yIE9BdXRoIG9wZXJhdGlvbnMgZm9yIHlvdXIgRmlyZWJhc2UgJyArXHJcbiAgICAgICAgICAgICdwcm9qZWN0LiBFZGl0IHRoZSBsaXN0IG9mIGF1dGhvcml6ZWQgZG9tYWlucyBmcm9tIHRoZSBGaXJlYmFzZSBjb25zb2xlLicsXHJcbiAgICAgICAgW1wiaW52YWxpZC1hY3Rpb24tY29kZVwiIC8qIElOVkFMSURfT09CX0NPREUgKi9dOiAnVGhlIGFjdGlvbiBjb2RlIGlzIGludmFsaWQuIFRoaXMgY2FuIGhhcHBlbiBpZiB0aGUgY29kZSBpcyBtYWxmb3JtZWQsICcgK1xyXG4gICAgICAgICAgICAnZXhwaXJlZCwgb3IgaGFzIGFscmVhZHkgYmVlbiB1c2VkLicsXHJcbiAgICAgICAgW1wid3JvbmctcGFzc3dvcmRcIiAvKiBJTlZBTElEX1BBU1NXT1JEICovXTogJ1RoZSBwYXNzd29yZCBpcyBpbnZhbGlkIG9yIHRoZSB1c2VyIGRvZXMgbm90IGhhdmUgYSBwYXNzd29yZC4nLFxyXG4gICAgICAgIFtcImludmFsaWQtcGVyc2lzdGVuY2UtdHlwZVwiIC8qIElOVkFMSURfUEVSU0lTVEVOQ0UgKi9dOiAnVGhlIHNwZWNpZmllZCBwZXJzaXN0ZW5jZSB0eXBlIGlzIGludmFsaWQuIEl0IGNhbiBvbmx5IGJlIGxvY2FsLCBzZXNzaW9uIG9yIG5vbmUuJyxcclxuICAgICAgICBbXCJpbnZhbGlkLXBob25lLW51bWJlclwiIC8qIElOVkFMSURfUEhPTkVfTlVNQkVSICovXTogJ1RoZSBmb3JtYXQgb2YgdGhlIHBob25lIG51bWJlciBwcm92aWRlZCBpcyBpbmNvcnJlY3QuIFBsZWFzZSBlbnRlciB0aGUgJyArXHJcbiAgICAgICAgICAgICdwaG9uZSBudW1iZXIgaW4gYSBmb3JtYXQgdGhhdCBjYW4gYmUgcGFyc2VkIGludG8gRS4xNjQgZm9ybWF0LiBFLjE2NCAnICtcclxuICAgICAgICAgICAgJ3Bob25lIG51bWJlcnMgYXJlIHdyaXR0ZW4gaW4gdGhlIGZvcm1hdCBbK11bY291bnRyeSBjb2RlXVtzdWJzY3JpYmVyICcgK1xyXG4gICAgICAgICAgICAnbnVtYmVyIGluY2x1ZGluZyBhcmVhIGNvZGVdLicsXHJcbiAgICAgICAgW1wiaW52YWxpZC1wcm92aWRlci1pZFwiIC8qIElOVkFMSURfUFJPVklERVJfSUQgKi9dOiAnVGhlIHNwZWNpZmllZCBwcm92aWRlciBJRCBpcyBpbnZhbGlkLicsXHJcbiAgICAgICAgW1wiaW52YWxpZC1yZWNpcGllbnQtZW1haWxcIiAvKiBJTlZBTElEX1JFQ0lQSUVOVF9FTUFJTCAqL106ICdUaGUgZW1haWwgY29ycmVzcG9uZGluZyB0byB0aGlzIGFjdGlvbiBmYWlsZWQgdG8gc2VuZCBhcyB0aGUgcHJvdmlkZWQgJyArXHJcbiAgICAgICAgICAgICdyZWNpcGllbnQgZW1haWwgYWRkcmVzcyBpcyBpbnZhbGlkLicsXHJcbiAgICAgICAgW1wiaW52YWxpZC1zZW5kZXJcIiAvKiBJTlZBTElEX1NFTkRFUiAqL106ICdUaGUgZW1haWwgdGVtcGxhdGUgY29ycmVzcG9uZGluZyB0byB0aGlzIGFjdGlvbiBjb250YWlucyBhbiBpbnZhbGlkIHNlbmRlciBlbWFpbCBvciBuYW1lLiAnICtcclxuICAgICAgICAgICAgJ1BsZWFzZSBmaXggYnkgZ29pbmcgdG8gdGhlIEF1dGggZW1haWwgdGVtcGxhdGVzIHNlY3Rpb24gaW4gdGhlIEZpcmViYXNlIENvbnNvbGUuJyxcclxuICAgICAgICBbXCJpbnZhbGlkLXZlcmlmaWNhdGlvbi1pZFwiIC8qIElOVkFMSURfU0VTU0lPTl9JTkZPICovXTogJ1RoZSB2ZXJpZmljYXRpb24gSUQgdXNlZCB0byBjcmVhdGUgdGhlIHBob25lIGF1dGggY3JlZGVudGlhbCBpcyBpbnZhbGlkLicsXHJcbiAgICAgICAgW1wiaW52YWxpZC10ZW5hbnQtaWRcIiAvKiBJTlZBTElEX1RFTkFOVF9JRCAqL106IFwiVGhlIEF1dGggaW5zdGFuY2UncyB0ZW5hbnQgSUQgaXMgaW52YWxpZC5cIixcclxuICAgICAgICBbXCJtaXNzaW5nLWFuZHJvaWQtcGtnLW5hbWVcIiAvKiBNSVNTSU5HX0FORFJPSURfUEFDS0FHRV9OQU1FICovXTogJ0FuIEFuZHJvaWQgUGFja2FnZSBOYW1lIG11c3QgYmUgcHJvdmlkZWQgaWYgdGhlIEFuZHJvaWQgQXBwIGlzIHJlcXVpcmVkIHRvIGJlIGluc3RhbGxlZC4nLFxyXG4gICAgICAgIFtcImF1dGgtZG9tYWluLWNvbmZpZy1yZXF1aXJlZFwiIC8qIE1JU1NJTkdfQVVUSF9ET01BSU4gKi9dOiAnQmUgc3VyZSB0byBpbmNsdWRlIGF1dGhEb21haW4gd2hlbiBjYWxsaW5nIGZpcmViYXNlLmluaXRpYWxpemVBcHAoKSwgJyArXHJcbiAgICAgICAgICAgICdieSBmb2xsb3dpbmcgdGhlIGluc3RydWN0aW9ucyBpbiB0aGUgRmlyZWJhc2UgY29uc29sZS4nLFxyXG4gICAgICAgIFtcIm1pc3NpbmctYXBwLWNyZWRlbnRpYWxcIiAvKiBNSVNTSU5HX0FQUF9DUkVERU5USUFMICovXTogJ1RoZSBwaG9uZSB2ZXJpZmljYXRpb24gcmVxdWVzdCBpcyBtaXNzaW5nIGFuIGFwcGxpY2F0aW9uIHZlcmlmaWVyICcgK1xyXG4gICAgICAgICAgICAnYXNzZXJ0aW9uLiBBIHJlQ0FQVENIQSByZXNwb25zZSB0b2tlbiBuZWVkcyB0byBiZSBwcm92aWRlZC4nLFxyXG4gICAgICAgIFtcIm1pc3NpbmctdmVyaWZpY2F0aW9uLWNvZGVcIiAvKiBNSVNTSU5HX0NPREUgKi9dOiAnVGhlIHBob25lIGF1dGggY3JlZGVudGlhbCB3YXMgY3JlYXRlZCB3aXRoIGFuIGVtcHR5IFNNUyB2ZXJpZmljYXRpb24gY29kZS4nLFxyXG4gICAgICAgIFtcIm1pc3NpbmctY29udGludWUtdXJpXCIgLyogTUlTU0lOR19DT05USU5VRV9VUkkgKi9dOiAnQSBjb250aW51ZSBVUkwgbXVzdCBiZSBwcm92aWRlZCBpbiB0aGUgcmVxdWVzdC4nLFxyXG4gICAgICAgIFtcIm1pc3NpbmctaWZyYW1lLXN0YXJ0XCIgLyogTUlTU0lOR19JRlJBTUVfU1RBUlQgKi9dOiAnQW4gaW50ZXJuYWwgQXV0aEVycm9yIGhhcyBvY2N1cnJlZC4nLFxyXG4gICAgICAgIFtcIm1pc3NpbmctaW9zLWJ1bmRsZS1pZFwiIC8qIE1JU1NJTkdfSU9TX0JVTkRMRV9JRCAqL106ICdBbiBpT1MgQnVuZGxlIElEIG11c3QgYmUgcHJvdmlkZWQgaWYgYW4gQXBwIFN0b3JlIElEIGlzIHByb3ZpZGVkLicsXHJcbiAgICAgICAgW1wibWlzc2luZy1vci1pbnZhbGlkLW5vbmNlXCIgLyogTUlTU0lOR19PUl9JTlZBTElEX05PTkNFICovXTogJ1RoZSByZXF1ZXN0IGRvZXMgbm90IGNvbnRhaW4gYSB2YWxpZCBub25jZS4gVGhpcyBjYW4gb2NjdXIgaWYgdGhlICcgK1xyXG4gICAgICAgICAgICAnU0hBLTI1NiBoYXNoIG9mIHRoZSBwcm92aWRlZCByYXcgbm9uY2UgZG9lcyBub3QgbWF0Y2ggdGhlIGhhc2hlZCBub25jZSAnICtcclxuICAgICAgICAgICAgJ2luIHRoZSBJRCB0b2tlbiBwYXlsb2FkLicsXHJcbiAgICAgICAgW1wibWlzc2luZy1tdWx0aS1mYWN0b3ItaW5mb1wiIC8qIE1JU1NJTkdfTUZBX0lORk8gKi9dOiAnTm8gc2Vjb25kIGZhY3RvciBpZGVudGlmaWVyIGlzIHByb3ZpZGVkLicsXHJcbiAgICAgICAgW1wibWlzc2luZy1tdWx0aS1mYWN0b3Itc2Vzc2lvblwiIC8qIE1JU1NJTkdfTUZBX1NFU1NJT04gKi9dOiAnVGhlIHJlcXVlc3QgaXMgbWlzc2luZyBwcm9vZiBvZiBmaXJzdCBmYWN0b3Igc3VjY2Vzc2Z1bCBzaWduLWluLicsXHJcbiAgICAgICAgW1wibWlzc2luZy1waG9uZS1udW1iZXJcIiAvKiBNSVNTSU5HX1BIT05FX05VTUJFUiAqL106ICdUbyBzZW5kIHZlcmlmaWNhdGlvbiBjb2RlcywgcHJvdmlkZSBhIHBob25lIG51bWJlciBmb3IgdGhlIHJlY2lwaWVudC4nLFxyXG4gICAgICAgIFtcIm1pc3NpbmctdmVyaWZpY2F0aW9uLWlkXCIgLyogTUlTU0lOR19TRVNTSU9OX0lORk8gKi9dOiAnVGhlIHBob25lIGF1dGggY3JlZGVudGlhbCB3YXMgY3JlYXRlZCB3aXRoIGFuIGVtcHR5IHZlcmlmaWNhdGlvbiBJRC4nLFxyXG4gICAgICAgIFtcImFwcC1kZWxldGVkXCIgLyogTU9EVUxFX0RFU1RST1lFRCAqL106ICdUaGlzIGluc3RhbmNlIG9mIEZpcmViYXNlQXBwIGhhcyBiZWVuIGRlbGV0ZWQuJyxcclxuICAgICAgICBbXCJtdWx0aS1mYWN0b3ItaW5mby1ub3QtZm91bmRcIiAvKiBNRkFfSU5GT19OT1RfRk9VTkQgKi9dOiAnVGhlIHVzZXIgZG9lcyBub3QgaGF2ZSBhIHNlY29uZCBmYWN0b3IgbWF0Y2hpbmcgdGhlIGlkZW50aWZpZXIgcHJvdmlkZWQuJyxcclxuICAgICAgICBbXCJtdWx0aS1mYWN0b3ItYXV0aC1yZXF1aXJlZFwiIC8qIE1GQV9SRVFVSVJFRCAqL106ICdQcm9vZiBvZiBvd25lcnNoaXAgb2YgYSBzZWNvbmQgZmFjdG9yIGlzIHJlcXVpcmVkIHRvIGNvbXBsZXRlIHNpZ24taW4uJyxcclxuICAgICAgICBbXCJhY2NvdW50LWV4aXN0cy13aXRoLWRpZmZlcmVudC1jcmVkZW50aWFsXCIgLyogTkVFRF9DT05GSVJNQVRJT04gKi9dOiAnQW4gYWNjb3VudCBhbHJlYWR5IGV4aXN0cyB3aXRoIHRoZSBzYW1lIGVtYWlsIGFkZHJlc3MgYnV0IGRpZmZlcmVudCAnICtcclxuICAgICAgICAgICAgJ3NpZ24taW4gY3JlZGVudGlhbHMuIFNpZ24gaW4gdXNpbmcgYSBwcm92aWRlciBhc3NvY2lhdGVkIHdpdGggdGhpcyAnICtcclxuICAgICAgICAgICAgJ2VtYWlsIGFkZHJlc3MuJyxcclxuICAgICAgICBbXCJuZXR3b3JrLXJlcXVlc3QtZmFpbGVkXCIgLyogTkVUV09SS19SRVFVRVNUX0ZBSUxFRCAqL106ICdBIG5ldHdvcmsgQXV0aEVycm9yIChzdWNoIGFzIHRpbWVvdXQsIGludGVycnVwdGVkIGNvbm5lY3Rpb24gb3IgdW5yZWFjaGFibGUgaG9zdCkgaGFzIG9jY3VycmVkLicsXHJcbiAgICAgICAgW1wibm8tYXV0aC1ldmVudFwiIC8qIE5PX0FVVEhfRVZFTlQgKi9dOiAnQW4gaW50ZXJuYWwgQXV0aEVycm9yIGhhcyBvY2N1cnJlZC4nLFxyXG4gICAgICAgIFtcIm5vLXN1Y2gtcHJvdmlkZXJcIiAvKiBOT19TVUNIX1BST1ZJREVSICovXTogJ1VzZXIgd2FzIG5vdCBsaW5rZWQgdG8gYW4gYWNjb3VudCB3aXRoIHRoZSBnaXZlbiBwcm92aWRlci4nLFxyXG4gICAgICAgIFtcIm51bGwtdXNlclwiIC8qIE5VTExfVVNFUiAqL106ICdBIG51bGwgdXNlciBvYmplY3Qgd2FzIHByb3ZpZGVkIGFzIHRoZSBhcmd1bWVudCBmb3IgYW4gb3BlcmF0aW9uIHdoaWNoICcgK1xyXG4gICAgICAgICAgICAncmVxdWlyZXMgYSBub24tbnVsbCB1c2VyIG9iamVjdC4nLFxyXG4gICAgICAgIFtcIm9wZXJhdGlvbi1ub3QtYWxsb3dlZFwiIC8qIE9QRVJBVElPTl9OT1RfQUxMT1dFRCAqL106ICdUaGUgZ2l2ZW4gc2lnbi1pbiBwcm92aWRlciBpcyBkaXNhYmxlZCBmb3IgdGhpcyBGaXJlYmFzZSBwcm9qZWN0LiAnICtcclxuICAgICAgICAgICAgJ0VuYWJsZSBpdCBpbiB0aGUgRmlyZWJhc2UgY29uc29sZSwgdW5kZXIgdGhlIHNpZ24taW4gbWV0aG9kIHRhYiBvZiB0aGUgJyArXHJcbiAgICAgICAgICAgICdBdXRoIHNlY3Rpb24uJyxcclxuICAgICAgICBbXCJvcGVyYXRpb24tbm90LXN1cHBvcnRlZC1pbi10aGlzLWVudmlyb25tZW50XCIgLyogT1BFUkFUSU9OX05PVF9TVVBQT1JURUQgKi9dOiAnVGhpcyBvcGVyYXRpb24gaXMgbm90IHN1cHBvcnRlZCBpbiB0aGUgZW52aXJvbm1lbnQgdGhpcyBhcHBsaWNhdGlvbiBpcyAnICtcclxuICAgICAgICAgICAgJ3J1bm5pbmcgb24uIFwibG9jYXRpb24ucHJvdG9jb2xcIiBtdXN0IGJlIGh0dHAsIGh0dHBzIG9yIGNocm9tZS1leHRlbnNpb24nICtcclxuICAgICAgICAgICAgJyBhbmQgd2ViIHN0b3JhZ2UgbXVzdCBiZSBlbmFibGVkLicsXHJcbiAgICAgICAgW1wicG9wdXAtYmxvY2tlZFwiIC8qIFBPUFVQX0JMT0NLRUQgKi9dOiAnVW5hYmxlIHRvIGVzdGFibGlzaCBhIGNvbm5lY3Rpb24gd2l0aCB0aGUgcG9wdXAuIEl0IG1heSBoYXZlIGJlZW4gYmxvY2tlZCBieSB0aGUgYnJvd3Nlci4nLFxyXG4gICAgICAgIFtcInBvcHVwLWNsb3NlZC1ieS11c2VyXCIgLyogUE9QVVBfQ0xPU0VEX0JZX1VTRVIgKi9dOiAnVGhlIHBvcHVwIGhhcyBiZWVuIGNsb3NlZCBieSB0aGUgdXNlciBiZWZvcmUgZmluYWxpemluZyB0aGUgb3BlcmF0aW9uLicsXHJcbiAgICAgICAgW1wicHJvdmlkZXItYWxyZWFkeS1saW5rZWRcIiAvKiBQUk9WSURFUl9BTFJFQURZX0xJTktFRCAqL106ICdVc2VyIGNhbiBvbmx5IGJlIGxpbmtlZCB0byBvbmUgaWRlbnRpdHkgZm9yIHRoZSBnaXZlbiBwcm92aWRlci4nLFxyXG4gICAgICAgIFtcInF1b3RhLWV4Y2VlZGVkXCIgLyogUVVPVEFfRVhDRUVERUQgKi9dOiBcIlRoZSBwcm9qZWN0J3MgcXVvdGEgZm9yIHRoaXMgb3BlcmF0aW9uIGhhcyBiZWVuIGV4Y2VlZGVkLlwiLFxyXG4gICAgICAgIFtcInJlZGlyZWN0LWNhbmNlbGxlZC1ieS11c2VyXCIgLyogUkVESVJFQ1RfQ0FOQ0VMTEVEX0JZX1VTRVIgKi9dOiAnVGhlIHJlZGlyZWN0IG9wZXJhdGlvbiBoYXMgYmVlbiBjYW5jZWxsZWQgYnkgdGhlIHVzZXIgYmVmb3JlIGZpbmFsaXppbmcuJyxcclxuICAgICAgICBbXCJyZWRpcmVjdC1vcGVyYXRpb24tcGVuZGluZ1wiIC8qIFJFRElSRUNUX09QRVJBVElPTl9QRU5ESU5HICovXTogJ0EgcmVkaXJlY3Qgc2lnbi1pbiBvcGVyYXRpb24gaXMgYWxyZWFkeSBwZW5kaW5nLicsXHJcbiAgICAgICAgW1wicmVqZWN0ZWQtY3JlZGVudGlhbFwiIC8qIFJFSkVDVEVEX0NSRURFTlRJQUwgKi9dOiAnVGhlIHJlcXVlc3QgY29udGFpbnMgbWFsZm9ybWVkIG9yIG1pc21hdGNoaW5nIGNyZWRlbnRpYWxzLicsXHJcbiAgICAgICAgW1wic2Vjb25kLWZhY3Rvci1hbHJlYWR5LWluLXVzZVwiIC8qIFNFQ09ORF9GQUNUT1JfQUxSRUFEWV9FTlJPTExFRCAqL106ICdUaGUgc2Vjb25kIGZhY3RvciBpcyBhbHJlYWR5IGVucm9sbGVkIG9uIHRoaXMgYWNjb3VudC4nLFxyXG4gICAgICAgIFtcIm1heGltdW0tc2Vjb25kLWZhY3Rvci1jb3VudC1leGNlZWRlZFwiIC8qIFNFQ09ORF9GQUNUT1JfTElNSVRfRVhDRUVERUQgKi9dOiAnVGhlIG1heGltdW0gYWxsb3dlZCBudW1iZXIgb2Ygc2Vjb25kIGZhY3RvcnMgb24gYSB1c2VyIGhhcyBiZWVuIGV4Y2VlZGVkLicsXHJcbiAgICAgICAgW1widGVuYW50LWlkLW1pc21hdGNoXCIgLyogVEVOQU5UX0lEX01JU01BVENIICovXTogXCJUaGUgcHJvdmlkZWQgdGVuYW50IElEIGRvZXMgbm90IG1hdGNoIHRoZSBBdXRoIGluc3RhbmNlJ3MgdGVuYW50IElEXCIsXHJcbiAgICAgICAgW1widGltZW91dFwiIC8qIFRJTUVPVVQgKi9dOiAnVGhlIG9wZXJhdGlvbiBoYXMgdGltZWQgb3V0LicsXHJcbiAgICAgICAgW1widXNlci10b2tlbi1leHBpcmVkXCIgLyogVE9LRU5fRVhQSVJFRCAqL106IFwiVGhlIHVzZXIncyBjcmVkZW50aWFsIGlzIG5vIGxvbmdlciB2YWxpZC4gVGhlIHVzZXIgbXVzdCBzaWduIGluIGFnYWluLlwiLFxyXG4gICAgICAgIFtcInRvby1tYW55LXJlcXVlc3RzXCIgLyogVE9PX01BTllfQVRURU1QVFNfVFJZX0xBVEVSICovXTogJ1dlIGhhdmUgYmxvY2tlZCBhbGwgcmVxdWVzdHMgZnJvbSB0aGlzIGRldmljZSBkdWUgdG8gdW51c3VhbCBhY3Rpdml0eS4gJyArXHJcbiAgICAgICAgICAgICdUcnkgYWdhaW4gbGF0ZXIuJyxcclxuICAgICAgICBbXCJ1bmF1dGhvcml6ZWQtY29udGludWUtdXJpXCIgLyogVU5BVVRIT1JJWkVEX0RPTUFJTiAqL106ICdUaGUgZG9tYWluIG9mIHRoZSBjb250aW51ZSBVUkwgaXMgbm90IHdoaXRlbGlzdGVkLiAgUGxlYXNlIHdoaXRlbGlzdCAnICtcclxuICAgICAgICAgICAgJ3RoZSBkb21haW4gaW4gdGhlIEZpcmViYXNlIGNvbnNvbGUuJyxcclxuICAgICAgICBbXCJ1bnN1cHBvcnRlZC1maXJzdC1mYWN0b3JcIiAvKiBVTlNVUFBPUlRFRF9GSVJTVF9GQUNUT1IgKi9dOiAnRW5yb2xsaW5nIGEgc2Vjb25kIGZhY3RvciBvciBzaWduaW5nIGluIHdpdGggYSBtdWx0aS1mYWN0b3IgYWNjb3VudCByZXF1aXJlcyBzaWduLWluIHdpdGggYSBzdXBwb3J0ZWQgZmlyc3QgZmFjdG9yLicsXHJcbiAgICAgICAgW1widW5zdXBwb3J0ZWQtcGVyc2lzdGVuY2UtdHlwZVwiIC8qIFVOU1VQUE9SVEVEX1BFUlNJU1RFTkNFICovXTogJ1RoZSBjdXJyZW50IGVudmlyb25tZW50IGRvZXMgbm90IHN1cHBvcnQgdGhlIHNwZWNpZmllZCBwZXJzaXN0ZW5jZSB0eXBlLicsXHJcbiAgICAgICAgW1widW5zdXBwb3J0ZWQtdGVuYW50LW9wZXJhdGlvblwiIC8qIFVOU1VQUE9SVEVEX1RFTkFOVF9PUEVSQVRJT04gKi9dOiAnVGhpcyBvcGVyYXRpb24gaXMgbm90IHN1cHBvcnRlZCBpbiBhIG11bHRpLXRlbmFudCBjb250ZXh0LicsXHJcbiAgICAgICAgW1widW52ZXJpZmllZC1lbWFpbFwiIC8qIFVOVkVSSUZJRURfRU1BSUwgKi9dOiAnVGhlIG9wZXJhdGlvbiByZXF1aXJlcyBhIHZlcmlmaWVkIGVtYWlsLicsXHJcbiAgICAgICAgW1widXNlci1jYW5jZWxsZWRcIiAvKiBVU0VSX0NBTkNFTExFRCAqL106ICdUaGUgdXNlciBkaWQgbm90IGdyYW50IHlvdXIgYXBwbGljYXRpb24gdGhlIHBlcm1pc3Npb25zIGl0IHJlcXVlc3RlZC4nLFxyXG4gICAgICAgIFtcInVzZXItbm90LWZvdW5kXCIgLyogVVNFUl9ERUxFVEVEICovXTogJ1RoZXJlIGlzIG5vIHVzZXIgcmVjb3JkIGNvcnJlc3BvbmRpbmcgdG8gdGhpcyBpZGVudGlmaWVyLiBUaGUgdXNlciBtYXkgJyArXHJcbiAgICAgICAgICAgICdoYXZlIGJlZW4gZGVsZXRlZC4nLFxyXG4gICAgICAgIFtcInVzZXItZGlzYWJsZWRcIiAvKiBVU0VSX0RJU0FCTEVEICovXTogJ1RoZSB1c2VyIGFjY291bnQgaGFzIGJlZW4gZGlzYWJsZWQgYnkgYW4gYWRtaW5pc3RyYXRvci4nLFxyXG4gICAgICAgIFtcInVzZXItbWlzbWF0Y2hcIiAvKiBVU0VSX01JU01BVENIICovXTogJ1RoZSBzdXBwbGllZCBjcmVkZW50aWFscyBkbyBub3QgY29ycmVzcG9uZCB0byB0aGUgcHJldmlvdXNseSBzaWduZWQgaW4gdXNlci4nLFxyXG4gICAgICAgIFtcInVzZXItc2lnbmVkLW91dFwiIC8qIFVTRVJfU0lHTkVEX09VVCAqL106ICcnLFxyXG4gICAgICAgIFtcIndlYWstcGFzc3dvcmRcIiAvKiBXRUFLX1BBU1NXT1JEICovXTogJ1RoZSBwYXNzd29yZCBtdXN0IGJlIDYgY2hhcmFjdGVycyBsb25nIG9yIG1vcmUuJyxcclxuICAgICAgICBbXCJ3ZWItc3RvcmFnZS11bnN1cHBvcnRlZFwiIC8qIFdFQl9TVE9SQUdFX1VOU1VQUE9SVEVEICovXTogJ1RoaXMgYnJvd3NlciBpcyBub3Qgc3VwcG9ydGVkIG9yIDNyZCBwYXJ0eSBjb29raWVzIGFuZCBkYXRhIG1heSBiZSBkaXNhYmxlZC4nLFxyXG4gICAgICAgIFtcImFscmVhZHktaW5pdGlhbGl6ZWRcIiAvKiBBTFJFQURZX0lOSVRJQUxJWkVEICovXTogJ2luaXRpYWxpemVBdXRoKCkgaGFzIGFscmVhZHkgYmVlbiBjYWxsZWQgd2l0aCAnICtcclxuICAgICAgICAgICAgJ2RpZmZlcmVudCBvcHRpb25zLiBUbyBhdm9pZCB0aGlzIGVycm9yLCBjYWxsIGluaXRpYWxpemVBdXRoKCkgd2l0aCB0aGUgJyArXHJcbiAgICAgICAgICAgICdzYW1lIG9wdGlvbnMgYXMgd2hlbiBpdCB3YXMgb3JpZ2luYWxseSBjYWxsZWQsIG9yIGNhbGwgZ2V0QXV0aCgpIHRvIHJldHVybiB0aGUnICtcclxuICAgICAgICAgICAgJyBhbHJlYWR5IGluaXRpYWxpemVkIGluc3RhbmNlLidcclxuICAgIH07XHJcbn1cclxuZnVuY3Rpb24gX3Byb2RFcnJvck1hcCgpIHtcclxuICAgIC8vIFdlIHdpbGwgaW5jbHVkZSB0aGlzIG9uZSBtZXNzYWdlIGluIHRoZSBwcm9kIGVycm9yIG1hcCBzaW5jZSBieSB0aGUgdmVyeVxyXG4gICAgLy8gbmF0dXJlIG9mIHRoaXMgZXJyb3IsIGRldmVsb3BlcnMgd2lsbCBuZXZlciBiZSBhYmxlIHRvIHNlZSB0aGUgbWVzc2FnZVxyXG4gICAgLy8gdXNpbmcgdGhlIGRlYnVnRXJyb3JNYXAgKHdoaWNoIGlzIGluc3RhbGxlZCBkdXJpbmcgYXV0aCBpbml0aWFsaXphdGlvbikuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIFtcImRlcGVuZGVudC1zZGstaW5pdGlhbGl6ZWQtYmVmb3JlLWF1dGhcIiAvKiBERVBFTkRFTlRfU0RLX0lOSVRfQkVGT1JFX0FVVEggKi9dOiAnQW5vdGhlciBGaXJlYmFzZSBTREsgd2FzIGluaXRpYWxpemVkIGFuZCBpcyB0cnlpbmcgdG8gdXNlIEF1dGggYmVmb3JlIEF1dGggaXMgJyArXHJcbiAgICAgICAgICAgICdpbml0aWFsaXplZC4gUGxlYXNlIGJlIHN1cmUgdG8gY2FsbCBgaW5pdGlhbGl6ZUF1dGhgIG9yIGBnZXRBdXRoYCBiZWZvcmUgJyArXHJcbiAgICAgICAgICAgICdzdGFydGluZyBhbnkgb3RoZXIgRmlyZWJhc2UgU0RLLidcclxuICAgIH07XHJcbn1cclxuLyoqXHJcbiAqIEEgdmVyYm9zZSBlcnJvciBtYXAgd2l0aCBkZXRhaWxlZCBkZXNjcmlwdGlvbnMgZm9yIG1vc3QgZXJyb3IgY29kZXMuXHJcbiAqXHJcbiAqIFNlZSBkaXNjdXNzaW9uIGF0IHtAbGluayBBdXRoRXJyb3JNYXB9XHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmNvbnN0IGRlYnVnRXJyb3JNYXAgPSBfZGVidWdFcnJvck1hcDtcclxuLyoqXHJcbiAqIEEgbWluaW1hbCBlcnJvciBtYXAgd2l0aCBhbGwgdmVyYm9zZSBlcnJvciBtZXNzYWdlcyBzdHJpcHBlZC5cclxuICpcclxuICogU2VlIGRpc2N1c3Npb24gYXQge0BsaW5rIEF1dGhFcnJvck1hcH1cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuY29uc3QgcHJvZEVycm9yTWFwID0gX3Byb2RFcnJvck1hcDtcclxuY29uc3QgX0RFRkFVTFRfQVVUSF9FUlJPUl9GQUNUT1JZID0gbmV3IEVycm9yRmFjdG9yeSgnYXV0aCcsICdGaXJlYmFzZScsIF9wcm9kRXJyb3JNYXAoKSk7XHJcbi8qKlxyXG4gKiBBIG1hcCBvZiBwb3RlbnRpYWwgYEF1dGhgIGVycm9yIGNvZGVzLCBmb3IgZWFzaWVyIGNvbXBhcmlzb24gd2l0aCBlcnJvcnNcclxuICogdGhyb3duIGJ5IHRoZSBTREsuXHJcbiAqXHJcbiAqIEByZW1hcmtzXHJcbiAqIE5vdGUgdGhhdCB5b3UgY2FuJ3QgdHJlZS1zaGFrZSBpbmRpdmlkdWFsIGtleXNcclxuICogaW4gdGhlIG1hcCwgc28gYnkgdXNpbmcgdGhlIG1hcCB5b3UgbWlnaHQgc3Vic3RhbnRpYWxseSBpbmNyZWFzZSB5b3VyXHJcbiAqIGJ1bmRsZSBzaXplLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5jb25zdCBBVVRIX0VSUk9SX0NPREVTX01BUF9ET19OT1RfVVNFX0lOVEVSTkFMTFkgPSB7XHJcbiAgICBBRE1JTl9PTkxZX09QRVJBVElPTjogJ2F1dGgvYWRtaW4tcmVzdHJpY3RlZC1vcGVyYXRpb24nLFxyXG4gICAgQVJHVU1FTlRfRVJST1I6ICdhdXRoL2FyZ3VtZW50LWVycm9yJyxcclxuICAgIEFQUF9OT1RfQVVUSE9SSVpFRDogJ2F1dGgvYXBwLW5vdC1hdXRob3JpemVkJyxcclxuICAgIEFQUF9OT1RfSU5TVEFMTEVEOiAnYXV0aC9hcHAtbm90LWluc3RhbGxlZCcsXHJcbiAgICBDQVBUQ0hBX0NIRUNLX0ZBSUxFRDogJ2F1dGgvY2FwdGNoYS1jaGVjay1mYWlsZWQnLFxyXG4gICAgQ09ERV9FWFBJUkVEOiAnYXV0aC9jb2RlLWV4cGlyZWQnLFxyXG4gICAgQ09SRE9WQV9OT1RfUkVBRFk6ICdhdXRoL2NvcmRvdmEtbm90LXJlYWR5JyxcclxuICAgIENPUlNfVU5TVVBQT1JURUQ6ICdhdXRoL2NvcnMtdW5zdXBwb3J0ZWQnLFxyXG4gICAgQ1JFREVOVElBTF9BTFJFQURZX0lOX1VTRTogJ2F1dGgvY3JlZGVudGlhbC1hbHJlYWR5LWluLXVzZScsXHJcbiAgICBDUkVERU5USUFMX01JU01BVENIOiAnYXV0aC9jdXN0b20tdG9rZW4tbWlzbWF0Y2gnLFxyXG4gICAgQ1JFREVOVElBTF9UT09fT0xEX0xPR0lOX0FHQUlOOiAnYXV0aC9yZXF1aXJlcy1yZWNlbnQtbG9naW4nLFxyXG4gICAgREVQRU5ERU5UX1NES19JTklUX0JFRk9SRV9BVVRIOiAnYXV0aC9kZXBlbmRlbnQtc2RrLWluaXRpYWxpemVkLWJlZm9yZS1hdXRoJyxcclxuICAgIERZTkFNSUNfTElOS19OT1RfQUNUSVZBVEVEOiAnYXV0aC9keW5hbWljLWxpbmstbm90LWFjdGl2YXRlZCcsXHJcbiAgICBFTUFJTF9DSEFOR0VfTkVFRFNfVkVSSUZJQ0FUSU9OOiAnYXV0aC9lbWFpbC1jaGFuZ2UtbmVlZHMtdmVyaWZpY2F0aW9uJyxcclxuICAgIEVNQUlMX0VYSVNUUzogJ2F1dGgvZW1haWwtYWxyZWFkeS1pbi11c2UnLFxyXG4gICAgRU1VTEFUT1JfQ09ORklHX0ZBSUxFRDogJ2F1dGgvZW11bGF0b3ItY29uZmlnLWZhaWxlZCcsXHJcbiAgICBFWFBJUkVEX09PQl9DT0RFOiAnYXV0aC9leHBpcmVkLWFjdGlvbi1jb2RlJyxcclxuICAgIEVYUElSRURfUE9QVVBfUkVRVUVTVDogJ2F1dGgvY2FuY2VsbGVkLXBvcHVwLXJlcXVlc3QnLFxyXG4gICAgSU5URVJOQUxfRVJST1I6ICdhdXRoL2ludGVybmFsLWVycm9yJyxcclxuICAgIElOVkFMSURfQVBJX0tFWTogJ2F1dGgvaW52YWxpZC1hcGkta2V5JyxcclxuICAgIElOVkFMSURfQVBQX0NSRURFTlRJQUw6ICdhdXRoL2ludmFsaWQtYXBwLWNyZWRlbnRpYWwnLFxyXG4gICAgSU5WQUxJRF9BUFBfSUQ6ICdhdXRoL2ludmFsaWQtYXBwLWlkJyxcclxuICAgIElOVkFMSURfQVVUSDogJ2F1dGgvaW52YWxpZC11c2VyLXRva2VuJyxcclxuICAgIElOVkFMSURfQVVUSF9FVkVOVDogJ2F1dGgvaW52YWxpZC1hdXRoLWV2ZW50JyxcclxuICAgIElOVkFMSURfQ0VSVF9IQVNIOiAnYXV0aC9pbnZhbGlkLWNlcnQtaGFzaCcsXHJcbiAgICBJTlZBTElEX0NPREU6ICdhdXRoL2ludmFsaWQtdmVyaWZpY2F0aW9uLWNvZGUnLFxyXG4gICAgSU5WQUxJRF9DT05USU5VRV9VUkk6ICdhdXRoL2ludmFsaWQtY29udGludWUtdXJpJyxcclxuICAgIElOVkFMSURfQ09SRE9WQV9DT05GSUdVUkFUSU9OOiAnYXV0aC9pbnZhbGlkLWNvcmRvdmEtY29uZmlndXJhdGlvbicsXHJcbiAgICBJTlZBTElEX0NVU1RPTV9UT0tFTjogJ2F1dGgvaW52YWxpZC1jdXN0b20tdG9rZW4nLFxyXG4gICAgSU5WQUxJRF9EWU5BTUlDX0xJTktfRE9NQUlOOiAnYXV0aC9pbnZhbGlkLWR5bmFtaWMtbGluay1kb21haW4nLFxyXG4gICAgSU5WQUxJRF9FTUFJTDogJ2F1dGgvaW52YWxpZC1lbWFpbCcsXHJcbiAgICBJTlZBTElEX0VNVUxBVE9SX1NDSEVNRTogJ2F1dGgvaW52YWxpZC1lbXVsYXRvci1zY2hlbWUnLFxyXG4gICAgSU5WQUxJRF9JRFBfUkVTUE9OU0U6ICdhdXRoL2ludmFsaWQtY3JlZGVudGlhbCcsXHJcbiAgICBJTlZBTElEX01FU1NBR0VfUEFZTE9BRDogJ2F1dGgvaW52YWxpZC1tZXNzYWdlLXBheWxvYWQnLFxyXG4gICAgSU5WQUxJRF9NRkFfU0VTU0lPTjogJ2F1dGgvaW52YWxpZC1tdWx0aS1mYWN0b3Itc2Vzc2lvbicsXHJcbiAgICBJTlZBTElEX09BVVRIX0NMSUVOVF9JRDogJ2F1dGgvaW52YWxpZC1vYXV0aC1jbGllbnQtaWQnLFxyXG4gICAgSU5WQUxJRF9PQVVUSF9QUk9WSURFUjogJ2F1dGgvaW52YWxpZC1vYXV0aC1wcm92aWRlcicsXHJcbiAgICBJTlZBTElEX09PQl9DT0RFOiAnYXV0aC9pbnZhbGlkLWFjdGlvbi1jb2RlJyxcclxuICAgIElOVkFMSURfT1JJR0lOOiAnYXV0aC91bmF1dGhvcml6ZWQtZG9tYWluJyxcclxuICAgIElOVkFMSURfUEFTU1dPUkQ6ICdhdXRoL3dyb25nLXBhc3N3b3JkJyxcclxuICAgIElOVkFMSURfUEVSU0lTVEVOQ0U6ICdhdXRoL2ludmFsaWQtcGVyc2lzdGVuY2UtdHlwZScsXHJcbiAgICBJTlZBTElEX1BIT05FX05VTUJFUjogJ2F1dGgvaW52YWxpZC1waG9uZS1udW1iZXInLFxyXG4gICAgSU5WQUxJRF9QUk9WSURFUl9JRDogJ2F1dGgvaW52YWxpZC1wcm92aWRlci1pZCcsXHJcbiAgICBJTlZBTElEX1JFQ0lQSUVOVF9FTUFJTDogJ2F1dGgvaW52YWxpZC1yZWNpcGllbnQtZW1haWwnLFxyXG4gICAgSU5WQUxJRF9TRU5ERVI6ICdhdXRoL2ludmFsaWQtc2VuZGVyJyxcclxuICAgIElOVkFMSURfU0VTU0lPTl9JTkZPOiAnYXV0aC9pbnZhbGlkLXZlcmlmaWNhdGlvbi1pZCcsXHJcbiAgICBJTlZBTElEX1RFTkFOVF9JRDogJ2F1dGgvaW52YWxpZC10ZW5hbnQtaWQnLFxyXG4gICAgTUZBX0lORk9fTk9UX0ZPVU5EOiAnYXV0aC9tdWx0aS1mYWN0b3ItaW5mby1ub3QtZm91bmQnLFxyXG4gICAgTUZBX1JFUVVJUkVEOiAnYXV0aC9tdWx0aS1mYWN0b3ItYXV0aC1yZXF1aXJlZCcsXHJcbiAgICBNSVNTSU5HX0FORFJPSURfUEFDS0FHRV9OQU1FOiAnYXV0aC9taXNzaW5nLWFuZHJvaWQtcGtnLW5hbWUnLFxyXG4gICAgTUlTU0lOR19BUFBfQ1JFREVOVElBTDogJ2F1dGgvbWlzc2luZy1hcHAtY3JlZGVudGlhbCcsXHJcbiAgICBNSVNTSU5HX0FVVEhfRE9NQUlOOiAnYXV0aC9hdXRoLWRvbWFpbi1jb25maWctcmVxdWlyZWQnLFxyXG4gICAgTUlTU0lOR19DT0RFOiAnYXV0aC9taXNzaW5nLXZlcmlmaWNhdGlvbi1jb2RlJyxcclxuICAgIE1JU1NJTkdfQ09OVElOVUVfVVJJOiAnYXV0aC9taXNzaW5nLWNvbnRpbnVlLXVyaScsXHJcbiAgICBNSVNTSU5HX0lGUkFNRV9TVEFSVDogJ2F1dGgvbWlzc2luZy1pZnJhbWUtc3RhcnQnLFxyXG4gICAgTUlTU0lOR19JT1NfQlVORExFX0lEOiAnYXV0aC9taXNzaW5nLWlvcy1idW5kbGUtaWQnLFxyXG4gICAgTUlTU0lOR19PUl9JTlZBTElEX05PTkNFOiAnYXV0aC9taXNzaW5nLW9yLWludmFsaWQtbm9uY2UnLFxyXG4gICAgTUlTU0lOR19NRkFfSU5GTzogJ2F1dGgvbWlzc2luZy1tdWx0aS1mYWN0b3ItaW5mbycsXHJcbiAgICBNSVNTSU5HX01GQV9TRVNTSU9OOiAnYXV0aC9taXNzaW5nLW11bHRpLWZhY3Rvci1zZXNzaW9uJyxcclxuICAgIE1JU1NJTkdfUEhPTkVfTlVNQkVSOiAnYXV0aC9taXNzaW5nLXBob25lLW51bWJlcicsXHJcbiAgICBNSVNTSU5HX1NFU1NJT05fSU5GTzogJ2F1dGgvbWlzc2luZy12ZXJpZmljYXRpb24taWQnLFxyXG4gICAgTU9EVUxFX0RFU1RST1lFRDogJ2F1dGgvYXBwLWRlbGV0ZWQnLFxyXG4gICAgTkVFRF9DT05GSVJNQVRJT046ICdhdXRoL2FjY291bnQtZXhpc3RzLXdpdGgtZGlmZmVyZW50LWNyZWRlbnRpYWwnLFxyXG4gICAgTkVUV09SS19SRVFVRVNUX0ZBSUxFRDogJ2F1dGgvbmV0d29yay1yZXF1ZXN0LWZhaWxlZCcsXHJcbiAgICBOVUxMX1VTRVI6ICdhdXRoL251bGwtdXNlcicsXHJcbiAgICBOT19BVVRIX0VWRU5UOiAnYXV0aC9uby1hdXRoLWV2ZW50JyxcclxuICAgIE5PX1NVQ0hfUFJPVklERVI6ICdhdXRoL25vLXN1Y2gtcHJvdmlkZXInLFxyXG4gICAgT1BFUkFUSU9OX05PVF9BTExPV0VEOiAnYXV0aC9vcGVyYXRpb24tbm90LWFsbG93ZWQnLFxyXG4gICAgT1BFUkFUSU9OX05PVF9TVVBQT1JURUQ6ICdhdXRoL29wZXJhdGlvbi1ub3Qtc3VwcG9ydGVkLWluLXRoaXMtZW52aXJvbm1lbnQnLFxyXG4gICAgUE9QVVBfQkxPQ0tFRDogJ2F1dGgvcG9wdXAtYmxvY2tlZCcsXHJcbiAgICBQT1BVUF9DTE9TRURfQllfVVNFUjogJ2F1dGgvcG9wdXAtY2xvc2VkLWJ5LXVzZXInLFxyXG4gICAgUFJPVklERVJfQUxSRUFEWV9MSU5LRUQ6ICdhdXRoL3Byb3ZpZGVyLWFscmVhZHktbGlua2VkJyxcclxuICAgIFFVT1RBX0VYQ0VFREVEOiAnYXV0aC9xdW90YS1leGNlZWRlZCcsXHJcbiAgICBSRURJUkVDVF9DQU5DRUxMRURfQllfVVNFUjogJ2F1dGgvcmVkaXJlY3QtY2FuY2VsbGVkLWJ5LXVzZXInLFxyXG4gICAgUkVESVJFQ1RfT1BFUkFUSU9OX1BFTkRJTkc6ICdhdXRoL3JlZGlyZWN0LW9wZXJhdGlvbi1wZW5kaW5nJyxcclxuICAgIFJFSkVDVEVEX0NSRURFTlRJQUw6ICdhdXRoL3JlamVjdGVkLWNyZWRlbnRpYWwnLFxyXG4gICAgU0VDT05EX0ZBQ1RPUl9BTFJFQURZX0VOUk9MTEVEOiAnYXV0aC9zZWNvbmQtZmFjdG9yLWFscmVhZHktaW4tdXNlJyxcclxuICAgIFNFQ09ORF9GQUNUT1JfTElNSVRfRVhDRUVERUQ6ICdhdXRoL21heGltdW0tc2Vjb25kLWZhY3Rvci1jb3VudC1leGNlZWRlZCcsXHJcbiAgICBURU5BTlRfSURfTUlTTUFUQ0g6ICdhdXRoL3RlbmFudC1pZC1taXNtYXRjaCcsXHJcbiAgICBUSU1FT1VUOiAnYXV0aC90aW1lb3V0JyxcclxuICAgIFRPS0VOX0VYUElSRUQ6ICdhdXRoL3VzZXItdG9rZW4tZXhwaXJlZCcsXHJcbiAgICBUT09fTUFOWV9BVFRFTVBUU19UUllfTEFURVI6ICdhdXRoL3Rvby1tYW55LXJlcXVlc3RzJyxcclxuICAgIFVOQVVUSE9SSVpFRF9ET01BSU46ICdhdXRoL3VuYXV0aG9yaXplZC1jb250aW51ZS11cmknLFxyXG4gICAgVU5TVVBQT1JURURfRklSU1RfRkFDVE9SOiAnYXV0aC91bnN1cHBvcnRlZC1maXJzdC1mYWN0b3InLFxyXG4gICAgVU5TVVBQT1JURURfUEVSU0lTVEVOQ0U6ICdhdXRoL3Vuc3VwcG9ydGVkLXBlcnNpc3RlbmNlLXR5cGUnLFxyXG4gICAgVU5TVVBQT1JURURfVEVOQU5UX09QRVJBVElPTjogJ2F1dGgvdW5zdXBwb3J0ZWQtdGVuYW50LW9wZXJhdGlvbicsXHJcbiAgICBVTlZFUklGSUVEX0VNQUlMOiAnYXV0aC91bnZlcmlmaWVkLWVtYWlsJyxcclxuICAgIFVTRVJfQ0FOQ0VMTEVEOiAnYXV0aC91c2VyLWNhbmNlbGxlZCcsXHJcbiAgICBVU0VSX0RFTEVURUQ6ICdhdXRoL3VzZXItbm90LWZvdW5kJyxcclxuICAgIFVTRVJfRElTQUJMRUQ6ICdhdXRoL3VzZXItZGlzYWJsZWQnLFxyXG4gICAgVVNFUl9NSVNNQVRDSDogJ2F1dGgvdXNlci1taXNtYXRjaCcsXHJcbiAgICBVU0VSX1NJR05FRF9PVVQ6ICdhdXRoL3VzZXItc2lnbmVkLW91dCcsXHJcbiAgICBXRUFLX1BBU1NXT1JEOiAnYXV0aC93ZWFrLXBhc3N3b3JkJyxcclxuICAgIFdFQl9TVE9SQUdFX1VOU1VQUE9SVEVEOiAnYXV0aC93ZWItc3RvcmFnZS11bnN1cHBvcnRlZCcsXHJcbiAgICBBTFJFQURZX0lOSVRJQUxJWkVEOiAnYXV0aC9hbHJlYWR5LWluaXRpYWxpemVkJ1xyXG59O1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jb25zdCBsb2dDbGllbnQgPSBuZXcgTG9nZ2VyKCdAZmlyZWJhc2UvYXV0aCcpO1xyXG5mdW5jdGlvbiBfbG9nRXJyb3IobXNnLCAuLi5hcmdzKSB7XHJcbiAgICBpZiAobG9nQ2xpZW50LmxvZ0xldmVsIDw9IExvZ0xldmVsLkVSUk9SKSB7XHJcbiAgICAgICAgbG9nQ2xpZW50LmVycm9yKGBBdXRoICgke1NES19WRVJTSU9OfSk6ICR7bXNnfWAsIC4uLmFyZ3MpO1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmZ1bmN0aW9uIF9mYWlsKGF1dGhPckNvZGUsIC4uLnJlc3QpIHtcclxuICAgIHRocm93IGNyZWF0ZUVycm9ySW50ZXJuYWwoYXV0aE9yQ29kZSwgLi4ucmVzdCk7XHJcbn1cclxuZnVuY3Rpb24gX2NyZWF0ZUVycm9yKGF1dGhPckNvZGUsIC4uLnJlc3QpIHtcclxuICAgIHJldHVybiBjcmVhdGVFcnJvckludGVybmFsKGF1dGhPckNvZGUsIC4uLnJlc3QpO1xyXG59XHJcbmZ1bmN0aW9uIGNyZWF0ZUVycm9ySW50ZXJuYWwoYXV0aE9yQ29kZSwgLi4ucmVzdCkge1xyXG4gICAgaWYgKHR5cGVvZiBhdXRoT3JDb2RlICE9PSAnc3RyaW5nJykge1xyXG4gICAgICAgIGNvbnN0IGNvZGUgPSByZXN0WzBdO1xyXG4gICAgICAgIGNvbnN0IGZ1bGxQYXJhbXMgPSBbLi4ucmVzdC5zbGljZSgxKV07XHJcbiAgICAgICAgaWYgKGZ1bGxQYXJhbXNbMF0pIHtcclxuICAgICAgICAgICAgZnVsbFBhcmFtc1swXS5hcHBOYW1lID0gYXV0aE9yQ29kZS5uYW1lO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYXV0aE9yQ29kZS5fZXJyb3JGYWN0b3J5LmNyZWF0ZShjb2RlLCAuLi5mdWxsUGFyYW1zKTtcclxuICAgIH1cclxuICAgIHJldHVybiBfREVGQVVMVF9BVVRIX0VSUk9SX0ZBQ1RPUlkuY3JlYXRlKGF1dGhPckNvZGUsIC4uLnJlc3QpO1xyXG59XHJcbmZ1bmN0aW9uIF9hc3NlcnQoYXNzZXJ0aW9uLCBhdXRoT3JDb2RlLCAuLi5yZXN0KSB7XHJcbiAgICBpZiAoIWFzc2VydGlvbikge1xyXG4gICAgICAgIHRocm93IGNyZWF0ZUVycm9ySW50ZXJuYWwoYXV0aE9yQ29kZSwgLi4ucmVzdCk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIFVuY29uZGl0aW9uYWxseSBmYWlscywgdGhyb3dpbmcgYW4gaW50ZXJuYWwgZXJyb3Igd2l0aCB0aGUgZ2l2ZW4gbWVzc2FnZS5cclxuICpcclxuICogQHBhcmFtIGZhaWx1cmUgdHlwZSBvZiBmYWlsdXJlIGVuY291bnRlcmVkXHJcbiAqIEB0aHJvd3MgRXJyb3JcclxuICovXHJcbmZ1bmN0aW9uIGRlYnVnRmFpbChmYWlsdXJlKSB7XHJcbiAgICAvLyBMb2cgdGhlIGZhaWx1cmUgaW4gYWRkaXRpb24gdG8gdGhyb3cgYW4gZXhjZXB0aW9uLCBqdXN0IGluIGNhc2UgdGhlXHJcbiAgICAvLyBleGNlcHRpb24gaXMgc3dhbGxvd2VkLlxyXG4gICAgY29uc3QgbWVzc2FnZSA9IGBJTlRFUk5BTCBBU1NFUlRJT04gRkFJTEVEOiBgICsgZmFpbHVyZTtcclxuICAgIF9sb2dFcnJvcihtZXNzYWdlKTtcclxuICAgIC8vIE5PVEU6IFdlIGRvbid0IHVzZSBGaXJlYmFzZUVycm9yIGhlcmUgYmVjYXVzZSB0aGVzZSBhcmUgaW50ZXJuYWwgZmFpbHVyZXNcclxuICAgIC8vIHRoYXQgY2Fubm90IGJlIGhhbmRsZWQgYnkgdGhlIHVzZXIuIChBbHNvIGl0IHdvdWxkIGNyZWF0ZSBhIGNpcmN1bGFyXHJcbiAgICAvLyBkZXBlbmRlbmN5IGJldHdlZW4gdGhlIGVycm9yIGFuZCBhc3NlcnQgbW9kdWxlcyB3aGljaCBkb2Vzbid0IHdvcmsuKVxyXG4gICAgdGhyb3cgbmV3IEVycm9yKG1lc3NhZ2UpO1xyXG59XHJcbi8qKlxyXG4gKiBGYWlscyBpZiB0aGUgZ2l2ZW4gYXNzZXJ0aW9uIGNvbmRpdGlvbiBpcyBmYWxzZSwgdGhyb3dpbmcgYW4gRXJyb3Igd2l0aCB0aGVcclxuICogZ2l2ZW4gbWVzc2FnZSBpZiBpdCBkaWQuXHJcbiAqXHJcbiAqIEBwYXJhbSBhc3NlcnRpb25cclxuICogQHBhcmFtIG1lc3NhZ2VcclxuICovXHJcbmZ1bmN0aW9uIGRlYnVnQXNzZXJ0KGFzc2VydGlvbiwgbWVzc2FnZSkge1xyXG4gICAgaWYgKCFhc3NlcnRpb24pIHtcclxuICAgICAgICBkZWJ1Z0ZhaWwobWVzc2FnZSk7XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuY29uc3QgaW5zdGFuY2VDYWNoZSA9IG5ldyBNYXAoKTtcclxuZnVuY3Rpb24gX2dldEluc3RhbmNlKGNscykge1xyXG4gICAgZGVidWdBc3NlcnQoY2xzIGluc3RhbmNlb2YgRnVuY3Rpb24sICdFeHBlY3RlZCBhIGNsYXNzIGRlZmluaXRpb24nKTtcclxuICAgIGxldCBpbnN0YW5jZSA9IGluc3RhbmNlQ2FjaGUuZ2V0KGNscyk7XHJcbiAgICBpZiAoaW5zdGFuY2UpIHtcclxuICAgICAgICBkZWJ1Z0Fzc2VydChpbnN0YW5jZSBpbnN0YW5jZW9mIGNscywgJ0luc3RhbmNlIHN0b3JlZCBpbiBjYWNoZSBtaXNtYXRjaGVkIHdpdGggY2xhc3MnKTtcclxuICAgICAgICByZXR1cm4gaW5zdGFuY2U7XHJcbiAgICB9XHJcbiAgICBpbnN0YW5jZSA9IG5ldyBjbHMoKTtcclxuICAgIGluc3RhbmNlQ2FjaGUuc2V0KGNscywgaW5zdGFuY2UpO1xyXG4gICAgcmV0dXJuIGluc3RhbmNlO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBJbml0aWFsaXplcyBhbiB7QGxpbmsgQXV0aH0gaW5zdGFuY2Ugd2l0aCBmaW5lLWdyYWluZWQgY29udHJvbCBvdmVyXHJcbiAqIHtAbGluayBEZXBlbmRlbmNpZXN9LlxyXG4gKlxyXG4gKiBAcmVtYXJrc1xyXG4gKlxyXG4gKiBUaGlzIGZ1bmN0aW9uIGFsbG93cyBtb3JlIGNvbnRyb2wgb3ZlciB0aGUge0BsaW5rIEF1dGh9IGluc3RhbmNlIHRoYW5cclxuICoge0BsaW5rIGdldEF1dGh9LiBgZ2V0QXV0aGAgdXNlcyBwbGF0Zm9ybS1zcGVjaWZpYyBkZWZhdWx0cyB0byBzdXBwbHlcclxuICogdGhlIHtAbGluayBEZXBlbmRlbmNpZXN9LiBJbiBnZW5lcmFsLCBgZ2V0QXV0aGAgaXMgdGhlIGVhc2llc3Qgd2F5IHRvXHJcbiAqIGluaXRpYWxpemUgQXV0aCBhbmQgd29ya3MgZm9yIG1vc3QgdXNlIGNhc2VzLiBVc2UgYGluaXRpYWxpemVBdXRoYCBpZiB5b3VcclxuICogbmVlZCBjb250cm9sIG92ZXIgd2hpY2ggcGVyc2lzdGVuY2UgbGF5ZXIgaXMgdXNlZCwgb3IgdG8gbWluaW1pemUgYnVuZGxlXHJcbiAqIHNpemUgaWYgeW91J3JlIG5vdCB1c2luZyBlaXRoZXIgYHNpZ25JbldpdGhQb3B1cGAgb3IgYHNpZ25JbldpdGhSZWRpcmVjdGAuXHJcbiAqXHJcbiAqIEZvciBleGFtcGxlLCBpZiB5b3VyIGFwcCBvbmx5IHVzZXMgYW5vbnltb3VzIGFjY291bnRzIGFuZCB5b3Ugb25seSB3YW50XHJcbiAqIGFjY291bnRzIHNhdmVkIGZvciB0aGUgY3VycmVudCBzZXNzaW9uLCBpbml0aWFsaXplIGBBdXRoYCB3aXRoOlxyXG4gKlxyXG4gKiBgYGBqc1xyXG4gKiBjb25zdCBhdXRoID0gaW5pdGlhbGl6ZUF1dGgoYXBwLCB7XHJcbiAqICAgcGVyc2lzdGVuY2U6IGJyb3dzZXJTZXNzaW9uUGVyc2lzdGVuY2UsXHJcbiAqICAgcG9wdXBSZWRpcmVjdFJlc29sdmVyOiB1bmRlZmluZWQsXHJcbiAqIH0pO1xyXG4gKiBgYGBcclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuZnVuY3Rpb24gaW5pdGlhbGl6ZUF1dGgoYXBwLCBkZXBzKSB7XHJcbiAgICBjb25zdCBwcm92aWRlciA9IF9nZXRQcm92aWRlcihhcHAsICdhdXRoJyk7XHJcbiAgICBpZiAocHJvdmlkZXIuaXNJbml0aWFsaXplZCgpKSB7XHJcbiAgICAgICAgY29uc3QgYXV0aCA9IHByb3ZpZGVyLmdldEltbWVkaWF0ZSgpO1xyXG4gICAgICAgIGNvbnN0IGluaXRpYWxPcHRpb25zID0gcHJvdmlkZXIuZ2V0T3B0aW9ucygpO1xyXG4gICAgICAgIGlmIChkZWVwRXF1YWwoaW5pdGlhbE9wdGlvbnMsIGRlcHMgIT09IG51bGwgJiYgZGVwcyAhPT0gdm9pZCAwID8gZGVwcyA6IHt9KSkge1xyXG4gICAgICAgICAgICByZXR1cm4gYXV0aDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIF9mYWlsKGF1dGgsIFwiYWxyZWFkeS1pbml0aWFsaXplZFwiIC8qIEFMUkVBRFlfSU5JVElBTElaRUQgKi8pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGNvbnN0IGF1dGggPSBwcm92aWRlci5pbml0aWFsaXplKHsgb3B0aW9uczogZGVwcyB9KTtcclxuICAgIHJldHVybiBhdXRoO1xyXG59XHJcbmZ1bmN0aW9uIF9pbml0aWFsaXplQXV0aEluc3RhbmNlKGF1dGgsIGRlcHMpIHtcclxuICAgIGNvbnN0IHBlcnNpc3RlbmNlID0gKGRlcHMgPT09IG51bGwgfHwgZGVwcyA9PT0gdm9pZCAwID8gdm9pZCAwIDogZGVwcy5wZXJzaXN0ZW5jZSkgfHwgW107XHJcbiAgICBjb25zdCBoaWVyYXJjaHkgPSAoQXJyYXkuaXNBcnJheShwZXJzaXN0ZW5jZSkgPyBwZXJzaXN0ZW5jZSA6IFtwZXJzaXN0ZW5jZV0pLm1hcChfZ2V0SW5zdGFuY2UpO1xyXG4gICAgaWYgKGRlcHMgPT09IG51bGwgfHwgZGVwcyA9PT0gdm9pZCAwID8gdm9pZCAwIDogZGVwcy5lcnJvck1hcCkge1xyXG4gICAgICAgIGF1dGguX3VwZGF0ZUVycm9yTWFwKGRlcHMuZXJyb3JNYXApO1xyXG4gICAgfVxyXG4gICAgLy8gVGhpcyBwcm9taXNlIGlzIGludGVuZGVkIHRvIGZsb2F0OyBhdXRoIGluaXRpYWxpemF0aW9uIGhhcHBlbnMgaW4gdGhlXHJcbiAgICAvLyBiYWNrZ3JvdW5kLCBtZWFud2hpbGUgdGhlIGF1dGggb2JqZWN0IG1heSBiZSB1c2VkIGJ5IHRoZSBhcHAuXHJcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWZsb2F0aW5nLXByb21pc2VzXHJcbiAgICBhdXRoLl9pbml0aWFsaXplV2l0aFBlcnNpc3RlbmNlKGhpZXJhcmNoeSwgZGVwcyA9PT0gbnVsbCB8fCBkZXBzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBkZXBzLnBvcHVwUmVkaXJlY3RSZXNvbHZlcik7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuZnVuY3Rpb24gX2dldEN1cnJlbnRVcmwoKSB7XHJcbiAgICB2YXIgX2E7XHJcbiAgICByZXR1cm4gKHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJyAmJiAoKF9hID0gc2VsZi5sb2NhdGlvbikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmhyZWYpKSB8fCAnJztcclxufVxyXG5mdW5jdGlvbiBfaXNIdHRwT3JIdHRwcygpIHtcclxuICAgIHJldHVybiBfZ2V0Q3VycmVudFNjaGVtZSgpID09PSAnaHR0cDonIHx8IF9nZXRDdXJyZW50U2NoZW1lKCkgPT09ICdodHRwczonO1xyXG59XHJcbmZ1bmN0aW9uIF9nZXRDdXJyZW50U2NoZW1lKCkge1xyXG4gICAgdmFyIF9hO1xyXG4gICAgcmV0dXJuICh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcgJiYgKChfYSA9IHNlbGYubG9jYXRpb24pID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5wcm90b2NvbCkpIHx8IG51bGw7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIERldGVybWluZSB3aGV0aGVyIHRoZSBicm93c2VyIGlzIHdvcmtpbmcgb25saW5lXHJcbiAqL1xyXG5mdW5jdGlvbiBfaXNPbmxpbmUoKSB7XHJcbiAgICBpZiAodHlwZW9mIG5hdmlnYXRvciAhPT0gJ3VuZGVmaW5lZCcgJiZcclxuICAgICAgICBuYXZpZ2F0b3IgJiZcclxuICAgICAgICAnb25MaW5lJyBpbiBuYXZpZ2F0b3IgJiZcclxuICAgICAgICB0eXBlb2YgbmF2aWdhdG9yLm9uTGluZSA9PT0gJ2Jvb2xlYW4nICYmXHJcbiAgICAgICAgLy8gQXBwbHkgb25seSBmb3IgdHJhZGl0aW9uYWwgd2ViIGFwcHMgYW5kIENocm9tZSBleHRlbnNpb25zLlxyXG4gICAgICAgIC8vIFRoaXMgaXMgZXNwZWNpYWxseSB0cnVlIGZvciBDb3Jkb3ZhIGFwcHMgd2hpY2ggaGF2ZSB1bnJlbGlhYmxlXHJcbiAgICAgICAgLy8gbmF2aWdhdG9yLm9uTGluZSBiZWhhdmlvciB1bmxlc3MgY29yZG92YS1wbHVnaW4tbmV0d29yay1pbmZvcm1hdGlvbiBpc1xyXG4gICAgICAgIC8vIGluc3RhbGxlZCB3aGljaCBvdmVyd3JpdGVzIHRoZSBuYXRpdmUgbmF2aWdhdG9yLm9uTGluZSB2YWx1ZSBhbmRcclxuICAgICAgICAvLyBkZWZpbmVzIG5hdmlnYXRvci5jb25uZWN0aW9uLlxyXG4gICAgICAgIChfaXNIdHRwT3JIdHRwcygpIHx8IGlzQnJvd3NlckV4dGVuc2lvbigpIHx8ICdjb25uZWN0aW9uJyBpbiBuYXZpZ2F0b3IpKSB7XHJcbiAgICAgICAgcmV0dXJuIG5hdmlnYXRvci5vbkxpbmU7XHJcbiAgICB9XHJcbiAgICAvLyBJZiB3ZSBjYW4ndCBkZXRlcm1pbmUgdGhlIHN0YXRlLCBhc3N1bWUgaXQgaXMgb25saW5lLlxyXG4gICAgcmV0dXJuIHRydWU7XHJcbn1cclxuZnVuY3Rpb24gX2dldFVzZXJMYW5ndWFnZSgpIHtcclxuICAgIGlmICh0eXBlb2YgbmF2aWdhdG9yID09PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgY29uc3QgbmF2aWdhdG9yTGFuZ3VhZ2UgPSBuYXZpZ2F0b3I7XHJcbiAgICByZXR1cm4gKFxyXG4gICAgLy8gTW9zdCByZWxpYWJsZSwgYnV0IG9ubHkgc3VwcG9ydGVkIGluIENocm9tZS9GaXJlZm94LlxyXG4gICAgKG5hdmlnYXRvckxhbmd1YWdlLmxhbmd1YWdlcyAmJiBuYXZpZ2F0b3JMYW5ndWFnZS5sYW5ndWFnZXNbMF0pIHx8XHJcbiAgICAgICAgLy8gU3VwcG9ydGVkIGluIG1vc3QgYnJvd3NlcnMsIGJ1dCByZXR1cm5zIHRoZSBsYW5ndWFnZSBvZiB0aGUgYnJvd3NlclxyXG4gICAgICAgIC8vIFVJLCBub3QgdGhlIGxhbmd1YWdlIHNldCBpbiBicm93c2VyIHNldHRpbmdzLlxyXG4gICAgICAgIG5hdmlnYXRvckxhbmd1YWdlLmxhbmd1YWdlIHx8XHJcbiAgICAgICAgLy8gQ291bGRuJ3QgZGV0ZXJtaW5lIGxhbmd1YWdlLlxyXG4gICAgICAgIG51bGwpO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBBIHN0cnVjdHVyZSB0byBoZWxwIHBpY2sgYmV0d2VlbiBhIHJhbmdlIG9mIGxvbmcgYW5kIHNob3J0IGRlbGF5IGR1cmF0aW9uc1xyXG4gKiBkZXBlbmRpbmcgb24gdGhlIGN1cnJlbnQgZW52aXJvbm1lbnQuIEluIGdlbmVyYWwsIHRoZSBsb25nIGRlbGF5IGlzIHVzZWQgZm9yXHJcbiAqIG1vYmlsZSBlbnZpcm9ubWVudHMgd2hlcmVhcyBzaG9ydCBkZWxheXMgYXJlIHVzZWQgZm9yIGRlc2t0b3AgZW52aXJvbm1lbnRzLlxyXG4gKi9cclxuY2xhc3MgRGVsYXkge1xyXG4gICAgY29uc3RydWN0b3Ioc2hvcnREZWxheSwgbG9uZ0RlbGF5KSB7XHJcbiAgICAgICAgdGhpcy5zaG9ydERlbGF5ID0gc2hvcnREZWxheTtcclxuICAgICAgICB0aGlzLmxvbmdEZWxheSA9IGxvbmdEZWxheTtcclxuICAgICAgICAvLyBJbnRlcm5hbCBlcnJvciB3aGVuIGltcHJvcGVybHkgaW5pdGlhbGl6ZWQuXHJcbiAgICAgICAgZGVidWdBc3NlcnQobG9uZ0RlbGF5ID4gc2hvcnREZWxheSwgJ1Nob3J0IGRlbGF5IHNob3VsZCBiZSBsZXNzIHRoYW4gbG9uZyBkZWxheSEnKTtcclxuICAgICAgICB0aGlzLmlzTW9iaWxlID0gaXNNb2JpbGVDb3Jkb3ZhKCkgfHwgaXNSZWFjdE5hdGl2ZSgpO1xyXG4gICAgfVxyXG4gICAgZ2V0KCkge1xyXG4gICAgICAgIGlmICghX2lzT25saW5lKCkpIHtcclxuICAgICAgICAgICAgLy8gUGljayB0aGUgc2hvcnRlciB0aW1lb3V0LlxyXG4gICAgICAgICAgICByZXR1cm4gTWF0aC5taW4oNTAwMCAvKiBPRkZMSU5FICovLCB0aGlzLnNob3J0RGVsYXkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBJZiBydW5uaW5nIGluIGEgbW9iaWxlIGVudmlyb25tZW50LCByZXR1cm4gdGhlIGxvbmcgZGVsYXksIG90aGVyd2lzZVxyXG4gICAgICAgIC8vIHJldHVybiB0aGUgc2hvcnQgZGVsYXkuXHJcbiAgICAgICAgLy8gVGhpcyBjb3VsZCBiZSBpbXByb3ZlZCBpbiB0aGUgZnV0dXJlIHRvIGR5bmFtaWNhbGx5IGNoYW5nZSBiYXNlZCBvbiBvdGhlclxyXG4gICAgICAgIC8vIHZhcmlhYmxlcyBpbnN0ZWFkIG9mIGp1c3QgcmVhZGluZyB0aGUgY3VycmVudCBlbnZpcm9ubWVudC5cclxuICAgICAgICByZXR1cm4gdGhpcy5pc01vYmlsZSA/IHRoaXMubG9uZ0RlbGF5IDogdGhpcy5zaG9ydERlbGF5O1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmZ1bmN0aW9uIF9lbXVsYXRvclVybChjb25maWcsIHBhdGgpIHtcclxuICAgIGRlYnVnQXNzZXJ0KGNvbmZpZy5lbXVsYXRvciwgJ0VtdWxhdG9yIHNob3VsZCBhbHdheXMgYmUgc2V0IGhlcmUnKTtcclxuICAgIGNvbnN0IHsgdXJsIH0gPSBjb25maWcuZW11bGF0b3I7XHJcbiAgICBpZiAoIXBhdGgpIHtcclxuICAgICAgICByZXR1cm4gdXJsO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGAke3VybH0ke3BhdGguc3RhcnRzV2l0aCgnLycpID8gcGF0aC5zbGljZSgxKSA6IHBhdGh9YDtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jbGFzcyBGZXRjaFByb3ZpZGVyIHtcclxuICAgIHN0YXRpYyBpbml0aWFsaXplKGZldGNoSW1wbCwgaGVhZGVyc0ltcGwsIHJlc3BvbnNlSW1wbCkge1xyXG4gICAgICAgIHRoaXMuZmV0Y2hJbXBsID0gZmV0Y2hJbXBsO1xyXG4gICAgICAgIGlmIChoZWFkZXJzSW1wbCkge1xyXG4gICAgICAgICAgICB0aGlzLmhlYWRlcnNJbXBsID0gaGVhZGVyc0ltcGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChyZXNwb25zZUltcGwpIHtcclxuICAgICAgICAgICAgdGhpcy5yZXNwb25zZUltcGwgPSByZXNwb25zZUltcGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgc3RhdGljIGZldGNoKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmZldGNoSW1wbCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5mZXRjaEltcGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcgJiYgJ2ZldGNoJyBpbiBzZWxmKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBzZWxmLmZldGNoO1xyXG4gICAgICAgIH1cclxuICAgICAgICBkZWJ1Z0ZhaWwoJ0NvdWxkIG5vdCBmaW5kIGZldGNoIGltcGxlbWVudGF0aW9uLCBtYWtlIHN1cmUgeW91IGNhbGwgRmV0Y2hQcm92aWRlci5pbml0aWFsaXplKCkgd2l0aCBhbiBhcHByb3ByaWF0ZSBwb2x5ZmlsbCcpO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIGhlYWRlcnMoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaGVhZGVyc0ltcGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaGVhZGVyc0ltcGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcgJiYgJ0hlYWRlcnMnIGluIHNlbGYpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHNlbGYuSGVhZGVycztcclxuICAgICAgICB9XHJcbiAgICAgICAgZGVidWdGYWlsKCdDb3VsZCBub3QgZmluZCBIZWFkZXJzIGltcGxlbWVudGF0aW9uLCBtYWtlIHN1cmUgeW91IGNhbGwgRmV0Y2hQcm92aWRlci5pbml0aWFsaXplKCkgd2l0aCBhbiBhcHByb3ByaWF0ZSBwb2x5ZmlsbCcpO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIHJlc3BvbnNlKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnJlc3BvbnNlSW1wbCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZXNwb25zZUltcGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcgJiYgJ1Jlc3BvbnNlJyBpbiBzZWxmKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBzZWxmLlJlc3BvbnNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBkZWJ1Z0ZhaWwoJ0NvdWxkIG5vdCBmaW5kIFJlc3BvbnNlIGltcGxlbWVudGF0aW9uLCBtYWtlIHN1cmUgeW91IGNhbGwgRmV0Y2hQcm92aWRlci5pbml0aWFsaXplKCkgd2l0aCBhbiBhcHByb3ByaWF0ZSBwb2x5ZmlsbCcpO1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBNYXAgZnJvbSBlcnJvcnMgcmV0dXJuZWQgYnkgdGhlIHNlcnZlciB0byBlcnJvcnMgdG8gZGV2ZWxvcGVyIHZpc2libGUgZXJyb3JzXHJcbiAqL1xyXG5jb25zdCBTRVJWRVJfRVJST1JfTUFQID0ge1xyXG4gICAgLy8gQ3VzdG9tIHRva2VuIGVycm9ycy5cclxuICAgIFtcIkNSRURFTlRJQUxfTUlTTUFUQ0hcIiAvKiBDUkVERU5USUFMX01JU01BVENIICovXTogXCJjdXN0b20tdG9rZW4tbWlzbWF0Y2hcIiAvKiBDUkVERU5USUFMX01JU01BVENIICovLFxyXG4gICAgLy8gVGhpcyBjYW4gb25seSBoYXBwZW4gaWYgdGhlIFNESyBzZW5kcyBhIGJhZCByZXF1ZXN0LlxyXG4gICAgW1wiTUlTU0lOR19DVVNUT01fVE9LRU5cIiAvKiBNSVNTSU5HX0NVU1RPTV9UT0tFTiAqL106IFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyxcclxuICAgIC8vIENyZWF0ZSBBdXRoIFVSSSBlcnJvcnMuXHJcbiAgICBbXCJJTlZBTElEX0lERU5USUZJRVJcIiAvKiBJTlZBTElEX0lERU5USUZJRVIgKi9dOiBcImludmFsaWQtZW1haWxcIiAvKiBJTlZBTElEX0VNQUlMICovLFxyXG4gICAgLy8gVGhpcyBjYW4gb25seSBoYXBwZW4gaWYgdGhlIFNESyBzZW5kcyBhIGJhZCByZXF1ZXN0LlxyXG4gICAgW1wiTUlTU0lOR19DT05USU5VRV9VUklcIiAvKiBNSVNTSU5HX0NPTlRJTlVFX1VSSSAqL106IFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyxcclxuICAgIC8vIFNpZ24gaW4gd2l0aCBlbWFpbCBhbmQgcGFzc3dvcmQgZXJyb3JzIChzb21lIGFwcGx5IHRvIHNpZ24gdXAgdG9vKS5cclxuICAgIFtcIklOVkFMSURfUEFTU1dPUkRcIiAvKiBJTlZBTElEX1BBU1NXT1JEICovXTogXCJ3cm9uZy1wYXNzd29yZFwiIC8qIElOVkFMSURfUEFTU1dPUkQgKi8sXHJcbiAgICAvLyBUaGlzIGNhbiBvbmx5IGhhcHBlbiBpZiB0aGUgU0RLIHNlbmRzIGEgYmFkIHJlcXVlc3QuXHJcbiAgICBbXCJNSVNTSU5HX1BBU1NXT1JEXCIgLyogTUlTU0lOR19QQVNTV09SRCAqL106IFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyxcclxuICAgIC8vIFNpZ24gdXAgd2l0aCBlbWFpbCBhbmQgcGFzc3dvcmQgZXJyb3JzLlxyXG4gICAgW1wiRU1BSUxfRVhJU1RTXCIgLyogRU1BSUxfRVhJU1RTICovXTogXCJlbWFpbC1hbHJlYWR5LWluLXVzZVwiIC8qIEVNQUlMX0VYSVNUUyAqLyxcclxuICAgIFtcIlBBU1NXT1JEX0xPR0lOX0RJU0FCTEVEXCIgLyogUEFTU1dPUkRfTE9HSU5fRElTQUJMRUQgKi9dOiBcIm9wZXJhdGlvbi1ub3QtYWxsb3dlZFwiIC8qIE9QRVJBVElPTl9OT1RfQUxMT1dFRCAqLyxcclxuICAgIC8vIFZlcmlmeSBhc3NlcnRpb24gZm9yIHNpZ24gaW4gd2l0aCBjcmVkZW50aWFsIGVycm9yczpcclxuICAgIFtcIklOVkFMSURfSURQX1JFU1BPTlNFXCIgLyogSU5WQUxJRF9JRFBfUkVTUE9OU0UgKi9dOiBcImludmFsaWQtY3JlZGVudGlhbFwiIC8qIElOVkFMSURfSURQX1JFU1BPTlNFICovLFxyXG4gICAgW1wiSU5WQUxJRF9QRU5ESU5HX1RPS0VOXCIgLyogSU5WQUxJRF9QRU5ESU5HX1RPS0VOICovXTogXCJpbnZhbGlkLWNyZWRlbnRpYWxcIiAvKiBJTlZBTElEX0lEUF9SRVNQT05TRSAqLyxcclxuICAgIFtcIkZFREVSQVRFRF9VU0VSX0lEX0FMUkVBRFlfTElOS0VEXCIgLyogRkVERVJBVEVEX1VTRVJfSURfQUxSRUFEWV9MSU5LRUQgKi9dOiBcImNyZWRlbnRpYWwtYWxyZWFkeS1pbi11c2VcIiAvKiBDUkVERU5USUFMX0FMUkVBRFlfSU5fVVNFICovLFxyXG4gICAgLy8gVGhpcyBjYW4gb25seSBoYXBwZW4gaWYgdGhlIFNESyBzZW5kcyBhIGJhZCByZXF1ZXN0LlxyXG4gICAgW1wiTUlTU0lOR19SRVFfVFlQRVwiIC8qIE1JU1NJTkdfUkVRX1RZUEUgKi9dOiBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8sXHJcbiAgICAvLyBTZW5kIFBhc3N3b3JkIHJlc2V0IGVtYWlsIGVycm9yczpcclxuICAgIFtcIkVNQUlMX05PVF9GT1VORFwiIC8qIEVNQUlMX05PVF9GT1VORCAqL106IFwidXNlci1ub3QtZm91bmRcIiAvKiBVU0VSX0RFTEVURUQgKi8sXHJcbiAgICBbXCJSRVNFVF9QQVNTV09SRF9FWENFRURfTElNSVRcIiAvKiBSRVNFVF9QQVNTV09SRF9FWENFRURfTElNSVQgKi9dOiBcInRvby1tYW55LXJlcXVlc3RzXCIgLyogVE9PX01BTllfQVRURU1QVFNfVFJZX0xBVEVSICovLFxyXG4gICAgW1wiRVhQSVJFRF9PT0JfQ09ERVwiIC8qIEVYUElSRURfT09CX0NPREUgKi9dOiBcImV4cGlyZWQtYWN0aW9uLWNvZGVcIiAvKiBFWFBJUkVEX09PQl9DT0RFICovLFxyXG4gICAgW1wiSU5WQUxJRF9PT0JfQ09ERVwiIC8qIElOVkFMSURfT09CX0NPREUgKi9dOiBcImludmFsaWQtYWN0aW9uLWNvZGVcIiAvKiBJTlZBTElEX09PQl9DT0RFICovLFxyXG4gICAgLy8gVGhpcyBjYW4gb25seSBoYXBwZW4gaWYgdGhlIFNESyBzZW5kcyBhIGJhZCByZXF1ZXN0LlxyXG4gICAgW1wiTUlTU0lOR19PT0JfQ09ERVwiIC8qIE1JU1NJTkdfT09CX0NPREUgKi9dOiBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8sXHJcbiAgICAvLyBPcGVyYXRpb25zIHRoYXQgcmVxdWlyZSBJRCB0b2tlbiBpbiByZXF1ZXN0OlxyXG4gICAgW1wiQ1JFREVOVElBTF9UT09fT0xEX0xPR0lOX0FHQUlOXCIgLyogQ1JFREVOVElBTF9UT09fT0xEX0xPR0lOX0FHQUlOICovXTogXCJyZXF1aXJlcy1yZWNlbnQtbG9naW5cIiAvKiBDUkVERU5USUFMX1RPT19PTERfTE9HSU5fQUdBSU4gKi8sXHJcbiAgICBbXCJJTlZBTElEX0lEX1RPS0VOXCIgLyogSU5WQUxJRF9JRF9UT0tFTiAqL106IFwiaW52YWxpZC11c2VyLXRva2VuXCIgLyogSU5WQUxJRF9BVVRIICovLFxyXG4gICAgW1wiVE9LRU5fRVhQSVJFRFwiIC8qIFRPS0VOX0VYUElSRUQgKi9dOiBcInVzZXItdG9rZW4tZXhwaXJlZFwiIC8qIFRPS0VOX0VYUElSRUQgKi8sXHJcbiAgICBbXCJVU0VSX05PVF9GT1VORFwiIC8qIFVTRVJfTk9UX0ZPVU5EICovXTogXCJ1c2VyLXRva2VuLWV4cGlyZWRcIiAvKiBUT0tFTl9FWFBJUkVEICovLFxyXG4gICAgLy8gT3RoZXIgZXJyb3JzLlxyXG4gICAgW1wiVE9PX01BTllfQVRURU1QVFNfVFJZX0xBVEVSXCIgLyogVE9PX01BTllfQVRURU1QVFNfVFJZX0xBVEVSICovXTogXCJ0b28tbWFueS1yZXF1ZXN0c1wiIC8qIFRPT19NQU5ZX0FUVEVNUFRTX1RSWV9MQVRFUiAqLyxcclxuICAgIC8vIFBob25lIEF1dGggcmVsYXRlZCBlcnJvcnMuXHJcbiAgICBbXCJJTlZBTElEX0NPREVcIiAvKiBJTlZBTElEX0NPREUgKi9dOiBcImludmFsaWQtdmVyaWZpY2F0aW9uLWNvZGVcIiAvKiBJTlZBTElEX0NPREUgKi8sXHJcbiAgICBbXCJJTlZBTElEX1NFU1NJT05fSU5GT1wiIC8qIElOVkFMSURfU0VTU0lPTl9JTkZPICovXTogXCJpbnZhbGlkLXZlcmlmaWNhdGlvbi1pZFwiIC8qIElOVkFMSURfU0VTU0lPTl9JTkZPICovLFxyXG4gICAgW1wiSU5WQUxJRF9URU1QT1JBUllfUFJPT0ZcIiAvKiBJTlZBTElEX1RFTVBPUkFSWV9QUk9PRiAqL106IFwiaW52YWxpZC1jcmVkZW50aWFsXCIgLyogSU5WQUxJRF9JRFBfUkVTUE9OU0UgKi8sXHJcbiAgICBbXCJNSVNTSU5HX1NFU1NJT05fSU5GT1wiIC8qIE1JU1NJTkdfU0VTU0lPTl9JTkZPICovXTogXCJtaXNzaW5nLXZlcmlmaWNhdGlvbi1pZFwiIC8qIE1JU1NJTkdfU0VTU0lPTl9JTkZPICovLFxyXG4gICAgW1wiU0VTU0lPTl9FWFBJUkVEXCIgLyogU0VTU0lPTl9FWFBJUkVEICovXTogXCJjb2RlLWV4cGlyZWRcIiAvKiBDT0RFX0VYUElSRUQgKi8sXHJcbiAgICAvLyBPdGhlciBhY3Rpb24gY29kZSBlcnJvcnMgd2hlbiBhZGRpdGlvbmFsIHNldHRpbmdzIHBhc3NlZC5cclxuICAgIC8vIE1JU1NJTkdfQ09OVElOVUVfVVJJIGlzIGdldHRpbmcgbWFwcGVkIHRvIElOVEVSTkFMX0VSUk9SIGFib3ZlLlxyXG4gICAgLy8gVGhpcyBpcyBPSyBhcyB0aGlzIGVycm9yIHdpbGwgYmUgY2F1Z2h0IGJ5IGNsaWVudCBzaWRlIHZhbGlkYXRpb24uXHJcbiAgICBbXCJNSVNTSU5HX0FORFJPSURfUEFDS0FHRV9OQU1FXCIgLyogTUlTU0lOR19BTkRST0lEX1BBQ0tBR0VfTkFNRSAqL106IFwibWlzc2luZy1hbmRyb2lkLXBrZy1uYW1lXCIgLyogTUlTU0lOR19BTkRST0lEX1BBQ0tBR0VfTkFNRSAqLyxcclxuICAgIFtcIlVOQVVUSE9SSVpFRF9ET01BSU5cIiAvKiBVTkFVVEhPUklaRURfRE9NQUlOICovXTogXCJ1bmF1dGhvcml6ZWQtY29udGludWUtdXJpXCIgLyogVU5BVVRIT1JJWkVEX0RPTUFJTiAqLyxcclxuICAgIC8vIGdldFByb2plY3RDb25maWcgZXJyb3JzIHdoZW4gY2xpZW50SWQgaXMgcGFzc2VkLlxyXG4gICAgW1wiSU5WQUxJRF9PQVVUSF9DTElFTlRfSURcIiAvKiBJTlZBTElEX09BVVRIX0NMSUVOVF9JRCAqL106IFwiaW52YWxpZC1vYXV0aC1jbGllbnQtaWRcIiAvKiBJTlZBTElEX09BVVRIX0NMSUVOVF9JRCAqLyxcclxuICAgIC8vIFVzZXIgYWN0aW9ucyAoc2lnbi11cCBvciBkZWxldGlvbikgZGlzYWJsZWQgZXJyb3JzLlxyXG4gICAgW1wiQURNSU5fT05MWV9PUEVSQVRJT05cIiAvKiBBRE1JTl9PTkxZX09QRVJBVElPTiAqL106IFwiYWRtaW4tcmVzdHJpY3RlZC1vcGVyYXRpb25cIiAvKiBBRE1JTl9PTkxZX09QRVJBVElPTiAqLyxcclxuICAgIC8vIE11bHRpIGZhY3RvciByZWxhdGVkIGVycm9ycy5cclxuICAgIFtcIklOVkFMSURfTUZBX1BFTkRJTkdfQ1JFREVOVElBTFwiIC8qIElOVkFMSURfTUZBX1BFTkRJTkdfQ1JFREVOVElBTCAqL106IFwiaW52YWxpZC1tdWx0aS1mYWN0b3Itc2Vzc2lvblwiIC8qIElOVkFMSURfTUZBX1NFU1NJT04gKi8sXHJcbiAgICBbXCJNRkFfRU5ST0xMTUVOVF9OT1RfRk9VTkRcIiAvKiBNRkFfRU5ST0xMTUVOVF9OT1RfRk9VTkQgKi9dOiBcIm11bHRpLWZhY3Rvci1pbmZvLW5vdC1mb3VuZFwiIC8qIE1GQV9JTkZPX05PVF9GT1VORCAqLyxcclxuICAgIFtcIk1JU1NJTkdfTUZBX0VOUk9MTE1FTlRfSURcIiAvKiBNSVNTSU5HX01GQV9FTlJPTExNRU5UX0lEICovXTogXCJtaXNzaW5nLW11bHRpLWZhY3Rvci1pbmZvXCIgLyogTUlTU0lOR19NRkFfSU5GTyAqLyxcclxuICAgIFtcIk1JU1NJTkdfTUZBX1BFTkRJTkdfQ1JFREVOVElBTFwiIC8qIE1JU1NJTkdfTUZBX1BFTkRJTkdfQ1JFREVOVElBTCAqL106IFwibWlzc2luZy1tdWx0aS1mYWN0b3Itc2Vzc2lvblwiIC8qIE1JU1NJTkdfTUZBX1NFU1NJT04gKi8sXHJcbiAgICBbXCJTRUNPTkRfRkFDVE9SX0VYSVNUU1wiIC8qIFNFQ09ORF9GQUNUT1JfRVhJU1RTICovXTogXCJzZWNvbmQtZmFjdG9yLWFscmVhZHktaW4tdXNlXCIgLyogU0VDT05EX0ZBQ1RPUl9BTFJFQURZX0VOUk9MTEVEICovLFxyXG4gICAgW1wiU0VDT05EX0ZBQ1RPUl9MSU1JVF9FWENFRURFRFwiIC8qIFNFQ09ORF9GQUNUT1JfTElNSVRfRVhDRUVERUQgKi9dOiBcIm1heGltdW0tc2Vjb25kLWZhY3Rvci1jb3VudC1leGNlZWRlZFwiIC8qIFNFQ09ORF9GQUNUT1JfTElNSVRfRVhDRUVERUQgKi9cclxufTtcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuY29uc3QgREVGQVVMVF9BUElfVElNRU9VVF9NUyA9IG5ldyBEZWxheSgzMDAwMCwgNjAwMDApO1xyXG5mdW5jdGlvbiBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdCkge1xyXG4gICAgaWYgKGF1dGgudGVuYW50SWQgJiYgIXJlcXVlc3QudGVuYW50SWQpIHtcclxuICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCByZXF1ZXN0KSwgeyB0ZW5hbnRJZDogYXV0aC50ZW5hbnRJZCB9KTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXF1ZXN0O1xyXG59XHJcbmFzeW5jIGZ1bmN0aW9uIF9wZXJmb3JtQXBpUmVxdWVzdChhdXRoLCBtZXRob2QsIHBhdGgsIHJlcXVlc3QsIGN1c3RvbUVycm9yTWFwID0ge30pIHtcclxuICAgIHJldHVybiBfcGVyZm9ybUZldGNoV2l0aEVycm9ySGFuZGxpbmcoYXV0aCwgY3VzdG9tRXJyb3JNYXAsICgpID0+IHtcclxuICAgICAgICBsZXQgYm9keSA9IHt9O1xyXG4gICAgICAgIGxldCBwYXJhbXMgPSB7fTtcclxuICAgICAgICBpZiAocmVxdWVzdCkge1xyXG4gICAgICAgICAgICBpZiAobWV0aG9kID09PSBcIkdFVFwiIC8qIEdFVCAqLykge1xyXG4gICAgICAgICAgICAgICAgcGFyYW1zID0gcmVxdWVzdDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGJvZHkgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkocmVxdWVzdClcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgcXVlcnkgPSBxdWVyeXN0cmluZyhPYmplY3QuYXNzaWduKHsga2V5OiBhdXRoLmNvbmZpZy5hcGlLZXkgfSwgcGFyYW1zKSkuc2xpY2UoMSk7XHJcbiAgICAgICAgY29uc3QgaGVhZGVycyA9IG5ldyAoRmV0Y2hQcm92aWRlci5oZWFkZXJzKCkpKCk7XHJcbiAgICAgICAgaGVhZGVycy5zZXQoXCJDb250ZW50LVR5cGVcIiAvKiBDT05URU5UX1RZUEUgKi8sICdhcHBsaWNhdGlvbi9qc29uJyk7XHJcbiAgICAgICAgaGVhZGVycy5zZXQoXCJYLUNsaWVudC1WZXJzaW9uXCIgLyogWF9DTElFTlRfVkVSU0lPTiAqLywgYXV0aC5fZ2V0U2RrQ2xpZW50VmVyc2lvbigpKTtcclxuICAgICAgICBpZiAoYXV0aC5sYW5ndWFnZUNvZGUpIHtcclxuICAgICAgICAgICAgaGVhZGVycy5zZXQoXCJYLUZpcmViYXNlLUxvY2FsZVwiIC8qIFhfRklSRUJBU0VfTE9DQUxFICovLCBhdXRoLmxhbmd1YWdlQ29kZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBGZXRjaFByb3ZpZGVyLmZldGNoKCkoX2dldEZpbmFsVGFyZ2V0KGF1dGgsIGF1dGguY29uZmlnLmFwaUhvc3QsIHBhdGgsIHF1ZXJ5KSwgT2JqZWN0LmFzc2lnbih7IG1ldGhvZCxcclxuICAgICAgICAgICAgaGVhZGVycywgcmVmZXJyZXJQb2xpY3k6ICduby1yZWZlcnJlcicgfSwgYm9keSkpO1xyXG4gICAgfSk7XHJcbn1cclxuYXN5bmMgZnVuY3Rpb24gX3BlcmZvcm1GZXRjaFdpdGhFcnJvckhhbmRsaW5nKGF1dGgsIGN1c3RvbUVycm9yTWFwLCBmZXRjaEZuKSB7XHJcbiAgICBhdXRoLl9jYW5Jbml0RW11bGF0b3IgPSBmYWxzZTtcclxuICAgIGNvbnN0IGVycm9yTWFwID0gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCBTRVJWRVJfRVJST1JfTUFQKSwgY3VzdG9tRXJyb3JNYXApO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBuZXR3b3JrVGltZW91dCA9IG5ldyBOZXR3b3JrVGltZW91dChhdXRoKTtcclxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IFByb21pc2UucmFjZShbXHJcbiAgICAgICAgICAgIGZldGNoRm4oKSxcclxuICAgICAgICAgICAgbmV0d29ya1RpbWVvdXQucHJvbWlzZVxyXG4gICAgICAgIF0pO1xyXG4gICAgICAgIC8vIElmIHdlJ3ZlIHJlYWNoZWQgdGhpcyBwb2ludCwgdGhlIGZldGNoIHN1Y2NlZWRlZCBhbmQgdGhlIG5ldHdvcmtUaW1lb3V0XHJcbiAgICAgICAgLy8gZGlkbid0IHRocm93OyBjbGVhciB0aGUgbmV0d29yayB0aW1lb3V0IGRlbGF5IHNvIHRoYXQgTm9kZSB3b24ndCBoYW5nXHJcbiAgICAgICAgbmV0d29ya1RpbWVvdXQuY2xlYXJOZXR3b3JrVGltZW91dCgpO1xyXG4gICAgICAgIGNvbnN0IGpzb24gPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XHJcbiAgICAgICAgaWYgKCduZWVkQ29uZmlybWF0aW9uJyBpbiBqc29uKSB7XHJcbiAgICAgICAgICAgIHRocm93IF9tYWtlVGFnZ2VkRXJyb3IoYXV0aCwgXCJhY2NvdW50LWV4aXN0cy13aXRoLWRpZmZlcmVudC1jcmVkZW50aWFsXCIgLyogTkVFRF9DT05GSVJNQVRJT04gKi8sIGpzb24pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocmVzcG9uc2Uub2sgJiYgISgnZXJyb3JNZXNzYWdlJyBpbiBqc29uKSkge1xyXG4gICAgICAgICAgICByZXR1cm4ganNvbjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IHJlc3BvbnNlLm9rID8ganNvbi5lcnJvck1lc3NhZ2UgOiBqc29uLmVycm9yLm1lc3NhZ2U7XHJcbiAgICAgICAgICAgIGNvbnN0IHNlcnZlckVycm9yQ29kZSA9IGVycm9yTWVzc2FnZS5zcGxpdCgnIDogJylbMF07XHJcbiAgICAgICAgICAgIGlmIChzZXJ2ZXJFcnJvckNvZGUgPT09IFwiRkVERVJBVEVEX1VTRVJfSURfQUxSRUFEWV9MSU5LRURcIiAvKiBGRURFUkFURURfVVNFUl9JRF9BTFJFQURZX0xJTktFRCAqLykge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgX21ha2VUYWdnZWRFcnJvcihhdXRoLCBcImNyZWRlbnRpYWwtYWxyZWFkeS1pbi11c2VcIiAvKiBDUkVERU5USUFMX0FMUkVBRFlfSU5fVVNFICovLCBqc29uKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChzZXJ2ZXJFcnJvckNvZGUgPT09IFwiRU1BSUxfRVhJU1RTXCIgLyogRU1BSUxfRVhJU1RTICovKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBfbWFrZVRhZ2dlZEVycm9yKGF1dGgsIFwiZW1haWwtYWxyZWFkeS1pbi11c2VcIiAvKiBFTUFJTF9FWElTVFMgKi8sIGpzb24pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IGF1dGhFcnJvciA9IGVycm9yTWFwW3NlcnZlckVycm9yQ29kZV0gfHxcclxuICAgICAgICAgICAgICAgIHNlcnZlckVycm9yQ29kZVxyXG4gICAgICAgICAgICAgICAgICAgIC50b0xvd2VyQ2FzZSgpXHJcbiAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL1tfXFxzXSsvZywgJy0nKTtcclxuICAgICAgICAgICAgX2ZhaWwoYXV0aCwgYXV0aEVycm9yKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgIGlmIChlIGluc3RhbmNlb2YgRmlyZWJhc2VFcnJvcikge1xyXG4gICAgICAgICAgICB0aHJvdyBlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBfZmFpbChhdXRoLCBcIm5ldHdvcmstcmVxdWVzdC1mYWlsZWRcIiAvKiBORVRXT1JLX1JFUVVFU1RfRkFJTEVEICovKTtcclxuICAgIH1cclxufVxyXG5hc3luYyBmdW5jdGlvbiBfcGVyZm9ybVNpZ25JblJlcXVlc3QoYXV0aCwgbWV0aG9kLCBwYXRoLCByZXF1ZXN0LCBjdXN0b21FcnJvck1hcCA9IHt9KSB7XHJcbiAgICBjb25zdCBzZXJ2ZXJSZXNwb25zZSA9IChhd2FpdCBfcGVyZm9ybUFwaVJlcXVlc3QoYXV0aCwgbWV0aG9kLCBwYXRoLCByZXF1ZXN0LCBjdXN0b21FcnJvck1hcCkpO1xyXG4gICAgaWYgKCdtZmFQZW5kaW5nQ3JlZGVudGlhbCcgaW4gc2VydmVyUmVzcG9uc2UpIHtcclxuICAgICAgICBfZmFpbChhdXRoLCBcIm11bHRpLWZhY3Rvci1hdXRoLXJlcXVpcmVkXCIgLyogTUZBX1JFUVVJUkVEICovLCB7XHJcbiAgICAgICAgICAgIHNlcnZlclJlc3BvbnNlXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gc2VydmVyUmVzcG9uc2U7XHJcbn1cclxuZnVuY3Rpb24gX2dldEZpbmFsVGFyZ2V0KGF1dGgsIGhvc3QsIHBhdGgsIHF1ZXJ5KSB7XHJcbiAgICBjb25zdCBiYXNlID0gYCR7aG9zdH0ke3BhdGh9PyR7cXVlcnl9YDtcclxuICAgIGlmICghYXV0aC5jb25maWcuZW11bGF0b3IpIHtcclxuICAgICAgICByZXR1cm4gYCR7YXV0aC5jb25maWcuYXBpU2NoZW1lfTovLyR7YmFzZX1gO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIF9lbXVsYXRvclVybChhdXRoLmNvbmZpZywgYmFzZSk7XHJcbn1cclxuY2xhc3MgTmV0d29ya1RpbWVvdXQge1xyXG4gICAgY29uc3RydWN0b3IoYXV0aCkge1xyXG4gICAgICAgIHRoaXMuYXV0aCA9IGF1dGg7XHJcbiAgICAgICAgLy8gTm9kZSB0aW1lcnMgYW5kIGJyb3dzZXIgdGltZXJzIGFyZSBmdW5kYW1lbnRhbGx5IGluY29tcGF0aWJsZSwgYnV0IHdlXHJcbiAgICAgICAgLy8gZG9uJ3QgY2FyZSBhYm91dCB0aGUgdmFsdWUgaGVyZVxyXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XHJcbiAgICAgICAgdGhpcy50aW1lciA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5wcm9taXNlID0gbmV3IFByb21pc2UoKF8sIHJlamVjdCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVqZWN0KF9jcmVhdGVFcnJvcih0aGlzLmF1dGgsIFwidGltZW91dFwiIC8qIFRJTUVPVVQgKi8pKTtcclxuICAgICAgICAgICAgfSwgREVGQVVMVF9BUElfVElNRU9VVF9NUy5nZXQoKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBjbGVhck5ldHdvcmtUaW1lb3V0KCkge1xyXG4gICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVyKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBfbWFrZVRhZ2dlZEVycm9yKGF1dGgsIGNvZGUsIHJlc3BvbnNlKSB7XHJcbiAgICBjb25zdCBlcnJvclBhcmFtcyA9IHtcclxuICAgICAgICBhcHBOYW1lOiBhdXRoLm5hbWVcclxuICAgIH07XHJcbiAgICBpZiAocmVzcG9uc2UuZW1haWwpIHtcclxuICAgICAgICBlcnJvclBhcmFtcy5lbWFpbCA9IHJlc3BvbnNlLmVtYWlsO1xyXG4gICAgfVxyXG4gICAgaWYgKHJlc3BvbnNlLnBob25lTnVtYmVyKSB7XHJcbiAgICAgICAgZXJyb3JQYXJhbXMucGhvbmVOdW1iZXIgPSByZXNwb25zZS5waG9uZU51bWJlcjtcclxuICAgIH1cclxuICAgIGNvbnN0IGVycm9yID0gX2NyZWF0ZUVycm9yKGF1dGgsIGNvZGUsIGVycm9yUGFyYW1zKTtcclxuICAgIC8vIFdlIGtub3cgY3VzdG9tRGF0YSBpcyBkZWZpbmVkIG9uIGVycm9yIGJlY2F1c2UgZXJyb3JQYXJhbXMgaXMgZGVmaW5lZFxyXG4gICAgZXJyb3IuY3VzdG9tRGF0YS5fdG9rZW5SZXNwb25zZSA9IHJlc3BvbnNlO1xyXG4gICAgcmV0dXJuIGVycm9yO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUFjY291bnQoYXV0aCwgcmVxdWVzdCkge1xyXG4gICAgcmV0dXJuIF9wZXJmb3JtQXBpUmVxdWVzdChhdXRoLCBcIlBPU1RcIiAvKiBQT1NUICovLCBcIi92MS9hY2NvdW50czpkZWxldGVcIiAvKiBERUxFVEVfQUNDT1VOVCAqLywgcmVxdWVzdCk7XHJcbn1cclxuYXN5bmMgZnVuY3Rpb24gZGVsZXRlTGlua2VkQWNjb3VudHMoYXV0aCwgcmVxdWVzdCkge1xyXG4gICAgcmV0dXJuIF9wZXJmb3JtQXBpUmVxdWVzdChhdXRoLCBcIlBPU1RcIiAvKiBQT1NUICovLCBcIi92MS9hY2NvdW50czp1cGRhdGVcIiAvKiBTRVRfQUNDT1VOVF9JTkZPICovLCByZXF1ZXN0KTtcclxufVxyXG5hc3luYyBmdW5jdGlvbiBnZXRBY2NvdW50SW5mbyhhdXRoLCByZXF1ZXN0KSB7XHJcbiAgICByZXR1cm4gX3BlcmZvcm1BcGlSZXF1ZXN0KGF1dGgsIFwiUE9TVFwiIC8qIFBPU1QgKi8sIFwiL3YxL2FjY291bnRzOmxvb2t1cFwiIC8qIEdFVF9BQ0NPVU5UX0lORk8gKi8sIHJlcXVlc3QpO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmZ1bmN0aW9uIHV0Y1RpbWVzdGFtcFRvRGF0ZVN0cmluZyh1dGNUaW1lc3RhbXApIHtcclxuICAgIGlmICghdXRjVGltZXN0YW1wKSB7XHJcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgIH1cclxuICAgIHRyeSB7XHJcbiAgICAgICAgLy8gQ29udmVydCB0byBkYXRlIG9iamVjdC5cclxuICAgICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoTnVtYmVyKHV0Y1RpbWVzdGFtcCkpO1xyXG4gICAgICAgIC8vIFRlc3QgZGF0ZSBpcyB2YWxpZC5cclxuICAgICAgICBpZiAoIWlzTmFOKGRhdGUuZ2V0VGltZSgpKSkge1xyXG4gICAgICAgICAgICAvLyBDb252ZXJ0IHRvIFVUQyBkYXRlIHN0cmluZy5cclxuICAgICAgICAgICAgcmV0dXJuIGRhdGUudG9VVENTdHJpbmcoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgIC8vIERvIG5vdGhpbmcuIHVuZGVmaW5lZCB3aWxsIGJlIHJldHVybmVkLlxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogUmV0dXJucyBhIEpTT04gV2ViIFRva2VuIChKV1QpIHVzZWQgdG8gaWRlbnRpZnkgdGhlIHVzZXIgdG8gYSBGaXJlYmFzZSBzZXJ2aWNlLlxyXG4gKlxyXG4gKiBAcmVtYXJrc1xyXG4gKiBSZXR1cm5zIHRoZSBjdXJyZW50IHRva2VuIGlmIGl0IGhhcyBub3QgZXhwaXJlZCBvciBpZiBpdCB3aWxsIG5vdCBleHBpcmUgaW4gdGhlIG5leHQgZml2ZVxyXG4gKiBtaW51dGVzLiBPdGhlcndpc2UsIHRoaXMgd2lsbCByZWZyZXNoIHRoZSB0b2tlbiBhbmQgcmV0dXJuIGEgbmV3IG9uZS5cclxuICpcclxuICogQHBhcmFtIHVzZXIgLSBUaGUgdXNlci5cclxuICogQHBhcmFtIGZvcmNlUmVmcmVzaCAtIEZvcmNlIHJlZnJlc2ggcmVnYXJkbGVzcyBvZiB0b2tlbiBleHBpcmF0aW9uLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5mdW5jdGlvbiBnZXRJZFRva2VuKHVzZXIsIGZvcmNlUmVmcmVzaCA9IGZhbHNlKSB7XHJcbiAgICByZXR1cm4gZ2V0TW9kdWxhckluc3RhbmNlKHVzZXIpLmdldElkVG9rZW4oZm9yY2VSZWZyZXNoKTtcclxufVxyXG4vKipcclxuICogUmV0dXJucyBhIGRlc2VyaWFsaXplZCBKU09OIFdlYiBUb2tlbiAoSldUKSB1c2VkIHRvIGlkZW50aXRmeSB0aGUgdXNlciB0byBhIEZpcmViYXNlIHNlcnZpY2UuXHJcbiAqXHJcbiAqIEByZW1hcmtzXHJcbiAqIFJldHVybnMgdGhlIGN1cnJlbnQgdG9rZW4gaWYgaXQgaGFzIG5vdCBleHBpcmVkIG9yIGlmIGl0IHdpbGwgbm90IGV4cGlyZSBpbiB0aGUgbmV4dCBmaXZlXHJcbiAqIG1pbnV0ZXMuIE90aGVyd2lzZSwgdGhpcyB3aWxsIHJlZnJlc2ggdGhlIHRva2VuIGFuZCByZXR1cm4gYSBuZXcgb25lLlxyXG4gKlxyXG4gKiBAcGFyYW0gdXNlciAtIFRoZSB1c2VyLlxyXG4gKiBAcGFyYW0gZm9yY2VSZWZyZXNoIC0gRm9yY2UgcmVmcmVzaCByZWdhcmRsZXNzIG9mIHRva2VuIGV4cGlyYXRpb24uXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIGdldElkVG9rZW5SZXN1bHQodXNlciwgZm9yY2VSZWZyZXNoID0gZmFsc2UpIHtcclxuICAgIGNvbnN0IHVzZXJJbnRlcm5hbCA9IGdldE1vZHVsYXJJbnN0YW5jZSh1c2VyKTtcclxuICAgIGNvbnN0IHRva2VuID0gYXdhaXQgdXNlckludGVybmFsLmdldElkVG9rZW4oZm9yY2VSZWZyZXNoKTtcclxuICAgIGNvbnN0IGNsYWltcyA9IF9wYXJzZVRva2VuKHRva2VuKTtcclxuICAgIF9hc3NlcnQoY2xhaW1zICYmIGNsYWltcy5leHAgJiYgY2xhaW1zLmF1dGhfdGltZSAmJiBjbGFpbXMuaWF0LCB1c2VySW50ZXJuYWwuYXV0aCwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIElOVEVSTkFMX0VSUk9SICovKTtcclxuICAgIGNvbnN0IGZpcmViYXNlID0gdHlwZW9mIGNsYWltcy5maXJlYmFzZSA9PT0gJ29iamVjdCcgPyBjbGFpbXMuZmlyZWJhc2UgOiB1bmRlZmluZWQ7XHJcbiAgICBjb25zdCBzaWduSW5Qcm92aWRlciA9IGZpcmViYXNlID09PSBudWxsIHx8IGZpcmViYXNlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBmaXJlYmFzZVsnc2lnbl9pbl9wcm92aWRlciddO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBjbGFpbXMsXHJcbiAgICAgICAgdG9rZW4sXHJcbiAgICAgICAgYXV0aFRpbWU6IHV0Y1RpbWVzdGFtcFRvRGF0ZVN0cmluZyhzZWNvbmRzU3RyaW5nVG9NaWxsaXNlY29uZHMoY2xhaW1zLmF1dGhfdGltZSkpLFxyXG4gICAgICAgIGlzc3VlZEF0VGltZTogdXRjVGltZXN0YW1wVG9EYXRlU3RyaW5nKHNlY29uZHNTdHJpbmdUb01pbGxpc2Vjb25kcyhjbGFpbXMuaWF0KSksXHJcbiAgICAgICAgZXhwaXJhdGlvblRpbWU6IHV0Y1RpbWVzdGFtcFRvRGF0ZVN0cmluZyhzZWNvbmRzU3RyaW5nVG9NaWxsaXNlY29uZHMoY2xhaW1zLmV4cCkpLFxyXG4gICAgICAgIHNpZ25JblByb3ZpZGVyOiBzaWduSW5Qcm92aWRlciB8fCBudWxsLFxyXG4gICAgICAgIHNpZ25JblNlY29uZEZhY3RvcjogKGZpcmViYXNlID09PSBudWxsIHx8IGZpcmViYXNlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBmaXJlYmFzZVsnc2lnbl9pbl9zZWNvbmRfZmFjdG9yJ10pIHx8IG51bGxcclxuICAgIH07XHJcbn1cclxuZnVuY3Rpb24gc2Vjb25kc1N0cmluZ1RvTWlsbGlzZWNvbmRzKHNlY29uZHMpIHtcclxuICAgIHJldHVybiBOdW1iZXIoc2Vjb25kcykgKiAxMDAwO1xyXG59XHJcbmZ1bmN0aW9uIF9wYXJzZVRva2VuKHRva2VuKSB7XHJcbiAgICBjb25zdCBbYWxnb3JpdGhtLCBwYXlsb2FkLCBzaWduYXR1cmVdID0gdG9rZW4uc3BsaXQoJy4nKTtcclxuICAgIGlmIChhbGdvcml0aG0gPT09IHVuZGVmaW5lZCB8fFxyXG4gICAgICAgIHBheWxvYWQgPT09IHVuZGVmaW5lZCB8fFxyXG4gICAgICAgIHNpZ25hdHVyZSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgX2xvZ0Vycm9yKCdKV1QgbWFsZm9ybWVkLCBjb250YWluZWQgZmV3ZXIgdGhhbiAzIHNlY3Rpb25zJyk7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGRlY29kZWQgPSBiYXNlNjREZWNvZGUocGF5bG9hZCk7XHJcbiAgICAgICAgaWYgKCFkZWNvZGVkKSB7XHJcbiAgICAgICAgICAgIF9sb2dFcnJvcignRmFpbGVkIHRvIGRlY29kZSBiYXNlNjQgSldUIHBheWxvYWQnKTtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBKU09OLnBhcnNlKGRlY29kZWQpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICBfbG9nRXJyb3IoJ0NhdWdodCBlcnJvciBwYXJzaW5nIEpXVCBwYXlsb2FkIGFzIEpTT04nLCBlKTtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogRXh0cmFjdCBleHBpcmVzSW4gVFRMIGZyb20gYSB0b2tlbiBieSBzdWJ0cmFjdGluZyB0aGUgZXhwaXJhdGlvbiBmcm9tIHRoZSBpc3N1YW5jZS5cclxuICovXHJcbmZ1bmN0aW9uIF90b2tlbkV4cGlyZXNJbih0b2tlbikge1xyXG4gICAgY29uc3QgcGFyc2VkVG9rZW4gPSBfcGFyc2VUb2tlbih0b2tlbik7XHJcbiAgICBfYXNzZXJ0KHBhcnNlZFRva2VuLCBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8pO1xyXG4gICAgX2Fzc2VydCh0eXBlb2YgcGFyc2VkVG9rZW4uZXhwICE9PSAndW5kZWZpbmVkJywgXCJpbnRlcm5hbC1lcnJvclwiIC8qIElOVEVSTkFMX0VSUk9SICovKTtcclxuICAgIF9hc3NlcnQodHlwZW9mIHBhcnNlZFRva2VuLmlhdCAhPT0gJ3VuZGVmaW5lZCcsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyk7XHJcbiAgICByZXR1cm4gTnVtYmVyKHBhcnNlZFRva2VuLmV4cCkgLSBOdW1iZXIocGFyc2VkVG9rZW4uaWF0KTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBfbG9nb3V0SWZJbnZhbGlkYXRlZCh1c2VyLCBwcm9taXNlLCBieXBhc3NBdXRoU3RhdGUgPSBmYWxzZSkge1xyXG4gICAgaWYgKGJ5cGFzc0F1dGhTdGF0ZSkge1xyXG4gICAgICAgIHJldHVybiBwcm9taXNlO1xyXG4gICAgfVxyXG4gICAgdHJ5IHtcclxuICAgICAgICByZXR1cm4gYXdhaXQgcHJvbWlzZTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBGaXJlYmFzZUVycm9yICYmIGlzVXNlckludmFsaWRhdGVkKGUpKSB7XHJcbiAgICAgICAgICAgIGlmICh1c2VyLmF1dGguY3VycmVudFVzZXIgPT09IHVzZXIpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHVzZXIuYXV0aC5zaWduT3V0KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhyb3cgZTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBpc1VzZXJJbnZhbGlkYXRlZCh7IGNvZGUgfSkge1xyXG4gICAgcmV0dXJuIChjb2RlID09PSBgYXV0aC8ke1widXNlci1kaXNhYmxlZFwiIC8qIFVTRVJfRElTQUJMRUQgKi99YCB8fFxyXG4gICAgICAgIGNvZGUgPT09IGBhdXRoLyR7XCJ1c2VyLXRva2VuLWV4cGlyZWRcIiAvKiBUT0tFTl9FWFBJUkVEICovfWApO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmNsYXNzIFByb2FjdGl2ZVJlZnJlc2gge1xyXG4gICAgY29uc3RydWN0b3IodXNlcikge1xyXG4gICAgICAgIHRoaXMudXNlciA9IHVzZXI7XHJcbiAgICAgICAgdGhpcy5pc1J1bm5pbmcgPSBmYWxzZTtcclxuICAgICAgICAvLyBOb2RlIHRpbWVycyBhbmQgYnJvd3NlciB0aW1lcnMgcmV0dXJuIGZ1bmRhbWVudGFsbHkgZGlmZmVyZW50IHR5cGVzLlxyXG4gICAgICAgIC8vIFdlIGRvbid0IGFjdHVhbGx5IGNhcmUgd2hhdCB0aGUgdmFsdWUgaXMgYnV0IFRTIHdvbid0IGFjY2VwdCB1bmtub3duIGFuZFxyXG4gICAgICAgIC8vIHdlIGNhbid0IGNhc3QgcHJvcGVybHkgaW4gYm90aCBlbnZpcm9ubWVudHMuXHJcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcclxuICAgICAgICB0aGlzLnRpbWVySWQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuZXJyb3JCYWNrb2ZmID0gMzAwMDAgLyogUkVUUllfQkFDS09GRl9NSU4gKi87XHJcbiAgICB9XHJcbiAgICBfc3RhcnQoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNSdW5uaW5nKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pc1J1bm5pbmcgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuc2NoZWR1bGUoKTtcclxuICAgIH1cclxuICAgIF9zdG9wKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5pc1J1bm5pbmcpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmlzUnVubmluZyA9IGZhbHNlO1xyXG4gICAgICAgIGlmICh0aGlzLnRpbWVySWQgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZXJJZCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZ2V0SW50ZXJ2YWwod2FzRXJyb3IpIHtcclxuICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgaWYgKHdhc0Vycm9yKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGludGVydmFsID0gdGhpcy5lcnJvckJhY2tvZmY7XHJcbiAgICAgICAgICAgIHRoaXMuZXJyb3JCYWNrb2ZmID0gTWF0aC5taW4odGhpcy5lcnJvckJhY2tvZmYgKiAyLCA5NjAwMDAgLyogUkVUUllfQkFDS09GRl9NQVggKi8pO1xyXG4gICAgICAgICAgICByZXR1cm4gaW50ZXJ2YWw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBSZXNldCB0aGUgZXJyb3IgYmFja29mZlxyXG4gICAgICAgICAgICB0aGlzLmVycm9yQmFja29mZiA9IDMwMDAwIC8qIFJFVFJZX0JBQ0tPRkZfTUlOICovO1xyXG4gICAgICAgICAgICBjb25zdCBleHBUaW1lID0gKF9hID0gdGhpcy51c2VyLnN0c1Rva2VuTWFuYWdlci5leHBpcmF0aW9uVGltZSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogMDtcclxuICAgICAgICAgICAgY29uc3QgaW50ZXJ2YWwgPSBleHBUaW1lIC0gRGF0ZS5ub3coKSAtIDMwMDAwMCAvKiBPRkZTRVQgKi87XHJcbiAgICAgICAgICAgIHJldHVybiBNYXRoLm1heCgwLCBpbnRlcnZhbCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgc2NoZWR1bGUod2FzRXJyb3IgPSBmYWxzZSkge1xyXG4gICAgICAgIGlmICghdGhpcy5pc1J1bm5pbmcpIHtcclxuICAgICAgICAgICAgLy8gSnVzdCBpbiBjYXNlLi4uXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgaW50ZXJ2YWwgPSB0aGlzLmdldEludGVydmFsKHdhc0Vycm9yKTtcclxuICAgICAgICB0aGlzLnRpbWVySWQgPSBzZXRUaW1lb3V0KGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5pdGVyYXRpb24oKTtcclxuICAgICAgICB9LCBpbnRlcnZhbCk7XHJcbiAgICB9XHJcbiAgICBhc3luYyBpdGVyYXRpb24oKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy51c2VyLmdldElkVG9rZW4odHJ1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIC8vIE9ubHkgcmV0cnkgb24gbmV0d29yayBlcnJvcnNcclxuICAgICAgICAgICAgaWYgKGUuY29kZSA9PT0gYGF1dGgvJHtcIm5ldHdvcmstcmVxdWVzdC1mYWlsZWRcIiAvKiBORVRXT1JLX1JFUVVFU1RfRkFJTEVEICovfWApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2NoZWR1bGUoLyogd2FzRXJyb3IgKi8gdHJ1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNjaGVkdWxlKCk7XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuY2xhc3MgVXNlck1ldGFkYXRhIHtcclxuICAgIGNvbnN0cnVjdG9yKGNyZWF0ZWRBdCwgbGFzdExvZ2luQXQpIHtcclxuICAgICAgICB0aGlzLmNyZWF0ZWRBdCA9IGNyZWF0ZWRBdDtcclxuICAgICAgICB0aGlzLmxhc3RMb2dpbkF0ID0gbGFzdExvZ2luQXQ7XHJcbiAgICAgICAgdGhpcy5faW5pdGlhbGl6ZVRpbWUoKTtcclxuICAgIH1cclxuICAgIF9pbml0aWFsaXplVGltZSgpIHtcclxuICAgICAgICB0aGlzLmxhc3RTaWduSW5UaW1lID0gdXRjVGltZXN0YW1wVG9EYXRlU3RyaW5nKHRoaXMubGFzdExvZ2luQXQpO1xyXG4gICAgICAgIHRoaXMuY3JlYXRpb25UaW1lID0gdXRjVGltZXN0YW1wVG9EYXRlU3RyaW5nKHRoaXMuY3JlYXRlZEF0KTtcclxuICAgIH1cclxuICAgIF9jb3B5KG1ldGFkYXRhKSB7XHJcbiAgICAgICAgdGhpcy5jcmVhdGVkQXQgPSBtZXRhZGF0YS5jcmVhdGVkQXQ7XHJcbiAgICAgICAgdGhpcy5sYXN0TG9naW5BdCA9IG1ldGFkYXRhLmxhc3RMb2dpbkF0O1xyXG4gICAgICAgIHRoaXMuX2luaXRpYWxpemVUaW1lKCk7XHJcbiAgICB9XHJcbiAgICB0b0pTT04oKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgY3JlYXRlZEF0OiB0aGlzLmNyZWF0ZWRBdCxcclxuICAgICAgICAgICAgbGFzdExvZ2luQXQ6IHRoaXMubGFzdExvZ2luQXRcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIF9yZWxvYWRXaXRob3V0U2F2aW5nKHVzZXIpIHtcclxuICAgIHZhciBfYTtcclxuICAgIGNvbnN0IGF1dGggPSB1c2VyLmF1dGg7XHJcbiAgICBjb25zdCBpZFRva2VuID0gYXdhaXQgdXNlci5nZXRJZFRva2VuKCk7XHJcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IF9sb2dvdXRJZkludmFsaWRhdGVkKHVzZXIsIGdldEFjY291bnRJbmZvKGF1dGgsIHsgaWRUb2tlbiB9KSk7XHJcbiAgICBfYXNzZXJ0KHJlc3BvbnNlID09PSBudWxsIHx8IHJlc3BvbnNlID09PSB2b2lkIDAgPyB2b2lkIDAgOiByZXNwb25zZS51c2Vycy5sZW5ndGgsIGF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyk7XHJcbiAgICBjb25zdCBjb3JlQWNjb3VudCA9IHJlc3BvbnNlLnVzZXJzWzBdO1xyXG4gICAgdXNlci5fbm90aWZ5UmVsb2FkTGlzdGVuZXIoY29yZUFjY291bnQpO1xyXG4gICAgY29uc3QgbmV3UHJvdmlkZXJEYXRhID0gKChfYSA9IGNvcmVBY2NvdW50LnByb3ZpZGVyVXNlckluZm8pID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5sZW5ndGgpXHJcbiAgICAgICAgPyBleHRyYWN0UHJvdmlkZXJEYXRhKGNvcmVBY2NvdW50LnByb3ZpZGVyVXNlckluZm8pXHJcbiAgICAgICAgOiBbXTtcclxuICAgIGNvbnN0IHByb3ZpZGVyRGF0YSA9IG1lcmdlUHJvdmlkZXJEYXRhKHVzZXIucHJvdmlkZXJEYXRhLCBuZXdQcm92aWRlckRhdGEpO1xyXG4gICAgLy8gUHJlc2VydmVzIHRoZSBub24tbm9ueW1vdXMgc3RhdHVzIG9mIHRoZSBzdG9yZWQgdXNlciwgZXZlbiBpZiBubyBtb3JlXHJcbiAgICAvLyBjcmVkZW50aWFscyAoZmVkZXJhdGVkIG9yIGVtYWlsL3Bhc3N3b3JkKSBhcmUgbGlua2VkIHRvIHRoZSB1c2VyLiBJZlxyXG4gICAgLy8gdGhlIHVzZXIgd2FzIHByZXZpb3VzbHkgYW5vbnltb3VzLCB0aGVuIHVzZSBwcm92aWRlciBkYXRhIHRvIHVwZGF0ZS5cclxuICAgIC8vIE9uIHRoZSBvdGhlciBoYW5kLCBpZiBpdCB3YXMgbm90IGFub255bW91cyBiZWZvcmUsIGl0IHNob3VsZCBuZXZlciBiZVxyXG4gICAgLy8gY29uc2lkZXJlZCBhbm9ueW1vdXMgbm93LlxyXG4gICAgY29uc3Qgb2xkSXNBbm9ueW1vdXMgPSB1c2VyLmlzQW5vbnltb3VzO1xyXG4gICAgY29uc3QgbmV3SXNBbm9ueW1vdXMgPSAhKHVzZXIuZW1haWwgJiYgY29yZUFjY291bnQucGFzc3dvcmRIYXNoKSAmJiAhKHByb3ZpZGVyRGF0YSA9PT0gbnVsbCB8fCBwcm92aWRlckRhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHByb3ZpZGVyRGF0YS5sZW5ndGgpO1xyXG4gICAgY29uc3QgaXNBbm9ueW1vdXMgPSAhb2xkSXNBbm9ueW1vdXMgPyBmYWxzZSA6IG5ld0lzQW5vbnltb3VzO1xyXG4gICAgY29uc3QgdXBkYXRlcyA9IHtcclxuICAgICAgICB1aWQ6IGNvcmVBY2NvdW50LmxvY2FsSWQsXHJcbiAgICAgICAgZGlzcGxheU5hbWU6IGNvcmVBY2NvdW50LmRpc3BsYXlOYW1lIHx8IG51bGwsXHJcbiAgICAgICAgcGhvdG9VUkw6IGNvcmVBY2NvdW50LnBob3RvVXJsIHx8IG51bGwsXHJcbiAgICAgICAgZW1haWw6IGNvcmVBY2NvdW50LmVtYWlsIHx8IG51bGwsXHJcbiAgICAgICAgZW1haWxWZXJpZmllZDogY29yZUFjY291bnQuZW1haWxWZXJpZmllZCB8fCBmYWxzZSxcclxuICAgICAgICBwaG9uZU51bWJlcjogY29yZUFjY291bnQucGhvbmVOdW1iZXIgfHwgbnVsbCxcclxuICAgICAgICB0ZW5hbnRJZDogY29yZUFjY291bnQudGVuYW50SWQgfHwgbnVsbCxcclxuICAgICAgICBwcm92aWRlckRhdGEsXHJcbiAgICAgICAgbWV0YWRhdGE6IG5ldyBVc2VyTWV0YWRhdGEoY29yZUFjY291bnQuY3JlYXRlZEF0LCBjb3JlQWNjb3VudC5sYXN0TG9naW5BdCksXHJcbiAgICAgICAgaXNBbm9ueW1vdXNcclxuICAgIH07XHJcbiAgICBPYmplY3QuYXNzaWduKHVzZXIsIHVwZGF0ZXMpO1xyXG59XHJcbi8qKlxyXG4gKiBSZWxvYWRzIHVzZXIgYWNjb3VudCBkYXRhLCBpZiBzaWduZWQgaW4uXHJcbiAqXHJcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIHJlbG9hZCh1c2VyKSB7XHJcbiAgICBjb25zdCB1c2VySW50ZXJuYWwgPSBnZXRNb2R1bGFySW5zdGFuY2UodXNlcik7XHJcbiAgICBhd2FpdCBfcmVsb2FkV2l0aG91dFNhdmluZyh1c2VySW50ZXJuYWwpO1xyXG4gICAgLy8gRXZlbiB0aG91Z2ggdGhlIGN1cnJlbnQgdXNlciBoYXNuJ3QgY2hhbmdlZCwgdXBkYXRlXHJcbiAgICAvLyBjdXJyZW50IHVzZXIgd2lsbCB0cmlnZ2VyIGEgcGVyc2lzdGVuY2UgdXBkYXRlIHcvIHRoZVxyXG4gICAgLy8gbmV3IGluZm8uXHJcbiAgICBhd2FpdCB1c2VySW50ZXJuYWwuYXV0aC5fcGVyc2lzdFVzZXJJZkN1cnJlbnQodXNlckludGVybmFsKTtcclxuICAgIHVzZXJJbnRlcm5hbC5hdXRoLl9ub3RpZnlMaXN0ZW5lcnNJZkN1cnJlbnQodXNlckludGVybmFsKTtcclxufVxyXG5mdW5jdGlvbiBtZXJnZVByb3ZpZGVyRGF0YShvcmlnaW5hbCwgbmV3RGF0YSkge1xyXG4gICAgY29uc3QgZGVkdXBlZCA9IG9yaWdpbmFsLmZpbHRlcihvID0+ICFuZXdEYXRhLnNvbWUobiA9PiBuLnByb3ZpZGVySWQgPT09IG8ucHJvdmlkZXJJZCkpO1xyXG4gICAgcmV0dXJuIFsuLi5kZWR1cGVkLCAuLi5uZXdEYXRhXTtcclxufVxyXG5mdW5jdGlvbiBleHRyYWN0UHJvdmlkZXJEYXRhKHByb3ZpZGVycykge1xyXG4gICAgcmV0dXJuIHByb3ZpZGVycy5tYXAoKF9hKSA9PiB7XHJcbiAgICAgICAgdmFyIHsgcHJvdmlkZXJJZCB9ID0gX2EsIHByb3ZpZGVyID0gX19yZXN0KF9hLCBbXCJwcm92aWRlcklkXCJdKTtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBwcm92aWRlcklkLFxyXG4gICAgICAgICAgICB1aWQ6IHByb3ZpZGVyLnJhd0lkIHx8ICcnLFxyXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogcHJvdmlkZXIuZGlzcGxheU5hbWUgfHwgbnVsbCxcclxuICAgICAgICAgICAgZW1haWw6IHByb3ZpZGVyLmVtYWlsIHx8IG51bGwsXHJcbiAgICAgICAgICAgIHBob25lTnVtYmVyOiBwcm92aWRlci5waG9uZU51bWJlciB8fCBudWxsLFxyXG4gICAgICAgICAgICBwaG90b1VSTDogcHJvdmlkZXIucGhvdG9VcmwgfHwgbnVsbFxyXG4gICAgICAgIH07XHJcbiAgICB9KTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiByZXF1ZXN0U3RzVG9rZW4oYXV0aCwgcmVmcmVzaFRva2VuKSB7XHJcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IF9wZXJmb3JtRmV0Y2hXaXRoRXJyb3JIYW5kbGluZyhhdXRoLCB7fSwgKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGJvZHkgPSBxdWVyeXN0cmluZyh7XHJcbiAgICAgICAgICAgICdncmFudF90eXBlJzogJ3JlZnJlc2hfdG9rZW4nLFxyXG4gICAgICAgICAgICAncmVmcmVzaF90b2tlbic6IHJlZnJlc2hUb2tlblxyXG4gICAgICAgIH0pLnNsaWNlKDEpO1xyXG4gICAgICAgIGNvbnN0IHsgdG9rZW5BcGlIb3N0LCBhcGlLZXkgfSA9IGF1dGguY29uZmlnO1xyXG4gICAgICAgIGNvbnN0IHVybCA9IF9nZXRGaW5hbFRhcmdldChhdXRoLCB0b2tlbkFwaUhvc3QsIFwiL3YxL3Rva2VuXCIgLyogVE9LRU4gKi8sIGBrZXk9JHthcGlLZXl9YCk7XHJcbiAgICAgICAgcmV0dXJuIEZldGNoUHJvdmlkZXIuZmV0Y2goKSh1cmwsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIiAvKiBQT1NUICovLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAnWC1DbGllbnQtVmVyc2lvbic6IGF1dGguX2dldFNka0NsaWVudFZlcnNpb24oKSxcclxuICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJ1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBib2R5XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuICAgIC8vIFRoZSByZXNwb25zZSBjb21lcyBiYWNrIGluIHNuYWtlX2Nhc2UuIENvbnZlcnQgdG8gY2FtZWw6XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGFjY2Vzc1Rva2VuOiByZXNwb25zZS5hY2Nlc3NfdG9rZW4sXHJcbiAgICAgICAgZXhwaXJlc0luOiByZXNwb25zZS5leHBpcmVzX2luLFxyXG4gICAgICAgIHJlZnJlc2hUb2tlbjogcmVzcG9uc2UucmVmcmVzaF90b2tlblxyXG4gICAgfTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogV2UgbmVlZCB0byBtYXJrIHRoaXMgY2xhc3MgYXMgaW50ZXJuYWwgZXhwbGljaXRseSB0byBleGNsdWRlIGl0IGluIHRoZSBwdWJsaWMgdHlwaW5ncywgYmVjYXVzZVxyXG4gKiBpdCByZWZlcmVuY2VzIEF1dGhJbnRlcm5hbCB3aGljaCBoYXMgYSBjaXJjdWxhciBkZXBlbmRlbmN5IHdpdGggVXNlckludGVybmFsLlxyXG4gKlxyXG4gKiBAaW50ZXJuYWxcclxuICovXHJcbmNsYXNzIFN0c1Rva2VuTWFuYWdlciB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLnJlZnJlc2hUb2tlbiA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5hY2Nlc3NUb2tlbiA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5leHBpcmF0aW9uVGltZSA9IG51bGw7XHJcbiAgICB9XHJcbiAgICBnZXQgaXNFeHBpcmVkKCkge1xyXG4gICAgICAgIHJldHVybiAoIXRoaXMuZXhwaXJhdGlvblRpbWUgfHxcclxuICAgICAgICAgICAgRGF0ZS5ub3coKSA+IHRoaXMuZXhwaXJhdGlvblRpbWUgLSAzMDAwMCAvKiBUT0tFTl9SRUZSRVNIICovKTtcclxuICAgIH1cclxuICAgIHVwZGF0ZUZyb21TZXJ2ZXJSZXNwb25zZShyZXNwb25zZSkge1xyXG4gICAgICAgIF9hc3NlcnQocmVzcG9uc2UuaWRUb2tlbiwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIElOVEVSTkFMX0VSUk9SICovKTtcclxuICAgICAgICBfYXNzZXJ0KHR5cGVvZiByZXNwb25zZS5pZFRva2VuICE9PSAndW5kZWZpbmVkJywgXCJpbnRlcm5hbC1lcnJvclwiIC8qIElOVEVSTkFMX0VSUk9SICovKTtcclxuICAgICAgICBfYXNzZXJ0KHR5cGVvZiByZXNwb25zZS5yZWZyZXNoVG9rZW4gIT09ICd1bmRlZmluZWQnLCBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8pO1xyXG4gICAgICAgIGNvbnN0IGV4cGlyZXNJbiA9ICdleHBpcmVzSW4nIGluIHJlc3BvbnNlICYmIHR5cGVvZiByZXNwb25zZS5leHBpcmVzSW4gIT09ICd1bmRlZmluZWQnXHJcbiAgICAgICAgICAgID8gTnVtYmVyKHJlc3BvbnNlLmV4cGlyZXNJbilcclxuICAgICAgICAgICAgOiBfdG9rZW5FeHBpcmVzSW4ocmVzcG9uc2UuaWRUb2tlbik7XHJcbiAgICAgICAgdGhpcy51cGRhdGVUb2tlbnNBbmRFeHBpcmF0aW9uKHJlc3BvbnNlLmlkVG9rZW4sIHJlc3BvbnNlLnJlZnJlc2hUb2tlbiwgZXhwaXJlc0luKTtcclxuICAgIH1cclxuICAgIGFzeW5jIGdldFRva2VuKGF1dGgsIGZvcmNlUmVmcmVzaCA9IGZhbHNlKSB7XHJcbiAgICAgICAgX2Fzc2VydCghdGhpcy5hY2Nlc3NUb2tlbiB8fCB0aGlzLnJlZnJlc2hUb2tlbiwgYXV0aCwgXCJ1c2VyLXRva2VuLWV4cGlyZWRcIiAvKiBUT0tFTl9FWFBJUkVEICovKTtcclxuICAgICAgICBpZiAoIWZvcmNlUmVmcmVzaCAmJiB0aGlzLmFjY2Vzc1Rva2VuICYmICF0aGlzLmlzRXhwaXJlZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hY2Nlc3NUb2tlbjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMucmVmcmVzaFRva2VuKSB7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucmVmcmVzaChhdXRoLCB0aGlzLnJlZnJlc2hUb2tlbik7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmFjY2Vzc1Rva2VuO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIGNsZWFyUmVmcmVzaFRva2VuKCkge1xyXG4gICAgICAgIHRoaXMucmVmcmVzaFRva2VuID0gbnVsbDtcclxuICAgIH1cclxuICAgIGFzeW5jIHJlZnJlc2goYXV0aCwgb2xkVG9rZW4pIHtcclxuICAgICAgICBjb25zdCB7IGFjY2Vzc1Rva2VuLCByZWZyZXNoVG9rZW4sIGV4cGlyZXNJbiB9ID0gYXdhaXQgcmVxdWVzdFN0c1Rva2VuKGF1dGgsIG9sZFRva2VuKTtcclxuICAgICAgICB0aGlzLnVwZGF0ZVRva2Vuc0FuZEV4cGlyYXRpb24oYWNjZXNzVG9rZW4sIHJlZnJlc2hUb2tlbiwgTnVtYmVyKGV4cGlyZXNJbikpO1xyXG4gICAgfVxyXG4gICAgdXBkYXRlVG9rZW5zQW5kRXhwaXJhdGlvbihhY2Nlc3NUb2tlbiwgcmVmcmVzaFRva2VuLCBleHBpcmVzSW5TZWMpIHtcclxuICAgICAgICB0aGlzLnJlZnJlc2hUb2tlbiA9IHJlZnJlc2hUb2tlbiB8fCBudWxsO1xyXG4gICAgICAgIHRoaXMuYWNjZXNzVG9rZW4gPSBhY2Nlc3NUb2tlbiB8fCBudWxsO1xyXG4gICAgICAgIHRoaXMuZXhwaXJhdGlvblRpbWUgPSBEYXRlLm5vdygpICsgZXhwaXJlc0luU2VjICogMTAwMDtcclxuICAgIH1cclxuICAgIHN0YXRpYyBmcm9tSlNPTihhcHBOYW1lLCBvYmplY3QpIHtcclxuICAgICAgICBjb25zdCB7IHJlZnJlc2hUb2tlbiwgYWNjZXNzVG9rZW4sIGV4cGlyYXRpb25UaW1lIH0gPSBvYmplY3Q7XHJcbiAgICAgICAgY29uc3QgbWFuYWdlciA9IG5ldyBTdHNUb2tlbk1hbmFnZXIoKTtcclxuICAgICAgICBpZiAocmVmcmVzaFRva2VuKSB7XHJcbiAgICAgICAgICAgIF9hc3NlcnQodHlwZW9mIHJlZnJlc2hUb2tlbiA9PT0gJ3N0cmluZycsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLywge1xyXG4gICAgICAgICAgICAgICAgYXBwTmFtZVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgbWFuYWdlci5yZWZyZXNoVG9rZW4gPSByZWZyZXNoVG9rZW47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChhY2Nlc3NUb2tlbikge1xyXG4gICAgICAgICAgICBfYXNzZXJ0KHR5cGVvZiBhY2Nlc3NUb2tlbiA9PT0gJ3N0cmluZycsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLywge1xyXG4gICAgICAgICAgICAgICAgYXBwTmFtZVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgbWFuYWdlci5hY2Nlc3NUb2tlbiA9IGFjY2Vzc1Rva2VuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZXhwaXJhdGlvblRpbWUpIHtcclxuICAgICAgICAgICAgX2Fzc2VydCh0eXBlb2YgZXhwaXJhdGlvblRpbWUgPT09ICdudW1iZXInLCBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8sIHtcclxuICAgICAgICAgICAgICAgIGFwcE5hbWVcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIG1hbmFnZXIuZXhwaXJhdGlvblRpbWUgPSBleHBpcmF0aW9uVGltZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG1hbmFnZXI7XHJcbiAgICB9XHJcbiAgICB0b0pTT04oKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcmVmcmVzaFRva2VuOiB0aGlzLnJlZnJlc2hUb2tlbixcclxuICAgICAgICAgICAgYWNjZXNzVG9rZW46IHRoaXMuYWNjZXNzVG9rZW4sXHJcbiAgICAgICAgICAgIGV4cGlyYXRpb25UaW1lOiB0aGlzLmV4cGlyYXRpb25UaW1lXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuICAgIF9hc3NpZ24oc3RzVG9rZW5NYW5hZ2VyKSB7XHJcbiAgICAgICAgdGhpcy5hY2Nlc3NUb2tlbiA9IHN0c1Rva2VuTWFuYWdlci5hY2Nlc3NUb2tlbjtcclxuICAgICAgICB0aGlzLnJlZnJlc2hUb2tlbiA9IHN0c1Rva2VuTWFuYWdlci5yZWZyZXNoVG9rZW47XHJcbiAgICAgICAgdGhpcy5leHBpcmF0aW9uVGltZSA9IHN0c1Rva2VuTWFuYWdlci5leHBpcmF0aW9uVGltZTtcclxuICAgIH1cclxuICAgIF9jbG9uZSgpIHtcclxuICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihuZXcgU3RzVG9rZW5NYW5hZ2VyKCksIHRoaXMudG9KU09OKCkpO1xyXG4gICAgfVxyXG4gICAgX3BlcmZvcm1SZWZyZXNoKCkge1xyXG4gICAgICAgIHJldHVybiBkZWJ1Z0ZhaWwoJ25vdCBpbXBsZW1lbnRlZCcpO1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmZ1bmN0aW9uIGFzc2VydFN0cmluZ09yVW5kZWZpbmVkKGFzc2VydGlvbiwgYXBwTmFtZSkge1xyXG4gICAgX2Fzc2VydCh0eXBlb2YgYXNzZXJ0aW9uID09PSAnc3RyaW5nJyB8fCB0eXBlb2YgYXNzZXJ0aW9uID09PSAndW5kZWZpbmVkJywgXCJpbnRlcm5hbC1lcnJvclwiIC8qIElOVEVSTkFMX0VSUk9SICovLCB7IGFwcE5hbWUgfSk7XHJcbn1cclxuY2xhc3MgVXNlckltcGwge1xyXG4gICAgY29uc3RydWN0b3IoX2EpIHtcclxuICAgICAgICB2YXIgeyB1aWQsIGF1dGgsIHN0c1Rva2VuTWFuYWdlciB9ID0gX2EsIG9wdCA9IF9fcmVzdChfYSwgW1widWlkXCIsIFwiYXV0aFwiLCBcInN0c1Rva2VuTWFuYWdlclwiXSk7XHJcbiAgICAgICAgLy8gRm9yIHRoZSB1c2VyIG9iamVjdCwgcHJvdmlkZXIgaXMgYWx3YXlzIEZpcmViYXNlLlxyXG4gICAgICAgIHRoaXMucHJvdmlkZXJJZCA9IFwiZmlyZWJhc2VcIiAvKiBGSVJFQkFTRSAqLztcclxuICAgICAgICB0aGlzLmVtYWlsVmVyaWZpZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmlzQW5vbnltb3VzID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy50ZW5hbnRJZCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5wcm92aWRlckRhdGEgPSBbXTtcclxuICAgICAgICB0aGlzLnByb2FjdGl2ZVJlZnJlc2ggPSBuZXcgUHJvYWN0aXZlUmVmcmVzaCh0aGlzKTtcclxuICAgICAgICB0aGlzLnJlbG9hZFVzZXJJbmZvID0gbnVsbDtcclxuICAgICAgICB0aGlzLnJlbG9hZExpc3RlbmVyID0gbnVsbDtcclxuICAgICAgICB0aGlzLnVpZCA9IHVpZDtcclxuICAgICAgICB0aGlzLmF1dGggPSBhdXRoO1xyXG4gICAgICAgIHRoaXMuc3RzVG9rZW5NYW5hZ2VyID0gc3RzVG9rZW5NYW5hZ2VyO1xyXG4gICAgICAgIHRoaXMuYWNjZXNzVG9rZW4gPSBzdHNUb2tlbk1hbmFnZXIuYWNjZXNzVG9rZW47XHJcbiAgICAgICAgdGhpcy5kaXNwbGF5TmFtZSA9IG9wdC5kaXNwbGF5TmFtZSB8fCBudWxsO1xyXG4gICAgICAgIHRoaXMuZW1haWwgPSBvcHQuZW1haWwgfHwgbnVsbDtcclxuICAgICAgICB0aGlzLnBob25lTnVtYmVyID0gb3B0LnBob25lTnVtYmVyIHx8IG51bGw7XHJcbiAgICAgICAgdGhpcy5waG90b1VSTCA9IG9wdC5waG90b1VSTCB8fCBudWxsO1xyXG4gICAgICAgIHRoaXMuaXNBbm9ueW1vdXMgPSBvcHQuaXNBbm9ueW1vdXMgfHwgZmFsc2U7XHJcbiAgICAgICAgdGhpcy5tZXRhZGF0YSA9IG5ldyBVc2VyTWV0YWRhdGEob3B0LmNyZWF0ZWRBdCB8fCB1bmRlZmluZWQsIG9wdC5sYXN0TG9naW5BdCB8fCB1bmRlZmluZWQpO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgZ2V0SWRUb2tlbihmb3JjZVJlZnJlc2gpIHtcclxuICAgICAgICBjb25zdCBhY2Nlc3NUb2tlbiA9IGF3YWl0IF9sb2dvdXRJZkludmFsaWRhdGVkKHRoaXMsIHRoaXMuc3RzVG9rZW5NYW5hZ2VyLmdldFRva2VuKHRoaXMuYXV0aCwgZm9yY2VSZWZyZXNoKSk7XHJcbiAgICAgICAgX2Fzc2VydChhY2Nlc3NUb2tlbiwgdGhpcy5hdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8pO1xyXG4gICAgICAgIGlmICh0aGlzLmFjY2Vzc1Rva2VuICE9PSBhY2Nlc3NUb2tlbikge1xyXG4gICAgICAgICAgICB0aGlzLmFjY2Vzc1Rva2VuID0gYWNjZXNzVG9rZW47XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYXV0aC5fcGVyc2lzdFVzZXJJZkN1cnJlbnQodGhpcyk7XHJcbiAgICAgICAgICAgIHRoaXMuYXV0aC5fbm90aWZ5TGlzdGVuZXJzSWZDdXJyZW50KHRoaXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYWNjZXNzVG9rZW47XHJcbiAgICB9XHJcbiAgICBnZXRJZFRva2VuUmVzdWx0KGZvcmNlUmVmcmVzaCkge1xyXG4gICAgICAgIHJldHVybiBnZXRJZFRva2VuUmVzdWx0KHRoaXMsIGZvcmNlUmVmcmVzaCk7XHJcbiAgICB9XHJcbiAgICByZWxvYWQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlbG9hZCh0aGlzKTtcclxuICAgIH1cclxuICAgIF9hc3NpZ24odXNlcikge1xyXG4gICAgICAgIGlmICh0aGlzID09PSB1c2VyKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgX2Fzc2VydCh0aGlzLnVpZCA9PT0gdXNlci51aWQsIHRoaXMuYXV0aCwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIElOVEVSTkFMX0VSUk9SICovKTtcclxuICAgICAgICB0aGlzLmRpc3BsYXlOYW1lID0gdXNlci5kaXNwbGF5TmFtZTtcclxuICAgICAgICB0aGlzLnBob3RvVVJMID0gdXNlci5waG90b1VSTDtcclxuICAgICAgICB0aGlzLmVtYWlsID0gdXNlci5lbWFpbDtcclxuICAgICAgICB0aGlzLmVtYWlsVmVyaWZpZWQgPSB1c2VyLmVtYWlsVmVyaWZpZWQ7XHJcbiAgICAgICAgdGhpcy5waG9uZU51bWJlciA9IHVzZXIucGhvbmVOdW1iZXI7XHJcbiAgICAgICAgdGhpcy5pc0Fub255bW91cyA9IHVzZXIuaXNBbm9ueW1vdXM7XHJcbiAgICAgICAgdGhpcy50ZW5hbnRJZCA9IHVzZXIudGVuYW50SWQ7XHJcbiAgICAgICAgdGhpcy5wcm92aWRlckRhdGEgPSB1c2VyLnByb3ZpZGVyRGF0YS5tYXAodXNlckluZm8gPT4gKE9iamVjdC5hc3NpZ24oe30sIHVzZXJJbmZvKSkpO1xyXG4gICAgICAgIHRoaXMubWV0YWRhdGEuX2NvcHkodXNlci5tZXRhZGF0YSk7XHJcbiAgICAgICAgdGhpcy5zdHNUb2tlbk1hbmFnZXIuX2Fzc2lnbih1c2VyLnN0c1Rva2VuTWFuYWdlcik7XHJcbiAgICB9XHJcbiAgICBfY2xvbmUoYXV0aCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgVXNlckltcGwoT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCB0aGlzKSwgeyBhdXRoLCBzdHNUb2tlbk1hbmFnZXI6IHRoaXMuc3RzVG9rZW5NYW5hZ2VyLl9jbG9uZSgpIH0pKTtcclxuICAgIH1cclxuICAgIF9vblJlbG9hZChjYWxsYmFjaykge1xyXG4gICAgICAgIC8vIFRoZXJlIHNob3VsZCBvbmx5IGV2ZXIgYmUgb25lIGxpc3RlbmVyLCBhbmQgdGhhdCBpcyBhIHNpbmdsZSBpbnN0YW5jZSBvZiBNdWx0aUZhY3RvclVzZXJcclxuICAgICAgICBfYXNzZXJ0KCF0aGlzLnJlbG9hZExpc3RlbmVyLCB0aGlzLmF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyk7XHJcbiAgICAgICAgdGhpcy5yZWxvYWRMaXN0ZW5lciA9IGNhbGxiYWNrO1xyXG4gICAgICAgIGlmICh0aGlzLnJlbG9hZFVzZXJJbmZvKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX25vdGlmeVJlbG9hZExpc3RlbmVyKHRoaXMucmVsb2FkVXNlckluZm8pO1xyXG4gICAgICAgICAgICB0aGlzLnJlbG9hZFVzZXJJbmZvID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBfbm90aWZ5UmVsb2FkTGlzdGVuZXIodXNlckluZm8pIHtcclxuICAgICAgICBpZiAodGhpcy5yZWxvYWRMaXN0ZW5lcikge1xyXG4gICAgICAgICAgICB0aGlzLnJlbG9hZExpc3RlbmVyKHVzZXJJbmZvKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIElmIG5vIGxpc3RlbmVyIGlzIHN1YnNjcmliZWQgeWV0LCBzYXZlIHRoZSByZXN1bHQgc28gaXQncyBhdmFpbGFibGUgd2hlbiB0aGV5IGRvIHN1YnNjcmliZVxyXG4gICAgICAgICAgICB0aGlzLnJlbG9hZFVzZXJJbmZvID0gdXNlckluZm87XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgX3N0YXJ0UHJvYWN0aXZlUmVmcmVzaCgpIHtcclxuICAgICAgICB0aGlzLnByb2FjdGl2ZVJlZnJlc2guX3N0YXJ0KCk7XHJcbiAgICB9XHJcbiAgICBfc3RvcFByb2FjdGl2ZVJlZnJlc2goKSB7XHJcbiAgICAgICAgdGhpcy5wcm9hY3RpdmVSZWZyZXNoLl9zdG9wKCk7XHJcbiAgICB9XHJcbiAgICBhc3luYyBfdXBkYXRlVG9rZW5zSWZOZWNlc3NhcnkocmVzcG9uc2UsIHJlbG9hZCA9IGZhbHNlKSB7XHJcbiAgICAgICAgbGV0IHRva2Vuc1JlZnJlc2hlZCA9IGZhbHNlO1xyXG4gICAgICAgIGlmIChyZXNwb25zZS5pZFRva2VuICYmXHJcbiAgICAgICAgICAgIHJlc3BvbnNlLmlkVG9rZW4gIT09IHRoaXMuc3RzVG9rZW5NYW5hZ2VyLmFjY2Vzc1Rva2VuKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3RzVG9rZW5NYW5hZ2VyLnVwZGF0ZUZyb21TZXJ2ZXJSZXNwb25zZShyZXNwb25zZSk7XHJcbiAgICAgICAgICAgIHRva2Vuc1JlZnJlc2hlZCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChyZWxvYWQpIHtcclxuICAgICAgICAgICAgYXdhaXQgX3JlbG9hZFdpdGhvdXRTYXZpbmcodGhpcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGF3YWl0IHRoaXMuYXV0aC5fcGVyc2lzdFVzZXJJZkN1cnJlbnQodGhpcyk7XHJcbiAgICAgICAgaWYgKHRva2Vuc1JlZnJlc2hlZCkge1xyXG4gICAgICAgICAgICB0aGlzLmF1dGguX25vdGlmeUxpc3RlbmVyc0lmQ3VycmVudCh0aGlzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBhc3luYyBkZWxldGUoKSB7XHJcbiAgICAgICAgY29uc3QgaWRUb2tlbiA9IGF3YWl0IHRoaXMuZ2V0SWRUb2tlbigpO1xyXG4gICAgICAgIGF3YWl0IF9sb2dvdXRJZkludmFsaWRhdGVkKHRoaXMsIGRlbGV0ZUFjY291bnQodGhpcy5hdXRoLCB7IGlkVG9rZW4gfSkpO1xyXG4gICAgICAgIHRoaXMuc3RzVG9rZW5NYW5hZ2VyLmNsZWFyUmVmcmVzaFRva2VuKCk7XHJcbiAgICAgICAgLy8gVE9ETzogRGV0ZXJtaW5lIGlmIGNhbmNlbGxhYmxlLXByb21pc2VzIGFyZSBuZWNlc3NhcnkgdG8gdXNlIGluIHRoaXMgY2xhc3Mgc28gdGhhdCBkZWxldGUoKVxyXG4gICAgICAgIC8vICAgICAgIGNhbmNlbHMgcGVuZGluZyBhY3Rpb25zLi4uXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYXV0aC5zaWduT3V0KCk7XHJcbiAgICB9XHJcbiAgICB0b0pTT04oKSB7XHJcbiAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7IHVpZDogdGhpcy51aWQsIGVtYWlsOiB0aGlzLmVtYWlsIHx8IHVuZGVmaW5lZCwgZW1haWxWZXJpZmllZDogdGhpcy5lbWFpbFZlcmlmaWVkLCBkaXNwbGF5TmFtZTogdGhpcy5kaXNwbGF5TmFtZSB8fCB1bmRlZmluZWQsIGlzQW5vbnltb3VzOiB0aGlzLmlzQW5vbnltb3VzLCBwaG90b1VSTDogdGhpcy5waG90b1VSTCB8fCB1bmRlZmluZWQsIHBob25lTnVtYmVyOiB0aGlzLnBob25lTnVtYmVyIHx8IHVuZGVmaW5lZCwgdGVuYW50SWQ6IHRoaXMudGVuYW50SWQgfHwgdW5kZWZpbmVkLCBwcm92aWRlckRhdGE6IHRoaXMucHJvdmlkZXJEYXRhLm1hcCh1c2VySW5mbyA9PiAoT2JqZWN0LmFzc2lnbih7fSwgdXNlckluZm8pKSksIHN0c1Rva2VuTWFuYWdlcjogdGhpcy5zdHNUb2tlbk1hbmFnZXIudG9KU09OKCksIFxyXG4gICAgICAgICAgICAvLyBSZWRpcmVjdCBldmVudCBJRCBtdXN0IGJlIG1haW50YWluZWQgaW4gY2FzZSB0aGVyZSBpcyBhIHBlbmRpbmdcclxuICAgICAgICAgICAgLy8gcmVkaXJlY3QgZXZlbnQuXHJcbiAgICAgICAgICAgIF9yZWRpcmVjdEV2ZW50SWQ6IHRoaXMuX3JlZGlyZWN0RXZlbnRJZCB9LCB0aGlzLm1ldGFkYXRhLnRvSlNPTigpKSwgeyBcclxuICAgICAgICAgICAgLy8gUmVxdWlyZWQgZm9yIGNvbXBhdGliaWxpdHkgd2l0aCB0aGUgbGVnYWN5IFNESyAoZ28vZmlyZWJhc2UtYXV0aC1zZGstcGVyc2lzdGVuY2UtcGFyc2luZyk6XHJcbiAgICAgICAgICAgIGFwaUtleTogdGhpcy5hdXRoLmNvbmZpZy5hcGlLZXksIGFwcE5hbWU6IHRoaXMuYXV0aC5uYW1lIH0pO1xyXG4gICAgfVxyXG4gICAgZ2V0IHJlZnJlc2hUb2tlbigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zdHNUb2tlbk1hbmFnZXIucmVmcmVzaFRva2VuIHx8ICcnO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIF9mcm9tSlNPTihhdXRoLCBvYmplY3QpIHtcclxuICAgICAgICB2YXIgX2EsIF9iLCBfYywgX2QsIF9lLCBfZiwgX2csIF9oO1xyXG4gICAgICAgIGNvbnN0IGRpc3BsYXlOYW1lID0gKF9hID0gb2JqZWN0LmRpc3BsYXlOYW1lKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiB1bmRlZmluZWQ7XHJcbiAgICAgICAgY29uc3QgZW1haWwgPSAoX2IgPSBvYmplY3QuZW1haWwpICE9PSBudWxsICYmIF9iICE9PSB2b2lkIDAgPyBfYiA6IHVuZGVmaW5lZDtcclxuICAgICAgICBjb25zdCBwaG9uZU51bWJlciA9IChfYyA9IG9iamVjdC5waG9uZU51bWJlcikgIT09IG51bGwgJiYgX2MgIT09IHZvaWQgMCA/IF9jIDogdW5kZWZpbmVkO1xyXG4gICAgICAgIGNvbnN0IHBob3RvVVJMID0gKF9kID0gb2JqZWN0LnBob3RvVVJMKSAhPT0gbnVsbCAmJiBfZCAhPT0gdm9pZCAwID8gX2QgOiB1bmRlZmluZWQ7XHJcbiAgICAgICAgY29uc3QgdGVuYW50SWQgPSAoX2UgPSBvYmplY3QudGVuYW50SWQpICE9PSBudWxsICYmIF9lICE9PSB2b2lkIDAgPyBfZSA6IHVuZGVmaW5lZDtcclxuICAgICAgICBjb25zdCBfcmVkaXJlY3RFdmVudElkID0gKF9mID0gb2JqZWN0Ll9yZWRpcmVjdEV2ZW50SWQpICE9PSBudWxsICYmIF9mICE9PSB2b2lkIDAgPyBfZiA6IHVuZGVmaW5lZDtcclxuICAgICAgICBjb25zdCBjcmVhdGVkQXQgPSAoX2cgPSBvYmplY3QuY3JlYXRlZEF0KSAhPT0gbnVsbCAmJiBfZyAhPT0gdm9pZCAwID8gX2cgOiB1bmRlZmluZWQ7XHJcbiAgICAgICAgY29uc3QgbGFzdExvZ2luQXQgPSAoX2ggPSBvYmplY3QubGFzdExvZ2luQXQpICE9PSBudWxsICYmIF9oICE9PSB2b2lkIDAgPyBfaCA6IHVuZGVmaW5lZDtcclxuICAgICAgICBjb25zdCB7IHVpZCwgZW1haWxWZXJpZmllZCwgaXNBbm9ueW1vdXMsIHByb3ZpZGVyRGF0YSwgc3RzVG9rZW5NYW5hZ2VyOiBwbGFpbk9iamVjdFRva2VuTWFuYWdlciB9ID0gb2JqZWN0O1xyXG4gICAgICAgIF9hc3NlcnQodWlkICYmIHBsYWluT2JqZWN0VG9rZW5NYW5hZ2VyLCBhdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8pO1xyXG4gICAgICAgIGNvbnN0IHN0c1Rva2VuTWFuYWdlciA9IFN0c1Rva2VuTWFuYWdlci5mcm9tSlNPTih0aGlzLm5hbWUsIHBsYWluT2JqZWN0VG9rZW5NYW5hZ2VyKTtcclxuICAgICAgICBfYXNzZXJ0KHR5cGVvZiB1aWQgPT09ICdzdHJpbmcnLCBhdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8pO1xyXG4gICAgICAgIGFzc2VydFN0cmluZ09yVW5kZWZpbmVkKGRpc3BsYXlOYW1lLCBhdXRoLm5hbWUpO1xyXG4gICAgICAgIGFzc2VydFN0cmluZ09yVW5kZWZpbmVkKGVtYWlsLCBhdXRoLm5hbWUpO1xyXG4gICAgICAgIF9hc3NlcnQodHlwZW9mIGVtYWlsVmVyaWZpZWQgPT09ICdib29sZWFuJywgYXV0aCwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIElOVEVSTkFMX0VSUk9SICovKTtcclxuICAgICAgICBfYXNzZXJ0KHR5cGVvZiBpc0Fub255bW91cyA9PT0gJ2Jvb2xlYW4nLCBhdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8pO1xyXG4gICAgICAgIGFzc2VydFN0cmluZ09yVW5kZWZpbmVkKHBob25lTnVtYmVyLCBhdXRoLm5hbWUpO1xyXG4gICAgICAgIGFzc2VydFN0cmluZ09yVW5kZWZpbmVkKHBob3RvVVJMLCBhdXRoLm5hbWUpO1xyXG4gICAgICAgIGFzc2VydFN0cmluZ09yVW5kZWZpbmVkKHRlbmFudElkLCBhdXRoLm5hbWUpO1xyXG4gICAgICAgIGFzc2VydFN0cmluZ09yVW5kZWZpbmVkKF9yZWRpcmVjdEV2ZW50SWQsIGF1dGgubmFtZSk7XHJcbiAgICAgICAgYXNzZXJ0U3RyaW5nT3JVbmRlZmluZWQoY3JlYXRlZEF0LCBhdXRoLm5hbWUpO1xyXG4gICAgICAgIGFzc2VydFN0cmluZ09yVW5kZWZpbmVkKGxhc3RMb2dpbkF0LCBhdXRoLm5hbWUpO1xyXG4gICAgICAgIGNvbnN0IHVzZXIgPSBuZXcgVXNlckltcGwoe1xyXG4gICAgICAgICAgICB1aWQsXHJcbiAgICAgICAgICAgIGF1dGgsXHJcbiAgICAgICAgICAgIGVtYWlsLFxyXG4gICAgICAgICAgICBlbWFpbFZlcmlmaWVkLFxyXG4gICAgICAgICAgICBkaXNwbGF5TmFtZSxcclxuICAgICAgICAgICAgaXNBbm9ueW1vdXMsXHJcbiAgICAgICAgICAgIHBob3RvVVJMLFxyXG4gICAgICAgICAgICBwaG9uZU51bWJlcixcclxuICAgICAgICAgICAgdGVuYW50SWQsXHJcbiAgICAgICAgICAgIHN0c1Rva2VuTWFuYWdlcixcclxuICAgICAgICAgICAgY3JlYXRlZEF0LFxyXG4gICAgICAgICAgICBsYXN0TG9naW5BdFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmIChwcm92aWRlckRhdGEgJiYgQXJyYXkuaXNBcnJheShwcm92aWRlckRhdGEpKSB7XHJcbiAgICAgICAgICAgIHVzZXIucHJvdmlkZXJEYXRhID0gcHJvdmlkZXJEYXRhLm1hcCh1c2VySW5mbyA9PiAoT2JqZWN0LmFzc2lnbih7fSwgdXNlckluZm8pKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChfcmVkaXJlY3RFdmVudElkKSB7XHJcbiAgICAgICAgICAgIHVzZXIuX3JlZGlyZWN0RXZlbnRJZCA9IF9yZWRpcmVjdEV2ZW50SWQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB1c2VyO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBJbml0aWFsaXplIGEgVXNlciBmcm9tIGFuIGlkVG9rZW4gc2VydmVyIHJlc3BvbnNlXHJcbiAgICAgKiBAcGFyYW0gYXV0aFxyXG4gICAgICogQHBhcmFtIGlkVG9rZW5SZXNwb25zZVxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgYXN5bmMgX2Zyb21JZFRva2VuUmVzcG9uc2UoYXV0aCwgaWRUb2tlblJlc3BvbnNlLCBpc0Fub255bW91cyA9IGZhbHNlKSB7XHJcbiAgICAgICAgY29uc3Qgc3RzVG9rZW5NYW5hZ2VyID0gbmV3IFN0c1Rva2VuTWFuYWdlcigpO1xyXG4gICAgICAgIHN0c1Rva2VuTWFuYWdlci51cGRhdGVGcm9tU2VydmVyUmVzcG9uc2UoaWRUb2tlblJlc3BvbnNlKTtcclxuICAgICAgICAvLyBJbml0aWFsaXplIHRoZSBGaXJlYmFzZSBBdXRoIHVzZXIuXHJcbiAgICAgICAgY29uc3QgdXNlciA9IG5ldyBVc2VySW1wbCh7XHJcbiAgICAgICAgICAgIHVpZDogaWRUb2tlblJlc3BvbnNlLmxvY2FsSWQsXHJcbiAgICAgICAgICAgIGF1dGgsXHJcbiAgICAgICAgICAgIHN0c1Rva2VuTWFuYWdlcixcclxuICAgICAgICAgICAgaXNBbm9ueW1vdXNcclxuICAgICAgICB9KTtcclxuICAgICAgICAvLyBVcGRhdGVzIHRoZSB1c2VyIGluZm8gYW5kIGRhdGEgYW5kIHJlc29sdmVzIHdpdGggYSB1c2VyIGluc3RhbmNlLlxyXG4gICAgICAgIGF3YWl0IF9yZWxvYWRXaXRob3V0U2F2aW5nKHVzZXIpO1xyXG4gICAgICAgIHJldHVybiB1c2VyO1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmNsYXNzIEluTWVtb3J5UGVyc2lzdGVuY2Uge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgdGhpcy50eXBlID0gXCJOT05FXCIgLyogTk9ORSAqLztcclxuICAgICAgICB0aGlzLnN0b3JhZ2UgPSB7fTtcclxuICAgIH1cclxuICAgIGFzeW5jIF9pc0F2YWlsYWJsZSgpIHtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuICAgIGFzeW5jIF9zZXQoa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgIHRoaXMuc3RvcmFnZVtrZXldID0gdmFsdWU7XHJcbiAgICB9XHJcbiAgICBhc3luYyBfZ2V0KGtleSkge1xyXG4gICAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy5zdG9yYWdlW2tleV07XHJcbiAgICAgICAgcmV0dXJuIHZhbHVlID09PSB1bmRlZmluZWQgPyBudWxsIDogdmFsdWU7XHJcbiAgICB9XHJcbiAgICBhc3luYyBfcmVtb3ZlKGtleSkge1xyXG4gICAgICAgIGRlbGV0ZSB0aGlzLnN0b3JhZ2Vba2V5XTtcclxuICAgIH1cclxuICAgIF9hZGRMaXN0ZW5lcihfa2V5LCBfbGlzdGVuZXIpIHtcclxuICAgICAgICAvLyBMaXN0ZW5lcnMgYXJlIG5vdCBzdXBwb3J0ZWQgZm9yIGluLW1lbW9yeSBzdG9yYWdlIHNpbmNlIGl0IGNhbm5vdCBiZSBzaGFyZWQgYWNyb3NzIHdpbmRvd3Mvd29ya2Vyc1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIF9yZW1vdmVMaXN0ZW5lcihfa2V5LCBfbGlzdGVuZXIpIHtcclxuICAgICAgICAvLyBMaXN0ZW5lcnMgYXJlIG5vdCBzdXBwb3J0ZWQgZm9yIGluLW1lbW9yeSBzdG9yYWdlIHNpbmNlIGl0IGNhbm5vdCBiZSBzaGFyZWQgYWNyb3NzIHdpbmRvd3Mvd29ya2Vyc1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxufVxyXG5Jbk1lbW9yeVBlcnNpc3RlbmNlLnR5cGUgPSAnTk9ORSc7XHJcbi8qKlxyXG4gKiBBbiBpbXBsZW1lbnRhdGlvbiBvZiB7QGxpbmsgUGVyc2lzdGVuY2V9IG9mIHR5cGUgJ05PTkUnLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5jb25zdCBpbk1lbW9yeVBlcnNpc3RlbmNlID0gSW5NZW1vcnlQZXJzaXN0ZW5jZTtcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuZnVuY3Rpb24gX3BlcnNpc3RlbmNlS2V5TmFtZShrZXksIGFwaUtleSwgYXBwTmFtZSkge1xyXG4gICAgcmV0dXJuIGAke1wiZmlyZWJhc2VcIiAvKiBQRVJTSVNURU5DRSAqL306JHtrZXl9OiR7YXBpS2V5fToke2FwcE5hbWV9YDtcclxufVxyXG5jbGFzcyBQZXJzaXN0ZW5jZVVzZXJNYW5hZ2VyIHtcclxuICAgIGNvbnN0cnVjdG9yKHBlcnNpc3RlbmNlLCBhdXRoLCB1c2VyS2V5KSB7XHJcbiAgICAgICAgdGhpcy5wZXJzaXN0ZW5jZSA9IHBlcnNpc3RlbmNlO1xyXG4gICAgICAgIHRoaXMuYXV0aCA9IGF1dGg7XHJcbiAgICAgICAgdGhpcy51c2VyS2V5ID0gdXNlcktleTtcclxuICAgICAgICBjb25zdCB7IGNvbmZpZywgbmFtZSB9ID0gdGhpcy5hdXRoO1xyXG4gICAgICAgIHRoaXMuZnVsbFVzZXJLZXkgPSBfcGVyc2lzdGVuY2VLZXlOYW1lKHRoaXMudXNlcktleSwgY29uZmlnLmFwaUtleSwgbmFtZSk7XHJcbiAgICAgICAgdGhpcy5mdWxsUGVyc2lzdGVuY2VLZXkgPSBfcGVyc2lzdGVuY2VLZXlOYW1lKFwicGVyc2lzdGVuY2VcIiAvKiBQRVJTSVNURU5DRV9VU0VSICovLCBjb25maWcuYXBpS2V5LCBuYW1lKTtcclxuICAgICAgICB0aGlzLmJvdW5kRXZlbnRIYW5kbGVyID0gYXV0aC5fb25TdG9yYWdlRXZlbnQuYmluZChhdXRoKTtcclxuICAgICAgICB0aGlzLnBlcnNpc3RlbmNlLl9hZGRMaXN0ZW5lcih0aGlzLmZ1bGxVc2VyS2V5LCB0aGlzLmJvdW5kRXZlbnRIYW5kbGVyKTtcclxuICAgIH1cclxuICAgIHNldEN1cnJlbnRVc2VyKHVzZXIpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW5jZS5fc2V0KHRoaXMuZnVsbFVzZXJLZXksIHVzZXIudG9KU09OKCkpO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgZ2V0Q3VycmVudFVzZXIoKSB7XHJcbiAgICAgICAgY29uc3QgYmxvYiA9IGF3YWl0IHRoaXMucGVyc2lzdGVuY2UuX2dldCh0aGlzLmZ1bGxVc2VyS2V5KTtcclxuICAgICAgICByZXR1cm4gYmxvYiA/IFVzZXJJbXBsLl9mcm9tSlNPTih0aGlzLmF1dGgsIGJsb2IpIDogbnVsbDtcclxuICAgIH1cclxuICAgIHJlbW92ZUN1cnJlbnRVc2VyKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlLl9yZW1vdmUodGhpcy5mdWxsVXNlcktleSk7XHJcbiAgICB9XHJcbiAgICBzYXZlUGVyc2lzdGVuY2VGb3JSZWRpcmVjdCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW5jZS5fc2V0KHRoaXMuZnVsbFBlcnNpc3RlbmNlS2V5LCB0aGlzLnBlcnNpc3RlbmNlLnR5cGUpO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgc2V0UGVyc2lzdGVuY2UobmV3UGVyc2lzdGVuY2UpIHtcclxuICAgICAgICBpZiAodGhpcy5wZXJzaXN0ZW5jZSA9PT0gbmV3UGVyc2lzdGVuY2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBjdXJyZW50VXNlciA9IGF3YWl0IHRoaXMuZ2V0Q3VycmVudFVzZXIoKTtcclxuICAgICAgICBhd2FpdCB0aGlzLnJlbW92ZUN1cnJlbnRVc2VyKCk7XHJcbiAgICAgICAgdGhpcy5wZXJzaXN0ZW5jZSA9IG5ld1BlcnNpc3RlbmNlO1xyXG4gICAgICAgIGlmIChjdXJyZW50VXNlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zZXRDdXJyZW50VXNlcihjdXJyZW50VXNlcik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZGVsZXRlKCkge1xyXG4gICAgICAgIHRoaXMucGVyc2lzdGVuY2UuX3JlbW92ZUxpc3RlbmVyKHRoaXMuZnVsbFVzZXJLZXksIHRoaXMuYm91bmRFdmVudEhhbmRsZXIpO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIGFzeW5jIGNyZWF0ZShhdXRoLCBwZXJzaXN0ZW5jZUhpZXJhcmNoeSwgdXNlcktleSA9IFwiYXV0aFVzZXJcIiAvKiBBVVRIX1VTRVIgKi8pIHtcclxuICAgICAgICBpZiAoIXBlcnNpc3RlbmNlSGllcmFyY2h5Lmxlbmd0aCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFBlcnNpc3RlbmNlVXNlck1hbmFnZXIoX2dldEluc3RhbmNlKGluTWVtb3J5UGVyc2lzdGVuY2UpLCBhdXRoLCB1c2VyS2V5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gRWxpbWluYXRlIGFueSBwZXJzaXN0ZW5jZXMgdGhhdCBhcmUgbm90IGF2YWlsYWJsZVxyXG4gICAgICAgIGNvbnN0IGF2YWlsYWJsZVBlcnNpc3RlbmNlcyA9IChhd2FpdCBQcm9taXNlLmFsbChwZXJzaXN0ZW5jZUhpZXJhcmNoeS5tYXAoYXN5bmMgKHBlcnNpc3RlbmNlKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChhd2FpdCBwZXJzaXN0ZW5jZS5faXNBdmFpbGFibGUoKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHBlcnNpc3RlbmNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgfSkpKS5maWx0ZXIocGVyc2lzdGVuY2UgPT4gcGVyc2lzdGVuY2UpO1xyXG4gICAgICAgIC8vIEZhbGwgYmFjayB0byB0aGUgZmlyc3QgcGVyc2lzdGVuY2UgbGlzdGVkLCBvciBpbiBtZW1vcnkgaWYgbm9uZSBhdmFpbGFibGVcclxuICAgICAgICBsZXQgc2VsZWN0ZWRQZXJzaXN0ZW5jZSA9IGF2YWlsYWJsZVBlcnNpc3RlbmNlc1swXSB8fFxyXG4gICAgICAgICAgICBfZ2V0SW5zdGFuY2UoaW5NZW1vcnlQZXJzaXN0ZW5jZSk7XHJcbiAgICAgICAgY29uc3Qga2V5ID0gX3BlcnNpc3RlbmNlS2V5TmFtZSh1c2VyS2V5LCBhdXRoLmNvbmZpZy5hcGlLZXksIGF1dGgubmFtZSk7XHJcbiAgICAgICAgLy8gUHVsbCBvdXQgdGhlIGV4aXN0aW5nIHVzZXIsIHNldHRpbmcgdGhlIGNob3NlbiBwZXJzaXN0ZW5jZSB0byB0aGF0XHJcbiAgICAgICAgLy8gcGVyc2lzdGVuY2UgaWYgdGhlIHVzZXIgZXhpc3RzLlxyXG4gICAgICAgIGxldCB1c2VyVG9NaWdyYXRlID0gbnVsbDtcclxuICAgICAgICAvLyBOb3RlLCBoZXJlIHdlIGNoZWNrIGZvciBhIHVzZXIgaW4gX2FsbF8gcGVyc2lzdGVuY2VzLCBub3QganVzdCB0aGVcclxuICAgICAgICAvLyBvbmVzIGRlZW1lZCBhdmFpbGFibGUuIElmIHdlIGNhbiBtaWdyYXRlIGEgdXNlciBvdXQgb2YgYSBicm9rZW5cclxuICAgICAgICAvLyBwZXJzaXN0ZW5jZSwgd2Ugd2lsbCAoYnV0IG9ubHkgaWYgdGhhdCBwZXJzaXN0ZW5jZSBzdXBwb3J0cyBtaWdyYXRpb24pLlxyXG4gICAgICAgIGZvciAoY29uc3QgcGVyc2lzdGVuY2Ugb2YgcGVyc2lzdGVuY2VIaWVyYXJjaHkpIHtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGJsb2IgPSBhd2FpdCBwZXJzaXN0ZW5jZS5fZ2V0KGtleSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoYmxvYikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHVzZXIgPSBVc2VySW1wbC5fZnJvbUpTT04oYXV0aCwgYmxvYik7IC8vIHRocm93cyBmb3IgdW5wYXJzYWJsZSBibG9iICh3cm9uZyBmb3JtYXQpXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBlcnNpc3RlbmNlICE9PSBzZWxlY3RlZFBlcnNpc3RlbmNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJUb01pZ3JhdGUgPSB1c2VyO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZFBlcnNpc3RlbmNlID0gcGVyc2lzdGVuY2U7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0Y2ggKF9hKSB7IH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gSWYgd2UgZmluZCB0aGUgdXNlciBpbiBhIHBlcnNpc3RlbmNlIHRoYXQgZG9lcyBzdXBwb3J0IG1pZ3JhdGlvbiwgdXNlXHJcbiAgICAgICAgLy8gdGhhdCBtaWdyYXRpb24gcGF0aCAob2Ygb25seSBwZXJzaXN0ZW5jZXMgdGhhdCBzdXBwb3J0IG1pZ3JhdGlvbilcclxuICAgICAgICBjb25zdCBtaWdyYXRpb25IaWVyYXJjaHkgPSBhdmFpbGFibGVQZXJzaXN0ZW5jZXMuZmlsdGVyKHAgPT4gcC5fc2hvdWxkQWxsb3dNaWdyYXRpb24pO1xyXG4gICAgICAgIC8vIElmIHRoZSBwZXJzaXN0ZW5jZSBkb2VzIF9ub3RfIGFsbG93IG1pZ3JhdGlvbiwganVzdCBmaW5pc2ggb2ZmIGhlcmVcclxuICAgICAgICBpZiAoIXNlbGVjdGVkUGVyc2lzdGVuY2UuX3Nob3VsZEFsbG93TWlncmF0aW9uIHx8XHJcbiAgICAgICAgICAgICFtaWdyYXRpb25IaWVyYXJjaHkubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUGVyc2lzdGVuY2VVc2VyTWFuYWdlcihzZWxlY3RlZFBlcnNpc3RlbmNlLCBhdXRoLCB1c2VyS2V5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgc2VsZWN0ZWRQZXJzaXN0ZW5jZSA9IG1pZ3JhdGlvbkhpZXJhcmNoeVswXTtcclxuICAgICAgICBpZiAodXNlclRvTWlncmF0ZSkge1xyXG4gICAgICAgICAgICAvLyBUaGlzIG5vcm1hbGx5IHNob3VsZG4ndCB0aHJvdyBzaW5jZSBjaG9zZW5QZXJzaXN0ZW5jZS5pc0F2YWlsYWJsZSgpIGlzIHRydWUsIGJ1dCBpZiBpdCBkb2VzXHJcbiAgICAgICAgICAgIC8vIHdlJ2xsIGp1c3QgbGV0IGl0IGJ1YmJsZSB0byBzdXJmYWNlIHRoZSBlcnJvci5cclxuICAgICAgICAgICAgYXdhaXQgc2VsZWN0ZWRQZXJzaXN0ZW5jZS5fc2V0KGtleSwgdXNlclRvTWlncmF0ZS50b0pTT04oKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIEF0dGVtcHQgdG8gY2xlYXIgdGhlIGtleSBpbiBvdGhlciBwZXJzaXN0ZW5jZXMgYnV0IGlnbm9yZSBlcnJvcnMuIFRoaXMgaGVscHMgcHJldmVudCBpc3N1ZXNcclxuICAgICAgICAvLyBzdWNoIGFzIHVzZXJzIGdldHRpbmcgc3R1Y2sgd2l0aCBhIHByZXZpb3VzIGFjY291bnQgYWZ0ZXIgc2lnbmluZyBvdXQgYW5kIHJlZnJlc2hpbmcgdGhlIHRhYi5cclxuICAgICAgICBhd2FpdCBQcm9taXNlLmFsbChwZXJzaXN0ZW5jZUhpZXJhcmNoeS5tYXAoYXN5bmMgKHBlcnNpc3RlbmNlKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChwZXJzaXN0ZW5jZSAhPT0gc2VsZWN0ZWRQZXJzaXN0ZW5jZSkge1xyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBwZXJzaXN0ZW5jZS5fcmVtb3ZlKGtleSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYXRjaCAoX2EpIHsgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSkpO1xyXG4gICAgICAgIHJldHVybiBuZXcgUGVyc2lzdGVuY2VVc2VyTWFuYWdlcihzZWxlY3RlZFBlcnNpc3RlbmNlLCBhdXRoLCB1c2VyS2V5KTtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogRGV0ZXJtaW5lIHRoZSBicm93c2VyIGZvciB0aGUgcHVycG9zZXMgb2YgcmVwb3J0aW5nIHVzYWdlIHRvIHRoZSBBUElcclxuICovXHJcbmZ1bmN0aW9uIF9nZXRCcm93c2VyTmFtZSh1c2VyQWdlbnQpIHtcclxuICAgIGNvbnN0IHVhID0gdXNlckFnZW50LnRvTG93ZXJDYXNlKCk7XHJcbiAgICBpZiAodWEuaW5jbHVkZXMoJ29wZXJhLycpIHx8IHVhLmluY2x1ZGVzKCdvcHIvJykgfHwgdWEuaW5jbHVkZXMoJ29waW9zLycpKSB7XHJcbiAgICAgICAgcmV0dXJuIFwiT3BlcmFcIiAvKiBPUEVSQSAqLztcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKF9pc0lFTW9iaWxlKHVhKSkge1xyXG4gICAgICAgIC8vIFdpbmRvd3MgcGhvbmUgSUVNb2JpbGUgYnJvd3Nlci5cclxuICAgICAgICByZXR1cm4gXCJJRU1vYmlsZVwiIC8qIElFTU9CSUxFICovO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAodWEuaW5jbHVkZXMoJ21zaWUnKSB8fCB1YS5pbmNsdWRlcygndHJpZGVudC8nKSkge1xyXG4gICAgICAgIHJldHVybiBcIklFXCIgLyogSUUgKi87XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICh1YS5pbmNsdWRlcygnZWRnZS8nKSkge1xyXG4gICAgICAgIHJldHVybiBcIkVkZ2VcIiAvKiBFREdFICovO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoX2lzRmlyZWZveCh1YSkpIHtcclxuICAgICAgICByZXR1cm4gXCJGaXJlZm94XCIgLyogRklSRUZPWCAqLztcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKHVhLmluY2x1ZGVzKCdzaWxrLycpKSB7XHJcbiAgICAgICAgcmV0dXJuIFwiU2lsa1wiIC8qIFNJTEsgKi87XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChfaXNCbGFja0JlcnJ5KHVhKSkge1xyXG4gICAgICAgIC8vIEJsYWNrYmVycnkgYnJvd3Nlci5cclxuICAgICAgICByZXR1cm4gXCJCbGFja2JlcnJ5XCIgLyogQkxBQ0tCRVJSWSAqLztcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKF9pc1dlYk9TKHVhKSkge1xyXG4gICAgICAgIC8vIFdlYk9TIGRlZmF1bHQgYnJvd3Nlci5cclxuICAgICAgICByZXR1cm4gXCJXZWJvc1wiIC8qIFdFQk9TICovO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoX2lzU2FmYXJpKHVhKSkge1xyXG4gICAgICAgIHJldHVybiBcIlNhZmFyaVwiIC8qIFNBRkFSSSAqLztcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKCh1YS5pbmNsdWRlcygnY2hyb21lLycpIHx8IF9pc0Nocm9tZUlPUyh1YSkpICYmXHJcbiAgICAgICAgIXVhLmluY2x1ZGVzKCdlZGdlLycpKSB7XHJcbiAgICAgICAgcmV0dXJuIFwiQ2hyb21lXCIgLyogQ0hST01FICovO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoX2lzQW5kcm9pZCh1YSkpIHtcclxuICAgICAgICAvLyBBbmRyb2lkIHN0b2NrIGJyb3dzZXIuXHJcbiAgICAgICAgcmV0dXJuIFwiQW5kcm9pZFwiIC8qIEFORFJPSUQgKi87XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICAvLyBNb3N0IG1vZGVybiBicm93c2VycyBoYXZlIG5hbWUvdmVyc2lvbiBhdCBlbmQgb2YgdXNlciBhZ2VudCBzdHJpbmcuXHJcbiAgICAgICAgY29uc3QgcmUgPSAvKFthLXpBLVpcXGRcXC5dKylcXC9bYS16QS1aXFxkXFwuXSokLztcclxuICAgICAgICBjb25zdCBtYXRjaGVzID0gdXNlckFnZW50Lm1hdGNoKHJlKTtcclxuICAgICAgICBpZiAoKG1hdGNoZXMgPT09IG51bGwgfHwgbWF0Y2hlcyA9PT0gdm9pZCAwID8gdm9pZCAwIDogbWF0Y2hlcy5sZW5ndGgpID09PSAyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBtYXRjaGVzWzFdO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBcIk90aGVyXCIgLyogT1RIRVIgKi87XHJcbn1cclxuZnVuY3Rpb24gX2lzRmlyZWZveCh1YSA9IGdldFVBKCkpIHtcclxuICAgIHJldHVybiAvZmlyZWZveFxcLy9pLnRlc3QodWEpO1xyXG59XHJcbmZ1bmN0aW9uIF9pc1NhZmFyaSh1c2VyQWdlbnQgPSBnZXRVQSgpKSB7XHJcbiAgICBjb25zdCB1YSA9IHVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpO1xyXG4gICAgcmV0dXJuICh1YS5pbmNsdWRlcygnc2FmYXJpLycpICYmXHJcbiAgICAgICAgIXVhLmluY2x1ZGVzKCdjaHJvbWUvJykgJiZcclxuICAgICAgICAhdWEuaW5jbHVkZXMoJ2NyaW9zLycpICYmXHJcbiAgICAgICAgIXVhLmluY2x1ZGVzKCdhbmRyb2lkJykpO1xyXG59XHJcbmZ1bmN0aW9uIF9pc0Nocm9tZUlPUyh1YSA9IGdldFVBKCkpIHtcclxuICAgIHJldHVybiAvY3Jpb3NcXC8vaS50ZXN0KHVhKTtcclxufVxyXG5mdW5jdGlvbiBfaXNJRU1vYmlsZSh1YSA9IGdldFVBKCkpIHtcclxuICAgIHJldHVybiAvaWVtb2JpbGUvaS50ZXN0KHVhKTtcclxufVxyXG5mdW5jdGlvbiBfaXNBbmRyb2lkKHVhID0gZ2V0VUEoKSkge1xyXG4gICAgcmV0dXJuIC9hbmRyb2lkL2kudGVzdCh1YSk7XHJcbn1cclxuZnVuY3Rpb24gX2lzQmxhY2tCZXJyeSh1YSA9IGdldFVBKCkpIHtcclxuICAgIHJldHVybiAvYmxhY2tiZXJyeS9pLnRlc3QodWEpO1xyXG59XHJcbmZ1bmN0aW9uIF9pc1dlYk9TKHVhID0gZ2V0VUEoKSkge1xyXG4gICAgcmV0dXJuIC93ZWJvcy9pLnRlc3QodWEpO1xyXG59XHJcbmZ1bmN0aW9uIF9pc0lPUyh1YSA9IGdldFVBKCkpIHtcclxuICAgIHJldHVybiAvaXBob25lfGlwYWR8aXBvZC9pLnRlc3QodWEpO1xyXG59XHJcbmZ1bmN0aW9uIF9pc0lPUzdPcjgodWEgPSBnZXRVQSgpKSB7XHJcbiAgICByZXR1cm4gKC8oaVBhZHxpUGhvbmV8aVBvZCkuKk9TIDdfXFxkL2kudGVzdCh1YSkgfHxcclxuICAgICAgICAvKGlQYWR8aVBob25lfGlQb2QpLipPUyA4X1xcZC9pLnRlc3QodWEpKTtcclxufVxyXG5mdW5jdGlvbiBfaXNJT1NTdGFuZGFsb25lKHVhID0gZ2V0VUEoKSkge1xyXG4gICAgdmFyIF9hO1xyXG4gICAgcmV0dXJuIF9pc0lPUyh1YSkgJiYgISEoKF9hID0gd2luZG93Lm5hdmlnYXRvcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnN0YW5kYWxvbmUpO1xyXG59XHJcbmZ1bmN0aW9uIF9pc0lFMTAoKSB7XHJcbiAgICByZXR1cm4gaXNJRSgpICYmIGRvY3VtZW50LmRvY3VtZW50TW9kZSA9PT0gMTA7XHJcbn1cclxuZnVuY3Rpb24gX2lzTW9iaWxlQnJvd3Nlcih1YSA9IGdldFVBKCkpIHtcclxuICAgIC8vIFRPRE86IGltcGxlbWVudCBnZXRCcm93c2VyTmFtZSBlcXVpdmFsZW50IGZvciBPUy5cclxuICAgIHJldHVybiAoX2lzSU9TKHVhKSB8fFxyXG4gICAgICAgIF9pc0FuZHJvaWQodWEpIHx8XHJcbiAgICAgICAgX2lzV2ViT1ModWEpIHx8XHJcbiAgICAgICAgX2lzQmxhY2tCZXJyeSh1YSkgfHxcclxuICAgICAgICAvd2luZG93cyBwaG9uZS9pLnRlc3QodWEpIHx8XHJcbiAgICAgICAgX2lzSUVNb2JpbGUodWEpKTtcclxufVxyXG5mdW5jdGlvbiBfaXNJZnJhbWUoKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIC8vIENoZWNrIHRoYXQgdGhlIGN1cnJlbnQgd2luZG93IGlzIG5vdCB0aGUgdG9wIHdpbmRvdy5cclxuICAgICAgICAvLyBJZiBzbywgcmV0dXJuIHRydWUuXHJcbiAgICAgICAgcmV0dXJuICEhKHdpbmRvdyAmJiB3aW5kb3cgIT09IHdpbmRvdy50b3ApO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLypcclxuICogRGV0ZXJtaW5lIHRoZSBTREsgdmVyc2lvbiBzdHJpbmdcclxuICovXHJcbmZ1bmN0aW9uIF9nZXRDbGllbnRWZXJzaW9uKGNsaWVudFBsYXRmb3JtLCBmcmFtZXdvcmtzID0gW10pIHtcclxuICAgIGxldCByZXBvcnRlZFBsYXRmb3JtO1xyXG4gICAgc3dpdGNoIChjbGllbnRQbGF0Zm9ybSkge1xyXG4gICAgICAgIGNhc2UgXCJCcm93c2VyXCIgLyogQlJPV1NFUiAqLzpcclxuICAgICAgICAgICAgLy8gSW4gYSBicm93c2VyIGVudmlyb25tZW50LCByZXBvcnQgdGhlIGJyb3dzZXIgbmFtZS5cclxuICAgICAgICAgICAgcmVwb3J0ZWRQbGF0Zm9ybSA9IF9nZXRCcm93c2VyTmFtZShnZXRVQSgpKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBcIldvcmtlclwiIC8qIFdPUktFUiAqLzpcclxuICAgICAgICAgICAgLy8gVGVjaG5pY2FsbHkgYSB3b3JrZXIgcnVucyBmcm9tIGEgYnJvd3NlciBidXQgd2UgbmVlZCB0byBkaWZmZXJlbnRpYXRlIGFcclxuICAgICAgICAgICAgLy8gd29ya2VyIGZyb20gYSBicm93c2VyLlxyXG4gICAgICAgICAgICAvLyBGb3IgZXhhbXBsZTogQ2hyb21lLVdvcmtlci9Kc0NvcmUvNC45LjEvRmlyZWJhc2VDb3JlLXdlYi5cclxuICAgICAgICAgICAgcmVwb3J0ZWRQbGF0Zm9ybSA9IGAke19nZXRCcm93c2VyTmFtZShnZXRVQSgpKX0tJHtjbGllbnRQbGF0Zm9ybX1gO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICByZXBvcnRlZFBsYXRmb3JtID0gY2xpZW50UGxhdGZvcm07XHJcbiAgICB9XHJcbiAgICBjb25zdCByZXBvcnRlZEZyYW1ld29ya3MgPSBmcmFtZXdvcmtzLmxlbmd0aFxyXG4gICAgICAgID8gZnJhbWV3b3Jrcy5qb2luKCcsJylcclxuICAgICAgICA6ICdGaXJlYmFzZUNvcmUtd2ViJzsgLyogZGVmYXVsdCB2YWx1ZSBpZiBubyBvdGhlciBmcmFtZXdvcmsgaXMgdXNlZCAqL1xyXG4gICAgcmV0dXJuIGAke3JlcG9ydGVkUGxhdGZvcm19LyR7XCJKc0NvcmVcIiAvKiBDT1JFICovfS8ke1NES19WRVJTSU9OfS8ke3JlcG9ydGVkRnJhbWV3b3Jrc31gO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmNsYXNzIEF1dGhJbXBsIHtcclxuICAgIGNvbnN0cnVjdG9yKGFwcCwgY29uZmlnKSB7XHJcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XHJcbiAgICAgICAgdGhpcy5jb25maWcgPSBjb25maWc7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50VXNlciA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5lbXVsYXRvckNvbmZpZyA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5vcGVyYXRpb25zID0gUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgdGhpcy5hdXRoU3RhdGVTdWJzY3JpcHRpb24gPSBuZXcgU3Vic2NyaXB0aW9uKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuaWRUb2tlblN1YnNjcmlwdGlvbiA9IG5ldyBTdWJzY3JpcHRpb24odGhpcyk7XHJcbiAgICAgICAgdGhpcy5yZWRpcmVjdFVzZXIgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuaXNQcm9hY3RpdmVSZWZyZXNoRW5hYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgIC8vIEFueSBuZXR3b3JrIGNhbGxzIHdpbGwgc2V0IHRoaXMgdG8gdHJ1ZSBhbmQgcHJldmVudCBzdWJzZXF1ZW50IGVtdWxhdG9yXHJcbiAgICAgICAgLy8gaW5pdGlhbGl6YXRpb25cclxuICAgICAgICB0aGlzLl9jYW5Jbml0RW11bGF0b3IgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuX2lzSW5pdGlhbGl6ZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9kZWxldGVkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5faW5pdGlhbGl6YXRpb25Qcm9taXNlID0gbnVsbDtcclxuICAgICAgICB0aGlzLl9wb3B1cFJlZGlyZWN0UmVzb2x2ZXIgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuX2Vycm9yRmFjdG9yeSA9IF9ERUZBVUxUX0FVVEhfRVJST1JfRkFDVE9SWTtcclxuICAgICAgICAvLyBUcmFja3MgdGhlIGxhc3Qgbm90aWZpZWQgVUlEIGZvciBzdGF0ZSBjaGFuZ2UgbGlzdGVuZXJzIHRvIHByZXZlbnRcclxuICAgICAgICAvLyByZXBlYXRlZCBjYWxscyB0byB0aGUgY2FsbGJhY2tzLiBVbmRlZmluZWQgbWVhbnMgaXQncyBuZXZlciBiZWVuXHJcbiAgICAgICAgLy8gY2FsbGVkLCB3aGVyZWFzIG51bGwgbWVhbnMgaXQncyBiZWVuIGNhbGxlZCB3aXRoIGEgc2lnbmVkIG91dCB1c2VyXHJcbiAgICAgICAgdGhpcy5sYXN0Tm90aWZpZWRVaWQgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgdGhpcy5sYW5ndWFnZUNvZGUgPSBudWxsO1xyXG4gICAgICAgIHRoaXMudGVuYW50SWQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSB7IGFwcFZlcmlmaWNhdGlvbkRpc2FibGVkRm9yVGVzdGluZzogZmFsc2UgfTtcclxuICAgICAgICB0aGlzLmZyYW1ld29ya3MgPSBbXTtcclxuICAgICAgICB0aGlzLm5hbWUgPSBhcHAubmFtZTtcclxuICAgICAgICB0aGlzLmNsaWVudFZlcnNpb24gPSBjb25maWcuc2RrQ2xpZW50VmVyc2lvbjtcclxuICAgIH1cclxuICAgIF9pbml0aWFsaXplV2l0aFBlcnNpc3RlbmNlKHBlcnNpc3RlbmNlSGllcmFyY2h5LCBwb3B1cFJlZGlyZWN0UmVzb2x2ZXIpIHtcclxuICAgICAgICBpZiAocG9wdXBSZWRpcmVjdFJlc29sdmVyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3BvcHVwUmVkaXJlY3RSZXNvbHZlciA9IF9nZXRJbnN0YW5jZShwb3B1cFJlZGlyZWN0UmVzb2x2ZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBIYXZlIHRvIGNoZWNrIGZvciBhcHAgZGVsZXRpb24gdGhyb3VnaG91dCBpbml0aWFsaXphdGlvbiAoYWZ0ZXIgZWFjaFxyXG4gICAgICAgIC8vIHByb21pc2UgcmVzb2x1dGlvbilcclxuICAgICAgICB0aGlzLl9pbml0aWFsaXphdGlvblByb21pc2UgPSB0aGlzLnF1ZXVlKGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5fZGVsZXRlZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMucGVyc2lzdGVuY2VNYW5hZ2VyID0gYXdhaXQgUGVyc2lzdGVuY2VVc2VyTWFuYWdlci5jcmVhdGUodGhpcywgcGVyc2lzdGVuY2VIaWVyYXJjaHkpO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5fZGVsZXRlZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIEluaXRpYWxpemUgdGhlIHJlc29sdmVyIGVhcmx5IGlmIG5lY2Vzc2FyeSAob25seSBhcHBsaWNhYmxlIHRvIHdlYjpcclxuICAgICAgICAgICAgLy8gdGhpcyB3aWxsIGNhdXNlIHRoZSBpZnJhbWUgdG8gbG9hZCBpbW1lZGlhdGVseSBpbiBjZXJ0YWluIGNhc2VzKVxyXG4gICAgICAgICAgICBpZiAoKF9hID0gdGhpcy5fcG9wdXBSZWRpcmVjdFJlc29sdmVyKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuX3Nob3VsZEluaXRQcm9hY3RpdmVseSkge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5fcG9wdXBSZWRpcmVjdFJlc29sdmVyLl9pbml0aWFsaXplKHRoaXMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuaW5pdGlhbGl6ZUN1cnJlbnRVc2VyKHBvcHVwUmVkaXJlY3RSZXNvbHZlcik7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9kZWxldGVkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5faXNJbml0aWFsaXplZCA9IHRydWU7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2luaXRpYWxpemF0aW9uUHJvbWlzZTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogSWYgdGhlIHBlcnNpc3RlbmNlIGlzIGNoYW5nZWQgaW4gYW5vdGhlciB3aW5kb3csIHRoZSB1c2VyIG1hbmFnZXIgd2lsbCBsZXQgdXMga25vd1xyXG4gICAgICovXHJcbiAgICBhc3luYyBfb25TdG9yYWdlRXZlbnQoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2RlbGV0ZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgdGhpcy5hc3NlcnRlZFBlcnNpc3RlbmNlLmdldEN1cnJlbnRVc2VyKCk7XHJcbiAgICAgICAgaWYgKCF0aGlzLmN1cnJlbnRVc2VyICYmICF1c2VyKSB7XHJcbiAgICAgICAgICAgIC8vIE5vIGNoYW5nZSwgZG8gbm90aGluZyAod2FzIHNpZ25lZCBvdXQgYW5kIHJlbWFpbmVkIHNpZ25lZCBvdXQpLlxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIElmIHRoZSBzYW1lIHVzZXIgaXMgdG8gYmUgc3luY2hyb25pemVkLlxyXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRVc2VyICYmIHVzZXIgJiYgdGhpcy5jdXJyZW50VXNlci51aWQgPT09IHVzZXIudWlkKSB7XHJcbiAgICAgICAgICAgIC8vIERhdGEgdXBkYXRlLCBzaW1wbHkgY29weSBkYXRhIGNoYW5nZXMuXHJcbiAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRVc2VyLl9hc3NpZ24odXNlcik7XHJcbiAgICAgICAgICAgIC8vIElmIHRva2VucyBjaGFuZ2VkIGZyb20gcHJldmlvdXMgdXNlciB0b2tlbnMsIHRoaXMgd2lsbCB0cmlnZ2VyXHJcbiAgICAgICAgICAgIC8vIG5vdGlmeUF1dGhMaXN0ZW5lcnNfLlxyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLmN1cnJlbnRVc2VyLmdldElkVG9rZW4oKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBVcGRhdGUgY3VycmVudCBBdXRoIHN0YXRlLiBFaXRoZXIgYSBuZXcgbG9naW4gb3IgbG9nb3V0LlxyXG4gICAgICAgIGF3YWl0IHRoaXMuX3VwZGF0ZUN1cnJlbnRVc2VyKHVzZXIpO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgaW5pdGlhbGl6ZUN1cnJlbnRVc2VyKHBvcHVwUmVkaXJlY3RSZXNvbHZlcikge1xyXG4gICAgICAgIHZhciBfYTtcclxuICAgICAgICAvLyBGaXJzdCBjaGVjayB0byBzZWUgaWYgd2UgaGF2ZSBhIHBlbmRpbmcgcmVkaXJlY3QgZXZlbnQuXHJcbiAgICAgICAgbGV0IHN0b3JlZFVzZXIgPSAoYXdhaXQgdGhpcy5hc3NlcnRlZFBlcnNpc3RlbmNlLmdldEN1cnJlbnRVc2VyKCkpO1xyXG4gICAgICAgIGlmIChwb3B1cFJlZGlyZWN0UmVzb2x2ZXIgJiYgdGhpcy5jb25maWcuYXV0aERvbWFpbikge1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLmdldE9ySW5pdFJlZGlyZWN0UGVyc2lzdGVuY2VNYW5hZ2VyKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlZGlyZWN0VXNlckV2ZW50SWQgPSAoX2EgPSB0aGlzLnJlZGlyZWN0VXNlcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLl9yZWRpcmVjdEV2ZW50SWQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHN0b3JlZFVzZXJFdmVudElkID0gc3RvcmVkVXNlciA9PT0gbnVsbCB8fCBzdG9yZWRVc2VyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzdG9yZWRVc2VyLl9yZWRpcmVjdEV2ZW50SWQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMudHJ5UmVkaXJlY3RTaWduSW4ocG9wdXBSZWRpcmVjdFJlc29sdmVyKTtcclxuICAgICAgICAgICAgLy8gSWYgdGhlIHN0b3JlZCB1c2VyIChpLmUuIHRoZSBvbGQgXCJjdXJyZW50VXNlclwiKSBoYXMgYSByZWRpcmVjdElkIHRoYXRcclxuICAgICAgICAgICAgLy8gbWF0Y2hlcyB0aGUgcmVkaXJlY3QgdXNlciwgdGhlbiB3ZSB3YW50IHRvIGluaXRpYWxseSBzaWduIGluIHdpdGggdGhlXHJcbiAgICAgICAgICAgIC8vIG5ldyB1c2VyIG9iamVjdCBmcm9tIHJlc3VsdC5cclxuICAgICAgICAgICAgLy8gVE9ETyhzYW1naG8pOiBNb3JlIHRob3JvdWdobHkgdGVzdCBhbGwgb2YgdGhpc1xyXG4gICAgICAgICAgICBpZiAoKCFyZWRpcmVjdFVzZXJFdmVudElkIHx8IHJlZGlyZWN0VXNlckV2ZW50SWQgPT09IHN0b3JlZFVzZXJFdmVudElkKSAmJlxyXG4gICAgICAgICAgICAgICAgKHJlc3VsdCA9PT0gbnVsbCB8fCByZXN1bHQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHJlc3VsdC51c2VyKSkge1xyXG4gICAgICAgICAgICAgICAgc3RvcmVkVXNlciA9IHJlc3VsdC51c2VyO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIElmIG5vIHVzZXIgaW4gcGVyc2lzdGVuY2UsIHRoZXJlIGlzIG5vIGN1cnJlbnQgdXNlci4gU2V0IHRvIG51bGwuXHJcbiAgICAgICAgaWYgKCFzdG9yZWRVc2VyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmRpcmVjdGx5U2V0Q3VycmVudFVzZXIobnVsbCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghc3RvcmVkVXNlci5fcmVkaXJlY3RFdmVudElkKSB7XHJcbiAgICAgICAgICAgIC8vIFRoaXMgaXNuJ3QgYSByZWRpcmVjdCB1c2VyLCB3ZSBjYW4gcmVsb2FkIGFuZCBiYWlsXHJcbiAgICAgICAgICAgIC8vIFRoaXMgd2lsbCBhbHNvIGNhdGNoIHRoZSByZWRpcmVjdGVkIHVzZXIsIGlmIGF2YWlsYWJsZSwgYXMgdGhhdCBtZXRob2RcclxuICAgICAgICAgICAgLy8gc3RyaXBzIHRoZSBfcmVkaXJlY3RFdmVudElkXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJlbG9hZEFuZFNldEN1cnJlbnRVc2VyT3JDbGVhcihzdG9yZWRVc2VyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgX2Fzc2VydCh0aGlzLl9wb3B1cFJlZGlyZWN0UmVzb2x2ZXIsIHRoaXMsIFwiYXJndW1lbnQtZXJyb3JcIiAvKiBBUkdVTUVOVF9FUlJPUiAqLyk7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5nZXRPckluaXRSZWRpcmVjdFBlcnNpc3RlbmNlTWFuYWdlcigpO1xyXG4gICAgICAgIC8vIElmIHRoZSByZWRpcmVjdCB1c2VyJ3MgZXZlbnQgSUQgbWF0Y2hlcyB0aGUgY3VycmVudCB1c2VyJ3MgZXZlbnQgSUQsXHJcbiAgICAgICAgLy8gRE8gTk9UIHJlbG9hZCB0aGUgY3VycmVudCB1c2VyLCBvdGhlcndpc2UgdGhleSdsbCBiZSBjbGVhcmVkIGZyb20gc3RvcmFnZS5cclxuICAgICAgICAvLyBUaGlzIGlzIGltcG9ydGFudCBmb3IgdGhlIHJlYXV0aGVudGljYXRlV2l0aFJlZGlyZWN0KCkgZmxvdy5cclxuICAgICAgICBpZiAodGhpcy5yZWRpcmVjdFVzZXIgJiZcclxuICAgICAgICAgICAgdGhpcy5yZWRpcmVjdFVzZXIuX3JlZGlyZWN0RXZlbnRJZCA9PT0gc3RvcmVkVXNlci5fcmVkaXJlY3RFdmVudElkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmRpcmVjdGx5U2V0Q3VycmVudFVzZXIoc3RvcmVkVXNlcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLnJlbG9hZEFuZFNldEN1cnJlbnRVc2VyT3JDbGVhcihzdG9yZWRVc2VyKTtcclxuICAgIH1cclxuICAgIGFzeW5jIHRyeVJlZGlyZWN0U2lnbkluKHJlZGlyZWN0UmVzb2x2ZXIpIHtcclxuICAgICAgICAvLyBUaGUgcmVkaXJlY3QgdXNlciBuZWVkcyB0byBiZSBjaGVja2VkIChhbmQgc2lnbmVkIGluIGlmIGF2YWlsYWJsZSlcclxuICAgICAgICAvLyBkdXJpbmcgYXV0aCBpbml0aWFsaXphdGlvbi4gQWxsIG9mIHRoZSBub3JtYWwgc2lnbiBpbiBhbmQgbGluay9yZWF1dGhcclxuICAgICAgICAvLyBmbG93cyBjYWxsIGJhY2sgaW50byBhdXRoIGFuZCBwdXNoIHRoaW5ncyBvbnRvIHRoZSBwcm9taXNlIHF1ZXVlLiBXZVxyXG4gICAgICAgIC8vIG5lZWQgdG8gYXdhaXQgdGhlIHJlc3VsdCBvZiB0aGUgcmVkaXJlY3Qgc2lnbiBpbiAqaW5zaWRlIHRoZSBwcm9taXNlXHJcbiAgICAgICAgLy8gcXVldWUqLiBUaGlzIHByZXNlbnRzIGEgcHJvYmxlbTogd2UgcnVuIGludG8gZGVhZGxvY2suIFNlZTpcclxuICAgICAgICAvLyAgICDilIw+IFtJbml0aWFsaXphdGlvbl0g4pSA4pSA4pSA4pSA4pSA4pSQXHJcbiAgICAgICAgLy8gICAg4pSMPiBbPG90aGVyIHF1ZXVlIHRhc2tzPl0g4pSCXHJcbiAgICAgICAgLy8gICAg4pSU4pSAIFtnZXRSZWRpcmVjdFJlc3VsdF0gPOKUgOKUmFxyXG4gICAgICAgIC8vICAgIHdoZXJlIFtdIGFyZSB0YXNrcyBvbiB0aGUgcXVldWUgYW5kIGFycm93cyBkZW5vdGUgYXdhaXRzXHJcbiAgICAgICAgLy8gSW5pdGlhbGl6YXRpb24gd2lsbCBuZXZlciBjb21wbGV0ZSBiZWNhdXNlIGl0J3Mgd2FpdGluZyBvbiBzb21ldGhpbmdcclxuICAgICAgICAvLyB0aGF0J3Mgd2FpdGluZyBmb3IgaW5pdGlhbGl6YXRpb24gdG8gY29tcGxldGUhXHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyBJbnN0ZWFkLCB0aGlzIG1ldGhvZCBjYWxscyBnZXRSZWRpcmVjdFJlc3VsdCgpIChzdG9yZWQgaW5cclxuICAgICAgICAvLyBfY29tcGxldGVSZWRpcmVjdEZuKSB3aXRoIGFuIG9wdGlvbmFsIHBhcmFtZXRlciB0aGF0IGluc3RydWN0cyBhbGwgb2ZcclxuICAgICAgICAvLyB0aGUgdW5kZXJseWluZyBhdXRoIG9wZXJhdGlvbnMgdG8gc2tpcCBhbnl0aGluZyB0aGF0IG11dGF0ZXMgYXV0aCBzdGF0ZS5cclxuICAgICAgICBsZXQgcmVzdWx0ID0gbnVsbDtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAvLyBXZSBrbm93IHRoaXMuX3BvcHVwUmVkaXJlY3RSZXNvbHZlciBpcyBzZXQgc2luY2UgcmVkaXJlY3RSZXNvbHZlclxyXG4gICAgICAgICAgICAvLyBpcyBwYXNzZWQgaW4uIFRoZSBfY29tcGxldGVSZWRpcmVjdEZuIGV4cGVjdHMgdGhlIHVud3JhcHBlZCBleHRlcm4uXHJcbiAgICAgICAgICAgIHJlc3VsdCA9IGF3YWl0IHRoaXMuX3BvcHVwUmVkaXJlY3RSZXNvbHZlci5fY29tcGxldGVSZWRpcmVjdEZuKHRoaXMsIHJlZGlyZWN0UmVzb2x2ZXIsIHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAvLyBTd2FsbG93IGFueSBlcnJvcnMgaGVyZTsgdGhlIGNvZGUgY2FuIHJldHJpZXZlIHRoZW0gaW5cclxuICAgICAgICAgICAgLy8gZ2V0UmVkaXJlY3RSZXN1bHQoKS5cclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5fc2V0UmVkaXJlY3RVc2VyKG51bGwpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG4gICAgYXN5bmMgcmVsb2FkQW5kU2V0Q3VycmVudFVzZXJPckNsZWFyKHVzZXIpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBhd2FpdCBfcmVsb2FkV2l0aG91dFNhdmluZyh1c2VyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgaWYgKGUuY29kZSAhPT0gYGF1dGgvJHtcIm5ldHdvcmstcmVxdWVzdC1mYWlsZWRcIiAvKiBORVRXT1JLX1JFUVVFU1RfRkFJTEVEICovfWApIHtcclxuICAgICAgICAgICAgICAgIC8vIFNvbWV0aGluZydzIHdyb25nIHdpdGggdGhlIHVzZXIncyB0b2tlbi4gTG9nIHRoZW0gb3V0IGFuZCByZW1vdmVcclxuICAgICAgICAgICAgICAgIC8vIHRoZW0gZnJvbSBzdG9yYWdlXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5kaXJlY3RseVNldEN1cnJlbnRVc2VyKG51bGwpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmRpcmVjdGx5U2V0Q3VycmVudFVzZXIodXNlcik7XHJcbiAgICB9XHJcbiAgICB1c2VEZXZpY2VMYW5ndWFnZSgpIHtcclxuICAgICAgICB0aGlzLmxhbmd1YWdlQ29kZSA9IF9nZXRVc2VyTGFuZ3VhZ2UoKTtcclxuICAgIH1cclxuICAgIGFzeW5jIF9kZWxldGUoKSB7XHJcbiAgICAgICAgdGhpcy5fZGVsZXRlZCA9IHRydWU7XHJcbiAgICB9XHJcbiAgICBhc3luYyB1cGRhdGVDdXJyZW50VXNlcih1c2VyRXh0ZXJuKSB7XHJcbiAgICAgICAgLy8gVGhlIHB1YmxpYyB1cGRhdGVDdXJyZW50VXNlciBtZXRob2QgbmVlZHMgdG8gbWFrZSBhIGNvcHkgb2YgdGhlIHVzZXIsXHJcbiAgICAgICAgLy8gYW5kIGFsc28gY2hlY2sgdGhhdCB0aGUgcHJvamVjdCBtYXRjaGVzXHJcbiAgICAgICAgY29uc3QgdXNlciA9IHVzZXJFeHRlcm5cclxuICAgICAgICAgICAgPyBnZXRNb2R1bGFySW5zdGFuY2UodXNlckV4dGVybilcclxuICAgICAgICAgICAgOiBudWxsO1xyXG4gICAgICAgIGlmICh1c2VyKSB7XHJcbiAgICAgICAgICAgIF9hc3NlcnQodXNlci5hdXRoLmNvbmZpZy5hcGlLZXkgPT09IHRoaXMuY29uZmlnLmFwaUtleSwgdGhpcywgXCJpbnZhbGlkLXVzZXItdG9rZW5cIiAvKiBJTlZBTElEX0FVVEggKi8pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5fdXBkYXRlQ3VycmVudFVzZXIodXNlciAmJiB1c2VyLl9jbG9uZSh0aGlzKSk7XHJcbiAgICB9XHJcbiAgICBhc3luYyBfdXBkYXRlQ3VycmVudFVzZXIodXNlcikge1xyXG4gICAgICAgIGlmICh0aGlzLl9kZWxldGVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHVzZXIpIHtcclxuICAgICAgICAgICAgX2Fzc2VydCh0aGlzLnRlbmFudElkID09PSB1c2VyLnRlbmFudElkLCB0aGlzLCBcInRlbmFudC1pZC1taXNtYXRjaFwiIC8qIFRFTkFOVF9JRF9NSVNNQVRDSCAqLyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLnF1ZXVlKGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5kaXJlY3RseVNldEN1cnJlbnRVc2VyKHVzZXIpO1xyXG4gICAgICAgICAgICB0aGlzLm5vdGlmeUF1dGhMaXN0ZW5lcnMoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGFzeW5jIHNpZ25PdXQoKSB7XHJcbiAgICAgICAgLy8gQ2xlYXIgdGhlIHJlZGlyZWN0IHVzZXIgd2hlbiBzaWduT3V0IGlzIGNhbGxlZFxyXG4gICAgICAgIGlmICh0aGlzLnJlZGlyZWN0UGVyc2lzdGVuY2VNYW5hZ2VyIHx8IHRoaXMuX3BvcHVwUmVkaXJlY3RSZXNvbHZlcikge1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLl9zZXRSZWRpcmVjdFVzZXIobnVsbCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLl91cGRhdGVDdXJyZW50VXNlcihudWxsKTtcclxuICAgIH1cclxuICAgIHNldFBlcnNpc3RlbmNlKHBlcnNpc3RlbmNlKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucXVldWUoYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLmFzc2VydGVkUGVyc2lzdGVuY2Uuc2V0UGVyc2lzdGVuY2UoX2dldEluc3RhbmNlKHBlcnNpc3RlbmNlKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBfZ2V0UGVyc2lzdGVuY2UoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYXNzZXJ0ZWRQZXJzaXN0ZW5jZS5wZXJzaXN0ZW5jZS50eXBlO1xyXG4gICAgfVxyXG4gICAgX3VwZGF0ZUVycm9yTWFwKGVycm9yTWFwKSB7XHJcbiAgICAgICAgdGhpcy5fZXJyb3JGYWN0b3J5ID0gbmV3IEVycm9yRmFjdG9yeSgnYXV0aCcsICdGaXJlYmFzZScsIGVycm9yTWFwKCkpO1xyXG4gICAgfVxyXG4gICAgb25BdXRoU3RhdGVDaGFuZ2VkKG5leHRPck9ic2VydmVyLCBlcnJvciwgY29tcGxldGVkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmVnaXN0ZXJTdGF0ZUxpc3RlbmVyKHRoaXMuYXV0aFN0YXRlU3Vic2NyaXB0aW9uLCBuZXh0T3JPYnNlcnZlciwgZXJyb3IsIGNvbXBsZXRlZCk7XHJcbiAgICB9XHJcbiAgICBvbklkVG9rZW5DaGFuZ2VkKG5leHRPck9ic2VydmVyLCBlcnJvciwgY29tcGxldGVkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmVnaXN0ZXJTdGF0ZUxpc3RlbmVyKHRoaXMuaWRUb2tlblN1YnNjcmlwdGlvbiwgbmV4dE9yT2JzZXJ2ZXIsIGVycm9yLCBjb21wbGV0ZWQpO1xyXG4gICAgfVxyXG4gICAgdG9KU09OKCkge1xyXG4gICAgICAgIHZhciBfYTtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBhcGlLZXk6IHRoaXMuY29uZmlnLmFwaUtleSxcclxuICAgICAgICAgICAgYXV0aERvbWFpbjogdGhpcy5jb25maWcuYXV0aERvbWFpbixcclxuICAgICAgICAgICAgYXBwTmFtZTogdGhpcy5uYW1lLFxyXG4gICAgICAgICAgICBjdXJyZW50VXNlcjogKF9hID0gdGhpcy5fY3VycmVudFVzZXIpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS50b0pTT04oKVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbiAgICBhc3luYyBfc2V0UmVkaXJlY3RVc2VyKHVzZXIsIHBvcHVwUmVkaXJlY3RSZXNvbHZlcikge1xyXG4gICAgICAgIGNvbnN0IHJlZGlyZWN0TWFuYWdlciA9IGF3YWl0IHRoaXMuZ2V0T3JJbml0UmVkaXJlY3RQZXJzaXN0ZW5jZU1hbmFnZXIocG9wdXBSZWRpcmVjdFJlc29sdmVyKTtcclxuICAgICAgICByZXR1cm4gdXNlciA9PT0gbnVsbFxyXG4gICAgICAgICAgICA/IHJlZGlyZWN0TWFuYWdlci5yZW1vdmVDdXJyZW50VXNlcigpXHJcbiAgICAgICAgICAgIDogcmVkaXJlY3RNYW5hZ2VyLnNldEN1cnJlbnRVc2VyKHVzZXIpO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgZ2V0T3JJbml0UmVkaXJlY3RQZXJzaXN0ZW5jZU1hbmFnZXIocG9wdXBSZWRpcmVjdFJlc29sdmVyKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLnJlZGlyZWN0UGVyc2lzdGVuY2VNYW5hZ2VyKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlc29sdmVyID0gKHBvcHVwUmVkaXJlY3RSZXNvbHZlciAmJiBfZ2V0SW5zdGFuY2UocG9wdXBSZWRpcmVjdFJlc29sdmVyKSkgfHxcclxuICAgICAgICAgICAgICAgIHRoaXMuX3BvcHVwUmVkaXJlY3RSZXNvbHZlcjtcclxuICAgICAgICAgICAgX2Fzc2VydChyZXNvbHZlciwgdGhpcywgXCJhcmd1bWVudC1lcnJvclwiIC8qIEFSR1VNRU5UX0VSUk9SICovKTtcclxuICAgICAgICAgICAgdGhpcy5yZWRpcmVjdFBlcnNpc3RlbmNlTWFuYWdlciA9IGF3YWl0IFBlcnNpc3RlbmNlVXNlck1hbmFnZXIuY3JlYXRlKHRoaXMsIFtfZ2V0SW5zdGFuY2UocmVzb2x2ZXIuX3JlZGlyZWN0UGVyc2lzdGVuY2UpXSwgXCJyZWRpcmVjdFVzZXJcIiAvKiBSRURJUkVDVF9VU0VSICovKTtcclxuICAgICAgICAgICAgdGhpcy5yZWRpcmVjdFVzZXIgPVxyXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5yZWRpcmVjdFBlcnNpc3RlbmNlTWFuYWdlci5nZXRDdXJyZW50VXNlcigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5yZWRpcmVjdFBlcnNpc3RlbmNlTWFuYWdlcjtcclxuICAgIH1cclxuICAgIGFzeW5jIF9yZWRpcmVjdFVzZXJGb3JJZChpZCkge1xyXG4gICAgICAgIHZhciBfYSwgX2I7XHJcbiAgICAgICAgLy8gTWFrZSBzdXJlIHdlJ3ZlIGNsZWFyZWQgYW55IHBlbmRpbmcgcGVyc2lzdGVuY2UgYWN0aW9ucyBpZiB3ZSdyZSBub3QgaW5cclxuICAgICAgICAvLyB0aGUgaW5pdGlhbGl6ZXJcclxuICAgICAgICBpZiAodGhpcy5faXNJbml0aWFsaXplZCkge1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnF1ZXVlKGFzeW5jICgpID0+IHsgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICgoKF9hID0gdGhpcy5fY3VycmVudFVzZXIpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5fcmVkaXJlY3RFdmVudElkKSA9PT0gaWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2N1cnJlbnRVc2VyO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoKChfYiA9IHRoaXMucmVkaXJlY3RVc2VyKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuX3JlZGlyZWN0RXZlbnRJZCkgPT09IGlkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJlZGlyZWN0VXNlcjtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgICBhc3luYyBfcGVyc2lzdFVzZXJJZkN1cnJlbnQodXNlcikge1xyXG4gICAgICAgIGlmICh1c2VyID09PSB0aGlzLmN1cnJlbnRVc2VyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnF1ZXVlKGFzeW5jICgpID0+IHRoaXMuZGlyZWN0bHlTZXRDdXJyZW50VXNlcih1c2VyKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqIE5vdGlmaWVzIGxpc3RlbmVycyBvbmx5IGlmIHRoZSB1c2VyIGlzIGN1cnJlbnQgKi9cclxuICAgIF9ub3RpZnlMaXN0ZW5lcnNJZkN1cnJlbnQodXNlcikge1xyXG4gICAgICAgIGlmICh1c2VyID09PSB0aGlzLmN1cnJlbnRVc2VyKSB7XHJcbiAgICAgICAgICAgIHRoaXMubm90aWZ5QXV0aExpc3RlbmVycygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIF9rZXkoKSB7XHJcbiAgICAgICAgcmV0dXJuIGAke3RoaXMuY29uZmlnLmF1dGhEb21haW59OiR7dGhpcy5jb25maWcuYXBpS2V5fToke3RoaXMubmFtZX1gO1xyXG4gICAgfVxyXG4gICAgX3N0YXJ0UHJvYWN0aXZlUmVmcmVzaCgpIHtcclxuICAgICAgICB0aGlzLmlzUHJvYWN0aXZlUmVmcmVzaEVuYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRVc2VyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRVc2VyLl9zdGFydFByb2FjdGl2ZVJlZnJlc2goKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBfc3RvcFByb2FjdGl2ZVJlZnJlc2goKSB7XHJcbiAgICAgICAgdGhpcy5pc1Byb2FjdGl2ZVJlZnJlc2hFbmFibGVkID0gZmFsc2U7XHJcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudFVzZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5fY3VycmVudFVzZXIuX3N0b3BQcm9hY3RpdmVSZWZyZXNoKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqIFJldHVybnMgdGhlIGN1cnJlbnQgdXNlciBjYXN0IGFzIHRoZSBpbnRlcm5hbCB0eXBlICovXHJcbiAgICBnZXQgX2N1cnJlbnRVc2VyKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRVc2VyO1xyXG4gICAgfVxyXG4gICAgbm90aWZ5QXV0aExpc3RlbmVycygpIHtcclxuICAgICAgICB2YXIgX2EsIF9iO1xyXG4gICAgICAgIGlmICghdGhpcy5faXNJbml0aWFsaXplZCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaWRUb2tlblN1YnNjcmlwdGlvbi5uZXh0KHRoaXMuY3VycmVudFVzZXIpO1xyXG4gICAgICAgIGNvbnN0IGN1cnJlbnRVaWQgPSAoX2IgPSAoX2EgPSB0aGlzLmN1cnJlbnRVc2VyKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EudWlkKSAhPT0gbnVsbCAmJiBfYiAhPT0gdm9pZCAwID8gX2IgOiBudWxsO1xyXG4gICAgICAgIGlmICh0aGlzLmxhc3ROb3RpZmllZFVpZCAhPT0gY3VycmVudFVpZCkge1xyXG4gICAgICAgICAgICB0aGlzLmxhc3ROb3RpZmllZFVpZCA9IGN1cnJlbnRVaWQ7XHJcbiAgICAgICAgICAgIHRoaXMuYXV0aFN0YXRlU3Vic2NyaXB0aW9uLm5leHQodGhpcy5jdXJyZW50VXNlcik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmVnaXN0ZXJTdGF0ZUxpc3RlbmVyKHN1YnNjcmlwdGlvbiwgbmV4dE9yT2JzZXJ2ZXIsIGVycm9yLCBjb21wbGV0ZWQpIHtcclxuICAgICAgICBpZiAodGhpcy5fZGVsZXRlZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gKCkgPT4geyB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBjYiA9IHR5cGVvZiBuZXh0T3JPYnNlcnZlciA9PT0gJ2Z1bmN0aW9uJ1xyXG4gICAgICAgICAgICA/IG5leHRPck9ic2VydmVyXHJcbiAgICAgICAgICAgIDogbmV4dE9yT2JzZXJ2ZXIubmV4dC5iaW5kKG5leHRPck9ic2VydmVyKTtcclxuICAgICAgICBjb25zdCBwcm9taXNlID0gdGhpcy5faXNJbml0aWFsaXplZFxyXG4gICAgICAgICAgICA/IFByb21pc2UucmVzb2x2ZSgpXHJcbiAgICAgICAgICAgIDogdGhpcy5faW5pdGlhbGl6YXRpb25Qcm9taXNlO1xyXG4gICAgICAgIF9hc3NlcnQocHJvbWlzZSwgdGhpcywgXCJpbnRlcm5hbC1lcnJvclwiIC8qIElOVEVSTkFMX0VSUk9SICovKTtcclxuICAgICAgICAvLyBUaGUgY2FsbGJhY2sgbmVlZHMgdG8gYmUgY2FsbGVkIGFzeW5jaHJvbm91c2x5IHBlciB0aGUgc3BlYy5cclxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWZsb2F0aW5nLXByb21pc2VzXHJcbiAgICAgICAgcHJvbWlzZS50aGVuKCgpID0+IGNiKHRoaXMuY3VycmVudFVzZXIpKTtcclxuICAgICAgICBpZiAodHlwZW9mIG5leHRPck9ic2VydmVyID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBzdWJzY3JpcHRpb24uYWRkT2JzZXJ2ZXIobmV4dE9yT2JzZXJ2ZXIsIGVycm9yLCBjb21wbGV0ZWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHN1YnNjcmlwdGlvbi5hZGRPYnNlcnZlcihuZXh0T3JPYnNlcnZlcik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBVbnByb3RlY3RlZCAoZnJvbSByYWNlIGNvbmRpdGlvbnMpIG1ldGhvZCB0byBzZXQgdGhlIGN1cnJlbnQgdXNlci4gVGhpc1xyXG4gICAgICogc2hvdWxkIG9ubHkgYmUgY2FsbGVkIGZyb20gd2l0aGluIGEgcXVldWVkIGNhbGxiYWNrLiBUaGlzIGlzIG5lY2Vzc2FyeVxyXG4gICAgICogYmVjYXVzZSB0aGUgcXVldWUgc2hvdWxkbid0IHJlbHkgb24gYW5vdGhlciBxdWV1ZWQgY2FsbGJhY2suXHJcbiAgICAgKi9cclxuICAgIGFzeW5jIGRpcmVjdGx5U2V0Q3VycmVudFVzZXIodXNlcikge1xyXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRVc2VyICYmIHRoaXMuY3VycmVudFVzZXIgIT09IHVzZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5fY3VycmVudFVzZXIuX3N0b3BQcm9hY3RpdmVSZWZyZXNoKCk7XHJcbiAgICAgICAgICAgIGlmICh1c2VyICYmIHRoaXMuaXNQcm9hY3RpdmVSZWZyZXNoRW5hYmxlZCkge1xyXG4gICAgICAgICAgICAgICAgdXNlci5fc3RhcnRQcm9hY3RpdmVSZWZyZXNoKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jdXJyZW50VXNlciA9IHVzZXI7XHJcbiAgICAgICAgaWYgKHVzZXIpIHtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5hc3NlcnRlZFBlcnNpc3RlbmNlLnNldEN1cnJlbnRVc2VyKHVzZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5hc3NlcnRlZFBlcnNpc3RlbmNlLnJlbW92ZUN1cnJlbnRVc2VyKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcXVldWUoYWN0aW9uKSB7XHJcbiAgICAgICAgLy8gSW4gY2FzZSBzb21ldGhpbmcgZXJyb3JzLCB0aGUgY2FsbGJhY2sgc3RpbGwgc2hvdWxkIGJlIGNhbGxlZCBpbiBvcmRlclxyXG4gICAgICAgIC8vIHRvIGtlZXAgdGhlIHByb21pc2UgY2hhaW4gYWxpdmVcclxuICAgICAgICB0aGlzLm9wZXJhdGlvbnMgPSB0aGlzLm9wZXJhdGlvbnMudGhlbihhY3Rpb24sIGFjdGlvbik7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMub3BlcmF0aW9ucztcclxuICAgIH1cclxuICAgIGdldCBhc3NlcnRlZFBlcnNpc3RlbmNlKCkge1xyXG4gICAgICAgIF9hc3NlcnQodGhpcy5wZXJzaXN0ZW5jZU1hbmFnZXIsIHRoaXMsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2VNYW5hZ2VyO1xyXG4gICAgfVxyXG4gICAgX2xvZ0ZyYW1ld29yayhmcmFtZXdvcmspIHtcclxuICAgICAgICBpZiAoIWZyYW1ld29yayB8fCB0aGlzLmZyYW1ld29ya3MuaW5jbHVkZXMoZnJhbWV3b3JrKSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZnJhbWV3b3Jrcy5wdXNoKGZyYW1ld29yayk7XHJcbiAgICAgICAgLy8gU29ydCBhbHBoYWJldGljYWxseSBzbyB0aGF0IFwiRmlyZWJhc2VDb3JlLXdlYixGaXJlYmFzZVVJLXdlYlwiIGFuZFxyXG4gICAgICAgIC8vIFwiRmlyZWJhc2VVSS13ZWIsRmlyZWJhc2VDb3JlLXdlYlwiIGFyZW4ndCB2aWV3ZWQgYXMgZGlmZmVyZW50LlxyXG4gICAgICAgIHRoaXMuZnJhbWV3b3Jrcy5zb3J0KCk7XHJcbiAgICAgICAgdGhpcy5jbGllbnRWZXJzaW9uID0gX2dldENsaWVudFZlcnNpb24odGhpcy5jb25maWcuY2xpZW50UGxhdGZvcm0sIHRoaXMuX2dldEZyYW1ld29ya3MoKSk7XHJcbiAgICB9XHJcbiAgICBfZ2V0RnJhbWV3b3JrcygpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5mcmFtZXdvcmtzO1xyXG4gICAgfVxyXG4gICAgX2dldFNka0NsaWVudFZlcnNpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY2xpZW50VmVyc2lvbjtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogTWV0aG9kIHRvIGJlIHVzZWQgdG8gY2FzdCBkb3duIHRvIG91ciBwcml2YXRlIGltcGxtZW50YXRpb24gb2YgQXV0aC5cclxuICogSXQgd2lsbCBhbHNvIGhhbmRsZSB1bndyYXBwaW5nIGZyb20gdGhlIGNvbXBhdCB0eXBlIGlmIG5lY2Vzc2FyeVxyXG4gKlxyXG4gKiBAcGFyYW0gYXV0aCBBdXRoIG9iamVjdCBwYXNzZWQgaW4gZnJvbSBkZXZlbG9wZXJcclxuICovXHJcbmZ1bmN0aW9uIF9jYXN0QXV0aChhdXRoKSB7XHJcbiAgICByZXR1cm4gZ2V0TW9kdWxhckluc3RhbmNlKGF1dGgpO1xyXG59XHJcbi8qKiBIZWxwZXIgY2xhc3MgdG8gd3JhcCBzdWJzY3JpYmVyIGxvZ2ljICovXHJcbmNsYXNzIFN1YnNjcmlwdGlvbiB7XHJcbiAgICBjb25zdHJ1Y3RvcihhdXRoKSB7XHJcbiAgICAgICAgdGhpcy5hdXRoID0gYXV0aDtcclxuICAgICAgICB0aGlzLm9ic2VydmVyID0gbnVsbDtcclxuICAgICAgICB0aGlzLmFkZE9ic2VydmVyID0gY3JlYXRlU3Vic2NyaWJlKG9ic2VydmVyID0+ICh0aGlzLm9ic2VydmVyID0gb2JzZXJ2ZXIpKTtcclxuICAgIH1cclxuICAgIGdldCBuZXh0KCkge1xyXG4gICAgICAgIF9hc3NlcnQodGhpcy5vYnNlcnZlciwgdGhpcy5hdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8pO1xyXG4gICAgICAgIHJldHVybiB0aGlzLm9ic2VydmVyLm5leHQuYmluZCh0aGlzLm9ic2VydmVyKTtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQ2hhbmdlcyB0aGUge0BsaW5rIEF1dGh9IGluc3RhbmNlIHRvIGNvbW11bmljYXRlIHdpdGggdGhlIEZpcmViYXNlIEF1dGggRW11bGF0b3IsIGluc3RlYWQgb2YgcHJvZHVjdGlvblxyXG4gKiBGaXJlYmFzZSBBdXRoIHNlcnZpY2VzLlxyXG4gKlxyXG4gKiBAcmVtYXJrc1xyXG4gKiBUaGlzIG11c3QgYmUgY2FsbGVkIHN5bmNocm9ub3VzbHkgaW1tZWRpYXRlbHkgZm9sbG93aW5nIHRoZSBmaXJzdCBjYWxsIHRvXHJcbiAqIHtAbGluayBpbml0aWFsaXplQXV0aH0uICBEbyBub3QgdXNlIHdpdGggcHJvZHVjdGlvbiBjcmVkZW50aWFscyBhcyBlbXVsYXRvclxyXG4gKiB0cmFmZmljIGlzIG5vdCBlbmNyeXB0ZWQuXHJcbiAqXHJcbiAqXHJcbiAqIEBleGFtcGxlXHJcbiAqIGBgYGphdmFzY3JpcHRcclxuICogY29ubmVjdEF1dGhFbXVsYXRvcihhdXRoLCAnaHR0cDovLzEyNy4wLjAuMTo5MDk5JywgeyBkaXNhYmxlV2FybmluZ3M6IHRydWUgfSk7XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXHJcbiAqIEBwYXJhbSB1cmwgLSBUaGUgVVJMIGF0IHdoaWNoIHRoZSBlbXVsYXRvciBpcyBydW5uaW5nIChlZywgJ2h0dHA6Ly9sb2NhbGhvc3Q6OTA5OScpLlxyXG4gKiBAcGFyYW0gb3B0aW9ucyAtIE9wdGlvbmFsLiBgb3B0aW9ucy5kaXNhYmxlV2FybmluZ3NgIGRlZmF1bHRzIHRvIGBmYWxzZWAuIFNldCBpdCB0b1xyXG4gKiBgdHJ1ZWAgdG8gZGlzYWJsZSB0aGUgd2FybmluZyBiYW5uZXIgYXR0YWNoZWQgdG8gdGhlIERPTS5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuZnVuY3Rpb24gY29ubmVjdEF1dGhFbXVsYXRvcihhdXRoLCB1cmwsIG9wdGlvbnMpIHtcclxuICAgIGNvbnN0IGF1dGhJbnRlcm5hbCA9IF9jYXN0QXV0aChhdXRoKTtcclxuICAgIF9hc3NlcnQoYXV0aEludGVybmFsLl9jYW5Jbml0RW11bGF0b3IsIGF1dGhJbnRlcm5hbCwgXCJlbXVsYXRvci1jb25maWctZmFpbGVkXCIgLyogRU1VTEFUT1JfQ09ORklHX0ZBSUxFRCAqLyk7XHJcbiAgICBfYXNzZXJ0KC9eaHR0cHM/OlxcL1xcLy8udGVzdCh1cmwpLCBhdXRoSW50ZXJuYWwsIFwiaW52YWxpZC1lbXVsYXRvci1zY2hlbWVcIiAvKiBJTlZBTElEX0VNVUxBVE9SX1NDSEVNRSAqLyk7XHJcbiAgICBjb25zdCBkaXNhYmxlV2FybmluZ3MgPSAhIShvcHRpb25zID09PSBudWxsIHx8IG9wdGlvbnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG9wdGlvbnMuZGlzYWJsZVdhcm5pbmdzKTtcclxuICAgIGNvbnN0IHByb3RvY29sID0gZXh0cmFjdFByb3RvY29sKHVybCk7XHJcbiAgICBjb25zdCB7IGhvc3QsIHBvcnQgfSA9IGV4dHJhY3RIb3N0QW5kUG9ydCh1cmwpO1xyXG4gICAgY29uc3QgcG9ydFN0ciA9IHBvcnQgPT09IG51bGwgPyAnJyA6IGA6JHtwb3J0fWA7XHJcbiAgICAvLyBBbHdheXMgcmVwbGFjZSBwYXRoIHdpdGggXCIvXCIgKGV2ZW4gaWYgaW5wdXQgdXJsIGhhZCBubyBwYXRoIGF0IGFsbCwgb3IgaGFkIGEgZGlmZmVyZW50IG9uZSkuXHJcbiAgICBhdXRoSW50ZXJuYWwuY29uZmlnLmVtdWxhdG9yID0geyB1cmw6IGAke3Byb3RvY29sfS8vJHtob3N0fSR7cG9ydFN0cn0vYCB9O1xyXG4gICAgYXV0aEludGVybmFsLnNldHRpbmdzLmFwcFZlcmlmaWNhdGlvbkRpc2FibGVkRm9yVGVzdGluZyA9IHRydWU7XHJcbiAgICBhdXRoSW50ZXJuYWwuZW11bGF0b3JDb25maWcgPSBPYmplY3QuZnJlZXplKHtcclxuICAgICAgICBob3N0LFxyXG4gICAgICAgIHBvcnQsXHJcbiAgICAgICAgcHJvdG9jb2w6IHByb3RvY29sLnJlcGxhY2UoJzonLCAnJyksXHJcbiAgICAgICAgb3B0aW9uczogT2JqZWN0LmZyZWV6ZSh7IGRpc2FibGVXYXJuaW5ncyB9KVxyXG4gICAgfSk7XHJcbiAgICBlbWl0RW11bGF0b3JXYXJuaW5nKGRpc2FibGVXYXJuaW5ncyk7XHJcbn1cclxuZnVuY3Rpb24gZXh0cmFjdFByb3RvY29sKHVybCkge1xyXG4gICAgY29uc3QgcHJvdG9jb2xFbmQgPSB1cmwuaW5kZXhPZignOicpO1xyXG4gICAgcmV0dXJuIHByb3RvY29sRW5kIDwgMCA/ICcnIDogdXJsLnN1YnN0cigwLCBwcm90b2NvbEVuZCArIDEpO1xyXG59XHJcbmZ1bmN0aW9uIGV4dHJhY3RIb3N0QW5kUG9ydCh1cmwpIHtcclxuICAgIGNvbnN0IHByb3RvY29sID0gZXh0cmFjdFByb3RvY29sKHVybCk7XHJcbiAgICBjb25zdCBhdXRob3JpdHkgPSAvKFxcL1xcLyk/KFtePyMvXSspLy5leGVjKHVybC5zdWJzdHIocHJvdG9jb2wubGVuZ3RoKSk7IC8vIEJldHdlZW4gLy8gYW5kIC8sID8gb3IgIy5cclxuICAgIGlmICghYXV0aG9yaXR5KSB7XHJcbiAgICAgICAgcmV0dXJuIHsgaG9zdDogJycsIHBvcnQ6IG51bGwgfTtcclxuICAgIH1cclxuICAgIGNvbnN0IGhvc3RBbmRQb3J0ID0gYXV0aG9yaXR5WzJdLnNwbGl0KCdAJykucG9wKCkgfHwgJyc7IC8vIFN0cmlwIG91dCBcInVzZXJuYW1lOnBhc3N3b3JkQFwiLlxyXG4gICAgY29uc3QgYnJhY2tldGVkSVB2NiA9IC9eKFxcW1teXFxdXStcXF0pKDp8JCkvLmV4ZWMoaG9zdEFuZFBvcnQpO1xyXG4gICAgaWYgKGJyYWNrZXRlZElQdjYpIHtcclxuICAgICAgICBjb25zdCBob3N0ID0gYnJhY2tldGVkSVB2NlsxXTtcclxuICAgICAgICByZXR1cm4geyBob3N0LCBwb3J0OiBwYXJzZVBvcnQoaG9zdEFuZFBvcnQuc3Vic3RyKGhvc3QubGVuZ3RoICsgMSkpIH07XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBjb25zdCBbaG9zdCwgcG9ydF0gPSBob3N0QW5kUG9ydC5zcGxpdCgnOicpO1xyXG4gICAgICAgIHJldHVybiB7IGhvc3QsIHBvcnQ6IHBhcnNlUG9ydChwb3J0KSB9O1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHBhcnNlUG9ydChwb3J0U3RyKSB7XHJcbiAgICBpZiAoIXBvcnRTdHIpIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIGNvbnN0IHBvcnQgPSBOdW1iZXIocG9ydFN0cik7XHJcbiAgICBpZiAoaXNOYU4ocG9ydCkpIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIHJldHVybiBwb3J0O1xyXG59XHJcbmZ1bmN0aW9uIGVtaXRFbXVsYXRvcldhcm5pbmcoZGlzYWJsZUJhbm5lcikge1xyXG4gICAgZnVuY3Rpb24gYXR0YWNoQmFubmVyKCkge1xyXG4gICAgICAgIGNvbnN0IGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xyXG4gICAgICAgIGNvbnN0IHN0eSA9IGVsLnN0eWxlO1xyXG4gICAgICAgIGVsLmlubmVyVGV4dCA9XHJcbiAgICAgICAgICAgICdSdW5uaW5nIGluIGVtdWxhdG9yIG1vZGUuIERvIG5vdCB1c2Ugd2l0aCBwcm9kdWN0aW9uIGNyZWRlbnRpYWxzLic7XHJcbiAgICAgICAgc3R5LnBvc2l0aW9uID0gJ2ZpeGVkJztcclxuICAgICAgICBzdHkud2lkdGggPSAnMTAwJSc7XHJcbiAgICAgICAgc3R5LmJhY2tncm91bmRDb2xvciA9ICcjZmZmZmZmJztcclxuICAgICAgICBzdHkuYm9yZGVyID0gJy4xZW0gc29saWQgIzAwMDAwMCc7XHJcbiAgICAgICAgc3R5LmNvbG9yID0gJyNiNTAwMDAnO1xyXG4gICAgICAgIHN0eS5ib3R0b20gPSAnMHB4JztcclxuICAgICAgICBzdHkubGVmdCA9ICcwcHgnO1xyXG4gICAgICAgIHN0eS5tYXJnaW4gPSAnMHB4JztcclxuICAgICAgICBzdHkuekluZGV4ID0gJzEwMDAwJztcclxuICAgICAgICBzdHkudGV4dEFsaWduID0gJ2NlbnRlcic7XHJcbiAgICAgICAgZWwuY2xhc3NMaXN0LmFkZCgnZmlyZWJhc2UtZW11bGF0b3Itd2FybmluZycpO1xyXG4gICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZWwpO1xyXG4gICAgfVxyXG4gICAgaWYgKHR5cGVvZiBjb25zb2xlICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgY29uc29sZS5pbmZvID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgY29uc29sZS5pbmZvKCdXQVJOSU5HOiBZb3UgYXJlIHVzaW5nIHRoZSBBdXRoIEVtdWxhdG9yLCcgK1xyXG4gICAgICAgICAgICAnIHdoaWNoIGlzIGludGVuZGVkIGZvciBsb2NhbCB0ZXN0aW5nIG9ubHkuICBEbyBub3QgdXNlIHdpdGgnICtcclxuICAgICAgICAgICAgJyBwcm9kdWN0aW9uIGNyZWRlbnRpYWxzLicpO1xyXG4gICAgfVxyXG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmXHJcbiAgICAgICAgdHlwZW9mIGRvY3VtZW50ICE9PSAndW5kZWZpbmVkJyAmJlxyXG4gICAgICAgICFkaXNhYmxlQmFubmVyKSB7XHJcbiAgICAgICAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgPT09ICdsb2FkaW5nJykge1xyXG4gICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGF0dGFjaEJhbm5lcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBhdHRhY2hCYW5uZXIoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEludGVyZmFjZSB0aGF0IHJlcHJlc2VudHMgdGhlIGNyZWRlbnRpYWxzIHJldHVybmVkIGJ5IGFuIHtAbGluayBBdXRoUHJvdmlkZXJ9LlxyXG4gKlxyXG4gKiBAcmVtYXJrc1xyXG4gKiBJbXBsZW1lbnRhdGlvbnMgc3BlY2lmeSB0aGUgZGV0YWlscyBhYm91dCBlYWNoIGF1dGggcHJvdmlkZXIncyBjcmVkZW50aWFsIHJlcXVpcmVtZW50cy5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuY2xhc3MgQXV0aENyZWRlbnRpYWwge1xyXG4gICAgLyoqIEBpbnRlcm5hbCAqL1xyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAvKipcclxuICAgICAqIFRoZSBhdXRoZW50aWNhdGlvbiBwcm92aWRlciBJRCBmb3IgdGhlIGNyZWRlbnRpYWwuXHJcbiAgICAgKlxyXG4gICAgICogQHJlbWFya3NcclxuICAgICAqIEZvciBleGFtcGxlLCAnZmFjZWJvb2suY29tJywgb3IgJ2dvb2dsZS5jb20nLlxyXG4gICAgICovXHJcbiAgICBwcm92aWRlcklkLCBcclxuICAgIC8qKlxyXG4gICAgICogVGhlIGF1dGhlbnRpY2F0aW9uIHNpZ24gaW4gbWV0aG9kIGZvciB0aGUgY3JlZGVudGlhbC5cclxuICAgICAqXHJcbiAgICAgKiBAcmVtYXJrc1xyXG4gICAgICogRm9yIGV4YW1wbGUsIHtAbGluayBTaWduSW5NZXRob2R9LkVNQUlMX1BBU1NXT1JELCBvclxyXG4gICAgICoge0BsaW5rIFNpZ25Jbk1ldGhvZH0uRU1BSUxfTElOSy4gVGhpcyBjb3JyZXNwb25kcyB0byB0aGUgc2lnbi1pbiBtZXRob2RcclxuICAgICAqIGlkZW50aWZpZXIgYXMgcmV0dXJuZWQgaW4ge0BsaW5rIGZldGNoU2lnbkluTWV0aG9kc0ZvckVtYWlsfS5cclxuICAgICAqL1xyXG4gICAgc2lnbkluTWV0aG9kKSB7XHJcbiAgICAgICAgdGhpcy5wcm92aWRlcklkID0gcHJvdmlkZXJJZDtcclxuICAgICAgICB0aGlzLnNpZ25Jbk1ldGhvZCA9IHNpZ25Jbk1ldGhvZDtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyBhIEpTT04tc2VyaWFsaXphYmxlIHJlcHJlc2VudGF0aW9uIG9mIHRoaXMgb2JqZWN0LlxyXG4gICAgICpcclxuICAgICAqIEByZXR1cm5zIGEgSlNPTi1zZXJpYWxpemFibGUgcmVwcmVzZW50YXRpb24gb2YgdGhpcyBvYmplY3QuXHJcbiAgICAgKi9cclxuICAgIHRvSlNPTigpIHtcclxuICAgICAgICByZXR1cm4gZGVidWdGYWlsKCdub3QgaW1wbGVtZW50ZWQnKTtcclxuICAgIH1cclxuICAgIC8qKiBAaW50ZXJuYWwgKi9cclxuICAgIF9nZXRJZFRva2VuUmVzcG9uc2UoX2F1dGgpIHtcclxuICAgICAgICByZXR1cm4gZGVidWdGYWlsKCdub3QgaW1wbGVtZW50ZWQnKTtcclxuICAgIH1cclxuICAgIC8qKiBAaW50ZXJuYWwgKi9cclxuICAgIF9saW5rVG9JZFRva2VuKF9hdXRoLCBfaWRUb2tlbikge1xyXG4gICAgICAgIHJldHVybiBkZWJ1Z0ZhaWwoJ25vdCBpbXBsZW1lbnRlZCcpO1xyXG4gICAgfVxyXG4gICAgLyoqIEBpbnRlcm5hbCAqL1xyXG4gICAgX2dldFJlYXV0aGVudGljYXRpb25SZXNvbHZlcihfYXV0aCkge1xyXG4gICAgICAgIHJldHVybiBkZWJ1Z0ZhaWwoJ25vdCBpbXBsZW1lbnRlZCcpO1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIHJlc2V0UGFzc3dvcmQoYXV0aCwgcmVxdWVzdCkge1xyXG4gICAgcmV0dXJuIF9wZXJmb3JtQXBpUmVxdWVzdChhdXRoLCBcIlBPU1RcIiAvKiBQT1NUICovLCBcIi92MS9hY2NvdW50czpyZXNldFBhc3N3b3JkXCIgLyogUkVTRVRfUEFTU1dPUkQgKi8sIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCByZXF1ZXN0KSk7XHJcbn1cclxuYXN5bmMgZnVuY3Rpb24gdXBkYXRlRW1haWxQYXNzd29yZChhdXRoLCByZXF1ZXN0KSB7XHJcbiAgICByZXR1cm4gX3BlcmZvcm1BcGlSZXF1ZXN0KGF1dGgsIFwiUE9TVFwiIC8qIFBPU1QgKi8sIFwiL3YxL2FjY291bnRzOnVwZGF0ZVwiIC8qIFNFVF9BQ0NPVU5UX0lORk8gKi8sIHJlcXVlc3QpO1xyXG59XHJcbmFzeW5jIGZ1bmN0aW9uIGFwcGx5QWN0aW9uQ29kZSQxKGF1dGgsIHJlcXVlc3QpIHtcclxuICAgIHJldHVybiBfcGVyZm9ybUFwaVJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogUE9TVCAqLywgXCIvdjEvYWNjb3VudHM6dXBkYXRlXCIgLyogU0VUX0FDQ09VTlRfSU5GTyAqLywgX2FkZFRpZElmTmVjZXNzYXJ5KGF1dGgsIHJlcXVlc3QpKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBzaWduSW5XaXRoUGFzc3dvcmQoYXV0aCwgcmVxdWVzdCkge1xyXG4gICAgcmV0dXJuIF9wZXJmb3JtU2lnbkluUmVxdWVzdChhdXRoLCBcIlBPU1RcIiAvKiBQT1NUICovLCBcIi92MS9hY2NvdW50czpzaWduSW5XaXRoUGFzc3dvcmRcIiAvKiBTSUdOX0lOX1dJVEhfUEFTU1dPUkQgKi8sIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCByZXF1ZXN0KSk7XHJcbn1cclxuYXN5bmMgZnVuY3Rpb24gc2VuZE9vYkNvZGUoYXV0aCwgcmVxdWVzdCkge1xyXG4gICAgcmV0dXJuIF9wZXJmb3JtQXBpUmVxdWVzdChhdXRoLCBcIlBPU1RcIiAvKiBQT1NUICovLCBcIi92MS9hY2NvdW50czpzZW5kT29iQ29kZVwiIC8qIFNFTkRfT09CX0NPREUgKi8sIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCByZXF1ZXN0KSk7XHJcbn1cclxuYXN5bmMgZnVuY3Rpb24gc2VuZEVtYWlsVmVyaWZpY2F0aW9uJDEoYXV0aCwgcmVxdWVzdCkge1xyXG4gICAgcmV0dXJuIHNlbmRPb2JDb2RlKGF1dGgsIHJlcXVlc3QpO1xyXG59XHJcbmFzeW5jIGZ1bmN0aW9uIHNlbmRQYXNzd29yZFJlc2V0RW1haWwkMShhdXRoLCByZXF1ZXN0KSB7XHJcbiAgICByZXR1cm4gc2VuZE9vYkNvZGUoYXV0aCwgcmVxdWVzdCk7XHJcbn1cclxuYXN5bmMgZnVuY3Rpb24gc2VuZFNpZ25JbkxpbmtUb0VtYWlsJDEoYXV0aCwgcmVxdWVzdCkge1xyXG4gICAgcmV0dXJuIHNlbmRPb2JDb2RlKGF1dGgsIHJlcXVlc3QpO1xyXG59XHJcbmFzeW5jIGZ1bmN0aW9uIHZlcmlmeUFuZENoYW5nZUVtYWlsKGF1dGgsIHJlcXVlc3QpIHtcclxuICAgIHJldHVybiBzZW5kT29iQ29kZShhdXRoLCByZXF1ZXN0KTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBzaWduSW5XaXRoRW1haWxMaW5rJDEoYXV0aCwgcmVxdWVzdCkge1xyXG4gICAgcmV0dXJuIF9wZXJmb3JtU2lnbkluUmVxdWVzdChhdXRoLCBcIlBPU1RcIiAvKiBQT1NUICovLCBcIi92MS9hY2NvdW50czpzaWduSW5XaXRoRW1haWxMaW5rXCIgLyogU0lHTl9JTl9XSVRIX0VNQUlMX0xJTksgKi8sIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCByZXF1ZXN0KSk7XHJcbn1cclxuYXN5bmMgZnVuY3Rpb24gc2lnbkluV2l0aEVtYWlsTGlua0ZvckxpbmtpbmcoYXV0aCwgcmVxdWVzdCkge1xyXG4gICAgcmV0dXJuIF9wZXJmb3JtU2lnbkluUmVxdWVzdChhdXRoLCBcIlBPU1RcIiAvKiBQT1NUICovLCBcIi92MS9hY2NvdW50czpzaWduSW5XaXRoRW1haWxMaW5rXCIgLyogU0lHTl9JTl9XSVRIX0VNQUlMX0xJTksgKi8sIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCByZXF1ZXN0KSk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEludGVyZmFjZSB0aGF0IHJlcHJlc2VudHMgdGhlIGNyZWRlbnRpYWxzIHJldHVybmVkIGJ5IHtAbGluayBFbWFpbEF1dGhQcm92aWRlcn0gZm9yXHJcbiAqIHtAbGluayBQcm92aWRlcklkfS5QQVNTV09SRFxyXG4gKlxyXG4gKiBAcmVtYXJrc1xyXG4gKiBDb3ZlcnMgYm90aCB7QGxpbmsgU2lnbkluTWV0aG9kfS5FTUFJTF9QQVNTV09SRCBhbmRcclxuICoge0BsaW5rIFNpZ25Jbk1ldGhvZH0uRU1BSUxfTElOSy5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuY2xhc3MgRW1haWxBdXRoQ3JlZGVudGlhbCBleHRlbmRzIEF1dGhDcmVkZW50aWFsIHtcclxuICAgIC8qKiBAaW50ZXJuYWwgKi9cclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgLyoqIEBpbnRlcm5hbCAqL1xyXG4gICAgX2VtYWlsLCBcclxuICAgIC8qKiBAaW50ZXJuYWwgKi9cclxuICAgIF9wYXNzd29yZCwgc2lnbkluTWV0aG9kLCBcclxuICAgIC8qKiBAaW50ZXJuYWwgKi9cclxuICAgIF90ZW5hbnRJZCA9IG51bGwpIHtcclxuICAgICAgICBzdXBlcihcInBhc3N3b3JkXCIgLyogUEFTU1dPUkQgKi8sIHNpZ25Jbk1ldGhvZCk7XHJcbiAgICAgICAgdGhpcy5fZW1haWwgPSBfZW1haWw7XHJcbiAgICAgICAgdGhpcy5fcGFzc3dvcmQgPSBfcGFzc3dvcmQ7XHJcbiAgICAgICAgdGhpcy5fdGVuYW50SWQgPSBfdGVuYW50SWQ7XHJcbiAgICB9XHJcbiAgICAvKiogQGludGVybmFsICovXHJcbiAgICBzdGF0aWMgX2Zyb21FbWFpbEFuZFBhc3N3b3JkKGVtYWlsLCBwYXNzd29yZCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgRW1haWxBdXRoQ3JlZGVudGlhbChlbWFpbCwgcGFzc3dvcmQsIFwicGFzc3dvcmRcIiAvKiBFTUFJTF9QQVNTV09SRCAqLyk7XHJcbiAgICB9XHJcbiAgICAvKiogQGludGVybmFsICovXHJcbiAgICBzdGF0aWMgX2Zyb21FbWFpbEFuZENvZGUoZW1haWwsIG9vYkNvZGUsIHRlbmFudElkID0gbnVsbCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgRW1haWxBdXRoQ3JlZGVudGlhbChlbWFpbCwgb29iQ29kZSwgXCJlbWFpbExpbmtcIiAvKiBFTUFJTF9MSU5LICovLCB0ZW5hbnRJZCk7XHJcbiAgICB9XHJcbiAgICAvKioge0Bpbmhlcml0ZG9jIEF1dGhDcmVkZW50aWFsLnRvSlNPTn0gKi9cclxuICAgIHRvSlNPTigpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBlbWFpbDogdGhpcy5fZW1haWwsXHJcbiAgICAgICAgICAgIHBhc3N3b3JkOiB0aGlzLl9wYXNzd29yZCxcclxuICAgICAgICAgICAgc2lnbkluTWV0aG9kOiB0aGlzLnNpZ25Jbk1ldGhvZCxcclxuICAgICAgICAgICAgdGVuYW50SWQ6IHRoaXMuX3RlbmFudElkXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogU3RhdGljIG1ldGhvZCB0byBkZXNlcmlhbGl6ZSBhIEpTT04gcmVwcmVzZW50YXRpb24gb2YgYW4gb2JqZWN0IGludG8gYW4ge0BsaW5rICBBdXRoQ3JlZGVudGlhbH0uXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGpzb24gLSBFaXRoZXIgYG9iamVjdGAgb3IgdGhlIHN0cmluZ2lmaWVkIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBvYmplY3QuIFdoZW4gc3RyaW5nIGlzXHJcbiAgICAgKiBwcm92aWRlZCwgYEpTT04ucGFyc2VgIHdvdWxkIGJlIGNhbGxlZCBmaXJzdC5cclxuICAgICAqXHJcbiAgICAgKiBAcmV0dXJucyBJZiB0aGUgSlNPTiBpbnB1dCBkb2VzIG5vdCByZXByZXNlbnQgYW4ge0BsaW5rIEF1dGhDcmVkZW50aWFsfSwgbnVsbCBpcyByZXR1cm5lZC5cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGZyb21KU09OKGpzb24pIHtcclxuICAgICAgICBjb25zdCBvYmogPSB0eXBlb2YganNvbiA9PT0gJ3N0cmluZycgPyBKU09OLnBhcnNlKGpzb24pIDoganNvbjtcclxuICAgICAgICBpZiAoKG9iaiA9PT0gbnVsbCB8fCBvYmogPT09IHZvaWQgMCA/IHZvaWQgMCA6IG9iai5lbWFpbCkgJiYgKG9iaiA9PT0gbnVsbCB8fCBvYmogPT09IHZvaWQgMCA/IHZvaWQgMCA6IG9iai5wYXNzd29yZCkpIHtcclxuICAgICAgICAgICAgaWYgKG9iai5zaWduSW5NZXRob2QgPT09IFwicGFzc3dvcmRcIiAvKiBFTUFJTF9QQVNTV09SRCAqLykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2Zyb21FbWFpbEFuZFBhc3N3b3JkKG9iai5lbWFpbCwgb2JqLnBhc3N3b3JkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChvYmouc2lnbkluTWV0aG9kID09PSBcImVtYWlsTGlua1wiIC8qIEVNQUlMX0xJTksgKi8pIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9mcm9tRW1haWxBbmRDb2RlKG9iai5lbWFpbCwgb2JqLnBhc3N3b3JkLCBvYmoudGVuYW50SWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgLyoqIEBpbnRlcm5hbCAqL1xyXG4gICAgYXN5bmMgX2dldElkVG9rZW5SZXNwb25zZShhdXRoKSB7XHJcbiAgICAgICAgc3dpdGNoICh0aGlzLnNpZ25Jbk1ldGhvZCkge1xyXG4gICAgICAgICAgICBjYXNlIFwicGFzc3dvcmRcIiAvKiBFTUFJTF9QQVNTV09SRCAqLzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBzaWduSW5XaXRoUGFzc3dvcmQoYXV0aCwge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblNlY3VyZVRva2VuOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIGVtYWlsOiB0aGlzLl9lbWFpbCxcclxuICAgICAgICAgICAgICAgICAgICBwYXNzd29yZDogdGhpcy5fcGFzc3dvcmRcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBjYXNlIFwiZW1haWxMaW5rXCIgLyogRU1BSUxfTElOSyAqLzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBzaWduSW5XaXRoRW1haWxMaW5rJDEoYXV0aCwge1xyXG4gICAgICAgICAgICAgICAgICAgIGVtYWlsOiB0aGlzLl9lbWFpbCxcclxuICAgICAgICAgICAgICAgICAgICBvb2JDb2RlOiB0aGlzLl9wYXNzd29yZFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICBfZmFpbChhdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKiBAaW50ZXJuYWwgKi9cclxuICAgIGFzeW5jIF9saW5rVG9JZFRva2VuKGF1dGgsIGlkVG9rZW4pIHtcclxuICAgICAgICBzd2l0Y2ggKHRoaXMuc2lnbkluTWV0aG9kKSB7XHJcbiAgICAgICAgICAgIGNhc2UgXCJwYXNzd29yZFwiIC8qIEVNQUlMX1BBU1NXT1JEICovOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZUVtYWlsUGFzc3dvcmQoYXV0aCwge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkVG9rZW4sXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuU2VjdXJlVG9rZW46IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgZW1haWw6IHRoaXMuX2VtYWlsLFxyXG4gICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiB0aGlzLl9wYXNzd29yZFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGNhc2UgXCJlbWFpbExpbmtcIiAvKiBFTUFJTF9MSU5LICovOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNpZ25JbldpdGhFbWFpbExpbmtGb3JMaW5raW5nKGF1dGgsIHtcclxuICAgICAgICAgICAgICAgICAgICBpZFRva2VuLFxyXG4gICAgICAgICAgICAgICAgICAgIGVtYWlsOiB0aGlzLl9lbWFpbCxcclxuICAgICAgICAgICAgICAgICAgICBvb2JDb2RlOiB0aGlzLl9wYXNzd29yZFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICBfZmFpbChhdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKiBAaW50ZXJuYWwgKi9cclxuICAgIF9nZXRSZWF1dGhlbnRpY2F0aW9uUmVzb2x2ZXIoYXV0aCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9nZXRJZFRva2VuUmVzcG9uc2UoYXV0aCk7XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gc2lnbkluV2l0aElkcChhdXRoLCByZXF1ZXN0KSB7XHJcbiAgICByZXR1cm4gX3BlcmZvcm1TaWduSW5SZXF1ZXN0KGF1dGgsIFwiUE9TVFwiIC8qIFBPU1QgKi8sIFwiL3YxL2FjY291bnRzOnNpZ25JbldpdGhJZHBcIiAvKiBTSUdOX0lOX1dJVEhfSURQICovLCBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdCkpO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmNvbnN0IElEUF9SRVFVRVNUX1VSSSQxID0gJ2h0dHA6Ly9sb2NhbGhvc3QnO1xyXG4vKipcclxuICogUmVwcmVzZW50cyB0aGUgT0F1dGggY3JlZGVudGlhbHMgcmV0dXJuZWQgYnkgYW4ge0BsaW5rIE9BdXRoUHJvdmlkZXJ9LlxyXG4gKlxyXG4gKiBAcmVtYXJrc1xyXG4gKiBJbXBsZW1lbnRhdGlvbnMgc3BlY2lmeSB0aGUgZGV0YWlscyBhYm91dCBlYWNoIGF1dGggcHJvdmlkZXIncyBjcmVkZW50aWFsIHJlcXVpcmVtZW50cy5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuY2xhc3MgT0F1dGhDcmVkZW50aWFsIGV4dGVuZHMgQXV0aENyZWRlbnRpYWwge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoLi4uYXJndW1lbnRzKTtcclxuICAgICAgICB0aGlzLnBlbmRpbmdUb2tlbiA9IG51bGw7XHJcbiAgICB9XHJcbiAgICAvKiogQGludGVybmFsICovXHJcbiAgICBzdGF0aWMgX2Zyb21QYXJhbXMocGFyYW1zKSB7XHJcbiAgICAgICAgY29uc3QgY3JlZCA9IG5ldyBPQXV0aENyZWRlbnRpYWwocGFyYW1zLnByb3ZpZGVySWQsIHBhcmFtcy5zaWduSW5NZXRob2QpO1xyXG4gICAgICAgIGlmIChwYXJhbXMuaWRUb2tlbiB8fCBwYXJhbXMuYWNjZXNzVG9rZW4pIHtcclxuICAgICAgICAgICAgLy8gT0F1dGggMiBhbmQgZWl0aGVyIElEIHRva2VuIG9yIGFjY2VzcyB0b2tlbi5cclxuICAgICAgICAgICAgaWYgKHBhcmFtcy5pZFRva2VuKSB7XHJcbiAgICAgICAgICAgICAgICBjcmVkLmlkVG9rZW4gPSBwYXJhbXMuaWRUb2tlbjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAocGFyYW1zLmFjY2Vzc1Rva2VuKSB7XHJcbiAgICAgICAgICAgICAgICBjcmVkLmFjY2Vzc1Rva2VuID0gcGFyYW1zLmFjY2Vzc1Rva2VuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIEFkZCBub25jZSBpZiBhdmFpbGFibGUgYW5kIG5vIHBlbmRpbmdUb2tlbiBpcyBwcmVzZW50LlxyXG4gICAgICAgICAgICBpZiAocGFyYW1zLm5vbmNlICYmICFwYXJhbXMucGVuZGluZ1Rva2VuKSB7XHJcbiAgICAgICAgICAgICAgICBjcmVkLm5vbmNlID0gcGFyYW1zLm5vbmNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChwYXJhbXMucGVuZGluZ1Rva2VuKSB7XHJcbiAgICAgICAgICAgICAgICBjcmVkLnBlbmRpbmdUb2tlbiA9IHBhcmFtcy5wZW5kaW5nVG9rZW47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAocGFyYW1zLm9hdXRoVG9rZW4gJiYgcGFyYW1zLm9hdXRoVG9rZW5TZWNyZXQpIHtcclxuICAgICAgICAgICAgLy8gT0F1dGggMSBhbmQgT0F1dGggdG9rZW4gd2l0aCB0b2tlbiBzZWNyZXRcclxuICAgICAgICAgICAgY3JlZC5hY2Nlc3NUb2tlbiA9IHBhcmFtcy5vYXV0aFRva2VuO1xyXG4gICAgICAgICAgICBjcmVkLnNlY3JldCA9IHBhcmFtcy5vYXV0aFRva2VuU2VjcmV0O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgX2ZhaWwoXCJhcmd1bWVudC1lcnJvclwiIC8qIEFSR1VNRU5UX0VSUk9SICovKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGNyZWQ7XHJcbiAgICB9XHJcbiAgICAvKioge0Bpbmhlcml0ZG9jIEF1dGhDcmVkZW50aWFsLnRvSlNPTn0gICovXHJcbiAgICB0b0pTT04oKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgaWRUb2tlbjogdGhpcy5pZFRva2VuLFxyXG4gICAgICAgICAgICBhY2Nlc3NUb2tlbjogdGhpcy5hY2Nlc3NUb2tlbixcclxuICAgICAgICAgICAgc2VjcmV0OiB0aGlzLnNlY3JldCxcclxuICAgICAgICAgICAgbm9uY2U6IHRoaXMubm9uY2UsXHJcbiAgICAgICAgICAgIHBlbmRpbmdUb2tlbjogdGhpcy5wZW5kaW5nVG9rZW4sXHJcbiAgICAgICAgICAgIHByb3ZpZGVySWQ6IHRoaXMucHJvdmlkZXJJZCxcclxuICAgICAgICAgICAgc2lnbkluTWV0aG9kOiB0aGlzLnNpZ25Jbk1ldGhvZFxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFN0YXRpYyBtZXRob2QgdG8gZGVzZXJpYWxpemUgYSBKU09OIHJlcHJlc2VudGF0aW9uIG9mIGFuIG9iamVjdCBpbnRvIGFuXHJcbiAgICAgKiB7QGxpbmsgIEF1dGhDcmVkZW50aWFsfS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ganNvbiAtIElucHV0IGNhbiBiZSBlaXRoZXIgT2JqZWN0IG9yIHRoZSBzdHJpbmdpZmllZCByZXByZXNlbnRhdGlvbiBvZiB0aGUgb2JqZWN0LlxyXG4gICAgICogV2hlbiBzdHJpbmcgaXMgcHJvdmlkZWQsIEpTT04ucGFyc2Ugd291bGQgYmUgY2FsbGVkIGZpcnN0LlxyXG4gICAgICpcclxuICAgICAqIEByZXR1cm5zIElmIHRoZSBKU09OIGlucHV0IGRvZXMgbm90IHJlcHJlc2VudCBhbiB7QGxpbmsgIEF1dGhDcmVkZW50aWFsfSwgbnVsbCBpcyByZXR1cm5lZC5cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGZyb21KU09OKGpzb24pIHtcclxuICAgICAgICBjb25zdCBvYmogPSB0eXBlb2YganNvbiA9PT0gJ3N0cmluZycgPyBKU09OLnBhcnNlKGpzb24pIDoganNvbjtcclxuICAgICAgICBjb25zdCB7IHByb3ZpZGVySWQsIHNpZ25Jbk1ldGhvZCB9ID0gb2JqLCByZXN0ID0gX19yZXN0KG9iaiwgW1wicHJvdmlkZXJJZFwiLCBcInNpZ25Jbk1ldGhvZFwiXSk7XHJcbiAgICAgICAgaWYgKCFwcm92aWRlcklkIHx8ICFzaWduSW5NZXRob2QpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGNyZWQgPSBuZXcgT0F1dGhDcmVkZW50aWFsKHByb3ZpZGVySWQsIHNpZ25Jbk1ldGhvZCk7XHJcbiAgICAgICAgT2JqZWN0LmFzc2lnbihjcmVkLCByZXN0KTtcclxuICAgICAgICByZXR1cm4gY3JlZDtcclxuICAgIH1cclxuICAgIC8qKiBAaW50ZXJuYWwgKi9cclxuICAgIF9nZXRJZFRva2VuUmVzcG9uc2UoYXV0aCkge1xyXG4gICAgICAgIGNvbnN0IHJlcXVlc3QgPSB0aGlzLmJ1aWxkUmVxdWVzdCgpO1xyXG4gICAgICAgIHJldHVybiBzaWduSW5XaXRoSWRwKGF1dGgsIHJlcXVlc3QpO1xyXG4gICAgfVxyXG4gICAgLyoqIEBpbnRlcm5hbCAqL1xyXG4gICAgX2xpbmtUb0lkVG9rZW4oYXV0aCwgaWRUb2tlbikge1xyXG4gICAgICAgIGNvbnN0IHJlcXVlc3QgPSB0aGlzLmJ1aWxkUmVxdWVzdCgpO1xyXG4gICAgICAgIHJlcXVlc3QuaWRUb2tlbiA9IGlkVG9rZW47XHJcbiAgICAgICAgcmV0dXJuIHNpZ25JbldpdGhJZHAoYXV0aCwgcmVxdWVzdCk7XHJcbiAgICB9XHJcbiAgICAvKiogQGludGVybmFsICovXHJcbiAgICBfZ2V0UmVhdXRoZW50aWNhdGlvblJlc29sdmVyKGF1dGgpIHtcclxuICAgICAgICBjb25zdCByZXF1ZXN0ID0gdGhpcy5idWlsZFJlcXVlc3QoKTtcclxuICAgICAgICByZXF1ZXN0LmF1dG9DcmVhdGUgPSBmYWxzZTtcclxuICAgICAgICByZXR1cm4gc2lnbkluV2l0aElkcChhdXRoLCByZXF1ZXN0KTtcclxuICAgIH1cclxuICAgIGJ1aWxkUmVxdWVzdCgpIHtcclxuICAgICAgICBjb25zdCByZXF1ZXN0ID0ge1xyXG4gICAgICAgICAgICByZXF1ZXN0VXJpOiBJRFBfUkVRVUVTVF9VUkkkMSxcclxuICAgICAgICAgICAgcmV0dXJuU2VjdXJlVG9rZW46IHRydWVcclxuICAgICAgICB9O1xyXG4gICAgICAgIGlmICh0aGlzLnBlbmRpbmdUb2tlbikge1xyXG4gICAgICAgICAgICByZXF1ZXN0LnBlbmRpbmdUb2tlbiA9IHRoaXMucGVuZGluZ1Rva2VuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY29uc3QgcG9zdEJvZHkgPSB7fTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuaWRUb2tlbikge1xyXG4gICAgICAgICAgICAgICAgcG9zdEJvZHlbJ2lkX3Rva2VuJ10gPSB0aGlzLmlkVG9rZW47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMuYWNjZXNzVG9rZW4pIHtcclxuICAgICAgICAgICAgICAgIHBvc3RCb2R5WydhY2Nlc3NfdG9rZW4nXSA9IHRoaXMuYWNjZXNzVG9rZW47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMuc2VjcmV0KSB7XHJcbiAgICAgICAgICAgICAgICBwb3N0Qm9keVsnb2F1dGhfdG9rZW5fc2VjcmV0J10gPSB0aGlzLnNlY3JldDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBwb3N0Qm9keVsncHJvdmlkZXJJZCddID0gdGhpcy5wcm92aWRlcklkO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5ub25jZSAmJiAhdGhpcy5wZW5kaW5nVG9rZW4pIHtcclxuICAgICAgICAgICAgICAgIHBvc3RCb2R5Wydub25jZSddID0gdGhpcy5ub25jZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXF1ZXN0LnBvc3RCb2R5ID0gcXVlcnlzdHJpbmcocG9zdEJvZHkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVxdWVzdDtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBzZW5kUGhvbmVWZXJpZmljYXRpb25Db2RlKGF1dGgsIHJlcXVlc3QpIHtcclxuICAgIHJldHVybiBfcGVyZm9ybUFwaVJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogUE9TVCAqLywgXCIvdjEvYWNjb3VudHM6c2VuZFZlcmlmaWNhdGlvbkNvZGVcIiAvKiBTRU5EX1ZFUklGSUNBVElPTl9DT0RFICovLCBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdCkpO1xyXG59XHJcbmFzeW5jIGZ1bmN0aW9uIHNpZ25JbldpdGhQaG9uZU51bWJlciQxKGF1dGgsIHJlcXVlc3QpIHtcclxuICAgIHJldHVybiBfcGVyZm9ybVNpZ25JblJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogUE9TVCAqLywgXCIvdjEvYWNjb3VudHM6c2lnbkluV2l0aFBob25lTnVtYmVyXCIgLyogU0lHTl9JTl9XSVRIX1BIT05FX05VTUJFUiAqLywgX2FkZFRpZElmTmVjZXNzYXJ5KGF1dGgsIHJlcXVlc3QpKTtcclxufVxyXG5hc3luYyBmdW5jdGlvbiBsaW5rV2l0aFBob25lTnVtYmVyJDEoYXV0aCwgcmVxdWVzdCkge1xyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBfcGVyZm9ybVNpZ25JblJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogUE9TVCAqLywgXCIvdjEvYWNjb3VudHM6c2lnbkluV2l0aFBob25lTnVtYmVyXCIgLyogU0lHTl9JTl9XSVRIX1BIT05FX05VTUJFUiAqLywgX2FkZFRpZElmTmVjZXNzYXJ5KGF1dGgsIHJlcXVlc3QpKTtcclxuICAgIGlmIChyZXNwb25zZS50ZW1wb3JhcnlQcm9vZikge1xyXG4gICAgICAgIHRocm93IF9tYWtlVGFnZ2VkRXJyb3IoYXV0aCwgXCJhY2NvdW50LWV4aXN0cy13aXRoLWRpZmZlcmVudC1jcmVkZW50aWFsXCIgLyogTkVFRF9DT05GSVJNQVRJT04gKi8sIHJlc3BvbnNlKTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXNwb25zZTtcclxufVxyXG5jb25zdCBWRVJJRllfUEhPTkVfTlVNQkVSX0ZPUl9FWElTVElOR19FUlJPUl9NQVBfID0ge1xyXG4gICAgW1wiVVNFUl9OT1RfRk9VTkRcIiAvKiBVU0VSX05PVF9GT1VORCAqL106IFwidXNlci1ub3QtZm91bmRcIiAvKiBVU0VSX0RFTEVURUQgKi9cclxufTtcclxuYXN5bmMgZnVuY3Rpb24gdmVyaWZ5UGhvbmVOdW1iZXJGb3JFeGlzdGluZyhhdXRoLCByZXF1ZXN0KSB7XHJcbiAgICBjb25zdCBhcGlSZXF1ZXN0ID0gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCByZXF1ZXN0KSwgeyBvcGVyYXRpb246ICdSRUFVVEgnIH0pO1xyXG4gICAgcmV0dXJuIF9wZXJmb3JtU2lnbkluUmVxdWVzdChhdXRoLCBcIlBPU1RcIiAvKiBQT1NUICovLCBcIi92MS9hY2NvdW50czpzaWduSW5XaXRoUGhvbmVOdW1iZXJcIiAvKiBTSUdOX0lOX1dJVEhfUEhPTkVfTlVNQkVSICovLCBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgYXBpUmVxdWVzdCksIFZFUklGWV9QSE9ORV9OVU1CRVJfRk9SX0VYSVNUSU5HX0VSUk9SX01BUF8pO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBSZXByZXNlbnRzIHRoZSBjcmVkZW50aWFscyByZXR1cm5lZCBieSB7QGxpbmsgUGhvbmVBdXRoUHJvdmlkZXJ9LlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5jbGFzcyBQaG9uZUF1dGhDcmVkZW50aWFsIGV4dGVuZHMgQXV0aENyZWRlbnRpYWwge1xyXG4gICAgY29uc3RydWN0b3IocGFyYW1zKSB7XHJcbiAgICAgICAgc3VwZXIoXCJwaG9uZVwiIC8qIFBIT05FICovLCBcInBob25lXCIgLyogUEhPTkUgKi8pO1xyXG4gICAgICAgIHRoaXMucGFyYW1zID0gcGFyYW1zO1xyXG4gICAgfVxyXG4gICAgLyoqIEBpbnRlcm5hbCAqL1xyXG4gICAgc3RhdGljIF9mcm9tVmVyaWZpY2F0aW9uKHZlcmlmaWNhdGlvbklkLCB2ZXJpZmljYXRpb25Db2RlKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQaG9uZUF1dGhDcmVkZW50aWFsKHsgdmVyaWZpY2F0aW9uSWQsIHZlcmlmaWNhdGlvbkNvZGUgfSk7XHJcbiAgICB9XHJcbiAgICAvKiogQGludGVybmFsICovXHJcbiAgICBzdGF0aWMgX2Zyb21Ub2tlblJlc3BvbnNlKHBob25lTnVtYmVyLCB0ZW1wb3JhcnlQcm9vZikge1xyXG4gICAgICAgIHJldHVybiBuZXcgUGhvbmVBdXRoQ3JlZGVudGlhbCh7IHBob25lTnVtYmVyLCB0ZW1wb3JhcnlQcm9vZiB9KTtcclxuICAgIH1cclxuICAgIC8qKiBAaW50ZXJuYWwgKi9cclxuICAgIF9nZXRJZFRva2VuUmVzcG9uc2UoYXV0aCkge1xyXG4gICAgICAgIHJldHVybiBzaWduSW5XaXRoUGhvbmVOdW1iZXIkMShhdXRoLCB0aGlzLl9tYWtlVmVyaWZpY2F0aW9uUmVxdWVzdCgpKTtcclxuICAgIH1cclxuICAgIC8qKiBAaW50ZXJuYWwgKi9cclxuICAgIF9saW5rVG9JZFRva2VuKGF1dGgsIGlkVG9rZW4pIHtcclxuICAgICAgICByZXR1cm4gbGlua1dpdGhQaG9uZU51bWJlciQxKGF1dGgsIE9iamVjdC5hc3NpZ24oeyBpZFRva2VuIH0sIHRoaXMuX21ha2VWZXJpZmljYXRpb25SZXF1ZXN0KCkpKTtcclxuICAgIH1cclxuICAgIC8qKiBAaW50ZXJuYWwgKi9cclxuICAgIF9nZXRSZWF1dGhlbnRpY2F0aW9uUmVzb2x2ZXIoYXV0aCkge1xyXG4gICAgICAgIHJldHVybiB2ZXJpZnlQaG9uZU51bWJlckZvckV4aXN0aW5nKGF1dGgsIHRoaXMuX21ha2VWZXJpZmljYXRpb25SZXF1ZXN0KCkpO1xyXG4gICAgfVxyXG4gICAgLyoqIEBpbnRlcm5hbCAqL1xyXG4gICAgX21ha2VWZXJpZmljYXRpb25SZXF1ZXN0KCkge1xyXG4gICAgICAgIGNvbnN0IHsgdGVtcG9yYXJ5UHJvb2YsIHBob25lTnVtYmVyLCB2ZXJpZmljYXRpb25JZCwgdmVyaWZpY2F0aW9uQ29kZSB9ID0gdGhpcy5wYXJhbXM7XHJcbiAgICAgICAgaWYgKHRlbXBvcmFyeVByb29mICYmIHBob25lTnVtYmVyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHRlbXBvcmFyeVByb29mLCBwaG9uZU51bWJlciB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzZXNzaW9uSW5mbzogdmVyaWZpY2F0aW9uSWQsXHJcbiAgICAgICAgICAgIGNvZGU6IHZlcmlmaWNhdGlvbkNvZGVcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG4gICAgLyoqIHtAaW5oZXJpdGRvYyBBdXRoQ3JlZGVudGlhbC50b0pTT059ICovXHJcbiAgICB0b0pTT04oKSB7XHJcbiAgICAgICAgY29uc3Qgb2JqID0ge1xyXG4gICAgICAgICAgICBwcm92aWRlcklkOiB0aGlzLnByb3ZpZGVySWRcclxuICAgICAgICB9O1xyXG4gICAgICAgIGlmICh0aGlzLnBhcmFtcy5waG9uZU51bWJlcikge1xyXG4gICAgICAgICAgICBvYmoucGhvbmVOdW1iZXIgPSB0aGlzLnBhcmFtcy5waG9uZU51bWJlcjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMucGFyYW1zLnRlbXBvcmFyeVByb29mKSB7XHJcbiAgICAgICAgICAgIG9iai50ZW1wb3JhcnlQcm9vZiA9IHRoaXMucGFyYW1zLnRlbXBvcmFyeVByb29mO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5wYXJhbXMudmVyaWZpY2F0aW9uQ29kZSkge1xyXG4gICAgICAgICAgICBvYmoudmVyaWZpY2F0aW9uQ29kZSA9IHRoaXMucGFyYW1zLnZlcmlmaWNhdGlvbkNvZGU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnBhcmFtcy52ZXJpZmljYXRpb25JZCkge1xyXG4gICAgICAgICAgICBvYmoudmVyaWZpY2F0aW9uSWQgPSB0aGlzLnBhcmFtcy52ZXJpZmljYXRpb25JZDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG9iajtcclxuICAgIH1cclxuICAgIC8qKiBHZW5lcmF0ZXMgYSBwaG9uZSBjcmVkZW50aWFsIGJhc2VkIG9uIGEgcGxhaW4gb2JqZWN0IG9yIGEgSlNPTiBzdHJpbmcuICovXHJcbiAgICBzdGF0aWMgZnJvbUpTT04oanNvbikge1xyXG4gICAgICAgIGlmICh0eXBlb2YganNvbiA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAganNvbiA9IEpTT04ucGFyc2UoanNvbik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHsgdmVyaWZpY2F0aW9uSWQsIHZlcmlmaWNhdGlvbkNvZGUsIHBob25lTnVtYmVyLCB0ZW1wb3JhcnlQcm9vZiB9ID0ganNvbjtcclxuICAgICAgICBpZiAoIXZlcmlmaWNhdGlvbkNvZGUgJiZcclxuICAgICAgICAgICAgIXZlcmlmaWNhdGlvbklkICYmXHJcbiAgICAgICAgICAgICFwaG9uZU51bWJlciAmJlxyXG4gICAgICAgICAgICAhdGVtcG9yYXJ5UHJvb2YpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuZXcgUGhvbmVBdXRoQ3JlZGVudGlhbCh7XHJcbiAgICAgICAgICAgIHZlcmlmaWNhdGlvbklkLFxyXG4gICAgICAgICAgICB2ZXJpZmljYXRpb25Db2RlLFxyXG4gICAgICAgICAgICBwaG9uZU51bWJlcixcclxuICAgICAgICAgICAgdGVtcG9yYXJ5UHJvb2ZcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogTWFwcyB0aGUgbW9kZSBzdHJpbmcgaW4gYWN0aW9uIGNvZGUgVVJMIHRvIEFjdGlvbiBDb2RlIEluZm8gb3BlcmF0aW9uLlxyXG4gKlxyXG4gKiBAcGFyYW0gbW9kZVxyXG4gKi9cclxuZnVuY3Rpb24gcGFyc2VNb2RlKG1vZGUpIHtcclxuICAgIHN3aXRjaCAobW9kZSkge1xyXG4gICAgICAgIGNhc2UgJ3JlY292ZXJFbWFpbCc6XHJcbiAgICAgICAgICAgIHJldHVybiBcIlJFQ09WRVJfRU1BSUxcIiAvKiBSRUNPVkVSX0VNQUlMICovO1xyXG4gICAgICAgIGNhc2UgJ3Jlc2V0UGFzc3dvcmQnOlxyXG4gICAgICAgICAgICByZXR1cm4gXCJQQVNTV09SRF9SRVNFVFwiIC8qIFBBU1NXT1JEX1JFU0VUICovO1xyXG4gICAgICAgIGNhc2UgJ3NpZ25Jbic6XHJcbiAgICAgICAgICAgIHJldHVybiBcIkVNQUlMX1NJR05JTlwiIC8qIEVNQUlMX1NJR05JTiAqLztcclxuICAgICAgICBjYXNlICd2ZXJpZnlFbWFpbCc6XHJcbiAgICAgICAgICAgIHJldHVybiBcIlZFUklGWV9FTUFJTFwiIC8qIFZFUklGWV9FTUFJTCAqLztcclxuICAgICAgICBjYXNlICd2ZXJpZnlBbmRDaGFuZ2VFbWFpbCc6XHJcbiAgICAgICAgICAgIHJldHVybiBcIlZFUklGWV9BTkRfQ0hBTkdFX0VNQUlMXCIgLyogVkVSSUZZX0FORF9DSEFOR0VfRU1BSUwgKi87XHJcbiAgICAgICAgY2FzZSAncmV2ZXJ0U2Vjb25kRmFjdG9yQWRkaXRpb24nOlxyXG4gICAgICAgICAgICByZXR1cm4gXCJSRVZFUlRfU0VDT05EX0ZBQ1RPUl9BRERJVElPTlwiIC8qIFJFVkVSVF9TRUNPTkRfRkFDVE9SX0FERElUSU9OICovO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBIZWxwZXIgdG8gcGFyc2UgRkRMIGxpbmtzXHJcbiAqXHJcbiAqIEBwYXJhbSB1cmxcclxuICovXHJcbmZ1bmN0aW9uIHBhcnNlRGVlcExpbmsodXJsKSB7XHJcbiAgICBjb25zdCBsaW5rID0gcXVlcnlzdHJpbmdEZWNvZGUoZXh0cmFjdFF1ZXJ5c3RyaW5nKHVybCkpWydsaW5rJ107XHJcbiAgICAvLyBEb3VibGUgbGluayBjYXNlIChhdXRvbWF0aWMgcmVkaXJlY3QpLlxyXG4gICAgY29uc3QgZG91YmxlRGVlcExpbmsgPSBsaW5rXHJcbiAgICAgICAgPyBxdWVyeXN0cmluZ0RlY29kZShleHRyYWN0UXVlcnlzdHJpbmcobGluaykpWydkZWVwX2xpbmtfaWQnXVxyXG4gICAgICAgIDogbnVsbDtcclxuICAgIC8vIGlPUyBjdXN0b20gc2NoZW1lIGxpbmtzLlxyXG4gICAgY29uc3QgaU9TRGVlcExpbmsgPSBxdWVyeXN0cmluZ0RlY29kZShleHRyYWN0UXVlcnlzdHJpbmcodXJsKSlbJ2RlZXBfbGlua19pZCddO1xyXG4gICAgY29uc3QgaU9TRG91YmxlRGVlcExpbmsgPSBpT1NEZWVwTGlua1xyXG4gICAgICAgID8gcXVlcnlzdHJpbmdEZWNvZGUoZXh0cmFjdFF1ZXJ5c3RyaW5nKGlPU0RlZXBMaW5rKSlbJ2xpbmsnXVxyXG4gICAgICAgIDogbnVsbDtcclxuICAgIHJldHVybiBpT1NEb3VibGVEZWVwTGluayB8fCBpT1NEZWVwTGluayB8fCBkb3VibGVEZWVwTGluayB8fCBsaW5rIHx8IHVybDtcclxufVxyXG4vKipcclxuICogQSB1dGlsaXR5IGNsYXNzIHRvIHBhcnNlIGVtYWlsIGFjdGlvbiBVUkxzIHN1Y2ggYXMgcGFzc3dvcmQgcmVzZXQsIGVtYWlsIHZlcmlmaWNhdGlvbixcclxuICogZW1haWwgbGluayBzaWduIGluLCBldGMuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmNsYXNzIEFjdGlvbkNvZGVVUkwge1xyXG4gICAgLyoqXHJcbiAgICAgKiBAcGFyYW0gYWN0aW9uTGluayAtIFRoZSBsaW5rIGZyb20gd2hpY2ggdG8gZXh0cmFjdCB0aGUgVVJMLlxyXG4gICAgICogQHJldHVybnMgVGhlIHtAbGluayBBY3Rpb25Db2RlVVJMfSBvYmplY3QsIG9yIG51bGwgaWYgdGhlIGxpbmsgaXMgaW52YWxpZC5cclxuICAgICAqXHJcbiAgICAgKiBAaW50ZXJuYWxcclxuICAgICAqL1xyXG4gICAgY29uc3RydWN0b3IoYWN0aW9uTGluaykge1xyXG4gICAgICAgIHZhciBfYSwgX2IsIF9jLCBfZCwgX2UsIF9mO1xyXG4gICAgICAgIGNvbnN0IHNlYXJjaFBhcmFtcyA9IHF1ZXJ5c3RyaW5nRGVjb2RlKGV4dHJhY3RRdWVyeXN0cmluZyhhY3Rpb25MaW5rKSk7XHJcbiAgICAgICAgY29uc3QgYXBpS2V5ID0gKF9hID0gc2VhcmNoUGFyYW1zW1wiYXBpS2V5XCIgLyogQVBJX0tFWSAqL10pICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IG51bGw7XHJcbiAgICAgICAgY29uc3QgY29kZSA9IChfYiA9IHNlYXJjaFBhcmFtc1tcIm9vYkNvZGVcIiAvKiBDT0RFICovXSkgIT09IG51bGwgJiYgX2IgIT09IHZvaWQgMCA/IF9iIDogbnVsbDtcclxuICAgICAgICBjb25zdCBvcGVyYXRpb24gPSBwYXJzZU1vZGUoKF9jID0gc2VhcmNoUGFyYW1zW1wibW9kZVwiIC8qIE1PREUgKi9dKSAhPT0gbnVsbCAmJiBfYyAhPT0gdm9pZCAwID8gX2MgOiBudWxsKTtcclxuICAgICAgICAvLyBWYWxpZGF0ZSBBUEkga2V5LCBjb2RlIGFuZCBtb2RlLlxyXG4gICAgICAgIF9hc3NlcnQoYXBpS2V5ICYmIGNvZGUgJiYgb3BlcmF0aW9uLCBcImFyZ3VtZW50LWVycm9yXCIgLyogQVJHVU1FTlRfRVJST1IgKi8pO1xyXG4gICAgICAgIHRoaXMuYXBpS2V5ID0gYXBpS2V5O1xyXG4gICAgICAgIHRoaXMub3BlcmF0aW9uID0gb3BlcmF0aW9uO1xyXG4gICAgICAgIHRoaXMuY29kZSA9IGNvZGU7XHJcbiAgICAgICAgdGhpcy5jb250aW51ZVVybCA9IChfZCA9IHNlYXJjaFBhcmFtc1tcImNvbnRpbnVlVXJsXCIgLyogQ09OVElOVUVfVVJMICovXSkgIT09IG51bGwgJiYgX2QgIT09IHZvaWQgMCA/IF9kIDogbnVsbDtcclxuICAgICAgICB0aGlzLmxhbmd1YWdlQ29kZSA9IChfZSA9IHNlYXJjaFBhcmFtc1tcImxhbmd1YWdlQ29kZVwiIC8qIExBTkdVQUdFX0NPREUgKi9dKSAhPT0gbnVsbCAmJiBfZSAhPT0gdm9pZCAwID8gX2UgOiBudWxsO1xyXG4gICAgICAgIHRoaXMudGVuYW50SWQgPSAoX2YgPSBzZWFyY2hQYXJhbXNbXCJ0ZW5hbnRJZFwiIC8qIFRFTkFOVF9JRCAqL10pICE9PSBudWxsICYmIF9mICE9PSB2b2lkIDAgPyBfZiA6IG51bGw7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFBhcnNlcyB0aGUgZW1haWwgYWN0aW9uIGxpbmsgc3RyaW5nIGFuZCByZXR1cm5zIGFuIHtAbGluayBBY3Rpb25Db2RlVVJMfSBpZiB0aGUgbGluayBpcyB2YWxpZCxcclxuICAgICAqIG90aGVyd2lzZSByZXR1cm5zIG51bGwuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGxpbmsgIC0gVGhlIGVtYWlsIGFjdGlvbiBsaW5rIHN0cmluZy5cclxuICAgICAqIEByZXR1cm5zIFRoZSB7QGxpbmsgQWN0aW9uQ29kZVVSTH0gb2JqZWN0LCBvciBudWxsIGlmIHRoZSBsaW5rIGlzIGludmFsaWQuXHJcbiAgICAgKlxyXG4gICAgICogQHB1YmxpY1xyXG4gICAgICovXHJcbiAgICBzdGF0aWMgcGFyc2VMaW5rKGxpbmspIHtcclxuICAgICAgICBjb25zdCBhY3Rpb25MaW5rID0gcGFyc2VEZWVwTGluayhsaW5rKTtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IEFjdGlvbkNvZGVVUkwoYWN0aW9uTGluayk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChfYSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIFBhcnNlcyB0aGUgZW1haWwgYWN0aW9uIGxpbmsgc3RyaW5nIGFuZCByZXR1cm5zIGFuIHtAbGluayBBY3Rpb25Db2RlVVJMfSBpZlxyXG4gKiB0aGUgbGluayBpcyB2YWxpZCwgb3RoZXJ3aXNlIHJldHVybnMgbnVsbC5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuZnVuY3Rpb24gcGFyc2VBY3Rpb25Db2RlVVJMKGxpbmspIHtcclxuICAgIHJldHVybiBBY3Rpb25Db2RlVVJMLnBhcnNlTGluayhsaW5rKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogUHJvdmlkZXIgZm9yIGdlbmVyYXRpbmcge0BsaW5rIEVtYWlsQXV0aENyZWRlbnRpYWx9LlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5jbGFzcyBFbWFpbEF1dGhQcm92aWRlciB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBBbHdheXMgc2V0IHRvIHtAbGluayBQcm92aWRlcklkfS5QQVNTV09SRCwgZXZlbiBmb3IgZW1haWwgbGluay5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLnByb3ZpZGVySWQgPSBFbWFpbEF1dGhQcm92aWRlci5QUk9WSURFUl9JRDtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogSW5pdGlhbGl6ZSBhbiB7QGxpbmsgQXV0aENyZWRlbnRpYWx9IHVzaW5nIGFuIGVtYWlsIGFuZCBwYXNzd29yZC5cclxuICAgICAqXHJcbiAgICAgKiBAZXhhbXBsZVxyXG4gICAgICogYGBgamF2YXNjcmlwdFxyXG4gICAgICogY29uc3QgYXV0aENyZWRlbnRpYWwgPSBFbWFpbEF1dGhQcm92aWRlci5jcmVkZW50aWFsKGVtYWlsLCBwYXNzd29yZCk7XHJcbiAgICAgKiBjb25zdCB1c2VyQ3JlZGVudGlhbCA9IGF3YWl0IHNpZ25JbldpdGhDcmVkZW50aWFsKGF1dGgsIGF1dGhDcmVkZW50aWFsKTtcclxuICAgICAqIGBgYFxyXG4gICAgICpcclxuICAgICAqIEBleGFtcGxlXHJcbiAgICAgKiBgYGBqYXZhc2NyaXB0XHJcbiAgICAgKiBjb25zdCB1c2VyQ3JlZGVudGlhbCA9IGF3YWl0IHNpZ25JbldpdGhFbWFpbEFuZFBhc3N3b3JkKGF1dGgsIGVtYWlsLCBwYXNzd29yZCk7XHJcbiAgICAgKiBgYGBcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gZW1haWwgLSBFbWFpbCBhZGRyZXNzLlxyXG4gICAgICogQHBhcmFtIHBhc3N3b3JkIC0gVXNlciBhY2NvdW50IHBhc3N3b3JkLlxyXG4gICAgICogQHJldHVybnMgVGhlIGF1dGggcHJvdmlkZXIgY3JlZGVudGlhbC5cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGNyZWRlbnRpYWwoZW1haWwsIHBhc3N3b3JkKSB7XHJcbiAgICAgICAgcmV0dXJuIEVtYWlsQXV0aENyZWRlbnRpYWwuX2Zyb21FbWFpbEFuZFBhc3N3b3JkKGVtYWlsLCBwYXNzd29yZCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEluaXRpYWxpemUgYW4ge0BsaW5rIEF1dGhDcmVkZW50aWFsfSB1c2luZyBhbiBlbWFpbCBhbmQgYW4gZW1haWwgbGluayBhZnRlciBhIHNpZ24gaW4gd2l0aFxyXG4gICAgICogZW1haWwgbGluayBvcGVyYXRpb24uXHJcbiAgICAgKlxyXG4gICAgICogQGV4YW1wbGVcclxuICAgICAqIGBgYGphdmFzY3JpcHRcclxuICAgICAqIGNvbnN0IGF1dGhDcmVkZW50aWFsID0gRW1haWxBdXRoUHJvdmlkZXIuY3JlZGVudGlhbFdpdGhMaW5rKGF1dGgsIGVtYWlsLCBlbWFpbExpbmspO1xyXG4gICAgICogY29uc3QgdXNlckNyZWRlbnRpYWwgPSBhd2FpdCBzaWduSW5XaXRoQ3JlZGVudGlhbChhdXRoLCBhdXRoQ3JlZGVudGlhbCk7XHJcbiAgICAgKiBgYGBcclxuICAgICAqXHJcbiAgICAgKiBAZXhhbXBsZVxyXG4gICAgICogYGBgamF2YXNjcmlwdFxyXG4gICAgICogYXdhaXQgc2VuZFNpZ25JbkxpbmtUb0VtYWlsKGF1dGgsIGVtYWlsKTtcclxuICAgICAqIC8vIE9idGFpbiBlbWFpbExpbmsgZnJvbSB1c2VyLlxyXG4gICAgICogY29uc3QgdXNlckNyZWRlbnRpYWwgPSBhd2FpdCBzaWduSW5XaXRoRW1haWxMaW5rKGF1dGgsIGVtYWlsLCBlbWFpbExpbmspO1xyXG4gICAgICogYGBgXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlIHVzZWQgdG8gdmVyaWZ5IHRoZSBsaW5rLlxyXG4gICAgICogQHBhcmFtIGVtYWlsIC0gRW1haWwgYWRkcmVzcy5cclxuICAgICAqIEBwYXJhbSBlbWFpbExpbmsgLSBTaWduLWluIGVtYWlsIGxpbmsuXHJcbiAgICAgKiBAcmV0dXJucyAtIFRoZSBhdXRoIHByb3ZpZGVyIGNyZWRlbnRpYWwuXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBjcmVkZW50aWFsV2l0aExpbmsoZW1haWwsIGVtYWlsTGluaykge1xyXG4gICAgICAgIGNvbnN0IGFjdGlvbkNvZGVVcmwgPSBBY3Rpb25Db2RlVVJMLnBhcnNlTGluayhlbWFpbExpbmspO1xyXG4gICAgICAgIF9hc3NlcnQoYWN0aW9uQ29kZVVybCwgXCJhcmd1bWVudC1lcnJvclwiIC8qIEFSR1VNRU5UX0VSUk9SICovKTtcclxuICAgICAgICByZXR1cm4gRW1haWxBdXRoQ3JlZGVudGlhbC5fZnJvbUVtYWlsQW5kQ29kZShlbWFpbCwgYWN0aW9uQ29kZVVybC5jb2RlLCBhY3Rpb25Db2RlVXJsLnRlbmFudElkKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogQWx3YXlzIHNldCB0byB7QGxpbmsgUHJvdmlkZXJJZH0uUEFTU1dPUkQsIGV2ZW4gZm9yIGVtYWlsIGxpbmsuXHJcbiAqL1xyXG5FbWFpbEF1dGhQcm92aWRlci5QUk9WSURFUl9JRCA9IFwicGFzc3dvcmRcIiAvKiBQQVNTV09SRCAqLztcclxuLyoqXHJcbiAqIEFsd2F5cyBzZXQgdG8ge0BsaW5rIFNpZ25Jbk1ldGhvZH0uRU1BSUxfUEFTU1dPUkQuXHJcbiAqL1xyXG5FbWFpbEF1dGhQcm92aWRlci5FTUFJTF9QQVNTV09SRF9TSUdOX0lOX01FVEhPRCA9IFwicGFzc3dvcmRcIiAvKiBFTUFJTF9QQVNTV09SRCAqLztcclxuLyoqXHJcbiAqIEFsd2F5cyBzZXQgdG8ge0BsaW5rIFNpZ25Jbk1ldGhvZH0uRU1BSUxfTElOSy5cclxuICovXHJcbkVtYWlsQXV0aFByb3ZpZGVyLkVNQUlMX0xJTktfU0lHTl9JTl9NRVRIT0QgPSBcImVtYWlsTGlua1wiIC8qIEVNQUlMX0xJTksgKi87XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBUaGUgYmFzZSBjbGFzcyBmb3IgYWxsIEZlZGVyYXRlZCBwcm92aWRlcnMgKE9BdXRoIChpbmNsdWRpbmcgT0lEQyksIFNBTUwpLlxyXG4gKlxyXG4gKiBUaGlzIGNsYXNzIGlzIG5vdCBtZWFudCB0byBiZSBpbnN0YW50aWF0ZWQgZGlyZWN0bHkuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmNsYXNzIEZlZGVyYXRlZEF1dGhQcm92aWRlciB7XHJcbiAgICAvKipcclxuICAgICAqIENvbnN0cnVjdG9yIGZvciBnZW5lcmljIE9BdXRoIHByb3ZpZGVycy5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gcHJvdmlkZXJJZCAtIFByb3ZpZGVyIGZvciB3aGljaCBjcmVkZW50aWFscyBzaG91bGQgYmUgZ2VuZXJhdGVkLlxyXG4gICAgICovXHJcbiAgICBjb25zdHJ1Y3Rvcihwcm92aWRlcklkKSB7XHJcbiAgICAgICAgdGhpcy5wcm92aWRlcklkID0gcHJvdmlkZXJJZDtcclxuICAgICAgICAvKiogQGludGVybmFsICovXHJcbiAgICAgICAgdGhpcy5kZWZhdWx0TGFuZ3VhZ2VDb2RlID0gbnVsbDtcclxuICAgICAgICAvKiogQGludGVybmFsICovXHJcbiAgICAgICAgdGhpcy5jdXN0b21QYXJhbWV0ZXJzID0ge307XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFNldCB0aGUgbGFuZ3VhZ2UgZ29kZS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gbGFuZ3VhZ2VDb2RlIC0gbGFuZ3VhZ2UgY29kZVxyXG4gICAgICovXHJcbiAgICBzZXREZWZhdWx0TGFuZ3VhZ2UobGFuZ3VhZ2VDb2RlKSB7XHJcbiAgICAgICAgdGhpcy5kZWZhdWx0TGFuZ3VhZ2VDb2RlID0gbGFuZ3VhZ2VDb2RlO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBTZXRzIHRoZSBPQXV0aCBjdXN0b20gcGFyYW1ldGVycyB0byBwYXNzIGluIGFuIE9BdXRoIHJlcXVlc3QgZm9yIHBvcHVwIGFuZCByZWRpcmVjdCBzaWduLWluXHJcbiAgICAgKiBvcGVyYXRpb25zLlxyXG4gICAgICpcclxuICAgICAqIEByZW1hcmtzXHJcbiAgICAgKiBGb3IgYSBkZXRhaWxlZCBsaXN0LCBjaGVjayB0aGUgcmVzZXJ2ZWQgcmVxdWlyZWQgT0F1dGggMi4wIHBhcmFtZXRlcnMgc3VjaCBhcyBgY2xpZW50X2lkYCxcclxuICAgICAqIGByZWRpcmVjdF91cmlgLCBgc2NvcGVgLCBgcmVzcG9uc2VfdHlwZWAsIGFuZCBgc3RhdGVgIGFyZSBub3QgYWxsb3dlZCBhbmQgd2lsbCBiZSBpZ25vcmVkLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBjdXN0b21PQXV0aFBhcmFtZXRlcnMgLSBUaGUgY3VzdG9tIE9BdXRoIHBhcmFtZXRlcnMgdG8gcGFzcyBpbiB0aGUgT0F1dGggcmVxdWVzdC5cclxuICAgICAqL1xyXG4gICAgc2V0Q3VzdG9tUGFyYW1ldGVycyhjdXN0b21PQXV0aFBhcmFtZXRlcnMpIHtcclxuICAgICAgICB0aGlzLmN1c3RvbVBhcmFtZXRlcnMgPSBjdXN0b21PQXV0aFBhcmFtZXRlcnM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFJldHJpZXZlIHRoZSBjdXJyZW50IGxpc3Qgb2Yge0BsaW5rIEN1c3RvbVBhcmFtZXRlcnN9LlxyXG4gICAgICovXHJcbiAgICBnZXRDdXN0b21QYXJhbWV0ZXJzKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmN1c3RvbVBhcmFtZXRlcnM7XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIENvbW1vbiBjb2RlIHRvIGFsbCBPQXV0aCBwcm92aWRlcnMuIFRoaXMgaXMgc2VwYXJhdGUgZnJvbSB0aGVcclxuICoge0BsaW5rIE9BdXRoUHJvdmlkZXJ9IHNvIHRoYXQgY2hpbGQgcHJvdmlkZXJzIChsaWtlXHJcbiAqIHtAbGluayBHb29nbGVBdXRoUHJvdmlkZXJ9KSBkb24ndCBpbmhlcml0IHRoZSBgY3JlZGVudGlhbGAgaW5zdGFuY2UgbWV0aG9kLlxyXG4gKiBJbnN0ZWFkLCB0aGV5IHJlbHkgb24gYSBzdGF0aWMgYGNyZWRlbnRpYWxgIG1ldGhvZC5cclxuICovXHJcbmNsYXNzIEJhc2VPQXV0aFByb3ZpZGVyIGV4dGVuZHMgRmVkZXJhdGVkQXV0aFByb3ZpZGVyIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHN1cGVyKC4uLmFyZ3VtZW50cyk7XHJcbiAgICAgICAgLyoqIEBpbnRlcm5hbCAqL1xyXG4gICAgICAgIHRoaXMuc2NvcGVzID0gW107XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEFkZCBhbiBPQXV0aCBzY29wZSB0byB0aGUgY3JlZGVudGlhbC5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gc2NvcGUgLSBQcm92aWRlciBPQXV0aCBzY29wZSB0byBhZGQuXHJcbiAgICAgKi9cclxuICAgIGFkZFNjb3BlKHNjb3BlKSB7XHJcbiAgICAgICAgLy8gSWYgbm90IGFscmVhZHkgYWRkZWQsIGFkZCBzY29wZSB0byBsaXN0LlxyXG4gICAgICAgIGlmICghdGhpcy5zY29wZXMuaW5jbHVkZXMoc2NvcGUpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2NvcGVzLnB1c2goc2NvcGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUmV0cmlldmUgdGhlIGN1cnJlbnQgbGlzdCBvZiBPQXV0aCBzY29wZXMuXHJcbiAgICAgKi9cclxuICAgIGdldFNjb3BlcygpIHtcclxuICAgICAgICByZXR1cm4gWy4uLnRoaXMuc2NvcGVzXTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogUHJvdmlkZXIgZm9yIGdlbmVyYXRpbmcgZ2VuZXJpYyB7QGxpbmsgT0F1dGhDcmVkZW50aWFsfS5cclxuICpcclxuICogQGV4YW1wbGVcclxuICogYGBgamF2YXNjcmlwdFxyXG4gKiAvLyBTaWduIGluIHVzaW5nIGEgcmVkaXJlY3QuXHJcbiAqIGNvbnN0IHByb3ZpZGVyID0gbmV3IE9BdXRoUHJvdmlkZXIoJ2dvb2dsZS5jb20nKTtcclxuICogLy8gU3RhcnQgYSBzaWduIGluIHByb2Nlc3MgZm9yIGFuIHVuYXV0aGVudGljYXRlZCB1c2VyLlxyXG4gKiBwcm92aWRlci5hZGRTY29wZSgncHJvZmlsZScpO1xyXG4gKiBwcm92aWRlci5hZGRTY29wZSgnZW1haWwnKTtcclxuICogYXdhaXQgc2lnbkluV2l0aFJlZGlyZWN0KGF1dGgsIHByb3ZpZGVyKTtcclxuICogLy8gVGhpcyB3aWxsIHRyaWdnZXIgYSBmdWxsIHBhZ2UgcmVkaXJlY3QgYXdheSBmcm9tIHlvdXIgYXBwXHJcbiAqXHJcbiAqIC8vIEFmdGVyIHJldHVybmluZyBmcm9tIHRoZSByZWRpcmVjdCB3aGVuIHlvdXIgYXBwIGluaXRpYWxpemVzIHlvdSBjYW4gb2J0YWluIHRoZSByZXN1bHRcclxuICogY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2V0UmVkaXJlY3RSZXN1bHQoYXV0aCk7XHJcbiAqIGlmIChyZXN1bHQpIHtcclxuICogICAvLyBUaGlzIGlzIHRoZSBzaWduZWQtaW4gdXNlclxyXG4gKiAgIGNvbnN0IHVzZXIgPSByZXN1bHQudXNlcjtcclxuICogICAvLyBUaGlzIGdpdmVzIHlvdSBhIE9BdXRoIEFjY2VzcyBUb2tlbiBmb3IgdGhlIHByb3ZpZGVyLlxyXG4gKiAgIGNvbnN0IGNyZWRlbnRpYWwgPSBwcm92aWRlci5jcmVkZW50aWFsRnJvbVJlc3VsdChhdXRoLCByZXN1bHQpO1xyXG4gKiAgIGNvbnN0IHRva2VuID0gY3JlZGVudGlhbC5hY2Nlc3NUb2tlbjtcclxuICogfVxyXG4gKiBgYGBcclxuICpcclxuICogQGV4YW1wbGVcclxuICogYGBgamF2YXNjcmlwdFxyXG4gKiAvLyBTaWduIGluIHVzaW5nIGEgcG9wdXAuXHJcbiAqIGNvbnN0IHByb3ZpZGVyID0gbmV3IE9BdXRoUHJvdmlkZXIoJ2dvb2dsZS5jb20nKTtcclxuICogcHJvdmlkZXIuYWRkU2NvcGUoJ3Byb2ZpbGUnKTtcclxuICogcHJvdmlkZXIuYWRkU2NvcGUoJ2VtYWlsJyk7XHJcbiAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNpZ25JbldpdGhQb3B1cChhdXRoLCBwcm92aWRlcik7XHJcbiAqXHJcbiAqIC8vIFRoZSBzaWduZWQtaW4gdXNlciBpbmZvLlxyXG4gKiBjb25zdCB1c2VyID0gcmVzdWx0LnVzZXI7XHJcbiAqIC8vIFRoaXMgZ2l2ZXMgeW91IGEgT0F1dGggQWNjZXNzIFRva2VuIGZvciB0aGUgcHJvdmlkZXIuXHJcbiAqIGNvbnN0IGNyZWRlbnRpYWwgPSBwcm92aWRlci5jcmVkZW50aWFsRnJvbVJlc3VsdChhdXRoLCByZXN1bHQpO1xyXG4gKiBjb25zdCB0b2tlbiA9IGNyZWRlbnRpYWwuYWNjZXNzVG9rZW47XHJcbiAqIGBgYFxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5jbGFzcyBPQXV0aFByb3ZpZGVyIGV4dGVuZHMgQmFzZU9BdXRoUHJvdmlkZXIge1xyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGFuIHtAbGluayBPQXV0aENyZWRlbnRpYWx9IGZyb20gYSBKU09OIHN0cmluZyBvciBhIHBsYWluIG9iamVjdC5cclxuICAgICAqIEBwYXJhbSBqc29uIC0gQSBwbGFpbiBvYmplY3Qgb3IgYSBKU09OIHN0cmluZ1xyXG4gICAgICovXHJcbiAgICBzdGF0aWMgY3JlZGVudGlhbEZyb21KU09OKGpzb24pIHtcclxuICAgICAgICBjb25zdCBvYmogPSB0eXBlb2YganNvbiA9PT0gJ3N0cmluZycgPyBKU09OLnBhcnNlKGpzb24pIDoganNvbjtcclxuICAgICAgICBfYXNzZXJ0KCdwcm92aWRlcklkJyBpbiBvYmogJiYgJ3NpZ25Jbk1ldGhvZCcgaW4gb2JqLCBcImFyZ3VtZW50LWVycm9yXCIgLyogQVJHVU1FTlRfRVJST1IgKi8pO1xyXG4gICAgICAgIHJldHVybiBPQXV0aENyZWRlbnRpYWwuX2Zyb21QYXJhbXMob2JqKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhIHtAbGluayBPQXV0aENyZWRlbnRpYWx9IGZyb20gYSBnZW5lcmljIE9BdXRoIHByb3ZpZGVyJ3MgYWNjZXNzIHRva2VuIG9yIElEIHRva2VuLlxyXG4gICAgICpcclxuICAgICAqIEByZW1hcmtzXHJcbiAgICAgKiBUaGUgcmF3IG5vbmNlIGlzIHJlcXVpcmVkIHdoZW4gYW4gSUQgdG9rZW4gd2l0aCBhIG5vbmNlIGZpZWxkIGlzIHByb3ZpZGVkLiBUaGUgU0hBLTI1NiBoYXNoIG9mXHJcbiAgICAgKiB0aGUgcmF3IG5vbmNlIG11c3QgbWF0Y2ggdGhlIG5vbmNlIGZpZWxkIGluIHRoZSBJRCB0b2tlbi5cclxuICAgICAqXHJcbiAgICAgKiBAZXhhbXBsZVxyXG4gICAgICogYGBgamF2YXNjcmlwdFxyXG4gICAgICogLy8gYGdvb2dsZVVzZXJgIGZyb20gdGhlIG9uc3VjY2VzcyBHb29nbGUgU2lnbiBJbiBjYWxsYmFjay5cclxuICAgICAqIC8vIEluaXRpYWxpemUgYSBnZW5lcmF0ZSBPQXV0aCBwcm92aWRlciB3aXRoIGEgYGdvb2dsZS5jb21gIHByb3ZpZGVySWQuXHJcbiAgICAgKiBjb25zdCBwcm92aWRlciA9IG5ldyBPQXV0aFByb3ZpZGVyKCdnb29nbGUuY29tJyk7XHJcbiAgICAgKiBjb25zdCBjcmVkZW50aWFsID0gcHJvdmlkZXIuY3JlZGVudGlhbCh7XHJcbiAgICAgKiAgIGlkVG9rZW46IGdvb2dsZVVzZXIuZ2V0QXV0aFJlc3BvbnNlKCkuaWRfdG9rZW4sXHJcbiAgICAgKiB9KTtcclxuICAgICAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNpZ25JbldpdGhDcmVkZW50aWFsKGNyZWRlbnRpYWwpO1xyXG4gICAgICogYGBgXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHBhcmFtcyAtIEVpdGhlciB0aGUgb3B0aW9ucyBvYmplY3QgY29udGFpbmluZyB0aGUgSUQgdG9rZW4sIGFjY2VzcyB0b2tlbiBhbmQgcmF3IG5vbmNlXHJcbiAgICAgKiBvciB0aGUgSUQgdG9rZW4gc3RyaW5nLlxyXG4gICAgICovXHJcbiAgICBjcmVkZW50aWFsKHBhcmFtcykge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9jcmVkZW50aWFsKHBhcmFtcyk7XHJcbiAgICB9XHJcbiAgICAvKiogQW4gaW50ZXJuYWwgY3JlZGVudGlhbCBtZXRob2QgdGhhdCBhY2NlcHRzIG1vcmUgcGVybWlzc2l2ZSBvcHRpb25zICovXHJcbiAgICBfY3JlZGVudGlhbChwYXJhbXMpIHtcclxuICAgICAgICBfYXNzZXJ0KHBhcmFtcy5pZFRva2VuIHx8IHBhcmFtcy5hY2Nlc3NUb2tlbiwgXCJhcmd1bWVudC1lcnJvclwiIC8qIEFSR1VNRU5UX0VSUk9SICovKTtcclxuICAgICAgICAvLyBGb3IgT0F1dGhDcmVkZW50aWFsLCBzaWduIGluIG1ldGhvZCBpcyBzYW1lIGFzIHByb3ZpZGVySWQuXHJcbiAgICAgICAgcmV0dXJuIE9BdXRoQ3JlZGVudGlhbC5fZnJvbVBhcmFtcyhPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIHBhcmFtcyksIHsgcHJvdmlkZXJJZDogdGhpcy5wcm92aWRlcklkLCBzaWduSW5NZXRob2Q6IHRoaXMucHJvdmlkZXJJZCB9KSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFVzZWQgdG8gZXh0cmFjdCB0aGUgdW5kZXJseWluZyB7QGxpbmsgT0F1dGhDcmVkZW50aWFsfSBmcm9tIGEge0BsaW5rIFVzZXJDcmVkZW50aWFsfS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gdXNlckNyZWRlbnRpYWwgLSBUaGUgdXNlciBjcmVkZW50aWFsLlxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgY3JlZGVudGlhbEZyb21SZXN1bHQodXNlckNyZWRlbnRpYWwpIHtcclxuICAgICAgICByZXR1cm4gT0F1dGhQcm92aWRlci5vYXV0aENyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KHVzZXJDcmVkZW50aWFsKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogVXNlZCB0byBleHRyYWN0IHRoZSB1bmRlcmx5aW5nIHtAbGluayBPQXV0aENyZWRlbnRpYWx9IGZyb20gYSB7QGxpbmsgQXV0aEVycm9yfSB3aGljaCB3YXNcclxuICAgICAqIHRocm93biBkdXJpbmcgYSBzaWduLWluLCBsaW5rLCBvciByZWF1dGhlbnRpY2F0ZSBvcGVyYXRpb24uXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHVzZXJDcmVkZW50aWFsIC0gVGhlIHVzZXIgY3JlZGVudGlhbC5cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGNyZWRlbnRpYWxGcm9tRXJyb3IoZXJyb3IpIHtcclxuICAgICAgICByZXR1cm4gT0F1dGhQcm92aWRlci5vYXV0aENyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KChlcnJvci5jdXN0b21EYXRhIHx8IHt9KSk7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgb2F1dGhDcmVkZW50aWFsRnJvbVRhZ2dlZE9iamVjdCh7IF90b2tlblJlc3BvbnNlOiB0b2tlblJlc3BvbnNlIH0pIHtcclxuICAgICAgICBpZiAoIXRva2VuUmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHsgb2F1dGhJZFRva2VuLCBvYXV0aEFjY2Vzc1Rva2VuLCBvYXV0aFRva2VuU2VjcmV0LCBwZW5kaW5nVG9rZW4sIG5vbmNlLCBwcm92aWRlcklkIH0gPSB0b2tlblJlc3BvbnNlO1xyXG4gICAgICAgIGlmICghb2F1dGhBY2Nlc3NUb2tlbiAmJlxyXG4gICAgICAgICAgICAhb2F1dGhUb2tlblNlY3JldCAmJlxyXG4gICAgICAgICAgICAhb2F1dGhJZFRva2VuICYmXHJcbiAgICAgICAgICAgICFwZW5kaW5nVG9rZW4pIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghcHJvdmlkZXJJZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBPQXV0aFByb3ZpZGVyKHByb3ZpZGVySWQpLl9jcmVkZW50aWFsKHtcclxuICAgICAgICAgICAgICAgIGlkVG9rZW46IG9hdXRoSWRUb2tlbixcclxuICAgICAgICAgICAgICAgIGFjY2Vzc1Rva2VuOiBvYXV0aEFjY2Vzc1Rva2VuLFxyXG4gICAgICAgICAgICAgICAgcmF3Tm9uY2U6IG5vbmNlLFxyXG4gICAgICAgICAgICAgICAgcGVuZGluZ1Rva2VuXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFByb3ZpZGVyIGZvciBnZW5lcmF0aW5nIGFuIHtAbGluayBPQXV0aENyZWRlbnRpYWx9IGZvciB7QGxpbmsgUHJvdmlkZXJJZH0uRkFDRUJPT0suXHJcbiAqXHJcbiAqIEBleGFtcGxlXHJcbiAqIGBgYGphdmFzY3JpcHRcclxuICogLy8gU2lnbiBpbiB1c2luZyBhIHJlZGlyZWN0LlxyXG4gKiBjb25zdCBwcm92aWRlciA9IG5ldyBGYWNlYm9va0F1dGhQcm92aWRlcigpO1xyXG4gKiAvLyBTdGFydCBhIHNpZ24gaW4gcHJvY2VzcyBmb3IgYW4gdW5hdXRoZW50aWNhdGVkIHVzZXIuXHJcbiAqIHByb3ZpZGVyLmFkZFNjb3BlKCd1c2VyX2JpcnRoZGF5Jyk7XHJcbiAqIGF3YWl0IHNpZ25JbldpdGhSZWRpcmVjdChhdXRoLCBwcm92aWRlcik7XHJcbiAqIC8vIFRoaXMgd2lsbCB0cmlnZ2VyIGEgZnVsbCBwYWdlIHJlZGlyZWN0IGF3YXkgZnJvbSB5b3VyIGFwcFxyXG4gKlxyXG4gKiAvLyBBZnRlciByZXR1cm5pbmcgZnJvbSB0aGUgcmVkaXJlY3Qgd2hlbiB5b3VyIGFwcCBpbml0aWFsaXplcyB5b3UgY2FuIG9idGFpbiB0aGUgcmVzdWx0XHJcbiAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdldFJlZGlyZWN0UmVzdWx0KGF1dGgpO1xyXG4gKiBpZiAocmVzdWx0KSB7XHJcbiAqICAgLy8gVGhpcyBpcyB0aGUgc2lnbmVkLWluIHVzZXJcclxuICogICBjb25zdCB1c2VyID0gcmVzdWx0LnVzZXI7XHJcbiAqICAgLy8gVGhpcyBnaXZlcyB5b3UgYSBGYWNlYm9vayBBY2Nlc3MgVG9rZW4uXHJcbiAqICAgY29uc3QgY3JlZGVudGlhbCA9IHByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tUmVzdWx0KGF1dGgsIHJlc3VsdCk7XHJcbiAqICAgY29uc3QgdG9rZW4gPSBjcmVkZW50aWFsLmFjY2Vzc1Rva2VuO1xyXG4gKiB9XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBAZXhhbXBsZVxyXG4gKiBgYGBqYXZhc2NyaXB0XHJcbiAqIC8vIFNpZ24gaW4gdXNpbmcgYSBwb3B1cC5cclxuICogY29uc3QgcHJvdmlkZXIgPSBuZXcgRmFjZWJvb2tBdXRoUHJvdmlkZXIoKTtcclxuICogcHJvdmlkZXIuYWRkU2NvcGUoJ3VzZXJfYmlydGhkYXknKTtcclxuICogY29uc3QgcmVzdWx0ID0gYXdhaXQgc2lnbkluV2l0aFBvcHVwKGF1dGgsIHByb3ZpZGVyKTtcclxuICpcclxuICogLy8gVGhlIHNpZ25lZC1pbiB1c2VyIGluZm8uXHJcbiAqIGNvbnN0IHVzZXIgPSByZXN1bHQudXNlcjtcclxuICogLy8gVGhpcyBnaXZlcyB5b3UgYSBGYWNlYm9vayBBY2Nlc3MgVG9rZW4uXHJcbiAqIGNvbnN0IGNyZWRlbnRpYWwgPSBwcm92aWRlci5jcmVkZW50aWFsRnJvbVJlc3VsdChhdXRoLCByZXN1bHQpO1xyXG4gKiBjb25zdCB0b2tlbiA9IGNyZWRlbnRpYWwuYWNjZXNzVG9rZW47XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5jbGFzcyBGYWNlYm9va0F1dGhQcm92aWRlciBleHRlbmRzIEJhc2VPQXV0aFByb3ZpZGVyIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHN1cGVyKFwiZmFjZWJvb2suY29tXCIgLyogRkFDRUJPT0sgKi8pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGEgY3JlZGVudGlhbCBmb3IgRmFjZWJvb2suXHJcbiAgICAgKlxyXG4gICAgICogQGV4YW1wbGVcclxuICAgICAqIGBgYGphdmFzY3JpcHRcclxuICAgICAqIC8vIGBldmVudGAgZnJvbSB0aGUgRmFjZWJvb2sgYXV0aC5hdXRoUmVzcG9uc2VDaGFuZ2UgY2FsbGJhY2suXHJcbiAgICAgKiBjb25zdCBjcmVkZW50aWFsID0gRmFjZWJvb2tBdXRoUHJvdmlkZXIuY3JlZGVudGlhbChldmVudC5hdXRoUmVzcG9uc2UuYWNjZXNzVG9rZW4pO1xyXG4gICAgICogY29uc3QgcmVzdWx0ID0gYXdhaXQgc2lnbkluV2l0aENyZWRlbnRpYWwoY3JlZGVudGlhbCk7XHJcbiAgICAgKiBgYGBcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gYWNjZXNzVG9rZW4gLSBGYWNlYm9vayBhY2Nlc3MgdG9rZW4uXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBjcmVkZW50aWFsKGFjY2Vzc1Rva2VuKSB7XHJcbiAgICAgICAgcmV0dXJuIE9BdXRoQ3JlZGVudGlhbC5fZnJvbVBhcmFtcyh7XHJcbiAgICAgICAgICAgIHByb3ZpZGVySWQ6IEZhY2Vib29rQXV0aFByb3ZpZGVyLlBST1ZJREVSX0lELFxyXG4gICAgICAgICAgICBzaWduSW5NZXRob2Q6IEZhY2Vib29rQXV0aFByb3ZpZGVyLkZBQ0VCT09LX1NJR05fSU5fTUVUSE9ELFxyXG4gICAgICAgICAgICBhY2Nlc3NUb2tlblxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBVc2VkIHRvIGV4dHJhY3QgdGhlIHVuZGVybHlpbmcge0BsaW5rIE9BdXRoQ3JlZGVudGlhbH0gZnJvbSBhIHtAbGluayBVc2VyQ3JlZGVudGlhbH0uXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHVzZXJDcmVkZW50aWFsIC0gVGhlIHVzZXIgY3JlZGVudGlhbC5cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGNyZWRlbnRpYWxGcm9tUmVzdWx0KHVzZXJDcmVkZW50aWFsKSB7XHJcbiAgICAgICAgcmV0dXJuIEZhY2Vib29rQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KHVzZXJDcmVkZW50aWFsKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogVXNlZCB0byBleHRyYWN0IHRoZSB1bmRlcmx5aW5nIHtAbGluayBPQXV0aENyZWRlbnRpYWx9IGZyb20gYSB7QGxpbmsgQXV0aEVycm9yfSB3aGljaCB3YXNcclxuICAgICAqIHRocm93biBkdXJpbmcgYSBzaWduLWluLCBsaW5rLCBvciByZWF1dGhlbnRpY2F0ZSBvcGVyYXRpb24uXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHVzZXJDcmVkZW50aWFsIC0gVGhlIHVzZXIgY3JlZGVudGlhbC5cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGNyZWRlbnRpYWxGcm9tRXJyb3IoZXJyb3IpIHtcclxuICAgICAgICByZXR1cm4gRmFjZWJvb2tBdXRoUHJvdmlkZXIuY3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3QoKGVycm9yLmN1c3RvbURhdGEgfHwge30pKTtcclxuICAgIH1cclxuICAgIHN0YXRpYyBjcmVkZW50aWFsRnJvbVRhZ2dlZE9iamVjdCh7IF90b2tlblJlc3BvbnNlOiB0b2tlblJlc3BvbnNlIH0pIHtcclxuICAgICAgICBpZiAoIXRva2VuUmVzcG9uc2UgfHwgISgnb2F1dGhBY2Nlc3NUb2tlbicgaW4gdG9rZW5SZXNwb25zZSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdG9rZW5SZXNwb25zZS5vYXV0aEFjY2Vzc1Rva2VuKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICByZXR1cm4gRmFjZWJvb2tBdXRoUHJvdmlkZXIuY3JlZGVudGlhbCh0b2tlblJlc3BvbnNlLm9hdXRoQWNjZXNzVG9rZW4pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoX2EpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbi8qKiBBbHdheXMgc2V0IHRvIHtAbGluayBTaWduSW5NZXRob2R9LkZBQ0VCT09LLiAqL1xyXG5GYWNlYm9va0F1dGhQcm92aWRlci5GQUNFQk9PS19TSUdOX0lOX01FVEhPRCA9IFwiZmFjZWJvb2suY29tXCIgLyogRkFDRUJPT0sgKi87XHJcbi8qKiBBbHdheXMgc2V0IHRvIHtAbGluayBQcm92aWRlcklkfS5GQUNFQk9PSy4gKi9cclxuRmFjZWJvb2tBdXRoUHJvdmlkZXIuUFJPVklERVJfSUQgPSBcImZhY2Vib29rLmNvbVwiIC8qIEZBQ0VCT09LICovO1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogUHJvdmlkZXIgZm9yIGdlbmVyYXRpbmcgYW4gYW4ge0BsaW5rIE9BdXRoQ3JlZGVudGlhbH0gZm9yIHtAbGluayBQcm92aWRlcklkfS5HT09HTEUuXHJcbiAqXHJcbiAqIEBleGFtcGxlXHJcbiAqIGBgYGphdmFzY3JpcHRcclxuICogLy8gU2lnbiBpbiB1c2luZyBhIHJlZGlyZWN0LlxyXG4gKiBjb25zdCBwcm92aWRlciA9IG5ldyBHb29nbGVBdXRoUHJvdmlkZXIoKTtcclxuICogLy8gU3RhcnQgYSBzaWduIGluIHByb2Nlc3MgZm9yIGFuIHVuYXV0aGVudGljYXRlZCB1c2VyLlxyXG4gKiBwcm92aWRlci5hZGRTY29wZSgncHJvZmlsZScpO1xyXG4gKiBwcm92aWRlci5hZGRTY29wZSgnZW1haWwnKTtcclxuICogYXdhaXQgc2lnbkluV2l0aFJlZGlyZWN0KGF1dGgsIHByb3ZpZGVyKTtcclxuICogLy8gVGhpcyB3aWxsIHRyaWdnZXIgYSBmdWxsIHBhZ2UgcmVkaXJlY3QgYXdheSBmcm9tIHlvdXIgYXBwXHJcbiAqXHJcbiAqIC8vIEFmdGVyIHJldHVybmluZyBmcm9tIHRoZSByZWRpcmVjdCB3aGVuIHlvdXIgYXBwIGluaXRpYWxpemVzIHlvdSBjYW4gb2J0YWluIHRoZSByZXN1bHRcclxuICogY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2V0UmVkaXJlY3RSZXN1bHQoYXV0aCk7XHJcbiAqIGlmIChyZXN1bHQpIHtcclxuICogICAvLyBUaGlzIGlzIHRoZSBzaWduZWQtaW4gdXNlclxyXG4gKiAgIGNvbnN0IHVzZXIgPSByZXN1bHQudXNlcjtcclxuICogICAvLyBUaGlzIGdpdmVzIHlvdSBhIEdvb2dsZSBBY2Nlc3MgVG9rZW4uXHJcbiAqICAgY29uc3QgY3JlZGVudGlhbCA9IHByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tUmVzdWx0KGF1dGgsIHJlc3VsdCk7XHJcbiAqICAgY29uc3QgdG9rZW4gPSBjcmVkZW50aWFsLmFjY2Vzc1Rva2VuO1xyXG4gKiB9XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBAZXhhbXBsZVxyXG4gKiBgYGBqYXZhc2NyaXB0XHJcbiAqIC8vIFNpZ24gaW4gdXNpbmcgYSBwb3B1cC5cclxuICogY29uc3QgcHJvdmlkZXIgPSBuZXcgR29vZ2xlQXV0aFByb3ZpZGVyKCk7XHJcbiAqIHByb3ZpZGVyLmFkZFNjb3BlKCdwcm9maWxlJyk7XHJcbiAqIHByb3ZpZGVyLmFkZFNjb3BlKCdlbWFpbCcpO1xyXG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBzaWduSW5XaXRoUG9wdXAoYXV0aCwgcHJvdmlkZXIpO1xyXG4gKlxyXG4gKiAvLyBUaGUgc2lnbmVkLWluIHVzZXIgaW5mby5cclxuICogY29uc3QgdXNlciA9IHJlc3VsdC51c2VyO1xyXG4gKiAvLyBUaGlzIGdpdmVzIHlvdSBhIEdvb2dsZSBBY2Nlc3MgVG9rZW4uXHJcbiAqIGNvbnN0IGNyZWRlbnRpYWwgPSBwcm92aWRlci5jcmVkZW50aWFsRnJvbVJlc3VsdChhdXRoLCByZXN1bHQpO1xyXG4gKiBjb25zdCB0b2tlbiA9IGNyZWRlbnRpYWwuYWNjZXNzVG9rZW47XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5jbGFzcyBHb29nbGVBdXRoUHJvdmlkZXIgZXh0ZW5kcyBCYXNlT0F1dGhQcm92aWRlciB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcihcImdvb2dsZS5jb21cIiAvKiBHT09HTEUgKi8pO1xyXG4gICAgICAgIHRoaXMuYWRkU2NvcGUoJ3Byb2ZpbGUnKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhIGNyZWRlbnRpYWwgZm9yIEdvb2dsZS4gQXQgbGVhc3Qgb25lIG9mIElEIHRva2VuIGFuZCBhY2Nlc3MgdG9rZW4gaXMgcmVxdWlyZWQuXHJcbiAgICAgKlxyXG4gICAgICogQGV4YW1wbGVcclxuICAgICAqIGBgYGphdmFzY3JpcHRcclxuICAgICAqIC8vIFxcYGdvb2dsZVVzZXJcXGAgZnJvbSB0aGUgb25zdWNjZXNzIEdvb2dsZSBTaWduIEluIGNhbGxiYWNrLlxyXG4gICAgICogY29uc3QgY3JlZGVudGlhbCA9IEdvb2dsZUF1dGhQcm92aWRlci5jcmVkZW50aWFsKGdvb2dsZVVzZXIuZ2V0QXV0aFJlc3BvbnNlKCkuaWRfdG9rZW4pO1xyXG4gICAgICogY29uc3QgcmVzdWx0ID0gYXdhaXQgc2lnbkluV2l0aENyZWRlbnRpYWwoY3JlZGVudGlhbCk7XHJcbiAgICAgKiBgYGBcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gaWRUb2tlbiAtIEdvb2dsZSBJRCB0b2tlbi5cclxuICAgICAqIEBwYXJhbSBhY2Nlc3NUb2tlbiAtIEdvb2dsZSBhY2Nlc3MgdG9rZW4uXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBjcmVkZW50aWFsKGlkVG9rZW4sIGFjY2Vzc1Rva2VuKSB7XHJcbiAgICAgICAgcmV0dXJuIE9BdXRoQ3JlZGVudGlhbC5fZnJvbVBhcmFtcyh7XHJcbiAgICAgICAgICAgIHByb3ZpZGVySWQ6IEdvb2dsZUF1dGhQcm92aWRlci5QUk9WSURFUl9JRCxcclxuICAgICAgICAgICAgc2lnbkluTWV0aG9kOiBHb29nbGVBdXRoUHJvdmlkZXIuR09PR0xFX1NJR05fSU5fTUVUSE9ELFxyXG4gICAgICAgICAgICBpZFRva2VuLFxyXG4gICAgICAgICAgICBhY2Nlc3NUb2tlblxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBVc2VkIHRvIGV4dHJhY3QgdGhlIHVuZGVybHlpbmcge0BsaW5rIE9BdXRoQ3JlZGVudGlhbH0gZnJvbSBhIHtAbGluayBVc2VyQ3JlZGVudGlhbH0uXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHVzZXJDcmVkZW50aWFsIC0gVGhlIHVzZXIgY3JlZGVudGlhbC5cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGNyZWRlbnRpYWxGcm9tUmVzdWx0KHVzZXJDcmVkZW50aWFsKSB7XHJcbiAgICAgICAgcmV0dXJuIEdvb2dsZUF1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVRhZ2dlZE9iamVjdCh1c2VyQ3JlZGVudGlhbCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFVzZWQgdG8gZXh0cmFjdCB0aGUgdW5kZXJseWluZyB7QGxpbmsgT0F1dGhDcmVkZW50aWFsfSBmcm9tIGEge0BsaW5rIEF1dGhFcnJvcn0gd2hpY2ggd2FzXHJcbiAgICAgKiB0aHJvd24gZHVyaW5nIGEgc2lnbi1pbiwgbGluaywgb3IgcmVhdXRoZW50aWNhdGUgb3BlcmF0aW9uLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB1c2VyQ3JlZGVudGlhbCAtIFRoZSB1c2VyIGNyZWRlbnRpYWwuXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBjcmVkZW50aWFsRnJvbUVycm9yKGVycm9yKSB7XHJcbiAgICAgICAgcmV0dXJuIEdvb2dsZUF1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVRhZ2dlZE9iamVjdCgoZXJyb3IuY3VzdG9tRGF0YSB8fCB7fSkpO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIGNyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KHsgX3Rva2VuUmVzcG9uc2U6IHRva2VuUmVzcG9uc2UgfSkge1xyXG4gICAgICAgIGlmICghdG9rZW5SZXNwb25zZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgeyBvYXV0aElkVG9rZW4sIG9hdXRoQWNjZXNzVG9rZW4gfSA9IHRva2VuUmVzcG9uc2U7XHJcbiAgICAgICAgaWYgKCFvYXV0aElkVG9rZW4gJiYgIW9hdXRoQWNjZXNzVG9rZW4pIHtcclxuICAgICAgICAgICAgLy8gVGhpcyBjb3VsZCBiZSBhbiBvYXV0aCAxIGNyZWRlbnRpYWwgb3IgYSBwaG9uZSBjcmVkZW50aWFsXHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICByZXR1cm4gR29vZ2xlQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWwob2F1dGhJZFRva2VuLCBvYXV0aEFjY2Vzc1Rva2VuKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKF9hKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4vKiogQWx3YXlzIHNldCB0byB7QGxpbmsgU2lnbkluTWV0aG9kfS5HT09HTEUuICovXHJcbkdvb2dsZUF1dGhQcm92aWRlci5HT09HTEVfU0lHTl9JTl9NRVRIT0QgPSBcImdvb2dsZS5jb21cIiAvKiBHT09HTEUgKi87XHJcbi8qKiBBbHdheXMgc2V0IHRvIHtAbGluayBQcm92aWRlcklkfS5HT09HTEUuICovXHJcbkdvb2dsZUF1dGhQcm92aWRlci5QUk9WSURFUl9JRCA9IFwiZ29vZ2xlLmNvbVwiIC8qIEdPT0dMRSAqLztcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFByb3ZpZGVyIGZvciBnZW5lcmF0aW5nIGFuIHtAbGluayBPQXV0aENyZWRlbnRpYWx9IGZvciB7QGxpbmsgUHJvdmlkZXJJZH0uR0lUSFVCLlxyXG4gKlxyXG4gKiBAcmVtYXJrc1xyXG4gKiBHaXRIdWIgcmVxdWlyZXMgYW4gT0F1dGggMi4wIHJlZGlyZWN0LCBzbyB5b3UgY2FuIGVpdGhlciBoYW5kbGUgdGhlIHJlZGlyZWN0IGRpcmVjdGx5LCBvciB1c2VcclxuICogdGhlIHtAbGluayBzaWduSW5XaXRoUG9wdXB9IGhhbmRsZXI6XHJcbiAqXHJcbiAqIEBleGFtcGxlXHJcbiAqIGBgYGphdmFzY3JpcHRcclxuICogLy8gU2lnbiBpbiB1c2luZyBhIHJlZGlyZWN0LlxyXG4gKiBjb25zdCBwcm92aWRlciA9IG5ldyBHaXRodWJBdXRoUHJvdmlkZXIoKTtcclxuICogLy8gU3RhcnQgYSBzaWduIGluIHByb2Nlc3MgZm9yIGFuIHVuYXV0aGVudGljYXRlZCB1c2VyLlxyXG4gKiBwcm92aWRlci5hZGRTY29wZSgncmVwbycpO1xyXG4gKiBhd2FpdCBzaWduSW5XaXRoUmVkaXJlY3QoYXV0aCwgcHJvdmlkZXIpO1xyXG4gKiAvLyBUaGlzIHdpbGwgdHJpZ2dlciBhIGZ1bGwgcGFnZSByZWRpcmVjdCBhd2F5IGZyb20geW91ciBhcHBcclxuICpcclxuICogLy8gQWZ0ZXIgcmV0dXJuaW5nIGZyb20gdGhlIHJlZGlyZWN0IHdoZW4geW91ciBhcHAgaW5pdGlhbGl6ZXMgeW91IGNhbiBvYnRhaW4gdGhlIHJlc3VsdFxyXG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRSZWRpcmVjdFJlc3VsdChhdXRoKTtcclxuICogaWYgKHJlc3VsdCkge1xyXG4gKiAgIC8vIFRoaXMgaXMgdGhlIHNpZ25lZC1pbiB1c2VyXHJcbiAqICAgY29uc3QgdXNlciA9IHJlc3VsdC51c2VyO1xyXG4gKiAgIC8vIFRoaXMgZ2l2ZXMgeW91IGEgR2l0aHViIEFjY2VzcyBUb2tlbi5cclxuICogICBjb25zdCBjcmVkZW50aWFsID0gcHJvdmlkZXIuY3JlZGVudGlhbEZyb21SZXN1bHQoYXV0aCwgcmVzdWx0KTtcclxuICogICBjb25zdCB0b2tlbiA9IGNyZWRlbnRpYWwuYWNjZXNzVG9rZW47XHJcbiAqIH1cclxuICogYGBgXHJcbiAqXHJcbiAqIEBleGFtcGxlXHJcbiAqIGBgYGphdmFzY3JpcHRcclxuICogLy8gU2lnbiBpbiB1c2luZyBhIHBvcHVwLlxyXG4gKiBjb25zdCBwcm92aWRlciA9IG5ldyBHaXRodWJBdXRoUHJvdmlkZXIoKTtcclxuICogcHJvdmlkZXIuYWRkU2NvcGUoJ3JlcG8nKTtcclxuICogY29uc3QgcmVzdWx0ID0gYXdhaXQgc2lnbkluV2l0aFBvcHVwKGF1dGgsIHByb3ZpZGVyKTtcclxuICpcclxuICogLy8gVGhlIHNpZ25lZC1pbiB1c2VyIGluZm8uXHJcbiAqIGNvbnN0IHVzZXIgPSByZXN1bHQudXNlcjtcclxuICogLy8gVGhpcyBnaXZlcyB5b3UgYSBHaXRodWIgQWNjZXNzIFRva2VuLlxyXG4gKiBjb25zdCBjcmVkZW50aWFsID0gcHJvdmlkZXIuY3JlZGVudGlhbEZyb21SZXN1bHQoYXV0aCwgcmVzdWx0KTtcclxuICogY29uc3QgdG9rZW4gPSBjcmVkZW50aWFsLmFjY2Vzc1Rva2VuO1xyXG4gKiBgYGBcclxuICogQHB1YmxpY1xyXG4gKi9cclxuY2xhc3MgR2l0aHViQXV0aFByb3ZpZGVyIGV4dGVuZHMgQmFzZU9BdXRoUHJvdmlkZXIge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoXCJnaXRodWIuY29tXCIgLyogR0lUSFVCICovKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhIGNyZWRlbnRpYWwgZm9yIEdpdGh1Yi5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gYWNjZXNzVG9rZW4gLSBHaXRodWIgYWNjZXNzIHRva2VuLlxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgY3JlZGVudGlhbChhY2Nlc3NUb2tlbikge1xyXG4gICAgICAgIHJldHVybiBPQXV0aENyZWRlbnRpYWwuX2Zyb21QYXJhbXMoe1xyXG4gICAgICAgICAgICBwcm92aWRlcklkOiBHaXRodWJBdXRoUHJvdmlkZXIuUFJPVklERVJfSUQsXHJcbiAgICAgICAgICAgIHNpZ25Jbk1ldGhvZDogR2l0aHViQXV0aFByb3ZpZGVyLkdJVEhVQl9TSUdOX0lOX01FVEhPRCxcclxuICAgICAgICAgICAgYWNjZXNzVG9rZW5cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogVXNlZCB0byBleHRyYWN0IHRoZSB1bmRlcmx5aW5nIHtAbGluayBPQXV0aENyZWRlbnRpYWx9IGZyb20gYSB7QGxpbmsgVXNlckNyZWRlbnRpYWx9LlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB1c2VyQ3JlZGVudGlhbCAtIFRoZSB1c2VyIGNyZWRlbnRpYWwuXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBjcmVkZW50aWFsRnJvbVJlc3VsdCh1c2VyQ3JlZGVudGlhbCkge1xyXG4gICAgICAgIHJldHVybiBHaXRodWJBdXRoUHJvdmlkZXIuY3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3QodXNlckNyZWRlbnRpYWwpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBVc2VkIHRvIGV4dHJhY3QgdGhlIHVuZGVybHlpbmcge0BsaW5rIE9BdXRoQ3JlZGVudGlhbH0gZnJvbSBhIHtAbGluayBBdXRoRXJyb3J9IHdoaWNoIHdhc1xyXG4gICAgICogdGhyb3duIGR1cmluZyBhIHNpZ24taW4sIGxpbmssIG9yIHJlYXV0aGVudGljYXRlIG9wZXJhdGlvbi5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gdXNlckNyZWRlbnRpYWwgLSBUaGUgdXNlciBjcmVkZW50aWFsLlxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgY3JlZGVudGlhbEZyb21FcnJvcihlcnJvcikge1xyXG4gICAgICAgIHJldHVybiBHaXRodWJBdXRoUHJvdmlkZXIuY3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3QoKGVycm9yLmN1c3RvbURhdGEgfHwge30pKTtcclxuICAgIH1cclxuICAgIHN0YXRpYyBjcmVkZW50aWFsRnJvbVRhZ2dlZE9iamVjdCh7IF90b2tlblJlc3BvbnNlOiB0b2tlblJlc3BvbnNlIH0pIHtcclxuICAgICAgICBpZiAoIXRva2VuUmVzcG9uc2UgfHwgISgnb2F1dGhBY2Nlc3NUb2tlbicgaW4gdG9rZW5SZXNwb25zZSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdG9rZW5SZXNwb25zZS5vYXV0aEFjY2Vzc1Rva2VuKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICByZXR1cm4gR2l0aHViQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWwodG9rZW5SZXNwb25zZS5vYXV0aEFjY2Vzc1Rva2VuKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKF9hKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4vKiogQWx3YXlzIHNldCB0byB7QGxpbmsgU2lnbkluTWV0aG9kfS5HSVRIVUIuICovXHJcbkdpdGh1YkF1dGhQcm92aWRlci5HSVRIVUJfU0lHTl9JTl9NRVRIT0QgPSBcImdpdGh1Yi5jb21cIiAvKiBHSVRIVUIgKi87XHJcbi8qKiBBbHdheXMgc2V0IHRvIHtAbGluayBQcm92aWRlcklkfS5HSVRIVUIuICovXHJcbkdpdGh1YkF1dGhQcm92aWRlci5QUk9WSURFUl9JRCA9IFwiZ2l0aHViLmNvbVwiIC8qIEdJVEhVQiAqLztcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuY29uc3QgSURQX1JFUVVFU1RfVVJJID0gJ2h0dHA6Ly9sb2NhbGhvc3QnO1xyXG4vKipcclxuICogQHB1YmxpY1xyXG4gKi9cclxuY2xhc3MgU0FNTEF1dGhDcmVkZW50aWFsIGV4dGVuZHMgQXV0aENyZWRlbnRpYWwge1xyXG4gICAgLyoqIEBpbnRlcm5hbCAqL1xyXG4gICAgY29uc3RydWN0b3IocHJvdmlkZXJJZCwgcGVuZGluZ1Rva2VuKSB7XHJcbiAgICAgICAgc3VwZXIocHJvdmlkZXJJZCwgcHJvdmlkZXJJZCk7XHJcbiAgICAgICAgdGhpcy5wZW5kaW5nVG9rZW4gPSBwZW5kaW5nVG9rZW47XHJcbiAgICB9XHJcbiAgICAvKiogQGludGVybmFsICovXHJcbiAgICBfZ2V0SWRUb2tlblJlc3BvbnNlKGF1dGgpIHtcclxuICAgICAgICBjb25zdCByZXF1ZXN0ID0gdGhpcy5idWlsZFJlcXVlc3QoKTtcclxuICAgICAgICByZXR1cm4gc2lnbkluV2l0aElkcChhdXRoLCByZXF1ZXN0KTtcclxuICAgIH1cclxuICAgIC8qKiBAaW50ZXJuYWwgKi9cclxuICAgIF9saW5rVG9JZFRva2VuKGF1dGgsIGlkVG9rZW4pIHtcclxuICAgICAgICBjb25zdCByZXF1ZXN0ID0gdGhpcy5idWlsZFJlcXVlc3QoKTtcclxuICAgICAgICByZXF1ZXN0LmlkVG9rZW4gPSBpZFRva2VuO1xyXG4gICAgICAgIHJldHVybiBzaWduSW5XaXRoSWRwKGF1dGgsIHJlcXVlc3QpO1xyXG4gICAgfVxyXG4gICAgLyoqIEBpbnRlcm5hbCAqL1xyXG4gICAgX2dldFJlYXV0aGVudGljYXRpb25SZXNvbHZlcihhdXRoKSB7XHJcbiAgICAgICAgY29uc3QgcmVxdWVzdCA9IHRoaXMuYnVpbGRSZXF1ZXN0KCk7XHJcbiAgICAgICAgcmVxdWVzdC5hdXRvQ3JlYXRlID0gZmFsc2U7XHJcbiAgICAgICAgcmV0dXJuIHNpZ25JbldpdGhJZHAoYXV0aCwgcmVxdWVzdCk7XHJcbiAgICB9XHJcbiAgICAvKioge0Bpbmhlcml0ZG9jIEF1dGhDcmVkZW50aWFsLnRvSlNPTn0gICovXHJcbiAgICB0b0pTT04oKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc2lnbkluTWV0aG9kOiB0aGlzLnNpZ25Jbk1ldGhvZCxcclxuICAgICAgICAgICAgcHJvdmlkZXJJZDogdGhpcy5wcm92aWRlcklkLFxyXG4gICAgICAgICAgICBwZW5kaW5nVG9rZW46IHRoaXMucGVuZGluZ1Rva2VuXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogU3RhdGljIG1ldGhvZCB0byBkZXNlcmlhbGl6ZSBhIEpTT04gcmVwcmVzZW50YXRpb24gb2YgYW4gb2JqZWN0IGludG8gYW5cclxuICAgICAqIHtAbGluayAgQXV0aENyZWRlbnRpYWx9LlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBqc29uIC0gSW5wdXQgY2FuIGJlIGVpdGhlciBPYmplY3Qgb3IgdGhlIHN0cmluZ2lmaWVkIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBvYmplY3QuXHJcbiAgICAgKiBXaGVuIHN0cmluZyBpcyBwcm92aWRlZCwgSlNPTi5wYXJzZSB3b3VsZCBiZSBjYWxsZWQgZmlyc3QuXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybnMgSWYgdGhlIEpTT04gaW5wdXQgZG9lcyBub3QgcmVwcmVzZW50IGFuIHtAbGluayAgQXV0aENyZWRlbnRpYWx9LCBudWxsIGlzIHJldHVybmVkLlxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgZnJvbUpTT04oanNvbikge1xyXG4gICAgICAgIGNvbnN0IG9iaiA9IHR5cGVvZiBqc29uID09PSAnc3RyaW5nJyA/IEpTT04ucGFyc2UoanNvbikgOiBqc29uO1xyXG4gICAgICAgIGNvbnN0IHsgcHJvdmlkZXJJZCwgc2lnbkluTWV0aG9kLCBwZW5kaW5nVG9rZW4gfSA9IG9iajtcclxuICAgICAgICBpZiAoIXByb3ZpZGVySWQgfHxcclxuICAgICAgICAgICAgIXNpZ25Jbk1ldGhvZCB8fFxyXG4gICAgICAgICAgICAhcGVuZGluZ1Rva2VuIHx8XHJcbiAgICAgICAgICAgIHByb3ZpZGVySWQgIT09IHNpZ25Jbk1ldGhvZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5ldyBTQU1MQXV0aENyZWRlbnRpYWwocHJvdmlkZXJJZCwgcGVuZGluZ1Rva2VuKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogSGVscGVyIHN0YXRpYyBtZXRob2QgdG8gYXZvaWQgZXhwb3NpbmcgdGhlIGNvbnN0cnVjdG9yIHRvIGVuZCB1c2Vycy5cclxuICAgICAqXHJcbiAgICAgKiBAaW50ZXJuYWxcclxuICAgICAqL1xyXG4gICAgc3RhdGljIF9jcmVhdGUocHJvdmlkZXJJZCwgcGVuZGluZ1Rva2VuKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBTQU1MQXV0aENyZWRlbnRpYWwocHJvdmlkZXJJZCwgcGVuZGluZ1Rva2VuKTtcclxuICAgIH1cclxuICAgIGJ1aWxkUmVxdWVzdCgpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICByZXF1ZXN0VXJpOiBJRFBfUkVRVUVTVF9VUkksXHJcbiAgICAgICAgICAgIHJldHVyblNlY3VyZVRva2VuOiB0cnVlLFxyXG4gICAgICAgICAgICBwZW5kaW5nVG9rZW46IHRoaXMucGVuZGluZ1Rva2VuXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jb25zdCBTQU1MX1BST1ZJREVSX1BSRUZJWCA9ICdzYW1sLic7XHJcbi8qKlxyXG4gKiBBbiB7QGxpbmsgQXV0aFByb3ZpZGVyfSBmb3IgU0FNTC5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuY2xhc3MgU0FNTEF1dGhQcm92aWRlciBleHRlbmRzIEZlZGVyYXRlZEF1dGhQcm92aWRlciB7XHJcbiAgICAvKipcclxuICAgICAqIENvbnN0cnVjdG9yLiBUaGUgcHJvdmlkZXJJZCBtdXN0IHN0YXJ0IHdpdGggXCJzYW1sLlwiXHJcbiAgICAgKiBAcGFyYW0gcHJvdmlkZXJJZCAtIFNBTUwgcHJvdmlkZXIgSUQuXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKHByb3ZpZGVySWQpIHtcclxuICAgICAgICBfYXNzZXJ0KHByb3ZpZGVySWQuc3RhcnRzV2l0aChTQU1MX1BST1ZJREVSX1BSRUZJWCksIFwiYXJndW1lbnQtZXJyb3JcIiAvKiBBUkdVTUVOVF9FUlJPUiAqLyk7XHJcbiAgICAgICAgc3VwZXIocHJvdmlkZXJJZCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEdlbmVyYXRlcyBhbiB7QGxpbmsgQXV0aENyZWRlbnRpYWx9IGZyb20gYSB7QGxpbmsgVXNlckNyZWRlbnRpYWx9IGFmdGVyIGFcclxuICAgICAqIHN1Y2Nlc3NmdWwgU0FNTCBmbG93IGNvbXBsZXRlcy5cclxuICAgICAqXHJcbiAgICAgKiBAcmVtYXJrc1xyXG4gICAgICpcclxuICAgICAqIEZvciBleGFtcGxlLCB0byBnZXQgYW4ge0BsaW5rIEF1dGhDcmVkZW50aWFsfSwgeW91IGNvdWxkIHdyaXRlIHRoZVxyXG4gICAgICogZm9sbG93aW5nIGNvZGU6XHJcbiAgICAgKlxyXG4gICAgICogYGBganNcclxuICAgICAqIGNvbnN0IHVzZXJDcmVkZW50aWFsID0gYXdhaXQgc2lnbkluV2l0aFBvcHVwKGF1dGgsIHNhbWxQcm92aWRlcik7XHJcbiAgICAgKiBjb25zdCBjcmVkZW50aWFsID0gU0FNTEF1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVJlc3VsdCh1c2VyQ3JlZGVudGlhbCk7XHJcbiAgICAgKiBgYGBcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gdXNlckNyZWRlbnRpYWwgLSBUaGUgdXNlciBjcmVkZW50aWFsLlxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgY3JlZGVudGlhbEZyb21SZXN1bHQodXNlckNyZWRlbnRpYWwpIHtcclxuICAgICAgICByZXR1cm4gU0FNTEF1dGhQcm92aWRlci5zYW1sQ3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3QodXNlckNyZWRlbnRpYWwpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBVc2VkIHRvIGV4dHJhY3QgdGhlIHVuZGVybHlpbmcge0BsaW5rIE9BdXRoQ3JlZGVudGlhbH0gZnJvbSBhIHtAbGluayBBdXRoRXJyb3J9IHdoaWNoIHdhc1xyXG4gICAgICogdGhyb3duIGR1cmluZyBhIHNpZ24taW4sIGxpbmssIG9yIHJlYXV0aGVudGljYXRlIG9wZXJhdGlvbi5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gdXNlckNyZWRlbnRpYWwgLSBUaGUgdXNlciBjcmVkZW50aWFsLlxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgY3JlZGVudGlhbEZyb21FcnJvcihlcnJvcikge1xyXG4gICAgICAgIHJldHVybiBTQU1MQXV0aFByb3ZpZGVyLnNhbWxDcmVkZW50aWFsRnJvbVRhZ2dlZE9iamVjdCgoZXJyb3IuY3VzdG9tRGF0YSB8fCB7fSkpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGFuIHtAbGluayBBdXRoQ3JlZGVudGlhbH0gZnJvbSBhIEpTT04gc3RyaW5nIG9yIGEgcGxhaW4gb2JqZWN0LlxyXG4gICAgICogQHBhcmFtIGpzb24gLSBBIHBsYWluIG9iamVjdCBvciBhIEpTT04gc3RyaW5nXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBjcmVkZW50aWFsRnJvbUpTT04oanNvbikge1xyXG4gICAgICAgIGNvbnN0IGNyZWRlbnRpYWwgPSBTQU1MQXV0aENyZWRlbnRpYWwuZnJvbUpTT04oanNvbik7XHJcbiAgICAgICAgX2Fzc2VydChjcmVkZW50aWFsLCBcImFyZ3VtZW50LWVycm9yXCIgLyogQVJHVU1FTlRfRVJST1IgKi8pO1xyXG4gICAgICAgIHJldHVybiBjcmVkZW50aWFsO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIHNhbWxDcmVkZW50aWFsRnJvbVRhZ2dlZE9iamVjdCh7IF90b2tlblJlc3BvbnNlOiB0b2tlblJlc3BvbnNlIH0pIHtcclxuICAgICAgICBpZiAoIXRva2VuUmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHsgcGVuZGluZ1Rva2VuLCBwcm92aWRlcklkIH0gPSB0b2tlblJlc3BvbnNlO1xyXG4gICAgICAgIGlmICghcGVuZGluZ1Rva2VuIHx8ICFwcm92aWRlcklkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICByZXR1cm4gU0FNTEF1dGhDcmVkZW50aWFsLl9jcmVhdGUocHJvdmlkZXJJZCwgcGVuZGluZ1Rva2VuKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBQcm92aWRlciBmb3IgZ2VuZXJhdGluZyBhbiB7QGxpbmsgT0F1dGhDcmVkZW50aWFsfSBmb3Ige0BsaW5rIFByb3ZpZGVySWR9LlRXSVRURVIuXHJcbiAqXHJcbiAqIEBleGFtcGxlXHJcbiAqIGBgYGphdmFzY3JpcHRcclxuICogLy8gU2lnbiBpbiB1c2luZyBhIHJlZGlyZWN0LlxyXG4gKiBjb25zdCBwcm92aWRlciA9IG5ldyBUd2l0dGVyQXV0aFByb3ZpZGVyKCk7XHJcbiAqIC8vIFN0YXJ0IGEgc2lnbiBpbiBwcm9jZXNzIGZvciBhbiB1bmF1dGhlbnRpY2F0ZWQgdXNlci5cclxuICogYXdhaXQgc2lnbkluV2l0aFJlZGlyZWN0KGF1dGgsIHByb3ZpZGVyKTtcclxuICogLy8gVGhpcyB3aWxsIHRyaWdnZXIgYSBmdWxsIHBhZ2UgcmVkaXJlY3QgYXdheSBmcm9tIHlvdXIgYXBwXHJcbiAqXHJcbiAqIC8vIEFmdGVyIHJldHVybmluZyBmcm9tIHRoZSByZWRpcmVjdCB3aGVuIHlvdXIgYXBwIGluaXRpYWxpemVzIHlvdSBjYW4gb2J0YWluIHRoZSByZXN1bHRcclxuICogY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2V0UmVkaXJlY3RSZXN1bHQoYXV0aCk7XHJcbiAqIGlmIChyZXN1bHQpIHtcclxuICogICAvLyBUaGlzIGlzIHRoZSBzaWduZWQtaW4gdXNlclxyXG4gKiAgIGNvbnN0IHVzZXIgPSByZXN1bHQudXNlcjtcclxuICogICAvLyBUaGlzIGdpdmVzIHlvdSBhIFR3aXR0ZXIgQWNjZXNzIFRva2VuIGFuZCBTZWNyZXQuXHJcbiAqICAgY29uc3QgY3JlZGVudGlhbCA9IHByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tUmVzdWx0KGF1dGgsIHJlc3VsdCk7XHJcbiAqICAgY29uc3QgdG9rZW4gPSBjcmVkZW50aWFsLmFjY2Vzc1Rva2VuO1xyXG4gKiAgIGNvbnN0IHNlY3JldCA9IGNyZWRlbnRpYWwuc2VjcmV0O1xyXG4gKiB9XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBAZXhhbXBsZVxyXG4gKiBgYGBqYXZhc2NyaXB0XHJcbiAqIC8vIFNpZ24gaW4gdXNpbmcgYSBwb3B1cC5cclxuICogY29uc3QgcHJvdmlkZXIgPSBuZXcgVHdpdHRlckF1dGhQcm92aWRlcigpO1xyXG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBzaWduSW5XaXRoUG9wdXAoYXV0aCwgcHJvdmlkZXIpO1xyXG4gKlxyXG4gKiAvLyBUaGUgc2lnbmVkLWluIHVzZXIgaW5mby5cclxuICogY29uc3QgdXNlciA9IHJlc3VsdC51c2VyO1xyXG4gKiAvLyBUaGlzIGdpdmVzIHlvdSBhIFR3aXR0ZXIgQWNjZXNzIFRva2VuIGFuZCBTZWNyZXQuXHJcbiAqIGNvbnN0IGNyZWRlbnRpYWwgPSBwcm92aWRlci5jcmVkZW50aWFsRnJvbVJlc3VsdChhdXRoLCByZXN1bHQpO1xyXG4gKiBjb25zdCB0b2tlbiA9IGNyZWRlbnRpYWwuYWNjZXNzVG9rZW47XHJcbiAqIGNvbnN0IHNlY3JldCA9IGNyZWRlbnRpYWwuc2VjcmV0O1xyXG4gKiBgYGBcclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuY2xhc3MgVHdpdHRlckF1dGhQcm92aWRlciBleHRlbmRzIEJhc2VPQXV0aFByb3ZpZGVyIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHN1cGVyKFwidHdpdHRlci5jb21cIiAvKiBUV0lUVEVSICovKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhIGNyZWRlbnRpYWwgZm9yIFR3aXR0ZXIuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHRva2VuIC0gVHdpdHRlciBhY2Nlc3MgdG9rZW4uXHJcbiAgICAgKiBAcGFyYW0gc2VjcmV0IC0gVHdpdHRlciBzZWNyZXQuXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBjcmVkZW50aWFsKHRva2VuLCBzZWNyZXQpIHtcclxuICAgICAgICByZXR1cm4gT0F1dGhDcmVkZW50aWFsLl9mcm9tUGFyYW1zKHtcclxuICAgICAgICAgICAgcHJvdmlkZXJJZDogVHdpdHRlckF1dGhQcm92aWRlci5QUk9WSURFUl9JRCxcclxuICAgICAgICAgICAgc2lnbkluTWV0aG9kOiBUd2l0dGVyQXV0aFByb3ZpZGVyLlRXSVRURVJfU0lHTl9JTl9NRVRIT0QsXHJcbiAgICAgICAgICAgIG9hdXRoVG9rZW46IHRva2VuLFxyXG4gICAgICAgICAgICBvYXV0aFRva2VuU2VjcmV0OiBzZWNyZXRcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogVXNlZCB0byBleHRyYWN0IHRoZSB1bmRlcmx5aW5nIHtAbGluayBPQXV0aENyZWRlbnRpYWx9IGZyb20gYSB7QGxpbmsgVXNlckNyZWRlbnRpYWx9LlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB1c2VyQ3JlZGVudGlhbCAtIFRoZSB1c2VyIGNyZWRlbnRpYWwuXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBjcmVkZW50aWFsRnJvbVJlc3VsdCh1c2VyQ3JlZGVudGlhbCkge1xyXG4gICAgICAgIHJldHVybiBUd2l0dGVyQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KHVzZXJDcmVkZW50aWFsKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogVXNlZCB0byBleHRyYWN0IHRoZSB1bmRlcmx5aW5nIHtAbGluayBPQXV0aENyZWRlbnRpYWx9IGZyb20gYSB7QGxpbmsgQXV0aEVycm9yfSB3aGljaCB3YXNcclxuICAgICAqIHRocm93biBkdXJpbmcgYSBzaWduLWluLCBsaW5rLCBvciByZWF1dGhlbnRpY2F0ZSBvcGVyYXRpb24uXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHVzZXJDcmVkZW50aWFsIC0gVGhlIHVzZXIgY3JlZGVudGlhbC5cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGNyZWRlbnRpYWxGcm9tRXJyb3IoZXJyb3IpIHtcclxuICAgICAgICByZXR1cm4gVHdpdHRlckF1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVRhZ2dlZE9iamVjdCgoZXJyb3IuY3VzdG9tRGF0YSB8fCB7fSkpO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIGNyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KHsgX3Rva2VuUmVzcG9uc2U6IHRva2VuUmVzcG9uc2UgfSkge1xyXG4gICAgICAgIGlmICghdG9rZW5SZXNwb25zZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgeyBvYXV0aEFjY2Vzc1Rva2VuLCBvYXV0aFRva2VuU2VjcmV0IH0gPSB0b2tlblJlc3BvbnNlO1xyXG4gICAgICAgIGlmICghb2F1dGhBY2Nlc3NUb2tlbiB8fCAhb2F1dGhUb2tlblNlY3JldCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgcmV0dXJuIFR3aXR0ZXJBdXRoUHJvdmlkZXIuY3JlZGVudGlhbChvYXV0aEFjY2Vzc1Rva2VuLCBvYXV0aFRva2VuU2VjcmV0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKF9hKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4vKiogQWx3YXlzIHNldCB0byB7QGxpbmsgU2lnbkluTWV0aG9kfS5UV0lUVEVSLiAqL1xyXG5Ud2l0dGVyQXV0aFByb3ZpZGVyLlRXSVRURVJfU0lHTl9JTl9NRVRIT0QgPSBcInR3aXR0ZXIuY29tXCIgLyogVFdJVFRFUiAqLztcclxuLyoqIEFsd2F5cyBzZXQgdG8ge0BsaW5rIFByb3ZpZGVySWR9LlRXSVRURVIuICovXHJcblR3aXR0ZXJBdXRoUHJvdmlkZXIuUFJPVklERVJfSUQgPSBcInR3aXR0ZXIuY29tXCIgLyogVFdJVFRFUiAqLztcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gc2lnblVwKGF1dGgsIHJlcXVlc3QpIHtcclxuICAgIHJldHVybiBfcGVyZm9ybVNpZ25JblJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogUE9TVCAqLywgXCIvdjEvYWNjb3VudHM6c2lnblVwXCIgLyogU0lHTl9VUCAqLywgX2FkZFRpZElmTmVjZXNzYXJ5KGF1dGgsIHJlcXVlc3QpKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jbGFzcyBVc2VyQ3JlZGVudGlhbEltcGwge1xyXG4gICAgY29uc3RydWN0b3IocGFyYW1zKSB7XHJcbiAgICAgICAgdGhpcy51c2VyID0gcGFyYW1zLnVzZXI7XHJcbiAgICAgICAgdGhpcy5wcm92aWRlcklkID0gcGFyYW1zLnByb3ZpZGVySWQ7XHJcbiAgICAgICAgdGhpcy5fdG9rZW5SZXNwb25zZSA9IHBhcmFtcy5fdG9rZW5SZXNwb25zZTtcclxuICAgICAgICB0aGlzLm9wZXJhdGlvblR5cGUgPSBwYXJhbXMub3BlcmF0aW9uVHlwZTtcclxuICAgIH1cclxuICAgIHN0YXRpYyBhc3luYyBfZnJvbUlkVG9rZW5SZXNwb25zZShhdXRoLCBvcGVyYXRpb25UeXBlLCBpZFRva2VuUmVzcG9uc2UsIGlzQW5vbnltb3VzID0gZmFsc2UpIHtcclxuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlckltcGwuX2Zyb21JZFRva2VuUmVzcG9uc2UoYXV0aCwgaWRUb2tlblJlc3BvbnNlLCBpc0Fub255bW91cyk7XHJcbiAgICAgICAgY29uc3QgcHJvdmlkZXJJZCA9IHByb3ZpZGVySWRGb3JSZXNwb25zZShpZFRva2VuUmVzcG9uc2UpO1xyXG4gICAgICAgIGNvbnN0IHVzZXJDcmVkID0gbmV3IFVzZXJDcmVkZW50aWFsSW1wbCh7XHJcbiAgICAgICAgICAgIHVzZXIsXHJcbiAgICAgICAgICAgIHByb3ZpZGVySWQsXHJcbiAgICAgICAgICAgIF90b2tlblJlc3BvbnNlOiBpZFRva2VuUmVzcG9uc2UsXHJcbiAgICAgICAgICAgIG9wZXJhdGlvblR5cGVcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gdXNlckNyZWQ7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgYXN5bmMgX2Zvck9wZXJhdGlvbih1c2VyLCBvcGVyYXRpb25UeXBlLCByZXNwb25zZSkge1xyXG4gICAgICAgIGF3YWl0IHVzZXIuX3VwZGF0ZVRva2Vuc0lmTmVjZXNzYXJ5KHJlc3BvbnNlLCAvKiByZWxvYWQgKi8gdHJ1ZSk7XHJcbiAgICAgICAgY29uc3QgcHJvdmlkZXJJZCA9IHByb3ZpZGVySWRGb3JSZXNwb25zZShyZXNwb25zZSk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBVc2VyQ3JlZGVudGlhbEltcGwoe1xyXG4gICAgICAgICAgICB1c2VyLFxyXG4gICAgICAgICAgICBwcm92aWRlcklkLFxyXG4gICAgICAgICAgICBfdG9rZW5SZXNwb25zZTogcmVzcG9uc2UsXHJcbiAgICAgICAgICAgIG9wZXJhdGlvblR5cGVcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBwcm92aWRlcklkRm9yUmVzcG9uc2UocmVzcG9uc2UpIHtcclxuICAgIGlmIChyZXNwb25zZS5wcm92aWRlcklkKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnByb3ZpZGVySWQ7XHJcbiAgICB9XHJcbiAgICBpZiAoJ3Bob25lTnVtYmVyJyBpbiByZXNwb25zZSkge1xyXG4gICAgICAgIHJldHVybiBcInBob25lXCIgLyogUEhPTkUgKi87XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbnVsbDtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogQXN5bmNocm9ub3VzbHkgc2lnbnMgaW4gYXMgYW4gYW5vbnltb3VzIHVzZXIuXHJcbiAqXHJcbiAqIEByZW1hcmtzXHJcbiAqIElmIHRoZXJlIGlzIGFscmVhZHkgYW4gYW5vbnltb3VzIHVzZXIgc2lnbmVkIGluLCB0aGF0IHVzZXIgd2lsbCBiZSByZXR1cm5lZDsgb3RoZXJ3aXNlLCBhXHJcbiAqIG5ldyBhbm9ueW1vdXMgdXNlciBpZGVudGl0eSB3aWxsIGJlIGNyZWF0ZWQgYW5kIHJldHVybmVkLlxyXG4gKlxyXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIHNpZ25JbkFub255bW91c2x5KGF1dGgpIHtcclxuICAgIHZhciBfYTtcclxuICAgIGNvbnN0IGF1dGhJbnRlcm5hbCA9IF9jYXN0QXV0aChhdXRoKTtcclxuICAgIGF3YWl0IGF1dGhJbnRlcm5hbC5faW5pdGlhbGl6YXRpb25Qcm9taXNlO1xyXG4gICAgaWYgKChfYSA9IGF1dGhJbnRlcm5hbC5jdXJyZW50VXNlcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmlzQW5vbnltb3VzKSB7XHJcbiAgICAgICAgLy8gSWYgYW4gYW5vbnltb3VzIHVzZXIgaXMgYWxyZWFkeSBzaWduZWQgaW4sIG5vIG5lZWQgdG8gc2lnbiB0aGVtIGluIGFnYWluLlxyXG4gICAgICAgIHJldHVybiBuZXcgVXNlckNyZWRlbnRpYWxJbXBsKHtcclxuICAgICAgICAgICAgdXNlcjogYXV0aEludGVybmFsLmN1cnJlbnRVc2VyLFxyXG4gICAgICAgICAgICBwcm92aWRlcklkOiBudWxsLFxyXG4gICAgICAgICAgICBvcGVyYXRpb25UeXBlOiBcInNpZ25JblwiIC8qIFNJR05fSU4gKi9cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgc2lnblVwKGF1dGhJbnRlcm5hbCwge1xyXG4gICAgICAgIHJldHVyblNlY3VyZVRva2VuOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIGNvbnN0IHVzZXJDcmVkZW50aWFsID0gYXdhaXQgVXNlckNyZWRlbnRpYWxJbXBsLl9mcm9tSWRUb2tlblJlc3BvbnNlKGF1dGhJbnRlcm5hbCwgXCJzaWduSW5cIiAvKiBTSUdOX0lOICovLCByZXNwb25zZSwgdHJ1ZSk7XHJcbiAgICBhd2FpdCBhdXRoSW50ZXJuYWwuX3VwZGF0ZUN1cnJlbnRVc2VyKHVzZXJDcmVkZW50aWFsLnVzZXIpO1xyXG4gICAgcmV0dXJuIHVzZXJDcmVkZW50aWFsO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmNsYXNzIE11bHRpRmFjdG9yRXJyb3IgZXh0ZW5kcyBGaXJlYmFzZUVycm9yIHtcclxuICAgIGNvbnN0cnVjdG9yKGF1dGgsIGVycm9yLCBvcGVyYXRpb25UeXBlLCB1c2VyKSB7XHJcbiAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgIHN1cGVyKGVycm9yLmNvZGUsIGVycm9yLm1lc3NhZ2UpO1xyXG4gICAgICAgIHRoaXMub3BlcmF0aW9uVHlwZSA9IG9wZXJhdGlvblR5cGU7XHJcbiAgICAgICAgdGhpcy51c2VyID0gdXNlcjtcclxuICAgICAgICB0aGlzLm5hbWUgPSAnRmlyZWJhc2VFcnJvcic7XHJcbiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL01pY3Jvc29mdC9UeXBlU2NyaXB0LXdpa2kvYmxvYi9tYXN0ZXIvQnJlYWtpbmctQ2hhbmdlcy5tZCNleHRlbmRpbmctYnVpbHQtaW5zLWxpa2UtZXJyb3ItYXJyYXktYW5kLW1hcC1tYXktbm8tbG9uZ2VyLXdvcmtcclxuICAgICAgICBPYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcywgTXVsdGlGYWN0b3JFcnJvci5wcm90b3R5cGUpO1xyXG4gICAgICAgIHRoaXMuYXBwTmFtZSA9IGF1dGgubmFtZTtcclxuICAgICAgICB0aGlzLmNvZGUgPSBlcnJvci5jb2RlO1xyXG4gICAgICAgIHRoaXMudGVuYW50SWQgPSAoX2EgPSBhdXRoLnRlbmFudElkKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiB1bmRlZmluZWQ7XHJcbiAgICAgICAgdGhpcy5zZXJ2ZXJSZXNwb25zZSA9IGVycm9yLmN1c3RvbURhdGFcclxuICAgICAgICAgICAgLnNlcnZlclJlc3BvbnNlO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIF9mcm9tRXJyb3JBbmRPcGVyYXRpb24oYXV0aCwgZXJyb3IsIG9wZXJhdGlvblR5cGUsIHVzZXIpIHtcclxuICAgICAgICByZXR1cm4gbmV3IE11bHRpRmFjdG9yRXJyb3IoYXV0aCwgZXJyb3IsIG9wZXJhdGlvblR5cGUsIHVzZXIpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIF9wcm9jZXNzQ3JlZGVudGlhbFNhdmluZ01mYUNvbnRleHRJZk5lY2Vzc2FyeShhdXRoLCBvcGVyYXRpb25UeXBlLCBjcmVkZW50aWFsLCB1c2VyKSB7XHJcbiAgICBjb25zdCBpZFRva2VuUHJvdmlkZXIgPSBvcGVyYXRpb25UeXBlID09PSBcInJlYXV0aGVudGljYXRlXCIgLyogUkVBVVRIRU5USUNBVEUgKi9cclxuICAgICAgICA/IGNyZWRlbnRpYWwuX2dldFJlYXV0aGVudGljYXRpb25SZXNvbHZlcihhdXRoKVxyXG4gICAgICAgIDogY3JlZGVudGlhbC5fZ2V0SWRUb2tlblJlc3BvbnNlKGF1dGgpO1xyXG4gICAgcmV0dXJuIGlkVG9rZW5Qcm92aWRlci5jYXRjaChlcnJvciA9PiB7XHJcbiAgICAgICAgaWYgKGVycm9yLmNvZGUgPT09IGBhdXRoLyR7XCJtdWx0aS1mYWN0b3ItYXV0aC1yZXF1aXJlZFwiIC8qIE1GQV9SRVFVSVJFRCAqL31gKSB7XHJcbiAgICAgICAgICAgIHRocm93IE11bHRpRmFjdG9yRXJyb3IuX2Zyb21FcnJvckFuZE9wZXJhdGlvbihhdXRoLCBlcnJvciwgb3BlcmF0aW9uVHlwZSwgdXNlcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRocm93IGVycm9yO1xyXG4gICAgfSk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFRha2VzIGEgc2V0IG9mIFVzZXJJbmZvIHByb3ZpZGVyIGRhdGEgYW5kIGNvbnZlcnRzIGl0IHRvIGEgc2V0IG9mIG5hbWVzXHJcbiAqL1xyXG5mdW5jdGlvbiBwcm92aWRlckRhdGFBc05hbWVzKHByb3ZpZGVyRGF0YSkge1xyXG4gICAgcmV0dXJuIG5ldyBTZXQocHJvdmlkZXJEYXRhXHJcbiAgICAgICAgLm1hcCgoeyBwcm92aWRlcklkIH0pID0+IHByb3ZpZGVySWQpXHJcbiAgICAgICAgLmZpbHRlcihwaWQgPT4gISFwaWQpKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogVW5saW5rcyBhIHByb3ZpZGVyIGZyb20gYSB1c2VyIGFjY291bnQuXHJcbiAqXHJcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXHJcbiAqIEBwYXJhbSBwcm92aWRlcklkIC0gVGhlIHByb3ZpZGVyIHRvIHVubGluay5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gdW5saW5rKHVzZXIsIHByb3ZpZGVySWQpIHtcclxuICAgIGNvbnN0IHVzZXJJbnRlcm5hbCA9IGdldE1vZHVsYXJJbnN0YW5jZSh1c2VyKTtcclxuICAgIGF3YWl0IF9hc3NlcnRMaW5rZWRTdGF0dXModHJ1ZSwgdXNlckludGVybmFsLCBwcm92aWRlcklkKTtcclxuICAgIGNvbnN0IHsgcHJvdmlkZXJVc2VySW5mbyB9ID0gYXdhaXQgZGVsZXRlTGlua2VkQWNjb3VudHModXNlckludGVybmFsLmF1dGgsIHtcclxuICAgICAgICBpZFRva2VuOiBhd2FpdCB1c2VySW50ZXJuYWwuZ2V0SWRUb2tlbigpLFxyXG4gICAgICAgIGRlbGV0ZVByb3ZpZGVyOiBbcHJvdmlkZXJJZF1cclxuICAgIH0pO1xyXG4gICAgY29uc3QgcHJvdmlkZXJzTGVmdCA9IHByb3ZpZGVyRGF0YUFzTmFtZXMocHJvdmlkZXJVc2VySW5mbyB8fCBbXSk7XHJcbiAgICB1c2VySW50ZXJuYWwucHJvdmlkZXJEYXRhID0gdXNlckludGVybmFsLnByb3ZpZGVyRGF0YS5maWx0ZXIocGQgPT4gcHJvdmlkZXJzTGVmdC5oYXMocGQucHJvdmlkZXJJZCkpO1xyXG4gICAgaWYgKCFwcm92aWRlcnNMZWZ0LmhhcyhcInBob25lXCIgLyogUEhPTkUgKi8pKSB7XHJcbiAgICAgICAgdXNlckludGVybmFsLnBob25lTnVtYmVyID0gbnVsbDtcclxuICAgIH1cclxuICAgIGF3YWl0IHVzZXJJbnRlcm5hbC5hdXRoLl9wZXJzaXN0VXNlcklmQ3VycmVudCh1c2VySW50ZXJuYWwpO1xyXG4gICAgcmV0dXJuIHVzZXJJbnRlcm5hbDtcclxufVxyXG5hc3luYyBmdW5jdGlvbiBfbGluayQxKHVzZXIsIGNyZWRlbnRpYWwsIGJ5cGFzc0F1dGhTdGF0ZSA9IGZhbHNlKSB7XHJcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IF9sb2dvdXRJZkludmFsaWRhdGVkKHVzZXIsIGNyZWRlbnRpYWwuX2xpbmtUb0lkVG9rZW4odXNlci5hdXRoLCBhd2FpdCB1c2VyLmdldElkVG9rZW4oKSksIGJ5cGFzc0F1dGhTdGF0ZSk7XHJcbiAgICByZXR1cm4gVXNlckNyZWRlbnRpYWxJbXBsLl9mb3JPcGVyYXRpb24odXNlciwgXCJsaW5rXCIgLyogTElOSyAqLywgcmVzcG9uc2UpO1xyXG59XHJcbmFzeW5jIGZ1bmN0aW9uIF9hc3NlcnRMaW5rZWRTdGF0dXMoZXhwZWN0ZWQsIHVzZXIsIHByb3ZpZGVyKSB7XHJcbiAgICBhd2FpdCBfcmVsb2FkV2l0aG91dFNhdmluZyh1c2VyKTtcclxuICAgIGNvbnN0IHByb3ZpZGVySWRzID0gcHJvdmlkZXJEYXRhQXNOYW1lcyh1c2VyLnByb3ZpZGVyRGF0YSk7XHJcbiAgICBjb25zdCBjb2RlID0gZXhwZWN0ZWQgPT09IGZhbHNlXHJcbiAgICAgICAgPyBcInByb3ZpZGVyLWFscmVhZHktbGlua2VkXCIgLyogUFJPVklERVJfQUxSRUFEWV9MSU5LRUQgKi9cclxuICAgICAgICA6IFwibm8tc3VjaC1wcm92aWRlclwiIC8qIE5PX1NVQ0hfUFJPVklERVIgKi87XHJcbiAgICBfYXNzZXJ0KHByb3ZpZGVySWRzLmhhcyhwcm92aWRlcikgPT09IGV4cGVjdGVkLCB1c2VyLmF1dGgsIGNvZGUpO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIF9yZWF1dGhlbnRpY2F0ZSh1c2VyLCBjcmVkZW50aWFsLCBieXBhc3NBdXRoU3RhdGUgPSBmYWxzZSkge1xyXG4gICAgY29uc3QgeyBhdXRoIH0gPSB1c2VyO1xyXG4gICAgY29uc3Qgb3BlcmF0aW9uVHlwZSA9IFwicmVhdXRoZW50aWNhdGVcIiAvKiBSRUFVVEhFTlRJQ0FURSAqLztcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBfbG9nb3V0SWZJbnZhbGlkYXRlZCh1c2VyLCBfcHJvY2Vzc0NyZWRlbnRpYWxTYXZpbmdNZmFDb250ZXh0SWZOZWNlc3NhcnkoYXV0aCwgb3BlcmF0aW9uVHlwZSwgY3JlZGVudGlhbCwgdXNlciksIGJ5cGFzc0F1dGhTdGF0ZSk7XHJcbiAgICAgICAgX2Fzc2VydChyZXNwb25zZS5pZFRva2VuLCBhdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8pO1xyXG4gICAgICAgIGNvbnN0IHBhcnNlZCA9IF9wYXJzZVRva2VuKHJlc3BvbnNlLmlkVG9rZW4pO1xyXG4gICAgICAgIF9hc3NlcnQocGFyc2VkLCBhdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8pO1xyXG4gICAgICAgIGNvbnN0IHsgc3ViOiBsb2NhbElkIH0gPSBwYXJzZWQ7XHJcbiAgICAgICAgX2Fzc2VydCh1c2VyLnVpZCA9PT0gbG9jYWxJZCwgYXV0aCwgXCJ1c2VyLW1pc21hdGNoXCIgLyogVVNFUl9NSVNNQVRDSCAqLyk7XHJcbiAgICAgICAgcmV0dXJuIFVzZXJDcmVkZW50aWFsSW1wbC5fZm9yT3BlcmF0aW9uKHVzZXIsIG9wZXJhdGlvblR5cGUsIHJlc3BvbnNlKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgLy8gQ29udmVydCB1c2VyIGRlbGV0ZWQgZXJyb3IgaW50byB1c2VyIG1pc21hdGNoXHJcbiAgICAgICAgaWYgKChlID09PSBudWxsIHx8IGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGUuY29kZSkgPT09IGBhdXRoLyR7XCJ1c2VyLW5vdC1mb3VuZFwiIC8qIFVTRVJfREVMRVRFRCAqL31gKSB7XHJcbiAgICAgICAgICAgIF9mYWlsKGF1dGgsIFwidXNlci1taXNtYXRjaFwiIC8qIFVTRVJfTUlTTUFUQ0ggKi8pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aHJvdyBlO1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIF9zaWduSW5XaXRoQ3JlZGVudGlhbChhdXRoLCBjcmVkZW50aWFsLCBieXBhc3NBdXRoU3RhdGUgPSBmYWxzZSkge1xyXG4gICAgY29uc3Qgb3BlcmF0aW9uVHlwZSA9IFwic2lnbkluXCIgLyogU0lHTl9JTiAqLztcclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgX3Byb2Nlc3NDcmVkZW50aWFsU2F2aW5nTWZhQ29udGV4dElmTmVjZXNzYXJ5KGF1dGgsIG9wZXJhdGlvblR5cGUsIGNyZWRlbnRpYWwpO1xyXG4gICAgY29uc3QgdXNlckNyZWRlbnRpYWwgPSBhd2FpdCBVc2VyQ3JlZGVudGlhbEltcGwuX2Zyb21JZFRva2VuUmVzcG9uc2UoYXV0aCwgb3BlcmF0aW9uVHlwZSwgcmVzcG9uc2UpO1xyXG4gICAgaWYgKCFieXBhc3NBdXRoU3RhdGUpIHtcclxuICAgICAgICBhd2FpdCBhdXRoLl91cGRhdGVDdXJyZW50VXNlcih1c2VyQ3JlZGVudGlhbC51c2VyKTtcclxuICAgIH1cclxuICAgIHJldHVybiB1c2VyQ3JlZGVudGlhbDtcclxufVxyXG4vKipcclxuICogQXN5bmNocm9ub3VzbHkgc2lnbnMgaW4gd2l0aCB0aGUgZ2l2ZW4gY3JlZGVudGlhbHMuXHJcbiAqXHJcbiAqIEByZW1hcmtzXHJcbiAqIEFuIHtAbGluayBBdXRoUHJvdmlkZXJ9IGNhbiBiZSB1c2VkIHRvIGdlbmVyYXRlIHRoZSBjcmVkZW50aWFsLlxyXG4gKlxyXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXHJcbiAqIEBwYXJhbSBjcmVkZW50aWFsIC0gVGhlIGF1dGggY3JlZGVudGlhbC5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gc2lnbkluV2l0aENyZWRlbnRpYWwoYXV0aCwgY3JlZGVudGlhbCkge1xyXG4gICAgcmV0dXJuIF9zaWduSW5XaXRoQ3JlZGVudGlhbChfY2FzdEF1dGgoYXV0aCksIGNyZWRlbnRpYWwpO1xyXG59XHJcbi8qKlxyXG4gKiBMaW5rcyB0aGUgdXNlciBhY2NvdW50IHdpdGggdGhlIGdpdmVuIGNyZWRlbnRpYWxzLlxyXG4gKlxyXG4gKiBAcmVtYXJrc1xyXG4gKiBBbiB7QGxpbmsgQXV0aFByb3ZpZGVyfSBjYW4gYmUgdXNlZCB0byBnZW5lcmF0ZSB0aGUgY3JlZGVudGlhbC5cclxuICpcclxuICogQHBhcmFtIHVzZXIgLSBUaGUgdXNlci5cclxuICogQHBhcmFtIGNyZWRlbnRpYWwgLSBUaGUgYXV0aCBjcmVkZW50aWFsLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBsaW5rV2l0aENyZWRlbnRpYWwodXNlciwgY3JlZGVudGlhbCkge1xyXG4gICAgY29uc3QgdXNlckludGVybmFsID0gZ2V0TW9kdWxhckluc3RhbmNlKHVzZXIpO1xyXG4gICAgYXdhaXQgX2Fzc2VydExpbmtlZFN0YXR1cyhmYWxzZSwgdXNlckludGVybmFsLCBjcmVkZW50aWFsLnByb3ZpZGVySWQpO1xyXG4gICAgcmV0dXJuIF9saW5rJDEodXNlckludGVybmFsLCBjcmVkZW50aWFsKTtcclxufVxyXG4vKipcclxuICogUmUtYXV0aGVudGljYXRlcyBhIHVzZXIgdXNpbmcgYSBmcmVzaCBjcmVkZW50aWFsLlxyXG4gKlxyXG4gKiBAcmVtYXJrc1xyXG4gKiBVc2UgYmVmb3JlIG9wZXJhdGlvbnMgc3VjaCBhcyB7QGxpbmsgdXBkYXRlUGFzc3dvcmR9IHRoYXQgcmVxdWlyZSB0b2tlbnMgZnJvbSByZWNlbnQgc2lnbi1pblxyXG4gKiBhdHRlbXB0cy4gVGhpcyBtZXRob2QgY2FuIGJlIHVzZWQgdG8gcmVjb3ZlciBmcm9tIGEgYENSRURFTlRJQUxfVE9PX09MRF9MT0dJTl9BR0FJTmAgZXJyb3IuXHJcbiAqXHJcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXHJcbiAqIEBwYXJhbSBjcmVkZW50aWFsIC0gVGhlIGF1dGggY3JlZGVudGlhbC5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gcmVhdXRoZW50aWNhdGVXaXRoQ3JlZGVudGlhbCh1c2VyLCBjcmVkZW50aWFsKSB7XHJcbiAgICByZXR1cm4gX3JlYXV0aGVudGljYXRlKGdldE1vZHVsYXJJbnN0YW5jZSh1c2VyKSwgY3JlZGVudGlhbCk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gc2lnbkluV2l0aEN1c3RvbVRva2VuJDEoYXV0aCwgcmVxdWVzdCkge1xyXG4gICAgcmV0dXJuIF9wZXJmb3JtU2lnbkluUmVxdWVzdChhdXRoLCBcIlBPU1RcIiAvKiBQT1NUICovLCBcIi92MS9hY2NvdW50czpzaWduSW5XaXRoQ3VzdG9tVG9rZW5cIiAvKiBTSUdOX0lOX1dJVEhfQ1VTVE9NX1RPS0VOICovLCBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdCkpO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBBc3luY2hyb25vdXNseSBzaWducyBpbiB1c2luZyBhIGN1c3RvbSB0b2tlbi5cclxuICpcclxuICogQHJlbWFya3NcclxuICogQ3VzdG9tIHRva2VucyBhcmUgdXNlZCB0byBpbnRlZ3JhdGUgRmlyZWJhc2UgQXV0aCB3aXRoIGV4aXN0aW5nIGF1dGggc3lzdGVtcywgYW5kIG11c3RcclxuICogYmUgZ2VuZXJhdGVkIGJ5IGFuIGF1dGggYmFja2VuZCB1c2luZyB0aGVcclxuICoge0BsaW5rIGh0dHBzOi8vZmlyZWJhc2UuZ29vZ2xlLmNvbS9kb2NzL3JlZmVyZW5jZS9hZG1pbi9ub2RlL2FkbWluLmF1dGguQXV0aCNjcmVhdGVjdXN0b210b2tlbiB8IGNyZWF0ZUN1c3RvbVRva2VufVxyXG4gKiBtZXRob2QgaW4gdGhlIHtAbGluayBodHRwczovL2ZpcmViYXNlLmdvb2dsZS5jb20vZG9jcy9hdXRoL2FkbWluIHwgQWRtaW4gU0RLfSAuXHJcbiAqXHJcbiAqIEZhaWxzIHdpdGggYW4gZXJyb3IgaWYgdGhlIHRva2VuIGlzIGludmFsaWQsIGV4cGlyZWQsIG9yIG5vdCBhY2NlcHRlZCBieSB0aGUgRmlyZWJhc2UgQXV0aCBzZXJ2aWNlLlxyXG4gKlxyXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXHJcbiAqIEBwYXJhbSBjdXN0b21Ub2tlbiAtIFRoZSBjdXN0b20gdG9rZW4gdG8gc2lnbiBpbiB3aXRoLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBzaWduSW5XaXRoQ3VzdG9tVG9rZW4oYXV0aCwgY3VzdG9tVG9rZW4pIHtcclxuICAgIGNvbnN0IGF1dGhJbnRlcm5hbCA9IF9jYXN0QXV0aChhdXRoKTtcclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgc2lnbkluV2l0aEN1c3RvbVRva2VuJDEoYXV0aEludGVybmFsLCB7XHJcbiAgICAgICAgdG9rZW46IGN1c3RvbVRva2VuLFxyXG4gICAgICAgIHJldHVyblNlY3VyZVRva2VuOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIGNvbnN0IGNyZWQgPSBhd2FpdCBVc2VyQ3JlZGVudGlhbEltcGwuX2Zyb21JZFRva2VuUmVzcG9uc2UoYXV0aEludGVybmFsLCBcInNpZ25JblwiIC8qIFNJR05fSU4gKi8sIHJlc3BvbnNlKTtcclxuICAgIGF3YWl0IGF1dGhJbnRlcm5hbC5fdXBkYXRlQ3VycmVudFVzZXIoY3JlZC51c2VyKTtcclxuICAgIHJldHVybiBjcmVkO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmNsYXNzIE11bHRpRmFjdG9ySW5mb0ltcGwge1xyXG4gICAgY29uc3RydWN0b3IoZmFjdG9ySWQsIHJlc3BvbnNlKSB7XHJcbiAgICAgICAgdGhpcy5mYWN0b3JJZCA9IGZhY3RvcklkO1xyXG4gICAgICAgIHRoaXMudWlkID0gcmVzcG9uc2UubWZhRW5yb2xsbWVudElkO1xyXG4gICAgICAgIHRoaXMuZW5yb2xsbWVudFRpbWUgPSBuZXcgRGF0ZShyZXNwb25zZS5lbnJvbGxlZEF0KS50b1VUQ1N0cmluZygpO1xyXG4gICAgICAgIHRoaXMuZGlzcGxheU5hbWUgPSByZXNwb25zZS5kaXNwbGF5TmFtZTtcclxuICAgIH1cclxuICAgIHN0YXRpYyBfZnJvbVNlcnZlclJlc3BvbnNlKGF1dGgsIGVucm9sbG1lbnQpIHtcclxuICAgICAgICBpZiAoJ3Bob25lSW5mbycgaW4gZW5yb2xsbWVudCkge1xyXG4gICAgICAgICAgICByZXR1cm4gUGhvbmVNdWx0aUZhY3RvckluZm8uX2Zyb21TZXJ2ZXJSZXNwb25zZShhdXRoLCBlbnJvbGxtZW50KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIF9mYWlsKGF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyk7XHJcbiAgICB9XHJcbn1cclxuY2xhc3MgUGhvbmVNdWx0aUZhY3RvckluZm8gZXh0ZW5kcyBNdWx0aUZhY3RvckluZm9JbXBsIHtcclxuICAgIGNvbnN0cnVjdG9yKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgc3VwZXIoXCJwaG9uZVwiIC8qIFBIT05FICovLCByZXNwb25zZSk7XHJcbiAgICAgICAgdGhpcy5waG9uZU51bWJlciA9IHJlc3BvbnNlLnBob25lSW5mbztcclxuICAgIH1cclxuICAgIHN0YXRpYyBfZnJvbVNlcnZlclJlc3BvbnNlKF9hdXRoLCBlbnJvbGxtZW50KSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQaG9uZU11bHRpRmFjdG9ySW5mbyhlbnJvbGxtZW50KTtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5mdW5jdGlvbiBfc2V0QWN0aW9uQ29kZVNldHRpbmdzT25SZXF1ZXN0KGF1dGgsIHJlcXVlc3QsIGFjdGlvbkNvZGVTZXR0aW5ncykge1xyXG4gICAgdmFyIF9hO1xyXG4gICAgX2Fzc2VydCgoKF9hID0gYWN0aW9uQ29kZVNldHRpbmdzLnVybCkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmxlbmd0aCkgPiAwLCBhdXRoLCBcImludmFsaWQtY29udGludWUtdXJpXCIgLyogSU5WQUxJRF9DT05USU5VRV9VUkkgKi8pO1xyXG4gICAgX2Fzc2VydCh0eXBlb2YgYWN0aW9uQ29kZVNldHRpbmdzLmR5bmFtaWNMaW5rRG9tYWluID09PSAndW5kZWZpbmVkJyB8fFxyXG4gICAgICAgIGFjdGlvbkNvZGVTZXR0aW5ncy5keW5hbWljTGlua0RvbWFpbi5sZW5ndGggPiAwLCBhdXRoLCBcImludmFsaWQtZHluYW1pYy1saW5rLWRvbWFpblwiIC8qIElOVkFMSURfRFlOQU1JQ19MSU5LX0RPTUFJTiAqLyk7XHJcbiAgICByZXF1ZXN0LmNvbnRpbnVlVXJsID0gYWN0aW9uQ29kZVNldHRpbmdzLnVybDtcclxuICAgIHJlcXVlc3QuZHluYW1pY0xpbmtEb21haW4gPSBhY3Rpb25Db2RlU2V0dGluZ3MuZHluYW1pY0xpbmtEb21haW47XHJcbiAgICByZXF1ZXN0LmNhbkhhbmRsZUNvZGVJbkFwcCA9IGFjdGlvbkNvZGVTZXR0aW5ncy5oYW5kbGVDb2RlSW5BcHA7XHJcbiAgICBpZiAoYWN0aW9uQ29kZVNldHRpbmdzLmlPUykge1xyXG4gICAgICAgIF9hc3NlcnQoYWN0aW9uQ29kZVNldHRpbmdzLmlPUy5idW5kbGVJZC5sZW5ndGggPiAwLCBhdXRoLCBcIm1pc3NpbmctaW9zLWJ1bmRsZS1pZFwiIC8qIE1JU1NJTkdfSU9TX0JVTkRMRV9JRCAqLyk7XHJcbiAgICAgICAgcmVxdWVzdC5pb3NCdW5kbGVJZCA9IGFjdGlvbkNvZGVTZXR0aW5ncy5pT1MuYnVuZGxlSWQ7XHJcbiAgICB9XHJcbiAgICBpZiAoYWN0aW9uQ29kZVNldHRpbmdzLmFuZHJvaWQpIHtcclxuICAgICAgICBfYXNzZXJ0KGFjdGlvbkNvZGVTZXR0aW5ncy5hbmRyb2lkLnBhY2thZ2VOYW1lLmxlbmd0aCA+IDAsIGF1dGgsIFwibWlzc2luZy1hbmRyb2lkLXBrZy1uYW1lXCIgLyogTUlTU0lOR19BTkRST0lEX1BBQ0tBR0VfTkFNRSAqLyk7XHJcbiAgICAgICAgcmVxdWVzdC5hbmRyb2lkSW5zdGFsbEFwcCA9IGFjdGlvbkNvZGVTZXR0aW5ncy5hbmRyb2lkLmluc3RhbGxBcHA7XHJcbiAgICAgICAgcmVxdWVzdC5hbmRyb2lkTWluaW11bVZlcnNpb25Db2RlID1cclxuICAgICAgICAgICAgYWN0aW9uQ29kZVNldHRpbmdzLmFuZHJvaWQubWluaW11bVZlcnNpb247XHJcbiAgICAgICAgcmVxdWVzdC5hbmRyb2lkUGFja2FnZU5hbWUgPSBhY3Rpb25Db2RlU2V0dGluZ3MuYW5kcm9pZC5wYWNrYWdlTmFtZTtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogU2VuZHMgYSBwYXNzd29yZCByZXNldCBlbWFpbCB0byB0aGUgZ2l2ZW4gZW1haWwgYWRkcmVzcy5cclxuICpcclxuICogQHJlbWFya3NcclxuICogVG8gY29tcGxldGUgdGhlIHBhc3N3b3JkIHJlc2V0LCBjYWxsIHtAbGluayBjb25maXJtUGFzc3dvcmRSZXNldH0gd2l0aCB0aGUgY29kZSBzdXBwbGllZCBpblxyXG4gKiB0aGUgZW1haWwgc2VudCB0byB0aGUgdXNlciwgYWxvbmcgd2l0aCB0aGUgbmV3IHBhc3N3b3JkIHNwZWNpZmllZCBieSB0aGUgdXNlci5cclxuICpcclxuICogQGV4YW1wbGVcclxuICogYGBgamF2YXNjcmlwdFxyXG4gKiBjb25zdCBhY3Rpb25Db2RlU2V0dGluZ3MgPSB7XHJcbiAqICAgdXJsOiAnaHR0cHM6Ly93d3cuZXhhbXBsZS5jb20vP2VtYWlsPXVzZXJAZXhhbXBsZS5jb20nLFxyXG4gKiAgIGlPUzoge1xyXG4gKiAgICAgIGJ1bmRsZUlkOiAnY29tLmV4YW1wbGUuaW9zJ1xyXG4gKiAgIH0sXHJcbiAqICAgYW5kcm9pZDoge1xyXG4gKiAgICAgcGFja2FnZU5hbWU6ICdjb20uZXhhbXBsZS5hbmRyb2lkJyxcclxuICogICAgIGluc3RhbGxBcHA6IHRydWUsXHJcbiAqICAgICBtaW5pbXVtVmVyc2lvbjogJzEyJ1xyXG4gKiAgIH0sXHJcbiAqICAgaGFuZGxlQ29kZUluQXBwOiB0cnVlXHJcbiAqIH07XHJcbiAqIGF3YWl0IHNlbmRQYXNzd29yZFJlc2V0RW1haWwoYXV0aCwgJ3VzZXJAZXhhbXBsZS5jb20nLCBhY3Rpb25Db2RlU2V0dGluZ3MpO1xyXG4gKiAvLyBPYnRhaW4gY29kZSBmcm9tIHVzZXIuXHJcbiAqIGF3YWl0IGNvbmZpcm1QYXNzd29yZFJlc2V0KCd1c2VyQGV4YW1wbGUuY29tJywgY29kZSk7XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXHJcbiAqIEBwYXJhbSBlbWFpbCAtIFRoZSB1c2VyJ3MgZW1haWwgYWRkcmVzcy5cclxuICogQHBhcmFtIGFjdGlvbkNvZGVTZXR0aW5ncyAtIFRoZSB7QGxpbmsgQWN0aW9uQ29kZVNldHRpbmdzfS5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gc2VuZFBhc3N3b3JkUmVzZXRFbWFpbChhdXRoLCBlbWFpbCwgYWN0aW9uQ29kZVNldHRpbmdzKSB7XHJcbiAgICBjb25zdCBhdXRoTW9kdWxhciA9IGdldE1vZHVsYXJJbnN0YW5jZShhdXRoKTtcclxuICAgIGNvbnN0IHJlcXVlc3QgPSB7XHJcbiAgICAgICAgcmVxdWVzdFR5cGU6IFwiUEFTU1dPUkRfUkVTRVRcIiAvKiBQQVNTV09SRF9SRVNFVCAqLyxcclxuICAgICAgICBlbWFpbFxyXG4gICAgfTtcclxuICAgIGlmIChhY3Rpb25Db2RlU2V0dGluZ3MpIHtcclxuICAgICAgICBfc2V0QWN0aW9uQ29kZVNldHRpbmdzT25SZXF1ZXN0KGF1dGhNb2R1bGFyLCByZXF1ZXN0LCBhY3Rpb25Db2RlU2V0dGluZ3MpO1xyXG4gICAgfVxyXG4gICAgYXdhaXQgc2VuZFBhc3N3b3JkUmVzZXRFbWFpbCQxKGF1dGhNb2R1bGFyLCByZXF1ZXN0KTtcclxufVxyXG4vKipcclxuICogQ29tcGxldGVzIHRoZSBwYXNzd29yZCByZXNldCBwcm9jZXNzLCBnaXZlbiBhIGNvbmZpcm1hdGlvbiBjb2RlIGFuZCBuZXcgcGFzc3dvcmQuXHJcbiAqXHJcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cclxuICogQHBhcmFtIG9vYkNvZGUgLSBBIGNvbmZpcm1hdGlvbiBjb2RlIHNlbnQgdG8gdGhlIHVzZXIuXHJcbiAqIEBwYXJhbSBuZXdQYXNzd29yZCAtIFRoZSBuZXcgcGFzc3dvcmQuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIGNvbmZpcm1QYXNzd29yZFJlc2V0KGF1dGgsIG9vYkNvZGUsIG5ld1Bhc3N3b3JkKSB7XHJcbiAgICBhd2FpdCByZXNldFBhc3N3b3JkKGdldE1vZHVsYXJJbnN0YW5jZShhdXRoKSwge1xyXG4gICAgICAgIG9vYkNvZGUsXHJcbiAgICAgICAgbmV3UGFzc3dvcmRcclxuICAgIH0pO1xyXG4gICAgLy8gRG8gbm90IHJldHVybiB0aGUgZW1haWwuXHJcbn1cclxuLyoqXHJcbiAqIEFwcGxpZXMgYSB2ZXJpZmljYXRpb24gY29kZSBzZW50IHRvIHRoZSB1c2VyIGJ5IGVtYWlsIG9yIG90aGVyIG91dC1vZi1iYW5kIG1lY2hhbmlzbS5cclxuICpcclxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxyXG4gKiBAcGFyYW0gb29iQ29kZSAtIEEgdmVyaWZpY2F0aW9uIGNvZGUgc2VudCB0byB0aGUgdXNlci5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gYXBwbHlBY3Rpb25Db2RlKGF1dGgsIG9vYkNvZGUpIHtcclxuICAgIGF3YWl0IGFwcGx5QWN0aW9uQ29kZSQxKGdldE1vZHVsYXJJbnN0YW5jZShhdXRoKSwgeyBvb2JDb2RlIH0pO1xyXG59XHJcbi8qKlxyXG4gKiBDaGVja3MgYSB2ZXJpZmljYXRpb24gY29kZSBzZW50IHRvIHRoZSB1c2VyIGJ5IGVtYWlsIG9yIG90aGVyIG91dC1vZi1iYW5kIG1lY2hhbmlzbS5cclxuICpcclxuICogQHJldHVybnMgbWV0YWRhdGEgYWJvdXQgdGhlIGNvZGUuXHJcbiAqXHJcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cclxuICogQHBhcmFtIG9vYkNvZGUgLSBBIHZlcmlmaWNhdGlvbiBjb2RlIHNlbnQgdG8gdGhlIHVzZXIuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIGNoZWNrQWN0aW9uQ29kZShhdXRoLCBvb2JDb2RlKSB7XHJcbiAgICBjb25zdCBhdXRoTW9kdWxhciA9IGdldE1vZHVsYXJJbnN0YW5jZShhdXRoKTtcclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVzZXRQYXNzd29yZChhdXRoTW9kdWxhciwgeyBvb2JDb2RlIH0pO1xyXG4gICAgLy8gRW1haWwgY291bGQgYmUgZW1wdHkgb25seSBpZiB0aGUgcmVxdWVzdCB0eXBlIGlzIEVNQUlMX1NJR05JTiBvclxyXG4gICAgLy8gVkVSSUZZX0FORF9DSEFOR0VfRU1BSUwuXHJcbiAgICAvLyBOZXcgZW1haWwgc2hvdWxkIG5vdCBiZSBlbXB0eSBpZiB0aGUgcmVxdWVzdCB0eXBlIGlzXHJcbiAgICAvLyBWRVJJRllfQU5EX0NIQU5HRV9FTUFJTC5cclxuICAgIC8vIE11bHRpLWZhY3RvciBpbmZvIGNvdWxkIG5vdCBiZSBlbXB0eSBpZiB0aGUgcmVxdWVzdCB0eXBlIGlzXHJcbiAgICAvLyBSRVZFUlRfU0VDT05EX0ZBQ1RPUl9BRERJVElPTi5cclxuICAgIGNvbnN0IG9wZXJhdGlvbiA9IHJlc3BvbnNlLnJlcXVlc3RUeXBlO1xyXG4gICAgX2Fzc2VydChvcGVyYXRpb24sIGF1dGhNb2R1bGFyLCBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8pO1xyXG4gICAgc3dpdGNoIChvcGVyYXRpb24pIHtcclxuICAgICAgICBjYXNlIFwiRU1BSUxfU0lHTklOXCIgLyogRU1BSUxfU0lHTklOICovOlxyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIFwiVkVSSUZZX0FORF9DSEFOR0VfRU1BSUxcIiAvKiBWRVJJRllfQU5EX0NIQU5HRV9FTUFJTCAqLzpcclxuICAgICAgICAgICAgX2Fzc2VydChyZXNwb25zZS5uZXdFbWFpbCwgYXV0aE1vZHVsYXIsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgXCJSRVZFUlRfU0VDT05EX0ZBQ1RPUl9BRERJVElPTlwiIC8qIFJFVkVSVF9TRUNPTkRfRkFDVE9SX0FERElUSU9OICovOlxyXG4gICAgICAgICAgICBfYXNzZXJ0KHJlc3BvbnNlLm1mYUluZm8sIGF1dGhNb2R1bGFyLCBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8pO1xyXG4gICAgICAgIC8vIGZhbGwgdGhyb3VnaFxyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIF9hc3NlcnQocmVzcG9uc2UuZW1haWwsIGF1dGhNb2R1bGFyLCBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8pO1xyXG4gICAgfVxyXG4gICAgLy8gVGhlIG11bHRpLWZhY3RvciBpbmZvIGZvciByZXZlcnQgc2Vjb25kIGZhY3RvciBhZGRpdGlvblxyXG4gICAgbGV0IG11bHRpRmFjdG9ySW5mbyA9IG51bGw7XHJcbiAgICBpZiAocmVzcG9uc2UubWZhSW5mbykge1xyXG4gICAgICAgIG11bHRpRmFjdG9ySW5mbyA9IE11bHRpRmFjdG9ySW5mb0ltcGwuX2Zyb21TZXJ2ZXJSZXNwb25zZShfY2FzdEF1dGgoYXV0aE1vZHVsYXIpLCByZXNwb25zZS5tZmFJbmZvKTtcclxuICAgIH1cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICBlbWFpbDogKHJlc3BvbnNlLnJlcXVlc3RUeXBlID09PSBcIlZFUklGWV9BTkRfQ0hBTkdFX0VNQUlMXCIgLyogVkVSSUZZX0FORF9DSEFOR0VfRU1BSUwgKi9cclxuICAgICAgICAgICAgICAgID8gcmVzcG9uc2UubmV3RW1haWxcclxuICAgICAgICAgICAgICAgIDogcmVzcG9uc2UuZW1haWwpIHx8IG51bGwsXHJcbiAgICAgICAgICAgIHByZXZpb3VzRW1haWw6IChyZXNwb25zZS5yZXF1ZXN0VHlwZSA9PT0gXCJWRVJJRllfQU5EX0NIQU5HRV9FTUFJTFwiIC8qIFZFUklGWV9BTkRfQ0hBTkdFX0VNQUlMICovXHJcbiAgICAgICAgICAgICAgICA/IHJlc3BvbnNlLmVtYWlsXHJcbiAgICAgICAgICAgICAgICA6IHJlc3BvbnNlLm5ld0VtYWlsKSB8fCBudWxsLFxyXG4gICAgICAgICAgICBtdWx0aUZhY3RvckluZm9cclxuICAgICAgICB9LFxyXG4gICAgICAgIG9wZXJhdGlvblxyXG4gICAgfTtcclxufVxyXG4vKipcclxuICogQ2hlY2tzIGEgcGFzc3dvcmQgcmVzZXQgY29kZSBzZW50IHRvIHRoZSB1c2VyIGJ5IGVtYWlsIG9yIG90aGVyIG91dC1vZi1iYW5kIG1lY2hhbmlzbS5cclxuICpcclxuICogQHJldHVybnMgdGhlIHVzZXIncyBlbWFpbCBhZGRyZXNzIGlmIHZhbGlkLlxyXG4gKlxyXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXHJcbiAqIEBwYXJhbSBjb2RlIC0gQSB2ZXJpZmljYXRpb24gY29kZSBzZW50IHRvIHRoZSB1c2VyLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiB2ZXJpZnlQYXNzd29yZFJlc2V0Q29kZShhdXRoLCBjb2RlKSB7XHJcbiAgICBjb25zdCB7IGRhdGEgfSA9IGF3YWl0IGNoZWNrQWN0aW9uQ29kZShnZXRNb2R1bGFySW5zdGFuY2UoYXV0aCksIGNvZGUpO1xyXG4gICAgLy8gRW1haWwgc2hvdWxkIGFsd2F5cyBiZSBwcmVzZW50IHNpbmNlIGEgY29kZSB3YXMgc2VudCB0byBpdFxyXG4gICAgcmV0dXJuIGRhdGEuZW1haWw7XHJcbn1cclxuLyoqXHJcbiAqIENyZWF0ZXMgYSBuZXcgdXNlciBhY2NvdW50IGFzc29jaWF0ZWQgd2l0aCB0aGUgc3BlY2lmaWVkIGVtYWlsIGFkZHJlc3MgYW5kIHBhc3N3b3JkLlxyXG4gKlxyXG4gKiBAcmVtYXJrc1xyXG4gKiBPbiBzdWNjZXNzZnVsIGNyZWF0aW9uIG9mIHRoZSB1c2VyIGFjY291bnQsIHRoaXMgdXNlciB3aWxsIGFsc28gYmUgc2lnbmVkIGluIHRvIHlvdXIgYXBwbGljYXRpb24uXHJcbiAqXHJcbiAqIFVzZXIgYWNjb3VudCBjcmVhdGlvbiBjYW4gZmFpbCBpZiB0aGUgYWNjb3VudCBhbHJlYWR5IGV4aXN0cyBvciB0aGUgcGFzc3dvcmQgaXMgaW52YWxpZC5cclxuICpcclxuICogTm90ZTogVGhlIGVtYWlsIGFkZHJlc3MgYWN0cyBhcyBhIHVuaXF1ZSBpZGVudGlmaWVyIGZvciB0aGUgdXNlciBhbmQgZW5hYmxlcyBhbiBlbWFpbC1iYXNlZFxyXG4gKiBwYXNzd29yZCByZXNldC4gVGhpcyBmdW5jdGlvbiB3aWxsIGNyZWF0ZSBhIG5ldyB1c2VyIGFjY291bnQgYW5kIHNldCB0aGUgaW5pdGlhbCB1c2VyIHBhc3N3b3JkLlxyXG4gKlxyXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXHJcbiAqIEBwYXJhbSBlbWFpbCAtIFRoZSB1c2VyJ3MgZW1haWwgYWRkcmVzcy5cclxuICogQHBhcmFtIHBhc3N3b3JkIC0gVGhlIHVzZXIncyBjaG9zZW4gcGFzc3dvcmQuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVVzZXJXaXRoRW1haWxBbmRQYXNzd29yZChhdXRoLCBlbWFpbCwgcGFzc3dvcmQpIHtcclxuICAgIGNvbnN0IGF1dGhJbnRlcm5hbCA9IF9jYXN0QXV0aChhdXRoKTtcclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgc2lnblVwKGF1dGhJbnRlcm5hbCwge1xyXG4gICAgICAgIHJldHVyblNlY3VyZVRva2VuOiB0cnVlLFxyXG4gICAgICAgIGVtYWlsLFxyXG4gICAgICAgIHBhc3N3b3JkXHJcbiAgICB9KTtcclxuICAgIGNvbnN0IHVzZXJDcmVkZW50aWFsID0gYXdhaXQgVXNlckNyZWRlbnRpYWxJbXBsLl9mcm9tSWRUb2tlblJlc3BvbnNlKGF1dGhJbnRlcm5hbCwgXCJzaWduSW5cIiAvKiBTSUdOX0lOICovLCByZXNwb25zZSk7XHJcbiAgICBhd2FpdCBhdXRoSW50ZXJuYWwuX3VwZGF0ZUN1cnJlbnRVc2VyKHVzZXJDcmVkZW50aWFsLnVzZXIpO1xyXG4gICAgcmV0dXJuIHVzZXJDcmVkZW50aWFsO1xyXG59XHJcbi8qKlxyXG4gKiBBc3luY2hyb25vdXNseSBzaWducyBpbiB1c2luZyBhbiBlbWFpbCBhbmQgcGFzc3dvcmQuXHJcbiAqXHJcbiAqIEByZW1hcmtzXHJcbiAqIEZhaWxzIHdpdGggYW4gZXJyb3IgaWYgdGhlIGVtYWlsIGFkZHJlc3MgYW5kIHBhc3N3b3JkIGRvIG5vdCBtYXRjaC5cclxuICpcclxuICogTm90ZTogVGhlIHVzZXIncyBwYXNzd29yZCBpcyBOT1QgdGhlIHBhc3N3b3JkIHVzZWQgdG8gYWNjZXNzIHRoZSB1c2VyJ3MgZW1haWwgYWNjb3VudC4gVGhlXHJcbiAqIGVtYWlsIGFkZHJlc3Mgc2VydmVzIGFzIGEgdW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoZSB1c2VyLCBhbmQgdGhlIHBhc3N3b3JkIGlzIHVzZWQgdG8gYWNjZXNzXHJcbiAqIHRoZSB1c2VyJ3MgYWNjb3VudCBpbiB5b3VyIEZpcmViYXNlIHByb2plY3QuIFNlZSBhbHNvOiB7QGxpbmsgY3JlYXRlVXNlcldpdGhFbWFpbEFuZFBhc3N3b3JkfS5cclxuICpcclxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxyXG4gKiBAcGFyYW0gZW1haWwgLSBUaGUgdXNlcnMgZW1haWwgYWRkcmVzcy5cclxuICogQHBhcmFtIHBhc3N3b3JkIC0gVGhlIHVzZXJzIHBhc3N3b3JkLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5mdW5jdGlvbiBzaWduSW5XaXRoRW1haWxBbmRQYXNzd29yZChhdXRoLCBlbWFpbCwgcGFzc3dvcmQpIHtcclxuICAgIHJldHVybiBzaWduSW5XaXRoQ3JlZGVudGlhbChnZXRNb2R1bGFySW5zdGFuY2UoYXV0aCksIEVtYWlsQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWwoZW1haWwsIHBhc3N3b3JkKSk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFNlbmRzIGEgc2lnbi1pbiBlbWFpbCBsaW5rIHRvIHRoZSB1c2VyIHdpdGggdGhlIHNwZWNpZmllZCBlbWFpbC5cclxuICpcclxuICogQHJlbWFya3NcclxuICogVGhlIHNpZ24taW4gb3BlcmF0aW9uIGhhcyB0byBhbHdheXMgYmUgY29tcGxldGVkIGluIHRoZSBhcHAgdW5saWtlIG90aGVyIG91dCBvZiBiYW5kIGVtYWlsXHJcbiAqIGFjdGlvbnMgKHBhc3N3b3JkIHJlc2V0IGFuZCBlbWFpbCB2ZXJpZmljYXRpb25zKS4gVGhpcyBpcyBiZWNhdXNlLCBhdCB0aGUgZW5kIG9mIHRoZSBmbG93LFxyXG4gKiB0aGUgdXNlciBpcyBleHBlY3RlZCB0byBiZSBzaWduZWQgaW4gYW5kIHRoZWlyIEF1dGggc3RhdGUgcGVyc2lzdGVkIHdpdGhpbiB0aGUgYXBwLlxyXG4gKlxyXG4gKiBUbyBjb21wbGV0ZSBzaWduIGluIHdpdGggdGhlIGVtYWlsIGxpbmssIGNhbGwge0BsaW5rIHNpZ25JbldpdGhFbWFpbExpbmt9IHdpdGggdGhlIGVtYWlsXHJcbiAqIGFkZHJlc3MgYW5kIHRoZSBlbWFpbCBsaW5rIHN1cHBsaWVkIGluIHRoZSBlbWFpbCBzZW50IHRvIHRoZSB1c2VyLlxyXG4gKlxyXG4gKiBAZXhhbXBsZVxyXG4gKiBgYGBqYXZhc2NyaXB0XHJcbiAqIGNvbnN0IGFjdGlvbkNvZGVTZXR0aW5ncyA9IHtcclxuICogICB1cmw6ICdodHRwczovL3d3dy5leGFtcGxlLmNvbS8/ZW1haWw9dXNlckBleGFtcGxlLmNvbScsXHJcbiAqICAgaU9TOiB7XHJcbiAqICAgICAgYnVuZGxlSWQ6ICdjb20uZXhhbXBsZS5pb3MnXHJcbiAqICAgfSxcclxuICogICBhbmRyb2lkOiB7XHJcbiAqICAgICBwYWNrYWdlTmFtZTogJ2NvbS5leGFtcGxlLmFuZHJvaWQnLFxyXG4gKiAgICAgaW5zdGFsbEFwcDogdHJ1ZSxcclxuICogICAgIG1pbmltdW1WZXJzaW9uOiAnMTInXHJcbiAqICAgfSxcclxuICogICBoYW5kbGVDb2RlSW5BcHA6IHRydWVcclxuICogfTtcclxuICogYXdhaXQgc2VuZFNpZ25JbkxpbmtUb0VtYWlsKGF1dGgsICd1c2VyQGV4YW1wbGUuY29tJywgYWN0aW9uQ29kZVNldHRpbmdzKTtcclxuICogLy8gT2J0YWluIGVtYWlsTGluayBmcm9tIHRoZSB1c2VyLlxyXG4gKiBpZihpc1NpZ25JbldpdGhFbWFpbExpbmsoYXV0aCwgZW1haWxMaW5rKSkge1xyXG4gKiAgIGF3YWl0IHNpZ25JbldpdGhFbWFpbExpbmsoJ3VzZXJAZXhhbXBsZS5jb20nLCAndXNlckBleGFtcGxlLmNvbScsIGVtYWlsTGluayk7XHJcbiAqIH1cclxuICogYGBgXHJcbiAqXHJcbiAqIEBwYXJhbSBhdXRoSW50ZXJuYWwgLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxyXG4gKiBAcGFyYW0gZW1haWwgLSBUaGUgdXNlcidzIGVtYWlsIGFkZHJlc3MuXHJcbiAqIEBwYXJhbSBhY3Rpb25Db2RlU2V0dGluZ3MgLSBUaGUge0BsaW5rIEFjdGlvbkNvZGVTZXR0aW5nc30uXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIHNlbmRTaWduSW5MaW5rVG9FbWFpbChhdXRoLCBlbWFpbCwgYWN0aW9uQ29kZVNldHRpbmdzKSB7XHJcbiAgICBjb25zdCBhdXRoTW9kdWxhciA9IGdldE1vZHVsYXJJbnN0YW5jZShhdXRoKTtcclxuICAgIGNvbnN0IHJlcXVlc3QgPSB7XHJcbiAgICAgICAgcmVxdWVzdFR5cGU6IFwiRU1BSUxfU0lHTklOXCIgLyogRU1BSUxfU0lHTklOICovLFxyXG4gICAgICAgIGVtYWlsXHJcbiAgICB9O1xyXG4gICAgX2Fzc2VydChhY3Rpb25Db2RlU2V0dGluZ3MuaGFuZGxlQ29kZUluQXBwLCBhdXRoTW9kdWxhciwgXCJhcmd1bWVudC1lcnJvclwiIC8qIEFSR1VNRU5UX0VSUk9SICovKTtcclxuICAgIGlmIChhY3Rpb25Db2RlU2V0dGluZ3MpIHtcclxuICAgICAgICBfc2V0QWN0aW9uQ29kZVNldHRpbmdzT25SZXF1ZXN0KGF1dGhNb2R1bGFyLCByZXF1ZXN0LCBhY3Rpb25Db2RlU2V0dGluZ3MpO1xyXG4gICAgfVxyXG4gICAgYXdhaXQgc2VuZFNpZ25JbkxpbmtUb0VtYWlsJDEoYXV0aE1vZHVsYXIsIHJlcXVlc3QpO1xyXG59XHJcbi8qKlxyXG4gKiBDaGVja3MgaWYgYW4gaW5jb21pbmcgbGluayBpcyBhIHNpZ24taW4gd2l0aCBlbWFpbCBsaW5rIHN1aXRhYmxlIGZvciB7QGxpbmsgc2lnbkluV2l0aEVtYWlsTGlua30uXHJcbiAqXHJcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cclxuICogQHBhcmFtIGVtYWlsTGluayAtIFRoZSBsaW5rIHNlbnQgdG8gdGhlIHVzZXIncyBlbWFpbCBhZGRyZXNzLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5mdW5jdGlvbiBpc1NpZ25JbldpdGhFbWFpbExpbmsoYXV0aCwgZW1haWxMaW5rKSB7XHJcbiAgICBjb25zdCBhY3Rpb25Db2RlVXJsID0gQWN0aW9uQ29kZVVSTC5wYXJzZUxpbmsoZW1haWxMaW5rKTtcclxuICAgIHJldHVybiAoYWN0aW9uQ29kZVVybCA9PT0gbnVsbCB8fCBhY3Rpb25Db2RlVXJsID09PSB2b2lkIDAgPyB2b2lkIDAgOiBhY3Rpb25Db2RlVXJsLm9wZXJhdGlvbikgPT09IFwiRU1BSUxfU0lHTklOXCIgLyogRU1BSUxfU0lHTklOICovO1xyXG59XHJcbi8qKlxyXG4gKiBBc3luY2hyb25vdXNseSBzaWducyBpbiB1c2luZyBhbiBlbWFpbCBhbmQgc2lnbi1pbiBlbWFpbCBsaW5rLlxyXG4gKlxyXG4gKiBAcmVtYXJrc1xyXG4gKiBJZiBubyBsaW5rIGlzIHBhc3NlZCwgdGhlIGxpbmsgaXMgaW5mZXJyZWQgZnJvbSB0aGUgY3VycmVudCBVUkwuXHJcbiAqXHJcbiAqIEZhaWxzIHdpdGggYW4gZXJyb3IgaWYgdGhlIGVtYWlsIGFkZHJlc3MgaXMgaW52YWxpZCBvciBPVFAgaW4gZW1haWwgbGluayBleHBpcmVzLlxyXG4gKlxyXG4gKiBOb3RlOiBDb25maXJtIHRoZSBsaW5rIGlzIGEgc2lnbi1pbiBlbWFpbCBsaW5rIGJlZm9yZSBjYWxsaW5nIHRoaXMgbWV0aG9kIGZpcmViYXNlLmF1dGguQXV0aC5pc1NpZ25JbldpdGhFbWFpbExpbmsuXHJcbiAqXHJcbiAqIEBleGFtcGxlXHJcbiAqIGBgYGphdmFzY3JpcHRcclxuICogY29uc3QgYWN0aW9uQ29kZVNldHRpbmdzID0ge1xyXG4gKiAgIHVybDogJ2h0dHBzOi8vd3d3LmV4YW1wbGUuY29tLz9lbWFpbD11c2VyQGV4YW1wbGUuY29tJyxcclxuICogICBpT1M6IHtcclxuICogICAgICBidW5kbGVJZDogJ2NvbS5leGFtcGxlLmlvcydcclxuICogICB9LFxyXG4gKiAgIGFuZHJvaWQ6IHtcclxuICogICAgIHBhY2thZ2VOYW1lOiAnY29tLmV4YW1wbGUuYW5kcm9pZCcsXHJcbiAqICAgICBpbnN0YWxsQXBwOiB0cnVlLFxyXG4gKiAgICAgbWluaW11bVZlcnNpb246ICcxMidcclxuICogICB9LFxyXG4gKiAgIGhhbmRsZUNvZGVJbkFwcDogdHJ1ZVxyXG4gKiB9O1xyXG4gKiBhd2FpdCBzZW5kU2lnbkluTGlua1RvRW1haWwoYXV0aCwgJ3VzZXJAZXhhbXBsZS5jb20nLCBhY3Rpb25Db2RlU2V0dGluZ3MpO1xyXG4gKiAvLyBPYnRhaW4gZW1haWxMaW5rIGZyb20gdGhlIHVzZXIuXHJcbiAqIGlmKGlzU2lnbkluV2l0aEVtYWlsTGluayhhdXRoLCBlbWFpbExpbmspKSB7XHJcbiAqICAgYXdhaXQgc2lnbkluV2l0aEVtYWlsTGluaygndXNlckBleGFtcGxlLmNvbScsICd1c2VyQGV4YW1wbGUuY29tJywgZW1haWxMaW5rKTtcclxuICogfVxyXG4gKiBgYGBcclxuICpcclxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxyXG4gKiBAcGFyYW0gZW1haWwgLSBUaGUgdXNlcidzIGVtYWlsIGFkZHJlc3MuXHJcbiAqIEBwYXJhbSBlbWFpbExpbmsgLSBUaGUgbGluayBzZW50IHRvIHRoZSB1c2VyJ3MgZW1haWwgYWRkcmVzcy5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gc2lnbkluV2l0aEVtYWlsTGluayhhdXRoLCBlbWFpbCwgZW1haWxMaW5rKSB7XHJcbiAgICBjb25zdCBhdXRoTW9kdWxhciA9IGdldE1vZHVsYXJJbnN0YW5jZShhdXRoKTtcclxuICAgIGNvbnN0IGNyZWRlbnRpYWwgPSBFbWFpbEF1dGhQcm92aWRlci5jcmVkZW50aWFsV2l0aExpbmsoZW1haWwsIGVtYWlsTGluayB8fCBfZ2V0Q3VycmVudFVybCgpKTtcclxuICAgIC8vIENoZWNrIGlmIHRoZSB0ZW5hbnQgSUQgaW4gdGhlIGVtYWlsIGxpbmsgbWF0Y2hlcyB0aGUgdGVuYW50IElEIG9uIEF1dGhcclxuICAgIC8vIGluc3RhbmNlLlxyXG4gICAgX2Fzc2VydChjcmVkZW50aWFsLl90ZW5hbnRJZCA9PT0gKGF1dGhNb2R1bGFyLnRlbmFudElkIHx8IG51bGwpLCBhdXRoTW9kdWxhciwgXCJ0ZW5hbnQtaWQtbWlzbWF0Y2hcIiAvKiBURU5BTlRfSURfTUlTTUFUQ0ggKi8pO1xyXG4gICAgcmV0dXJuIHNpZ25JbldpdGhDcmVkZW50aWFsKGF1dGhNb2R1bGFyLCBjcmVkZW50aWFsKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBjcmVhdGVBdXRoVXJpKGF1dGgsIHJlcXVlc3QpIHtcclxuICAgIHJldHVybiBfcGVyZm9ybUFwaVJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogUE9TVCAqLywgXCIvdjEvYWNjb3VudHM6Y3JlYXRlQXV0aFVyaVwiIC8qIENSRUFURV9BVVRIX1VSSSAqLywgX2FkZFRpZElmTmVjZXNzYXJ5KGF1dGgsIHJlcXVlc3QpKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogR2V0cyB0aGUgbGlzdCBvZiBwb3NzaWJsZSBzaWduIGluIG1ldGhvZHMgZm9yIHRoZSBnaXZlbiBlbWFpbCBhZGRyZXNzLlxyXG4gKlxyXG4gKiBAcmVtYXJrc1xyXG4gKiBUaGlzIGlzIHVzZWZ1bCB0byBkaWZmZXJlbnRpYXRlIG1ldGhvZHMgb2Ygc2lnbi1pbiBmb3IgdGhlIHNhbWUgcHJvdmlkZXIsIGVnLlxyXG4gKiB7QGxpbmsgRW1haWxBdXRoUHJvdmlkZXJ9IHdoaWNoIGhhcyAyIG1ldGhvZHMgb2Ygc2lnbi1pbixcclxuICoge0BsaW5rIFNpZ25Jbk1ldGhvZH0uRU1BSUxfUEFTU1dPUkQgYW5kXHJcbiAqIHtAbGluayBTaWduSW5NZXRob2R9LkVNQUlMX0xJTksuXHJcbiAqXHJcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cclxuICogQHBhcmFtIGVtYWlsIC0gVGhlIHVzZXIncyBlbWFpbCBhZGRyZXNzLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBmZXRjaFNpZ25Jbk1ldGhvZHNGb3JFbWFpbChhdXRoLCBlbWFpbCkge1xyXG4gICAgLy8gY3JlYXRlQXV0aFVyaSByZXR1cm5zIGFuIGVycm9yIGlmIGNvbnRpbnVlIFVSSSBpcyBub3QgaHR0cCBvciBodHRwcy5cclxuICAgIC8vIEZvciBlbnZpcm9ubWVudHMgbGlrZSBDb3Jkb3ZhLCBDaHJvbWUgZXh0ZW5zaW9ucywgbmF0aXZlIGZyYW1ld29ya3MsIGZpbGVcclxuICAgIC8vIHN5c3RlbXMsIGV0YywgdXNlIGh0dHA6Ly9sb2NhbGhvc3QgYXMgY29udGludWUgVVJMLlxyXG4gICAgY29uc3QgY29udGludWVVcmkgPSBfaXNIdHRwT3JIdHRwcygpID8gX2dldEN1cnJlbnRVcmwoKSA6ICdodHRwOi8vbG9jYWxob3N0JztcclxuICAgIGNvbnN0IHJlcXVlc3QgPSB7XHJcbiAgICAgICAgaWRlbnRpZmllcjogZW1haWwsXHJcbiAgICAgICAgY29udGludWVVcmlcclxuICAgIH07XHJcbiAgICBjb25zdCB7IHNpZ25pbk1ldGhvZHMgfSA9IGF3YWl0IGNyZWF0ZUF1dGhVcmkoZ2V0TW9kdWxhckluc3RhbmNlKGF1dGgpLCByZXF1ZXN0KTtcclxuICAgIHJldHVybiBzaWduaW5NZXRob2RzIHx8IFtdO1xyXG59XHJcbi8qKlxyXG4gKiBTZW5kcyBhIHZlcmlmaWNhdGlvbiBlbWFpbCB0byBhIHVzZXIuXHJcbiAqXHJcbiAqIEByZW1hcmtzXHJcbiAqIFRoZSB2ZXJpZmljYXRpb24gcHJvY2VzcyBpcyBjb21wbGV0ZWQgYnkgY2FsbGluZyB7QGxpbmsgYXBwbHlBY3Rpb25Db2RlfS5cclxuICpcclxuICogQGV4YW1wbGVcclxuICogYGBgamF2YXNjcmlwdFxyXG4gKiBjb25zdCBhY3Rpb25Db2RlU2V0dGluZ3MgPSB7XHJcbiAqICAgdXJsOiAnaHR0cHM6Ly93d3cuZXhhbXBsZS5jb20vP2VtYWlsPXVzZXJAZXhhbXBsZS5jb20nLFxyXG4gKiAgIGlPUzoge1xyXG4gKiAgICAgIGJ1bmRsZUlkOiAnY29tLmV4YW1wbGUuaW9zJ1xyXG4gKiAgIH0sXHJcbiAqICAgYW5kcm9pZDoge1xyXG4gKiAgICAgcGFja2FnZU5hbWU6ICdjb20uZXhhbXBsZS5hbmRyb2lkJyxcclxuICogICAgIGluc3RhbGxBcHA6IHRydWUsXHJcbiAqICAgICBtaW5pbXVtVmVyc2lvbjogJzEyJ1xyXG4gKiAgIH0sXHJcbiAqICAgaGFuZGxlQ29kZUluQXBwOiB0cnVlXHJcbiAqIH07XHJcbiAqIGF3YWl0IHNlbmRFbWFpbFZlcmlmaWNhdGlvbih1c2VyLCBhY3Rpb25Db2RlU2V0dGluZ3MpO1xyXG4gKiAvLyBPYnRhaW4gY29kZSBmcm9tIHRoZSB1c2VyLlxyXG4gKiBhd2FpdCBhcHBseUFjdGlvbkNvZGUoYXV0aCwgY29kZSk7XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBAcGFyYW0gdXNlciAtIFRoZSB1c2VyLlxyXG4gKiBAcGFyYW0gYWN0aW9uQ29kZVNldHRpbmdzIC0gVGhlIHtAbGluayBBY3Rpb25Db2RlU2V0dGluZ3N9LlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBzZW5kRW1haWxWZXJpZmljYXRpb24odXNlciwgYWN0aW9uQ29kZVNldHRpbmdzKSB7XHJcbiAgICBjb25zdCB1c2VySW50ZXJuYWwgPSBnZXRNb2R1bGFySW5zdGFuY2UodXNlcik7XHJcbiAgICBjb25zdCBpZFRva2VuID0gYXdhaXQgdXNlci5nZXRJZFRva2VuKCk7XHJcbiAgICBjb25zdCByZXF1ZXN0ID0ge1xyXG4gICAgICAgIHJlcXVlc3RUeXBlOiBcIlZFUklGWV9FTUFJTFwiIC8qIFZFUklGWV9FTUFJTCAqLyxcclxuICAgICAgICBpZFRva2VuXHJcbiAgICB9O1xyXG4gICAgaWYgKGFjdGlvbkNvZGVTZXR0aW5ncykge1xyXG4gICAgICAgIF9zZXRBY3Rpb25Db2RlU2V0dGluZ3NPblJlcXVlc3QodXNlckludGVybmFsLmF1dGgsIHJlcXVlc3QsIGFjdGlvbkNvZGVTZXR0aW5ncyk7XHJcbiAgICB9XHJcbiAgICBjb25zdCB7IGVtYWlsIH0gPSBhd2FpdCBzZW5kRW1haWxWZXJpZmljYXRpb24kMSh1c2VySW50ZXJuYWwuYXV0aCwgcmVxdWVzdCk7XHJcbiAgICBpZiAoZW1haWwgIT09IHVzZXIuZW1haWwpIHtcclxuICAgICAgICBhd2FpdCB1c2VyLnJlbG9hZCgpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBTZW5kcyBhIHZlcmlmaWNhdGlvbiBlbWFpbCB0byBhIG5ldyBlbWFpbCBhZGRyZXNzLlxyXG4gKlxyXG4gKiBAcmVtYXJrc1xyXG4gKiBUaGUgdXNlcidzIGVtYWlsIHdpbGwgYmUgdXBkYXRlZCB0byB0aGUgbmV3IG9uZSBhZnRlciBiZWluZyB2ZXJpZmllZC5cclxuICpcclxuICogSWYgeW91IGhhdmUgYSBjdXN0b20gZW1haWwgYWN0aW9uIGhhbmRsZXIsIHlvdSBjYW4gY29tcGxldGUgdGhlIHZlcmlmaWNhdGlvbiBwcm9jZXNzIGJ5IGNhbGxpbmdcclxuICoge0BsaW5rIGFwcGx5QWN0aW9uQ29kZX0uXHJcbiAqXHJcbiAqIEBleGFtcGxlXHJcbiAqIGBgYGphdmFzY3JpcHRcclxuICogY29uc3QgYWN0aW9uQ29kZVNldHRpbmdzID0ge1xyXG4gKiAgIHVybDogJ2h0dHBzOi8vd3d3LmV4YW1wbGUuY29tLz9lbWFpbD11c2VyQGV4YW1wbGUuY29tJyxcclxuICogICBpT1M6IHtcclxuICogICAgICBidW5kbGVJZDogJ2NvbS5leGFtcGxlLmlvcydcclxuICogICB9LFxyXG4gKiAgIGFuZHJvaWQ6IHtcclxuICogICAgIHBhY2thZ2VOYW1lOiAnY29tLmV4YW1wbGUuYW5kcm9pZCcsXHJcbiAqICAgICBpbnN0YWxsQXBwOiB0cnVlLFxyXG4gKiAgICAgbWluaW11bVZlcnNpb246ICcxMidcclxuICogICB9LFxyXG4gKiAgIGhhbmRsZUNvZGVJbkFwcDogdHJ1ZVxyXG4gKiB9O1xyXG4gKiBhd2FpdCB2ZXJpZnlCZWZvcmVVcGRhdGVFbWFpbCh1c2VyLCAnbmV3ZW1haWxAZXhhbXBsZS5jb20nLCBhY3Rpb25Db2RlU2V0dGluZ3MpO1xyXG4gKiAvLyBPYnRhaW4gY29kZSBmcm9tIHRoZSB1c2VyLlxyXG4gKiBhd2FpdCBhcHBseUFjdGlvbkNvZGUoYXV0aCwgY29kZSk7XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBAcGFyYW0gdXNlciAtIFRoZSB1c2VyLlxyXG4gKiBAcGFyYW0gbmV3RW1haWwgLSBUaGUgbmV3IGVtYWlsIGFkZHJlc3MgdG8gYmUgdmVyaWZpZWQgYmVmb3JlIHVwZGF0ZS5cclxuICogQHBhcmFtIGFjdGlvbkNvZGVTZXR0aW5ncyAtIFRoZSB7QGxpbmsgQWN0aW9uQ29kZVNldHRpbmdzfS5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gdmVyaWZ5QmVmb3JlVXBkYXRlRW1haWwodXNlciwgbmV3RW1haWwsIGFjdGlvbkNvZGVTZXR0aW5ncykge1xyXG4gICAgY29uc3QgdXNlckludGVybmFsID0gZ2V0TW9kdWxhckluc3RhbmNlKHVzZXIpO1xyXG4gICAgY29uc3QgaWRUb2tlbiA9IGF3YWl0IHVzZXIuZ2V0SWRUb2tlbigpO1xyXG4gICAgY29uc3QgcmVxdWVzdCA9IHtcclxuICAgICAgICByZXF1ZXN0VHlwZTogXCJWRVJJRllfQU5EX0NIQU5HRV9FTUFJTFwiIC8qIFZFUklGWV9BTkRfQ0hBTkdFX0VNQUlMICovLFxyXG4gICAgICAgIGlkVG9rZW4sXHJcbiAgICAgICAgbmV3RW1haWxcclxuICAgIH07XHJcbiAgICBpZiAoYWN0aW9uQ29kZVNldHRpbmdzKSB7XHJcbiAgICAgICAgX3NldEFjdGlvbkNvZGVTZXR0aW5nc09uUmVxdWVzdCh1c2VySW50ZXJuYWwuYXV0aCwgcmVxdWVzdCwgYWN0aW9uQ29kZVNldHRpbmdzKTtcclxuICAgIH1cclxuICAgIGNvbnN0IHsgZW1haWwgfSA9IGF3YWl0IHZlcmlmeUFuZENoYW5nZUVtYWlsKHVzZXJJbnRlcm5hbC5hdXRoLCByZXF1ZXN0KTtcclxuICAgIGlmIChlbWFpbCAhPT0gdXNlci5lbWFpbCkge1xyXG4gICAgICAgIC8vIElmIHRoZSBsb2NhbCBjb3B5IG9mIHRoZSBlbWFpbCBvbiB1c2VyIGlzIG91dGRhdGVkLCByZWxvYWQgdGhlXHJcbiAgICAgICAgLy8gdXNlci5cclxuICAgICAgICBhd2FpdCB1c2VyLnJlbG9hZCgpO1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVByb2ZpbGUkMShhdXRoLCByZXF1ZXN0KSB7XHJcbiAgICByZXR1cm4gX3BlcmZvcm1BcGlSZXF1ZXN0KGF1dGgsIFwiUE9TVFwiIC8qIFBPU1QgKi8sIFwiL3YxL2FjY291bnRzOnVwZGF0ZVwiIC8qIFNFVF9BQ0NPVU5UX0lORk8gKi8sIHJlcXVlc3QpO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBVcGRhdGVzIGEgdXNlcidzIHByb2ZpbGUgZGF0YS5cclxuICpcclxuICogQHBhcmFtIHVzZXIgLSBUaGUgdXNlci5cclxuICogQHBhcmFtIHByb2ZpbGUgLSBUaGUgcHJvZmlsZSdzIGBkaXNwbGF5TmFtZWAgYW5kIGBwaG90b1VSTGAgdG8gdXBkYXRlLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiB1cGRhdGVQcm9maWxlKHVzZXIsIHsgZGlzcGxheU5hbWUsIHBob3RvVVJMOiBwaG90b1VybCB9KSB7XHJcbiAgICBpZiAoZGlzcGxheU5hbWUgPT09IHVuZGVmaW5lZCAmJiBwaG90b1VybCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29uc3QgdXNlckludGVybmFsID0gZ2V0TW9kdWxhckluc3RhbmNlKHVzZXIpO1xyXG4gICAgY29uc3QgaWRUb2tlbiA9IGF3YWl0IHVzZXJJbnRlcm5hbC5nZXRJZFRva2VuKCk7XHJcbiAgICBjb25zdCBwcm9maWxlUmVxdWVzdCA9IHtcclxuICAgICAgICBpZFRva2VuLFxyXG4gICAgICAgIGRpc3BsYXlOYW1lLFxyXG4gICAgICAgIHBob3RvVXJsLFxyXG4gICAgICAgIHJldHVyblNlY3VyZVRva2VuOiB0cnVlXHJcbiAgICB9O1xyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBfbG9nb3V0SWZJbnZhbGlkYXRlZCh1c2VySW50ZXJuYWwsIHVwZGF0ZVByb2ZpbGUkMSh1c2VySW50ZXJuYWwuYXV0aCwgcHJvZmlsZVJlcXVlc3QpKTtcclxuICAgIHVzZXJJbnRlcm5hbC5kaXNwbGF5TmFtZSA9IHJlc3BvbnNlLmRpc3BsYXlOYW1lIHx8IG51bGw7XHJcbiAgICB1c2VySW50ZXJuYWwucGhvdG9VUkwgPSByZXNwb25zZS5waG90b1VybCB8fCBudWxsO1xyXG4gICAgLy8gVXBkYXRlIHRoZSBwYXNzd29yZCBwcm92aWRlciBhcyB3ZWxsXHJcbiAgICBjb25zdCBwYXNzd29yZFByb3ZpZGVyID0gdXNlckludGVybmFsLnByb3ZpZGVyRGF0YS5maW5kKCh7IHByb3ZpZGVySWQgfSkgPT4gcHJvdmlkZXJJZCA9PT0gXCJwYXNzd29yZFwiIC8qIFBBU1NXT1JEICovKTtcclxuICAgIGlmIChwYXNzd29yZFByb3ZpZGVyKSB7XHJcbiAgICAgICAgcGFzc3dvcmRQcm92aWRlci5kaXNwbGF5TmFtZSA9IHVzZXJJbnRlcm5hbC5kaXNwbGF5TmFtZTtcclxuICAgICAgICBwYXNzd29yZFByb3ZpZGVyLnBob3RvVVJMID0gdXNlckludGVybmFsLnBob3RvVVJMO1xyXG4gICAgfVxyXG4gICAgYXdhaXQgdXNlckludGVybmFsLl91cGRhdGVUb2tlbnNJZk5lY2Vzc2FyeShyZXNwb25zZSk7XHJcbn1cclxuLyoqXHJcbiAqIFVwZGF0ZXMgdGhlIHVzZXIncyBlbWFpbCBhZGRyZXNzLlxyXG4gKlxyXG4gKiBAcmVtYXJrc1xyXG4gKiBBbiBlbWFpbCB3aWxsIGJlIHNlbnQgdG8gdGhlIG9yaWdpbmFsIGVtYWlsIGFkZHJlc3MgKGlmIGl0IHdhcyBzZXQpIHRoYXQgYWxsb3dzIHRvIHJldm9rZSB0aGVcclxuICogZW1haWwgYWRkcmVzcyBjaGFuZ2UsIGluIG9yZGVyIHRvIHByb3RlY3QgdGhlbSBmcm9tIGFjY291bnQgaGlqYWNraW5nLlxyXG4gKlxyXG4gKiBJbXBvcnRhbnQ6IHRoaXMgaXMgYSBzZWN1cml0eSBzZW5zaXRpdmUgb3BlcmF0aW9uIHRoYXQgcmVxdWlyZXMgdGhlIHVzZXIgdG8gaGF2ZSByZWNlbnRseSBzaWduZWRcclxuICogaW4uIElmIHRoaXMgcmVxdWlyZW1lbnQgaXNuJ3QgbWV0LCBhc2sgdGhlIHVzZXIgdG8gYXV0aGVudGljYXRlIGFnYWluIGFuZCB0aGVuIGNhbGxcclxuICoge0BsaW5rIHJlYXV0aGVudGljYXRlV2l0aENyZWRlbnRpYWx9LlxyXG4gKlxyXG4gKiBAcGFyYW0gdXNlciAtIFRoZSB1c2VyLlxyXG4gKiBAcGFyYW0gbmV3RW1haWwgLSBUaGUgbmV3IGVtYWlsIGFkZHJlc3MuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmZ1bmN0aW9uIHVwZGF0ZUVtYWlsKHVzZXIsIG5ld0VtYWlsKSB7XHJcbiAgICByZXR1cm4gdXBkYXRlRW1haWxPclBhc3N3b3JkKGdldE1vZHVsYXJJbnN0YW5jZSh1c2VyKSwgbmV3RW1haWwsIG51bGwpO1xyXG59XHJcbi8qKlxyXG4gKiBVcGRhdGVzIHRoZSB1c2VyJ3MgcGFzc3dvcmQuXHJcbiAqXHJcbiAqIEByZW1hcmtzXHJcbiAqIEltcG9ydGFudDogdGhpcyBpcyBhIHNlY3VyaXR5IHNlbnNpdGl2ZSBvcGVyYXRpb24gdGhhdCByZXF1aXJlcyB0aGUgdXNlciB0byBoYXZlIHJlY2VudGx5IHNpZ25lZFxyXG4gKiBpbi4gSWYgdGhpcyByZXF1aXJlbWVudCBpc24ndCBtZXQsIGFzayB0aGUgdXNlciB0byBhdXRoZW50aWNhdGUgYWdhaW4gYW5kIHRoZW4gY2FsbFxyXG4gKiB7QGxpbmsgcmVhdXRoZW50aWNhdGVXaXRoQ3JlZGVudGlhbH0uXHJcbiAqXHJcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXHJcbiAqIEBwYXJhbSBuZXdQYXNzd29yZCAtIFRoZSBuZXcgcGFzc3dvcmQuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmZ1bmN0aW9uIHVwZGF0ZVBhc3N3b3JkKHVzZXIsIG5ld1Bhc3N3b3JkKSB7XHJcbiAgICByZXR1cm4gdXBkYXRlRW1haWxPclBhc3N3b3JkKGdldE1vZHVsYXJJbnN0YW5jZSh1c2VyKSwgbnVsbCwgbmV3UGFzc3dvcmQpO1xyXG59XHJcbmFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUVtYWlsT3JQYXNzd29yZCh1c2VyLCBlbWFpbCwgcGFzc3dvcmQpIHtcclxuICAgIGNvbnN0IHsgYXV0aCB9ID0gdXNlcjtcclxuICAgIGNvbnN0IGlkVG9rZW4gPSBhd2FpdCB1c2VyLmdldElkVG9rZW4oKTtcclxuICAgIGNvbnN0IHJlcXVlc3QgPSB7XHJcbiAgICAgICAgaWRUb2tlbixcclxuICAgICAgICByZXR1cm5TZWN1cmVUb2tlbjogdHJ1ZVxyXG4gICAgfTtcclxuICAgIGlmIChlbWFpbCkge1xyXG4gICAgICAgIHJlcXVlc3QuZW1haWwgPSBlbWFpbDtcclxuICAgIH1cclxuICAgIGlmIChwYXNzd29yZCkge1xyXG4gICAgICAgIHJlcXVlc3QucGFzc3dvcmQgPSBwYXNzd29yZDtcclxuICAgIH1cclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgX2xvZ291dElmSW52YWxpZGF0ZWQodXNlciwgdXBkYXRlRW1haWxQYXNzd29yZChhdXRoLCByZXF1ZXN0KSk7XHJcbiAgICBhd2FpdCB1c2VyLl91cGRhdGVUb2tlbnNJZk5lY2Vzc2FyeShyZXNwb25zZSwgLyogcmVsb2FkICovIHRydWUpO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBQYXJzZSB0aGUgYEFkZGl0aW9uYWxVc2VySW5mb2AgZnJvbSB0aGUgSUQgdG9rZW4gcmVzcG9uc2UuXHJcbiAqXHJcbiAqL1xyXG5mdW5jdGlvbiBfZnJvbUlkVG9rZW5SZXNwb25zZShpZFRva2VuUmVzcG9uc2UpIHtcclxuICAgIHZhciBfYSwgX2I7XHJcbiAgICBpZiAoIWlkVG9rZW5SZXNwb25zZSkge1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgY29uc3QgeyBwcm92aWRlcklkIH0gPSBpZFRva2VuUmVzcG9uc2U7XHJcbiAgICBjb25zdCBwcm9maWxlID0gaWRUb2tlblJlc3BvbnNlLnJhd1VzZXJJbmZvXHJcbiAgICAgICAgPyBKU09OLnBhcnNlKGlkVG9rZW5SZXNwb25zZS5yYXdVc2VySW5mbylcclxuICAgICAgICA6IHt9O1xyXG4gICAgY29uc3QgaXNOZXdVc2VyID0gaWRUb2tlblJlc3BvbnNlLmlzTmV3VXNlciB8fFxyXG4gICAgICAgIGlkVG9rZW5SZXNwb25zZS5raW5kID09PSBcImlkZW50aXR5dG9vbGtpdCNTaWdudXBOZXdVc2VyUmVzcG9uc2VcIiAvKiBTaWdudXBOZXdVc2VyICovO1xyXG4gICAgaWYgKCFwcm92aWRlcklkICYmIChpZFRva2VuUmVzcG9uc2UgPT09IG51bGwgfHwgaWRUb2tlblJlc3BvbnNlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBpZFRva2VuUmVzcG9uc2UuaWRUb2tlbikpIHtcclxuICAgICAgICBjb25zdCBzaWduSW5Qcm92aWRlciA9IChfYiA9IChfYSA9IF9wYXJzZVRva2VuKGlkVG9rZW5SZXNwb25zZS5pZFRva2VuKSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmZpcmViYXNlKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2JbJ3NpZ25faW5fcHJvdmlkZXInXTtcclxuICAgICAgICBpZiAoc2lnbkluUHJvdmlkZXIpIHtcclxuICAgICAgICAgICAgY29uc3QgZmlsdGVyZWRQcm92aWRlcklkID0gc2lnbkluUHJvdmlkZXIgIT09IFwiYW5vbnltb3VzXCIgLyogQU5PTllNT1VTICovICYmXHJcbiAgICAgICAgICAgICAgICBzaWduSW5Qcm92aWRlciAhPT0gXCJjdXN0b21cIiAvKiBDVVNUT00gKi9cclxuICAgICAgICAgICAgICAgID8gc2lnbkluUHJvdmlkZXJcclxuICAgICAgICAgICAgICAgIDogbnVsbDtcclxuICAgICAgICAgICAgLy8gVXNlcyBnZW5lcmljIGNsYXNzIGluIGFjY29yZGFuY2Ugd2l0aCB0aGUgbGVnYWN5IFNESy5cclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBHZW5lcmljQWRkaXRpb25hbFVzZXJJbmZvKGlzTmV3VXNlciwgZmlsdGVyZWRQcm92aWRlcklkKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAoIXByb3ZpZGVySWQpIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIHN3aXRjaCAocHJvdmlkZXJJZCkge1xyXG4gICAgICAgIGNhc2UgXCJmYWNlYm9vay5jb21cIiAvKiBGQUNFQk9PSyAqLzpcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBGYWNlYm9va0FkZGl0aW9uYWxVc2VySW5mbyhpc05ld1VzZXIsIHByb2ZpbGUpO1xyXG4gICAgICAgIGNhc2UgXCJnaXRodWIuY29tXCIgLyogR0lUSFVCICovOlxyXG4gICAgICAgICAgICByZXR1cm4gbmV3IEdpdGh1YkFkZGl0aW9uYWxVc2VySW5mbyhpc05ld1VzZXIsIHByb2ZpbGUpO1xyXG4gICAgICAgIGNhc2UgXCJnb29nbGUuY29tXCIgLyogR09PR0xFICovOlxyXG4gICAgICAgICAgICByZXR1cm4gbmV3IEdvb2dsZUFkZGl0aW9uYWxVc2VySW5mbyhpc05ld1VzZXIsIHByb2ZpbGUpO1xyXG4gICAgICAgIGNhc2UgXCJ0d2l0dGVyLmNvbVwiIC8qIFRXSVRURVIgKi86XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgVHdpdHRlckFkZGl0aW9uYWxVc2VySW5mbyhpc05ld1VzZXIsIHByb2ZpbGUsIGlkVG9rZW5SZXNwb25zZS5zY3JlZW5OYW1lIHx8IG51bGwpO1xyXG4gICAgICAgIGNhc2UgXCJjdXN0b21cIiAvKiBDVVNUT00gKi86XHJcbiAgICAgICAgY2FzZSBcImFub255bW91c1wiIC8qIEFOT05ZTU9VUyAqLzpcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBHZW5lcmljQWRkaXRpb25hbFVzZXJJbmZvKGlzTmV3VXNlciwgbnVsbCk7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBHZW5lcmljQWRkaXRpb25hbFVzZXJJbmZvKGlzTmV3VXNlciwgcHJvdmlkZXJJZCwgcHJvZmlsZSk7XHJcbiAgICB9XHJcbn1cclxuY2xhc3MgR2VuZXJpY0FkZGl0aW9uYWxVc2VySW5mbyB7XHJcbiAgICBjb25zdHJ1Y3Rvcihpc05ld1VzZXIsIHByb3ZpZGVySWQsIHByb2ZpbGUgPSB7fSkge1xyXG4gICAgICAgIHRoaXMuaXNOZXdVc2VyID0gaXNOZXdVc2VyO1xyXG4gICAgICAgIHRoaXMucHJvdmlkZXJJZCA9IHByb3ZpZGVySWQ7XHJcbiAgICAgICAgdGhpcy5wcm9maWxlID0gcHJvZmlsZTtcclxuICAgIH1cclxufVxyXG5jbGFzcyBGZWRlcmF0ZWRBZGRpdGlvbmFsVXNlckluZm9XaXRoVXNlcm5hbWUgZXh0ZW5kcyBHZW5lcmljQWRkaXRpb25hbFVzZXJJbmZvIHtcclxuICAgIGNvbnN0cnVjdG9yKGlzTmV3VXNlciwgcHJvdmlkZXJJZCwgcHJvZmlsZSwgdXNlcm5hbWUpIHtcclxuICAgICAgICBzdXBlcihpc05ld1VzZXIsIHByb3ZpZGVySWQsIHByb2ZpbGUpO1xyXG4gICAgICAgIHRoaXMudXNlcm5hbWUgPSB1c2VybmFtZTtcclxuICAgIH1cclxufVxyXG5jbGFzcyBGYWNlYm9va0FkZGl0aW9uYWxVc2VySW5mbyBleHRlbmRzIEdlbmVyaWNBZGRpdGlvbmFsVXNlckluZm8ge1xyXG4gICAgY29uc3RydWN0b3IoaXNOZXdVc2VyLCBwcm9maWxlKSB7XHJcbiAgICAgICAgc3VwZXIoaXNOZXdVc2VyLCBcImZhY2Vib29rLmNvbVwiIC8qIEZBQ0VCT09LICovLCBwcm9maWxlKTtcclxuICAgIH1cclxufVxyXG5jbGFzcyBHaXRodWJBZGRpdGlvbmFsVXNlckluZm8gZXh0ZW5kcyBGZWRlcmF0ZWRBZGRpdGlvbmFsVXNlckluZm9XaXRoVXNlcm5hbWUge1xyXG4gICAgY29uc3RydWN0b3IoaXNOZXdVc2VyLCBwcm9maWxlKSB7XHJcbiAgICAgICAgc3VwZXIoaXNOZXdVc2VyLCBcImdpdGh1Yi5jb21cIiAvKiBHSVRIVUIgKi8sIHByb2ZpbGUsIHR5cGVvZiAocHJvZmlsZSA9PT0gbnVsbCB8fCBwcm9maWxlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBwcm9maWxlLmxvZ2luKSA9PT0gJ3N0cmluZycgPyBwcm9maWxlID09PSBudWxsIHx8IHByb2ZpbGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHByb2ZpbGUubG9naW4gOiBudWxsKTtcclxuICAgIH1cclxufVxyXG5jbGFzcyBHb29nbGVBZGRpdGlvbmFsVXNlckluZm8gZXh0ZW5kcyBHZW5lcmljQWRkaXRpb25hbFVzZXJJbmZvIHtcclxuICAgIGNvbnN0cnVjdG9yKGlzTmV3VXNlciwgcHJvZmlsZSkge1xyXG4gICAgICAgIHN1cGVyKGlzTmV3VXNlciwgXCJnb29nbGUuY29tXCIgLyogR09PR0xFICovLCBwcm9maWxlKTtcclxuICAgIH1cclxufVxyXG5jbGFzcyBUd2l0dGVyQWRkaXRpb25hbFVzZXJJbmZvIGV4dGVuZHMgRmVkZXJhdGVkQWRkaXRpb25hbFVzZXJJbmZvV2l0aFVzZXJuYW1lIHtcclxuICAgIGNvbnN0cnVjdG9yKGlzTmV3VXNlciwgcHJvZmlsZSwgc2NyZWVuTmFtZSkge1xyXG4gICAgICAgIHN1cGVyKGlzTmV3VXNlciwgXCJ0d2l0dGVyLmNvbVwiIC8qIFRXSVRURVIgKi8sIHByb2ZpbGUsIHNjcmVlbk5hbWUpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBFeHRyYWN0cyBwcm92aWRlciBzcGVjaWZpYyB7QGxpbmsgQWRkaXRpb25hbFVzZXJJbmZvfSBmb3IgdGhlIGdpdmVuIGNyZWRlbnRpYWwuXHJcbiAqXHJcbiAqIEBwYXJhbSB1c2VyQ3JlZGVudGlhbCAtIFRoZSB1c2VyIGNyZWRlbnRpYWwuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmZ1bmN0aW9uIGdldEFkZGl0aW9uYWxVc2VySW5mbyh1c2VyQ3JlZGVudGlhbCkge1xyXG4gICAgY29uc3QgeyB1c2VyLCBfdG9rZW5SZXNwb25zZSB9ID0gdXNlckNyZWRlbnRpYWw7XHJcbiAgICBpZiAodXNlci5pc0Fub255bW91cyAmJiAhX3Rva2VuUmVzcG9uc2UpIHtcclxuICAgICAgICAvLyBIYW5kbGUgdGhlIHNwZWNpYWwgY2FzZSB3aGVyZSBzaWduSW5Bbm9ueW1vdXNseSgpIGdldHMgY2FsbGVkIHR3aWNlLlxyXG4gICAgICAgIC8vIE5vIG5ldHdvcmsgY2FsbCBpcyBtYWRlIHNvIHRoZXJlJ3Mgbm90aGluZyB0byBhY3R1YWxseSBmaWxsIHRoaXMgaW5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBwcm92aWRlcklkOiBudWxsLFxyXG4gICAgICAgICAgICBpc05ld1VzZXI6IGZhbHNlLFxyXG4gICAgICAgICAgICBwcm9maWxlOiBudWxsXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuICAgIHJldHVybiBfZnJvbUlkVG9rZW5SZXNwb25zZShfdG9rZW5SZXNwb25zZSk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLy8gTm9uLW9wdGlvbmFsIGF1dGggbWV0aG9kcy5cclxuLyoqXHJcbiAqIENoYW5nZXMgdGhlIHR5cGUgb2YgcGVyc2lzdGVuY2Ugb24gdGhlIHtAbGluayBBdXRofSBpbnN0YW5jZSBmb3IgdGhlIGN1cnJlbnRseSBzYXZlZFxyXG4gKiBgQXV0aGAgc2Vzc2lvbiBhbmQgYXBwbGllcyB0aGlzIHR5cGUgb2YgcGVyc2lzdGVuY2UgZm9yIGZ1dHVyZSBzaWduLWluIHJlcXVlc3RzLCBpbmNsdWRpbmdcclxuICogc2lnbi1pbiB3aXRoIHJlZGlyZWN0IHJlcXVlc3RzLlxyXG4gKlxyXG4gKiBAcmVtYXJrc1xyXG4gKiBUaGlzIG1ha2VzIGl0IGVhc3kgZm9yIGEgdXNlciBzaWduaW5nIGluIHRvIHNwZWNpZnkgd2hldGhlciB0aGVpciBzZXNzaW9uIHNob3VsZCBiZVxyXG4gKiByZW1lbWJlcmVkIG9yIG5vdC4gSXQgYWxzbyBtYWtlcyBpdCBlYXNpZXIgdG8gbmV2ZXIgcGVyc2lzdCB0aGUgYEF1dGhgIHN0YXRlIGZvciBhcHBsaWNhdGlvbnNcclxuICogdGhhdCBhcmUgc2hhcmVkIGJ5IG90aGVyIHVzZXJzIG9yIGhhdmUgc2Vuc2l0aXZlIGRhdGEuXHJcbiAqXHJcbiAqIEBleGFtcGxlXHJcbiAqIGBgYGphdmFzY3JpcHRcclxuICogc2V0UGVyc2lzdGVuY2UoYXV0aCwgYnJvd3NlclNlc3Npb25QZXJzaXN0ZW5jZSk7XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXHJcbiAqIEBwYXJhbSBwZXJzaXN0ZW5jZSAtIFRoZSB7QGxpbmsgUGVyc2lzdGVuY2V9IHRvIHVzZS5cclxuICogQHJldHVybnMgQSBgUHJvbWlzZWAgdGhhdCByZXNvbHZlcyBvbmNlIHRoZSBwZXJzaXN0ZW5jZSBjaGFuZ2UgaGFzIGNvbXBsZXRlZFxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5mdW5jdGlvbiBzZXRQZXJzaXN0ZW5jZShhdXRoLCBwZXJzaXN0ZW5jZSkge1xyXG4gICAgcmV0dXJuIGdldE1vZHVsYXJJbnN0YW5jZShhdXRoKS5zZXRQZXJzaXN0ZW5jZShwZXJzaXN0ZW5jZSk7XHJcbn1cclxuLyoqXHJcbiAqIEFkZHMgYW4gb2JzZXJ2ZXIgZm9yIGNoYW5nZXMgdG8gdGhlIHNpZ25lZC1pbiB1c2VyJ3MgSUQgdG9rZW4sIHdoaWNoIGluY2x1ZGVzIHNpZ24taW4sXHJcbiAqIHNpZ24tb3V0LCBhbmQgdG9rZW4gcmVmcmVzaCBldmVudHMuXHJcbiAqXHJcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cclxuICogQHBhcmFtIG5leHRPck9ic2VydmVyIC0gY2FsbGJhY2sgdHJpZ2dlcmVkIG9uIGNoYW5nZS5cclxuICogQHBhcmFtIGVycm9yIC0gY2FsbGJhY2sgdHJpZ2dlcmVkIG9uIGVycm9yLlxyXG4gKiBAcGFyYW0gY29tcGxldGVkIC0gY2FsbGJhY2sgdHJpZ2dlcmVkIHdoZW4gb2JzZXJ2ZXIgaXMgcmVtb3ZlZC5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuZnVuY3Rpb24gb25JZFRva2VuQ2hhbmdlZChhdXRoLCBuZXh0T3JPYnNlcnZlciwgZXJyb3IsIGNvbXBsZXRlZCkge1xyXG4gICAgcmV0dXJuIGdldE1vZHVsYXJJbnN0YW5jZShhdXRoKS5vbklkVG9rZW5DaGFuZ2VkKG5leHRPck9ic2VydmVyLCBlcnJvciwgY29tcGxldGVkKTtcclxufVxyXG4vKipcclxuICogQWRkcyBhbiBvYnNlcnZlciBmb3IgY2hhbmdlcyB0byB0aGUgdXNlcidzIHNpZ24taW4gc3RhdGUuXHJcbiAqXHJcbiAqIEByZW1hcmtzXHJcbiAqIFRvIGtlZXAgdGhlIG9sZCBiZWhhdmlvciwgc2VlIHtAbGluayBvbklkVG9rZW5DaGFuZ2VkfS5cclxuICpcclxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxyXG4gKiBAcGFyYW0gbmV4dE9yT2JzZXJ2ZXIgLSBjYWxsYmFjayB0cmlnZ2VyZWQgb24gY2hhbmdlLlxyXG4gKiBAcGFyYW0gZXJyb3IgLSBjYWxsYmFjayB0cmlnZ2VyZWQgb24gZXJyb3IuXHJcbiAqIEBwYXJhbSBjb21wbGV0ZWQgLSBjYWxsYmFjayB0cmlnZ2VyZWQgd2hlbiBvYnNlcnZlciBpcyByZW1vdmVkLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5mdW5jdGlvbiBvbkF1dGhTdGF0ZUNoYW5nZWQoYXV0aCwgbmV4dE9yT2JzZXJ2ZXIsIGVycm9yLCBjb21wbGV0ZWQpIHtcclxuICAgIHJldHVybiBnZXRNb2R1bGFySW5zdGFuY2UoYXV0aCkub25BdXRoU3RhdGVDaGFuZ2VkKG5leHRPck9ic2VydmVyLCBlcnJvciwgY29tcGxldGVkKTtcclxufVxyXG4vKipcclxuICogU2V0cyB0aGUgY3VycmVudCBsYW5ndWFnZSB0byB0aGUgZGVmYXVsdCBkZXZpY2UvYnJvd3NlciBwcmVmZXJlbmNlLlxyXG4gKlxyXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmZ1bmN0aW9uIHVzZURldmljZUxhbmd1YWdlKGF1dGgpIHtcclxuICAgIGdldE1vZHVsYXJJbnN0YW5jZShhdXRoKS51c2VEZXZpY2VMYW5ndWFnZSgpO1xyXG59XHJcbi8qKlxyXG4gKiBBc3luY2hyb25vdXNseSBzZXRzIHRoZSBwcm92aWRlZCB1c2VyIGFzIHtAbGluayBBdXRoLmN1cnJlbnRVc2VyfSBvbiB0aGVcclxuICoge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxyXG4gKlxyXG4gKiBAcmVtYXJrc1xyXG4gKiBBIG5ldyBpbnN0YW5jZSBjb3B5IG9mIHRoZSB1c2VyIHByb3ZpZGVkIHdpbGwgYmUgbWFkZSBhbmQgc2V0IGFzIGN1cnJlbnRVc2VyLlxyXG4gKlxyXG4gKiBUaGlzIHdpbGwgdHJpZ2dlciB7QGxpbmsgb25BdXRoU3RhdGVDaGFuZ2VkfSBhbmQge0BsaW5rIG9uSWRUb2tlbkNoYW5nZWR9IGxpc3RlbmVyc1xyXG4gKiBsaWtlIG90aGVyIHNpZ24gaW4gbWV0aG9kcy5cclxuICpcclxuICogVGhlIG9wZXJhdGlvbiBmYWlscyB3aXRoIGFuIGVycm9yIGlmIHRoZSB1c2VyIHRvIGJlIHVwZGF0ZWQgYmVsb25ncyB0byBhIGRpZmZlcmVudCBGaXJlYmFzZVxyXG4gKiBwcm9qZWN0LlxyXG4gKlxyXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXHJcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIG5ldyB7QGxpbmsgVXNlcn0uXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmZ1bmN0aW9uIHVwZGF0ZUN1cnJlbnRVc2VyKGF1dGgsIHVzZXIpIHtcclxuICAgIHJldHVybiBnZXRNb2R1bGFySW5zdGFuY2UoYXV0aCkudXBkYXRlQ3VycmVudFVzZXIodXNlcik7XHJcbn1cclxuLyoqXHJcbiAqIFNpZ25zIG91dCB0aGUgY3VycmVudCB1c2VyLlxyXG4gKlxyXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmZ1bmN0aW9uIHNpZ25PdXQoYXV0aCkge1xyXG4gICAgcmV0dXJuIGdldE1vZHVsYXJJbnN0YW5jZShhdXRoKS5zaWduT3V0KCk7XHJcbn1cclxuLyoqXHJcbiAqIERlbGV0ZXMgYW5kIHNpZ25zIG91dCB0aGUgdXNlci5cclxuICpcclxuICogQHJlbWFya3NcclxuICogSW1wb3J0YW50OiB0aGlzIGlzIGEgc2VjdXJpdHktc2Vuc2l0aXZlIG9wZXJhdGlvbiB0aGF0IHJlcXVpcmVzIHRoZSB1c2VyIHRvIGhhdmUgcmVjZW50bHlcclxuICogc2lnbmVkIGluLiBJZiB0aGlzIHJlcXVpcmVtZW50IGlzbid0IG1ldCwgYXNrIHRoZSB1c2VyIHRvIGF1dGhlbnRpY2F0ZSBhZ2FpbiBhbmQgdGhlbiBjYWxsXHJcbiAqIHtAbGluayByZWF1dGhlbnRpY2F0ZVdpdGhDcmVkZW50aWFsfS5cclxuICpcclxuICogQHBhcmFtIHVzZXIgLSBUaGUgdXNlci5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gZGVsZXRlVXNlcih1c2VyKSB7XHJcbiAgICByZXR1cm4gZ2V0TW9kdWxhckluc3RhbmNlKHVzZXIpLmRlbGV0ZSgpO1xyXG59XG5cbmNsYXNzIE11bHRpRmFjdG9yU2Vzc2lvbkltcGwge1xyXG4gICAgY29uc3RydWN0b3IodHlwZSwgY3JlZGVudGlhbCkge1xyXG4gICAgICAgIHRoaXMudHlwZSA9IHR5cGU7XHJcbiAgICAgICAgdGhpcy5jcmVkZW50aWFsID0gY3JlZGVudGlhbDtcclxuICAgIH1cclxuICAgIHN0YXRpYyBfZnJvbUlkdG9rZW4oaWRUb2tlbikge1xyXG4gICAgICAgIHJldHVybiBuZXcgTXVsdGlGYWN0b3JTZXNzaW9uSW1wbChcImVucm9sbFwiIC8qIEVOUk9MTCAqLywgaWRUb2tlbik7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgX2Zyb21NZmFQZW5kaW5nQ3JlZGVudGlhbChtZmFQZW5kaW5nQ3JlZGVudGlhbCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgTXVsdGlGYWN0b3JTZXNzaW9uSW1wbChcInNpZ25pblwiIC8qIFNJR05fSU4gKi8sIG1mYVBlbmRpbmdDcmVkZW50aWFsKTtcclxuICAgIH1cclxuICAgIHRvSlNPTigpIHtcclxuICAgICAgICBjb25zdCBrZXkgPSB0aGlzLnR5cGUgPT09IFwiZW5yb2xsXCIgLyogRU5ST0xMICovXHJcbiAgICAgICAgICAgID8gJ2lkVG9rZW4nXHJcbiAgICAgICAgICAgIDogJ3BlbmRpbmdDcmVkZW50aWFsJztcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBtdWx0aUZhY3RvclNlc3Npb246IHtcclxuICAgICAgICAgICAgICAgIFtrZXldOiB0aGlzLmNyZWRlbnRpYWxcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgZnJvbUpTT04ob2JqKSB7XHJcbiAgICAgICAgdmFyIF9hLCBfYjtcclxuICAgICAgICBpZiAob2JqID09PSBudWxsIHx8IG9iaiA9PT0gdm9pZCAwID8gdm9pZCAwIDogb2JqLm11bHRpRmFjdG9yU2Vzc2lvbikge1xyXG4gICAgICAgICAgICBpZiAoKF9hID0gb2JqLm11bHRpRmFjdG9yU2Vzc2lvbikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnBlbmRpbmdDcmVkZW50aWFsKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gTXVsdGlGYWN0b3JTZXNzaW9uSW1wbC5fZnJvbU1mYVBlbmRpbmdDcmVkZW50aWFsKG9iai5tdWx0aUZhY3RvclNlc3Npb24ucGVuZGluZ0NyZWRlbnRpYWwpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKChfYiA9IG9iai5tdWx0aUZhY3RvclNlc3Npb24pID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5pZFRva2VuKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gTXVsdGlGYWN0b3JTZXNzaW9uSW1wbC5fZnJvbUlkdG9rZW4ob2JqLm11bHRpRmFjdG9yU2Vzc2lvbi5pZFRva2VuKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jbGFzcyBNdWx0aUZhY3RvclJlc29sdmVySW1wbCB7XHJcbiAgICBjb25zdHJ1Y3RvcihzZXNzaW9uLCBoaW50cywgc2lnbkluUmVzb2x2ZXIpIHtcclxuICAgICAgICB0aGlzLnNlc3Npb24gPSBzZXNzaW9uO1xyXG4gICAgICAgIHRoaXMuaGludHMgPSBoaW50cztcclxuICAgICAgICB0aGlzLnNpZ25JblJlc29sdmVyID0gc2lnbkluUmVzb2x2ZXI7XHJcbiAgICB9XHJcbiAgICAvKiogQGludGVybmFsICovXHJcbiAgICBzdGF0aWMgX2Zyb21FcnJvcihhdXRoRXh0ZXJuLCBlcnJvcikge1xyXG4gICAgICAgIGNvbnN0IGF1dGggPSBfY2FzdEF1dGgoYXV0aEV4dGVybik7XHJcbiAgICAgICAgY29uc3QgaGludHMgPSAoZXJyb3Iuc2VydmVyUmVzcG9uc2UubWZhSW5mbyB8fCBbXSkubWFwKGVucm9sbG1lbnQgPT4gTXVsdGlGYWN0b3JJbmZvSW1wbC5fZnJvbVNlcnZlclJlc3BvbnNlKGF1dGgsIGVucm9sbG1lbnQpKTtcclxuICAgICAgICBfYXNzZXJ0KGVycm9yLnNlcnZlclJlc3BvbnNlLm1mYVBlbmRpbmdDcmVkZW50aWFsLCBhdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8pO1xyXG4gICAgICAgIGNvbnN0IHNlc3Npb24gPSBNdWx0aUZhY3RvclNlc3Npb25JbXBsLl9mcm9tTWZhUGVuZGluZ0NyZWRlbnRpYWwoZXJyb3Iuc2VydmVyUmVzcG9uc2UubWZhUGVuZGluZ0NyZWRlbnRpYWwpO1xyXG4gICAgICAgIHJldHVybiBuZXcgTXVsdGlGYWN0b3JSZXNvbHZlckltcGwoc2Vzc2lvbiwgaGludHMsIGFzeW5jIChhc3NlcnRpb24pID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbWZhUmVzcG9uc2UgPSBhd2FpdCBhc3NlcnRpb24uX3Byb2Nlc3MoYXV0aCwgc2Vzc2lvbik7XHJcbiAgICAgICAgICAgIC8vIENsZWFyIG91dCB0aGUgdW5uZWVkZWQgZmllbGRzIGZyb20gdGhlIG9sZCBsb2dpbiByZXNwb25zZVxyXG4gICAgICAgICAgICBkZWxldGUgZXJyb3Iuc2VydmVyUmVzcG9uc2UubWZhSW5mbztcclxuICAgICAgICAgICAgZGVsZXRlIGVycm9yLnNlcnZlclJlc3BvbnNlLm1mYVBlbmRpbmdDcmVkZW50aWFsO1xyXG4gICAgICAgICAgICAvLyBVc2UgaW4gdGhlIG5ldyB0b2tlbiAmIHJlZnJlc2ggdG9rZW4gaW4gdGhlIG9sZCByZXNwb25zZVxyXG4gICAgICAgICAgICBjb25zdCBpZFRva2VuUmVzcG9uc2UgPSBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIGVycm9yLnNlcnZlclJlc3BvbnNlKSwgeyBpZFRva2VuOiBtZmFSZXNwb25zZS5pZFRva2VuLCByZWZyZXNoVG9rZW46IG1mYVJlc3BvbnNlLnJlZnJlc2hUb2tlbiB9KTtcclxuICAgICAgICAgICAgLy8gVE9ETzogd2Ugc2hvdWxkIGNvbGxhcHNlIHRoaXMgc3dpdGNoIHN0YXRlbWVudCBpbnRvIFVzZXJDcmVkZW50aWFsSW1wbC5fZm9yT3BlcmF0aW9uIGFuZCBoYXZlIGl0IHN1cHBvcnQgdGhlIFNJR05fSU4gY2FzZVxyXG4gICAgICAgICAgICBzd2l0Y2ggKGVycm9yLm9wZXJhdGlvblR5cGUpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJzaWduSW5cIiAvKiBTSUdOX0lOICovOlxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHVzZXJDcmVkZW50aWFsID0gYXdhaXQgVXNlckNyZWRlbnRpYWxJbXBsLl9mcm9tSWRUb2tlblJlc3BvbnNlKGF1dGgsIGVycm9yLm9wZXJhdGlvblR5cGUsIGlkVG9rZW5SZXNwb25zZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgYXV0aC5fdXBkYXRlQ3VycmVudFVzZXIodXNlckNyZWRlbnRpYWwudXNlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVzZXJDcmVkZW50aWFsO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBcInJlYXV0aGVudGljYXRlXCIgLyogUkVBVVRIRU5USUNBVEUgKi86XHJcbiAgICAgICAgICAgICAgICAgICAgX2Fzc2VydChlcnJvci51c2VyLCBhdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8pO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBVc2VyQ3JlZGVudGlhbEltcGwuX2Zvck9wZXJhdGlvbihlcnJvci51c2VyLCBlcnJvci5vcGVyYXRpb25UeXBlLCBpZFRva2VuUmVzcG9uc2UpO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBfZmFpbChhdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBhc3luYyByZXNvbHZlU2lnbkluKGFzc2VydGlvbkV4dGVybikge1xyXG4gICAgICAgIGNvbnN0IGFzc2VydGlvbiA9IGFzc2VydGlvbkV4dGVybjtcclxuICAgICAgICByZXR1cm4gdGhpcy5zaWduSW5SZXNvbHZlcihhc3NlcnRpb24pO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBQcm92aWRlcyBhIHtAbGluayBNdWx0aUZhY3RvclJlc29sdmVyfSBzdWl0YWJsZSBmb3IgY29tcGxldGlvbiBvZiBhXHJcbiAqIG11bHRpLWZhY3RvciBmbG93LlxyXG4gKlxyXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXHJcbiAqIEBwYXJhbSBlcnJvciAtIFRoZSB7QGxpbmsgTXVsdGlGYWN0b3JFcnJvcn0gcmFpc2VkIGR1cmluZyBhIHNpZ24taW4sIG9yXHJcbiAqIHJlYXV0aGVudGljYXRpb24gb3BlcmF0aW9uLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5mdW5jdGlvbiBnZXRNdWx0aUZhY3RvclJlc29sdmVyKGF1dGgsIGVycm9yKSB7XHJcbiAgICB2YXIgX2E7XHJcbiAgICBjb25zdCBhdXRoTW9kdWxhciA9IGdldE1vZHVsYXJJbnN0YW5jZShhdXRoKTtcclxuICAgIGNvbnN0IGVycm9ySW50ZXJuYWwgPSBlcnJvcjtcclxuICAgIF9hc3NlcnQoZXJyb3Iub3BlcmF0aW9uVHlwZSwgYXV0aE1vZHVsYXIsIFwiYXJndW1lbnQtZXJyb3JcIiAvKiBBUkdVTUVOVF9FUlJPUiAqLyk7XHJcbiAgICBfYXNzZXJ0KChfYSA9IGVycm9ySW50ZXJuYWwuc2VydmVyUmVzcG9uc2UpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5tZmFQZW5kaW5nQ3JlZGVudGlhbCwgYXV0aE1vZHVsYXIsIFwiYXJndW1lbnQtZXJyb3JcIiAvKiBBUkdVTUVOVF9FUlJPUiAqLyk7XHJcbiAgICByZXR1cm4gTXVsdGlGYWN0b3JSZXNvbHZlckltcGwuX2Zyb21FcnJvcihhdXRoTW9kdWxhciwgZXJyb3JJbnRlcm5hbCk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuZnVuY3Rpb24gc3RhcnRFbnJvbGxQaG9uZU1mYShhdXRoLCByZXF1ZXN0KSB7XHJcbiAgICByZXR1cm4gX3BlcmZvcm1BcGlSZXF1ZXN0KGF1dGgsIFwiUE9TVFwiIC8qIFBPU1QgKi8sIFwiL3YyL2FjY291bnRzL21mYUVucm9sbG1lbnQ6c3RhcnRcIiAvKiBTVEFSVF9QSE9ORV9NRkFfRU5ST0xMTUVOVCAqLywgT2JqZWN0LmFzc2lnbih7IHRlbmFudElkOiBhdXRoLnRlbmFudElkIH0sIHJlcXVlc3QpKTtcclxufVxyXG5mdW5jdGlvbiBmaW5hbGl6ZUVucm9sbFBob25lTWZhKGF1dGgsIHJlcXVlc3QpIHtcclxuICAgIHJldHVybiBfcGVyZm9ybUFwaVJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogUE9TVCAqLywgXCIvdjIvYWNjb3VudHMvbWZhRW5yb2xsbWVudDpmaW5hbGl6ZVwiIC8qIEZJTkFMSVpFX1BIT05FX01GQV9FTlJPTExNRU5UICovLCBPYmplY3QuYXNzaWduKHsgdGVuYW50SWQ6IGF1dGgudGVuYW50SWQgfSwgcmVxdWVzdCkpO1xyXG59XHJcbmZ1bmN0aW9uIHdpdGhkcmF3TWZhKGF1dGgsIHJlcXVlc3QpIHtcclxuICAgIHJldHVybiBfcGVyZm9ybUFwaVJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogUE9TVCAqLywgXCIvdjIvYWNjb3VudHMvbWZhRW5yb2xsbWVudDp3aXRoZHJhd1wiIC8qIFdJVEhEUkFXX01GQSAqLywgT2JqZWN0LmFzc2lnbih7IHRlbmFudElkOiBhdXRoLnRlbmFudElkIH0sIHJlcXVlc3QpKTtcclxufVxuXG5jbGFzcyBNdWx0aUZhY3RvclVzZXJJbXBsIHtcclxuICAgIGNvbnN0cnVjdG9yKHVzZXIpIHtcclxuICAgICAgICB0aGlzLnVzZXIgPSB1c2VyO1xyXG4gICAgICAgIHRoaXMuZW5yb2xsZWRGYWN0b3JzID0gW107XHJcbiAgICAgICAgdXNlci5fb25SZWxvYWQodXNlckluZm8gPT4ge1xyXG4gICAgICAgICAgICBpZiAodXNlckluZm8ubWZhSW5mbykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lbnJvbGxlZEZhY3RvcnMgPSB1c2VySW5mby5tZmFJbmZvLm1hcChlbnJvbGxtZW50ID0+IE11bHRpRmFjdG9ySW5mb0ltcGwuX2Zyb21TZXJ2ZXJSZXNwb25zZSh1c2VyLmF1dGgsIGVucm9sbG1lbnQpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIF9mcm9tVXNlcih1c2VyKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBNdWx0aUZhY3RvclVzZXJJbXBsKHVzZXIpO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgZ2V0U2Vzc2lvbigpIHtcclxuICAgICAgICByZXR1cm4gTXVsdGlGYWN0b3JTZXNzaW9uSW1wbC5fZnJvbUlkdG9rZW4oYXdhaXQgdGhpcy51c2VyLmdldElkVG9rZW4oKSk7XHJcbiAgICB9XHJcbiAgICBhc3luYyBlbnJvbGwoYXNzZXJ0aW9uRXh0ZXJuLCBkaXNwbGF5TmFtZSkge1xyXG4gICAgICAgIGNvbnN0IGFzc2VydGlvbiA9IGFzc2VydGlvbkV4dGVybjtcclxuICAgICAgICBjb25zdCBzZXNzaW9uID0gKGF3YWl0IHRoaXMuZ2V0U2Vzc2lvbigpKTtcclxuICAgICAgICBjb25zdCBmaW5hbGl6ZU1mYVJlc3BvbnNlID0gYXdhaXQgX2xvZ291dElmSW52YWxpZGF0ZWQodGhpcy51c2VyLCBhc3NlcnRpb24uX3Byb2Nlc3ModGhpcy51c2VyLmF1dGgsIHNlc3Npb24sIGRpc3BsYXlOYW1lKSk7XHJcbiAgICAgICAgLy8gTmV3IHRva2VucyB3aWxsIGJlIGlzc3VlZCBhZnRlciBlbnJvbGxtZW50IG9mIHRoZSBuZXcgc2Vjb25kIGZhY3RvcnMuXHJcbiAgICAgICAgLy8gVGhleSBuZWVkIHRvIGJlIHVwZGF0ZWQgb24gdGhlIHVzZXIuXHJcbiAgICAgICAgYXdhaXQgdGhpcy51c2VyLl91cGRhdGVUb2tlbnNJZk5lY2Vzc2FyeShmaW5hbGl6ZU1mYVJlc3BvbnNlKTtcclxuICAgICAgICAvLyBUaGUgdXNlciBuZWVkcyB0byBiZSByZWxvYWRlZCB0byBnZXQgdGhlIG5ldyBtdWx0aS1mYWN0b3IgaW5mb3JtYXRpb25cclxuICAgICAgICAvLyBmcm9tIHNlcnZlci4gVVNFUl9SRUxPQURFRCBldmVudCB3aWxsIGJlIHRyaWdnZXJlZCBhbmQgYGVucm9sbGVkRmFjdG9yc2BcclxuICAgICAgICAvLyB3aWxsIGJlIHVwZGF0ZWQuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMudXNlci5yZWxvYWQoKTtcclxuICAgIH1cclxuICAgIGFzeW5jIHVuZW5yb2xsKGluZm9PclVpZCkge1xyXG4gICAgICAgIGNvbnN0IG1mYUVucm9sbG1lbnRJZCA9IHR5cGVvZiBpbmZvT3JVaWQgPT09ICdzdHJpbmcnID8gaW5mb09yVWlkIDogaW5mb09yVWlkLnVpZDtcclxuICAgICAgICBjb25zdCBpZFRva2VuID0gYXdhaXQgdGhpcy51c2VyLmdldElkVG9rZW4oKTtcclxuICAgICAgICBjb25zdCBpZFRva2VuUmVzcG9uc2UgPSBhd2FpdCBfbG9nb3V0SWZJbnZhbGlkYXRlZCh0aGlzLnVzZXIsIHdpdGhkcmF3TWZhKHRoaXMudXNlci5hdXRoLCB7XHJcbiAgICAgICAgICAgIGlkVG9rZW4sXHJcbiAgICAgICAgICAgIG1mYUVucm9sbG1lbnRJZFxyXG4gICAgICAgIH0pKTtcclxuICAgICAgICAvLyBSZW1vdmUgdGhlIHNlY29uZCBmYWN0b3IgZnJvbSB0aGUgdXNlcidzIGxpc3QuXHJcbiAgICAgICAgdGhpcy5lbnJvbGxlZEZhY3RvcnMgPSB0aGlzLmVucm9sbGVkRmFjdG9ycy5maWx0ZXIoKHsgdWlkIH0pID0+IHVpZCAhPT0gbWZhRW5yb2xsbWVudElkKTtcclxuICAgICAgICAvLyBEZXBlbmRpbmcgb24gd2hldGhlciB0aGUgYmFja2VuZCBkZWNpZGVkIHRvIHJldm9rZSB0aGUgdXNlcidzIHNlc3Npb24sXHJcbiAgICAgICAgLy8gdGhlIHRva2VuUmVzcG9uc2UgbWF5IGJlIGVtcHR5LiBJZiB0aGUgdG9rZW5zIHdlcmUgbm90IHVwZGF0ZWQgKGFuZCB0aGV5XHJcbiAgICAgICAgLy8gYXJlIG5vdyBpbnZhbGlkKSwgcmVsb2FkaW5nIHRoZSB1c2VyIHdpbGwgZGlzY292ZXIgdGhpcyBhbmQgaW52YWxpZGF0ZVxyXG4gICAgICAgIC8vIHRoZSB1c2VyJ3Mgc3RhdGUgYWNjb3JkaW5nbHkuXHJcbiAgICAgICAgYXdhaXQgdGhpcy51c2VyLl91cGRhdGVUb2tlbnNJZk5lY2Vzc2FyeShpZFRva2VuUmVzcG9uc2UpO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMudXNlci5yZWxvYWQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgaWYgKGUuY29kZSAhPT0gYGF1dGgvJHtcInVzZXItdG9rZW4tZXhwaXJlZFwiIC8qIFRPS0VOX0VYUElSRUQgKi99YCkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5jb25zdCBtdWx0aUZhY3RvclVzZXJDYWNoZSA9IG5ldyBXZWFrTWFwKCk7XHJcbi8qKlxyXG4gKiBUaGUge0BsaW5rIE11bHRpRmFjdG9yVXNlcn0gY29ycmVzcG9uZGluZyB0byB0aGUgdXNlci5cclxuICpcclxuICogQHJlbWFya3NcclxuICogVGhpcyBpcyB1c2VkIHRvIGFjY2VzcyBhbGwgbXVsdGktZmFjdG9yIHByb3BlcnRpZXMgYW5kIG9wZXJhdGlvbnMgcmVsYXRlZCB0byB0aGUgdXNlci5cclxuICpcclxuICogQHBhcmFtIHVzZXIgLSBUaGUgdXNlci5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuZnVuY3Rpb24gbXVsdGlGYWN0b3IodXNlcikge1xyXG4gICAgY29uc3QgdXNlck1vZHVsYXIgPSBnZXRNb2R1bGFySW5zdGFuY2UodXNlcik7XHJcbiAgICBpZiAoIW11bHRpRmFjdG9yVXNlckNhY2hlLmhhcyh1c2VyTW9kdWxhcikpIHtcclxuICAgICAgICBtdWx0aUZhY3RvclVzZXJDYWNoZS5zZXQodXNlck1vZHVsYXIsIE11bHRpRmFjdG9yVXNlckltcGwuX2Zyb21Vc2VyKHVzZXJNb2R1bGFyKSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbXVsdGlGYWN0b3JVc2VyQ2FjaGUuZ2V0KHVzZXJNb2R1bGFyKTtcclxufVxuXG5jb25zdCBTVE9SQUdFX0FWQUlMQUJMRV9LRVkgPSAnX19zYWsnO1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vLyBUaGVyZSBhcmUgdHdvIGRpZmZlcmVudCBicm93c2VyIHBlcnNpc3RlbmNlIHR5cGVzOiBsb2NhbCBhbmQgc2Vzc2lvbi5cclxuLy8gQm90aCBoYXZlIHRoZSBzYW1lIGltcGxlbWVudGF0aW9uIGJ1dCB1c2UgYSBkaWZmZXJlbnQgdW5kZXJseWluZyBzdG9yYWdlXHJcbi8vIG9iamVjdC5cclxuY2xhc3MgQnJvd3NlclBlcnNpc3RlbmNlQ2xhc3Mge1xyXG4gICAgY29uc3RydWN0b3Ioc3RvcmFnZSwgdHlwZSkge1xyXG4gICAgICAgIHRoaXMuc3RvcmFnZSA9IHN0b3JhZ2U7XHJcbiAgICAgICAgdGhpcy50eXBlID0gdHlwZTtcclxuICAgIH1cclxuICAgIF9pc0F2YWlsYWJsZSgpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuc3RvcmFnZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShmYWxzZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5zdG9yYWdlLnNldEl0ZW0oU1RPUkFHRV9BVkFJTEFCTEVfS0VZLCAnMScpO1xyXG4gICAgICAgICAgICB0aGlzLnN0b3JhZ2UucmVtb3ZlSXRlbShTVE9SQUdFX0FWQUlMQUJMRV9LRVkpO1xyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoX2EpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShmYWxzZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgX3NldChrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5zdG9yYWdlLnNldEl0ZW0oa2V5LCBKU09OLnN0cmluZ2lmeSh2YWx1ZSkpO1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcclxuICAgIH1cclxuICAgIF9nZXQoa2V5KSB7XHJcbiAgICAgICAgY29uc3QganNvbiA9IHRoaXMuc3RvcmFnZS5nZXRJdGVtKGtleSk7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShqc29uID8gSlNPTi5wYXJzZShqc29uKSA6IG51bGwpO1xyXG4gICAgfVxyXG4gICAgX3JlbW92ZShrZXkpIHtcclxuICAgICAgICB0aGlzLnN0b3JhZ2UucmVtb3ZlSXRlbShrZXkpO1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5mdW5jdGlvbiBfaWZyYW1lQ2Fubm90U3luY1dlYlN0b3JhZ2UoKSB7XHJcbiAgICBjb25zdCB1YSA9IGdldFVBKCk7XHJcbiAgICByZXR1cm4gX2lzU2FmYXJpKHVhKSB8fCBfaXNJT1ModWEpO1xyXG59XHJcbi8vIFRoZSBwb2xsaW5nIHBlcmlvZCBpbiBjYXNlIGV2ZW50cyBhcmUgbm90IHN1cHBvcnRlZFxyXG5jb25zdCBfUE9MTElOR19JTlRFUlZBTF9NUyQxID0gMTAwMDtcclxuLy8gVGhlIElFIDEwIGxvY2FsU3RvcmFnZSBjcm9zcyB0YWIgc3luY2hyb25pemF0aW9uIGRlbGF5IGluIG1pbGxpc2Vjb25kc1xyXG5jb25zdCBJRTEwX0xPQ0FMX1NUT1JBR0VfU1lOQ19ERUxBWSA9IDEwO1xyXG5jbGFzcyBCcm93c2VyTG9jYWxQZXJzaXN0ZW5jZSBleHRlbmRzIEJyb3dzZXJQZXJzaXN0ZW5jZUNsYXNzIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHN1cGVyKHdpbmRvdy5sb2NhbFN0b3JhZ2UsIFwiTE9DQUxcIiAvKiBMT0NBTCAqLyk7XHJcbiAgICAgICAgdGhpcy5saXN0ZW5lcnMgPSB7fTtcclxuICAgICAgICB0aGlzLmxvY2FsQ2FjaGUgPSB7fTtcclxuICAgICAgICAvLyBzZXRUaW1lb3V0IHJldHVybiB2YWx1ZSBpcyBwbGF0Zm9ybSBzcGVjaWZpY1xyXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XHJcbiAgICAgICAgdGhpcy5wb2xsVGltZXIgPSBudWxsO1xyXG4gICAgICAgIC8vIFNhZmFyaSBvciBpT1MgYnJvd3NlciBhbmQgZW1iZWRkZWQgaW4gYW4gaWZyYW1lLlxyXG4gICAgICAgIHRoaXMuc2FmYXJpTG9jYWxTdG9yYWdlTm90U3luY2VkID0gX2lmcmFtZUNhbm5vdFN5bmNXZWJTdG9yYWdlKCkgJiYgX2lzSWZyYW1lKCk7XHJcbiAgICAgICAgLy8gV2hldGhlciB0byB1c2UgcG9sbGluZyBpbnN0ZWFkIG9mIGRlcGVuZGluZyBvbiB3aW5kb3cgZXZlbnRzXHJcbiAgICAgICAgdGhpcy5mYWxsYmFja1RvUG9sbGluZyA9IF9pc01vYmlsZUJyb3dzZXIoKTtcclxuICAgICAgICB0aGlzLl9zaG91bGRBbGxvd01pZ3JhdGlvbiA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5ib3VuZEV2ZW50SGFuZGxlciA9IHRoaXMub25TdG9yYWdlRXZlbnQuYmluZCh0aGlzKTtcclxuICAgIH1cclxuICAgIGZvckFsbENoYW5nZWRLZXlzKGNiKSB7XHJcbiAgICAgICAgLy8gQ2hlY2sgYWxsIGtleXMgd2l0aCBsaXN0ZW5lcnMgb24gdGhlbS5cclxuICAgICAgICBmb3IgKGNvbnN0IGtleSBvZiBPYmplY3Qua2V5cyh0aGlzLmxpc3RlbmVycykpIHtcclxuICAgICAgICAgICAgLy8gR2V0IHZhbHVlIGZyb20gbG9jYWxTdG9yYWdlLlxyXG4gICAgICAgICAgICBjb25zdCBuZXdWYWx1ZSA9IHRoaXMuc3RvcmFnZS5nZXRJdGVtKGtleSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG9sZFZhbHVlID0gdGhpcy5sb2NhbENhY2hlW2tleV07XHJcbiAgICAgICAgICAgIC8vIElmIGxvY2FsIG1hcCB2YWx1ZSBkb2VzIG5vdCBtYXRjaCwgdHJpZ2dlciBsaXN0ZW5lciB3aXRoIHN0b3JhZ2UgZXZlbnQuXHJcbiAgICAgICAgICAgIC8vIERpZmZlcmVudGlhdGUgdGhpcyBzaW11bGF0ZWQgZXZlbnQgZnJvbSB0aGUgcmVhbCBzdG9yYWdlIGV2ZW50LlxyXG4gICAgICAgICAgICBpZiAobmV3VmFsdWUgIT09IG9sZFZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICBjYihrZXksIG9sZFZhbHVlLCBuZXdWYWx1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBvblN0b3JhZ2VFdmVudChldmVudCwgcG9sbCA9IGZhbHNlKSB7XHJcbiAgICAgICAgLy8gS2V5IHdvdWxkIGJlIG51bGwgaW4gc29tZSBzaXR1YXRpb25zLCBsaWtlIHdoZW4gbG9jYWxTdG9yYWdlIGlzIGNsZWFyZWRcclxuICAgICAgICBpZiAoIWV2ZW50LmtleSkge1xyXG4gICAgICAgICAgICB0aGlzLmZvckFsbENoYW5nZWRLZXlzKChrZXksIF9vbGRWYWx1ZSwgbmV3VmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5TGlzdGVuZXJzKGtleSwgbmV3VmFsdWUpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBrZXkgPSBldmVudC5rZXk7XHJcbiAgICAgICAgLy8gQ2hlY2sgdGhlIG1lY2hhbmlzbSBob3cgdGhpcyBldmVudCB3YXMgZGV0ZWN0ZWQuXHJcbiAgICAgICAgLy8gVGhlIGZpcnN0IGV2ZW50IHdpbGwgZGljdGF0ZSB0aGUgbWVjaGFuaXNtIHRvIGJlIHVzZWQuXHJcbiAgICAgICAgaWYgKHBvbGwpIHtcclxuICAgICAgICAgICAgLy8gRW52aXJvbm1lbnQgZGV0ZWN0cyBzdG9yYWdlIGNoYW5nZXMgdmlhIHBvbGxpbmcuXHJcbiAgICAgICAgICAgIC8vIFJlbW92ZSBzdG9yYWdlIGV2ZW50IGxpc3RlbmVyIHRvIHByZXZlbnQgcG9zc2libGUgZXZlbnQgZHVwbGljYXRpb24uXHJcbiAgICAgICAgICAgIHRoaXMuZGV0YWNoTGlzdGVuZXIoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIEVudmlyb25tZW50IGRldGVjdHMgc3RvcmFnZSBjaGFuZ2VzIHZpYSBzdG9yYWdlIGV2ZW50IGxpc3RlbmVyLlxyXG4gICAgICAgICAgICAvLyBSZW1vdmUgcG9sbGluZyBsaXN0ZW5lciB0byBwcmV2ZW50IHBvc3NpYmxlIGV2ZW50IGR1cGxpY2F0aW9uLlxyXG4gICAgICAgICAgICB0aGlzLnN0b3BQb2xsaW5nKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFNhZmFyaSBlbWJlZGRlZCBpZnJhbWUuIFN0b3JhZ2UgZXZlbnQgd2lsbCB0cmlnZ2VyIHdpdGggdGhlIGRlbHRhXHJcbiAgICAgICAgLy8gY2hhbmdlcyBidXQgbm8gY2hhbmdlcyB3aWxsIGJlIGFwcGxpZWQgdG8gdGhlIGlmcmFtZSBsb2NhbFN0b3JhZ2UuXHJcbiAgICAgICAgaWYgKHRoaXMuc2FmYXJpTG9jYWxTdG9yYWdlTm90U3luY2VkKSB7XHJcbiAgICAgICAgICAgIC8vIEdldCBjdXJyZW50IGlmcmFtZSBwYWdlIHZhbHVlLlxyXG4gICAgICAgICAgICBjb25zdCBzdG9yZWRWYWx1ZSA9IHRoaXMuc3RvcmFnZS5nZXRJdGVtKGtleSk7XHJcbiAgICAgICAgICAgIC8vIFZhbHVlIG5vdCBzeW5jaHJvbml6ZWQsIHN5bmNocm9uaXplIG1hbnVhbGx5LlxyXG4gICAgICAgICAgICBpZiAoZXZlbnQubmV3VmFsdWUgIT09IHN0b3JlZFZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZXZlbnQubmV3VmFsdWUgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBWYWx1ZSBjaGFuZ2VkIGZyb20gY3VycmVudCB2YWx1ZS5cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0b3JhZ2Uuc2V0SXRlbShrZXksIGV2ZW50Lm5ld1ZhbHVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIEN1cnJlbnQgdmFsdWUgZGVsZXRlZC5cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0b3JhZ2UucmVtb3ZlSXRlbShrZXkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMubG9jYWxDYWNoZVtrZXldID09PSBldmVudC5uZXdWYWx1ZSAmJiAhcG9sbCkge1xyXG4gICAgICAgICAgICAgICAgLy8gQWxyZWFkeSBkZXRlY3RlZCBhbmQgcHJvY2Vzc2VkLCBkbyBub3QgdHJpZ2dlciBsaXN0ZW5lcnMgYWdhaW4uXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgdHJpZ2dlckxpc3RlbmVycyA9ICgpID0+IHtcclxuICAgICAgICAgICAgLy8gS2VlcCBsb2NhbCBtYXAgdXAgdG8gZGF0ZSBpbiBjYXNlIHN0b3JhZ2UgZXZlbnQgaXMgdHJpZ2dlcmVkIGJlZm9yZVxyXG4gICAgICAgICAgICAvLyBwb2xsLlxyXG4gICAgICAgICAgICBjb25zdCBzdG9yZWRWYWx1ZSA9IHRoaXMuc3RvcmFnZS5nZXRJdGVtKGtleSk7XHJcbiAgICAgICAgICAgIGlmICghcG9sbCAmJiB0aGlzLmxvY2FsQ2FjaGVba2V5XSA9PT0gc3RvcmVkVmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIC8vIFJlYWwgc3RvcmFnZSBldmVudCB3aGljaCBoYXMgYWxyZWFkeSBiZWVuIGRldGVjdGVkLCBkbyBub3RoaW5nLlxyXG4gICAgICAgICAgICAgICAgLy8gVGhpcyBzZWVtcyB0byB0cmlnZ2VyIGluIHNvbWUgSUUgYnJvd3NlcnMgZm9yIHNvbWUgcmVhc29uLlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMubm90aWZ5TGlzdGVuZXJzKGtleSwgc3RvcmVkVmFsdWUpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgY29uc3Qgc3RvcmVkVmFsdWUgPSB0aGlzLnN0b3JhZ2UuZ2V0SXRlbShrZXkpO1xyXG4gICAgICAgIGlmIChfaXNJRTEwKCkgJiZcclxuICAgICAgICAgICAgc3RvcmVkVmFsdWUgIT09IGV2ZW50Lm5ld1ZhbHVlICYmXHJcbiAgICAgICAgICAgIGV2ZW50Lm5ld1ZhbHVlICE9PSBldmVudC5vbGRWYWx1ZSkge1xyXG4gICAgICAgICAgICAvLyBJRSAxMCBoYXMgdGhpcyB3ZWlyZCBidWcgd2hlcmUgYSBzdG9yYWdlIGV2ZW50IHdvdWxkIHRyaWdnZXIgd2l0aCB0aGVcclxuICAgICAgICAgICAgLy8gY29ycmVjdCBrZXksIG9sZFZhbHVlIGFuZCBuZXdWYWx1ZSBidXQgbG9jYWxTdG9yYWdlLmdldEl0ZW0oa2V5KSBkb2VzXHJcbiAgICAgICAgICAgIC8vIG5vdCB5aWVsZCB0aGUgdXBkYXRlZCB2YWx1ZSB1bnRpbCBhIGZldyBtaWxsaXNlY29uZHMuIFRoaXMgZW5zdXJlc1xyXG4gICAgICAgICAgICAvLyB0aGlzIHJlY292ZXJzIGZyb20gdGhhdCBzaXR1YXRpb24uXHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQodHJpZ2dlckxpc3RlbmVycywgSUUxMF9MT0NBTF9TVE9SQUdFX1NZTkNfREVMQVkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdHJpZ2dlckxpc3RlbmVycygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIG5vdGlmeUxpc3RlbmVycyhrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5sb2NhbENhY2hlW2tleV0gPSB2YWx1ZTtcclxuICAgICAgICBjb25zdCBsaXN0ZW5lcnMgPSB0aGlzLmxpc3RlbmVyc1trZXldO1xyXG4gICAgICAgIGlmIChsaXN0ZW5lcnMpIHtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBsaXN0ZW5lciBvZiBBcnJheS5mcm9tKGxpc3RlbmVycykpIHtcclxuICAgICAgICAgICAgICAgIGxpc3RlbmVyKHZhbHVlID8gSlNPTi5wYXJzZSh2YWx1ZSkgOiB2YWx1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBzdGFydFBvbGxpbmcoKSB7XHJcbiAgICAgICAgdGhpcy5zdG9wUG9sbGluZygpO1xyXG4gICAgICAgIHRoaXMucG9sbFRpbWVyID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmZvckFsbENoYW5nZWRLZXlzKChrZXksIG9sZFZhbHVlLCBuZXdWYWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vblN0b3JhZ2VFdmVudChuZXcgU3RvcmFnZUV2ZW50KCdzdG9yYWdlJywge1xyXG4gICAgICAgICAgICAgICAgICAgIGtleSxcclxuICAgICAgICAgICAgICAgICAgICBvbGRWYWx1ZSxcclxuICAgICAgICAgICAgICAgICAgICBuZXdWYWx1ZVxyXG4gICAgICAgICAgICAgICAgfSksIFxyXG4gICAgICAgICAgICAgICAgLyogcG9sbCAqLyB0cnVlKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSwgX1BPTExJTkdfSU5URVJWQUxfTVMkMSk7XHJcbiAgICB9XHJcbiAgICBzdG9wUG9sbGluZygpIHtcclxuICAgICAgICBpZiAodGhpcy5wb2xsVGltZXIpIHtcclxuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnBvbGxUaW1lcik7XHJcbiAgICAgICAgICAgIHRoaXMucG9sbFRpbWVyID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBhdHRhY2hMaXN0ZW5lcigpIHtcclxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignc3RvcmFnZScsIHRoaXMuYm91bmRFdmVudEhhbmRsZXIpO1xyXG4gICAgfVxyXG4gICAgZGV0YWNoTGlzdGVuZXIoKSB7XHJcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3N0b3JhZ2UnLCB0aGlzLmJvdW5kRXZlbnRIYW5kbGVyKTtcclxuICAgIH1cclxuICAgIF9hZGRMaXN0ZW5lcihrZXksIGxpc3RlbmVyKSB7XHJcbiAgICAgICAgaWYgKE9iamVjdC5rZXlzKHRoaXMubGlzdGVuZXJzKS5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgLy8gV2hldGhlciBicm93c2VyIGNhbiBkZXRlY3Qgc3RvcmFnZSBldmVudCB3aGVuIGl0IGhhZCBhbHJlYWR5IGJlZW4gcHVzaGVkIHRvIHRoZSBiYWNrZ3JvdW5kLlxyXG4gICAgICAgICAgICAvLyBUaGlzIG1heSBoYXBwZW4gaW4gc29tZSBtb2JpbGUgYnJvd3NlcnMuIEEgbG9jYWxTdG9yYWdlIGNoYW5nZSBpbiB0aGUgZm9yZWdyb3VuZCB3aW5kb3dcclxuICAgICAgICAgICAgLy8gd2lsbCBub3QgYmUgZGV0ZWN0ZWQgaW4gdGhlIGJhY2tncm91bmQgd2luZG93IHZpYSB0aGUgc3RvcmFnZSBldmVudC5cclxuICAgICAgICAgICAgLy8gVGhpcyB3YXMgZGV0ZWN0ZWQgaW4gaU9TIDcueCBtb2JpbGUgYnJvd3NlcnNcclxuICAgICAgICAgICAgaWYgKHRoaXMuZmFsbGJhY2tUb1BvbGxpbmcpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RhcnRQb2xsaW5nKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmF0dGFjaExpc3RlbmVyKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0aGlzLmxpc3RlbmVyc1trZXldKSB7XHJcbiAgICAgICAgICAgIHRoaXMubGlzdGVuZXJzW2tleV0gPSBuZXcgU2V0KCk7XHJcbiAgICAgICAgICAgIC8vIFBvcHVsYXRlIHRoZSBjYWNoZSB0byBhdm9pZCBzcHVyaW91c2x5IHRyaWdnZXJpbmcgb24gZmlyc3QgcG9sbC5cclxuICAgICAgICAgICAgdGhpcy5sb2NhbENhY2hlW2tleV0gPSB0aGlzLnN0b3JhZ2UuZ2V0SXRlbShrZXkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmxpc3RlbmVyc1trZXldLmFkZChsaXN0ZW5lcik7XHJcbiAgICB9XHJcbiAgICBfcmVtb3ZlTGlzdGVuZXIoa2V5LCBsaXN0ZW5lcikge1xyXG4gICAgICAgIGlmICh0aGlzLmxpc3RlbmVyc1trZXldKSB7XHJcbiAgICAgICAgICAgIHRoaXMubGlzdGVuZXJzW2tleV0uZGVsZXRlKGxpc3RlbmVyKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMubGlzdGVuZXJzW2tleV0uc2l6ZSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMubGlzdGVuZXJzW2tleV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKE9iamVjdC5rZXlzKHRoaXMubGlzdGVuZXJzKS5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgdGhpcy5kZXRhY2hMaXN0ZW5lcigpO1xyXG4gICAgICAgICAgICB0aGlzLnN0b3BQb2xsaW5nKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8gVXBkYXRlIGxvY2FsIGNhY2hlIG9uIGJhc2Ugb3BlcmF0aW9uczpcclxuICAgIGFzeW5jIF9zZXQoa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgIGF3YWl0IHN1cGVyLl9zZXQoa2V5LCB2YWx1ZSk7XHJcbiAgICAgICAgdGhpcy5sb2NhbENhY2hlW2tleV0gPSBKU09OLnN0cmluZ2lmeSh2YWx1ZSk7XHJcbiAgICB9XHJcbiAgICBhc3luYyBfZ2V0KGtleSkge1xyXG4gICAgICAgIGNvbnN0IHZhbHVlID0gYXdhaXQgc3VwZXIuX2dldChrZXkpO1xyXG4gICAgICAgIHRoaXMubG9jYWxDYWNoZVtrZXldID0gSlNPTi5zdHJpbmdpZnkodmFsdWUpO1xyXG4gICAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgIH1cclxuICAgIGFzeW5jIF9yZW1vdmUoa2V5KSB7XHJcbiAgICAgICAgYXdhaXQgc3VwZXIuX3JlbW92ZShrZXkpO1xyXG4gICAgICAgIGRlbGV0ZSB0aGlzLmxvY2FsQ2FjaGVba2V5XTtcclxuICAgIH1cclxufVxyXG5Ccm93c2VyTG9jYWxQZXJzaXN0ZW5jZS50eXBlID0gJ0xPQ0FMJztcclxuLyoqXHJcbiAqIEFuIGltcGxlbWVudGF0aW9uIG9mIHtAbGluayBQZXJzaXN0ZW5jZX0gb2YgdHlwZSBgTE9DQUxgIHVzaW5nIGBsb2NhbFN0b3JhZ2VgXHJcbiAqIGZvciB0aGUgdW5kZXJseWluZyBzdG9yYWdlLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5jb25zdCBicm93c2VyTG9jYWxQZXJzaXN0ZW5jZSA9IEJyb3dzZXJMb2NhbFBlcnNpc3RlbmNlO1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jbGFzcyBCcm93c2VyU2Vzc2lvblBlcnNpc3RlbmNlIGV4dGVuZHMgQnJvd3NlclBlcnNpc3RlbmNlQ2xhc3Mge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIod2luZG93LnNlc3Npb25TdG9yYWdlLCBcIlNFU1NJT05cIiAvKiBTRVNTSU9OICovKTtcclxuICAgIH1cclxuICAgIF9hZGRMaXN0ZW5lcihfa2V5LCBfbGlzdGVuZXIpIHtcclxuICAgICAgICAvLyBMaXN0ZW5lcnMgYXJlIG5vdCBzdXBwb3J0ZWQgZm9yIHNlc3Npb24gc3RvcmFnZSBzaW5jZSBpdCBjYW5ub3QgYmUgc2hhcmVkIGFjcm9zcyB3aW5kb3dzXHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgX3JlbW92ZUxpc3RlbmVyKF9rZXksIF9saXN0ZW5lcikge1xyXG4gICAgICAgIC8vIExpc3RlbmVycyBhcmUgbm90IHN1cHBvcnRlZCBmb3Igc2Vzc2lvbiBzdG9yYWdlIHNpbmNlIGl0IGNhbm5vdCBiZSBzaGFyZWQgYWNyb3NzIHdpbmRvd3NcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbn1cclxuQnJvd3NlclNlc3Npb25QZXJzaXN0ZW5jZS50eXBlID0gJ1NFU1NJT04nO1xyXG4vKipcclxuICogQW4gaW1wbGVtZW50YXRpb24gb2Yge0BsaW5rIFBlcnNpc3RlbmNlfSBvZiBgU0VTU0lPTmAgdXNpbmcgYHNlc3Npb25TdG9yYWdlYFxyXG4gKiBmb3IgdGhlIHVuZGVybHlpbmcgc3RvcmFnZS5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuY29uc3QgYnJvd3NlclNlc3Npb25QZXJzaXN0ZW5jZSA9IEJyb3dzZXJTZXNzaW9uUGVyc2lzdGVuY2U7XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBTaGltIGZvciBQcm9taXNlLmFsbFNldHRsZWQsIG5vdGUgdGhlIHNsaWdodGx5IGRpZmZlcmVudCBmb3JtYXQgb2YgYGZ1bGZpbGxlZGAgdnMgYHN0YXR1c2AuXHJcbiAqXHJcbiAqIEBwYXJhbSBwcm9taXNlcyAtIEFycmF5IG9mIHByb21pc2VzIHRvIHdhaXQgb24uXHJcbiAqL1xyXG5mdW5jdGlvbiBfYWxsU2V0dGxlZChwcm9taXNlcykge1xyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKHByb21pc2VzLm1hcChhc3luYyAocHJvbWlzZSkgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gYXdhaXQgcHJvbWlzZTtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGZ1bGZpbGxlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIHZhbHVlXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChyZWFzb24pIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIGZ1bGZpbGxlZDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICByZWFzb25cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICB9KSk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEludGVyZmFjZSBjbGFzcyBmb3IgcmVjZWl2aW5nIG1lc3NhZ2VzLlxyXG4gKlxyXG4gKi9cclxuY2xhc3MgUmVjZWl2ZXIge1xyXG4gICAgY29uc3RydWN0b3IoZXZlbnRUYXJnZXQpIHtcclxuICAgICAgICB0aGlzLmV2ZW50VGFyZ2V0ID0gZXZlbnRUYXJnZXQ7XHJcbiAgICAgICAgdGhpcy5oYW5kbGVyc01hcCA9IHt9O1xyXG4gICAgICAgIHRoaXMuYm91bmRFdmVudEhhbmRsZXIgPSB0aGlzLmhhbmRsZUV2ZW50LmJpbmQodGhpcyk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIE9idGFpbiBhbiBpbnN0YW5jZSBvZiBhIFJlY2VpdmVyIGZvciBhIGdpdmVuIGV2ZW50IHRhcmdldCwgaWYgbm9uZSBleGlzdHMgaXQgd2lsbCBiZSBjcmVhdGVkLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBldmVudFRhcmdldCAtIEFuIGV2ZW50IHRhcmdldCAoc3VjaCBhcyB3aW5kb3cgb3Igc2VsZikgdGhyb3VnaCB3aGljaCB0aGUgdW5kZXJseWluZ1xyXG4gICAgICogbWVzc2FnZXMgd2lsbCBiZSByZWNlaXZlZC5cclxuICAgICAqL1xyXG4gICAgc3RhdGljIF9nZXRJbnN0YW5jZShldmVudFRhcmdldCkge1xyXG4gICAgICAgIC8vIFRoZSByZXN1bHRzIGFyZSBzdG9yZWQgaW4gYW4gYXJyYXkgc2luY2Ugb2JqZWN0cyBjYW4ndCBiZSBrZXlzIGZvciBvdGhlclxyXG4gICAgICAgIC8vIG9iamVjdHMuIEluIGFkZGl0aW9uLCBzZXR0aW5nIGEgdW5pcXVlIHByb3BlcnR5IG9uIGFuIGV2ZW50IHRhcmdldCBhcyBhXHJcbiAgICAgICAgLy8gaGFzaCBtYXAga2V5IG1heSBub3QgYmUgYWxsb3dlZCBkdWUgdG8gQ09SUyByZXN0cmljdGlvbnMuXHJcbiAgICAgICAgY29uc3QgZXhpc3RpbmdJbnN0YW5jZSA9IHRoaXMucmVjZWl2ZXJzLmZpbmQocmVjZWl2ZXIgPT4gcmVjZWl2ZXIuaXNMaXN0ZW5pbmd0byhldmVudFRhcmdldCkpO1xyXG4gICAgICAgIGlmIChleGlzdGluZ0luc3RhbmNlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBleGlzdGluZ0luc3RhbmNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBuZXdJbnN0YW5jZSA9IG5ldyBSZWNlaXZlcihldmVudFRhcmdldCk7XHJcbiAgICAgICAgdGhpcy5yZWNlaXZlcnMucHVzaChuZXdJbnN0YW5jZSk7XHJcbiAgICAgICAgcmV0dXJuIG5ld0luc3RhbmNlO1xyXG4gICAgfVxyXG4gICAgaXNMaXN0ZW5pbmd0byhldmVudFRhcmdldCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmV2ZW50VGFyZ2V0ID09PSBldmVudFRhcmdldDtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogRmFucyBvdXQgYSBNZXNzYWdlRXZlbnQgdG8gdGhlIGFwcHJvcHJpYXRlIGxpc3RlbmVycy5cclxuICAgICAqXHJcbiAgICAgKiBAcmVtYXJrc1xyXG4gICAgICogU2VuZHMgYW4ge0BsaW5rIFN0YXR1cy5BQ0t9IHVwb24gcmVjZWlwdCBhbmQgYSB7QGxpbmsgU3RhdHVzLkRPTkV9IG9uY2UgYWxsIGhhbmRsZXJzIGhhdmVcclxuICAgICAqIGZpbmlzaGVkIHByb2Nlc3NpbmcuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGV2ZW50IC0gVGhlIE1lc3NhZ2VFdmVudC5cclxuICAgICAqXHJcbiAgICAgKi9cclxuICAgIGFzeW5jIGhhbmRsZUV2ZW50KGV2ZW50KSB7XHJcbiAgICAgICAgY29uc3QgbWVzc2FnZUV2ZW50ID0gZXZlbnQ7XHJcbiAgICAgICAgY29uc3QgeyBldmVudElkLCBldmVudFR5cGUsIGRhdGEgfSA9IG1lc3NhZ2VFdmVudC5kYXRhO1xyXG4gICAgICAgIGNvbnN0IGhhbmRsZXJzID0gdGhpcy5oYW5kbGVyc01hcFtldmVudFR5cGVdO1xyXG4gICAgICAgIGlmICghKGhhbmRsZXJzID09PSBudWxsIHx8IGhhbmRsZXJzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBoYW5kbGVycy5zaXplKSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIG1lc3NhZ2VFdmVudC5wb3J0c1swXS5wb3N0TWVzc2FnZSh7XHJcbiAgICAgICAgICAgIHN0YXR1czogXCJhY2tcIiAvKiBBQ0sgKi8sXHJcbiAgICAgICAgICAgIGV2ZW50SWQsXHJcbiAgICAgICAgICAgIGV2ZW50VHlwZVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNvbnN0IHByb21pc2VzID0gQXJyYXkuZnJvbShoYW5kbGVycykubWFwKGFzeW5jIChoYW5kbGVyKSA9PiBoYW5kbGVyKG1lc3NhZ2VFdmVudC5vcmlnaW4sIGRhdGEpKTtcclxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IF9hbGxTZXR0bGVkKHByb21pc2VzKTtcclxuICAgICAgICBtZXNzYWdlRXZlbnQucG9ydHNbMF0ucG9zdE1lc3NhZ2Uoe1xyXG4gICAgICAgICAgICBzdGF0dXM6IFwiZG9uZVwiIC8qIERPTkUgKi8sXHJcbiAgICAgICAgICAgIGV2ZW50SWQsXHJcbiAgICAgICAgICAgIGV2ZW50VHlwZSxcclxuICAgICAgICAgICAgcmVzcG9uc2VcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogU3Vic2NyaWJlIGFuIGV2ZW50IGhhbmRsZXIgZm9yIGEgcGFydGljdWxhciBldmVudC5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gZXZlbnRUeXBlIC0gRXZlbnQgbmFtZSB0byBzdWJzY3JpYmUgdG8uXHJcbiAgICAgKiBAcGFyYW0gZXZlbnRIYW5kbGVyIC0gVGhlIGV2ZW50IGhhbmRsZXIgd2hpY2ggc2hvdWxkIHJlY2VpdmUgdGhlIGV2ZW50cy5cclxuICAgICAqXHJcbiAgICAgKi9cclxuICAgIF9zdWJzY3JpYmUoZXZlbnRUeXBlLCBldmVudEhhbmRsZXIpIHtcclxuICAgICAgICBpZiAoT2JqZWN0LmtleXModGhpcy5oYW5kbGVyc01hcCkubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZXZlbnRUYXJnZXQuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIHRoaXMuYm91bmRFdmVudEhhbmRsZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXRoaXMuaGFuZGxlcnNNYXBbZXZlbnRUeXBlXSkge1xyXG4gICAgICAgICAgICB0aGlzLmhhbmRsZXJzTWFwW2V2ZW50VHlwZV0gPSBuZXcgU2V0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaGFuZGxlcnNNYXBbZXZlbnRUeXBlXS5hZGQoZXZlbnRIYW5kbGVyKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogVW5zdWJzY3JpYmUgYW4gZXZlbnQgaGFuZGxlciBmcm9tIGEgcGFydGljdWxhciBldmVudC5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gZXZlbnRUeXBlIC0gRXZlbnQgbmFtZSB0byB1bnN1YnNjcmliZSBmcm9tLlxyXG4gICAgICogQHBhcmFtIGV2ZW50SGFuZGxlciAtIE9wdGlub2FsIGV2ZW50IGhhbmRsZXIsIGlmIG5vbmUgcHJvdmlkZWQsIHVuc3Vic2NyaWJlIGFsbCBoYW5kbGVycyBvbiB0aGlzIGV2ZW50LlxyXG4gICAgICpcclxuICAgICAqL1xyXG4gICAgX3Vuc3Vic2NyaWJlKGV2ZW50VHlwZSwgZXZlbnRIYW5kbGVyKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaGFuZGxlcnNNYXBbZXZlbnRUeXBlXSAmJiBldmVudEhhbmRsZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5oYW5kbGVyc01hcFtldmVudFR5cGVdLmRlbGV0ZShldmVudEhhbmRsZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIWV2ZW50SGFuZGxlciB8fCB0aGlzLmhhbmRsZXJzTWFwW2V2ZW50VHlwZV0uc2l6ZSA9PT0gMCkge1xyXG4gICAgICAgICAgICBkZWxldGUgdGhpcy5oYW5kbGVyc01hcFtldmVudFR5cGVdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoT2JqZWN0LmtleXModGhpcy5oYW5kbGVyc01hcCkubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZXZlbnRUYXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIHRoaXMuYm91bmRFdmVudEhhbmRsZXIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5SZWNlaXZlci5yZWNlaXZlcnMgPSBbXTtcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuZnVuY3Rpb24gX2dlbmVyYXRlRXZlbnRJZChwcmVmaXggPSAnJywgZGlnaXRzID0gMTApIHtcclxuICAgIGxldCByYW5kb20gPSAnJztcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGlnaXRzOyBpKyspIHtcclxuICAgICAgICByYW5kb20gKz0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHByZWZpeCArIHJhbmRvbTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogSW50ZXJmYWNlIGZvciBzZW5kaW5nIG1lc3NhZ2VzIGFuZCB3YWl0aW5nIGZvciBhIGNvbXBsZXRpb24gcmVzcG9uc2UuXHJcbiAqXHJcbiAqL1xyXG5jbGFzcyBTZW5kZXIge1xyXG4gICAgY29uc3RydWN0b3IodGFyZ2V0KSB7XHJcbiAgICAgICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7XHJcbiAgICAgICAgdGhpcy5oYW5kbGVycyA9IG5ldyBTZXQoKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogVW5zdWJzY3JpYmUgdGhlIGhhbmRsZXIgYW5kIHJlbW92ZSBpdCBmcm9tIG91ciB0cmFja2luZyBTZXQuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGhhbmRsZXIgLSBUaGUgaGFuZGxlciB0byB1bnN1YnNjcmliZS5cclxuICAgICAqL1xyXG4gICAgcmVtb3ZlTWVzc2FnZUhhbmRsZXIoaGFuZGxlcikge1xyXG4gICAgICAgIGlmIChoYW5kbGVyLm1lc3NhZ2VDaGFubmVsKSB7XHJcbiAgICAgICAgICAgIGhhbmRsZXIubWVzc2FnZUNoYW5uZWwucG9ydDEucmVtb3ZlRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGhhbmRsZXIub25NZXNzYWdlKTtcclxuICAgICAgICAgICAgaGFuZGxlci5tZXNzYWdlQ2hhbm5lbC5wb3J0MS5jbG9zZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmhhbmRsZXJzLmRlbGV0ZShoYW5kbGVyKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogU2VuZCBhIG1lc3NhZ2UgdG8gdGhlIFJlY2VpdmVyIGxvY2F0ZWQgYXQge0BsaW5rIHRhcmdldH0uXHJcbiAgICAgKlxyXG4gICAgICogQHJlbWFya3NcclxuICAgICAqIFdlJ2xsIGZpcnN0IHdhaXQgYSBiaXQgZm9yIGFuIEFDSyAsIGlmIHdlIGdldCBvbmUgd2Ugd2lsbCB3YWl0IHNpZ25pZmljYW50bHkgbG9uZ2VyIHVudGlsIHRoZVxyXG4gICAgICogcmVjZWl2ZXIgaGFzIGhhZCBhIGNoYW5jZSB0byBmdWxseSBwcm9jZXNzIHRoZSBldmVudC5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gZXZlbnRUeXBlIC0gVHlwZSBvZiBldmVudCB0byBzZW5kLlxyXG4gICAgICogQHBhcmFtIGRhdGEgLSBUaGUgcGF5bG9hZCBvZiB0aGUgZXZlbnQuXHJcbiAgICAgKiBAcGFyYW0gdGltZW91dCAtIFRpbWVvdXQgZm9yIHdhaXRpbmcgb24gYW4gQUNLIGZyb20gdGhlIHJlY2VpdmVyLlxyXG4gICAgICpcclxuICAgICAqIEByZXR1cm5zIEFuIGFycmF5IG9mIHNldHRsZWQgcHJvbWlzZXMgZnJvbSBhbGwgdGhlIGhhbmRsZXJzIHRoYXQgd2VyZSBsaXN0ZW5pbmcgb24gdGhlIHJlY2VpdmVyLlxyXG4gICAgICovXHJcbiAgICBhc3luYyBfc2VuZChldmVudFR5cGUsIGRhdGEsIHRpbWVvdXQgPSA1MCAvKiBBQ0sgKi8pIHtcclxuICAgICAgICBjb25zdCBtZXNzYWdlQ2hhbm5lbCA9IHR5cGVvZiBNZXNzYWdlQ2hhbm5lbCAhPT0gJ3VuZGVmaW5lZCcgPyBuZXcgTWVzc2FnZUNoYW5uZWwoKSA6IG51bGw7XHJcbiAgICAgICAgaWYgKCFtZXNzYWdlQ2hhbm5lbCkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJjb25uZWN0aW9uX3VuYXZhaWxhYmxlXCIgLyogQ09OTkVDVElPTl9VTkFWQUlMQUJMRSAqLyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIE5vZGUgdGltZXJzIGFuZCBicm93c2VyIHRpbWVycyByZXR1cm4gZnVuZGFtZW50YWxseSBkaWZmZXJlbnQgdHlwZXMuXHJcbiAgICAgICAgLy8gV2UgZG9uJ3QgYWN0dWFsbHkgY2FyZSB3aGF0IHRoZSB2YWx1ZSBpcyBidXQgVFMgd29uJ3QgYWNjZXB0IHVua25vd24gYW5kXHJcbiAgICAgICAgLy8gd2UgY2FuJ3QgY2FzdCBwcm9wZXJseSBpbiBib3RoIGVudmlyb25tZW50cy5cclxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxyXG4gICAgICAgIGxldCBjb21wbGV0aW9uVGltZXI7XHJcbiAgICAgICAgbGV0IGhhbmRsZXI7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZXZlbnRJZCA9IF9nZW5lcmF0ZUV2ZW50SWQoJycsIDIwKTtcclxuICAgICAgICAgICAgbWVzc2FnZUNoYW5uZWwucG9ydDEuc3RhcnQoKTtcclxuICAgICAgICAgICAgY29uc3QgYWNrVGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoXCJ1bnN1cHBvcnRlZF9ldmVudFwiIC8qIFVOU1VQUE9SVEVEX0VWRU5UICovKSk7XHJcbiAgICAgICAgICAgIH0sIHRpbWVvdXQpO1xyXG4gICAgICAgICAgICBoYW5kbGVyID0ge1xyXG4gICAgICAgICAgICAgICAgbWVzc2FnZUNoYW5uZWwsXHJcbiAgICAgICAgICAgICAgICBvbk1lc3NhZ2UoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBtZXNzYWdlRXZlbnQgPSBldmVudDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobWVzc2FnZUV2ZW50LmRhdGEuZXZlbnRJZCAhPT0gZXZlbnRJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAobWVzc2FnZUV2ZW50LmRhdGEuc3RhdHVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJhY2tcIiAvKiBBQ0sgKi86XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGUgcmVjZWl2ZXIgc2hvdWxkIEFDSyBmaXJzdC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dChhY2tUaW1lcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wbGV0aW9uVGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QobmV3IEVycm9yKFwidGltZW91dFwiIC8qIFRJTUVPVVQgKi8pKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDMwMDAgLyogQ09NUExFVElPTiAqLyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImRvbmVcIiAvKiBET05FICovOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gT25jZSB0aGUgcmVjZWl2ZXIncyBoYW5kbGVycyBhcmUgZmluaXNoZWQgd2Ugd2lsbCBnZXQgdGhlIHJlc3VsdHMuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQoY29tcGxldGlvblRpbWVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUobWVzc2FnZUV2ZW50LmRhdGEucmVzcG9uc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQoYWNrVGltZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KGNvbXBsZXRpb25UaW1lcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QobmV3IEVycm9yKFwiaW52YWxpZF9yZXNwb25zZVwiIC8qIElOVkFMSURfUkVTUE9OU0UgKi8pKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy5oYW5kbGVycy5hZGQoaGFuZGxlcik7XHJcbiAgICAgICAgICAgIG1lc3NhZ2VDaGFubmVsLnBvcnQxLmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBoYW5kbGVyLm9uTWVzc2FnZSk7XHJcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0LnBvc3RNZXNzYWdlKHtcclxuICAgICAgICAgICAgICAgIGV2ZW50VHlwZSxcclxuICAgICAgICAgICAgICAgIGV2ZW50SWQsXHJcbiAgICAgICAgICAgICAgICBkYXRhXHJcbiAgICAgICAgICAgIH0sIFttZXNzYWdlQ2hhbm5lbC5wb3J0Ml0pO1xyXG4gICAgICAgIH0pLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoaGFuZGxlcikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVNZXNzYWdlSGFuZGxlcihoYW5kbGVyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBMYXp5IGFjY2Vzc29yIGZvciB3aW5kb3csIHNpbmNlIHRoZSBjb21wYXQgbGF5ZXIgd29uJ3QgdHJlZSBzaGFrZSB0aGlzIG91dCxcclxuICogd2UgbmVlZCB0byBtYWtlIHN1cmUgbm90IHRvIG1lc3Mgd2l0aCB3aW5kb3cgdW5sZXNzIHdlIGhhdmUgdG9cclxuICovXHJcbmZ1bmN0aW9uIF93aW5kb3coKSB7XHJcbiAgICByZXR1cm4gd2luZG93O1xyXG59XHJcbmZ1bmN0aW9uIF9zZXRXaW5kb3dMb2NhdGlvbih1cmwpIHtcclxuICAgIF93aW5kb3coKS5sb2NhdGlvbi5ocmVmID0gdXJsO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5mdW5jdGlvbiBfaXNXb3JrZXIoKSB7XHJcbiAgICByZXR1cm4gKHR5cGVvZiBfd2luZG93KClbJ1dvcmtlckdsb2JhbFNjb3BlJ10gIT09ICd1bmRlZmluZWQnICYmXHJcbiAgICAgICAgdHlwZW9mIF93aW5kb3coKVsnaW1wb3J0U2NyaXB0cyddID09PSAnZnVuY3Rpb24nKTtcclxufVxyXG5hc3luYyBmdW5jdGlvbiBfZ2V0QWN0aXZlU2VydmljZVdvcmtlcigpIHtcclxuICAgIGlmICghKG5hdmlnYXRvciA9PT0gbnVsbCB8fCBuYXZpZ2F0b3IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyKSkge1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZWdpc3RyYXRpb24gPSBhd2FpdCBuYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5yZWFkeTtcclxuICAgICAgICByZXR1cm4gcmVnaXN0cmF0aW9uLmFjdGl2ZTtcclxuICAgIH1cclxuICAgIGNhdGNoIChfYSkge1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIF9nZXRTZXJ2aWNlV29ya2VyQ29udHJvbGxlcigpIHtcclxuICAgIHZhciBfYTtcclxuICAgIHJldHVybiAoKF9hID0gbmF2aWdhdG9yID09PSBudWxsIHx8IG5hdmlnYXRvciA9PT0gdm9pZCAwID8gdm9pZCAwIDogbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5jb250cm9sbGVyKSB8fCBudWxsO1xyXG59XHJcbmZ1bmN0aW9uIF9nZXRXb3JrZXJHbG9iYWxTY29wZSgpIHtcclxuICAgIHJldHVybiBfaXNXb3JrZXIoKSA/IHNlbGYgOiBudWxsO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmNvbnN0IERCX05BTUUgPSAnZmlyZWJhc2VMb2NhbFN0b3JhZ2VEYic7XHJcbmNvbnN0IERCX1ZFUlNJT04gPSAxO1xyXG5jb25zdCBEQl9PQkpFQ1RTVE9SRV9OQU1FID0gJ2ZpcmViYXNlTG9jYWxTdG9yYWdlJztcclxuY29uc3QgREJfREFUQV9LRVlQQVRIID0gJ2ZiYXNlX2tleSc7XHJcbi8qKlxyXG4gKiBQcm9taXNlIHdyYXBwZXIgZm9yIElEQlJlcXVlc3RcclxuICpcclxuICogVW5mb3J0dW5hdGVseSB3ZSBjYW4ndCBjbGVhbmx5IGV4dGVuZCBQcm9taXNlPFQ+IHNpbmNlIHByb21pc2VzIGFyZSBub3QgY2FsbGFibGUgaW4gRVM2XHJcbiAqXHJcbiAqL1xyXG5jbGFzcyBEQlByb21pc2Uge1xyXG4gICAgY29uc3RydWN0b3IocmVxdWVzdCkge1xyXG4gICAgICAgIHRoaXMucmVxdWVzdCA9IHJlcXVlc3Q7XHJcbiAgICB9XHJcbiAgICB0b1Byb21pc2UoKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5yZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Y2Nlc3MnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKHRoaXMucmVxdWVzdC5yZXN1bHQpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5yZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmVqZWN0KHRoaXMucmVxdWVzdC5lcnJvcik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGdldE9iamVjdFN0b3JlKGRiLCBpc1JlYWRXcml0ZSkge1xyXG4gICAgcmV0dXJuIGRiXHJcbiAgICAgICAgLnRyYW5zYWN0aW9uKFtEQl9PQkpFQ1RTVE9SRV9OQU1FXSwgaXNSZWFkV3JpdGUgPyAncmVhZHdyaXRlJyA6ICdyZWFkb25seScpXHJcbiAgICAgICAgLm9iamVjdFN0b3JlKERCX09CSkVDVFNUT1JFX05BTUUpO1xyXG59XHJcbmZ1bmN0aW9uIF9kZWxldGVEYXRhYmFzZSgpIHtcclxuICAgIGNvbnN0IHJlcXVlc3QgPSBpbmRleGVkREIuZGVsZXRlRGF0YWJhc2UoREJfTkFNRSk7XHJcbiAgICByZXR1cm4gbmV3IERCUHJvbWlzZShyZXF1ZXN0KS50b1Byb21pc2UoKTtcclxufVxyXG5mdW5jdGlvbiBfb3BlbkRhdGFiYXNlKCkge1xyXG4gICAgY29uc3QgcmVxdWVzdCA9IGluZGV4ZWREQi5vcGVuKERCX05BTUUsIERCX1ZFUlNJT04pO1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICByZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgKCkgPT4ge1xyXG4gICAgICAgICAgICByZWplY3QocmVxdWVzdC5lcnJvcik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCd1cGdyYWRlbmVlZGVkJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBkYiA9IHJlcXVlc3QucmVzdWx0O1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgZGIuY3JlYXRlT2JqZWN0U3RvcmUoREJfT0JKRUNUU1RPUkVfTkFNRSwgeyBrZXlQYXRoOiBEQl9EQVRBX0tFWVBBVEggfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgIHJlamVjdChlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJlcXVlc3QuYWRkRXZlbnRMaXN0ZW5lcignc3VjY2VzcycsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZGIgPSByZXF1ZXN0LnJlc3VsdDtcclxuICAgICAgICAgICAgLy8gU3RyYW5nZSBidWcgdGhhdCBvY2N1cnMgaW4gRmlyZWZveCB3aGVuIG11bHRpcGxlIHRhYnMgYXJlIG9wZW5lZCBhdCB0aGVcclxuICAgICAgICAgICAgLy8gc2FtZSB0aW1lLiBUaGUgb25seSB3YXkgdG8gcmVjb3ZlciBzZWVtcyB0byBiZSBkZWxldGluZyB0aGUgZGF0YWJhc2VcclxuICAgICAgICAgICAgLy8gYW5kIHJlLWluaXRpYWxpemluZyBpdC5cclxuICAgICAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2ZpcmViYXNlL2ZpcmViYXNlLWpzLXNkay9pc3N1ZXMvNjM0XHJcbiAgICAgICAgICAgIGlmICghZGIub2JqZWN0U3RvcmVOYW1lcy5jb250YWlucyhEQl9PQkpFQ1RTVE9SRV9OQU1FKSkge1xyXG4gICAgICAgICAgICAgICAgLy8gTmVlZCB0byBjbG9zZSB0aGUgZGF0YWJhc2Ugb3IgZWxzZSB5b3UgZ2V0IGEgYGJsb2NrZWRgIGV2ZW50XHJcbiAgICAgICAgICAgICAgICBkYi5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgX2RlbGV0ZURhdGFiYXNlKCk7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKGF3YWl0IF9vcGVuRGF0YWJhc2UoKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKGRiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn1cclxuYXN5bmMgZnVuY3Rpb24gX3B1dE9iamVjdChkYiwga2V5LCB2YWx1ZSkge1xyXG4gICAgY29uc3QgcmVxdWVzdCA9IGdldE9iamVjdFN0b3JlKGRiLCB0cnVlKS5wdXQoe1xyXG4gICAgICAgIFtEQl9EQVRBX0tFWVBBVEhdOiBrZXksXHJcbiAgICAgICAgdmFsdWVcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIG5ldyBEQlByb21pc2UocmVxdWVzdCkudG9Qcm9taXNlKCk7XHJcbn1cclxuYXN5bmMgZnVuY3Rpb24gZ2V0T2JqZWN0KGRiLCBrZXkpIHtcclxuICAgIGNvbnN0IHJlcXVlc3QgPSBnZXRPYmplY3RTdG9yZShkYiwgZmFsc2UpLmdldChrZXkpO1xyXG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IG5ldyBEQlByb21pc2UocmVxdWVzdCkudG9Qcm9taXNlKCk7XHJcbiAgICByZXR1cm4gZGF0YSA9PT0gdW5kZWZpbmVkID8gbnVsbCA6IGRhdGEudmFsdWU7XHJcbn1cclxuZnVuY3Rpb24gX2RlbGV0ZU9iamVjdChkYiwga2V5KSB7XHJcbiAgICBjb25zdCByZXF1ZXN0ID0gZ2V0T2JqZWN0U3RvcmUoZGIsIHRydWUpLmRlbGV0ZShrZXkpO1xyXG4gICAgcmV0dXJuIG5ldyBEQlByb21pc2UocmVxdWVzdCkudG9Qcm9taXNlKCk7XHJcbn1cclxuY29uc3QgX1BPTExJTkdfSU5URVJWQUxfTVMgPSA4MDA7XHJcbmNvbnN0IF9UUkFOU0FDVElPTl9SRVRSWV9DT1VOVCA9IDM7XHJcbmNsYXNzIEluZGV4ZWREQkxvY2FsUGVyc2lzdGVuY2Uge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgdGhpcy50eXBlID0gXCJMT0NBTFwiIC8qIExPQ0FMICovO1xyXG4gICAgICAgIHRoaXMuX3Nob3VsZEFsbG93TWlncmF0aW9uID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmxpc3RlbmVycyA9IHt9O1xyXG4gICAgICAgIHRoaXMubG9jYWxDYWNoZSA9IHt9O1xyXG4gICAgICAgIC8vIHNldFRpbWVvdXQgcmV0dXJuIHZhbHVlIGlzIHBsYXRmb3JtIHNwZWNpZmljXHJcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcclxuICAgICAgICB0aGlzLnBvbGxUaW1lciA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5wZW5kaW5nV3JpdGVzID0gMDtcclxuICAgICAgICB0aGlzLnJlY2VpdmVyID0gbnVsbDtcclxuICAgICAgICB0aGlzLnNlbmRlciA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5zZXJ2aWNlV29ya2VyUmVjZWl2ZXJBdmFpbGFibGUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmFjdGl2ZVNlcnZpY2VXb3JrZXIgPSBudWxsO1xyXG4gICAgICAgIC8vIEZpcmUgJiBmb3JnZXQgdGhlIHNlcnZpY2Ugd29ya2VyIHJlZ2lzdHJhdGlvbiBhcyBpdCBtYXkgbmV2ZXIgcmVzb2x2ZVxyXG4gICAgICAgIHRoaXMuX3dvcmtlckluaXRpYWxpemF0aW9uUHJvbWlzZSA9XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZVNlcnZpY2VXb3JrZXJNZXNzYWdpbmcoKS50aGVuKCgpID0+IHsgfSwgKCkgPT4geyB9KTtcclxuICAgIH1cclxuICAgIGFzeW5jIF9vcGVuRGIoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZGIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZGIgPSBhd2FpdCBfb3BlbkRhdGFiYXNlKCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGI7XHJcbiAgICB9XHJcbiAgICBhc3luYyBfd2l0aFJldHJpZXMob3ApIHtcclxuICAgICAgICBsZXQgbnVtQXR0ZW1wdHMgPSAwO1xyXG4gICAgICAgIHdoaWxlICh0cnVlKSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBkYiA9IGF3YWl0IHRoaXMuX29wZW5EYigpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IG9wKGRiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG51bUF0dGVtcHRzKysgPiBfVFJBTlNBQ1RJT05fUkVUUllfQ09VTlQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZGIpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRiLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kYiA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIFRPRE86IGNvbnNpZGVyIGFkZGluZyBleHBvbmVudGlhbCBiYWNrb2ZmXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEluZGV4ZWREQiBldmVudHMgZG8gbm90IHByb3BhZ2F0ZSBmcm9tIHRoZSBtYWluIHdpbmRvdyB0byB0aGUgd29ya2VyIGNvbnRleHQuICBXZSByZWx5IG9uIGFcclxuICAgICAqIHBvc3RNZXNzYWdlIGludGVyZmFjZSB0byBzZW5kIHRoZXNlIGV2ZW50cyB0byB0aGUgd29ya2VyIG91cnNlbHZlcy5cclxuICAgICAqL1xyXG4gICAgYXN5bmMgaW5pdGlhbGl6ZVNlcnZpY2VXb3JrZXJNZXNzYWdpbmcoKSB7XHJcbiAgICAgICAgcmV0dXJuIF9pc1dvcmtlcigpID8gdGhpcy5pbml0aWFsaXplUmVjZWl2ZXIoKSA6IHRoaXMuaW5pdGlhbGl6ZVNlbmRlcigpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBBcyB0aGUgd29ya2VyIHdlIHNob3VsZCBsaXN0ZW4gdG8gZXZlbnRzIGZyb20gdGhlIG1haW4gd2luZG93LlxyXG4gICAgICovXHJcbiAgICBhc3luYyBpbml0aWFsaXplUmVjZWl2ZXIoKSB7XHJcbiAgICAgICAgdGhpcy5yZWNlaXZlciA9IFJlY2VpdmVyLl9nZXRJbnN0YW5jZShfZ2V0V29ya2VyR2xvYmFsU2NvcGUoKSk7XHJcbiAgICAgICAgLy8gUmVmcmVzaCBmcm9tIHBlcnNpc3RlbmNlIGlmIHdlIHJlY2VpdmUgYSBLZXlDaGFuZ2VkIG1lc3NhZ2UuXHJcbiAgICAgICAgdGhpcy5yZWNlaXZlci5fc3Vic2NyaWJlKFwia2V5Q2hhbmdlZFwiIC8qIEtFWV9DSEFOR0VEICovLCBhc3luYyAoX29yaWdpbiwgZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBrZXlzID0gYXdhaXQgdGhpcy5fcG9sbCgpO1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAga2V5UHJvY2Vzc2VkOiBrZXlzLmluY2x1ZGVzKGRhdGEua2V5KVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vIExldCB0aGUgc2VuZGVyIGtub3cgdGhhdCB3ZSBhcmUgbGlzdGVuaW5nIHNvIHRoZXkgZ2l2ZSB1cyBtb3JlIHRpbWVvdXQuXHJcbiAgICAgICAgdGhpcy5yZWNlaXZlci5fc3Vic2NyaWJlKFwicGluZ1wiIC8qIFBJTkcgKi8sIGFzeW5jIChfb3JpZ2luLCBfZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gW1wia2V5Q2hhbmdlZFwiIC8qIEtFWV9DSEFOR0VEICovXTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQXMgdGhlIG1haW4gd2luZG93LCB3ZSBzaG91bGQgbGV0IHRoZSB3b3JrZXIga25vdyB3aGVuIGtleXMgY2hhbmdlIChzZXQgYW5kIHJlbW92ZSkuXHJcbiAgICAgKlxyXG4gICAgICogQHJlbWFya3NcclxuICAgICAqIHtAbGluayBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvU2VydmljZVdvcmtlckNvbnRhaW5lci9yZWFkeSB8IFNlcnZpY2VXb3JrZXJDb250YWluZXIucmVhZHl9XHJcbiAgICAgKiBtYXkgbm90IHJlc29sdmUuXHJcbiAgICAgKi9cclxuICAgIGFzeW5jIGluaXRpYWxpemVTZW5kZXIoKSB7XHJcbiAgICAgICAgdmFyIF9hLCBfYjtcclxuICAgICAgICAvLyBDaGVjayB0byBzZWUgaWYgdGhlcmUncyBhbiBhY3RpdmUgc2VydmljZSB3b3JrZXIuXHJcbiAgICAgICAgdGhpcy5hY3RpdmVTZXJ2aWNlV29ya2VyID0gYXdhaXQgX2dldEFjdGl2ZVNlcnZpY2VXb3JrZXIoKTtcclxuICAgICAgICBpZiAoIXRoaXMuYWN0aXZlU2VydmljZVdvcmtlcikge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2VuZGVyID0gbmV3IFNlbmRlcih0aGlzLmFjdGl2ZVNlcnZpY2VXb3JrZXIpO1xyXG4gICAgICAgIC8vIFBpbmcgdGhlIHNlcnZpY2Ugd29ya2VyIHRvIGNoZWNrIHdoYXQgZXZlbnRzIHRoZXkgY2FuIGhhbmRsZS5cclxuICAgICAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgdGhpcy5zZW5kZXIuX3NlbmQoXCJwaW5nXCIgLyogUElORyAqLywge30sIDgwMCAvKiBMT05HX0FDSyAqLyk7XHJcbiAgICAgICAgaWYgKCFyZXN1bHRzKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCgoX2EgPSByZXN1bHRzWzBdKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuZnVsZmlsbGVkKSAmJlxyXG4gICAgICAgICAgICAoKF9iID0gcmVzdWx0c1swXSkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLnZhbHVlLmluY2x1ZGVzKFwia2V5Q2hhbmdlZFwiIC8qIEtFWV9DSEFOR0VEICovKSkpIHtcclxuICAgICAgICAgICAgdGhpcy5zZXJ2aWNlV29ya2VyUmVjZWl2ZXJBdmFpbGFibGUgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogTGV0IHRoZSB3b3JrZXIga25vdyBhYm91dCBhIGNoYW5nZWQga2V5LCB0aGUgZXhhY3Qga2V5IGRvZXNuJ3QgdGVjaG5pY2FsbHkgbWF0dGVyIHNpbmNlIHRoZVxyXG4gICAgICogd29ya2VyIHdpbGwganVzdCB0cmlnZ2VyIGEgZnVsbCBzeW5jIGFueXdheS5cclxuICAgICAqXHJcbiAgICAgKiBAcmVtYXJrc1xyXG4gICAgICogRm9yIG5vdywgd2Ugb25seSBzdXBwb3J0IG9uZSBzZXJ2aWNlIHdvcmtlciBwZXIgcGFnZS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ga2V5IC0gU3RvcmFnZSBrZXkgd2hpY2ggY2hhbmdlZC5cclxuICAgICAqL1xyXG4gICAgYXN5bmMgbm90aWZ5U2VydmljZVdvcmtlcihrZXkpIHtcclxuICAgICAgICBpZiAoIXRoaXMuc2VuZGVyIHx8XHJcbiAgICAgICAgICAgICF0aGlzLmFjdGl2ZVNlcnZpY2VXb3JrZXIgfHxcclxuICAgICAgICAgICAgX2dldFNlcnZpY2VXb3JrZXJDb250cm9sbGVyKCkgIT09IHRoaXMuYWN0aXZlU2VydmljZVdvcmtlcikge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuc2VuZGVyLl9zZW5kKFwia2V5Q2hhbmdlZFwiIC8qIEtFWV9DSEFOR0VEICovLCB7IGtleSB9LCBcclxuICAgICAgICAgICAgLy8gVXNlIGxvbmcgdGltZW91dCBpZiByZWNlaXZlciBoYXMgcHJldmlvdXNseSByZXNwb25kZWQgdG8gYSBwaW5nIGZyb20gdXMuXHJcbiAgICAgICAgICAgIHRoaXMuc2VydmljZVdvcmtlclJlY2VpdmVyQXZhaWxhYmxlXHJcbiAgICAgICAgICAgICAgICA/IDgwMCAvKiBMT05HX0FDSyAqL1xyXG4gICAgICAgICAgICAgICAgOiA1MCAvKiBBQ0sgKi8pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoX2EpIHtcclxuICAgICAgICAgICAgLy8gVGhpcyBpcyBhIGJlc3QgZWZmb3J0IGFwcHJvYWNoLiBJZ25vcmUgZXJyb3JzLlxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGFzeW5jIF9pc0F2YWlsYWJsZSgpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAoIWluZGV4ZWREQikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IGRiID0gYXdhaXQgX29wZW5EYXRhYmFzZSgpO1xyXG4gICAgICAgICAgICBhd2FpdCBfcHV0T2JqZWN0KGRiLCBTVE9SQUdFX0FWQUlMQUJMRV9LRVksICcxJyk7XHJcbiAgICAgICAgICAgIGF3YWl0IF9kZWxldGVPYmplY3QoZGIsIFNUT1JBR0VfQVZBSUxBQkxFX0tFWSk7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoX2EpIHsgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIGFzeW5jIF93aXRoUGVuZGluZ1dyaXRlKHdyaXRlKSB7XHJcbiAgICAgICAgdGhpcy5wZW5kaW5nV3JpdGVzKys7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgYXdhaXQgd3JpdGUoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZmluYWxseSB7XHJcbiAgICAgICAgICAgIHRoaXMucGVuZGluZ1dyaXRlcy0tO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGFzeW5jIF9zZXQoa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl93aXRoUGVuZGluZ1dyaXRlKGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5fd2l0aFJldHJpZXMoKGRiKSA9PiBfcHV0T2JqZWN0KGRiLCBrZXksIHZhbHVlKSk7XHJcbiAgICAgICAgICAgIHRoaXMubG9jYWxDYWNoZVtrZXldID0gdmFsdWU7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm5vdGlmeVNlcnZpY2VXb3JrZXIoa2V5KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGFzeW5jIF9nZXQoa2V5KSB7XHJcbiAgICAgICAgY29uc3Qgb2JqID0gKGF3YWl0IHRoaXMuX3dpdGhSZXRyaWVzKChkYikgPT4gZ2V0T2JqZWN0KGRiLCBrZXkpKSk7XHJcbiAgICAgICAgdGhpcy5sb2NhbENhY2hlW2tleV0gPSBvYmo7XHJcbiAgICAgICAgcmV0dXJuIG9iajtcclxuICAgIH1cclxuICAgIGFzeW5jIF9yZW1vdmUoa2V5KSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3dpdGhQZW5kaW5nV3JpdGUoYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLl93aXRoUmV0cmllcygoZGIpID0+IF9kZWxldGVPYmplY3QoZGIsIGtleSkpO1xyXG4gICAgICAgICAgICBkZWxldGUgdGhpcy5sb2NhbENhY2hlW2tleV07XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm5vdGlmeVNlcnZpY2VXb3JrZXIoa2V5KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGFzeW5jIF9wb2xsKCkge1xyXG4gICAgICAgIC8vIFRPRE86IGNoZWNrIGlmIHdlIG5lZWQgdG8gZmFsbGJhY2sgaWYgZ2V0QWxsIGlzIG5vdCBzdXBwb3J0ZWRcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLl93aXRoUmV0cmllcygoZGIpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZ2V0QWxsUmVxdWVzdCA9IGdldE9iamVjdFN0b3JlKGRiLCBmYWxzZSkuZ2V0QWxsKCk7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgREJQcm9taXNlKGdldEFsbFJlcXVlc3QpLnRvUHJvbWlzZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmICghcmVzdWx0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gSWYgd2UgaGF2ZSBwZW5kaW5nIHdyaXRlcyBpbiBwcm9ncmVzcyBhYm9ydCwgd2UnbGwgZ2V0IHBpY2tlZCB1cCBvbiB0aGUgbmV4dCBwb2xsXHJcbiAgICAgICAgaWYgKHRoaXMucGVuZGluZ1dyaXRlcyAhPT0gMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gW107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGtleXMgPSBbXTtcclxuICAgICAgICBjb25zdCBrZXlzSW5SZXN1bHQgPSBuZXcgU2V0KCk7XHJcbiAgICAgICAgZm9yIChjb25zdCB7IGZiYXNlX2tleToga2V5LCB2YWx1ZSB9IG9mIHJlc3VsdCkge1xyXG4gICAgICAgICAgICBrZXlzSW5SZXN1bHQuYWRkKGtleSk7XHJcbiAgICAgICAgICAgIGlmIChKU09OLnN0cmluZ2lmeSh0aGlzLmxvY2FsQ2FjaGVba2V5XSkgIT09IEpTT04uc3RyaW5naWZ5KHZhbHVlKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ub3RpZnlMaXN0ZW5lcnMoa2V5LCB2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICBrZXlzLnB1c2goa2V5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKGNvbnN0IGxvY2FsS2V5IG9mIE9iamVjdC5rZXlzKHRoaXMubG9jYWxDYWNoZSkpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMubG9jYWxDYWNoZVtsb2NhbEtleV0gJiYgIWtleXNJblJlc3VsdC5oYXMobG9jYWxLZXkpKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBEZWxldGVkXHJcbiAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeUxpc3RlbmVycyhsb2NhbEtleSwgbnVsbCk7XHJcbiAgICAgICAgICAgICAgICBrZXlzLnB1c2gobG9jYWxLZXkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBrZXlzO1xyXG4gICAgfVxyXG4gICAgbm90aWZ5TGlzdGVuZXJzKGtleSwgbmV3VmFsdWUpIHtcclxuICAgICAgICB0aGlzLmxvY2FsQ2FjaGVba2V5XSA9IG5ld1ZhbHVlO1xyXG4gICAgICAgIGNvbnN0IGxpc3RlbmVycyA9IHRoaXMubGlzdGVuZXJzW2tleV07XHJcbiAgICAgICAgaWYgKGxpc3RlbmVycykge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGxpc3RlbmVyIG9mIEFycmF5LmZyb20obGlzdGVuZXJzKSkge1xyXG4gICAgICAgICAgICAgICAgbGlzdGVuZXIobmV3VmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgc3RhcnRQb2xsaW5nKCkge1xyXG4gICAgICAgIHRoaXMuc3RvcFBvbGxpbmcoKTtcclxuICAgICAgICB0aGlzLnBvbGxUaW1lciA9IHNldEludGVydmFsKGFzeW5jICgpID0+IHRoaXMuX3BvbGwoKSwgX1BPTExJTkdfSU5URVJWQUxfTVMpO1xyXG4gICAgfVxyXG4gICAgc3RvcFBvbGxpbmcoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMucG9sbFRpbWVyKSB7XHJcbiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5wb2xsVGltZXIpO1xyXG4gICAgICAgICAgICB0aGlzLnBvbGxUaW1lciA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgX2FkZExpc3RlbmVyKGtleSwgbGlzdGVuZXIpIHtcclxuICAgICAgICBpZiAoT2JqZWN0LmtleXModGhpcy5saXN0ZW5lcnMpLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICB0aGlzLnN0YXJ0UG9sbGluZygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXRoaXMubGlzdGVuZXJzW2tleV0pIHtcclxuICAgICAgICAgICAgdGhpcy5saXN0ZW5lcnNba2V5XSA9IG5ldyBTZXQoKTtcclxuICAgICAgICAgICAgLy8gUG9wdWxhdGUgdGhlIGNhY2hlIHRvIGF2b2lkIHNwdXJpb3VzbHkgdHJpZ2dlcmluZyBvbiBmaXJzdCBwb2xsLlxyXG4gICAgICAgICAgICB2b2lkIHRoaXMuX2dldChrZXkpOyAvLyBUaGlzIGNhbiBoYXBwZW4gaW4gdGhlIGJhY2tncm91bmQgYXN5bmMgYW5kIHdlIGNhbiByZXR1cm4gaW1tZWRpYXRlbHkuXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMubGlzdGVuZXJzW2tleV0uYWRkKGxpc3RlbmVyKTtcclxuICAgIH1cclxuICAgIF9yZW1vdmVMaXN0ZW5lcihrZXksIGxpc3RlbmVyKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubGlzdGVuZXJzW2tleV0pIHtcclxuICAgICAgICAgICAgdGhpcy5saXN0ZW5lcnNba2V5XS5kZWxldGUobGlzdGVuZXIpO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5saXN0ZW5lcnNba2V5XS5zaXplID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5saXN0ZW5lcnNba2V5XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoT2JqZWN0LmtleXModGhpcy5saXN0ZW5lcnMpLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICB0aGlzLnN0b3BQb2xsaW5nKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbkluZGV4ZWREQkxvY2FsUGVyc2lzdGVuY2UudHlwZSA9ICdMT0NBTCc7XHJcbi8qKlxyXG4gKiBBbiBpbXBsZW1lbnRhdGlvbiBvZiB7QGxpbmsgUGVyc2lzdGVuY2V9IG9mIHR5cGUgYExPQ0FMYCB1c2luZyBgaW5kZXhlZERCYFxyXG4gKiBmb3IgdGhlIHVuZGVybHlpbmcgc3RvcmFnZS5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuY29uc3QgaW5kZXhlZERCTG9jYWxQZXJzaXN0ZW5jZSA9IEluZGV4ZWREQkxvY2FsUGVyc2lzdGVuY2U7XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmZ1bmN0aW9uIHN0YXJ0U2lnbkluUGhvbmVNZmEoYXV0aCwgcmVxdWVzdCkge1xyXG4gICAgcmV0dXJuIF9wZXJmb3JtQXBpUmVxdWVzdChhdXRoLCBcIlBPU1RcIiAvKiBQT1NUICovLCBcIi92Mi9hY2NvdW50cy9tZmFTaWduSW46c3RhcnRcIiAvKiBTVEFSVF9QSE9ORV9NRkFfU0lHTl9JTiAqLywgT2JqZWN0LmFzc2lnbih7IHRlbmFudElkOiBhdXRoLnRlbmFudElkIH0sIHJlcXVlc3QpKTtcclxufVxyXG5mdW5jdGlvbiBmaW5hbGl6ZVNpZ25JblBob25lTWZhKGF1dGgsIHJlcXVlc3QpIHtcclxuICAgIHJldHVybiBfcGVyZm9ybUFwaVJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogUE9TVCAqLywgXCIvdjIvYWNjb3VudHMvbWZhU2lnbkluOmZpbmFsaXplXCIgLyogRklOQUxJWkVfUEhPTkVfTUZBX1NJR05fSU4gKi8sIE9iamVjdC5hc3NpZ24oeyB0ZW5hbnRJZDogYXV0aC50ZW5hbnRJZCB9LCByZXF1ZXN0KSk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gZ2V0UmVjYXB0Y2hhUGFyYW1zKGF1dGgpIHtcclxuICAgIHJldHVybiAoKGF3YWl0IF9wZXJmb3JtQXBpUmVxdWVzdChhdXRoLCBcIkdFVFwiIC8qIEdFVCAqLywgXCIvdjEvcmVjYXB0Y2hhUGFyYW1zXCIgLyogR0VUX1JFQ0FQVENIQV9QQVJBTSAqLykpLnJlY2FwdGNoYVNpdGVLZXkgfHwgJycpO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmZ1bmN0aW9uIGdldFNjcmlwdFBhcmVudEVsZW1lbnQoKSB7XHJcbiAgICB2YXIgX2EsIF9iO1xyXG4gICAgcmV0dXJuIChfYiA9IChfYSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoZWFkJykpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYVswXSkgIT09IG51bGwgJiYgX2IgIT09IHZvaWQgMCA/IF9iIDogZG9jdW1lbnQ7XHJcbn1cclxuZnVuY3Rpb24gX2xvYWRKUyh1cmwpIHtcclxuICAgIC8vIFRPRE86IGNvbnNpZGVyIGFkZGluZyB0aW1lb3V0IHN1cHBvcnQgJiBjYW5jZWxsYXRpb25cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgY29uc3QgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcclxuICAgICAgICBlbC5zZXRBdHRyaWJ1dGUoJ3NyYycsIHVybCk7XHJcbiAgICAgICAgZWwub25sb2FkID0gcmVzb2x2ZTtcclxuICAgICAgICBlbC5vbmVycm9yID0gZSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVycm9yID0gX2NyZWF0ZUVycm9yKFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyk7XHJcbiAgICAgICAgICAgIGVycm9yLmN1c3RvbURhdGEgPSBlO1xyXG4gICAgICAgICAgICByZWplY3QoZXJyb3IpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgZWwudHlwZSA9ICd0ZXh0L2phdmFzY3JpcHQnO1xyXG4gICAgICAgIGVsLmNoYXJzZXQgPSAnVVRGLTgnO1xyXG4gICAgICAgIGdldFNjcmlwdFBhcmVudEVsZW1lbnQoKS5hcHBlbmRDaGlsZChlbCk7XHJcbiAgICB9KTtcclxufVxyXG5mdW5jdGlvbiBfZ2VuZXJhdGVDYWxsYmFja05hbWUocHJlZml4KSB7XHJcbiAgICByZXR1cm4gYF9fJHtwcmVmaXh9JHtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwMDAwKX1gO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmNvbnN0IF9TT0xWRV9USU1FX01TID0gNTAwO1xyXG5jb25zdCBfRVhQSVJBVElPTl9USU1FX01TID0gNjAwMDA7XHJcbmNvbnN0IF9XSURHRVRfSURfU1RBUlQgPSAxMDAwMDAwMDAwMDAwO1xyXG5jbGFzcyBNb2NrUmVDYXB0Y2hhIHtcclxuICAgIGNvbnN0cnVjdG9yKGF1dGgpIHtcclxuICAgICAgICB0aGlzLmF1dGggPSBhdXRoO1xyXG4gICAgICAgIHRoaXMuY291bnRlciA9IF9XSURHRVRfSURfU1RBUlQ7XHJcbiAgICAgICAgdGhpcy5fd2lkZ2V0cyA9IG5ldyBNYXAoKTtcclxuICAgIH1cclxuICAgIHJlbmRlcihjb250YWluZXIsIHBhcmFtZXRlcnMpIHtcclxuICAgICAgICBjb25zdCBpZCA9IHRoaXMuY291bnRlcjtcclxuICAgICAgICB0aGlzLl93aWRnZXRzLnNldChpZCwgbmV3IE1vY2tXaWRnZXQoY29udGFpbmVyLCB0aGlzLmF1dGgubmFtZSwgcGFyYW1ldGVycyB8fCB7fSkpO1xyXG4gICAgICAgIHRoaXMuY291bnRlcisrO1xyXG4gICAgICAgIHJldHVybiBpZDtcclxuICAgIH1cclxuICAgIHJlc2V0KG9wdFdpZGdldElkKSB7XHJcbiAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgIGNvbnN0IGlkID0gb3B0V2lkZ2V0SWQgfHwgX1dJREdFVF9JRF9TVEFSVDtcclxuICAgICAgICB2b2lkICgoX2EgPSB0aGlzLl93aWRnZXRzLmdldChpZCkpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5kZWxldGUoKSk7XHJcbiAgICAgICAgdGhpcy5fd2lkZ2V0cy5kZWxldGUoaWQpO1xyXG4gICAgfVxyXG4gICAgZ2V0UmVzcG9uc2Uob3B0V2lkZ2V0SWQpIHtcclxuICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgY29uc3QgaWQgPSBvcHRXaWRnZXRJZCB8fCBfV0lER0VUX0lEX1NUQVJUO1xyXG4gICAgICAgIHJldHVybiAoKF9hID0gdGhpcy5fd2lkZ2V0cy5nZXQoaWQpKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuZ2V0UmVzcG9uc2UoKSkgfHwgJyc7XHJcbiAgICB9XHJcbiAgICBhc3luYyBleGVjdXRlKG9wdFdpZGdldElkKSB7XHJcbiAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgIGNvbnN0IGlkID0gb3B0V2lkZ2V0SWQgfHwgX1dJREdFVF9JRF9TVEFSVDtcclxuICAgICAgICB2b2lkICgoX2EgPSB0aGlzLl93aWRnZXRzLmdldChpZCkpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5leGVjdXRlKCkpO1xyXG4gICAgICAgIHJldHVybiAnJztcclxuICAgIH1cclxufVxyXG5jbGFzcyBNb2NrV2lkZ2V0IHtcclxuICAgIGNvbnN0cnVjdG9yKGNvbnRhaW5lck9ySWQsIGFwcE5hbWUsIHBhcmFtcykge1xyXG4gICAgICAgIHRoaXMucGFyYW1zID0gcGFyYW1zO1xyXG4gICAgICAgIHRoaXMudGltZXJJZCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5kZWxldGVkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5yZXNwb25zZVRva2VuID0gbnVsbDtcclxuICAgICAgICB0aGlzLmNsaWNrSGFuZGxlciA9ICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5leGVjdXRlKCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBjb25zdCBjb250YWluZXIgPSB0eXBlb2YgY29udGFpbmVyT3JJZCA9PT0gJ3N0cmluZydcclxuICAgICAgICAgICAgPyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb250YWluZXJPcklkKVxyXG4gICAgICAgICAgICA6IGNvbnRhaW5lck9ySWQ7XHJcbiAgICAgICAgX2Fzc2VydChjb250YWluZXIsIFwiYXJndW1lbnQtZXJyb3JcIiAvKiBBUkdVTUVOVF9FUlJPUiAqLywgeyBhcHBOYW1lIH0pO1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xyXG4gICAgICAgIHRoaXMuaXNWaXNpYmxlID0gdGhpcy5wYXJhbXMuc2l6ZSAhPT0gJ2ludmlzaWJsZSc7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNWaXNpYmxlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZXhlY3V0ZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5jb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmNsaWNrSGFuZGxlcik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZ2V0UmVzcG9uc2UoKSB7XHJcbiAgICAgICAgdGhpcy5jaGVja0lmRGVsZXRlZCgpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJlc3BvbnNlVG9rZW47XHJcbiAgICB9XHJcbiAgICBkZWxldGUoKSB7XHJcbiAgICAgICAgdGhpcy5jaGVja0lmRGVsZXRlZCgpO1xyXG4gICAgICAgIHRoaXMuZGVsZXRlZCA9IHRydWU7XHJcbiAgICAgICAgaWYgKHRoaXMudGltZXJJZCkge1xyXG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lcklkKTtcclxuICAgICAgICAgICAgdGhpcy50aW1lcklkID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmNsaWNrSGFuZGxlcik7XHJcbiAgICB9XHJcbiAgICBleGVjdXRlKCkge1xyXG4gICAgICAgIHRoaXMuY2hlY2tJZkRlbGV0ZWQoKTtcclxuICAgICAgICBpZiAodGhpcy50aW1lcklkKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy50aW1lcklkID0gd2luZG93LnNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnJlc3BvbnNlVG9rZW4gPSBnZW5lcmF0ZVJhbmRvbUFscGhhTnVtZXJpY1N0cmluZyg1MCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHsgY2FsbGJhY2ssICdleHBpcmVkLWNhbGxiYWNrJzogZXhwaXJlZENhbGxiYWNrIH0gPSB0aGlzLnBhcmFtcztcclxuICAgICAgICAgICAgaWYgKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKHRoaXMucmVzcG9uc2VUb2tlbik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYXRjaCAoZSkgeyB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy50aW1lcklkID0gd2luZG93LnNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy50aW1lcklkID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVzcG9uc2VUb2tlbiA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBpZiAoZXhwaXJlZENhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXhwaXJlZENhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7IH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzVmlzaWJsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZXhlY3V0ZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBfRVhQSVJBVElPTl9USU1FX01TKTtcclxuICAgICAgICB9LCBfU09MVkVfVElNRV9NUyk7XHJcbiAgICB9XHJcbiAgICBjaGVja0lmRGVsZXRlZCgpIHtcclxuICAgICAgICBpZiAodGhpcy5kZWxldGVkKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigncmVDQVBUQ0hBIG1vY2sgd2FzIGFscmVhZHkgZGVsZXRlZCEnKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gZ2VuZXJhdGVSYW5kb21BbHBoYU51bWVyaWNTdHJpbmcobGVuKSB7XHJcbiAgICBjb25zdCBjaGFycyA9IFtdO1xyXG4gICAgY29uc3QgYWxsb3dlZENoYXJzID0gJzEyMzQ1Njc4OTBhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ekFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaJztcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgICBjaGFycy5wdXNoKGFsbG93ZWRDaGFycy5jaGFyQXQoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogYWxsb3dlZENoYXJzLmxlbmd0aCkpKTtcclxuICAgIH1cclxuICAgIHJldHVybiBjaGFycy5qb2luKCcnKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vLyBSZUNhcHRjaGEgd2lsbCBsb2FkIHVzaW5nIHRoZSBzYW1lIGNhbGxiYWNrLCBzbyB0aGUgY2FsbGJhY2sgZnVuY3Rpb24gbmVlZHNcclxuLy8gdG8gYmUga2VwdCBhcm91bmRcclxuY29uc3QgX0pTTE9BRF9DQUxMQkFDSyA9IF9nZW5lcmF0ZUNhbGxiYWNrTmFtZSgncmNiJyk7XHJcbmNvbnN0IE5FVFdPUktfVElNRU9VVF9ERUxBWSA9IG5ldyBEZWxheSgzMDAwMCwgNjAwMDApO1xyXG5jb25zdCBSRUNBUFRDSEFfQkFTRSA9ICdodHRwczovL3d3dy5nb29nbGUuY29tL3JlY2FwdGNoYS9hcGkuanM/JztcclxuLyoqXHJcbiAqIExvYWRlciBmb3IgdGhlIEdSZUNhcHRjaGEgbGlicmFyeS4gVGhlcmUgc2hvdWxkIG9ubHkgZXZlciBiZSBvbmUgb2YgdGhpcy5cclxuICovXHJcbmNsYXNzIFJlQ2FwdGNoYUxvYWRlckltcGwge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgdGhpcy5ob3N0TGFuZ3VhZ2UgPSAnJztcclxuICAgICAgICB0aGlzLmNvdW50ZXIgPSAwO1xyXG4gICAgICAgIHRoaXMubGlicmFyeVNlcGFyYXRlbHlMb2FkZWQgPSAhIV93aW5kb3coKS5ncmVjYXB0Y2hhO1xyXG4gICAgfVxyXG4gICAgbG9hZChhdXRoLCBobCA9ICcnKSB7XHJcbiAgICAgICAgX2Fzc2VydChpc0hvc3RMYW5ndWFnZVZhbGlkKGhsKSwgYXV0aCwgXCJhcmd1bWVudC1lcnJvclwiIC8qIEFSR1VNRU5UX0VSUk9SICovKTtcclxuICAgICAgICBpZiAodGhpcy5zaG91bGRSZXNvbHZlSW1tZWRpYXRlbHkoaGwpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoX3dpbmRvdygpLmdyZWNhcHRjaGEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBuZXR3b3JrVGltZW91dCA9IF93aW5kb3coKS5zZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHJlamVjdChfY3JlYXRlRXJyb3IoYXV0aCwgXCJuZXR3b3JrLXJlcXVlc3QtZmFpbGVkXCIgLyogTkVUV09SS19SRVFVRVNUX0ZBSUxFRCAqLykpO1xyXG4gICAgICAgICAgICB9LCBORVRXT1JLX1RJTUVPVVRfREVMQVkuZ2V0KCkpO1xyXG4gICAgICAgICAgICBfd2luZG93KClbX0pTTE9BRF9DQUxMQkFDS10gPSAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBfd2luZG93KCkuY2xlYXJUaW1lb3V0KG5ldHdvcmtUaW1lb3V0KTtcclxuICAgICAgICAgICAgICAgIGRlbGV0ZSBfd2luZG93KClbX0pTTE9BRF9DQUxMQkFDS107XHJcbiAgICAgICAgICAgICAgICBjb25zdCByZWNhcHRjaGEgPSBfd2luZG93KCkuZ3JlY2FwdGNoYTtcclxuICAgICAgICAgICAgICAgIGlmICghcmVjYXB0Y2hhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KF9jcmVhdGVFcnJvcihhdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8pKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBXcmFwIHRoZSBncmVwdGNoYSByZW5kZXIgZnVuY3Rpb24gc28gdGhhdCB3ZSBrbm93IGlmIHRoZSBkZXZlbG9wZXIgaGFzXHJcbiAgICAgICAgICAgICAgICAvLyBjYWxsZWQgaXQgc2VwYXJhdGVseVxyXG4gICAgICAgICAgICAgICAgY29uc3QgcmVuZGVyID0gcmVjYXB0Y2hhLnJlbmRlcjtcclxuICAgICAgICAgICAgICAgIHJlY2FwdGNoYS5yZW5kZXIgPSAoY29udGFpbmVyLCBwYXJhbXMpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB3aWRnZXRJZCA9IHJlbmRlcihjb250YWluZXIsIHBhcmFtcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb3VudGVyKys7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHdpZGdldElkO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaG9zdExhbmd1YWdlID0gaGw7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKHJlY2FwdGNoYSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGNvbnN0IHVybCA9IGAke1JFQ0FQVENIQV9CQVNFfT8ke3F1ZXJ5c3RyaW5nKHtcclxuICAgICAgICAgICAgICAgIG9ubG9hZDogX0pTTE9BRF9DQUxMQkFDSyxcclxuICAgICAgICAgICAgICAgIHJlbmRlcjogJ2V4cGxpY2l0JyxcclxuICAgICAgICAgICAgICAgIGhsXHJcbiAgICAgICAgICAgIH0pfWA7XHJcbiAgICAgICAgICAgIF9sb2FkSlModXJsKS5jYXRjaCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQobmV0d29ya1RpbWVvdXQpO1xyXG4gICAgICAgICAgICAgICAgcmVqZWN0KF9jcmVhdGVFcnJvcihhdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8pKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBjbGVhcmVkT25lSW5zdGFuY2UoKSB7XHJcbiAgICAgICAgdGhpcy5jb3VudGVyLS07XHJcbiAgICB9XHJcbiAgICBzaG91bGRSZXNvbHZlSW1tZWRpYXRlbHkoaGwpIHtcclxuICAgICAgICAvLyBXZSBjYW4gcmVzb2x2ZSBpbW1lZGlhdGVseSBpZjpcclxuICAgICAgICAvLyAgIOKAoiBncmVjYXB0Y2hhIGlzIGFscmVhZHkgZGVmaW5lZCBBTkQgKFxyXG4gICAgICAgIC8vICAgICAxLiB0aGUgcmVxdWVzdGVkIGxhbmd1YWdlIGNvZGVzIGFyZSB0aGUgc2FtZSBPUlxyXG4gICAgICAgIC8vICAgICAyLiB0aGVyZSBleGlzdHMgYWxyZWFkeSBhIFJlQ2FwdGNoYSBvbiB0aGUgcGFnZVxyXG4gICAgICAgIC8vICAgICAzLiB0aGUgbGlicmFyeSB3YXMgYWxyZWFkeSBsb2FkZWQgYnkgdGhlIGFwcFxyXG4gICAgICAgIC8vIEluIGNhc2VzICgyKSBhbmQgKDMpLCB3ZSBfY2FuJ3RfIHJlbG9hZCBhcyBpdCB3b3VsZCBicmVhayB0aGUgcmVjYXB0Y2hhc1xyXG4gICAgICAgIC8vIHRoYXQgYXJlIGFscmVhZHkgaW4gdGhlIHBhZ2VcclxuICAgICAgICByZXR1cm4gKCEhX3dpbmRvdygpLmdyZWNhcHRjaGEgJiZcclxuICAgICAgICAgICAgKGhsID09PSB0aGlzLmhvc3RMYW5ndWFnZSB8fFxyXG4gICAgICAgICAgICAgICAgdGhpcy5jb3VudGVyID4gMCB8fFxyXG4gICAgICAgICAgICAgICAgdGhpcy5saWJyYXJ5U2VwYXJhdGVseUxvYWRlZCkpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGlzSG9zdExhbmd1YWdlVmFsaWQoaGwpIHtcclxuICAgIHJldHVybiBobC5sZW5ndGggPD0gNiAmJiAvXlxccypbYS16QS1aMC05XFwtXSpcXHMqJC8udGVzdChobCk7XHJcbn1cclxuY2xhc3MgTW9ja1JlQ2FwdGNoYUxvYWRlckltcGwge1xyXG4gICAgYXN5bmMgbG9hZChhdXRoKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBNb2NrUmVDYXB0Y2hhKGF1dGgpO1xyXG4gICAgfVxyXG4gICAgY2xlYXJlZE9uZUluc3RhbmNlKCkgeyB9XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuY29uc3QgUkVDQVBUQ0hBX1ZFUklGSUVSX1RZUEUgPSAncmVjYXB0Y2hhJztcclxuY29uc3QgREVGQVVMVF9QQVJBTVMgPSB7XHJcbiAgICB0aGVtZTogJ2xpZ2h0JyxcclxuICAgIHR5cGU6ICdpbWFnZSdcclxufTtcclxuLyoqXHJcbiAqIEFuIHtAbGluayBodHRwczovL3d3dy5nb29nbGUuY29tL3JlY2FwdGNoYS8gfCByZUNBUFRDSEF9LWJhc2VkIGFwcGxpY2F0aW9uIHZlcmlmaWVyLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5jbGFzcyBSZWNhcHRjaGFWZXJpZmllciB7XHJcbiAgICAvKipcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gY29udGFpbmVyT3JJZCAtIFRoZSByZUNBUFRDSEEgY29udGFpbmVyIHBhcmFtZXRlci5cclxuICAgICAqXHJcbiAgICAgKiBAcmVtYXJrc1xyXG4gICAgICogVGhpcyBoYXMgZGlmZmVyZW50IG1lYW5pbmcgZGVwZW5kaW5nIG9uIHdoZXRoZXIgdGhlIHJlQ0FQVENIQSBpcyBoaWRkZW4gb3IgdmlzaWJsZS4gRm9yIGFcclxuICAgICAqIHZpc2libGUgcmVDQVBUQ0hBIHRoZSBjb250YWluZXIgbXVzdCBiZSBlbXB0eS4gSWYgYSBzdHJpbmcgaXMgdXNlZCwgaXQgaGFzIHRvIGNvcnJlc3BvbmQgdG9cclxuICAgICAqIGFuIGVsZW1lbnQgSUQuIFRoZSBjb3JyZXNwb25kaW5nIGVsZW1lbnQgbXVzdCBhbHNvIG11c3QgYmUgaW4gdGhlIERPTSBhdCB0aGUgdGltZSBvZlxyXG4gICAgICogaW5pdGlhbGl6YXRpb24uXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHBhcmFtZXRlcnMgLSBUaGUgb3B0aW9uYWwgcmVDQVBUQ0hBIHBhcmFtZXRlcnMuXHJcbiAgICAgKlxyXG4gICAgICogQHJlbWFya3NcclxuICAgICAqIENoZWNrIHRoZSByZUNBUFRDSEEgZG9jcyBmb3IgYSBjb21wcmVoZW5zaXZlIGxpc3QuIEFsbCBwYXJhbWV0ZXJzIGFyZSBhY2NlcHRlZCBleGNlcHQgZm9yXHJcbiAgICAgKiB0aGUgc2l0ZWtleS4gRmlyZWJhc2UgQXV0aCBiYWNrZW5kIHByb3Zpc2lvbnMgYSByZUNBUFRDSEEgZm9yIGVhY2ggcHJvamVjdCBhbmQgd2lsbFxyXG4gICAgICogY29uZmlndXJlIHRoaXMgdXBvbiByZW5kZXJpbmcuIEZvciBhbiBpbnZpc2libGUgcmVDQVBUQ0hBLCBhIHNpemUga2V5IG11c3QgaGF2ZSB0aGUgdmFsdWVcclxuICAgICAqICdpbnZpc2libGUnLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBhdXRoRXh0ZXJuIC0gVGhlIGNvcnJlc3BvbmRpbmcgRmlyZWJhc2Uge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxyXG4gICAgICpcclxuICAgICAqIEByZW1hcmtzXHJcbiAgICAgKiBJZiBub25lIGlzIHByb3ZpZGVkLCB0aGUgZGVmYXVsdCBGaXJlYmFzZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UgaXMgdXNlZC4gQSBGaXJlYmFzZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2VcclxuICAgICAqIG11c3QgYmUgaW5pdGlhbGl6ZWQgd2l0aCBhbiBBUEkga2V5LCBvdGhlcndpc2UgYW4gZXJyb3Igd2lsbCBiZSB0aHJvd24uXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKGNvbnRhaW5lck9ySWQsIHBhcmFtZXRlcnMgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1BBUkFNUyksIGF1dGhFeHRlcm4pIHtcclxuICAgICAgICB0aGlzLnBhcmFtZXRlcnMgPSBwYXJhbWV0ZXJzO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRoZSBhcHBsaWNhdGlvbiB2ZXJpZmllciB0eXBlLlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJlbWFya3NcclxuICAgICAgICAgKiBGb3IgYSByZUNBUFRDSEEgdmVyaWZpZXIsIHRoaXMgaXMgJ3JlY2FwdGNoYScuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy50eXBlID0gUkVDQVBUQ0hBX1ZFUklGSUVSX1RZUEU7XHJcbiAgICAgICAgdGhpcy5kZXN0cm95ZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLndpZGdldElkID0gbnVsbDtcclxuICAgICAgICB0aGlzLnRva2VuQ2hhbmdlTGlzdGVuZXJzID0gbmV3IFNldCgpO1xyXG4gICAgICAgIHRoaXMucmVuZGVyUHJvbWlzZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5yZWNhcHRjaGEgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuYXV0aCA9IF9jYXN0QXV0aChhdXRoRXh0ZXJuKTtcclxuICAgICAgICB0aGlzLmlzSW52aXNpYmxlID0gdGhpcy5wYXJhbWV0ZXJzLnNpemUgPT09ICdpbnZpc2libGUnO1xyXG4gICAgICAgIF9hc3NlcnQodHlwZW9mIGRvY3VtZW50ICE9PSAndW5kZWZpbmVkJywgdGhpcy5hdXRoLCBcIm9wZXJhdGlvbi1ub3Qtc3VwcG9ydGVkLWluLXRoaXMtZW52aXJvbm1lbnRcIiAvKiBPUEVSQVRJT05fTk9UX1NVUFBPUlRFRCAqLyk7XHJcbiAgICAgICAgY29uc3QgY29udGFpbmVyID0gdHlwZW9mIGNvbnRhaW5lck9ySWQgPT09ICdzdHJpbmcnXHJcbiAgICAgICAgICAgID8gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY29udGFpbmVyT3JJZClcclxuICAgICAgICAgICAgOiBjb250YWluZXJPcklkO1xyXG4gICAgICAgIF9hc3NlcnQoY29udGFpbmVyLCB0aGlzLmF1dGgsIFwiYXJndW1lbnQtZXJyb3JcIiAvKiBBUkdVTUVOVF9FUlJPUiAqLyk7XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIgPSBjb250YWluZXI7XHJcbiAgICAgICAgdGhpcy5wYXJhbWV0ZXJzLmNhbGxiYWNrID0gdGhpcy5tYWtlVG9rZW5DYWxsYmFjayh0aGlzLnBhcmFtZXRlcnMuY2FsbGJhY2spO1xyXG4gICAgICAgIHRoaXMuX3JlY2FwdGNoYUxvYWRlciA9IHRoaXMuYXV0aC5zZXR0aW5ncy5hcHBWZXJpZmljYXRpb25EaXNhYmxlZEZvclRlc3RpbmdcclxuICAgICAgICAgICAgPyBuZXcgTW9ja1JlQ2FwdGNoYUxvYWRlckltcGwoKVxyXG4gICAgICAgICAgICA6IG5ldyBSZUNhcHRjaGFMb2FkZXJJbXBsKCk7XHJcbiAgICAgICAgdGhpcy52YWxpZGF0ZVN0YXJ0aW5nU3RhdGUoKTtcclxuICAgICAgICAvLyBUT0RPOiBGaWd1cmUgb3V0IGlmIHNkayB2ZXJzaW9uIGlzIG5lZWRlZFxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBXYWl0cyBmb3IgdGhlIHVzZXIgdG8gc29sdmUgdGhlIHJlQ0FQVENIQSBhbmQgcmVzb2x2ZXMgd2l0aCB0aGUgcmVDQVBUQ0hBIHRva2VuLlxyXG4gICAgICpcclxuICAgICAqIEByZXR1cm5zIEEgUHJvbWlzZSBmb3IgdGhlIHJlQ0FQVENIQSB0b2tlbi5cclxuICAgICAqL1xyXG4gICAgYXN5bmMgdmVyaWZ5KCkge1xyXG4gICAgICAgIHRoaXMuYXNzZXJ0Tm90RGVzdHJveWVkKCk7XHJcbiAgICAgICAgY29uc3QgaWQgPSBhd2FpdCB0aGlzLnJlbmRlcigpO1xyXG4gICAgICAgIGNvbnN0IHJlY2FwdGNoYSA9IHRoaXMuZ2V0QXNzZXJ0ZWRSZWNhcHRjaGEoKTtcclxuICAgICAgICBjb25zdCByZXNwb25zZSA9IHJlY2FwdGNoYS5nZXRSZXNwb25zZShpZCk7XHJcbiAgICAgICAgaWYgKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXNwb25zZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB0b2tlbkNoYW5nZSA9ICh0b2tlbikgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0b2tlbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjsgLy8gSWdub3JlIHRva2VuIGV4cGlyYXRpb25zLlxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy50b2tlbkNoYW5nZUxpc3RlbmVycy5kZWxldGUodG9rZW5DaGFuZ2UpO1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh0b2tlbik7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHRoaXMudG9rZW5DaGFuZ2VMaXN0ZW5lcnMuYWRkKHRva2VuQ2hhbmdlKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuaXNJbnZpc2libGUpIHtcclxuICAgICAgICAgICAgICAgIHJlY2FwdGNoYS5leGVjdXRlKGlkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBSZW5kZXJzIHRoZSByZUNBUFRDSEEgd2lkZ2V0IG9uIHRoZSBwYWdlLlxyXG4gICAgICpcclxuICAgICAqIEByZXR1cm5zIEEgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHdpdGggdGhlIHJlQ0FQVENIQSB3aWRnZXQgSUQuXHJcbiAgICAgKi9cclxuICAgIHJlbmRlcigpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICB0aGlzLmFzc2VydE5vdERlc3Ryb3llZCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAvLyBUaGlzIG1ldGhvZCByZXR1cm5zIGEgcHJvbWlzZS4gU2luY2UgaXQncyBub3QgYXN5bmMgKHdlIHdhbnQgdG8gcmV0dXJuIHRoZVxyXG4gICAgICAgICAgICAvLyBfc2FtZV8gcHJvbWlzZSBpZiByZW5kZXJpbmcgaXMgc3RpbGwgb2NjdXJyaW5nKSwgdGhlIEFQSSBzdXJmYWNlIHNob3VsZFxyXG4gICAgICAgICAgICAvLyByZWplY3Qgd2l0aCB0aGUgZXJyb3IgcmF0aGVyIHRoYW4ganVzdCB0aHJvd1xyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnJlbmRlclByb21pc2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVuZGVyUHJvbWlzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5yZW5kZXJQcm9taXNlID0gdGhpcy5tYWtlUmVuZGVyUHJvbWlzZSgpLmNhdGNoKGUgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlclByb21pc2UgPSBudWxsO1xyXG4gICAgICAgICAgICB0aHJvdyBlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJlbmRlclByb21pc2U7XHJcbiAgICB9XHJcbiAgICAvKiogQGludGVybmFsICovXHJcbiAgICBfcmVzZXQoKSB7XHJcbiAgICAgICAgdGhpcy5hc3NlcnROb3REZXN0cm95ZWQoKTtcclxuICAgICAgICBpZiAodGhpcy53aWRnZXRJZCAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLmdldEFzc2VydGVkUmVjYXB0Y2hhKCkucmVzZXQodGhpcy53aWRnZXRJZCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBDbGVhcnMgdGhlIHJlQ0FQVENIQSB3aWRnZXQgZnJvbSB0aGUgcGFnZSBhbmQgZGVzdHJveXMgdGhlIGluc3RhbmNlLlxyXG4gICAgICovXHJcbiAgICBjbGVhcigpIHtcclxuICAgICAgICB0aGlzLmFzc2VydE5vdERlc3Ryb3llZCgpO1xyXG4gICAgICAgIHRoaXMuZGVzdHJveWVkID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLl9yZWNhcHRjaGFMb2FkZXIuY2xlYXJlZE9uZUluc3RhbmNlKCk7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzSW52aXNpYmxlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVyLmNoaWxkTm9kZXMuZm9yRWFjaChub2RlID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyLnJlbW92ZUNoaWxkKG5vZGUpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICB2YWxpZGF0ZVN0YXJ0aW5nU3RhdGUoKSB7XHJcbiAgICAgICAgX2Fzc2VydCghdGhpcy5wYXJhbWV0ZXJzLnNpdGVrZXksIHRoaXMuYXV0aCwgXCJhcmd1bWVudC1lcnJvclwiIC8qIEFSR1VNRU5UX0VSUk9SICovKTtcclxuICAgICAgICBfYXNzZXJ0KHRoaXMuaXNJbnZpc2libGUgfHwgIXRoaXMuY29udGFpbmVyLmhhc0NoaWxkTm9kZXMoKSwgdGhpcy5hdXRoLCBcImFyZ3VtZW50LWVycm9yXCIgLyogQVJHVU1FTlRfRVJST1IgKi8pO1xyXG4gICAgICAgIF9hc3NlcnQodHlwZW9mIGRvY3VtZW50ICE9PSAndW5kZWZpbmVkJywgdGhpcy5hdXRoLCBcIm9wZXJhdGlvbi1ub3Qtc3VwcG9ydGVkLWluLXRoaXMtZW52aXJvbm1lbnRcIiAvKiBPUEVSQVRJT05fTk9UX1NVUFBPUlRFRCAqLyk7XHJcbiAgICB9XHJcbiAgICBtYWtlVG9rZW5DYWxsYmFjayhleGlzdGluZykge1xyXG4gICAgICAgIHJldHVybiB0b2tlbiA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMudG9rZW5DaGFuZ2VMaXN0ZW5lcnMuZm9yRWFjaChsaXN0ZW5lciA9PiBsaXN0ZW5lcih0b2tlbikpO1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGV4aXN0aW5nID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgICBleGlzdGluZyh0b2tlbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mIGV4aXN0aW5nID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZ2xvYmFsRnVuYyA9IF93aW5kb3coKVtleGlzdGluZ107XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGdsb2JhbEZ1bmMgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgICAgICAgICBnbG9iYWxGdW5jKHRva2VuKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbiAgICBhc3NlcnROb3REZXN0cm95ZWQoKSB7XHJcbiAgICAgICAgX2Fzc2VydCghdGhpcy5kZXN0cm95ZWQsIHRoaXMuYXV0aCwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIElOVEVSTkFMX0VSUk9SICovKTtcclxuICAgIH1cclxuICAgIGFzeW5jIG1ha2VSZW5kZXJQcm9taXNlKCkge1xyXG4gICAgICAgIGF3YWl0IHRoaXMuaW5pdCgpO1xyXG4gICAgICAgIGlmICghdGhpcy53aWRnZXRJZCkge1xyXG4gICAgICAgICAgICBsZXQgY29udGFpbmVyID0gdGhpcy5jb250YWluZXI7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5pc0ludmlzaWJsZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZ3VhcmFudGVlZEVtcHR5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoZ3VhcmFudGVlZEVtcHR5KTtcclxuICAgICAgICAgICAgICAgIGNvbnRhaW5lciA9IGd1YXJhbnRlZWRFbXB0eTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLndpZGdldElkID0gdGhpcy5nZXRBc3NlcnRlZFJlY2FwdGNoYSgpLnJlbmRlcihjb250YWluZXIsIHRoaXMucGFyYW1ldGVycyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLndpZGdldElkO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgaW5pdCgpIHtcclxuICAgICAgICBfYXNzZXJ0KF9pc0h0dHBPckh0dHBzKCkgJiYgIV9pc1dvcmtlcigpLCB0aGlzLmF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyk7XHJcbiAgICAgICAgYXdhaXQgZG9tUmVhZHkoKTtcclxuICAgICAgICB0aGlzLnJlY2FwdGNoYSA9IGF3YWl0IHRoaXMuX3JlY2FwdGNoYUxvYWRlci5sb2FkKHRoaXMuYXV0aCwgdGhpcy5hdXRoLmxhbmd1YWdlQ29kZSB8fCB1bmRlZmluZWQpO1xyXG4gICAgICAgIGNvbnN0IHNpdGVLZXkgPSBhd2FpdCBnZXRSZWNhcHRjaGFQYXJhbXModGhpcy5hdXRoKTtcclxuICAgICAgICBfYXNzZXJ0KHNpdGVLZXksIHRoaXMuYXV0aCwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIElOVEVSTkFMX0VSUk9SICovKTtcclxuICAgICAgICB0aGlzLnBhcmFtZXRlcnMuc2l0ZWtleSA9IHNpdGVLZXk7XHJcbiAgICB9XHJcbiAgICBnZXRBc3NlcnRlZFJlY2FwdGNoYSgpIHtcclxuICAgICAgICBfYXNzZXJ0KHRoaXMucmVjYXB0Y2hhLCB0aGlzLmF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmVjYXB0Y2hhO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGRvbVJlYWR5KCkge1xyXG4gICAgbGV0IHJlc29sdmVyID0gbnVsbDtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcclxuICAgICAgICBpZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gJ2NvbXBsZXRlJykge1xyXG4gICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gRG9jdW1lbnQgbm90IHJlYWR5LCB3YWl0IGZvciBsb2FkIGJlZm9yZSByZXNvbHZpbmcuXHJcbiAgICAgICAgLy8gU2F2ZSByZXNvbHZlciwgc28gd2UgY2FuIHJlbW92ZSBsaXN0ZW5lciBpbiBjYXNlIGl0IHdhcyBleHRlcm5hbGx5XHJcbiAgICAgICAgLy8gY2FuY2VsbGVkLlxyXG4gICAgICAgIHJlc29sdmVyID0gKCkgPT4gcmVzb2x2ZSgpO1xyXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgcmVzb2x2ZXIpO1xyXG4gICAgfSkuY2F0Y2goZSA9PiB7XHJcbiAgICAgICAgaWYgKHJlc29sdmVyKSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdsb2FkJywgcmVzb2x2ZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aHJvdyBlO1xyXG4gICAgfSk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuY2xhc3MgQ29uZmlybWF0aW9uUmVzdWx0SW1wbCB7XHJcbiAgICBjb25zdHJ1Y3Rvcih2ZXJpZmljYXRpb25JZCwgb25Db25maXJtYXRpb24pIHtcclxuICAgICAgICB0aGlzLnZlcmlmaWNhdGlvbklkID0gdmVyaWZpY2F0aW9uSWQ7XHJcbiAgICAgICAgdGhpcy5vbkNvbmZpcm1hdGlvbiA9IG9uQ29uZmlybWF0aW9uO1xyXG4gICAgfVxyXG4gICAgY29uZmlybSh2ZXJpZmljYXRpb25Db2RlKSB7XHJcbiAgICAgICAgY29uc3QgYXV0aENyZWRlbnRpYWwgPSBQaG9uZUF1dGhDcmVkZW50aWFsLl9mcm9tVmVyaWZpY2F0aW9uKHRoaXMudmVyaWZpY2F0aW9uSWQsIHZlcmlmaWNhdGlvbkNvZGUpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLm9uQ29uZmlybWF0aW9uKGF1dGhDcmVkZW50aWFsKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogQXN5bmNocm9ub3VzbHkgc2lnbnMgaW4gdXNpbmcgYSBwaG9uZSBudW1iZXIuXHJcbiAqXHJcbiAqIEByZW1hcmtzXHJcbiAqIFRoaXMgbWV0aG9kIHNlbmRzIGEgY29kZSB2aWEgU01TIHRvIHRoZSBnaXZlblxyXG4gKiBwaG9uZSBudW1iZXIsIGFuZCByZXR1cm5zIGEge0BsaW5rIENvbmZpcm1hdGlvblJlc3VsdH0uIEFmdGVyIHRoZSB1c2VyXHJcbiAqIHByb3ZpZGVzIHRoZSBjb2RlIHNlbnQgdG8gdGhlaXIgcGhvbmUsIGNhbGwge0BsaW5rIENvbmZpcm1hdGlvblJlc3VsdC5jb25maXJtfVxyXG4gKiB3aXRoIHRoZSBjb2RlIHRvIHNpZ24gdGhlIHVzZXIgaW4uXHJcbiAqXHJcbiAqIEZvciBhYnVzZSBwcmV2ZW50aW9uLCB0aGlzIG1ldGhvZCBhbHNvIHJlcXVpcmVzIGEge0BsaW5rIEFwcGxpY2F0aW9uVmVyaWZpZXJ9LlxyXG4gKiBUaGlzIFNESyBpbmNsdWRlcyBhIHJlQ0FQVENIQS1iYXNlZCBpbXBsZW1lbnRhdGlvbiwge0BsaW5rIFJlY2FwdGNoYVZlcmlmaWVyfS5cclxuICpcclxuICogQGV4YW1wbGVcclxuICogYGBgamF2YXNjcmlwdFxyXG4gKiAvLyAncmVjYXB0Y2hhLWNvbnRhaW5lcicgaXMgdGhlIElEIG9mIGFuIGVsZW1lbnQgaW4gdGhlIERPTS5cclxuICogY29uc3QgYXBwbGljYXRpb25WZXJpZmllciA9IG5ldyBmaXJlYmFzZS5hdXRoLlJlY2FwdGNoYVZlcmlmaWVyKCdyZWNhcHRjaGEtY29udGFpbmVyJyk7XHJcbiAqIGNvbnN0IGNvbmZpcm1hdGlvblJlc3VsdCA9IGF3YWl0IHNpZ25JbldpdGhQaG9uZU51bWJlcihhdXRoLCBwaG9uZU51bWJlciwgYXBwbGljYXRpb25WZXJpZmllcik7XHJcbiAqIC8vIE9idGFpbiBhIHZlcmlmaWNhdGlvbkNvZGUgZnJvbSB0aGUgdXNlci5cclxuICogY29uc3QgY3JlZGVudGlhbCA9IGF3YWl0IGNvbmZpcm1hdGlvblJlc3VsdC5jb25maXJtKHZlcmlmaWNhdGlvbkNvZGUpO1xyXG4gKiBgYGBcclxuICpcclxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxyXG4gKiBAcGFyYW0gcGhvbmVOdW1iZXIgLSBUaGUgdXNlcidzIHBob25lIG51bWJlciBpbiBFLjE2NCBmb3JtYXQgKGUuZy4gKzE2NTA1NTUwMTAxKS5cclxuICogQHBhcmFtIGFwcFZlcmlmaWVyIC0gVGhlIHtAbGluayBBcHBsaWNhdGlvblZlcmlmaWVyfS5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gc2lnbkluV2l0aFBob25lTnVtYmVyKGF1dGgsIHBob25lTnVtYmVyLCBhcHBWZXJpZmllcikge1xyXG4gICAgY29uc3QgYXV0aEludGVybmFsID0gX2Nhc3RBdXRoKGF1dGgpO1xyXG4gICAgY29uc3QgdmVyaWZpY2F0aW9uSWQgPSBhd2FpdCBfdmVyaWZ5UGhvbmVOdW1iZXIoYXV0aEludGVybmFsLCBwaG9uZU51bWJlciwgZ2V0TW9kdWxhckluc3RhbmNlKGFwcFZlcmlmaWVyKSk7XHJcbiAgICByZXR1cm4gbmV3IENvbmZpcm1hdGlvblJlc3VsdEltcGwodmVyaWZpY2F0aW9uSWQsIGNyZWQgPT4gc2lnbkluV2l0aENyZWRlbnRpYWwoYXV0aEludGVybmFsLCBjcmVkKSk7XHJcbn1cclxuLyoqXHJcbiAqIExpbmtzIHRoZSB1c2VyIGFjY291bnQgd2l0aCB0aGUgZ2l2ZW4gcGhvbmUgbnVtYmVyLlxyXG4gKlxyXG4gKiBAcGFyYW0gdXNlciAtIFRoZSB1c2VyLlxyXG4gKiBAcGFyYW0gcGhvbmVOdW1iZXIgLSBUaGUgdXNlcidzIHBob25lIG51bWJlciBpbiBFLjE2NCBmb3JtYXQgKGUuZy4gKzE2NTA1NTUwMTAxKS5cclxuICogQHBhcmFtIGFwcFZlcmlmaWVyIC0gVGhlIHtAbGluayBBcHBsaWNhdGlvblZlcmlmaWVyfS5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gbGlua1dpdGhQaG9uZU51bWJlcih1c2VyLCBwaG9uZU51bWJlciwgYXBwVmVyaWZpZXIpIHtcclxuICAgIGNvbnN0IHVzZXJJbnRlcm5hbCA9IGdldE1vZHVsYXJJbnN0YW5jZSh1c2VyKTtcclxuICAgIGF3YWl0IF9hc3NlcnRMaW5rZWRTdGF0dXMoZmFsc2UsIHVzZXJJbnRlcm5hbCwgXCJwaG9uZVwiIC8qIFBIT05FICovKTtcclxuICAgIGNvbnN0IHZlcmlmaWNhdGlvbklkID0gYXdhaXQgX3ZlcmlmeVBob25lTnVtYmVyKHVzZXJJbnRlcm5hbC5hdXRoLCBwaG9uZU51bWJlciwgZ2V0TW9kdWxhckluc3RhbmNlKGFwcFZlcmlmaWVyKSk7XHJcbiAgICByZXR1cm4gbmV3IENvbmZpcm1hdGlvblJlc3VsdEltcGwodmVyaWZpY2F0aW9uSWQsIGNyZWQgPT4gbGlua1dpdGhDcmVkZW50aWFsKHVzZXJJbnRlcm5hbCwgY3JlZCkpO1xyXG59XHJcbi8qKlxyXG4gKiBSZS1hdXRoZW50aWNhdGVzIGEgdXNlciB1c2luZyBhIGZyZXNoIHBob25lIGNyZWRlbnRpYWwuXHJcbiAqXHJcbiAqIEByZW1hcmtzIFVzZSBiZWZvcmUgb3BlcmF0aW9ucyBzdWNoIGFzIHtAbGluayB1cGRhdGVQYXNzd29yZH0gdGhhdCByZXF1aXJlIHRva2VucyBmcm9tIHJlY2VudCBzaWduLWluIGF0dGVtcHRzLlxyXG4gKlxyXG4gKiBAcGFyYW0gdXNlciAtIFRoZSB1c2VyLlxyXG4gKiBAcGFyYW0gcGhvbmVOdW1iZXIgLSBUaGUgdXNlcidzIHBob25lIG51bWJlciBpbiBFLjE2NCBmb3JtYXQgKGUuZy4gKzE2NTA1NTUwMTAxKS5cclxuICogQHBhcmFtIGFwcFZlcmlmaWVyIC0gVGhlIHtAbGluayBBcHBsaWNhdGlvblZlcmlmaWVyfS5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gcmVhdXRoZW50aWNhdGVXaXRoUGhvbmVOdW1iZXIodXNlciwgcGhvbmVOdW1iZXIsIGFwcFZlcmlmaWVyKSB7XHJcbiAgICBjb25zdCB1c2VySW50ZXJuYWwgPSBnZXRNb2R1bGFySW5zdGFuY2UodXNlcik7XHJcbiAgICBjb25zdCB2ZXJpZmljYXRpb25JZCA9IGF3YWl0IF92ZXJpZnlQaG9uZU51bWJlcih1c2VySW50ZXJuYWwuYXV0aCwgcGhvbmVOdW1iZXIsIGdldE1vZHVsYXJJbnN0YW5jZShhcHBWZXJpZmllcikpO1xyXG4gICAgcmV0dXJuIG5ldyBDb25maXJtYXRpb25SZXN1bHRJbXBsKHZlcmlmaWNhdGlvbklkLCBjcmVkID0+IHJlYXV0aGVudGljYXRlV2l0aENyZWRlbnRpYWwodXNlckludGVybmFsLCBjcmVkKSk7XHJcbn1cclxuLyoqXHJcbiAqIFJldHVybnMgYSB2ZXJpZmljYXRpb24gSUQgdG8gYmUgdXNlZCBpbiBjb25qdW5jdGlvbiB3aXRoIHRoZSBTTVMgY29kZSB0aGF0IGlzIHNlbnQuXHJcbiAqXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBfdmVyaWZ5UGhvbmVOdW1iZXIoYXV0aCwgb3B0aW9ucywgdmVyaWZpZXIpIHtcclxuICAgIHZhciBfYTtcclxuICAgIGNvbnN0IHJlY2FwdGNoYVRva2VuID0gYXdhaXQgdmVyaWZpZXIudmVyaWZ5KCk7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIF9hc3NlcnQodHlwZW9mIHJlY2FwdGNoYVRva2VuID09PSAnc3RyaW5nJywgYXV0aCwgXCJhcmd1bWVudC1lcnJvclwiIC8qIEFSR1VNRU5UX0VSUk9SICovKTtcclxuICAgICAgICBfYXNzZXJ0KHZlcmlmaWVyLnR5cGUgPT09IFJFQ0FQVENIQV9WRVJJRklFUl9UWVBFLCBhdXRoLCBcImFyZ3VtZW50LWVycm9yXCIgLyogQVJHVU1FTlRfRVJST1IgKi8pO1xyXG4gICAgICAgIGxldCBwaG9uZUluZm9PcHRpb25zO1xyXG4gICAgICAgIGlmICh0eXBlb2Ygb3B0aW9ucyA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgcGhvbmVJbmZvT3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgICAgIHBob25lTnVtYmVyOiBvcHRpb25zXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBwaG9uZUluZm9PcHRpb25zID0gb3B0aW9ucztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCdzZXNzaW9uJyBpbiBwaG9uZUluZm9PcHRpb25zKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHNlc3Npb24gPSBwaG9uZUluZm9PcHRpb25zLnNlc3Npb247XHJcbiAgICAgICAgICAgIGlmICgncGhvbmVOdW1iZXInIGluIHBob25lSW5mb09wdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgIF9hc3NlcnQoc2Vzc2lvbi50eXBlID09PSBcImVucm9sbFwiIC8qIEVOUk9MTCAqLywgYXV0aCwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIElOVEVSTkFMX0VSUk9SICovKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgc3RhcnRFbnJvbGxQaG9uZU1mYShhdXRoLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWRUb2tlbjogc2Vzc2lvbi5jcmVkZW50aWFsLFxyXG4gICAgICAgICAgICAgICAgICAgIHBob25lRW5yb2xsbWVudEluZm86IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGhvbmVOdW1iZXI6IHBob25lSW5mb09wdGlvbnMucGhvbmVOdW1iZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY2FwdGNoYVRva2VuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UucGhvbmVTZXNzaW9uSW5mby5zZXNzaW9uSW5mbztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIF9hc3NlcnQoc2Vzc2lvbi50eXBlID09PSBcInNpZ25pblwiIC8qIFNJR05fSU4gKi8sIGF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBtZmFFbnJvbGxtZW50SWQgPSAoKF9hID0gcGhvbmVJbmZvT3B0aW9ucy5tdWx0aUZhY3RvckhpbnQpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS51aWQpIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgcGhvbmVJbmZvT3B0aW9ucy5tdWx0aUZhY3RvclVpZDtcclxuICAgICAgICAgICAgICAgIF9hc3NlcnQobWZhRW5yb2xsbWVudElkLCBhdXRoLCBcIm1pc3NpbmctbXVsdGktZmFjdG9yLWluZm9cIiAvKiBNSVNTSU5HX01GQV9JTkZPICovKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgc3RhcnRTaWduSW5QaG9uZU1mYShhdXRoLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWZhUGVuZGluZ0NyZWRlbnRpYWw6IHNlc3Npb24uY3JlZGVudGlhbCxcclxuICAgICAgICAgICAgICAgICAgICBtZmFFbnJvbGxtZW50SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgcGhvbmVTaWduSW5JbmZvOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY2FwdGNoYVRva2VuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UucGhvbmVSZXNwb25zZUluZm8uc2Vzc2lvbkluZm87XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHsgc2Vzc2lvbkluZm8gfSA9IGF3YWl0IHNlbmRQaG9uZVZlcmlmaWNhdGlvbkNvZGUoYXV0aCwge1xyXG4gICAgICAgICAgICAgICAgcGhvbmVOdW1iZXI6IHBob25lSW5mb09wdGlvbnMucGhvbmVOdW1iZXIsXHJcbiAgICAgICAgICAgICAgICByZWNhcHRjaGFUb2tlblxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIHNlc3Npb25JbmZvO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGZpbmFsbHkge1xyXG4gICAgICAgIHZlcmlmaWVyLl9yZXNldCgpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBVcGRhdGVzIHRoZSB1c2VyJ3MgcGhvbmUgbnVtYmVyLlxyXG4gKlxyXG4gKiBAZXhhbXBsZVxyXG4gKiBgYGBcclxuICogLy8gJ3JlY2FwdGNoYS1jb250YWluZXInIGlzIHRoZSBJRCBvZiBhbiBlbGVtZW50IGluIHRoZSBET00uXHJcbiAqIGNvbnN0IGFwcGxpY2F0aW9uVmVyaWZpZXIgPSBuZXcgUmVjYXB0Y2hhVmVyaWZpZXIoJ3JlY2FwdGNoYS1jb250YWluZXInKTtcclxuICogY29uc3QgcHJvdmlkZXIgPSBuZXcgUGhvbmVBdXRoUHJvdmlkZXIoYXV0aCk7XHJcbiAqIGNvbnN0IHZlcmlmaWNhdGlvbklkID0gYXdhaXQgcHJvdmlkZXIudmVyaWZ5UGhvbmVOdW1iZXIoJysxNjUwNTU1MDEwMScsIGFwcGxpY2F0aW9uVmVyaWZpZXIpO1xyXG4gKiAvLyBPYnRhaW4gdGhlIHZlcmlmaWNhdGlvbkNvZGUgZnJvbSB0aGUgdXNlci5cclxuICogY29uc3QgcGhvbmVDcmVkZW50aWFsID0gUGhvbmVBdXRoUHJvdmlkZXIuY3JlZGVudGlhbCh2ZXJpZmljYXRpb25JZCwgdmVyaWZpY2F0aW9uQ29kZSk7XHJcbiAqIGF3YWl0IHVwZGF0ZVBob25lTnVtYmVyKHVzZXIsIHBob25lQ3JlZGVudGlhbCk7XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBAcGFyYW0gdXNlciAtIFRoZSB1c2VyLlxyXG4gKiBAcGFyYW0gY3JlZGVudGlhbCAtIEEgY3JlZGVudGlhbCBhdXRoZW50aWNhdGluZyB0aGUgbmV3IHBob25lIG51bWJlci5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gdXBkYXRlUGhvbmVOdW1iZXIodXNlciwgY3JlZGVudGlhbCkge1xyXG4gICAgYXdhaXQgX2xpbmskMShnZXRNb2R1bGFySW5zdGFuY2UodXNlciksIGNyZWRlbnRpYWwpO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBQcm92aWRlciBmb3IgZ2VuZXJhdGluZyBhbiB7QGxpbmsgUGhvbmVBdXRoQ3JlZGVudGlhbH0uXHJcbiAqXHJcbiAqIEBleGFtcGxlXHJcbiAqIGBgYGphdmFzY3JpcHRcclxuICogLy8gJ3JlY2FwdGNoYS1jb250YWluZXInIGlzIHRoZSBJRCBvZiBhbiBlbGVtZW50IGluIHRoZSBET00uXHJcbiAqIGNvbnN0IGFwcGxpY2F0aW9uVmVyaWZpZXIgPSBuZXcgUmVjYXB0Y2hhVmVyaWZpZXIoJ3JlY2FwdGNoYS1jb250YWluZXInKTtcclxuICogY29uc3QgcHJvdmlkZXIgPSBuZXcgUGhvbmVBdXRoUHJvdmlkZXIoYXV0aCk7XHJcbiAqIGNvbnN0IHZlcmlmaWNhdGlvbklkID0gYXdhaXQgcHJvdmlkZXIudmVyaWZ5UGhvbmVOdW1iZXIoJysxNjUwNTU1MDEwMScsIGFwcGxpY2F0aW9uVmVyaWZpZXIpO1xyXG4gKiAvLyBPYnRhaW4gdGhlIHZlcmlmaWNhdGlvbkNvZGUgZnJvbSB0aGUgdXNlci5cclxuICogY29uc3QgcGhvbmVDcmVkZW50aWFsID0gUGhvbmVBdXRoUHJvdmlkZXIuY3JlZGVudGlhbCh2ZXJpZmljYXRpb25JZCwgdmVyaWZpY2F0aW9uQ29kZSk7XHJcbiAqIGNvbnN0IHVzZXJDcmVkZW50aWFsID0gYXdhaXQgc2lnbkluV2l0aENyZWRlbnRpYWwoYXV0aCwgcGhvbmVDcmVkZW50aWFsKTtcclxuICogYGBgXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmNsYXNzIFBob25lQXV0aFByb3ZpZGVyIHtcclxuICAgIC8qKlxyXG4gICAgICogQHBhcmFtIGF1dGggLSBUaGUgRmlyZWJhc2Uge0BsaW5rIEF1dGh9IGluc3RhbmNlIGluIHdoaWNoIHNpZ24taW5zIHNob3VsZCBvY2N1ci5cclxuICAgICAqXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKGF1dGgpIHtcclxuICAgICAgICAvKiogQWx3YXlzIHNldCB0byB7QGxpbmsgUHJvdmlkZXJJZH0uUEhPTkUuICovXHJcbiAgICAgICAgdGhpcy5wcm92aWRlcklkID0gUGhvbmVBdXRoUHJvdmlkZXIuUFJPVklERVJfSUQ7XHJcbiAgICAgICAgdGhpcy5hdXRoID0gX2Nhc3RBdXRoKGF1dGgpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKlxyXG4gICAgICogU3RhcnRzIGEgcGhvbmUgbnVtYmVyIGF1dGhlbnRpY2F0aW9uIGZsb3cgYnkgc2VuZGluZyBhIHZlcmlmaWNhdGlvbiBjb2RlIHRvIHRoZSBnaXZlbiBwaG9uZVxyXG4gICAgICogbnVtYmVyLlxyXG4gICAgICpcclxuICAgICAqIEBleGFtcGxlXHJcbiAgICAgKiBgYGBqYXZhc2NyaXB0XHJcbiAgICAgKiBjb25zdCBwcm92aWRlciA9IG5ldyBQaG9uZUF1dGhQcm92aWRlcihhdXRoKTtcclxuICAgICAqIGNvbnN0IHZlcmlmaWNhdGlvbklkID0gYXdhaXQgcHJvdmlkZXIudmVyaWZ5UGhvbmVOdW1iZXIocGhvbmVOdW1iZXIsIGFwcGxpY2F0aW9uVmVyaWZpZXIpO1xyXG4gICAgICogLy8gT2J0YWluIHZlcmlmaWNhdGlvbkNvZGUgZnJvbSB0aGUgdXNlci5cclxuICAgICAqIGNvbnN0IGF1dGhDcmVkZW50aWFsID0gUGhvbmVBdXRoUHJvdmlkZXIuY3JlZGVudGlhbCh2ZXJpZmljYXRpb25JZCwgdmVyaWZpY2F0aW9uQ29kZSk7XHJcbiAgICAgKiBjb25zdCB1c2VyQ3JlZGVudGlhbCA9IGF3YWl0IHNpZ25JbldpdGhDcmVkZW50aWFsKGF1dGgsIGF1dGhDcmVkZW50aWFsKTtcclxuICAgICAqIGBgYFxyXG4gICAgICpcclxuICAgICAqIEBleGFtcGxlXHJcbiAgICAgKiBBbiBhbHRlcm5hdGl2ZSBmbG93IGlzIHByb3ZpZGVkIHVzaW5nIHRoZSBgc2lnbkluV2l0aFBob25lTnVtYmVyYCBtZXRob2QuXHJcbiAgICAgKiBgYGBqYXZhc2NyaXB0XHJcbiAgICAgKiBjb25zdCBjb25maXJtYXRpb25SZXN1bHQgPSBzaWduSW5XaXRoUGhvbmVOdW1iZXIoYXV0aCwgcGhvbmVOdW1iZXIsIGFwcGxpY2F0aW9uVmVyaWZpZXIpO1xyXG4gICAgICogLy8gT2J0YWluIHZlcmlmaWNhdGlvbkNvZGUgZnJvbSB0aGUgdXNlci5cclxuICAgICAqIGNvbnN0IHVzZXJDcmVkZW50aWFsID0gY29uZmlybWF0aW9uUmVzdWx0LmNvbmZpcm0odmVyaWZpY2F0aW9uQ29kZSk7XHJcbiAgICAgKiBgYGBcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gcGhvbmVJbmZvT3B0aW9ucyAtIFRoZSB1c2VyJ3Mge0BsaW5rIFBob25lSW5mb09wdGlvbnN9LiBUaGUgcGhvbmUgbnVtYmVyIHNob3VsZCBiZSBpblxyXG4gICAgICogRS4xNjQgZm9ybWF0IChlLmcuICsxNjUwNTU1MDEwMSkuXHJcbiAgICAgKiBAcGFyYW0gYXBwbGljYXRpb25WZXJpZmllciAtIEZvciBhYnVzZSBwcmV2ZW50aW9uLCB0aGlzIG1ldGhvZCBhbHNvIHJlcXVpcmVzIGFcclxuICAgICAqIHtAbGluayBBcHBsaWNhdGlvblZlcmlmaWVyfS4gVGhpcyBTREsgaW5jbHVkZXMgYSByZUNBUFRDSEEtYmFzZWQgaW1wbGVtZW50YXRpb24sXHJcbiAgICAgKiB7QGxpbmsgUmVjYXB0Y2hhVmVyaWZpZXJ9LlxyXG4gICAgICpcclxuICAgICAqIEByZXR1cm5zIEEgUHJvbWlzZSBmb3IgYSB2ZXJpZmljYXRpb24gSUQgdGhhdCBjYW4gYmUgcGFzc2VkIHRvXHJcbiAgICAgKiB7QGxpbmsgUGhvbmVBdXRoUHJvdmlkZXIuY3JlZGVudGlhbH0gdG8gaWRlbnRpZnkgdGhpcyBmbG93Li5cclxuICAgICAqL1xyXG4gICAgdmVyaWZ5UGhvbmVOdW1iZXIocGhvbmVPcHRpb25zLCBhcHBsaWNhdGlvblZlcmlmaWVyKSB7XHJcbiAgICAgICAgcmV0dXJuIF92ZXJpZnlQaG9uZU51bWJlcih0aGlzLmF1dGgsIHBob25lT3B0aW9ucywgZ2V0TW9kdWxhckluc3RhbmNlKGFwcGxpY2F0aW9uVmVyaWZpZXIpKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhIHBob25lIGF1dGggY3JlZGVudGlhbCwgZ2l2ZW4gdGhlIHZlcmlmaWNhdGlvbiBJRCBmcm9tXHJcbiAgICAgKiB7QGxpbmsgUGhvbmVBdXRoUHJvdmlkZXIudmVyaWZ5UGhvbmVOdW1iZXJ9IGFuZCB0aGUgY29kZSB0aGF0IHdhcyBzZW50IHRvIHRoZSB1c2VyJ3NcclxuICAgICAqIG1vYmlsZSBkZXZpY2UuXHJcbiAgICAgKlxyXG4gICAgICogQGV4YW1wbGVcclxuICAgICAqIGBgYGphdmFzY3JpcHRcclxuICAgICAqIGNvbnN0IHByb3ZpZGVyID0gbmV3IFBob25lQXV0aFByb3ZpZGVyKGF1dGgpO1xyXG4gICAgICogY29uc3QgdmVyaWZpY2F0aW9uSWQgPSBwcm92aWRlci52ZXJpZnlQaG9uZU51bWJlcihwaG9uZU51bWJlciwgYXBwbGljYXRpb25WZXJpZmllcik7XHJcbiAgICAgKiAvLyBPYnRhaW4gdmVyaWZpY2F0aW9uQ29kZSBmcm9tIHRoZSB1c2VyLlxyXG4gICAgICogY29uc3QgYXV0aENyZWRlbnRpYWwgPSBQaG9uZUF1dGhQcm92aWRlci5jcmVkZW50aWFsKHZlcmlmaWNhdGlvbklkLCB2ZXJpZmljYXRpb25Db2RlKTtcclxuICAgICAqIGNvbnN0IHVzZXJDcmVkZW50aWFsID0gc2lnbkluV2l0aENyZWRlbnRpYWwoYXV0aCwgYXV0aENyZWRlbnRpYWwpO1xyXG4gICAgICogYGBgXHJcbiAgICAgKlxyXG4gICAgICogQGV4YW1wbGVcclxuICAgICAqIEFuIGFsdGVybmF0aXZlIGZsb3cgaXMgcHJvdmlkZWQgdXNpbmcgdGhlIGBzaWduSW5XaXRoUGhvbmVOdW1iZXJgIG1ldGhvZC5cclxuICAgICAqIGBgYGphdmFzY3JpcHRcclxuICAgICAqIGNvbnN0IGNvbmZpcm1hdGlvblJlc3VsdCA9IGF3YWl0IHNpZ25JbldpdGhQaG9uZU51bWJlcihhdXRoLCBwaG9uZU51bWJlciwgYXBwbGljYXRpb25WZXJpZmllcik7XHJcbiAgICAgKiAvLyBPYnRhaW4gdmVyaWZpY2F0aW9uQ29kZSBmcm9tIHRoZSB1c2VyLlxyXG4gICAgICogY29uc3QgdXNlckNyZWRlbnRpYWwgPSBhd2FpdCBjb25maXJtYXRpb25SZXN1bHQuY29uZmlybSh2ZXJpZmljYXRpb25Db2RlKTtcclxuICAgICAqIGBgYFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB2ZXJpZmljYXRpb25JZCAtIFRoZSB2ZXJpZmljYXRpb24gSUQgcmV0dXJuZWQgZnJvbSB7QGxpbmsgUGhvbmVBdXRoUHJvdmlkZXIudmVyaWZ5UGhvbmVOdW1iZXJ9LlxyXG4gICAgICogQHBhcmFtIHZlcmlmaWNhdGlvbkNvZGUgLSBUaGUgdmVyaWZpY2F0aW9uIGNvZGUgc2VudCB0byB0aGUgdXNlcidzIG1vYmlsZSBkZXZpY2UuXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybnMgVGhlIGF1dGggcHJvdmlkZXIgY3JlZGVudGlhbC5cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGNyZWRlbnRpYWwodmVyaWZpY2F0aW9uSWQsIHZlcmlmaWNhdGlvbkNvZGUpIHtcclxuICAgICAgICByZXR1cm4gUGhvbmVBdXRoQ3JlZGVudGlhbC5fZnJvbVZlcmlmaWNhdGlvbih2ZXJpZmljYXRpb25JZCwgdmVyaWZpY2F0aW9uQ29kZSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEdlbmVyYXRlcyBhbiB7QGxpbmsgQXV0aENyZWRlbnRpYWx9IGZyb20gYSB7QGxpbmsgVXNlckNyZWRlbnRpYWx9LlxyXG4gICAgICogQHBhcmFtIHVzZXJDcmVkZW50aWFsIC0gVGhlIHVzZXIgY3JlZGVudGlhbC5cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGNyZWRlbnRpYWxGcm9tUmVzdWx0KHVzZXJDcmVkZW50aWFsKSB7XHJcbiAgICAgICAgY29uc3QgY3JlZGVudGlhbCA9IHVzZXJDcmVkZW50aWFsO1xyXG4gICAgICAgIHJldHVybiBQaG9uZUF1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVRhZ2dlZE9iamVjdChjcmVkZW50aWFsKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyBhbiB7QGxpbmsgQXV0aENyZWRlbnRpYWx9IHdoZW4gcGFzc2VkIGFuIGVycm9yLlxyXG4gICAgICpcclxuICAgICAqIEByZW1hcmtzXHJcbiAgICAgKlxyXG4gICAgICogVGhpcyBtZXRob2Qgd29ya3MgZm9yIGVycm9ycyBsaWtlXHJcbiAgICAgKiBgYXV0aC9hY2NvdW50LWV4aXN0cy13aXRoLWRpZmZlcmVudC1jcmVkZW50aWFsc2AuIFRoaXMgaXMgdXNlZnVsIGZvclxyXG4gICAgICogcmVjb3ZlcmluZyB3aGVuIGF0dGVtcHRpbmcgdG8gc2V0IGEgdXNlcidzIHBob25lIG51bWJlciBidXQgdGhlIG51bWJlclxyXG4gICAgICogaW4gcXVlc3Rpb24gaXMgYWxyZWFkeSB0aWVkIHRvIGFub3RoZXIgYWNjb3VudC4gRm9yIGV4YW1wbGUsIHRoZSBmb2xsb3dpbmdcclxuICAgICAqIGNvZGUgdHJpZXMgdG8gdXBkYXRlIHRoZSBjdXJyZW50IHVzZXIncyBwaG9uZSBudW1iZXIsIGFuZCBpZiB0aGF0XHJcbiAgICAgKiBmYWlscywgbGlua3MgdGhlIHVzZXIgd2l0aCB0aGUgYWNjb3VudCBhc3NvY2lhdGVkIHdpdGggdGhhdCBudW1iZXI6XHJcbiAgICAgKlxyXG4gICAgICogYGBganNcclxuICAgICAqIGNvbnN0IHByb3ZpZGVyID0gbmV3IFBob25lQXV0aFByb3ZpZGVyKGF1dGgpO1xyXG4gICAgICogY29uc3QgdmVyaWZpY2F0aW9uSWQgPSBhd2FpdCBwcm92aWRlci52ZXJpZnlQaG9uZU51bWJlcihudW1iZXIsIHZlcmlmaWVyKTtcclxuICAgICAqIHRyeSB7XHJcbiAgICAgKiAgIGNvbnN0IGNvZGUgPSAnJzsgLy8gUHJvbXB0IHRoZSB1c2VyIGZvciB0aGUgdmVyaWZpY2F0aW9uIGNvZGVcclxuICAgICAqICAgYXdhaXQgdXBkYXRlUGhvbmVOdW1iZXIoXHJcbiAgICAgKiAgICAgICBhdXRoLmN1cnJlbnRVc2VyLFxyXG4gICAgICogICAgICAgUGhvbmVBdXRoUHJvdmlkZXIuY3JlZGVudGlhbCh2ZXJpZmljYXRpb25JZCwgY29kZSkpO1xyXG4gICAgICogfSBjYXRjaCAoZSkge1xyXG4gICAgICogICBpZiAoZS5jb2RlID09PSAnYXV0aC9hY2NvdW50LWV4aXN0cy13aXRoLWRpZmZlcmVudC1jcmVkZW50aWFsJykge1xyXG4gICAgICogICAgIGNvbnN0IGNyZWQgPSBQaG9uZUF1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbUVycm9yKGUpO1xyXG4gICAgICogICAgIGF3YWl0IGxpbmtXaXRoQ3JlZGVudGlhbChhdXRoLmN1cnJlbnRVc2VyLCBjcmVkKTtcclxuICAgICAqICAgfVxyXG4gICAgICogfVxyXG4gICAgICpcclxuICAgICAqIC8vIEF0IHRoaXMgcG9pbnQsIGF1dGguY3VycmVudFVzZXIucGhvbmVOdW1iZXIgPT09IG51bWJlci5cclxuICAgICAqIGBgYFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBlcnJvciAtIFRoZSBlcnJvciB0byBnZW5lcmF0ZSBhIGNyZWRlbnRpYWwgZnJvbS5cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGNyZWRlbnRpYWxGcm9tRXJyb3IoZXJyb3IpIHtcclxuICAgICAgICByZXR1cm4gUGhvbmVBdXRoUHJvdmlkZXIuY3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3QoKGVycm9yLmN1c3RvbURhdGEgfHwge30pKTtcclxuICAgIH1cclxuICAgIHN0YXRpYyBjcmVkZW50aWFsRnJvbVRhZ2dlZE9iamVjdCh7IF90b2tlblJlc3BvbnNlOiB0b2tlblJlc3BvbnNlIH0pIHtcclxuICAgICAgICBpZiAoIXRva2VuUmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHsgcGhvbmVOdW1iZXIsIHRlbXBvcmFyeVByb29mIH0gPSB0b2tlblJlc3BvbnNlO1xyXG4gICAgICAgIGlmIChwaG9uZU51bWJlciAmJiB0ZW1wb3JhcnlQcm9vZikge1xyXG4gICAgICAgICAgICByZXR1cm4gUGhvbmVBdXRoQ3JlZGVudGlhbC5fZnJvbVRva2VuUmVzcG9uc2UocGhvbmVOdW1iZXIsIHRlbXBvcmFyeVByb29mKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbn1cclxuLyoqIEFsd2F5cyBzZXQgdG8ge0BsaW5rIFByb3ZpZGVySWR9LlBIT05FLiAqL1xyXG5QaG9uZUF1dGhQcm92aWRlci5QUk9WSURFUl9JRCA9IFwicGhvbmVcIiAvKiBQSE9ORSAqLztcclxuLyoqIEFsd2F5cyBzZXQgdG8ge0BsaW5rIFNpZ25Jbk1ldGhvZH0uUEhPTkUuICovXHJcblBob25lQXV0aFByb3ZpZGVyLlBIT05FX1NJR05fSU5fTUVUSE9EID0gXCJwaG9uZVwiIC8qIFBIT05FICovO1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjEgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogQ2hvb3NlcyBhIHBvcHVwL3JlZGlyZWN0IHJlc29sdmVyIHRvIHVzZS4gVGhpcyBwcmVmZXJzIHRoZSBvdmVycmlkZSAod2hpY2hcclxuICogaXMgZGlyZWN0bHkgcGFzc2VkIGluKSwgYW5kIGZhbGxzIGJhY2sgdG8gdGhlIHByb3BlcnR5IHNldCBvbiB0aGUgYXV0aFxyXG4gKiBvYmplY3QuIElmIG5laXRoZXIgYXJlIGF2YWlsYWJsZSwgdGhpcyBmdW5jdGlvbiBlcnJvcnMgdy8gYW4gYXJndW1lbnQgZXJyb3IuXHJcbiAqL1xyXG5mdW5jdGlvbiBfd2l0aERlZmF1bHRSZXNvbHZlcihhdXRoLCByZXNvbHZlck92ZXJyaWRlKSB7XHJcbiAgICBpZiAocmVzb2x2ZXJPdmVycmlkZSkge1xyXG4gICAgICAgIHJldHVybiBfZ2V0SW5zdGFuY2UocmVzb2x2ZXJPdmVycmlkZSk7XHJcbiAgICB9XHJcbiAgICBfYXNzZXJ0KGF1dGguX3BvcHVwUmVkaXJlY3RSZXNvbHZlciwgYXV0aCwgXCJhcmd1bWVudC1lcnJvclwiIC8qIEFSR1VNRU5UX0VSUk9SICovKTtcclxuICAgIHJldHVybiBhdXRoLl9wb3B1cFJlZGlyZWN0UmVzb2x2ZXI7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuY2xhc3MgSWRwQ3JlZGVudGlhbCBleHRlbmRzIEF1dGhDcmVkZW50aWFsIHtcclxuICAgIGNvbnN0cnVjdG9yKHBhcmFtcykge1xyXG4gICAgICAgIHN1cGVyKFwiY3VzdG9tXCIgLyogQ1VTVE9NICovLCBcImN1c3RvbVwiIC8qIENVU1RPTSAqLyk7XHJcbiAgICAgICAgdGhpcy5wYXJhbXMgPSBwYXJhbXM7XHJcbiAgICB9XHJcbiAgICBfZ2V0SWRUb2tlblJlc3BvbnNlKGF1dGgpIHtcclxuICAgICAgICByZXR1cm4gc2lnbkluV2l0aElkcChhdXRoLCB0aGlzLl9idWlsZElkcFJlcXVlc3QoKSk7XHJcbiAgICB9XHJcbiAgICBfbGlua1RvSWRUb2tlbihhdXRoLCBpZFRva2VuKSB7XHJcbiAgICAgICAgcmV0dXJuIHNpZ25JbldpdGhJZHAoYXV0aCwgdGhpcy5fYnVpbGRJZHBSZXF1ZXN0KGlkVG9rZW4pKTtcclxuICAgIH1cclxuICAgIF9nZXRSZWF1dGhlbnRpY2F0aW9uUmVzb2x2ZXIoYXV0aCkge1xyXG4gICAgICAgIHJldHVybiBzaWduSW5XaXRoSWRwKGF1dGgsIHRoaXMuX2J1aWxkSWRwUmVxdWVzdCgpKTtcclxuICAgIH1cclxuICAgIF9idWlsZElkcFJlcXVlc3QoaWRUb2tlbikge1xyXG4gICAgICAgIGNvbnN0IHJlcXVlc3QgPSB7XHJcbiAgICAgICAgICAgIHJlcXVlc3RVcmk6IHRoaXMucGFyYW1zLnJlcXVlc3RVcmksXHJcbiAgICAgICAgICAgIHNlc3Npb25JZDogdGhpcy5wYXJhbXMuc2Vzc2lvbklkLFxyXG4gICAgICAgICAgICBwb3N0Qm9keTogdGhpcy5wYXJhbXMucG9zdEJvZHksXHJcbiAgICAgICAgICAgIHRlbmFudElkOiB0aGlzLnBhcmFtcy50ZW5hbnRJZCxcclxuICAgICAgICAgICAgcGVuZGluZ1Rva2VuOiB0aGlzLnBhcmFtcy5wZW5kaW5nVG9rZW4sXHJcbiAgICAgICAgICAgIHJldHVyblNlY3VyZVRva2VuOiB0cnVlLFxyXG4gICAgICAgICAgICByZXR1cm5JZHBDcmVkZW50aWFsOiB0cnVlXHJcbiAgICAgICAgfTtcclxuICAgICAgICBpZiAoaWRUb2tlbikge1xyXG4gICAgICAgICAgICByZXF1ZXN0LmlkVG9rZW4gPSBpZFRva2VuO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVxdWVzdDtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBfc2lnbkluKHBhcmFtcykge1xyXG4gICAgcmV0dXJuIF9zaWduSW5XaXRoQ3JlZGVudGlhbChwYXJhbXMuYXV0aCwgbmV3IElkcENyZWRlbnRpYWwocGFyYW1zKSwgcGFyYW1zLmJ5cGFzc0F1dGhTdGF0ZSk7XHJcbn1cclxuZnVuY3Rpb24gX3JlYXV0aChwYXJhbXMpIHtcclxuICAgIGNvbnN0IHsgYXV0aCwgdXNlciB9ID0gcGFyYW1zO1xyXG4gICAgX2Fzc2VydCh1c2VyLCBhdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8pO1xyXG4gICAgcmV0dXJuIF9yZWF1dGhlbnRpY2F0ZSh1c2VyLCBuZXcgSWRwQ3JlZGVudGlhbChwYXJhbXMpLCBwYXJhbXMuYnlwYXNzQXV0aFN0YXRlKTtcclxufVxyXG5hc3luYyBmdW5jdGlvbiBfbGluayhwYXJhbXMpIHtcclxuICAgIGNvbnN0IHsgYXV0aCwgdXNlciB9ID0gcGFyYW1zO1xyXG4gICAgX2Fzc2VydCh1c2VyLCBhdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8pO1xyXG4gICAgcmV0dXJuIF9saW5rJDEodXNlciwgbmV3IElkcENyZWRlbnRpYWwocGFyYW1zKSwgcGFyYW1zLmJ5cGFzc0F1dGhTdGF0ZSk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFBvcHVwIGV2ZW50IG1hbmFnZXIuIEhhbmRsZXMgdGhlIHBvcHVwJ3MgZW50aXJlIGxpZmVjeWNsZTsgbGlzdGVucyB0byBhdXRoXHJcbiAqIGV2ZW50c1xyXG4gKi9cclxuY2xhc3MgQWJzdHJhY3RQb3B1cFJlZGlyZWN0T3BlcmF0aW9uIHtcclxuICAgIGNvbnN0cnVjdG9yKGF1dGgsIGZpbHRlciwgcmVzb2x2ZXIsIHVzZXIsIGJ5cGFzc0F1dGhTdGF0ZSA9IGZhbHNlKSB7XHJcbiAgICAgICAgdGhpcy5hdXRoID0gYXV0aDtcclxuICAgICAgICB0aGlzLnJlc29sdmVyID0gcmVzb2x2ZXI7XHJcbiAgICAgICAgdGhpcy51c2VyID0gdXNlcjtcclxuICAgICAgICB0aGlzLmJ5cGFzc0F1dGhTdGF0ZSA9IGJ5cGFzc0F1dGhTdGF0ZTtcclxuICAgICAgICB0aGlzLnBlbmRpbmdQcm9taXNlID0gbnVsbDtcclxuICAgICAgICB0aGlzLmV2ZW50TWFuYWdlciA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5maWx0ZXIgPSBBcnJheS5pc0FycmF5KGZpbHRlcikgPyBmaWx0ZXIgOiBbZmlsdGVyXTtcclxuICAgIH1cclxuICAgIGV4ZWN1dGUoKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGFzeW5jIChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5wZW5kaW5nUHJvbWlzZSA9IHsgcmVzb2x2ZSwgcmVqZWN0IH07XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmV2ZW50TWFuYWdlciA9IGF3YWl0IHRoaXMucmVzb2x2ZXIuX2luaXRpYWxpemUodGhpcy5hdXRoKTtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMub25FeGVjdXRpb24oKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZXZlbnRNYW5hZ2VyLnJlZ2lzdGVyQ29uc3VtZXIodGhpcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVqZWN0KGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBhc3luYyBvbkF1dGhFdmVudChldmVudCkge1xyXG4gICAgICAgIGNvbnN0IHsgdXJsUmVzcG9uc2UsIHNlc3Npb25JZCwgcG9zdEJvZHksIHRlbmFudElkLCBlcnJvciwgdHlwZSB9ID0gZXZlbnQ7XHJcbiAgICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVqZWN0KGVycm9yKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBwYXJhbXMgPSB7XHJcbiAgICAgICAgICAgIGF1dGg6IHRoaXMuYXV0aCxcclxuICAgICAgICAgICAgcmVxdWVzdFVyaTogdXJsUmVzcG9uc2UsXHJcbiAgICAgICAgICAgIHNlc3Npb25JZDogc2Vzc2lvbklkLFxyXG4gICAgICAgICAgICB0ZW5hbnRJZDogdGVuYW50SWQgfHwgdW5kZWZpbmVkLFxyXG4gICAgICAgICAgICBwb3N0Qm9keTogcG9zdEJvZHkgfHwgdW5kZWZpbmVkLFxyXG4gICAgICAgICAgICB1c2VyOiB0aGlzLnVzZXIsXHJcbiAgICAgICAgICAgIGJ5cGFzc0F1dGhTdGF0ZTogdGhpcy5ieXBhc3NBdXRoU3RhdGVcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVzb2x2ZShhd2FpdCB0aGlzLmdldElkcFRhc2sodHlwZSkocGFyYW1zKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVqZWN0KGUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIG9uRXJyb3IoZXJyb3IpIHtcclxuICAgICAgICB0aGlzLnJlamVjdChlcnJvcik7XHJcbiAgICB9XHJcbiAgICBnZXRJZHBUYXNrKHR5cGUpIHtcclxuICAgICAgICBzd2l0Y2ggKHR5cGUpIHtcclxuICAgICAgICAgICAgY2FzZSBcInNpZ25JblZpYVBvcHVwXCIgLyogU0lHTl9JTl9WSUFfUE9QVVAgKi86XHJcbiAgICAgICAgICAgIGNhc2UgXCJzaWduSW5WaWFSZWRpcmVjdFwiIC8qIFNJR05fSU5fVklBX1JFRElSRUNUICovOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF9zaWduSW47XHJcbiAgICAgICAgICAgIGNhc2UgXCJsaW5rVmlhUG9wdXBcIiAvKiBMSU5LX1ZJQV9QT1BVUCAqLzpcclxuICAgICAgICAgICAgY2FzZSBcImxpbmtWaWFSZWRpcmVjdFwiIC8qIExJTktfVklBX1JFRElSRUNUICovOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF9saW5rO1xyXG4gICAgICAgICAgICBjYXNlIFwicmVhdXRoVmlhUG9wdXBcIiAvKiBSRUFVVEhfVklBX1BPUFVQICovOlxyXG4gICAgICAgICAgICBjYXNlIFwicmVhdXRoVmlhUmVkaXJlY3RcIiAvKiBSRUFVVEhfVklBX1JFRElSRUNUICovOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF9yZWF1dGg7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICBfZmFpbCh0aGlzLmF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmVzb2x2ZShjcmVkKSB7XHJcbiAgICAgICAgZGVidWdBc3NlcnQodGhpcy5wZW5kaW5nUHJvbWlzZSwgJ1BlbmRpbmcgcHJvbWlzZSB3YXMgbmV2ZXIgc2V0Jyk7XHJcbiAgICAgICAgdGhpcy5wZW5kaW5nUHJvbWlzZS5yZXNvbHZlKGNyZWQpO1xyXG4gICAgICAgIHRoaXMudW5yZWdpc3RlckFuZENsZWFuVXAoKTtcclxuICAgIH1cclxuICAgIHJlamVjdChlcnJvcikge1xyXG4gICAgICAgIGRlYnVnQXNzZXJ0KHRoaXMucGVuZGluZ1Byb21pc2UsICdQZW5kaW5nIHByb21pc2Ugd2FzIG5ldmVyIHNldCcpO1xyXG4gICAgICAgIHRoaXMucGVuZGluZ1Byb21pc2UucmVqZWN0KGVycm9yKTtcclxuICAgICAgICB0aGlzLnVucmVnaXN0ZXJBbmRDbGVhblVwKCk7XHJcbiAgICB9XHJcbiAgICB1bnJlZ2lzdGVyQW5kQ2xlYW5VcCgpIHtcclxuICAgICAgICBpZiAodGhpcy5ldmVudE1hbmFnZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5ldmVudE1hbmFnZXIudW5yZWdpc3RlckNvbnN1bWVyKHRoaXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnBlbmRpbmdQcm9taXNlID0gbnVsbDtcclxuICAgICAgICB0aGlzLmNsZWFuVXAoKTtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jb25zdCBfUE9MTF9XSU5ET1dfQ0xPU0VfVElNRU9VVCA9IG5ldyBEZWxheSgyMDAwLCAxMDAwMCk7XHJcbi8qKlxyXG4gKiBBdXRoZW50aWNhdGVzIGEgRmlyZWJhc2UgY2xpZW50IHVzaW5nIGEgcG9wdXAtYmFzZWQgT0F1dGggYXV0aGVudGljYXRpb24gZmxvdy5cclxuICpcclxuICogQHJlbWFya3NcclxuICogSWYgc3VjY2VlZHMsIHJldHVybnMgdGhlIHNpZ25lZCBpbiB1c2VyIGFsb25nIHdpdGggdGhlIHByb3ZpZGVyJ3MgY3JlZGVudGlhbC4gSWYgc2lnbiBpbiB3YXNcclxuICogdW5zdWNjZXNzZnVsLCByZXR1cm5zIGFuIGVycm9yIG9iamVjdCBjb250YWluaW5nIGFkZGl0aW9uYWwgaW5mb3JtYXRpb24gYWJvdXQgdGhlIGVycm9yLlxyXG4gKlxyXG4gKiBAZXhhbXBsZVxyXG4gKiBgYGBqYXZhc2NyaXB0XHJcbiAqIC8vIFNpZ24gaW4gdXNpbmcgYSBwb3B1cC5cclxuICogY29uc3QgcHJvdmlkZXIgPSBuZXcgRmFjZWJvb2tBdXRoUHJvdmlkZXIoKTtcclxuICogY29uc3QgcmVzdWx0ID0gYXdhaXQgc2lnbkluV2l0aFBvcHVwKGF1dGgsIHByb3ZpZGVyKTtcclxuICpcclxuICogLy8gVGhlIHNpZ25lZC1pbiB1c2VyIGluZm8uXHJcbiAqIGNvbnN0IHVzZXIgPSByZXN1bHQudXNlcjtcclxuICogLy8gVGhpcyBnaXZlcyB5b3UgYSBGYWNlYm9vayBBY2Nlc3MgVG9rZW4uXHJcbiAqIGNvbnN0IGNyZWRlbnRpYWwgPSBwcm92aWRlci5jcmVkZW50aWFsRnJvbVJlc3VsdChhdXRoLCByZXN1bHQpO1xyXG4gKiBjb25zdCB0b2tlbiA9IGNyZWRlbnRpYWwuYWNjZXNzVG9rZW47XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXHJcbiAqIEBwYXJhbSBwcm92aWRlciAtIFRoZSBwcm92aWRlciB0byBhdXRoZW50aWNhdGUuIFRoZSBwcm92aWRlciBoYXMgdG8gYmUgYW4ge0BsaW5rIE9BdXRoUHJvdmlkZXJ9LlxyXG4gKiBOb24tT0F1dGggcHJvdmlkZXJzIGxpa2Uge0BsaW5rIEVtYWlsQXV0aFByb3ZpZGVyfSB3aWxsIHRocm93IGFuIGVycm9yLlxyXG4gKiBAcGFyYW0gcmVzb2x2ZXIgLSBBbiBpbnN0YW5jZSBvZiB7QGxpbmsgUG9wdXBSZWRpcmVjdFJlc29sdmVyfSwgb3B0aW9uYWxcclxuICogaWYgYWxyZWFkeSBzdXBwbGllZCB0byB7QGxpbmsgaW5pdGlhbGl6ZUF1dGh9IG9yIHByb3ZpZGVkIGJ5IHtAbGluayBnZXRBdXRofS5cclxuICpcclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gc2lnbkluV2l0aFBvcHVwKGF1dGgsIHByb3ZpZGVyLCByZXNvbHZlcikge1xyXG4gICAgY29uc3QgYXV0aEludGVybmFsID0gX2Nhc3RBdXRoKGF1dGgpO1xyXG4gICAgX2Fzc2VydChwcm92aWRlciBpbnN0YW5jZW9mIEZlZGVyYXRlZEF1dGhQcm92aWRlciwgYXV0aCwgXCJhcmd1bWVudC1lcnJvclwiIC8qIEFSR1VNRU5UX0VSUk9SICovKTtcclxuICAgIGNvbnN0IHJlc29sdmVySW50ZXJuYWwgPSBfd2l0aERlZmF1bHRSZXNvbHZlcihhdXRoSW50ZXJuYWwsIHJlc29sdmVyKTtcclxuICAgIGNvbnN0IGFjdGlvbiA9IG5ldyBQb3B1cE9wZXJhdGlvbihhdXRoSW50ZXJuYWwsIFwic2lnbkluVmlhUG9wdXBcIiAvKiBTSUdOX0lOX1ZJQV9QT1BVUCAqLywgcHJvdmlkZXIsIHJlc29sdmVySW50ZXJuYWwpO1xyXG4gICAgcmV0dXJuIGFjdGlvbi5leGVjdXRlTm90TnVsbCgpO1xyXG59XHJcbi8qKlxyXG4gKiBSZWF1dGhlbnRpY2F0ZXMgdGhlIGN1cnJlbnQgdXNlciB3aXRoIHRoZSBzcGVjaWZpZWQge0BsaW5rIE9BdXRoUHJvdmlkZXJ9IHVzaW5nIGEgcG9wLXVwIGJhc2VkXHJcbiAqIE9BdXRoIGZsb3cuXHJcbiAqXHJcbiAqIEByZW1hcmtzXHJcbiAqIElmIHRoZSByZWF1dGhlbnRpY2F0aW9uIGlzIHN1Y2Nlc3NmdWwsIHRoZSByZXR1cm5lZCByZXN1bHQgd2lsbCBjb250YWluIHRoZSB1c2VyIGFuZCB0aGVcclxuICogcHJvdmlkZXIncyBjcmVkZW50aWFsLlxyXG4gKlxyXG4gKiBAZXhhbXBsZVxyXG4gKiBgYGBqYXZhc2NyaXB0XHJcbiAqIC8vIFNpZ24gaW4gdXNpbmcgYSBwb3B1cC5cclxuICogY29uc3QgcHJvdmlkZXIgPSBuZXcgRmFjZWJvb2tBdXRoUHJvdmlkZXIoKTtcclxuICogY29uc3QgcmVzdWx0ID0gYXdhaXQgc2lnbkluV2l0aFBvcHVwKGF1dGgsIHByb3ZpZGVyKTtcclxuICogLy8gUmVhdXRoZW50aWNhdGUgdXNpbmcgYSBwb3B1cC5cclxuICogYXdhaXQgcmVhdXRoZW50aWNhdGVXaXRoUG9wdXAocmVzdWx0LnVzZXIsIHByb3ZpZGVyKTtcclxuICogYGBgXHJcbiAqXHJcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXHJcbiAqIEBwYXJhbSBwcm92aWRlciAtIFRoZSBwcm92aWRlciB0byBhdXRoZW50aWNhdGUuIFRoZSBwcm92aWRlciBoYXMgdG8gYmUgYW4ge0BsaW5rIE9BdXRoUHJvdmlkZXJ9LlxyXG4gKiBOb24tT0F1dGggcHJvdmlkZXJzIGxpa2Uge0BsaW5rIEVtYWlsQXV0aFByb3ZpZGVyfSB3aWxsIHRocm93IGFuIGVycm9yLlxyXG4gKiBAcGFyYW0gcmVzb2x2ZXIgLSBBbiBpbnN0YW5jZSBvZiB7QGxpbmsgUG9wdXBSZWRpcmVjdFJlc29sdmVyfSwgb3B0aW9uYWxcclxuICogaWYgYWxyZWFkeSBzdXBwbGllZCB0byB7QGxpbmsgaW5pdGlhbGl6ZUF1dGh9IG9yIHByb3ZpZGVkIGJ5IHtAbGluayBnZXRBdXRofS5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gcmVhdXRoZW50aWNhdGVXaXRoUG9wdXAodXNlciwgcHJvdmlkZXIsIHJlc29sdmVyKSB7XHJcbiAgICBjb25zdCB1c2VySW50ZXJuYWwgPSBnZXRNb2R1bGFySW5zdGFuY2UodXNlcik7XHJcbiAgICBfYXNzZXJ0KHByb3ZpZGVyIGluc3RhbmNlb2YgRmVkZXJhdGVkQXV0aFByb3ZpZGVyLCB1c2VySW50ZXJuYWwuYXV0aCwgXCJhcmd1bWVudC1lcnJvclwiIC8qIEFSR1VNRU5UX0VSUk9SICovKTtcclxuICAgIGNvbnN0IHJlc29sdmVySW50ZXJuYWwgPSBfd2l0aERlZmF1bHRSZXNvbHZlcih1c2VySW50ZXJuYWwuYXV0aCwgcmVzb2x2ZXIpO1xyXG4gICAgY29uc3QgYWN0aW9uID0gbmV3IFBvcHVwT3BlcmF0aW9uKHVzZXJJbnRlcm5hbC5hdXRoLCBcInJlYXV0aFZpYVBvcHVwXCIgLyogUkVBVVRIX1ZJQV9QT1BVUCAqLywgcHJvdmlkZXIsIHJlc29sdmVySW50ZXJuYWwsIHVzZXJJbnRlcm5hbCk7XHJcbiAgICByZXR1cm4gYWN0aW9uLmV4ZWN1dGVOb3ROdWxsKCk7XHJcbn1cclxuLyoqXHJcbiAqIExpbmtzIHRoZSBhdXRoZW50aWNhdGVkIHByb3ZpZGVyIHRvIHRoZSB1c2VyIGFjY291bnQgdXNpbmcgYSBwb3AtdXAgYmFzZWQgT0F1dGggZmxvdy5cclxuICpcclxuICogQHJlbWFya3NcclxuICogSWYgdGhlIGxpbmtpbmcgaXMgc3VjY2Vzc2Z1bCwgdGhlIHJldHVybmVkIHJlc3VsdCB3aWxsIGNvbnRhaW4gdGhlIHVzZXIgYW5kIHRoZSBwcm92aWRlcidzIGNyZWRlbnRpYWwuXHJcbiAqXHJcbiAqXHJcbiAqIEBleGFtcGxlXHJcbiAqIGBgYGphdmFzY3JpcHRcclxuICogLy8gU2lnbiBpbiB1c2luZyBzb21lIG90aGVyIHByb3ZpZGVyLlxyXG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBzaWduSW5XaXRoRW1haWxBbmRQYXNzd29yZChhdXRoLCBlbWFpbCwgcGFzc3dvcmQpO1xyXG4gKiAvLyBMaW5rIHVzaW5nIGEgcG9wdXAuXHJcbiAqIGNvbnN0IHByb3ZpZGVyID0gbmV3IEZhY2Vib29rQXV0aFByb3ZpZGVyKCk7XHJcbiAqIGF3YWl0IGxpbmtXaXRoUG9wdXAocmVzdWx0LnVzZXIsIHByb3ZpZGVyKTtcclxuICogYGBgXHJcbiAqXHJcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXHJcbiAqIEBwYXJhbSBwcm92aWRlciAtIFRoZSBwcm92aWRlciB0byBhdXRoZW50aWNhdGUuIFRoZSBwcm92aWRlciBoYXMgdG8gYmUgYW4ge0BsaW5rIE9BdXRoUHJvdmlkZXJ9LlxyXG4gKiBOb24tT0F1dGggcHJvdmlkZXJzIGxpa2Uge0BsaW5rIEVtYWlsQXV0aFByb3ZpZGVyfSB3aWxsIHRocm93IGFuIGVycm9yLlxyXG4gKiBAcGFyYW0gcmVzb2x2ZXIgLSBBbiBpbnN0YW5jZSBvZiB7QGxpbmsgUG9wdXBSZWRpcmVjdFJlc29sdmVyfSwgb3B0aW9uYWxcclxuICogaWYgYWxyZWFkeSBzdXBwbGllZCB0byB7QGxpbmsgaW5pdGlhbGl6ZUF1dGh9IG9yIHByb3ZpZGVkIGJ5IHtAbGluayBnZXRBdXRofS5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gbGlua1dpdGhQb3B1cCh1c2VyLCBwcm92aWRlciwgcmVzb2x2ZXIpIHtcclxuICAgIGNvbnN0IHVzZXJJbnRlcm5hbCA9IGdldE1vZHVsYXJJbnN0YW5jZSh1c2VyKTtcclxuICAgIF9hc3NlcnQocHJvdmlkZXIgaW5zdGFuY2VvZiBGZWRlcmF0ZWRBdXRoUHJvdmlkZXIsIHVzZXJJbnRlcm5hbC5hdXRoLCBcImFyZ3VtZW50LWVycm9yXCIgLyogQVJHVU1FTlRfRVJST1IgKi8pO1xyXG4gICAgY29uc3QgcmVzb2x2ZXJJbnRlcm5hbCA9IF93aXRoRGVmYXVsdFJlc29sdmVyKHVzZXJJbnRlcm5hbC5hdXRoLCByZXNvbHZlcik7XHJcbiAgICBjb25zdCBhY3Rpb24gPSBuZXcgUG9wdXBPcGVyYXRpb24odXNlckludGVybmFsLmF1dGgsIFwibGlua1ZpYVBvcHVwXCIgLyogTElOS19WSUFfUE9QVVAgKi8sIHByb3ZpZGVyLCByZXNvbHZlckludGVybmFsLCB1c2VySW50ZXJuYWwpO1xyXG4gICAgcmV0dXJuIGFjdGlvbi5leGVjdXRlTm90TnVsbCgpO1xyXG59XHJcbi8qKlxyXG4gKiBQb3B1cCBldmVudCBtYW5hZ2VyLiBIYW5kbGVzIHRoZSBwb3B1cCdzIGVudGlyZSBsaWZlY3ljbGU7IGxpc3RlbnMgdG8gYXV0aFxyXG4gKiBldmVudHNcclxuICpcclxuICovXHJcbmNsYXNzIFBvcHVwT3BlcmF0aW9uIGV4dGVuZHMgQWJzdHJhY3RQb3B1cFJlZGlyZWN0T3BlcmF0aW9uIHtcclxuICAgIGNvbnN0cnVjdG9yKGF1dGgsIGZpbHRlciwgcHJvdmlkZXIsIHJlc29sdmVyLCB1c2VyKSB7XHJcbiAgICAgICAgc3VwZXIoYXV0aCwgZmlsdGVyLCByZXNvbHZlciwgdXNlcik7XHJcbiAgICAgICAgdGhpcy5wcm92aWRlciA9IHByb3ZpZGVyO1xyXG4gICAgICAgIHRoaXMuYXV0aFdpbmRvdyA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5wb2xsSWQgPSBudWxsO1xyXG4gICAgICAgIGlmIChQb3B1cE9wZXJhdGlvbi5jdXJyZW50UG9wdXBBY3Rpb24pIHtcclxuICAgICAgICAgICAgUG9wdXBPcGVyYXRpb24uY3VycmVudFBvcHVwQWN0aW9uLmNhbmNlbCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBQb3B1cE9wZXJhdGlvbi5jdXJyZW50UG9wdXBBY3Rpb24gPSB0aGlzO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgZXhlY3V0ZU5vdE51bGwoKSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5leGVjdXRlKCk7XHJcbiAgICAgICAgX2Fzc2VydChyZXN1bHQsIHRoaXMuYXV0aCwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIElOVEVSTkFMX0VSUk9SICovKTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG4gICAgYXN5bmMgb25FeGVjdXRpb24oKSB7XHJcbiAgICAgICAgZGVidWdBc3NlcnQodGhpcy5maWx0ZXIubGVuZ3RoID09PSAxLCAnUG9wdXAgb3BlcmF0aW9ucyBvbmx5IGhhbmRsZSBvbmUgZXZlbnQnKTtcclxuICAgICAgICBjb25zdCBldmVudElkID0gX2dlbmVyYXRlRXZlbnRJZCgpO1xyXG4gICAgICAgIHRoaXMuYXV0aFdpbmRvdyA9IGF3YWl0IHRoaXMucmVzb2x2ZXIuX29wZW5Qb3B1cCh0aGlzLmF1dGgsIHRoaXMucHJvdmlkZXIsIHRoaXMuZmlsdGVyWzBdLCAvLyBUaGVyZSdzIGFsd2F5cyBvbmUsIHNlZSBjb25zdHJ1Y3RvclxyXG4gICAgICAgIGV2ZW50SWQpO1xyXG4gICAgICAgIHRoaXMuYXV0aFdpbmRvdy5hc3NvY2lhdGVkRXZlbnQgPSBldmVudElkO1xyXG4gICAgICAgIC8vIENoZWNrIGZvciB3ZWIgc3RvcmFnZSBzdXBwb3J0IGFuZCBvcmlnaW4gdmFsaWRhdGlvbiBfYWZ0ZXJfIHRoZSBwb3B1cCBpc1xyXG4gICAgICAgIC8vIGxvYWRlZC4gVGhlc2Ugb3BlcmF0aW9ucyBhcmUgc2xvdyAofjEgc2Vjb25kIG9yIHNvKSBSYXRoZXIgdGhhblxyXG4gICAgICAgIC8vIHdhaXRpbmcgb24gdGhlbSBiZWZvcmUgb3BlbmluZyB0aGUgd2luZG93LCBvcHRpbWlzdGljYWxseSBvcGVuIHRoZSBwb3B1cFxyXG4gICAgICAgIC8vIGFuZCBjaGVjayBmb3Igc3RvcmFnZSBzdXBwb3J0IGF0IHRoZSBzYW1lIHRpbWUuIElmIHN0b3JhZ2Ugc3VwcG9ydCBpc1xyXG4gICAgICAgIC8vIG5vdCBhdmFpbGFibGUsIHRoaXMgd2lsbCBjYXVzZSB0aGUgd2hvbGUgdGhpbmcgdG8gcmVqZWN0IHByb3Blcmx5LiBJdFxyXG4gICAgICAgIC8vIHdpbGwgYWxzbyBjbG9zZSB0aGUgcG9wdXAsIGJ1dCBzaW5jZSB0aGUgcHJvbWlzZSBoYXMgYWxyZWFkeSByZWplY3RlZCxcclxuICAgICAgICAvLyB0aGUgcG9wdXAgY2xvc2VkIGJ5IHVzZXIgcG9sbCB3aWxsIHJlamVjdCBpbnRvIHRoZSB2b2lkLlxyXG4gICAgICAgIHRoaXMucmVzb2x2ZXIuX29yaWdpblZhbGlkYXRpb24odGhpcy5hdXRoKS5jYXRjaChlID0+IHtcclxuICAgICAgICAgICAgdGhpcy5yZWplY3QoZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5yZXNvbHZlci5faXNJZnJhbWVXZWJTdG9yYWdlU3VwcG9ydGVkKHRoaXMuYXV0aCwgaXNTdXBwb3J0ZWQgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIWlzU3VwcG9ydGVkKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlamVjdChfY3JlYXRlRXJyb3IodGhpcy5hdXRoLCBcIndlYi1zdG9yYWdlLXVuc3VwcG9ydGVkXCIgLyogV0VCX1NUT1JBR0VfVU5TVVBQT1JURUQgKi8pKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vIEhhbmRsZSB1c2VyIGNsb3N1cmUuIE5vdGljZSB0aGlzIGRvZXMgKm5vdCogdXNlIGF3YWl0XHJcbiAgICAgICAgdGhpcy5wb2xsVXNlckNhbmNlbGxhdGlvbigpO1xyXG4gICAgfVxyXG4gICAgZ2V0IGV2ZW50SWQoKSB7XHJcbiAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgIHJldHVybiAoKF9hID0gdGhpcy5hdXRoV2luZG93KSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuYXNzb2NpYXRlZEV2ZW50KSB8fCBudWxsO1xyXG4gICAgfVxyXG4gICAgY2FuY2VsKCkge1xyXG4gICAgICAgIHRoaXMucmVqZWN0KF9jcmVhdGVFcnJvcih0aGlzLmF1dGgsIFwiY2FuY2VsbGVkLXBvcHVwLXJlcXVlc3RcIiAvKiBFWFBJUkVEX1BPUFVQX1JFUVVFU1QgKi8pKTtcclxuICAgIH1cclxuICAgIGNsZWFuVXAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuYXV0aFdpbmRvdykge1xyXG4gICAgICAgICAgICB0aGlzLmF1dGhXaW5kb3cuY2xvc2UoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMucG9sbElkKSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy5jbGVhclRpbWVvdXQodGhpcy5wb2xsSWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmF1dGhXaW5kb3cgPSBudWxsO1xyXG4gICAgICAgIHRoaXMucG9sbElkID0gbnVsbDtcclxuICAgICAgICBQb3B1cE9wZXJhdGlvbi5jdXJyZW50UG9wdXBBY3Rpb24gPSBudWxsO1xyXG4gICAgfVxyXG4gICAgcG9sbFVzZXJDYW5jZWxsYXRpb24oKSB7XHJcbiAgICAgICAgY29uc3QgcG9sbCA9ICgpID0+IHtcclxuICAgICAgICAgICAgdmFyIF9hLCBfYjtcclxuICAgICAgICAgICAgaWYgKChfYiA9IChfYSA9IHRoaXMuYXV0aFdpbmRvdykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLndpbmRvdykgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLmNsb3NlZCkge1xyXG4gICAgICAgICAgICAgICAgLy8gTWFrZSBzdXJlIHRoYXQgdGhlcmUgaXMgc3VmZmljaWVudCB0aW1lIGZvciB3aGF0ZXZlciBhY3Rpb24gdG9cclxuICAgICAgICAgICAgICAgIC8vIGNvbXBsZXRlLiBUaGUgd2luZG93IGNvdWxkIGhhdmUgY2xvc2VkIGJ1dCB0aGUgc2lnbiBpbiBuZXR3b3JrXHJcbiAgICAgICAgICAgICAgICAvLyBjYWxsIGNvdWxkIHN0aWxsIGJlIGluIGZsaWdodC5cclxuICAgICAgICAgICAgICAgIHRoaXMucG9sbElkID0gd2luZG93LnNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucG9sbElkID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlamVjdChfY3JlYXRlRXJyb3IodGhpcy5hdXRoLCBcInBvcHVwLWNsb3NlZC1ieS11c2VyXCIgLyogUE9QVVBfQ0xPU0VEX0JZX1VTRVIgKi8pKTtcclxuICAgICAgICAgICAgICAgIH0sIDIwMDAgLyogQVVUSF9FVkVOVCAqLyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5wb2xsSWQgPSB3aW5kb3cuc2V0VGltZW91dChwb2xsLCBfUE9MTF9XSU5ET1dfQ0xPU0VfVElNRU9VVC5nZXQoKSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBwb2xsKCk7XHJcbiAgICB9XHJcbn1cclxuLy8gT25seSBvbmUgcG9wdXAgaXMgZXZlciBzaG93biBhdCBvbmNlLiBUaGUgbGlmZWN5Y2xlIG9mIHRoZSBjdXJyZW50IHBvcHVwXHJcbi8vIGNhbiBiZSBtYW5hZ2VkIC8gY2FuY2VsbGVkIGJ5IHRoZSBjb25zdHJ1Y3Rvci5cclxuUG9wdXBPcGVyYXRpb24uY3VycmVudFBvcHVwQWN0aW9uID0gbnVsbDtcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuY29uc3QgUEVORElOR19SRURJUkVDVF9LRVkgPSAncGVuZGluZ1JlZGlyZWN0JztcclxuLy8gV2Ugb25seSBnZXQgb25lIHJlZGlyZWN0IG91dGNvbWUgZm9yIGFueSBvbmUgYXV0aCwgc28ganVzdCBzdG9yZSBpdFxyXG4vLyBpbiBoZXJlLlxyXG5jb25zdCByZWRpcmVjdE91dGNvbWVNYXAgPSBuZXcgTWFwKCk7XHJcbmNsYXNzIFJlZGlyZWN0QWN0aW9uIGV4dGVuZHMgQWJzdHJhY3RQb3B1cFJlZGlyZWN0T3BlcmF0aW9uIHtcclxuICAgIGNvbnN0cnVjdG9yKGF1dGgsIHJlc29sdmVyLCBieXBhc3NBdXRoU3RhdGUgPSBmYWxzZSkge1xyXG4gICAgICAgIHN1cGVyKGF1dGgsIFtcclxuICAgICAgICAgICAgXCJzaWduSW5WaWFSZWRpcmVjdFwiIC8qIFNJR05fSU5fVklBX1JFRElSRUNUICovLFxyXG4gICAgICAgICAgICBcImxpbmtWaWFSZWRpcmVjdFwiIC8qIExJTktfVklBX1JFRElSRUNUICovLFxyXG4gICAgICAgICAgICBcInJlYXV0aFZpYVJlZGlyZWN0XCIgLyogUkVBVVRIX1ZJQV9SRURJUkVDVCAqLyxcclxuICAgICAgICAgICAgXCJ1bmtub3duXCIgLyogVU5LTk9XTiAqL1xyXG4gICAgICAgIF0sIHJlc29sdmVyLCB1bmRlZmluZWQsIGJ5cGFzc0F1dGhTdGF0ZSk7XHJcbiAgICAgICAgdGhpcy5ldmVudElkID0gbnVsbDtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogT3ZlcnJpZGUgdGhlIGV4ZWN1dGUgZnVuY3Rpb247IGlmIHdlIGFscmVhZHkgaGF2ZSBhIHJlZGlyZWN0IHJlc3VsdCwgdGhlblxyXG4gICAgICoganVzdCByZXR1cm4gaXQuXHJcbiAgICAgKi9cclxuICAgIGFzeW5jIGV4ZWN1dGUoKSB7XHJcbiAgICAgICAgbGV0IHJlYWR5T3V0Y29tZSA9IHJlZGlyZWN0T3V0Y29tZU1hcC5nZXQodGhpcy5hdXRoLl9rZXkoKSk7XHJcbiAgICAgICAgaWYgKCFyZWFkeU91dGNvbWUpIHtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGhhc1BlbmRpbmdSZWRpcmVjdCA9IGF3YWl0IF9nZXRBbmRDbGVhclBlbmRpbmdSZWRpcmVjdFN0YXR1cyh0aGlzLnJlc29sdmVyLCB0aGlzLmF1dGgpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gaGFzUGVuZGluZ1JlZGlyZWN0ID8gYXdhaXQgc3VwZXIuZXhlY3V0ZSgpIDogbnVsbDtcclxuICAgICAgICAgICAgICAgIHJlYWR5T3V0Y29tZSA9ICgpID0+IFByb21pc2UucmVzb2x2ZShyZXN1bHQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgICByZWFkeU91dGNvbWUgPSAoKSA9PiBQcm9taXNlLnJlamVjdChlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZWRpcmVjdE91dGNvbWVNYXAuc2V0KHRoaXMuYXV0aC5fa2V5KCksIHJlYWR5T3V0Y29tZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZWFkeU91dGNvbWUoKTtcclxuICAgIH1cclxuICAgIGFzeW5jIG9uQXV0aEV2ZW50KGV2ZW50KSB7XHJcbiAgICAgICAgaWYgKGV2ZW50LnR5cGUgPT09IFwic2lnbkluVmlhUmVkaXJlY3RcIiAvKiBTSUdOX0lOX1ZJQV9SRURJUkVDVCAqLykge1xyXG4gICAgICAgICAgICByZXR1cm4gc3VwZXIub25BdXRoRXZlbnQoZXZlbnQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChldmVudC50eXBlID09PSBcInVua25vd25cIiAvKiBVTktOT1dOICovKSB7XHJcbiAgICAgICAgICAgIC8vIFRoaXMgaXMgYSBzZW50aW5lbCB2YWx1ZSBpbmRpY2F0aW5nIHRoZXJlJ3Mgbm8gcGVuZGluZyByZWRpcmVjdFxyXG4gICAgICAgICAgICB0aGlzLnJlc29sdmUobnVsbCk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGV2ZW50LmV2ZW50SWQpIHtcclxuICAgICAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IHRoaXMuYXV0aC5fcmVkaXJlY3RVc2VyRm9ySWQoZXZlbnQuZXZlbnRJZCk7XHJcbiAgICAgICAgICAgIGlmICh1c2VyKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnVzZXIgPSB1c2VyO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLm9uQXV0aEV2ZW50KGV2ZW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVzb2x2ZShudWxsKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGFzeW5jIG9uRXhlY3V0aW9uKCkgeyB9XHJcbiAgICBjbGVhblVwKCkgeyB9XHJcbn1cclxuYXN5bmMgZnVuY3Rpb24gX2dldEFuZENsZWFyUGVuZGluZ1JlZGlyZWN0U3RhdHVzKHJlc29sdmVyLCBhdXRoKSB7XHJcbiAgICBjb25zdCBrZXkgPSBwZW5kaW5nUmVkaXJlY3RLZXkoYXV0aCk7XHJcbiAgICBjb25zdCBoYXNQZW5kaW5nUmVkaXJlY3QgPSAoYXdhaXQgcmVzb2x2ZXJQZXJzaXN0ZW5jZShyZXNvbHZlcikuX2dldChrZXkpKSA9PT0gJ3RydWUnO1xyXG4gICAgYXdhaXQgcmVzb2x2ZXJQZXJzaXN0ZW5jZShyZXNvbHZlcikuX3JlbW92ZShrZXkpO1xyXG4gICAgcmV0dXJuIGhhc1BlbmRpbmdSZWRpcmVjdDtcclxufVxyXG5hc3luYyBmdW5jdGlvbiBfc2V0UGVuZGluZ1JlZGlyZWN0U3RhdHVzKHJlc29sdmVyLCBhdXRoKSB7XHJcbiAgICByZXR1cm4gcmVzb2x2ZXJQZXJzaXN0ZW5jZShyZXNvbHZlcikuX3NldChwZW5kaW5nUmVkaXJlY3RLZXkoYXV0aCksICd0cnVlJyk7XHJcbn1cclxuZnVuY3Rpb24gX2NsZWFyUmVkaXJlY3RPdXRjb21lcygpIHtcclxuICAgIHJlZGlyZWN0T3V0Y29tZU1hcC5jbGVhcigpO1xyXG59XHJcbmZ1bmN0aW9uIHJlc29sdmVyUGVyc2lzdGVuY2UocmVzb2x2ZXIpIHtcclxuICAgIHJldHVybiBfZ2V0SW5zdGFuY2UocmVzb2x2ZXIuX3JlZGlyZWN0UGVyc2lzdGVuY2UpO1xyXG59XHJcbmZ1bmN0aW9uIHBlbmRpbmdSZWRpcmVjdEtleShhdXRoKSB7XHJcbiAgICByZXR1cm4gX3BlcnNpc3RlbmNlS2V5TmFtZShQRU5ESU5HX1JFRElSRUNUX0tFWSwgYXV0aC5jb25maWcuYXBpS2V5LCBhdXRoLm5hbWUpO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBBdXRoZW50aWNhdGVzIGEgRmlyZWJhc2UgY2xpZW50IHVzaW5nIGEgZnVsbC1wYWdlIHJlZGlyZWN0IGZsb3cuXHJcbiAqXHJcbiAqIEByZW1hcmtzXHJcbiAqIFRvIGhhbmRsZSB0aGUgcmVzdWx0cyBhbmQgZXJyb3JzIGZvciB0aGlzIG9wZXJhdGlvbiwgcmVmZXIgdG8ge0BsaW5rIGdldFJlZGlyZWN0UmVzdWx0fS5cclxuICpcclxuICogQGV4YW1wbGVcclxuICogYGBgamF2YXNjcmlwdFxyXG4gKiAvLyBTaWduIGluIHVzaW5nIGEgcmVkaXJlY3QuXHJcbiAqIGNvbnN0IHByb3ZpZGVyID0gbmV3IEZhY2Vib29rQXV0aFByb3ZpZGVyKCk7XHJcbiAqIC8vIFlvdSBjYW4gYWRkIGFkZGl0aW9uYWwgc2NvcGVzIHRvIHRoZSBwcm92aWRlcjpcclxuICogcHJvdmlkZXIuYWRkU2NvcGUoJ3VzZXJfYmlydGhkYXknKTtcclxuICogLy8gU3RhcnQgYSBzaWduIGluIHByb2Nlc3MgZm9yIGFuIHVuYXV0aGVudGljYXRlZCB1c2VyLlxyXG4gKiBhd2FpdCBzaWduSW5XaXRoUmVkaXJlY3QoYXV0aCwgcHJvdmlkZXIpO1xyXG4gKiAvLyBUaGlzIHdpbGwgdHJpZ2dlciBhIGZ1bGwgcGFnZSByZWRpcmVjdCBhd2F5IGZyb20geW91ciBhcHBcclxuICpcclxuICogLy8gQWZ0ZXIgcmV0dXJuaW5nIGZyb20gdGhlIHJlZGlyZWN0IHdoZW4geW91ciBhcHAgaW5pdGlhbGl6ZXMgeW91IGNhbiBvYnRhaW4gdGhlIHJlc3VsdFxyXG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRSZWRpcmVjdFJlc3VsdChhdXRoKTtcclxuICogaWYgKHJlc3VsdCkge1xyXG4gKiAgIC8vIFRoaXMgaXMgdGhlIHNpZ25lZC1pbiB1c2VyXHJcbiAqICAgY29uc3QgdXNlciA9IHJlc3VsdC51c2VyO1xyXG4gKiAgIC8vIFRoaXMgZ2l2ZXMgeW91IGEgRmFjZWJvb2sgQWNjZXNzIFRva2VuLlxyXG4gKiAgIGNvbnN0IGNyZWRlbnRpYWwgPSBwcm92aWRlci5jcmVkZW50aWFsRnJvbVJlc3VsdChhdXRoLCByZXN1bHQpO1xyXG4gKiAgIGNvbnN0IHRva2VuID0gY3JlZGVudGlhbC5hY2Nlc3NUb2tlbjtcclxuICogfVxyXG4gKiAvLyBBcyB0aGlzIEFQSSBjYW4gYmUgdXNlZCBmb3Igc2lnbi1pbiwgbGlua2luZyBhbmQgcmVhdXRoZW50aWNhdGlvbixcclxuICogLy8gY2hlY2sgdGhlIG9wZXJhdGlvblR5cGUgdG8gZGV0ZXJtaW5lIHdoYXQgdHJpZ2dlcmVkIHRoaXMgcmVkaXJlY3RcclxuICogLy8gb3BlcmF0aW9uLlxyXG4gKiBjb25zdCBvcGVyYXRpb25UeXBlID0gcmVzdWx0Lm9wZXJhdGlvblR5cGU7XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXHJcbiAqIEBwYXJhbSBwcm92aWRlciAtIFRoZSBwcm92aWRlciB0byBhdXRoZW50aWNhdGUuIFRoZSBwcm92aWRlciBoYXMgdG8gYmUgYW4ge0BsaW5rIE9BdXRoUHJvdmlkZXJ9LlxyXG4gKiBOb24tT0F1dGggcHJvdmlkZXJzIGxpa2Uge0BsaW5rIEVtYWlsQXV0aFByb3ZpZGVyfSB3aWxsIHRocm93IGFuIGVycm9yLlxyXG4gKiBAcGFyYW0gcmVzb2x2ZXIgLSBBbiBpbnN0YW5jZSBvZiB7QGxpbmsgUG9wdXBSZWRpcmVjdFJlc29sdmVyfSwgb3B0aW9uYWxcclxuICogaWYgYWxyZWFkeSBzdXBwbGllZCB0byB7QGxpbmsgaW5pdGlhbGl6ZUF1dGh9IG9yIHByb3ZpZGVkIGJ5IHtAbGluayBnZXRBdXRofS5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuZnVuY3Rpb24gc2lnbkluV2l0aFJlZGlyZWN0KGF1dGgsIHByb3ZpZGVyLCByZXNvbHZlcikge1xyXG4gICAgcmV0dXJuIF9zaWduSW5XaXRoUmVkaXJlY3QoYXV0aCwgcHJvdmlkZXIsIHJlc29sdmVyKTtcclxufVxyXG5hc3luYyBmdW5jdGlvbiBfc2lnbkluV2l0aFJlZGlyZWN0KGF1dGgsIHByb3ZpZGVyLCByZXNvbHZlcikge1xyXG4gICAgY29uc3QgYXV0aEludGVybmFsID0gX2Nhc3RBdXRoKGF1dGgpO1xyXG4gICAgX2Fzc2VydChwcm92aWRlciBpbnN0YW5jZW9mIEZlZGVyYXRlZEF1dGhQcm92aWRlciwgYXV0aCwgXCJhcmd1bWVudC1lcnJvclwiIC8qIEFSR1VNRU5UX0VSUk9SICovKTtcclxuICAgIGNvbnN0IHJlc29sdmVySW50ZXJuYWwgPSBfd2l0aERlZmF1bHRSZXNvbHZlcihhdXRoSW50ZXJuYWwsIHJlc29sdmVyKTtcclxuICAgIGF3YWl0IF9zZXRQZW5kaW5nUmVkaXJlY3RTdGF0dXMocmVzb2x2ZXJJbnRlcm5hbCwgYXV0aEludGVybmFsKTtcclxuICAgIHJldHVybiByZXNvbHZlckludGVybmFsLl9vcGVuUmVkaXJlY3QoYXV0aEludGVybmFsLCBwcm92aWRlciwgXCJzaWduSW5WaWFSZWRpcmVjdFwiIC8qIFNJR05fSU5fVklBX1JFRElSRUNUICovKTtcclxufVxyXG4vKipcclxuICogUmVhdXRoZW50aWNhdGVzIHRoZSBjdXJyZW50IHVzZXIgd2l0aCB0aGUgc3BlY2lmaWVkIHtAbGluayBPQXV0aFByb3ZpZGVyfSB1c2luZyBhIGZ1bGwtcGFnZSByZWRpcmVjdCBmbG93LlxyXG4gKlxyXG4gKiBAZXhhbXBsZVxyXG4gKiBgYGBqYXZhc2NyaXB0XHJcbiAqIC8vIFNpZ24gaW4gdXNpbmcgYSByZWRpcmVjdC5cclxuICogY29uc3QgcHJvdmlkZXIgPSBuZXcgRmFjZWJvb2tBdXRoUHJvdmlkZXIoKTtcclxuICogY29uc3QgcmVzdWx0ID0gYXdhaXQgc2lnbkluV2l0aFJlZGlyZWN0KGF1dGgsIHByb3ZpZGVyKTtcclxuICogLy8gVGhpcyB3aWxsIHRyaWdnZXIgYSBmdWxsIHBhZ2UgcmVkaXJlY3QgYXdheSBmcm9tIHlvdXIgYXBwXHJcbiAqXHJcbiAqIC8vIEFmdGVyIHJldHVybmluZyBmcm9tIHRoZSByZWRpcmVjdCB3aGVuIHlvdXIgYXBwIGluaXRpYWxpemVzIHlvdSBjYW4gb2J0YWluIHRoZSByZXN1bHRcclxuICogY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2V0UmVkaXJlY3RSZXN1bHQoYXV0aCk7XHJcbiAqIC8vIExpbmsgdXNpbmcgYSByZWRpcmVjdC5cclxuICogYXdhaXQgbGlua1dpdGhSZWRpcmVjdChyZXN1bHQudXNlciwgcHJvdmlkZXIpO1xyXG4gKiAvLyBUaGlzIHdpbGwgYWdhaW4gdHJpZ2dlciBhIGZ1bGwgcGFnZSByZWRpcmVjdCBhd2F5IGZyb20geW91ciBhcHBcclxuICpcclxuICogLy8gQWZ0ZXIgcmV0dXJuaW5nIGZyb20gdGhlIHJlZGlyZWN0IHdoZW4geW91ciBhcHAgaW5pdGlhbGl6ZXMgeW91IGNhbiBvYnRhaW4gdGhlIHJlc3VsdFxyXG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRSZWRpcmVjdFJlc3VsdChhdXRoKTtcclxuICogYGBgXHJcbiAqXHJcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXHJcbiAqIEBwYXJhbSBwcm92aWRlciAtIFRoZSBwcm92aWRlciB0byBhdXRoZW50aWNhdGUuIFRoZSBwcm92aWRlciBoYXMgdG8gYmUgYW4ge0BsaW5rIE9BdXRoUHJvdmlkZXJ9LlxyXG4gKiBOb24tT0F1dGggcHJvdmlkZXJzIGxpa2Uge0BsaW5rIEVtYWlsQXV0aFByb3ZpZGVyfSB3aWxsIHRocm93IGFuIGVycm9yLlxyXG4gKiBAcGFyYW0gcmVzb2x2ZXIgLSBBbiBpbnN0YW5jZSBvZiB7QGxpbmsgUG9wdXBSZWRpcmVjdFJlc29sdmVyfSwgb3B0aW9uYWxcclxuICogaWYgYWxyZWFkeSBzdXBwbGllZCB0byB7QGxpbmsgaW5pdGlhbGl6ZUF1dGh9IG9yIHByb3ZpZGVkIGJ5IHtAbGluayBnZXRBdXRofS5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuZnVuY3Rpb24gcmVhdXRoZW50aWNhdGVXaXRoUmVkaXJlY3QodXNlciwgcHJvdmlkZXIsIHJlc29sdmVyKSB7XHJcbiAgICByZXR1cm4gX3JlYXV0aGVudGljYXRlV2l0aFJlZGlyZWN0KHVzZXIsIHByb3ZpZGVyLCByZXNvbHZlcik7XHJcbn1cclxuYXN5bmMgZnVuY3Rpb24gX3JlYXV0aGVudGljYXRlV2l0aFJlZGlyZWN0KHVzZXIsIHByb3ZpZGVyLCByZXNvbHZlcikge1xyXG4gICAgY29uc3QgdXNlckludGVybmFsID0gZ2V0TW9kdWxhckluc3RhbmNlKHVzZXIpO1xyXG4gICAgX2Fzc2VydChwcm92aWRlciBpbnN0YW5jZW9mIEZlZGVyYXRlZEF1dGhQcm92aWRlciwgdXNlckludGVybmFsLmF1dGgsIFwiYXJndW1lbnQtZXJyb3JcIiAvKiBBUkdVTUVOVF9FUlJPUiAqLyk7XHJcbiAgICAvLyBBbGxvdyB0aGUgcmVzb2x2ZXIgdG8gZXJyb3IgYmVmb3JlIHBlcnNpc3RpbmcgdGhlIHJlZGlyZWN0IHVzZXJcclxuICAgIGNvbnN0IHJlc29sdmVySW50ZXJuYWwgPSBfd2l0aERlZmF1bHRSZXNvbHZlcih1c2VySW50ZXJuYWwuYXV0aCwgcmVzb2x2ZXIpO1xyXG4gICAgYXdhaXQgX3NldFBlbmRpbmdSZWRpcmVjdFN0YXR1cyhyZXNvbHZlckludGVybmFsLCB1c2VySW50ZXJuYWwuYXV0aCk7XHJcbiAgICBjb25zdCBldmVudElkID0gYXdhaXQgcHJlcGFyZVVzZXJGb3JSZWRpcmVjdCh1c2VySW50ZXJuYWwpO1xyXG4gICAgcmV0dXJuIHJlc29sdmVySW50ZXJuYWwuX29wZW5SZWRpcmVjdCh1c2VySW50ZXJuYWwuYXV0aCwgcHJvdmlkZXIsIFwicmVhdXRoVmlhUmVkaXJlY3RcIiAvKiBSRUFVVEhfVklBX1JFRElSRUNUICovLCBldmVudElkKTtcclxufVxyXG4vKipcclxuICogTGlua3MgdGhlIHtAbGluayBPQXV0aFByb3ZpZGVyfSB0byB0aGUgdXNlciBhY2NvdW50IHVzaW5nIGEgZnVsbC1wYWdlIHJlZGlyZWN0IGZsb3cuXHJcbiAqXHJcbiAqIEBleGFtcGxlXHJcbiAqIGBgYGphdmFzY3JpcHRcclxuICogLy8gU2lnbiBpbiB1c2luZyBzb21lIG90aGVyIHByb3ZpZGVyLlxyXG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBzaWduSW5XaXRoRW1haWxBbmRQYXNzd29yZChhdXRoLCBlbWFpbCwgcGFzc3dvcmQpO1xyXG4gKiAvLyBMaW5rIHVzaW5nIGEgcmVkaXJlY3QuXHJcbiAqIGNvbnN0IHByb3ZpZGVyID0gbmV3IEZhY2Vib29rQXV0aFByb3ZpZGVyKCk7XHJcbiAqIGF3YWl0IGxpbmtXaXRoUmVkaXJlY3QocmVzdWx0LnVzZXIsIHByb3ZpZGVyKTtcclxuICogLy8gVGhpcyB3aWxsIHRyaWdnZXIgYSBmdWxsIHBhZ2UgcmVkaXJlY3QgYXdheSBmcm9tIHlvdXIgYXBwXHJcbiAqXHJcbiAqIC8vIEFmdGVyIHJldHVybmluZyBmcm9tIHRoZSByZWRpcmVjdCB3aGVuIHlvdXIgYXBwIGluaXRpYWxpemVzIHlvdSBjYW4gb2J0YWluIHRoZSByZXN1bHRcclxuICogY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2V0UmVkaXJlY3RSZXN1bHQoYXV0aCk7XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBAcGFyYW0gdXNlciAtIFRoZSB1c2VyLlxyXG4gKiBAcGFyYW0gcHJvdmlkZXIgLSBUaGUgcHJvdmlkZXIgdG8gYXV0aGVudGljYXRlLiBUaGUgcHJvdmlkZXIgaGFzIHRvIGJlIGFuIHtAbGluayBPQXV0aFByb3ZpZGVyfS5cclxuICogTm9uLU9BdXRoIHByb3ZpZGVycyBsaWtlIHtAbGluayBFbWFpbEF1dGhQcm92aWRlcn0gd2lsbCB0aHJvdyBhbiBlcnJvci5cclxuICogQHBhcmFtIHJlc29sdmVyIC0gQW4gaW5zdGFuY2Ugb2Yge0BsaW5rIFBvcHVwUmVkaXJlY3RSZXNvbHZlcn0sIG9wdGlvbmFsXHJcbiAqIGlmIGFscmVhZHkgc3VwcGxpZWQgdG8ge0BsaW5rIGluaXRpYWxpemVBdXRofSBvciBwcm92aWRlZCBieSB7QGxpbmsgZ2V0QXV0aH0uXHJcbiAqXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmZ1bmN0aW9uIGxpbmtXaXRoUmVkaXJlY3QodXNlciwgcHJvdmlkZXIsIHJlc29sdmVyKSB7XHJcbiAgICByZXR1cm4gX2xpbmtXaXRoUmVkaXJlY3QodXNlciwgcHJvdmlkZXIsIHJlc29sdmVyKTtcclxufVxyXG5hc3luYyBmdW5jdGlvbiBfbGlua1dpdGhSZWRpcmVjdCh1c2VyLCBwcm92aWRlciwgcmVzb2x2ZXIpIHtcclxuICAgIGNvbnN0IHVzZXJJbnRlcm5hbCA9IGdldE1vZHVsYXJJbnN0YW5jZSh1c2VyKTtcclxuICAgIF9hc3NlcnQocHJvdmlkZXIgaW5zdGFuY2VvZiBGZWRlcmF0ZWRBdXRoUHJvdmlkZXIsIHVzZXJJbnRlcm5hbC5hdXRoLCBcImFyZ3VtZW50LWVycm9yXCIgLyogQVJHVU1FTlRfRVJST1IgKi8pO1xyXG4gICAgLy8gQWxsb3cgdGhlIHJlc29sdmVyIHRvIGVycm9yIGJlZm9yZSBwZXJzaXN0aW5nIHRoZSByZWRpcmVjdCB1c2VyXHJcbiAgICBjb25zdCByZXNvbHZlckludGVybmFsID0gX3dpdGhEZWZhdWx0UmVzb2x2ZXIodXNlckludGVybmFsLmF1dGgsIHJlc29sdmVyKTtcclxuICAgIGF3YWl0IF9hc3NlcnRMaW5rZWRTdGF0dXMoZmFsc2UsIHVzZXJJbnRlcm5hbCwgcHJvdmlkZXIucHJvdmlkZXJJZCk7XHJcbiAgICBhd2FpdCBfc2V0UGVuZGluZ1JlZGlyZWN0U3RhdHVzKHJlc29sdmVySW50ZXJuYWwsIHVzZXJJbnRlcm5hbC5hdXRoKTtcclxuICAgIGNvbnN0IGV2ZW50SWQgPSBhd2FpdCBwcmVwYXJlVXNlckZvclJlZGlyZWN0KHVzZXJJbnRlcm5hbCk7XHJcbiAgICByZXR1cm4gcmVzb2x2ZXJJbnRlcm5hbC5fb3BlblJlZGlyZWN0KHVzZXJJbnRlcm5hbC5hdXRoLCBwcm92aWRlciwgXCJsaW5rVmlhUmVkaXJlY3RcIiAvKiBMSU5LX1ZJQV9SRURJUkVDVCAqLywgZXZlbnRJZCk7XHJcbn1cclxuLyoqXHJcbiAqIFJldHVybnMgYSB7QGxpbmsgVXNlckNyZWRlbnRpYWx9IGZyb20gdGhlIHJlZGlyZWN0LWJhc2VkIHNpZ24taW4gZmxvdy5cclxuICpcclxuICogQHJlbWFya3NcclxuICogSWYgc2lnbi1pbiBzdWNjZWVkZWQsIHJldHVybnMgdGhlIHNpZ25lZCBpbiB1c2VyLiBJZiBzaWduLWluIHdhcyB1bnN1Y2Nlc3NmdWwsIGZhaWxzIHdpdGggYW5cclxuICogZXJyb3IuIElmIG5vIHJlZGlyZWN0IG9wZXJhdGlvbiB3YXMgY2FsbGVkLCByZXR1cm5zIGEge0BsaW5rIFVzZXJDcmVkZW50aWFsfVxyXG4gKiB3aXRoIGEgbnVsbCBgdXNlcmAuXHJcbiAqXHJcbiAqIEBleGFtcGxlXHJcbiAqIGBgYGphdmFzY3JpcHRcclxuICogLy8gU2lnbiBpbiB1c2luZyBhIHJlZGlyZWN0LlxyXG4gKiBjb25zdCBwcm92aWRlciA9IG5ldyBGYWNlYm9va0F1dGhQcm92aWRlcigpO1xyXG4gKiAvLyBZb3UgY2FuIGFkZCBhZGRpdGlvbmFsIHNjb3BlcyB0byB0aGUgcHJvdmlkZXI6XHJcbiAqIHByb3ZpZGVyLmFkZFNjb3BlKCd1c2VyX2JpcnRoZGF5Jyk7XHJcbiAqIC8vIFN0YXJ0IGEgc2lnbiBpbiBwcm9jZXNzIGZvciBhbiB1bmF1dGhlbnRpY2F0ZWQgdXNlci5cclxuICogYXdhaXQgc2lnbkluV2l0aFJlZGlyZWN0KGF1dGgsIHByb3ZpZGVyKTtcclxuICogLy8gVGhpcyB3aWxsIHRyaWdnZXIgYSBmdWxsIHBhZ2UgcmVkaXJlY3QgYXdheSBmcm9tIHlvdXIgYXBwXHJcbiAqXHJcbiAqIC8vIEFmdGVyIHJldHVybmluZyBmcm9tIHRoZSByZWRpcmVjdCB3aGVuIHlvdXIgYXBwIGluaXRpYWxpemVzIHlvdSBjYW4gb2J0YWluIHRoZSByZXN1bHRcclxuICogY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2V0UmVkaXJlY3RSZXN1bHQoYXV0aCk7XHJcbiAqIGlmIChyZXN1bHQpIHtcclxuICogICAvLyBUaGlzIGlzIHRoZSBzaWduZWQtaW4gdXNlclxyXG4gKiAgIGNvbnN0IHVzZXIgPSByZXN1bHQudXNlcjtcclxuICogICAvLyBUaGlzIGdpdmVzIHlvdSBhIEZhY2Vib29rIEFjY2VzcyBUb2tlbi5cclxuICogICBjb25zdCBjcmVkZW50aWFsID0gcHJvdmlkZXIuY3JlZGVudGlhbEZyb21SZXN1bHQoYXV0aCwgcmVzdWx0KTtcclxuICogICBjb25zdCB0b2tlbiA9IGNyZWRlbnRpYWwuYWNjZXNzVG9rZW47XHJcbiAqIH1cclxuICogLy8gQXMgdGhpcyBBUEkgY2FuIGJlIHVzZWQgZm9yIHNpZ24taW4sIGxpbmtpbmcgYW5kIHJlYXV0aGVudGljYXRpb24sXHJcbiAqIC8vIGNoZWNrIHRoZSBvcGVyYXRpb25UeXBlIHRvIGRldGVybWluZSB3aGF0IHRyaWdnZXJlZCB0aGlzIHJlZGlyZWN0XHJcbiAqIC8vIG9wZXJhdGlvbi5cclxuICogY29uc3Qgb3BlcmF0aW9uVHlwZSA9IHJlc3VsdC5vcGVyYXRpb25UeXBlO1xyXG4gKiBgYGBcclxuICpcclxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxyXG4gKiBAcGFyYW0gcmVzb2x2ZXIgLSBBbiBpbnN0YW5jZSBvZiB7QGxpbmsgUG9wdXBSZWRpcmVjdFJlc29sdmVyfSwgb3B0aW9uYWxcclxuICogaWYgYWxyZWFkeSBzdXBwbGllZCB0byB7QGxpbmsgaW5pdGlhbGl6ZUF1dGh9IG9yIHByb3ZpZGVkIGJ5IHtAbGluayBnZXRBdXRofS5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gZ2V0UmVkaXJlY3RSZXN1bHQoYXV0aCwgcmVzb2x2ZXIpIHtcclxuICAgIGF3YWl0IF9jYXN0QXV0aChhdXRoKS5faW5pdGlhbGl6YXRpb25Qcm9taXNlO1xyXG4gICAgcmV0dXJuIF9nZXRSZWRpcmVjdFJlc3VsdChhdXRoLCByZXNvbHZlciwgZmFsc2UpO1xyXG59XHJcbmFzeW5jIGZ1bmN0aW9uIF9nZXRSZWRpcmVjdFJlc3VsdChhdXRoLCByZXNvbHZlckV4dGVybiwgYnlwYXNzQXV0aFN0YXRlID0gZmFsc2UpIHtcclxuICAgIGNvbnN0IGF1dGhJbnRlcm5hbCA9IF9jYXN0QXV0aChhdXRoKTtcclxuICAgIGNvbnN0IHJlc29sdmVyID0gX3dpdGhEZWZhdWx0UmVzb2x2ZXIoYXV0aEludGVybmFsLCByZXNvbHZlckV4dGVybik7XHJcbiAgICBjb25zdCBhY3Rpb24gPSBuZXcgUmVkaXJlY3RBY3Rpb24oYXV0aEludGVybmFsLCByZXNvbHZlciwgYnlwYXNzQXV0aFN0YXRlKTtcclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGFjdGlvbi5leGVjdXRlKCk7XHJcbiAgICBpZiAocmVzdWx0ICYmICFieXBhc3NBdXRoU3RhdGUpIHtcclxuICAgICAgICBkZWxldGUgcmVzdWx0LnVzZXIuX3JlZGlyZWN0RXZlbnRJZDtcclxuICAgICAgICBhd2FpdCBhdXRoSW50ZXJuYWwuX3BlcnNpc3RVc2VySWZDdXJyZW50KHJlc3VsdC51c2VyKTtcclxuICAgICAgICBhd2FpdCBhdXRoSW50ZXJuYWwuX3NldFJlZGlyZWN0VXNlcihudWxsLCByZXNvbHZlckV4dGVybik7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcbmFzeW5jIGZ1bmN0aW9uIHByZXBhcmVVc2VyRm9yUmVkaXJlY3QodXNlcikge1xyXG4gICAgY29uc3QgZXZlbnRJZCA9IF9nZW5lcmF0ZUV2ZW50SWQoYCR7dXNlci51aWR9Ojo6YCk7XHJcbiAgICB1c2VyLl9yZWRpcmVjdEV2ZW50SWQgPSBldmVudElkO1xyXG4gICAgYXdhaXQgdXNlci5hdXRoLl9zZXRSZWRpcmVjdFVzZXIodXNlcik7XHJcbiAgICBhd2FpdCB1c2VyLmF1dGguX3BlcnNpc3RVc2VySWZDdXJyZW50KHVzZXIpO1xyXG4gICAgcmV0dXJuIGV2ZW50SWQ7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLy8gVGhlIGFtb3VudCBvZiB0aW1lIHRvIHN0b3JlIHRoZSBVSURzIG9mIHNlZW4gZXZlbnRzOyB0aGlzIGlzXHJcbi8vIHNldCB0byAxMCBtaW4gYnkgZGVmYXVsdFxyXG5jb25zdCBFVkVOVF9EVVBMSUNBVElPTl9DQUNIRV9EVVJBVElPTl9NUyA9IDEwICogNjAgKiAxMDAwO1xyXG5jbGFzcyBBdXRoRXZlbnRNYW5hZ2VyIHtcclxuICAgIGNvbnN0cnVjdG9yKGF1dGgpIHtcclxuICAgICAgICB0aGlzLmF1dGggPSBhdXRoO1xyXG4gICAgICAgIHRoaXMuY2FjaGVkRXZlbnRVaWRzID0gbmV3IFNldCgpO1xyXG4gICAgICAgIHRoaXMuY29uc3VtZXJzID0gbmV3IFNldCgpO1xyXG4gICAgICAgIHRoaXMucXVldWVkUmVkaXJlY3RFdmVudCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5oYXNIYW5kbGVkUG90ZW50aWFsUmVkaXJlY3QgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmxhc3RQcm9jZXNzZWRFdmVudFRpbWUgPSBEYXRlLm5vdygpO1xyXG4gICAgfVxyXG4gICAgcmVnaXN0ZXJDb25zdW1lcihhdXRoRXZlbnRDb25zdW1lcikge1xyXG4gICAgICAgIHRoaXMuY29uc3VtZXJzLmFkZChhdXRoRXZlbnRDb25zdW1lcik7XHJcbiAgICAgICAgaWYgKHRoaXMucXVldWVkUmVkaXJlY3RFdmVudCAmJlxyXG4gICAgICAgICAgICB0aGlzLmlzRXZlbnRGb3JDb25zdW1lcih0aGlzLnF1ZXVlZFJlZGlyZWN0RXZlbnQsIGF1dGhFdmVudENvbnN1bWVyKSkge1xyXG4gICAgICAgICAgICB0aGlzLnNlbmRUb0NvbnN1bWVyKHRoaXMucXVldWVkUmVkaXJlY3RFdmVudCwgYXV0aEV2ZW50Q29uc3VtZXIpO1xyXG4gICAgICAgICAgICB0aGlzLnNhdmVFdmVudFRvQ2FjaGUodGhpcy5xdWV1ZWRSZWRpcmVjdEV2ZW50KTtcclxuICAgICAgICAgICAgdGhpcy5xdWV1ZWRSZWRpcmVjdEV2ZW50ID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICB1bnJlZ2lzdGVyQ29uc3VtZXIoYXV0aEV2ZW50Q29uc3VtZXIpIHtcclxuICAgICAgICB0aGlzLmNvbnN1bWVycy5kZWxldGUoYXV0aEV2ZW50Q29uc3VtZXIpO1xyXG4gICAgfVxyXG4gICAgb25FdmVudChldmVudCkge1xyXG4gICAgICAgIC8vIENoZWNrIGlmIHRoZSBldmVudCBoYXMgYWxyZWFkeSBiZWVuIGhhbmRsZWRcclxuICAgICAgICBpZiAodGhpcy5oYXNFdmVudEJlZW5IYW5kbGVkKGV2ZW50KSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBoYW5kbGVkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5jb25zdW1lcnMuZm9yRWFjaChjb25zdW1lciA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmlzRXZlbnRGb3JDb25zdW1lcihldmVudCwgY29uc3VtZXIpKSB7XHJcbiAgICAgICAgICAgICAgICBoYW5kbGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VuZFRvQ29uc3VtZXIoZXZlbnQsIGNvbnN1bWVyKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2F2ZUV2ZW50VG9DYWNoZShldmVudCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBpZiAodGhpcy5oYXNIYW5kbGVkUG90ZW50aWFsUmVkaXJlY3QgfHwgIWlzUmVkaXJlY3RFdmVudChldmVudCkpIHtcclxuICAgICAgICAgICAgLy8gSWYgd2UndmUgYWxyZWFkeSBzZWVuIGEgcmVkaXJlY3QgYmVmb3JlLCBvciB0aGlzIGlzIGEgcG9wdXAgZXZlbnQsXHJcbiAgICAgICAgICAgIC8vIGJhaWwgbm93XHJcbiAgICAgICAgICAgIHJldHVybiBoYW5kbGVkO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmhhc0hhbmRsZWRQb3RlbnRpYWxSZWRpcmVjdCA9IHRydWU7XHJcbiAgICAgICAgLy8gSWYgdGhlIHJlZGlyZWN0IHdhc24ndCBoYW5kbGVkLCBoYW5nIG9uIHRvIGl0XHJcbiAgICAgICAgaWYgKCFoYW5kbGVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMucXVldWVkUmVkaXJlY3RFdmVudCA9IGV2ZW50O1xyXG4gICAgICAgICAgICBoYW5kbGVkID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGhhbmRsZWQ7XHJcbiAgICB9XHJcbiAgICBzZW5kVG9Db25zdW1lcihldmVudCwgY29uc3VtZXIpIHtcclxuICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgaWYgKGV2ZW50LmVycm9yICYmICFpc051bGxSZWRpcmVjdEV2ZW50KGV2ZW50KSkge1xyXG4gICAgICAgICAgICBjb25zdCBjb2RlID0gKChfYSA9IGV2ZW50LmVycm9yLmNvZGUpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5zcGxpdCgnYXV0aC8nKVsxXSkgfHxcclxuICAgICAgICAgICAgICAgIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLztcclxuICAgICAgICAgICAgY29uc3VtZXIub25FcnJvcihfY3JlYXRlRXJyb3IodGhpcy5hdXRoLCBjb2RlKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdW1lci5vbkF1dGhFdmVudChldmVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgaXNFdmVudEZvckNvbnN1bWVyKGV2ZW50LCBjb25zdW1lcikge1xyXG4gICAgICAgIGNvbnN0IGV2ZW50SWRNYXRjaGVzID0gY29uc3VtZXIuZXZlbnRJZCA9PT0gbnVsbCB8fFxyXG4gICAgICAgICAgICAoISFldmVudC5ldmVudElkICYmIGV2ZW50LmV2ZW50SWQgPT09IGNvbnN1bWVyLmV2ZW50SWQpO1xyXG4gICAgICAgIHJldHVybiBjb25zdW1lci5maWx0ZXIuaW5jbHVkZXMoZXZlbnQudHlwZSkgJiYgZXZlbnRJZE1hdGNoZXM7XHJcbiAgICB9XHJcbiAgICBoYXNFdmVudEJlZW5IYW5kbGVkKGV2ZW50KSB7XHJcbiAgICAgICAgaWYgKERhdGUubm93KCkgLSB0aGlzLmxhc3RQcm9jZXNzZWRFdmVudFRpbWUgPj1cclxuICAgICAgICAgICAgRVZFTlRfRFVQTElDQVRJT05fQ0FDSEVfRFVSQVRJT05fTVMpIHtcclxuICAgICAgICAgICAgdGhpcy5jYWNoZWRFdmVudFVpZHMuY2xlYXIoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY2FjaGVkRXZlbnRVaWRzLmhhcyhldmVudFVpZChldmVudCkpO1xyXG4gICAgfVxyXG4gICAgc2F2ZUV2ZW50VG9DYWNoZShldmVudCkge1xyXG4gICAgICAgIHRoaXMuY2FjaGVkRXZlbnRVaWRzLmFkZChldmVudFVpZChldmVudCkpO1xyXG4gICAgICAgIHRoaXMubGFzdFByb2Nlc3NlZEV2ZW50VGltZSA9IERhdGUubm93KCk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gZXZlbnRVaWQoZSkge1xyXG4gICAgcmV0dXJuIFtlLnR5cGUsIGUuZXZlbnRJZCwgZS5zZXNzaW9uSWQsIGUudGVuYW50SWRdLmZpbHRlcih2ID0+IHYpLmpvaW4oJy0nKTtcclxufVxyXG5mdW5jdGlvbiBpc051bGxSZWRpcmVjdEV2ZW50KHsgdHlwZSwgZXJyb3IgfSkge1xyXG4gICAgcmV0dXJuICh0eXBlID09PSBcInVua25vd25cIiAvKiBVTktOT1dOICovICYmXHJcbiAgICAgICAgKGVycm9yID09PSBudWxsIHx8IGVycm9yID09PSB2b2lkIDAgPyB2b2lkIDAgOiBlcnJvci5jb2RlKSA9PT0gYGF1dGgvJHtcIm5vLWF1dGgtZXZlbnRcIiAvKiBOT19BVVRIX0VWRU5UICovfWApO1xyXG59XHJcbmZ1bmN0aW9uIGlzUmVkaXJlY3RFdmVudChldmVudCkge1xyXG4gICAgc3dpdGNoIChldmVudC50eXBlKSB7XHJcbiAgICAgICAgY2FzZSBcInNpZ25JblZpYVJlZGlyZWN0XCIgLyogU0lHTl9JTl9WSUFfUkVESVJFQ1QgKi86XHJcbiAgICAgICAgY2FzZSBcImxpbmtWaWFSZWRpcmVjdFwiIC8qIExJTktfVklBX1JFRElSRUNUICovOlxyXG4gICAgICAgIGNhc2UgXCJyZWF1dGhWaWFSZWRpcmVjdFwiIC8qIFJFQVVUSF9WSUFfUkVESVJFQ1QgKi86XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIGNhc2UgXCJ1bmtub3duXCIgLyogVU5LTk9XTiAqLzpcclxuICAgICAgICAgICAgcmV0dXJuIGlzTnVsbFJlZGlyZWN0RXZlbnQoZXZlbnQpO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBfZ2V0UHJvamVjdENvbmZpZyhhdXRoLCByZXF1ZXN0ID0ge30pIHtcclxuICAgIHJldHVybiBfcGVyZm9ybUFwaVJlcXVlc3QoYXV0aCwgXCJHRVRcIiAvKiBHRVQgKi8sIFwiL3YxL3Byb2plY3RzXCIgLyogR0VUX1BST0pFQ1RfQ09ORklHICovLCByZXF1ZXN0KTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jb25zdCBJUF9BRERSRVNTX1JFR0VYID0gL15cXGR7MSwzfVxcLlxcZHsxLDN9XFwuXFxkezEsM31cXC5cXGR7MSwzfSQvO1xyXG5jb25zdCBIVFRQX1JFR0VYID0gL15odHRwcz8vO1xyXG5hc3luYyBmdW5jdGlvbiBfdmFsaWRhdGVPcmlnaW4oYXV0aCkge1xyXG4gICAgLy8gU2tpcCBvcmlnaW4gdmFsaWRhdGlvbiBpZiB3ZSBhcmUgaW4gYW4gZW11bGF0ZWQgZW52aXJvbm1lbnRcclxuICAgIGlmIChhdXRoLmNvbmZpZy5lbXVsYXRvcikge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IHsgYXV0aG9yaXplZERvbWFpbnMgfSA9IGF3YWl0IF9nZXRQcm9qZWN0Q29uZmlnKGF1dGgpO1xyXG4gICAgZm9yIChjb25zdCBkb21haW4gb2YgYXV0aG9yaXplZERvbWFpbnMpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAobWF0Y2hEb21haW4oZG9tYWluKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChfYSkge1xyXG4gICAgICAgICAgICAvLyBEbyBub3RoaW5nIGlmIHRoZXJlJ3MgYSBVUkwgZXJyb3I7IGp1c3QgY29udGludWUgc2VhcmNoaW5nXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8gSW4gdGhlIG9sZCBTREssIHRoaXMgZXJyb3IgYWxzbyBwcm92aWRlcyBoZWxwZnVsIG1lc3NhZ2VzLlxyXG4gICAgX2ZhaWwoYXV0aCwgXCJ1bmF1dGhvcml6ZWQtZG9tYWluXCIgLyogSU5WQUxJRF9PUklHSU4gKi8pO1xyXG59XHJcbmZ1bmN0aW9uIG1hdGNoRG9tYWluKGV4cGVjdGVkKSB7XHJcbiAgICBjb25zdCBjdXJyZW50VXJsID0gX2dldEN1cnJlbnRVcmwoKTtcclxuICAgIGNvbnN0IHsgcHJvdG9jb2wsIGhvc3RuYW1lIH0gPSBuZXcgVVJMKGN1cnJlbnRVcmwpO1xyXG4gICAgaWYgKGV4cGVjdGVkLnN0YXJ0c1dpdGgoJ2Nocm9tZS1leHRlbnNpb246Ly8nKSkge1xyXG4gICAgICAgIGNvbnN0IGNlVXJsID0gbmV3IFVSTChleHBlY3RlZCk7XHJcbiAgICAgICAgaWYgKGNlVXJsLmhvc3RuYW1lID09PSAnJyAmJiBob3N0bmFtZSA9PT0gJycpIHtcclxuICAgICAgICAgICAgLy8gRm9yIHNvbWUgcmVhc29uIHdlJ3JlIG5vdCBwYXJzaW5nIGNocm9tZSBVUkxzIHByb3Blcmx5XHJcbiAgICAgICAgICAgIHJldHVybiAocHJvdG9jb2wgPT09ICdjaHJvbWUtZXh0ZW5zaW9uOicgJiZcclxuICAgICAgICAgICAgICAgIGV4cGVjdGVkLnJlcGxhY2UoJ2Nocm9tZS1leHRlbnNpb246Ly8nLCAnJykgPT09XHJcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudFVybC5yZXBsYWNlKCdjaHJvbWUtZXh0ZW5zaW9uOi8vJywgJycpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHByb3RvY29sID09PSAnY2hyb21lLWV4dGVuc2lvbjonICYmIGNlVXJsLmhvc3RuYW1lID09PSBob3N0bmFtZTtcclxuICAgIH1cclxuICAgIGlmICghSFRUUF9SRUdFWC50ZXN0KHByb3RvY29sKSkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIGlmIChJUF9BRERSRVNTX1JFR0VYLnRlc3QoZXhwZWN0ZWQpKSB7XHJcbiAgICAgICAgLy8gVGhlIGRvbWFpbiBoYXMgdG8gYmUgZXhhY3RseSBlcXVhbCB0byB0aGUgcGF0dGVybiwgYXMgYW4gSVAgZG9tYWluIHdpbGxcclxuICAgICAgICAvLyBvbmx5IGNvbnRhaW4gdGhlIElQLCBubyBleHRyYSBjaGFyYWN0ZXIuXHJcbiAgICAgICAgcmV0dXJuIGhvc3RuYW1lID09PSBleHBlY3RlZDtcclxuICAgIH1cclxuICAgIC8vIERvdHMgaW4gcGF0dGVybiBzaG91bGQgYmUgZXNjYXBlZC5cclxuICAgIGNvbnN0IGVzY2FwZWREb21haW5QYXR0ZXJuID0gZXhwZWN0ZWQucmVwbGFjZSgvXFwuL2csICdcXFxcLicpO1xyXG4gICAgLy8gTm9uIGlwIGFkZHJlc3MgZG9tYWlucy5cclxuICAgIC8vIGRvbWFpbi5jb20gPSAqLmRvbWFpbi5jb20gT1IgZG9tYWluLmNvbVxyXG4gICAgY29uc3QgcmUgPSBuZXcgUmVnRXhwKCdeKC4rXFxcXC4nICsgZXNjYXBlZERvbWFpblBhdHRlcm4gKyAnfCcgKyBlc2NhcGVkRG9tYWluUGF0dGVybiArICcpJCcsICdpJyk7XHJcbiAgICByZXR1cm4gcmUudGVzdChob3N0bmFtZSk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTEMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmNvbnN0IE5FVFdPUktfVElNRU9VVCA9IG5ldyBEZWxheSgzMDAwMCwgNjAwMDApO1xyXG4vKipcclxuICogUmVzZXQgdW5sYW9kZWQgR0FwaSBtb2R1bGVzLiBJZiBnYXBpLmxvYWQgZmFpbHMgZHVlIHRvIGEgbmV0d29yayBlcnJvcixcclxuICogaXQgd2lsbCBzdG9wIHdvcmtpbmcgYWZ0ZXIgYSByZXRyaWFsLiBUaGlzIGlzIGEgaGFjayB0byBmaXggdGhpcyBpc3N1ZS5cclxuICovXHJcbmZ1bmN0aW9uIHJlc2V0VW5sb2FkZWRHYXBpTW9kdWxlcygpIHtcclxuICAgIC8vIENsZWFyIGxhc3QgZmFpbGVkIGdhcGkubG9hZCBzdGF0ZSB0byBmb3JjZSBuZXh0IGdhcGkubG9hZCB0byBmaXJzdFxyXG4gICAgLy8gbG9hZCB0aGUgZmFpbGVkIGdhcGkuaWZyYW1lcyBtb2R1bGUuXHJcbiAgICAvLyBHZXQgZ2FwaXguYmVhY29uIGNvbnRleHQuXHJcbiAgICBjb25zdCBiZWFjb24gPSBfd2luZG93KCkuX19fanNsO1xyXG4gICAgLy8gR2V0IGN1cnJlbnQgaGludC5cclxuICAgIGlmIChiZWFjb24gPT09IG51bGwgfHwgYmVhY29uID09PSB2b2lkIDAgPyB2b2lkIDAgOiBiZWFjb24uSCkge1xyXG4gICAgICAgIC8vIEdldCBnYXBpIGhpbnQuXHJcbiAgICAgICAgZm9yIChjb25zdCBoaW50IG9mIE9iamVjdC5rZXlzKGJlYWNvbi5IKSkge1xyXG4gICAgICAgICAgICAvLyBSZXF1ZXN0ZWQgbW9kdWxlcy5cclxuICAgICAgICAgICAgYmVhY29uLkhbaGludF0uciA9IGJlYWNvbi5IW2hpbnRdLnIgfHwgW107XHJcbiAgICAgICAgICAgIC8vIExvYWRlZCBtb2R1bGVzLlxyXG4gICAgICAgICAgICBiZWFjb24uSFtoaW50XS5MID0gYmVhY29uLkhbaGludF0uTCB8fCBbXTtcclxuICAgICAgICAgICAgLy8gU2V0IHJlcXVlc3RlZCBtb2R1bGVzIHRvIGEgY29weSBvZiB0aGUgbG9hZGVkIG1vZHVsZXMuXHJcbiAgICAgICAgICAgIGJlYWNvbi5IW2hpbnRdLnIgPSBbLi4uYmVhY29uLkhbaGludF0uTF07XHJcbiAgICAgICAgICAgIC8vIENsZWFyIHBlbmRpbmcgY2FsbGJhY2tzLlxyXG4gICAgICAgICAgICBpZiAoYmVhY29uLkNQKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJlYWNvbi5DUC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBhbGwgZmFpbGVkIHBlbmRpbmcgY2FsbGJhY2tzLlxyXG4gICAgICAgICAgICAgICAgICAgIGJlYWNvbi5DUFtpXSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gbG9hZEdhcGkoYXV0aCkge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICB2YXIgX2EsIF9iLCBfYztcclxuICAgICAgICAvLyBGdW5jdGlvbiB0byBydW4gd2hlbiBnYXBpLmxvYWQgaXMgcmVhZHkuXHJcbiAgICAgICAgZnVuY3Rpb24gbG9hZEdhcGlJZnJhbWUoKSB7XHJcbiAgICAgICAgICAgIC8vIFRoZSBkZXZlbG9wZXIgbWF5IGhhdmUgdHJpZWQgdG8gcHJldmlvdXNseSBydW4gZ2FwaS5sb2FkIGFuZCBmYWlsZWQuXHJcbiAgICAgICAgICAgIC8vIFJ1biB0aGlzIHRvIGZpeCB0aGF0LlxyXG4gICAgICAgICAgICByZXNldFVubG9hZGVkR2FwaU1vZHVsZXMoKTtcclxuICAgICAgICAgICAgZ2FwaS5sb2FkKCdnYXBpLmlmcmFtZXMnLCB7XHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjazogKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZ2FwaS5pZnJhbWVzLmdldENvbnRleHQoKSk7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgb250aW1lb3V0OiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhlIGFib3ZlIHJlc2V0IG1heSBiZSBzdWZmaWNpZW50LCBidXQgaGF2aW5nIHRoaXMgcmVzZXQgYWZ0ZXJcclxuICAgICAgICAgICAgICAgICAgICAvLyBmYWlsdXJlIGVuc3VyZXMgdGhhdCBpZiB0aGUgZGV2ZWxvcGVyIGNhbGxzIGdhcGkubG9hZCBhZnRlciB0aGVcclxuICAgICAgICAgICAgICAgICAgICAvLyBjb25uZWN0aW9uIGlzIHJlLWVzdGFibGlzaGVkIGFuZCBiZWZvcmUgYW5vdGhlciBhdHRlbXB0IHRvIGVtYmVkXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhlIGlmcmFtZSwgaXQgd291bGQgd29yayBhbmQgd291bGQgbm90IGJlIGJyb2tlbiBiZWNhdXNlIG9mIG91clxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGZhaWxlZCBhdHRlbXB0LlxyXG4gICAgICAgICAgICAgICAgICAgIC8vIFRpbWVvdXQgd2hlbiBnYXBpLmlmcmFtZXMuSWZyYW1lIG5vdCBsb2FkZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgcmVzZXRVbmxvYWRlZEdhcGlNb2R1bGVzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KF9jcmVhdGVFcnJvcihhdXRoLCBcIm5ldHdvcmstcmVxdWVzdC1mYWlsZWRcIiAvKiBORVRXT1JLX1JFUVVFU1RfRkFJTEVEICovKSk7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgdGltZW91dDogTkVUV09SS19USU1FT1VULmdldCgpXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoKF9iID0gKF9hID0gX3dpbmRvdygpLmdhcGkpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5pZnJhbWVzKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuSWZyYW1lKSB7XHJcbiAgICAgICAgICAgIC8vIElmIGdhcGkuaWZyYW1lcy5JZnJhbWUgYXZhaWxhYmxlLCByZXNvbHZlLlxyXG4gICAgICAgICAgICByZXNvbHZlKGdhcGkuaWZyYW1lcy5nZXRDb250ZXh0KCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICghISgoX2MgPSBfd2luZG93KCkuZ2FwaSkgPT09IG51bGwgfHwgX2MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jLmxvYWQpKSB7XHJcbiAgICAgICAgICAgIC8vIEdhcGkgbG9hZGVyIHJlYWR5LCBsb2FkIGdhcGkuaWZyYW1lcy5cclxuICAgICAgICAgICAgbG9hZEdhcGlJZnJhbWUoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIENyZWF0ZSBhIG5ldyBpZnJhbWUgY2FsbGJhY2sgd2hlbiB0aGlzIGlzIGNhbGxlZCBzbyBhcyBub3QgdG8gb3ZlcndyaXRlXHJcbiAgICAgICAgICAgIC8vIGFueSBwcmV2aW91cyBkZWZpbmVkIGNhbGxiYWNrLiBUaGlzIGhhcHBlbnMgaWYgdGhpcyBtZXRob2QgaXMgY2FsbGVkXHJcbiAgICAgICAgICAgIC8vIG11bHRpcGxlIHRpbWVzIGluIHBhcmFsbGVsIGFuZCBjb3VsZCByZXN1bHQgaW4gdGhlIGxhdGVyIGNhbGxiYWNrXHJcbiAgICAgICAgICAgIC8vIG92ZXJ3cml0aW5nIHRoZSBwcmV2aW91cyBvbmUuIFRoaXMgd291bGQgZW5kIHVwIHdpdGggYSBpZnJhbWVcclxuICAgICAgICAgICAgLy8gdGltZW91dC5cclxuICAgICAgICAgICAgY29uc3QgY2JOYW1lID0gX2dlbmVyYXRlQ2FsbGJhY2tOYW1lKCdpZnJhbWVmY2InKTtcclxuICAgICAgICAgICAgLy8gR0FwaSBsb2FkZXIgbm90IGF2YWlsYWJsZSwgZHluYW1pY2FsbHkgbG9hZCBwbGF0Zm9ybS5qcy5cclxuICAgICAgICAgICAgX3dpbmRvdygpW2NiTmFtZV0gPSAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAvLyBHQXBpIGxvYWRlciBzaG91bGQgYmUgcmVhZHkuXHJcbiAgICAgICAgICAgICAgICBpZiAoISFnYXBpLmxvYWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBsb2FkR2FwaUlmcmFtZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gR2FwaSBsb2FkZXIgZmFpbGVkLCB0aHJvdyBlcnJvci5cclxuICAgICAgICAgICAgICAgICAgICByZWplY3QoX2NyZWF0ZUVycm9yKGF1dGgsIFwibmV0d29yay1yZXF1ZXN0LWZhaWxlZFwiIC8qIE5FVFdPUktfUkVRVUVTVF9GQUlMRUQgKi8pKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgLy8gTG9hZCBHQXBpIGxvYWRlci5cclxuICAgICAgICAgICAgcmV0dXJuIF9sb2FkSlMoYGh0dHBzOi8vYXBpcy5nb29nbGUuY29tL2pzL2FwaS5qcz9vbmxvYWQ9JHtjYk5hbWV9YCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSkuY2F0Y2goZXJyb3IgPT4ge1xyXG4gICAgICAgIC8vIFJlc2V0IGNhY2hlZCBwcm9taXNlIHRvIGFsbG93IGZvciByZXRyaWFsLlxyXG4gICAgICAgIGNhY2hlZEdBcGlMb2FkZXIgPSBudWxsO1xyXG4gICAgICAgIHRocm93IGVycm9yO1xyXG4gICAgfSk7XHJcbn1cclxubGV0IGNhY2hlZEdBcGlMb2FkZXIgPSBudWxsO1xyXG5mdW5jdGlvbiBfbG9hZEdhcGkoYXV0aCkge1xyXG4gICAgY2FjaGVkR0FwaUxvYWRlciA9IGNhY2hlZEdBcGlMb2FkZXIgfHwgbG9hZEdhcGkoYXV0aCk7XHJcbiAgICByZXR1cm4gY2FjaGVkR0FwaUxvYWRlcjtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuY29uc3QgUElOR19USU1FT1VUID0gbmV3IERlbGF5KDUwMDAsIDE1MDAwKTtcclxuY29uc3QgSUZSQU1FX1BBVEggPSAnX18vYXV0aC9pZnJhbWUnO1xyXG5jb25zdCBFTVVMQVRFRF9JRlJBTUVfUEFUSCA9ICdlbXVsYXRvci9hdXRoL2lmcmFtZSc7XHJcbmNvbnN0IElGUkFNRV9BVFRSSUJVVEVTID0ge1xyXG4gICAgc3R5bGU6IHtcclxuICAgICAgICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcclxuICAgICAgICB0b3A6ICctMTAwcHgnLFxyXG4gICAgICAgIHdpZHRoOiAnMXB4JyxcclxuICAgICAgICBoZWlnaHQ6ICcxcHgnXHJcbiAgICB9XHJcbn07XHJcbi8vIE1hcCBmcm9tIGFwaUhvc3QgdG8gZW5kcG9pbnQgSUQgZm9yIHBhc3NpbmcgaW50byBpZnJhbWUuIEluIGN1cnJlbnQgU0RLLCBhcGlIb3N0IGNhbiBiZSBzZXQgdG9cclxuLy8gYW55dGhpbmcgKG5vdCBmcm9tIGEgbGlzdCBvZiBlbmRwb2ludHMgd2l0aCBJRHMgYXMgaW4gbGVnYWN5KSwgc28gdGhpcyBpcyB0aGUgY2xvc2VzdCB3ZSBjYW4gZ2V0LlxyXG5jb25zdCBFSURfRlJPTV9BUElIT1NUID0gbmV3IE1hcChbXHJcbiAgICBbXCJpZGVudGl0eXRvb2xraXQuZ29vZ2xlYXBpcy5jb21cIiAvKiBBUElfSE9TVCAqLywgJ3AnXSxcclxuICAgIFsnc3RhZ2luZy1pZGVudGl0eXRvb2xraXQuc2FuZGJveC5nb29nbGVhcGlzLmNvbScsICdzJ10sXHJcbiAgICBbJ3Rlc3QtaWRlbnRpdHl0b29sa2l0LnNhbmRib3guZ29vZ2xlYXBpcy5jb20nLCAndCddIC8vIHRlc3RcclxuXSk7XHJcbmZ1bmN0aW9uIGdldElmcmFtZVVybChhdXRoKSB7XHJcbiAgICBjb25zdCBjb25maWcgPSBhdXRoLmNvbmZpZztcclxuICAgIF9hc3NlcnQoY29uZmlnLmF1dGhEb21haW4sIGF1dGgsIFwiYXV0aC1kb21haW4tY29uZmlnLXJlcXVpcmVkXCIgLyogTUlTU0lOR19BVVRIX0RPTUFJTiAqLyk7XHJcbiAgICBjb25zdCB1cmwgPSBjb25maWcuZW11bGF0b3JcclxuICAgICAgICA/IF9lbXVsYXRvclVybChjb25maWcsIEVNVUxBVEVEX0lGUkFNRV9QQVRIKVxyXG4gICAgICAgIDogYGh0dHBzOi8vJHthdXRoLmNvbmZpZy5hdXRoRG9tYWlufS8ke0lGUkFNRV9QQVRIfWA7XHJcbiAgICBjb25zdCBwYXJhbXMgPSB7XHJcbiAgICAgICAgYXBpS2V5OiBjb25maWcuYXBpS2V5LFxyXG4gICAgICAgIGFwcE5hbWU6IGF1dGgubmFtZSxcclxuICAgICAgICB2OiBTREtfVkVSU0lPTlxyXG4gICAgfTtcclxuICAgIGNvbnN0IGVpZCA9IEVJRF9GUk9NX0FQSUhPU1QuZ2V0KGF1dGguY29uZmlnLmFwaUhvc3QpO1xyXG4gICAgaWYgKGVpZCkge1xyXG4gICAgICAgIHBhcmFtcy5laWQgPSBlaWQ7XHJcbiAgICB9XHJcbiAgICBjb25zdCBmcmFtZXdvcmtzID0gYXV0aC5fZ2V0RnJhbWV3b3JrcygpO1xyXG4gICAgaWYgKGZyYW1ld29ya3MubGVuZ3RoKSB7XHJcbiAgICAgICAgcGFyYW1zLmZ3ID0gZnJhbWV3b3Jrcy5qb2luKCcsJyk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYCR7dXJsfT8ke3F1ZXJ5c3RyaW5nKHBhcmFtcykuc2xpY2UoMSl9YDtcclxufVxyXG5hc3luYyBmdW5jdGlvbiBfb3BlbklmcmFtZShhdXRoKSB7XHJcbiAgICBjb25zdCBjb250ZXh0ID0gYXdhaXQgX2xvYWRHYXBpKGF1dGgpO1xyXG4gICAgY29uc3QgZ2FwaSA9IF93aW5kb3coKS5nYXBpO1xyXG4gICAgX2Fzc2VydChnYXBpLCBhdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8pO1xyXG4gICAgcmV0dXJuIGNvbnRleHQub3Blbih7XHJcbiAgICAgICAgd2hlcmU6IGRvY3VtZW50LmJvZHksXHJcbiAgICAgICAgdXJsOiBnZXRJZnJhbWVVcmwoYXV0aCksXHJcbiAgICAgICAgbWVzc2FnZUhhbmRsZXJzRmlsdGVyOiBnYXBpLmlmcmFtZXMuQ1JPU1NfT1JJR0lOX0lGUkFNRVNfRklMVEVSLFxyXG4gICAgICAgIGF0dHJpYnV0ZXM6IElGUkFNRV9BVFRSSUJVVEVTLFxyXG4gICAgICAgIGRvbnRjbGVhcjogdHJ1ZVxyXG4gICAgfSwgKGlmcmFtZSkgPT4gbmV3IFByb21pc2UoYXN5bmMgKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgIGF3YWl0IGlmcmFtZS5yZXN0eWxlKHtcclxuICAgICAgICAgICAgLy8gUHJldmVudCBpZnJhbWUgZnJvbSBjbG9zaW5nIG9uIG1vdXNlIG91dC5cclxuICAgICAgICAgICAgc2V0SGlkZU9uTGVhdmU6IGZhbHNlXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY29uc3QgbmV0d29ya0Vycm9yID0gX2NyZWF0ZUVycm9yKGF1dGgsIFwibmV0d29yay1yZXF1ZXN0LWZhaWxlZFwiIC8qIE5FVFdPUktfUkVRVUVTVF9GQUlMRUQgKi8pO1xyXG4gICAgICAgIC8vIENvbmZpcm0gaWZyYW1lIGlzIGNvcnJlY3RseSBsb2FkZWQuXHJcbiAgICAgICAgLy8gVG8gZmFsbGJhY2sgb24gZmFpbHVyZSwgc2V0IGEgdGltZW91dC5cclxuICAgICAgICBjb25zdCBuZXR3b3JrRXJyb3JUaW1lciA9IF93aW5kb3coKS5zZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgcmVqZWN0KG5ldHdvcmtFcnJvcik7XHJcbiAgICAgICAgfSwgUElOR19USU1FT1VULmdldCgpKTtcclxuICAgICAgICAvLyBDbGVhciB0aW1lciBhbmQgcmVzb2x2ZSBwZW5kaW5nIGlmcmFtZSByZWFkeSBwcm9taXNlLlxyXG4gICAgICAgIGZ1bmN0aW9uIGNsZWFyVGltZXJBbmRSZXNvbHZlKCkge1xyXG4gICAgICAgICAgICBfd2luZG93KCkuY2xlYXJUaW1lb3V0KG5ldHdvcmtFcnJvclRpbWVyKTtcclxuICAgICAgICAgICAgcmVzb2x2ZShpZnJhbWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBUaGlzIHJldHVybnMgYW4gSVRoZW5hYmxlLiBIb3dldmVyIHRoZSByZWplY3QgcGFydCBkb2VzIG5vdCBjYWxsXHJcbiAgICAgICAgLy8gd2hlbiB0aGUgaWZyYW1lIGlzIG5vdCBsb2FkZWQuXHJcbiAgICAgICAgaWZyYW1lLnBpbmcoY2xlYXJUaW1lckFuZFJlc29sdmUpLnRoZW4oY2xlYXJUaW1lckFuZFJlc29sdmUsICgpID0+IHtcclxuICAgICAgICAgICAgcmVqZWN0KG5ldHdvcmtFcnJvcik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KSk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTEMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmNvbnN0IEJBU0VfUE9QVVBfT1BUSU9OUyA9IHtcclxuICAgIGxvY2F0aW9uOiAneWVzJyxcclxuICAgIHJlc2l6YWJsZTogJ3llcycsXHJcbiAgICBzdGF0dXNiYXI6ICd5ZXMnLFxyXG4gICAgdG9vbGJhcjogJ25vJ1xyXG59O1xyXG5jb25zdCBERUZBVUxUX1dJRFRIID0gNTAwO1xyXG5jb25zdCBERUZBVUxUX0hFSUdIVCA9IDYwMDtcclxuY29uc3QgVEFSR0VUX0JMQU5LID0gJ19ibGFuayc7XHJcbmNvbnN0IEZJUkVGT1hfRU1QVFlfVVJMID0gJ2h0dHA6Ly9sb2NhbGhvc3QnO1xyXG5jbGFzcyBBdXRoUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3Iod2luZG93KSB7XHJcbiAgICAgICAgdGhpcy53aW5kb3cgPSB3aW5kb3c7XHJcbiAgICAgICAgdGhpcy5hc3NvY2lhdGVkRXZlbnQgPSBudWxsO1xyXG4gICAgfVxyXG4gICAgY2xvc2UoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMud2luZG93KSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLndpbmRvdy5jbG9zZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhdGNoIChlKSB7IH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gX29wZW4oYXV0aCwgdXJsLCBuYW1lLCB3aWR0aCA9IERFRkFVTFRfV0lEVEgsIGhlaWdodCA9IERFRkFVTFRfSEVJR0hUKSB7XHJcbiAgICBjb25zdCB0b3AgPSBNYXRoLm1heCgod2luZG93LnNjcmVlbi5hdmFpbEhlaWdodCAtIGhlaWdodCkgLyAyLCAwKS50b1N0cmluZygpO1xyXG4gICAgY29uc3QgbGVmdCA9IE1hdGgubWF4KCh3aW5kb3cuc2NyZWVuLmF2YWlsV2lkdGggLSB3aWR0aCkgLyAyLCAwKS50b1N0cmluZygpO1xyXG4gICAgbGV0IHRhcmdldCA9ICcnO1xyXG4gICAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgQkFTRV9QT1BVUF9PUFRJT05TKSwgeyB3aWR0aDogd2lkdGgudG9TdHJpbmcoKSwgaGVpZ2h0OiBoZWlnaHQudG9TdHJpbmcoKSwgdG9wLFxyXG4gICAgICAgIGxlZnQgfSk7XHJcbiAgICAvLyBDaHJvbWUgaU9TIDcgYW5kIDggaXMgcmV0dXJuaW5nIGFuIHVuZGVmaW5lZCBwb3B1cCB3aW4gd2hlbiB0YXJnZXQgaXNcclxuICAgIC8vIHNwZWNpZmllZCwgZXZlbiB0aG91Z2ggdGhlIHBvcHVwIGlzIG5vdCBuZWNlc3NhcmlseSBibG9ja2VkLlxyXG4gICAgY29uc3QgdWEgPSBnZXRVQSgpLnRvTG93ZXJDYXNlKCk7XHJcbiAgICBpZiAobmFtZSkge1xyXG4gICAgICAgIHRhcmdldCA9IF9pc0Nocm9tZUlPUyh1YSkgPyBUQVJHRVRfQkxBTksgOiBuYW1lO1xyXG4gICAgfVxyXG4gICAgaWYgKF9pc0ZpcmVmb3godWEpKSB7XHJcbiAgICAgICAgLy8gRmlyZWZveCBjb21wbGFpbnMgd2hlbiBpbnZhbGlkIFVSTHMgYXJlIHBvcHBlZCBvdXQuIEhhY2t5IHdheSB0byBieXBhc3MuXHJcbiAgICAgICAgdXJsID0gdXJsIHx8IEZJUkVGT1hfRU1QVFlfVVJMO1xyXG4gICAgICAgIC8vIEZpcmVmb3ggZGlzYWJsZXMgYnkgZGVmYXVsdCBzY3JvbGxpbmcgb24gcG9wdXAgd2luZG93cywgd2hpY2ggY2FuIGNyZWF0ZVxyXG4gICAgICAgIC8vIGlzc3VlcyB3aGVuIHRoZSB1c2VyIGhhcyBtYW55IEdvb2dsZSBhY2NvdW50cywgZm9yIGluc3RhbmNlLlxyXG4gICAgICAgIG9wdGlvbnMuc2Nyb2xsYmFycyA9ICd5ZXMnO1xyXG4gICAgfVxyXG4gICAgY29uc3Qgb3B0aW9uc1N0cmluZyA9IE9iamVjdC5lbnRyaWVzKG9wdGlvbnMpLnJlZHVjZSgoYWNjdW0sIFtrZXksIHZhbHVlXSkgPT4gYCR7YWNjdW19JHtrZXl9PSR7dmFsdWV9LGAsICcnKTtcclxuICAgIGlmIChfaXNJT1NTdGFuZGFsb25lKHVhKSAmJiB0YXJnZXQgIT09ICdfc2VsZicpIHtcclxuICAgICAgICBvcGVuQXNOZXdXaW5kb3dJT1ModXJsIHx8ICcnLCB0YXJnZXQpO1xyXG4gICAgICAgIHJldHVybiBuZXcgQXV0aFBvcHVwKG51bGwpO1xyXG4gICAgfVxyXG4gICAgLy8gYWJvdXQ6YmxhbmsgZ2V0dGluZyBzYW5pdGl6ZWQgY2F1c2luZyBicm93c2VycyBsaWtlIElFL0VkZ2UgdG8gZGlzcGxheVxyXG4gICAgLy8gYnJpZWYgZXJyb3IgbWVzc2FnZSBiZWZvcmUgcmVkaXJlY3RpbmcgdG8gaGFuZGxlci5cclxuICAgIGNvbnN0IG5ld1dpbiA9IHdpbmRvdy5vcGVuKHVybCB8fCAnJywgdGFyZ2V0LCBvcHRpb25zU3RyaW5nKTtcclxuICAgIF9hc3NlcnQobmV3V2luLCBhdXRoLCBcInBvcHVwLWJsb2NrZWRcIiAvKiBQT1BVUF9CTE9DS0VEICovKTtcclxuICAgIC8vIEZsYWt5IG9uIElFIGVkZ2UsIGVuY2Fwc3VsYXRlIHdpdGggYSB0cnkgYW5kIGNhdGNoLlxyXG4gICAgdHJ5IHtcclxuICAgICAgICBuZXdXaW4uZm9jdXMoKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlKSB7IH1cclxuICAgIHJldHVybiBuZXcgQXV0aFBvcHVwKG5ld1dpbik7XHJcbn1cclxuZnVuY3Rpb24gb3BlbkFzTmV3V2luZG93SU9TKHVybCwgdGFyZ2V0KSB7XHJcbiAgICBjb25zdCBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcclxuICAgIGVsLmhyZWYgPSB1cmw7XHJcbiAgICBlbC50YXJnZXQgPSB0YXJnZXQ7XHJcbiAgICBjb25zdCBjbGljayA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdNb3VzZUV2ZW50Jyk7XHJcbiAgICBjbGljay5pbml0TW91c2VFdmVudCgnY2xpY2snLCB0cnVlLCB0cnVlLCB3aW5kb3csIDEsIDAsIDAsIDAsIDAsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCAxLCBudWxsKTtcclxuICAgIGVsLmRpc3BhdGNoRXZlbnQoY2xpY2spO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBVUkwgZm9yIEF1dGhlbnRpY2F0aW9uIHdpZGdldCB3aGljaCB3aWxsIGluaXRpYXRlIHRoZSBPQXV0aCBoYW5kc2hha2VcclxuICpcclxuICogQGludGVybmFsXHJcbiAqL1xyXG5jb25zdCBXSURHRVRfUEFUSCA9ICdfXy9hdXRoL2hhbmRsZXInO1xyXG4vKipcclxuICogVVJMIGZvciBlbXVsYXRlZCBlbnZpcm9ubWVudFxyXG4gKlxyXG4gKiBAaW50ZXJuYWxcclxuICovXHJcbmNvbnN0IEVNVUxBVE9SX1dJREdFVF9QQVRIID0gJ2VtdWxhdG9yL2F1dGgvaGFuZGxlcic7XHJcbmZ1bmN0aW9uIF9nZXRSZWRpcmVjdFVybChhdXRoLCBwcm92aWRlciwgYXV0aFR5cGUsIHJlZGlyZWN0VXJsLCBldmVudElkLCBhZGRpdGlvbmFsUGFyYW1zKSB7XHJcbiAgICBfYXNzZXJ0KGF1dGguY29uZmlnLmF1dGhEb21haW4sIGF1dGgsIFwiYXV0aC1kb21haW4tY29uZmlnLXJlcXVpcmVkXCIgLyogTUlTU0lOR19BVVRIX0RPTUFJTiAqLyk7XHJcbiAgICBfYXNzZXJ0KGF1dGguY29uZmlnLmFwaUtleSwgYXV0aCwgXCJpbnZhbGlkLWFwaS1rZXlcIiAvKiBJTlZBTElEX0FQSV9LRVkgKi8pO1xyXG4gICAgY29uc3QgcGFyYW1zID0ge1xyXG4gICAgICAgIGFwaUtleTogYXV0aC5jb25maWcuYXBpS2V5LFxyXG4gICAgICAgIGFwcE5hbWU6IGF1dGgubmFtZSxcclxuICAgICAgICBhdXRoVHlwZSxcclxuICAgICAgICByZWRpcmVjdFVybCxcclxuICAgICAgICB2OiBTREtfVkVSU0lPTixcclxuICAgICAgICBldmVudElkXHJcbiAgICB9O1xyXG4gICAgaWYgKHByb3ZpZGVyIGluc3RhbmNlb2YgRmVkZXJhdGVkQXV0aFByb3ZpZGVyKSB7XHJcbiAgICAgICAgcHJvdmlkZXIuc2V0RGVmYXVsdExhbmd1YWdlKGF1dGgubGFuZ3VhZ2VDb2RlKTtcclxuICAgICAgICBwYXJhbXMucHJvdmlkZXJJZCA9IHByb3ZpZGVyLnByb3ZpZGVySWQgfHwgJyc7XHJcbiAgICAgICAgaWYgKCFpc0VtcHR5KHByb3ZpZGVyLmdldEN1c3RvbVBhcmFtZXRlcnMoKSkpIHtcclxuICAgICAgICAgICAgcGFyYW1zLmN1c3RvbVBhcmFtZXRlcnMgPSBKU09OLnN0cmluZ2lmeShwcm92aWRlci5nZXRDdXN0b21QYXJhbWV0ZXJzKCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBUT0RPIHNldCBhZGRpdGlvbmFsUGFyYW1zIGZyb20gdGhlIHByb3ZpZGVyIGFzIHdlbGw/XHJcbiAgICAgICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoYWRkaXRpb25hbFBhcmFtcyB8fCB7fSkpIHtcclxuICAgICAgICAgICAgcGFyYW1zW2tleV0gPSB2YWx1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAocHJvdmlkZXIgaW5zdGFuY2VvZiBCYXNlT0F1dGhQcm92aWRlcikge1xyXG4gICAgICAgIGNvbnN0IHNjb3BlcyA9IHByb3ZpZGVyLmdldFNjb3BlcygpLmZpbHRlcihzY29wZSA9PiBzY29wZSAhPT0gJycpO1xyXG4gICAgICAgIGlmIChzY29wZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBwYXJhbXMuc2NvcGVzID0gc2NvcGVzLmpvaW4oJywnKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAoYXV0aC50ZW5hbnRJZCkge1xyXG4gICAgICAgIHBhcmFtcy50aWQgPSBhdXRoLnRlbmFudElkO1xyXG4gICAgfVxyXG4gICAgLy8gVE9ETzogbWF5YmUgc2V0IGVpZCBhcyBlbmRpcG9pbnRJZFxyXG4gICAgLy8gVE9ETzogbWF5YmUgc2V0IGZ3IGFzIEZyYW1ld29ya3Muam9pbihcIixcIilcclxuICAgIGNvbnN0IHBhcmFtc0RpY3QgPSBwYXJhbXM7XHJcbiAgICBmb3IgKGNvbnN0IGtleSBvZiBPYmplY3Qua2V5cyhwYXJhbXNEaWN0KSkge1xyXG4gICAgICAgIGlmIChwYXJhbXNEaWN0W2tleV0gPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBkZWxldGUgcGFyYW1zRGljdFtrZXldO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBgJHtnZXRIYW5kbGVyQmFzZShhdXRoKX0/JHtxdWVyeXN0cmluZyhwYXJhbXNEaWN0KS5zbGljZSgxKX1gO1xyXG59XHJcbmZ1bmN0aW9uIGdldEhhbmRsZXJCYXNlKHsgY29uZmlnIH0pIHtcclxuICAgIGlmICghY29uZmlnLmVtdWxhdG9yKSB7XHJcbiAgICAgICAgcmV0dXJuIGBodHRwczovLyR7Y29uZmlnLmF1dGhEb21haW59LyR7V0lER0VUX1BBVEh9YDtcclxuICAgIH1cclxuICAgIHJldHVybiBfZW11bGF0b3JVcmwoY29uZmlnLCBFTVVMQVRPUl9XSURHRVRfUEFUSCk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFRoZSBzcGVjaWFsIHdlYiBzdG9yYWdlIGV2ZW50XHJcbiAqXHJcbiAqL1xyXG5jb25zdCBXRUJfU1RPUkFHRV9TVVBQT1JUX0tFWSA9ICd3ZWJTdG9yYWdlU3VwcG9ydCc7XHJcbmNsYXNzIEJyb3dzZXJQb3B1cFJlZGlyZWN0UmVzb2x2ZXIge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgdGhpcy5ldmVudE1hbmFnZXJzID0ge307XHJcbiAgICAgICAgdGhpcy5pZnJhbWVzID0ge307XHJcbiAgICAgICAgdGhpcy5vcmlnaW5WYWxpZGF0aW9uUHJvbWlzZXMgPSB7fTtcclxuICAgICAgICB0aGlzLl9yZWRpcmVjdFBlcnNpc3RlbmNlID0gYnJvd3NlclNlc3Npb25QZXJzaXN0ZW5jZTtcclxuICAgICAgICB0aGlzLl9jb21wbGV0ZVJlZGlyZWN0Rm4gPSBfZ2V0UmVkaXJlY3RSZXN1bHQ7XHJcbiAgICB9XHJcbiAgICAvLyBXcmFwcGluZyBpbiBhc3luYyBldmVuIHRob3VnaCB3ZSBkb24ndCBhd2FpdCBhbnl3aGVyZSBpbiBvcmRlclxyXG4gICAgLy8gdG8gbWFrZSBzdXJlIGVycm9ycyBhcmUgcmFpc2VkIGFzIHByb21pc2UgcmVqZWN0aW9uc1xyXG4gICAgYXN5bmMgX29wZW5Qb3B1cChhdXRoLCBwcm92aWRlciwgYXV0aFR5cGUsIGV2ZW50SWQpIHtcclxuICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgZGVidWdBc3NlcnQoKF9hID0gdGhpcy5ldmVudE1hbmFnZXJzW2F1dGguX2tleSgpXSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLm1hbmFnZXIsICdfaW5pdGlhbGl6ZSgpIG5vdCBjYWxsZWQgYmVmb3JlIF9vcGVuUG9wdXAoKScpO1xyXG4gICAgICAgIGNvbnN0IHVybCA9IF9nZXRSZWRpcmVjdFVybChhdXRoLCBwcm92aWRlciwgYXV0aFR5cGUsIF9nZXRDdXJyZW50VXJsKCksIGV2ZW50SWQpO1xyXG4gICAgICAgIHJldHVybiBfb3BlbihhdXRoLCB1cmwsIF9nZW5lcmF0ZUV2ZW50SWQoKSk7XHJcbiAgICB9XHJcbiAgICBhc3luYyBfb3BlblJlZGlyZWN0KGF1dGgsIHByb3ZpZGVyLCBhdXRoVHlwZSwgZXZlbnRJZCkge1xyXG4gICAgICAgIGF3YWl0IHRoaXMuX29yaWdpblZhbGlkYXRpb24oYXV0aCk7XHJcbiAgICAgICAgX3NldFdpbmRvd0xvY2F0aW9uKF9nZXRSZWRpcmVjdFVybChhdXRoLCBwcm92aWRlciwgYXV0aFR5cGUsIF9nZXRDdXJyZW50VXJsKCksIGV2ZW50SWQpKTtcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKCkgPT4geyB9KTtcclxuICAgIH1cclxuICAgIF9pbml0aWFsaXplKGF1dGgpIHtcclxuICAgICAgICBjb25zdCBrZXkgPSBhdXRoLl9rZXkoKTtcclxuICAgICAgICBpZiAodGhpcy5ldmVudE1hbmFnZXJzW2tleV0pIHtcclxuICAgICAgICAgICAgY29uc3QgeyBtYW5hZ2VyLCBwcm9taXNlIH0gPSB0aGlzLmV2ZW50TWFuYWdlcnNba2V5XTtcclxuICAgICAgICAgICAgaWYgKG1hbmFnZXIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobWFuYWdlcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBkZWJ1Z0Fzc2VydChwcm9taXNlLCAnSWYgbWFuYWdlciBpcyBub3Qgc2V0LCBwcm9taXNlIHNob3VsZCBiZScpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHByb21pc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgcHJvbWlzZSA9IHRoaXMuaW5pdEFuZEdldE1hbmFnZXIoYXV0aCk7XHJcbiAgICAgICAgdGhpcy5ldmVudE1hbmFnZXJzW2tleV0gPSB7IHByb21pc2UgfTtcclxuICAgICAgICByZXR1cm4gcHJvbWlzZTtcclxuICAgIH1cclxuICAgIGFzeW5jIGluaXRBbmRHZXRNYW5hZ2VyKGF1dGgpIHtcclxuICAgICAgICBjb25zdCBpZnJhbWUgPSBhd2FpdCBfb3BlbklmcmFtZShhdXRoKTtcclxuICAgICAgICBjb25zdCBtYW5hZ2VyID0gbmV3IEF1dGhFdmVudE1hbmFnZXIoYXV0aCk7XHJcbiAgICAgICAgaWZyYW1lLnJlZ2lzdGVyKCdhdXRoRXZlbnQnLCAoaWZyYW1lRXZlbnQpID0+IHtcclxuICAgICAgICAgICAgX2Fzc2VydChpZnJhbWVFdmVudCA9PT0gbnVsbCB8fCBpZnJhbWVFdmVudCA9PT0gdm9pZCAwID8gdm9pZCAwIDogaWZyYW1lRXZlbnQuYXV0aEV2ZW50LCBhdXRoLCBcImludmFsaWQtYXV0aC1ldmVudFwiIC8qIElOVkFMSURfQVVUSF9FVkVOVCAqLyk7XHJcbiAgICAgICAgICAgIC8vIFRPRE86IENvbnNpZGVyIHNwbGl0dGluZyByZWRpcmVjdCBhbmQgcG9wdXAgZXZlbnRzIGVhcmxpZXIgb25cclxuICAgICAgICAgICAgY29uc3QgaGFuZGxlZCA9IG1hbmFnZXIub25FdmVudChpZnJhbWVFdmVudC5hdXRoRXZlbnQpO1xyXG4gICAgICAgICAgICByZXR1cm4geyBzdGF0dXM6IGhhbmRsZWQgPyBcIkFDS1wiIC8qIEFDSyAqLyA6IFwiRVJST1JcIiAvKiBFUlJPUiAqLyB9O1xyXG4gICAgICAgIH0sIGdhcGkuaWZyYW1lcy5DUk9TU19PUklHSU5fSUZSQU1FU19GSUxURVIpO1xyXG4gICAgICAgIHRoaXMuZXZlbnRNYW5hZ2Vyc1thdXRoLl9rZXkoKV0gPSB7IG1hbmFnZXIgfTtcclxuICAgICAgICB0aGlzLmlmcmFtZXNbYXV0aC5fa2V5KCldID0gaWZyYW1lO1xyXG4gICAgICAgIHJldHVybiBtYW5hZ2VyO1xyXG4gICAgfVxyXG4gICAgX2lzSWZyYW1lV2ViU3RvcmFnZVN1cHBvcnRlZChhdXRoLCBjYikge1xyXG4gICAgICAgIGNvbnN0IGlmcmFtZSA9IHRoaXMuaWZyYW1lc1thdXRoLl9rZXkoKV07XHJcbiAgICAgICAgaWZyYW1lLnNlbmQoV0VCX1NUT1JBR0VfU1VQUE9SVF9LRVksIHsgdHlwZTogV0VCX1NUT1JBR0VfU1VQUE9SVF9LRVkgfSwgcmVzdWx0ID0+IHtcclxuICAgICAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgICAgICBjb25zdCBpc1N1cHBvcnRlZCA9IChfYSA9IHJlc3VsdCA9PT0gbnVsbCB8fCByZXN1bHQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHJlc3VsdFswXSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hW1dFQl9TVE9SQUdFX1NVUFBPUlRfS0VZXTtcclxuICAgICAgICAgICAgaWYgKGlzU3VwcG9ydGVkICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIGNiKCEhaXNTdXBwb3J0ZWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIF9mYWlsKGF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyk7XHJcbiAgICAgICAgfSwgZ2FwaS5pZnJhbWVzLkNST1NTX09SSUdJTl9JRlJBTUVTX0ZJTFRFUik7XHJcbiAgICB9XHJcbiAgICBfb3JpZ2luVmFsaWRhdGlvbihhdXRoKSB7XHJcbiAgICAgICAgY29uc3Qga2V5ID0gYXV0aC5fa2V5KCk7XHJcbiAgICAgICAgaWYgKCF0aGlzLm9yaWdpblZhbGlkYXRpb25Qcm9taXNlc1trZXldKSB7XHJcbiAgICAgICAgICAgIHRoaXMub3JpZ2luVmFsaWRhdGlvblByb21pc2VzW2tleV0gPSBfdmFsaWRhdGVPcmlnaW4oYXV0aCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLm9yaWdpblZhbGlkYXRpb25Qcm9taXNlc1trZXldO1xyXG4gICAgfVxyXG4gICAgZ2V0IF9zaG91bGRJbml0UHJvYWN0aXZlbHkoKSB7XHJcbiAgICAgICAgLy8gTW9iaWxlIGJyb3dzZXJzIGFuZCBTYWZhcmkgbmVlZCB0byBvcHRpbWlzdGljYWxseSBpbml0aWFsaXplXHJcbiAgICAgICAgcmV0dXJuIF9pc01vYmlsZUJyb3dzZXIoKSB8fCBfaXNTYWZhcmkoKSB8fCBfaXNJT1MoKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogQW4gaW1wbGVtZW50YXRpb24gb2Yge0BsaW5rIFBvcHVwUmVkaXJlY3RSZXNvbHZlcn0gc3VpdGFibGUgZm9yIGJyb3dzZXJcclxuICogYmFzZWQgYXBwbGljYXRpb25zLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5jb25zdCBicm93c2VyUG9wdXBSZWRpcmVjdFJlc29sdmVyID0gQnJvd3NlclBvcHVwUmVkaXJlY3RSZXNvbHZlcjtcblxuY2xhc3MgTXVsdGlGYWN0b3JBc3NlcnRpb25JbXBsIHtcclxuICAgIGNvbnN0cnVjdG9yKGZhY3RvcklkKSB7XHJcbiAgICAgICAgdGhpcy5mYWN0b3JJZCA9IGZhY3RvcklkO1xyXG4gICAgfVxyXG4gICAgX3Byb2Nlc3MoYXV0aCwgc2Vzc2lvbiwgZGlzcGxheU5hbWUpIHtcclxuICAgICAgICBzd2l0Y2ggKHNlc3Npb24udHlwZSkge1xyXG4gICAgICAgICAgICBjYXNlIFwiZW5yb2xsXCIgLyogRU5ST0xMICovOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2ZpbmFsaXplRW5yb2xsKGF1dGgsIHNlc3Npb24uY3JlZGVudGlhbCwgZGlzcGxheU5hbWUpO1xyXG4gICAgICAgICAgICBjYXNlIFwic2lnbmluXCIgLyogU0lHTl9JTiAqLzpcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9maW5hbGl6ZVNpZ25JbihhdXRoLCBzZXNzaW9uLmNyZWRlbnRpYWwpO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlYnVnRmFpbCgndW5leHBlY3RlZCBNdWx0aUZhY3RvclNlc3Npb25UeXBlJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiB7QGluaGVyaXRkb2MgUGhvbmVNdWx0aUZhY3RvckFzc2VydGlvbn1cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuY2xhc3MgUGhvbmVNdWx0aUZhY3RvckFzc2VydGlvbkltcGwgZXh0ZW5kcyBNdWx0aUZhY3RvckFzc2VydGlvbkltcGwge1xyXG4gICAgY29uc3RydWN0b3IoY3JlZGVudGlhbCkge1xyXG4gICAgICAgIHN1cGVyKFwicGhvbmVcIiAvKiBQSE9ORSAqLyk7XHJcbiAgICAgICAgdGhpcy5jcmVkZW50aWFsID0gY3JlZGVudGlhbDtcclxuICAgIH1cclxuICAgIC8qKiBAaW50ZXJuYWwgKi9cclxuICAgIHN0YXRpYyBfZnJvbUNyZWRlbnRpYWwoY3JlZGVudGlhbCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgUGhvbmVNdWx0aUZhY3RvckFzc2VydGlvbkltcGwoY3JlZGVudGlhbCk7XHJcbiAgICB9XHJcbiAgICAvKiogQGludGVybmFsICovXHJcbiAgICBfZmluYWxpemVFbnJvbGwoYXV0aCwgaWRUb2tlbiwgZGlzcGxheU5hbWUpIHtcclxuICAgICAgICByZXR1cm4gZmluYWxpemVFbnJvbGxQaG9uZU1mYShhdXRoLCB7XHJcbiAgICAgICAgICAgIGlkVG9rZW4sXHJcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lLFxyXG4gICAgICAgICAgICBwaG9uZVZlcmlmaWNhdGlvbkluZm86IHRoaXMuY3JlZGVudGlhbC5fbWFrZVZlcmlmaWNhdGlvblJlcXVlc3QoKVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyoqIEBpbnRlcm5hbCAqL1xyXG4gICAgX2ZpbmFsaXplU2lnbkluKGF1dGgsIG1mYVBlbmRpbmdDcmVkZW50aWFsKSB7XHJcbiAgICAgICAgcmV0dXJuIGZpbmFsaXplU2lnbkluUGhvbmVNZmEoYXV0aCwge1xyXG4gICAgICAgICAgICBtZmFQZW5kaW5nQ3JlZGVudGlhbCxcclxuICAgICAgICAgICAgcGhvbmVWZXJpZmljYXRpb25JbmZvOiB0aGlzLmNyZWRlbnRpYWwuX21ha2VWZXJpZmljYXRpb25SZXF1ZXN0KClcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogUHJvdmlkZXIgZm9yIGdlbmVyYXRpbmcgYSB7QGxpbmsgUGhvbmVNdWx0aUZhY3RvckFzc2VydGlvbn0uXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmNsYXNzIFBob25lTXVsdGlGYWN0b3JHZW5lcmF0b3Ige1xyXG4gICAgY29uc3RydWN0b3IoKSB7IH1cclxuICAgIC8qKlxyXG4gICAgICogUHJvdmlkZXMgYSB7QGxpbmsgUGhvbmVNdWx0aUZhY3RvckFzc2VydGlvbn0gdG8gY29uZmlybSBvd25lcnNoaXAgb2YgdGhlIHBob25lIHNlY29uZCBmYWN0b3IuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHBob25lQXV0aENyZWRlbnRpYWwgLSBBIGNyZWRlbnRpYWwgcHJvdmlkZWQgYnkge0BsaW5rIFBob25lQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWx9LlxyXG4gICAgICogQHJldHVybnMgQSB7QGxpbmsgUGhvbmVNdWx0aUZhY3RvckFzc2VydGlvbn0gd2hpY2ggY2FuIGJlIHVzZWQgd2l0aFxyXG4gICAgICoge0BsaW5rIE11bHRpRmFjdG9yUmVzb2x2ZXIucmVzb2x2ZVNpZ25Jbn1cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGFzc2VydGlvbihjcmVkZW50aWFsKSB7XHJcbiAgICAgICAgcmV0dXJuIFBob25lTXVsdGlGYWN0b3JBc3NlcnRpb25JbXBsLl9mcm9tQ3JlZGVudGlhbChjcmVkZW50aWFsKTtcclxuICAgIH1cclxufVxuXG52YXIgbmFtZSA9IFwiQGZpcmViYXNlL2F1dGhcIjtcbnZhciB2ZXJzaW9uID0gXCIwLjE3LjFcIjtcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuY2xhc3MgQXV0aEludGVyb3Age1xyXG4gICAgY29uc3RydWN0b3IoYXV0aCkge1xyXG4gICAgICAgIHRoaXMuYXV0aCA9IGF1dGg7XHJcbiAgICAgICAgdGhpcy5pbnRlcm5hbExpc3RlbmVycyA9IG5ldyBNYXAoKTtcclxuICAgIH1cclxuICAgIGdldFVpZCgpIHtcclxuICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgdGhpcy5hc3NlcnRBdXRoQ29uZmlndXJlZCgpO1xyXG4gICAgICAgIHJldHVybiAoKF9hID0gdGhpcy5hdXRoLmN1cnJlbnRVc2VyKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EudWlkKSB8fCBudWxsO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgZ2V0VG9rZW4oZm9yY2VSZWZyZXNoKSB7XHJcbiAgICAgICAgdGhpcy5hc3NlcnRBdXRoQ29uZmlndXJlZCgpO1xyXG4gICAgICAgIGF3YWl0IHRoaXMuYXV0aC5faW5pdGlhbGl6YXRpb25Qcm9taXNlO1xyXG4gICAgICAgIGlmICghdGhpcy5hdXRoLmN1cnJlbnRVc2VyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBhY2Nlc3NUb2tlbiA9IGF3YWl0IHRoaXMuYXV0aC5jdXJyZW50VXNlci5nZXRJZFRva2VuKGZvcmNlUmVmcmVzaCk7XHJcbiAgICAgICAgcmV0dXJuIHsgYWNjZXNzVG9rZW4gfTtcclxuICAgIH1cclxuICAgIGFkZEF1dGhUb2tlbkxpc3RlbmVyKGxpc3RlbmVyKSB7XHJcbiAgICAgICAgdGhpcy5hc3NlcnRBdXRoQ29uZmlndXJlZCgpO1xyXG4gICAgICAgIGlmICh0aGlzLmludGVybmFsTGlzdGVuZXJzLmhhcyhsaXN0ZW5lcikpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCB1bnN1YnNjcmliZSA9IHRoaXMuYXV0aC5vbklkVG9rZW5DaGFuZ2VkKHVzZXIgPT4ge1xyXG4gICAgICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgICAgIGxpc3RlbmVyKCgoX2EgPSB1c2VyKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Euc3RzVG9rZW5NYW5hZ2VyLmFjY2Vzc1Rva2VuKSB8fCBudWxsKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmludGVybmFsTGlzdGVuZXJzLnNldChsaXN0ZW5lciwgdW5zdWJzY3JpYmUpO1xyXG4gICAgICAgIHRoaXMudXBkYXRlUHJvYWN0aXZlUmVmcmVzaCgpO1xyXG4gICAgfVxyXG4gICAgcmVtb3ZlQXV0aFRva2VuTGlzdGVuZXIobGlzdGVuZXIpIHtcclxuICAgICAgICB0aGlzLmFzc2VydEF1dGhDb25maWd1cmVkKCk7XHJcbiAgICAgICAgY29uc3QgdW5zdWJzY3JpYmUgPSB0aGlzLmludGVybmFsTGlzdGVuZXJzLmdldChsaXN0ZW5lcik7XHJcbiAgICAgICAgaWYgKCF1bnN1YnNjcmliZSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaW50ZXJuYWxMaXN0ZW5lcnMuZGVsZXRlKGxpc3RlbmVyKTtcclxuICAgICAgICB1bnN1YnNjcmliZSgpO1xyXG4gICAgICAgIHRoaXMudXBkYXRlUHJvYWN0aXZlUmVmcmVzaCgpO1xyXG4gICAgfVxyXG4gICAgYXNzZXJ0QXV0aENvbmZpZ3VyZWQoKSB7XHJcbiAgICAgICAgX2Fzc2VydCh0aGlzLmF1dGguX2luaXRpYWxpemF0aW9uUHJvbWlzZSwgXCJkZXBlbmRlbnQtc2RrLWluaXRpYWxpemVkLWJlZm9yZS1hdXRoXCIgLyogREVQRU5ERU5UX1NES19JTklUX0JFRk9SRV9BVVRIICovKTtcclxuICAgIH1cclxuICAgIHVwZGF0ZVByb2FjdGl2ZVJlZnJlc2goKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaW50ZXJuYWxMaXN0ZW5lcnMuc2l6ZSA+IDApIHtcclxuICAgICAgICAgICAgdGhpcy5hdXRoLl9zdGFydFByb2FjdGl2ZVJlZnJlc2goKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuYXV0aC5fc3RvcFByb2FjdGl2ZVJlZnJlc2goKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuZnVuY3Rpb24gZ2V0VmVyc2lvbkZvclBsYXRmb3JtKGNsaWVudFBsYXRmb3JtKSB7XHJcbiAgICBzd2l0Y2ggKGNsaWVudFBsYXRmb3JtKSB7XHJcbiAgICAgICAgY2FzZSBcIk5vZGVcIiAvKiBOT0RFICovOlxyXG4gICAgICAgICAgICByZXR1cm4gJ25vZGUnO1xyXG4gICAgICAgIGNhc2UgXCJSZWFjdE5hdGl2ZVwiIC8qIFJFQUNUX05BVElWRSAqLzpcclxuICAgICAgICAgICAgcmV0dXJuICdybic7XHJcbiAgICAgICAgY2FzZSBcIldvcmtlclwiIC8qIFdPUktFUiAqLzpcclxuICAgICAgICAgICAgcmV0dXJuICd3ZWJ3b3JrZXInO1xyXG4gICAgICAgIGNhc2UgXCJDb3Jkb3ZhXCIgLyogQ09SRE9WQSAqLzpcclxuICAgICAgICAgICAgcmV0dXJuICdjb3Jkb3ZhJztcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgfVxyXG59XHJcbi8qKiBAaW50ZXJuYWwgKi9cclxuZnVuY3Rpb24gcmVnaXN0ZXJBdXRoKGNsaWVudFBsYXRmb3JtKSB7XHJcbiAgICBfcmVnaXN0ZXJDb21wb25lbnQobmV3IENvbXBvbmVudChcImF1dGhcIiAvKiBBVVRIICovLCAoY29udGFpbmVyLCB7IG9wdGlvbnM6IGRlcHMgfSkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGFwcCA9IGNvbnRhaW5lci5nZXRQcm92aWRlcignYXBwJykuZ2V0SW1tZWRpYXRlKCk7XHJcbiAgICAgICAgY29uc3QgeyBhcGlLZXksIGF1dGhEb21haW4gfSA9IGFwcC5vcHRpb25zO1xyXG4gICAgICAgIHJldHVybiAoYXBwID0+IHtcclxuICAgICAgICAgICAgX2Fzc2VydChhcGlLZXkgJiYgIWFwaUtleS5pbmNsdWRlcygnOicpLCBcImludmFsaWQtYXBpLWtleVwiIC8qIElOVkFMSURfQVBJX0tFWSAqLywgeyBhcHBOYW1lOiBhcHAubmFtZSB9KTtcclxuICAgICAgICAgICAgLy8gQXV0aCBkb21haW4gaXMgb3B0aW9uYWwgaWYgSWRQIHNpZ24gaW4gaXNuJ3QgYmVpbmcgdXNlZFxyXG4gICAgICAgICAgICBfYXNzZXJ0KCEoYXV0aERvbWFpbiA9PT0gbnVsbCB8fCBhdXRoRG9tYWluID09PSB2b2lkIDAgPyB2b2lkIDAgOiBhdXRoRG9tYWluLmluY2x1ZGVzKCc6JykpLCBcImFyZ3VtZW50LWVycm9yXCIgLyogQVJHVU1FTlRfRVJST1IgKi8sIHtcclxuICAgICAgICAgICAgICAgIGFwcE5hbWU6IGFwcC5uYW1lXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBjb25maWcgPSB7XHJcbiAgICAgICAgICAgICAgICBhcGlLZXksXHJcbiAgICAgICAgICAgICAgICBhdXRoRG9tYWluLFxyXG4gICAgICAgICAgICAgICAgY2xpZW50UGxhdGZvcm0sXHJcbiAgICAgICAgICAgICAgICBhcGlIb3N0OiBcImlkZW50aXR5dG9vbGtpdC5nb29nbGVhcGlzLmNvbVwiIC8qIEFQSV9IT1NUICovLFxyXG4gICAgICAgICAgICAgICAgdG9rZW5BcGlIb3N0OiBcInNlY3VyZXRva2VuLmdvb2dsZWFwaXMuY29tXCIgLyogVE9LRU5fQVBJX0hPU1QgKi8sXHJcbiAgICAgICAgICAgICAgICBhcGlTY2hlbWU6IFwiaHR0cHNcIiAvKiBBUElfU0NIRU1FICovLFxyXG4gICAgICAgICAgICAgICAgc2RrQ2xpZW50VmVyc2lvbjogX2dldENsaWVudFZlcnNpb24oY2xpZW50UGxhdGZvcm0pXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGNvbnN0IGF1dGhJbnN0YW5jZSA9IG5ldyBBdXRoSW1wbChhcHAsIGNvbmZpZyk7XHJcbiAgICAgICAgICAgIF9pbml0aWFsaXplQXV0aEluc3RhbmNlKGF1dGhJbnN0YW5jZSwgZGVwcyk7XHJcbiAgICAgICAgICAgIHJldHVybiBhdXRoSW5zdGFuY2U7XHJcbiAgICAgICAgfSkoYXBwKTtcclxuICAgIH0sIFwiUFVCTElDXCIgLyogUFVCTElDICovKVxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEF1dGggY2FuIG9ubHkgYmUgaW5pdGlhbGl6ZWQgYnkgZXhwbGljaXRseSBjYWxsaW5nIGdldEF1dGgoKSBvciBpbml0aWFsaXplQXV0aCgpXHJcbiAgICAgICAgICogRm9yIHdoeSB3ZSBkbyB0aGlzLCBTZWUgZ28vZmlyZWJhc2UtbmV4dC1hdXRoLWluaXRcclxuICAgICAgICAgKi9cclxuICAgICAgICAuc2V0SW5zdGFudGlhdGlvbk1vZGUoXCJFWFBMSUNJVFwiIC8qIEVYUExJQ0lUICovKVxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEJlY2F1c2UgYWxsIGZpcmViYXNlIHByb2R1Y3RzIHRoYXQgZGVwZW5kIG9uIGF1dGggZGVwZW5kIG9uIGF1dGgtaW50ZXJuYWwgZGlyZWN0bHksXHJcbiAgICAgICAgICogd2UgbmVlZCB0byBpbml0aWFsaXplIGF1dGgtaW50ZXJuYWwgYWZ0ZXIgYXV0aCBpcyBpbml0aWFsaXplZCB0byBtYWtlIGl0IGF2YWlsYWJsZSB0byBvdGhlciBmaXJlYmFzZSBwcm9kdWN0cy5cclxuICAgICAgICAgKi9cclxuICAgICAgICAuc2V0SW5zdGFuY2VDcmVhdGVkQ2FsbGJhY2soKGNvbnRhaW5lciwgX2luc3RhbmNlSWRlbnRpZmllciwgX2luc3RhbmNlKSA9PiB7XHJcbiAgICAgICAgY29uc3QgYXV0aEludGVybmFsUHJvdmlkZXIgPSBjb250YWluZXIuZ2V0UHJvdmlkZXIoXCJhdXRoLWludGVybmFsXCIgLyogQVVUSF9JTlRFUk5BTCAqLyk7XHJcbiAgICAgICAgYXV0aEludGVybmFsUHJvdmlkZXIuaW5pdGlhbGl6ZSgpO1xyXG4gICAgfSkpO1xyXG4gICAgX3JlZ2lzdGVyQ29tcG9uZW50KG5ldyBDb21wb25lbnQoXCJhdXRoLWludGVybmFsXCIgLyogQVVUSF9JTlRFUk5BTCAqLywgY29udGFpbmVyID0+IHtcclxuICAgICAgICBjb25zdCBhdXRoID0gX2Nhc3RBdXRoKGNvbnRhaW5lci5nZXRQcm92aWRlcihcImF1dGhcIiAvKiBBVVRIICovKS5nZXRJbW1lZGlhdGUoKSk7XHJcbiAgICAgICAgcmV0dXJuIChhdXRoID0+IG5ldyBBdXRoSW50ZXJvcChhdXRoKSkoYXV0aCk7XHJcbiAgICB9LCBcIlBSSVZBVEVcIiAvKiBQUklWQVRFICovKS5zZXRJbnN0YW50aWF0aW9uTW9kZShcIkVYUExJQ0lUXCIgLyogRVhQTElDSVQgKi8pKTtcclxuICAgIHJlZ2lzdGVyVmVyc2lvbihuYW1lLCB2ZXJzaW9uLCBnZXRWZXJzaW9uRm9yUGxhdGZvcm0oY2xpZW50UGxhdGZvcm0pKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjEgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogUmV0dXJucyB0aGUgQXV0aCBpbnN0YW5jZSBhc3NvY2lhdGVkIHdpdGggdGhlIHByb3ZpZGVkIHtAbGluayBAZmlyZWJhc2UvYXBwI0ZpcmViYXNlQXBwfS5cclxuICogSWYgbm8gaW5zdGFuY2UgZXhpc3RzLCBpbml0aWFsaXplcyBhbiBBdXRoIGluc3RhbmNlIHdpdGggcGxhdGZvcm0tc3BlY2lmaWMgZGVmYXVsdCBkZXBlbmRlbmNpZXMuXHJcbiAqXHJcbiAqIEBwYXJhbSBhcHAgLSBUaGUgRmlyZWJhc2UgQXBwLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5mdW5jdGlvbiBnZXRBdXRoKGFwcCA9IGdldEFwcCgpKSB7XHJcbiAgICBjb25zdCBwcm92aWRlciA9IF9nZXRQcm92aWRlcihhcHAsICdhdXRoJyk7XHJcbiAgICBpZiAocHJvdmlkZXIuaXNJbml0aWFsaXplZCgpKSB7XHJcbiAgICAgICAgcmV0dXJuIHByb3ZpZGVyLmdldEltbWVkaWF0ZSgpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGluaXRpYWxpemVBdXRoKGFwcCwge1xyXG4gICAgICAgIHBvcHVwUmVkaXJlY3RSZXNvbHZlcjogYnJvd3NlclBvcHVwUmVkaXJlY3RSZXNvbHZlcixcclxuICAgICAgICBwZXJzaXN0ZW5jZTogW1xyXG4gICAgICAgICAgICBpbmRleGVkREJMb2NhbFBlcnNpc3RlbmNlLFxyXG4gICAgICAgICAgICBicm93c2VyTG9jYWxQZXJzaXN0ZW5jZSxcclxuICAgICAgICAgICAgYnJvd3NlclNlc3Npb25QZXJzaXN0ZW5jZVxyXG4gICAgICAgIF1cclxuICAgIH0pO1xyXG59XHJcbnJlZ2lzdGVyQXV0aChcIkJyb3dzZXJcIiAvKiBCUk9XU0VSICovKTtcblxuZXhwb3J0IHsgc2VuZFBhc3N3b3JkUmVzZXRFbWFpbCBhcyAkLCBBY3Rpb25Db2RlT3BlcmF0aW9uIGFzIEEsIHByb2RFcnJvck1hcCBhcyBCLCBBVVRIX0VSUk9SX0NPREVTX01BUF9ET19OT1RfVVNFX0lOVEVSTkFMTFkgYXMgQywgaW5pdGlhbGl6ZUF1dGggYXMgRCwgY29ubmVjdEF1dGhFbXVsYXRvciBhcyBFLCBGYWN0b3JJZCBhcyBGLCBBdXRoQ3JlZGVudGlhbCBhcyBHLCBFbWFpbEF1dGhDcmVkZW50aWFsIGFzIEgsIE9BdXRoQ3JlZGVudGlhbCBhcyBJLCBQaG9uZUF1dGhDcmVkZW50aWFsIGFzIEosIGluTWVtb3J5UGVyc2lzdGVuY2UgYXMgSywgRW1haWxBdXRoUHJvdmlkZXIgYXMgTCwgRmFjZWJvb2tBdXRoUHJvdmlkZXIgYXMgTSwgR29vZ2xlQXV0aFByb3ZpZGVyIGFzIE4sIE9wZXJhdGlvblR5cGUgYXMgTywgUGhvbmVBdXRoUHJvdmlkZXIgYXMgUCwgR2l0aHViQXV0aFByb3ZpZGVyIGFzIFEsIFJlY2FwdGNoYVZlcmlmaWVyIGFzIFIsIFNpZ25Jbk1ldGhvZCBhcyBTLCBPQXV0aFByb3ZpZGVyIGFzIFQsIFNBTUxBdXRoUHJvdmlkZXIgYXMgVSwgVHdpdHRlckF1dGhQcm92aWRlciBhcyBWLCBzaWduSW5Bbm9ueW1vdXNseSBhcyBXLCBzaWduSW5XaXRoQ3JlZGVudGlhbCBhcyBYLCBsaW5rV2l0aENyZWRlbnRpYWwgYXMgWSwgcmVhdXRoZW50aWNhdGVXaXRoQ3JlZGVudGlhbCBhcyBaLCBzaWduSW5XaXRoQ3VzdG9tVG9rZW4gYXMgXywgYnJvd3NlclNlc3Npb25QZXJzaXN0ZW5jZSBhcyBhLCBjb25maXJtUGFzc3dvcmRSZXNldCBhcyBhMCwgYXBwbHlBY3Rpb25Db2RlIGFzIGExLCBjaGVja0FjdGlvbkNvZGUgYXMgYTIsIHZlcmlmeVBhc3N3b3JkUmVzZXRDb2RlIGFzIGEzLCBjcmVhdGVVc2VyV2l0aEVtYWlsQW5kUGFzc3dvcmQgYXMgYTQsIHNpZ25JbldpdGhFbWFpbEFuZFBhc3N3b3JkIGFzIGE1LCBzZW5kU2lnbkluTGlua1RvRW1haWwgYXMgYTYsIGlzU2lnbkluV2l0aEVtYWlsTGluayBhcyBhNywgc2lnbkluV2l0aEVtYWlsTGluayBhcyBhOCwgZmV0Y2hTaWduSW5NZXRob2RzRm9yRW1haWwgYXMgYTksIF9nZXRSZWRpcmVjdFJlc3VsdCBhcyBhQSwgX2NsZWFyUmVkaXJlY3RPdXRjb21lcyBhcyBhQiwgX2Nhc3RBdXRoIGFzIGFDLCBVc2VySW1wbCBhcyBhRCwgQXV0aEltcGwgYXMgYUUsIF9nZXRDbGllbnRWZXJzaW9uIGFzIGFGLCBfZ2VuZXJhdGVFdmVudElkIGFzIGFHLCBBdXRoUG9wdXAgYXMgYUgsIEZldGNoUHJvdmlkZXIgYXMgYUksIFNBTUxBdXRoQ3JlZGVudGlhbCBhcyBhSiwgc2VuZEVtYWlsVmVyaWZpY2F0aW9uIGFzIGFhLCB2ZXJpZnlCZWZvcmVVcGRhdGVFbWFpbCBhcyBhYiwgQWN0aW9uQ29kZVVSTCBhcyBhYywgcGFyc2VBY3Rpb25Db2RlVVJMIGFzIGFkLCB1cGRhdGVQcm9maWxlIGFzIGFlLCB1cGRhdGVFbWFpbCBhcyBhZiwgdXBkYXRlUGFzc3dvcmQgYXMgYWcsIGdldElkVG9rZW4gYXMgYWgsIGdldElkVG9rZW5SZXN1bHQgYXMgYWksIHVubGluayBhcyBhaiwgZ2V0QWRkaXRpb25hbFVzZXJJbmZvIGFzIGFrLCByZWxvYWQgYXMgYWwsIGdldE11bHRpRmFjdG9yUmVzb2x2ZXIgYXMgYW0sIG11bHRpRmFjdG9yIGFzIGFuLCBfaXNJT1M3T3I4IGFzIGFvLCBkZWJ1Z0Fzc2VydCBhcyBhcCwgX2lzSU9TIGFzIGFxLCBfaXNBbmRyb2lkIGFzIGFyLCBfZmFpbCBhcyBhcywgX2dldFJlZGlyZWN0VXJsIGFzIGF0LCBfZ2V0UHJvamVjdENvbmZpZyBhcyBhdSwgX2NyZWF0ZUVycm9yIGFzIGF2LCBfYXNzZXJ0IGFzIGF3LCBfZ2V0SW5zdGFuY2UgYXMgYXgsIF9wZXJzaXN0ZW5jZUtleU5hbWUgYXMgYXksIEF1dGhFdmVudE1hbmFnZXIgYXMgYXosIGJyb3dzZXJMb2NhbFBlcnNpc3RlbmNlIGFzIGIsIHNpZ25JbldpdGhQb3B1cCBhcyBjLCBsaW5rV2l0aFBvcHVwIGFzIGQsIHJlYXV0aGVudGljYXRlV2l0aFBvcHVwIGFzIGUsIHNpZ25JbldpdGhSZWRpcmVjdCBhcyBmLCBsaW5rV2l0aFJlZGlyZWN0IGFzIGcsIHJlYXV0aGVudGljYXRlV2l0aFJlZGlyZWN0IGFzIGgsIGluZGV4ZWREQkxvY2FsUGVyc2lzdGVuY2UgYXMgaSwgZ2V0UmVkaXJlY3RSZXN1bHQgYXMgaiwgYnJvd3NlclBvcHVwUmVkaXJlY3RSZXNvbHZlciBhcyBrLCBsaW5rV2l0aFBob25lTnVtYmVyIGFzIGwsIFBob25lTXVsdGlGYWN0b3JHZW5lcmF0b3IgYXMgbSwgZ2V0QXV0aCBhcyBuLCBQcm92aWRlcklkIGFzIG8sIHNldFBlcnNpc3RlbmNlIGFzIHAsIG9uSWRUb2tlbkNoYW5nZWQgYXMgcSwgcmVhdXRoZW50aWNhdGVXaXRoUGhvbmVOdW1iZXIgYXMgciwgc2lnbkluV2l0aFBob25lTnVtYmVyIGFzIHMsIG9uQXV0aFN0YXRlQ2hhbmdlZCBhcyB0LCB1cGRhdGVQaG9uZU51bWJlciBhcyB1LCB1c2VEZXZpY2VMYW5ndWFnZSBhcyB2LCB1cGRhdGVDdXJyZW50VXNlciBhcyB3LCBzaWduT3V0IGFzIHgsIGRlbGV0ZVVzZXIgYXMgeSwgZGVidWdFcnJvck1hcCBhcyB6IH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC05ZmYwZmE5Yy5qcy5tYXBcbiIsImltcG9ydCB7IGdldEFwcCwgX2dldFByb3ZpZGVyLCBfcmVnaXN0ZXJDb21wb25lbnQsIHJlZ2lzdGVyVmVyc2lvbiwgU0RLX1ZFUlNJT04gfSBmcm9tICdAZmlyZWJhc2UvYXBwJztcbmltcG9ydCB7IEZpcmViYXNlRXJyb3IsIGNyZWF0ZU1vY2tVc2VyVG9rZW4sIGdldE1vZHVsYXJJbnN0YW5jZSB9IGZyb20gJ0BmaXJlYmFzZS91dGlsJztcbmltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gJ0BmaXJlYmFzZS9jb21wb25lbnQnO1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogRXJyb3IgY29kZXMgZm9yIHJlcXVlc3RzIG1hZGUgYnkgdGhlIHRoZSBYaHJJbyB3cmFwcGVyLlxyXG4gKi9cclxudmFyIEVycm9yQ29kZTtcclxuKGZ1bmN0aW9uIChFcnJvckNvZGUpIHtcclxuICAgIEVycm9yQ29kZVtFcnJvckNvZGVbXCJOT19FUlJPUlwiXSA9IDBdID0gXCJOT19FUlJPUlwiO1xyXG4gICAgRXJyb3JDb2RlW0Vycm9yQ29kZVtcIk5FVFdPUktfRVJST1JcIl0gPSAxXSA9IFwiTkVUV09SS19FUlJPUlwiO1xyXG4gICAgRXJyb3JDb2RlW0Vycm9yQ29kZVtcIkFCT1JUXCJdID0gMl0gPSBcIkFCT1JUXCI7XHJcbn0pKEVycm9yQ29kZSB8fCAoRXJyb3JDb2RlID0ge30pKTtcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEBmaWxlb3ZlcnZpZXcgQ29uc3RhbnRzIHVzZWQgaW4gdGhlIEZpcmViYXNlIFN0b3JhZ2UgbGlicmFyeS5cclxuICovXHJcbi8qKlxyXG4gKiBEb21haW4gbmFtZSBmb3IgZmlyZWJhc2Ugc3RvcmFnZS5cclxuICovXHJcbmNvbnN0IERFRkFVTFRfSE9TVCA9ICdmaXJlYmFzZXN0b3JhZ2UuZ29vZ2xlYXBpcy5jb20nO1xyXG4vKipcclxuICogVGhlIGtleSBpbiBGaXJlYmFzZSBjb25maWcganNvbiBmb3IgdGhlIHN0b3JhZ2UgYnVja2V0LlxyXG4gKi9cclxuY29uc3QgQ09ORklHX1NUT1JBR0VfQlVDS0VUX0tFWSA9ICdzdG9yYWdlQnVja2V0JztcclxuLyoqXHJcbiAqIDIgbWludXRlc1xyXG4gKlxyXG4gKiBUaGUgdGltZW91dCBmb3IgYWxsIG9wZXJhdGlvbnMgZXhjZXB0IHVwbG9hZC5cclxuICovXHJcbmNvbnN0IERFRkFVTFRfTUFYX09QRVJBVElPTl9SRVRSWV9USU1FID0gMiAqIDYwICogMTAwMDtcclxuLyoqXHJcbiAqIDEwIG1pbnV0ZXNcclxuICpcclxuICogVGhlIHRpbWVvdXQgZm9yIHVwbG9hZC5cclxuICovXHJcbmNvbnN0IERFRkFVTFRfTUFYX1VQTE9BRF9SRVRSWV9USU1FID0gMTAgKiA2MCAqIDEwMDA7XG5cbi8qKlxyXG4gKiBBbiBlcnJvciByZXR1cm5lZCBieSB0aGUgRmlyZWJhc2UgU3RvcmFnZSBTREsuXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmNsYXNzIFN0b3JhZ2VFcnJvciBleHRlbmRzIEZpcmViYXNlRXJyb3Ige1xyXG4gICAgLyoqXHJcbiAgICAgKiBAcGFyYW0gY29kZSAtIEEgU3RvcmFnZUVycm9yQ29kZSBzdHJpbmcgdG8gYmUgcHJlZml4ZWQgd2l0aCAnc3RvcmFnZS8nIGFuZFxyXG4gICAgICogIGFkZGVkIHRvIHRoZSBlbmQgb2YgdGhlIG1lc3NhZ2UuXHJcbiAgICAgKiBAcGFyYW0gbWVzc2FnZSAgLSBFcnJvciBtZXNzYWdlLlxyXG4gICAgICovXHJcbiAgICBjb25zdHJ1Y3Rvcihjb2RlLCBtZXNzYWdlKSB7XHJcbiAgICAgICAgc3VwZXIocHJlcGVuZENvZGUoY29kZSksIGBGaXJlYmFzZSBTdG9yYWdlOiAke21lc3NhZ2V9ICgke3ByZXBlbmRDb2RlKGNvZGUpfSlgKTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBTdG9yZXMgY3VzdG9tIGVycm9yIGRhdGEgdW5xdWUgdG8gU3RvcmFnZUVycm9yLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuY3VzdG9tRGF0YSA9IHsgc2VydmVyUmVzcG9uc2U6IG51bGwgfTtcclxuICAgICAgICB0aGlzLl9iYXNlTWVzc2FnZSA9IHRoaXMubWVzc2FnZTtcclxuICAgICAgICAvLyBXaXRob3V0IHRoaXMsIGBpbnN0YW5jZW9mIFN0b3JhZ2VFcnJvcmAsIGluIHRlc3RzIGZvciBleGFtcGxlLFxyXG4gICAgICAgIC8vIHJldHVybnMgZmFsc2UuXHJcbiAgICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKHRoaXMsIFN0b3JhZ2VFcnJvci5wcm90b3R5cGUpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBDb21wYXJlcyBhIFN0b3JhZ2VFcnJvckNvZGUgYWdhaW5zdCB0aGlzIGVycm9yJ3MgY29kZSwgZmlsdGVyaW5nIG91dCB0aGUgcHJlZml4LlxyXG4gICAgICovXHJcbiAgICBfY29kZUVxdWFscyhjb2RlKSB7XHJcbiAgICAgICAgcmV0dXJuIHByZXBlbmRDb2RlKGNvZGUpID09PSB0aGlzLmNvZGU7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIE9wdGlvbmFsIHJlc3BvbnNlIG1lc3NhZ2UgdGhhdCB3YXMgYWRkZWQgYnkgdGhlIHNlcnZlci5cclxuICAgICAqL1xyXG4gICAgZ2V0IHNlcnZlclJlc3BvbnNlKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmN1c3RvbURhdGEuc2VydmVyUmVzcG9uc2U7XHJcbiAgICB9XHJcbiAgICBzZXQgc2VydmVyUmVzcG9uc2Uoc2VydmVyUmVzcG9uc2UpIHtcclxuICAgICAgICB0aGlzLmN1c3RvbURhdGEuc2VydmVyUmVzcG9uc2UgPSBzZXJ2ZXJSZXNwb25zZTtcclxuICAgICAgICBpZiAodGhpcy5jdXN0b21EYXRhLnNlcnZlclJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZSA9IGAke3RoaXMuX2Jhc2VNZXNzYWdlfVxcbiR7dGhpcy5jdXN0b21EYXRhLnNlcnZlclJlc3BvbnNlfWA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2UgPSB0aGlzLl9iYXNlTWVzc2FnZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gcHJlcGVuZENvZGUoY29kZSkge1xyXG4gICAgcmV0dXJuICdzdG9yYWdlLycgKyBjb2RlO1xyXG59XHJcbmZ1bmN0aW9uIHVua25vd24oKSB7XHJcbiAgICBjb25zdCBtZXNzYWdlID0gJ0FuIHVua25vd24gZXJyb3Igb2NjdXJyZWQsIHBsZWFzZSBjaGVjayB0aGUgZXJyb3IgcGF5bG9hZCBmb3IgJyArXHJcbiAgICAgICAgJ3NlcnZlciByZXNwb25zZS4nO1xyXG4gICAgcmV0dXJuIG5ldyBTdG9yYWdlRXJyb3IoXCJ1bmtub3duXCIgLyogVU5LTk9XTiAqLywgbWVzc2FnZSk7XHJcbn1cclxuZnVuY3Rpb24gb2JqZWN0Tm90Rm91bmQocGF0aCkge1xyXG4gICAgcmV0dXJuIG5ldyBTdG9yYWdlRXJyb3IoXCJvYmplY3Qtbm90LWZvdW5kXCIgLyogT0JKRUNUX05PVF9GT1VORCAqLywgXCJPYmplY3QgJ1wiICsgcGF0aCArIFwiJyBkb2VzIG5vdCBleGlzdC5cIik7XHJcbn1cclxuZnVuY3Rpb24gcXVvdGFFeGNlZWRlZChidWNrZXQpIHtcclxuICAgIHJldHVybiBuZXcgU3RvcmFnZUVycm9yKFwicXVvdGEtZXhjZWVkZWRcIiAvKiBRVU9UQV9FWENFRURFRCAqLywgXCJRdW90YSBmb3IgYnVja2V0ICdcIiArXHJcbiAgICAgICAgYnVja2V0ICtcclxuICAgICAgICBcIicgZXhjZWVkZWQsIHBsZWFzZSB2aWV3IHF1b3RhIG9uIFwiICtcclxuICAgICAgICAnaHR0cHM6Ly9maXJlYmFzZS5nb29nbGUuY29tL3ByaWNpbmcvLicpO1xyXG59XHJcbmZ1bmN0aW9uIHVuYXV0aGVudGljYXRlZCgpIHtcclxuICAgIGNvbnN0IG1lc3NhZ2UgPSAnVXNlciBpcyBub3QgYXV0aGVudGljYXRlZCwgcGxlYXNlIGF1dGhlbnRpY2F0ZSB1c2luZyBGaXJlYmFzZSAnICtcclxuICAgICAgICAnQXV0aGVudGljYXRpb24gYW5kIHRyeSBhZ2Fpbi4nO1xyXG4gICAgcmV0dXJuIG5ldyBTdG9yYWdlRXJyb3IoXCJ1bmF1dGhlbnRpY2F0ZWRcIiAvKiBVTkFVVEhFTlRJQ0FURUQgKi8sIG1lc3NhZ2UpO1xyXG59XHJcbmZ1bmN0aW9uIHVuYXV0aG9yaXplZEFwcCgpIHtcclxuICAgIHJldHVybiBuZXcgU3RvcmFnZUVycm9yKFwidW5hdXRob3JpemVkLWFwcFwiIC8qIFVOQVVUSE9SSVpFRF9BUFAgKi8sICdUaGlzIGFwcCBkb2VzIG5vdCBoYXZlIHBlcm1pc3Npb24gdG8gYWNjZXNzIEZpcmViYXNlIFN0b3JhZ2Ugb24gdGhpcyBwcm9qZWN0LicpO1xyXG59XHJcbmZ1bmN0aW9uIHVuYXV0aG9yaXplZChwYXRoKSB7XHJcbiAgICByZXR1cm4gbmV3IFN0b3JhZ2VFcnJvcihcInVuYXV0aG9yaXplZFwiIC8qIFVOQVVUSE9SSVpFRCAqLywgXCJVc2VyIGRvZXMgbm90IGhhdmUgcGVybWlzc2lvbiB0byBhY2Nlc3MgJ1wiICsgcGF0aCArIFwiJy5cIik7XHJcbn1cclxuZnVuY3Rpb24gcmV0cnlMaW1pdEV4Y2VlZGVkKCkge1xyXG4gICAgcmV0dXJuIG5ldyBTdG9yYWdlRXJyb3IoXCJyZXRyeS1saW1pdC1leGNlZWRlZFwiIC8qIFJFVFJZX0xJTUlUX0VYQ0VFREVEICovLCAnTWF4IHJldHJ5IHRpbWUgZm9yIG9wZXJhdGlvbiBleGNlZWRlZCwgcGxlYXNlIHRyeSBhZ2Fpbi4nKTtcclxufVxyXG5mdW5jdGlvbiBjYW5jZWxlZCgpIHtcclxuICAgIHJldHVybiBuZXcgU3RvcmFnZUVycm9yKFwiY2FuY2VsZWRcIiAvKiBDQU5DRUxFRCAqLywgJ1VzZXIgY2FuY2VsZWQgdGhlIHVwbG9hZC9kb3dubG9hZC4nKTtcclxufVxyXG5mdW5jdGlvbiBpbnZhbGlkVXJsKHVybCkge1xyXG4gICAgcmV0dXJuIG5ldyBTdG9yYWdlRXJyb3IoXCJpbnZhbGlkLXVybFwiIC8qIElOVkFMSURfVVJMICovLCBcIkludmFsaWQgVVJMICdcIiArIHVybCArIFwiJy5cIik7XHJcbn1cclxuZnVuY3Rpb24gaW52YWxpZERlZmF1bHRCdWNrZXQoYnVja2V0KSB7XHJcbiAgICByZXR1cm4gbmV3IFN0b3JhZ2VFcnJvcihcImludmFsaWQtZGVmYXVsdC1idWNrZXRcIiAvKiBJTlZBTElEX0RFRkFVTFRfQlVDS0VUICovLCBcIkludmFsaWQgZGVmYXVsdCBidWNrZXQgJ1wiICsgYnVja2V0ICsgXCInLlwiKTtcclxufVxyXG5mdW5jdGlvbiBub0RlZmF1bHRCdWNrZXQoKSB7XHJcbiAgICByZXR1cm4gbmV3IFN0b3JhZ2VFcnJvcihcIm5vLWRlZmF1bHQtYnVja2V0XCIgLyogTk9fREVGQVVMVF9CVUNLRVQgKi8sICdObyBkZWZhdWx0IGJ1Y2tldCAnICtcclxuICAgICAgICBcImZvdW5kLiBEaWQgeW91IHNldCB0aGUgJ1wiICtcclxuICAgICAgICBDT05GSUdfU1RPUkFHRV9CVUNLRVRfS0VZICtcclxuICAgICAgICBcIicgcHJvcGVydHkgd2hlbiBpbml0aWFsaXppbmcgdGhlIGFwcD9cIik7XHJcbn1cclxuZnVuY3Rpb24gY2Fubm90U2xpY2VCbG9iKCkge1xyXG4gICAgcmV0dXJuIG5ldyBTdG9yYWdlRXJyb3IoXCJjYW5ub3Qtc2xpY2UtYmxvYlwiIC8qIENBTk5PVF9TTElDRV9CTE9CICovLCAnQ2Fubm90IHNsaWNlIGJsb2IgZm9yIHVwbG9hZC4gUGxlYXNlIHJldHJ5IHRoZSB1cGxvYWQuJyk7XHJcbn1cclxuZnVuY3Rpb24gc2VydmVyRmlsZVdyb25nU2l6ZSgpIHtcclxuICAgIHJldHVybiBuZXcgU3RvcmFnZUVycm9yKFwic2VydmVyLWZpbGUtd3Jvbmctc2l6ZVwiIC8qIFNFUlZFUl9GSUxFX1dST05HX1NJWkUgKi8sICdTZXJ2ZXIgcmVjb3JkZWQgaW5jb3JyZWN0IHVwbG9hZCBmaWxlIHNpemUsIHBsZWFzZSByZXRyeSB0aGUgdXBsb2FkLicpO1xyXG59XHJcbmZ1bmN0aW9uIG5vRG93bmxvYWRVUkwoKSB7XHJcbiAgICByZXR1cm4gbmV3IFN0b3JhZ2VFcnJvcihcIm5vLWRvd25sb2FkLXVybFwiIC8qIE5PX0RPV05MT0FEX1VSTCAqLywgJ1RoZSBnaXZlbiBmaWxlIGRvZXMgbm90IGhhdmUgYW55IGRvd25sb2FkIFVSTHMuJyk7XHJcbn1cclxuLyoqXHJcbiAqIEBpbnRlcm5hbFxyXG4gKi9cclxuZnVuY3Rpb24gaW52YWxpZEFyZ3VtZW50KG1lc3NhZ2UpIHtcclxuICAgIHJldHVybiBuZXcgU3RvcmFnZUVycm9yKFwiaW52YWxpZC1hcmd1bWVudFwiIC8qIElOVkFMSURfQVJHVU1FTlQgKi8sIG1lc3NhZ2UpO1xyXG59XHJcbmZ1bmN0aW9uIGFwcERlbGV0ZWQoKSB7XHJcbiAgICByZXR1cm4gbmV3IFN0b3JhZ2VFcnJvcihcImFwcC1kZWxldGVkXCIgLyogQVBQX0RFTEVURUQgKi8sICdUaGUgRmlyZWJhc2UgYXBwIHdhcyBkZWxldGVkLicpO1xyXG59XHJcbi8qKlxyXG4gKiBAcGFyYW0gbmFtZSAtIFRoZSBuYW1lIG9mIHRoZSBvcGVyYXRpb24gdGhhdCB3YXMgaW52YWxpZC5cclxuICpcclxuICogQGludGVybmFsXHJcbiAqL1xyXG5mdW5jdGlvbiBpbnZhbGlkUm9vdE9wZXJhdGlvbihuYW1lKSB7XHJcbiAgICByZXR1cm4gbmV3IFN0b3JhZ2VFcnJvcihcImludmFsaWQtcm9vdC1vcGVyYXRpb25cIiAvKiBJTlZBTElEX1JPT1RfT1BFUkFUSU9OICovLCBcIlRoZSBvcGVyYXRpb24gJ1wiICtcclxuICAgICAgICBuYW1lICtcclxuICAgICAgICBcIicgY2Fubm90IGJlIHBlcmZvcm1lZCBvbiBhIHJvb3QgcmVmZXJlbmNlLCBjcmVhdGUgYSBub24tcm9vdCBcIiArXHJcbiAgICAgICAgXCJyZWZlcmVuY2UgdXNpbmcgY2hpbGQsIHN1Y2ggYXMgLmNoaWxkKCdmaWxlLnBuZycpLlwiKTtcclxufVxyXG4vKipcclxuICogQHBhcmFtIGZvcm1hdCAtIFRoZSBmb3JtYXQgdGhhdCB3YXMgbm90IHZhbGlkLlxyXG4gKiBAcGFyYW0gbWVzc2FnZSAtIEEgbWVzc2FnZSBkZXNjcmliaW5nIHRoZSBmb3JtYXQgdmlvbGF0aW9uLlxyXG4gKi9cclxuZnVuY3Rpb24gaW52YWxpZEZvcm1hdChmb3JtYXQsIG1lc3NhZ2UpIHtcclxuICAgIHJldHVybiBuZXcgU3RvcmFnZUVycm9yKFwiaW52YWxpZC1mb3JtYXRcIiAvKiBJTlZBTElEX0ZPUk1BVCAqLywgXCJTdHJpbmcgZG9lcyBub3QgbWF0Y2ggZm9ybWF0ICdcIiArIGZvcm1hdCArIFwiJzogXCIgKyBtZXNzYWdlKTtcclxufVxyXG4vKipcclxuICogQHBhcmFtIG1lc3NhZ2UgLSBBIG1lc3NhZ2UgZGVzY3JpYmluZyB0aGUgaW50ZXJuYWwgZXJyb3IuXHJcbiAqL1xyXG5mdW5jdGlvbiBpbnRlcm5hbEVycm9yKG1lc3NhZ2UpIHtcclxuICAgIHRocm93IG5ldyBTdG9yYWdlRXJyb3IoXCJpbnRlcm5hbC1lcnJvclwiIC8qIElOVEVSTkFMX0VSUk9SICovLCAnSW50ZXJuYWwgZXJyb3I6ICcgKyBtZXNzYWdlKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogTmV0d29yayBsYXllciBmb3IgYnJvd3NlcnMuIFdlIHVzZSB0aGlzIGluc3RlYWQgb2YgZ29vZy5uZXQuWGhySW8gYmVjYXVzZVxyXG4gKiBnb29nLm5ldC5YaHJJbyBpcyBoeXV1dXVnZSBhbmQgZG9lc24ndCB3b3JrIGluIFJlYWN0IE5hdGl2ZSBvbiBBbmRyb2lkLlxyXG4gKi9cclxuY2xhc3MgWGhyQ29ubmVjdGlvbiB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLnNlbnRfID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy54aHJfID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XHJcbiAgICAgICAgdGhpcy5lcnJvckNvZGVfID0gRXJyb3JDb2RlLk5PX0VSUk9SO1xyXG4gICAgICAgIHRoaXMuc2VuZFByb21pc2VfID0gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMueGhyXy5hZGRFdmVudExpc3RlbmVyKCdhYm9ydCcsICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZXJyb3JDb2RlXyA9IEVycm9yQ29kZS5BQk9SVDtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRoaXMueGhyXy5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZXJyb3JDb2RlXyA9IEVycm9yQ29kZS5ORVRXT1JLX0VSUk9SO1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy54aHJfLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBAb3ZlcnJpZGVcclxuICAgICAqL1xyXG4gICAgc2VuZCh1cmwsIG1ldGhvZCwgYm9keSwgaGVhZGVycykge1xyXG4gICAgICAgIGlmICh0aGlzLnNlbnRfKSB7XHJcbiAgICAgICAgICAgIHRocm93IGludGVybmFsRXJyb3IoJ2Nhbm5vdCAuc2VuZCgpIG1vcmUgdGhhbiBvbmNlJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2VudF8gPSB0cnVlO1xyXG4gICAgICAgIHRoaXMueGhyXy5vcGVuKG1ldGhvZCwgdXJsLCB0cnVlKTtcclxuICAgICAgICBpZiAoaGVhZGVycyAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIGhlYWRlcnMpIHtcclxuICAgICAgICAgICAgICAgIGlmIChoZWFkZXJzLmhhc093blByb3BlcnR5KGtleSkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnhocl8uc2V0UmVxdWVzdEhlYWRlcihrZXksIGhlYWRlcnNba2V5XS50b1N0cmluZygpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoYm9keSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMueGhyXy5zZW5kKGJvZHkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy54aHJfLnNlbmQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VuZFByb21pc2VfO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBAb3ZlcnJpZGVcclxuICAgICAqL1xyXG4gICAgZ2V0RXJyb3JDb2RlKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5zZW50Xykge1xyXG4gICAgICAgICAgICB0aHJvdyBpbnRlcm5hbEVycm9yKCdjYW5ub3QgLmdldEVycm9yQ29kZSgpIGJlZm9yZSBzZW5kaW5nJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmVycm9yQ29kZV87XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEBvdmVycmlkZVxyXG4gICAgICovXHJcbiAgICBnZXRTdGF0dXMoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLnNlbnRfKSB7XHJcbiAgICAgICAgICAgIHRocm93IGludGVybmFsRXJyb3IoJ2Nhbm5vdCAuZ2V0U3RhdHVzKCkgYmVmb3JlIHNlbmRpbmcnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMueGhyXy5zdGF0dXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAtMTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEBvdmVycmlkZVxyXG4gICAgICovXHJcbiAgICBnZXRSZXNwb25zZVRleHQoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLnNlbnRfKSB7XHJcbiAgICAgICAgICAgIHRocm93IGludGVybmFsRXJyb3IoJ2Nhbm5vdCAuZ2V0UmVzcG9uc2VUZXh0KCkgYmVmb3JlIHNlbmRpbmcnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMueGhyXy5yZXNwb25zZVRleHQ7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEFib3J0cyB0aGUgcmVxdWVzdC5cclxuICAgICAqIEBvdmVycmlkZVxyXG4gICAgICovXHJcbiAgICBhYm9ydCgpIHtcclxuICAgICAgICB0aGlzLnhocl8uYWJvcnQoKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQG92ZXJyaWRlXHJcbiAgICAgKi9cclxuICAgIGdldFJlc3BvbnNlSGVhZGVyKGhlYWRlcikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnhocl8uZ2V0UmVzcG9uc2VIZWFkZXIoaGVhZGVyKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQG92ZXJyaWRlXHJcbiAgICAgKi9cclxuICAgIGFkZFVwbG9hZFByb2dyZXNzTGlzdGVuZXIobGlzdGVuZXIpIHtcclxuICAgICAgICBpZiAodGhpcy54aHJfLnVwbG9hZCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMueGhyXy51cGxvYWQuYWRkRXZlbnRMaXN0ZW5lcigncHJvZ3Jlc3MnLCBsaXN0ZW5lcik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBAb3ZlcnJpZGVcclxuICAgICAqL1xyXG4gICAgcmVtb3ZlVXBsb2FkUHJvZ3Jlc3NMaXN0ZW5lcihsaXN0ZW5lcikge1xyXG4gICAgICAgIGlmICh0aGlzLnhocl8udXBsb2FkICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy54aHJfLnVwbG9hZC5yZW1vdmVFdmVudExpc3RlbmVyKCdwcm9ncmVzcycsIGxpc3RlbmVyKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gbmV3Q29ubmVjdGlvbigpIHtcclxuICAgIHJldHVybiBuZXcgWGhyQ29ubmVjdGlvbigpO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBGYWN0b3J5LWxpa2UgY2xhc3MgZm9yIGNyZWF0aW5nIFhocklvIGluc3RhbmNlcy5cclxuICovXHJcbmNsYXNzIENvbm5lY3Rpb25Qb29sIHtcclxuICAgIGNyZWF0ZUNvbm5lY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ld0Nvbm5lY3Rpb24oKTtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogRmlyZWJhc2UgU3RvcmFnZSBsb2NhdGlvbiBkYXRhLlxyXG4gKlxyXG4gKiBAaW50ZXJuYWxcclxuICovXHJcbmNsYXNzIExvY2F0aW9uIHtcclxuICAgIGNvbnN0cnVjdG9yKGJ1Y2tldCwgcGF0aCkge1xyXG4gICAgICAgIHRoaXMuYnVja2V0ID0gYnVja2V0O1xyXG4gICAgICAgIHRoaXMucGF0aF8gPSBwYXRoO1xyXG4gICAgfVxyXG4gICAgZ2V0IHBhdGgoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGF0aF87XHJcbiAgICB9XHJcbiAgICBnZXQgaXNSb290KCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBhdGgubGVuZ3RoID09PSAwO1xyXG4gICAgfVxyXG4gICAgZnVsbFNlcnZlclVybCgpIHtcclxuICAgICAgICBjb25zdCBlbmNvZGUgPSBlbmNvZGVVUklDb21wb25lbnQ7XHJcbiAgICAgICAgcmV0dXJuICcvYi8nICsgZW5jb2RlKHRoaXMuYnVja2V0KSArICcvby8nICsgZW5jb2RlKHRoaXMucGF0aCk7XHJcbiAgICB9XHJcbiAgICBidWNrZXRPbmx5U2VydmVyVXJsKCkge1xyXG4gICAgICAgIGNvbnN0IGVuY29kZSA9IGVuY29kZVVSSUNvbXBvbmVudDtcclxuICAgICAgICByZXR1cm4gJy9iLycgKyBlbmNvZGUodGhpcy5idWNrZXQpICsgJy9vJztcclxuICAgIH1cclxuICAgIHN0YXRpYyBtYWtlRnJvbUJ1Y2tldFNwZWMoYnVja2V0U3RyaW5nLCBob3N0KSB7XHJcbiAgICAgICAgbGV0IGJ1Y2tldExvY2F0aW9uO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGJ1Y2tldExvY2F0aW9uID0gTG9jYXRpb24ubWFrZUZyb21VcmwoYnVja2V0U3RyaW5nLCBob3N0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgLy8gTm90IHZhbGlkIFVSTCwgdXNlIGFzLWlzLiBUaGlzIGxldHMgeW91IHB1dCBiYXJlIGJ1Y2tldCBuYW1lcyBpblxyXG4gICAgICAgICAgICAvLyBjb25maWcuXHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgTG9jYXRpb24oYnVja2V0U3RyaW5nLCAnJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChidWNrZXRMb2NhdGlvbi5wYXRoID09PSAnJykge1xyXG4gICAgICAgICAgICByZXR1cm4gYnVja2V0TG9jYXRpb247XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aHJvdyBpbnZhbGlkRGVmYXVsdEJ1Y2tldChidWNrZXRTdHJpbmcpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHN0YXRpYyBtYWtlRnJvbVVybCh1cmwsIGhvc3QpIHtcclxuICAgICAgICBsZXQgbG9jYXRpb24gPSBudWxsO1xyXG4gICAgICAgIGNvbnN0IGJ1Y2tldERvbWFpbiA9ICcoW0EtWmEtejAtOS5cXFxcLV9dKyknO1xyXG4gICAgICAgIGZ1bmN0aW9uIGdzTW9kaWZ5KGxvYykge1xyXG4gICAgICAgICAgICBpZiAobG9jLnBhdGguY2hhckF0KGxvYy5wYXRoLmxlbmd0aCAtIDEpID09PSAnLycpIHtcclxuICAgICAgICAgICAgICAgIGxvYy5wYXRoXyA9IGxvYy5wYXRoXy5zbGljZSgwLCAtMSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgZ3NQYXRoID0gJygvKC4qKSk/JCc7XHJcbiAgICAgICAgY29uc3QgZ3NSZWdleCA9IG5ldyBSZWdFeHAoJ15nczovLycgKyBidWNrZXREb21haW4gKyBnc1BhdGgsICdpJyk7XHJcbiAgICAgICAgY29uc3QgZ3NJbmRpY2VzID0geyBidWNrZXQ6IDEsIHBhdGg6IDMgfTtcclxuICAgICAgICBmdW5jdGlvbiBodHRwTW9kaWZ5KGxvYykge1xyXG4gICAgICAgICAgICBsb2MucGF0aF8gPSBkZWNvZGVVUklDb21wb25lbnQobG9jLnBhdGgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCB2ZXJzaW9uID0gJ3ZbQS1aYS16MC05X10rJztcclxuICAgICAgICBjb25zdCBmaXJlYmFzZVN0b3JhZ2VIb3N0ID0gaG9zdC5yZXBsYWNlKC9bLl0vZywgJ1xcXFwuJyk7XHJcbiAgICAgICAgY29uc3QgZmlyZWJhc2VTdG9yYWdlUGF0aCA9ICcoLyhbXj8jXSopLiopPyQnO1xyXG4gICAgICAgIGNvbnN0IGZpcmViYXNlU3RvcmFnZVJlZ0V4cCA9IG5ldyBSZWdFeHAoYF5odHRwcz86Ly8ke2ZpcmViYXNlU3RvcmFnZUhvc3R9LyR7dmVyc2lvbn0vYi8ke2J1Y2tldERvbWFpbn0vbyR7ZmlyZWJhc2VTdG9yYWdlUGF0aH1gLCAnaScpO1xyXG4gICAgICAgIGNvbnN0IGZpcmViYXNlU3RvcmFnZUluZGljZXMgPSB7IGJ1Y2tldDogMSwgcGF0aDogMyB9O1xyXG4gICAgICAgIGNvbnN0IGNsb3VkU3RvcmFnZUhvc3QgPSBob3N0ID09PSBERUZBVUxUX0hPU1RcclxuICAgICAgICAgICAgPyAnKD86c3RvcmFnZS5nb29nbGVhcGlzLmNvbXxzdG9yYWdlLmNsb3VkLmdvb2dsZS5jb20pJ1xyXG4gICAgICAgICAgICA6IGhvc3Q7XHJcbiAgICAgICAgY29uc3QgY2xvdWRTdG9yYWdlUGF0aCA9ICcoW14/I10qKSc7XHJcbiAgICAgICAgY29uc3QgY2xvdWRTdG9yYWdlUmVnRXhwID0gbmV3IFJlZ0V4cChgXmh0dHBzPzovLyR7Y2xvdWRTdG9yYWdlSG9zdH0vJHtidWNrZXREb21haW59LyR7Y2xvdWRTdG9yYWdlUGF0aH1gLCAnaScpO1xyXG4gICAgICAgIGNvbnN0IGNsb3VkU3RvcmFnZUluZGljZXMgPSB7IGJ1Y2tldDogMSwgcGF0aDogMiB9O1xyXG4gICAgICAgIGNvbnN0IGdyb3VwcyA9IFtcclxuICAgICAgICAgICAgeyByZWdleDogZ3NSZWdleCwgaW5kaWNlczogZ3NJbmRpY2VzLCBwb3N0TW9kaWZ5OiBnc01vZGlmeSB9LFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZWdleDogZmlyZWJhc2VTdG9yYWdlUmVnRXhwLFxyXG4gICAgICAgICAgICAgICAgaW5kaWNlczogZmlyZWJhc2VTdG9yYWdlSW5kaWNlcyxcclxuICAgICAgICAgICAgICAgIHBvc3RNb2RpZnk6IGh0dHBNb2RpZnlcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmVnZXg6IGNsb3VkU3RvcmFnZVJlZ0V4cCxcclxuICAgICAgICAgICAgICAgIGluZGljZXM6IGNsb3VkU3RvcmFnZUluZGljZXMsXHJcbiAgICAgICAgICAgICAgICBwb3N0TW9kaWZ5OiBodHRwTW9kaWZ5XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICBdO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZ3JvdXBzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGdyb3VwID0gZ3JvdXBzW2ldO1xyXG4gICAgICAgICAgICBjb25zdCBjYXB0dXJlcyA9IGdyb3VwLnJlZ2V4LmV4ZWModXJsKTtcclxuICAgICAgICAgICAgaWYgKGNhcHR1cmVzKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBidWNrZXRWYWx1ZSA9IGNhcHR1cmVzW2dyb3VwLmluZGljZXMuYnVja2V0XTtcclxuICAgICAgICAgICAgICAgIGxldCBwYXRoVmFsdWUgPSBjYXB0dXJlc1tncm91cC5pbmRpY2VzLnBhdGhdO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFwYXRoVmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBwYXRoVmFsdWUgPSAnJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGxvY2F0aW9uID0gbmV3IExvY2F0aW9uKGJ1Y2tldFZhbHVlLCBwYXRoVmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgZ3JvdXAucG9zdE1vZGlmeShsb2NhdGlvbik7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobG9jYXRpb24gPT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aHJvdyBpbnZhbGlkVXJsKHVybCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBsb2NhdGlvbjtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQSByZXF1ZXN0IHdob3NlIHByb21pc2UgYWx3YXlzIGZhaWxzLlxyXG4gKi9cclxuY2xhc3MgRmFpbFJlcXVlc3Qge1xyXG4gICAgY29uc3RydWN0b3IoZXJyb3IpIHtcclxuICAgICAgICB0aGlzLnByb21pc2VfID0gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xyXG4gICAgfVxyXG4gICAgLyoqIEBpbmhlcml0RG9jICovXHJcbiAgICBnZXRQcm9taXNlKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnByb21pc2VfO1xyXG4gICAgfVxyXG4gICAgLyoqIEBpbmhlcml0RG9jICovXHJcbiAgICBjYW5jZWwoX2FwcERlbGV0ZSA9IGZhbHNlKSB7IH1cclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogQHBhcmFtIGYgTWF5IGJlIGludm9rZWRcclxuICogICAgIGJlZm9yZSB0aGUgZnVuY3Rpb24gcmV0dXJucy5cclxuICogQHBhcmFtIGNhbGxiYWNrIEdldCBhbGwgdGhlIGFyZ3VtZW50cyBwYXNzZWQgdG8gdGhlIGZ1bmN0aW9uXHJcbiAqICAgICBwYXNzZWQgdG8gZiwgaW5jbHVkaW5nIHRoZSBpbml0aWFsIGJvb2xlYW4uXHJcbiAqL1xyXG5mdW5jdGlvbiBzdGFydChmLCBcclxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcclxuY2FsbGJhY2ssIHRpbWVvdXQpIHtcclxuICAgIC8vIFRPRE8oYW5keXNvdG8pOiBtYWtlIHRoaXMgY29kZSBjbGVhbmVyIChwcm9iYWJseSByZWZhY3RvciBpbnRvIGFuIGFjdHVhbFxyXG4gICAgLy8gdHlwZSBpbnN0ZWFkIG9mIGEgYnVuY2ggb2YgZnVuY3Rpb25zIHdpdGggc3RhdGUgc2hhcmVkIGluIHRoZSBjbG9zdXJlKVxyXG4gICAgbGV0IHdhaXRTZWNvbmRzID0gMTtcclxuICAgIC8vIFdvdWxkIHR5cGUgdGhpcyBhcyBcIm51bWJlclwiIGJ1dCB0aGF0IGRvZXNuJ3Qgd29yayBmb3IgTm9kZSBzbyDCr1xcXyjjg4QpXy/Cr1xyXG4gICAgLy8gVE9ETzogZmluZCBhIHdheSB0byBleGNsdWRlIE5vZGUgdHlwZSBkZWZpbml0aW9uIGZvciBzdG9yYWdlIGJlY2F1c2Ugc3RvcmFnZSBvbmx5IHdvcmtzIGluIGJyb3dzZXJcclxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XHJcbiAgICBsZXQgdGltZW91dElkID0gbnVsbDtcclxuICAgIGxldCBoaXRUaW1lb3V0ID0gZmFsc2U7XHJcbiAgICBsZXQgY2FuY2VsU3RhdGUgPSAwO1xyXG4gICAgZnVuY3Rpb24gY2FuY2VsZWQoKSB7XHJcbiAgICAgICAgcmV0dXJuIGNhbmNlbFN0YXRlID09PSAyO1xyXG4gICAgfVxyXG4gICAgbGV0IHRyaWdnZXJlZENhbGxiYWNrID0gZmFsc2U7XHJcbiAgICBmdW5jdGlvbiB0cmlnZ2VyQ2FsbGJhY2soLi4uYXJncykge1xyXG4gICAgICAgIGlmICghdHJpZ2dlcmVkQ2FsbGJhY2spIHtcclxuICAgICAgICAgICAgdHJpZ2dlcmVkQ2FsbGJhY2sgPSB0cnVlO1xyXG4gICAgICAgICAgICBjYWxsYmFjay5hcHBseShudWxsLCBhcmdzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBjYWxsV2l0aERlbGF5KG1pbGxpcykge1xyXG4gICAgICAgIHRpbWVvdXRJZCA9IHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aW1lb3V0SWQgPSBudWxsO1xyXG4gICAgICAgICAgICBmKGhhbmRsZXIsIGNhbmNlbGVkKCkpO1xyXG4gICAgICAgIH0sIG1pbGxpcyk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBoYW5kbGVyKHN1Y2Nlc3MsIC4uLmFyZ3MpIHtcclxuICAgICAgICBpZiAodHJpZ2dlcmVkQ2FsbGJhY2spIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoc3VjY2Vzcykge1xyXG4gICAgICAgICAgICB0cmlnZ2VyQ2FsbGJhY2suY2FsbChudWxsLCBzdWNjZXNzLCAuLi5hcmdzKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBtdXN0U3RvcCA9IGNhbmNlbGVkKCkgfHwgaGl0VGltZW91dDtcclxuICAgICAgICBpZiAobXVzdFN0b3ApIHtcclxuICAgICAgICAgICAgdHJpZ2dlckNhbGxiYWNrLmNhbGwobnVsbCwgc3VjY2VzcywgLi4uYXJncyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHdhaXRTZWNvbmRzIDwgNjQpIHtcclxuICAgICAgICAgICAgLyogVE9ETyhhbmR5c290byk6IGRvbid0IGJhY2sgb2ZmIHNvIHF1aWNrbHkgaWYgd2Uga25vdyB3ZSdyZSBvZmZsaW5lLiAqL1xyXG4gICAgICAgICAgICB3YWl0U2Vjb25kcyAqPSAyO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgd2FpdE1pbGxpcztcclxuICAgICAgICBpZiAoY2FuY2VsU3RhdGUgPT09IDEpIHtcclxuICAgICAgICAgICAgY2FuY2VsU3RhdGUgPSAyO1xyXG4gICAgICAgICAgICB3YWl0TWlsbGlzID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHdhaXRNaWxsaXMgPSAod2FpdFNlY29uZHMgKyBNYXRoLnJhbmRvbSgpKSAqIDEwMDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhbGxXaXRoRGVsYXkod2FpdE1pbGxpcyk7XHJcbiAgICB9XHJcbiAgICBsZXQgc3RvcHBlZCA9IGZhbHNlO1xyXG4gICAgZnVuY3Rpb24gc3RvcCh3YXNUaW1lb3V0KSB7XHJcbiAgICAgICAgaWYgKHN0b3BwZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzdG9wcGVkID0gdHJ1ZTtcclxuICAgICAgICBpZiAodHJpZ2dlcmVkQ2FsbGJhY2spIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGltZW91dElkICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGlmICghd2FzVGltZW91dCkge1xyXG4gICAgICAgICAgICAgICAgY2FuY2VsU3RhdGUgPSAyO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xyXG4gICAgICAgICAgICBjYWxsV2l0aERlbGF5KDApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKCF3YXNUaW1lb3V0KSB7XHJcbiAgICAgICAgICAgICAgICBjYW5jZWxTdGF0ZSA9IDE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBjYWxsV2l0aERlbGF5KDApO1xyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgaGl0VGltZW91dCA9IHRydWU7XHJcbiAgICAgICAgc3RvcCh0cnVlKTtcclxuICAgIH0sIHRpbWVvdXQpO1xyXG4gICAgcmV0dXJuIHN0b3A7XHJcbn1cclxuLyoqXHJcbiAqIFN0b3BzIHRoZSByZXRyeSBsb29wIGZyb20gcmVwZWF0aW5nLlxyXG4gKiBJZiB0aGUgZnVuY3Rpb24gaXMgY3VycmVudGx5IFwiaW4gYmV0d2VlblwiIHJldHJpZXMsIGl0IGlzIGludm9rZWQgaW1tZWRpYXRlbHlcclxuICogd2l0aCB0aGUgc2Vjb25kIHBhcmFtZXRlciBhcyBcInRydWVcIi4gT3RoZXJ3aXNlLCBpdCB3aWxsIGJlIGludm9rZWQgb25jZSBtb3JlXHJcbiAqIGFmdGVyIHRoZSBjdXJyZW50IGludm9jYXRpb24gZmluaXNoZXMgaWZmIHRoZSBjdXJyZW50IGludm9jYXRpb24gd291bGQgaGF2ZVxyXG4gKiB0cmlnZ2VyZWQgYW5vdGhlciByZXRyeS5cclxuICovXHJcbmZ1bmN0aW9uIHN0b3AoaWQpIHtcclxuICAgIGlkKGZhbHNlKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5mdW5jdGlvbiBpc0p1c3REZWYocCkge1xyXG4gICAgcmV0dXJuIHAgIT09IHZvaWQgMDtcclxufVxyXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L2Jhbi10eXBlc1xyXG5mdW5jdGlvbiBpc0Z1bmN0aW9uKHApIHtcclxuICAgIHJldHVybiB0eXBlb2YgcCA9PT0gJ2Z1bmN0aW9uJztcclxufVxyXG5mdW5jdGlvbiBpc05vbkFycmF5T2JqZWN0KHApIHtcclxuICAgIHJldHVybiB0eXBlb2YgcCA9PT0gJ29iamVjdCcgJiYgIUFycmF5LmlzQXJyYXkocCk7XHJcbn1cclxuZnVuY3Rpb24gaXNTdHJpbmcocCkge1xyXG4gICAgcmV0dXJuIHR5cGVvZiBwID09PSAnc3RyaW5nJyB8fCBwIGluc3RhbmNlb2YgU3RyaW5nO1xyXG59XHJcbmZ1bmN0aW9uIGlzTmF0aXZlQmxvYihwKSB7XHJcbiAgICByZXR1cm4gaXNOYXRpdmVCbG9iRGVmaW5lZCgpICYmIHAgaW5zdGFuY2VvZiBCbG9iO1xyXG59XHJcbmZ1bmN0aW9uIGlzTmF0aXZlQmxvYkRlZmluZWQoKSB7XHJcbiAgICByZXR1cm4gdHlwZW9mIEJsb2IgIT09ICd1bmRlZmluZWQnO1xyXG59XHJcbmZ1bmN0aW9uIHZhbGlkYXRlTnVtYmVyKGFyZ3VtZW50LCBtaW5WYWx1ZSwgbWF4VmFsdWUsIHZhbHVlKSB7XHJcbiAgICBpZiAodmFsdWUgPCBtaW5WYWx1ZSkge1xyXG4gICAgICAgIHRocm93IGludmFsaWRBcmd1bWVudChgSW52YWxpZCB2YWx1ZSBmb3IgJyR7YXJndW1lbnR9Jy4gRXhwZWN0ZWQgJHttaW5WYWx1ZX0gb3IgZ3JlYXRlci5gKTtcclxuICAgIH1cclxuICAgIGlmICh2YWx1ZSA+IG1heFZhbHVlKSB7XHJcbiAgICAgICAgdGhyb3cgaW52YWxpZEFyZ3VtZW50KGBJbnZhbGlkIHZhbHVlIGZvciAnJHthcmd1bWVudH0nLiBFeHBlY3RlZCAke21heFZhbHVlfSBvciBsZXNzLmApO1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmZ1bmN0aW9uIG1ha2VVcmwodXJsUGFydCwgaG9zdCkge1xyXG4gICAgY29uc3QgcHJvdG9jb2xNYXRjaCA9IGhvc3QubWF0Y2goL14oXFx3Kyk6XFwvXFwvLisvKTtcclxuICAgIGNvbnN0IHByb3RvY29sID0gcHJvdG9jb2xNYXRjaCA9PT0gbnVsbCB8fCBwcm90b2NvbE1hdGNoID09PSB2b2lkIDAgPyB2b2lkIDAgOiBwcm90b2NvbE1hdGNoWzFdO1xyXG4gICAgbGV0IG9yaWdpbiA9IGhvc3Q7XHJcbiAgICBpZiAocHJvdG9jb2wgPT0gbnVsbCkge1xyXG4gICAgICAgIG9yaWdpbiA9IGBodHRwczovLyR7aG9zdH1gO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGAke29yaWdpbn0vdjAke3VybFBhcnR9YDtcclxufVxyXG5mdW5jdGlvbiBtYWtlUXVlcnlTdHJpbmcocGFyYW1zKSB7XHJcbiAgICBjb25zdCBlbmNvZGUgPSBlbmNvZGVVUklDb21wb25lbnQ7XHJcbiAgICBsZXQgcXVlcnlQYXJ0ID0gJz8nO1xyXG4gICAgZm9yIChjb25zdCBrZXkgaW4gcGFyYW1zKSB7XHJcbiAgICAgICAgaWYgKHBhcmFtcy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5leHRQYXJ0ID0gZW5jb2RlKGtleSkgKyAnPScgKyBlbmNvZGUocGFyYW1zW2tleV0pO1xyXG4gICAgICAgICAgICBxdWVyeVBhcnQgPSBxdWVyeVBhcnQgKyBuZXh0UGFydCArICcmJztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyBDaG9wIG9mZiB0aGUgZXh0cmEgJyYnIG9yICc/JyBvbiB0aGUgZW5kXHJcbiAgICBxdWVyeVBhcnQgPSBxdWVyeVBhcnQuc2xpY2UoMCwgLTEpO1xyXG4gICAgcmV0dXJuIHF1ZXJ5UGFydDtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jbGFzcyBOZXR3b3JrUmVxdWVzdCB7XHJcbiAgICBjb25zdHJ1Y3Rvcih1cmwsIG1ldGhvZCwgaGVhZGVycywgYm9keSwgc3VjY2Vzc0NvZGVzLCBhZGRpdGlvbmFsUmV0cnlDb2RlcywgY2FsbGJhY2ssIGVycm9yQ2FsbGJhY2ssIHRpbWVvdXQsIHByb2dyZXNzQ2FsbGJhY2ssIHBvb2wpIHtcclxuICAgICAgICB0aGlzLnBlbmRpbmdDb25uZWN0aW9uXyA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5iYWNrb2ZmSWRfID0gbnVsbDtcclxuICAgICAgICB0aGlzLmNhbmNlbGVkXyA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuYXBwRGVsZXRlXyA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMudXJsXyA9IHVybDtcclxuICAgICAgICB0aGlzLm1ldGhvZF8gPSBtZXRob2Q7XHJcbiAgICAgICAgdGhpcy5oZWFkZXJzXyA9IGhlYWRlcnM7XHJcbiAgICAgICAgdGhpcy5ib2R5XyA9IGJvZHk7XHJcbiAgICAgICAgdGhpcy5zdWNjZXNzQ29kZXNfID0gc3VjY2Vzc0NvZGVzLnNsaWNlKCk7XHJcbiAgICAgICAgdGhpcy5hZGRpdGlvbmFsUmV0cnlDb2Rlc18gPSBhZGRpdGlvbmFsUmV0cnlDb2Rlcy5zbGljZSgpO1xyXG4gICAgICAgIHRoaXMuY2FsbGJhY2tfID0gY2FsbGJhY2s7XHJcbiAgICAgICAgdGhpcy5lcnJvckNhbGxiYWNrXyA9IGVycm9yQ2FsbGJhY2s7XHJcbiAgICAgICAgdGhpcy5wcm9ncmVzc0NhbGxiYWNrXyA9IHByb2dyZXNzQ2FsbGJhY2s7XHJcbiAgICAgICAgdGhpcy50aW1lb3V0XyA9IHRpbWVvdXQ7XHJcbiAgICAgICAgdGhpcy5wb29sXyA9IHBvb2w7XHJcbiAgICAgICAgdGhpcy5wcm9taXNlXyA9IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5yZXNvbHZlXyA9IHJlc29sdmU7XHJcbiAgICAgICAgICAgIHRoaXMucmVqZWN0XyA9IHJlamVjdDtcclxuICAgICAgICAgICAgdGhpcy5zdGFydF8oKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQWN0dWFsbHkgc3RhcnRzIHRoZSByZXRyeSBsb29wLlxyXG4gICAgICovXHJcbiAgICBzdGFydF8oKSB7XHJcbiAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgZnVuY3Rpb24gZG9UaGVSZXF1ZXN0KGJhY2tvZmZDYWxsYmFjaywgY2FuY2VsZWQpIHtcclxuICAgICAgICAgICAgaWYgKGNhbmNlbGVkKSB7XHJcbiAgICAgICAgICAgICAgICBiYWNrb2ZmQ2FsbGJhY2soZmFsc2UsIG5ldyBSZXF1ZXN0RW5kU3RhdHVzKGZhbHNlLCBudWxsLCB0cnVlKSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgY29ubmVjdGlvbiA9IHNlbGYucG9vbF8uY3JlYXRlQ29ubmVjdGlvbigpO1xyXG4gICAgICAgICAgICBzZWxmLnBlbmRpbmdDb25uZWN0aW9uXyA9IGNvbm5lY3Rpb247XHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIHByb2dyZXNzTGlzdGVuZXIocHJvZ3Jlc3NFdmVudCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbG9hZGVkID0gcHJvZ3Jlc3NFdmVudC5sb2FkZWQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0b3RhbCA9IHByb2dyZXNzRXZlbnQubGVuZ3RoQ29tcHV0YWJsZSA/IHByb2dyZXNzRXZlbnQudG90YWwgOiAtMTtcclxuICAgICAgICAgICAgICAgIGlmIChzZWxmLnByb2dyZXNzQ2FsbGJhY2tfICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5wcm9ncmVzc0NhbGxiYWNrXyhsb2FkZWQsIHRvdGFsKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoc2VsZi5wcm9ncmVzc0NhbGxiYWNrXyAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgY29ubmVjdGlvbi5hZGRVcGxvYWRQcm9ncmVzc0xpc3RlbmVyKHByb2dyZXNzTGlzdGVuZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZmxvYXRpbmctcHJvbWlzZXNcclxuICAgICAgICAgICAgY29ubmVjdGlvblxyXG4gICAgICAgICAgICAgICAgLnNlbmQoc2VsZi51cmxfLCBzZWxmLm1ldGhvZF8sIHNlbGYuYm9keV8sIHNlbGYuaGVhZGVyc18pXHJcbiAgICAgICAgICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5wcm9ncmVzc0NhbGxiYWNrXyAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbm5lY3Rpb24ucmVtb3ZlVXBsb2FkUHJvZ3Jlc3NMaXN0ZW5lcihwcm9ncmVzc0xpc3RlbmVyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHNlbGYucGVuZGluZ0Nvbm5lY3Rpb25fID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGhpdFNlcnZlciA9IGNvbm5lY3Rpb24uZ2V0RXJyb3JDb2RlKCkgPT09IEVycm9yQ29kZS5OT19FUlJPUjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHN0YXR1cyA9IGNvbm5lY3Rpb24uZ2V0U3RhdHVzKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWhpdFNlcnZlciB8fCBzZWxmLmlzUmV0cnlTdGF0dXNDb2RlXyhzdGF0dXMpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgd2FzQ2FuY2VsZWQgPSBjb25uZWN0aW9uLmdldEVycm9yQ29kZSgpID09PSBFcnJvckNvZGUuQUJPUlQ7XHJcbiAgICAgICAgICAgICAgICAgICAgYmFja29mZkNhbGxiYWNrKGZhbHNlLCBuZXcgUmVxdWVzdEVuZFN0YXR1cyhmYWxzZSwgbnVsbCwgd2FzQ2FuY2VsZWQpKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzdWNjZXNzQ29kZSA9IHNlbGYuc3VjY2Vzc0NvZGVzXy5pbmRleE9mKHN0YXR1cykgIT09IC0xO1xyXG4gICAgICAgICAgICAgICAgYmFja29mZkNhbGxiYWNrKHRydWUsIG5ldyBSZXF1ZXN0RW5kU3RhdHVzKHN1Y2Nlc3NDb2RlLCBjb25uZWN0aW9uKSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAcGFyYW0gcmVxdWVzdFdlbnRUaHJvdWdoIC0gVHJ1ZSBpZiB0aGUgcmVxdWVzdCBldmVudHVhbGx5IHdlbnRcclxuICAgICAgICAgKiAgICAgdGhyb3VnaCwgZmFsc2UgaWYgaXQgaGl0IHRoZSByZXRyeSBsaW1pdCBvciB3YXMgY2FuY2VsZWQuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZnVuY3Rpb24gYmFja29mZkRvbmUocmVxdWVzdFdlbnRUaHJvdWdoLCBzdGF0dXMpIHtcclxuICAgICAgICAgICAgY29uc3QgcmVzb2x2ZSA9IHNlbGYucmVzb2x2ZV87XHJcbiAgICAgICAgICAgIGNvbnN0IHJlamVjdCA9IHNlbGYucmVqZWN0XztcclxuICAgICAgICAgICAgY29uc3QgY29ubmVjdGlvbiA9IHN0YXR1cy5jb25uZWN0aW9uO1xyXG4gICAgICAgICAgICBpZiAoc3RhdHVzLndhc1N1Y2Nlc3NDb2RlKSB7XHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHNlbGYuY2FsbGJhY2tfKGNvbm5lY3Rpb24sIGNvbm5lY3Rpb24uZ2V0UmVzcG9uc2VUZXh0KCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc0p1c3REZWYocmVzdWx0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZWplY3QoZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY29ubmVjdGlvbiAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGVyciA9IHVua25vd24oKTtcclxuICAgICAgICAgICAgICAgICAgICBlcnIuc2VydmVyUmVzcG9uc2UgPSBjb25uZWN0aW9uLmdldFJlc3BvbnNlVGV4dCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLmVycm9yQ2FsbGJhY2tfKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChzZWxmLmVycm9yQ2FsbGJhY2tfKGNvbm5lY3Rpb24sIGVycikpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXR1cy5jYW5jZWxlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlcnIgPSBzZWxmLmFwcERlbGV0ZV8gPyBhcHBEZWxldGVkKCkgOiBjYW5jZWxlZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVyciA9IHJldHJ5TGltaXRFeGNlZWRlZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuY2FuY2VsZWRfKSB7XHJcbiAgICAgICAgICAgIGJhY2tvZmZEb25lKGZhbHNlLCBuZXcgUmVxdWVzdEVuZFN0YXR1cyhmYWxzZSwgbnVsbCwgdHJ1ZSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5iYWNrb2ZmSWRfID0gc3RhcnQoZG9UaGVSZXF1ZXN0LCBiYWNrb2ZmRG9uZSwgdGhpcy50aW1lb3V0Xyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqIEBpbmhlcml0RG9jICovXHJcbiAgICBnZXRQcm9taXNlKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnByb21pc2VfO1xyXG4gICAgfVxyXG4gICAgLyoqIEBpbmhlcml0RG9jICovXHJcbiAgICBjYW5jZWwoYXBwRGVsZXRlKSB7XHJcbiAgICAgICAgdGhpcy5jYW5jZWxlZF8gPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuYXBwRGVsZXRlXyA9IGFwcERlbGV0ZSB8fCBmYWxzZTtcclxuICAgICAgICBpZiAodGhpcy5iYWNrb2ZmSWRfICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHN0b3AodGhpcy5iYWNrb2ZmSWRfKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMucGVuZGluZ0Nvbm5lY3Rpb25fICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGVuZGluZ0Nvbm5lY3Rpb25fLmFib3J0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgaXNSZXRyeVN0YXR1c0NvZGVfKHN0YXR1cykge1xyXG4gICAgICAgIC8vIFRoZSBjb2RlcyBmb3Igd2hpY2ggdG8gcmV0cnkgY2FtZSBmcm9tIHRoaXMgcGFnZTpcclxuICAgICAgICAvLyBodHRwczovL2Nsb3VkLmdvb2dsZS5jb20vc3RvcmFnZS9kb2NzL2V4cG9uZW50aWFsLWJhY2tvZmZcclxuICAgICAgICBjb25zdCBpc0ZpdmVIdW5kcmVkQ29kZSA9IHN0YXR1cyA+PSA1MDAgJiYgc3RhdHVzIDwgNjAwO1xyXG4gICAgICAgIGNvbnN0IGV4dHJhUmV0cnlDb2RlcyA9IFtcclxuICAgICAgICAgICAgLy8gUmVxdWVzdCBUaW1lb3V0OiB3ZWIgc2VydmVyIGRpZG4ndCByZWNlaXZlIGZ1bGwgcmVxdWVzdCBpbiB0aW1lLlxyXG4gICAgICAgICAgICA0MDgsXHJcbiAgICAgICAgICAgIC8vIFRvbyBNYW55IFJlcXVlc3RzOiB5b3UncmUgZ2V0dGluZyByYXRlLWxpbWl0ZWQsIGJhc2ljYWxseS5cclxuICAgICAgICAgICAgNDI5XHJcbiAgICAgICAgXTtcclxuICAgICAgICBjb25zdCBpc0V4dHJhUmV0cnlDb2RlID0gZXh0cmFSZXRyeUNvZGVzLmluZGV4T2Yoc3RhdHVzKSAhPT0gLTE7XHJcbiAgICAgICAgY29uc3QgaXNSZXF1ZXN0U3BlY2lmaWNSZXRyeUNvZGUgPSB0aGlzLmFkZGl0aW9uYWxSZXRyeUNvZGVzXy5pbmRleE9mKHN0YXR1cykgIT09IC0xO1xyXG4gICAgICAgIHJldHVybiBpc0ZpdmVIdW5kcmVkQ29kZSB8fCBpc0V4dHJhUmV0cnlDb2RlIHx8IGlzUmVxdWVzdFNwZWNpZmljUmV0cnlDb2RlO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBBIGNvbGxlY3Rpb24gb2YgaW5mb3JtYXRpb24gYWJvdXQgdGhlIHJlc3VsdCBvZiBhIG5ldHdvcmsgcmVxdWVzdC5cclxuICogQHBhcmFtIG9wdF9jYW5jZWxlZCAtIERlZmF1bHRzIHRvIGZhbHNlLlxyXG4gKi9cclxuY2xhc3MgUmVxdWVzdEVuZFN0YXR1cyB7XHJcbiAgICBjb25zdHJ1Y3Rvcih3YXNTdWNjZXNzQ29kZSwgY29ubmVjdGlvbiwgY2FuY2VsZWQpIHtcclxuICAgICAgICB0aGlzLndhc1N1Y2Nlc3NDb2RlID0gd2FzU3VjY2Vzc0NvZGU7XHJcbiAgICAgICAgdGhpcy5jb25uZWN0aW9uID0gY29ubmVjdGlvbjtcclxuICAgICAgICB0aGlzLmNhbmNlbGVkID0gISFjYW5jZWxlZDtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBhZGRBdXRoSGVhZGVyXyhoZWFkZXJzLCBhdXRoVG9rZW4pIHtcclxuICAgIGlmIChhdXRoVG9rZW4gIT09IG51bGwgJiYgYXV0aFRva2VuLmxlbmd0aCA+IDApIHtcclxuICAgICAgICBoZWFkZXJzWydBdXRob3JpemF0aW9uJ10gPSAnRmlyZWJhc2UgJyArIGF1dGhUb2tlbjtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBhZGRWZXJzaW9uSGVhZGVyXyhoZWFkZXJzLCBmaXJlYmFzZVZlcnNpb24pIHtcclxuICAgIGhlYWRlcnNbJ1gtRmlyZWJhc2UtU3RvcmFnZS1WZXJzaW9uJ10gPVxyXG4gICAgICAgICd3ZWJqcy8nICsgKGZpcmViYXNlVmVyc2lvbiAhPT0gbnVsbCAmJiBmaXJlYmFzZVZlcnNpb24gIT09IHZvaWQgMCA/IGZpcmViYXNlVmVyc2lvbiA6ICdBcHBNYW5hZ2VyJyk7XHJcbn1cclxuZnVuY3Rpb24gYWRkR21waWRIZWFkZXJfKGhlYWRlcnMsIGFwcElkKSB7XHJcbiAgICBpZiAoYXBwSWQpIHtcclxuICAgICAgICBoZWFkZXJzWydYLUZpcmViYXNlLUdNUElEJ10gPSBhcHBJZDtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBhZGRBcHBDaGVja0hlYWRlcl8oaGVhZGVycywgYXBwQ2hlY2tUb2tlbikge1xyXG4gICAgaWYgKGFwcENoZWNrVG9rZW4gIT09IG51bGwpIHtcclxuICAgICAgICBoZWFkZXJzWydYLUZpcmViYXNlLUFwcENoZWNrJ10gPSBhcHBDaGVja1Rva2VuO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIG1ha2VSZXF1ZXN0KHJlcXVlc3RJbmZvLCBhcHBJZCwgYXV0aFRva2VuLCBhcHBDaGVja1Rva2VuLCBwb29sLCBmaXJlYmFzZVZlcnNpb24pIHtcclxuICAgIGNvbnN0IHF1ZXJ5UGFydCA9IG1ha2VRdWVyeVN0cmluZyhyZXF1ZXN0SW5mby51cmxQYXJhbXMpO1xyXG4gICAgY29uc3QgdXJsID0gcmVxdWVzdEluZm8udXJsICsgcXVlcnlQYXJ0O1xyXG4gICAgY29uc3QgaGVhZGVycyA9IE9iamVjdC5hc3NpZ24oe30sIHJlcXVlc3RJbmZvLmhlYWRlcnMpO1xyXG4gICAgYWRkR21waWRIZWFkZXJfKGhlYWRlcnMsIGFwcElkKTtcclxuICAgIGFkZEF1dGhIZWFkZXJfKGhlYWRlcnMsIGF1dGhUb2tlbik7XHJcbiAgICBhZGRWZXJzaW9uSGVhZGVyXyhoZWFkZXJzLCBmaXJlYmFzZVZlcnNpb24pO1xyXG4gICAgYWRkQXBwQ2hlY2tIZWFkZXJfKGhlYWRlcnMsIGFwcENoZWNrVG9rZW4pO1xyXG4gICAgcmV0dXJuIG5ldyBOZXR3b3JrUmVxdWVzdCh1cmwsIHJlcXVlc3RJbmZvLm1ldGhvZCwgaGVhZGVycywgcmVxdWVzdEluZm8uYm9keSwgcmVxdWVzdEluZm8uc3VjY2Vzc0NvZGVzLCByZXF1ZXN0SW5mby5hZGRpdGlvbmFsUmV0cnlDb2RlcywgcmVxdWVzdEluZm8uaGFuZGxlciwgcmVxdWVzdEluZm8uZXJyb3JIYW5kbGVyLCByZXF1ZXN0SW5mby50aW1lb3V0LCByZXF1ZXN0SW5mby5wcm9ncmVzc0NhbGxiYWNrLCBwb29sKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5mdW5jdGlvbiBnZXRCbG9iQnVpbGRlcigpIHtcclxuICAgIGlmICh0eXBlb2YgQmxvYkJ1aWxkZXIgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgcmV0dXJuIEJsb2JCdWlsZGVyO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAodHlwZW9mIFdlYktpdEJsb2JCdWlsZGVyICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgIHJldHVybiBXZWJLaXRCbG9iQnVpbGRlcjtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIENvbmNhdGVuYXRlcyBvbmUgb3IgbW9yZSB2YWx1ZXMgdG9nZXRoZXIgYW5kIGNvbnZlcnRzIHRoZW0gdG8gYSBCbG9iLlxyXG4gKlxyXG4gKiBAcGFyYW0gYXJncyBUaGUgdmFsdWVzIHRoYXQgd2lsbCBtYWtlIHVwIHRoZSByZXN1bHRpbmcgYmxvYi5cclxuICogQHJldHVybiBUaGUgYmxvYi5cclxuICovXHJcbmZ1bmN0aW9uIGdldEJsb2IoLi4uYXJncykge1xyXG4gICAgY29uc3QgQmxvYkJ1aWxkZXIgPSBnZXRCbG9iQnVpbGRlcigpO1xyXG4gICAgaWYgKEJsb2JCdWlsZGVyICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICBjb25zdCBiYiA9IG5ldyBCbG9iQnVpbGRlcigpO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJncy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBiYi5hcHBlbmQoYXJnc1tpXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBiYi5nZXRCbG9iKCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBpZiAoaXNOYXRpdmVCbG9iRGVmaW5lZCgpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgQmxvYihhcmdzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBTdG9yYWdlRXJyb3IoXCJ1bnN1cHBvcnRlZC1lbnZpcm9ubWVudFwiIC8qIFVOU1VQUE9SVEVEX0VOVklST05NRU5UICovLCBcIlRoaXMgYnJvd3NlciBkb2Vzbid0IHNlZW0gdG8gc3VwcG9ydCBjcmVhdGluZyBCbG9ic1wiKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIFNsaWNlcyB0aGUgYmxvYi4gVGhlIHJldHVybmVkIGJsb2IgY29udGFpbnMgZGF0YSBmcm9tIHRoZSBzdGFydCBieXRlXHJcbiAqIChpbmNsdXNpdmUpIHRpbGwgdGhlIGVuZCBieXRlIChleGNsdXNpdmUpLiBOZWdhdGl2ZSBpbmRpY2VzIGNhbm5vdCBiZSB1c2VkLlxyXG4gKlxyXG4gKiBAcGFyYW0gYmxvYiBUaGUgYmxvYiB0byBiZSBzbGljZWQuXHJcbiAqIEBwYXJhbSBzdGFydCBJbmRleCBvZiB0aGUgc3RhcnRpbmcgYnl0ZS5cclxuICogQHBhcmFtIGVuZCBJbmRleCBvZiB0aGUgZW5kaW5nIGJ5dGUuXHJcbiAqIEByZXR1cm4gVGhlIGJsb2Igc2xpY2Ugb3IgbnVsbCBpZiBub3Qgc3VwcG9ydGVkLlxyXG4gKi9cclxuZnVuY3Rpb24gc2xpY2VCbG9iKGJsb2IsIHN0YXJ0LCBlbmQpIHtcclxuICAgIGlmIChibG9iLndlYmtpdFNsaWNlKSB7XHJcbiAgICAgICAgcmV0dXJuIGJsb2Iud2Via2l0U2xpY2Uoc3RhcnQsIGVuZCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChibG9iLm1velNsaWNlKSB7XHJcbiAgICAgICAgcmV0dXJuIGJsb2IubW96U2xpY2Uoc3RhcnQsIGVuZCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChibG9iLnNsaWNlKSB7XHJcbiAgICAgICAgcmV0dXJuIGJsb2Iuc2xpY2Uoc3RhcnQsIGVuZCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbnVsbDtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjEgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKiogQ29udmVydHMgYSBCYXNlNjQgZW5jb2RlZCBzdHJpbmcgdG8gYSBiaW5hcnkgc3RyaW5nLiAqL1xyXG5mdW5jdGlvbiBkZWNvZGVCYXNlNjQoZW5jb2RlZCkge1xyXG4gICAgcmV0dXJuIGF0b2IoZW5jb2RlZCk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEFuIGVudW1lcmF0aW9uIG9mIHRoZSBwb3NzaWJsZSBzdHJpbmcgZm9ybWF0cyBmb3IgdXBsb2FkLlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5jb25zdCBTdHJpbmdGb3JtYXQgPSB7XHJcbiAgICAvKipcclxuICAgICAqIEluZGljYXRlcyB0aGUgc3RyaW5nIHNob3VsZCBiZSBpbnRlcnByZXRlZCBcInJhd1wiLCB0aGF0IGlzLCBhcyBub3JtYWwgdGV4dC5cclxuICAgICAqIFRoZSBzdHJpbmcgd2lsbCBiZSBpbnRlcnByZXRlZCBhcyBVVEYtMTYsIHRoZW4gdXBsb2FkZWQgYXMgYSBVVEYtOCBieXRlXHJcbiAgICAgKiBzZXF1ZW5jZS5cclxuICAgICAqIEV4YW1wbGU6IFRoZSBzdHJpbmcgJ0hlbGxvISBcXFxcdWQ4M2RcXFxcdWRlMGEnIGJlY29tZXMgdGhlIGJ5dGUgc2VxdWVuY2VcclxuICAgICAqIDQ4IDY1IDZjIDZjIDZmIDIxIDIwIGYwIDlmIDk4IDhhXHJcbiAgICAgKi9cclxuICAgIFJBVzogJ3JhdycsXHJcbiAgICAvKipcclxuICAgICAqIEluZGljYXRlcyB0aGUgc3RyaW5nIHNob3VsZCBiZSBpbnRlcnByZXRlZCBhcyBiYXNlNjQtZW5jb2RlZCBkYXRhLlxyXG4gICAgICogUGFkZGluZyBjaGFyYWN0ZXJzICh0cmFpbGluZyAnPSdzKSBhcmUgb3B0aW9uYWwuXHJcbiAgICAgKiBFeGFtcGxlOiBUaGUgc3RyaW5nICdyV21PKytFNnQ3L3Jsdz09JyBiZWNvbWVzIHRoZSBieXRlIHNlcXVlbmNlXHJcbiAgICAgKiBhZCA2OSA4ZSBmYiBlMSAzYSBiNyBiZiBlYiA5N1xyXG4gICAgICovXHJcbiAgICBCQVNFNjQ6ICdiYXNlNjQnLFxyXG4gICAgLyoqXHJcbiAgICAgKiBJbmRpY2F0ZXMgdGhlIHN0cmluZyBzaG91bGQgYmUgaW50ZXJwcmV0ZWQgYXMgYmFzZTY0dXJsLWVuY29kZWQgZGF0YS5cclxuICAgICAqIFBhZGRpbmcgY2hhcmFjdGVycyAodHJhaWxpbmcgJz0ncykgYXJlIG9wdGlvbmFsLlxyXG4gICAgICogRXhhbXBsZTogVGhlIHN0cmluZyAncldtTy0tRTZ0N19ybHc9PScgYmVjb21lcyB0aGUgYnl0ZSBzZXF1ZW5jZVxyXG4gICAgICogYWQgNjkgOGUgZmIgZTEgM2EgYjcgYmYgZWIgOTdcclxuICAgICAqL1xyXG4gICAgQkFTRTY0VVJMOiAnYmFzZTY0dXJsJyxcclxuICAgIC8qKlxyXG4gICAgICogSW5kaWNhdGVzIHRoZSBzdHJpbmcgaXMgYSBkYXRhIFVSTCwgc3VjaCBhcyBvbmUgb2J0YWluZWQgZnJvbVxyXG4gICAgICogY2FudmFzLnRvRGF0YVVSTCgpLlxyXG4gICAgICogRXhhbXBsZTogdGhlIHN0cmluZyAnZGF0YTphcHBsaWNhdGlvbi9vY3RldC1zdHJlYW07YmFzZTY0LGFhYWEnXHJcbiAgICAgKiBiZWNvbWVzIHRoZSBieXRlIHNlcXVlbmNlXHJcbiAgICAgKiA2OSBhNiA5YVxyXG4gICAgICogKHRoZSBjb250ZW50LXR5cGUgXCJhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW1cIiBpcyBhbHNvIGFwcGxpZWQsIGJ1dCBjYW5cclxuICAgICAqIGJlIG92ZXJyaWRkZW4gaW4gdGhlIG1ldGFkYXRhIG9iamVjdCkuXHJcbiAgICAgKi9cclxuICAgIERBVEFfVVJMOiAnZGF0YV91cmwnXHJcbn07XHJcbmNsYXNzIFN0cmluZ0RhdGEge1xyXG4gICAgY29uc3RydWN0b3IoZGF0YSwgY29udGVudFR5cGUpIHtcclxuICAgICAgICB0aGlzLmRhdGEgPSBkYXRhO1xyXG4gICAgICAgIHRoaXMuY29udGVudFR5cGUgPSBjb250ZW50VHlwZSB8fCBudWxsO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBAaW50ZXJuYWxcclxuICovXHJcbmZ1bmN0aW9uIGRhdGFGcm9tU3RyaW5nKGZvcm1hdCwgc3RyaW5nRGF0YSkge1xyXG4gICAgc3dpdGNoIChmb3JtYXQpIHtcclxuICAgICAgICBjYXNlIFN0cmluZ0Zvcm1hdC5SQVc6XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgU3RyaW5nRGF0YSh1dGY4Qnl0ZXNfKHN0cmluZ0RhdGEpKTtcclxuICAgICAgICBjYXNlIFN0cmluZ0Zvcm1hdC5CQVNFNjQ6XHJcbiAgICAgICAgY2FzZSBTdHJpbmdGb3JtYXQuQkFTRTY0VVJMOlxyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFN0cmluZ0RhdGEoYmFzZTY0Qnl0ZXNfKGZvcm1hdCwgc3RyaW5nRGF0YSkpO1xyXG4gICAgICAgIGNhc2UgU3RyaW5nRm9ybWF0LkRBVEFfVVJMOlxyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFN0cmluZ0RhdGEoZGF0YVVSTEJ5dGVzXyhzdHJpbmdEYXRhKSwgZGF0YVVSTENvbnRlbnRUeXBlXyhzdHJpbmdEYXRhKSk7XHJcbiAgICAgICAgLy8gZG8gbm90aGluZ1xyXG4gICAgfVxyXG4gICAgLy8gYXNzZXJ0KGZhbHNlKTtcclxuICAgIHRocm93IHVua25vd24oKTtcclxufVxyXG5mdW5jdGlvbiB1dGY4Qnl0ZXNfKHZhbHVlKSB7XHJcbiAgICBjb25zdCBiID0gW107XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHZhbHVlLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgbGV0IGMgPSB2YWx1ZS5jaGFyQ29kZUF0KGkpO1xyXG4gICAgICAgIGlmIChjIDw9IDEyNykge1xyXG4gICAgICAgICAgICBiLnB1c2goYyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAoYyA8PSAyMDQ3KSB7XHJcbiAgICAgICAgICAgICAgICBiLnB1c2goMTkyIHwgKGMgPj4gNiksIDEyOCB8IChjICYgNjMpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmICgoYyAmIDY0NTEyKSA9PT0gNTUyOTYpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBUaGUgc3RhcnQgb2YgYSBzdXJyb2dhdGUgcGFpci5cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWxpZCA9IGkgPCB2YWx1ZS5sZW5ndGggLSAxICYmICh2YWx1ZS5jaGFyQ29kZUF0KGkgKyAxKSAmIDY0NTEyKSA9PT0gNTYzMjA7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF2YWxpZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGUgc2Vjb25kIHN1cnJvZ2F0ZSB3YXNuJ3QgdGhlcmUuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGIucHVzaCgyMzksIDE5MSwgMTg5KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGhpID0gYztcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbG8gPSB2YWx1ZS5jaGFyQ29kZUF0KCsraSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSA2NTUzNiB8ICgoaGkgJiAxMDIzKSA8PCAxMCkgfCAobG8gJiAxMDIzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYi5wdXNoKDI0MCB8IChjID4+IDE4KSwgMTI4IHwgKChjID4+IDEyKSAmIDYzKSwgMTI4IHwgKChjID4+IDYpICYgNjMpLCAxMjggfCAoYyAmIDYzKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKChjICYgNjQ1MTIpID09PSA1NjMyMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJbnZhbGlkIGxvdyBzdXJyb2dhdGUuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGIucHVzaCgyMzksIDE5MSwgMTg5KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGIucHVzaCgyMjQgfCAoYyA+PiAxMiksIDEyOCB8ICgoYyA+PiA2KSAmIDYzKSwgMTI4IHwgKGMgJiA2MykpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBuZXcgVWludDhBcnJheShiKTtcclxufVxyXG5mdW5jdGlvbiBwZXJjZW50RW5jb2RlZEJ5dGVzXyh2YWx1ZSkge1xyXG4gICAgbGV0IGRlY29kZWQ7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGRlY29kZWQgPSBkZWNvZGVVUklDb21wb25lbnQodmFsdWUpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICB0aHJvdyBpbnZhbGlkRm9ybWF0KFN0cmluZ0Zvcm1hdC5EQVRBX1VSTCwgJ01hbGZvcm1lZCBkYXRhIFVSTC4nKTtcclxuICAgIH1cclxuICAgIHJldHVybiB1dGY4Qnl0ZXNfKGRlY29kZWQpO1xyXG59XHJcbmZ1bmN0aW9uIGJhc2U2NEJ5dGVzXyhmb3JtYXQsIHZhbHVlKSB7XHJcbiAgICBzd2l0Y2ggKGZvcm1hdCkge1xyXG4gICAgICAgIGNhc2UgU3RyaW5nRm9ybWF0LkJBU0U2NDoge1xyXG4gICAgICAgICAgICBjb25zdCBoYXNNaW51cyA9IHZhbHVlLmluZGV4T2YoJy0nKSAhPT0gLTE7XHJcbiAgICAgICAgICAgIGNvbnN0IGhhc1VuZGVyID0gdmFsdWUuaW5kZXhPZignXycpICE9PSAtMTtcclxuICAgICAgICAgICAgaWYgKGhhc01pbnVzIHx8IGhhc1VuZGVyKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpbnZhbGlkQ2hhciA9IGhhc01pbnVzID8gJy0nIDogJ18nO1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgaW52YWxpZEZvcm1hdChmb3JtYXQsIFwiSW52YWxpZCBjaGFyYWN0ZXIgJ1wiICtcclxuICAgICAgICAgICAgICAgICAgICBpbnZhbGlkQ2hhciArXHJcbiAgICAgICAgICAgICAgICAgICAgXCInIGZvdW5kOiBpcyBpdCBiYXNlNjR1cmwgZW5jb2RlZD9cIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhc2UgU3RyaW5nRm9ybWF0LkJBU0U2NFVSTDoge1xyXG4gICAgICAgICAgICBjb25zdCBoYXNQbHVzID0gdmFsdWUuaW5kZXhPZignKycpICE9PSAtMTtcclxuICAgICAgICAgICAgY29uc3QgaGFzU2xhc2ggPSB2YWx1ZS5pbmRleE9mKCcvJykgIT09IC0xO1xyXG4gICAgICAgICAgICBpZiAoaGFzUGx1cyB8fCBoYXNTbGFzaCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaW52YWxpZENoYXIgPSBoYXNQbHVzID8gJysnIDogJy8nO1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgaW52YWxpZEZvcm1hdChmb3JtYXQsIFwiSW52YWxpZCBjaGFyYWN0ZXIgJ1wiICsgaW52YWxpZENoYXIgKyBcIicgZm91bmQ6IGlzIGl0IGJhc2U2NCBlbmNvZGVkP1wiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UoLy0vZywgJysnKS5yZXBsYWNlKC9fL2csICcvJyk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBkbyBub3RoaW5nXHJcbiAgICB9XHJcbiAgICBsZXQgYnl0ZXM7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGJ5dGVzID0gZGVjb2RlQmFzZTY0KHZhbHVlKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgdGhyb3cgaW52YWxpZEZvcm1hdChmb3JtYXQsICdJbnZhbGlkIGNoYXJhY3RlciBmb3VuZCcpO1xyXG4gICAgfVxyXG4gICAgY29uc3QgYXJyYXkgPSBuZXcgVWludDhBcnJheShieXRlcy5sZW5ndGgpO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBieXRlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGFycmF5W2ldID0gYnl0ZXMuY2hhckNvZGVBdChpKTtcclxuICAgIH1cclxuICAgIHJldHVybiBhcnJheTtcclxufVxyXG5jbGFzcyBEYXRhVVJMUGFydHMge1xyXG4gICAgY29uc3RydWN0b3IoZGF0YVVSTCkge1xyXG4gICAgICAgIHRoaXMuYmFzZTY0ID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5jb250ZW50VHlwZSA9IG51bGw7XHJcbiAgICAgICAgY29uc3QgbWF0Y2hlcyA9IGRhdGFVUkwubWF0Y2goL15kYXRhOihbXixdKyk/LC8pO1xyXG4gICAgICAgIGlmIChtYXRjaGVzID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRocm93IGludmFsaWRGb3JtYXQoU3RyaW5nRm9ybWF0LkRBVEFfVVJMLCBcIk11c3QgYmUgZm9ybWF0dGVkICdkYXRhOls8bWVkaWF0eXBlPl1bO2Jhc2U2NF0sPGRhdGE+XCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBtaWRkbGUgPSBtYXRjaGVzWzFdIHx8IG51bGw7XHJcbiAgICAgICAgaWYgKG1pZGRsZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYmFzZTY0ID0gZW5kc1dpdGgobWlkZGxlLCAnO2Jhc2U2NCcpO1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRlbnRUeXBlID0gdGhpcy5iYXNlNjRcclxuICAgICAgICAgICAgICAgID8gbWlkZGxlLnN1YnN0cmluZygwLCBtaWRkbGUubGVuZ3RoIC0gJztiYXNlNjQnLmxlbmd0aClcclxuICAgICAgICAgICAgICAgIDogbWlkZGxlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnJlc3QgPSBkYXRhVVJMLnN1YnN0cmluZyhkYXRhVVJMLmluZGV4T2YoJywnKSArIDEpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGRhdGFVUkxCeXRlc18oZGF0YVVybCkge1xyXG4gICAgY29uc3QgcGFydHMgPSBuZXcgRGF0YVVSTFBhcnRzKGRhdGFVcmwpO1xyXG4gICAgaWYgKHBhcnRzLmJhc2U2NCkge1xyXG4gICAgICAgIHJldHVybiBiYXNlNjRCeXRlc18oU3RyaW5nRm9ybWF0LkJBU0U2NCwgcGFydHMucmVzdCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gcGVyY2VudEVuY29kZWRCeXRlc18ocGFydHMucmVzdCk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gZGF0YVVSTENvbnRlbnRUeXBlXyhkYXRhVXJsKSB7XHJcbiAgICBjb25zdCBwYXJ0cyA9IG5ldyBEYXRhVVJMUGFydHMoZGF0YVVybCk7XHJcbiAgICByZXR1cm4gcGFydHMuY29udGVudFR5cGU7XHJcbn1cclxuZnVuY3Rpb24gZW5kc1dpdGgocywgZW5kKSB7XHJcbiAgICBjb25zdCBsb25nRW5vdWdoID0gcy5sZW5ndGggPj0gZW5kLmxlbmd0aDtcclxuICAgIGlmICghbG9uZ0Vub3VnaCkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIHJldHVybiBzLnN1YnN0cmluZyhzLmxlbmd0aCAtIGVuZC5sZW5ndGgpID09PSBlbmQ7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEBwYXJhbSBvcHRfZWxpZGVDb3B5IC0gSWYgdHJ1ZSwgZG9lc24ndCBjb3B5IG11dGFibGUgaW5wdXQgZGF0YVxyXG4gKiAgICAgKGUuZy4gVWludDhBcnJheXMpLiBQYXNzIHRydWUgb25seSBpZiB5b3Uga25vdyB0aGUgb2JqZWN0cyB3aWxsIG5vdCBiZVxyXG4gKiAgICAgbW9kaWZpZWQgYWZ0ZXIgdGhpcyBibG9iJ3MgY29uc3RydWN0aW9uLlxyXG4gKlxyXG4gKiBAaW50ZXJuYWxcclxuICovXHJcbmNsYXNzIEZic0Jsb2Ige1xyXG4gICAgY29uc3RydWN0b3IoZGF0YSwgZWxpZGVDb3B5KSB7XHJcbiAgICAgICAgbGV0IHNpemUgPSAwO1xyXG4gICAgICAgIGxldCBibG9iVHlwZSA9ICcnO1xyXG4gICAgICAgIGlmIChpc05hdGl2ZUJsb2IoZGF0YSkpIHtcclxuICAgICAgICAgICAgdGhpcy5kYXRhXyA9IGRhdGE7XHJcbiAgICAgICAgICAgIHNpemUgPSBkYXRhLnNpemU7XHJcbiAgICAgICAgICAgIGJsb2JUeXBlID0gZGF0YS50eXBlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChkYXRhIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHtcclxuICAgICAgICAgICAgaWYgKGVsaWRlQ29weSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhXyA9IG5ldyBVaW50OEFycmF5KGRhdGEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhXyA9IG5ldyBVaW50OEFycmF5KGRhdGEuYnl0ZUxlbmd0aCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGFfLnNldChuZXcgVWludDhBcnJheShkYXRhKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2l6ZSA9IHRoaXMuZGF0YV8ubGVuZ3RoO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChkYXRhIGluc3RhbmNlb2YgVWludDhBcnJheSkge1xyXG4gICAgICAgICAgICBpZiAoZWxpZGVDb3B5KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGFfID0gZGF0YTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGF0YV8gPSBuZXcgVWludDhBcnJheShkYXRhLmxlbmd0aCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGFfLnNldChkYXRhKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzaXplID0gZGF0YS5sZW5ndGg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2l6ZV8gPSBzaXplO1xyXG4gICAgICAgIHRoaXMudHlwZV8gPSBibG9iVHlwZTtcclxuICAgIH1cclxuICAgIHNpemUoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2l6ZV87XHJcbiAgICB9XHJcbiAgICB0eXBlKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnR5cGVfO1xyXG4gICAgfVxyXG4gICAgc2xpY2Uoc3RhcnRCeXRlLCBlbmRCeXRlKSB7XHJcbiAgICAgICAgaWYgKGlzTmF0aXZlQmxvYih0aGlzLmRhdGFfKSkge1xyXG4gICAgICAgICAgICBjb25zdCByZWFsQmxvYiA9IHRoaXMuZGF0YV87XHJcbiAgICAgICAgICAgIGNvbnN0IHNsaWNlZCA9IHNsaWNlQmxvYihyZWFsQmxvYiwgc3RhcnRCeXRlLCBlbmRCeXRlKTtcclxuICAgICAgICAgICAgaWYgKHNsaWNlZCA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBGYnNCbG9iKHNsaWNlZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCBzbGljZSA9IG5ldyBVaW50OEFycmF5KHRoaXMuZGF0YV8uYnVmZmVyLCBzdGFydEJ5dGUsIGVuZEJ5dGUgLSBzdGFydEJ5dGUpO1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IEZic0Jsb2Ioc2xpY2UsIHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHN0YXRpYyBnZXRCbG9iKC4uLmFyZ3MpIHtcclxuICAgICAgICBpZiAoaXNOYXRpdmVCbG9iRGVmaW5lZCgpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGJsb2JieSA9IGFyZ3MubWFwKCh2YWwpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICh2YWwgaW5zdGFuY2VvZiBGYnNCbG9iKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhbC5kYXRhXztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB2YWw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IEZic0Jsb2IoZ2V0QmxvYi5hcHBseShudWxsLCBibG9iYnkpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVpbnQ4QXJyYXlzID0gYXJncy5tYXAoKHZhbCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGlzU3RyaW5nKHZhbCkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YUZyb21TdHJpbmcoU3RyaW5nRm9ybWF0LlJBVywgdmFsKS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gQmxvYnMgZG9uJ3QgZXhpc3QsIHNvIHRoaXMgaGFzIHRvIGJlIGEgVWludDhBcnJheS5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmFsLmRhdGFfO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgbGV0IGZpbmFsTGVuZ3RoID0gMDtcclxuICAgICAgICAgICAgdWludDhBcnJheXMuZm9yRWFjaCgoYXJyYXkpID0+IHtcclxuICAgICAgICAgICAgICAgIGZpbmFsTGVuZ3RoICs9IGFycmF5LmJ5dGVMZW5ndGg7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBtZXJnZWQgPSBuZXcgVWludDhBcnJheShmaW5hbExlbmd0aCk7XHJcbiAgICAgICAgICAgIGxldCBpbmRleCA9IDA7XHJcbiAgICAgICAgICAgIHVpbnQ4QXJyYXlzLmZvckVhY2goKGFycmF5KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWVyZ2VkW2luZGV4KytdID0gYXJyYXlbaV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IEZic0Jsb2IobWVyZ2VkLCB0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICB1cGxvYWREYXRhKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRhdGFfO1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBSZXR1cm5zIHRoZSBPYmplY3QgcmVzdWx0aW5nIGZyb20gcGFyc2luZyB0aGUgZ2l2ZW4gSlNPTiwgb3IgbnVsbCBpZiB0aGVcclxuICogZ2l2ZW4gc3RyaW5nIGRvZXMgbm90IHJlcHJlc2VudCBhIEpTT04gb2JqZWN0LlxyXG4gKi9cclxuZnVuY3Rpb24ganNvbk9iamVjdE9yTnVsbChzKSB7XHJcbiAgICBsZXQgb2JqO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBvYmogPSBKU09OLnBhcnNlKHMpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIGlmIChpc05vbkFycmF5T2JqZWN0KG9iaikpIHtcclxuICAgICAgICByZXR1cm4gb2JqO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEBmaWxlb3ZlcnZpZXcgQ29udGFpbnMgaGVscGVyIG1ldGhvZHMgZm9yIG1hbmlwdWxhdGluZyBwYXRocy5cclxuICovXHJcbi8qKlxyXG4gKiBAcmV0dXJuIE51bGwgaWYgdGhlIHBhdGggaXMgYWxyZWFkeSBhdCB0aGUgcm9vdC5cclxuICovXHJcbmZ1bmN0aW9uIHBhcmVudChwYXRoKSB7XHJcbiAgICBpZiAocGF0aC5sZW5ndGggPT09IDApIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIGNvbnN0IGluZGV4ID0gcGF0aC5sYXN0SW5kZXhPZignLycpO1xyXG4gICAgaWYgKGluZGV4ID09PSAtMSkge1xyXG4gICAgICAgIHJldHVybiAnJztcclxuICAgIH1cclxuICAgIGNvbnN0IG5ld1BhdGggPSBwYXRoLnNsaWNlKDAsIGluZGV4KTtcclxuICAgIHJldHVybiBuZXdQYXRoO1xyXG59XHJcbmZ1bmN0aW9uIGNoaWxkKHBhdGgsIGNoaWxkUGF0aCkge1xyXG4gICAgY29uc3QgY2Fub25pY2FsQ2hpbGRQYXRoID0gY2hpbGRQYXRoXHJcbiAgICAgICAgLnNwbGl0KCcvJylcclxuICAgICAgICAuZmlsdGVyKGNvbXBvbmVudCA9PiBjb21wb25lbnQubGVuZ3RoID4gMClcclxuICAgICAgICAuam9pbignLycpO1xyXG4gICAgaWYgKHBhdGgubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgcmV0dXJuIGNhbm9uaWNhbENoaWxkUGF0aDtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBwYXRoICsgJy8nICsgY2Fub25pY2FsQ2hpbGRQYXRoO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBSZXR1cm5zIHRoZSBsYXN0IGNvbXBvbmVudCBvZiBhIHBhdGguXHJcbiAqICcvZm9vL2JhcicgLT4gJ2JhcidcclxuICogJy9mb28vYmFyL2Jhei8nIC0+ICdiYXovJ1xyXG4gKiAnL2EnIC0+ICdhJ1xyXG4gKi9cclxuZnVuY3Rpb24gbGFzdENvbXBvbmVudChwYXRoKSB7XHJcbiAgICBjb25zdCBpbmRleCA9IHBhdGgubGFzdEluZGV4T2YoJy8nLCBwYXRoLmxlbmd0aCAtIDIpO1xyXG4gICAgaWYgKGluZGV4ID09PSAtMSkge1xyXG4gICAgICAgIHJldHVybiBwYXRoO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIHBhdGguc2xpY2UoaW5kZXggKyAxKTtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5mdW5jdGlvbiBub1hmb3JtXyhtZXRhZGF0YSwgdmFsdWUpIHtcclxuICAgIHJldHVybiB2YWx1ZTtcclxufVxyXG5jbGFzcyBNYXBwaW5nIHtcclxuICAgIGNvbnN0cnVjdG9yKHNlcnZlciwgbG9jYWwsIHdyaXRhYmxlLCB4Zm9ybSkge1xyXG4gICAgICAgIHRoaXMuc2VydmVyID0gc2VydmVyO1xyXG4gICAgICAgIHRoaXMubG9jYWwgPSBsb2NhbCB8fCBzZXJ2ZXI7XHJcbiAgICAgICAgdGhpcy53cml0YWJsZSA9ICEhd3JpdGFibGU7XHJcbiAgICAgICAgdGhpcy54Zm9ybSA9IHhmb3JtIHx8IG5vWGZvcm1fO1xyXG4gICAgfVxyXG59XHJcbmxldCBtYXBwaW5nc18gPSBudWxsO1xyXG5mdW5jdGlvbiB4Zm9ybVBhdGgoZnVsbFBhdGgpIHtcclxuICAgIGlmICghaXNTdHJpbmcoZnVsbFBhdGgpIHx8IGZ1bGxQYXRoLmxlbmd0aCA8IDIpIHtcclxuICAgICAgICByZXR1cm4gZnVsbFBhdGg7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gbGFzdENvbXBvbmVudChmdWxsUGF0aCk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gZ2V0TWFwcGluZ3MoKSB7XHJcbiAgICBpZiAobWFwcGluZ3NfKSB7XHJcbiAgICAgICAgcmV0dXJuIG1hcHBpbmdzXztcclxuICAgIH1cclxuICAgIGNvbnN0IG1hcHBpbmdzID0gW107XHJcbiAgICBtYXBwaW5ncy5wdXNoKG5ldyBNYXBwaW5nKCdidWNrZXQnKSk7XHJcbiAgICBtYXBwaW5ncy5wdXNoKG5ldyBNYXBwaW5nKCdnZW5lcmF0aW9uJykpO1xyXG4gICAgbWFwcGluZ3MucHVzaChuZXcgTWFwcGluZygnbWV0YWdlbmVyYXRpb24nKSk7XHJcbiAgICBtYXBwaW5ncy5wdXNoKG5ldyBNYXBwaW5nKCduYW1lJywgJ2Z1bGxQYXRoJywgdHJ1ZSkpO1xyXG4gICAgZnVuY3Rpb24gbWFwcGluZ3NYZm9ybVBhdGgoX21ldGFkYXRhLCBmdWxsUGF0aCkge1xyXG4gICAgICAgIHJldHVybiB4Zm9ybVBhdGgoZnVsbFBhdGgpO1xyXG4gICAgfVxyXG4gICAgY29uc3QgbmFtZU1hcHBpbmcgPSBuZXcgTWFwcGluZygnbmFtZScpO1xyXG4gICAgbmFtZU1hcHBpbmcueGZvcm0gPSBtYXBwaW5nc1hmb3JtUGF0aDtcclxuICAgIG1hcHBpbmdzLnB1c2gobmFtZU1hcHBpbmcpO1xyXG4gICAgLyoqXHJcbiAgICAgKiBDb2VyY2VzIHRoZSBzZWNvbmQgcGFyYW0gdG8gYSBudW1iZXIsIGlmIGl0IGlzIGRlZmluZWQuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIHhmb3JtU2l6ZShfbWV0YWRhdGEsIHNpemUpIHtcclxuICAgICAgICBpZiAoc2l6ZSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBOdW1iZXIoc2l6ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gc2l6ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBjb25zdCBzaXplTWFwcGluZyA9IG5ldyBNYXBwaW5nKCdzaXplJyk7XHJcbiAgICBzaXplTWFwcGluZy54Zm9ybSA9IHhmb3JtU2l6ZTtcclxuICAgIG1hcHBpbmdzLnB1c2goc2l6ZU1hcHBpbmcpO1xyXG4gICAgbWFwcGluZ3MucHVzaChuZXcgTWFwcGluZygndGltZUNyZWF0ZWQnKSk7XHJcbiAgICBtYXBwaW5ncy5wdXNoKG5ldyBNYXBwaW5nKCd1cGRhdGVkJykpO1xyXG4gICAgbWFwcGluZ3MucHVzaChuZXcgTWFwcGluZygnbWQ1SGFzaCcsIG51bGwsIHRydWUpKTtcclxuICAgIG1hcHBpbmdzLnB1c2gobmV3IE1hcHBpbmcoJ2NhY2hlQ29udHJvbCcsIG51bGwsIHRydWUpKTtcclxuICAgIG1hcHBpbmdzLnB1c2gobmV3IE1hcHBpbmcoJ2NvbnRlbnREaXNwb3NpdGlvbicsIG51bGwsIHRydWUpKTtcclxuICAgIG1hcHBpbmdzLnB1c2gobmV3IE1hcHBpbmcoJ2NvbnRlbnRFbmNvZGluZycsIG51bGwsIHRydWUpKTtcclxuICAgIG1hcHBpbmdzLnB1c2gobmV3IE1hcHBpbmcoJ2NvbnRlbnRMYW5ndWFnZScsIG51bGwsIHRydWUpKTtcclxuICAgIG1hcHBpbmdzLnB1c2gobmV3IE1hcHBpbmcoJ2NvbnRlbnRUeXBlJywgbnVsbCwgdHJ1ZSkpO1xyXG4gICAgbWFwcGluZ3MucHVzaChuZXcgTWFwcGluZygnbWV0YWRhdGEnLCAnY3VzdG9tTWV0YWRhdGEnLCB0cnVlKSk7XHJcbiAgICBtYXBwaW5nc18gPSBtYXBwaW5ncztcclxuICAgIHJldHVybiBtYXBwaW5nc187XHJcbn1cclxuZnVuY3Rpb24gYWRkUmVmKG1ldGFkYXRhLCBzZXJ2aWNlKSB7XHJcbiAgICBmdW5jdGlvbiBnZW5lcmF0ZVJlZigpIHtcclxuICAgICAgICBjb25zdCBidWNrZXQgPSBtZXRhZGF0YVsnYnVja2V0J107XHJcbiAgICAgICAgY29uc3QgcGF0aCA9IG1ldGFkYXRhWydmdWxsUGF0aCddO1xyXG4gICAgICAgIGNvbnN0IGxvYyA9IG5ldyBMb2NhdGlvbihidWNrZXQsIHBhdGgpO1xyXG4gICAgICAgIHJldHVybiBzZXJ2aWNlLl9tYWtlU3RvcmFnZVJlZmVyZW5jZShsb2MpO1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG1ldGFkYXRhLCAncmVmJywgeyBnZXQ6IGdlbmVyYXRlUmVmIH0pO1xyXG59XHJcbmZ1bmN0aW9uIGZyb21SZXNvdXJjZShzZXJ2aWNlLCByZXNvdXJjZSwgbWFwcGluZ3MpIHtcclxuICAgIGNvbnN0IG1ldGFkYXRhID0ge307XHJcbiAgICBtZXRhZGF0YVsndHlwZSddID0gJ2ZpbGUnO1xyXG4gICAgY29uc3QgbGVuID0gbWFwcGluZ3MubGVuZ3RoO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgIGNvbnN0IG1hcHBpbmcgPSBtYXBwaW5nc1tpXTtcclxuICAgICAgICBtZXRhZGF0YVttYXBwaW5nLmxvY2FsXSA9IG1hcHBpbmcueGZvcm0obWV0YWRhdGEsIHJlc291cmNlW21hcHBpbmcuc2VydmVyXSk7XHJcbiAgICB9XHJcbiAgICBhZGRSZWYobWV0YWRhdGEsIHNlcnZpY2UpO1xyXG4gICAgcmV0dXJuIG1ldGFkYXRhO1xyXG59XHJcbmZ1bmN0aW9uIGZyb21SZXNvdXJjZVN0cmluZyhzZXJ2aWNlLCByZXNvdXJjZVN0cmluZywgbWFwcGluZ3MpIHtcclxuICAgIGNvbnN0IG9iaiA9IGpzb25PYmplY3RPck51bGwocmVzb3VyY2VTdHJpbmcpO1xyXG4gICAgaWYgKG9iaiA9PT0gbnVsbCkge1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgY29uc3QgcmVzb3VyY2UgPSBvYmo7XHJcbiAgICByZXR1cm4gZnJvbVJlc291cmNlKHNlcnZpY2UsIHJlc291cmNlLCBtYXBwaW5ncyk7XHJcbn1cclxuZnVuY3Rpb24gZG93bmxvYWRVcmxGcm9tUmVzb3VyY2VTdHJpbmcobWV0YWRhdGEsIHJlc291cmNlU3RyaW5nLCBob3N0KSB7XHJcbiAgICBjb25zdCBvYmogPSBqc29uT2JqZWN0T3JOdWxsKHJlc291cmNlU3RyaW5nKTtcclxuICAgIGlmIChvYmogPT09IG51bGwpIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIGlmICghaXNTdHJpbmcob2JqWydkb3dubG9hZFRva2VucyddKSkge1xyXG4gICAgICAgIC8vIFRoaXMgY2FuIGhhcHBlbiBpZiBvYmplY3RzIGFyZSB1cGxvYWRlZCB0aHJvdWdoIEdDUyBhbmQgcmV0cmlldmVkXHJcbiAgICAgICAgLy8gdGhyb3VnaCBsaXN0LCBzbyB3ZSBkb24ndCB3YW50IHRvIHRocm93IGFuIEVycm9yLlxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgY29uc3QgdG9rZW5zID0gb2JqWydkb3dubG9hZFRva2VucyddO1xyXG4gICAgaWYgKHRva2Vucy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIGNvbnN0IGVuY29kZSA9IGVuY29kZVVSSUNvbXBvbmVudDtcclxuICAgIGNvbnN0IHRva2Vuc0xpc3QgPSB0b2tlbnMuc3BsaXQoJywnKTtcclxuICAgIGNvbnN0IHVybHMgPSB0b2tlbnNMaXN0Lm1hcCgodG9rZW4pID0+IHtcclxuICAgICAgICBjb25zdCBidWNrZXQgPSBtZXRhZGF0YVsnYnVja2V0J107XHJcbiAgICAgICAgY29uc3QgcGF0aCA9IG1ldGFkYXRhWydmdWxsUGF0aCddO1xyXG4gICAgICAgIGNvbnN0IHVybFBhcnQgPSAnL2IvJyArIGVuY29kZShidWNrZXQpICsgJy9vLycgKyBlbmNvZGUocGF0aCk7XHJcbiAgICAgICAgY29uc3QgYmFzZSA9IG1ha2VVcmwodXJsUGFydCwgaG9zdCk7XHJcbiAgICAgICAgY29uc3QgcXVlcnlTdHJpbmcgPSBtYWtlUXVlcnlTdHJpbmcoe1xyXG4gICAgICAgICAgICBhbHQ6ICdtZWRpYScsXHJcbiAgICAgICAgICAgIHRva2VuXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGJhc2UgKyBxdWVyeVN0cmluZztcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHVybHNbMF07XHJcbn1cclxuZnVuY3Rpb24gdG9SZXNvdXJjZVN0cmluZyhtZXRhZGF0YSwgbWFwcGluZ3MpIHtcclxuICAgIGNvbnN0IHJlc291cmNlID0ge307XHJcbiAgICBjb25zdCBsZW4gPSBtYXBwaW5ncy5sZW5ndGg7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgY29uc3QgbWFwcGluZyA9IG1hcHBpbmdzW2ldO1xyXG4gICAgICAgIGlmIChtYXBwaW5nLndyaXRhYmxlKSB7XHJcbiAgICAgICAgICAgIHJlc291cmNlW21hcHBpbmcuc2VydmVyXSA9IG1ldGFkYXRhW21hcHBpbmcubG9jYWxdO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShyZXNvdXJjZSk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuY29uc3QgUFJFRklYRVNfS0VZID0gJ3ByZWZpeGVzJztcclxuY29uc3QgSVRFTVNfS0VZID0gJ2l0ZW1zJztcclxuZnVuY3Rpb24gZnJvbUJhY2tlbmRSZXNwb25zZShzZXJ2aWNlLCBidWNrZXQsIHJlc291cmNlKSB7XHJcbiAgICBjb25zdCBsaXN0UmVzdWx0ID0ge1xyXG4gICAgICAgIHByZWZpeGVzOiBbXSxcclxuICAgICAgICBpdGVtczogW10sXHJcbiAgICAgICAgbmV4dFBhZ2VUb2tlbjogcmVzb3VyY2VbJ25leHRQYWdlVG9rZW4nXVxyXG4gICAgfTtcclxuICAgIGlmIChyZXNvdXJjZVtQUkVGSVhFU19LRVldKSB7XHJcbiAgICAgICAgZm9yIChjb25zdCBwYXRoIG9mIHJlc291cmNlW1BSRUZJWEVTX0tFWV0pIHtcclxuICAgICAgICAgICAgY29uc3QgcGF0aFdpdGhvdXRUcmFpbGluZ1NsYXNoID0gcGF0aC5yZXBsYWNlKC9cXC8kLywgJycpO1xyXG4gICAgICAgICAgICBjb25zdCByZWZlcmVuY2UgPSBzZXJ2aWNlLl9tYWtlU3RvcmFnZVJlZmVyZW5jZShuZXcgTG9jYXRpb24oYnVja2V0LCBwYXRoV2l0aG91dFRyYWlsaW5nU2xhc2gpKTtcclxuICAgICAgICAgICAgbGlzdFJlc3VsdC5wcmVmaXhlcy5wdXNoKHJlZmVyZW5jZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKHJlc291cmNlW0lURU1TX0tFWV0pIHtcclxuICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgcmVzb3VyY2VbSVRFTVNfS0VZXSkge1xyXG4gICAgICAgICAgICBjb25zdCByZWZlcmVuY2UgPSBzZXJ2aWNlLl9tYWtlU3RvcmFnZVJlZmVyZW5jZShuZXcgTG9jYXRpb24oYnVja2V0LCBpdGVtWyduYW1lJ10pKTtcclxuICAgICAgICAgICAgbGlzdFJlc3VsdC5pdGVtcy5wdXNoKHJlZmVyZW5jZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGxpc3RSZXN1bHQ7XHJcbn1cclxuZnVuY3Rpb24gZnJvbVJlc3BvbnNlU3RyaW5nKHNlcnZpY2UsIGJ1Y2tldCwgcmVzb3VyY2VTdHJpbmcpIHtcclxuICAgIGNvbnN0IG9iaiA9IGpzb25PYmplY3RPck51bGwocmVzb3VyY2VTdHJpbmcpO1xyXG4gICAgaWYgKG9iaiA9PT0gbnVsbCkge1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgY29uc3QgcmVzb3VyY2UgPSBvYmo7XHJcbiAgICByZXR1cm4gZnJvbUJhY2tlbmRSZXNwb25zZShzZXJ2aWNlLCBidWNrZXQsIHJlc291cmNlKTtcclxufVxuXG5jbGFzcyBSZXF1ZXN0SW5mbyB7XHJcbiAgICBjb25zdHJ1Y3Rvcih1cmwsIG1ldGhvZCwgXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdGhlIHZhbHVlIHdpdGggd2hpY2ggdG8gcmVzb2x2ZSB0aGUgcmVxdWVzdCdzIHByb21pc2UuIE9ubHkgY2FsbGVkXHJcbiAgICAgKiBpZiB0aGUgcmVxdWVzdCBpcyBzdWNjZXNzZnVsLiBUaHJvdyBmcm9tIHRoaXMgZnVuY3Rpb24gdG8gcmVqZWN0IHRoZVxyXG4gICAgICogcmV0dXJuZWQgUmVxdWVzdCdzIHByb21pc2Ugd2l0aCB0aGUgdGhyb3duIGVycm9yLlxyXG4gICAgICogTm90ZTogVGhlIFhocklvIHBhc3NlZCB0byB0aGlzIGZ1bmN0aW9uIG1heSBiZSByZXVzZWQgYWZ0ZXIgdGhpcyBjYWxsYmFja1xyXG4gICAgICogcmV0dXJucy4gRG8gbm90IGtlZXAgYSByZWZlcmVuY2UgdG8gaXQgaW4gYW55IHdheS5cclxuICAgICAqL1xyXG4gICAgaGFuZGxlciwgdGltZW91dCkge1xyXG4gICAgICAgIHRoaXMudXJsID0gdXJsO1xyXG4gICAgICAgIHRoaXMubWV0aG9kID0gbWV0aG9kO1xyXG4gICAgICAgIHRoaXMuaGFuZGxlciA9IGhhbmRsZXI7XHJcbiAgICAgICAgdGhpcy50aW1lb3V0ID0gdGltZW91dDtcclxuICAgICAgICB0aGlzLnVybFBhcmFtcyA9IHt9O1xyXG4gICAgICAgIHRoaXMuaGVhZGVycyA9IHt9O1xyXG4gICAgICAgIHRoaXMuYm9keSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5lcnJvckhhbmRsZXIgPSBudWxsO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIENhbGxlZCB3aXRoIHRoZSBjdXJyZW50IG51bWJlciBvZiBieXRlcyB1cGxvYWRlZCBhbmQgdG90YWwgc2l6ZSAoLTEgaWYgbm90XHJcbiAgICAgICAgICogY29tcHV0YWJsZSkgb2YgdGhlIHJlcXVlc3QgYm9keSAoaS5lLiB1c2VkIHRvIHJlcG9ydCB1cGxvYWQgcHJvZ3Jlc3MpLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMucHJvZ3Jlc3NDYWxsYmFjayA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5zdWNjZXNzQ29kZXMgPSBbMjAwXTtcclxuICAgICAgICB0aGlzLmFkZGl0aW9uYWxSZXRyeUNvZGVzID0gW107XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFRocm93cyB0aGUgVU5LTk9XTiBTdG9yYWdlRXJyb3IgaWYgY25kbiBpcyBmYWxzZS5cclxuICovXHJcbmZ1bmN0aW9uIGhhbmRsZXJDaGVjayhjbmRuKSB7XHJcbiAgICBpZiAoIWNuZG4pIHtcclxuICAgICAgICB0aHJvdyB1bmtub3duKCk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gbWV0YWRhdGFIYW5kbGVyKHNlcnZpY2UsIG1hcHBpbmdzKSB7XHJcbiAgICBmdW5jdGlvbiBoYW5kbGVyKHhociwgdGV4dCkge1xyXG4gICAgICAgIGNvbnN0IG1ldGFkYXRhID0gZnJvbVJlc291cmNlU3RyaW5nKHNlcnZpY2UsIHRleHQsIG1hcHBpbmdzKTtcclxuICAgICAgICBoYW5kbGVyQ2hlY2sobWV0YWRhdGEgIT09IG51bGwpO1xyXG4gICAgICAgIHJldHVybiBtZXRhZGF0YTtcclxuICAgIH1cclxuICAgIHJldHVybiBoYW5kbGVyO1xyXG59XHJcbmZ1bmN0aW9uIGxpc3RIYW5kbGVyKHNlcnZpY2UsIGJ1Y2tldCkge1xyXG4gICAgZnVuY3Rpb24gaGFuZGxlcih4aHIsIHRleHQpIHtcclxuICAgICAgICBjb25zdCBsaXN0UmVzdWx0ID0gZnJvbVJlc3BvbnNlU3RyaW5nKHNlcnZpY2UsIGJ1Y2tldCwgdGV4dCk7XHJcbiAgICAgICAgaGFuZGxlckNoZWNrKGxpc3RSZXN1bHQgIT09IG51bGwpO1xyXG4gICAgICAgIHJldHVybiBsaXN0UmVzdWx0O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGhhbmRsZXI7XHJcbn1cclxuZnVuY3Rpb24gZG93bmxvYWRVcmxIYW5kbGVyKHNlcnZpY2UsIG1hcHBpbmdzKSB7XHJcbiAgICBmdW5jdGlvbiBoYW5kbGVyKHhociwgdGV4dCkge1xyXG4gICAgICAgIGNvbnN0IG1ldGFkYXRhID0gZnJvbVJlc291cmNlU3RyaW5nKHNlcnZpY2UsIHRleHQsIG1hcHBpbmdzKTtcclxuICAgICAgICBoYW5kbGVyQ2hlY2sobWV0YWRhdGEgIT09IG51bGwpO1xyXG4gICAgICAgIHJldHVybiBkb3dubG9hZFVybEZyb21SZXNvdXJjZVN0cmluZyhtZXRhZGF0YSwgdGV4dCwgc2VydmljZS5ob3N0KTtcclxuICAgIH1cclxuICAgIHJldHVybiBoYW5kbGVyO1xyXG59XHJcbmZ1bmN0aW9uIHNoYXJlZEVycm9ySGFuZGxlcihsb2NhdGlvbikge1xyXG4gICAgZnVuY3Rpb24gZXJyb3JIYW5kbGVyKHhociwgZXJyKSB7XHJcbiAgICAgICAgbGV0IG5ld0VycjtcclxuICAgICAgICBpZiAoeGhyLmdldFN0YXR1cygpID09PSA0MDEpIHtcclxuICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAvLyBUaGlzIGV4YWN0IG1lc3NhZ2Ugc3RyaW5nIGlzIHRoZSBvbmx5IGNvbnNpc3RlbnQgcGFydCBvZiB0aGVcclxuICAgICAgICAgICAgLy8gc2VydmVyJ3MgZXJyb3IgcmVzcG9uc2UgdGhhdCBpZGVudGlmaWVzIGl0IGFzIGFuIEFwcCBDaGVjayBlcnJvci5cclxuICAgICAgICAgICAgeGhyLmdldFJlc3BvbnNlVGV4dCgpLmluY2x1ZGVzKCdGaXJlYmFzZSBBcHAgQ2hlY2sgdG9rZW4gaXMgaW52YWxpZCcpKSB7XHJcbiAgICAgICAgICAgICAgICBuZXdFcnIgPSB1bmF1dGhvcml6ZWRBcHAoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIG5ld0VyciA9IHVuYXV0aGVudGljYXRlZCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAoeGhyLmdldFN0YXR1cygpID09PSA0MDIpIHtcclxuICAgICAgICAgICAgICAgIG5ld0VyciA9IHF1b3RhRXhjZWVkZWQobG9jYXRpb24uYnVja2V0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmICh4aHIuZ2V0U3RhdHVzKCkgPT09IDQwMykge1xyXG4gICAgICAgICAgICAgICAgICAgIG5ld0VyciA9IHVuYXV0aG9yaXplZChsb2NhdGlvbi5wYXRoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIG5ld0VyciA9IGVycjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBuZXdFcnIuc2VydmVyUmVzcG9uc2UgPSBlcnIuc2VydmVyUmVzcG9uc2U7XHJcbiAgICAgICAgcmV0dXJuIG5ld0VycjtcclxuICAgIH1cclxuICAgIHJldHVybiBlcnJvckhhbmRsZXI7XHJcbn1cclxuZnVuY3Rpb24gb2JqZWN0RXJyb3JIYW5kbGVyKGxvY2F0aW9uKSB7XHJcbiAgICBjb25zdCBzaGFyZWQgPSBzaGFyZWRFcnJvckhhbmRsZXIobG9jYXRpb24pO1xyXG4gICAgZnVuY3Rpb24gZXJyb3JIYW5kbGVyKHhociwgZXJyKSB7XHJcbiAgICAgICAgbGV0IG5ld0VyciA9IHNoYXJlZCh4aHIsIGVycik7XHJcbiAgICAgICAgaWYgKHhoci5nZXRTdGF0dXMoKSA9PT0gNDA0KSB7XHJcbiAgICAgICAgICAgIG5ld0VyciA9IG9iamVjdE5vdEZvdW5kKGxvY2F0aW9uLnBhdGgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBuZXdFcnIuc2VydmVyUmVzcG9uc2UgPSBlcnIuc2VydmVyUmVzcG9uc2U7XHJcbiAgICAgICAgcmV0dXJuIG5ld0VycjtcclxuICAgIH1cclxuICAgIHJldHVybiBlcnJvckhhbmRsZXI7XHJcbn1cclxuZnVuY3Rpb24gZ2V0TWV0YWRhdGEkMihzZXJ2aWNlLCBsb2NhdGlvbiwgbWFwcGluZ3MpIHtcclxuICAgIGNvbnN0IHVybFBhcnQgPSBsb2NhdGlvbi5mdWxsU2VydmVyVXJsKCk7XHJcbiAgICBjb25zdCB1cmwgPSBtYWtlVXJsKHVybFBhcnQsIHNlcnZpY2UuaG9zdCk7XHJcbiAgICBjb25zdCBtZXRob2QgPSAnR0VUJztcclxuICAgIGNvbnN0IHRpbWVvdXQgPSBzZXJ2aWNlLm1heE9wZXJhdGlvblJldHJ5VGltZTtcclxuICAgIGNvbnN0IHJlcXVlc3RJbmZvID0gbmV3IFJlcXVlc3RJbmZvKHVybCwgbWV0aG9kLCBtZXRhZGF0YUhhbmRsZXIoc2VydmljZSwgbWFwcGluZ3MpLCB0aW1lb3V0KTtcclxuICAgIHJlcXVlc3RJbmZvLmVycm9ySGFuZGxlciA9IG9iamVjdEVycm9ySGFuZGxlcihsb2NhdGlvbik7XHJcbiAgICByZXR1cm4gcmVxdWVzdEluZm87XHJcbn1cclxuZnVuY3Rpb24gbGlzdCQyKHNlcnZpY2UsIGxvY2F0aW9uLCBkZWxpbWl0ZXIsIHBhZ2VUb2tlbiwgbWF4UmVzdWx0cykge1xyXG4gICAgY29uc3QgdXJsUGFyYW1zID0ge307XHJcbiAgICBpZiAobG9jYXRpb24uaXNSb290KSB7XHJcbiAgICAgICAgdXJsUGFyYW1zWydwcmVmaXgnXSA9ICcnO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgdXJsUGFyYW1zWydwcmVmaXgnXSA9IGxvY2F0aW9uLnBhdGggKyAnLyc7XHJcbiAgICB9XHJcbiAgICBpZiAoZGVsaW1pdGVyICYmIGRlbGltaXRlci5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgdXJsUGFyYW1zWydkZWxpbWl0ZXInXSA9IGRlbGltaXRlcjtcclxuICAgIH1cclxuICAgIGlmIChwYWdlVG9rZW4pIHtcclxuICAgICAgICB1cmxQYXJhbXNbJ3BhZ2VUb2tlbiddID0gcGFnZVRva2VuO1xyXG4gICAgfVxyXG4gICAgaWYgKG1heFJlc3VsdHMpIHtcclxuICAgICAgICB1cmxQYXJhbXNbJ21heFJlc3VsdHMnXSA9IG1heFJlc3VsdHM7XHJcbiAgICB9XHJcbiAgICBjb25zdCB1cmxQYXJ0ID0gbG9jYXRpb24uYnVja2V0T25seVNlcnZlclVybCgpO1xyXG4gICAgY29uc3QgdXJsID0gbWFrZVVybCh1cmxQYXJ0LCBzZXJ2aWNlLmhvc3QpO1xyXG4gICAgY29uc3QgbWV0aG9kID0gJ0dFVCc7XHJcbiAgICBjb25zdCB0aW1lb3V0ID0gc2VydmljZS5tYXhPcGVyYXRpb25SZXRyeVRpbWU7XHJcbiAgICBjb25zdCByZXF1ZXN0SW5mbyA9IG5ldyBSZXF1ZXN0SW5mbyh1cmwsIG1ldGhvZCwgbGlzdEhhbmRsZXIoc2VydmljZSwgbG9jYXRpb24uYnVja2V0KSwgdGltZW91dCk7XHJcbiAgICByZXF1ZXN0SW5mby51cmxQYXJhbXMgPSB1cmxQYXJhbXM7XHJcbiAgICByZXF1ZXN0SW5mby5lcnJvckhhbmRsZXIgPSBzaGFyZWRFcnJvckhhbmRsZXIobG9jYXRpb24pO1xyXG4gICAgcmV0dXJuIHJlcXVlc3RJbmZvO1xyXG59XHJcbmZ1bmN0aW9uIGdldERvd25sb2FkVXJsKHNlcnZpY2UsIGxvY2F0aW9uLCBtYXBwaW5ncykge1xyXG4gICAgY29uc3QgdXJsUGFydCA9IGxvY2F0aW9uLmZ1bGxTZXJ2ZXJVcmwoKTtcclxuICAgIGNvbnN0IHVybCA9IG1ha2VVcmwodXJsUGFydCwgc2VydmljZS5ob3N0KTtcclxuICAgIGNvbnN0IG1ldGhvZCA9ICdHRVQnO1xyXG4gICAgY29uc3QgdGltZW91dCA9IHNlcnZpY2UubWF4T3BlcmF0aW9uUmV0cnlUaW1lO1xyXG4gICAgY29uc3QgcmVxdWVzdEluZm8gPSBuZXcgUmVxdWVzdEluZm8odXJsLCBtZXRob2QsIGRvd25sb2FkVXJsSGFuZGxlcihzZXJ2aWNlLCBtYXBwaW5ncyksIHRpbWVvdXQpO1xyXG4gICAgcmVxdWVzdEluZm8uZXJyb3JIYW5kbGVyID0gb2JqZWN0RXJyb3JIYW5kbGVyKGxvY2F0aW9uKTtcclxuICAgIHJldHVybiByZXF1ZXN0SW5mbztcclxufVxyXG5mdW5jdGlvbiB1cGRhdGVNZXRhZGF0YSQyKHNlcnZpY2UsIGxvY2F0aW9uLCBtZXRhZGF0YSwgbWFwcGluZ3MpIHtcclxuICAgIGNvbnN0IHVybFBhcnQgPSBsb2NhdGlvbi5mdWxsU2VydmVyVXJsKCk7XHJcbiAgICBjb25zdCB1cmwgPSBtYWtlVXJsKHVybFBhcnQsIHNlcnZpY2UuaG9zdCk7XHJcbiAgICBjb25zdCBtZXRob2QgPSAnUEFUQ0gnO1xyXG4gICAgY29uc3QgYm9keSA9IHRvUmVzb3VyY2VTdHJpbmcobWV0YWRhdGEsIG1hcHBpbmdzKTtcclxuICAgIGNvbnN0IGhlYWRlcnMgPSB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD11dGYtOCcgfTtcclxuICAgIGNvbnN0IHRpbWVvdXQgPSBzZXJ2aWNlLm1heE9wZXJhdGlvblJldHJ5VGltZTtcclxuICAgIGNvbnN0IHJlcXVlc3RJbmZvID0gbmV3IFJlcXVlc3RJbmZvKHVybCwgbWV0aG9kLCBtZXRhZGF0YUhhbmRsZXIoc2VydmljZSwgbWFwcGluZ3MpLCB0aW1lb3V0KTtcclxuICAgIHJlcXVlc3RJbmZvLmhlYWRlcnMgPSBoZWFkZXJzO1xyXG4gICAgcmVxdWVzdEluZm8uYm9keSA9IGJvZHk7XHJcbiAgICByZXF1ZXN0SW5mby5lcnJvckhhbmRsZXIgPSBvYmplY3RFcnJvckhhbmRsZXIobG9jYXRpb24pO1xyXG4gICAgcmV0dXJuIHJlcXVlc3RJbmZvO1xyXG59XHJcbmZ1bmN0aW9uIGRlbGV0ZU9iamVjdCQyKHNlcnZpY2UsIGxvY2F0aW9uKSB7XHJcbiAgICBjb25zdCB1cmxQYXJ0ID0gbG9jYXRpb24uZnVsbFNlcnZlclVybCgpO1xyXG4gICAgY29uc3QgdXJsID0gbWFrZVVybCh1cmxQYXJ0LCBzZXJ2aWNlLmhvc3QpO1xyXG4gICAgY29uc3QgbWV0aG9kID0gJ0RFTEVURSc7XHJcbiAgICBjb25zdCB0aW1lb3V0ID0gc2VydmljZS5tYXhPcGVyYXRpb25SZXRyeVRpbWU7XHJcbiAgICBmdW5jdGlvbiBoYW5kbGVyKF94aHIsIF90ZXh0KSB7IH1cclxuICAgIGNvbnN0IHJlcXVlc3RJbmZvID0gbmV3IFJlcXVlc3RJbmZvKHVybCwgbWV0aG9kLCBoYW5kbGVyLCB0aW1lb3V0KTtcclxuICAgIHJlcXVlc3RJbmZvLnN1Y2Nlc3NDb2RlcyA9IFsyMDAsIDIwNF07XHJcbiAgICByZXF1ZXN0SW5mby5lcnJvckhhbmRsZXIgPSBvYmplY3RFcnJvckhhbmRsZXIobG9jYXRpb24pO1xyXG4gICAgcmV0dXJuIHJlcXVlc3RJbmZvO1xyXG59XHJcbmZ1bmN0aW9uIGRldGVybWluZUNvbnRlbnRUeXBlXyhtZXRhZGF0YSwgYmxvYikge1xyXG4gICAgcmV0dXJuICgobWV0YWRhdGEgJiYgbWV0YWRhdGFbJ2NvbnRlbnRUeXBlJ10pIHx8XHJcbiAgICAgICAgKGJsb2IgJiYgYmxvYi50eXBlKCkpIHx8XHJcbiAgICAgICAgJ2FwcGxpY2F0aW9uL29jdGV0LXN0cmVhbScpO1xyXG59XHJcbmZ1bmN0aW9uIG1ldGFkYXRhRm9yVXBsb2FkXyhsb2NhdGlvbiwgYmxvYiwgbWV0YWRhdGEpIHtcclxuICAgIGNvbnN0IG1ldGFkYXRhQ2xvbmUgPSBPYmplY3QuYXNzaWduKHt9LCBtZXRhZGF0YSk7XHJcbiAgICBtZXRhZGF0YUNsb25lWydmdWxsUGF0aCddID0gbG9jYXRpb24ucGF0aDtcclxuICAgIG1ldGFkYXRhQ2xvbmVbJ3NpemUnXSA9IGJsb2Iuc2l6ZSgpO1xyXG4gICAgaWYgKCFtZXRhZGF0YUNsb25lWydjb250ZW50VHlwZSddKSB7XHJcbiAgICAgICAgbWV0YWRhdGFDbG9uZVsnY29udGVudFR5cGUnXSA9IGRldGVybWluZUNvbnRlbnRUeXBlXyhudWxsLCBibG9iKTtcclxuICAgIH1cclxuICAgIHJldHVybiBtZXRhZGF0YUNsb25lO1xyXG59XHJcbi8qKlxyXG4gKiBQcmVwYXJlIFJlcXVlc3RJbmZvIGZvciB1cGxvYWRzIGFzIENvbnRlbnQtVHlwZTogbXVsdGlwYXJ0LlxyXG4gKi9cclxuZnVuY3Rpb24gbXVsdGlwYXJ0VXBsb2FkKHNlcnZpY2UsIGxvY2F0aW9uLCBtYXBwaW5ncywgYmxvYiwgbWV0YWRhdGEpIHtcclxuICAgIGNvbnN0IHVybFBhcnQgPSBsb2NhdGlvbi5idWNrZXRPbmx5U2VydmVyVXJsKCk7XHJcbiAgICBjb25zdCBoZWFkZXJzID0ge1xyXG4gICAgICAgICdYLUdvb2ctVXBsb2FkLVByb3RvY29sJzogJ211bHRpcGFydCdcclxuICAgIH07XHJcbiAgICBmdW5jdGlvbiBnZW5Cb3VuZGFyeSgpIHtcclxuICAgICAgICBsZXQgc3RyID0gJyc7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAyOyBpKyspIHtcclxuICAgICAgICAgICAgc3RyID0gc3RyICsgTWF0aC5yYW5kb20oKS50b1N0cmluZygpLnNsaWNlKDIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gc3RyO1xyXG4gICAgfVxyXG4gICAgY29uc3QgYm91bmRhcnkgPSBnZW5Cb3VuZGFyeSgpO1xyXG4gICAgaGVhZGVyc1snQ29udGVudC1UeXBlJ10gPSAnbXVsdGlwYXJ0L3JlbGF0ZWQ7IGJvdW5kYXJ5PScgKyBib3VuZGFyeTtcclxuICAgIGNvbnN0IG1ldGFkYXRhXyA9IG1ldGFkYXRhRm9yVXBsb2FkXyhsb2NhdGlvbiwgYmxvYiwgbWV0YWRhdGEpO1xyXG4gICAgY29uc3QgbWV0YWRhdGFTdHJpbmcgPSB0b1Jlc291cmNlU3RyaW5nKG1ldGFkYXRhXywgbWFwcGluZ3MpO1xyXG4gICAgY29uc3QgcHJlQmxvYlBhcnQgPSAnLS0nICtcclxuICAgICAgICBib3VuZGFyeSArXHJcbiAgICAgICAgJ1xcclxcbicgK1xyXG4gICAgICAgICdDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLThcXHJcXG5cXHJcXG4nICtcclxuICAgICAgICBtZXRhZGF0YVN0cmluZyArXHJcbiAgICAgICAgJ1xcclxcbi0tJyArXHJcbiAgICAgICAgYm91bmRhcnkgK1xyXG4gICAgICAgICdcXHJcXG4nICtcclxuICAgICAgICAnQ29udGVudC1UeXBlOiAnICtcclxuICAgICAgICBtZXRhZGF0YV9bJ2NvbnRlbnRUeXBlJ10gK1xyXG4gICAgICAgICdcXHJcXG5cXHJcXG4nO1xyXG4gICAgY29uc3QgcG9zdEJsb2JQYXJ0ID0gJ1xcclxcbi0tJyArIGJvdW5kYXJ5ICsgJy0tJztcclxuICAgIGNvbnN0IGJvZHkgPSBGYnNCbG9iLmdldEJsb2IocHJlQmxvYlBhcnQsIGJsb2IsIHBvc3RCbG9iUGFydCk7XHJcbiAgICBpZiAoYm9keSA9PT0gbnVsbCkge1xyXG4gICAgICAgIHRocm93IGNhbm5vdFNsaWNlQmxvYigpO1xyXG4gICAgfVxyXG4gICAgY29uc3QgdXJsUGFyYW1zID0geyBuYW1lOiBtZXRhZGF0YV9bJ2Z1bGxQYXRoJ10gfTtcclxuICAgIGNvbnN0IHVybCA9IG1ha2VVcmwodXJsUGFydCwgc2VydmljZS5ob3N0KTtcclxuICAgIGNvbnN0IG1ldGhvZCA9ICdQT1NUJztcclxuICAgIGNvbnN0IHRpbWVvdXQgPSBzZXJ2aWNlLm1heFVwbG9hZFJldHJ5VGltZTtcclxuICAgIGNvbnN0IHJlcXVlc3RJbmZvID0gbmV3IFJlcXVlc3RJbmZvKHVybCwgbWV0aG9kLCBtZXRhZGF0YUhhbmRsZXIoc2VydmljZSwgbWFwcGluZ3MpLCB0aW1lb3V0KTtcclxuICAgIHJlcXVlc3RJbmZvLnVybFBhcmFtcyA9IHVybFBhcmFtcztcclxuICAgIHJlcXVlc3RJbmZvLmhlYWRlcnMgPSBoZWFkZXJzO1xyXG4gICAgcmVxdWVzdEluZm8uYm9keSA9IGJvZHkudXBsb2FkRGF0YSgpO1xyXG4gICAgcmVxdWVzdEluZm8uZXJyb3JIYW5kbGVyID0gc2hhcmVkRXJyb3JIYW5kbGVyKGxvY2F0aW9uKTtcclxuICAgIHJldHVybiByZXF1ZXN0SW5mbztcclxufVxyXG4vKipcclxuICogQHBhcmFtIGN1cnJlbnQgVGhlIG51bWJlciBvZiBieXRlcyB0aGF0IGhhdmUgYmVlbiB1cGxvYWRlZCBzbyBmYXIuXHJcbiAqIEBwYXJhbSB0b3RhbCBUaGUgdG90YWwgbnVtYmVyIG9mIGJ5dGVzIGluIHRoZSB1cGxvYWQuXHJcbiAqIEBwYXJhbSBvcHRfZmluYWxpemVkIFRydWUgaWYgdGhlIHNlcnZlciBoYXMgZmluaXNoZWQgdGhlIHVwbG9hZC5cclxuICogQHBhcmFtIG9wdF9tZXRhZGF0YSBUaGUgdXBsb2FkIG1ldGFkYXRhLCBzaG91bGRcclxuICogICAgIG9ubHkgYmUgcGFzc2VkIGlmIG9wdF9maW5hbGl6ZWQgaXMgdHJ1ZS5cclxuICovXHJcbmNsYXNzIFJlc3VtYWJsZVVwbG9hZFN0YXR1cyB7XHJcbiAgICBjb25zdHJ1Y3RvcihjdXJyZW50LCB0b3RhbCwgZmluYWxpemVkLCBtZXRhZGF0YSkge1xyXG4gICAgICAgIHRoaXMuY3VycmVudCA9IGN1cnJlbnQ7XHJcbiAgICAgICAgdGhpcy50b3RhbCA9IHRvdGFsO1xyXG4gICAgICAgIHRoaXMuZmluYWxpemVkID0gISFmaW5hbGl6ZWQ7XHJcbiAgICAgICAgdGhpcy5tZXRhZGF0YSA9IG1ldGFkYXRhIHx8IG51bGw7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gY2hlY2tSZXN1bWVIZWFkZXJfKHhociwgYWxsb3dlZCkge1xyXG4gICAgbGV0IHN0YXR1cyA9IG51bGw7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHN0YXR1cyA9IHhoci5nZXRSZXNwb25zZUhlYWRlcignWC1Hb29nLVVwbG9hZC1TdGF0dXMnKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgaGFuZGxlckNoZWNrKGZhbHNlKTtcclxuICAgIH1cclxuICAgIGNvbnN0IGFsbG93ZWRTdGF0dXMgPSBhbGxvd2VkIHx8IFsnYWN0aXZlJ107XHJcbiAgICBoYW5kbGVyQ2hlY2soISFzdGF0dXMgJiYgYWxsb3dlZFN0YXR1cy5pbmRleE9mKHN0YXR1cykgIT09IC0xKTtcclxuICAgIHJldHVybiBzdGF0dXM7XHJcbn1cclxuZnVuY3Rpb24gY3JlYXRlUmVzdW1hYmxlVXBsb2FkKHNlcnZpY2UsIGxvY2F0aW9uLCBtYXBwaW5ncywgYmxvYiwgbWV0YWRhdGEpIHtcclxuICAgIGNvbnN0IHVybFBhcnQgPSBsb2NhdGlvbi5idWNrZXRPbmx5U2VydmVyVXJsKCk7XHJcbiAgICBjb25zdCBtZXRhZGF0YUZvclVwbG9hZCA9IG1ldGFkYXRhRm9yVXBsb2FkXyhsb2NhdGlvbiwgYmxvYiwgbWV0YWRhdGEpO1xyXG4gICAgY29uc3QgdXJsUGFyYW1zID0geyBuYW1lOiBtZXRhZGF0YUZvclVwbG9hZFsnZnVsbFBhdGgnXSB9O1xyXG4gICAgY29uc3QgdXJsID0gbWFrZVVybCh1cmxQYXJ0LCBzZXJ2aWNlLmhvc3QpO1xyXG4gICAgY29uc3QgbWV0aG9kID0gJ1BPU1QnO1xyXG4gICAgY29uc3QgaGVhZGVycyA9IHtcclxuICAgICAgICAnWC1Hb29nLVVwbG9hZC1Qcm90b2NvbCc6ICdyZXN1bWFibGUnLFxyXG4gICAgICAgICdYLUdvb2ctVXBsb2FkLUNvbW1hbmQnOiAnc3RhcnQnLFxyXG4gICAgICAgICdYLUdvb2ctVXBsb2FkLUhlYWRlci1Db250ZW50LUxlbmd0aCc6IGAke2Jsb2Iuc2l6ZSgpfWAsXHJcbiAgICAgICAgJ1gtR29vZy1VcGxvYWQtSGVhZGVyLUNvbnRlbnQtVHlwZSc6IG1ldGFkYXRhRm9yVXBsb2FkWydjb250ZW50VHlwZSddLFxyXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD11dGYtOCdcclxuICAgIH07XHJcbiAgICBjb25zdCBib2R5ID0gdG9SZXNvdXJjZVN0cmluZyhtZXRhZGF0YUZvclVwbG9hZCwgbWFwcGluZ3MpO1xyXG4gICAgY29uc3QgdGltZW91dCA9IHNlcnZpY2UubWF4VXBsb2FkUmV0cnlUaW1lO1xyXG4gICAgZnVuY3Rpb24gaGFuZGxlcih4aHIpIHtcclxuICAgICAgICBjaGVja1Jlc3VtZUhlYWRlcl8oeGhyKTtcclxuICAgICAgICBsZXQgdXJsO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHVybCA9IHhoci5nZXRSZXNwb25zZUhlYWRlcignWC1Hb29nLVVwbG9hZC1VUkwnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgaGFuZGxlckNoZWNrKGZhbHNlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaGFuZGxlckNoZWNrKGlzU3RyaW5nKHVybCkpO1xyXG4gICAgICAgIHJldHVybiB1cmw7XHJcbiAgICB9XHJcbiAgICBjb25zdCByZXF1ZXN0SW5mbyA9IG5ldyBSZXF1ZXN0SW5mbyh1cmwsIG1ldGhvZCwgaGFuZGxlciwgdGltZW91dCk7XHJcbiAgICByZXF1ZXN0SW5mby51cmxQYXJhbXMgPSB1cmxQYXJhbXM7XHJcbiAgICByZXF1ZXN0SW5mby5oZWFkZXJzID0gaGVhZGVycztcclxuICAgIHJlcXVlc3RJbmZvLmJvZHkgPSBib2R5O1xyXG4gICAgcmVxdWVzdEluZm8uZXJyb3JIYW5kbGVyID0gc2hhcmVkRXJyb3JIYW5kbGVyKGxvY2F0aW9uKTtcclxuICAgIHJldHVybiByZXF1ZXN0SW5mbztcclxufVxyXG4vKipcclxuICogQHBhcmFtIHVybCBGcm9tIGEgY2FsbCB0byBmYnMucmVxdWVzdHMuY3JlYXRlUmVzdW1hYmxlVXBsb2FkLlxyXG4gKi9cclxuZnVuY3Rpb24gZ2V0UmVzdW1hYmxlVXBsb2FkU3RhdHVzKHNlcnZpY2UsIGxvY2F0aW9uLCB1cmwsIGJsb2IpIHtcclxuICAgIGNvbnN0IGhlYWRlcnMgPSB7ICdYLUdvb2ctVXBsb2FkLUNvbW1hbmQnOiAncXVlcnknIH07XHJcbiAgICBmdW5jdGlvbiBoYW5kbGVyKHhocikge1xyXG4gICAgICAgIGNvbnN0IHN0YXR1cyA9IGNoZWNrUmVzdW1lSGVhZGVyXyh4aHIsIFsnYWN0aXZlJywgJ2ZpbmFsJ10pO1xyXG4gICAgICAgIGxldCBzaXplU3RyaW5nID0gbnVsbDtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBzaXplU3RyaW5nID0geGhyLmdldFJlc3BvbnNlSGVhZGVyKCdYLUdvb2ctVXBsb2FkLVNpemUtUmVjZWl2ZWQnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgaGFuZGxlckNoZWNrKGZhbHNlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCFzaXplU3RyaW5nKSB7XHJcbiAgICAgICAgICAgIC8vIG51bGwgb3IgZW1wdHkgc3RyaW5nXHJcbiAgICAgICAgICAgIGhhbmRsZXJDaGVjayhmYWxzZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHNpemUgPSBOdW1iZXIoc2l6ZVN0cmluZyk7XHJcbiAgICAgICAgaGFuZGxlckNoZWNrKCFpc05hTihzaXplKSk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBSZXN1bWFibGVVcGxvYWRTdGF0dXMoc2l6ZSwgYmxvYi5zaXplKCksIHN0YXR1cyA9PT0gJ2ZpbmFsJyk7XHJcbiAgICB9XHJcbiAgICBjb25zdCBtZXRob2QgPSAnUE9TVCc7XHJcbiAgICBjb25zdCB0aW1lb3V0ID0gc2VydmljZS5tYXhVcGxvYWRSZXRyeVRpbWU7XHJcbiAgICBjb25zdCByZXF1ZXN0SW5mbyA9IG5ldyBSZXF1ZXN0SW5mbyh1cmwsIG1ldGhvZCwgaGFuZGxlciwgdGltZW91dCk7XHJcbiAgICByZXF1ZXN0SW5mby5oZWFkZXJzID0gaGVhZGVycztcclxuICAgIHJlcXVlc3RJbmZvLmVycm9ySGFuZGxlciA9IHNoYXJlZEVycm9ySGFuZGxlcihsb2NhdGlvbik7XHJcbiAgICByZXR1cm4gcmVxdWVzdEluZm87XHJcbn1cclxuLyoqXHJcbiAqIEFueSB1cGxvYWRzIHZpYSB0aGUgcmVzdW1hYmxlIHVwbG9hZCBBUEkgbXVzdCB0cmFuc2ZlciBhIG51bWJlciBvZiBieXRlc1xyXG4gKiB0aGF0IGlzIGEgbXVsdGlwbGUgb2YgdGhpcyBudW1iZXIuXHJcbiAqL1xyXG5jb25zdCBSRVNVTUFCTEVfVVBMT0FEX0NIVU5LX1NJWkUgPSAyNTYgKiAxMDI0O1xyXG4vKipcclxuICogQHBhcmFtIHVybCBGcm9tIGEgY2FsbCB0byBmYnMucmVxdWVzdHMuY3JlYXRlUmVzdW1hYmxlVXBsb2FkLlxyXG4gKiBAcGFyYW0gY2h1bmtTaXplIE51bWJlciBvZiBieXRlcyB0byB1cGxvYWQuXHJcbiAqIEBwYXJhbSBzdGF0dXMgVGhlIHByZXZpb3VzIHN0YXR1cy5cclxuICogICAgIElmIG5vdCBwYXNzZWQgb3IgbnVsbCwgd2Ugc3RhcnQgZnJvbSB0aGUgYmVnaW5uaW5nLlxyXG4gKiBAdGhyb3dzIGZicy5FcnJvciBJZiB0aGUgdXBsb2FkIGlzIGFscmVhZHkgY29tcGxldGUsIHRoZSBwYXNzZWQgaW4gc3RhdHVzXHJcbiAqICAgICBoYXMgYSBmaW5hbCBzaXplIGluY29uc2lzdGVudCB3aXRoIHRoZSBibG9iLCBvciB0aGUgYmxvYiBjYW5ub3QgYmUgc2xpY2VkXHJcbiAqICAgICBmb3IgdXBsb2FkLlxyXG4gKi9cclxuZnVuY3Rpb24gY29udGludWVSZXN1bWFibGVVcGxvYWQobG9jYXRpb24sIHNlcnZpY2UsIHVybCwgYmxvYiwgY2h1bmtTaXplLCBtYXBwaW5ncywgc3RhdHVzLCBwcm9ncmVzc0NhbGxiYWNrKSB7XHJcbiAgICAvLyBUT0RPKGFuZHlzb3RvKTogc3RhbmRhcmRpemUgb24gaW50ZXJuYWwgYXNzZXJ0c1xyXG4gICAgLy8gYXNzZXJ0KCEob3B0X3N0YXR1cyAmJiBvcHRfc3RhdHVzLmZpbmFsaXplZCkpO1xyXG4gICAgY29uc3Qgc3RhdHVzXyA9IG5ldyBSZXN1bWFibGVVcGxvYWRTdGF0dXMoMCwgMCk7XHJcbiAgICBpZiAoc3RhdHVzKSB7XHJcbiAgICAgICAgc3RhdHVzXy5jdXJyZW50ID0gc3RhdHVzLmN1cnJlbnQ7XHJcbiAgICAgICAgc3RhdHVzXy50b3RhbCA9IHN0YXR1cy50b3RhbDtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHN0YXR1c18uY3VycmVudCA9IDA7XHJcbiAgICAgICAgc3RhdHVzXy50b3RhbCA9IGJsb2Iuc2l6ZSgpO1xyXG4gICAgfVxyXG4gICAgaWYgKGJsb2Iuc2l6ZSgpICE9PSBzdGF0dXNfLnRvdGFsKSB7XHJcbiAgICAgICAgdGhyb3cgc2VydmVyRmlsZVdyb25nU2l6ZSgpO1xyXG4gICAgfVxyXG4gICAgY29uc3QgYnl0ZXNMZWZ0ID0gc3RhdHVzXy50b3RhbCAtIHN0YXR1c18uY3VycmVudDtcclxuICAgIGxldCBieXRlc1RvVXBsb2FkID0gYnl0ZXNMZWZ0O1xyXG4gICAgaWYgKGNodW5rU2l6ZSA+IDApIHtcclxuICAgICAgICBieXRlc1RvVXBsb2FkID0gTWF0aC5taW4oYnl0ZXNUb1VwbG9hZCwgY2h1bmtTaXplKTtcclxuICAgIH1cclxuICAgIGNvbnN0IHN0YXJ0Qnl0ZSA9IHN0YXR1c18uY3VycmVudDtcclxuICAgIGNvbnN0IGVuZEJ5dGUgPSBzdGFydEJ5dGUgKyBieXRlc1RvVXBsb2FkO1xyXG4gICAgY29uc3QgdXBsb2FkQ29tbWFuZCA9IGJ5dGVzVG9VcGxvYWQgPT09IGJ5dGVzTGVmdCA/ICd1cGxvYWQsIGZpbmFsaXplJyA6ICd1cGxvYWQnO1xyXG4gICAgY29uc3QgaGVhZGVycyA9IHtcclxuICAgICAgICAnWC1Hb29nLVVwbG9hZC1Db21tYW5kJzogdXBsb2FkQ29tbWFuZCxcclxuICAgICAgICAnWC1Hb29nLVVwbG9hZC1PZmZzZXQnOiBgJHtzdGF0dXNfLmN1cnJlbnR9YFxyXG4gICAgfTtcclxuICAgIGNvbnN0IGJvZHkgPSBibG9iLnNsaWNlKHN0YXJ0Qnl0ZSwgZW5kQnl0ZSk7XHJcbiAgICBpZiAoYm9keSA9PT0gbnVsbCkge1xyXG4gICAgICAgIHRocm93IGNhbm5vdFNsaWNlQmxvYigpO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gaGFuZGxlcih4aHIsIHRleHQpIHtcclxuICAgICAgICAvLyBUT0RPKGFuZHlzb3RvKTogVmVyaWZ5IHRoZSBNRDUgb2YgZWFjaCB1cGxvYWRlZCByYW5nZTpcclxuICAgICAgICAvLyB0aGUgJ3gtcmFuZ2UtbWQ1JyBoZWFkZXIgY29tZXMgYmFjayB3aXRoIHN0YXR1cyBjb2RlIDMwOCByZXNwb25zZXMuXHJcbiAgICAgICAgLy8gV2UnbGwgb25seSBiZSBhYmxlIHRvIGJhaWwgb3V0IHRob3VnaCwgYmVjYXVzZSB5b3UgY2FuJ3QgcmUtdXBsb2FkIGFcclxuICAgICAgICAvLyByYW5nZSB0aGF0IHlvdSBwcmV2aW91c2x5IHVwbG9hZGVkLlxyXG4gICAgICAgIGNvbnN0IHVwbG9hZFN0YXR1cyA9IGNoZWNrUmVzdW1lSGVhZGVyXyh4aHIsIFsnYWN0aXZlJywgJ2ZpbmFsJ10pO1xyXG4gICAgICAgIGNvbnN0IG5ld0N1cnJlbnQgPSBzdGF0dXNfLmN1cnJlbnQgKyBieXRlc1RvVXBsb2FkO1xyXG4gICAgICAgIGNvbnN0IHNpemUgPSBibG9iLnNpemUoKTtcclxuICAgICAgICBsZXQgbWV0YWRhdGE7XHJcbiAgICAgICAgaWYgKHVwbG9hZFN0YXR1cyA9PT0gJ2ZpbmFsJykge1xyXG4gICAgICAgICAgICBtZXRhZGF0YSA9IG1ldGFkYXRhSGFuZGxlcihzZXJ2aWNlLCBtYXBwaW5ncykoeGhyLCB0ZXh0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIG1ldGFkYXRhID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5ldyBSZXN1bWFibGVVcGxvYWRTdGF0dXMobmV3Q3VycmVudCwgc2l6ZSwgdXBsb2FkU3RhdHVzID09PSAnZmluYWwnLCBtZXRhZGF0YSk7XHJcbiAgICB9XHJcbiAgICBjb25zdCBtZXRob2QgPSAnUE9TVCc7XHJcbiAgICBjb25zdCB0aW1lb3V0ID0gc2VydmljZS5tYXhVcGxvYWRSZXRyeVRpbWU7XHJcbiAgICBjb25zdCByZXF1ZXN0SW5mbyA9IG5ldyBSZXF1ZXN0SW5mbyh1cmwsIG1ldGhvZCwgaGFuZGxlciwgdGltZW91dCk7XHJcbiAgICByZXF1ZXN0SW5mby5oZWFkZXJzID0gaGVhZGVycztcclxuICAgIHJlcXVlc3RJbmZvLmJvZHkgPSBib2R5LnVwbG9hZERhdGEoKTtcclxuICAgIHJlcXVlc3RJbmZvLnByb2dyZXNzQ2FsbGJhY2sgPSBwcm9ncmVzc0NhbGxiYWNrIHx8IG51bGw7XHJcbiAgICByZXF1ZXN0SW5mby5lcnJvckhhbmRsZXIgPSBzaGFyZWRFcnJvckhhbmRsZXIobG9jYXRpb24pO1xyXG4gICAgcmV0dXJuIHJlcXVlc3RJbmZvO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBBbiBldmVudCB0aGF0IGlzIHRyaWdnZXJlZCBvbiBhIHRhc2suXHJcbiAqIEBpbnRlcm5hbFxyXG4gKi9cclxuY29uc3QgVGFza0V2ZW50ID0ge1xyXG4gICAgLyoqXHJcbiAgICAgKiBGb3IgdGhpcyBldmVudCxcclxuICAgICAqIDx1bD5cclxuICAgICAqICAgPGxpPlRoZSBgbmV4dGAgZnVuY3Rpb24gaXMgdHJpZ2dlcmVkIG9uIHByb2dyZXNzIHVwZGF0ZXMgYW5kIHdoZW4gdGhlXHJcbiAgICAgKiAgICAgICB0YXNrIGlzIHBhdXNlZC9yZXN1bWVkIHdpdGggYW4gYFVwbG9hZFRhc2tTbmFwc2hvdGAgYXMgdGhlIGZpcnN0XHJcbiAgICAgKiAgICAgICBhcmd1bWVudC48L2xpPlxyXG4gICAgICogICA8bGk+VGhlIGBlcnJvcmAgZnVuY3Rpb24gaXMgdHJpZ2dlcmVkIGlmIHRoZSB1cGxvYWQgaXMgY2FuY2VsZWQgb3IgZmFpbHNcclxuICAgICAqICAgICAgIGZvciBhbm90aGVyIHJlYXNvbi48L2xpPlxyXG4gICAgICogICA8bGk+VGhlIGBjb21wbGV0ZWAgZnVuY3Rpb24gaXMgdHJpZ2dlcmVkIGlmIHRoZSB1cGxvYWQgY29tcGxldGVzXHJcbiAgICAgKiAgICAgICBzdWNjZXNzZnVsbHkuPC9saT5cclxuICAgICAqIDwvdWw+XHJcbiAgICAgKi9cclxuICAgIFNUQVRFX0NIQU5HRUQ6ICdzdGF0ZV9jaGFuZ2VkJ1xyXG59O1xyXG4vLyB0eXBlIGtleXMgPSBrZXlvZiBUYXNrU3RhdGVcclxuLyoqXHJcbiAqIFJlcHJlc2VudHMgdGhlIGN1cnJlbnQgc3RhdGUgb2YgYSBydW5uaW5nIHVwbG9hZC5cclxuICogQGludGVybmFsXHJcbiAqL1xyXG5jb25zdCBUYXNrU3RhdGUgPSB7XHJcbiAgICAvKiogVGhlIHRhc2sgaXMgY3VycmVudGx5IHRyYW5zZmVycmluZyBkYXRhLiAqL1xyXG4gICAgUlVOTklORzogJ3J1bm5pbmcnLFxyXG4gICAgLyoqIFRoZSB0YXNrIHdhcyBwYXVzZWQgYnkgdGhlIHVzZXIuICovXHJcbiAgICBQQVVTRUQ6ICdwYXVzZWQnLFxyXG4gICAgLyoqIFRoZSB0YXNrIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuICovXHJcbiAgICBTVUNDRVNTOiAnc3VjY2VzcycsXHJcbiAgICAvKiogVGhlIHRhc2sgd2FzIGNhbmNlbGVkLiAqL1xyXG4gICAgQ0FOQ0VMRUQ6ICdjYW5jZWxlZCcsXHJcbiAgICAvKiogVGhlIHRhc2sgZmFpbGVkIHdpdGggYW4gZXJyb3IuICovXHJcbiAgICBFUlJPUjogJ2Vycm9yJ1xyXG59O1xyXG5mdW5jdGlvbiB0YXNrU3RhdGVGcm9tSW50ZXJuYWxUYXNrU3RhdGUoc3RhdGUpIHtcclxuICAgIHN3aXRjaCAoc3RhdGUpIHtcclxuICAgICAgICBjYXNlIFwicnVubmluZ1wiIC8qIFJVTk5JTkcgKi86XHJcbiAgICAgICAgY2FzZSBcInBhdXNpbmdcIiAvKiBQQVVTSU5HICovOlxyXG4gICAgICAgIGNhc2UgXCJjYW5jZWxpbmdcIiAvKiBDQU5DRUxJTkcgKi86XHJcbiAgICAgICAgICAgIHJldHVybiBUYXNrU3RhdGUuUlVOTklORztcclxuICAgICAgICBjYXNlIFwicGF1c2VkXCIgLyogUEFVU0VEICovOlxyXG4gICAgICAgICAgICByZXR1cm4gVGFza1N0YXRlLlBBVVNFRDtcclxuICAgICAgICBjYXNlIFwic3VjY2Vzc1wiIC8qIFNVQ0NFU1MgKi86XHJcbiAgICAgICAgICAgIHJldHVybiBUYXNrU3RhdGUuU1VDQ0VTUztcclxuICAgICAgICBjYXNlIFwiY2FuY2VsZWRcIiAvKiBDQU5DRUxFRCAqLzpcclxuICAgICAgICAgICAgcmV0dXJuIFRhc2tTdGF0ZS5DQU5DRUxFRDtcclxuICAgICAgICBjYXNlIFwiZXJyb3JcIiAvKiBFUlJPUiAqLzpcclxuICAgICAgICAgICAgcmV0dXJuIFRhc2tTdGF0ZS5FUlJPUjtcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAvLyBUT0RPKGFuZHlzb3RvKTogYXNzZXJ0KGZhbHNlKTtcclxuICAgICAgICAgICAgcmV0dXJuIFRhc2tTdGF0ZS5FUlJPUjtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jbGFzcyBPYnNlcnZlciB7XHJcbiAgICBjb25zdHJ1Y3RvcihuZXh0T3JPYnNlcnZlciwgZXJyb3IsIGNvbXBsZXRlKSB7XHJcbiAgICAgICAgY29uc3QgYXNGdW5jdGlvbnMgPSBpc0Z1bmN0aW9uKG5leHRPck9ic2VydmVyKSB8fCBlcnJvciAhPSBudWxsIHx8IGNvbXBsZXRlICE9IG51bGw7XHJcbiAgICAgICAgaWYgKGFzRnVuY3Rpb25zKSB7XHJcbiAgICAgICAgICAgIHRoaXMubmV4dCA9IG5leHRPck9ic2VydmVyO1xyXG4gICAgICAgICAgICB0aGlzLmVycm9yID0gZXJyb3IgIT09IG51bGwgJiYgZXJyb3IgIT09IHZvaWQgMCA/IGVycm9yIDogdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICB0aGlzLmNvbXBsZXRlID0gY29tcGxldGUgIT09IG51bGwgJiYgY29tcGxldGUgIT09IHZvaWQgMCA/IGNvbXBsZXRlIDogdW5kZWZpbmVkO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY29uc3Qgb2JzZXJ2ZXIgPSBuZXh0T3JPYnNlcnZlcjtcclxuICAgICAgICAgICAgdGhpcy5uZXh0ID0gb2JzZXJ2ZXIubmV4dDtcclxuICAgICAgICAgICAgdGhpcy5lcnJvciA9IG9ic2VydmVyLmVycm9yO1xyXG4gICAgICAgICAgICB0aGlzLmNvbXBsZXRlID0gb2JzZXJ2ZXIuY29tcGxldGU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBSZXR1cm5zIGEgZnVuY3Rpb24gdGhhdCBpbnZva2VzIGYgd2l0aCBpdHMgYXJndW1lbnRzIGFzeW5jaHJvbm91c2x5IGFzIGFcclxuICogbWljcm90YXNrLCBpLmUuIGFzIHNvb24gYXMgcG9zc2libGUgYWZ0ZXIgdGhlIGN1cnJlbnQgc2NyaXB0IHJldHVybnMgYmFja1xyXG4gKiBpbnRvIGJyb3dzZXIgY29kZS5cclxuICovXHJcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvYmFuLXR5cGVzXHJcbmZ1bmN0aW9uIGFzeW5jKGYpIHtcclxuICAgIHJldHVybiAoLi4uYXJnc1RvRm9yd2FyZCkgPT4ge1xyXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZmxvYXRpbmctcHJvbWlzZXNcclxuICAgICAgICBQcm9taXNlLnJlc29sdmUoKS50aGVuKCgpID0+IGYoLi4uYXJnc1RvRm9yd2FyZCkpO1xyXG4gICAgfTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogUmVwcmVzZW50cyBhIGJsb2IgYmVpbmcgdXBsb2FkZWQuIENhbiBiZSB1c2VkIHRvIHBhdXNlL3Jlc3VtZS9jYW5jZWwgdGhlXHJcbiAqIHVwbG9hZCBhbmQgbWFuYWdlIGNhbGxiYWNrcyBmb3IgdmFyaW91cyBldmVudHMuXHJcbiAqIEBpbnRlcm5hbFxyXG4gKi9cclxuY2xhc3MgVXBsb2FkVGFzayB7XHJcbiAgICAvKipcclxuICAgICAqIEBwYXJhbSByZWYgLSBUaGUgZmlyZWJhc2VTdG9yYWdlLlJlZmVyZW5jZSBvYmplY3QgdGhpcyB0YXNrIGNhbWVcclxuICAgICAqICAgICBmcm9tLCB1bnR5cGVkIHRvIGF2b2lkIGN5Y2xpYyBkZXBlbmRlbmNpZXMuXHJcbiAgICAgKiBAcGFyYW0gYmxvYiAtIFRoZSBibG9iIHRvIHVwbG9hZC5cclxuICAgICAqL1xyXG4gICAgY29uc3RydWN0b3IocmVmLCBibG9iLCBtZXRhZGF0YSA9IG51bGwpIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBOdW1iZXIgb2YgYnl0ZXMgdHJhbnNmZXJyZWQgc28gZmFyLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuX3RyYW5zZmVycmVkID0gMDtcclxuICAgICAgICB0aGlzLl9uZWVkVG9GZXRjaFN0YXR1cyA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX25lZWRUb0ZldGNoTWV0YWRhdGEgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9vYnNlcnZlcnMgPSBbXTtcclxuICAgICAgICB0aGlzLl9lcnJvciA9IHVuZGVmaW5lZDtcclxuICAgICAgICB0aGlzLl91cGxvYWRVcmwgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgdGhpcy5fcmVxdWVzdCA9IHVuZGVmaW5lZDtcclxuICAgICAgICB0aGlzLl9jaHVua011bHRpcGxpZXIgPSAxO1xyXG4gICAgICAgIHRoaXMuX3Jlc29sdmUgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgdGhpcy5fcmVqZWN0ID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIHRoaXMuX3JlZiA9IHJlZjtcclxuICAgICAgICB0aGlzLl9ibG9iID0gYmxvYjtcclxuICAgICAgICB0aGlzLl9tZXRhZGF0YSA9IG1ldGFkYXRhO1xyXG4gICAgICAgIHRoaXMuX21hcHBpbmdzID0gZ2V0TWFwcGluZ3MoKTtcclxuICAgICAgICB0aGlzLl9yZXN1bWFibGUgPSB0aGlzLl9zaG91bGREb1Jlc3VtYWJsZSh0aGlzLl9ibG9iKTtcclxuICAgICAgICB0aGlzLl9zdGF0ZSA9IFwicnVubmluZ1wiIC8qIFJVTk5JTkcgKi87XHJcbiAgICAgICAgdGhpcy5fZXJyb3JIYW5kbGVyID0gZXJyb3IgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9yZXF1ZXN0ID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICB0aGlzLl9jaHVua011bHRpcGxpZXIgPSAxO1xyXG4gICAgICAgICAgICBpZiAoZXJyb3IuX2NvZGVFcXVhbHMoXCJjYW5jZWxlZFwiIC8qIENBTkNFTEVEICovKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbmVlZFRvRmV0Y2hTdGF0dXMgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb21wbGV0ZVRyYW5zaXRpb25zXygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZXJyb3IgPSBlcnJvcjtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3RyYW5zaXRpb24oXCJlcnJvclwiIC8qIEVSUk9SICovKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5fbWV0YWRhdGFFcnJvckhhbmRsZXIgPSBlcnJvciA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX3JlcXVlc3QgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIGlmIChlcnJvci5fY29kZUVxdWFscyhcImNhbmNlbGVkXCIgLyogQ0FOQ0VMRUQgKi8pKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbXBsZXRlVHJhbnNpdGlvbnNfKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9lcnJvciA9IGVycm9yO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdHJhbnNpdGlvbihcImVycm9yXCIgLyogRVJST1IgKi8pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLl9wcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9yZXNvbHZlID0gcmVzb2x2ZTtcclxuICAgICAgICAgICAgdGhpcy5fcmVqZWN0ID0gcmVqZWN0O1xyXG4gICAgICAgICAgICB0aGlzLl9zdGFydCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vIFByZXZlbnQgdW5jYXVnaHQgcmVqZWN0aW9ucyBvbiB0aGUgaW50ZXJuYWwgcHJvbWlzZSBmcm9tIGJ1YmJsaW5nIG91dFxyXG4gICAgICAgIC8vIHRvIHRoZSB0b3AgbGV2ZWwgd2l0aCBhIGR1bW15IGhhbmRsZXIuXHJcbiAgICAgICAgdGhpcy5fcHJvbWlzZS50aGVuKG51bGwsICgpID0+IHsgfSk7XHJcbiAgICB9XHJcbiAgICBfbWFrZVByb2dyZXNzQ2FsbGJhY2soKSB7XHJcbiAgICAgICAgY29uc3Qgc2l6ZUJlZm9yZSA9IHRoaXMuX3RyYW5zZmVycmVkO1xyXG4gICAgICAgIHJldHVybiBsb2FkZWQgPT4gdGhpcy5fdXBkYXRlUHJvZ3Jlc3Moc2l6ZUJlZm9yZSArIGxvYWRlZCk7XHJcbiAgICB9XHJcbiAgICBfc2hvdWxkRG9SZXN1bWFibGUoYmxvYikge1xyXG4gICAgICAgIHJldHVybiBibG9iLnNpemUoKSA+IDI1NiAqIDEwMjQ7XHJcbiAgICB9XHJcbiAgICBfc3RhcnQoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX3N0YXRlICE9PSBcInJ1bm5pbmdcIiAvKiBSVU5OSU5HICovKSB7XHJcbiAgICAgICAgICAgIC8vIFRoaXMgY2FuIGhhcHBlbiBpZiBzb21lb25lIHBhdXNlcyB1cyBpbiBhIHJlc3VtZSBjYWxsYmFjaywgZm9yIGV4YW1wbGUuXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuX3JlcXVlc3QgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLl9yZXN1bWFibGUpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX3VwbG9hZFVybCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jcmVhdGVSZXN1bWFibGUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9uZWVkVG9GZXRjaFN0YXR1cykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2ZldGNoU3RhdHVzKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fbmVlZFRvRmV0Y2hNZXRhZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBIYXBwZW5zIGlmIHdlIG1pc3MgdGhlIG1ldGFkYXRhIG9uIHVwbG9hZCBjb21wbGV0aW9uLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9mZXRjaE1ldGFkYXRhKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb250aW51ZVVwbG9hZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fb25lU2hvdFVwbG9hZCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIF9yZXNvbHZlVG9rZW4oY2FsbGJhY2spIHtcclxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWZsb2F0aW5nLXByb21pc2VzXHJcbiAgICAgICAgUHJvbWlzZS5hbGwoW1xyXG4gICAgICAgICAgICB0aGlzLl9yZWYuc3RvcmFnZS5fZ2V0QXV0aFRva2VuKCksXHJcbiAgICAgICAgICAgIHRoaXMuX3JlZi5zdG9yYWdlLl9nZXRBcHBDaGVja1Rva2VuKClcclxuICAgICAgICBdKS50aGVuKChbYXV0aFRva2VuLCBhcHBDaGVja1Rva2VuXSkgPT4ge1xyXG4gICAgICAgICAgICBzd2l0Y2ggKHRoaXMuX3N0YXRlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwicnVubmluZ1wiIC8qIFJVTk5JTkcgKi86XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soYXV0aFRva2VuLCBhcHBDaGVja1Rva2VuKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJjYW5jZWxpbmdcIiAvKiBDQU5DRUxJTkcgKi86XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdHJhbnNpdGlvbihcImNhbmNlbGVkXCIgLyogQ0FOQ0VMRUQgKi8pO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBcInBhdXNpbmdcIiAvKiBQQVVTSU5HICovOlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3RyYW5zaXRpb24oXCJwYXVzZWRcIiAvKiBQQVVTRUQgKi8pO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICAvLyBUT0RPKGFuZHlzb3RvKTogYXNzZXJ0IGZhbHNlXHJcbiAgICBfY3JlYXRlUmVzdW1hYmxlKCkge1xyXG4gICAgICAgIHRoaXMuX3Jlc29sdmVUb2tlbigoYXV0aFRva2VuLCBhcHBDaGVja1Rva2VuKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3RJbmZvID0gY3JlYXRlUmVzdW1hYmxlVXBsb2FkKHRoaXMuX3JlZi5zdG9yYWdlLCB0aGlzLl9yZWYuX2xvY2F0aW9uLCB0aGlzLl9tYXBwaW5ncywgdGhpcy5fYmxvYiwgdGhpcy5fbWV0YWRhdGEpO1xyXG4gICAgICAgICAgICBjb25zdCBjcmVhdGVSZXF1ZXN0ID0gdGhpcy5fcmVmLnN0b3JhZ2UuX21ha2VSZXF1ZXN0KHJlcXVlc3RJbmZvLCBhdXRoVG9rZW4sIGFwcENoZWNrVG9rZW4pO1xyXG4gICAgICAgICAgICB0aGlzLl9yZXF1ZXN0ID0gY3JlYXRlUmVxdWVzdDtcclxuICAgICAgICAgICAgY3JlYXRlUmVxdWVzdC5nZXRQcm9taXNlKCkudGhlbigodXJsKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yZXF1ZXN0ID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdXBsb2FkVXJsID0gdXJsO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbmVlZFRvRmV0Y2hTdGF0dXMgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29tcGxldGVUcmFuc2l0aW9uc18oKTtcclxuICAgICAgICAgICAgfSwgdGhpcy5fZXJyb3JIYW5kbGVyKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIF9mZXRjaFN0YXR1cygpIHtcclxuICAgICAgICAvLyBUT0RPKGFuZHlzb3RvKTogYXNzZXJ0KHRoaXMudXBsb2FkVXJsXyAhPT0gbnVsbCk7XHJcbiAgICAgICAgY29uc3QgdXJsID0gdGhpcy5fdXBsb2FkVXJsO1xyXG4gICAgICAgIHRoaXMuX3Jlc29sdmVUb2tlbigoYXV0aFRva2VuLCBhcHBDaGVja1Rva2VuKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3RJbmZvID0gZ2V0UmVzdW1hYmxlVXBsb2FkU3RhdHVzKHRoaXMuX3JlZi5zdG9yYWdlLCB0aGlzLl9yZWYuX2xvY2F0aW9uLCB1cmwsIHRoaXMuX2Jsb2IpO1xyXG4gICAgICAgICAgICBjb25zdCBzdGF0dXNSZXF1ZXN0ID0gdGhpcy5fcmVmLnN0b3JhZ2UuX21ha2VSZXF1ZXN0KHJlcXVlc3RJbmZvLCBhdXRoVG9rZW4sIGFwcENoZWNrVG9rZW4pO1xyXG4gICAgICAgICAgICB0aGlzLl9yZXF1ZXN0ID0gc3RhdHVzUmVxdWVzdDtcclxuICAgICAgICAgICAgc3RhdHVzUmVxdWVzdC5nZXRQcm9taXNlKCkudGhlbihzdGF0dXMgPT4ge1xyXG4gICAgICAgICAgICAgICAgc3RhdHVzID0gc3RhdHVzO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVxdWVzdCA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3VwZGF0ZVByb2dyZXNzKHN0YXR1cy5jdXJyZW50KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX25lZWRUb0ZldGNoU3RhdHVzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBpZiAoc3RhdHVzLmZpbmFsaXplZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX25lZWRUb0ZldGNoTWV0YWRhdGEgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5jb21wbGV0ZVRyYW5zaXRpb25zXygpO1xyXG4gICAgICAgICAgICB9LCB0aGlzLl9lcnJvckhhbmRsZXIpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgX2NvbnRpbnVlVXBsb2FkKCkge1xyXG4gICAgICAgIGNvbnN0IGNodW5rU2l6ZSA9IFJFU1VNQUJMRV9VUExPQURfQ0hVTktfU0laRSAqIHRoaXMuX2NodW5rTXVsdGlwbGllcjtcclxuICAgICAgICBjb25zdCBzdGF0dXMgPSBuZXcgUmVzdW1hYmxlVXBsb2FkU3RhdHVzKHRoaXMuX3RyYW5zZmVycmVkLCB0aGlzLl9ibG9iLnNpemUoKSk7XHJcbiAgICAgICAgLy8gVE9ETyhhbmR5c290byk6IGFzc2VydCh0aGlzLnVwbG9hZFVybF8gIT09IG51bGwpO1xyXG4gICAgICAgIGNvbnN0IHVybCA9IHRoaXMuX3VwbG9hZFVybDtcclxuICAgICAgICB0aGlzLl9yZXNvbHZlVG9rZW4oKGF1dGhUb2tlbiwgYXBwQ2hlY2tUb2tlbikgPT4ge1xyXG4gICAgICAgICAgICBsZXQgcmVxdWVzdEluZm87XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICByZXF1ZXN0SW5mbyA9IGNvbnRpbnVlUmVzdW1hYmxlVXBsb2FkKHRoaXMuX3JlZi5fbG9jYXRpb24sIHRoaXMuX3JlZi5zdG9yYWdlLCB1cmwsIHRoaXMuX2Jsb2IsIGNodW5rU2l6ZSwgdGhpcy5fbWFwcGluZ3MsIHN0YXR1cywgdGhpcy5fbWFrZVByb2dyZXNzQ2FsbGJhY2soKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2Vycm9yID0gZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3RyYW5zaXRpb24oXCJlcnJvclwiIC8qIEVSUk9SICovKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCB1cGxvYWRSZXF1ZXN0ID0gdGhpcy5fcmVmLnN0b3JhZ2UuX21ha2VSZXF1ZXN0KHJlcXVlc3RJbmZvLCBhdXRoVG9rZW4sIGFwcENoZWNrVG9rZW4pO1xyXG4gICAgICAgICAgICB0aGlzLl9yZXF1ZXN0ID0gdXBsb2FkUmVxdWVzdDtcclxuICAgICAgICAgICAgdXBsb2FkUmVxdWVzdC5nZXRQcm9taXNlKCkudGhlbigobmV3U3RhdHVzKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9pbmNyZWFzZU11bHRpcGxpZXIoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3JlcXVlc3QgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGVQcm9ncmVzcyhuZXdTdGF0dXMuY3VycmVudCk7XHJcbiAgICAgICAgICAgICAgICBpZiAobmV3U3RhdHVzLmZpbmFsaXplZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX21ldGFkYXRhID0gbmV3U3RhdHVzLm1ldGFkYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3RyYW5zaXRpb24oXCJzdWNjZXNzXCIgLyogU1VDQ0VTUyAqLyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbXBsZXRlVHJhbnNpdGlvbnNfKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIHRoaXMuX2Vycm9ySGFuZGxlcik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBfaW5jcmVhc2VNdWx0aXBsaWVyKCkge1xyXG4gICAgICAgIGNvbnN0IGN1cnJlbnRTaXplID0gUkVTVU1BQkxFX1VQTE9BRF9DSFVOS19TSVpFICogdGhpcy5fY2h1bmtNdWx0aXBsaWVyO1xyXG4gICAgICAgIC8vIE1heCBjaHVuayBzaXplIGlzIDMyTS5cclxuICAgICAgICBpZiAoY3VycmVudFNpemUgPCAzMiAqIDEwMjQgKiAxMDI0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2NodW5rTXVsdGlwbGllciAqPSAyO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIF9mZXRjaE1ldGFkYXRhKCkge1xyXG4gICAgICAgIHRoaXMuX3Jlc29sdmVUb2tlbigoYXV0aFRva2VuLCBhcHBDaGVja1Rva2VuKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3RJbmZvID0gZ2V0TWV0YWRhdGEkMih0aGlzLl9yZWYuc3RvcmFnZSwgdGhpcy5fcmVmLl9sb2NhdGlvbiwgdGhpcy5fbWFwcGluZ3MpO1xyXG4gICAgICAgICAgICBjb25zdCBtZXRhZGF0YVJlcXVlc3QgPSB0aGlzLl9yZWYuc3RvcmFnZS5fbWFrZVJlcXVlc3QocmVxdWVzdEluZm8sIGF1dGhUb2tlbiwgYXBwQ2hlY2tUb2tlbik7XHJcbiAgICAgICAgICAgIHRoaXMuX3JlcXVlc3QgPSBtZXRhZGF0YVJlcXVlc3Q7XHJcbiAgICAgICAgICAgIG1ldGFkYXRhUmVxdWVzdC5nZXRQcm9taXNlKCkudGhlbihtZXRhZGF0YSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yZXF1ZXN0ID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbWV0YWRhdGEgPSBtZXRhZGF0YTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3RyYW5zaXRpb24oXCJzdWNjZXNzXCIgLyogU1VDQ0VTUyAqLyk7XHJcbiAgICAgICAgICAgIH0sIHRoaXMuX21ldGFkYXRhRXJyb3JIYW5kbGVyKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIF9vbmVTaG90VXBsb2FkKCkge1xyXG4gICAgICAgIHRoaXMuX3Jlc29sdmVUb2tlbigoYXV0aFRva2VuLCBhcHBDaGVja1Rva2VuKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3RJbmZvID0gbXVsdGlwYXJ0VXBsb2FkKHRoaXMuX3JlZi5zdG9yYWdlLCB0aGlzLl9yZWYuX2xvY2F0aW9uLCB0aGlzLl9tYXBwaW5ncywgdGhpcy5fYmxvYiwgdGhpcy5fbWV0YWRhdGEpO1xyXG4gICAgICAgICAgICBjb25zdCBtdWx0aXBhcnRSZXF1ZXN0ID0gdGhpcy5fcmVmLnN0b3JhZ2UuX21ha2VSZXF1ZXN0KHJlcXVlc3RJbmZvLCBhdXRoVG9rZW4sIGFwcENoZWNrVG9rZW4pO1xyXG4gICAgICAgICAgICB0aGlzLl9yZXF1ZXN0ID0gbXVsdGlwYXJ0UmVxdWVzdDtcclxuICAgICAgICAgICAgbXVsdGlwYXJ0UmVxdWVzdC5nZXRQcm9taXNlKCkudGhlbihtZXRhZGF0YSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yZXF1ZXN0ID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbWV0YWRhdGEgPSBtZXRhZGF0YTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3VwZGF0ZVByb2dyZXNzKHRoaXMuX2Jsb2Iuc2l6ZSgpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3RyYW5zaXRpb24oXCJzdWNjZXNzXCIgLyogU1VDQ0VTUyAqLyk7XHJcbiAgICAgICAgICAgIH0sIHRoaXMuX2Vycm9ySGFuZGxlcik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBfdXBkYXRlUHJvZ3Jlc3ModHJhbnNmZXJyZWQpIHtcclxuICAgICAgICBjb25zdCBvbGQgPSB0aGlzLl90cmFuc2ZlcnJlZDtcclxuICAgICAgICB0aGlzLl90cmFuc2ZlcnJlZCA9IHRyYW5zZmVycmVkO1xyXG4gICAgICAgIC8vIEEgcHJvZ3Jlc3MgdXBkYXRlIGNhbiBtYWtlIHRoZSBcInRyYW5zZmVycmVkXCIgdmFsdWUgc21hbGxlciAoZS5nLiBhXHJcbiAgICAgICAgLy8gcGFydGlhbCB1cGxvYWQgbm90IGNvbXBsZXRlZCBieSBzZXJ2ZXIsIGFmdGVyIHdoaWNoIHRoZSBcInRyYW5zZmVycmVkXCJcclxuICAgICAgICAvLyB2YWx1ZSBtYXkgcmVzZXQgdG8gdGhlIHZhbHVlIGF0IHRoZSBiZWdpbm5pbmcgb2YgdGhlIHJlcXVlc3QpLlxyXG4gICAgICAgIGlmICh0aGlzLl90cmFuc2ZlcnJlZCAhPT0gb2xkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX25vdGlmeU9ic2VydmVycygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIF90cmFuc2l0aW9uKHN0YXRlKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX3N0YXRlID09PSBzdGF0ZSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHN3aXRjaCAoc3RhdGUpIHtcclxuICAgICAgICAgICAgY2FzZSBcImNhbmNlbGluZ1wiIC8qIENBTkNFTElORyAqLzpcclxuICAgICAgICAgICAgICAgIC8vIFRPRE8oYW5keXNvdG8pOlxyXG4gICAgICAgICAgICAgICAgLy8gYXNzZXJ0KHRoaXMuc3RhdGVfID09PSBJbnRlcm5hbFRhc2tTdGF0ZS5SVU5OSU5HIHx8XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgdGhpcy5zdGF0ZV8gPT09IEludGVybmFsVGFza1N0YXRlLlBBVVNJTkcpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc3RhdGUgPSBzdGF0ZTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9yZXF1ZXN0ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZXF1ZXN0LmNhbmNlbCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgXCJwYXVzaW5nXCIgLyogUEFVU0lORyAqLzpcclxuICAgICAgICAgICAgICAgIC8vIFRPRE8oYW5keXNvdG8pOlxyXG4gICAgICAgICAgICAgICAgLy8gYXNzZXJ0KHRoaXMuc3RhdGVfID09PSBJbnRlcm5hbFRhc2tTdGF0ZS5SVU5OSU5HKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3N0YXRlID0gc3RhdGU7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fcmVxdWVzdCAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVxdWVzdC5jYW5jZWwoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwicnVubmluZ1wiIC8qIFJVTk5JTkcgKi86XHJcbiAgICAgICAgICAgICAgICAvLyBUT0RPKGFuZHlzb3RvKTpcclxuICAgICAgICAgICAgICAgIC8vIGFzc2VydCh0aGlzLnN0YXRlXyA9PT0gSW50ZXJuYWxUYXNrU3RhdGUuUEFVU0VEIHx8XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgdGhpcy5zdGF0ZV8gPT09IEludGVybmFsVGFza1N0YXRlLlBBVVNJTkcpO1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgd2FzUGF1c2VkID0gdGhpcy5fc3RhdGUgPT09IFwicGF1c2VkXCIgLyogUEFVU0VEICovO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc3RhdGUgPSBzdGF0ZTtcclxuICAgICAgICAgICAgICAgIGlmICh3YXNQYXVzZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9ub3RpZnlPYnNlcnZlcnMoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGFydCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgXCJwYXVzZWRcIiAvKiBQQVVTRUQgKi86XHJcbiAgICAgICAgICAgICAgICAvLyBUT0RPKGFuZHlzb3RvKTpcclxuICAgICAgICAgICAgICAgIC8vIGFzc2VydCh0aGlzLnN0YXRlXyA9PT0gSW50ZXJuYWxUYXNrU3RhdGUuUEFVU0lORyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zdGF0ZSA9IHN0YXRlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbm90aWZ5T2JzZXJ2ZXJzKCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBcImNhbmNlbGVkXCIgLyogQ0FOQ0VMRUQgKi86XHJcbiAgICAgICAgICAgICAgICAvLyBUT0RPKGFuZHlzb3RvKTpcclxuICAgICAgICAgICAgICAgIC8vIGFzc2VydCh0aGlzLnN0YXRlXyA9PT0gSW50ZXJuYWxUYXNrU3RhdGUuUEFVU0VEIHx8XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgdGhpcy5zdGF0ZV8gPT09IEludGVybmFsVGFza1N0YXRlLkNBTkNFTElORyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9lcnJvciA9IGNhbmNlbGVkKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zdGF0ZSA9IHN0YXRlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbm90aWZ5T2JzZXJ2ZXJzKCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBcImVycm9yXCIgLyogRVJST1IgKi86XHJcbiAgICAgICAgICAgICAgICAvLyBUT0RPKGFuZHlzb3RvKTpcclxuICAgICAgICAgICAgICAgIC8vIGFzc2VydCh0aGlzLnN0YXRlXyA9PT0gSW50ZXJuYWxUYXNrU3RhdGUuUlVOTklORyB8fFxyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgIHRoaXMuc3RhdGVfID09PSBJbnRlcm5hbFRhc2tTdGF0ZS5QQVVTSU5HIHx8XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgdGhpcy5zdGF0ZV8gPT09IEludGVybmFsVGFza1N0YXRlLkNBTkNFTElORyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zdGF0ZSA9IHN0YXRlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbm90aWZ5T2JzZXJ2ZXJzKCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBcInN1Y2Nlc3NcIiAvKiBTVUNDRVNTICovOlxyXG4gICAgICAgICAgICAgICAgLy8gVE9ETyhhbmR5c290byk6XHJcbiAgICAgICAgICAgICAgICAvLyBhc3NlcnQodGhpcy5zdGF0ZV8gPT09IEludGVybmFsVGFza1N0YXRlLlJVTk5JTkcgfHxcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICB0aGlzLnN0YXRlXyA9PT0gSW50ZXJuYWxUYXNrU3RhdGUuUEFVU0lORyB8fFxyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgIHRoaXMuc3RhdGVfID09PSBJbnRlcm5hbFRhc2tTdGF0ZS5DQU5DRUxJTkcpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc3RhdGUgPSBzdGF0ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX25vdGlmeU9ic2VydmVycygpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgY29tcGxldGVUcmFuc2l0aW9uc18oKSB7XHJcbiAgICAgICAgc3dpdGNoICh0aGlzLl9zdGF0ZSkge1xyXG4gICAgICAgICAgICBjYXNlIFwicGF1c2luZ1wiIC8qIFBBVVNJTkcgKi86XHJcbiAgICAgICAgICAgICAgICB0aGlzLl90cmFuc2l0aW9uKFwicGF1c2VkXCIgLyogUEFVU0VEICovKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwiY2FuY2VsaW5nXCIgLyogQ0FOQ0VMSU5HICovOlxyXG4gICAgICAgICAgICAgICAgdGhpcy5fdHJhbnNpdGlvbihcImNhbmNlbGVkXCIgLyogQ0FOQ0VMRUQgKi8pO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgXCJydW5uaW5nXCIgLyogUlVOTklORyAqLzpcclxuICAgICAgICAgICAgICAgIHRoaXMuX3N0YXJ0KCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEEgc25hcHNob3Qgb2YgdGhlIGN1cnJlbnQgdGFzayBzdGF0ZS5cclxuICAgICAqL1xyXG4gICAgZ2V0IHNuYXBzaG90KCkge1xyXG4gICAgICAgIGNvbnN0IGV4dGVybmFsU3RhdGUgPSB0YXNrU3RhdGVGcm9tSW50ZXJuYWxUYXNrU3RhdGUodGhpcy5fc3RhdGUpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGJ5dGVzVHJhbnNmZXJyZWQ6IHRoaXMuX3RyYW5zZmVycmVkLFxyXG4gICAgICAgICAgICB0b3RhbEJ5dGVzOiB0aGlzLl9ibG9iLnNpemUoKSxcclxuICAgICAgICAgICAgc3RhdGU6IGV4dGVybmFsU3RhdGUsXHJcbiAgICAgICAgICAgIG1ldGFkYXRhOiB0aGlzLl9tZXRhZGF0YSxcclxuICAgICAgICAgICAgdGFzazogdGhpcyxcclxuICAgICAgICAgICAgcmVmOiB0aGlzLl9yZWZcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBBZGRzIGEgY2FsbGJhY2sgZm9yIGFuIGV2ZW50LlxyXG4gICAgICogQHBhcmFtIHR5cGUgLSBUaGUgdHlwZSBvZiBldmVudCB0byBsaXN0ZW4gZm9yLlxyXG4gICAgICogQHBhcmFtIG5leHRPck9ic2VydmVyIC1cclxuICAgICAqICAgICBUaGUgYG5leHRgIGZ1bmN0aW9uLCB3aGljaCBnZXRzIGNhbGxlZCBmb3IgZWFjaCBpdGVtIGluXHJcbiAgICAgKiAgICAgdGhlIGV2ZW50IHN0cmVhbSwgb3IgYW4gb2JzZXJ2ZXIgb2JqZWN0IHdpdGggc29tZSBvciBhbGwgb2YgdGhlc2UgdGhyZWVcclxuICAgICAqICAgICBwcm9wZXJ0aWVzIChgbmV4dGAsIGBlcnJvcmAsIGBjb21wbGV0ZWApLlxyXG4gICAgICogQHBhcmFtIGVycm9yIC0gQSBmdW5jdGlvbiB0aGF0IGdldHMgY2FsbGVkIHdpdGggYSBgU3RvcmFnZUVycm9yYFxyXG4gICAgICogICAgIGlmIHRoZSBldmVudCBzdHJlYW0gZW5kcyBkdWUgdG8gYW4gZXJyb3IuXHJcbiAgICAgKiBAcGFyYW0gY29tcGxldGVkIC0gQSBmdW5jdGlvbiB0aGF0IGdldHMgY2FsbGVkIGlmIHRoZVxyXG4gICAgICogICAgIGV2ZW50IHN0cmVhbSBlbmRzIG5vcm1hbGx5LlxyXG4gICAgICogQHJldHVybnNcclxuICAgICAqICAgICBJZiBvbmx5IHRoZSBldmVudCBhcmd1bWVudCBpcyBwYXNzZWQsIHJldHVybnMgYSBmdW5jdGlvbiB5b3UgY2FuIHVzZSB0b1xyXG4gICAgICogICAgIGFkZCBjYWxsYmFja3MgKHNlZSB0aGUgZXhhbXBsZXMgYWJvdmUpLiBJZiBtb3JlIHRoYW4ganVzdCB0aGUgZXZlbnRcclxuICAgICAqICAgICBhcmd1bWVudCBpcyBwYXNzZWQsIHJldHVybnMgYSBmdW5jdGlvbiB5b3UgY2FuIGNhbGwgdG8gdW5yZWdpc3RlciB0aGVcclxuICAgICAqICAgICBjYWxsYmFja3MuXHJcbiAgICAgKi9cclxuICAgIG9uKHR5cGUsIG5leHRPck9ic2VydmVyLCBlcnJvciwgY29tcGxldGVkKSB7XHJcbiAgICAgICAgY29uc3Qgb2JzZXJ2ZXIgPSBuZXcgT2JzZXJ2ZXIobmV4dE9yT2JzZXJ2ZXIgfHwgdW5kZWZpbmVkLCBlcnJvciB8fCB1bmRlZmluZWQsIGNvbXBsZXRlZCB8fCB1bmRlZmluZWQpO1xyXG4gICAgICAgIHRoaXMuX2FkZE9ic2VydmVyKG9ic2VydmVyKTtcclxuICAgICAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9yZW1vdmVPYnNlcnZlcihvYnNlcnZlcik7XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogVGhpcyBvYmplY3QgYmVoYXZlcyBsaWtlIGEgUHJvbWlzZSwgYW5kIHJlc29sdmVzIHdpdGggaXRzIHNuYXBzaG90IGRhdGFcclxuICAgICAqIHdoZW4gdGhlIHVwbG9hZCBjb21wbGV0ZXMuXHJcbiAgICAgKiBAcGFyYW0gb25GdWxmaWxsZWQgLSBUaGUgZnVsZmlsbG1lbnQgY2FsbGJhY2suIFByb21pc2UgY2hhaW5pbmcgd29ya3MgYXMgbm9ybWFsLlxyXG4gICAgICogQHBhcmFtIG9uUmVqZWN0ZWQgLSBUaGUgcmVqZWN0aW9uIGNhbGxiYWNrLlxyXG4gICAgICovXHJcbiAgICB0aGVuKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkKSB7XHJcbiAgICAgICAgLy8gVGhlc2UgY2FzdHMgYXJlIG5lZWRlZCBzbyB0aGF0IFR5cGVTY3JpcHQgY2FuIGluZmVyIHRoZSB0eXBlcyBvZiB0aGVcclxuICAgICAgICAvLyByZXN1bHRpbmcgUHJvbWlzZS5cclxuICAgICAgICByZXR1cm4gdGhpcy5fcHJvbWlzZS50aGVuKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogRXF1aXZhbGVudCB0byBjYWxsaW5nIGB0aGVuKG51bGwsIG9uUmVqZWN0ZWQpYC5cclxuICAgICAqL1xyXG4gICAgY2F0Y2gob25SZWplY3RlZCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnRoZW4obnVsbCwgb25SZWplY3RlZCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEFkZHMgdGhlIGdpdmVuIG9ic2VydmVyLlxyXG4gICAgICovXHJcbiAgICBfYWRkT2JzZXJ2ZXIob2JzZXJ2ZXIpIHtcclxuICAgICAgICB0aGlzLl9vYnNlcnZlcnMucHVzaChvYnNlcnZlcik7XHJcbiAgICAgICAgdGhpcy5fbm90aWZ5T2JzZXJ2ZXIob2JzZXJ2ZXIpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBSZW1vdmVzIHRoZSBnaXZlbiBvYnNlcnZlci5cclxuICAgICAqL1xyXG4gICAgX3JlbW92ZU9ic2VydmVyKG9ic2VydmVyKSB7XHJcbiAgICAgICAgY29uc3QgaSA9IHRoaXMuX29ic2VydmVycy5pbmRleE9mKG9ic2VydmVyKTtcclxuICAgICAgICBpZiAoaSAhPT0gLTEpIHtcclxuICAgICAgICAgICAgdGhpcy5fb2JzZXJ2ZXJzLnNwbGljZShpLCAxKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBfbm90aWZ5T2JzZXJ2ZXJzKCkge1xyXG4gICAgICAgIHRoaXMuX2ZpbmlzaFByb21pc2UoKTtcclxuICAgICAgICBjb25zdCBvYnNlcnZlcnMgPSB0aGlzLl9vYnNlcnZlcnMuc2xpY2UoKTtcclxuICAgICAgICBvYnNlcnZlcnMuZm9yRWFjaChvYnNlcnZlciA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX25vdGlmeU9ic2VydmVyKG9ic2VydmVyKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIF9maW5pc2hQcm9taXNlKCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9yZXNvbHZlICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgbGV0IHRyaWdnZXJlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIHN3aXRjaCAodGFza1N0YXRlRnJvbUludGVybmFsVGFza1N0YXRlKHRoaXMuX3N0YXRlKSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSBUYXNrU3RhdGUuU1VDQ0VTUzpcclxuICAgICAgICAgICAgICAgICAgICBhc3luYyh0aGlzLl9yZXNvbHZlLmJpbmQobnVsbCwgdGhpcy5zbmFwc2hvdCkpKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFRhc2tTdGF0ZS5DQU5DRUxFRDpcclxuICAgICAgICAgICAgICAgIGNhc2UgVGFza1N0YXRlLkVSUk9SOlxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRvQ2FsbCA9IHRoaXMuX3JlamVjdDtcclxuICAgICAgICAgICAgICAgICAgICBhc3luYyh0b0NhbGwuYmluZChudWxsLCB0aGlzLl9lcnJvcikpKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIHRyaWdnZXJlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0cmlnZ2VyZWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3Jlc29sdmUgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yZWplY3QgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBfbm90aWZ5T2JzZXJ2ZXIob2JzZXJ2ZXIpIHtcclxuICAgICAgICBjb25zdCBleHRlcm5hbFN0YXRlID0gdGFza1N0YXRlRnJvbUludGVybmFsVGFza1N0YXRlKHRoaXMuX3N0YXRlKTtcclxuICAgICAgICBzd2l0Y2ggKGV4dGVybmFsU3RhdGUpIHtcclxuICAgICAgICAgICAgY2FzZSBUYXNrU3RhdGUuUlVOTklORzpcclxuICAgICAgICAgICAgY2FzZSBUYXNrU3RhdGUuUEFVU0VEOlxyXG4gICAgICAgICAgICAgICAgaWYgKG9ic2VydmVyLm5leHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBhc3luYyhvYnNlcnZlci5uZXh0LmJpbmQob2JzZXJ2ZXIsIHRoaXMuc25hcHNob3QpKSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgVGFza1N0YXRlLlNVQ0NFU1M6XHJcbiAgICAgICAgICAgICAgICBpZiAob2JzZXJ2ZXIuY29tcGxldGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBhc3luYyhvYnNlcnZlci5jb21wbGV0ZS5iaW5kKG9ic2VydmVyKSkoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFRhc2tTdGF0ZS5DQU5DRUxFRDpcclxuICAgICAgICAgICAgY2FzZSBUYXNrU3RhdGUuRVJST1I6XHJcbiAgICAgICAgICAgICAgICBpZiAob2JzZXJ2ZXIuZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICBhc3luYyhvYnNlcnZlci5lcnJvci5iaW5kKG9ic2VydmVyLCB0aGlzLl9lcnJvcikpKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIC8vIFRPRE8oYW5keXNvdG8pOiBhc3NlcnQoZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgaWYgKG9ic2VydmVyLmVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXN5bmMob2JzZXJ2ZXIuZXJyb3IuYmluZChvYnNlcnZlciwgdGhpcy5fZXJyb3IpKSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUmVzdW1lcyBhIHBhdXNlZCB0YXNrLiBIYXMgbm8gZWZmZWN0IG9uIGEgY3VycmVudGx5IHJ1bm5pbmcgb3IgZmFpbGVkIHRhc2suXHJcbiAgICAgKiBAcmV0dXJucyBUcnVlIGlmIHRoZSBvcGVyYXRpb24gdG9vayBlZmZlY3QsIGZhbHNlIGlmIGlnbm9yZWQuXHJcbiAgICAgKi9cclxuICAgIHJlc3VtZSgpIHtcclxuICAgICAgICBjb25zdCB2YWxpZCA9IHRoaXMuX3N0YXRlID09PSBcInBhdXNlZFwiIC8qIFBBVVNFRCAqLyB8fFxyXG4gICAgICAgICAgICB0aGlzLl9zdGF0ZSA9PT0gXCJwYXVzaW5nXCIgLyogUEFVU0lORyAqLztcclxuICAgICAgICBpZiAodmFsaWQpIHtcclxuICAgICAgICAgICAgdGhpcy5fdHJhbnNpdGlvbihcInJ1bm5pbmdcIiAvKiBSVU5OSU5HICovKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHZhbGlkO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBQYXVzZXMgYSBjdXJyZW50bHkgcnVubmluZyB0YXNrLiBIYXMgbm8gZWZmZWN0IG9uIGEgcGF1c2VkIG9yIGZhaWxlZCB0YXNrLlxyXG4gICAgICogQHJldHVybnMgVHJ1ZSBpZiB0aGUgb3BlcmF0aW9uIHRvb2sgZWZmZWN0LCBmYWxzZSBpZiBpZ25vcmVkLlxyXG4gICAgICovXHJcbiAgICBwYXVzZSgpIHtcclxuICAgICAgICBjb25zdCB2YWxpZCA9IHRoaXMuX3N0YXRlID09PSBcInJ1bm5pbmdcIiAvKiBSVU5OSU5HICovO1xyXG4gICAgICAgIGlmICh2YWxpZCkge1xyXG4gICAgICAgICAgICB0aGlzLl90cmFuc2l0aW9uKFwicGF1c2luZ1wiIC8qIFBBVVNJTkcgKi8pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdmFsaWQ7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIENhbmNlbHMgYSBjdXJyZW50bHkgcnVubmluZyBvciBwYXVzZWQgdGFzay4gSGFzIG5vIGVmZmVjdCBvbiBhIGNvbXBsZXRlIG9yXHJcbiAgICAgKiBmYWlsZWQgdGFzay5cclxuICAgICAqIEByZXR1cm5zIFRydWUgaWYgdGhlIG9wZXJhdGlvbiB0b29rIGVmZmVjdCwgZmFsc2UgaWYgaWdub3JlZC5cclxuICAgICAqL1xyXG4gICAgY2FuY2VsKCkge1xyXG4gICAgICAgIGNvbnN0IHZhbGlkID0gdGhpcy5fc3RhdGUgPT09IFwicnVubmluZ1wiIC8qIFJVTk5JTkcgKi8gfHxcclxuICAgICAgICAgICAgdGhpcy5fc3RhdGUgPT09IFwicGF1c2luZ1wiIC8qIFBBVVNJTkcgKi87XHJcbiAgICAgICAgaWYgKHZhbGlkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3RyYW5zaXRpb24oXCJjYW5jZWxpbmdcIiAvKiBDQU5DRUxJTkcgKi8pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdmFsaWQ7XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFByb3ZpZGVzIG1ldGhvZHMgdG8gaW50ZXJhY3Qgd2l0aCBhIGJ1Y2tldCBpbiB0aGUgRmlyZWJhc2UgU3RvcmFnZSBzZXJ2aWNlLlxyXG4gKiBAaW50ZXJuYWxcclxuICogQHBhcmFtIF9sb2NhdGlvbiAtIEFuIGZicy5sb2NhdGlvbiwgb3IgdGhlIFVSTCBhdFxyXG4gKiAgICAgd2hpY2ggdG8gYmFzZSB0aGlzIG9iamVjdCwgaW4gb25lIG9mIHRoZSBmb2xsb3dpbmcgZm9ybXM6XHJcbiAqICAgICAgICAgZ3M6Ly88YnVja2V0Pi88b2JqZWN0LXBhdGg+XHJcbiAqICAgICAgICAgaHR0cFtzXTovL2ZpcmViYXNlc3RvcmFnZS5nb29nbGVhcGlzLmNvbS9cclxuICogICAgICAgICAgICAgICAgICAgICA8YXBpLXZlcnNpb24+L2IvPGJ1Y2tldD4vby88b2JqZWN0LXBhdGg+XHJcbiAqICAgICBBbnkgcXVlcnkgb3IgZnJhZ21lbnQgc3RyaW5ncyB3aWxsIGJlIGlnbm9yZWQgaW4gdGhlIGh0dHBbc11cclxuICogICAgIGZvcm1hdC4gSWYgbm8gdmFsdWUgaXMgcGFzc2VkLCB0aGUgc3RvcmFnZSBvYmplY3Qgd2lsbCB1c2UgYSBVUkwgYmFzZWQgb25cclxuICogICAgIHRoZSBwcm9qZWN0IElEIG9mIHRoZSBiYXNlIGZpcmViYXNlLkFwcCBpbnN0YW5jZS5cclxuICovXHJcbmNsYXNzIFJlZmVyZW5jZSB7XHJcbiAgICBjb25zdHJ1Y3Rvcihfc2VydmljZSwgbG9jYXRpb24pIHtcclxuICAgICAgICB0aGlzLl9zZXJ2aWNlID0gX3NlcnZpY2U7XHJcbiAgICAgICAgaWYgKGxvY2F0aW9uIGluc3RhbmNlb2YgTG9jYXRpb24pIHtcclxuICAgICAgICAgICAgdGhpcy5fbG9jYXRpb24gPSBsb2NhdGlvbjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2xvY2F0aW9uID0gTG9jYXRpb24ubWFrZUZyb21VcmwobG9jYXRpb24sIF9zZXJ2aWNlLmhvc3QpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0aGUgVVJMIGZvciB0aGUgYnVja2V0IGFuZCBwYXRoIHRoaXMgb2JqZWN0IHJlZmVyZW5jZXMsXHJcbiAgICAgKiAgICAgaW4gdGhlIGZvcm0gZ3M6Ly88YnVja2V0Pi88b2JqZWN0LXBhdGg+XHJcbiAgICAgKiBAb3ZlcnJpZGVcclxuICAgICAqL1xyXG4gICAgdG9TdHJpbmcoKSB7XHJcbiAgICAgICAgcmV0dXJuICdnczovLycgKyB0aGlzLl9sb2NhdGlvbi5idWNrZXQgKyAnLycgKyB0aGlzLl9sb2NhdGlvbi5wYXRoO1xyXG4gICAgfVxyXG4gICAgX25ld1JlZihzZXJ2aWNlLCBsb2NhdGlvbikge1xyXG4gICAgICAgIHJldHVybiBuZXcgUmVmZXJlbmNlKHNlcnZpY2UsIGxvY2F0aW9uKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQSByZWZlcmVuY2UgdG8gdGhlIHJvb3Qgb2YgdGhpcyBvYmplY3QncyBidWNrZXQuXHJcbiAgICAgKi9cclxuICAgIGdldCByb290KCkge1xyXG4gICAgICAgIGNvbnN0IGxvY2F0aW9uID0gbmV3IExvY2F0aW9uKHRoaXMuX2xvY2F0aW9uLmJ1Y2tldCwgJycpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9uZXdSZWYodGhpcy5fc2VydmljZSwgbG9jYXRpb24pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgbmFtZSBvZiB0aGUgYnVja2V0IGNvbnRhaW5pbmcgdGhpcyByZWZlcmVuY2UncyBvYmplY3QuXHJcbiAgICAgKi9cclxuICAgIGdldCBidWNrZXQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xvY2F0aW9uLmJ1Y2tldDtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogVGhlIGZ1bGwgcGF0aCBvZiB0aGlzIG9iamVjdC5cclxuICAgICAqL1xyXG4gICAgZ2V0IGZ1bGxQYXRoKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9sb2NhdGlvbi5wYXRoO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgc2hvcnQgbmFtZSBvZiB0aGlzIG9iamVjdCwgd2hpY2ggaXMgdGhlIGxhc3QgY29tcG9uZW50IG9mIHRoZSBmdWxsIHBhdGguXHJcbiAgICAgKiBGb3IgZXhhbXBsZSwgaWYgZnVsbFBhdGggaXMgJ2Z1bGwvcGF0aC9pbWFnZS5wbmcnLCBuYW1lIGlzICdpbWFnZS5wbmcnLlxyXG4gICAgICovXHJcbiAgICBnZXQgbmFtZSgpIHtcclxuICAgICAgICByZXR1cm4gbGFzdENvbXBvbmVudCh0aGlzLl9sb2NhdGlvbi5wYXRoKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogVGhlIGBTdG9yYWdlU2VydmljZWAgaW5zdGFuY2UgdGhpcyBgU3RvcmFnZVJlZmVyZW5jZWAgaXMgYXNzb2NpYXRlZCB3aXRoLlxyXG4gICAgICovXHJcbiAgICBnZXQgc3RvcmFnZSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fc2VydmljZTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQSBgU3RvcmFnZVJlZmVyZW5jZWAgcG9pbnRpbmcgdG8gdGhlIHBhcmVudCBsb2NhdGlvbiBvZiB0aGlzIGBTdG9yYWdlUmVmZXJlbmNlYCwgb3IgbnVsbCBpZlxyXG4gICAgICogdGhpcyByZWZlcmVuY2UgaXMgdGhlIHJvb3QuXHJcbiAgICAgKi9cclxuICAgIGdldCBwYXJlbnQoKSB7XHJcbiAgICAgICAgY29uc3QgbmV3UGF0aCA9IHBhcmVudCh0aGlzLl9sb2NhdGlvbi5wYXRoKTtcclxuICAgICAgICBpZiAobmV3UGF0aCA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgbG9jYXRpb24gPSBuZXcgTG9jYXRpb24odGhpcy5fbG9jYXRpb24uYnVja2V0LCBuZXdQYXRoKTtcclxuICAgICAgICByZXR1cm4gbmV3IFJlZmVyZW5jZSh0aGlzLl9zZXJ2aWNlLCBsb2NhdGlvbik7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFV0aWxpdHkgZnVuY3Rpb24gdG8gdGhyb3cgYW4gZXJyb3IgaW4gbWV0aG9kcyB0aGF0IGRvIG5vdCBhY2NlcHQgYSByb290IHJlZmVyZW5jZS5cclxuICAgICAqL1xyXG4gICAgX3Rocm93SWZSb290KG5hbWUpIHtcclxuICAgICAgICBpZiAodGhpcy5fbG9jYXRpb24ucGF0aCA9PT0gJycpIHtcclxuICAgICAgICAgICAgdGhyb3cgaW52YWxpZFJvb3RPcGVyYXRpb24obmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBVcGxvYWRzIGRhdGEgdG8gdGhpcyBvYmplY3QncyBsb2NhdGlvbi5cclxuICogVGhlIHVwbG9hZCBpcyBub3QgcmVzdW1hYmxlLlxyXG4gKlxyXG4gKiBAcGFyYW0gcmVmIC0gU3RvcmFnZVJlZmVyZW5jZSB3aGVyZSBkYXRhIHNob3VsZCBiZSB1cGxvYWRlZC5cclxuICogQHBhcmFtIGRhdGEgLSBUaGUgZGF0YSB0byB1cGxvYWQuXHJcbiAqIEBwYXJhbSBtZXRhZGF0YSAtIE1ldGFkYXRhIGZvciB0aGUgbmV3bHkgdXBsb2FkZWQgZGF0YS5cclxuICogQHJldHVybnMgQSBQcm9taXNlIGNvbnRhaW5pbmcgYW4gVXBsb2FkUmVzdWx0XHJcbiAqL1xyXG5mdW5jdGlvbiB1cGxvYWRCeXRlcyQxKHJlZiwgZGF0YSwgbWV0YWRhdGEpIHtcclxuICAgIHJlZi5fdGhyb3dJZlJvb3QoJ3VwbG9hZEJ5dGVzJyk7XHJcbiAgICBjb25zdCByZXF1ZXN0SW5mbyA9IG11bHRpcGFydFVwbG9hZChyZWYuc3RvcmFnZSwgcmVmLl9sb2NhdGlvbiwgZ2V0TWFwcGluZ3MoKSwgbmV3IEZic0Jsb2IoZGF0YSwgdHJ1ZSksIG1ldGFkYXRhKTtcclxuICAgIHJldHVybiByZWYuc3RvcmFnZVxyXG4gICAgICAgIC5tYWtlUmVxdWVzdFdpdGhUb2tlbnMocmVxdWVzdEluZm8pXHJcbiAgICAgICAgLnRoZW4ocmVxdWVzdCA9PiByZXF1ZXN0LmdldFByb21pc2UoKSlcclxuICAgICAgICAudGhlbihmaW5hbE1ldGFkYXRhID0+IHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBtZXRhZGF0YTogZmluYWxNZXRhZGF0YSxcclxuICAgICAgICAgICAgcmVmXHJcbiAgICAgICAgfTtcclxuICAgIH0pO1xyXG59XHJcbi8qKlxyXG4gKiBVcGxvYWRzIGRhdGEgdG8gdGhpcyBvYmplY3QncyBsb2NhdGlvbi5cclxuICogVGhlIHVwbG9hZCBjYW4gYmUgcGF1c2VkIGFuZCByZXN1bWVkLCBhbmQgZXhwb3NlcyBwcm9ncmVzcyB1cGRhdGVzLlxyXG4gKiBAcHVibGljXHJcbiAqIEBwYXJhbSByZWYgLSBTdG9yYWdlUmVmZXJlbmNlIHdoZXJlIGRhdGEgc2hvdWxkIGJlIHVwbG9hZGVkLlxyXG4gKiBAcGFyYW0gZGF0YSAtIFRoZSBkYXRhIHRvIHVwbG9hZC5cclxuICogQHBhcmFtIG1ldGFkYXRhIC0gTWV0YWRhdGEgZm9yIHRoZSBuZXdseSB1cGxvYWRlZCBkYXRhLlxyXG4gKiBAcmV0dXJucyBBbiBVcGxvYWRUYXNrXHJcbiAqL1xyXG5mdW5jdGlvbiB1cGxvYWRCeXRlc1Jlc3VtYWJsZSQxKHJlZiwgZGF0YSwgbWV0YWRhdGEpIHtcclxuICAgIHJlZi5fdGhyb3dJZlJvb3QoJ3VwbG9hZEJ5dGVzUmVzdW1hYmxlJyk7XHJcbiAgICByZXR1cm4gbmV3IFVwbG9hZFRhc2socmVmLCBuZXcgRmJzQmxvYihkYXRhKSwgbWV0YWRhdGEpO1xyXG59XHJcbi8qKlxyXG4gKiBVcGxvYWRzIGEgc3RyaW5nIHRvIHRoaXMgb2JqZWN0J3MgbG9jYXRpb24uXHJcbiAqIFRoZSB1cGxvYWQgaXMgbm90IHJlc3VtYWJsZS5cclxuICogQHB1YmxpY1xyXG4gKiBAcGFyYW0gcmVmIC0gU3RvcmFnZVJlZmVyZW5jZSB3aGVyZSBzdHJpbmcgc2hvdWxkIGJlIHVwbG9hZGVkLlxyXG4gKiBAcGFyYW0gdmFsdWUgLSBUaGUgc3RyaW5nIHRvIHVwbG9hZC5cclxuICogQHBhcmFtIGZvcm1hdCAtIFRoZSBmb3JtYXQgb2YgdGhlIHN0cmluZyB0byB1cGxvYWQuXHJcbiAqIEBwYXJhbSBtZXRhZGF0YSAtIE1ldGFkYXRhIGZvciB0aGUgbmV3bHkgdXBsb2FkZWQgc3RyaW5nLlxyXG4gKiBAcmV0dXJucyBBIFByb21pc2UgY29udGFpbmluZyBhbiBVcGxvYWRSZXN1bHRcclxuICovXHJcbmZ1bmN0aW9uIHVwbG9hZFN0cmluZyQxKHJlZiwgdmFsdWUsIGZvcm1hdCA9IFN0cmluZ0Zvcm1hdC5SQVcsIG1ldGFkYXRhKSB7XHJcbiAgICByZWYuX3Rocm93SWZSb290KCd1cGxvYWRTdHJpbmcnKTtcclxuICAgIGNvbnN0IGRhdGEgPSBkYXRhRnJvbVN0cmluZyhmb3JtYXQsIHZhbHVlKTtcclxuICAgIGNvbnN0IG1ldGFkYXRhQ2xvbmUgPSBPYmplY3QuYXNzaWduKHt9LCBtZXRhZGF0YSk7XHJcbiAgICBpZiAobWV0YWRhdGFDbG9uZVsnY29udGVudFR5cGUnXSA9PSBudWxsICYmIGRhdGEuY29udGVudFR5cGUgIT0gbnVsbCkge1xyXG4gICAgICAgIG1ldGFkYXRhQ2xvbmVbJ2NvbnRlbnRUeXBlJ10gPSBkYXRhLmNvbnRlbnRUeXBlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHVwbG9hZEJ5dGVzJDEocmVmLCBkYXRhLmRhdGEsIG1ldGFkYXRhQ2xvbmUpO1xyXG59XHJcbi8qKlxyXG4gKiBMaXN0IGFsbCBpdGVtcyAoZmlsZXMpIGFuZCBwcmVmaXhlcyAoZm9sZGVycykgdW5kZXIgdGhpcyBzdG9yYWdlIHJlZmVyZW5jZS5cclxuICpcclxuICogVGhpcyBpcyBhIGhlbHBlciBtZXRob2QgZm9yIGNhbGxpbmcgbGlzdCgpIHJlcGVhdGVkbHkgdW50aWwgdGhlcmUgYXJlXHJcbiAqIG5vIG1vcmUgcmVzdWx0cy4gVGhlIGRlZmF1bHQgcGFnaW5hdGlvbiBzaXplIGlzIDEwMDAuXHJcbiAqXHJcbiAqIE5vdGU6IFRoZSByZXN1bHRzIG1heSBub3QgYmUgY29uc2lzdGVudCBpZiBvYmplY3RzIGFyZSBjaGFuZ2VkIHdoaWxlIHRoaXNcclxuICogb3BlcmF0aW9uIGlzIHJ1bm5pbmcuXHJcbiAqXHJcbiAqIFdhcm5pbmc6IGxpc3RBbGwgbWF5IHBvdGVudGlhbGx5IGNvbnN1bWUgdG9vIG1hbnkgcmVzb3VyY2VzIGlmIHRoZXJlIGFyZVxyXG4gKiB0b28gbWFueSByZXN1bHRzLlxyXG4gKiBAcHVibGljXHJcbiAqIEBwYXJhbSByZWYgLSBTdG9yYWdlUmVmZXJlbmNlIHRvIGdldCBsaXN0IGZyb20uXHJcbiAqXHJcbiAqIEByZXR1cm5zIEEgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHdpdGggYWxsIHRoZSBpdGVtcyBhbmQgcHJlZml4ZXMgdW5kZXJcclxuICogICAgICB0aGUgY3VycmVudCBzdG9yYWdlIHJlZmVyZW5jZS4gYHByZWZpeGVzYCBjb250YWlucyByZWZlcmVuY2VzIHRvXHJcbiAqICAgICAgc3ViLWRpcmVjdG9yaWVzIGFuZCBgaXRlbXNgIGNvbnRhaW5zIHJlZmVyZW5jZXMgdG8gb2JqZWN0cyBpbiB0aGlzXHJcbiAqICAgICAgZm9sZGVyLiBgbmV4dFBhZ2VUb2tlbmAgaXMgbmV2ZXIgcmV0dXJuZWQuXHJcbiAqL1xyXG5mdW5jdGlvbiBsaXN0QWxsJDEocmVmKSB7XHJcbiAgICBjb25zdCBhY2N1bXVsYXRvciA9IHtcclxuICAgICAgICBwcmVmaXhlczogW10sXHJcbiAgICAgICAgaXRlbXM6IFtdXHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIGxpc3RBbGxIZWxwZXIocmVmLCBhY2N1bXVsYXRvcikudGhlbigoKSA9PiBhY2N1bXVsYXRvcik7XHJcbn1cclxuLyoqXHJcbiAqIFNlcGFyYXRlZCBmcm9tIGxpc3RBbGwgYmVjYXVzZSBhc3luYyBmdW5jdGlvbnMgY2FuJ3QgdXNlIFwiYXJndW1lbnRzXCIuXHJcbiAqIEBwYXJhbSByZWZcclxuICogQHBhcmFtIGFjY3VtdWxhdG9yXHJcbiAqIEBwYXJhbSBwYWdlVG9rZW5cclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIGxpc3RBbGxIZWxwZXIocmVmLCBhY2N1bXVsYXRvciwgcGFnZVRva2VuKSB7XHJcbiAgICBjb25zdCBvcHQgPSB7XHJcbiAgICAgICAgLy8gbWF4UmVzdWx0cyBpcyAxMDAwIGJ5IGRlZmF1bHQuXHJcbiAgICAgICAgcGFnZVRva2VuXHJcbiAgICB9O1xyXG4gICAgY29uc3QgbmV4dFBhZ2UgPSBhd2FpdCBsaXN0JDEocmVmLCBvcHQpO1xyXG4gICAgYWNjdW11bGF0b3IucHJlZml4ZXMucHVzaCguLi5uZXh0UGFnZS5wcmVmaXhlcyk7XHJcbiAgICBhY2N1bXVsYXRvci5pdGVtcy5wdXNoKC4uLm5leHRQYWdlLml0ZW1zKTtcclxuICAgIGlmIChuZXh0UGFnZS5uZXh0UGFnZVRva2VuICE9IG51bGwpIHtcclxuICAgICAgICBhd2FpdCBsaXN0QWxsSGVscGVyKHJlZiwgYWNjdW11bGF0b3IsIG5leHRQYWdlLm5leHRQYWdlVG9rZW4pO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBMaXN0IGl0ZW1zIChmaWxlcykgYW5kIHByZWZpeGVzIChmb2xkZXJzKSB1bmRlciB0aGlzIHN0b3JhZ2UgcmVmZXJlbmNlLlxyXG4gKlxyXG4gKiBMaXN0IEFQSSBpcyBvbmx5IGF2YWlsYWJsZSBmb3IgRmlyZWJhc2UgUnVsZXMgVmVyc2lvbiAyLlxyXG4gKlxyXG4gKiBHQ1MgaXMgYSBrZXktYmxvYiBzdG9yZS4gRmlyZWJhc2UgU3RvcmFnZSBpbXBvc2VzIHRoZSBzZW1hbnRpYyBvZiAnLydcclxuICogZGVsaW1pdGVkIGZvbGRlciBzdHJ1Y3R1cmUuXHJcbiAqIFJlZmVyIHRvIEdDUydzIExpc3QgQVBJIGlmIHlvdSB3YW50IHRvIGxlYXJuIG1vcmUuXHJcbiAqXHJcbiAqIFRvIGFkaGVyZSB0byBGaXJlYmFzZSBSdWxlcydzIFNlbWFudGljcywgRmlyZWJhc2UgU3RvcmFnZSBkb2VzIG5vdFxyXG4gKiBzdXBwb3J0IG9iamVjdHMgd2hvc2UgcGF0aHMgZW5kIHdpdGggXCIvXCIgb3IgY29udGFpbiB0d28gY29uc2VjdXRpdmVcclxuICogXCIvXCJzLiBGaXJlYmFzZSBTdG9yYWdlIExpc3QgQVBJIHdpbGwgZmlsdGVyIHRoZXNlIHVuc3VwcG9ydGVkIG9iamVjdHMuXHJcbiAqIGxpc3QoKSBtYXkgZmFpbCBpZiB0aGVyZSBhcmUgdG9vIG1hbnkgdW5zdXBwb3J0ZWQgb2JqZWN0cyBpbiB0aGUgYnVja2V0LlxyXG4gKiBAcHVibGljXHJcbiAqXHJcbiAqIEBwYXJhbSByZWYgLSBTdG9yYWdlUmVmZXJlbmNlIHRvIGdldCBsaXN0IGZyb20uXHJcbiAqIEBwYXJhbSBvcHRpb25zIC0gU2VlIExpc3RPcHRpb25zIGZvciBkZXRhaWxzLlxyXG4gKiBAcmV0dXJucyBBIFByb21pc2UgdGhhdCByZXNvbHZlcyB3aXRoIHRoZSBpdGVtcyBhbmQgcHJlZml4ZXMuXHJcbiAqICAgICAgYHByZWZpeGVzYCBjb250YWlucyByZWZlcmVuY2VzIHRvIHN1Yi1mb2xkZXJzIGFuZCBgaXRlbXNgXHJcbiAqICAgICAgY29udGFpbnMgcmVmZXJlbmNlcyB0byBvYmplY3RzIGluIHRoaXMgZm9sZGVyLiBgbmV4dFBhZ2VUb2tlbmBcclxuICogICAgICBjYW4gYmUgdXNlZCB0byBnZXQgdGhlIHJlc3Qgb2YgdGhlIHJlc3VsdHMuXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBsaXN0JDEocmVmLCBvcHRpb25zKSB7XHJcbiAgICBpZiAob3B0aW9ucyAhPSBudWxsKSB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBvcHRpb25zLm1heFJlc3VsdHMgPT09ICdudW1iZXInKSB7XHJcbiAgICAgICAgICAgIHZhbGlkYXRlTnVtYmVyKCdvcHRpb25zLm1heFJlc3VsdHMnLCBcclxuICAgICAgICAgICAgLyogbWluVmFsdWU9ICovIDEsIFxyXG4gICAgICAgICAgICAvKiBtYXhWYWx1ZT0gKi8gMTAwMCwgb3B0aW9ucy5tYXhSZXN1bHRzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBjb25zdCBvcCA9IG9wdGlvbnMgfHwge307XHJcbiAgICBjb25zdCByZXF1ZXN0SW5mbyA9IGxpc3QkMihyZWYuc3RvcmFnZSwgcmVmLl9sb2NhdGlvbiwgXHJcbiAgICAvKmRlbGltaXRlcj0gKi8gJy8nLCBvcC5wYWdlVG9rZW4sIG9wLm1heFJlc3VsdHMpO1xyXG4gICAgcmV0dXJuIChhd2FpdCByZWYuc3RvcmFnZS5tYWtlUmVxdWVzdFdpdGhUb2tlbnMocmVxdWVzdEluZm8pKS5nZXRQcm9taXNlKCk7XHJcbn1cclxuLyoqXHJcbiAqIEEgYFByb21pc2VgIHRoYXQgcmVzb2x2ZXMgd2l0aCB0aGUgbWV0YWRhdGEgZm9yIHRoaXMgb2JqZWN0LiBJZiB0aGlzXHJcbiAqIG9iamVjdCBkb2Vzbid0IGV4aXN0IG9yIG1ldGFkYXRhIGNhbm5vdCBiZSByZXRyZWl2ZWQsIHRoZSBwcm9taXNlIGlzXHJcbiAqIHJlamVjdGVkLlxyXG4gKiBAcHVibGljXHJcbiAqIEBwYXJhbSByZWYgLSBTdG9yYWdlUmVmZXJlbmNlIHRvIGdldCBtZXRhZGF0YSBmcm9tLlxyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gZ2V0TWV0YWRhdGEkMShyZWYpIHtcclxuICAgIHJlZi5fdGhyb3dJZlJvb3QoJ2dldE1ldGFkYXRhJyk7XHJcbiAgICBjb25zdCByZXF1ZXN0SW5mbyA9IGdldE1ldGFkYXRhJDIocmVmLnN0b3JhZ2UsIHJlZi5fbG9jYXRpb24sIGdldE1hcHBpbmdzKCkpO1xyXG4gICAgcmV0dXJuIChhd2FpdCByZWYuc3RvcmFnZS5tYWtlUmVxdWVzdFdpdGhUb2tlbnMocmVxdWVzdEluZm8pKS5nZXRQcm9taXNlKCk7XHJcbn1cclxuLyoqXHJcbiAqIFVwZGF0ZXMgdGhlIG1ldGFkYXRhIGZvciB0aGlzIG9iamVjdC5cclxuICogQHB1YmxpY1xyXG4gKiBAcGFyYW0gcmVmIC0gU3RvcmFnZVJlZmVyZW5jZSB0byB1cGRhdGUgbWV0YWRhdGEgZm9yLlxyXG4gKiBAcGFyYW0gbWV0YWRhdGEgLSBUaGUgbmV3IG1ldGFkYXRhIGZvciB0aGUgb2JqZWN0LlxyXG4gKiAgICAgT25seSB2YWx1ZXMgdGhhdCBoYXZlIGJlZW4gZXhwbGljaXRseSBzZXQgd2lsbCBiZSBjaGFuZ2VkLiBFeHBsaWNpdGx5XHJcbiAqICAgICBzZXR0aW5nIGEgdmFsdWUgdG8gbnVsbCB3aWxsIHJlbW92ZSB0aGUgbWV0YWRhdGEuXHJcbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHRoYXQgcmVzb2x2ZXNcclxuICogICAgIHdpdGggdGhlIG5ldyBtZXRhZGF0YSBmb3IgdGhpcyBvYmplY3QuXHJcbiAqICAgICBTZWUgYGZpcmViYXNlU3RvcmFnZS5SZWZlcmVuY2UucHJvdG90eXBlLmdldE1ldGFkYXRhYFxyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gdXBkYXRlTWV0YWRhdGEkMShyZWYsIG1ldGFkYXRhKSB7XHJcbiAgICByZWYuX3Rocm93SWZSb290KCd1cGRhdGVNZXRhZGF0YScpO1xyXG4gICAgY29uc3QgcmVxdWVzdEluZm8gPSB1cGRhdGVNZXRhZGF0YSQyKHJlZi5zdG9yYWdlLCByZWYuX2xvY2F0aW9uLCBtZXRhZGF0YSwgZ2V0TWFwcGluZ3MoKSk7XHJcbiAgICByZXR1cm4gKGF3YWl0IHJlZi5zdG9yYWdlLm1ha2VSZXF1ZXN0V2l0aFRva2VucyhyZXF1ZXN0SW5mbykpLmdldFByb21pc2UoKTtcclxufVxyXG4vKipcclxuICogUmV0dXJucyB0aGUgZG93bmxvYWQgVVJMIGZvciB0aGUgZ2l2ZW4gUmVmZXJlbmNlLlxyXG4gKiBAcHVibGljXHJcbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHRoYXQgcmVzb2x2ZXMgd2l0aCB0aGUgZG93bmxvYWRcclxuICogICAgIFVSTCBmb3IgdGhpcyBvYmplY3QuXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBnZXREb3dubG9hZFVSTCQxKHJlZikge1xyXG4gICAgcmVmLl90aHJvd0lmUm9vdCgnZ2V0RG93bmxvYWRVUkwnKTtcclxuICAgIGNvbnN0IHJlcXVlc3RJbmZvID0gZ2V0RG93bmxvYWRVcmwocmVmLnN0b3JhZ2UsIHJlZi5fbG9jYXRpb24sIGdldE1hcHBpbmdzKCkpO1xyXG4gICAgcmV0dXJuIChhd2FpdCByZWYuc3RvcmFnZS5tYWtlUmVxdWVzdFdpdGhUb2tlbnMocmVxdWVzdEluZm8pKVxyXG4gICAgICAgIC5nZXRQcm9taXNlKClcclxuICAgICAgICAudGhlbih1cmwgPT4ge1xyXG4gICAgICAgIGlmICh1cmwgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgdGhyb3cgbm9Eb3dubG9hZFVSTCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdXJsO1xyXG4gICAgfSk7XHJcbn1cclxuLyoqXHJcbiAqIERlbGV0ZXMgdGhlIG9iamVjdCBhdCB0aGlzIGxvY2F0aW9uLlxyXG4gKiBAcHVibGljXHJcbiAqIEBwYXJhbSByZWYgLSBTdG9yYWdlUmVmZXJlbmNlIGZvciBvYmplY3QgdG8gZGVsZXRlLlxyXG4gKiBAcmV0dXJucyBBIGBQcm9taXNlYCB0aGF0IHJlc29sdmVzIGlmIHRoZSBkZWxldGlvbiBzdWNjZWVkcy5cclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIGRlbGV0ZU9iamVjdCQxKHJlZikge1xyXG4gICAgcmVmLl90aHJvd0lmUm9vdCgnZGVsZXRlT2JqZWN0Jyk7XHJcbiAgICBjb25zdCByZXF1ZXN0SW5mbyA9IGRlbGV0ZU9iamVjdCQyKHJlZi5zdG9yYWdlLCByZWYuX2xvY2F0aW9uKTtcclxuICAgIHJldHVybiAoYXdhaXQgcmVmLnN0b3JhZ2UubWFrZVJlcXVlc3RXaXRoVG9rZW5zKHJlcXVlc3RJbmZvKSkuZ2V0UHJvbWlzZSgpO1xyXG59XHJcbi8qKlxyXG4gKiBSZXR1cm5zIHJlZmVyZW5jZSBmb3Igb2JqZWN0IG9idGFpbmVkIGJ5IGFwcGVuZGluZyBgY2hpbGRQYXRoYCB0byBgcmVmYC5cclxuICpcclxuICogQHBhcmFtIHJlZiAtIFN0b3JhZ2VSZWZlcmVuY2UgdG8gZ2V0IGNoaWxkIG9mLlxyXG4gKiBAcGFyYW0gY2hpbGRQYXRoIC0gQ2hpbGQgcGF0aCBmcm9tIHByb3ZpZGVkIHJlZi5cclxuICogQHJldHVybnMgQSByZWZlcmVuY2UgdG8gdGhlIG9iamVjdCBvYnRhaW5lZCBieVxyXG4gKiBhcHBlbmRpbmcgY2hpbGRQYXRoLCByZW1vdmluZyBhbnkgZHVwbGljYXRlLCBiZWdpbm5pbmcsIG9yIHRyYWlsaW5nXHJcbiAqIHNsYXNoZXMuXHJcbiAqXHJcbiAqL1xyXG5mdW5jdGlvbiBfZ2V0Q2hpbGQkMShyZWYsIGNoaWxkUGF0aCkge1xyXG4gICAgY29uc3QgbmV3UGF0aCA9IGNoaWxkKHJlZi5fbG9jYXRpb24ucGF0aCwgY2hpbGRQYXRoKTtcclxuICAgIGNvbnN0IGxvY2F0aW9uID0gbmV3IExvY2F0aW9uKHJlZi5fbG9jYXRpb24uYnVja2V0LCBuZXdQYXRoKTtcclxuICAgIHJldHVybiBuZXcgUmVmZXJlbmNlKHJlZi5zdG9yYWdlLCBsb2NhdGlvbik7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuZnVuY3Rpb24gaXNVcmwocGF0aCkge1xyXG4gICAgcmV0dXJuIC9eW0EtWmEtel0rOlxcL1xcLy8udGVzdChwYXRoKTtcclxufVxyXG4vKipcclxuICogUmV0dXJucyBhIGZpcmViYXNlU3RvcmFnZS5SZWZlcmVuY2UgZm9yIHRoZSBnaXZlbiB1cmwuXHJcbiAqL1xyXG5mdW5jdGlvbiByZWZGcm9tVVJMKHNlcnZpY2UsIHVybCkge1xyXG4gICAgcmV0dXJuIG5ldyBSZWZlcmVuY2Uoc2VydmljZSwgdXJsKTtcclxufVxyXG4vKipcclxuICogUmV0dXJucyBhIGZpcmViYXNlU3RvcmFnZS5SZWZlcmVuY2UgZm9yIHRoZSBnaXZlbiBwYXRoIGluIHRoZSBkZWZhdWx0XHJcbiAqIGJ1Y2tldC5cclxuICovXHJcbmZ1bmN0aW9uIHJlZkZyb21QYXRoKHJlZiwgcGF0aCkge1xyXG4gICAgaWYgKHJlZiBpbnN0YW5jZW9mIEZpcmViYXNlU3RvcmFnZUltcGwpIHtcclxuICAgICAgICBjb25zdCBzZXJ2aWNlID0gcmVmO1xyXG4gICAgICAgIGlmIChzZXJ2aWNlLl9idWNrZXQgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aHJvdyBub0RlZmF1bHRCdWNrZXQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgcmVmZXJlbmNlID0gbmV3IFJlZmVyZW5jZShzZXJ2aWNlLCBzZXJ2aWNlLl9idWNrZXQpO1xyXG4gICAgICAgIGlmIChwYXRoICE9IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlZkZyb21QYXRoKHJlZmVyZW5jZSwgcGF0aCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVmZXJlbmNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIC8vIHJlZiBpcyBhIFJlZmVyZW5jZVxyXG4gICAgICAgIGlmIChwYXRoICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF9nZXRDaGlsZCQxKHJlZiwgcGF0aCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVmO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiByZWYkMShzZXJ2aWNlT3JSZWYsIHBhdGhPclVybCkge1xyXG4gICAgaWYgKHBhdGhPclVybCAmJiBpc1VybChwYXRoT3JVcmwpKSB7XHJcbiAgICAgICAgaWYgKHNlcnZpY2VPclJlZiBpbnN0YW5jZW9mIEZpcmViYXNlU3RvcmFnZUltcGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlZkZyb21VUkwoc2VydmljZU9yUmVmLCBwYXRoT3JVcmwpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhyb3cgaW52YWxpZEFyZ3VtZW50KCdUbyB1c2UgcmVmKHNlcnZpY2UsIHVybCksIHRoZSBmaXJzdCBhcmd1bWVudCBtdXN0IGJlIGEgU3RvcmFnZSBpbnN0YW5jZS4nKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gcmVmRnJvbVBhdGgoc2VydmljZU9yUmVmLCBwYXRoT3JVcmwpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGV4dHJhY3RCdWNrZXQoaG9zdCwgY29uZmlnKSB7XHJcbiAgICBjb25zdCBidWNrZXRTdHJpbmcgPSBjb25maWcgPT09IG51bGwgfHwgY29uZmlnID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjb25maWdbQ09ORklHX1NUT1JBR0VfQlVDS0VUX0tFWV07XHJcbiAgICBpZiAoYnVja2V0U3RyaW5nID09IG51bGwpIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIHJldHVybiBMb2NhdGlvbi5tYWtlRnJvbUJ1Y2tldFNwZWMoYnVja2V0U3RyaW5nLCBob3N0KTtcclxufVxyXG5mdW5jdGlvbiBjb25uZWN0U3RvcmFnZUVtdWxhdG9yJDEoc3RvcmFnZSwgaG9zdCwgcG9ydCwgb3B0aW9ucyA9IHt9KSB7XHJcbiAgICBzdG9yYWdlLmhvc3QgPSBgaHR0cDovLyR7aG9zdH06JHtwb3J0fWA7XHJcbiAgICBjb25zdCB7IG1vY2tVc2VyVG9rZW4gfSA9IG9wdGlvbnM7XHJcbiAgICBpZiAobW9ja1VzZXJUb2tlbikge1xyXG4gICAgICAgIHN0b3JhZ2UuX292ZXJyaWRlQXV0aFRva2VuID1cclxuICAgICAgICAgICAgdHlwZW9mIG1vY2tVc2VyVG9rZW4gPT09ICdzdHJpbmcnXHJcbiAgICAgICAgICAgICAgICA/IG1vY2tVc2VyVG9rZW5cclxuICAgICAgICAgICAgICAgIDogY3JlYXRlTW9ja1VzZXJUb2tlbihtb2NrVXNlclRva2VuLCBzdG9yYWdlLmFwcC5vcHRpb25zLnByb2plY3RJZCk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIEEgc2VydmljZSB0aGF0IHByb3ZpZGVzIEZpcmViYXNlIFN0b3JhZ2UgUmVmZXJlbmNlIGluc3RhbmNlcy5cclxuICogQHBhcmFtIG9wdF91cmwgLSBnczovLyB1cmwgdG8gYSBjdXN0b20gU3RvcmFnZSBCdWNrZXRcclxuICpcclxuICogQGludGVybmFsXHJcbiAqL1xyXG5jbGFzcyBGaXJlYmFzZVN0b3JhZ2VJbXBsIHtcclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgLyoqXHJcbiAgICAgKiBGaXJlYmFzZUFwcCBhc3NvY2lhdGVkIHdpdGggdGhpcyBTdG9yYWdlU2VydmljZSBpbnN0YW5jZS5cclxuICAgICAqL1xyXG4gICAgYXBwLCBfYXV0aFByb3ZpZGVyLCBcclxuICAgIC8qKlxyXG4gICAgICogQGludGVybmFsXHJcbiAgICAgKi9cclxuICAgIF9hcHBDaGVja1Byb3ZpZGVyLCBcclxuICAgIC8qKlxyXG4gICAgICogQGludGVybmFsXHJcbiAgICAgKi9cclxuICAgIF9wb29sLCBfdXJsLCBfZmlyZWJhc2VWZXJzaW9uKSB7XHJcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XHJcbiAgICAgICAgdGhpcy5fYXV0aFByb3ZpZGVyID0gX2F1dGhQcm92aWRlcjtcclxuICAgICAgICB0aGlzLl9hcHBDaGVja1Byb3ZpZGVyID0gX2FwcENoZWNrUHJvdmlkZXI7XHJcbiAgICAgICAgdGhpcy5fcG9vbCA9IF9wb29sO1xyXG4gICAgICAgIHRoaXMuX3VybCA9IF91cmw7XHJcbiAgICAgICAgdGhpcy5fZmlyZWJhc2VWZXJzaW9uID0gX2ZpcmViYXNlVmVyc2lvbjtcclxuICAgICAgICB0aGlzLl9idWNrZXQgPSBudWxsO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRoaXMgc3RyaW5nIGNhbiBiZSBpbiB0aGUgZm9ybWF0czpcclxuICAgICAgICAgKiAtIGhvc3RcclxuICAgICAgICAgKiAtIGhvc3Q6cG9ydFxyXG4gICAgICAgICAqIC0gcHJvdG9jb2w6Ly9ob3N0OnBvcnRcclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLl9ob3N0ID0gREVGQVVMVF9IT1NUO1xyXG4gICAgICAgIHRoaXMuX2FwcElkID0gbnVsbDtcclxuICAgICAgICB0aGlzLl9kZWxldGVkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fbWF4T3BlcmF0aW9uUmV0cnlUaW1lID0gREVGQVVMVF9NQVhfT1BFUkFUSU9OX1JFVFJZX1RJTUU7XHJcbiAgICAgICAgdGhpcy5fbWF4VXBsb2FkUmV0cnlUaW1lID0gREVGQVVMVF9NQVhfVVBMT0FEX1JFVFJZX1RJTUU7XHJcbiAgICAgICAgdGhpcy5fcmVxdWVzdHMgPSBuZXcgU2V0KCk7XHJcbiAgICAgICAgaWYgKF91cmwgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLl9idWNrZXQgPSBMb2NhdGlvbi5tYWtlRnJvbUJ1Y2tldFNwZWMoX3VybCwgdGhpcy5faG9zdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9idWNrZXQgPSBleHRyYWN0QnVja2V0KHRoaXMuX2hvc3QsIHRoaXMuYXBwLm9wdGlvbnMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGdldCBob3N0KCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9ob3N0O1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBTZXQgaG9zdCBzdHJpbmcgZm9yIHRoaXMgc2VydmljZS5cclxuICAgICAqIEBwYXJhbSBob3N0IC0gaG9zdCBzdHJpbmcgaW4gdGhlIGZvcm0gb2YgaG9zdCwgaG9zdDpwb3J0LFxyXG4gICAgICogb3IgcHJvdG9jb2w6Ly9ob3N0OnBvcnRcclxuICAgICAqL1xyXG4gICAgc2V0IGhvc3QoaG9zdCkge1xyXG4gICAgICAgIHRoaXMuX2hvc3QgPSBob3N0O1xyXG4gICAgICAgIGlmICh0aGlzLl91cmwgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLl9idWNrZXQgPSBMb2NhdGlvbi5tYWtlRnJvbUJ1Y2tldFNwZWModGhpcy5fdXJsLCBob3N0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2J1Y2tldCA9IGV4dHJhY3RCdWNrZXQoaG9zdCwgdGhpcy5hcHAub3B0aW9ucyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgbWF4aW11bSB0aW1lIHRvIHJldHJ5IHVwbG9hZHMgaW4gbWlsbGlzZWNvbmRzLlxyXG4gICAgICovXHJcbiAgICBnZXQgbWF4VXBsb2FkUmV0cnlUaW1lKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9tYXhVcGxvYWRSZXRyeVRpbWU7XHJcbiAgICB9XHJcbiAgICBzZXQgbWF4VXBsb2FkUmV0cnlUaW1lKHRpbWUpIHtcclxuICAgICAgICB2YWxpZGF0ZU51bWJlcigndGltZScsIFxyXG4gICAgICAgIC8qIG1pblZhbHVlPSovIDAsIFxyXG4gICAgICAgIC8qIG1heFZhbHVlPSAqLyBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksIHRpbWUpO1xyXG4gICAgICAgIHRoaXMuX21heFVwbG9hZFJldHJ5VGltZSA9IHRpbWU7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFRoZSBtYXhpbXVtIHRpbWUgdG8gcmV0cnkgb3BlcmF0aW9ucyBvdGhlciB0aGFuIHVwbG9hZHMgb3IgZG93bmxvYWRzIGluXHJcbiAgICAgKiBtaWxsaXNlY29uZHMuXHJcbiAgICAgKi9cclxuICAgIGdldCBtYXhPcGVyYXRpb25SZXRyeVRpbWUoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX21heE9wZXJhdGlvblJldHJ5VGltZTtcclxuICAgIH1cclxuICAgIHNldCBtYXhPcGVyYXRpb25SZXRyeVRpbWUodGltZSkge1xyXG4gICAgICAgIHZhbGlkYXRlTnVtYmVyKCd0aW1lJywgXHJcbiAgICAgICAgLyogbWluVmFsdWU9Ki8gMCwgXHJcbiAgICAgICAgLyogbWF4VmFsdWU9ICovIE51bWJlci5QT1NJVElWRV9JTkZJTklUWSwgdGltZSk7XHJcbiAgICAgICAgdGhpcy5fbWF4T3BlcmF0aW9uUmV0cnlUaW1lID0gdGltZTtcclxuICAgIH1cclxuICAgIGFzeW5jIF9nZXRBdXRoVG9rZW4oKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX292ZXJyaWRlQXV0aFRva2VuKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vdmVycmlkZUF1dGhUb2tlbjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgYXV0aCA9IHRoaXMuX2F1dGhQcm92aWRlci5nZXRJbW1lZGlhdGUoeyBvcHRpb25hbDogdHJ1ZSB9KTtcclxuICAgICAgICBpZiAoYXV0aCkge1xyXG4gICAgICAgICAgICBjb25zdCB0b2tlbkRhdGEgPSBhd2FpdCBhdXRoLmdldFRva2VuKCk7XHJcbiAgICAgICAgICAgIGlmICh0b2tlbkRhdGEgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0b2tlbkRhdGEuYWNjZXNzVG9rZW47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgICBhc3luYyBfZ2V0QXBwQ2hlY2tUb2tlbigpIHtcclxuICAgICAgICBjb25zdCBhcHBDaGVjayA9IHRoaXMuX2FwcENoZWNrUHJvdmlkZXIuZ2V0SW1tZWRpYXRlKHsgb3B0aW9uYWw6IHRydWUgfSk7XHJcbiAgICAgICAgaWYgKGFwcENoZWNrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGFwcENoZWNrLmdldFRva2VuKCk7XHJcbiAgICAgICAgICAgIC8vIFRPRE86IFdoYXQgZG8gd2Ugd2FudCB0byBkbyBpZiB0aGVyZSBpcyBhbiBlcnJvciBnZXR0aW5nIHRoZSB0b2tlbj9cclxuICAgICAgICAgICAgLy8gQ29udGV4dDogYXBwQ2hlY2suZ2V0VG9rZW4oKSB3aWxsIG5ldmVyIHRocm93IGV2ZW4gaWYgYW4gZXJyb3IgaGFwcGVuZWQuIEluIHRoZSBlcnJvciBjYXNlLCBhIGR1bW15IHRva2VuIHdpbGwgYmVcclxuICAgICAgICAgICAgLy8gcmV0dXJuZWQgYWxvbmcgd2l0aCBhbiBlcnJvciBmaWVsZCBkZXNjcmliaW5nIHRoZSBlcnJvci4gSW4gZ2VuZXJhbCwgd2Ugc2hvdWxkbid0IGNhcmUgYWJvdXQgdGhlIGVycm9yIGNvbmRpdGlvbiBhbmQganVzdCB1c2VcclxuICAgICAgICAgICAgLy8gdGhlIHRva2VuIChhY3R1YWwgb3IgZHVtbXkpIHRvIHNlbmQgcmVxdWVzdHMuXHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQudG9rZW47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBTdG9wIHJ1bm5pbmcgcmVxdWVzdHMgYW5kIHByZXZlbnQgbW9yZSBmcm9tIGJlaW5nIGNyZWF0ZWQuXHJcbiAgICAgKi9cclxuICAgIF9kZWxldGUoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLl9kZWxldGVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2RlbGV0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLl9yZXF1ZXN0cy5mb3JFYWNoKHJlcXVlc3QgPT4gcmVxdWVzdC5jYW5jZWwoKSk7XHJcbiAgICAgICAgICAgIHRoaXMuX3JlcXVlc3RzLmNsZWFyKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyBhIG5ldyBmaXJlYmFzZVN0b3JhZ2UuUmVmZXJlbmNlIG9iamVjdCByZWZlcmVuY2luZyB0aGlzIFN0b3JhZ2VTZXJ2aWNlXHJcbiAgICAgKiBhdCB0aGUgZ2l2ZW4gTG9jYXRpb24uXHJcbiAgICAgKi9cclxuICAgIF9tYWtlU3RvcmFnZVJlZmVyZW5jZShsb2MpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFJlZmVyZW5jZSh0aGlzLCBsb2MpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBAcGFyYW0gcmVxdWVzdEluZm8gLSBIVFRQIFJlcXVlc3RJbmZvIG9iamVjdFxyXG4gICAgICogQHBhcmFtIGF1dGhUb2tlbiAtIEZpcmViYXNlIGF1dGggdG9rZW5cclxuICAgICAqL1xyXG4gICAgX21ha2VSZXF1ZXN0KHJlcXVlc3RJbmZvLCBhdXRoVG9rZW4sIGFwcENoZWNrVG9rZW4pIHtcclxuICAgICAgICBpZiAoIXRoaXMuX2RlbGV0ZWQpIHtcclxuICAgICAgICAgICAgY29uc3QgcmVxdWVzdCA9IG1ha2VSZXF1ZXN0KHJlcXVlc3RJbmZvLCB0aGlzLl9hcHBJZCwgYXV0aFRva2VuLCBhcHBDaGVja1Rva2VuLCB0aGlzLl9wb29sLCB0aGlzLl9maXJlYmFzZVZlcnNpb24pO1xyXG4gICAgICAgICAgICB0aGlzLl9yZXF1ZXN0cy5hZGQocmVxdWVzdCk7XHJcbiAgICAgICAgICAgIC8vIFJlcXVlc3QgcmVtb3ZlcyBpdHNlbGYgZnJvbSBzZXQgd2hlbiBjb21wbGV0ZS5cclxuICAgICAgICAgICAgcmVxdWVzdC5nZXRQcm9taXNlKCkudGhlbigoKSA9PiB0aGlzLl9yZXF1ZXN0cy5kZWxldGUocmVxdWVzdCksICgpID0+IHRoaXMuX3JlcXVlc3RzLmRlbGV0ZShyZXF1ZXN0KSk7XHJcbiAgICAgICAgICAgIHJldHVybiByZXF1ZXN0O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBGYWlsUmVxdWVzdChhcHBEZWxldGVkKCkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGFzeW5jIG1ha2VSZXF1ZXN0V2l0aFRva2VucyhyZXF1ZXN0SW5mbykge1xyXG4gICAgICAgIGNvbnN0IFthdXRoVG9rZW4sIGFwcENoZWNrVG9rZW5dID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xyXG4gICAgICAgICAgICB0aGlzLl9nZXRBdXRoVG9rZW4oKSxcclxuICAgICAgICAgICAgdGhpcy5fZ2V0QXBwQ2hlY2tUb2tlbigpXHJcbiAgICAgICAgXSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX21ha2VSZXF1ZXN0KHJlcXVlc3RJbmZvLCBhdXRoVG9rZW4sIGFwcENoZWNrVG9rZW4pO1xyXG4gICAgfVxyXG59XG5cbmNvbnN0IG5hbWUgPSBcIkBmaXJlYmFzZS9zdG9yYWdlXCI7XG5jb25zdCB2ZXJzaW9uID0gXCIwLjguMVwiO1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogVHlwZSBjb25zdGFudCBmb3IgRmlyZWJhc2UgU3RvcmFnZS5cclxuICovXHJcbmNvbnN0IFNUT1JBR0VfVFlQRSA9ICdzdG9yYWdlJztcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFVwbG9hZHMgZGF0YSB0byB0aGlzIG9iamVjdCdzIGxvY2F0aW9uLlxyXG4gKiBUaGUgdXBsb2FkIGlzIG5vdCByZXN1bWFibGUuXHJcbiAqIEBwdWJsaWNcclxuICogQHBhcmFtIHJlZiAtIFN0b3JhZ2VSZWZlcmVuY2Ugd2hlcmUgZGF0YSBzaG91bGQgYmUgdXBsb2FkZWQuXHJcbiAqIEBwYXJhbSBkYXRhIC0gVGhlIGRhdGEgdG8gdXBsb2FkLlxyXG4gKiBAcGFyYW0gbWV0YWRhdGEgLSBNZXRhZGF0YSBmb3IgdGhlIGRhdGEgdG8gdXBsb2FkLlxyXG4gKiBAcmV0dXJucyBBIFByb21pc2UgY29udGFpbmluZyBhbiBVcGxvYWRSZXN1bHRcclxuICovXHJcbmZ1bmN0aW9uIHVwbG9hZEJ5dGVzKHJlZiwgZGF0YSwgbWV0YWRhdGEpIHtcclxuICAgIHJlZiA9IGdldE1vZHVsYXJJbnN0YW5jZShyZWYpO1xyXG4gICAgcmV0dXJuIHVwbG9hZEJ5dGVzJDEocmVmLCBkYXRhLCBtZXRhZGF0YSk7XHJcbn1cclxuLyoqXHJcbiAqIFVwbG9hZHMgYSBzdHJpbmcgdG8gdGhpcyBvYmplY3QncyBsb2NhdGlvbi5cclxuICogVGhlIHVwbG9hZCBpcyBub3QgcmVzdW1hYmxlLlxyXG4gKiBAcHVibGljXHJcbiAqIEBwYXJhbSByZWYgLSBTdG9yYWdlUmVmZXJlbmNlIHdoZXJlIHN0cmluZyBzaG91bGQgYmUgdXBsb2FkZWQuXHJcbiAqIEBwYXJhbSB2YWx1ZSAtIFRoZSBzdHJpbmcgdG8gdXBsb2FkLlxyXG4gKiBAcGFyYW0gZm9ybWF0IC0gVGhlIGZvcm1hdCBvZiB0aGUgc3RyaW5nIHRvIHVwbG9hZC5cclxuICogQHBhcmFtIG1ldGFkYXRhIC0gTWV0YWRhdGEgZm9yIHRoZSBzdHJpbmcgdG8gdXBsb2FkLlxyXG4gKiBAcmV0dXJucyBBIFByb21pc2UgY29udGFpbmluZyBhbiBVcGxvYWRSZXN1bHRcclxuICovXHJcbmZ1bmN0aW9uIHVwbG9hZFN0cmluZyhyZWYsIHZhbHVlLCBmb3JtYXQsIG1ldGFkYXRhKSB7XHJcbiAgICByZWYgPSBnZXRNb2R1bGFySW5zdGFuY2UocmVmKTtcclxuICAgIHJldHVybiB1cGxvYWRTdHJpbmckMShyZWYsIHZhbHVlLCBmb3JtYXQsIG1ldGFkYXRhKTtcclxufVxyXG4vKipcclxuICogVXBsb2FkcyBkYXRhIHRvIHRoaXMgb2JqZWN0J3MgbG9jYXRpb24uXHJcbiAqIFRoZSB1cGxvYWQgY2FuIGJlIHBhdXNlZCBhbmQgcmVzdW1lZCwgYW5kIGV4cG9zZXMgcHJvZ3Jlc3MgdXBkYXRlcy5cclxuICogQHB1YmxpY1xyXG4gKiBAcGFyYW0gcmVmIC0gU3RvcmFnZVJlZmVyZW5jZSB3aGVyZSBkYXRhIHNob3VsZCBiZSB1cGxvYWRlZC5cclxuICogQHBhcmFtIGRhdGEgLSBUaGUgZGF0YSB0byB1cGxvYWQuXHJcbiAqIEBwYXJhbSBtZXRhZGF0YSAtIE1ldGFkYXRhIGZvciB0aGUgZGF0YSB0byB1cGxvYWQuXHJcbiAqIEByZXR1cm5zIEFuIFVwbG9hZFRhc2tcclxuICovXHJcbmZ1bmN0aW9uIHVwbG9hZEJ5dGVzUmVzdW1hYmxlKHJlZiwgZGF0YSwgbWV0YWRhdGEpIHtcclxuICAgIHJlZiA9IGdldE1vZHVsYXJJbnN0YW5jZShyZWYpO1xyXG4gICAgcmV0dXJuIHVwbG9hZEJ5dGVzUmVzdW1hYmxlJDEocmVmLCBkYXRhLCBtZXRhZGF0YSk7XHJcbn1cclxuLyoqXHJcbiAqIEEgYFByb21pc2VgIHRoYXQgcmVzb2x2ZXMgd2l0aCB0aGUgbWV0YWRhdGEgZm9yIHRoaXMgb2JqZWN0LiBJZiB0aGlzXHJcbiAqIG9iamVjdCBkb2Vzbid0IGV4aXN0IG9yIG1ldGFkYXRhIGNhbm5vdCBiZSByZXRyZWl2ZWQsIHRoZSBwcm9taXNlIGlzXHJcbiAqIHJlamVjdGVkLlxyXG4gKiBAcHVibGljXHJcbiAqIEBwYXJhbSByZWYgLSB7QGxpbmsgU3RvcmFnZVJlZmVyZW5jZX0gdG8gZ2V0IG1ldGFkYXRhIGZyb20uXHJcbiAqL1xyXG5mdW5jdGlvbiBnZXRNZXRhZGF0YShyZWYpIHtcclxuICAgIHJlZiA9IGdldE1vZHVsYXJJbnN0YW5jZShyZWYpO1xyXG4gICAgcmV0dXJuIGdldE1ldGFkYXRhJDEocmVmKTtcclxufVxyXG4vKipcclxuICogVXBkYXRlcyB0aGUgbWV0YWRhdGEgZm9yIHRoaXMgb2JqZWN0LlxyXG4gKiBAcHVibGljXHJcbiAqIEBwYXJhbSByZWYgLSB7QGxpbmsgU3RvcmFnZVJlZmVyZW5jZX0gdG8gdXBkYXRlIG1ldGFkYXRhIGZvci5cclxuICogQHBhcmFtIG1ldGFkYXRhIC0gVGhlIG5ldyBtZXRhZGF0YSBmb3IgdGhlIG9iamVjdC5cclxuICogICAgIE9ubHkgdmFsdWVzIHRoYXQgaGF2ZSBiZWVuIGV4cGxpY2l0bHkgc2V0IHdpbGwgYmUgY2hhbmdlZC4gRXhwbGljaXRseVxyXG4gKiAgICAgc2V0dGluZyBhIHZhbHVlIHRvIG51bGwgd2lsbCByZW1vdmUgdGhlIG1ldGFkYXRhLlxyXG4gKiBAcmV0dXJucyBBIGBQcm9taXNlYCB0aGF0IHJlc29sdmVzIHdpdGggdGhlIG5ldyBtZXRhZGF0YSBmb3IgdGhpcyBvYmplY3QuXHJcbiAqL1xyXG5mdW5jdGlvbiB1cGRhdGVNZXRhZGF0YShyZWYsIG1ldGFkYXRhKSB7XHJcbiAgICByZWYgPSBnZXRNb2R1bGFySW5zdGFuY2UocmVmKTtcclxuICAgIHJldHVybiB1cGRhdGVNZXRhZGF0YSQxKHJlZiwgbWV0YWRhdGEpO1xyXG59XHJcbi8qKlxyXG4gKiBMaXN0IGl0ZW1zIChmaWxlcykgYW5kIHByZWZpeGVzIChmb2xkZXJzKSB1bmRlciB0aGlzIHN0b3JhZ2UgcmVmZXJlbmNlLlxyXG4gKlxyXG4gKiBMaXN0IEFQSSBpcyBvbmx5IGF2YWlsYWJsZSBmb3IgRmlyZWJhc2UgUnVsZXMgVmVyc2lvbiAyLlxyXG4gKlxyXG4gKiBHQ1MgaXMgYSBrZXktYmxvYiBzdG9yZS4gRmlyZWJhc2UgU3RvcmFnZSBpbXBvc2VzIHRoZSBzZW1hbnRpYyBvZiAnLydcclxuICogZGVsaW1pdGVkIGZvbGRlciBzdHJ1Y3R1cmUuXHJcbiAqIFJlZmVyIHRvIEdDUydzIExpc3QgQVBJIGlmIHlvdSB3YW50IHRvIGxlYXJuIG1vcmUuXHJcbiAqXHJcbiAqIFRvIGFkaGVyZSB0byBGaXJlYmFzZSBSdWxlcydzIFNlbWFudGljcywgRmlyZWJhc2UgU3RvcmFnZSBkb2VzIG5vdFxyXG4gKiBzdXBwb3J0IG9iamVjdHMgd2hvc2UgcGF0aHMgZW5kIHdpdGggXCIvXCIgb3IgY29udGFpbiB0d28gY29uc2VjdXRpdmVcclxuICogXCIvXCJzLiBGaXJlYmFzZSBTdG9yYWdlIExpc3QgQVBJIHdpbGwgZmlsdGVyIHRoZXNlIHVuc3VwcG9ydGVkIG9iamVjdHMuXHJcbiAqIGxpc3QoKSBtYXkgZmFpbCBpZiB0aGVyZSBhcmUgdG9vIG1hbnkgdW5zdXBwb3J0ZWQgb2JqZWN0cyBpbiB0aGUgYnVja2V0LlxyXG4gKiBAcHVibGljXHJcbiAqXHJcbiAqIEBwYXJhbSByZWYgLSB7QGxpbmsgU3RvcmFnZVJlZmVyZW5jZX0gdG8gZ2V0IGxpc3QgZnJvbS5cclxuICogQHBhcmFtIG9wdGlvbnMgLSBTZWUge0BsaW5rIExpc3RPcHRpb25zfSBmb3IgZGV0YWlscy5cclxuICogQHJldHVybnMgQSBgUHJvbWlzZWAgdGhhdCByZXNvbHZlcyB3aXRoIHRoZSBpdGVtcyBhbmQgcHJlZml4ZXMuXHJcbiAqICAgICAgYHByZWZpeGVzYCBjb250YWlucyByZWZlcmVuY2VzIHRvIHN1Yi1mb2xkZXJzIGFuZCBgaXRlbXNgXHJcbiAqICAgICAgY29udGFpbnMgcmVmZXJlbmNlcyB0byBvYmplY3RzIGluIHRoaXMgZm9sZGVyLiBgbmV4dFBhZ2VUb2tlbmBcclxuICogICAgICBjYW4gYmUgdXNlZCB0byBnZXQgdGhlIHJlc3Qgb2YgdGhlIHJlc3VsdHMuXHJcbiAqL1xyXG5mdW5jdGlvbiBsaXN0KHJlZiwgb3B0aW9ucykge1xyXG4gICAgcmVmID0gZ2V0TW9kdWxhckluc3RhbmNlKHJlZik7XHJcbiAgICByZXR1cm4gbGlzdCQxKHJlZiwgb3B0aW9ucyk7XHJcbn1cclxuLyoqXHJcbiAqIExpc3QgYWxsIGl0ZW1zIChmaWxlcykgYW5kIHByZWZpeGVzIChmb2xkZXJzKSB1bmRlciB0aGlzIHN0b3JhZ2UgcmVmZXJlbmNlLlxyXG4gKlxyXG4gKiBUaGlzIGlzIGEgaGVscGVyIG1ldGhvZCBmb3IgY2FsbGluZyBsaXN0KCkgcmVwZWF0ZWRseSB1bnRpbCB0aGVyZSBhcmVcclxuICogbm8gbW9yZSByZXN1bHRzLiBUaGUgZGVmYXVsdCBwYWdpbmF0aW9uIHNpemUgaXMgMTAwMC5cclxuICpcclxuICogTm90ZTogVGhlIHJlc3VsdHMgbWF5IG5vdCBiZSBjb25zaXN0ZW50IGlmIG9iamVjdHMgYXJlIGNoYW5nZWQgd2hpbGUgdGhpc1xyXG4gKiBvcGVyYXRpb24gaXMgcnVubmluZy5cclxuICpcclxuICogV2FybmluZzogYGxpc3RBbGxgIG1heSBwb3RlbnRpYWxseSBjb25zdW1lIHRvbyBtYW55IHJlc291cmNlcyBpZiB0aGVyZSBhcmVcclxuICogdG9vIG1hbnkgcmVzdWx0cy5cclxuICogQHB1YmxpY1xyXG4gKiBAcGFyYW0gcmVmIC0ge0BsaW5rIFN0b3JhZ2VSZWZlcmVuY2V9IHRvIGdldCBsaXN0IGZyb20uXHJcbiAqXHJcbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHRoYXQgcmVzb2x2ZXMgd2l0aCBhbGwgdGhlIGl0ZW1zIGFuZCBwcmVmaXhlcyB1bmRlclxyXG4gKiAgICAgIHRoZSBjdXJyZW50IHN0b3JhZ2UgcmVmZXJlbmNlLiBgcHJlZml4ZXNgIGNvbnRhaW5zIHJlZmVyZW5jZXMgdG9cclxuICogICAgICBzdWItZGlyZWN0b3JpZXMgYW5kIGBpdGVtc2AgY29udGFpbnMgcmVmZXJlbmNlcyB0byBvYmplY3RzIGluIHRoaXNcclxuICogICAgICBmb2xkZXIuIGBuZXh0UGFnZVRva2VuYCBpcyBuZXZlciByZXR1cm5lZC5cclxuICovXHJcbmZ1bmN0aW9uIGxpc3RBbGwocmVmKSB7XHJcbiAgICByZWYgPSBnZXRNb2R1bGFySW5zdGFuY2UocmVmKTtcclxuICAgIHJldHVybiBsaXN0QWxsJDEocmVmKTtcclxufVxyXG4vKipcclxuICogUmV0dXJucyB0aGUgZG93bmxvYWQgVVJMIGZvciB0aGUgZ2l2ZW4ge0BsaW5rIFN0b3JhZ2VSZWZlcmVuY2V9LlxyXG4gKiBAcHVibGljXHJcbiAqIEBwYXJhbSByZWYgLSB7QGxpbmsgU3RvcmFnZVJlZmVyZW5jZX0gdG8gZ2V0IHRoZSBkb3dubG9hZCBVUkwgZm9yLlxyXG4gKiBAcmV0dXJucyBBIGBQcm9taXNlYCB0aGF0IHJlc29sdmVzIHdpdGggdGhlIGRvd25sb2FkXHJcbiAqICAgICBVUkwgZm9yIHRoaXMgb2JqZWN0LlxyXG4gKi9cclxuZnVuY3Rpb24gZ2V0RG93bmxvYWRVUkwocmVmKSB7XHJcbiAgICByZWYgPSBnZXRNb2R1bGFySW5zdGFuY2UocmVmKTtcclxuICAgIHJldHVybiBnZXREb3dubG9hZFVSTCQxKHJlZik7XHJcbn1cclxuLyoqXHJcbiAqIERlbGV0ZXMgdGhlIG9iamVjdCBhdCB0aGlzIGxvY2F0aW9uLlxyXG4gKiBAcHVibGljXHJcbiAqIEBwYXJhbSByZWYgLSB7QGxpbmsgU3RvcmFnZVJlZmVyZW5jZX0gZm9yIG9iamVjdCB0byBkZWxldGUuXHJcbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHRoYXQgcmVzb2x2ZXMgaWYgdGhlIGRlbGV0aW9uIHN1Y2NlZWRzLlxyXG4gKi9cclxuZnVuY3Rpb24gZGVsZXRlT2JqZWN0KHJlZikge1xyXG4gICAgcmVmID0gZ2V0TW9kdWxhckluc3RhbmNlKHJlZik7XHJcbiAgICByZXR1cm4gZGVsZXRlT2JqZWN0JDEocmVmKTtcclxufVxyXG5mdW5jdGlvbiByZWYoc2VydmljZU9yUmVmLCBwYXRoT3JVcmwpIHtcclxuICAgIHNlcnZpY2VPclJlZiA9IGdldE1vZHVsYXJJbnN0YW5jZShzZXJ2aWNlT3JSZWYpO1xyXG4gICAgcmV0dXJuIHJlZiQxKHNlcnZpY2VPclJlZiwgcGF0aE9yVXJsKTtcclxufVxyXG4vKipcclxuICogQGludGVybmFsXHJcbiAqL1xyXG5mdW5jdGlvbiBfZ2V0Q2hpbGQocmVmLCBjaGlsZFBhdGgpIHtcclxuICAgIHJldHVybiBfZ2V0Q2hpbGQkMShyZWYsIGNoaWxkUGF0aCk7XHJcbn1cclxuLyoqXHJcbiAqIEdldHMgYSB7QGxpbmsgRmlyZWJhc2VTdG9yYWdlfSBpbnN0YW5jZSBmb3IgdGhlIGdpdmVuIEZpcmViYXNlIGFwcC5cclxuICogQHB1YmxpY1xyXG4gKiBAcGFyYW0gYXBwIC0gRmlyZWJhc2UgYXBwIHRvIGdldCB7QGxpbmsgRmlyZWJhc2VTdG9yYWdlfSBpbnN0YW5jZSBmb3IuXHJcbiAqIEBwYXJhbSBidWNrZXRVcmwgLSBUaGUgZ3M6Ly8gdXJsIHRvIHlvdXIgRmlyZWJhc2UgU3RvcmFnZSBCdWNrZXQuXHJcbiAqIElmIG5vdCBwYXNzZWQsIHVzZXMgdGhlIGFwcCdzIGRlZmF1bHQgU3RvcmFnZSBCdWNrZXQuXHJcbiAqIEByZXR1cm5zIEEge0BsaW5rIEZpcmViYXNlU3RvcmFnZX0gaW5zdGFuY2UuXHJcbiAqL1xyXG5mdW5jdGlvbiBnZXRTdG9yYWdlKGFwcCA9IGdldEFwcCgpLCBidWNrZXRVcmwpIHtcclxuICAgIGFwcCA9IGdldE1vZHVsYXJJbnN0YW5jZShhcHApO1xyXG4gICAgY29uc3Qgc3RvcmFnZVByb3ZpZGVyID0gX2dldFByb3ZpZGVyKGFwcCwgU1RPUkFHRV9UWVBFKTtcclxuICAgIGNvbnN0IHN0b3JhZ2VJbnN0YW5jZSA9IHN0b3JhZ2VQcm92aWRlci5nZXRJbW1lZGlhdGUoe1xyXG4gICAgICAgIGlkZW50aWZpZXI6IGJ1Y2tldFVybFxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gc3RvcmFnZUluc3RhbmNlO1xyXG59XHJcbi8qKlxyXG4gKiBNb2RpZnkgdGhpcyB7QGxpbmsgRmlyZWJhc2VTdG9yYWdlfSBpbnN0YW5jZSB0byBjb21tdW5pY2F0ZSB3aXRoIHRoZSBDbG91ZCBTdG9yYWdlIGVtdWxhdG9yLlxyXG4gKlxyXG4gKiBAcGFyYW0gc3RvcmFnZSAtIFRoZSB7QGxpbmsgRmlyZWJhc2VTdG9yYWdlfSBpbnN0YW5jZVxyXG4gKiBAcGFyYW0gaG9zdCAtIFRoZSBlbXVsYXRvciBob3N0IChleDogbG9jYWxob3N0KVxyXG4gKiBAcGFyYW0gcG9ydCAtIFRoZSBlbXVsYXRvciBwb3J0IChleDogNTAwMSlcclxuICogQHBhcmFtIG9wdGlvbnMubW9ja1VzZXJUb2tlbiAtIHRoZSBtb2NrIGF1dGggdG9rZW4gdG8gdXNlIGZvciB1bml0IHRlc3RpbmcgU2VjdXJpdHkgUnVsZXMuXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmZ1bmN0aW9uIGNvbm5lY3RTdG9yYWdlRW11bGF0b3Ioc3RvcmFnZSwgaG9zdCwgcG9ydCwgb3B0aW9ucyA9IHt9KSB7XHJcbiAgICBjb25uZWN0U3RvcmFnZUVtdWxhdG9yJDEoc3RvcmFnZSwgaG9zdCwgcG9ydCwgb3B0aW9ucyk7XHJcbn1cblxuLyoqXHJcbiAqIENsb3VkIFN0b3JhZ2UgZm9yIEZpcmViYXNlXHJcbiAqXHJcbiAqIEBwYWNrYWdlRG9jdW1lbnRhdGlvblxyXG4gKi9cclxuZnVuY3Rpb24gZmFjdG9yeShjb250YWluZXIsIHsgaW5zdGFuY2VJZGVudGlmaWVyOiB1cmwgfSkge1xyXG4gICAgY29uc3QgYXBwID0gY29udGFpbmVyLmdldFByb3ZpZGVyKCdhcHAnKS5nZXRJbW1lZGlhdGUoKTtcclxuICAgIGNvbnN0IGF1dGhQcm92aWRlciA9IGNvbnRhaW5lci5nZXRQcm92aWRlcignYXV0aC1pbnRlcm5hbCcpO1xyXG4gICAgY29uc3QgYXBwQ2hlY2tQcm92aWRlciA9IGNvbnRhaW5lci5nZXRQcm92aWRlcignYXBwLWNoZWNrLWludGVybmFsJyk7XHJcbiAgICByZXR1cm4gbmV3IEZpcmViYXNlU3RvcmFnZUltcGwoYXBwLCBhdXRoUHJvdmlkZXIsIGFwcENoZWNrUHJvdmlkZXIsIG5ldyBDb25uZWN0aW9uUG9vbCgpLCB1cmwsIFNES19WRVJTSU9OKTtcclxufVxyXG5mdW5jdGlvbiByZWdpc3RlclN0b3JhZ2UoKSB7XHJcbiAgICBfcmVnaXN0ZXJDb21wb25lbnQobmV3IENvbXBvbmVudChTVE9SQUdFX1RZUEUsIGZhY3RvcnksIFwiUFVCTElDXCIgLyogUFVCTElDICovKS5zZXRNdWx0aXBsZUluc3RhbmNlcyh0cnVlKSk7XHJcbiAgICByZWdpc3RlclZlcnNpb24obmFtZSwgdmVyc2lvbik7XHJcbn1cclxucmVnaXN0ZXJTdG9yYWdlKCk7XG5cbmV4cG9ydCB7IFN0cmluZ0Zvcm1hdCwgRmJzQmxvYiBhcyBfRmJzQmxvYiwgTG9jYXRpb24gYXMgX0xvY2F0aW9uLCBUYXNrRXZlbnQgYXMgX1Rhc2tFdmVudCwgVGFza1N0YXRlIGFzIF9UYXNrU3RhdGUsIFVwbG9hZFRhc2sgYXMgX1VwbG9hZFRhc2ssIGRhdGFGcm9tU3RyaW5nIGFzIF9kYXRhRnJvbVN0cmluZywgX2dldENoaWxkLCBpbnZhbGlkQXJndW1lbnQgYXMgX2ludmFsaWRBcmd1bWVudCwgaW52YWxpZFJvb3RPcGVyYXRpb24gYXMgX2ludmFsaWRSb290T3BlcmF0aW9uLCBjb25uZWN0U3RvcmFnZUVtdWxhdG9yLCBkZWxldGVPYmplY3QsIGdldERvd25sb2FkVVJMLCBnZXRNZXRhZGF0YSwgZ2V0U3RvcmFnZSwgbGlzdCwgbGlzdEFsbCwgcmVmLCB1cGRhdGVNZXRhZGF0YSwgdXBsb2FkQnl0ZXMsIHVwbG9hZEJ5dGVzUmVzdW1hYmxlLCB1cGxvYWRTdHJpbmcgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmVzbTIwMTcuanMubWFwXG4iLCJpbXBvcnQgeyBDb21wb25lbnQsIENvbXBvbmVudENvbnRhaW5lciB9IGZyb20gJ0BmaXJlYmFzZS9jb21wb25lbnQnO1xuaW1wb3J0IHsgTG9nZ2VyLCBzZXRVc2VyTG9nSGFuZGxlciwgc2V0TG9nTGV2ZWwgYXMgc2V0TG9nTGV2ZWwkMSB9IGZyb20gJ0BmaXJlYmFzZS9sb2dnZXInO1xuaW1wb3J0IHsgRXJyb3JGYWN0b3J5LCBkZWVwRXF1YWwgfSBmcm9tICdAZmlyZWJhc2UvdXRpbCc7XG5leHBvcnQgeyBGaXJlYmFzZUVycm9yIH0gZnJvbSAnQGZpcmViYXNlL3V0aWwnO1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jbGFzcyBQbGF0Zm9ybUxvZ2dlclNlcnZpY2VJbXBsIHtcclxuICAgIGNvbnN0cnVjdG9yKGNvbnRhaW5lcikge1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xyXG4gICAgfVxyXG4gICAgLy8gSW4gaW5pdGlhbCBpbXBsZW1lbnRhdGlvbiwgdGhpcyB3aWxsIGJlIGNhbGxlZCBieSBpbnN0YWxsYXRpb25zIG9uXHJcbiAgICAvLyBhdXRoIHRva2VuIHJlZnJlc2gsIGFuZCBpbnN0YWxsYXRpb25zIHdpbGwgc2VuZCB0aGlzIHN0cmluZy5cclxuICAgIGdldFBsYXRmb3JtSW5mb1N0cmluZygpIHtcclxuICAgICAgICBjb25zdCBwcm92aWRlcnMgPSB0aGlzLmNvbnRhaW5lci5nZXRQcm92aWRlcnMoKTtcclxuICAgICAgICAvLyBMb29wIHRocm91Z2ggcHJvdmlkZXJzIGFuZCBnZXQgbGlicmFyeS92ZXJzaW9uIHBhaXJzIGZyb20gYW55IHRoYXQgYXJlXHJcbiAgICAgICAgLy8gdmVyc2lvbiBjb21wb25lbnRzLlxyXG4gICAgICAgIHJldHVybiBwcm92aWRlcnNcclxuICAgICAgICAgICAgLm1hcChwcm92aWRlciA9PiB7XHJcbiAgICAgICAgICAgIGlmIChpc1ZlcnNpb25TZXJ2aWNlUHJvdmlkZXIocHJvdmlkZXIpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzZXJ2aWNlID0gcHJvdmlkZXIuZ2V0SW1tZWRpYXRlKCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYCR7c2VydmljZS5saWJyYXJ5fS8ke3NlcnZpY2UudmVyc2lvbn1gO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAuZmlsdGVyKGxvZ1N0cmluZyA9PiBsb2dTdHJpbmcpXHJcbiAgICAgICAgICAgIC5qb2luKCcgJyk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqXHJcbiAqIEBwYXJhbSBwcm92aWRlciBjaGVjayBpZiB0aGlzIHByb3ZpZGVyIHByb3ZpZGVzIGEgVmVyc2lvblNlcnZpY2VcclxuICpcclxuICogTk9URTogVXNpbmcgUHJvdmlkZXI8J2FwcC12ZXJzaW9uJz4gaXMgYSBoYWNrIHRvIGluZGljYXRlIHRoYXQgdGhlIHByb3ZpZGVyXHJcbiAqIHByb3ZpZGVzIFZlcnNpb25TZXJ2aWNlLiBUaGUgcHJvdmlkZXIgaXMgbm90IG5lY2Vzc2FyaWx5IGEgJ2FwcC12ZXJzaW9uJ1xyXG4gKiBwcm92aWRlci5cclxuICovXHJcbmZ1bmN0aW9uIGlzVmVyc2lvblNlcnZpY2VQcm92aWRlcihwcm92aWRlcikge1xyXG4gICAgY29uc3QgY29tcG9uZW50ID0gcHJvdmlkZXIuZ2V0Q29tcG9uZW50KCk7XHJcbiAgICByZXR1cm4gKGNvbXBvbmVudCA9PT0gbnVsbCB8fCBjb21wb25lbnQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGNvbXBvbmVudC50eXBlKSA9PT0gXCJWRVJTSU9OXCIgLyogVkVSU0lPTiAqLztcclxufVxuXG5jb25zdCBuYW1lJG8gPSBcIkBmaXJlYmFzZS9hcHBcIjtcbmNvbnN0IHZlcnNpb24kMSA9IFwiMC43LjBcIjtcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuY29uc3QgbG9nZ2VyID0gbmV3IExvZ2dlcignQGZpcmViYXNlL2FwcCcpO1xuXG5jb25zdCBuYW1lJG4gPSBcIkBmaXJlYmFzZS9hcHAtY29tcGF0XCI7XG5cbmNvbnN0IG5hbWUkbSA9IFwiQGZpcmViYXNlL2FuYWx5dGljcy1jb21wYXRcIjtcblxuY29uc3QgbmFtZSRsID0gXCJAZmlyZWJhc2UvYW5hbHl0aWNzXCI7XG5cbmNvbnN0IG5hbWUkayA9IFwiQGZpcmViYXNlL2FwcC1jaGVjay1jb21wYXRcIjtcblxuY29uc3QgbmFtZSRqID0gXCJAZmlyZWJhc2UvYXBwLWNoZWNrXCI7XG5cbmNvbnN0IG5hbWUkaSA9IFwiQGZpcmViYXNlL2F1dGhcIjtcblxuY29uc3QgbmFtZSRoID0gXCJAZmlyZWJhc2UvYXV0aC1jb21wYXRcIjtcblxuY29uc3QgbmFtZSRnID0gXCJAZmlyZWJhc2UvZGF0YWJhc2VcIjtcblxuY29uc3QgbmFtZSRmID0gXCJAZmlyZWJhc2UvZGF0YWJhc2UtY29tcGF0XCI7XG5cbmNvbnN0IG5hbWUkZSA9IFwiQGZpcmViYXNlL2Z1bmN0aW9uc1wiO1xuXG5jb25zdCBuYW1lJGQgPSBcIkBmaXJlYmFzZS9mdW5jdGlvbnMtY29tcGF0XCI7XG5cbmNvbnN0IG5hbWUkYyA9IFwiQGZpcmViYXNlL2luc3RhbGxhdGlvbnNcIjtcblxuY29uc3QgbmFtZSRiID0gXCJAZmlyZWJhc2UvaW5zdGFsbGF0aW9ucy1jb21wYXRcIjtcblxuY29uc3QgbmFtZSRhID0gXCJAZmlyZWJhc2UvbWVzc2FnaW5nXCI7XG5cbmNvbnN0IG5hbWUkOSA9IFwiQGZpcmViYXNlL21lc3NhZ2luZy1jb21wYXRcIjtcblxuY29uc3QgbmFtZSQ4ID0gXCJAZmlyZWJhc2UvcGVyZm9ybWFuY2VcIjtcblxuY29uc3QgbmFtZSQ3ID0gXCJAZmlyZWJhc2UvcGVyZm9ybWFuY2UtY29tcGF0XCI7XG5cbmNvbnN0IG5hbWUkNiA9IFwiQGZpcmViYXNlL3JlbW90ZS1jb25maWdcIjtcblxuY29uc3QgbmFtZSQ1ID0gXCJAZmlyZWJhc2UvcmVtb3RlLWNvbmZpZy1jb21wYXRcIjtcblxuY29uc3QgbmFtZSQ0ID0gXCJAZmlyZWJhc2Uvc3RvcmFnZVwiO1xuXG5jb25zdCBuYW1lJDMgPSBcIkBmaXJlYmFzZS9zdG9yYWdlLWNvbXBhdFwiO1xuXG5jb25zdCBuYW1lJDIgPSBcIkBmaXJlYmFzZS9maXJlc3RvcmVcIjtcblxuY29uc3QgbmFtZSQxID0gXCJAZmlyZWJhc2UvZmlyZXN0b3JlLWNvbXBhdFwiO1xuXG5jb25zdCBuYW1lID0gXCJmaXJlYmFzZVwiO1xuY29uc3QgdmVyc2lvbiA9IFwiOS4wLjBcIjtcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFRoZSBkZWZhdWx0IGFwcCBuYW1lXHJcbiAqXHJcbiAqIEBpbnRlcm5hbFxyXG4gKi9cclxuY29uc3QgREVGQVVMVF9FTlRSWV9OQU1FID0gJ1tERUZBVUxUXSc7XHJcbmNvbnN0IFBMQVRGT1JNX0xPR19TVFJJTkcgPSB7XHJcbiAgICBbbmFtZSRvXTogJ2ZpcmUtY29yZScsXHJcbiAgICBbbmFtZSRuXTogJ2ZpcmUtY29yZS1jb21wYXQnLFxyXG4gICAgW25hbWUkbF06ICdmaXJlLWFuYWx5dGljcycsXHJcbiAgICBbbmFtZSRtXTogJ2ZpcmUtYW5hbHl0aWNzLWNvbXBhdCcsXHJcbiAgICBbbmFtZSRqXTogJ2ZpcmUtYXBwLWNoZWNrJyxcclxuICAgIFtuYW1lJGtdOiAnZmlyZS1hcHAtY2hlY2stY29tcGF0JyxcclxuICAgIFtuYW1lJGldOiAnZmlyZS1hdXRoJyxcclxuICAgIFtuYW1lJGhdOiAnZmlyZS1hdXRoLWNvbXBhdCcsXHJcbiAgICBbbmFtZSRnXTogJ2ZpcmUtcnRkYicsXHJcbiAgICBbbmFtZSRmXTogJ2ZpcmUtcnRkYi1jb21wYXQnLFxyXG4gICAgW25hbWUkZV06ICdmaXJlLWZuJyxcclxuICAgIFtuYW1lJGRdOiAnZmlyZS1mbi1jb21wYXQnLFxyXG4gICAgW25hbWUkY106ICdmaXJlLWlpZCcsXHJcbiAgICBbbmFtZSRiXTogJ2ZpcmUtaWlkLWNvbXBhdCcsXHJcbiAgICBbbmFtZSRhXTogJ2ZpcmUtZmNtJyxcclxuICAgIFtuYW1lJDldOiAnZmlyZS1mY20tY29tcGF0JyxcclxuICAgIFtuYW1lJDhdOiAnZmlyZS1wZXJmJyxcclxuICAgIFtuYW1lJDddOiAnZmlyZS1wZXJmLWNvbXBhdCcsXHJcbiAgICBbbmFtZSQ2XTogJ2ZpcmUtcmMnLFxyXG4gICAgW25hbWUkNV06ICdmaXJlLXJjLWNvbXBhdCcsXHJcbiAgICBbbmFtZSQ0XTogJ2ZpcmUtZ2NzJyxcclxuICAgIFtuYW1lJDNdOiAnZmlyZS1nY3MtY29tcGF0JyxcclxuICAgIFtuYW1lJDJdOiAnZmlyZS1mc3QnLFxyXG4gICAgW25hbWUkMV06ICdmaXJlLWZzdC1jb21wYXQnLFxyXG4gICAgJ2ZpcmUtanMnOiAnZmlyZS1qcycsXHJcbiAgICBbbmFtZV06ICdmaXJlLWpzLWFsbCdcclxufTtcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEBpbnRlcm5hbFxyXG4gKi9cclxuY29uc3QgX2FwcHMgPSBuZXcgTWFwKCk7XHJcbi8qKlxyXG4gKiBSZWdpc3RlcmVkIGNvbXBvbmVudHMuXHJcbiAqXHJcbiAqIEBpbnRlcm5hbFxyXG4gKi9cclxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcclxuY29uc3QgX2NvbXBvbmVudHMgPSBuZXcgTWFwKCk7XHJcbi8qKlxyXG4gKiBAcGFyYW0gY29tcG9uZW50IC0gdGhlIGNvbXBvbmVudCBiZWluZyBhZGRlZCB0byB0aGlzIGFwcCdzIGNvbnRhaW5lclxyXG4gKlxyXG4gKiBAaW50ZXJuYWxcclxuICovXHJcbmZ1bmN0aW9uIF9hZGRDb21wb25lbnQoYXBwLCBjb21wb25lbnQpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXBwLmNvbnRhaW5lci5hZGRDb21wb25lbnQoY29tcG9uZW50KTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgbG9nZ2VyLmRlYnVnKGBDb21wb25lbnQgJHtjb21wb25lbnQubmFtZX0gZmFpbGVkIHRvIHJlZ2lzdGVyIHdpdGggRmlyZWJhc2VBcHAgJHthcHAubmFtZX1gLCBlKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICpcclxuICogQGludGVybmFsXHJcbiAqL1xyXG5mdW5jdGlvbiBfYWRkT3JPdmVyd3JpdGVDb21wb25lbnQoYXBwLCBjb21wb25lbnQpIHtcclxuICAgIGFwcC5jb250YWluZXIuYWRkT3JPdmVyd3JpdGVDb21wb25lbnQoY29tcG9uZW50KTtcclxufVxyXG4vKipcclxuICpcclxuICogQHBhcmFtIGNvbXBvbmVudCAtIHRoZSBjb21wb25lbnQgdG8gcmVnaXN0ZXJcclxuICogQHJldHVybnMgd2hldGhlciBvciBub3QgdGhlIGNvbXBvbmVudCBpcyByZWdpc3RlcmVkIHN1Y2Nlc3NmdWxseVxyXG4gKlxyXG4gKiBAaW50ZXJuYWxcclxuICovXHJcbmZ1bmN0aW9uIF9yZWdpc3RlckNvbXBvbmVudChjb21wb25lbnQpIHtcclxuICAgIGNvbnN0IGNvbXBvbmVudE5hbWUgPSBjb21wb25lbnQubmFtZTtcclxuICAgIGlmIChfY29tcG9uZW50cy5oYXMoY29tcG9uZW50TmFtZSkpIHtcclxuICAgICAgICBsb2dnZXIuZGVidWcoYFRoZXJlIHdlcmUgbXVsdGlwbGUgYXR0ZW1wdHMgdG8gcmVnaXN0ZXIgY29tcG9uZW50ICR7Y29tcG9uZW50TmFtZX0uYCk7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgX2NvbXBvbmVudHMuc2V0KGNvbXBvbmVudE5hbWUsIGNvbXBvbmVudCk7XHJcbiAgICAvLyBhZGQgdGhlIGNvbXBvbmVudCB0byBleGlzdGluZyBhcHAgaW5zdGFuY2VzXHJcbiAgICBmb3IgKGNvbnN0IGFwcCBvZiBfYXBwcy52YWx1ZXMoKSkge1xyXG4gICAgICAgIF9hZGRDb21wb25lbnQoYXBwLCBjb21wb25lbnQpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbn1cclxuLyoqXHJcbiAqXHJcbiAqIEBwYXJhbSBhcHAgLSBGaXJlYmFzZUFwcCBpbnN0YW5jZVxyXG4gKiBAcGFyYW0gbmFtZSAtIHNlcnZpY2UgbmFtZVxyXG4gKlxyXG4gKiBAcmV0dXJucyB0aGUgcHJvdmlkZXIgZm9yIHRoZSBzZXJ2aWNlIHdpdGggdGhlIG1hdGNoaW5nIG5hbWVcclxuICpcclxuICogQGludGVybmFsXHJcbiAqL1xyXG5mdW5jdGlvbiBfZ2V0UHJvdmlkZXIoYXBwLCBuYW1lKSB7XHJcbiAgICByZXR1cm4gYXBwLmNvbnRhaW5lci5nZXRQcm92aWRlcihuYW1lKTtcclxufVxyXG4vKipcclxuICpcclxuICogQHBhcmFtIGFwcCAtIEZpcmViYXNlQXBwIGluc3RhbmNlXHJcbiAqIEBwYXJhbSBuYW1lIC0gc2VydmljZSBuYW1lXHJcbiAqIEBwYXJhbSBpbnN0YW5jZUlkZW50aWZpZXIgLSBzZXJ2aWNlIGluc3RhbmNlIGlkZW50aWZpZXIgaW4gY2FzZSB0aGUgc2VydmljZSBzdXBwb3J0cyBtdWx0aXBsZSBpbnN0YW5jZXNcclxuICpcclxuICogQGludGVybmFsXHJcbiAqL1xyXG5mdW5jdGlvbiBfcmVtb3ZlU2VydmljZUluc3RhbmNlKGFwcCwgbmFtZSwgaW5zdGFuY2VJZGVudGlmaWVyID0gREVGQVVMVF9FTlRSWV9OQU1FKSB7XHJcbiAgICBfZ2V0UHJvdmlkZXIoYXBwLCBuYW1lKS5jbGVhckluc3RhbmNlKGluc3RhbmNlSWRlbnRpZmllcik7XHJcbn1cclxuLyoqXHJcbiAqIFRlc3Qgb25seVxyXG4gKlxyXG4gKiBAaW50ZXJuYWxcclxuICovXHJcbmZ1bmN0aW9uIF9jbGVhckNvbXBvbmVudHMoKSB7XHJcbiAgICBfY29tcG9uZW50cy5jbGVhcigpO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmNvbnN0IEVSUk9SUyA9IHtcclxuICAgIFtcIm5vLWFwcFwiIC8qIE5PX0FQUCAqL106IFwiTm8gRmlyZWJhc2UgQXBwICd7JGFwcE5hbWV9JyBoYXMgYmVlbiBjcmVhdGVkIC0gXCIgK1xyXG4gICAgICAgICdjYWxsIEZpcmViYXNlIEFwcC5pbml0aWFsaXplQXBwKCknLFxyXG4gICAgW1wiYmFkLWFwcC1uYW1lXCIgLyogQkFEX0FQUF9OQU1FICovXTogXCJJbGxlZ2FsIEFwcCBuYW1lOiAneyRhcHBOYW1lfVwiLFxyXG4gICAgW1wiZHVwbGljYXRlLWFwcFwiIC8qIERVUExJQ0FURV9BUFAgKi9dOiBcIkZpcmViYXNlIEFwcCBuYW1lZCAneyRhcHBOYW1lfScgYWxyZWFkeSBleGlzdHMgd2l0aCBkaWZmZXJlbnQgb3B0aW9ucyBvciBjb25maWdcIixcclxuICAgIFtcImFwcC1kZWxldGVkXCIgLyogQVBQX0RFTEVURUQgKi9dOiBcIkZpcmViYXNlIEFwcCBuYW1lZCAneyRhcHBOYW1lfScgYWxyZWFkeSBkZWxldGVkXCIsXHJcbiAgICBbXCJpbnZhbGlkLWFwcC1hcmd1bWVudFwiIC8qIElOVkFMSURfQVBQX0FSR1VNRU5UICovXTogJ2ZpcmViYXNlLnskYXBwTmFtZX0oKSB0YWtlcyBlaXRoZXIgbm8gYXJndW1lbnQgb3IgYSAnICtcclxuICAgICAgICAnRmlyZWJhc2UgQXBwIGluc3RhbmNlLicsXHJcbiAgICBbXCJpbnZhbGlkLWxvZy1hcmd1bWVudFwiIC8qIElOVkFMSURfTE9HX0FSR1VNRU5UICovXTogJ0ZpcnN0IGFyZ3VtZW50IHRvIGBvbkxvZ2AgbXVzdCBiZSBudWxsIG9yIGEgZnVuY3Rpb24uJ1xyXG59O1xyXG5jb25zdCBFUlJPUl9GQUNUT1JZID0gbmV3IEVycm9yRmFjdG9yeSgnYXBwJywgJ0ZpcmViYXNlJywgRVJST1JTKTtcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuY2xhc3MgRmlyZWJhc2VBcHBJbXBsIHtcclxuICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMsIGNvbmZpZywgY29udGFpbmVyKSB7XHJcbiAgICAgICAgdGhpcy5faXNEZWxldGVkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe30sIG9wdGlvbnMpO1xyXG4gICAgICAgIHRoaXMuX2NvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIGNvbmZpZyk7XHJcbiAgICAgICAgdGhpcy5fbmFtZSA9IGNvbmZpZy5uYW1lO1xyXG4gICAgICAgIHRoaXMuX2F1dG9tYXRpY0RhdGFDb2xsZWN0aW9uRW5hYmxlZCA9XHJcbiAgICAgICAgICAgIGNvbmZpZy5hdXRvbWF0aWNEYXRhQ29sbGVjdGlvbkVuYWJsZWQ7XHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyID0gY29udGFpbmVyO1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyLmFkZENvbXBvbmVudChuZXcgQ29tcG9uZW50KCdhcHAnLCAoKSA9PiB0aGlzLCBcIlBVQkxJQ1wiIC8qIFBVQkxJQyAqLykpO1xyXG4gICAgfVxyXG4gICAgZ2V0IGF1dG9tYXRpY0RhdGFDb2xsZWN0aW9uRW5hYmxlZCgpIHtcclxuICAgICAgICB0aGlzLmNoZWNrRGVzdHJveWVkKCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2F1dG9tYXRpY0RhdGFDb2xsZWN0aW9uRW5hYmxlZDtcclxuICAgIH1cclxuICAgIHNldCBhdXRvbWF0aWNEYXRhQ29sbGVjdGlvbkVuYWJsZWQodmFsKSB7XHJcbiAgICAgICAgdGhpcy5jaGVja0Rlc3Ryb3llZCgpO1xyXG4gICAgICAgIHRoaXMuX2F1dG9tYXRpY0RhdGFDb2xsZWN0aW9uRW5hYmxlZCA9IHZhbDtcclxuICAgIH1cclxuICAgIGdldCBuYW1lKCkge1xyXG4gICAgICAgIHRoaXMuY2hlY2tEZXN0cm95ZWQoKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5fbmFtZTtcclxuICAgIH1cclxuICAgIGdldCBvcHRpb25zKCkge1xyXG4gICAgICAgIHRoaXMuY2hlY2tEZXN0cm95ZWQoKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5fb3B0aW9ucztcclxuICAgIH1cclxuICAgIGdldCBjb25maWcoKSB7XHJcbiAgICAgICAgdGhpcy5jaGVja0Rlc3Ryb3llZCgpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9jb25maWc7XHJcbiAgICB9XHJcbiAgICBnZXQgY29udGFpbmVyKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9jb250YWluZXI7XHJcbiAgICB9XHJcbiAgICBnZXQgaXNEZWxldGVkKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9pc0RlbGV0ZWQ7XHJcbiAgICB9XHJcbiAgICBzZXQgaXNEZWxldGVkKHZhbCkge1xyXG4gICAgICAgIHRoaXMuX2lzRGVsZXRlZCA9IHZhbDtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogVGhpcyBmdW5jdGlvbiB3aWxsIHRocm93IGFuIEVycm9yIGlmIHRoZSBBcHAgaGFzIGFscmVhZHkgYmVlbiBkZWxldGVkIC1cclxuICAgICAqIHVzZSBiZWZvcmUgcGVyZm9ybWluZyBBUEkgYWN0aW9ucyBvbiB0aGUgQXBwLlxyXG4gICAgICovXHJcbiAgICBjaGVja0Rlc3Ryb3llZCgpIHtcclxuICAgICAgICBpZiAodGhpcy5pc0RlbGV0ZWQpIHtcclxuICAgICAgICAgICAgdGhyb3cgRVJST1JfRkFDVE9SWS5jcmVhdGUoXCJhcHAtZGVsZXRlZFwiIC8qIEFQUF9ERUxFVEVEICovLCB7IGFwcE5hbWU6IHRoaXMuX25hbWUgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBUaGUgY3VycmVudCBTREsgdmVyc2lvbi5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuY29uc3QgU0RLX1ZFUlNJT04gPSB2ZXJzaW9uO1xyXG5mdW5jdGlvbiBpbml0aWFsaXplQXBwKG9wdGlvbnMsIHJhd0NvbmZpZyA9IHt9KSB7XHJcbiAgICBpZiAodHlwZW9mIHJhd0NvbmZpZyAhPT0gJ29iamVjdCcpIHtcclxuICAgICAgICBjb25zdCBuYW1lID0gcmF3Q29uZmlnO1xyXG4gICAgICAgIHJhd0NvbmZpZyA9IHsgbmFtZSB9O1xyXG4gICAgfVxyXG4gICAgY29uc3QgY29uZmlnID0gT2JqZWN0LmFzc2lnbih7IG5hbWU6IERFRkFVTFRfRU5UUllfTkFNRSwgYXV0b21hdGljRGF0YUNvbGxlY3Rpb25FbmFibGVkOiBmYWxzZSB9LCByYXdDb25maWcpO1xyXG4gICAgY29uc3QgbmFtZSA9IGNvbmZpZy5uYW1lO1xyXG4gICAgaWYgKHR5cGVvZiBuYW1lICE9PSAnc3RyaW5nJyB8fCAhbmFtZSkge1xyXG4gICAgICAgIHRocm93IEVSUk9SX0ZBQ1RPUlkuY3JlYXRlKFwiYmFkLWFwcC1uYW1lXCIgLyogQkFEX0FQUF9OQU1FICovLCB7XHJcbiAgICAgICAgICAgIGFwcE5hbWU6IFN0cmluZyhuYW1lKVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgY29uc3QgZXhpc3RpbmdBcHAgPSBfYXBwcy5nZXQobmFtZSk7XHJcbiAgICBpZiAoZXhpc3RpbmdBcHApIHtcclxuICAgICAgICAvLyByZXR1cm4gdGhlIGV4aXN0aW5nIGFwcCBpZiBvcHRpb25zIGFuZCBjb25maWcgZGVlcCBlcXVhbCB0aGUgb25lcyBpbiB0aGUgZXhpc3RpbmcgYXBwLlxyXG4gICAgICAgIGlmIChkZWVwRXF1YWwob3B0aW9ucywgZXhpc3RpbmdBcHAub3B0aW9ucykgJiZcclxuICAgICAgICAgICAgZGVlcEVxdWFsKGNvbmZpZywgZXhpc3RpbmdBcHAuY29uZmlnKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZXhpc3RpbmdBcHA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aHJvdyBFUlJPUl9GQUNUT1JZLmNyZWF0ZShcImR1cGxpY2F0ZS1hcHBcIiAvKiBEVVBMSUNBVEVfQVBQICovLCB7IGFwcE5hbWU6IG5hbWUgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgY29uc3QgY29udGFpbmVyID0gbmV3IENvbXBvbmVudENvbnRhaW5lcihuYW1lKTtcclxuICAgIGZvciAoY29uc3QgY29tcG9uZW50IG9mIF9jb21wb25lbnRzLnZhbHVlcygpKSB7XHJcbiAgICAgICAgY29udGFpbmVyLmFkZENvbXBvbmVudChjb21wb25lbnQpO1xyXG4gICAgfVxyXG4gICAgY29uc3QgbmV3QXBwID0gbmV3IEZpcmViYXNlQXBwSW1wbChvcHRpb25zLCBjb25maWcsIGNvbnRhaW5lcik7XHJcbiAgICBfYXBwcy5zZXQobmFtZSwgbmV3QXBwKTtcclxuICAgIHJldHVybiBuZXdBcHA7XHJcbn1cclxuLyoqXHJcbiAqIFJldHJpZXZlcyBhIHtAbGluayBAZmlyZWJhc2UvYXBwI0ZpcmViYXNlQXBwfSBpbnN0YW5jZS5cclxuICpcclxuICogV2hlbiBjYWxsZWQgd2l0aCBubyBhcmd1bWVudHMsIHRoZSBkZWZhdWx0IGFwcCBpcyByZXR1cm5lZC4gV2hlbiBhbiBhcHAgbmFtZVxyXG4gKiBpcyBwcm92aWRlZCwgdGhlIGFwcCBjb3JyZXNwb25kaW5nIHRvIHRoYXQgbmFtZSBpcyByZXR1cm5lZC5cclxuICpcclxuICogQW4gZXhjZXB0aW9uIGlzIHRocm93biBpZiB0aGUgYXBwIGJlaW5nIHJldHJpZXZlZCBoYXMgbm90IHlldCBiZWVuXHJcbiAqIGluaXRpYWxpemVkLlxyXG4gKlxyXG4gKiBAZXhhbXBsZVxyXG4gKiBgYGBqYXZhc2NyaXB0XHJcbiAqIC8vIFJldHVybiB0aGUgZGVmYXVsdCBhcHBcclxuICogY29uc3QgYXBwID0gZ2V0QXBwKCk7XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBAZXhhbXBsZVxyXG4gKiBgYGBqYXZhc2NyaXB0XHJcbiAqIC8vIFJldHVybiBhIG5hbWVkIGFwcFxyXG4gKiBjb25zdCBvdGhlckFwcCA9IGdldEFwcChcIm90aGVyQXBwXCIpO1xyXG4gKiBgYGBcclxuICpcclxuICogQHBhcmFtIG5hbWUgLSBPcHRpb25hbCBuYW1lIG9mIHRoZSBhcHAgdG8gcmV0dXJuLiBJZiBubyBuYW1lIGlzXHJcbiAqICAgcHJvdmlkZWQsIHRoZSBkZWZhdWx0IGlzIGBcIltERUZBVUxUXVwiYC5cclxuICpcclxuICogQHJldHVybnMgVGhlIGFwcCBjb3JyZXNwb25kaW5nIHRvIHRoZSBwcm92aWRlZCBhcHAgbmFtZS5cclxuICogICBJZiBubyBhcHAgbmFtZSBpcyBwcm92aWRlZCwgdGhlIGRlZmF1bHQgYXBwIGlzIHJldHVybmVkLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5mdW5jdGlvbiBnZXRBcHAobmFtZSA9IERFRkFVTFRfRU5UUllfTkFNRSkge1xyXG4gICAgY29uc3QgYXBwID0gX2FwcHMuZ2V0KG5hbWUpO1xyXG4gICAgaWYgKCFhcHApIHtcclxuICAgICAgICB0aHJvdyBFUlJPUl9GQUNUT1JZLmNyZWF0ZShcIm5vLWFwcFwiIC8qIE5PX0FQUCAqLywgeyBhcHBOYW1lOiBuYW1lIH0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFwcDtcclxufVxyXG4vKipcclxuICogQSAocmVhZC1vbmx5KSBhcnJheSBvZiBhbGwgaW5pdGlhbGl6ZWQgYXBwcy5cclxuICogQHB1YmxpY1xyXG4gKi9cclxuZnVuY3Rpb24gZ2V0QXBwcygpIHtcclxuICAgIHJldHVybiBBcnJheS5mcm9tKF9hcHBzLnZhbHVlcygpKTtcclxufVxyXG4vKipcclxuICogUmVuZGVycyB0aGlzIGFwcCB1bnVzYWJsZSBhbmQgZnJlZXMgdGhlIHJlc291cmNlcyBvZiBhbGwgYXNzb2NpYXRlZFxyXG4gKiBzZXJ2aWNlcy5cclxuICpcclxuICogQGV4YW1wbGVcclxuICogYGBgamF2YXNjcmlwdFxyXG4gKiBkZWxldGVBcHAoYXBwKVxyXG4gKiAgIC50aGVuKGZ1bmN0aW9uKCkge1xyXG4gKiAgICAgY29uc29sZS5sb2coXCJBcHAgZGVsZXRlZCBzdWNjZXNzZnVsbHlcIik7XHJcbiAqICAgfSlcclxuICogICAuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHtcclxuICogICAgIGNvbnNvbGUubG9nKFwiRXJyb3IgZGVsZXRpbmcgYXBwOlwiLCBlcnJvcik7XHJcbiAqICAgfSk7XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBkZWxldGVBcHAoYXBwKSB7XHJcbiAgICBjb25zdCBuYW1lID0gYXBwLm5hbWU7XHJcbiAgICBpZiAoX2FwcHMuaGFzKG5hbWUpKSB7XHJcbiAgICAgICAgX2FwcHMuZGVsZXRlKG5hbWUpO1xyXG4gICAgICAgIGF3YWl0IFByb21pc2UuYWxsKGFwcC5jb250YWluZXJcclxuICAgICAgICAgICAgLmdldFByb3ZpZGVycygpXHJcbiAgICAgICAgICAgIC5tYXAocHJvdmlkZXIgPT4gcHJvdmlkZXIuZGVsZXRlKCkpKTtcclxuICAgICAgICBhcHAuaXNEZWxldGVkID0gdHJ1ZTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogUmVnaXN0ZXJzIGEgbGlicmFyeSdzIG5hbWUgYW5kIHZlcnNpb24gZm9yIHBsYXRmb3JtIGxvZ2dpbmcgcHVycG9zZXMuXHJcbiAqIEBwYXJhbSBsaWJyYXJ5IC0gTmFtZSBvZiAxcCBvciAzcCBsaWJyYXJ5IChlLmcuIGZpcmVzdG9yZSwgYW5ndWxhcmZpcmUpXHJcbiAqIEBwYXJhbSB2ZXJzaW9uIC0gQ3VycmVudCB2ZXJzaW9uIG9mIHRoYXQgbGlicmFyeS5cclxuICogQHBhcmFtIHZhcmlhbnQgLSBCdW5kbGUgdmFyaWFudCwgZS5nLiwgbm9kZSwgcm4sIGV0Yy5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuZnVuY3Rpb24gcmVnaXN0ZXJWZXJzaW9uKGxpYnJhcnlLZXlPck5hbWUsIHZlcnNpb24sIHZhcmlhbnQpIHtcclxuICAgIHZhciBfYTtcclxuICAgIC8vIFRPRE86IFdlIGNhbiB1c2UgdGhpcyBjaGVjayB0byB3aGl0ZWxpc3Qgc3RyaW5ncyB3aGVuL2lmIHdlIHNldCB1cFxyXG4gICAgLy8gYSBnb29kIHdoaXRlbGlzdCBzeXN0ZW0uXHJcbiAgICBsZXQgbGlicmFyeSA9IChfYSA9IFBMQVRGT1JNX0xPR19TVFJJTkdbbGlicmFyeUtleU9yTmFtZV0pICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IGxpYnJhcnlLZXlPck5hbWU7XHJcbiAgICBpZiAodmFyaWFudCkge1xyXG4gICAgICAgIGxpYnJhcnkgKz0gYC0ke3ZhcmlhbnR9YDtcclxuICAgIH1cclxuICAgIGNvbnN0IGxpYnJhcnlNaXNtYXRjaCA9IGxpYnJhcnkubWF0Y2goL1xcc3xcXC8vKTtcclxuICAgIGNvbnN0IHZlcnNpb25NaXNtYXRjaCA9IHZlcnNpb24ubWF0Y2goL1xcc3xcXC8vKTtcclxuICAgIGlmIChsaWJyYXJ5TWlzbWF0Y2ggfHwgdmVyc2lvbk1pc21hdGNoKSB7XHJcbiAgICAgICAgY29uc3Qgd2FybmluZyA9IFtcclxuICAgICAgICAgICAgYFVuYWJsZSB0byByZWdpc3RlciBsaWJyYXJ5IFwiJHtsaWJyYXJ5fVwiIHdpdGggdmVyc2lvbiBcIiR7dmVyc2lvbn1cIjpgXHJcbiAgICAgICAgXTtcclxuICAgICAgICBpZiAobGlicmFyeU1pc21hdGNoKSB7XHJcbiAgICAgICAgICAgIHdhcm5pbmcucHVzaChgbGlicmFyeSBuYW1lIFwiJHtsaWJyYXJ5fVwiIGNvbnRhaW5zIGlsbGVnYWwgY2hhcmFjdGVycyAod2hpdGVzcGFjZSBvciBcIi9cIilgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGxpYnJhcnlNaXNtYXRjaCAmJiB2ZXJzaW9uTWlzbWF0Y2gpIHtcclxuICAgICAgICAgICAgd2FybmluZy5wdXNoKCdhbmQnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHZlcnNpb25NaXNtYXRjaCkge1xyXG4gICAgICAgICAgICB3YXJuaW5nLnB1c2goYHZlcnNpb24gbmFtZSBcIiR7dmVyc2lvbn1cIiBjb250YWlucyBpbGxlZ2FsIGNoYXJhY3RlcnMgKHdoaXRlc3BhY2Ugb3IgXCIvXCIpYCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxvZ2dlci53YXJuKHdhcm5pbmcuam9pbignICcpKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBfcmVnaXN0ZXJDb21wb25lbnQobmV3IENvbXBvbmVudChgJHtsaWJyYXJ5fS12ZXJzaW9uYCwgKCkgPT4gKHsgbGlicmFyeSwgdmVyc2lvbiB9KSwgXCJWRVJTSU9OXCIgLyogVkVSU0lPTiAqLykpO1xyXG59XHJcbi8qKlxyXG4gKiBTZXRzIGxvZyBoYW5kbGVyIGZvciBhbGwgRmlyZWJhc2UgU0RLcy5cclxuICogQHBhcmFtIGxvZ0NhbGxiYWNrIC0gQW4gb3B0aW9uYWwgY3VzdG9tIGxvZyBoYW5kbGVyIHRoYXQgZXhlY3V0ZXMgdXNlciBjb2RlIHdoZW5ldmVyXHJcbiAqIHRoZSBGaXJlYmFzZSBTREsgbWFrZXMgYSBsb2dnaW5nIGNhbGwuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmZ1bmN0aW9uIG9uTG9nKGxvZ0NhbGxiYWNrLCBvcHRpb25zKSB7XHJcbiAgICBpZiAobG9nQ2FsbGJhY2sgIT09IG51bGwgJiYgdHlwZW9mIGxvZ0NhbGxiYWNrICE9PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgdGhyb3cgRVJST1JfRkFDVE9SWS5jcmVhdGUoXCJpbnZhbGlkLWxvZy1hcmd1bWVudFwiIC8qIElOVkFMSURfTE9HX0FSR1VNRU5UICovKTtcclxuICAgIH1cclxuICAgIHNldFVzZXJMb2dIYW5kbGVyKGxvZ0NhbGxiYWNrLCBvcHRpb25zKTtcclxufVxyXG4vKipcclxuICogU2V0cyBsb2cgbGV2ZWwgZm9yIGFsbCBGaXJlYmFzZSBTREtzLlxyXG4gKlxyXG4gKiBBbGwgb2YgdGhlIGxvZyB0eXBlcyBhYm92ZSB0aGUgY3VycmVudCBsb2cgbGV2ZWwgYXJlIGNhcHR1cmVkIChpLmUuIGlmXHJcbiAqIHlvdSBzZXQgdGhlIGxvZyBsZXZlbCB0byBgaW5mb2AsIGVycm9ycyBhcmUgbG9nZ2VkLCBidXQgYGRlYnVnYCBhbmRcclxuICogYHZlcmJvc2VgIGxvZ3MgYXJlIG5vdCkuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmZ1bmN0aW9uIHNldExvZ0xldmVsKGxvZ0xldmVsKSB7XHJcbiAgICBzZXRMb2dMZXZlbCQxKGxvZ0xldmVsKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5mdW5jdGlvbiByZWdpc3RlckNvcmVDb21wb25lbnRzKHZhcmlhbnQpIHtcclxuICAgIF9yZWdpc3RlckNvbXBvbmVudChuZXcgQ29tcG9uZW50KCdwbGF0Zm9ybS1sb2dnZXInLCBjb250YWluZXIgPT4gbmV3IFBsYXRmb3JtTG9nZ2VyU2VydmljZUltcGwoY29udGFpbmVyKSwgXCJQUklWQVRFXCIgLyogUFJJVkFURSAqLykpO1xyXG4gICAgLy8gUmVnaXN0ZXIgYGFwcGAgcGFja2FnZS5cclxuICAgIHJlZ2lzdGVyVmVyc2lvbihuYW1lJG8sIHZlcnNpb24kMSwgdmFyaWFudCk7XHJcbiAgICAvLyBSZWdpc3RlciBwbGF0Zm9ybSBTREsgaWRlbnRpZmllciAobm8gdmVyc2lvbikuXHJcbiAgICByZWdpc3RlclZlcnNpb24oJ2ZpcmUtanMnLCAnJyk7XHJcbn1cblxuLyoqXHJcbiAqIEZpcmViYXNlIEFwcFxyXG4gKlxyXG4gKiBAcmVtYXJrcyBUaGlzIHBhY2thZ2UgY29vcmRpbmF0ZXMgdGhlIGNvbW11bmljYXRpb24gYmV0d2VlbiB0aGUgZGlmZmVyZW50IEZpcmViYXNlIGNvbXBvbmVudHNcclxuICogQHBhY2thZ2VEb2N1bWVudGF0aW9uXHJcbiAqL1xyXG5yZWdpc3RlckNvcmVDb21wb25lbnRzKCk7XG5cbmV4cG9ydCB7IFNES19WRVJTSU9OLCBERUZBVUxUX0VOVFJZX05BTUUgYXMgX0RFRkFVTFRfRU5UUllfTkFNRSwgX2FkZENvbXBvbmVudCwgX2FkZE9yT3ZlcndyaXRlQ29tcG9uZW50LCBfYXBwcywgX2NsZWFyQ29tcG9uZW50cywgX2NvbXBvbmVudHMsIF9nZXRQcm92aWRlciwgX3JlZ2lzdGVyQ29tcG9uZW50LCBfcmVtb3ZlU2VydmljZUluc3RhbmNlLCBkZWxldGVBcHAsIGdldEFwcCwgZ2V0QXBwcywgaW5pdGlhbGl6ZUFwcCwgb25Mb2csIHJlZ2lzdGVyVmVyc2lvbiwgc2V0TG9nTGV2ZWwgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmVzbTIwMTcuanMubWFwXG4iLCIvKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZVxyXG50aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZVxyXG5MaWNlbnNlIGF0IGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG5cclxuVEhJUyBDT0RFIElTIFBST1ZJREVEIE9OIEFOICpBUyBJUyogQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxyXG5LSU5ELCBFSVRIRVIgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgV0lUSE9VVCBMSU1JVEFUSU9OIEFOWSBJTVBMSUVEXHJcbldBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBUSVRMRSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UsXHJcbk1FUkNIQU5UQUJMSVRZIE9SIE5PTi1JTkZSSU5HRU1FTlQuXHJcblxyXG5TZWUgdGhlIEFwYWNoZSBWZXJzaW9uIDIuMCBMaWNlbnNlIGZvciBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnNcclxuYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG5cclxuZnVuY3Rpb24gX19zcHJlYWRBcnJheXMoKSB7XHJcbiAgICBmb3IgKHZhciBzID0gMCwgaSA9IDAsIGlsID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IGlsOyBpKyspIHMgKz0gYXJndW1lbnRzW2ldLmxlbmd0aDtcclxuICAgIGZvciAodmFyIHIgPSBBcnJheShzKSwgayA9IDAsIGkgPSAwOyBpIDwgaWw7IGkrKylcclxuICAgICAgICBmb3IgKHZhciBhID0gYXJndW1lbnRzW2ldLCBqID0gMCwgamwgPSBhLmxlbmd0aDsgaiA8IGpsOyBqKyssIGsrKylcclxuICAgICAgICAgICAgcltrXSA9IGFbal07XHJcbiAgICByZXR1cm4gcjtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgX2E7XHJcbi8qKlxyXG4gKiBBIGNvbnRhaW5lciBmb3IgYWxsIG9mIHRoZSBMb2dnZXIgaW5zdGFuY2VzXHJcbiAqL1xyXG52YXIgaW5zdGFuY2VzID0gW107XHJcbi8qKlxyXG4gKiBUaGUgSlMgU0RLIHN1cHBvcnRzIDUgbG9nIGxldmVscyBhbmQgYWxzbyBhbGxvd3MgYSB1c2VyIHRoZSBhYmlsaXR5IHRvXHJcbiAqIHNpbGVuY2UgdGhlIGxvZ3MgYWx0b2dldGhlci5cclxuICpcclxuICogVGhlIG9yZGVyIGlzIGEgZm9sbG93czpcclxuICogREVCVUcgPCBWRVJCT1NFIDwgSU5GTyA8IFdBUk4gPCBFUlJPUlxyXG4gKlxyXG4gKiBBbGwgb2YgdGhlIGxvZyB0eXBlcyBhYm92ZSB0aGUgY3VycmVudCBsb2cgbGV2ZWwgd2lsbCBiZSBjYXB0dXJlZCAoaS5lLiBpZlxyXG4gKiB5b3Ugc2V0IHRoZSBsb2cgbGV2ZWwgdG8gYElORk9gLCBlcnJvcnMgd2lsbCBzdGlsbCBiZSBsb2dnZWQsIGJ1dCBgREVCVUdgIGFuZFxyXG4gKiBgVkVSQk9TRWAgbG9ncyB3aWxsIG5vdClcclxuICovXHJcbnZhciBMb2dMZXZlbDtcclxuKGZ1bmN0aW9uIChMb2dMZXZlbCkge1xyXG4gICAgTG9nTGV2ZWxbTG9nTGV2ZWxbXCJERUJVR1wiXSA9IDBdID0gXCJERUJVR1wiO1xyXG4gICAgTG9nTGV2ZWxbTG9nTGV2ZWxbXCJWRVJCT1NFXCJdID0gMV0gPSBcIlZFUkJPU0VcIjtcclxuICAgIExvZ0xldmVsW0xvZ0xldmVsW1wiSU5GT1wiXSA9IDJdID0gXCJJTkZPXCI7XHJcbiAgICBMb2dMZXZlbFtMb2dMZXZlbFtcIldBUk5cIl0gPSAzXSA9IFwiV0FSTlwiO1xyXG4gICAgTG9nTGV2ZWxbTG9nTGV2ZWxbXCJFUlJPUlwiXSA9IDRdID0gXCJFUlJPUlwiO1xyXG4gICAgTG9nTGV2ZWxbTG9nTGV2ZWxbXCJTSUxFTlRcIl0gPSA1XSA9IFwiU0lMRU5UXCI7XHJcbn0pKExvZ0xldmVsIHx8IChMb2dMZXZlbCA9IHt9KSk7XHJcbnZhciBsZXZlbFN0cmluZ1RvRW51bSA9IHtcclxuICAgICdkZWJ1Zyc6IExvZ0xldmVsLkRFQlVHLFxyXG4gICAgJ3ZlcmJvc2UnOiBMb2dMZXZlbC5WRVJCT1NFLFxyXG4gICAgJ2luZm8nOiBMb2dMZXZlbC5JTkZPLFxyXG4gICAgJ3dhcm4nOiBMb2dMZXZlbC5XQVJOLFxyXG4gICAgJ2Vycm9yJzogTG9nTGV2ZWwuRVJST1IsXHJcbiAgICAnc2lsZW50JzogTG9nTGV2ZWwuU0lMRU5UXHJcbn07XHJcbi8qKlxyXG4gKiBUaGUgZGVmYXVsdCBsb2cgbGV2ZWxcclxuICovXHJcbnZhciBkZWZhdWx0TG9nTGV2ZWwgPSBMb2dMZXZlbC5JTkZPO1xyXG4vKipcclxuICogQnkgZGVmYXVsdCwgYGNvbnNvbGUuZGVidWdgIGlzIG5vdCBkaXNwbGF5ZWQgaW4gdGhlIGRldmVsb3BlciBjb25zb2xlIChpblxyXG4gKiBjaHJvbWUpLiBUbyBhdm9pZCBmb3JjaW5nIHVzZXJzIHRvIGhhdmUgdG8gb3B0LWluIHRvIHRoZXNlIGxvZ3MgdHdpY2VcclxuICogKGkuZS4gb25jZSBmb3IgZmlyZWJhc2UsIGFuZCBvbmNlIGluIHRoZSBjb25zb2xlKSwgd2UgYXJlIHNlbmRpbmcgYERFQlVHYFxyXG4gKiBsb2dzIHRvIHRoZSBgY29uc29sZS5sb2dgIGZ1bmN0aW9uLlxyXG4gKi9cclxudmFyIENvbnNvbGVNZXRob2QgPSAoX2EgPSB7fSxcclxuICAgIF9hW0xvZ0xldmVsLkRFQlVHXSA9ICdsb2cnLFxyXG4gICAgX2FbTG9nTGV2ZWwuVkVSQk9TRV0gPSAnbG9nJyxcclxuICAgIF9hW0xvZ0xldmVsLklORk9dID0gJ2luZm8nLFxyXG4gICAgX2FbTG9nTGV2ZWwuV0FSTl0gPSAnd2FybicsXHJcbiAgICBfYVtMb2dMZXZlbC5FUlJPUl0gPSAnZXJyb3InLFxyXG4gICAgX2EpO1xyXG4vKipcclxuICogVGhlIGRlZmF1bHQgbG9nIGhhbmRsZXIgd2lsbCBmb3J3YXJkIERFQlVHLCBWRVJCT1NFLCBJTkZPLCBXQVJOLCBhbmQgRVJST1JcclxuICogbWVzc2FnZXMgb24gdG8gdGhlaXIgY29ycmVzcG9uZGluZyBjb25zb2xlIGNvdW50ZXJwYXJ0cyAoaWYgdGhlIGxvZyBtZXRob2RcclxuICogaXMgc3VwcG9ydGVkIGJ5IHRoZSBjdXJyZW50IGxvZyBsZXZlbClcclxuICovXHJcbnZhciBkZWZhdWx0TG9nSGFuZGxlciA9IGZ1bmN0aW9uIChpbnN0YW5jZSwgbG9nVHlwZSkge1xyXG4gICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgIGZvciAodmFyIF9pID0gMjsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgYXJnc1tfaSAtIDJdID0gYXJndW1lbnRzW19pXTtcclxuICAgIH1cclxuICAgIGlmIChsb2dUeXBlIDwgaW5zdGFuY2UubG9nTGV2ZWwpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB2YXIgbm93ID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xyXG4gICAgdmFyIG1ldGhvZCA9IENvbnNvbGVNZXRob2RbbG9nVHlwZV07XHJcbiAgICBpZiAobWV0aG9kKSB7XHJcbiAgICAgICAgY29uc29sZVttZXRob2RdLmFwcGx5KGNvbnNvbGUsIF9fc3ByZWFkQXJyYXlzKFtcIltcIiArIG5vdyArIFwiXSAgXCIgKyBpbnN0YW5jZS5uYW1lICsgXCI6XCJdLCBhcmdzKSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBdHRlbXB0ZWQgdG8gbG9nIGEgbWVzc2FnZSB3aXRoIGFuIGludmFsaWQgbG9nVHlwZSAodmFsdWU6IFwiICsgbG9nVHlwZSArIFwiKVwiKTtcclxuICAgIH1cclxufTtcclxudmFyIExvZ2dlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIC8qKlxyXG4gICAgICogR2l2ZXMgeW91IGFuIGluc3RhbmNlIG9mIGEgTG9nZ2VyIHRvIGNhcHR1cmUgbWVzc2FnZXMgYWNjb3JkaW5nIHRvXHJcbiAgICAgKiBGaXJlYmFzZSdzIGxvZ2dpbmcgc2NoZW1lLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBuYW1lIFRoZSBuYW1lIHRoYXQgdGhlIGxvZ3Mgd2lsbCBiZSBhc3NvY2lhdGVkIHdpdGhcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gTG9nZ2VyKG5hbWUpIHtcclxuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRoZSBsb2cgbGV2ZWwgb2YgdGhlIGdpdmVuIExvZ2dlciBpbnN0YW5jZS5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLl9sb2dMZXZlbCA9IGRlZmF1bHRMb2dMZXZlbDtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBUaGUgbWFpbiAoaW50ZXJuYWwpIGxvZyBoYW5kbGVyIGZvciB0aGUgTG9nZ2VyIGluc3RhbmNlLlxyXG4gICAgICAgICAqIENhbiBiZSBzZXQgdG8gYSBuZXcgZnVuY3Rpb24gaW4gaW50ZXJuYWwgcGFja2FnZSBjb2RlIGJ1dCBub3QgYnkgdXNlci5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLl9sb2dIYW5kbGVyID0gZGVmYXVsdExvZ0hhbmRsZXI7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIG9wdGlvbmFsLCBhZGRpdGlvbmFsLCB1c2VyLWRlZmluZWQgbG9nIGhhbmRsZXIgZm9yIHRoZSBMb2dnZXIgaW5zdGFuY2UuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5fdXNlckxvZ0hhbmRsZXIgPSBudWxsO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIENhcHR1cmUgdGhlIGN1cnJlbnQgaW5zdGFuY2UgZm9yIGxhdGVyIHVzZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGluc3RhbmNlcy5wdXNoKHRoaXMpO1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KExvZ2dlci5wcm90b3R5cGUsIFwibG9nTGV2ZWxcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbG9nTGV2ZWw7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWwpIHtcclxuICAgICAgICAgICAgaWYgKCEodmFsIGluIExvZ0xldmVsKSkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkludmFsaWQgdmFsdWUgXFxcIlwiICsgdmFsICsgXCJcXFwiIGFzc2lnbmVkIHRvIGBsb2dMZXZlbGBcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5fbG9nTGV2ZWwgPSB2YWw7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgLy8gV29ya2Fyb3VuZCBmb3Igc2V0dGVyL2dldHRlciBoYXZpbmcgdG8gYmUgdGhlIHNhbWUgdHlwZS5cclxuICAgIExvZ2dlci5wcm90b3R5cGUuc2V0TG9nTGV2ZWwgPSBmdW5jdGlvbiAodmFsKSB7XHJcbiAgICAgICAgdGhpcy5fbG9nTGV2ZWwgPSB0eXBlb2YgdmFsID09PSAnc3RyaW5nJyA/IGxldmVsU3RyaW5nVG9FbnVtW3ZhbF0gOiB2YWw7XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KExvZ2dlci5wcm90b3R5cGUsIFwibG9nSGFuZGxlclwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9sb2dIYW5kbGVyO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsKSB7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsICE9PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdWYWx1ZSBhc3NpZ25lZCB0byBgbG9nSGFuZGxlcmAgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5fbG9nSGFuZGxlciA9IHZhbDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTG9nZ2VyLnByb3RvdHlwZSwgXCJ1c2VyTG9nSGFuZGxlclwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl91c2VyTG9nSGFuZGxlcjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbCkge1xyXG4gICAgICAgICAgICB0aGlzLl91c2VyTG9nSGFuZGxlciA9IHZhbDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICAvKipcclxuICAgICAqIFRoZSBmdW5jdGlvbnMgYmVsb3cgYXJlIGFsbCBiYXNlZCBvbiB0aGUgYGNvbnNvbGVgIGludGVyZmFjZVxyXG4gICAgICovXHJcbiAgICBMb2dnZXIucHJvdG90eXBlLmRlYnVnID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBhcmdzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl91c2VyTG9nSGFuZGxlciAmJiB0aGlzLl91c2VyTG9nSGFuZGxlci5hcHBseSh0aGlzLCBfX3NwcmVhZEFycmF5cyhbdGhpcywgTG9nTGV2ZWwuREVCVUddLCBhcmdzKSk7XHJcbiAgICAgICAgdGhpcy5fbG9nSGFuZGxlci5hcHBseSh0aGlzLCBfX3NwcmVhZEFycmF5cyhbdGhpcywgTG9nTGV2ZWwuREVCVUddLCBhcmdzKSk7XHJcbiAgICB9O1xyXG4gICAgTG9nZ2VyLnByb3RvdHlwZS5sb2cgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX3VzZXJMb2dIYW5kbGVyICYmIHRoaXMuX3VzZXJMb2dIYW5kbGVyLmFwcGx5KHRoaXMsIF9fc3ByZWFkQXJyYXlzKFt0aGlzLCBMb2dMZXZlbC5WRVJCT1NFXSwgYXJncykpO1xyXG4gICAgICAgIHRoaXMuX2xvZ0hhbmRsZXIuYXBwbHkodGhpcywgX19zcHJlYWRBcnJheXMoW3RoaXMsIExvZ0xldmVsLlZFUkJPU0VdLCBhcmdzKSk7XHJcbiAgICB9O1xyXG4gICAgTG9nZ2VyLnByb3RvdHlwZS5pbmZvID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBhcmdzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl91c2VyTG9nSGFuZGxlciAmJiB0aGlzLl91c2VyTG9nSGFuZGxlci5hcHBseSh0aGlzLCBfX3NwcmVhZEFycmF5cyhbdGhpcywgTG9nTGV2ZWwuSU5GT10sIGFyZ3MpKTtcclxuICAgICAgICB0aGlzLl9sb2dIYW5kbGVyLmFwcGx5KHRoaXMsIF9fc3ByZWFkQXJyYXlzKFt0aGlzLCBMb2dMZXZlbC5JTkZPXSwgYXJncykpO1xyXG4gICAgfTtcclxuICAgIExvZ2dlci5wcm90b3R5cGUud2FybiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgYXJncyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fdXNlckxvZ0hhbmRsZXIgJiYgdGhpcy5fdXNlckxvZ0hhbmRsZXIuYXBwbHkodGhpcywgX19zcHJlYWRBcnJheXMoW3RoaXMsIExvZ0xldmVsLldBUk5dLCBhcmdzKSk7XHJcbiAgICAgICAgdGhpcy5fbG9nSGFuZGxlci5hcHBseSh0aGlzLCBfX3NwcmVhZEFycmF5cyhbdGhpcywgTG9nTGV2ZWwuV0FSTl0sIGFyZ3MpKTtcclxuICAgIH07XHJcbiAgICBMb2dnZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBhcmdzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl91c2VyTG9nSGFuZGxlciAmJiB0aGlzLl91c2VyTG9nSGFuZGxlci5hcHBseSh0aGlzLCBfX3NwcmVhZEFycmF5cyhbdGhpcywgTG9nTGV2ZWwuRVJST1JdLCBhcmdzKSk7XHJcbiAgICAgICAgdGhpcy5fbG9nSGFuZGxlci5hcHBseSh0aGlzLCBfX3NwcmVhZEFycmF5cyhbdGhpcywgTG9nTGV2ZWwuRVJST1JdLCBhcmdzKSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIExvZ2dlcjtcclxufSgpKTtcclxuZnVuY3Rpb24gc2V0TG9nTGV2ZWwobGV2ZWwpIHtcclxuICAgIGluc3RhbmNlcy5mb3JFYWNoKGZ1bmN0aW9uIChpbnN0KSB7XHJcbiAgICAgICAgaW5zdC5zZXRMb2dMZXZlbChsZXZlbCk7XHJcbiAgICB9KTtcclxufVxyXG5mdW5jdGlvbiBzZXRVc2VyTG9nSGFuZGxlcihsb2dDYWxsYmFjaywgb3B0aW9ucykge1xyXG4gICAgdmFyIF9sb29wXzEgPSBmdW5jdGlvbiAoaW5zdGFuY2UpIHtcclxuICAgICAgICB2YXIgY3VzdG9tTG9nTGV2ZWwgPSBudWxsO1xyXG4gICAgICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnMubGV2ZWwpIHtcclxuICAgICAgICAgICAgY3VzdG9tTG9nTGV2ZWwgPSBsZXZlbFN0cmluZ1RvRW51bVtvcHRpb25zLmxldmVsXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGxvZ0NhbGxiYWNrID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGluc3RhbmNlLnVzZXJMb2dIYW5kbGVyID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGluc3RhbmNlLnVzZXJMb2dIYW5kbGVyID0gZnVuY3Rpb24gKGluc3RhbmNlLCBsZXZlbCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMjsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXJnc1tfaSAtIDJdID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gYXJnc1xyXG4gICAgICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKGFyZykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChhcmcgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mIGFyZyA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFyZztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mIGFyZyA9PT0gJ251bWJlcicgfHwgdHlwZW9mIGFyZyA9PT0gJ2Jvb2xlYW4nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhcmcudG9TdHJpbmcoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoYXJnIGluc3RhbmNlb2YgRXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFyZy5tZXNzYWdlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShhcmcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChpZ25vcmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoYXJnKSB7IHJldHVybiBhcmc7IH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmpvaW4oJyAnKTtcclxuICAgICAgICAgICAgICAgIGlmIChsZXZlbCA+PSAoY3VzdG9tTG9nTGV2ZWwgIT09IG51bGwgJiYgY3VzdG9tTG9nTGV2ZWwgIT09IHZvaWQgMCA/IGN1c3RvbUxvZ0xldmVsIDogaW5zdGFuY2UubG9nTGV2ZWwpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9nQ2FsbGJhY2soe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXZlbDogTG9nTGV2ZWxbbGV2ZWxdLnRvTG93ZXJDYXNlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3M6IGFyZ3MsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IGluc3RhbmNlLm5hbWVcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgZm9yICh2YXIgX2kgPSAwLCBpbnN0YW5jZXNfMSA9IGluc3RhbmNlczsgX2kgPCBpbnN0YW5jZXNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICB2YXIgaW5zdGFuY2UgPSBpbnN0YW5jZXNfMVtfaV07XHJcbiAgICAgICAgX2xvb3BfMShpbnN0YW5jZSk7XHJcbiAgICB9XHJcbn1cblxuZXhwb3J0IHsgTG9nTGV2ZWwsIExvZ2dlciwgc2V0TG9nTGV2ZWwsIHNldFVzZXJMb2dIYW5kbGVyIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5lc20uanMubWFwXG4iLCJpbXBvcnQgeyBfX2Fzc2lnbiwgX19leHRlbmRzIH0gZnJvbSAndHNsaWInO1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogQGZpbGVvdmVydmlldyBGaXJlYmFzZSBjb25zdGFudHMuICBTb21lIG9mIHRoZXNlIChAZGVmaW5lcykgY2FuIGJlIG92ZXJyaWRkZW4gYXQgY29tcGlsZS10aW1lLlxyXG4gKi9cclxudmFyIENPTlNUQU5UUyA9IHtcclxuICAgIC8qKlxyXG4gICAgICogQGRlZmluZSB7Ym9vbGVhbn0gV2hldGhlciB0aGlzIGlzIHRoZSBjbGllbnQgTm9kZS5qcyBTREsuXHJcbiAgICAgKi9cclxuICAgIE5PREVfQ0xJRU5UOiBmYWxzZSxcclxuICAgIC8qKlxyXG4gICAgICogQGRlZmluZSB7Ym9vbGVhbn0gV2hldGhlciB0aGlzIGlzIHRoZSBBZG1pbiBOb2RlLmpzIFNESy5cclxuICAgICAqL1xyXG4gICAgTk9ERV9BRE1JTjogZmFsc2UsXHJcbiAgICAvKipcclxuICAgICAqIEZpcmViYXNlIFNESyBWZXJzaW9uXHJcbiAgICAgKi9cclxuICAgIFNES19WRVJTSU9OOiAnJHtKU0NPUkVfVkVSU0lPTn0nXHJcbn07XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBUaHJvd3MgYW4gZXJyb3IgaWYgdGhlIHByb3ZpZGVkIGFzc2VydGlvbiBpcyBmYWxzeVxyXG4gKi9cclxudmFyIGFzc2VydCA9IGZ1bmN0aW9uIChhc3NlcnRpb24sIG1lc3NhZ2UpIHtcclxuICAgIGlmICghYXNzZXJ0aW9uKSB7XHJcbiAgICAgICAgdGhyb3cgYXNzZXJ0aW9uRXJyb3IobWVzc2FnZSk7XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiBSZXR1cm5zIGFuIEVycm9yIG9iamVjdCBzdWl0YWJsZSBmb3IgdGhyb3dpbmcuXHJcbiAqL1xyXG52YXIgYXNzZXJ0aW9uRXJyb3IgPSBmdW5jdGlvbiAobWVzc2FnZSkge1xyXG4gICAgcmV0dXJuIG5ldyBFcnJvcignRmlyZWJhc2UgRGF0YWJhc2UgKCcgK1xyXG4gICAgICAgIENPTlNUQU5UUy5TREtfVkVSU0lPTiArXHJcbiAgICAgICAgJykgSU5URVJOQUwgQVNTRVJUIEZBSUxFRDogJyArXHJcbiAgICAgICAgbWVzc2FnZSk7XHJcbn07XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBzdHJpbmdUb0J5dGVBcnJheSQxID0gZnVuY3Rpb24gKHN0cikge1xyXG4gICAgLy8gVE9ETyh1c2VyKTogVXNlIG5hdGl2ZSBpbXBsZW1lbnRhdGlvbnMgaWYvd2hlbiBhdmFpbGFibGVcclxuICAgIHZhciBvdXQgPSBbXTtcclxuICAgIHZhciBwID0gMDtcclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgdmFyIGMgPSBzdHIuY2hhckNvZGVBdChpKTtcclxuICAgICAgICBpZiAoYyA8IDEyOCkge1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IGM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGMgPCAyMDQ4KSB7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgPj4gNikgfCAxOTI7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgJiA2MykgfCAxMjg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKChjICYgMHhmYzAwKSA9PT0gMHhkODAwICYmXHJcbiAgICAgICAgICAgIGkgKyAxIDwgc3RyLmxlbmd0aCAmJlxyXG4gICAgICAgICAgICAoc3RyLmNoYXJDb2RlQXQoaSArIDEpICYgMHhmYzAwKSA9PT0gMHhkYzAwKSB7XHJcbiAgICAgICAgICAgIC8vIFN1cnJvZ2F0ZSBQYWlyXHJcbiAgICAgICAgICAgIGMgPSAweDEwMDAwICsgKChjICYgMHgwM2ZmKSA8PCAxMCkgKyAoc3RyLmNoYXJDb2RlQXQoKytpKSAmIDB4MDNmZik7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgPj4gMTgpIHwgMjQwO1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9ICgoYyA+PiAxMikgJiA2MykgfCAxMjg7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKChjID4+IDYpICYgNjMpIHwgMTI4O1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjICYgNjMpIHwgMTI4O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoYyA+PiAxMikgfCAyMjQ7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKChjID4+IDYpICYgNjMpIHwgMTI4O1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjICYgNjMpIHwgMTI4O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBvdXQ7XHJcbn07XHJcbi8qKlxyXG4gKiBUdXJucyBhbiBhcnJheSBvZiBudW1iZXJzIGludG8gdGhlIHN0cmluZyBnaXZlbiBieSB0aGUgY29uY2F0ZW5hdGlvbiBvZiB0aGVcclxuICogY2hhcmFjdGVycyB0byB3aGljaCB0aGUgbnVtYmVycyBjb3JyZXNwb25kLlxyXG4gKiBAcGFyYW0gYnl0ZXMgQXJyYXkgb2YgbnVtYmVycyByZXByZXNlbnRpbmcgY2hhcmFjdGVycy5cclxuICogQHJldHVybiBTdHJpbmdpZmljYXRpb24gb2YgdGhlIGFycmF5LlxyXG4gKi9cclxudmFyIGJ5dGVBcnJheVRvU3RyaW5nID0gZnVuY3Rpb24gKGJ5dGVzKSB7XHJcbiAgICAvLyBUT0RPKHVzZXIpOiBVc2UgbmF0aXZlIGltcGxlbWVudGF0aW9ucyBpZi93aGVuIGF2YWlsYWJsZVxyXG4gICAgdmFyIG91dCA9IFtdO1xyXG4gICAgdmFyIHBvcyA9IDAsIGMgPSAwO1xyXG4gICAgd2hpbGUgKHBvcyA8IGJ5dGVzLmxlbmd0aCkge1xyXG4gICAgICAgIHZhciBjMSA9IGJ5dGVzW3BvcysrXTtcclxuICAgICAgICBpZiAoYzEgPCAxMjgpIHtcclxuICAgICAgICAgICAgb3V0W2MrK10gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGMxKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoYzEgPiAxOTEgJiYgYzEgPCAyMjQpIHtcclxuICAgICAgICAgICAgdmFyIGMyID0gYnl0ZXNbcG9zKytdO1xyXG4gICAgICAgICAgICBvdXRbYysrXSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoKChjMSAmIDMxKSA8PCA2KSB8IChjMiAmIDYzKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGMxID4gMjM5ICYmIGMxIDwgMzY1KSB7XHJcbiAgICAgICAgICAgIC8vIFN1cnJvZ2F0ZSBQYWlyXHJcbiAgICAgICAgICAgIHZhciBjMiA9IGJ5dGVzW3BvcysrXTtcclxuICAgICAgICAgICAgdmFyIGMzID0gYnl0ZXNbcG9zKytdO1xyXG4gICAgICAgICAgICB2YXIgYzQgPSBieXRlc1twb3MrK107XHJcbiAgICAgICAgICAgIHZhciB1ID0gKCgoYzEgJiA3KSA8PCAxOCkgfCAoKGMyICYgNjMpIDw8IDEyKSB8ICgoYzMgJiA2MykgPDwgNikgfCAoYzQgJiA2MykpIC1cclxuICAgICAgICAgICAgICAgIDB4MTAwMDA7XHJcbiAgICAgICAgICAgIG91dFtjKytdID0gU3RyaW5nLmZyb21DaGFyQ29kZSgweGQ4MDAgKyAodSA+PiAxMCkpO1xyXG4gICAgICAgICAgICBvdXRbYysrXSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoMHhkYzAwICsgKHUgJiAxMDIzKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgYzIgPSBieXRlc1twb3MrK107XHJcbiAgICAgICAgICAgIHZhciBjMyA9IGJ5dGVzW3BvcysrXTtcclxuICAgICAgICAgICAgb3V0W2MrK10gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKCgoYzEgJiAxNSkgPDwgMTIpIHwgKChjMiAmIDYzKSA8PCA2KSB8IChjMyAmIDYzKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG91dC5qb2luKCcnKTtcclxufTtcclxuLy8gV2UgZGVmaW5lIGl0IGFzIGFuIG9iamVjdCBsaXRlcmFsIGluc3RlYWQgb2YgYSBjbGFzcyBiZWNhdXNlIGEgY2xhc3MgY29tcGlsZWQgZG93biB0byBlczUgY2FuJ3RcclxuLy8gYmUgdHJlZXNoYWtlZC4gaHR0cHM6Ly9naXRodWIuY29tL3JvbGx1cC9yb2xsdXAvaXNzdWVzLzE2OTFcclxuLy8gU3RhdGljIGxvb2t1cCBtYXBzLCBsYXppbHkgcG9wdWxhdGVkIGJ5IGluaXRfKClcclxudmFyIGJhc2U2NCA9IHtcclxuICAgIC8qKlxyXG4gICAgICogTWFwcyBieXRlcyB0byBjaGFyYWN0ZXJzLlxyXG4gICAgICovXHJcbiAgICBieXRlVG9DaGFyTWFwXzogbnVsbCxcclxuICAgIC8qKlxyXG4gICAgICogTWFwcyBjaGFyYWN0ZXJzIHRvIGJ5dGVzLlxyXG4gICAgICovXHJcbiAgICBjaGFyVG9CeXRlTWFwXzogbnVsbCxcclxuICAgIC8qKlxyXG4gICAgICogTWFwcyBieXRlcyB0byB3ZWJzYWZlIGNoYXJhY3RlcnMuXHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICovXHJcbiAgICBieXRlVG9DaGFyTWFwV2ViU2FmZV86IG51bGwsXHJcbiAgICAvKipcclxuICAgICAqIE1hcHMgd2Vic2FmZSBjaGFyYWN0ZXJzIHRvIGJ5dGVzLlxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqL1xyXG4gICAgY2hhclRvQnl0ZU1hcFdlYlNhZmVfOiBudWxsLFxyXG4gICAgLyoqXHJcbiAgICAgKiBPdXIgZGVmYXVsdCBhbHBoYWJldCwgc2hhcmVkIGJldHdlZW5cclxuICAgICAqIEVOQ09ERURfVkFMUyBhbmQgRU5DT0RFRF9WQUxTX1dFQlNBRkVcclxuICAgICAqL1xyXG4gICAgRU5DT0RFRF9WQUxTX0JBU0U6ICdBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWicgKyAnYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXonICsgJzAxMjM0NTY3ODknLFxyXG4gICAgLyoqXHJcbiAgICAgKiBPdXIgZGVmYXVsdCBhbHBoYWJldC4gVmFsdWUgNjQgKD0pIGlzIHNwZWNpYWw7IGl0IG1lYW5zIFwibm90aGluZy5cIlxyXG4gICAgICovXHJcbiAgICBnZXQgRU5DT0RFRF9WQUxTKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLkVOQ09ERURfVkFMU19CQVNFICsgJysvPSc7XHJcbiAgICB9LFxyXG4gICAgLyoqXHJcbiAgICAgKiBPdXIgd2Vic2FmZSBhbHBoYWJldC5cclxuICAgICAqL1xyXG4gICAgZ2V0IEVOQ09ERURfVkFMU19XRUJTQUZFKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLkVOQ09ERURfVkFMU19CQVNFICsgJy1fLic7XHJcbiAgICB9LFxyXG4gICAgLyoqXHJcbiAgICAgKiBXaGV0aGVyIHRoaXMgYnJvd3NlciBzdXBwb3J0cyB0aGUgYXRvYiBhbmQgYnRvYSBmdW5jdGlvbnMuIFRoaXMgZXh0ZW5zaW9uXHJcbiAgICAgKiBzdGFydGVkIGF0IE1vemlsbGEgYnV0IGlzIG5vdyBpbXBsZW1lbnRlZCBieSBtYW55IGJyb3dzZXJzLiBXZSB1c2UgdGhlXHJcbiAgICAgKiBBU1NVTUVfKiB2YXJpYWJsZXMgdG8gYXZvaWQgcHVsbGluZyBpbiB0aGUgZnVsbCB1c2VyYWdlbnQgZGV0ZWN0aW9uIGxpYnJhcnlcclxuICAgICAqIGJ1dCBzdGlsbCBhbGxvd2luZyB0aGUgc3RhbmRhcmQgcGVyLWJyb3dzZXIgY29tcGlsYXRpb25zLlxyXG4gICAgICpcclxuICAgICAqL1xyXG4gICAgSEFTX05BVElWRV9TVVBQT1JUOiB0eXBlb2YgYXRvYiA9PT0gJ2Z1bmN0aW9uJyxcclxuICAgIC8qKlxyXG4gICAgICogQmFzZTY0LWVuY29kZSBhbiBhcnJheSBvZiBieXRlcy5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gaW5wdXQgQW4gYXJyYXkgb2YgYnl0ZXMgKG51bWJlcnMgd2l0aFxyXG4gICAgICogICAgIHZhbHVlIGluIFswLCAyNTVdKSB0byBlbmNvZGUuXHJcbiAgICAgKiBAcGFyYW0gd2ViU2FmZSBCb29sZWFuIGluZGljYXRpbmcgd2Ugc2hvdWxkIHVzZSB0aGVcclxuICAgICAqICAgICBhbHRlcm5hdGl2ZSBhbHBoYWJldC5cclxuICAgICAqIEByZXR1cm4gVGhlIGJhc2U2NCBlbmNvZGVkIHN0cmluZy5cclxuICAgICAqL1xyXG4gICAgZW5jb2RlQnl0ZUFycmF5OiBmdW5jdGlvbiAoaW5wdXQsIHdlYlNhZmUpIHtcclxuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoaW5wdXQpKSB7XHJcbiAgICAgICAgICAgIHRocm93IEVycm9yKCdlbmNvZGVCeXRlQXJyYXkgdGFrZXMgYW4gYXJyYXkgYXMgYSBwYXJhbWV0ZXInKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pbml0XygpO1xyXG4gICAgICAgIHZhciBieXRlVG9DaGFyTWFwID0gd2ViU2FmZVxyXG4gICAgICAgICAgICA/IHRoaXMuYnl0ZVRvQ2hhck1hcFdlYlNhZmVfXHJcbiAgICAgICAgICAgIDogdGhpcy5ieXRlVG9DaGFyTWFwXztcclxuICAgICAgICB2YXIgb3V0cHV0ID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpbnB1dC5sZW5ndGg7IGkgKz0gMykge1xyXG4gICAgICAgICAgICB2YXIgYnl0ZTEgPSBpbnB1dFtpXTtcclxuICAgICAgICAgICAgdmFyIGhhdmVCeXRlMiA9IGkgKyAxIDwgaW5wdXQubGVuZ3RoO1xyXG4gICAgICAgICAgICB2YXIgYnl0ZTIgPSBoYXZlQnl0ZTIgPyBpbnB1dFtpICsgMV0gOiAwO1xyXG4gICAgICAgICAgICB2YXIgaGF2ZUJ5dGUzID0gaSArIDIgPCBpbnB1dC5sZW5ndGg7XHJcbiAgICAgICAgICAgIHZhciBieXRlMyA9IGhhdmVCeXRlMyA/IGlucHV0W2kgKyAyXSA6IDA7XHJcbiAgICAgICAgICAgIHZhciBvdXRCeXRlMSA9IGJ5dGUxID4+IDI7XHJcbiAgICAgICAgICAgIHZhciBvdXRCeXRlMiA9ICgoYnl0ZTEgJiAweDAzKSA8PCA0KSB8IChieXRlMiA+PiA0KTtcclxuICAgICAgICAgICAgdmFyIG91dEJ5dGUzID0gKChieXRlMiAmIDB4MGYpIDw8IDIpIHwgKGJ5dGUzID4+IDYpO1xyXG4gICAgICAgICAgICB2YXIgb3V0Qnl0ZTQgPSBieXRlMyAmIDB4M2Y7XHJcbiAgICAgICAgICAgIGlmICghaGF2ZUJ5dGUzKSB7XHJcbiAgICAgICAgICAgICAgICBvdXRCeXRlNCA9IDY0O1xyXG4gICAgICAgICAgICAgICAgaWYgKCFoYXZlQnl0ZTIpIHtcclxuICAgICAgICAgICAgICAgICAgICBvdXRCeXRlMyA9IDY0O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG91dHB1dC5wdXNoKGJ5dGVUb0NoYXJNYXBbb3V0Qnl0ZTFdLCBieXRlVG9DaGFyTWFwW291dEJ5dGUyXSwgYnl0ZVRvQ2hhck1hcFtvdXRCeXRlM10sIGJ5dGVUb0NoYXJNYXBbb3V0Qnl0ZTRdKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG91dHB1dC5qb2luKCcnKTtcclxuICAgIH0sXHJcbiAgICAvKipcclxuICAgICAqIEJhc2U2NC1lbmNvZGUgYSBzdHJpbmcuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGlucHV0IEEgc3RyaW5nIHRvIGVuY29kZS5cclxuICAgICAqIEBwYXJhbSB3ZWJTYWZlIElmIHRydWUsIHdlIHNob3VsZCB1c2UgdGhlXHJcbiAgICAgKiAgICAgYWx0ZXJuYXRpdmUgYWxwaGFiZXQuXHJcbiAgICAgKiBAcmV0dXJuIFRoZSBiYXNlNjQgZW5jb2RlZCBzdHJpbmcuXHJcbiAgICAgKi9cclxuICAgIGVuY29kZVN0cmluZzogZnVuY3Rpb24gKGlucHV0LCB3ZWJTYWZlKSB7XHJcbiAgICAgICAgLy8gU2hvcnRjdXQgZm9yIE1vemlsbGEgYnJvd3NlcnMgdGhhdCBpbXBsZW1lbnRcclxuICAgICAgICAvLyBhIG5hdGl2ZSBiYXNlNjQgZW5jb2RlciBpbiB0aGUgZm9ybSBvZiBcImJ0b2EvYXRvYlwiXHJcbiAgICAgICAgaWYgKHRoaXMuSEFTX05BVElWRV9TVVBQT1JUICYmICF3ZWJTYWZlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBidG9hKGlucHV0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZW5jb2RlQnl0ZUFycmF5KHN0cmluZ1RvQnl0ZUFycmF5JDEoaW5wdXQpLCB3ZWJTYWZlKTtcclxuICAgIH0sXHJcbiAgICAvKipcclxuICAgICAqIEJhc2U2NC1kZWNvZGUgYSBzdHJpbmcuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGlucHV0IHRvIGRlY29kZS5cclxuICAgICAqIEBwYXJhbSB3ZWJTYWZlIFRydWUgaWYgd2Ugc2hvdWxkIHVzZSB0aGVcclxuICAgICAqICAgICBhbHRlcm5hdGl2ZSBhbHBoYWJldC5cclxuICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGluZyB0aGUgZGVjb2RlZCB2YWx1ZS5cclxuICAgICAqL1xyXG4gICAgZGVjb2RlU3RyaW5nOiBmdW5jdGlvbiAoaW5wdXQsIHdlYlNhZmUpIHtcclxuICAgICAgICAvLyBTaG9ydGN1dCBmb3IgTW96aWxsYSBicm93c2VycyB0aGF0IGltcGxlbWVudFxyXG4gICAgICAgIC8vIGEgbmF0aXZlIGJhc2U2NCBlbmNvZGVyIGluIHRoZSBmb3JtIG9mIFwiYnRvYS9hdG9iXCJcclxuICAgICAgICBpZiAodGhpcy5IQVNfTkFUSVZFX1NVUFBPUlQgJiYgIXdlYlNhZmUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGF0b2IoaW5wdXQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYnl0ZUFycmF5VG9TdHJpbmcodGhpcy5kZWNvZGVTdHJpbmdUb0J5dGVBcnJheShpbnB1dCwgd2ViU2FmZSkpO1xyXG4gICAgfSxcclxuICAgIC8qKlxyXG4gICAgICogQmFzZTY0LWRlY29kZSBhIHN0cmluZy5cclxuICAgICAqXHJcbiAgICAgKiBJbiBiYXNlLTY0IGRlY29kaW5nLCBncm91cHMgb2YgZm91ciBjaGFyYWN0ZXJzIGFyZSBjb252ZXJ0ZWQgaW50byB0aHJlZVxyXG4gICAgICogYnl0ZXMuICBJZiB0aGUgZW5jb2RlciBkaWQgbm90IGFwcGx5IHBhZGRpbmcsIHRoZSBpbnB1dCBsZW5ndGggbWF5IG5vdFxyXG4gICAgICogYmUgYSBtdWx0aXBsZSBvZiA0LlxyXG4gICAgICpcclxuICAgICAqIEluIHRoaXMgY2FzZSwgdGhlIGxhc3QgZ3JvdXAgd2lsbCBoYXZlIGZld2VyIHRoYW4gNCBjaGFyYWN0ZXJzLCBhbmRcclxuICAgICAqIHBhZGRpbmcgd2lsbCBiZSBpbmZlcnJlZC4gIElmIHRoZSBncm91cCBoYXMgb25lIG9yIHR3byBjaGFyYWN0ZXJzLCBpdCBkZWNvZGVzXHJcbiAgICAgKiB0byBvbmUgYnl0ZS4gIElmIHRoZSBncm91cCBoYXMgdGhyZWUgY2hhcmFjdGVycywgaXQgZGVjb2RlcyB0byB0d28gYnl0ZXMuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGlucHV0IElucHV0IHRvIGRlY29kZS5cclxuICAgICAqIEBwYXJhbSB3ZWJTYWZlIFRydWUgaWYgd2Ugc2hvdWxkIHVzZSB0aGUgd2ViLXNhZmUgYWxwaGFiZXQuXHJcbiAgICAgKiBAcmV0dXJuIGJ5dGVzIHJlcHJlc2VudGluZyB0aGUgZGVjb2RlZCB2YWx1ZS5cclxuICAgICAqL1xyXG4gICAgZGVjb2RlU3RyaW5nVG9CeXRlQXJyYXk6IGZ1bmN0aW9uIChpbnB1dCwgd2ViU2FmZSkge1xyXG4gICAgICAgIHRoaXMuaW5pdF8oKTtcclxuICAgICAgICB2YXIgY2hhclRvQnl0ZU1hcCA9IHdlYlNhZmVcclxuICAgICAgICAgICAgPyB0aGlzLmNoYXJUb0J5dGVNYXBXZWJTYWZlX1xyXG4gICAgICAgICAgICA6IHRoaXMuY2hhclRvQnl0ZU1hcF87XHJcbiAgICAgICAgdmFyIG91dHB1dCA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaW5wdXQubGVuZ3RoOykge1xyXG4gICAgICAgICAgICB2YXIgYnl0ZTEgPSBjaGFyVG9CeXRlTWFwW2lucHV0LmNoYXJBdChpKyspXTtcclxuICAgICAgICAgICAgdmFyIGhhdmVCeXRlMiA9IGkgPCBpbnB1dC5sZW5ndGg7XHJcbiAgICAgICAgICAgIHZhciBieXRlMiA9IGhhdmVCeXRlMiA/IGNoYXJUb0J5dGVNYXBbaW5wdXQuY2hhckF0KGkpXSA6IDA7XHJcbiAgICAgICAgICAgICsraTtcclxuICAgICAgICAgICAgdmFyIGhhdmVCeXRlMyA9IGkgPCBpbnB1dC5sZW5ndGg7XHJcbiAgICAgICAgICAgIHZhciBieXRlMyA9IGhhdmVCeXRlMyA/IGNoYXJUb0J5dGVNYXBbaW5wdXQuY2hhckF0KGkpXSA6IDY0O1xyXG4gICAgICAgICAgICArK2k7XHJcbiAgICAgICAgICAgIHZhciBoYXZlQnl0ZTQgPSBpIDwgaW5wdXQubGVuZ3RoO1xyXG4gICAgICAgICAgICB2YXIgYnl0ZTQgPSBoYXZlQnl0ZTQgPyBjaGFyVG9CeXRlTWFwW2lucHV0LmNoYXJBdChpKV0gOiA2NDtcclxuICAgICAgICAgICAgKytpO1xyXG4gICAgICAgICAgICBpZiAoYnl0ZTEgPT0gbnVsbCB8fCBieXRlMiA9PSBudWxsIHx8IGJ5dGUzID09IG51bGwgfHwgYnl0ZTQgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgRXJyb3IoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgb3V0Qnl0ZTEgPSAoYnl0ZTEgPDwgMikgfCAoYnl0ZTIgPj4gNCk7XHJcbiAgICAgICAgICAgIG91dHB1dC5wdXNoKG91dEJ5dGUxKTtcclxuICAgICAgICAgICAgaWYgKGJ5dGUzICE9PSA2NCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG91dEJ5dGUyID0gKChieXRlMiA8PCA0KSAmIDB4ZjApIHwgKGJ5dGUzID4+IDIpO1xyXG4gICAgICAgICAgICAgICAgb3V0cHV0LnB1c2gob3V0Qnl0ZTIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGJ5dGU0ICE9PSA2NCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBvdXRCeXRlMyA9ICgoYnl0ZTMgPDwgNikgJiAweGMwKSB8IGJ5dGU0O1xyXG4gICAgICAgICAgICAgICAgICAgIG91dHB1dC5wdXNoKG91dEJ5dGUzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gb3V0cHV0O1xyXG4gICAgfSxcclxuICAgIC8qKlxyXG4gICAgICogTGF6eSBzdGF0aWMgaW5pdGlhbGl6YXRpb24gZnVuY3Rpb24uIENhbGxlZCBiZWZvcmVcclxuICAgICAqIGFjY2Vzc2luZyBhbnkgb2YgdGhlIHN0YXRpYyBtYXAgdmFyaWFibGVzLlxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqL1xyXG4gICAgaW5pdF86IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAoIXRoaXMuYnl0ZVRvQ2hhck1hcF8pIHtcclxuICAgICAgICAgICAgdGhpcy5ieXRlVG9DaGFyTWFwXyA9IHt9O1xyXG4gICAgICAgICAgICB0aGlzLmNoYXJUb0J5dGVNYXBfID0ge307XHJcbiAgICAgICAgICAgIHRoaXMuYnl0ZVRvQ2hhck1hcFdlYlNhZmVfID0ge307XHJcbiAgICAgICAgICAgIHRoaXMuY2hhclRvQnl0ZU1hcFdlYlNhZmVfID0ge307XHJcbiAgICAgICAgICAgIC8vIFdlIHdhbnQgcXVpY2sgbWFwcGluZ3MgYmFjayBhbmQgZm9ydGgsIHNvIHdlIHByZWNvbXB1dGUgdHdvIG1hcHMuXHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5FTkNPREVEX1ZBTFMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYnl0ZVRvQ2hhck1hcF9baV0gPSB0aGlzLkVOQ09ERURfVkFMUy5jaGFyQXQoaSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoYXJUb0J5dGVNYXBfW3RoaXMuYnl0ZVRvQ2hhck1hcF9baV1dID0gaTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYnl0ZVRvQ2hhck1hcFdlYlNhZmVfW2ldID0gdGhpcy5FTkNPREVEX1ZBTFNfV0VCU0FGRS5jaGFyQXQoaSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoYXJUb0J5dGVNYXBXZWJTYWZlX1t0aGlzLmJ5dGVUb0NoYXJNYXBXZWJTYWZlX1tpXV0gPSBpO1xyXG4gICAgICAgICAgICAgICAgLy8gQmUgZm9yZ2l2aW5nIHdoZW4gZGVjb2RpbmcgYW5kIGNvcnJlY3RseSBkZWNvZGUgYm90aCBlbmNvZGluZ3MuXHJcbiAgICAgICAgICAgICAgICBpZiAoaSA+PSB0aGlzLkVOQ09ERURfVkFMU19CQVNFLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2hhclRvQnl0ZU1hcF9bdGhpcy5FTkNPREVEX1ZBTFNfV0VCU0FGRS5jaGFyQXQoaSldID0gaTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNoYXJUb0J5dGVNYXBXZWJTYWZlX1t0aGlzLkVOQ09ERURfVkFMUy5jaGFyQXQoaSldID0gaTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqIFVSTC1zYWZlIGJhc2U2NCBlbmNvZGluZ1xyXG4gKi9cclxudmFyIGJhc2U2NEVuY29kZSA9IGZ1bmN0aW9uIChzdHIpIHtcclxuICAgIHZhciB1dGY4Qnl0ZXMgPSBzdHJpbmdUb0J5dGVBcnJheSQxKHN0cik7XHJcbiAgICByZXR1cm4gYmFzZTY0LmVuY29kZUJ5dGVBcnJheSh1dGY4Qnl0ZXMsIHRydWUpO1xyXG59O1xyXG4vKipcclxuICogVVJMLXNhZmUgYmFzZTY0IGVuY29kaW5nICh3aXRob3V0IFwiLlwiIHBhZGRpbmcgaW4gdGhlIGVuZCkuXHJcbiAqIGUuZy4gVXNlZCBpbiBKU09OIFdlYiBUb2tlbiAoSldUKSBwYXJ0cy5cclxuICovXHJcbnZhciBiYXNlNjR1cmxFbmNvZGVXaXRob3V0UGFkZGluZyA9IGZ1bmN0aW9uIChzdHIpIHtcclxuICAgIC8vIFVzZSBiYXNlNjR1cmwgZW5jb2RpbmcgYW5kIHJlbW92ZSBwYWRkaW5nIGluIHRoZSBlbmQgKGRvdCBjaGFyYWN0ZXJzKS5cclxuICAgIHJldHVybiBiYXNlNjRFbmNvZGUoc3RyKS5yZXBsYWNlKC9cXC4vZywgJycpO1xyXG59O1xyXG4vKipcclxuICogVVJMLXNhZmUgYmFzZTY0IGRlY29kaW5nXHJcbiAqXHJcbiAqIE5PVEU6IERPIE5PVCB1c2UgdGhlIGdsb2JhbCBhdG9iKCkgZnVuY3Rpb24gLSBpdCBkb2VzIE5PVCBzdXBwb3J0IHRoZVxyXG4gKiBiYXNlNjRVcmwgdmFyaWFudCBlbmNvZGluZy5cclxuICpcclxuICogQHBhcmFtIHN0ciBUbyBiZSBkZWNvZGVkXHJcbiAqIEByZXR1cm4gRGVjb2RlZCByZXN1bHQsIGlmIHBvc3NpYmxlXHJcbiAqL1xyXG52YXIgYmFzZTY0RGVjb2RlID0gZnVuY3Rpb24gKHN0cikge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICByZXR1cm4gYmFzZTY0LmRlY29kZVN0cmluZyhzdHIsIHRydWUpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdiYXNlNjREZWNvZGUgZmFpbGVkOiAnLCBlKTtcclxuICAgIH1cclxuICAgIHJldHVybiBudWxsO1xyXG59O1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogRG8gYSBkZWVwLWNvcHkgb2YgYmFzaWMgSmF2YVNjcmlwdCBPYmplY3RzIG9yIEFycmF5cy5cclxuICovXHJcbmZ1bmN0aW9uIGRlZXBDb3B5KHZhbHVlKSB7XHJcbiAgICByZXR1cm4gZGVlcEV4dGVuZCh1bmRlZmluZWQsIHZhbHVlKTtcclxufVxyXG4vKipcclxuICogQ29weSBwcm9wZXJ0aWVzIGZyb20gc291cmNlIHRvIHRhcmdldCAocmVjdXJzaXZlbHkgYWxsb3dzIGV4dGVuc2lvblxyXG4gKiBvZiBPYmplY3RzIGFuZCBBcnJheXMpLiAgU2NhbGFyIHZhbHVlcyBpbiB0aGUgdGFyZ2V0IGFyZSBvdmVyLXdyaXR0ZW4uXHJcbiAqIElmIHRhcmdldCBpcyB1bmRlZmluZWQsIGFuIG9iamVjdCBvZiB0aGUgYXBwcm9wcmlhdGUgdHlwZSB3aWxsIGJlIGNyZWF0ZWRcclxuICogKGFuZCByZXR1cm5lZCkuXHJcbiAqXHJcbiAqIFdlIHJlY3Vyc2l2ZWx5IGNvcHkgYWxsIGNoaWxkIHByb3BlcnRpZXMgb2YgcGxhaW4gT2JqZWN0cyBpbiB0aGUgc291cmNlLSBzb1xyXG4gKiB0aGF0IG5hbWVzcGFjZS0gbGlrZSBkaWN0aW9uYXJpZXMgYXJlIG1lcmdlZC5cclxuICpcclxuICogTm90ZSB0aGF0IHRoZSB0YXJnZXQgY2FuIGJlIGEgZnVuY3Rpb24sIGluIHdoaWNoIGNhc2UgdGhlIHByb3BlcnRpZXMgaW5cclxuICogdGhlIHNvdXJjZSBPYmplY3QgYXJlIGNvcGllZCBvbnRvIGl0IGFzIHN0YXRpYyBwcm9wZXJ0aWVzIG9mIHRoZSBGdW5jdGlvbi5cclxuICpcclxuICogTm90ZTogd2UgZG9uJ3QgbWVyZ2UgX19wcm90b19fIHRvIHByZXZlbnQgcHJvdG90eXBlIHBvbGx1dGlvblxyXG4gKi9cclxuZnVuY3Rpb24gZGVlcEV4dGVuZCh0YXJnZXQsIHNvdXJjZSkge1xyXG4gICAgaWYgKCEoc291cmNlIGluc3RhbmNlb2YgT2JqZWN0KSkge1xyXG4gICAgICAgIHJldHVybiBzb3VyY2U7XHJcbiAgICB9XHJcbiAgICBzd2l0Y2ggKHNvdXJjZS5jb25zdHJ1Y3Rvcikge1xyXG4gICAgICAgIGNhc2UgRGF0ZTpcclxuICAgICAgICAgICAgLy8gVHJlYXQgRGF0ZXMgbGlrZSBzY2FsYXJzOyBpZiB0aGUgdGFyZ2V0IGRhdGUgb2JqZWN0IGhhZCBhbnkgY2hpbGRcclxuICAgICAgICAgICAgLy8gcHJvcGVydGllcyAtIHRoZXkgd2lsbCBiZSBsb3N0IVxyXG4gICAgICAgICAgICB2YXIgZGF0ZVZhbHVlID0gc291cmNlO1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IERhdGUoZGF0ZVZhbHVlLmdldFRpbWUoKSk7XHJcbiAgICAgICAgY2FzZSBPYmplY3Q6XHJcbiAgICAgICAgICAgIGlmICh0YXJnZXQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0ge307XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBBcnJheTpcclxuICAgICAgICAgICAgLy8gQWx3YXlzIGNvcHkgdGhlIGFycmF5IHNvdXJjZSBhbmQgb3ZlcndyaXRlIHRoZSB0YXJnZXQuXHJcbiAgICAgICAgICAgIHRhcmdldCA9IFtdO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAvLyBOb3QgYSBwbGFpbiBPYmplY3QgLSB0cmVhdCBpdCBhcyBhIHNjYWxhci5cclxuICAgICAgICAgICAgcmV0dXJuIHNvdXJjZTtcclxuICAgIH1cclxuICAgIGZvciAodmFyIHByb3AgaW4gc291cmNlKSB7XHJcbiAgICAgICAgLy8gdXNlIGlzVmFsaWRLZXkgdG8gZ3VhcmQgYWdhaW5zdCBwcm90b3R5cGUgcG9sbHV0aW9uLiBTZWUgaHR0cHM6Ly9zbnlrLmlvL3Z1bG4vU05ZSy1KUy1MT0RBU0gtNDUwMjAyXHJcbiAgICAgICAgaWYgKCFzb3VyY2UuaGFzT3duUHJvcGVydHkocHJvcCkgfHwgIWlzVmFsaWRLZXkocHJvcCkpIHtcclxuICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRhcmdldFtwcm9wXSA9IGRlZXBFeHRlbmQodGFyZ2V0W3Byb3BdLCBzb3VyY2VbcHJvcF0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRhcmdldDtcclxufVxyXG5mdW5jdGlvbiBpc1ZhbGlkS2V5KGtleSkge1xyXG4gICAgcmV0dXJuIGtleSAhPT0gJ19fcHJvdG9fXyc7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIERlZmVycmVkID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRGVmZXJyZWQoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLnJlamVjdCA9IGZ1bmN0aW9uICgpIHsgfTtcclxuICAgICAgICB0aGlzLnJlc29sdmUgPSBmdW5jdGlvbiAoKSB7IH07XHJcbiAgICAgICAgdGhpcy5wcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICBfdGhpcy5yZXNvbHZlID0gcmVzb2x2ZTtcclxuICAgICAgICAgICAgX3RoaXMucmVqZWN0ID0gcmVqZWN0O1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBPdXIgQVBJIGludGVybmFscyBhcmUgbm90IHByb21pc2VpZmllZCBhbmQgY2Fubm90IGJlY2F1c2Ugb3VyIGNhbGxiYWNrIEFQSXMgaGF2ZSBzdWJ0bGUgZXhwZWN0YXRpb25zIGFyb3VuZFxyXG4gICAgICogaW52b2tpbmcgcHJvbWlzZXMgaW5saW5lLCB3aGljaCBQcm9taXNlcyBhcmUgZm9yYmlkZGVuIHRvIGRvLiBUaGlzIG1ldGhvZCBhY2NlcHRzIGFuIG9wdGlvbmFsIG5vZGUtc3R5bGUgY2FsbGJhY2tcclxuICAgICAqIGFuZCByZXR1cm5zIGEgbm9kZS1zdHlsZSBjYWxsYmFjayB3aGljaCB3aWxsIHJlc29sdmUgb3IgcmVqZWN0IHRoZSBEZWZlcnJlZCdzIHByb21pc2UuXHJcbiAgICAgKi9cclxuICAgIERlZmVycmVkLnByb3RvdHlwZS53cmFwQ2FsbGJhY2sgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoZXJyb3IsIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMucmVqZWN0KGVycm9yKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLnJlc29sdmUodmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgICAgIC8vIEF0dGFjaGluZyBub29wIGhhbmRsZXIganVzdCBpbiBjYXNlIGRldmVsb3BlciB3YXNuJ3QgZXhwZWN0aW5nXHJcbiAgICAgICAgICAgICAgICAvLyBwcm9taXNlc1xyXG4gICAgICAgICAgICAgICAgX3RoaXMucHJvbWlzZS5jYXRjaChmdW5jdGlvbiAoKSB7IH0pO1xyXG4gICAgICAgICAgICAgICAgLy8gU29tZSBvZiBvdXIgY2FsbGJhY2tzIGRvbid0IGV4cGVjdCBhIHZhbHVlIGFuZCBvdXIgb3duIHRlc3RzXHJcbiAgICAgICAgICAgICAgICAvLyBhc3NlcnQgdGhhdCB0aGUgcGFyYW1ldGVyIGxlbmd0aCBpcyAxXHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2subGVuZ3RoID09PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soZXJyb3IsIHZhbHVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIERlZmVycmVkO1xyXG59KCkpO1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjEgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5mdW5jdGlvbiBjcmVhdGVNb2NrVXNlclRva2VuKHRva2VuLCBwcm9qZWN0SWQpIHtcclxuICAgIGlmICh0b2tlbi51aWQpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBcInVpZFwiIGZpZWxkIGlzIG5vIGxvbmdlciBzdXBwb3J0ZWQgYnkgbW9ja1VzZXJUb2tlbi4gUGxlYXNlIHVzZSBcInN1YlwiIGluc3RlYWQgZm9yIEZpcmViYXNlIEF1dGggVXNlciBJRC4nKTtcclxuICAgIH1cclxuICAgIC8vIFVuc2VjdXJlZCBKV1RzIHVzZSBcIm5vbmVcIiBhcyB0aGUgYWxnb3JpdGhtLlxyXG4gICAgdmFyIGhlYWRlciA9IHtcclxuICAgICAgICBhbGc6ICdub25lJyxcclxuICAgICAgICB0eXBlOiAnSldUJ1xyXG4gICAgfTtcclxuICAgIHZhciBwcm9qZWN0ID0gcHJvamVjdElkIHx8ICdkZW1vLXByb2plY3QnO1xyXG4gICAgdmFyIGlhdCA9IHRva2VuLmlhdCB8fCAwO1xyXG4gICAgdmFyIHN1YiA9IHRva2VuLnN1YiB8fCB0b2tlbi51c2VyX2lkO1xyXG4gICAgaWYgKCFzdWIpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJtb2NrVXNlclRva2VuIG11c3QgY29udGFpbiAnc3ViJyBvciAndXNlcl9pZCcgZmllbGQhXCIpO1xyXG4gICAgfVxyXG4gICAgdmFyIHBheWxvYWQgPSBfX2Fzc2lnbih7IFxyXG4gICAgICAgIC8vIFNldCBhbGwgcmVxdWlyZWQgZmllbGRzIHRvIGRlY2VudCBkZWZhdWx0c1xyXG4gICAgICAgIGlzczogXCJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vXCIgKyBwcm9qZWN0LCBhdWQ6IHByb2plY3QsIGlhdDogaWF0LCBleHA6IGlhdCArIDM2MDAsIGF1dGhfdGltZTogaWF0LCBzdWI6IHN1YiwgdXNlcl9pZDogc3ViLCBmaXJlYmFzZToge1xyXG4gICAgICAgICAgICBzaWduX2luX3Byb3ZpZGVyOiAnY3VzdG9tJyxcclxuICAgICAgICAgICAgaWRlbnRpdGllczoge31cclxuICAgICAgICB9IH0sIHRva2VuKTtcclxuICAgIC8vIFVuc2VjdXJlZCBKV1RzIHVzZSB0aGUgZW1wdHkgc3RyaW5nIGFzIGEgc2lnbmF0dXJlLlxyXG4gICAgdmFyIHNpZ25hdHVyZSA9ICcnO1xyXG4gICAgcmV0dXJuIFtcclxuICAgICAgICBiYXNlNjR1cmxFbmNvZGVXaXRob3V0UGFkZGluZyhKU09OLnN0cmluZ2lmeShoZWFkZXIpKSxcclxuICAgICAgICBiYXNlNjR1cmxFbmNvZGVXaXRob3V0UGFkZGluZyhKU09OLnN0cmluZ2lmeShwYXlsb2FkKSksXHJcbiAgICAgICAgc2lnbmF0dXJlXHJcbiAgICBdLmpvaW4oJy4nKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogUmV0dXJucyBuYXZpZ2F0b3IudXNlckFnZW50IHN0cmluZyBvciAnJyBpZiBpdCdzIG5vdCBkZWZpbmVkLlxyXG4gKiBAcmV0dXJuIHVzZXIgYWdlbnQgc3RyaW5nXHJcbiAqL1xyXG5mdW5jdGlvbiBnZXRVQSgpIHtcclxuICAgIGlmICh0eXBlb2YgbmF2aWdhdG9yICE9PSAndW5kZWZpbmVkJyAmJlxyXG4gICAgICAgIHR5cGVvZiBuYXZpZ2F0b3JbJ3VzZXJBZ2VudCddID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgIHJldHVybiBuYXZpZ2F0b3JbJ3VzZXJBZ2VudCddO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBEZXRlY3QgQ29yZG92YSAvIFBob25lR2FwIC8gSW9uaWMgZnJhbWV3b3JrcyBvbiBhIG1vYmlsZSBkZXZpY2UuXHJcbiAqXHJcbiAqIERlbGliZXJhdGVseSBkb2VzIG5vdCByZWx5IG9uIGNoZWNraW5nIGBmaWxlOi8vYCBVUkxzIChhcyB0aGlzIGZhaWxzIFBob25lR2FwXHJcbiAqIGluIHRoZSBSaXBwbGUgZW11bGF0b3IpIG5vciBDb3Jkb3ZhIGBvbkRldmljZVJlYWR5YCwgd2hpY2ggd291bGQgbm9ybWFsbHlcclxuICogd2FpdCBmb3IgYSBjYWxsYmFjay5cclxuICovXHJcbmZ1bmN0aW9uIGlzTW9iaWxlQ29yZG92YSgpIHtcclxuICAgIHJldHVybiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiZcclxuICAgICAgICAvLyBAdHMtaWdub3JlIFNldHRpbmcgdXAgYW4gYnJvYWRseSBhcHBsaWNhYmxlIGluZGV4IHNpZ25hdHVyZSBmb3IgV2luZG93XHJcbiAgICAgICAgLy8ganVzdCB0byBkZWFsIHdpdGggdGhpcyBjYXNlIHdvdWxkIHByb2JhYmx5IGJlIGEgYmFkIGlkZWEuXHJcbiAgICAgICAgISEod2luZG93Wydjb3Jkb3ZhJ10gfHwgd2luZG93WydwaG9uZWdhcCddIHx8IHdpbmRvd1snUGhvbmVHYXAnXSkgJiZcclxuICAgICAgICAvaW9zfGlwaG9uZXxpcG9kfGlwYWR8YW5kcm9pZHxibGFja2JlcnJ5fGllbW9iaWxlL2kudGVzdChnZXRVQSgpKSk7XHJcbn1cclxuLyoqXHJcbiAqIERldGVjdCBOb2RlLmpzLlxyXG4gKlxyXG4gKiBAcmV0dXJuIHRydWUgaWYgTm9kZS5qcyBlbnZpcm9ubWVudCBpcyBkZXRlY3RlZC5cclxuICovXHJcbi8vIE5vZGUgZGV0ZWN0aW9uIGxvZ2ljIGZyb206IGh0dHBzOi8vZ2l0aHViLmNvbS9pbGlha2FuL2RldGVjdC1ub2RlL1xyXG5mdW5jdGlvbiBpc05vZGUoKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHJldHVybiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGdsb2JhbC5wcm9jZXNzKSA9PT0gJ1tvYmplY3QgcHJvY2Vzc10nKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBEZXRlY3QgQnJvd3NlciBFbnZpcm9ubWVudFxyXG4gKi9cclxuZnVuY3Rpb24gaXNCcm93c2VyKCkge1xyXG4gICAgcmV0dXJuIHR5cGVvZiBzZWxmID09PSAnb2JqZWN0JyAmJiBzZWxmLnNlbGYgPT09IHNlbGY7XHJcbn1cclxuZnVuY3Rpb24gaXNCcm93c2VyRXh0ZW5zaW9uKCkge1xyXG4gICAgdmFyIHJ1bnRpbWUgPSB0eXBlb2YgY2hyb21lID09PSAnb2JqZWN0J1xyXG4gICAgICAgID8gY2hyb21lLnJ1bnRpbWVcclxuICAgICAgICA6IHR5cGVvZiBicm93c2VyID09PSAnb2JqZWN0J1xyXG4gICAgICAgICAgICA/IGJyb3dzZXIucnVudGltZVxyXG4gICAgICAgICAgICA6IHVuZGVmaW5lZDtcclxuICAgIHJldHVybiB0eXBlb2YgcnVudGltZSA9PT0gJ29iamVjdCcgJiYgcnVudGltZS5pZCAhPT0gdW5kZWZpbmVkO1xyXG59XHJcbi8qKlxyXG4gKiBEZXRlY3QgUmVhY3QgTmF0aXZlLlxyXG4gKlxyXG4gKiBAcmV0dXJuIHRydWUgaWYgUmVhY3ROYXRpdmUgZW52aXJvbm1lbnQgaXMgZGV0ZWN0ZWQuXHJcbiAqL1xyXG5mdW5jdGlvbiBpc1JlYWN0TmF0aXZlKCkge1xyXG4gICAgcmV0dXJuICh0eXBlb2YgbmF2aWdhdG9yID09PSAnb2JqZWN0JyAmJiBuYXZpZ2F0b3JbJ3Byb2R1Y3QnXSA9PT0gJ1JlYWN0TmF0aXZlJyk7XHJcbn1cclxuLyoqIERldGVjdHMgRWxlY3Ryb24gYXBwcy4gKi9cclxuZnVuY3Rpb24gaXNFbGVjdHJvbigpIHtcclxuICAgIHJldHVybiBnZXRVQSgpLmluZGV4T2YoJ0VsZWN0cm9uLycpID49IDA7XHJcbn1cclxuLyoqIERldGVjdHMgSW50ZXJuZXQgRXhwbG9yZXIuICovXHJcbmZ1bmN0aW9uIGlzSUUoKSB7XHJcbiAgICB2YXIgdWEgPSBnZXRVQSgpO1xyXG4gICAgcmV0dXJuIHVhLmluZGV4T2YoJ01TSUUgJykgPj0gMCB8fCB1YS5pbmRleE9mKCdUcmlkZW50LycpID49IDA7XHJcbn1cclxuLyoqIERldGVjdHMgVW5pdmVyc2FsIFdpbmRvd3MgUGxhdGZvcm0gYXBwcy4gKi9cclxuZnVuY3Rpb24gaXNVV1AoKSB7XHJcbiAgICByZXR1cm4gZ2V0VUEoKS5pbmRleE9mKCdNU0FwcEhvc3QvJykgPj0gMDtcclxufVxyXG4vKipcclxuICogRGV0ZWN0IHdoZXRoZXIgdGhlIGN1cnJlbnQgU0RLIGJ1aWxkIGlzIHRoZSBOb2RlIHZlcnNpb24uXHJcbiAqXHJcbiAqIEByZXR1cm4gdHJ1ZSBpZiBpdCdzIHRoZSBOb2RlIFNESyBidWlsZC5cclxuICovXHJcbmZ1bmN0aW9uIGlzTm9kZVNkaygpIHtcclxuICAgIHJldHVybiBDT05TVEFOVFMuTk9ERV9DTElFTlQgPT09IHRydWUgfHwgQ09OU1RBTlRTLk5PREVfQURNSU4gPT09IHRydWU7XHJcbn1cclxuLyoqIFJldHVybnMgdHJ1ZSBpZiB3ZSBhcmUgcnVubmluZyBpbiBTYWZhcmkuICovXHJcbmZ1bmN0aW9uIGlzU2FmYXJpKCkge1xyXG4gICAgcmV0dXJuICghaXNOb2RlKCkgJiZcclxuICAgICAgICBuYXZpZ2F0b3IudXNlckFnZW50LmluY2x1ZGVzKCdTYWZhcmknKSAmJlxyXG4gICAgICAgICFuYXZpZ2F0b3IudXNlckFnZW50LmluY2x1ZGVzKCdDaHJvbWUnKSk7XHJcbn1cclxuLyoqXHJcbiAqIFRoaXMgbWV0aG9kIGNoZWNrcyBpZiBpbmRleGVkREIgaXMgc3VwcG9ydGVkIGJ5IGN1cnJlbnQgYnJvd3Nlci9zZXJ2aWNlIHdvcmtlciBjb250ZXh0XHJcbiAqIEByZXR1cm4gdHJ1ZSBpZiBpbmRleGVkREIgaXMgc3VwcG9ydGVkIGJ5IGN1cnJlbnQgYnJvd3Nlci9zZXJ2aWNlIHdvcmtlciBjb250ZXh0XHJcbiAqL1xyXG5mdW5jdGlvbiBpc0luZGV4ZWREQkF2YWlsYWJsZSgpIHtcclxuICAgIHJldHVybiAnaW5kZXhlZERCJyBpbiBzZWxmICYmIGluZGV4ZWREQiAhPSBudWxsO1xyXG59XHJcbi8qKlxyXG4gKiBUaGlzIG1ldGhvZCB2YWxpZGF0ZXMgYnJvd3Nlci9zdyBjb250ZXh0IGZvciBpbmRleGVkREIgYnkgb3BlbmluZyBhIGR1bW15IGluZGV4ZWREQiBkYXRhYmFzZSBhbmQgcmVqZWN0XHJcbiAqIGlmIGVycm9ycyBvY2N1ciBkdXJpbmcgdGhlIGRhdGFiYXNlIG9wZW4gb3BlcmF0aW9uLlxyXG4gKlxyXG4gKiBAdGhyb3dzIGV4Y2VwdGlvbiBpZiBjdXJyZW50IGJyb3dzZXIvc3cgY29udGV4dCBjYW4ndCBydW4gaWRiLm9wZW4gKGV4OiBTYWZhcmkgaWZyYW1lLCBGaXJlZm94XHJcbiAqIHByaXZhdGUgYnJvd3NpbmcpXHJcbiAqL1xyXG5mdW5jdGlvbiB2YWxpZGF0ZUluZGV4ZWREQk9wZW5hYmxlKCkge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICB2YXIgcHJlRXhpc3RfMSA9IHRydWU7XHJcbiAgICAgICAgICAgIHZhciBEQl9DSEVDS19OQU1FXzEgPSAndmFsaWRhdGUtYnJvd3Nlci1jb250ZXh0LWZvci1pbmRleGVkZGItYW5hbHl0aWNzLW1vZHVsZSc7XHJcbiAgICAgICAgICAgIHZhciByZXF1ZXN0XzEgPSBzZWxmLmluZGV4ZWREQi5vcGVuKERCX0NIRUNLX05BTUVfMSk7XHJcbiAgICAgICAgICAgIHJlcXVlc3RfMS5vbnN1Y2Nlc3MgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXF1ZXN0XzEucmVzdWx0LmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAvLyBkZWxldGUgZGF0YWJhc2Ugb25seSB3aGVuIGl0IGRvZXNuJ3QgcHJlLWV4aXN0XHJcbiAgICAgICAgICAgICAgICBpZiAoIXByZUV4aXN0XzEpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmluZGV4ZWREQi5kZWxldGVEYXRhYmFzZShEQl9DSEVDS19OQU1FXzEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgcmVxdWVzdF8xLm9udXBncmFkZW5lZWRlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHByZUV4aXN0XzEgPSBmYWxzZTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgcmVxdWVzdF8xLm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgICAgICAgICByZWplY3QoKChfYSA9IHJlcXVlc3RfMS5lcnJvcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLm1lc3NhZ2UpIHx8ICcnKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIHJlamVjdChlcnJvcik7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn1cclxuLyoqXHJcbiAqXHJcbiAqIFRoaXMgbWV0aG9kIGNoZWNrcyB3aGV0aGVyIGNvb2tpZSBpcyBlbmFibGVkIHdpdGhpbiBjdXJyZW50IGJyb3dzZXJcclxuICogQHJldHVybiB0cnVlIGlmIGNvb2tpZSBpcyBlbmFibGVkIHdpdGhpbiBjdXJyZW50IGJyb3dzZXJcclxuICovXHJcbmZ1bmN0aW9uIGFyZUNvb2tpZXNFbmFibGVkKCkge1xyXG4gICAgaWYgKCFuYXZpZ2F0b3IgfHwgIW5hdmlnYXRvci5jb29raWVFbmFibGVkKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbn1cclxuLyoqXHJcbiAqIFBvbHlmaWxsIGZvciBgZ2xvYmFsVGhpc2Agb2JqZWN0LlxyXG4gKiBAcmV0dXJucyB0aGUgYGdsb2JhbFRoaXNgIG9iamVjdCBmb3IgdGhlIGdpdmVuIGVudmlyb25tZW50LlxyXG4gKi9cclxuZnVuY3Rpb24gZ2V0R2xvYmFsKCkge1xyXG4gICAgaWYgKHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgIHJldHVybiBzZWxmO1xyXG4gICAgfVxyXG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgcmV0dXJuIHdpbmRvdztcclxuICAgIH1cclxuICAgIGlmICh0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgIHJldHVybiBnbG9iYWw7XHJcbiAgICB9XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuYWJsZSB0byBsb2NhdGUgZ2xvYmFsIG9iamVjdC4nKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgRVJST1JfTkFNRSA9ICdGaXJlYmFzZUVycm9yJztcclxuLy8gQmFzZWQgb24gY29kZSBmcm9tOlxyXG4vLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9FcnJvciNDdXN0b21fRXJyb3JfVHlwZXNcclxudmFyIEZpcmViYXNlRXJyb3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICBfX2V4dGVuZHMoRmlyZWJhc2VFcnJvciwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIEZpcmViYXNlRXJyb3IoY29kZSwgbWVzc2FnZSwgY3VzdG9tRGF0YSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIG1lc3NhZ2UpIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMuY29kZSA9IGNvZGU7XHJcbiAgICAgICAgX3RoaXMuY3VzdG9tRGF0YSA9IGN1c3RvbURhdGE7XHJcbiAgICAgICAgX3RoaXMubmFtZSA9IEVSUk9SX05BTUU7XHJcbiAgICAgICAgLy8gRml4IEZvciBFUzVcclxuICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vTWljcm9zb2Z0L1R5cGVTY3JpcHQtd2lraS9ibG9iL21hc3Rlci9CcmVha2luZy1DaGFuZ2VzLm1kI2V4dGVuZGluZy1idWlsdC1pbnMtbGlrZS1lcnJvci1hcnJheS1hbmQtbWFwLW1heS1uby1sb25nZXItd29ya1xyXG4gICAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZihfdGhpcywgRmlyZWJhc2VFcnJvci5wcm90b3R5cGUpO1xyXG4gICAgICAgIC8vIE1haW50YWlucyBwcm9wZXIgc3RhY2sgdHJhY2UgZm9yIHdoZXJlIG91ciBlcnJvciB3YXMgdGhyb3duLlxyXG4gICAgICAgIC8vIE9ubHkgYXZhaWxhYmxlIG9uIFY4LlxyXG4gICAgICAgIGlmIChFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSkge1xyXG4gICAgICAgICAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZShfdGhpcywgRXJyb3JGYWN0b3J5LnByb3RvdHlwZS5jcmVhdGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gRmlyZWJhc2VFcnJvcjtcclxufShFcnJvcikpO1xyXG52YXIgRXJyb3JGYWN0b3J5ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRXJyb3JGYWN0b3J5KHNlcnZpY2UsIHNlcnZpY2VOYW1lLCBlcnJvcnMpIHtcclxuICAgICAgICB0aGlzLnNlcnZpY2UgPSBzZXJ2aWNlO1xyXG4gICAgICAgIHRoaXMuc2VydmljZU5hbWUgPSBzZXJ2aWNlTmFtZTtcclxuICAgICAgICB0aGlzLmVycm9ycyA9IGVycm9ycztcclxuICAgIH1cclxuICAgIEVycm9yRmFjdG9yeS5wcm90b3R5cGUuY3JlYXRlID0gZnVuY3Rpb24gKGNvZGUpIHtcclxuICAgICAgICB2YXIgZGF0YSA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIGRhdGFbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBjdXN0b21EYXRhID0gZGF0YVswXSB8fCB7fTtcclxuICAgICAgICB2YXIgZnVsbENvZGUgPSB0aGlzLnNlcnZpY2UgKyBcIi9cIiArIGNvZGU7XHJcbiAgICAgICAgdmFyIHRlbXBsYXRlID0gdGhpcy5lcnJvcnNbY29kZV07XHJcbiAgICAgICAgdmFyIG1lc3NhZ2UgPSB0ZW1wbGF0ZSA/IHJlcGxhY2VUZW1wbGF0ZSh0ZW1wbGF0ZSwgY3VzdG9tRGF0YSkgOiAnRXJyb3InO1xyXG4gICAgICAgIC8vIFNlcnZpY2UgTmFtZTogRXJyb3IgbWVzc2FnZSAoc2VydmljZS9jb2RlKS5cclxuICAgICAgICB2YXIgZnVsbE1lc3NhZ2UgPSB0aGlzLnNlcnZpY2VOYW1lICsgXCI6IFwiICsgbWVzc2FnZSArIFwiIChcIiArIGZ1bGxDb2RlICsgXCIpLlwiO1xyXG4gICAgICAgIHZhciBlcnJvciA9IG5ldyBGaXJlYmFzZUVycm9yKGZ1bGxDb2RlLCBmdWxsTWVzc2FnZSwgY3VzdG9tRGF0YSk7XHJcbiAgICAgICAgcmV0dXJuIGVycm9yO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBFcnJvckZhY3Rvcnk7XHJcbn0oKSk7XHJcbmZ1bmN0aW9uIHJlcGxhY2VUZW1wbGF0ZSh0ZW1wbGF0ZSwgZGF0YSkge1xyXG4gICAgcmV0dXJuIHRlbXBsYXRlLnJlcGxhY2UoUEFUVEVSTiwgZnVuY3Rpb24gKF8sIGtleSkge1xyXG4gICAgICAgIHZhciB2YWx1ZSA9IGRhdGFba2V5XTtcclxuICAgICAgICByZXR1cm4gdmFsdWUgIT0gbnVsbCA/IFN0cmluZyh2YWx1ZSkgOiBcIjxcIiArIGtleSArIFwiPz5cIjtcclxuICAgIH0pO1xyXG59XHJcbnZhciBQQVRURVJOID0gL1xce1xcJChbXn1dKyl9L2c7XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBFdmFsdWF0ZXMgYSBKU09OIHN0cmluZyBpbnRvIGEgamF2YXNjcmlwdCBvYmplY3QuXHJcbiAqXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdHIgQSBzdHJpbmcgY29udGFpbmluZyBKU09OLlxyXG4gKiBAcmV0dXJuIHsqfSBUaGUgamF2YXNjcmlwdCBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSBzcGVjaWZpZWQgSlNPTi5cclxuICovXHJcbmZ1bmN0aW9uIGpzb25FdmFsKHN0cikge1xyXG4gICAgcmV0dXJuIEpTT04ucGFyc2Uoc3RyKTtcclxufVxyXG4vKipcclxuICogUmV0dXJucyBKU09OIHJlcHJlc2VudGluZyBhIGphdmFzY3JpcHQgb2JqZWN0LlxyXG4gKiBAcGFyYW0geyp9IGRhdGEgSmF2YXNjcmlwdCBvYmplY3QgdG8gYmUgc3RyaW5naWZpZWQuXHJcbiAqIEByZXR1cm4ge3N0cmluZ30gVGhlIEpTT04gY29udGVudHMgb2YgdGhlIG9iamVjdC5cclxuICovXHJcbmZ1bmN0aW9uIHN0cmluZ2lmeShkYXRhKSB7XHJcbiAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoZGF0YSk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIERlY29kZXMgYSBGaXJlYmFzZSBhdXRoLiB0b2tlbiBpbnRvIGNvbnN0aXR1ZW50IHBhcnRzLlxyXG4gKlxyXG4gKiBOb3RlczpcclxuICogLSBNYXkgcmV0dXJuIHdpdGggaW52YWxpZCAvIGluY29tcGxldGUgY2xhaW1zIGlmIHRoZXJlJ3Mgbm8gbmF0aXZlIGJhc2U2NCBkZWNvZGluZyBzdXBwb3J0LlxyXG4gKiAtIERvZXNuJ3QgY2hlY2sgaWYgdGhlIHRva2VuIGlzIGFjdHVhbGx5IHZhbGlkLlxyXG4gKi9cclxudmFyIGRlY29kZSA9IGZ1bmN0aW9uICh0b2tlbikge1xyXG4gICAgdmFyIGhlYWRlciA9IHt9LCBjbGFpbXMgPSB7fSwgZGF0YSA9IHt9LCBzaWduYXR1cmUgPSAnJztcclxuICAgIHRyeSB7XHJcbiAgICAgICAgdmFyIHBhcnRzID0gdG9rZW4uc3BsaXQoJy4nKTtcclxuICAgICAgICBoZWFkZXIgPSBqc29uRXZhbChiYXNlNjREZWNvZGUocGFydHNbMF0pIHx8ICcnKTtcclxuICAgICAgICBjbGFpbXMgPSBqc29uRXZhbChiYXNlNjREZWNvZGUocGFydHNbMV0pIHx8ICcnKTtcclxuICAgICAgICBzaWduYXR1cmUgPSBwYXJ0c1syXTtcclxuICAgICAgICBkYXRhID0gY2xhaW1zWydkJ10gfHwge307XHJcbiAgICAgICAgZGVsZXRlIGNsYWltc1snZCddO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGUpIHsgfVxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBoZWFkZXI6IGhlYWRlcixcclxuICAgICAgICBjbGFpbXM6IGNsYWltcyxcclxuICAgICAgICBkYXRhOiBkYXRhLFxyXG4gICAgICAgIHNpZ25hdHVyZTogc2lnbmF0dXJlXHJcbiAgICB9O1xyXG59O1xyXG4vKipcclxuICogRGVjb2RlcyBhIEZpcmViYXNlIGF1dGguIHRva2VuIGFuZCBjaGVja3MgdGhlIHZhbGlkaXR5IG9mIGl0cyB0aW1lLWJhc2VkIGNsYWltcy4gV2lsbCByZXR1cm4gdHJ1ZSBpZiB0aGVcclxuICogdG9rZW4gaXMgd2l0aGluIHRoZSB0aW1lIHdpbmRvdyBhdXRob3JpemVkIGJ5IHRoZSAnbmJmJyAobm90LWJlZm9yZSkgYW5kICdpYXQnIChpc3N1ZWQtYXQpIGNsYWltcy5cclxuICpcclxuICogTm90ZXM6XHJcbiAqIC0gTWF5IHJldHVybiBhIGZhbHNlIG5lZ2F0aXZlIGlmIHRoZXJlJ3Mgbm8gbmF0aXZlIGJhc2U2NCBkZWNvZGluZyBzdXBwb3J0LlxyXG4gKiAtIERvZXNuJ3QgY2hlY2sgaWYgdGhlIHRva2VuIGlzIGFjdHVhbGx5IHZhbGlkLlxyXG4gKi9cclxudmFyIGlzVmFsaWRUaW1lc3RhbXAgPSBmdW5jdGlvbiAodG9rZW4pIHtcclxuICAgIHZhciBjbGFpbXMgPSBkZWNvZGUodG9rZW4pLmNsYWltcztcclxuICAgIHZhciBub3cgPSBNYXRoLmZsb29yKG5ldyBEYXRlKCkuZ2V0VGltZSgpIC8gMTAwMCk7XHJcbiAgICB2YXIgdmFsaWRTaW5jZSA9IDAsIHZhbGlkVW50aWwgPSAwO1xyXG4gICAgaWYgKHR5cGVvZiBjbGFpbXMgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgaWYgKGNsYWltcy5oYXNPd25Qcm9wZXJ0eSgnbmJmJykpIHtcclxuICAgICAgICAgICAgdmFsaWRTaW5jZSA9IGNsYWltc1snbmJmJ107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGNsYWltcy5oYXNPd25Qcm9wZXJ0eSgnaWF0JykpIHtcclxuICAgICAgICAgICAgdmFsaWRTaW5jZSA9IGNsYWltc1snaWF0J107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChjbGFpbXMuaGFzT3duUHJvcGVydHkoJ2V4cCcpKSB7XHJcbiAgICAgICAgICAgIHZhbGlkVW50aWwgPSBjbGFpbXNbJ2V4cCddO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gdG9rZW4gd2lsbCBleHBpcmUgYWZ0ZXIgMjRoIGJ5IGRlZmF1bHRcclxuICAgICAgICAgICAgdmFsaWRVbnRpbCA9IHZhbGlkU2luY2UgKyA4NjQwMDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gKCEhbm93ICYmXHJcbiAgICAgICAgISF2YWxpZFNpbmNlICYmXHJcbiAgICAgICAgISF2YWxpZFVudGlsICYmXHJcbiAgICAgICAgbm93ID49IHZhbGlkU2luY2UgJiZcclxuICAgICAgICBub3cgPD0gdmFsaWRVbnRpbCk7XHJcbn07XHJcbi8qKlxyXG4gKiBEZWNvZGVzIGEgRmlyZWJhc2UgYXV0aC4gdG9rZW4gYW5kIHJldHVybnMgaXRzIGlzc3VlZCBhdCB0aW1lIGlmIHZhbGlkLCBudWxsIG90aGVyd2lzZS5cclxuICpcclxuICogTm90ZXM6XHJcbiAqIC0gTWF5IHJldHVybiBudWxsIGlmIHRoZXJlJ3Mgbm8gbmF0aXZlIGJhc2U2NCBkZWNvZGluZyBzdXBwb3J0LlxyXG4gKiAtIERvZXNuJ3QgY2hlY2sgaWYgdGhlIHRva2VuIGlzIGFjdHVhbGx5IHZhbGlkLlxyXG4gKi9cclxudmFyIGlzc3VlZEF0VGltZSA9IGZ1bmN0aW9uICh0b2tlbikge1xyXG4gICAgdmFyIGNsYWltcyA9IGRlY29kZSh0b2tlbikuY2xhaW1zO1xyXG4gICAgaWYgKHR5cGVvZiBjbGFpbXMgPT09ICdvYmplY3QnICYmIGNsYWltcy5oYXNPd25Qcm9wZXJ0eSgnaWF0JykpIHtcclxuICAgICAgICByZXR1cm4gY2xhaW1zWydpYXQnXTtcclxuICAgIH1cclxuICAgIHJldHVybiBudWxsO1xyXG59O1xyXG4vKipcclxuICogRGVjb2RlcyBhIEZpcmViYXNlIGF1dGguIHRva2VuIGFuZCBjaGVja3MgdGhlIHZhbGlkaXR5IG9mIGl0cyBmb3JtYXQuIEV4cGVjdHMgYSB2YWxpZCBpc3N1ZWQtYXQgdGltZS5cclxuICpcclxuICogTm90ZXM6XHJcbiAqIC0gTWF5IHJldHVybiBhIGZhbHNlIG5lZ2F0aXZlIGlmIHRoZXJlJ3Mgbm8gbmF0aXZlIGJhc2U2NCBkZWNvZGluZyBzdXBwb3J0LlxyXG4gKiAtIERvZXNuJ3QgY2hlY2sgaWYgdGhlIHRva2VuIGlzIGFjdHVhbGx5IHZhbGlkLlxyXG4gKi9cclxudmFyIGlzVmFsaWRGb3JtYXQgPSBmdW5jdGlvbiAodG9rZW4pIHtcclxuICAgIHZhciBkZWNvZGVkID0gZGVjb2RlKHRva2VuKSwgY2xhaW1zID0gZGVjb2RlZC5jbGFpbXM7XHJcbiAgICByZXR1cm4gISFjbGFpbXMgJiYgdHlwZW9mIGNsYWltcyA9PT0gJ29iamVjdCcgJiYgY2xhaW1zLmhhc093blByb3BlcnR5KCdpYXQnKTtcclxufTtcclxuLyoqXHJcbiAqIEF0dGVtcHRzIHRvIHBlZXIgaW50byBhbiBhdXRoIHRva2VuIGFuZCBkZXRlcm1pbmUgaWYgaXQncyBhbiBhZG1pbiBhdXRoIHRva2VuIGJ5IGxvb2tpbmcgYXQgdGhlIGNsYWltcyBwb3J0aW9uLlxyXG4gKlxyXG4gKiBOb3RlczpcclxuICogLSBNYXkgcmV0dXJuIGEgZmFsc2UgbmVnYXRpdmUgaWYgdGhlcmUncyBubyBuYXRpdmUgYmFzZTY0IGRlY29kaW5nIHN1cHBvcnQuXHJcbiAqIC0gRG9lc24ndCBjaGVjayBpZiB0aGUgdG9rZW4gaXMgYWN0dWFsbHkgdmFsaWQuXHJcbiAqL1xyXG52YXIgaXNBZG1pbiA9IGZ1bmN0aW9uICh0b2tlbikge1xyXG4gICAgdmFyIGNsYWltcyA9IGRlY29kZSh0b2tlbikuY2xhaW1zO1xyXG4gICAgcmV0dXJuIHR5cGVvZiBjbGFpbXMgPT09ICdvYmplY3QnICYmIGNsYWltc1snYWRtaW4nXSA9PT0gdHJ1ZTtcclxufTtcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuZnVuY3Rpb24gY29udGFpbnMob2JqLCBrZXkpIHtcclxuICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpO1xyXG59XHJcbmZ1bmN0aW9uIHNhZmVHZXQob2JqLCBrZXkpIHtcclxuICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7XHJcbiAgICAgICAgcmV0dXJuIG9ialtrZXldO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBpc0VtcHR5KG9iaikge1xyXG4gICAgZm9yICh2YXIga2V5IGluIG9iaikge1xyXG4gICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxufVxyXG5mdW5jdGlvbiBtYXAob2JqLCBmbiwgY29udGV4dE9iaikge1xyXG4gICAgdmFyIHJlcyA9IHt9O1xyXG4gICAgZm9yICh2YXIga2V5IGluIG9iaikge1xyXG4gICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7XHJcbiAgICAgICAgICAgIHJlc1trZXldID0gZm4uY2FsbChjb250ZXh0T2JqLCBvYmpba2V5XSwga2V5LCBvYmopO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiByZXM7XHJcbn1cclxuLyoqXHJcbiAqIERlZXAgZXF1YWwgdHdvIG9iamVjdHMuIFN1cHBvcnQgQXJyYXlzIGFuZCBPYmplY3RzLlxyXG4gKi9cclxuZnVuY3Rpb24gZGVlcEVxdWFsKGEsIGIpIHtcclxuICAgIGlmIChhID09PSBiKSB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgICB2YXIgYUtleXMgPSBPYmplY3Qua2V5cyhhKTtcclxuICAgIHZhciBiS2V5cyA9IE9iamVjdC5rZXlzKGIpO1xyXG4gICAgZm9yICh2YXIgX2kgPSAwLCBhS2V5c18xID0gYUtleXM7IF9pIDwgYUtleXNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICB2YXIgayA9IGFLZXlzXzFbX2ldO1xyXG4gICAgICAgIGlmICghYktleXMuaW5jbHVkZXMoaykpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgYVByb3AgPSBhW2tdO1xyXG4gICAgICAgIHZhciBiUHJvcCA9IGJba107XHJcbiAgICAgICAgaWYgKGlzT2JqZWN0KGFQcm9wKSAmJiBpc09iamVjdChiUHJvcCkpIHtcclxuICAgICAgICAgICAgaWYgKCFkZWVwRXF1YWwoYVByb3AsIGJQcm9wKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGFQcm9wICE9PSBiUHJvcCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZm9yICh2YXIgX2EgPSAwLCBiS2V5c18xID0gYktleXM7IF9hIDwgYktleXNfMS5sZW5ndGg7IF9hKyspIHtcclxuICAgICAgICB2YXIgayA9IGJLZXlzXzFbX2FdO1xyXG4gICAgICAgIGlmICghYUtleXMuaW5jbHVkZXMoaykpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiB0cnVlO1xyXG59XHJcbmZ1bmN0aW9uIGlzT2JqZWN0KHRoaW5nKSB7XHJcbiAgICByZXR1cm4gdGhpbmcgIT09IG51bGwgJiYgdHlwZW9mIHRoaW5nID09PSAnb2JqZWN0JztcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogUmV0dXJucyBhIHF1ZXJ5c3RyaW5nLWZvcm1hdHRlZCBzdHJpbmcgKGUuZy4gJmFyZz12YWwmYXJnMj12YWwyKSBmcm9tIGFcclxuICogcGFyYW1zIG9iamVjdCAoZS5nLiB7YXJnOiAndmFsJywgYXJnMjogJ3ZhbDInfSlcclxuICogTm90ZTogWW91IG11c3QgcHJlcGVuZCBpdCB3aXRoID8gd2hlbiBhZGRpbmcgaXQgdG8gYSBVUkwuXHJcbiAqL1xyXG5mdW5jdGlvbiBxdWVyeXN0cmluZyhxdWVyeXN0cmluZ1BhcmFtcykge1xyXG4gICAgdmFyIHBhcmFtcyA9IFtdO1xyXG4gICAgdmFyIF9sb29wXzEgPSBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xyXG4gICAgICAgICAgICB2YWx1ZS5mb3JFYWNoKGZ1bmN0aW9uIChhcnJheVZhbCkge1xyXG4gICAgICAgICAgICAgICAgcGFyYW1zLnB1c2goZW5jb2RlVVJJQ29tcG9uZW50KGtleSkgKyAnPScgKyBlbmNvZGVVUklDb21wb25lbnQoYXJyYXlWYWwpKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBwYXJhbXMucHVzaChlbmNvZGVVUklDb21wb25lbnQoa2V5KSArICc9JyArIGVuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gT2JqZWN0LmVudHJpZXMocXVlcnlzdHJpbmdQYXJhbXMpOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgIHZhciBfYiA9IF9hW19pXSwga2V5ID0gX2JbMF0sIHZhbHVlID0gX2JbMV07XHJcbiAgICAgICAgX2xvb3BfMShrZXksIHZhbHVlKTtcclxuICAgIH1cclxuICAgIHJldHVybiBwYXJhbXMubGVuZ3RoID8gJyYnICsgcGFyYW1zLmpvaW4oJyYnKSA6ICcnO1xyXG59XHJcbi8qKlxyXG4gKiBEZWNvZGVzIGEgcXVlcnlzdHJpbmcgKGUuZy4gP2FyZz12YWwmYXJnMj12YWwyKSBpbnRvIGEgcGFyYW1zIG9iamVjdFxyXG4gKiAoZS5nLiB7YXJnOiAndmFsJywgYXJnMjogJ3ZhbDInfSlcclxuICovXHJcbmZ1bmN0aW9uIHF1ZXJ5c3RyaW5nRGVjb2RlKHF1ZXJ5c3RyaW5nKSB7XHJcbiAgICB2YXIgb2JqID0ge307XHJcbiAgICB2YXIgdG9rZW5zID0gcXVlcnlzdHJpbmcucmVwbGFjZSgvXlxcPy8sICcnKS5zcGxpdCgnJicpO1xyXG4gICAgdG9rZW5zLmZvckVhY2goZnVuY3Rpb24gKHRva2VuKSB7XHJcbiAgICAgICAgaWYgKHRva2VuKSB7XHJcbiAgICAgICAgICAgIHZhciBfYSA9IHRva2VuLnNwbGl0KCc9JyksIGtleSA9IF9hWzBdLCB2YWx1ZSA9IF9hWzFdO1xyXG4gICAgICAgICAgICBvYmpbZGVjb2RlVVJJQ29tcG9uZW50KGtleSldID0gZGVjb2RlVVJJQ29tcG9uZW50KHZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBvYmo7XHJcbn1cclxuLyoqXHJcbiAqIEV4dHJhY3QgdGhlIHF1ZXJ5IHN0cmluZyBwYXJ0IG9mIGEgVVJMLCBpbmNsdWRpbmcgdGhlIGxlYWRpbmcgcXVlc3Rpb24gbWFyayAoaWYgcHJlc2VudCkuXHJcbiAqL1xyXG5mdW5jdGlvbiBleHRyYWN0UXVlcnlzdHJpbmcodXJsKSB7XHJcbiAgICB2YXIgcXVlcnlTdGFydCA9IHVybC5pbmRleE9mKCc/Jyk7XHJcbiAgICBpZiAoIXF1ZXJ5U3RhcnQpIHtcclxuICAgICAgICByZXR1cm4gJyc7XHJcbiAgICB9XHJcbiAgICB2YXIgZnJhZ21lbnRTdGFydCA9IHVybC5pbmRleE9mKCcjJywgcXVlcnlTdGFydCk7XHJcbiAgICByZXR1cm4gdXJsLnN1YnN0cmluZyhxdWVyeVN0YXJ0LCBmcmFnbWVudFN0YXJ0ID4gMCA/IGZyYWdtZW50U3RhcnQgOiB1bmRlZmluZWQpO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBAZmlsZW92ZXJ2aWV3IFNIQS0xIGNyeXB0b2dyYXBoaWMgaGFzaC5cclxuICogVmFyaWFibGUgbmFtZXMgZm9sbG93IHRoZSBub3RhdGlvbiBpbiBGSVBTIFBVQiAxODAtMzpcclxuICogaHR0cDovL2NzcmMubmlzdC5nb3YvcHVibGljYXRpb25zL2ZpcHMvZmlwczE4MC0zL2ZpcHMxODAtM19maW5hbC5wZGYuXHJcbiAqXHJcbiAqIFVzYWdlOlxyXG4gKiAgIHZhciBzaGExID0gbmV3IHNoYTEoKTtcclxuICogICBzaGExLnVwZGF0ZShieXRlcyk7XHJcbiAqICAgdmFyIGhhc2ggPSBzaGExLmRpZ2VzdCgpO1xyXG4gKlxyXG4gKiBQZXJmb3JtYW5jZTpcclxuICogICBDaHJvbWUgMjM6ICAgfjQwMCBNYml0L3NcclxuICogICBGaXJlZm94IDE2OiAgfjI1MCBNYml0L3NcclxuICpcclxuICovXHJcbi8qKlxyXG4gKiBTSEEtMSBjcnlwdG9ncmFwaGljIGhhc2ggY29uc3RydWN0b3IuXHJcbiAqXHJcbiAqIFRoZSBwcm9wZXJ0aWVzIGRlY2xhcmVkIGhlcmUgYXJlIGRpc2N1c3NlZCBpbiB0aGUgYWJvdmUgYWxnb3JpdGhtIGRvY3VtZW50LlxyXG4gKiBAY29uc3RydWN0b3JcclxuICogQGZpbmFsXHJcbiAqIEBzdHJ1Y3RcclxuICovXHJcbnZhciBTaGExID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gU2hhMSgpIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBIb2xkcyB0aGUgcHJldmlvdXMgdmFsdWVzIG9mIGFjY3VtdWxhdGVkIHZhcmlhYmxlcyBhLWUgaW4gdGhlIGNvbXByZXNzX1xyXG4gICAgICAgICAqIGZ1bmN0aW9uLlxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5jaGFpbl8gPSBbXTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBBIGJ1ZmZlciBob2xkaW5nIHRoZSBwYXJ0aWFsbHkgY29tcHV0ZWQgaGFzaCByZXN1bHQuXHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLmJ1Zl8gPSBbXTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBBbiBhcnJheSBvZiA4MCBieXRlcywgZWFjaCBhIHBhcnQgb2YgdGhlIG1lc3NhZ2UgdG8gYmUgaGFzaGVkLiAgUmVmZXJyZWQgdG9cclxuICAgICAgICAgKiBhcyB0aGUgbWVzc2FnZSBzY2hlZHVsZSBpbiB0aGUgZG9jcy5cclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuV18gPSBbXTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBDb250YWlucyBkYXRhIG5lZWRlZCB0byBwYWQgbWVzc2FnZXMgbGVzcyB0aGFuIDY0IGJ5dGVzLlxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5wYWRfID0gW107XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQHByaXZhdGUge251bWJlcn1cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLmluYnVmXyA9IDA7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQHByaXZhdGUge251bWJlcn1cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLnRvdGFsXyA9IDA7XHJcbiAgICAgICAgdGhpcy5ibG9ja1NpemUgPSA1MTIgLyA4O1xyXG4gICAgICAgIHRoaXMucGFkX1swXSA9IDEyODtcclxuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IHRoaXMuYmxvY2tTaXplOyArK2kpIHtcclxuICAgICAgICAgICAgdGhpcy5wYWRfW2ldID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5yZXNldCgpO1xyXG4gICAgfVxyXG4gICAgU2hhMS5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bMF0gPSAweDY3NDUyMzAxO1xyXG4gICAgICAgIHRoaXMuY2hhaW5fWzFdID0gMHhlZmNkYWI4OTtcclxuICAgICAgICB0aGlzLmNoYWluX1syXSA9IDB4OThiYWRjZmU7XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bM10gPSAweDEwMzI1NDc2O1xyXG4gICAgICAgIHRoaXMuY2hhaW5fWzRdID0gMHhjM2QyZTFmMDtcclxuICAgICAgICB0aGlzLmluYnVmXyA9IDA7XHJcbiAgICAgICAgdGhpcy50b3RhbF8gPSAwO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogSW50ZXJuYWwgY29tcHJlc3MgaGVscGVyIGZ1bmN0aW9uLlxyXG4gICAgICogQHBhcmFtIGJ1ZiBCbG9jayB0byBjb21wcmVzcy5cclxuICAgICAqIEBwYXJhbSBvZmZzZXQgT2Zmc2V0IG9mIHRoZSBibG9jayBpbiB0aGUgYnVmZmVyLlxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqL1xyXG4gICAgU2hhMS5wcm90b3R5cGUuY29tcHJlc3NfID0gZnVuY3Rpb24gKGJ1Ziwgb2Zmc2V0KSB7XHJcbiAgICAgICAgaWYgKCFvZmZzZXQpIHtcclxuICAgICAgICAgICAgb2Zmc2V0ID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIFcgPSB0aGlzLldfO1xyXG4gICAgICAgIC8vIGdldCAxNiBiaWcgZW5kaWFuIHdvcmRzXHJcbiAgICAgICAgaWYgKHR5cGVvZiBidWYgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMTY7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgLy8gVE9ETyh1c2VyKTogW2J1ZyA4MTQwMTIyXSBSZWNlbnQgdmVyc2lvbnMgb2YgU2FmYXJpIGZvciBNYWMgT1MgYW5kIGlPU1xyXG4gICAgICAgICAgICAgICAgLy8gaGF2ZSBhIGJ1ZyB0aGF0IHR1cm5zIHRoZSBwb3N0LWluY3JlbWVudCArKyBvcGVyYXRvciBpbnRvIHByZS1pbmNyZW1lbnRcclxuICAgICAgICAgICAgICAgIC8vIGR1cmluZyBKSVQgY29tcGlsYXRpb24uICBXZSBoYXZlIGNvZGUgdGhhdCBkZXBlbmRzIGhlYXZpbHkgb24gU0hBLTEgZm9yXHJcbiAgICAgICAgICAgICAgICAvLyBjb3JyZWN0bmVzcyBhbmQgd2hpY2ggaXMgYWZmZWN0ZWQgYnkgdGhpcyBidWcsIHNvIEkndmUgcmVtb3ZlZCBhbGwgdXNlc1xyXG4gICAgICAgICAgICAgICAgLy8gb2YgcG9zdC1pbmNyZW1lbnQgKysgaW4gd2hpY2ggdGhlIHJlc3VsdCB2YWx1ZSBpcyB1c2VkLiAgV2UgY2FuIHJldmVydFxyXG4gICAgICAgICAgICAgICAgLy8gdGhpcyBjaGFuZ2Ugb25jZSB0aGUgU2FmYXJpIGJ1Z1xyXG4gICAgICAgICAgICAgICAgLy8gKGh0dHBzOi8vYnVncy53ZWJraXQub3JnL3Nob3dfYnVnLmNnaT9pZD0xMDkwMzYpIGhhcyBiZWVuIGZpeGVkIGFuZFxyXG4gICAgICAgICAgICAgICAgLy8gbW9zdCBjbGllbnRzIGhhdmUgYmVlbiB1cGRhdGVkLlxyXG4gICAgICAgICAgICAgICAgV1tpXSA9XHJcbiAgICAgICAgICAgICAgICAgICAgKGJ1Zi5jaGFyQ29kZUF0KG9mZnNldCkgPDwgMjQpIHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgKGJ1Zi5jaGFyQ29kZUF0KG9mZnNldCArIDEpIDw8IDE2KSB8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChidWYuY2hhckNvZGVBdChvZmZzZXQgKyAyKSA8PCA4KSB8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1Zi5jaGFyQ29kZUF0KG9mZnNldCArIDMpO1xyXG4gICAgICAgICAgICAgICAgb2Zmc2V0ICs9IDQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMTY7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgV1tpXSA9XHJcbiAgICAgICAgICAgICAgICAgICAgKGJ1ZltvZmZzZXRdIDw8IDI0KSB8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChidWZbb2Zmc2V0ICsgMV0gPDwgMTYpIHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgKGJ1ZltvZmZzZXQgKyAyXSA8PCA4KSB8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1ZltvZmZzZXQgKyAzXTtcclxuICAgICAgICAgICAgICAgIG9mZnNldCArPSA0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGV4cGFuZCB0byA4MCB3b3Jkc1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAxNjsgaSA8IDgwOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIHQgPSBXW2kgLSAzXSBeIFdbaSAtIDhdIF4gV1tpIC0gMTRdIF4gV1tpIC0gMTZdO1xyXG4gICAgICAgICAgICBXW2ldID0gKCh0IDw8IDEpIHwgKHQgPj4+IDMxKSkgJiAweGZmZmZmZmZmO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgYSA9IHRoaXMuY2hhaW5fWzBdO1xyXG4gICAgICAgIHZhciBiID0gdGhpcy5jaGFpbl9bMV07XHJcbiAgICAgICAgdmFyIGMgPSB0aGlzLmNoYWluX1syXTtcclxuICAgICAgICB2YXIgZCA9IHRoaXMuY2hhaW5fWzNdO1xyXG4gICAgICAgIHZhciBlID0gdGhpcy5jaGFpbl9bNF07XHJcbiAgICAgICAgdmFyIGYsIGs7XHJcbiAgICAgICAgLy8gVE9ETyh1c2VyKTogVHJ5IHRvIHVucm9sbCB0aGlzIGxvb3AgdG8gc3BlZWQgdXAgdGhlIGNvbXB1dGF0aW9uLlxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgODA7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAoaSA8IDQwKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaSA8IDIwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZiA9IGQgXiAoYiAmIChjIF4gZCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGsgPSAweDVhODI3OTk5O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZiA9IGIgXiBjIF4gZDtcclxuICAgICAgICAgICAgICAgICAgICBrID0gMHg2ZWQ5ZWJhMTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmIChpIDwgNjApIHtcclxuICAgICAgICAgICAgICAgICAgICBmID0gKGIgJiBjKSB8IChkICYgKGIgfCBjKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgayA9IDB4OGYxYmJjZGM7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBmID0gYiBeIGMgXiBkO1xyXG4gICAgICAgICAgICAgICAgICAgIGsgPSAweGNhNjJjMWQ2O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciB0ID0gKCgoYSA8PCA1KSB8IChhID4+PiAyNykpICsgZiArIGUgKyBrICsgV1tpXSkgJiAweGZmZmZmZmZmO1xyXG4gICAgICAgICAgICBlID0gZDtcclxuICAgICAgICAgICAgZCA9IGM7XHJcbiAgICAgICAgICAgIGMgPSAoKGIgPDwgMzApIHwgKGIgPj4+IDIpKSAmIDB4ZmZmZmZmZmY7XHJcbiAgICAgICAgICAgIGIgPSBhO1xyXG4gICAgICAgICAgICBhID0gdDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bMF0gPSAodGhpcy5jaGFpbl9bMF0gKyBhKSAmIDB4ZmZmZmZmZmY7XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bMV0gPSAodGhpcy5jaGFpbl9bMV0gKyBiKSAmIDB4ZmZmZmZmZmY7XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bMl0gPSAodGhpcy5jaGFpbl9bMl0gKyBjKSAmIDB4ZmZmZmZmZmY7XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bM10gPSAodGhpcy5jaGFpbl9bM10gKyBkKSAmIDB4ZmZmZmZmZmY7XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bNF0gPSAodGhpcy5jaGFpbl9bNF0gKyBlKSAmIDB4ZmZmZmZmZmY7XHJcbiAgICB9O1xyXG4gICAgU2hhMS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKGJ5dGVzLCBsZW5ndGgpIHtcclxuICAgICAgICAvLyBUT0RPKGpvaG5sZW56KTogdGlnaHRlbiB0aGUgZnVuY3Rpb24gc2lnbmF0dXJlIGFuZCByZW1vdmUgdGhpcyBjaGVja1xyXG4gICAgICAgIGlmIChieXRlcyA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGxlbmd0aCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIGxlbmd0aCA9IGJ5dGVzLmxlbmd0aDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGxlbmd0aE1pbnVzQmxvY2sgPSBsZW5ndGggLSB0aGlzLmJsb2NrU2l6ZTtcclxuICAgICAgICB2YXIgbiA9IDA7XHJcbiAgICAgICAgLy8gVXNpbmcgbG9jYWwgaW5zdGVhZCBvZiBtZW1iZXIgdmFyaWFibGVzIGdpdmVzIH41JSBzcGVlZHVwIG9uIEZpcmVmb3ggMTYuXHJcbiAgICAgICAgdmFyIGJ1ZiA9IHRoaXMuYnVmXztcclxuICAgICAgICB2YXIgaW5idWYgPSB0aGlzLmluYnVmXztcclxuICAgICAgICAvLyBUaGUgb3V0ZXIgd2hpbGUgbG9vcCBzaG91bGQgZXhlY3V0ZSBhdCBtb3N0IHR3aWNlLlxyXG4gICAgICAgIHdoaWxlIChuIDwgbGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIC8vIFdoZW4gd2UgaGF2ZSBubyBkYXRhIGluIHRoZSBibG9jayB0byB0b3AgdXAsIHdlIGNhbiBkaXJlY3RseSBwcm9jZXNzIHRoZVxyXG4gICAgICAgICAgICAvLyBpbnB1dCBidWZmZXIgKGFzc3VtaW5nIGl0IGNvbnRhaW5zIHN1ZmZpY2llbnQgZGF0YSkuIFRoaXMgZ2l2ZXMgfjI1JVxyXG4gICAgICAgICAgICAvLyBzcGVlZHVwIG9uIENocm9tZSAyMyBhbmQgfjE1JSBzcGVlZHVwIG9uIEZpcmVmb3ggMTYsIGJ1dCByZXF1aXJlcyB0aGF0XHJcbiAgICAgICAgICAgIC8vIHRoZSBkYXRhIGlzIHByb3ZpZGVkIGluIGxhcmdlIGNodW5rcyAob3IgaW4gbXVsdGlwbGVzIG9mIDY0IGJ5dGVzKS5cclxuICAgICAgICAgICAgaWYgKGluYnVmID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAobiA8PSBsZW5ndGhNaW51c0Jsb2NrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb21wcmVzc18oYnl0ZXMsIG4pO1xyXG4gICAgICAgICAgICAgICAgICAgIG4gKz0gdGhpcy5ibG9ja1NpemU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBieXRlcyA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgICAgIHdoaWxlIChuIDwgbGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnVmW2luYnVmXSA9IGJ5dGVzLmNoYXJDb2RlQXQobik7XHJcbiAgICAgICAgICAgICAgICAgICAgKytpbmJ1ZjtcclxuICAgICAgICAgICAgICAgICAgICArK247XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluYnVmID09PSB0aGlzLmJsb2NrU2l6ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbXByZXNzXyhidWYpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbmJ1ZiA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEp1bXAgdG8gdGhlIG91dGVyIGxvb3Agc28gd2UgdXNlIHRoZSBmdWxsLWJsb2NrIG9wdGltaXphdGlvbi5cclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKG4gPCBsZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBidWZbaW5idWZdID0gYnl0ZXNbbl07XHJcbiAgICAgICAgICAgICAgICAgICAgKytpbmJ1ZjtcclxuICAgICAgICAgICAgICAgICAgICArK247XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluYnVmID09PSB0aGlzLmJsb2NrU2l6ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbXByZXNzXyhidWYpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbmJ1ZiA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEp1bXAgdG8gdGhlIG91dGVyIGxvb3Agc28gd2UgdXNlIHRoZSBmdWxsLWJsb2NrIG9wdGltaXphdGlvbi5cclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaW5idWZfID0gaW5idWY7XHJcbiAgICAgICAgdGhpcy50b3RhbF8gKz0gbGVuZ3RoO1xyXG4gICAgfTtcclxuICAgIC8qKiBAb3ZlcnJpZGUgKi9cclxuICAgIFNoYTEucHJvdG90eXBlLmRpZ2VzdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgZGlnZXN0ID0gW107XHJcbiAgICAgICAgdmFyIHRvdGFsQml0cyA9IHRoaXMudG90YWxfICogODtcclxuICAgICAgICAvLyBBZGQgcGFkIDB4ODAgMHgwMCouXHJcbiAgICAgICAgaWYgKHRoaXMuaW5idWZfIDwgNTYpIHtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGUodGhpcy5wYWRfLCA1NiAtIHRoaXMuaW5idWZfKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlKHRoaXMucGFkXywgdGhpcy5ibG9ja1NpemUgLSAodGhpcy5pbmJ1Zl8gLSA1NikpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBBZGQgIyBiaXRzLlxyXG4gICAgICAgIGZvciAodmFyIGkgPSB0aGlzLmJsb2NrU2l6ZSAtIDE7IGkgPj0gNTY7IGktLSkge1xyXG4gICAgICAgICAgICB0aGlzLmJ1Zl9baV0gPSB0b3RhbEJpdHMgJiAyNTU7XHJcbiAgICAgICAgICAgIHRvdGFsQml0cyAvPSAyNTY7IC8vIERvbid0IHVzZSBiaXQtc2hpZnRpbmcgaGVyZSFcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jb21wcmVzc18odGhpcy5idWZfKTtcclxuICAgICAgICB2YXIgbiA9IDA7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA1OyBpKyspIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDI0OyBqID49IDA7IGogLT0gOCkge1xyXG4gICAgICAgICAgICAgICAgZGlnZXN0W25dID0gKHRoaXMuY2hhaW5fW2ldID4+IGopICYgMjU1O1xyXG4gICAgICAgICAgICAgICAgKytuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBkaWdlc3Q7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFNoYTE7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBIZWxwZXIgdG8gbWFrZSBhIFN1YnNjcmliZSBmdW5jdGlvbiAoanVzdCBsaWtlIFByb21pc2UgaGVscHMgbWFrZSBhXHJcbiAqIFRoZW5hYmxlKS5cclxuICpcclxuICogQHBhcmFtIGV4ZWN1dG9yIEZ1bmN0aW9uIHdoaWNoIGNhbiBtYWtlIGNhbGxzIHRvIGEgc2luZ2xlIE9ic2VydmVyXHJcbiAqICAgICBhcyBhIHByb3h5LlxyXG4gKiBAcGFyYW0gb25Ob09ic2VydmVycyBDYWxsYmFjayB3aGVuIGNvdW50IG9mIE9ic2VydmVycyBnb2VzIHRvIHplcm8uXHJcbiAqL1xyXG5mdW5jdGlvbiBjcmVhdGVTdWJzY3JpYmUoZXhlY3V0b3IsIG9uTm9PYnNlcnZlcnMpIHtcclxuICAgIHZhciBwcm94eSA9IG5ldyBPYnNlcnZlclByb3h5KGV4ZWN1dG9yLCBvbk5vT2JzZXJ2ZXJzKTtcclxuICAgIHJldHVybiBwcm94eS5zdWJzY3JpYmUuYmluZChwcm94eSk7XHJcbn1cclxuLyoqXHJcbiAqIEltcGxlbWVudCBmYW4tb3V0IGZvciBhbnkgbnVtYmVyIG9mIE9ic2VydmVycyBhdHRhY2hlZCB2aWEgYSBzdWJzY3JpYmVcclxuICogZnVuY3Rpb24uXHJcbiAqL1xyXG52YXIgT2JzZXJ2ZXJQcm94eSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIC8qKlxyXG4gICAgICogQHBhcmFtIGV4ZWN1dG9yIEZ1bmN0aW9uIHdoaWNoIGNhbiBtYWtlIGNhbGxzIHRvIGEgc2luZ2xlIE9ic2VydmVyXHJcbiAgICAgKiAgICAgYXMgYSBwcm94eS5cclxuICAgICAqIEBwYXJhbSBvbk5vT2JzZXJ2ZXJzIENhbGxiYWNrIHdoZW4gY291bnQgb2YgT2JzZXJ2ZXJzIGdvZXMgdG8gemVyby5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gT2JzZXJ2ZXJQcm94eShleGVjdXRvciwgb25Ob09ic2VydmVycykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5vYnNlcnZlcnMgPSBbXTtcclxuICAgICAgICB0aGlzLnVuc3Vic2NyaWJlcyA9IFtdO1xyXG4gICAgICAgIHRoaXMub2JzZXJ2ZXJDb3VudCA9IDA7XHJcbiAgICAgICAgLy8gTWljcm8tdGFzayBzY2hlZHVsaW5nIGJ5IGNhbGxpbmcgdGFzay50aGVuKCkuXHJcbiAgICAgICAgdGhpcy50YXNrID0gUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgdGhpcy5maW5hbGl6ZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLm9uTm9PYnNlcnZlcnMgPSBvbk5vT2JzZXJ2ZXJzO1xyXG4gICAgICAgIC8vIENhbGwgdGhlIGV4ZWN1dG9yIGFzeW5jaHJvbm91c2x5IHNvIHN1YnNjcmliZXJzIHRoYXQgYXJlIGNhbGxlZFxyXG4gICAgICAgIC8vIHN5bmNocm9ub3VzbHkgYWZ0ZXIgdGhlIGNyZWF0aW9uIG9mIHRoZSBzdWJzY3JpYmUgZnVuY3Rpb25cclxuICAgICAgICAvLyBjYW4gc3RpbGwgcmVjZWl2ZSB0aGUgdmVyeSBmaXJzdCB2YWx1ZSBnZW5lcmF0ZWQgaW4gdGhlIGV4ZWN1dG9yLlxyXG4gICAgICAgIHRoaXMudGFza1xyXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGV4ZWN1dG9yKF90aGlzKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgX3RoaXMuZXJyb3IoZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBPYnNlcnZlclByb3h5LnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5mb3JFYWNoT2JzZXJ2ZXIoZnVuY3Rpb24gKG9ic2VydmVyKSB7XHJcbiAgICAgICAgICAgIG9ic2VydmVyLm5leHQodmFsdWUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIE9ic2VydmVyUHJveHkucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgdGhpcy5mb3JFYWNoT2JzZXJ2ZXIoZnVuY3Rpb24gKG9ic2VydmVyKSB7XHJcbiAgICAgICAgICAgIG9ic2VydmVyLmVycm9yKGVycm9yKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmNsb3NlKGVycm9yKTtcclxuICAgIH07XHJcbiAgICBPYnNlcnZlclByb3h5LnByb3RvdHlwZS5jb21wbGV0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmZvckVhY2hPYnNlcnZlcihmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcclxuICAgICAgICAgICAgb2JzZXJ2ZXIuY29tcGxldGUoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBTdWJzY3JpYmUgZnVuY3Rpb24gdGhhdCBjYW4gYmUgdXNlZCB0byBhZGQgYW4gT2JzZXJ2ZXIgdG8gdGhlIGZhbi1vdXQgbGlzdC5cclxuICAgICAqXHJcbiAgICAgKiAtIFdlIHJlcXVpcmUgdGhhdCBubyBldmVudCBpcyBzZW50IHRvIGEgc3Vic2NyaWJlciBzeWNocm9ub3VzbHkgdG8gdGhlaXJcclxuICAgICAqICAgY2FsbCB0byBzdWJzY3JpYmUoKS5cclxuICAgICAqL1xyXG4gICAgT2JzZXJ2ZXJQcm94eS5wcm90b3R5cGUuc3Vic2NyaWJlID0gZnVuY3Rpb24gKG5leHRPck9ic2VydmVyLCBlcnJvciwgY29tcGxldGUpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBvYnNlcnZlcjtcclxuICAgICAgICBpZiAobmV4dE9yT2JzZXJ2ZXIgPT09IHVuZGVmaW5lZCAmJlxyXG4gICAgICAgICAgICBlcnJvciA9PT0gdW5kZWZpbmVkICYmXHJcbiAgICAgICAgICAgIGNvbXBsZXRlID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIE9ic2VydmVyLicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBBc3NlbWJsZSBhbiBPYnNlcnZlciBvYmplY3Qgd2hlbiBwYXNzZWQgYXMgY2FsbGJhY2sgZnVuY3Rpb25zLlxyXG4gICAgICAgIGlmIChpbXBsZW1lbnRzQW55TWV0aG9kcyhuZXh0T3JPYnNlcnZlciwgW1xyXG4gICAgICAgICAgICAnbmV4dCcsXHJcbiAgICAgICAgICAgICdlcnJvcicsXHJcbiAgICAgICAgICAgICdjb21wbGV0ZSdcclxuICAgICAgICBdKSkge1xyXG4gICAgICAgICAgICBvYnNlcnZlciA9IG5leHRPck9ic2VydmVyO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgb2JzZXJ2ZXIgPSB7XHJcbiAgICAgICAgICAgICAgICBuZXh0OiBuZXh0T3JPYnNlcnZlcixcclxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvcixcclxuICAgICAgICAgICAgICAgIGNvbXBsZXRlOiBjb21wbGV0ZVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAob2JzZXJ2ZXIubmV4dCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIG9ic2VydmVyLm5leHQgPSBub29wO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAob2JzZXJ2ZXIuZXJyb3IgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBvYnNlcnZlci5lcnJvciA9IG5vb3A7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChvYnNlcnZlci5jb21wbGV0ZSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIG9ic2VydmVyLmNvbXBsZXRlID0gbm9vcDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHVuc3ViID0gdGhpcy51bnN1YnNjcmliZU9uZS5iaW5kKHRoaXMsIHRoaXMub2JzZXJ2ZXJzLmxlbmd0aCk7XHJcbiAgICAgICAgLy8gQXR0ZW1wdCB0byBzdWJzY3JpYmUgdG8gYSB0ZXJtaW5hdGVkIE9ic2VydmFibGUgLSB3ZVxyXG4gICAgICAgIC8vIGp1c3QgcmVzcG9uZCB0byB0aGUgT2JzZXJ2ZXIgd2l0aCB0aGUgZmluYWwgZXJyb3Igb3IgY29tcGxldGVcclxuICAgICAgICAvLyBldmVudC5cclxuICAgICAgICBpZiAodGhpcy5maW5hbGl6ZWQpIHtcclxuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1mbG9hdGluZy1wcm9taXNlc1xyXG4gICAgICAgICAgICB0aGlzLnRhc2sudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5maW5hbEVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLmVycm9yKF90aGlzLmZpbmFsRXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIuY29tcGxldGUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIG5vdGhpbmdcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMub2JzZXJ2ZXJzLnB1c2gob2JzZXJ2ZXIpO1xyXG4gICAgICAgIHJldHVybiB1bnN1YjtcclxuICAgIH07XHJcbiAgICAvLyBVbnN1YnNjcmliZSBpcyBzeW5jaHJvbm91cyAtIHdlIGd1YXJhbnRlZSB0aGF0IG5vIGV2ZW50cyBhcmUgc2VudCB0b1xyXG4gICAgLy8gYW55IHVuc3Vic2NyaWJlZCBPYnNlcnZlci5cclxuICAgIE9ic2VydmVyUHJveHkucHJvdG90eXBlLnVuc3Vic2NyaWJlT25lID0gZnVuY3Rpb24gKGkpIHtcclxuICAgICAgICBpZiAodGhpcy5vYnNlcnZlcnMgPT09IHVuZGVmaW5lZCB8fCB0aGlzLm9ic2VydmVyc1tpXSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZGVsZXRlIHRoaXMub2JzZXJ2ZXJzW2ldO1xyXG4gICAgICAgIHRoaXMub2JzZXJ2ZXJDb3VudCAtPSAxO1xyXG4gICAgICAgIGlmICh0aGlzLm9ic2VydmVyQ291bnQgPT09IDAgJiYgdGhpcy5vbk5vT2JzZXJ2ZXJzICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5vbk5vT2JzZXJ2ZXJzKHRoaXMpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBPYnNlcnZlclByb3h5LnByb3RvdHlwZS5mb3JFYWNoT2JzZXJ2ZXIgPSBmdW5jdGlvbiAoZm4pIHtcclxuICAgICAgICBpZiAodGhpcy5maW5hbGl6ZWQpIHtcclxuICAgICAgICAgICAgLy8gQWxyZWFkeSBjbG9zZWQgYnkgcHJldmlvdXMgZXZlbnQuLi4uanVzdCBlYXQgdGhlIGFkZGl0aW9uYWwgdmFsdWVzLlxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFNpbmNlIHNlbmRPbmUgY2FsbHMgYXN5bmNocm9ub3VzbHkgLSB0aGVyZSBpcyBubyBjaGFuY2UgdGhhdFxyXG4gICAgICAgIC8vIHRoaXMub2JzZXJ2ZXJzIHdpbGwgYmVjb21lIHVuZGVmaW5lZC5cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMub2JzZXJ2ZXJzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VuZE9uZShpLCBmbik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8vIENhbGwgdGhlIE9ic2VydmVyIHZpYSBvbmUgb2YgaXQncyBjYWxsYmFjayBmdW5jdGlvbi4gV2UgYXJlIGNhcmVmdWwgdG9cclxuICAgIC8vIGNvbmZpcm0gdGhhdCB0aGUgb2JzZXJ2ZSBoYXMgbm90IGJlZW4gdW5zdWJzY3JpYmVkIHNpbmNlIHRoaXMgYXN5bmNocm9ub3VzXHJcbiAgICAvLyBmdW5jdGlvbiBoYWQgYmVlbiBxdWV1ZWQuXHJcbiAgICBPYnNlcnZlclByb3h5LnByb3RvdHlwZS5zZW5kT25lID0gZnVuY3Rpb24gKGksIGZuKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAvLyBFeGVjdXRlIHRoZSBjYWxsYmFjayBhc3luY2hyb25vdXNseVxyXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZmxvYXRpbmctcHJvbWlzZXNcclxuICAgICAgICB0aGlzLnRhc2sudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChfdGhpcy5vYnNlcnZlcnMgIT09IHVuZGVmaW5lZCAmJiBfdGhpcy5vYnNlcnZlcnNbaV0gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICBmbihfdGhpcy5vYnNlcnZlcnNbaV0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBJZ25vcmUgZXhjZXB0aW9ucyByYWlzZWQgaW4gT2JzZXJ2ZXJzIG9yIG1pc3NpbmcgbWV0aG9kcyBvZiBhblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIE9ic2VydmVyLlxyXG4gICAgICAgICAgICAgICAgICAgIC8vIExvZyBlcnJvciB0byBjb25zb2xlLiBiLzMxNDA0ODA2XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBjb25zb2xlICE9PSAndW5kZWZpbmVkJyAmJiBjb25zb2xlLmVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgT2JzZXJ2ZXJQcm94eS5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBpZiAodGhpcy5maW5hbGl6ZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmZpbmFsaXplZCA9IHRydWU7XHJcbiAgICAgICAgaWYgKGVyciAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZmluYWxFcnJvciA9IGVycjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gUHJveHkgaXMgbm8gbG9uZ2VyIG5lZWRlZCAtIGdhcmJhZ2UgY29sbGVjdCByZWZlcmVuY2VzXHJcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1mbG9hdGluZy1wcm9taXNlc1xyXG4gICAgICAgIHRoaXMudGFzay50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgX3RoaXMub2JzZXJ2ZXJzID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICBfdGhpcy5vbk5vT2JzZXJ2ZXJzID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBPYnNlcnZlclByb3h5O1xyXG59KCkpO1xyXG4vKiogVHVybiBzeW5jaHJvbm91cyBmdW5jdGlvbiBpbnRvIG9uZSBjYWxsZWQgYXN5bmNocm9ub3VzbHkuICovXHJcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvYmFuLXR5cGVzXHJcbmZ1bmN0aW9uIGFzeW5jKGZuLCBvbkVycm9yKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBhcmdzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICBQcm9taXNlLnJlc29sdmUodHJ1ZSlcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBmbi5hcHBseSh2b2lkIDAsIGFyZ3MpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIG9uRXJyb3IoZXJyb3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG59XHJcbi8qKlxyXG4gKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgb2JqZWN0IHBhc3NlZCBpbiBpbXBsZW1lbnRzIGFueSBvZiB0aGUgbmFtZWQgbWV0aG9kcy5cclxuICovXHJcbmZ1bmN0aW9uIGltcGxlbWVudHNBbnlNZXRob2RzKG9iaiwgbWV0aG9kcykge1xyXG4gICAgaWYgKHR5cGVvZiBvYmogIT09ICdvYmplY3QnIHx8IG9iaiA9PT0gbnVsbCkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIGZvciAodmFyIF9pID0gMCwgbWV0aG9kc18xID0gbWV0aG9kczsgX2kgPCBtZXRob2RzXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgdmFyIG1ldGhvZCA9IG1ldGhvZHNfMVtfaV07XHJcbiAgICAgICAgaWYgKG1ldGhvZCBpbiBvYmogJiYgdHlwZW9mIG9ialttZXRob2RdID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBmYWxzZTtcclxufVxyXG5mdW5jdGlvbiBub29wKCkge1xyXG4gICAgLy8gZG8gbm90aGluZ1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBDaGVjayB0byBtYWtlIHN1cmUgdGhlIGFwcHJvcHJpYXRlIG51bWJlciBvZiBhcmd1bWVudHMgYXJlIHByb3ZpZGVkIGZvciBhIHB1YmxpYyBmdW5jdGlvbi5cclxuICogVGhyb3dzIGFuIGVycm9yIGlmIGl0IGZhaWxzLlxyXG4gKlxyXG4gKiBAcGFyYW0gZm5OYW1lIFRoZSBmdW5jdGlvbiBuYW1lXHJcbiAqIEBwYXJhbSBtaW5Db3VudCBUaGUgbWluaW11bSBudW1iZXIgb2YgYXJndW1lbnRzIHRvIGFsbG93IGZvciB0aGUgZnVuY3Rpb24gY2FsbFxyXG4gKiBAcGFyYW0gbWF4Q291bnQgVGhlIG1heGltdW0gbnVtYmVyIG9mIGFyZ3VtZW50IHRvIGFsbG93IGZvciB0aGUgZnVuY3Rpb24gY2FsbFxyXG4gKiBAcGFyYW0gYXJnQ291bnQgVGhlIGFjdHVhbCBudW1iZXIgb2YgYXJndW1lbnRzIHByb3ZpZGVkLlxyXG4gKi9cclxudmFyIHZhbGlkYXRlQXJnQ291bnQgPSBmdW5jdGlvbiAoZm5OYW1lLCBtaW5Db3VudCwgbWF4Q291bnQsIGFyZ0NvdW50KSB7XHJcbiAgICB2YXIgYXJnRXJyb3I7XHJcbiAgICBpZiAoYXJnQ291bnQgPCBtaW5Db3VudCkge1xyXG4gICAgICAgIGFyZ0Vycm9yID0gJ2F0IGxlYXN0ICcgKyBtaW5Db3VudDtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGFyZ0NvdW50ID4gbWF4Q291bnQpIHtcclxuICAgICAgICBhcmdFcnJvciA9IG1heENvdW50ID09PSAwID8gJ25vbmUnIDogJ25vIG1vcmUgdGhhbiAnICsgbWF4Q291bnQ7XHJcbiAgICB9XHJcbiAgICBpZiAoYXJnRXJyb3IpIHtcclxuICAgICAgICB2YXIgZXJyb3IgPSBmbk5hbWUgK1xyXG4gICAgICAgICAgICAnIGZhaWxlZDogV2FzIGNhbGxlZCB3aXRoICcgK1xyXG4gICAgICAgICAgICBhcmdDb3VudCArXHJcbiAgICAgICAgICAgIChhcmdDb3VudCA9PT0gMSA/ICcgYXJndW1lbnQuJyA6ICcgYXJndW1lbnRzLicpICtcclxuICAgICAgICAgICAgJyBFeHBlY3RzICcgK1xyXG4gICAgICAgICAgICBhcmdFcnJvciArXHJcbiAgICAgICAgICAgICcuJztcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3IpO1xyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICogR2VuZXJhdGVzIGEgc3RyaW5nIHRvIHByZWZpeCBhbiBlcnJvciBtZXNzYWdlIGFib3V0IGZhaWxlZCBhcmd1bWVudCB2YWxpZGF0aW9uXHJcbiAqXHJcbiAqIEBwYXJhbSBmbk5hbWUgVGhlIGZ1bmN0aW9uIG5hbWVcclxuICogQHBhcmFtIGFyZ05hbWUgVGhlIG5hbWUgb2YgdGhlIGFyZ3VtZW50XHJcbiAqIEByZXR1cm4gVGhlIHByZWZpeCB0byBhZGQgdG8gdGhlIGVycm9yIHRocm93biBmb3IgdmFsaWRhdGlvbi5cclxuICovXHJcbmZ1bmN0aW9uIGVycm9yUHJlZml4KGZuTmFtZSwgYXJnTmFtZSkge1xyXG4gICAgcmV0dXJuIGZuTmFtZSArIFwiIGZhaWxlZDogXCIgKyBhcmdOYW1lICsgXCIgYXJndW1lbnQgXCI7XHJcbn1cclxuLyoqXHJcbiAqIEBwYXJhbSBmbk5hbWVcclxuICogQHBhcmFtIGFyZ3VtZW50TnVtYmVyXHJcbiAqIEBwYXJhbSBuYW1lc3BhY2VcclxuICogQHBhcmFtIG9wdGlvbmFsXHJcbiAqL1xyXG5mdW5jdGlvbiB2YWxpZGF0ZU5hbWVzcGFjZShmbk5hbWUsIG5hbWVzcGFjZSwgb3B0aW9uYWwpIHtcclxuICAgIGlmIChvcHRpb25hbCAmJiAhbmFtZXNwYWNlKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgaWYgKHR5cGVvZiBuYW1lc3BhY2UgIT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgLy9UT0RPOiBJIHNob3VsZCBkbyBtb3JlIHZhbGlkYXRpb24gaGVyZS4gV2Ugb25seSBhbGxvdyBjZXJ0YWluIGNoYXJzIGluIG5hbWVzcGFjZXMuXHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yUHJlZml4KGZuTmFtZSwgJ25hbWVzcGFjZScpICsgJ211c3QgYmUgYSB2YWxpZCBmaXJlYmFzZSBuYW1lc3BhY2UuJyk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gdmFsaWRhdGVDYWxsYmFjayhmbk5hbWUsIGFyZ3VtZW50TmFtZSwgXHJcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvYmFuLXR5cGVzXHJcbmNhbGxiYWNrLCBvcHRpb25hbCkge1xyXG4gICAgaWYgKG9wdGlvbmFsICYmICFjYWxsYmFjaykge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgIT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JQcmVmaXgoZm5OYW1lLCBhcmd1bWVudE5hbWUpICsgJ211c3QgYmUgYSB2YWxpZCBmdW5jdGlvbi4nKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiB2YWxpZGF0ZUNvbnRleHRPYmplY3QoZm5OYW1lLCBhcmd1bWVudE5hbWUsIGNvbnRleHQsIG9wdGlvbmFsKSB7XHJcbiAgICBpZiAob3B0aW9uYWwgJiYgIWNvbnRleHQpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBpZiAodHlwZW9mIGNvbnRleHQgIT09ICdvYmplY3QnIHx8IGNvbnRleHQgPT09IG51bGwpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JQcmVmaXgoZm5OYW1lLCBhcmd1bWVudE5hbWUpICsgJ211c3QgYmUgYSB2YWxpZCBjb250ZXh0IG9iamVjdC4nKTtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vLyBDb2RlIG9yaWdpbmFsbHkgY2FtZSBmcm9tIGdvb2cuY3J5cHQuc3RyaW5nVG9VdGY4Qnl0ZUFycmF5LCBidXQgZm9yIHNvbWUgcmVhc29uIHRoZXlcclxuLy8gYXV0b21hdGljYWxseSByZXBsYWNlZCAnXFxyXFxuJyB3aXRoICdcXG4nLCBhbmQgdGhleSBkaWRuJ3QgaGFuZGxlIHN1cnJvZ2F0ZSBwYWlycyxcclxuLy8gc28gaXQncyBiZWVuIG1vZGlmaWVkLlxyXG4vLyBOb3RlIHRoYXQgbm90IGFsbCBVbmljb2RlIGNoYXJhY3RlcnMgYXBwZWFyIGFzIHNpbmdsZSBjaGFyYWN0ZXJzIGluIEphdmFTY3JpcHQgc3RyaW5ncy5cclxuLy8gZnJvbUNoYXJDb2RlIHJldHVybnMgdGhlIFVURi0xNiBlbmNvZGluZyBvZiBhIGNoYXJhY3RlciAtIHNvIHNvbWUgVW5pY29kZSBjaGFyYWN0ZXJzXHJcbi8vIHVzZSAyIGNoYXJhY3RlcnMgaW4gSmF2YXNjcmlwdC4gIEFsbCA0LWJ5dGUgVVRGLTggY2hhcmFjdGVycyBiZWdpbiB3aXRoIGEgZmlyc3RcclxuLy8gY2hhcmFjdGVyIGluIHRoZSByYW5nZSAweEQ4MDAgLSAweERCRkYgKHRoZSBmaXJzdCBjaGFyYWN0ZXIgb2YgYSBzby1jYWxsZWQgc3Vycm9nYXRlXHJcbi8vIHBhaXIpLlxyXG4vLyBTZWUgaHR0cDovL3d3dy5lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzUuMS8jc2VjLTE1LjEuM1xyXG4vKipcclxuICogQHBhcmFtIHtzdHJpbmd9IHN0clxyXG4gKiBAcmV0dXJuIHtBcnJheX1cclxuICovXHJcbnZhciBzdHJpbmdUb0J5dGVBcnJheSA9IGZ1bmN0aW9uIChzdHIpIHtcclxuICAgIHZhciBvdXQgPSBbXTtcclxuICAgIHZhciBwID0gMDtcclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgdmFyIGMgPSBzdHIuY2hhckNvZGVBdChpKTtcclxuICAgICAgICAvLyBJcyB0aGlzIHRoZSBsZWFkIHN1cnJvZ2F0ZSBpbiBhIHN1cnJvZ2F0ZSBwYWlyP1xyXG4gICAgICAgIGlmIChjID49IDB4ZDgwMCAmJiBjIDw9IDB4ZGJmZikge1xyXG4gICAgICAgICAgICB2YXIgaGlnaCA9IGMgLSAweGQ4MDA7IC8vIHRoZSBoaWdoIDEwIGJpdHMuXHJcbiAgICAgICAgICAgIGkrKztcclxuICAgICAgICAgICAgYXNzZXJ0KGkgPCBzdHIubGVuZ3RoLCAnU3Vycm9nYXRlIHBhaXIgbWlzc2luZyB0cmFpbCBzdXJyb2dhdGUuJyk7XHJcbiAgICAgICAgICAgIHZhciBsb3cgPSBzdHIuY2hhckNvZGVBdChpKSAtIDB4ZGMwMDsgLy8gdGhlIGxvdyAxMCBiaXRzLlxyXG4gICAgICAgICAgICBjID0gMHgxMDAwMCArIChoaWdoIDw8IDEwKSArIGxvdztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGMgPCAxMjgpIHtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSBjO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjIDwgMjA0OCkge1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjID4+IDYpIHwgMTkyO1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjICYgNjMpIHwgMTI4O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjIDwgNjU1MzYpIHtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoYyA+PiAxMikgfCAyMjQ7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKChjID4+IDYpICYgNjMpIHwgMTI4O1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjICYgNjMpIHwgMTI4O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoYyA+PiAxOCkgfCAyNDA7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKChjID4+IDEyKSAmIDYzKSB8IDEyODtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoKGMgPj4gNikgJiA2MykgfCAxMjg7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgJiA2MykgfCAxMjg7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG91dDtcclxufTtcclxuLyoqXHJcbiAqIENhbGN1bGF0ZSBsZW5ndGggd2l0aG91dCBhY3R1YWxseSBjb252ZXJ0aW5nOyB1c2VmdWwgZm9yIGRvaW5nIGNoZWFwZXIgdmFsaWRhdGlvbi5cclxuICogQHBhcmFtIHtzdHJpbmd9IHN0clxyXG4gKiBAcmV0dXJuIHtudW1iZXJ9XHJcbiAqL1xyXG52YXIgc3RyaW5nTGVuZ3RoID0gZnVuY3Rpb24gKHN0cikge1xyXG4gICAgdmFyIHAgPSAwO1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICB2YXIgYyA9IHN0ci5jaGFyQ29kZUF0KGkpO1xyXG4gICAgICAgIGlmIChjIDwgMTI4KSB7XHJcbiAgICAgICAgICAgIHArKztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoYyA8IDIwNDgpIHtcclxuICAgICAgICAgICAgcCArPSAyO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjID49IDB4ZDgwMCAmJiBjIDw9IDB4ZGJmZikge1xyXG4gICAgICAgICAgICAvLyBMZWFkIHN1cnJvZ2F0ZSBvZiBhIHN1cnJvZ2F0ZSBwYWlyLiAgVGhlIHBhaXIgdG9nZXRoZXIgd2lsbCB0YWtlIDQgYnl0ZXMgdG8gcmVwcmVzZW50LlxyXG4gICAgICAgICAgICBwICs9IDQ7XHJcbiAgICAgICAgICAgIGkrKzsgLy8gc2tpcCB0cmFpbCBzdXJyb2dhdGUuXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBwICs9IDM7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHA7XHJcbn07XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBUaGUgYW1vdW50IG9mIG1pbGxpc2Vjb25kcyB0byBleHBvbmVudGlhbGx5IGluY3JlYXNlLlxyXG4gKi9cclxudmFyIERFRkFVTFRfSU5URVJWQUxfTUlMTElTID0gMTAwMDtcclxuLyoqXHJcbiAqIFRoZSBmYWN0b3IgdG8gYmFja29mZiBieS5cclxuICogU2hvdWxkIGJlIGEgbnVtYmVyIGdyZWF0ZXIgdGhhbiAxLlxyXG4gKi9cclxudmFyIERFRkFVTFRfQkFDS09GRl9GQUNUT1IgPSAyO1xyXG4vKipcclxuICogVGhlIG1heGltdW0gbWlsbGlzZWNvbmRzIHRvIGluY3JlYXNlIHRvLlxyXG4gKlxyXG4gKiA8cD5WaXNpYmxlIGZvciB0ZXN0aW5nXHJcbiAqL1xyXG52YXIgTUFYX1ZBTFVFX01JTExJUyA9IDQgKiA2MCAqIDYwICogMTAwMDsgLy8gRm91ciBob3VycywgbGlrZSBpT1MgYW5kIEFuZHJvaWQuXHJcbi8qKlxyXG4gKiBUaGUgcGVyY2VudGFnZSBvZiBiYWNrb2ZmIHRpbWUgdG8gcmFuZG9taXplIGJ5LlxyXG4gKiBTZWVcclxuICogaHR0cDovL2dvL3NhZmUtY2xpZW50LWJlaGF2aW9yI3N0ZXAtMS1kZXRlcm1pbmUtdGhlLWFwcHJvcHJpYXRlLXJldHJ5LWludGVydmFsLXRvLWhhbmRsZS1zcGlrZS10cmFmZmljXHJcbiAqIGZvciBjb250ZXh0LlxyXG4gKlxyXG4gKiA8cD5WaXNpYmxlIGZvciB0ZXN0aW5nXHJcbiAqL1xyXG52YXIgUkFORE9NX0ZBQ1RPUiA9IDAuNTtcclxuLyoqXHJcbiAqIEJhc2VkIG9uIHRoZSBiYWNrb2ZmIG1ldGhvZCBmcm9tXHJcbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9nb29nbGUvY2xvc3VyZS1saWJyYXJ5L2Jsb2IvbWFzdGVyL2Nsb3N1cmUvZ29vZy9tYXRoL2V4cG9uZW50aWFsYmFja29mZi5qcy5cclxuICogRXh0cmFjdGVkIGhlcmUgc28gd2UgZG9uJ3QgbmVlZCB0byBwYXNzIG1ldGFkYXRhIGFuZCBhIHN0YXRlZnVsIEV4cG9uZW50aWFsQmFja29mZiBvYmplY3QgYXJvdW5kLlxyXG4gKi9cclxuZnVuY3Rpb24gY2FsY3VsYXRlQmFja29mZk1pbGxpcyhiYWNrb2ZmQ291bnQsIGludGVydmFsTWlsbGlzLCBiYWNrb2ZmRmFjdG9yKSB7XHJcbiAgICBpZiAoaW50ZXJ2YWxNaWxsaXMgPT09IHZvaWQgMCkgeyBpbnRlcnZhbE1pbGxpcyA9IERFRkFVTFRfSU5URVJWQUxfTUlMTElTOyB9XHJcbiAgICBpZiAoYmFja29mZkZhY3RvciA9PT0gdm9pZCAwKSB7IGJhY2tvZmZGYWN0b3IgPSBERUZBVUxUX0JBQ0tPRkZfRkFDVE9SOyB9XHJcbiAgICAvLyBDYWxjdWxhdGVzIGFuIGV4cG9uZW50aWFsbHkgaW5jcmVhc2luZyB2YWx1ZS5cclxuICAgIC8vIERldmlhdGlvbjogY2FsY3VsYXRlcyB2YWx1ZSBmcm9tIGNvdW50IGFuZCBhIGNvbnN0YW50IGludGVydmFsLCBzbyB3ZSBvbmx5IG5lZWQgdG8gc2F2ZSB2YWx1ZVxyXG4gICAgLy8gYW5kIGNvdW50IHRvIHJlc3RvcmUgc3RhdGUuXHJcbiAgICB2YXIgY3VyckJhc2VWYWx1ZSA9IGludGVydmFsTWlsbGlzICogTWF0aC5wb3coYmFja29mZkZhY3RvciwgYmFja29mZkNvdW50KTtcclxuICAgIC8vIEEgcmFuZG9tIFwiZnV6elwiIHRvIGF2b2lkIHdhdmVzIG9mIHJldHJpZXMuXHJcbiAgICAvLyBEZXZpYXRpb246IHJhbmRvbUZhY3RvciBpcyByZXF1aXJlZC5cclxuICAgIHZhciByYW5kb21XYWl0ID0gTWF0aC5yb3VuZChcclxuICAgIC8vIEEgZnJhY3Rpb24gb2YgdGhlIGJhY2tvZmYgdmFsdWUgdG8gYWRkL3N1YnRyYWN0LlxyXG4gICAgLy8gRGV2aWF0aW9uOiBjaGFuZ2VzIG11bHRpcGxpY2F0aW9uIG9yZGVyIHRvIGltcHJvdmUgcmVhZGFiaWxpdHkuXHJcbiAgICBSQU5ET01fRkFDVE9SICpcclxuICAgICAgICBjdXJyQmFzZVZhbHVlICpcclxuICAgICAgICAvLyBBIHJhbmRvbSBmbG9hdCAocm91bmRlZCB0byBpbnQgYnkgTWF0aC5yb3VuZCBhYm92ZSkgaW4gdGhlIHJhbmdlIFstMSwgMV0uIERldGVybWluZXNcclxuICAgICAgICAvLyBpZiB3ZSBhZGQgb3Igc3VidHJhY3QuXHJcbiAgICAgICAgKE1hdGgucmFuZG9tKCkgLSAwLjUpICpcclxuICAgICAgICAyKTtcclxuICAgIC8vIExpbWl0cyBiYWNrb2ZmIHRvIG1heCB0byBhdm9pZCBlZmZlY3RpdmVseSBwZXJtYW5lbnQgYmFja29mZi5cclxuICAgIHJldHVybiBNYXRoLm1pbihNQVhfVkFMVUVfTUlMTElTLCBjdXJyQmFzZVZhbHVlICsgcmFuZG9tV2FpdCk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFByb3ZpZGUgRW5nbGlzaCBvcmRpbmFsIGxldHRlcnMgYWZ0ZXIgYSBudW1iZXJcclxuICovXHJcbmZ1bmN0aW9uIG9yZGluYWwoaSkge1xyXG4gICAgaWYgKCFOdW1iZXIuaXNGaW5pdGUoaSkpIHtcclxuICAgICAgICByZXR1cm4gXCJcIiArIGk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gaSArIGluZGljYXRvcihpKTtcclxufVxyXG5mdW5jdGlvbiBpbmRpY2F0b3IoaSkge1xyXG4gICAgaSA9IE1hdGguYWJzKGkpO1xyXG4gICAgdmFyIGNlbnQgPSBpICUgMTAwO1xyXG4gICAgaWYgKGNlbnQgPj0gMTAgJiYgY2VudCA8PSAyMCkge1xyXG4gICAgICAgIHJldHVybiAndGgnO1xyXG4gICAgfVxyXG4gICAgdmFyIGRlYyA9IGkgJSAxMDtcclxuICAgIGlmIChkZWMgPT09IDEpIHtcclxuICAgICAgICByZXR1cm4gJ3N0JztcclxuICAgIH1cclxuICAgIGlmIChkZWMgPT09IDIpIHtcclxuICAgICAgICByZXR1cm4gJ25kJztcclxuICAgIH1cclxuICAgIGlmIChkZWMgPT09IDMpIHtcclxuICAgICAgICByZXR1cm4gJ3JkJztcclxuICAgIH1cclxuICAgIHJldHVybiAndGgnO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmZ1bmN0aW9uIGdldE1vZHVsYXJJbnN0YW5jZShzZXJ2aWNlKSB7XHJcbiAgICBpZiAoc2VydmljZSAmJiBzZXJ2aWNlLl9kZWxlZ2F0ZSkge1xyXG4gICAgICAgIHJldHVybiBzZXJ2aWNlLl9kZWxlZ2F0ZTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xyXG4gICAgfVxyXG59XG5cbmV4cG9ydCB7IENPTlNUQU5UUywgRGVmZXJyZWQsIEVycm9yRmFjdG9yeSwgRmlyZWJhc2VFcnJvciwgTUFYX1ZBTFVFX01JTExJUywgUkFORE9NX0ZBQ1RPUiwgU2hhMSwgYXJlQ29va2llc0VuYWJsZWQsIGFzc2VydCwgYXNzZXJ0aW9uRXJyb3IsIGFzeW5jLCBiYXNlNjQsIGJhc2U2NERlY29kZSwgYmFzZTY0RW5jb2RlLCBiYXNlNjR1cmxFbmNvZGVXaXRob3V0UGFkZGluZywgY2FsY3VsYXRlQmFja29mZk1pbGxpcywgY29udGFpbnMsIGNyZWF0ZU1vY2tVc2VyVG9rZW4sIGNyZWF0ZVN1YnNjcmliZSwgZGVjb2RlLCBkZWVwQ29weSwgZGVlcEVxdWFsLCBkZWVwRXh0ZW5kLCBlcnJvclByZWZpeCwgZXh0cmFjdFF1ZXJ5c3RyaW5nLCBnZXRHbG9iYWwsIGdldE1vZHVsYXJJbnN0YW5jZSwgZ2V0VUEsIGlzQWRtaW4sIGlzQnJvd3NlciwgaXNCcm93c2VyRXh0ZW5zaW9uLCBpc0VsZWN0cm9uLCBpc0VtcHR5LCBpc0lFLCBpc0luZGV4ZWREQkF2YWlsYWJsZSwgaXNNb2JpbGVDb3Jkb3ZhLCBpc05vZGUsIGlzTm9kZVNkaywgaXNSZWFjdE5hdGl2ZSwgaXNTYWZhcmksIGlzVVdQLCBpc1ZhbGlkRm9ybWF0LCBpc1ZhbGlkVGltZXN0YW1wLCBpc3N1ZWRBdFRpbWUsIGpzb25FdmFsLCBtYXAsIG9yZGluYWwsIHF1ZXJ5c3RyaW5nLCBxdWVyeXN0cmluZ0RlY29kZSwgc2FmZUdldCwgc3RyaW5nTGVuZ3RoLCBzdHJpbmdUb0J5dGVBcnJheSwgc3RyaW5naWZ5LCB2YWxpZGF0ZUFyZ0NvdW50LCB2YWxpZGF0ZUNhbGxiYWNrLCB2YWxpZGF0ZUNvbnRleHRPYmplY3QsIHZhbGlkYXRlSW5kZXhlZERCT3BlbmFibGUsIHZhbGlkYXRlTmFtZXNwYWNlIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5lc20uanMubWFwXG4iLCIvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG5Db3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi5cblxuUGVybWlzc2lvbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgYW5kL29yIGRpc3RyaWJ1dGUgdGhpcyBzb2Z0d2FyZSBmb3IgYW55XG5wdXJwb3NlIHdpdGggb3Igd2l0aG91dCBmZWUgaXMgaGVyZWJ5IGdyYW50ZWQuXG5cblRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIgQU5EIFRIRSBBVVRIT1IgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEhcblJFR0FSRCBUTyBUSElTIFNPRlRXQVJFIElOQ0xVRElORyBBTEwgSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWVxuQU5EIEZJVE5FU1MuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1IgQkUgTElBQkxFIEZPUiBBTlkgU1BFQ0lBTCwgRElSRUNULFxuSU5ESVJFQ1QsIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUyBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NXG5MT1NTIE9GIFVTRSwgREFUQSBPUiBQUk9GSVRTLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgTkVHTElHRU5DRSBPUlxuT1RIRVIgVE9SVElPVVMgQUNUSU9OLCBBUklTSU5HIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUlxuUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS5cbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovXG4vKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSwgU3VwcHJlc3NlZEVycm9yLCBTeW1ib2wsIEl0ZXJhdG9yICovXG5cbnZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24oZCwgYikge1xuICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBfX2V4dGVuZHMoZCwgYikge1xuICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xufVxuXG5leHBvcnQgdmFyIF9fYXNzaWduID0gZnVuY3Rpb24oKSB7XG4gIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiBfX2Fzc2lnbih0KSB7XG4gICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcbiAgICAgICAgICBzID0gYXJndW1lbnRzW2ldO1xuICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSkgdFtwXSA9IHNbcF07XG4gICAgICB9XG4gICAgICByZXR1cm4gdDtcbiAgfVxuICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVzdChzLCBlKSB7XG4gIHZhciB0ID0ge307XG4gIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSAmJiBlLmluZGV4T2YocCkgPCAwKVxuICAgICAgdFtwXSA9IHNbcF07XG4gIGlmIChzICE9IG51bGwgJiYgdHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMgPT09IFwiZnVuY3Rpb25cIilcbiAgICAgIGZvciAodmFyIGkgPSAwLCBwID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzKTsgaSA8IHAubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBpZiAoZS5pbmRleE9mKHBbaV0pIDwgMCAmJiBPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwocywgcFtpXSkpXG4gICAgICAgICAgICAgIHRbcFtpXV0gPSBzW3BbaV1dO1xuICAgICAgfVxuICByZXR1cm4gdDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcbiAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcbiAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcbiAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcbiAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fcGFyYW0ocGFyYW1JbmRleCwgZGVjb3JhdG9yKSB7XG4gIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXkpIHsgZGVjb3JhdG9yKHRhcmdldCwga2V5LCBwYXJhbUluZGV4KTsgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gX19lc0RlY29yYXRlKGN0b3IsIGRlc2NyaXB0b3JJbiwgZGVjb3JhdG9ycywgY29udGV4dEluLCBpbml0aWFsaXplcnMsIGV4dHJhSW5pdGlhbGl6ZXJzKSB7XG4gIGZ1bmN0aW9uIGFjY2VwdChmKSB7IGlmIChmICE9PSB2b2lkIDAgJiYgdHlwZW9mIGYgIT09IFwiZnVuY3Rpb25cIikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkZ1bmN0aW9uIGV4cGVjdGVkXCIpOyByZXR1cm4gZjsgfVxuICB2YXIga2luZCA9IGNvbnRleHRJbi5raW5kLCBrZXkgPSBraW5kID09PSBcImdldHRlclwiID8gXCJnZXRcIiA6IGtpbmQgPT09IFwic2V0dGVyXCIgPyBcInNldFwiIDogXCJ2YWx1ZVwiO1xuICB2YXIgdGFyZ2V0ID0gIWRlc2NyaXB0b3JJbiAmJiBjdG9yID8gY29udGV4dEluW1wic3RhdGljXCJdID8gY3RvciA6IGN0b3IucHJvdG90eXBlIDogbnVsbDtcbiAgdmFyIGRlc2NyaXB0b3IgPSBkZXNjcmlwdG9ySW4gfHwgKHRhcmdldCA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBjb250ZXh0SW4ubmFtZSkgOiB7fSk7XG4gIHZhciBfLCBkb25lID0gZmFsc2U7XG4gIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICB2YXIgY29udGV4dCA9IHt9O1xuICAgICAgZm9yICh2YXIgcCBpbiBjb250ZXh0SW4pIGNvbnRleHRbcF0gPSBwID09PSBcImFjY2Vzc1wiID8ge30gOiBjb250ZXh0SW5bcF07XG4gICAgICBmb3IgKHZhciBwIGluIGNvbnRleHRJbi5hY2Nlc3MpIGNvbnRleHQuYWNjZXNzW3BdID0gY29udGV4dEluLmFjY2Vzc1twXTtcbiAgICAgIGNvbnRleHQuYWRkSW5pdGlhbGl6ZXIgPSBmdW5jdGlvbiAoZikgeyBpZiAoZG9uZSkgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBhZGQgaW5pdGlhbGl6ZXJzIGFmdGVyIGRlY29yYXRpb24gaGFzIGNvbXBsZXRlZFwiKTsgZXh0cmFJbml0aWFsaXplcnMucHVzaChhY2NlcHQoZiB8fCBudWxsKSk7IH07XG4gICAgICB2YXIgcmVzdWx0ID0gKDAsIGRlY29yYXRvcnNbaV0pKGtpbmQgPT09IFwiYWNjZXNzb3JcIiA/IHsgZ2V0OiBkZXNjcmlwdG9yLmdldCwgc2V0OiBkZXNjcmlwdG9yLnNldCB9IDogZGVzY3JpcHRvcltrZXldLCBjb250ZXh0KTtcbiAgICAgIGlmIChraW5kID09PSBcImFjY2Vzc29yXCIpIHtcbiAgICAgICAgICBpZiAocmVzdWx0ID09PSB2b2lkIDApIGNvbnRpbnVlO1xuICAgICAgICAgIGlmIChyZXN1bHQgPT09IG51bGwgfHwgdHlwZW9mIHJlc3VsdCAhPT0gXCJvYmplY3RcIikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIk9iamVjdCBleHBlY3RlZFwiKTtcbiAgICAgICAgICBpZiAoXyA9IGFjY2VwdChyZXN1bHQuZ2V0KSkgZGVzY3JpcHRvci5nZXQgPSBfO1xuICAgICAgICAgIGlmIChfID0gYWNjZXB0KHJlc3VsdC5zZXQpKSBkZXNjcmlwdG9yLnNldCA9IF87XG4gICAgICAgICAgaWYgKF8gPSBhY2NlcHQocmVzdWx0LmluaXQpKSBpbml0aWFsaXplcnMudW5zaGlmdChfKTtcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKF8gPSBhY2NlcHQocmVzdWx0KSkge1xuICAgICAgICAgIGlmIChraW5kID09PSBcImZpZWxkXCIpIGluaXRpYWxpemVycy51bnNoaWZ0KF8pO1xuICAgICAgICAgIGVsc2UgZGVzY3JpcHRvcltrZXldID0gXztcbiAgICAgIH1cbiAgfVxuICBpZiAodGFyZ2V0KSBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBjb250ZXh0SW4ubmFtZSwgZGVzY3JpcHRvcik7XG4gIGRvbmUgPSB0cnVlO1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIF9fcnVuSW5pdGlhbGl6ZXJzKHRoaXNBcmcsIGluaXRpYWxpemVycywgdmFsdWUpIHtcbiAgdmFyIHVzZVZhbHVlID0gYXJndW1lbnRzLmxlbmd0aCA+IDI7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgaW5pdGlhbGl6ZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YWx1ZSA9IHVzZVZhbHVlID8gaW5pdGlhbGl6ZXJzW2ldLmNhbGwodGhpc0FyZywgdmFsdWUpIDogaW5pdGlhbGl6ZXJzW2ldLmNhbGwodGhpc0FyZyk7XG4gIH1cbiAgcmV0dXJuIHVzZVZhbHVlID8gdmFsdWUgOiB2b2lkIDA7XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gX19wcm9wS2V5KHgpIHtcbiAgcmV0dXJuIHR5cGVvZiB4ID09PSBcInN5bWJvbFwiID8geCA6IFwiXCIuY29uY2F0KHgpO1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIF9fc2V0RnVuY3Rpb25OYW1lKGYsIG5hbWUsIHByZWZpeCkge1xuICBpZiAodHlwZW9mIG5hbWUgPT09IFwic3ltYm9sXCIpIG5hbWUgPSBuYW1lLmRlc2NyaXB0aW9uID8gXCJbXCIuY29uY2F0KG5hbWUuZGVzY3JpcHRpb24sIFwiXVwiKSA6IFwiXCI7XG4gIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkoZiwgXCJuYW1lXCIsIHsgY29uZmlndXJhYmxlOiB0cnVlLCB2YWx1ZTogcHJlZml4ID8gXCJcIi5jb25jYXQocHJlZml4LCBcIiBcIiwgbmFtZSkgOiBuYW1lIH0pO1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIF9fbWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpIHtcbiAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0Lm1ldGFkYXRhID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiBSZWZsZWN0Lm1ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXRlcih0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fZ2VuZXJhdG9yKHRoaXNBcmcsIGJvZHkpIHtcbiAgdmFyIF8gPSB7IGxhYmVsOiAwLCBzZW50OiBmdW5jdGlvbigpIHsgaWYgKHRbMF0gJiAxKSB0aHJvdyB0WzFdOyByZXR1cm4gdFsxXTsgfSwgdHJ5czogW10sIG9wczogW10gfSwgZiwgeSwgdCwgZyA9IE9iamVjdC5jcmVhdGUoKHR5cGVvZiBJdGVyYXRvciA9PT0gXCJmdW5jdGlvblwiID8gSXRlcmF0b3IgOiBPYmplY3QpLnByb3RvdHlwZSk7XG4gIHJldHVybiBnLm5leHQgPSB2ZXJiKDApLCBnW1widGhyb3dcIl0gPSB2ZXJiKDEpLCBnW1wicmV0dXJuXCJdID0gdmVyYigyKSwgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnO1xuICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cbiAgZnVuY3Rpb24gc3RlcChvcCkge1xuICAgICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO1xuICAgICAgd2hpbGUgKGcgJiYgKGcgPSAwLCBvcFswXSAmJiAoXyA9IDApKSwgXykgdHJ5IHtcbiAgICAgICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSBvcFswXSAmIDIgPyB5W1wicmV0dXJuXCJdIDogb3BbMF0gPyB5W1widGhyb3dcIl0gfHwgKCh0ID0geVtcInJldHVyblwiXSkgJiYgdC5jYWxsKHkpLCAwKSA6IHkubmV4dCkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgcmV0dXJuIHQ7XG4gICAgICAgICAgaWYgKHkgPSAwLCB0KSBvcCA9IFtvcFswXSAmIDIsIHQudmFsdWVdO1xuICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcbiAgICAgICAgICAgICAgY2FzZSAwOiBjYXNlIDE6IHQgPSBvcDsgYnJlYWs7XG4gICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XG4gICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcbiAgICAgICAgICAgICAgY2FzZSA3OiBvcCA9IF8ub3BzLnBvcCgpOyBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xuICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XG4gICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDMgJiYgKCF0IHx8IChvcFsxXSA+IHRbMF0gJiYgb3BbMV0gPCB0WzNdKSkpIHsgXy5sYWJlbCA9IG9wWzFdOyBicmVhazsgfVxuICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XG4gICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XG4gICAgICAgICAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7XG4gICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cbiAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xuICB9XG59XG5cbmV4cG9ydCB2YXIgX19jcmVhdGVCaW5kaW5nID0gT2JqZWN0LmNyZWF0ZSA/IChmdW5jdGlvbihvLCBtLCBrLCBrMikge1xuICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IobSwgayk7XG4gIGlmICghZGVzYyB8fCAoXCJnZXRcIiBpbiBkZXNjID8gIW0uX19lc01vZHVsZSA6IGRlc2Mud3JpdGFibGUgfHwgZGVzYy5jb25maWd1cmFibGUpKSB7XG4gICAgICBkZXNjID0geyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gbVtrXTsgfSB9O1xuICB9XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBrMiwgZGVzYyk7XG59KSA6IChmdW5jdGlvbihvLCBtLCBrLCBrMikge1xuICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICBvW2syXSA9IG1ba107XG59KTtcblxuZXhwb3J0IGZ1bmN0aW9uIF9fZXhwb3J0U3RhcihtLCBvKSB7XG4gIGZvciAodmFyIHAgaW4gbSkgaWYgKHAgIT09IFwiZGVmYXVsdFwiICYmICFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobywgcCkpIF9fY3JlYXRlQmluZGluZyhvLCBtLCBwKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fdmFsdWVzKG8pIHtcbiAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDtcbiAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7XG4gIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gXCJudW1iZXJcIikgcmV0dXJuIHtcbiAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwO1xuICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTtcbiAgICAgIH1cbiAgfTtcbiAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gXCJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLlwiIDogXCJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX19yZWFkKG8sIG4pIHtcbiAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdO1xuICBpZiAoIW0pIHJldHVybiBvO1xuICB2YXIgaSA9IG0uY2FsbChvKSwgciwgYXIgPSBbXSwgZTtcbiAgdHJ5IHtcbiAgICAgIHdoaWxlICgobiA9PT0gdm9pZCAwIHx8IG4tLSA+IDApICYmICEociA9IGkubmV4dCgpKS5kb25lKSBhci5wdXNoKHIudmFsdWUpO1xuICB9XG4gIGNhdGNoIChlcnJvcikgeyBlID0geyBlcnJvcjogZXJyb3IgfTsgfVxuICBmaW5hbGx5IHtcbiAgICAgIHRyeSB7XG4gICAgICAgICAgaWYgKHIgJiYgIXIuZG9uZSAmJiAobSA9IGlbXCJyZXR1cm5cIl0pKSBtLmNhbGwoaSk7XG4gICAgICB9XG4gICAgICBmaW5hbGx5IHsgaWYgKGUpIHRocm93IGUuZXJyb3I7IH1cbiAgfVxuICByZXR1cm4gYXI7XG59XG5cbi8qKiBAZGVwcmVjYXRlZCAqL1xuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkKCkge1xuICBmb3IgKHZhciBhciA9IFtdLCBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKylcbiAgICAgIGFyID0gYXIuY29uY2F0KF9fcmVhZChhcmd1bWVudHNbaV0pKTtcbiAgcmV0dXJuIGFyO1xufVxuXG4vKiogQGRlcHJlY2F0ZWQgKi9cbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZEFycmF5cygpIHtcbiAgZm9yICh2YXIgcyA9IDAsIGkgPSAwLCBpbCA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBpbDsgaSsrKSBzICs9IGFyZ3VtZW50c1tpXS5sZW5ndGg7XG4gIGZvciAodmFyIHIgPSBBcnJheShzKSwgayA9IDAsIGkgPSAwOyBpIDwgaWw7IGkrKylcbiAgICAgIGZvciAodmFyIGEgPSBhcmd1bWVudHNbaV0sIGogPSAwLCBqbCA9IGEubGVuZ3RoOyBqIDwgamw7IGorKywgaysrKVxuICAgICAgICAgIHJba10gPSBhW2pdO1xuICByZXR1cm4gcjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkQXJyYXkodG8sIGZyb20sIHBhY2spIHtcbiAgaWYgKHBhY2sgfHwgYXJndW1lbnRzLmxlbmd0aCA9PT0gMikgZm9yICh2YXIgaSA9IDAsIGwgPSBmcm9tLmxlbmd0aCwgYXI7IGkgPCBsOyBpKyspIHtcbiAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcbiAgICAgICAgICBpZiAoIWFyKSBhciA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20sIDAsIGkpO1xuICAgICAgICAgIGFyW2ldID0gZnJvbVtpXTtcbiAgICAgIH1cbiAgfVxuICByZXR1cm4gdG8uY29uY2F0KGFyIHx8IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20pKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXQodikge1xuICByZXR1cm4gdGhpcyBpbnN0YW5jZW9mIF9fYXdhaXQgPyAodGhpcy52ID0gdiwgdGhpcykgOiBuZXcgX19hd2FpdCh2KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNHZW5lcmF0b3IodGhpc0FyZywgX2FyZ3VtZW50cywgZ2VuZXJhdG9yKSB7XG4gIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XG4gIHZhciBnID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pLCBpLCBxID0gW107XG4gIHJldHVybiBpID0gT2JqZWN0LmNyZWF0ZSgodHlwZW9mIEFzeW5jSXRlcmF0b3IgPT09IFwiZnVuY3Rpb25cIiA/IEFzeW5jSXRlcmF0b3IgOiBPYmplY3QpLnByb3RvdHlwZSksIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiwgYXdhaXRSZXR1cm4pLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XG4gIGZ1bmN0aW9uIGF3YWl0UmV0dXJuKGYpIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBQcm9taXNlLnJlc29sdmUodikudGhlbihmLCByZWplY3QpOyB9OyB9XG4gIGZ1bmN0aW9uIHZlcmIobiwgZikgeyBpZiAoZ1tuXSkgeyBpW25dID0gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChhLCBiKSB7IHEucHVzaChbbiwgdiwgYSwgYl0pID4gMSB8fCByZXN1bWUobiwgdik7IH0pOyB9OyBpZiAoZikgaVtuXSA9IGYoaVtuXSk7IH0gfVxuICBmdW5jdGlvbiByZXN1bWUobiwgdikgeyB0cnkgeyBzdGVwKGdbbl0odikpOyB9IGNhdGNoIChlKSB7IHNldHRsZShxWzBdWzNdLCBlKTsgfSB9XG4gIGZ1bmN0aW9uIHN0ZXAocikgeyByLnZhbHVlIGluc3RhbmNlb2YgX19hd2FpdCA/IFByb21pc2UucmVzb2x2ZShyLnZhbHVlLnYpLnRoZW4oZnVsZmlsbCwgcmVqZWN0KSA6IHNldHRsZShxWzBdWzJdLCByKTsgfVxuICBmdW5jdGlvbiBmdWxmaWxsKHZhbHVlKSB7IHJlc3VtZShcIm5leHRcIiwgdmFsdWUpOyB9XG4gIGZ1bmN0aW9uIHJlamVjdCh2YWx1ZSkgeyByZXN1bWUoXCJ0aHJvd1wiLCB2YWx1ZSk7IH1cbiAgZnVuY3Rpb24gc2V0dGxlKGYsIHYpIHsgaWYgKGYodiksIHEuc2hpZnQoKSwgcS5sZW5ndGgpIHJlc3VtZShxWzBdWzBdLCBxWzBdWzFdKTsgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0RlbGVnYXRvcihvKSB7XG4gIHZhciBpLCBwO1xuICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIsIGZ1bmN0aW9uIChlKSB7IHRocm93IGU7IH0pLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xuICBmdW5jdGlvbiB2ZXJiKG4sIGYpIHsgaVtuXSA9IG9bbl0gPyBmdW5jdGlvbiAodikgeyByZXR1cm4gKHAgPSAhcCkgPyB7IHZhbHVlOiBfX2F3YWl0KG9bbl0odikpLCBkb25lOiBmYWxzZSB9IDogZiA/IGYodikgOiB2OyB9IDogZjsgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY1ZhbHVlcyhvKSB7XG4gIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XG4gIHZhciBtID0gb1tTeW1ib2wuYXN5bmNJdGVyYXRvcl0sIGk7XG4gIHJldHVybiBtID8gbS5jYWxsKG8pIDogKG8gPSB0eXBlb2YgX192YWx1ZXMgPT09IFwiZnVuY3Rpb25cIiA/IF9fdmFsdWVzKG8pIDogb1tTeW1ib2wuaXRlcmF0b3JdKCksIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpKTtcbiAgZnVuY3Rpb24gdmVyYihuKSB7IGlbbl0gPSBvW25dICYmIGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHYgPSBvW25dKHYpLCBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCB2LmRvbmUsIHYudmFsdWUpOyB9KTsgfTsgfVxuICBmdW5jdGlvbiBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCBkLCB2KSB7IFByb21pc2UucmVzb2x2ZSh2KS50aGVuKGZ1bmN0aW9uKHYpIHsgcmVzb2x2ZSh7IHZhbHVlOiB2LCBkb25lOiBkIH0pOyB9LCByZWplY3QpOyB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfX21ha2VUZW1wbGF0ZU9iamVjdChjb29rZWQsIHJhdykge1xuICBpZiAoT2JqZWN0LmRlZmluZVByb3BlcnR5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjb29rZWQsIFwicmF3XCIsIHsgdmFsdWU6IHJhdyB9KTsgfSBlbHNlIHsgY29va2VkLnJhdyA9IHJhdzsgfVxuICByZXR1cm4gY29va2VkO1xufTtcblxudmFyIF9fc2V0TW9kdWxlRGVmYXVsdCA9IE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgdikge1xuICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgXCJkZWZhdWx0XCIsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHYgfSk7XG59KSA6IGZ1bmN0aW9uKG8sIHYpIHtcbiAgb1tcImRlZmF1bHRcIl0gPSB2O1xufTtcblxudmFyIG93bktleXMgPSBmdW5jdGlvbihvKSB7XG4gIG93bktleXMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyB8fCBmdW5jdGlvbiAobykge1xuICAgIHZhciBhciA9IFtdO1xuICAgIGZvciAodmFyIGsgaW4gbykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvLCBrKSkgYXJbYXIubGVuZ3RoXSA9IGs7XG4gICAgcmV0dXJuIGFyO1xuICB9O1xuICByZXR1cm4gb3duS2V5cyhvKTtcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydFN0YXIobW9kKSB7XG4gIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XG4gIHZhciByZXN1bHQgPSB7fTtcbiAgaWYgKG1vZCAhPSBudWxsKSBmb3IgKHZhciBrID0gb3duS2V5cyhtb2QpLCBpID0gMDsgaSA8IGsubGVuZ3RoOyBpKyspIGlmIChrW2ldICE9PSBcImRlZmF1bHRcIikgX19jcmVhdGVCaW5kaW5nKHJlc3VsdCwgbW9kLCBrW2ldKTtcbiAgX19zZXRNb2R1bGVEZWZhdWx0KHJlc3VsdCwgbW9kKTtcbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0RGVmYXVsdChtb2QpIHtcbiAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBkZWZhdWx0OiBtb2QgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fY2xhc3NQcml2YXRlRmllbGRHZXQocmVjZWl2ZXIsIHN0YXRlLCBraW5kLCBmKSB7XG4gIGlmIChraW5kID09PSBcImFcIiAmJiAhZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlByaXZhdGUgYWNjZXNzb3Igd2FzIGRlZmluZWQgd2l0aG91dCBhIGdldHRlclwiKTtcbiAgaWYgKHR5cGVvZiBzdGF0ZSA9PT0gXCJmdW5jdGlvblwiID8gcmVjZWl2ZXIgIT09IHN0YXRlIHx8ICFmIDogIXN0YXRlLmhhcyhyZWNlaXZlcikpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgcmVhZCBwcml2YXRlIG1lbWJlciBmcm9tIGFuIG9iamVjdCB3aG9zZSBjbGFzcyBkaWQgbm90IGRlY2xhcmUgaXRcIik7XG4gIHJldHVybiBraW5kID09PSBcIm1cIiA/IGYgOiBraW5kID09PSBcImFcIiA/IGYuY2FsbChyZWNlaXZlcikgOiBmID8gZi52YWx1ZSA6IHN0YXRlLmdldChyZWNlaXZlcik7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfX2NsYXNzUHJpdmF0ZUZpZWxkU2V0KHJlY2VpdmVyLCBzdGF0ZSwgdmFsdWUsIGtpbmQsIGYpIHtcbiAgaWYgKGtpbmQgPT09IFwibVwiKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiUHJpdmF0ZSBtZXRob2QgaXMgbm90IHdyaXRhYmxlXCIpO1xuICBpZiAoa2luZCA9PT0gXCJhXCIgJiYgIWYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJQcml2YXRlIGFjY2Vzc29yIHdhcyBkZWZpbmVkIHdpdGhvdXQgYSBzZXR0ZXJcIik7XG4gIGlmICh0eXBlb2Ygc3RhdGUgPT09IFwiZnVuY3Rpb25cIiA/IHJlY2VpdmVyICE9PSBzdGF0ZSB8fCAhZiA6ICFzdGF0ZS5oYXMocmVjZWl2ZXIpKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IHdyaXRlIHByaXZhdGUgbWVtYmVyIHRvIGFuIG9iamVjdCB3aG9zZSBjbGFzcyBkaWQgbm90IGRlY2xhcmUgaXRcIik7XG4gIHJldHVybiAoa2luZCA9PT0gXCJhXCIgPyBmLmNhbGwocmVjZWl2ZXIsIHZhbHVlKSA6IGYgPyBmLnZhbHVlID0gdmFsdWUgOiBzdGF0ZS5zZXQocmVjZWl2ZXIsIHZhbHVlKSksIHZhbHVlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX19jbGFzc1ByaXZhdGVGaWVsZEluKHN0YXRlLCByZWNlaXZlcikge1xuICBpZiAocmVjZWl2ZXIgPT09IG51bGwgfHwgKHR5cGVvZiByZWNlaXZlciAhPT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgcmVjZWl2ZXIgIT09IFwiZnVuY3Rpb25cIikpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgdXNlICdpbicgb3BlcmF0b3Igb24gbm9uLW9iamVjdFwiKTtcbiAgcmV0dXJuIHR5cGVvZiBzdGF0ZSA9PT0gXCJmdW5jdGlvblwiID8gcmVjZWl2ZXIgPT09IHN0YXRlIDogc3RhdGUuaGFzKHJlY2VpdmVyKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fYWRkRGlzcG9zYWJsZVJlc291cmNlKGVudiwgdmFsdWUsIGFzeW5jKSB7XG4gIGlmICh2YWx1ZSAhPT0gbnVsbCAmJiB2YWx1ZSAhPT0gdm9pZCAwKSB7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgdmFsdWUgIT09IFwiZnVuY3Rpb25cIikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIk9iamVjdCBleHBlY3RlZC5cIik7XG4gICAgdmFyIGRpc3Bvc2UsIGlubmVyO1xuICAgIGlmIChhc3luYykge1xuICAgICAgaWYgKCFTeW1ib2wuYXN5bmNEaXNwb3NlKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jRGlzcG9zZSBpcyBub3QgZGVmaW5lZC5cIik7XG4gICAgICBkaXNwb3NlID0gdmFsdWVbU3ltYm9sLmFzeW5jRGlzcG9zZV07XG4gICAgfVxuICAgIGlmIChkaXNwb3NlID09PSB2b2lkIDApIHtcbiAgICAgIGlmICghU3ltYm9sLmRpc3Bvc2UpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuZGlzcG9zZSBpcyBub3QgZGVmaW5lZC5cIik7XG4gICAgICBkaXNwb3NlID0gdmFsdWVbU3ltYm9sLmRpc3Bvc2VdO1xuICAgICAgaWYgKGFzeW5jKSBpbm5lciA9IGRpc3Bvc2U7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgZGlzcG9zZSAhPT0gXCJmdW5jdGlvblwiKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiT2JqZWN0IG5vdCBkaXNwb3NhYmxlLlwiKTtcbiAgICBpZiAoaW5uZXIpIGRpc3Bvc2UgPSBmdW5jdGlvbigpIHsgdHJ5IHsgaW5uZXIuY2FsbCh0aGlzKTsgfSBjYXRjaCAoZSkgeyByZXR1cm4gUHJvbWlzZS5yZWplY3QoZSk7IH0gfTtcbiAgICBlbnYuc3RhY2sucHVzaCh7IHZhbHVlOiB2YWx1ZSwgZGlzcG9zZTogZGlzcG9zZSwgYXN5bmM6IGFzeW5jIH0pO1xuICB9XG4gIGVsc2UgaWYgKGFzeW5jKSB7XG4gICAgZW52LnN0YWNrLnB1c2goeyBhc3luYzogdHJ1ZSB9KTtcbiAgfVxuICByZXR1cm4gdmFsdWU7XG59XG5cbnZhciBfU3VwcHJlc3NlZEVycm9yID0gdHlwZW9mIFN1cHByZXNzZWRFcnJvciA9PT0gXCJmdW5jdGlvblwiID8gU3VwcHJlc3NlZEVycm9yIDogZnVuY3Rpb24gKGVycm9yLCBzdXBwcmVzc2VkLCBtZXNzYWdlKSB7XG4gIHZhciBlID0gbmV3IEVycm9yKG1lc3NhZ2UpO1xuICByZXR1cm4gZS5uYW1lID0gXCJTdXBwcmVzc2VkRXJyb3JcIiwgZS5lcnJvciA9IGVycm9yLCBlLnN1cHByZXNzZWQgPSBzdXBwcmVzc2VkLCBlO1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIF9fZGlzcG9zZVJlc291cmNlcyhlbnYpIHtcbiAgZnVuY3Rpb24gZmFpbChlKSB7XG4gICAgZW52LmVycm9yID0gZW52Lmhhc0Vycm9yID8gbmV3IF9TdXBwcmVzc2VkRXJyb3IoZSwgZW52LmVycm9yLCBcIkFuIGVycm9yIHdhcyBzdXBwcmVzc2VkIGR1cmluZyBkaXNwb3NhbC5cIikgOiBlO1xuICAgIGVudi5oYXNFcnJvciA9IHRydWU7XG4gIH1cbiAgdmFyIHIsIHMgPSAwO1xuICBmdW5jdGlvbiBuZXh0KCkge1xuICAgIHdoaWxlIChyID0gZW52LnN0YWNrLnBvcCgpKSB7XG4gICAgICB0cnkge1xuICAgICAgICBpZiAoIXIuYXN5bmMgJiYgcyA9PT0gMSkgcmV0dXJuIHMgPSAwLCBlbnYuc3RhY2sucHVzaChyKSwgUHJvbWlzZS5yZXNvbHZlKCkudGhlbihuZXh0KTtcbiAgICAgICAgaWYgKHIuZGlzcG9zZSkge1xuICAgICAgICAgIHZhciByZXN1bHQgPSByLmRpc3Bvc2UuY2FsbChyLnZhbHVlKTtcbiAgICAgICAgICBpZiAoci5hc3luYykgcmV0dXJuIHMgfD0gMiwgUHJvbWlzZS5yZXNvbHZlKHJlc3VsdCkudGhlbihuZXh0LCBmdW5jdGlvbihlKSB7IGZhaWwoZSk7IHJldHVybiBuZXh0KCk7IH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgcyB8PSAxO1xuICAgICAgfVxuICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgZmFpbChlKTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHMgPT09IDEpIHJldHVybiBlbnYuaGFzRXJyb3IgPyBQcm9taXNlLnJlamVjdChlbnYuZXJyb3IpIDogUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgaWYgKGVudi5oYXNFcnJvcikgdGhyb3cgZW52LmVycm9yO1xuICB9XG4gIHJldHVybiBuZXh0KCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfX3Jld3JpdGVSZWxhdGl2ZUltcG9ydEV4dGVuc2lvbihwYXRoLCBwcmVzZXJ2ZUpzeCkge1xuICBpZiAodHlwZW9mIHBhdGggPT09IFwic3RyaW5nXCIgJiYgL15cXC5cXC4/XFwvLy50ZXN0KHBhdGgpKSB7XG4gICAgICByZXR1cm4gcGF0aC5yZXBsYWNlKC9cXC4odHN4KSR8KCg/OlxcLmQpPykoKD86XFwuW14uL10rPyk/KVxcLihbY21dPyl0cyQvaSwgZnVuY3Rpb24gKG0sIHRzeCwgZCwgZXh0LCBjbSkge1xuICAgICAgICAgIHJldHVybiB0c3ggPyBwcmVzZXJ2ZUpzeCA/IFwiLmpzeFwiIDogXCIuanNcIiA6IGQgJiYgKCFleHQgfHwgIWNtKSA/IG0gOiAoZCArIGV4dCArIFwiLlwiICsgY20udG9Mb3dlckNhc2UoKSArIFwianNcIik7XG4gICAgICB9KTtcbiAgfVxuICByZXR1cm4gcGF0aDtcbn1cblxuZXhwb3J0IGRlZmF1bHQge1xuICBfX2V4dGVuZHMsXG4gIF9fYXNzaWduLFxuICBfX3Jlc3QsXG4gIF9fZGVjb3JhdGUsXG4gIF9fcGFyYW0sXG4gIF9fZXNEZWNvcmF0ZSxcbiAgX19ydW5Jbml0aWFsaXplcnMsXG4gIF9fcHJvcEtleSxcbiAgX19zZXRGdW5jdGlvbk5hbWUsXG4gIF9fbWV0YWRhdGEsXG4gIF9fYXdhaXRlcixcbiAgX19nZW5lcmF0b3IsXG4gIF9fY3JlYXRlQmluZGluZyxcbiAgX19leHBvcnRTdGFyLFxuICBfX3ZhbHVlcyxcbiAgX19yZWFkLFxuICBfX3NwcmVhZCxcbiAgX19zcHJlYWRBcnJheXMsXG4gIF9fc3ByZWFkQXJyYXksXG4gIF9fYXdhaXQsXG4gIF9fYXN5bmNHZW5lcmF0b3IsXG4gIF9fYXN5bmNEZWxlZ2F0b3IsXG4gIF9fYXN5bmNWYWx1ZXMsXG4gIF9fbWFrZVRlbXBsYXRlT2JqZWN0LFxuICBfX2ltcG9ydFN0YXIsXG4gIF9faW1wb3J0RGVmYXVsdCxcbiAgX19jbGFzc1ByaXZhdGVGaWVsZEdldCxcbiAgX19jbGFzc1ByaXZhdGVGaWVsZFNldCxcbiAgX19jbGFzc1ByaXZhdGVGaWVsZEluLFxuICBfX2FkZERpc3Bvc2FibGVSZXNvdXJjZSxcbiAgX19kaXNwb3NlUmVzb3VyY2VzLFxuICBfX3Jld3JpdGVSZWxhdGl2ZUltcG9ydEV4dGVuc2lvbixcbn07XG4iLCJpbXBvcnQgeyBfZ2V0UHJvdmlkZXIgYXMgdCwgZ2V0QXBwIGFzIGUsIF9yZW1vdmVTZXJ2aWNlSW5zdGFuY2UgYXMgbiwgX3JlZ2lzdGVyQ29tcG9uZW50IGFzIHMsIHJlZ2lzdGVyVmVyc2lvbiBhcyBpLCBTREtfVkVSU0lPTiBhcyByIH0gZnJvbSBcIkBmaXJlYmFzZS9hcHBcIjtcblxuaW1wb3J0IHsgQ29tcG9uZW50IGFzIG8gfSBmcm9tIFwiQGZpcmViYXNlL2NvbXBvbmVudFwiO1xuXG5pbXBvcnQgeyBMb2dnZXIgYXMgYSwgTG9nTGV2ZWwgYXMgYyB9IGZyb20gXCJAZmlyZWJhc2UvbG9nZ2VyXCI7XG5cbmltcG9ydCB7IGdldFVBIGFzIHUsIGlzU2FmYXJpIGFzIGgsIGlzTW9iaWxlQ29yZG92YSBhcyBsLCBpc1JlYWN0TmF0aXZlIGFzIGYsIGlzRWxlY3Ryb24gYXMgZCwgaXNJRSBhcyB3LCBpc1VXUCBhcyBfLCBpc0Jyb3dzZXJFeHRlbnNpb24gYXMgbSwgY3JlYXRlTW9ja1VzZXJUb2tlbiBhcyBnLCBnZXRNb2R1bGFySW5zdGFuY2UgYXMgeSwgZGVlcEVxdWFsIGFzIHAgfSBmcm9tIFwiQGZpcmViYXNlL3V0aWxcIjtcblxuaW1wb3J0IHsgWGhySW8gYXMgRSwgRXZlbnRUeXBlIGFzIFQsIEVycm9yQ29kZSBhcyBJLCBjcmVhdGVXZWJDaGFubmVsVHJhbnNwb3J0IGFzIEEsIGdldFN0YXRFdmVudFRhcmdldCBhcyBSLCBGZXRjaFhtbEh0dHBGYWN0b3J5IGFzIFAsIFdlYkNoYW5uZWwgYXMgYiwgRXZlbnQgYXMgdiwgU3RhdCBhcyBWIH0gZnJvbSBcIkBmaXJlYmFzZS93ZWJjaGFubmVsLXdyYXBwZXJcIjtcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogU2ltcGxlIHdyYXBwZXIgYXJvdW5kIGEgbnVsbGFibGUgVUlELiBNb3N0bHkgZXhpc3RzIHRvIG1ha2UgY29kZSBtb3JlXG4gKiByZWFkYWJsZS5cbiAqL1xuY2xhc3MgUyB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLnVpZCA9IHQ7XG4gICAgfVxuICAgIGlzQXV0aGVudGljYXRlZCgpIHtcbiAgICAgICAgcmV0dXJuIG51bGwgIT0gdGhpcy51aWQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBrZXkgcmVwcmVzZW50aW5nIHRoaXMgdXNlciwgc3VpdGFibGUgZm9yIGluY2x1c2lvbiBpbiBhXG4gICAgICogZGljdGlvbmFyeS5cbiAgICAgKi8gICAgdG9LZXkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmlzQXV0aGVudGljYXRlZCgpID8gXCJ1aWQ6XCIgKyB0aGlzLnVpZCA6IFwiYW5vbnltb3VzLXVzZXJcIjtcbiAgICB9XG4gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIHJldHVybiB0LnVpZCA9PT0gdGhpcy51aWQ7XG4gICAgfVxufVxuXG4vKiogQSB1c2VyIHdpdGggYSBudWxsIFVJRC4gKi8gUy5VTkFVVEhFTlRJQ0FURUQgPSBuZXcgUyhudWxsKSwgXG4vLyBUT0RPKG1pa2VsZWhlbik6IExvb2sgaW50byBnZXR0aW5nIGEgcHJvcGVyIHVpZC1lcXVpdmFsZW50IGZvclxuLy8gbm9uLUZpcmViYXNlQXV0aCBwcm92aWRlcnMuXG5TLkdPT0dMRV9DUkVERU5USUFMUyA9IG5ldyBTKFwiZ29vZ2xlLWNyZWRlbnRpYWxzLXVpZFwiKSwgUy5GSVJTVF9QQVJUWSA9IG5ldyBTKFwiZmlyc3QtcGFydHktdWlkXCIpLCBcblMuTU9DS19VU0VSID0gbmV3IFMoXCJtb2NrLXVzZXJcIik7XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5sZXQgRCA9IFwiOS4wLjFcIjtcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmNvbnN0IEMgPSBuZXcgYShcIkBmaXJlYmFzZS9maXJlc3RvcmVcIik7XG5cbi8vIEhlbHBlciBtZXRob2RzIGFyZSBuZWVkZWQgYmVjYXVzZSB2YXJpYWJsZXMgY2FuJ3QgYmUgZXhwb3J0ZWQgYXMgcmVhZC93cml0ZVxuZnVuY3Rpb24gTigpIHtcbiAgICByZXR1cm4gQy5sb2dMZXZlbDtcbn1cblxuLyoqXG4gKiBTZXRzIHRoZSB2ZXJib3NpdHkgb2YgQ2xvdWQgRmlyZXN0b3JlIGxvZ3MgKGRlYnVnLCBlcnJvciwgb3Igc2lsZW50KS5cbiAqXG4gKiBAcGFyYW0gbG9nTGV2ZWwgLSBUaGUgdmVyYm9zaXR5IHlvdSBzZXQgZm9yIGFjdGl2aXR5IGFuZCBlcnJvciBsb2dnaW5nLiBDYW5cbiAqICAgYmUgYW55IG9mIHRoZSBmb2xsb3dpbmcgdmFsdWVzOlxuICpcbiAqICAgPHVsPlxuICogICAgIDxsaT5gZGVidWdgIGZvciB0aGUgbW9zdCB2ZXJib3NlIGxvZ2dpbmcgbGV2ZWwsIHByaW1hcmlseSBmb3JcbiAqICAgICBkZWJ1Z2dpbmcuPC9saT5cbiAqICAgICA8bGk+YGVycm9yYCB0byBsb2cgZXJyb3JzIG9ubHkuPC9saT5cbiAqICAgICA8bGk+PGNvZGU+YHNpbGVudGAgdG8gdHVybiBvZmYgbG9nZ2luZy48L2xpPlxuICogICA8L3VsPlxuICovIGZ1bmN0aW9uIHgodCkge1xuICAgIEMuc2V0TG9nTGV2ZWwodCk7XG59XG5cbmZ1bmN0aW9uIGsodCwgLi4uZSkge1xuICAgIGlmIChDLmxvZ0xldmVsIDw9IGMuREVCVUcpIHtcbiAgICAgICAgY29uc3QgbiA9IGUubWFwKEYpO1xuICAgICAgICBDLmRlYnVnKGBGaXJlc3RvcmUgKCR7RH0pOiAke3R9YCwgLi4ubik7XG4gICAgfVxufVxuXG5mdW5jdGlvbiAkKHQsIC4uLmUpIHtcbiAgICBpZiAoQy5sb2dMZXZlbCA8PSBjLkVSUk9SKSB7XG4gICAgICAgIGNvbnN0IG4gPSBlLm1hcChGKTtcbiAgICAgICAgQy5lcnJvcihgRmlyZXN0b3JlICgke0R9KTogJHt0fWAsIC4uLm4pO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAaW50ZXJuYWxcbiAqLyBmdW5jdGlvbiBPKHQsIC4uLmUpIHtcbiAgICBpZiAoQy5sb2dMZXZlbCA8PSBjLldBUk4pIHtcbiAgICAgICAgY29uc3QgbiA9IGUubWFwKEYpO1xuICAgICAgICBDLndhcm4oYEZpcmVzdG9yZSAoJHtEfSk6ICR7dH1gLCAuLi5uKTtcbiAgICB9XG59XG5cbi8qKlxuICogQ29udmVydHMgYW4gYWRkaXRpb25hbCBsb2cgcGFyYW1ldGVyIHRvIGEgc3RyaW5nIHJlcHJlc2VudGF0aW9uLlxuICovIGZ1bmN0aW9uIEYodCkge1xuICAgIGlmIChcInN0cmluZ1wiID09IHR5cGVvZiB0KSByZXR1cm4gdDtcbiAgICB0cnkge1xuICAgICAgICByZXR1cm4gZSA9IHQsIEpTT04uc3RyaW5naWZ5KGUpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgLy8gQ29udmVydGluZyB0byBKU09OIGZhaWxlZCwganVzdCBsb2cgdGhlIG9iamVjdCBkaXJlY3RseVxuICAgICAgICByZXR1cm4gdDtcbiAgICB9XG4gICAgLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbiAgICAvKiogRm9ybWF0cyBhbiBvYmplY3QgYXMgYSBKU09OIHN0cmluZywgc3VpdGFibGUgZm9yIGxvZ2dpbmcuICovXG4gICAgdmFyIGU7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFVuY29uZGl0aW9uYWxseSBmYWlscywgdGhyb3dpbmcgYW4gRXJyb3Igd2l0aCB0aGUgZ2l2ZW4gbWVzc2FnZS5cbiAqIE1lc3NhZ2VzIGFyZSBzdHJpcHBlZCBpbiBwcm9kdWN0aW9uIGJ1aWxkcy5cbiAqXG4gKiBSZXR1cm5zIGBuZXZlcmAgYW5kIGNhbiBiZSB1c2VkIGluIGV4cHJlc3Npb25zOlxuICogQGV4YW1wbGVcbiAqIGxldCBmdXR1cmVWYXIgPSBmYWlsKCdub3QgaW1wbGVtZW50ZWQgeWV0Jyk7XG4gKi8gZnVuY3Rpb24gTSh0ID0gXCJVbmV4cGVjdGVkIHN0YXRlXCIpIHtcbiAgICAvLyBMb2cgdGhlIGZhaWx1cmUgaW4gYWRkaXRpb24gdG8gdGhyb3cgYW4gZXhjZXB0aW9uLCBqdXN0IGluIGNhc2UgdGhlXG4gICAgLy8gZXhjZXB0aW9uIGlzIHN3YWxsb3dlZC5cbiAgICBjb25zdCBlID0gYEZJUkVTVE9SRSAoJHtEfSkgSU5URVJOQUwgQVNTRVJUSU9OIEZBSUxFRDogYCArIHQ7XG4gICAgLy8gTk9URTogV2UgZG9uJ3QgdXNlIEZpcmVzdG9yZUVycm9yIGhlcmUgYmVjYXVzZSB0aGVzZSBhcmUgaW50ZXJuYWwgZmFpbHVyZXNcbiAgICAvLyB0aGF0IGNhbm5vdCBiZSBoYW5kbGVkIGJ5IHRoZSB1c2VyLiAoQWxzbyBpdCB3b3VsZCBjcmVhdGUgYSBjaXJjdWxhclxuICAgIC8vIGRlcGVuZGVuY3kgYmV0d2VlbiB0aGUgZXJyb3IgYW5kIGFzc2VydCBtb2R1bGVzIHdoaWNoIGRvZXNuJ3Qgd29yay4pXG4gICAgdGhyb3cgJChlKSwgbmV3IEVycm9yKGUpO1xufVxuXG4vKipcbiAqIEZhaWxzIGlmIHRoZSBnaXZlbiBhc3NlcnRpb24gY29uZGl0aW9uIGlzIGZhbHNlLCB0aHJvd2luZyBhbiBFcnJvciB3aXRoIHRoZVxuICogZ2l2ZW4gbWVzc2FnZSBpZiBpdCBkaWQuXG4gKlxuICogTWVzc2FnZXMgYXJlIHN0cmlwcGVkIGluIHByb2R1Y3Rpb24gYnVpbGRzLlxuICovIGZ1bmN0aW9uIEwodCwgZSkge1xuICAgIHQgfHwgTSgpO1xufVxuXG4vKipcbiAqIEZhaWxzIGlmIHRoZSBnaXZlbiBhc3NlcnRpb24gY29uZGl0aW9uIGlzIGZhbHNlLCB0aHJvd2luZyBhbiBFcnJvciB3aXRoIHRoZVxuICogZ2l2ZW4gbWVzc2FnZSBpZiBpdCBkaWQuXG4gKlxuICogVGhlIGNvZGUgb2YgY2FsbHNpdGVzIGludm9raW5nIHRoaXMgZnVuY3Rpb24gYXJlIHN0cmlwcGVkIG91dCBpbiBwcm9kdWN0aW9uXG4gKiBidWlsZHMuIEFueSBzaWRlLWVmZmVjdHMgb2YgY29kZSB3aXRoaW4gdGhlIGRlYnVnQXNzZXJ0KCkgaW52b2NhdGlvbiB3aWxsIG5vdFxuICogaGFwcGVuIGluIHRoaXMgY2FzZS5cbiAqXG4gKiBAaW50ZXJuYWxcbiAqLyBmdW5jdGlvbiBCKHQsIGUpIHtcbiAgICB0IHx8IE0oKTtcbn1cblxuLyoqXG4gKiBDYXN0cyBgb2JqYCB0byBgVGAuIEluIG5vbi1wcm9kdWN0aW9uIGJ1aWxkcywgdmVyaWZpZXMgdGhhdCBgb2JqYCBpcyBhblxuICogaW5zdGFuY2Ugb2YgYFRgIGJlZm9yZSBjYXN0aW5nLlxuICovIGZ1bmN0aW9uIFUodCwgXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuZSkge1xuICAgIHJldHVybiB0O1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjb25zdCBxID0ge1xuICAgIC8vIENhdXNlcyBhcmUgY29waWVkIGZyb206XG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2dycGMvZ3JwYy9ibG9iL2JjZWVjOTRlYTRmYzVmMDA4NWQ4MTIzNWQ4ZTFjMDY3OThkYzM0MWEvaW5jbHVkZS9ncnBjJTJCJTJCL2ltcGwvY29kZWdlbi9zdGF0dXNfY29kZV9lbnVtLmhcbiAgICAvKiogTm90IGFuIGVycm9yOyByZXR1cm5lZCBvbiBzdWNjZXNzLiAqL1xuICAgIE9LOiBcIm9rXCIsXG4gICAgLyoqIFRoZSBvcGVyYXRpb24gd2FzIGNhbmNlbGxlZCAodHlwaWNhbGx5IGJ5IHRoZSBjYWxsZXIpLiAqL1xuICAgIENBTkNFTExFRDogXCJjYW5jZWxsZWRcIixcbiAgICAvKiogVW5rbm93biBlcnJvciBvciBhbiBlcnJvciBmcm9tIGEgZGlmZmVyZW50IGVycm9yIGRvbWFpbi4gKi9cbiAgICBVTktOT1dOOiBcInVua25vd25cIixcbiAgICAvKipcbiAgICAgKiBDbGllbnQgc3BlY2lmaWVkIGFuIGludmFsaWQgYXJndW1lbnQuIE5vdGUgdGhhdCB0aGlzIGRpZmZlcnMgZnJvbVxuICAgICAqIEZBSUxFRF9QUkVDT05ESVRJT04uIElOVkFMSURfQVJHVU1FTlQgaW5kaWNhdGVzIGFyZ3VtZW50cyB0aGF0IGFyZVxuICAgICAqIHByb2JsZW1hdGljIHJlZ2FyZGxlc3Mgb2YgdGhlIHN0YXRlIG9mIHRoZSBzeXN0ZW0gKGUuZy4sIGEgbWFsZm9ybWVkIGZpbGVcbiAgICAgKiBuYW1lKS5cbiAgICAgKi9cbiAgICBJTlZBTElEX0FSR1VNRU5UOiBcImludmFsaWQtYXJndW1lbnRcIixcbiAgICAvKipcbiAgICAgKiBEZWFkbGluZSBleHBpcmVkIGJlZm9yZSBvcGVyYXRpb24gY291bGQgY29tcGxldGUuIEZvciBvcGVyYXRpb25zIHRoYXRcbiAgICAgKiBjaGFuZ2UgdGhlIHN0YXRlIG9mIHRoZSBzeXN0ZW0sIHRoaXMgZXJyb3IgbWF5IGJlIHJldHVybmVkIGV2ZW4gaWYgdGhlXG4gICAgICogb3BlcmF0aW9uIGhhcyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LiBGb3IgZXhhbXBsZSwgYSBzdWNjZXNzZnVsIHJlc3BvbnNlXG4gICAgICogZnJvbSBhIHNlcnZlciBjb3VsZCBoYXZlIGJlZW4gZGVsYXllZCBsb25nIGVub3VnaCBmb3IgdGhlIGRlYWRsaW5lIHRvXG4gICAgICogZXhwaXJlLlxuICAgICAqL1xuICAgIERFQURMSU5FX0VYQ0VFREVEOiBcImRlYWRsaW5lLWV4Y2VlZGVkXCIsXG4gICAgLyoqIFNvbWUgcmVxdWVzdGVkIGVudGl0eSAoZS5nLiwgZmlsZSBvciBkaXJlY3RvcnkpIHdhcyBub3QgZm91bmQuICovXG4gICAgTk9UX0ZPVU5EOiBcIm5vdC1mb3VuZFwiLFxuICAgIC8qKlxuICAgICAqIFNvbWUgZW50aXR5IHRoYXQgd2UgYXR0ZW1wdGVkIHRvIGNyZWF0ZSAoZS5nLiwgZmlsZSBvciBkaXJlY3RvcnkpIGFscmVhZHlcbiAgICAgKiBleGlzdHMuXG4gICAgICovXG4gICAgQUxSRUFEWV9FWElTVFM6IFwiYWxyZWFkeS1leGlzdHNcIixcbiAgICAvKipcbiAgICAgKiBUaGUgY2FsbGVyIGRvZXMgbm90IGhhdmUgcGVybWlzc2lvbiB0byBleGVjdXRlIHRoZSBzcGVjaWZpZWQgb3BlcmF0aW9uLlxuICAgICAqIFBFUk1JU1NJT05fREVOSUVEIG11c3Qgbm90IGJlIHVzZWQgZm9yIHJlamVjdGlvbnMgY2F1c2VkIGJ5IGV4aGF1c3RpbmdcbiAgICAgKiBzb21lIHJlc291cmNlICh1c2UgUkVTT1VSQ0VfRVhIQVVTVEVEIGluc3RlYWQgZm9yIHRob3NlIGVycm9ycykuXG4gICAgICogUEVSTUlTU0lPTl9ERU5JRUQgbXVzdCBub3QgYmUgdXNlZCBpZiB0aGUgY2FsbGVyIGNhbiBub3QgYmUgaWRlbnRpZmllZFxuICAgICAqICh1c2UgVU5BVVRIRU5USUNBVEVEIGluc3RlYWQgZm9yIHRob3NlIGVycm9ycykuXG4gICAgICovXG4gICAgUEVSTUlTU0lPTl9ERU5JRUQ6IFwicGVybWlzc2lvbi1kZW5pZWRcIixcbiAgICAvKipcbiAgICAgKiBUaGUgcmVxdWVzdCBkb2VzIG5vdCBoYXZlIHZhbGlkIGF1dGhlbnRpY2F0aW9uIGNyZWRlbnRpYWxzIGZvciB0aGVcbiAgICAgKiBvcGVyYXRpb24uXG4gICAgICovXG4gICAgVU5BVVRIRU5USUNBVEVEOiBcInVuYXV0aGVudGljYXRlZFwiLFxuICAgIC8qKlxuICAgICAqIFNvbWUgcmVzb3VyY2UgaGFzIGJlZW4gZXhoYXVzdGVkLCBwZXJoYXBzIGEgcGVyLXVzZXIgcXVvdGEsIG9yIHBlcmhhcHMgdGhlXG4gICAgICogZW50aXJlIGZpbGUgc3lzdGVtIGlzIG91dCBvZiBzcGFjZS5cbiAgICAgKi9cbiAgICBSRVNPVVJDRV9FWEhBVVNURUQ6IFwicmVzb3VyY2UtZXhoYXVzdGVkXCIsXG4gICAgLyoqXG4gICAgICogT3BlcmF0aW9uIHdhcyByZWplY3RlZCBiZWNhdXNlIHRoZSBzeXN0ZW0gaXMgbm90IGluIGEgc3RhdGUgcmVxdWlyZWQgZm9yXG4gICAgICogdGhlIG9wZXJhdGlvbidzIGV4ZWN1dGlvbi4gRm9yIGV4YW1wbGUsIGRpcmVjdG9yeSB0byBiZSBkZWxldGVkIG1heSBiZVxuICAgICAqIG5vbi1lbXB0eSwgYW4gcm1kaXIgb3BlcmF0aW9uIGlzIGFwcGxpZWQgdG8gYSBub24tZGlyZWN0b3J5LCBldGMuXG4gICAgICpcbiAgICAgKiBBIGxpdG11cyB0ZXN0IHRoYXQgbWF5IGhlbHAgYSBzZXJ2aWNlIGltcGxlbWVudG9yIGluIGRlY2lkaW5nXG4gICAgICogYmV0d2VlbiBGQUlMRURfUFJFQ09ORElUSU9OLCBBQk9SVEVELCBhbmQgVU5BVkFJTEFCTEU6XG4gICAgICogIChhKSBVc2UgVU5BVkFJTEFCTEUgaWYgdGhlIGNsaWVudCBjYW4gcmV0cnkganVzdCB0aGUgZmFpbGluZyBjYWxsLlxuICAgICAqICAoYikgVXNlIEFCT1JURUQgaWYgdGhlIGNsaWVudCBzaG91bGQgcmV0cnkgYXQgYSBoaWdoZXItbGV2ZWxcbiAgICAgKiAgICAgIChlLmcuLCByZXN0YXJ0aW5nIGEgcmVhZC1tb2RpZnktd3JpdGUgc2VxdWVuY2UpLlxuICAgICAqICAoYykgVXNlIEZBSUxFRF9QUkVDT05ESVRJT04gaWYgdGhlIGNsaWVudCBzaG91bGQgbm90IHJldHJ5IHVudGlsXG4gICAgICogICAgICB0aGUgc3lzdGVtIHN0YXRlIGhhcyBiZWVuIGV4cGxpY2l0bHkgZml4ZWQuIEUuZy4sIGlmIGFuIFwicm1kaXJcIlxuICAgICAqICAgICAgZmFpbHMgYmVjYXVzZSB0aGUgZGlyZWN0b3J5IGlzIG5vbi1lbXB0eSwgRkFJTEVEX1BSRUNPTkRJVElPTlxuICAgICAqICAgICAgc2hvdWxkIGJlIHJldHVybmVkIHNpbmNlIHRoZSBjbGllbnQgc2hvdWxkIG5vdCByZXRyeSB1bmxlc3NcbiAgICAgKiAgICAgIHRoZXkgaGF2ZSBmaXJzdCBmaXhlZCB1cCB0aGUgZGlyZWN0b3J5IGJ5IGRlbGV0aW5nIGZpbGVzIGZyb20gaXQuXG4gICAgICogIChkKSBVc2UgRkFJTEVEX1BSRUNPTkRJVElPTiBpZiB0aGUgY2xpZW50IHBlcmZvcm1zIGNvbmRpdGlvbmFsXG4gICAgICogICAgICBSRVNUIEdldC9VcGRhdGUvRGVsZXRlIG9uIGEgcmVzb3VyY2UgYW5kIHRoZSByZXNvdXJjZSBvbiB0aGVcbiAgICAgKiAgICAgIHNlcnZlciBkb2VzIG5vdCBtYXRjaCB0aGUgY29uZGl0aW9uLiBFLmcuLCBjb25mbGljdGluZ1xuICAgICAqICAgICAgcmVhZC1tb2RpZnktd3JpdGUgb24gdGhlIHNhbWUgcmVzb3VyY2UuXG4gICAgICovXG4gICAgRkFJTEVEX1BSRUNPTkRJVElPTjogXCJmYWlsZWQtcHJlY29uZGl0aW9uXCIsXG4gICAgLyoqXG4gICAgICogVGhlIG9wZXJhdGlvbiB3YXMgYWJvcnRlZCwgdHlwaWNhbGx5IGR1ZSB0byBhIGNvbmN1cnJlbmN5IGlzc3VlIGxpa2VcbiAgICAgKiBzZXF1ZW5jZXIgY2hlY2sgZmFpbHVyZXMsIHRyYW5zYWN0aW9uIGFib3J0cywgZXRjLlxuICAgICAqXG4gICAgICogU2VlIGxpdG11cyB0ZXN0IGFib3ZlIGZvciBkZWNpZGluZyBiZXR3ZWVuIEZBSUxFRF9QUkVDT05ESVRJT04sIEFCT1JURUQsXG4gICAgICogYW5kIFVOQVZBSUxBQkxFLlxuICAgICAqL1xuICAgIEFCT1JURUQ6IFwiYWJvcnRlZFwiLFxuICAgIC8qKlxuICAgICAqIE9wZXJhdGlvbiB3YXMgYXR0ZW1wdGVkIHBhc3QgdGhlIHZhbGlkIHJhbmdlLiBFLmcuLCBzZWVraW5nIG9yIHJlYWRpbmdcbiAgICAgKiBwYXN0IGVuZCBvZiBmaWxlLlxuICAgICAqXG4gICAgICogVW5saWtlIElOVkFMSURfQVJHVU1FTlQsIHRoaXMgZXJyb3IgaW5kaWNhdGVzIGEgcHJvYmxlbSB0aGF0IG1heSBiZSBmaXhlZFxuICAgICAqIGlmIHRoZSBzeXN0ZW0gc3RhdGUgY2hhbmdlcy4gRm9yIGV4YW1wbGUsIGEgMzItYml0IGZpbGUgc3lzdGVtIHdpbGxcbiAgICAgKiBnZW5lcmF0ZSBJTlZBTElEX0FSR1VNRU5UIGlmIGFza2VkIHRvIHJlYWQgYXQgYW4gb2Zmc2V0IHRoYXQgaXMgbm90IGluIHRoZVxuICAgICAqIHJhbmdlIFswLDJeMzItMV0sIGJ1dCBpdCB3aWxsIGdlbmVyYXRlIE9VVF9PRl9SQU5HRSBpZiBhc2tlZCB0byByZWFkIGZyb21cbiAgICAgKiBhbiBvZmZzZXQgcGFzdCB0aGUgY3VycmVudCBmaWxlIHNpemUuXG4gICAgICpcbiAgICAgKiBUaGVyZSBpcyBhIGZhaXIgYml0IG9mIG92ZXJsYXAgYmV0d2VlbiBGQUlMRURfUFJFQ09ORElUSU9OIGFuZFxuICAgICAqIE9VVF9PRl9SQU5HRS4gV2UgcmVjb21tZW5kIHVzaW5nIE9VVF9PRl9SQU5HRSAodGhlIG1vcmUgc3BlY2lmaWMgZXJyb3IpXG4gICAgICogd2hlbiBpdCBhcHBsaWVzIHNvIHRoYXQgY2FsbGVycyB3aG8gYXJlIGl0ZXJhdGluZyB0aHJvdWdoIGEgc3BhY2UgY2FuXG4gICAgICogZWFzaWx5IGxvb2sgZm9yIGFuIE9VVF9PRl9SQU5HRSBlcnJvciB0byBkZXRlY3Qgd2hlbiB0aGV5IGFyZSBkb25lLlxuICAgICAqL1xuICAgIE9VVF9PRl9SQU5HRTogXCJvdXQtb2YtcmFuZ2VcIixcbiAgICAvKiogT3BlcmF0aW9uIGlzIG5vdCBpbXBsZW1lbnRlZCBvciBub3Qgc3VwcG9ydGVkL2VuYWJsZWQgaW4gdGhpcyBzZXJ2aWNlLiAqL1xuICAgIFVOSU1QTEVNRU5URUQ6IFwidW5pbXBsZW1lbnRlZFwiLFxuICAgIC8qKlxuICAgICAqIEludGVybmFsIGVycm9ycy4gTWVhbnMgc29tZSBpbnZhcmlhbnRzIGV4cGVjdGVkIGJ5IHVuZGVybHlpbmcgU3lzdGVtIGhhc1xuICAgICAqIGJlZW4gYnJva2VuLiBJZiB5b3Ugc2VlIG9uZSBvZiB0aGVzZSBlcnJvcnMsIFNvbWV0aGluZyBpcyB2ZXJ5IGJyb2tlbi5cbiAgICAgKi9cbiAgICBJTlRFUk5BTDogXCJpbnRlcm5hbFwiLFxuICAgIC8qKlxuICAgICAqIFRoZSBzZXJ2aWNlIGlzIGN1cnJlbnRseSB1bmF2YWlsYWJsZS4gVGhpcyBpcyBhIG1vc3QgbGlrZWx5IGEgdHJhbnNpZW50XG4gICAgICogY29uZGl0aW9uIGFuZCBtYXkgYmUgY29ycmVjdGVkIGJ5IHJldHJ5aW5nIHdpdGggYSBiYWNrb2ZmLlxuICAgICAqXG4gICAgICogU2VlIGxpdG11cyB0ZXN0IGFib3ZlIGZvciBkZWNpZGluZyBiZXR3ZWVuIEZBSUxFRF9QUkVDT05ESVRJT04sIEFCT1JURUQsXG4gICAgICogYW5kIFVOQVZBSUxBQkxFLlxuICAgICAqL1xuICAgIFVOQVZBSUxBQkxFOiBcInVuYXZhaWxhYmxlXCIsXG4gICAgLyoqIFVucmVjb3ZlcmFibGUgZGF0YSBsb3NzIG9yIGNvcnJ1cHRpb24uICovXG4gICAgREFUQV9MT1NTOiBcImRhdGEtbG9zc1wiXG59O1xuXG4vKiogQW4gZXJyb3IgcmV0dXJuZWQgYnkgYSBGaXJlc3RvcmUgb3BlcmF0aW9uLiAqLyBjbGFzcyBLIGV4dGVuZHMgRXJyb3Ige1xuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yICovXG4gICAgY29uc3RydWN0b3IoXG4gICAgLyoqXG4gICAgICogVGhlIGJhY2tlbmQgZXJyb3IgY29kZSBhc3NvY2lhdGVkIHdpdGggdGhpcyBlcnJvci5cbiAgICAgKi9cbiAgICB0LCBcbiAgICAvKipcbiAgICAgKiBBIGN1c3RvbSBlcnJvciBkZXNjcmlwdGlvbi5cbiAgICAgKi9cbiAgICBlKSB7XG4gICAgICAgIHN1cGVyKGUpLCB0aGlzLmNvZGUgPSB0LCB0aGlzLm1lc3NhZ2UgPSBlLCBcbiAgICAgICAgLyoqIFRoZSBjdXN0b20gbmFtZSBmb3IgYWxsIEZpcmVzdG9yZUVycm9ycy4gKi9cbiAgICAgICAgdGhpcy5uYW1lID0gXCJGaXJlYmFzZUVycm9yXCIsIFxuICAgICAgICAvLyBIQUNLOiBXZSB3cml0ZSBhIHRvU3RyaW5nIHByb3BlcnR5IGRpcmVjdGx5IGJlY2F1c2UgRXJyb3IgaXMgbm90IGEgcmVhbFxuICAgICAgICAvLyBjbGFzcyBhbmQgc28gaW5oZXJpdGFuY2UgZG9lcyBub3Qgd29yayBjb3JyZWN0bHkuIFdlIGNvdWxkIGFsdGVybmF0aXZlbHlcbiAgICAgICAgLy8gZG8gdGhlIHNhbWUgXCJiYWNrLWRvb3IgaW5oZXJpdGFuY2VcIiB0cmljayB0aGF0IEZpcmViYXNlRXJyb3IgZG9lcy5cbiAgICAgICAgdGhpcy50b1N0cmluZyA9ICgpID0+IGAke3RoaXMubmFtZX06IFtjb2RlPSR7dGhpcy5jb2RlfV06ICR7dGhpcy5tZXNzYWdlfWA7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjbGFzcyBqIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5wcm9taXNlID0gbmV3IFByb21pc2UoKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnJlc29sdmUgPSB0LCB0aGlzLnJlamVjdCA9IGU7XG4gICAgICAgIH0pKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNsYXNzIFEge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy51c2VyID0gZSwgdGhpcy50eXBlID0gXCJPQXV0aFwiLCB0aGlzLmF1dGhIZWFkZXJzID0ge30sIFxuICAgICAgICAvLyBTZXQgdGhlIGhlYWRlcnMgdXNpbmcgT2JqZWN0IExpdGVyYWwgbm90YXRpb24gdG8gYXZvaWQgbWluaWZpY2F0aW9uXG4gICAgICAgIHRoaXMuYXV0aEhlYWRlcnMuQXV0aG9yaXphdGlvbiA9IGBCZWFyZXIgJHt0fWA7XG4gICAgfVxufVxuXG4vKiogQSBDcmVkZW50aWFsc1Byb3ZpZGVyIHRoYXQgYWx3YXlzIHlpZWxkcyBhbiBlbXB0eSB0b2tlbi4gKi8gY2xhc3MgVyB7XG4gICAgZ2V0VG9rZW4oKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobnVsbCk7XG4gICAgfVxuICAgIGludmFsaWRhdGVUb2tlbigpIHt9XG4gICAgc3RhcnQodCwgZSkge1xuICAgICAgICAvLyBGaXJlIHdpdGggaW5pdGlhbCB1c2VyLlxuICAgICAgICB0LmVucXVldWVSZXRyeWFibGUoKCgpID0+IGUoUy5VTkFVVEhFTlRJQ0FURUQpKSk7XG4gICAgfVxuICAgIHNodXRkb3duKCkge31cbn1cblxuLyoqXG4gKiBBIENyZWRlbnRpYWxzUHJvdmlkZXIgdGhhdCBhbHdheXMgcmV0dXJucyBhIGNvbnN0YW50IHRva2VuLiBVc2VkIGZvclxuICogZW11bGF0b3IgdG9rZW4gbW9ja2luZy5cbiAqLyBjbGFzcyBHIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMudG9rZW4gPSB0LCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFN0b3JlcyB0aGUgbGlzdGVuZXIgcmVnaXN0ZXJlZCB3aXRoIHNldENoYW5nZUxpc3RlbmVyKClcbiAgICAgICAgICogVGhpcyBpc24ndCBhY3R1YWxseSBuZWNlc3Nhcnkgc2luY2UgdGhlIFVJRCBuZXZlciBjaGFuZ2VzLCBidXQgd2UgdXNlIHRoaXNcbiAgICAgICAgICogdG8gdmVyaWZ5IHRoZSBsaXN0ZW4gY29udHJhY3QgaXMgYWRoZXJlZCB0byBpbiB0ZXN0cy5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuY2hhbmdlTGlzdGVuZXIgPSBudWxsO1xuICAgIH1cbiAgICBnZXRUb2tlbigpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0aGlzLnRva2VuKTtcbiAgICB9XG4gICAgaW52YWxpZGF0ZVRva2VuKCkge31cbiAgICBzdGFydCh0LCBlKSB7XG4gICAgICAgIHRoaXMuY2hhbmdlTGlzdGVuZXIgPSBlLCBcbiAgICAgICAgLy8gRmlyZSB3aXRoIGluaXRpYWwgdXNlci5cbiAgICAgICAgdC5lbnF1ZXVlUmV0cnlhYmxlKCgoKSA9PiBlKHRoaXMudG9rZW4udXNlcikpKTtcbiAgICB9XG4gICAgc2h1dGRvd24oKSB7XG4gICAgICAgIHRoaXMuY2hhbmdlTGlzdGVuZXIgPSBudWxsO1xuICAgIH1cbn1cblxuY2xhc3MgeiB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLnQgPSB0LCBcbiAgICAgICAgLyoqIFRyYWNrcyB0aGUgY3VycmVudCBVc2VyLiAqL1xuICAgICAgICB0aGlzLmN1cnJlbnRVc2VyID0gUy5VTkFVVEhFTlRJQ0FURUQsIFxuICAgICAgICAvKipcbiAgICAgICAgICogQ291bnRlciB1c2VkIHRvIGRldGVjdCBpZiB0aGUgdG9rZW4gY2hhbmdlZCB3aGlsZSBhIGdldFRva2VuIHJlcXVlc3Qgd2FzXG4gICAgICAgICAqIG91dHN0YW5kaW5nLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5pID0gMCwgdGhpcy5mb3JjZVJlZnJlc2ggPSAhMSwgdGhpcy5hdXRoID0gbnVsbDtcbiAgICB9XG4gICAgc3RhcnQodCwgZSkge1xuICAgICAgICBsZXQgbiA9IHRoaXMuaTtcbiAgICAgICAgLy8gQSBjaGFuZ2UgbGlzdGVuZXIgdGhhdCBwcmV2ZW50cyBkb3VibGUtZmlyaW5nIGZvciB0aGUgc2FtZSB0b2tlbiBjaGFuZ2UuXG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IHQgPT4gdGhpcy5pICE9PSBuID8gKG4gPSB0aGlzLmksIGUodCkpIDogUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgIC8vIEEgcHJvbWlzZSB0aGF0IGNhbiBiZSB3YWl0ZWQgb24gdG8gYmxvY2sgb24gdGhlIG5leHQgdG9rZW4gY2hhbmdlLlxuICAgICAgICAvLyBUaGlzIHByb21pc2UgaXMgcmUtY3JlYXRlZCBhZnRlciBlYWNoIGNoYW5nZS5cbiAgICAgICAgICAgICAgICBsZXQgaSA9IG5ldyBqO1xuICAgICAgICB0aGlzLm8gPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmkrKywgdGhpcy5jdXJyZW50VXNlciA9IHRoaXMudSgpLCBpLnJlc29sdmUoKSwgaSA9IG5ldyBqLCB0LmVucXVldWVSZXRyeWFibGUoKCgpID0+IHModGhpcy5jdXJyZW50VXNlcikpKTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgciA9IGUgPT4ge1xuICAgICAgICAgICAgdC5lbnF1ZXVlUmV0cnlhYmxlKChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgayhcIkZpcmViYXNlQ3JlZGVudGlhbHNQcm92aWRlclwiLCBcIkF1dGggZGV0ZWN0ZWRcIiksIHRoaXMuYXV0aCA9IGUsIHRoaXMuYXV0aC5hZGRBdXRoVG9rZW5MaXN0ZW5lcih0aGlzLm8pLCBcbiAgICAgICAgICAgICAgICAvLyBDYWxsIHRoZSBjaGFuZ2UgbGlzdGVuZXIgaW5saW5lIHRvIGJsb2NrIG9uIHRoZSB1c2VyIGNoYW5nZS5cbiAgICAgICAgICAgICAgICBhd2FpdCBpLnByb21pc2UsIGF3YWl0IHModGhpcy5jdXJyZW50VXNlcik7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMudC5vbkluaXQoKHQgPT4gcih0KSkpLCBcbiAgICAgICAgLy8gT3VyIHVzZXJzIGNhbiBpbml0aWFsaXplIEF1dGggcmlnaHQgYWZ0ZXIgRmlyZXN0b3JlLCBzbyB3ZSBnaXZlIGl0XG4gICAgICAgIC8vIGEgY2hhbmNlIHRvIHJlZ2lzdGVyIGl0c2VsZiB3aXRoIHRoZSBjb21wb25lbnQgZnJhbWV3b3JrIGJlZm9yZSB3ZVxuICAgICAgICAvLyBkZXRlcm1pbmUgd2hldGhlciB0byBzdGFydCB1cCBpbiB1bmF1dGhlbnRpY2F0ZWQgbW9kZS5cbiAgICAgICAgc2V0VGltZW91dCgoKCkgPT4ge1xuICAgICAgICAgICAgaWYgKCF0aGlzLmF1dGgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy50LmdldEltbWVkaWF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiAhMFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHQgPyByKHQpIDogKFxuICAgICAgICAgICAgICAgIC8vIElmIGF1dGggaXMgc3RpbGwgbm90IGF2YWlsYWJsZSwgcHJvY2VlZCB3aXRoIGBudWxsYCB1c2VyXG4gICAgICAgICAgICAgICAgayhcIkZpcmViYXNlQ3JlZGVudGlhbHNQcm92aWRlclwiLCBcIkF1dGggbm90IHlldCBkZXRlY3RlZFwiKSwgaS5yZXNvbHZlKCksIGkgPSBuZXcgaik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pLCAwKSwgdC5lbnF1ZXVlUmV0cnlhYmxlKChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAvLyBJZiB3ZSBoYXZlIG5vdCByZWNlaXZlZCBhIHRva2VuLCB3YWl0IGZvciB0aGUgZmlyc3Qgb25lLlxuICAgICAgICAgICAgMCA9PT0gdGhpcy5pICYmIChhd2FpdCBpLnByb21pc2UsIGF3YWl0IHModGhpcy5jdXJyZW50VXNlcikpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGdldFRva2VuKCkge1xuICAgICAgICAvLyBUYWtlIG5vdGUgb2YgdGhlIGN1cnJlbnQgdmFsdWUgb2YgdGhlIHRva2VuQ291bnRlciBzbyB0aGF0IHRoaXMgbWV0aG9kXG4gICAgICAgIC8vIGNhbiBmYWlsICh3aXRoIGFuIEFCT1JURUQgZXJyb3IpIGlmIHRoZXJlIGlzIGEgdG9rZW4gY2hhbmdlIHdoaWxlIHRoZVxuICAgICAgICAvLyByZXF1ZXN0IGlzIG91dHN0YW5kaW5nLlxuICAgICAgICBjb25zdCB0ID0gdGhpcy5pLCBlID0gdGhpcy5mb3JjZVJlZnJlc2g7XG4gICAgICAgIHJldHVybiB0aGlzLmZvcmNlUmVmcmVzaCA9ICExLCB0aGlzLmF1dGggPyB0aGlzLmF1dGguZ2V0VG9rZW4oZSkudGhlbigoZSA9PiBcbiAgICAgICAgLy8gQ2FuY2VsIHRoZSByZXF1ZXN0IHNpbmNlIHRoZSB0b2tlbiBjaGFuZ2VkIHdoaWxlIHRoZSByZXF1ZXN0IHdhc1xuICAgICAgICAvLyBvdXRzdGFuZGluZyBzbyB0aGUgcmVzcG9uc2UgaXMgcG90ZW50aWFsbHkgZm9yIGEgcHJldmlvdXMgdXNlciAod2hpY2hcbiAgICAgICAgLy8gdXNlciwgd2UgY2FuJ3QgYmUgc3VyZSkuXG4gICAgICAgIHRoaXMuaSAhPT0gdCA/IChrKFwiRmlyZWJhc2VDcmVkZW50aWFsc1Byb3ZpZGVyXCIsIFwiZ2V0VG9rZW4gYWJvcnRlZCBkdWUgdG8gdG9rZW4gY2hhbmdlLlwiKSwgXG4gICAgICAgIHRoaXMuZ2V0VG9rZW4oKSkgOiBlID8gKEwoXCJzdHJpbmdcIiA9PSB0eXBlb2YgZS5hY2Nlc3NUb2tlbiksIG5ldyBRKGUuYWNjZXNzVG9rZW4sIHRoaXMuY3VycmVudFVzZXIpKSA6IG51bGwpKSA6IFByb21pc2UucmVzb2x2ZShudWxsKTtcbiAgICB9XG4gICAgaW52YWxpZGF0ZVRva2VuKCkge1xuICAgICAgICB0aGlzLmZvcmNlUmVmcmVzaCA9ICEwO1xuICAgIH1cbiAgICBzaHV0ZG93bigpIHtcbiAgICAgICAgdGhpcy5hdXRoICYmIHRoaXMuYXV0aC5yZW1vdmVBdXRoVG9rZW5MaXN0ZW5lcih0aGlzLm8pO1xuICAgIH1cbiAgICAvLyBBdXRoLmdldFVpZCgpIGNhbiByZXR1cm4gbnVsbCBldmVuIHdpdGggYSB1c2VyIGxvZ2dlZCBpbi4gSXQgaXMgYmVjYXVzZVxuICAgIC8vIGdldFVpZCgpIGlzIHN5bmNocm9ub3VzLCBidXQgdGhlIGF1dGggY29kZSBwb3B1bGF0aW5nIFVpZCBpcyBhc3luY2hyb25vdXMuXG4gICAgLy8gVGhpcyBtZXRob2Qgc2hvdWxkIG9ubHkgYmUgY2FsbGVkIGluIHRoZSBBdXRoVG9rZW5MaXN0ZW5lciBjYWxsYmFja1xuICAgIC8vIHRvIGd1YXJhbnRlZSB0byBnZXQgdGhlIGFjdHVhbCB1c2VyLlxuICAgIHUoKSB7XG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLmF1dGggJiYgdGhpcy5hdXRoLmdldFVpZCgpO1xuICAgICAgICByZXR1cm4gTChudWxsID09PSB0IHx8IFwic3RyaW5nXCIgPT0gdHlwZW9mIHQpLCBuZXcgUyh0KTtcbiAgICB9XG59XG5cbi8qXG4gKiBGaXJzdFBhcnR5VG9rZW4gcHJvdmlkZXMgYSBmcmVzaCB0b2tlbiBlYWNoIHRpbWUgaXRzIHZhbHVlXG4gKiBpcyByZXF1ZXN0ZWQsIGJlY2F1c2UgaWYgdGhlIHRva2VuIGlzIHRvbyBvbGQsIHJlcXVlc3RzIHdpbGwgYmUgcmVqZWN0ZWQuXG4gKiBUZWNobmljYWxseSB0aGlzIG1heSBubyBsb25nZXIgYmUgbmVjZXNzYXJ5IHNpbmNlIHRoZSBTREsgc2hvdWxkIGdyYWNlZnVsbHlcbiAqIHJlY292ZXIgZnJvbSB1bmF1dGhlbnRpY2F0ZWQgZXJyb3JzIChzZWUgYi8zMzE0NzgxOCBmb3IgY29udGV4dCksIGJ1dCBpdCdzXG4gKiBzYWZlciB0byBrZWVwIHRoZSBpbXBsZW1lbnRhdGlvbiBhcy1pcy5cbiAqLyBjbGFzcyBIIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHRoaXMuaCA9IHQsIHRoaXMubCA9IGUsIHRoaXMubSA9IG4sIHRoaXMudHlwZSA9IFwiRmlyc3RQYXJ0eVwiLCB0aGlzLnVzZXIgPSBTLkZJUlNUX1BBUlRZO1xuICAgIH1cbiAgICBnZXQgYXV0aEhlYWRlcnMoKSB7XG4gICAgICAgIGNvbnN0IHQgPSB7XG4gICAgICAgICAgICBcIlgtR29vZy1BdXRoVXNlclwiOiB0aGlzLmxcbiAgICAgICAgfSwgZSA9IHRoaXMuaC5hdXRoLmdldEF1dGhIZWFkZXJWYWx1ZUZvckZpcnN0UGFydHkoW10pO1xuICAgICAgICAvLyBVc2UgYXJyYXkgbm90YXRpb24gdG8gcHJldmVudCBtaW5pZmljYXRpb25cbiAgICAgICAgICAgICAgICByZXR1cm4gZSAmJiAodC5BdXRob3JpemF0aW9uID0gZSksIHRoaXMubSAmJiAodFtcIlgtR29vZy1JYW0tQXV0aG9yaXphdGlvbi1Ub2tlblwiXSA9IHRoaXMubSksIFxuICAgICAgICB0O1xuICAgIH1cbn1cblxuLypcbiAqIFByb3ZpZGVzIHVzZXIgY3JlZGVudGlhbHMgcmVxdWlyZWQgZm9yIHRoZSBGaXJlc3RvcmUgSmF2YVNjcmlwdCBTREtcbiAqIHRvIGF1dGhlbnRpY2F0ZSB0aGUgdXNlciwgdXNpbmcgdGVjaG5pcXVlIHRoYXQgaXMgb25seSBhdmFpbGFibGVcbiAqIHRvIGFwcGxpY2F0aW9ucyBob3N0ZWQgYnkgR29vZ2xlLlxuICovIGNsYXNzIEoge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4pIHtcbiAgICAgICAgdGhpcy5oID0gdCwgdGhpcy5sID0gZSwgdGhpcy5tID0gbjtcbiAgICB9XG4gICAgZ2V0VG9rZW4oKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobmV3IEgodGhpcy5oLCB0aGlzLmwsIHRoaXMubSkpO1xuICAgIH1cbiAgICBzdGFydCh0LCBlKSB7XG4gICAgICAgIC8vIEZpcmUgd2l0aCBpbml0aWFsIHVpZC5cbiAgICAgICAgdC5lbnF1ZXVlUmV0cnlhYmxlKCgoKSA9PiBlKFMuRklSU1RfUEFSVFkpKSk7XG4gICAgfVxuICAgIHNodXRkb3duKCkge31cbiAgICBpbnZhbGlkYXRlVG9rZW4oKSB7fVxufVxuXG4vKipcbiAqIEJ1aWxkcyBhIENyZWRlbnRpYWxzUHJvdmlkZXIgZGVwZW5kaW5nIG9uIHRoZSB0eXBlIG9mXG4gKiB0aGUgY3JlZGVudGlhbHMgcGFzc2VkIGluLlxuICovXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBgTGlzdGVuU2VxdWVuY2VgIGlzIGEgbW9ub3RvbmljIHNlcXVlbmNlLiBJdCBpcyBpbml0aWFsaXplZCB3aXRoIGEgbWluaW11bSB2YWx1ZSB0b1xuICogZXhjZWVkLiBBbGwgc3Vic2VxdWVudCBjYWxscyB0byBuZXh0IHdpbGwgcmV0dXJuIGluY3JlYXNpbmcgdmFsdWVzLiBJZiBwcm92aWRlZCB3aXRoIGFcbiAqIGBTZXF1ZW5jZU51bWJlclN5bmNlcmAsIGl0IHdpbGwgYWRkaXRpb25hbGx5IGJ1bXAgaXRzIG5leHQgdmFsdWUgd2hlbiB0b2xkIG9mIGEgbmV3IHZhbHVlLCBhc1xuICogd2VsbCBhcyB3cml0ZSBvdXQgc2VxdWVuY2UgbnVtYmVycyB0aGF0IGl0IHByb2R1Y2VzIHZpYSBgbmV4dCgpYC5cbiAqL1xuY2xhc3MgWSB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLnByZXZpb3VzVmFsdWUgPSB0LCBlICYmIChlLnNlcXVlbmNlTnVtYmVySGFuZGxlciA9IHQgPT4gdGhpcy5nKHQpLCB0aGlzLnAgPSB0ID0+IGUud3JpdGVTZXF1ZW5jZU51bWJlcih0KSk7XG4gICAgfVxuICAgIGcodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcmV2aW91c1ZhbHVlID0gTWF0aC5tYXgodCwgdGhpcy5wcmV2aW91c1ZhbHVlKSwgdGhpcy5wcmV2aW91c1ZhbHVlO1xuICAgIH1cbiAgICBuZXh0KCkge1xuICAgICAgICBjb25zdCB0ID0gKyt0aGlzLnByZXZpb3VzVmFsdWU7XG4gICAgICAgIHJldHVybiB0aGlzLnAgJiYgdGhpcy5wKHQpLCB0O1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogR2VuZXJhdGVzIGBuQnl0ZXNgIG9mIHJhbmRvbSBieXRlcy5cbiAqXG4gKiBJZiBgbkJ5dGVzIDwgMGAgLCBhbiBlcnJvciB3aWxsIGJlIHRocm93bi5cbiAqL1xuZnVuY3Rpb24gWCh0KSB7XG4gICAgLy8gUG9seWZpbGxzIGZvciBJRSBhbmQgV2ViV29ya2VyIGJ5IHVzaW5nIGBzZWxmYCBhbmQgYG1zQ3J5cHRvYCB3aGVuIGBjcnlwdG9gIGlzIG5vdCBhdmFpbGFibGUuXG4gICAgY29uc3QgZSA9IFxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2Ygc2VsZiAmJiAoc2VsZi5jcnlwdG8gfHwgc2VsZi5tc0NyeXB0byksIG4gPSBuZXcgVWludDhBcnJheSh0KTtcbiAgICBpZiAoZSAmJiBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIGUuZ2V0UmFuZG9tVmFsdWVzKSBlLmdldFJhbmRvbVZhbHVlcyhuKTsgZWxzZSBcbiAgICAvLyBGYWxscyBiYWNrIHRvIE1hdGgucmFuZG9tXG4gICAgZm9yIChsZXQgZSA9IDA7IGUgPCB0OyBlKyspIG5bZV0gPSBNYXRoLmZsb29yKDI1NiAqIE1hdGgucmFuZG9tKCkpO1xuICAgIHJldHVybiBuO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBZLlQgPSAtMTtcblxuY2xhc3MgWiB7XG4gICAgc3RhdGljIEkoKSB7XG4gICAgICAgIC8vIEFscGhhbnVtZXJpYyBjaGFyYWN0ZXJzXG4gICAgICAgIGNvbnN0IHQgPSBcIkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5XCIsIGUgPSBNYXRoLmZsb29yKDI1NiAvIHQubGVuZ3RoKSAqIHQubGVuZ3RoO1xuICAgICAgICAvLyBUaGUgbGFyZ2VzdCBieXRlIHZhbHVlIHRoYXQgaXMgYSBtdWx0aXBsZSBvZiBgY2hhci5sZW5ndGhgLlxuICAgICAgICAgICAgICAgIGxldCBuID0gXCJcIjtcbiAgICAgICAgZm9yICg7bi5sZW5ndGggPCAyMDsgKSB7XG4gICAgICAgICAgICBjb25zdCBzID0gWCg0MCk7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHMubGVuZ3RoOyArK2kpIFxuICAgICAgICAgICAgLy8gT25seSBhY2NlcHQgdmFsdWVzIHRoYXQgYXJlIFswLCBtYXhNdWx0aXBsZSksIHRoaXMgZW5zdXJlcyB0aGV5IGNhblxuICAgICAgICAgICAgLy8gYmUgZXZlbmx5IG1hcHBlZCB0byBpbmRpY2VzIG9mIGBjaGFyc2AgdmlhIGEgbW9kdWxvIG9wZXJhdGlvbi5cbiAgICAgICAgICAgIG4ubGVuZ3RoIDwgMjAgJiYgc1tpXSA8IGUgJiYgKG4gKz0gdC5jaGFyQXQoc1tpXSAlIHQubGVuZ3RoKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG47XG4gICAgfVxufVxuXG5mdW5jdGlvbiB0dCh0LCBlKSB7XG4gICAgcmV0dXJuIHQgPCBlID8gLTEgOiB0ID4gZSA/IDEgOiAwO1xufVxuXG4vKiogSGVscGVyIHRvIGNvbXBhcmUgYXJyYXlzIHVzaW5nIGlzRXF1YWwoKS4gKi8gZnVuY3Rpb24gZXQodCwgZSwgbikge1xuICAgIHJldHVybiB0Lmxlbmd0aCA9PT0gZS5sZW5ndGggJiYgdC5ldmVyeSgoKHQsIHMpID0+IG4odCwgZVtzXSkpKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBpbW1lZGlhdGUgbGV4aWNvZ3JhcGhpY2FsbHktZm9sbG93aW5nIHN0cmluZy4gVGhpcyBpcyB1c2VmdWwgdG9cbiAqIGNvbnN0cnVjdCBhbiBpbmNsdXNpdmUgcmFuZ2UgZm9yIGluZGV4ZWRkYiBpdGVyYXRvcnMuXG4gKi8gZnVuY3Rpb24gbnQodCkge1xuICAgIC8vIFJldHVybiB0aGUgaW5wdXQgc3RyaW5nLCB3aXRoIGFuIGFkZGl0aW9uYWwgTlVMIGJ5dGUgYXBwZW5kZWQuXG4gICAgcmV0dXJuIHQgKyBcIlxcMFwiO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLy8gVGhlIGVhcmxpZXN0IGRhdGUgc3VwcG9ydGVkIGJ5IEZpcmVzdG9yZSB0aW1lc3RhbXBzICgwMDAxLTAxLTAxVDAwOjAwOjAwWikuXG4vKipcbiAqIEEgYFRpbWVzdGFtcGAgcmVwcmVzZW50cyBhIHBvaW50IGluIHRpbWUgaW5kZXBlbmRlbnQgb2YgYW55IHRpbWUgem9uZSBvclxuICogY2FsZW5kYXIsIHJlcHJlc2VudGVkIGFzIHNlY29uZHMgYW5kIGZyYWN0aW9ucyBvZiBzZWNvbmRzIGF0IG5hbm9zZWNvbmRcbiAqIHJlc29sdXRpb24gaW4gVVRDIEVwb2NoIHRpbWUuXG4gKlxuICogSXQgaXMgZW5jb2RlZCB1c2luZyB0aGUgUHJvbGVwdGljIEdyZWdvcmlhbiBDYWxlbmRhciB3aGljaCBleHRlbmRzIHRoZVxuICogR3JlZ29yaWFuIGNhbGVuZGFyIGJhY2t3YXJkcyB0byB5ZWFyIG9uZS4gSXQgaXMgZW5jb2RlZCBhc3N1bWluZyBhbGwgbWludXRlc1xuICogYXJlIDYwIHNlY29uZHMgbG9uZywgaS5lLiBsZWFwIHNlY29uZHMgYXJlIFwic21lYXJlZFwiIHNvIHRoYXQgbm8gbGVhcCBzZWNvbmRcbiAqIHRhYmxlIGlzIG5lZWRlZCBmb3IgaW50ZXJwcmV0YXRpb24uIFJhbmdlIGlzIGZyb20gMDAwMS0wMS0wMVQwMDowMDowMFogdG9cbiAqIDk5OTktMTItMzFUMjM6NTk6NTkuOTk5OTk5OTk5Wi5cbiAqXG4gKiBGb3IgZXhhbXBsZXMgYW5kIGZ1cnRoZXIgc3BlY2lmaWNhdGlvbnMsIHJlZmVyIHRvIHRoZVxuICoge0BsaW5rIGh0dHBzOi8vZ2l0aHViLmNvbS9nb29nbGUvcHJvdG9idWYvYmxvYi9tYXN0ZXIvc3JjL2dvb2dsZS9wcm90b2J1Zi90aW1lc3RhbXAucHJvdG8gfCBUaW1lc3RhbXAgZGVmaW5pdGlvbn0uXG4gKi9cbmNsYXNzIHN0IHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IHRpbWVzdGFtcC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBzZWNvbmRzIC0gVGhlIG51bWJlciBvZiBzZWNvbmRzIG9mIFVUQyB0aW1lIHNpbmNlIFVuaXggZXBvY2hcbiAgICAgKiAgICAgMTk3MC0wMS0wMVQwMDowMDowMFouIE11c3QgYmUgZnJvbSAwMDAxLTAxLTAxVDAwOjAwOjAwWiB0b1xuICAgICAqICAgICA5OTk5LTEyLTMxVDIzOjU5OjU5WiBpbmNsdXNpdmUuXG4gICAgICogQHBhcmFtIG5hbm9zZWNvbmRzIC0gVGhlIG5vbi1uZWdhdGl2ZSBmcmFjdGlvbnMgb2YgYSBzZWNvbmQgYXQgbmFub3NlY29uZFxuICAgICAqICAgICByZXNvbHV0aW9uLiBOZWdhdGl2ZSBzZWNvbmQgdmFsdWVzIHdpdGggZnJhY3Rpb25zIG11c3Qgc3RpbGwgaGF2ZVxuICAgICAqICAgICBub24tbmVnYXRpdmUgbmFub3NlY29uZHMgdmFsdWVzIHRoYXQgY291bnQgZm9yd2FyZCBpbiB0aW1lLiBNdXN0IGJlXG4gICAgICogICAgIGZyb20gMCB0byA5OTksOTk5LDk5OSBpbmNsdXNpdmUuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoXG4gICAgLyoqXG4gICAgICogVGhlIG51bWJlciBvZiBzZWNvbmRzIG9mIFVUQyB0aW1lIHNpbmNlIFVuaXggZXBvY2ggMTk3MC0wMS0wMVQwMDowMDowMFouXG4gICAgICovXG4gICAgdCwgXG4gICAgLyoqXG4gICAgICogVGhlIGZyYWN0aW9ucyBvZiBhIHNlY29uZCBhdCBuYW5vc2Vjb25kIHJlc29sdXRpb24uKlxuICAgICAqL1xuICAgIGUpIHtcbiAgICAgICAgaWYgKHRoaXMuc2Vjb25kcyA9IHQsIHRoaXMubmFub3NlY29uZHMgPSBlLCBlIDwgMCkgdGhyb3cgbmV3IEsocS5JTlZBTElEX0FSR1VNRU5ULCBcIlRpbWVzdGFtcCBuYW5vc2Vjb25kcyBvdXQgb2YgcmFuZ2U6IFwiICsgZSk7XG4gICAgICAgIGlmIChlID49IDFlOSkgdGhyb3cgbmV3IEsocS5JTlZBTElEX0FSR1VNRU5ULCBcIlRpbWVzdGFtcCBuYW5vc2Vjb25kcyBvdXQgb2YgcmFuZ2U6IFwiICsgZSk7XG4gICAgICAgIGlmICh0IDwgLTYyMTM1NTk2ODAwKSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIFwiVGltZXN0YW1wIHNlY29uZHMgb3V0IG9mIHJhbmdlOiBcIiArIHQpO1xuICAgICAgICAvLyBUaGlzIHdpbGwgYnJlYWsgaW4gdGhlIHllYXIgMTAsMDAwLlxuICAgICAgICAgICAgICAgIGlmICh0ID49IDI1MzQwMjMwMDgwMCkgdGhyb3cgbmV3IEsocS5JTlZBTElEX0FSR1VNRU5ULCBcIlRpbWVzdGFtcCBzZWNvbmRzIG91dCBvZiByYW5nZTogXCIgKyB0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyB0aW1lc3RhbXAgd2l0aCB0aGUgY3VycmVudCBkYXRlLCB3aXRoIG1pbGxpc2Vjb25kIHByZWNpc2lvbi5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIGEgbmV3IHRpbWVzdGFtcCByZXByZXNlbnRpbmcgdGhlIGN1cnJlbnQgZGF0ZS5cbiAgICAgKi8gICAgc3RhdGljIG5vdygpIHtcbiAgICAgICAgcmV0dXJuIHN0LmZyb21NaWxsaXMoRGF0ZS5ub3coKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgdGltZXN0YW1wIGZyb20gdGhlIGdpdmVuIGRhdGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZGF0ZSAtIFRoZSBkYXRlIHRvIGluaXRpYWxpemUgdGhlIGBUaW1lc3RhbXBgIGZyb20uXG4gICAgICogQHJldHVybnMgQSBuZXcgYFRpbWVzdGFtcGAgcmVwcmVzZW50aW5nIHRoZSBzYW1lIHBvaW50IGluIHRpbWUgYXMgdGhlIGdpdmVuXG4gICAgICogICAgIGRhdGUuXG4gICAgICovICAgIHN0YXRpYyBmcm9tRGF0ZSh0KSB7XG4gICAgICAgIHJldHVybiBzdC5mcm9tTWlsbGlzKHQuZ2V0VGltZSgpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyB0aW1lc3RhbXAgZnJvbSB0aGUgZ2l2ZW4gbnVtYmVyIG9mIG1pbGxpc2Vjb25kcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBtaWxsaXNlY29uZHMgLSBOdW1iZXIgb2YgbWlsbGlzZWNvbmRzIHNpbmNlIFVuaXggZXBvY2hcbiAgICAgKiAgICAgMTk3MC0wMS0wMVQwMDowMDowMFouXG4gICAgICogQHJldHVybnMgQSBuZXcgYFRpbWVzdGFtcGAgcmVwcmVzZW50aW5nIHRoZSBzYW1lIHBvaW50IGluIHRpbWUgYXMgdGhlIGdpdmVuXG4gICAgICogICAgIG51bWJlciBvZiBtaWxsaXNlY29uZHMuXG4gICAgICovICAgIHN0YXRpYyBmcm9tTWlsbGlzKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IE1hdGguZmxvb3IodCAvIDFlMyksIG4gPSBNYXRoLmZsb29yKDFlNiAqICh0IC0gMWUzICogZSkpO1xuICAgICAgICByZXR1cm4gbmV3IHN0KGUsIG4pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0cyBhIGBUaW1lc3RhbXBgIHRvIGEgSmF2YVNjcmlwdCBgRGF0ZWAgb2JqZWN0LiBUaGlzIGNvbnZlcnNpb25cbiAgICAgKiBjYXVzZXMgYSBsb3NzIG9mIHByZWNpc2lvbiBzaW5jZSBgRGF0ZWAgb2JqZWN0cyBvbmx5IHN1cHBvcnQgbWlsbGlzZWNvbmRcbiAgICAgKiBwcmVjaXNpb24uXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBKYXZhU2NyaXB0IGBEYXRlYCBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSBzYW1lIHBvaW50IGluIHRpbWUgYXNcbiAgICAgKiAgICAgdGhpcyBgVGltZXN0YW1wYCwgd2l0aCBtaWxsaXNlY29uZCBwcmVjaXNpb24uXG4gICAgICovICAgIHRvRGF0ZSgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBEYXRlKHRoaXMudG9NaWxsaXMoKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENvbnZlcnRzIGEgYFRpbWVzdGFtcGAgdG8gYSBudW1lcmljIHRpbWVzdGFtcCAoaW4gbWlsbGlzZWNvbmRzIHNpbmNlXG4gICAgICogZXBvY2gpLiBUaGlzIG9wZXJhdGlvbiBjYXVzZXMgYSBsb3NzIG9mIHByZWNpc2lvbi5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIFRoZSBwb2ludCBpbiB0aW1lIGNvcnJlc3BvbmRpbmcgdG8gdGhpcyB0aW1lc3RhbXAsIHJlcHJlc2VudGVkIGFzXG4gICAgICogICAgIHRoZSBudW1iZXIgb2YgbWlsbGlzZWNvbmRzIHNpbmNlIFVuaXggZXBvY2ggMTk3MC0wMS0wMVQwMDowMDowMFouXG4gICAgICovICAgIHRvTWlsbGlzKCkge1xuICAgICAgICByZXR1cm4gMWUzICogdGhpcy5zZWNvbmRzICsgdGhpcy5uYW5vc2Vjb25kcyAvIDFlNjtcbiAgICB9XG4gICAgX2NvbXBhcmVUbyh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNlY29uZHMgPT09IHQuc2Vjb25kcyA/IHR0KHRoaXMubmFub3NlY29uZHMsIHQubmFub3NlY29uZHMpIDogdHQodGhpcy5zZWNvbmRzLCB0LnNlY29uZHMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhpcyBgVGltZXN0YW1wYCBpcyBlcXVhbCB0byB0aGUgcHJvdmlkZWQgb25lLlxuICAgICAqXG4gICAgICogQHBhcmFtIG90aGVyIC0gVGhlIGBUaW1lc3RhbXBgIHRvIGNvbXBhcmUgYWdhaW5zdC5cbiAgICAgKiBAcmV0dXJucyB0cnVlIGlmIHRoaXMgYFRpbWVzdGFtcGAgaXMgZXF1YWwgdG8gdGhlIHByb3ZpZGVkIG9uZS5cbiAgICAgKi8gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIHJldHVybiB0LnNlY29uZHMgPT09IHRoaXMuc2Vjb25kcyAmJiB0Lm5hbm9zZWNvbmRzID09PSB0aGlzLm5hbm9zZWNvbmRzO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyBhIHRleHR1YWwgcmVwcmVzZW50YXRpb24gb2YgdGhpcyBgVGltZXN0YW1wYC4gKi8gICAgdG9TdHJpbmcoKSB7XG4gICAgICAgIHJldHVybiBcIlRpbWVzdGFtcChzZWNvbmRzPVwiICsgdGhpcy5zZWNvbmRzICsgXCIsIG5hbm9zZWNvbmRzPVwiICsgdGhpcy5uYW5vc2Vjb25kcyArIFwiKVwiO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyBhIEpTT04tc2VyaWFsaXphYmxlIHJlcHJlc2VudGF0aW9uIG9mIHRoaXMgYFRpbWVzdGFtcGAuICovICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHNlY29uZHM6IHRoaXMuc2Vjb25kcyxcbiAgICAgICAgICAgIG5hbm9zZWNvbmRzOiB0aGlzLm5hbm9zZWNvbmRzXG4gICAgICAgIH07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENvbnZlcnRzIHRoaXMgb2JqZWN0IHRvIGEgcHJpbWl0aXZlIHN0cmluZywgd2hpY2ggYWxsb3dzIGBUaW1lc3RhbXBgIG9iamVjdHNcbiAgICAgKiB0byBiZSBjb21wYXJlZCB1c2luZyB0aGUgYD5gLCBgPD1gLCBgPj1gIGFuZCBgPmAgb3BlcmF0b3JzLlxuICAgICAqLyAgICB2YWx1ZU9mKCkge1xuICAgICAgICAvLyBUaGlzIG1ldGhvZCByZXR1cm5zIGEgc3RyaW5nIG9mIHRoZSBmb3JtIDxzZWNvbmRzPi48bmFub3NlY29uZHM+IHdoZXJlXG4gICAgICAgIC8vIDxzZWNvbmRzPiBpcyB0cmFuc2xhdGVkIHRvIGhhdmUgYSBub24tbmVnYXRpdmUgdmFsdWUgYW5kIGJvdGggPHNlY29uZHM+XG4gICAgICAgIC8vIGFuZCA8bmFub3NlY29uZHM+IGFyZSBsZWZ0LXBhZGRlZCB3aXRoIHplcm9lcyB0byBiZSBhIGNvbnNpc3RlbnQgbGVuZ3RoLlxuICAgICAgICAvLyBTdHJpbmdzIHdpdGggdGhpcyBmb3JtYXQgdGhlbiBoYXZlIGEgbGV4aW9ncmFwaGljYWwgb3JkZXJpbmcgdGhhdCBtYXRjaGVzXG4gICAgICAgIC8vIHRoZSBleHBlY3RlZCBvcmRlcmluZy4gVGhlIDxzZWNvbmRzPiB0cmFuc2xhdGlvbiBpcyBkb25lIHRvIGF2b2lkIGhhdmluZ1xuICAgICAgICAvLyBhIGxlYWRpbmcgbmVnYXRpdmUgc2lnbiAoaS5lLiBhIGxlYWRpbmcgJy0nIGNoYXJhY3RlcikgaW4gaXRzIHN0cmluZ1xuICAgICAgICAvLyByZXByZXNlbnRhdGlvbiwgd2hpY2ggd291bGQgYWZmZWN0IGl0cyBsZXhpb2dyYXBoaWNhbCBvcmRlcmluZy5cbiAgICAgICAgY29uc3QgdCA9IHRoaXMuc2Vjb25kcyAtIC02MjEzNTU5NjgwMDtcbiAgICAgICAgLy8gTm90ZTogVXAgdG8gMTIgZGVjaW1hbCBkaWdpdHMgYXJlIHJlcXVpcmVkIHRvIHJlcHJlc2VudCBhbGwgdmFsaWRcbiAgICAgICAgLy8gJ3NlY29uZHMnIHZhbHVlcy5cbiAgICAgICAgICAgICAgICByZXR1cm4gU3RyaW5nKHQpLnBhZFN0YXJ0KDEyLCBcIjBcIikgKyBcIi5cIiArIFN0cmluZyh0aGlzLm5hbm9zZWNvbmRzKS5wYWRTdGFydCg5LCBcIjBcIik7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBIHZlcnNpb24gb2YgYSBkb2N1bWVudCBpbiBGaXJlc3RvcmUuIFRoaXMgY29ycmVzcG9uZHMgdG8gdGhlIHZlcnNpb25cbiAqIHRpbWVzdGFtcCwgc3VjaCBhcyB1cGRhdGVfdGltZSBvciByZWFkX3RpbWUuXG4gKi8gY2xhc3MgaXQge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy50aW1lc3RhbXAgPSB0O1xuICAgIH1cbiAgICBzdGF0aWMgZnJvbVRpbWVzdGFtcCh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgaXQodCk7XG4gICAgfVxuICAgIHN0YXRpYyBtaW4oKSB7XG4gICAgICAgIHJldHVybiBuZXcgaXQobmV3IHN0KDAsIDApKTtcbiAgICB9XG4gICAgY29tcGFyZVRvKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudGltZXN0YW1wLl9jb21wYXJlVG8odC50aW1lc3RhbXApO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudGltZXN0YW1wLmlzRXF1YWwodC50aW1lc3RhbXApO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyBhIG51bWJlciByZXByZXNlbnRhdGlvbiBvZiB0aGUgdmVyc2lvbiBmb3IgdXNlIGluIHNwZWMgdGVzdHMuICovICAgIHRvTWljcm9zZWNvbmRzKCkge1xuICAgICAgICAvLyBDb252ZXJ0IHRvIG1pY3Jvc2Vjb25kcy5cbiAgICAgICAgcmV0dXJuIDFlNiAqIHRoaXMudGltZXN0YW1wLnNlY29uZHMgKyB0aGlzLnRpbWVzdGFtcC5uYW5vc2Vjb25kcyAvIDFlMztcbiAgICB9XG4gICAgdG9TdHJpbmcoKSB7XG4gICAgICAgIHJldHVybiBcIlNuYXBzaG90VmVyc2lvbihcIiArIHRoaXMudGltZXN0YW1wLnRvU3RyaW5nKCkgKyBcIilcIjtcbiAgICB9XG4gICAgdG9UaW1lc3RhbXAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRpbWVzdGFtcDtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGZ1bmN0aW9uIHJ0KHQpIHtcbiAgICBsZXQgZSA9IDA7XG4gICAgZm9yIChjb25zdCBuIGluIHQpIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0LCBuKSAmJiBlKys7XG4gICAgcmV0dXJuIGU7XG59XG5cbmZ1bmN0aW9uIG90KHQsIGUpIHtcbiAgICBmb3IgKGNvbnN0IG4gaW4gdCkgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHQsIG4pICYmIGUobiwgdFtuXSk7XG59XG5cbmZ1bmN0aW9uIGF0KHQpIHtcbiAgICBmb3IgKGNvbnN0IGUgaW4gdCkgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0LCBlKSkgcmV0dXJuICExO1xuICAgIHJldHVybiAhMDtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUGF0aCByZXByZXNlbnRzIGFuIG9yZGVyZWQgc2VxdWVuY2Ugb2Ygc3RyaW5nIHNlZ21lbnRzLlxuICovXG5jbGFzcyBjdCB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbikge1xuICAgICAgICB2b2lkIDAgPT09IGUgPyBlID0gMCA6IGUgPiB0Lmxlbmd0aCAmJiBNKCksIHZvaWQgMCA9PT0gbiA/IG4gPSB0Lmxlbmd0aCAtIGUgOiBuID4gdC5sZW5ndGggLSBlICYmIE0oKSwgXG4gICAgICAgIHRoaXMuc2VnbWVudHMgPSB0LCB0aGlzLm9mZnNldCA9IGUsIHRoaXMubGVuID0gbjtcbiAgICB9XG4gICAgZ2V0IGxlbmd0aCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubGVuO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgcmV0dXJuIDAgPT09IGN0LmNvbXBhcmF0b3IodGhpcywgdCk7XG4gICAgfVxuICAgIGNoaWxkKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuc2VnbWVudHMuc2xpY2UodGhpcy5vZmZzZXQsIHRoaXMubGltaXQoKSk7XG4gICAgICAgIHJldHVybiB0IGluc3RhbmNlb2YgY3QgPyB0LmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgZS5wdXNoKHQpO1xuICAgICAgICB9KSkgOiBlLnB1c2godCksIHRoaXMuY29uc3RydWN0KGUpO1xuICAgIH1cbiAgICAvKiogVGhlIGluZGV4IG9mIG9uZSBwYXN0IHRoZSBsYXN0IHNlZ21lbnQgb2YgdGhlIHBhdGguICovICAgIGxpbWl0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5vZmZzZXQgKyB0aGlzLmxlbmd0aDtcbiAgICB9XG4gICAgcG9wRmlyc3QodCkge1xuICAgICAgICByZXR1cm4gdCA9IHZvaWQgMCA9PT0gdCA/IDEgOiB0LCB0aGlzLmNvbnN0cnVjdCh0aGlzLnNlZ21lbnRzLCB0aGlzLm9mZnNldCArIHQsIHRoaXMubGVuZ3RoIC0gdCk7XG4gICAgfVxuICAgIHBvcExhc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnN0cnVjdCh0aGlzLnNlZ21lbnRzLCB0aGlzLm9mZnNldCwgdGhpcy5sZW5ndGggLSAxKTtcbiAgICB9XG4gICAgZmlyc3RTZWdtZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zZWdtZW50c1t0aGlzLm9mZnNldF07XG4gICAgfVxuICAgIGxhc3RTZWdtZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXQodGhpcy5sZW5ndGggLSAxKTtcbiAgICB9XG4gICAgZ2V0KHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VnbWVudHNbdGhpcy5vZmZzZXQgKyB0XTtcbiAgICB9XG4gICAgaXNFbXB0eSgpIHtcbiAgICAgICAgcmV0dXJuIDAgPT09IHRoaXMubGVuZ3RoO1xuICAgIH1cbiAgICBpc1ByZWZpeE9mKHQpIHtcbiAgICAgICAgaWYgKHQubGVuZ3RoIDwgdGhpcy5sZW5ndGgpIHJldHVybiAhMTtcbiAgICAgICAgZm9yIChsZXQgZSA9IDA7IGUgPCB0aGlzLmxlbmd0aDsgZSsrKSBpZiAodGhpcy5nZXQoZSkgIT09IHQuZ2V0KGUpKSByZXR1cm4gITE7XG4gICAgICAgIHJldHVybiAhMDtcbiAgICB9XG4gICAgaXNJbW1lZGlhdGVQYXJlbnRPZih0KSB7XG4gICAgICAgIGlmICh0aGlzLmxlbmd0aCArIDEgIT09IHQubGVuZ3RoKSByZXR1cm4gITE7XG4gICAgICAgIGZvciAobGV0IGUgPSAwOyBlIDwgdGhpcy5sZW5ndGg7IGUrKykgaWYgKHRoaXMuZ2V0KGUpICE9PSB0LmdldChlKSkgcmV0dXJuICExO1xuICAgICAgICByZXR1cm4gITA7XG4gICAgfVxuICAgIGZvckVhY2godCkge1xuICAgICAgICBmb3IgKGxldCBlID0gdGhpcy5vZmZzZXQsIG4gPSB0aGlzLmxpbWl0KCk7IGUgPCBuOyBlKyspIHQodGhpcy5zZWdtZW50c1tlXSk7XG4gICAgfVxuICAgIHRvQXJyYXkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNlZ21lbnRzLnNsaWNlKHRoaXMub2Zmc2V0LCB0aGlzLmxpbWl0KCkpO1xuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyYXRvcih0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBNYXRoLm1pbih0Lmxlbmd0aCwgZS5sZW5ndGgpO1xuICAgICAgICBmb3IgKGxldCBzID0gMDsgcyA8IG47IHMrKykge1xuICAgICAgICAgICAgY29uc3QgbiA9IHQuZ2V0KHMpLCBpID0gZS5nZXQocyk7XG4gICAgICAgICAgICBpZiAobiA8IGkpIHJldHVybiAtMTtcbiAgICAgICAgICAgIGlmIChuID4gaSkgcmV0dXJuIDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHQubGVuZ3RoIDwgZS5sZW5ndGggPyAtMSA6IHQubGVuZ3RoID4gZS5sZW5ndGggPyAxIDogMDtcbiAgICB9XG59XG5cbi8qKlxuICogQSBzbGFzaC1zZXBhcmF0ZWQgcGF0aCBmb3IgbmF2aWdhdGluZyByZXNvdXJjZXMgKGRvY3VtZW50cyBhbmQgY29sbGVjdGlvbnMpXG4gKiB3aXRoaW4gRmlyZXN0b3JlLlxuICpcbiAqIEBpbnRlcm5hbFxuICovIGNsYXNzIHV0IGV4dGVuZHMgY3Qge1xuICAgIGNvbnN0cnVjdCh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiBuZXcgdXQodCwgZSwgbik7XG4gICAgfVxuICAgIGNhbm9uaWNhbFN0cmluZygpIHtcbiAgICAgICAgLy8gTk9URTogVGhlIGNsaWVudCBpcyBpZ25vcmFudCBvZiBhbnkgcGF0aCBzZWdtZW50cyBjb250YWluaW5nIGVzY2FwZVxuICAgICAgICAvLyBzZXF1ZW5jZXMgKGUuZy4gX19pZDEyM19fKSBhbmQganVzdCBwYXNzZXMgdGhlbSB0aHJvdWdoIHJhdyAodGhleSBleGlzdFxuICAgICAgICAvLyBmb3IgbGVnYWN5IHJlYXNvbnMgYW5kIHNob3VsZCBub3QgYmUgdXNlZCBmcmVxdWVudGx5KS5cbiAgICAgICAgcmV0dXJuIHRoaXMudG9BcnJheSgpLmpvaW4oXCIvXCIpO1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2Fub25pY2FsU3RyaW5nKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSByZXNvdXJjZSBwYXRoIGZyb20gdGhlIGdpdmVuIHNsYXNoLWRlbGltaXRlZCBzdHJpbmcuIElmIG11bHRpcGxlXG4gICAgICogYXJndW1lbnRzIGFyZSBwcm92aWRlZCwgYWxsIGNvbXBvbmVudHMgYXJlIGNvbWJpbmVkLiBMZWFkaW5nIGFuZCB0cmFpbGluZ1xuICAgICAqIHNsYXNoZXMgZnJvbSBhbGwgY29tcG9uZW50cyBhcmUgaWdub3JlZC5cbiAgICAgKi8gICAgc3RhdGljIGZyb21TdHJpbmcoLi4udCkge1xuICAgICAgICAvLyBOT1RFOiBUaGUgY2xpZW50IGlzIGlnbm9yYW50IG9mIGFueSBwYXRoIHNlZ21lbnRzIGNvbnRhaW5pbmcgZXNjYXBlXG4gICAgICAgIC8vIHNlcXVlbmNlcyAoZS5nLiBfX2lkMTIzX18pIGFuZCBqdXN0IHBhc3NlcyB0aGVtIHRocm91Z2ggcmF3ICh0aGV5IGV4aXN0XG4gICAgICAgIC8vIGZvciBsZWdhY3kgcmVhc29ucyBhbmQgc2hvdWxkIG5vdCBiZSB1c2VkIGZyZXF1ZW50bHkpLlxuICAgICAgICBjb25zdCBlID0gW107XG4gICAgICAgIGZvciAoY29uc3QgbiBvZiB0KSB7XG4gICAgICAgICAgICBpZiAobi5pbmRleE9mKFwiLy9cIikgPj0gMCkgdGhyb3cgbmV3IEsocS5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBzZWdtZW50ICgke259KS4gUGF0aHMgbXVzdCBub3QgY29udGFpbiAvLyBpbiB0aGVtLmApO1xuICAgICAgICAgICAgLy8gU3RyaXAgbGVhZGluZyBhbmQgdHJhbGluZyBzbGFzaGVkLlxuICAgICAgICAgICAgICAgICAgICAgICAgZS5wdXNoKC4uLm4uc3BsaXQoXCIvXCIpLmZpbHRlcigodCA9PiB0Lmxlbmd0aCA+IDApKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyB1dChlKTtcbiAgICB9XG4gICAgc3RhdGljIGVtcHR5UGF0aCgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyB1dChbXSk7XG4gICAgfVxufVxuXG5jb25zdCBodCA9IC9eW19hLXpBLVpdW19hLXpBLVowLTldKiQvO1xuXG4vKipcbiAqIEEgZG90LXNlcGFyYXRlZCBwYXRoIGZvciBuYXZpZ2F0aW5nIHN1Yi1vYmplY3RzIHdpdGhpbiBhIGRvY3VtZW50LlxuICogQGludGVybmFsXG4gKi8gY2xhc3MgbHQgZXh0ZW5kcyBjdCB7XG4gICAgY29uc3RydWN0KHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIG5ldyBsdCh0LCBlLCBuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHRoZSBzdHJpbmcgY291bGQgYmUgdXNlZCBhcyBhIHNlZ21lbnQgaW4gYSBmaWVsZCBwYXRoXG4gICAgICogd2l0aG91dCBlc2NhcGluZy5cbiAgICAgKi8gICAgc3RhdGljIGlzVmFsaWRJZGVudGlmaWVyKHQpIHtcbiAgICAgICAgcmV0dXJuIGh0LnRlc3QodCk7XG4gICAgfVxuICAgIGNhbm9uaWNhbFN0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudG9BcnJheSgpLm1hcCgodCA9PiAodCA9IHQucmVwbGFjZSgvXFxcXC9nLCBcIlxcXFxcXFxcXCIpLnJlcGxhY2UoL2AvZywgXCJcXFxcYFwiKSwgXG4gICAgICAgIGx0LmlzVmFsaWRJZGVudGlmaWVyKHQpIHx8ICh0ID0gXCJgXCIgKyB0ICsgXCJgXCIpLCB0KSkpLmpvaW4oXCIuXCIpO1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2Fub25pY2FsU3RyaW5nKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGlzIGZpZWxkIHJlZmVyZW5jZXMgdGhlIGtleSBvZiBhIGRvY3VtZW50LlxuICAgICAqLyAgICBpc0tleUZpZWxkKCkge1xuICAgICAgICByZXR1cm4gMSA9PT0gdGhpcy5sZW5ndGggJiYgXCJfX25hbWVfX1wiID09PSB0aGlzLmdldCgwKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIGZpZWxkIGRlc2lnbmF0aW5nIHRoZSBrZXkgb2YgYSBkb2N1bWVudC5cbiAgICAgKi8gICAgc3RhdGljIGtleUZpZWxkKCkge1xuICAgICAgICByZXR1cm4gbmV3IGx0KFsgXCJfX25hbWVfX1wiIF0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQYXJzZXMgYSBmaWVsZCBzdHJpbmcgZnJvbSB0aGUgZ2l2ZW4gc2VydmVyLWZvcm1hdHRlZCBzdHJpbmcuXG4gICAgICpcbiAgICAgKiAtIFNwbGl0dGluZyB0aGUgZW1wdHkgc3RyaW5nIGlzIG5vdCBhbGxvd2VkIChmb3Igbm93IGF0IGxlYXN0KS5cbiAgICAgKiAtIEVtcHR5IHNlZ21lbnRzIHdpdGhpbiB0aGUgc3RyaW5nIChlLmcuIGlmIHRoZXJlIGFyZSB0d28gY29uc2VjdXRpdmVcbiAgICAgKiAgIHNlcGFyYXRvcnMpIGFyZSBub3QgYWxsb3dlZC5cbiAgICAgKlxuICAgICAqIFRPRE8oYi8zNzI0NDE1Nyk6IHdlIHNob3VsZCBtYWtlIHRoaXMgbW9yZSBzdHJpY3QuIFJpZ2h0IG5vdywgaXQgYWxsb3dzXG4gICAgICogbm9uLWlkZW50aWZpZXIgcGF0aCBjb21wb25lbnRzLCBldmVuIGlmIHRoZXkgYXJlbid0IGVzY2FwZWQuXG4gICAgICovICAgIHN0YXRpYyBmcm9tU2VydmVyRm9ybWF0KHQpIHtcbiAgICAgICAgY29uc3QgZSA9IFtdO1xuICAgICAgICBsZXQgbiA9IFwiXCIsIHMgPSAwO1xuICAgICAgICBjb25zdCBpID0gKCkgPT4ge1xuICAgICAgICAgICAgaWYgKDAgPT09IG4ubGVuZ3RoKSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIGZpZWxkIHBhdGggKCR7dH0pLiBQYXRocyBtdXN0IG5vdCBiZSBlbXB0eSwgYmVnaW4gd2l0aCAnLicsIGVuZCB3aXRoICcuJywgb3IgY29udGFpbiAnLi4nYCk7XG4gICAgICAgICAgICBlLnB1c2gobiksIG4gPSBcIlwiO1xuICAgICAgICB9O1xuICAgICAgICBsZXQgciA9ICExO1xuICAgICAgICBmb3IgKDtzIDwgdC5sZW5ndGg7ICkge1xuICAgICAgICAgICAgY29uc3QgZSA9IHRbc107XG4gICAgICAgICAgICBpZiAoXCJcXFxcXCIgPT09IGUpIHtcbiAgICAgICAgICAgICAgICBpZiAocyArIDEgPT09IHQubGVuZ3RoKSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIFwiUGF0aCBoYXMgdHJhaWxpbmcgZXNjYXBlIGNoYXJhY3RlcjogXCIgKyB0KTtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdFtzICsgMV07XG4gICAgICAgICAgICAgICAgaWYgKFwiXFxcXFwiICE9PSBlICYmIFwiLlwiICE9PSBlICYmIFwiYFwiICE9PSBlKSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIFwiUGF0aCBoYXMgaW52YWxpZCBlc2NhcGUgc2VxdWVuY2U6IFwiICsgdCk7XG4gICAgICAgICAgICAgICAgbiArPSBlLCBzICs9IDI7XG4gICAgICAgICAgICB9IGVsc2UgXCJgXCIgPT09IGUgPyAociA9ICFyLCBzKyspIDogXCIuXCIgIT09IGUgfHwgciA/IChuICs9IGUsIHMrKykgOiAoaSgpLCBzKyspO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpKCksIHIpIHRocm93IG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgXCJVbnRlcm1pbmF0ZWQgYCBpbiBwYXRoOiBcIiArIHQpO1xuICAgICAgICByZXR1cm4gbmV3IGx0KGUpO1xuICAgIH1cbiAgICBzdGF0aWMgZW1wdHlQYXRoKCkge1xuICAgICAgICByZXR1cm4gbmV3IGx0KFtdKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFByb3ZpZGVzIGEgc2V0IG9mIGZpZWxkcyB0aGF0IGNhbiBiZSB1c2VkIHRvIHBhcnRpYWxseSBwYXRjaCBhIGRvY3VtZW50LlxuICogRmllbGRNYXNrIGlzIHVzZWQgaW4gY29uanVuY3Rpb24gd2l0aCBPYmplY3RWYWx1ZS5cbiAqIEV4YW1wbGVzOlxuICogICBmb28gLSBPdmVyd3JpdGVzIGZvbyBlbnRpcmVseSB3aXRoIHRoZSBwcm92aWRlZCB2YWx1ZS4gSWYgZm9vIGlzIG5vdFxuICogICAgICAgICBwcmVzZW50IGluIHRoZSBjb21wYW5pb24gT2JqZWN0VmFsdWUsIHRoZSBmaWVsZCBpcyBkZWxldGVkLlxuICogICBmb28uYmFyIC0gT3ZlcndyaXRlcyBvbmx5IHRoZSBmaWVsZCBiYXIgb2YgdGhlIG9iamVjdCBmb28uXG4gKiAgICAgICAgICAgICBJZiBmb28gaXMgbm90IGFuIG9iamVjdCwgZm9vIGlzIHJlcGxhY2VkIHdpdGggYW4gb2JqZWN0XG4gKiAgICAgICAgICAgICBjb250YWluaW5nIGZvb1xuICovIGNsYXNzIGZ0IHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMuZmllbGRzID0gdCwgXG4gICAgICAgIC8vIFRPRE8oZGltb25kKTogdmFsaWRhdGlvbiBvZiBGaWVsZE1hc2tcbiAgICAgICAgLy8gU29ydCB0aGUgZmllbGQgbWFzayB0byBzdXBwb3J0IGBGaWVsZE1hc2suaXNFcXVhbCgpYCBhbmQgYXNzZXJ0IGJlbG93LlxuICAgICAgICB0LnNvcnQobHQuY29tcGFyYXRvcik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFZlcmlmaWVzIHRoYXQgYGZpZWxkUGF0aGAgaXMgaW5jbHVkZWQgYnkgYXQgbGVhc3Qgb25lIGZpZWxkIGluIHRoaXMgZmllbGRcbiAgICAgKiBtYXNrLlxuICAgICAqXG4gICAgICogVGhpcyBpcyBhbiBPKG4pIG9wZXJhdGlvbiwgd2hlcmUgYG5gIGlzIHRoZSBzaXplIG9mIHRoZSBmaWVsZCBtYXNrLlxuICAgICAqLyAgICBjb3ZlcnModCkge1xuICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdGhpcy5maWVsZHMpIGlmIChlLmlzUHJlZml4T2YodCkpIHJldHVybiAhMDtcbiAgICAgICAgcmV0dXJuICExO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgcmV0dXJuIGV0KHRoaXMuZmllbGRzLCB0LmZpZWxkcywgKCh0LCBlKSA9PiB0LmlzRXF1YWwoZSkpKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKiogQ29udmVydHMgYSBCYXNlNjQgZW5jb2RlZCBzdHJpbmcgdG8gYSBiaW5hcnkgc3RyaW5nLiAqL1xuLyoqIFRydWUgaWYgYW5kIG9ubHkgaWYgdGhlIEJhc2U2NCBjb252ZXJzaW9uIGZ1bmN0aW9ucyBhcmUgYXZhaWxhYmxlLiAqL1xuZnVuY3Rpb24gZHQoKSB7XG4gICAgcmV0dXJuIFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIGF0b2I7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEltbXV0YWJsZSBjbGFzcyB0aGF0IHJlcHJlc2VudHMgYSBcInByb3RvXCIgYnl0ZSBzdHJpbmcuXG4gKlxuICogUHJvdG8gYnl0ZSBzdHJpbmdzIGNhbiBlaXRoZXIgYmUgQmFzZTY0LWVuY29kZWQgc3RyaW5ncyBvciBVaW50OEFycmF5cyB3aGVuXG4gKiBzZW50IG9uIHRoZSB3aXJlLiBUaGlzIGNsYXNzIGFic3RyYWN0cyBhd2F5IHRoaXMgZGlmZmVyZW50aWF0aW9uIGJ5IGhvbGRpbmdcbiAqIHRoZSBwcm90byBieXRlIHN0cmluZyBpbiBhIGNvbW1vbiBjbGFzcyB0aGF0IG11c3QgYmUgY29udmVydGVkIGludG8gYSBzdHJpbmdcbiAqIGJlZm9yZSBiZWluZyBzZW50IGFzIGEgcHJvdG8uXG4gKiBAaW50ZXJuYWxcbiAqLyBjbGFzcyB3dCB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLmJpbmFyeVN0cmluZyA9IHQ7XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tQmFzZTY0U3RyaW5nKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IGF0b2IodCk7XG4gICAgICAgIHJldHVybiBuZXcgd3QoZSk7XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tVWludDhBcnJheSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBcbiAgICAgICAgLyoqXG4gKiBIZWxwZXIgZnVuY3Rpb24gdG8gY29udmVydCBhbiBVaW50OGFycmF5IHRvIGEgYmluYXJ5IHN0cmluZy5cbiAqL1xuICAgICAgICBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICBsZXQgZSA9IFwiXCI7XG4gICAgICAgICAgICBmb3IgKGxldCBuID0gMDsgbiA8IHQubGVuZ3RoOyArK24pIGUgKz0gU3RyaW5nLmZyb21DaGFyQ29kZSh0W25dKTtcbiAgICAgICAgICAgIHJldHVybiBlO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICogSGVscGVyIGZ1bmN0aW9uIHRvIGNvbnZlcnQgYSBiaW5hcnkgc3RyaW5nIHRvIGFuIFVpbnQ4QXJyYXkuXG4gKi8gKHQpO1xuICAgICAgICByZXR1cm4gbmV3IHd0KGUpO1xuICAgIH1cbiAgICB0b0Jhc2U2NCgpIHtcbiAgICAgICAgcmV0dXJuIHQgPSB0aGlzLmJpbmFyeVN0cmluZywgYnRvYSh0KTtcbiAgICAgICAgLyoqIENvbnZlcnRzIGEgYmluYXJ5IHN0cmluZyB0byBhIEJhc2U2NCBlbmNvZGVkIHN0cmluZy4gKi9cbiAgICAgICAgdmFyIHQ7XG4gICAgfVxuICAgIHRvVWludDhBcnJheSgpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSBuZXcgVWludDhBcnJheSh0Lmxlbmd0aCk7XG4gICAgICAgICAgICBmb3IgKGxldCBuID0gMDsgbiA8IHQubGVuZ3RoOyBuKyspIGVbbl0gPSB0LmNoYXJDb2RlQXQobik7XG4gICAgICAgICAgICByZXR1cm4gZTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuICAgICAgICAvLyBBIFJlZ0V4cCBtYXRjaGluZyBJU08gODYwMSBVVEMgdGltZXN0YW1wcyB3aXRoIG9wdGlvbmFsIGZyYWN0aW9uLlxuICAgICAgICAodGhpcy5iaW5hcnlTdHJpbmcpO1xuICAgIH1cbiAgICBhcHByb3hpbWF0ZUJ5dGVTaXplKCkge1xuICAgICAgICByZXR1cm4gMiAqIHRoaXMuYmluYXJ5U3RyaW5nLmxlbmd0aDtcbiAgICB9XG4gICAgY29tcGFyZVRvKHQpIHtcbiAgICAgICAgcmV0dXJuIHR0KHRoaXMuYmluYXJ5U3RyaW5nLCB0LmJpbmFyeVN0cmluZyk7XG4gICAgfVxuICAgIGlzRXF1YWwodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5iaW5hcnlTdHJpbmcgPT09IHQuYmluYXJ5U3RyaW5nO1xuICAgIH1cbn1cblxud3QuRU1QVFlfQllURV9TVFJJTkcgPSBuZXcgd3QoXCJcIik7XG5cbmNvbnN0IF90ID0gbmV3IFJlZ0V4cCgvXlxcZHs0fS1cXGRcXGQtXFxkXFxkVFxcZFxcZDpcXGRcXGQ6XFxkXFxkKD86XFwuKFxcZCspKT9aJC8pO1xuXG4vKipcbiAqIENvbnZlcnRzIHRoZSBwb3NzaWJsZSBQcm90byB2YWx1ZXMgZm9yIGEgdGltZXN0YW1wIHZhbHVlIGludG8gYSBcInNlY29uZHMgYW5kXG4gKiBuYW5vc1wiIHJlcHJlc2VudGF0aW9uLlxuICovIGZ1bmN0aW9uIG10KHQpIHtcbiAgICAvLyBUaGUganNvbiBpbnRlcmZhY2UgKGZvciB0aGUgYnJvd3Nlcikgd2lsbCByZXR1cm4gYW4gaXNvIHRpbWVzdGFtcCBzdHJpbmcsXG4gICAgLy8gd2hpbGUgdGhlIHByb3RvIGpzIGxpYnJhcnkgKGZvciBub2RlKSB3aWxsIHJldHVybiBhXG4gICAgLy8gZ29vZ2xlLnByb3RvYnVmLlRpbWVzdGFtcCBpbnN0YW5jZS5cbiAgICBpZiAoTCghIXQpLCBcInN0cmluZ1wiID09IHR5cGVvZiB0KSB7XG4gICAgICAgIC8vIFRoZSBkYXRlIHN0cmluZyBjYW4gaGF2ZSBoaWdoZXIgcHJlY2lzaW9uIChuYW5vcykgdGhhbiB0aGUgRGF0ZSBjbGFzc1xuICAgICAgICAvLyAobWlsbGlzKSwgc28gd2UgZG8gc29tZSBjdXN0b20gcGFyc2luZyBoZXJlLlxuICAgICAgICAvLyBQYXJzZSB0aGUgbmFub3MgcmlnaHQgb3V0IG9mIHRoZSBzdHJpbmcuXG4gICAgICAgIGxldCBlID0gMDtcbiAgICAgICAgY29uc3QgbiA9IF90LmV4ZWModCk7XG4gICAgICAgIGlmIChMKCEhbiksIG5bMV0pIHtcbiAgICAgICAgICAgIC8vIFBhZCB0aGUgZnJhY3Rpb24gb3V0IHRvIDkgZGlnaXRzIChuYW5vcykuXG4gICAgICAgICAgICBsZXQgdCA9IG5bMV07XG4gICAgICAgICAgICB0ID0gKHQgKyBcIjAwMDAwMDAwMFwiKS5zdWJzdHIoMCwgOSksIGUgPSBOdW1iZXIodCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gUGFyc2UgdGhlIGRhdGUgdG8gZ2V0IHRoZSBzZWNvbmRzLlxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBuZXcgRGF0ZSh0KTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHNlY29uZHM6IE1hdGguZmxvb3Iocy5nZXRUaW1lKCkgLyAxZTMpLFxuICAgICAgICAgICAgbmFub3M6IGVcbiAgICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgc2Vjb25kczogZ3QodC5zZWNvbmRzKSxcbiAgICAgICAgbmFub3M6IGd0KHQubmFub3MpXG4gICAgfTtcbn1cblxuLyoqXG4gKiBDb252ZXJ0cyB0aGUgcG9zc2libGUgUHJvdG8gdHlwZXMgZm9yIG51bWJlcnMgaW50byBhIEphdmFTY3JpcHQgbnVtYmVyLlxuICogUmV0dXJucyAwIGlmIHRoZSB2YWx1ZSBpcyBub3QgbnVtZXJpYy5cbiAqLyBmdW5jdGlvbiBndCh0KSB7XG4gICAgLy8gVE9ETyhiam9ybmljayk6IEhhbmRsZSBpbnQ2NCBncmVhdGVyIHRoYW4gNTMgYml0cy5cbiAgICByZXR1cm4gXCJudW1iZXJcIiA9PSB0eXBlb2YgdCA/IHQgOiBcInN0cmluZ1wiID09IHR5cGVvZiB0ID8gTnVtYmVyKHQpIDogMDtcbn1cblxuLyoqIENvbnZlcnRzIHRoZSBwb3NzaWJsZSBQcm90byB0eXBlcyBmb3IgQmxvYnMgaW50byBhIEJ5dGVTdHJpbmcuICovIGZ1bmN0aW9uIHl0KHQpIHtcbiAgICByZXR1cm4gXCJzdHJpbmdcIiA9PSB0eXBlb2YgdCA/IHd0LmZyb21CYXNlNjRTdHJpbmcodCkgOiB3dC5mcm9tVWludDhBcnJheSh0KTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUmVwcmVzZW50cyBhIGxvY2FsbHktYXBwbGllZCBTZXJ2ZXJUaW1lc3RhbXAuXG4gKlxuICogU2VydmVyIFRpbWVzdGFtcHMgYXJlIGJhY2tlZCBieSBNYXBWYWx1ZXMgdGhhdCBjb250YWluIGFuIGludGVybmFsIGZpZWxkXG4gKiBgX190eXBlX19gIHdpdGggYSB2YWx1ZSBvZiBgc2VydmVyX3RpbWVzdGFtcGAuIFRoZSBwcmV2aW91cyB2YWx1ZSBhbmQgbG9jYWxcbiAqIHdyaXRlIHRpbWUgYXJlIHN0b3JlZCBpbiBpdHMgYF9fcHJldmlvdXNfdmFsdWVfX2AgYW5kIGBfX2xvY2FsX3dyaXRlX3RpbWVfX2BcbiAqIGZpZWxkcyByZXNwZWN0aXZlbHkuXG4gKlxuICogTm90ZXM6XG4gKiAtIFNlcnZlclRpbWVzdGFtcFZhbHVlIGluc3RhbmNlcyBhcmUgY3JlYXRlZCBhcyB0aGUgcmVzdWx0IG9mIGFwcGx5aW5nIGFcbiAqICAgdHJhbnNmb3JtLiBUaGV5IGNhbiBvbmx5IGV4aXN0IGluIHRoZSBsb2NhbCB2aWV3IG9mIGEgZG9jdW1lbnQuIFRoZXJlZm9yZVxuICogICB0aGV5IGRvIG5vdCBuZWVkIHRvIGJlIHBhcnNlZCBvciBzZXJpYWxpemVkLlxuICogLSBXaGVuIGV2YWx1YXRlZCBsb2NhbGx5IChlLmcuIGZvciBzbmFwc2hvdC5kYXRhKCkpLCB0aGV5IGJ5IGRlZmF1bHRcbiAqICAgZXZhbHVhdGUgdG8gYG51bGxgLiBUaGlzIGJlaGF2aW9yIGNhbiBiZSBjb25maWd1cmVkIGJ5IHBhc3NpbmcgY3VzdG9tXG4gKiAgIEZpZWxkVmFsdWVPcHRpb25zIHRvIHZhbHVlKCkuXG4gKiAtIFdpdGggcmVzcGVjdCB0byBvdGhlciBTZXJ2ZXJUaW1lc3RhbXBWYWx1ZXMsIHRoZXkgc29ydCBieSB0aGVpclxuICogICBsb2NhbFdyaXRlVGltZS5cbiAqLyBmdW5jdGlvbiBwdCh0KSB7XG4gICAgdmFyIGUsIG47XG4gICAgcmV0dXJuIFwic2VydmVyX3RpbWVzdGFtcFwiID09PSAobnVsbCA9PT0gKG4gPSAoKG51bGwgPT09IChlID0gbnVsbCA9PSB0ID8gdm9pZCAwIDogdC5tYXBWYWx1ZSkgfHwgdm9pZCAwID09PSBlID8gdm9pZCAwIDogZS5maWVsZHMpIHx8IHt9KS5fX3R5cGVfXykgfHwgdm9pZCAwID09PSBuID8gdm9pZCAwIDogbi5zdHJpbmdWYWx1ZSk7XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyBTZXJ2ZXJUaW1lc3RhbXAgcHJvdG8gdmFsdWUgKHVzaW5nIHRoZSBpbnRlcm5hbCBmb3JtYXQpLlxuICovXG4vKipcbiAqIFJldHVybnMgdGhlIHZhbHVlIG9mIHRoZSBmaWVsZCBiZWZvcmUgdGhpcyBTZXJ2ZXJUaW1lc3RhbXAgd2FzIHNldC5cbiAqXG4gKiBQcmVzZXJ2aW5nIHRoZSBwcmV2aW91cyB2YWx1ZXMgYWxsb3dzIHRoZSB1c2VyIHRvIGRpc3BsYXkgdGhlIGxhc3QgcmVzb2xlZFxuICogdmFsdWUgdW50aWwgdGhlIGJhY2tlbmQgcmVzcG9uZHMgd2l0aCB0aGUgdGltZXN0YW1wLlxuICovXG5mdW5jdGlvbiBFdCh0KSB7XG4gICAgY29uc3QgZSA9IHQubWFwVmFsdWUuZmllbGRzLl9fcHJldmlvdXNfdmFsdWVfXztcbiAgICByZXR1cm4gcHQoZSkgPyBFdChlKSA6IGU7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgbG9jYWwgdGltZSBhdCB3aGljaCB0aGlzIHRpbWVzdGFtcCB3YXMgZmlyc3Qgc2V0LlxuICovIGZ1bmN0aW9uIFR0KHQpIHtcbiAgICBjb25zdCBlID0gbXQodC5tYXBWYWx1ZS5maWVsZHMuX19sb2NhbF93cml0ZV90aW1lX18udGltZXN0YW1wVmFsdWUpO1xuICAgIHJldHVybiBuZXcgc3QoZS5zZWNvbmRzLCBlLm5hbm9zKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKiBTZW50aW5lbCB2YWx1ZSB0aGF0IHNvcnRzIGJlZm9yZSBhbnkgTXV0YXRpb24gQmF0Y2ggSUQuICovXG4vKipcbiAqIFJldHVybnMgd2hldGhlciBhIHZhcmlhYmxlIGlzIGVpdGhlciB1bmRlZmluZWQgb3IgbnVsbC5cbiAqL1xuZnVuY3Rpb24gSXQodCkge1xuICAgIHJldHVybiBudWxsID09IHQ7XG59XG5cbi8qKiBSZXR1cm5zIHdoZXRoZXIgdGhlIHZhbHVlIHJlcHJlc2VudHMgLTAuICovIGZ1bmN0aW9uIEF0KHQpIHtcbiAgICAvLyBEZXRlY3QgaWYgdGhlIHZhbHVlIGlzIC0wLjAuIEJhc2VkIG9uIHBvbHlmaWxsIGZyb21cbiAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9PYmplY3QvaXNcbiAgICByZXR1cm4gMCA9PT0gdCAmJiAxIC8gdCA9PSAtMSAvIDA7XG59XG5cbi8qKlxuICogUmV0dXJucyB3aGV0aGVyIGEgdmFsdWUgaXMgYW4gaW50ZWdlciBhbmQgaW4gdGhlIHNhZmUgaW50ZWdlciByYW5nZVxuICogQHBhcmFtIHZhbHVlIC0gVGhlIHZhbHVlIHRvIHRlc3QgZm9yIGJlaW5nIGFuIGludGVnZXIgYW5kIGluIHRoZSBzYWZlIHJhbmdlXG4gKi8gZnVuY3Rpb24gUnQodCkge1xuICAgIHJldHVybiBcIm51bWJlclwiID09IHR5cGVvZiB0ICYmIE51bWJlci5pc0ludGVnZXIodCkgJiYgIUF0KHQpICYmIHQgPD0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIgJiYgdCA+PSBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUjtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQGludGVybmFsXG4gKi8gY2xhc3MgUHQge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5wYXRoID0gdDtcbiAgICB9XG4gICAgc3RhdGljIGZyb21QYXRoKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQdCh1dC5mcm9tU3RyaW5nKHQpKTtcbiAgICB9XG4gICAgc3RhdGljIGZyb21OYW1lKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQdCh1dC5mcm9tU3RyaW5nKHQpLnBvcEZpcnN0KDUpKTtcbiAgICB9XG4gICAgLyoqIFJldHVybnMgdHJ1ZSBpZiB0aGUgZG9jdW1lbnQgaXMgaW4gdGhlIHNwZWNpZmllZCBjb2xsZWN0aW9uSWQuICovICAgIGhhc0NvbGxlY3Rpb25JZCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBhdGgubGVuZ3RoID49IDIgJiYgdGhpcy5wYXRoLmdldCh0aGlzLnBhdGgubGVuZ3RoIC0gMikgPT09IHQ7XG4gICAgfVxuICAgIGlzRXF1YWwodCkge1xuICAgICAgICByZXR1cm4gbnVsbCAhPT0gdCAmJiAwID09PSB1dC5jb21wYXJhdG9yKHRoaXMucGF0aCwgdC5wYXRoKTtcbiAgICB9XG4gICAgdG9TdHJpbmcoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBhdGgudG9TdHJpbmcoKTtcbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmF0b3IodCwgZSkge1xuICAgICAgICByZXR1cm4gdXQuY29tcGFyYXRvcih0LnBhdGgsIGUucGF0aCk7XG4gICAgfVxuICAgIHN0YXRpYyBpc0RvY3VtZW50S2V5KHQpIHtcbiAgICAgICAgcmV0dXJuIHQubGVuZ3RoICUgMiA9PSAwO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCByZXR1cm5zIGEgbmV3IGRvY3VtZW50IGtleSB3aXRoIHRoZSBnaXZlbiBzZWdtZW50cy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBzZWdtZW50cyAtIFRoZSBzZWdtZW50cyBvZiB0aGUgcGF0aCB0byB0aGUgZG9jdW1lbnRcbiAgICAgKiBAcmV0dXJucyBBIG5ldyBpbnN0YW5jZSBvZiBEb2N1bWVudEtleVxuICAgICAqLyAgICBzdGF0aWMgZnJvbVNlZ21lbnRzKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQdChuZXcgdXQodC5zbGljZSgpKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqIEV4dHJhY3RzIHRoZSBiYWNrZW5kJ3MgdHlwZSBvcmRlciBmb3IgdGhlIHByb3ZpZGVkIHZhbHVlLiAqLyBmdW5jdGlvbiBidCh0KSB7XG4gICAgcmV0dXJuIFwibnVsbFZhbHVlXCIgaW4gdCA/IDAgLyogTnVsbFZhbHVlICovIDogXCJib29sZWFuVmFsdWVcIiBpbiB0ID8gMSAvKiBCb29sZWFuVmFsdWUgKi8gOiBcImludGVnZXJWYWx1ZVwiIGluIHQgfHwgXCJkb3VibGVWYWx1ZVwiIGluIHQgPyAyIC8qIE51bWJlclZhbHVlICovIDogXCJ0aW1lc3RhbXBWYWx1ZVwiIGluIHQgPyAzIC8qIFRpbWVzdGFtcFZhbHVlICovIDogXCJzdHJpbmdWYWx1ZVwiIGluIHQgPyA1IC8qIFN0cmluZ1ZhbHVlICovIDogXCJieXRlc1ZhbHVlXCIgaW4gdCA/IDYgLyogQmxvYlZhbHVlICovIDogXCJyZWZlcmVuY2VWYWx1ZVwiIGluIHQgPyA3IC8qIFJlZlZhbHVlICovIDogXCJnZW9Qb2ludFZhbHVlXCIgaW4gdCA/IDggLyogR2VvUG9pbnRWYWx1ZSAqLyA6IFwiYXJyYXlWYWx1ZVwiIGluIHQgPyA5IC8qIEFycmF5VmFsdWUgKi8gOiBcIm1hcFZhbHVlXCIgaW4gdCA/IHB0KHQpID8gNCAvKiBTZXJ2ZXJUaW1lc3RhbXBWYWx1ZSAqLyA6IDEwIC8qIE9iamVjdFZhbHVlICovIDogTSgpO1xufVxuXG4vKiogVGVzdHMgYGxlZnRgIGFuZCBgcmlnaHRgIGZvciBlcXVhbGl0eSBiYXNlZCBvbiB0aGUgYmFja2VuZCBzZW1hbnRpY3MuICovIGZ1bmN0aW9uIHZ0KHQsIGUpIHtcbiAgICBjb25zdCBuID0gYnQodCk7XG4gICAgaWYgKG4gIT09IGJ0KGUpKSByZXR1cm4gITE7XG4gICAgc3dpdGNoIChuKSB7XG4gICAgICBjYXNlIDAgLyogTnVsbFZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuICEwO1xuXG4gICAgICBjYXNlIDEgLyogQm9vbGVhblZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIHQuYm9vbGVhblZhbHVlID09PSBlLmJvb2xlYW5WYWx1ZTtcblxuICAgICAgY2FzZSA0IC8qIFNlcnZlclRpbWVzdGFtcFZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIFR0KHQpLmlzRXF1YWwoVHQoZSkpO1xuXG4gICAgICBjYXNlIDMgLyogVGltZXN0YW1wVmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgaWYgKFwic3RyaW5nXCIgPT0gdHlwZW9mIHQudGltZXN0YW1wVmFsdWUgJiYgXCJzdHJpbmdcIiA9PSB0eXBlb2YgZS50aW1lc3RhbXBWYWx1ZSAmJiB0LnRpbWVzdGFtcFZhbHVlLmxlbmd0aCA9PT0gZS50aW1lc3RhbXBWYWx1ZS5sZW5ndGgpIFxuICAgICAgICAgICAgLy8gVXNlIHN0cmluZyBlcXVhbGl0eSBmb3IgSVNPIDg2MDEgdGltZXN0YW1wc1xuICAgICAgICAgICAgcmV0dXJuIHQudGltZXN0YW1wVmFsdWUgPT09IGUudGltZXN0YW1wVmFsdWU7XG4gICAgICAgICAgICBjb25zdCBuID0gbXQodC50aW1lc3RhbXBWYWx1ZSksIHMgPSBtdChlLnRpbWVzdGFtcFZhbHVlKTtcbiAgICAgICAgICAgIHJldHVybiBuLnNlY29uZHMgPT09IHMuc2Vjb25kcyAmJiBuLm5hbm9zID09PSBzLm5hbm9zO1xuICAgICAgICB9KHQsIGUpO1xuXG4gICAgICBjYXNlIDUgLyogU3RyaW5nVmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gdC5zdHJpbmdWYWx1ZSA9PT0gZS5zdHJpbmdWYWx1ZTtcblxuICAgICAgY2FzZSA2IC8qIEJsb2JWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICByZXR1cm4geXQodC5ieXRlc1ZhbHVlKS5pc0VxdWFsKHl0KGUuYnl0ZXNWYWx1ZSkpO1xuICAgICAgICB9KHQsIGUpO1xuXG4gICAgICBjYXNlIDcgLyogUmVmVmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gdC5yZWZlcmVuY2VWYWx1ZSA9PT0gZS5yZWZlcmVuY2VWYWx1ZTtcblxuICAgICAgY2FzZSA4IC8qIEdlb1BvaW50VmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgcmV0dXJuIGd0KHQuZ2VvUG9pbnRWYWx1ZS5sYXRpdHVkZSkgPT09IGd0KGUuZ2VvUG9pbnRWYWx1ZS5sYXRpdHVkZSkgJiYgZ3QodC5nZW9Qb2ludFZhbHVlLmxvbmdpdHVkZSkgPT09IGd0KGUuZ2VvUG9pbnRWYWx1ZS5sb25naXR1ZGUpO1xuICAgICAgICB9KHQsIGUpO1xuXG4gICAgICBjYXNlIDIgLyogTnVtYmVyVmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgaWYgKFwiaW50ZWdlclZhbHVlXCIgaW4gdCAmJiBcImludGVnZXJWYWx1ZVwiIGluIGUpIHJldHVybiBndCh0LmludGVnZXJWYWx1ZSkgPT09IGd0KGUuaW50ZWdlclZhbHVlKTtcbiAgICAgICAgICAgIGlmIChcImRvdWJsZVZhbHVlXCIgaW4gdCAmJiBcImRvdWJsZVZhbHVlXCIgaW4gZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBndCh0LmRvdWJsZVZhbHVlKSwgcyA9IGd0KGUuZG91YmxlVmFsdWUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBuID09PSBzID8gQXQobikgPT09IEF0KHMpIDogaXNOYU4obikgJiYgaXNOYU4ocyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gITE7XG4gICAgICAgIH0odCwgZSk7XG5cbiAgICAgIGNhc2UgOSAvKiBBcnJheVZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIGV0KHQuYXJyYXlWYWx1ZS52YWx1ZXMgfHwgW10sIGUuYXJyYXlWYWx1ZS52YWx1ZXMgfHwgW10sIHZ0KTtcblxuICAgICAgY2FzZSAxMCAvKiBPYmplY3RWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gdC5tYXBWYWx1ZS5maWVsZHMgfHwge30sIHMgPSBlLm1hcFZhbHVlLmZpZWxkcyB8fCB7fTtcbiAgICAgICAgICAgIGlmIChydChuKSAhPT0gcnQocykpIHJldHVybiAhMTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgdCBpbiBuKSBpZiAobi5oYXNPd25Qcm9wZXJ0eSh0KSAmJiAodm9pZCAwID09PSBzW3RdIHx8ICF2dChuW3RdLCBzW3RdKSkpIHJldHVybiAhMTtcbiAgICAgICAgICAgIHJldHVybiAhMDtcbiAgICAgICAgfVxuICAgICAgICAvKiogUmV0dXJucyB0cnVlIGlmIHRoZSBBcnJheVZhbHVlIGNvbnRhaW5zIHRoZSBzcGVjaWZpZWQgZWxlbWVudC4gKi8gKHQsIGUpO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gTSgpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gVnQodCwgZSkge1xuICAgIHJldHVybiB2b2lkIDAgIT09ICh0LnZhbHVlcyB8fCBbXSkuZmluZCgodCA9PiB2dCh0LCBlKSkpO1xufVxuXG5mdW5jdGlvbiBTdCh0LCBlKSB7XG4gICAgY29uc3QgbiA9IGJ0KHQpLCBzID0gYnQoZSk7XG4gICAgaWYgKG4gIT09IHMpIHJldHVybiB0dChuLCBzKTtcbiAgICBzd2l0Y2ggKG4pIHtcbiAgICAgIGNhc2UgMCAvKiBOdWxsVmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gMDtcblxuICAgICAgY2FzZSAxIC8qIEJvb2xlYW5WYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiB0dCh0LmJvb2xlYW5WYWx1ZSwgZS5ib29sZWFuVmFsdWUpO1xuXG4gICAgICBjYXNlIDIgLyogTnVtYmVyVmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgY29uc3QgbiA9IGd0KHQuaW50ZWdlclZhbHVlIHx8IHQuZG91YmxlVmFsdWUpLCBzID0gZ3QoZS5pbnRlZ2VyVmFsdWUgfHwgZS5kb3VibGVWYWx1ZSk7XG4gICAgICAgICAgICByZXR1cm4gbiA8IHMgPyAtMSA6IG4gPiBzID8gMSA6IG4gPT09IHMgPyAwIDogXG4gICAgICAgICAgICAvLyBvbmUgb3IgYm90aCBhcmUgTmFOLlxuICAgICAgICAgICAgaXNOYU4obikgPyBpc05hTihzKSA/IDAgOiAtMSA6IDE7XG4gICAgICAgIH0odCwgZSk7XG5cbiAgICAgIGNhc2UgMyAvKiBUaW1lc3RhbXBWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiBEdCh0LnRpbWVzdGFtcFZhbHVlLCBlLnRpbWVzdGFtcFZhbHVlKTtcblxuICAgICAgY2FzZSA0IC8qIFNlcnZlclRpbWVzdGFtcFZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIER0KFR0KHQpLCBUdChlKSk7XG5cbiAgICAgIGNhc2UgNSAvKiBTdHJpbmdWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiB0dCh0LnN0cmluZ1ZhbHVlLCBlLnN0cmluZ1ZhbHVlKTtcblxuICAgICAgY2FzZSA2IC8qIEJsb2JWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBjb25zdCBuID0geXQodCksIHMgPSB5dChlKTtcbiAgICAgICAgICAgIHJldHVybiBuLmNvbXBhcmVUbyhzKTtcbiAgICAgICAgfSh0LmJ5dGVzVmFsdWUsIGUuYnl0ZXNWYWx1ZSk7XG5cbiAgICAgIGNhc2UgNyAvKiBSZWZWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gdC5zcGxpdChcIi9cIiksIHMgPSBlLnNwbGl0KFwiL1wiKTtcbiAgICAgICAgICAgIGZvciAobGV0IHQgPSAwOyB0IDwgbi5sZW5ndGggJiYgdCA8IHMubGVuZ3RoOyB0KyspIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdHQoblt0XSwgc1t0XSk7XG4gICAgICAgICAgICAgICAgaWYgKDAgIT09IGUpIHJldHVybiBlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHR0KG4ubGVuZ3RoLCBzLmxlbmd0aCk7XG4gICAgICAgIH0odC5yZWZlcmVuY2VWYWx1ZSwgZS5yZWZlcmVuY2VWYWx1ZSk7XG5cbiAgICAgIGNhc2UgOCAvKiBHZW9Qb2ludFZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0dChndCh0LmxhdGl0dWRlKSwgZ3QoZS5sYXRpdHVkZSkpO1xuICAgICAgICAgICAgaWYgKDAgIT09IG4pIHJldHVybiBuO1xuICAgICAgICAgICAgcmV0dXJuIHR0KGd0KHQubG9uZ2l0dWRlKSwgZ3QoZS5sb25naXR1ZGUpKTtcbiAgICAgICAgfSh0Lmdlb1BvaW50VmFsdWUsIGUuZ2VvUG9pbnRWYWx1ZSk7XG5cbiAgICAgIGNhc2UgOSAvKiBBcnJheVZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0LnZhbHVlcyB8fCBbXSwgcyA9IGUudmFsdWVzIHx8IFtdO1xuICAgICAgICAgICAgZm9yIChsZXQgdCA9IDA7IHQgPCBuLmxlbmd0aCAmJiB0IDwgcy5sZW5ndGg7ICsrdCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBTdChuW3RdLCBzW3RdKTtcbiAgICAgICAgICAgICAgICBpZiAoZSkgcmV0dXJuIGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdHQobi5sZW5ndGgsIHMubGVuZ3RoKTtcbiAgICAgICAgfSh0LmFycmF5VmFsdWUsIGUuYXJyYXlWYWx1ZSk7XG5cbiAgICAgIGNhc2UgMTAgLyogT2JqZWN0VmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgY29uc3QgbiA9IHQuZmllbGRzIHx8IHt9LCBzID0gT2JqZWN0LmtleXMobiksIGkgPSBlLmZpZWxkcyB8fCB7fSwgciA9IE9iamVjdC5rZXlzKGkpO1xuICAgICAgICAgICAgLy8gRXZlbiB0aG91Z2ggTWFwVmFsdWVzIGFyZSBsaWtlbHkgc29ydGVkIGNvcnJlY3RseSBiYXNlZCBvbiB0aGVpciBpbnNlcnRpb25cbiAgICAgICAgICAgIC8vIG9yZGVyIChlLmcuIHdoZW4gcmVjZWl2ZWQgZnJvbSB0aGUgYmFja2VuZCksIGxvY2FsIG1vZGlmaWNhdGlvbnMgY2FuIGJyaW5nXG4gICAgICAgICAgICAvLyBlbGVtZW50cyBvdXQgb2Ygb3JkZXIuIFdlIG5lZWQgdG8gcmUtc29ydCB0aGUgZWxlbWVudHMgdG8gZW5zdXJlIHRoYXRcbiAgICAgICAgICAgIC8vIGNhbm9uaWNhbCBJRHMgYXJlIGluZGVwZW5kZW50IG9mIGluc2VydGlvbiBvcmRlci5cbiAgICAgICAgICAgIHMuc29ydCgpLCByLnNvcnQoKTtcbiAgICAgICAgICAgIGZvciAobGV0IHQgPSAwOyB0IDwgcy5sZW5ndGggJiYgdCA8IHIubGVuZ3RoOyArK3QpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdHQoc1t0XSwgclt0XSk7XG4gICAgICAgICAgICAgICAgaWYgKDAgIT09IGUpIHJldHVybiBlO1xuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBTdChuW3NbdF1dLCBpW3JbdF1dKTtcbiAgICAgICAgICAgICAgICBpZiAoMCAhPT0gbykgcmV0dXJuIG87XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdHQocy5sZW5ndGgsIHIubGVuZ3RoKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAqIEdlbmVyYXRlcyB0aGUgY2Fub25pY2FsIElEIGZvciB0aGUgcHJvdmlkZWQgZmllbGQgdmFsdWUgKGFzIHVzZWQgaW4gVGFyZ2V0XG4gKiBzZXJpYWxpemF0aW9uKS5cbiAqLyAodC5tYXBWYWx1ZSwgZS5tYXBWYWx1ZSk7XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHRocm93IE0oKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIER0KHQsIGUpIHtcbiAgICBpZiAoXCJzdHJpbmdcIiA9PSB0eXBlb2YgdCAmJiBcInN0cmluZ1wiID09IHR5cGVvZiBlICYmIHQubGVuZ3RoID09PSBlLmxlbmd0aCkgcmV0dXJuIHR0KHQsIGUpO1xuICAgIGNvbnN0IG4gPSBtdCh0KSwgcyA9IG10KGUpLCBpID0gdHQobi5zZWNvbmRzLCBzLnNlY29uZHMpO1xuICAgIHJldHVybiAwICE9PSBpID8gaSA6IHR0KG4ubmFub3MsIHMubmFub3MpO1xufVxuXG5mdW5jdGlvbiBDdCh0KSB7XG4gICAgcmV0dXJuIE50KHQpO1xufVxuXG5mdW5jdGlvbiBOdCh0KSB7XG4gICAgcmV0dXJuIFwibnVsbFZhbHVlXCIgaW4gdCA/IFwibnVsbFwiIDogXCJib29sZWFuVmFsdWVcIiBpbiB0ID8gXCJcIiArIHQuYm9vbGVhblZhbHVlIDogXCJpbnRlZ2VyVmFsdWVcIiBpbiB0ID8gXCJcIiArIHQuaW50ZWdlclZhbHVlIDogXCJkb3VibGVWYWx1ZVwiIGluIHQgPyBcIlwiICsgdC5kb3VibGVWYWx1ZSA6IFwidGltZXN0YW1wVmFsdWVcIiBpbiB0ID8gZnVuY3Rpb24odCkge1xuICAgICAgICBjb25zdCBlID0gbXQodCk7XG4gICAgICAgIHJldHVybiBgdGltZSgke2Uuc2Vjb25kc30sJHtlLm5hbm9zfSlgO1xuICAgIH0odC50aW1lc3RhbXBWYWx1ZSkgOiBcInN0cmluZ1ZhbHVlXCIgaW4gdCA/IHQuc3RyaW5nVmFsdWUgOiBcImJ5dGVzVmFsdWVcIiBpbiB0ID8geXQodC5ieXRlc1ZhbHVlKS50b0Jhc2U2NCgpIDogXCJyZWZlcmVuY2VWYWx1ZVwiIGluIHQgPyAobiA9IHQucmVmZXJlbmNlVmFsdWUsIFxuICAgIFB0LmZyb21OYW1lKG4pLnRvU3RyaW5nKCkpIDogXCJnZW9Qb2ludFZhbHVlXCIgaW4gdCA/IGBnZW8oJHsoZSA9IHQuZ2VvUG9pbnRWYWx1ZSkubGF0aXR1ZGV9LCR7ZS5sb25naXR1ZGV9KWAgOiBcImFycmF5VmFsdWVcIiBpbiB0ID8gZnVuY3Rpb24odCkge1xuICAgICAgICBsZXQgZSA9IFwiW1wiLCBuID0gITA7XG4gICAgICAgIGZvciAoY29uc3QgcyBvZiB0LnZhbHVlcyB8fCBbXSkgbiA/IG4gPSAhMSA6IGUgKz0gXCIsXCIsIGUgKz0gTnQocyk7XG4gICAgICAgIHJldHVybiBlICsgXCJdXCI7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIGEgcmVmZXJlbmNlIHZhbHVlIGZvciB0aGUgcHJvdmlkZWQgZGF0YWJhc2UgYW5kIGtleS4gKi8gKHQuYXJyYXlWYWx1ZSkgOiBcIm1hcFZhbHVlXCIgaW4gdCA/IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgLy8gSXRlcmF0aW9uIG9yZGVyIGluIEphdmFTY3JpcHQgaXMgbm90IGd1YXJhbnRlZWQuIFRvIGVuc3VyZSB0aGF0IHdlIGdlbmVyYXRlXG4gICAgICAgIC8vIG1hdGNoaW5nIGNhbm9uaWNhbCBJRHMgZm9yIGlkZW50aWNhbCBtYXBzLCB3ZSBuZWVkIHRvIHNvcnQgdGhlIGtleXMuXG4gICAgICAgIGNvbnN0IGUgPSBPYmplY3Qua2V5cyh0LmZpZWxkcyB8fCB7fSkuc29ydCgpO1xuICAgICAgICBsZXQgbiA9IFwie1wiLCBzID0gITA7XG4gICAgICAgIGZvciAoY29uc3QgaSBvZiBlKSBzID8gcyA9ICExIDogbiArPSBcIixcIiwgbiArPSBgJHtpfToke050KHQuZmllbGRzW2ldKX1gO1xuICAgICAgICByZXR1cm4gbiArIFwifVwiO1xuICAgIH0odC5tYXBWYWx1ZSkgOiBNKCk7XG4gICAgdmFyIGUsIG47XG59XG5cbmZ1bmN0aW9uIHh0KHQsIGUpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZWZlcmVuY2VWYWx1ZTogYHByb2plY3RzLyR7dC5wcm9qZWN0SWR9L2RhdGFiYXNlcy8ke3QuZGF0YWJhc2V9L2RvY3VtZW50cy8ke2UucGF0aC5jYW5vbmljYWxTdHJpbmcoKX1gXG4gICAgfTtcbn1cblxuLyoqIFJldHVybnMgdHJ1ZSBpZiBgdmFsdWVgIGlzIGFuIEludGVnZXJWYWx1ZSAuICovIGZ1bmN0aW9uIGt0KHQpIHtcbiAgICByZXR1cm4gISF0ICYmIFwiaW50ZWdlclZhbHVlXCIgaW4gdDtcbn1cblxuLyoqIFJldHVybnMgdHJ1ZSBpZiBgdmFsdWVgIGlzIGEgRG91YmxlVmFsdWUuICovXG4vKiogUmV0dXJucyB0cnVlIGlmIGB2YWx1ZWAgaXMgYW4gQXJyYXlWYWx1ZS4gKi9cbmZ1bmN0aW9uICR0KHQpIHtcbiAgICByZXR1cm4gISF0ICYmIFwiYXJyYXlWYWx1ZVwiIGluIHQ7XG59XG5cbi8qKiBSZXR1cm5zIHRydWUgaWYgYHZhbHVlYCBpcyBhIE51bGxWYWx1ZS4gKi8gZnVuY3Rpb24gT3QodCkge1xuICAgIHJldHVybiAhIXQgJiYgXCJudWxsVmFsdWVcIiBpbiB0O1xufVxuXG4vKiogUmV0dXJucyB0cnVlIGlmIGB2YWx1ZWAgaXMgTmFOLiAqLyBmdW5jdGlvbiBGdCh0KSB7XG4gICAgcmV0dXJuICEhdCAmJiBcImRvdWJsZVZhbHVlXCIgaW4gdCAmJiBpc05hTihOdW1iZXIodC5kb3VibGVWYWx1ZSkpO1xufVxuXG4vKiogUmV0dXJucyB0cnVlIGlmIGB2YWx1ZWAgaXMgYSBNYXBWYWx1ZS4gKi8gZnVuY3Rpb24gTXQodCkge1xuICAgIHJldHVybiAhIXQgJiYgXCJtYXBWYWx1ZVwiIGluIHQ7XG59XG5cbi8qKiBDcmVhdGVzIGEgZGVlcCBjb3B5IG9mIGBzb3VyY2VgLiAqLyBmdW5jdGlvbiBMdCh0KSB7XG4gICAgaWYgKHQuZ2VvUG9pbnRWYWx1ZSkgcmV0dXJuIHtcbiAgICAgICAgZ2VvUG9pbnRWYWx1ZTogT2JqZWN0LmFzc2lnbih7fSwgdC5nZW9Qb2ludFZhbHVlKVxuICAgIH07XG4gICAgaWYgKHQudGltZXN0YW1wVmFsdWUgJiYgXCJvYmplY3RcIiA9PSB0eXBlb2YgdC50aW1lc3RhbXBWYWx1ZSkgcmV0dXJuIHtcbiAgICAgICAgdGltZXN0YW1wVmFsdWU6IE9iamVjdC5hc3NpZ24oe30sIHQudGltZXN0YW1wVmFsdWUpXG4gICAgfTtcbiAgICBpZiAodC5tYXBWYWx1ZSkge1xuICAgICAgICBjb25zdCBlID0ge1xuICAgICAgICAgICAgbWFwVmFsdWU6IHtcbiAgICAgICAgICAgICAgICBmaWVsZHM6IHt9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBvdCh0Lm1hcFZhbHVlLmZpZWxkcywgKCh0LCBuKSA9PiBlLm1hcFZhbHVlLmZpZWxkc1t0XSA9IEx0KG4pKSksIGU7XG4gICAgfVxuICAgIGlmICh0LmFycmF5VmFsdWUpIHtcbiAgICAgICAgY29uc3QgZSA9IHtcbiAgICAgICAgICAgIGFycmF5VmFsdWU6IHtcbiAgICAgICAgICAgICAgICB2YWx1ZXM6IFtdXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgKHQuYXJyYXlWYWx1ZS52YWx1ZXMgfHwgW10pLmxlbmd0aDsgKytuKSBlLmFycmF5VmFsdWUudmFsdWVzW25dID0gTHQodC5hcnJheVZhbHVlLnZhbHVlc1tuXSk7XG4gICAgICAgIHJldHVybiBlO1xuICAgIH1cbiAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgdCk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEFuIE9iamVjdFZhbHVlIHJlcHJlc2VudHMgYSBNYXBWYWx1ZSBpbiB0aGUgRmlyZXN0b3JlIFByb3RvIGFuZCBvZmZlcnMgdGhlXG4gKiBhYmlsaXR5IHRvIGFkZCBhbmQgcmVtb3ZlIGZpZWxkcyAodmlhIHRoZSBPYmplY3RWYWx1ZUJ1aWxkZXIpLlxuICovIGNsYXNzIEJ0IHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMudmFsdWUgPSB0O1xuICAgIH1cbiAgICBzdGF0aWMgZW1wdHkoKSB7XG4gICAgICAgIHJldHVybiBuZXcgQnQoe1xuICAgICAgICAgICAgbWFwVmFsdWU6IHt9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSB2YWx1ZSBhdCB0aGUgZ2l2ZW4gcGF0aCBvciBudWxsLlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhdGggLSB0aGUgcGF0aCB0byBzZWFyY2hcbiAgICAgKiBAcmV0dXJucyBUaGUgdmFsdWUgYXQgdGhlIHBhdGggb3IgbnVsbCBpZiB0aGUgcGF0aCBpcyBub3Qgc2V0LlxuICAgICAqLyAgICBmaWVsZCh0KSB7XG4gICAgICAgIGlmICh0LmlzRW1wdHkoKSkgcmV0dXJuIHRoaXMudmFsdWU7XG4gICAgICAgIHtcbiAgICAgICAgICAgIGxldCBlID0gdGhpcy52YWx1ZTtcbiAgICAgICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgdC5sZW5ndGggLSAxOyArK24pIGlmIChlID0gKGUubWFwVmFsdWUuZmllbGRzIHx8IHt9KVt0LmdldChuKV0sIFxuICAgICAgICAgICAgIU10KGUpKSByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIHJldHVybiBlID0gKGUubWFwVmFsdWUuZmllbGRzIHx8IHt9KVt0Lmxhc3RTZWdtZW50KCldLCBlIHx8IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgZmllbGQgdG8gdGhlIHByb3ZpZGVkIHZhbHVlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhdGggLSBUaGUgZmllbGQgcGF0aCB0byBzZXQuXG4gICAgICogQHBhcmFtIHZhbHVlIC0gVGhlIHZhbHVlIHRvIHNldC5cbiAgICAgKi8gICAgc2V0KHQsIGUpIHtcbiAgICAgICAgdGhpcy5nZXRGaWVsZHNNYXAodC5wb3BMYXN0KCkpW3QubGFzdFNlZ21lbnQoKV0gPSBMdChlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgcHJvdmlkZWQgZmllbGRzIHRvIHRoZSBwcm92aWRlZCB2YWx1ZXMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZGF0YSAtIEEgbWFwIG9mIGZpZWxkcyB0byB2YWx1ZXMgKG9yIG51bGwgZm9yIGRlbGV0ZXMpLlxuICAgICAqLyAgICBzZXRBbGwodCkge1xuICAgICAgICBsZXQgZSA9IGx0LmVtcHR5UGF0aCgpLCBuID0ge30sIHMgPSBbXTtcbiAgICAgICAgdC5mb3JFYWNoKCgodCwgaSkgPT4ge1xuICAgICAgICAgICAgaWYgKCFlLmlzSW1tZWRpYXRlUGFyZW50T2YoaSkpIHtcbiAgICAgICAgICAgICAgICAvLyBJbnNlcnQgdGhlIGFjY3VtdWxhdGVkIGNoYW5nZXMgYXQgdGhpcyBwYXJlbnQgbG9jYXRpb25cbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5nZXRGaWVsZHNNYXAoZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHBseUNoYW5nZXModCwgbiwgcyksIG4gPSB7fSwgcyA9IFtdLCBlID0gaS5wb3BMYXN0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0ID8gbltpLmxhc3RTZWdtZW50KCldID0gTHQodCkgOiBzLnB1c2goaS5sYXN0U2VnbWVudCgpKTtcbiAgICAgICAgfSkpO1xuICAgICAgICBjb25zdCBpID0gdGhpcy5nZXRGaWVsZHNNYXAoZSk7XG4gICAgICAgIHRoaXMuYXBwbHlDaGFuZ2VzKGksIG4sIHMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIHRoZSBmaWVsZCBhdCB0aGUgc3BlY2lmaWVkIHBhdGguIElmIHRoZXJlIGlzIG5vIGZpZWxkIGF0IHRoZVxuICAgICAqIHNwZWNpZmllZCBwYXRoLCBub3RoaW5nIGlzIGNoYW5nZWQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGF0aCAtIFRoZSBmaWVsZCBwYXRoIHRvIHJlbW92ZS5cbiAgICAgKi8gICAgZGVsZXRlKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuZmllbGQodC5wb3BMYXN0KCkpO1xuICAgICAgICBNdChlKSAmJiBlLm1hcFZhbHVlLmZpZWxkcyAmJiBkZWxldGUgZS5tYXBWYWx1ZS5maWVsZHNbdC5sYXN0U2VnbWVudCgpXTtcbiAgICB9XG4gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIHJldHVybiB2dCh0aGlzLnZhbHVlLCB0LnZhbHVlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgbWFwIHRoYXQgY29udGFpbnMgdGhlIGxlYWYgZWxlbWVudCBvZiBgcGF0aGAuIElmIHRoZSBwYXJlbnRcbiAgICAgKiBlbnRyeSBkb2VzIG5vdCB5ZXQgZXhpc3QsIG9yIGlmIGl0IGlzIG5vdCBhIG1hcCwgYSBuZXcgbWFwIHdpbGwgYmUgY3JlYXRlZC5cbiAgICAgKi8gICAgZ2V0RmllbGRzTWFwKHQpIHtcbiAgICAgICAgbGV0IGUgPSB0aGlzLnZhbHVlO1xuICAgICAgICBlLm1hcFZhbHVlLmZpZWxkcyB8fCAoZS5tYXBWYWx1ZSA9IHtcbiAgICAgICAgICAgIGZpZWxkczoge31cbiAgICAgICAgfSk7XG4gICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgdC5sZW5ndGg7ICsrbikge1xuICAgICAgICAgICAgbGV0IHMgPSBlLm1hcFZhbHVlLmZpZWxkc1t0LmdldChuKV07XG4gICAgICAgICAgICBNdChzKSAmJiBzLm1hcFZhbHVlLmZpZWxkcyB8fCAocyA9IHtcbiAgICAgICAgICAgICAgICBtYXBWYWx1ZToge1xuICAgICAgICAgICAgICAgICAgICBmaWVsZHM6IHt9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgZS5tYXBWYWx1ZS5maWVsZHNbdC5nZXQobildID0gcyksIGUgPSBzO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBlLm1hcFZhbHVlLmZpZWxkcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogTW9kaWZpZXMgYGZpZWxkc01hcGAgYnkgYWRkaW5nLCByZXBsYWNpbmcgb3IgZGVsZXRpbmcgdGhlIHNwZWNpZmllZFxuICAgICAqIGVudHJpZXMuXG4gICAgICovICAgIGFwcGx5Q2hhbmdlcyh0LCBlLCBuKSB7XG4gICAgICAgIG90KGUsICgoZSwgbikgPT4gdFtlXSA9IG4pKTtcbiAgICAgICAgZm9yIChjb25zdCBlIG9mIG4pIGRlbGV0ZSB0W2VdO1xuICAgIH1cbiAgICBjbG9uZSgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBCdChMdCh0aGlzLnZhbHVlKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIFJldHVybnMgYSBGaWVsZE1hc2sgYnVpbHQgZnJvbSBhbGwgZmllbGRzIGluIGEgTWFwVmFsdWUuXG4gKi8gZnVuY3Rpb24gVXQodCkge1xuICAgIGNvbnN0IGUgPSBbXTtcbiAgICByZXR1cm4gb3QodC5maWVsZHMsICgodCwgbikgPT4ge1xuICAgICAgICBjb25zdCBzID0gbmV3IGx0KFsgdCBdKTtcbiAgICAgICAgaWYgKE10KG4pKSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gVXQobi5tYXBWYWx1ZSkuZmllbGRzO1xuICAgICAgICAgICAgaWYgKDAgPT09IHQubGVuZ3RoKSBcbiAgICAgICAgICAgIC8vIFByZXNlcnZlIHRoZSBlbXB0eSBtYXAgYnkgYWRkaW5nIGl0IHRvIHRoZSBGaWVsZE1hc2suXG4gICAgICAgICAgICBlLnB1c2gocyk7IGVsc2UgXG4gICAgICAgICAgICAvLyBGb3IgbmVzdGVkIGFuZCBub24tZW1wdHkgT2JqZWN0VmFsdWVzLCBhZGQgdGhlIEZpZWxkUGF0aCBvZiB0aGVcbiAgICAgICAgICAgIC8vIGxlYWYgbm9kZXMuXG4gICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgdCkgZS5wdXNoKHMuY2hpbGQobikpO1xuICAgICAgICB9IGVsc2UgXG4gICAgICAgIC8vIEZvciBuZXN0ZWQgYW5kIG5vbi1lbXB0eSBPYmplY3RWYWx1ZXMsIGFkZCB0aGUgRmllbGRQYXRoIG9mIHRoZSBsZWFmXG4gICAgICAgIC8vIG5vZGVzLlxuICAgICAgICBlLnB1c2gocyk7XG4gICAgfSkpLCBuZXcgZnQoZSk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFJlcHJlc2VudHMgYSBkb2N1bWVudCBpbiBGaXJlc3RvcmUgd2l0aCBhIGtleSwgdmVyc2lvbiwgZGF0YSBhbmQgd2hldGhlciBpdFxuICogaGFzIGxvY2FsIG11dGF0aW9ucyBhcHBsaWVkIHRvIGl0LlxuICpcbiAqIERvY3VtZW50cyBjYW4gdHJhbnNpdGlvbiBiZXR3ZWVuIHN0YXRlcyB2aWEgYGNvbnZlcnRUb0ZvdW5kRG9jdW1lbnQoKWAsXG4gKiBgY29udmVydFRvTm9Eb2N1bWVudCgpYCBhbmQgYGNvbnZlcnRUb1Vua25vd25Eb2N1bWVudCgpYC4gSWYgYSBkb2N1bWVudCBkb2VzXG4gKiBub3QgdHJhbnNpdGlvbiB0byBvbmUgb2YgdGhlc2Ugc3RhdGVzIGV2ZW4gYWZ0ZXIgYWxsIG11dGF0aW9ucyBoYXZlIGJlZW5cbiAqIGFwcGxpZWQsIGBpc1ZhbGlkRG9jdW1lbnQoKWAgcmV0dXJucyBmYWxzZSBhbmQgdGhlIGRvY3VtZW50IHNob3VsZCBiZSByZW1vdmVkXG4gKiBmcm9tIGFsbCB2aWV3cy5cbiAqLyBjbGFzcyBxdCB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcywgaSkge1xuICAgICAgICB0aGlzLmtleSA9IHQsIHRoaXMuZG9jdW1lbnRUeXBlID0gZSwgdGhpcy52ZXJzaW9uID0gbiwgdGhpcy5kYXRhID0gcywgdGhpcy5kb2N1bWVudFN0YXRlID0gaTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGRvY3VtZW50IHdpdGggbm8ga25vd24gdmVyc2lvbiBvciBkYXRhLCBidXQgd2hpY2ggY2FuIHNlcnZlIGFzXG4gICAgICogYmFzZSBkb2N1bWVudCBmb3IgbXV0YXRpb25zLlxuICAgICAqLyAgICBzdGF0aWMgbmV3SW52YWxpZERvY3VtZW50KHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBxdCh0LCAwIC8qIElOVkFMSUQgKi8gLCBpdC5taW4oKSwgQnQuZW1wdHkoKSwgMCAvKiBTWU5DRUQgKi8pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IGRvY3VtZW50IHRoYXQgaXMga25vd24gdG8gZXhpc3Qgd2l0aCB0aGUgZ2l2ZW4gZGF0YSBhdCB0aGVcbiAgICAgKiBnaXZlbiB2ZXJzaW9uLlxuICAgICAqLyAgICBzdGF0aWMgbmV3Rm91bmREb2N1bWVudCh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiBuZXcgcXQodCwgMSAvKiBGT1VORF9ET0NVTUVOVCAqLyAsIGUsIG4sIDAgLyogU1lOQ0VEICovKTtcbiAgICB9XG4gICAgLyoqIENyZWF0ZXMgYSBuZXcgZG9jdW1lbnQgdGhhdCBpcyBrbm93biB0byBub3QgZXhpc3QgYXQgdGhlIGdpdmVuIHZlcnNpb24uICovICAgIHN0YXRpYyBuZXdOb0RvY3VtZW50KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBxdCh0LCAyIC8qIE5PX0RPQ1VNRU5UICovICwgZSwgQnQuZW1wdHkoKSwgMCAvKiBTWU5DRUQgKi8pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IGRvY3VtZW50IHRoYXQgaXMga25vd24gdG8gZXhpc3QgYXQgdGhlIGdpdmVuIHZlcnNpb24gYnV0XG4gICAgICogd2hvc2UgZGF0YSBpcyBub3Qga25vd24gKGUuZy4gYSBkb2N1bWVudCB0aGF0IHdhcyB1cGRhdGVkIHdpdGhvdXQgYSBrbm93blxuICAgICAqIGJhc2UgZG9jdW1lbnQpLlxuICAgICAqLyAgICBzdGF0aWMgbmV3VW5rbm93bkRvY3VtZW50KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBxdCh0LCAzIC8qIFVOS05PV05fRE9DVU1FTlQgKi8gLCBlLCBCdC5lbXB0eSgpLCAyIC8qIEhBU19DT01NSVRURURfTVVUQVRJT05TICovKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2hhbmdlcyB0aGUgZG9jdW1lbnQgdHlwZSB0byBpbmRpY2F0ZSB0aGF0IGl0IGV4aXN0cyBhbmQgdGhhdCBpdHMgdmVyc2lvblxuICAgICAqIGFuZCBkYXRhIGFyZSBrbm93bi5cbiAgICAgKi8gICAgY29udmVydFRvRm91bmREb2N1bWVudCh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnZlcnNpb24gPSB0LCB0aGlzLmRvY3VtZW50VHlwZSA9IDEgLyogRk9VTkRfRE9DVU1FTlQgKi8gLCB0aGlzLmRhdGEgPSBlLCBcbiAgICAgICAgdGhpcy5kb2N1bWVudFN0YXRlID0gMCAvKiBTWU5DRUQgKi8gLCB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDaGFuZ2VzIHRoZSBkb2N1bWVudCB0eXBlIHRvIGluZGljYXRlIHRoYXQgaXQgZG9lc24ndCBleGlzdCBhdCB0aGUgZ2l2ZW5cbiAgICAgKiB2ZXJzaW9uLlxuICAgICAqLyAgICBjb252ZXJ0VG9Ob0RvY3VtZW50KHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudmVyc2lvbiA9IHQsIHRoaXMuZG9jdW1lbnRUeXBlID0gMiAvKiBOT19ET0NVTUVOVCAqLyAsIHRoaXMuZGF0YSA9IEJ0LmVtcHR5KCksIFxuICAgICAgICB0aGlzLmRvY3VtZW50U3RhdGUgPSAwIC8qIFNZTkNFRCAqLyAsIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENoYW5nZXMgdGhlIGRvY3VtZW50IHR5cGUgdG8gaW5kaWNhdGUgdGhhdCBpdCBleGlzdHMgYXQgYSBnaXZlbiB2ZXJzaW9uIGJ1dFxuICAgICAqIHRoYXQgaXRzIGRhdGEgaXMgbm90IGtub3duIChlLmcuIGEgZG9jdW1lbnQgdGhhdCB3YXMgdXBkYXRlZCB3aXRob3V0IGEga25vd25cbiAgICAgKiBiYXNlIGRvY3VtZW50KS5cbiAgICAgKi8gICAgY29udmVydFRvVW5rbm93bkRvY3VtZW50KHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudmVyc2lvbiA9IHQsIHRoaXMuZG9jdW1lbnRUeXBlID0gMyAvKiBVTktOT1dOX0RPQ1VNRU5UICovICwgdGhpcy5kYXRhID0gQnQuZW1wdHkoKSwgXG4gICAgICAgIHRoaXMuZG9jdW1lbnRTdGF0ZSA9IDIgLyogSEFTX0NPTU1JVFRFRF9NVVRBVElPTlMgKi8gLCB0aGlzO1xuICAgIH1cbiAgICBzZXRIYXNDb21taXR0ZWRNdXRhdGlvbnMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRvY3VtZW50U3RhdGUgPSAyIC8qIEhBU19DT01NSVRURURfTVVUQVRJT05TICovICwgdGhpcztcbiAgICB9XG4gICAgc2V0SGFzTG9jYWxNdXRhdGlvbnMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRvY3VtZW50U3RhdGUgPSAxIC8qIEhBU19MT0NBTF9NVVRBVElPTlMgKi8gLCB0aGlzO1xuICAgIH1cbiAgICBnZXQgaGFzTG9jYWxNdXRhdGlvbnMoKSB7XG4gICAgICAgIHJldHVybiAxIC8qIEhBU19MT0NBTF9NVVRBVElPTlMgKi8gPT09IHRoaXMuZG9jdW1lbnRTdGF0ZTtcbiAgICB9XG4gICAgZ2V0IGhhc0NvbW1pdHRlZE11dGF0aW9ucygpIHtcbiAgICAgICAgcmV0dXJuIDIgLyogSEFTX0NPTU1JVFRFRF9NVVRBVElPTlMgKi8gPT09IHRoaXMuZG9jdW1lbnRTdGF0ZTtcbiAgICB9XG4gICAgZ2V0IGhhc1BlbmRpbmdXcml0ZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmhhc0xvY2FsTXV0YXRpb25zIHx8IHRoaXMuaGFzQ29tbWl0dGVkTXV0YXRpb25zO1xuICAgIH1cbiAgICBpc1ZhbGlkRG9jdW1lbnQoKSB7XG4gICAgICAgIHJldHVybiAwIC8qIElOVkFMSUQgKi8gIT09IHRoaXMuZG9jdW1lbnRUeXBlO1xuICAgIH1cbiAgICBpc0ZvdW5kRG9jdW1lbnQoKSB7XG4gICAgICAgIHJldHVybiAxIC8qIEZPVU5EX0RPQ1VNRU5UICovID09PSB0aGlzLmRvY3VtZW50VHlwZTtcbiAgICB9XG4gICAgaXNOb0RvY3VtZW50KCkge1xuICAgICAgICByZXR1cm4gMiAvKiBOT19ET0NVTUVOVCAqLyA9PT0gdGhpcy5kb2N1bWVudFR5cGU7XG4gICAgfVxuICAgIGlzVW5rbm93bkRvY3VtZW50KCkge1xuICAgICAgICByZXR1cm4gMyAvKiBVTktOT1dOX0RPQ1VNRU5UICovID09PSB0aGlzLmRvY3VtZW50VHlwZTtcbiAgICB9XG4gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIHJldHVybiB0IGluc3RhbmNlb2YgcXQgJiYgdGhpcy5rZXkuaXNFcXVhbCh0LmtleSkgJiYgdGhpcy52ZXJzaW9uLmlzRXF1YWwodC52ZXJzaW9uKSAmJiB0aGlzLmRvY3VtZW50VHlwZSA9PT0gdC5kb2N1bWVudFR5cGUgJiYgdGhpcy5kb2N1bWVudFN0YXRlID09PSB0LmRvY3VtZW50U3RhdGUgJiYgdGhpcy5kYXRhLmlzRXF1YWwodC5kYXRhKTtcbiAgICB9XG4gICAgY2xvbmUoKSB7XG4gICAgICAgIHJldHVybiBuZXcgcXQodGhpcy5rZXksIHRoaXMuZG9jdW1lbnRUeXBlLCB0aGlzLnZlcnNpb24sIHRoaXMuZGF0YS5jbG9uZSgpLCB0aGlzLmRvY3VtZW50U3RhdGUpO1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIGBEb2N1bWVudCgke3RoaXMua2V5fSwgJHt0aGlzLnZlcnNpb259LCAke0pTT04uc3RyaW5naWZ5KHRoaXMuZGF0YS52YWx1ZSl9LCB7ZG9jdW1lbnRUeXBlOiAke3RoaXMuZG9jdW1lbnRUeXBlfX0pLCB7ZG9jdW1lbnRTdGF0ZTogJHt0aGlzLmRvY3VtZW50U3RhdGV9fSlgO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDb21wYXJlcyB0aGUgdmFsdWUgZm9yIGZpZWxkIGBmaWVsZGAgaW4gdGhlIHByb3ZpZGVkIGRvY3VtZW50cy4gVGhyb3dzIGlmXG4gKiB0aGUgZmllbGQgZG9lcyBub3QgZXhpc3QgaW4gYm90aCBkb2N1bWVudHMuXG4gKi9cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vLyBWaXNpYmxlIGZvciB0ZXN0aW5nXG5jbGFzcyBLdCB7XG4gICAgY29uc3RydWN0b3IodCwgZSA9IG51bGwsIG4gPSBbXSwgcyA9IFtdLCBpID0gbnVsbCwgciA9IG51bGwsIG8gPSBudWxsKSB7XG4gICAgICAgIHRoaXMucGF0aCA9IHQsIHRoaXMuY29sbGVjdGlvbkdyb3VwID0gZSwgdGhpcy5vcmRlckJ5ID0gbiwgdGhpcy5maWx0ZXJzID0gcywgdGhpcy5saW1pdCA9IGksIFxuICAgICAgICB0aGlzLnN0YXJ0QXQgPSByLCB0aGlzLmVuZEF0ID0gbywgdGhpcy5BID0gbnVsbDtcbiAgICB9XG59XG5cbi8qKlxuICogSW5pdGlhbGl6ZXMgYSBUYXJnZXQgd2l0aCBhIHBhdGggYW5kIG9wdGlvbmFsIGFkZGl0aW9uYWwgcXVlcnkgY29uc3RyYWludHMuXG4gKiBQYXRoIG11c3QgY3VycmVudGx5IGJlIGVtcHR5IGlmIHRoaXMgaXMgYSBjb2xsZWN0aW9uIGdyb3VwIHF1ZXJ5LlxuICpcbiAqIE5PVEU6IHlvdSBzaG91bGQgYWx3YXlzIGNvbnN0cnVjdCBgVGFyZ2V0YCBmcm9tIGBRdWVyeS50b1RhcmdldGAgaW5zdGVhZCBvZlxuICogdXNpbmcgdGhpcyBmYWN0b3J5IG1ldGhvZCwgYmVjYXVzZSBgUXVlcnlgIHByb3ZpZGVzIGFuIGltcGxpY2l0IGBvcmRlckJ5YFxuICogcHJvcGVydHkuXG4gKi8gZnVuY3Rpb24ganQodCwgZSA9IG51bGwsIG4gPSBbXSwgcyA9IFtdLCBpID0gbnVsbCwgciA9IG51bGwsIG8gPSBudWxsKSB7XG4gICAgcmV0dXJuIG5ldyBLdCh0LCBlLCBuLCBzLCBpLCByLCBvKTtcbn1cblxuZnVuY3Rpb24gUXQodCkge1xuICAgIGNvbnN0IGUgPSBVKHQpO1xuICAgIGlmIChudWxsID09PSBlLkEpIHtcbiAgICAgICAgbGV0IHQgPSBlLnBhdGguY2Fub25pY2FsU3RyaW5nKCk7XG4gICAgICAgIG51bGwgIT09IGUuY29sbGVjdGlvbkdyb3VwICYmICh0ICs9IFwifGNnOlwiICsgZS5jb2xsZWN0aW9uR3JvdXApLCB0ICs9IFwifGY6XCIsIHQgKz0gZS5maWx0ZXJzLm1hcCgodCA9PiBKdCh0KSkpLmpvaW4oXCIsXCIpLCBcbiAgICAgICAgdCArPSBcInxvYjpcIiwgdCArPSBlLm9yZGVyQnkubWFwKCh0ID0+IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIC8vIFRPRE8oYi8yOTE4MzE2NSk6IE1ha2UgdGhpcyBjb2xsaXNpb24gcm9idXN0LlxuICAgICAgICAgICAgcmV0dXJuIHQuZmllbGQuY2Fub25pY2FsU3RyaW5nKCkgKyB0LmRpcjtcbiAgICAgICAgfSh0KSkpLmpvaW4oXCIsXCIpLCBJdChlLmxpbWl0KSB8fCAodCArPSBcInxsOlwiLCB0ICs9IGUubGltaXQpLCBlLnN0YXJ0QXQgJiYgKHQgKz0gXCJ8bGI6XCIsIFxuICAgICAgICB0ICs9IG9lKGUuc3RhcnRBdCkpLCBlLmVuZEF0ICYmICh0ICs9IFwifHViOlwiLCB0ICs9IG9lKGUuZW5kQXQpKSwgZS5BID0gdDtcbiAgICB9XG4gICAgcmV0dXJuIGUuQTtcbn1cblxuZnVuY3Rpb24gV3QodCkge1xuICAgIGxldCBlID0gdC5wYXRoLmNhbm9uaWNhbFN0cmluZygpO1xuICAgIHJldHVybiBudWxsICE9PSB0LmNvbGxlY3Rpb25Hcm91cCAmJiAoZSArPSBcIiBjb2xsZWN0aW9uR3JvdXA9XCIgKyB0LmNvbGxlY3Rpb25Hcm91cCksIFxuICAgIHQuZmlsdGVycy5sZW5ndGggPiAwICYmIChlICs9IGAsIGZpbHRlcnM6IFske3QuZmlsdGVycy5tYXAoKHQgPT4ge1xuICAgICAgICByZXR1cm4gYCR7KGUgPSB0KS5maWVsZC5jYW5vbmljYWxTdHJpbmcoKX0gJHtlLm9wfSAke0N0KGUudmFsdWUpfWA7XG4gICAgICAgIC8qKiBSZXR1cm5zIGEgZGVidWcgZGVzY3JpcHRpb24gZm9yIGBmaWx0ZXJgLiAqL1xuICAgICAgICB2YXIgZTtcbiAgICAgICAgLyoqIEZpbHRlciB0aGF0IG1hdGNoZXMgb24ga2V5IGZpZWxkcyAoaS5lLiAnX19uYW1lX18nKS4gKi8gICAgfSkpLmpvaW4oXCIsIFwiKX1dYCksIFxuICAgIEl0KHQubGltaXQpIHx8IChlICs9IFwiLCBsaW1pdDogXCIgKyB0LmxpbWl0KSwgdC5vcmRlckJ5Lmxlbmd0aCA+IDAgJiYgKGUgKz0gYCwgb3JkZXJCeTogWyR7dC5vcmRlckJ5Lm1hcCgodCA9PiBmdW5jdGlvbih0KSB7XG4gICAgICAgIHJldHVybiBgJHt0LmZpZWxkLmNhbm9uaWNhbFN0cmluZygpfSAoJHt0LmRpcn0pYDtcbiAgICB9KHQpKSkuam9pbihcIiwgXCIpfV1gKSwgdC5zdGFydEF0ICYmIChlICs9IFwiLCBzdGFydEF0OiBcIiArIG9lKHQuc3RhcnRBdCkpLCB0LmVuZEF0ICYmIChlICs9IFwiLCBlbmRBdDogXCIgKyBvZSh0LmVuZEF0KSksIFxuICAgIGBUYXJnZXQoJHtlfSlgO1xufVxuXG5mdW5jdGlvbiBHdCh0LCBlKSB7XG4gICAgaWYgKHQubGltaXQgIT09IGUubGltaXQpIHJldHVybiAhMTtcbiAgICBpZiAodC5vcmRlckJ5Lmxlbmd0aCAhPT0gZS5vcmRlckJ5Lmxlbmd0aCkgcmV0dXJuICExO1xuICAgIGZvciAobGV0IG4gPSAwOyBuIDwgdC5vcmRlckJ5Lmxlbmd0aDsgbisrKSBpZiAoIWNlKHQub3JkZXJCeVtuXSwgZS5vcmRlckJ5W25dKSkgcmV0dXJuICExO1xuICAgIGlmICh0LmZpbHRlcnMubGVuZ3RoICE9PSBlLmZpbHRlcnMubGVuZ3RoKSByZXR1cm4gITE7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0LmZpbHRlcnMubGVuZ3RoOyBpKyspIGlmIChuID0gdC5maWx0ZXJzW2ldLCBzID0gZS5maWx0ZXJzW2ldLCBcbiAgICBuLm9wICE9PSBzLm9wIHx8ICFuLmZpZWxkLmlzRXF1YWwocy5maWVsZCkgfHwgIXZ0KG4udmFsdWUsIHMudmFsdWUpKSByZXR1cm4gITE7XG4gICAgdmFyIG4sIHM7XG4gICAgcmV0dXJuIHQuY29sbGVjdGlvbkdyb3VwID09PSBlLmNvbGxlY3Rpb25Hcm91cCAmJiAoISF0LnBhdGguaXNFcXVhbChlLnBhdGgpICYmICghIWhlKHQuc3RhcnRBdCwgZS5zdGFydEF0KSAmJiBoZSh0LmVuZEF0LCBlLmVuZEF0KSkpO1xufVxuXG5mdW5jdGlvbiB6dCh0KSB7XG4gICAgcmV0dXJuIFB0LmlzRG9jdW1lbnRLZXkodC5wYXRoKSAmJiBudWxsID09PSB0LmNvbGxlY3Rpb25Hcm91cCAmJiAwID09PSB0LmZpbHRlcnMubGVuZ3RoO1xufVxuXG5jbGFzcyBIdCBleHRlbmRzIGNsYXNzIHt9IHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMuZmllbGQgPSB0LCB0aGlzLm9wID0gZSwgdGhpcy52YWx1ZSA9IG47XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBmaWx0ZXIgYmFzZWQgb24gdGhlIHByb3ZpZGVkIGFyZ3VtZW50cy5cbiAgICAgKi8gICAgc3RhdGljIGNyZWF0ZSh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiB0LmlzS2V5RmllbGQoKSA/IFwiaW5cIiAvKiBJTiAqLyA9PT0gZSB8fCBcIm5vdC1pblwiIC8qIE5PVF9JTiAqLyA9PT0gZSA/IHRoaXMuUih0LCBlLCBuKSA6IG5ldyBZdCh0LCBlLCBuKSA6IFwiYXJyYXktY29udGFpbnNcIiAvKiBBUlJBWV9DT05UQUlOUyAqLyA9PT0gZSA/IG5ldyBlZSh0LCBuKSA6IFwiaW5cIiAvKiBJTiAqLyA9PT0gZSA/IG5ldyBuZSh0LCBuKSA6IFwibm90LWluXCIgLyogTk9UX0lOICovID09PSBlID8gbmV3IHNlKHQsIG4pIDogXCJhcnJheS1jb250YWlucy1hbnlcIiAvKiBBUlJBWV9DT05UQUlOU19BTlkgKi8gPT09IGUgPyBuZXcgaWUodCwgbikgOiBuZXcgSHQodCwgZSwgbik7XG4gICAgfVxuICAgIHN0YXRpYyBSKHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIFwiaW5cIiAvKiBJTiAqLyA9PT0gZSA/IG5ldyBYdCh0LCBuKSA6IG5ldyBadCh0LCBuKTtcbiAgICB9XG4gICAgbWF0Y2hlcyh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0LmRhdGEuZmllbGQodGhpcy5maWVsZCk7XG4gICAgICAgIC8vIFR5cGVzIGRvIG5vdCBoYXZlIHRvIG1hdGNoIGluIE5PVF9FUVVBTCBmaWx0ZXJzLlxuICAgICAgICAgICAgICAgIHJldHVybiBcIiE9XCIgLyogTk9UX0VRVUFMICovID09PSB0aGlzLm9wID8gbnVsbCAhPT0gZSAmJiB0aGlzLlAoU3QoZSwgdGhpcy52YWx1ZSkpIDogbnVsbCAhPT0gZSAmJiBidCh0aGlzLnZhbHVlKSA9PT0gYnQoZSkgJiYgdGhpcy5QKFN0KGUsIHRoaXMudmFsdWUpKTtcbiAgICAgICAgLy8gT25seSBjb21wYXJlIHR5cGVzIHdpdGggbWF0Y2hpbmcgYmFja2VuZCBvcmRlciAoc3VjaCBhcyBkb3VibGUgYW5kIGludCkuXG4gICAgICAgIH1cbiAgICBQKHQpIHtcbiAgICAgICAgc3dpdGNoICh0aGlzLm9wKSB7XG4gICAgICAgICAgY2FzZSBcIjxcIiAvKiBMRVNTX1RIQU4gKi8gOlxuICAgICAgICAgICAgcmV0dXJuIHQgPCAwO1xuXG4gICAgICAgICAgY2FzZSBcIjw9XCIgLyogTEVTU19USEFOX09SX0VRVUFMICovIDpcbiAgICAgICAgICAgIHJldHVybiB0IDw9IDA7XG5cbiAgICAgICAgICBjYXNlIFwiPT1cIiAvKiBFUVVBTCAqLyA6XG4gICAgICAgICAgICByZXR1cm4gMCA9PT0gdDtcblxuICAgICAgICAgIGNhc2UgXCIhPVwiIC8qIE5PVF9FUVVBTCAqLyA6XG4gICAgICAgICAgICByZXR1cm4gMCAhPT0gdDtcblxuICAgICAgICAgIGNhc2UgXCI+XCIgLyogR1JFQVRFUl9USEFOICovIDpcbiAgICAgICAgICAgIHJldHVybiB0ID4gMDtcblxuICAgICAgICAgIGNhc2UgXCI+PVwiIC8qIEdSRUFURVJfVEhBTl9PUl9FUVVBTCAqLyA6XG4gICAgICAgICAgICByZXR1cm4gdCA+PSAwO1xuXG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBNKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdigpIHtcbiAgICAgICAgcmV0dXJuIFsgXCI8XCIgLyogTEVTU19USEFOICovICwgXCI8PVwiIC8qIExFU1NfVEhBTl9PUl9FUVVBTCAqLyAsIFwiPlwiIC8qIEdSRUFURVJfVEhBTiAqLyAsIFwiPj1cIiAvKiBHUkVBVEVSX1RIQU5fT1JfRVFVQUwgKi8gLCBcIiE9XCIgLyogTk9UX0VRVUFMICovICwgXCJub3QtaW5cIiAvKiBOT1RfSU4gKi8gXS5pbmRleE9mKHRoaXMub3ApID49IDA7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBKdCh0KSB7XG4gICAgLy8gVE9ETyhiLzI5MTgzMTY1KTogVGVjaG5pY2FsbHksIHRoaXMgd29uJ3QgYmUgdW5pcXVlIGlmIHR3byB2YWx1ZXMgaGF2ZVxuICAgIC8vIHRoZSBzYW1lIGRlc2NyaXB0aW9uLCBzdWNoIGFzIHRoZSBpbnQgMyBhbmQgdGhlIHN0cmluZyBcIjNcIi4gU28gd2Ugc2hvdWxkXG4gICAgLy8gYWRkIHRoZSB0eXBlcyBpbiBoZXJlIHNvbWVob3csIHRvby5cbiAgICByZXR1cm4gdC5maWVsZC5jYW5vbmljYWxTdHJpbmcoKSArIHQub3AudG9TdHJpbmcoKSArIEN0KHQudmFsdWUpO1xufVxuXG5jbGFzcyBZdCBleHRlbmRzIEh0IHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHN1cGVyKHQsIGUsIG4pLCB0aGlzLmtleSA9IFB0LmZyb21OYW1lKG4ucmVmZXJlbmNlVmFsdWUpO1xuICAgIH1cbiAgICBtYXRjaGVzKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IFB0LmNvbXBhcmF0b3IodC5rZXksIHRoaXMua2V5KTtcbiAgICAgICAgcmV0dXJuIHRoaXMuUChlKTtcbiAgICB9XG59XG5cbi8qKiBGaWx0ZXIgdGhhdCBtYXRjaGVzIG9uIGtleSBmaWVsZHMgd2l0aGluIGFuIGFycmF5LiAqLyBjbGFzcyBYdCBleHRlbmRzIEh0IHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHN1cGVyKHQsIFwiaW5cIiAvKiBJTiAqLyAsIGUpLCB0aGlzLmtleXMgPSB0ZShcImluXCIgLyogSU4gKi8gLCBlKTtcbiAgICB9XG4gICAgbWF0Y2hlcyh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmtleXMuc29tZSgoZSA9PiBlLmlzRXF1YWwodC5rZXkpKSk7XG4gICAgfVxufVxuXG4vKiogRmlsdGVyIHRoYXQgbWF0Y2hlcyBvbiBrZXkgZmllbGRzIG5vdCBwcmVzZW50IHdpdGhpbiBhbiBhcnJheS4gKi8gY2xhc3MgWnQgZXh0ZW5kcyBIdCB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICBzdXBlcih0LCBcIm5vdC1pblwiIC8qIE5PVF9JTiAqLyAsIGUpLCB0aGlzLmtleXMgPSB0ZShcIm5vdC1pblwiIC8qIE5PVF9JTiAqLyAsIGUpO1xuICAgIH1cbiAgICBtYXRjaGVzKHQpIHtcbiAgICAgICAgcmV0dXJuICF0aGlzLmtleXMuc29tZSgoZSA9PiBlLmlzRXF1YWwodC5rZXkpKSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiB0ZSh0LCBlKSB7XG4gICAgdmFyIG47XG4gICAgcmV0dXJuICgobnVsbCA9PT0gKG4gPSBlLmFycmF5VmFsdWUpIHx8IHZvaWQgMCA9PT0gbiA/IHZvaWQgMCA6IG4udmFsdWVzKSB8fCBbXSkubWFwKCh0ID0+IFB0LmZyb21OYW1lKHQucmVmZXJlbmNlVmFsdWUpKSk7XG59XG5cbi8qKiBBIEZpbHRlciB0aGF0IGltcGxlbWVudHMgdGhlIGFycmF5LWNvbnRhaW5zIG9wZXJhdG9yLiAqLyBjbGFzcyBlZSBleHRlbmRzIEh0IHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHN1cGVyKHQsIFwiYXJyYXktY29udGFpbnNcIiAvKiBBUlJBWV9DT05UQUlOUyAqLyAsIGUpO1xuICAgIH1cbiAgICBtYXRjaGVzKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHQuZGF0YS5maWVsZCh0aGlzLmZpZWxkKTtcbiAgICAgICAgcmV0dXJuICR0KGUpICYmIFZ0KGUuYXJyYXlWYWx1ZSwgdGhpcy52YWx1ZSk7XG4gICAgfVxufVxuXG4vKiogQSBGaWx0ZXIgdGhhdCBpbXBsZW1lbnRzIHRoZSBJTiBvcGVyYXRvci4gKi8gY2xhc3MgbmUgZXh0ZW5kcyBIdCB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICBzdXBlcih0LCBcImluXCIgLyogSU4gKi8gLCBlKTtcbiAgICB9XG4gICAgbWF0Y2hlcyh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0LmRhdGEuZmllbGQodGhpcy5maWVsZCk7XG4gICAgICAgIHJldHVybiBudWxsICE9PSBlICYmIFZ0KHRoaXMudmFsdWUuYXJyYXlWYWx1ZSwgZSk7XG4gICAgfVxufVxuXG4vKiogQSBGaWx0ZXIgdGhhdCBpbXBsZW1lbnRzIHRoZSBub3QtaW4gb3BlcmF0b3IuICovIGNsYXNzIHNlIGV4dGVuZHMgSHQge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgc3VwZXIodCwgXCJub3QtaW5cIiAvKiBOT1RfSU4gKi8gLCBlKTtcbiAgICB9XG4gICAgbWF0Y2hlcyh0KSB7XG4gICAgICAgIGlmIChWdCh0aGlzLnZhbHVlLmFycmF5VmFsdWUsIHtcbiAgICAgICAgICAgIG51bGxWYWx1ZTogXCJOVUxMX1ZBTFVFXCJcbiAgICAgICAgfSkpIHJldHVybiAhMTtcbiAgICAgICAgY29uc3QgZSA9IHQuZGF0YS5maWVsZCh0aGlzLmZpZWxkKTtcbiAgICAgICAgcmV0dXJuIG51bGwgIT09IGUgJiYgIVZ0KHRoaXMudmFsdWUuYXJyYXlWYWx1ZSwgZSk7XG4gICAgfVxufVxuXG4vKiogQSBGaWx0ZXIgdGhhdCBpbXBsZW1lbnRzIHRoZSBhcnJheS1jb250YWlucy1hbnkgb3BlcmF0b3IuICovIGNsYXNzIGllIGV4dGVuZHMgSHQge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgc3VwZXIodCwgXCJhcnJheS1jb250YWlucy1hbnlcIiAvKiBBUlJBWV9DT05UQUlOU19BTlkgKi8gLCBlKTtcbiAgICB9XG4gICAgbWF0Y2hlcyh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0LmRhdGEuZmllbGQodGhpcy5maWVsZCk7XG4gICAgICAgIHJldHVybiAhKCEkdChlKSB8fCAhZS5hcnJheVZhbHVlLnZhbHVlcykgJiYgZS5hcnJheVZhbHVlLnZhbHVlcy5zb21lKCh0ID0+IFZ0KHRoaXMudmFsdWUuYXJyYXlWYWx1ZSwgdCkpKTtcbiAgICB9XG59XG5cbi8qKlxuICogUmVwcmVzZW50cyBhIGJvdW5kIG9mIGEgcXVlcnkuXG4gKlxuICogVGhlIGJvdW5kIGlzIHNwZWNpZmllZCB3aXRoIHRoZSBnaXZlbiBjb21wb25lbnRzIHJlcHJlc2VudGluZyBhIHBvc2l0aW9uIGFuZFxuICogd2hldGhlciBpdCdzIGp1c3QgYmVmb3JlIG9yIGp1c3QgYWZ0ZXIgdGhlIHBvc2l0aW9uIChyZWxhdGl2ZSB0byB3aGF0ZXZlciB0aGVcbiAqIHF1ZXJ5IG9yZGVyIGlzKS5cbiAqXG4gKiBUaGUgcG9zaXRpb24gcmVwcmVzZW50cyBhIGxvZ2ljYWwgaW5kZXggcG9zaXRpb24gZm9yIGEgcXVlcnkuIEl0J3MgYSBwcmVmaXhcbiAqIG9mIHZhbHVlcyBmb3IgdGhlIChwb3RlbnRpYWxseSBpbXBsaWNpdCkgb3JkZXIgYnkgY2xhdXNlcyBvZiBhIHF1ZXJ5LlxuICpcbiAqIEJvdW5kIHByb3ZpZGVzIGEgZnVuY3Rpb24gdG8gZGV0ZXJtaW5lIHdoZXRoZXIgYSBkb2N1bWVudCBjb21lcyBiZWZvcmUgb3JcbiAqIGFmdGVyIGEgYm91bmQuIFRoaXMgaXMgaW5mbHVlbmNlZCBieSB3aGV0aGVyIHRoZSBwb3NpdGlvbiBpcyBqdXN0IGJlZm9yZSBvclxuICoganVzdCBhZnRlciB0aGUgcHJvdmlkZWQgdmFsdWVzLlxuICovIGNsYXNzIHJlIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMucG9zaXRpb24gPSB0LCB0aGlzLmJlZm9yZSA9IGU7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBvZSh0KSB7XG4gICAgLy8gVE9ETyhiLzI5MTgzMTY1KTogTWFrZSB0aGlzIGNvbGxpc2lvbiByb2J1c3QuXG4gICAgcmV0dXJuIGAke3QuYmVmb3JlID8gXCJiXCIgOiBcImFcIn06JHt0LnBvc2l0aW9uLm1hcCgodCA9PiBDdCh0KSkpLmpvaW4oXCIsXCIpfWA7XG59XG5cbi8qKlxuICogQW4gb3JkZXJpbmcgb24gYSBmaWVsZCwgaW4gc29tZSBEaXJlY3Rpb24uIERpcmVjdGlvbiBkZWZhdWx0cyB0byBBU0NFTkRJTkcuXG4gKi8gY2xhc3MgYWUge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUgPSBcImFzY1wiIC8qIEFTQ0VORElORyAqLykge1xuICAgICAgICB0aGlzLmZpZWxkID0gdCwgdGhpcy5kaXIgPSBlO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gY2UodCwgZSkge1xuICAgIHJldHVybiB0LmRpciA9PT0gZS5kaXIgJiYgdC5maWVsZC5pc0VxdWFsKGUuZmllbGQpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdHJ1ZSBpZiBhIGRvY3VtZW50IHNvcnRzIGJlZm9yZSBhIGJvdW5kIHVzaW5nIHRoZSBwcm92aWRlZCBzb3J0XG4gKiBvcmRlci5cbiAqLyBmdW5jdGlvbiB1ZSh0LCBlLCBuKSB7XG4gICAgbGV0IHMgPSAwO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdC5wb3NpdGlvbi5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCByID0gZVtpXSwgbyA9IHQucG9zaXRpb25baV07XG4gICAgICAgIGlmIChyLmZpZWxkLmlzS2V5RmllbGQoKSkgcyA9IFB0LmNvbXBhcmF0b3IoUHQuZnJvbU5hbWUoby5yZWZlcmVuY2VWYWx1ZSksIG4ua2V5KTsgZWxzZSB7XG4gICAgICAgICAgICBzID0gU3Qobywgbi5kYXRhLmZpZWxkKHIuZmllbGQpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoXCJkZXNjXCIgLyogREVTQ0VORElORyAqLyA9PT0gci5kaXIgJiYgKHMgKj0gLTEpLCAwICE9PSBzKSBicmVhaztcbiAgICB9XG4gICAgcmV0dXJuIHQuYmVmb3JlID8gcyA8PSAwIDogcyA8IDA7XG59XG5cbmZ1bmN0aW9uIGhlKHQsIGUpIHtcbiAgICBpZiAobnVsbCA9PT0gdCkgcmV0dXJuIG51bGwgPT09IGU7XG4gICAgaWYgKG51bGwgPT09IGUpIHJldHVybiAhMTtcbiAgICBpZiAodC5iZWZvcmUgIT09IGUuYmVmb3JlIHx8IHQucG9zaXRpb24ubGVuZ3RoICE9PSBlLnBvc2l0aW9uLmxlbmd0aCkgcmV0dXJuICExO1xuICAgIGZvciAobGV0IG4gPSAwOyBuIDwgdC5wb3NpdGlvbi5sZW5ndGg7IG4rKykge1xuICAgICAgICBpZiAoIXZ0KHQucG9zaXRpb25bbl0sIGUucG9zaXRpb25bbl0pKSByZXR1cm4gITE7XG4gICAgfVxuICAgIHJldHVybiAhMDtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUXVlcnkgZW5jYXBzdWxhdGVzIGFsbCB0aGUgcXVlcnkgYXR0cmlidXRlcyB3ZSBzdXBwb3J0IGluIHRoZSBTREsuIEl0IGNhblxuICogYmUgcnVuIGFnYWluc3QgdGhlIExvY2FsU3RvcmUsIGFzIHdlbGwgYXMgYmUgY29udmVydGVkIHRvIGEgYFRhcmdldGAgdG9cbiAqIHF1ZXJ5IHRoZSBSZW1vdGVTdG9yZSByZXN1bHRzLlxuICpcbiAqIFZpc2libGUgZm9yIHRlc3RpbmcuXG4gKi8gY2xhc3MgbGUge1xuICAgIC8qKlxuICAgICAqIEluaXRpYWxpemVzIGEgUXVlcnkgd2l0aCBhIHBhdGggYW5kIG9wdGlvbmFsIGFkZGl0aW9uYWwgcXVlcnkgY29uc3RyYWludHMuXG4gICAgICogUGF0aCBtdXN0IGN1cnJlbnRseSBiZSBlbXB0eSBpZiB0aGlzIGlzIGEgY29sbGVjdGlvbiBncm91cCBxdWVyeS5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih0LCBlID0gbnVsbCwgbiA9IFtdLCBzID0gW10sIGkgPSBudWxsLCByID0gXCJGXCIgLyogRmlyc3QgKi8gLCBvID0gbnVsbCwgYSA9IG51bGwpIHtcbiAgICAgICAgdGhpcy5wYXRoID0gdCwgdGhpcy5jb2xsZWN0aW9uR3JvdXAgPSBlLCB0aGlzLmV4cGxpY2l0T3JkZXJCeSA9IG4sIHRoaXMuZmlsdGVycyA9IHMsIFxuICAgICAgICB0aGlzLmxpbWl0ID0gaSwgdGhpcy5saW1pdFR5cGUgPSByLCB0aGlzLnN0YXJ0QXQgPSBvLCB0aGlzLmVuZEF0ID0gYSwgdGhpcy5WID0gbnVsbCwgXG4gICAgICAgIC8vIFRoZSBjb3JyZXNwb25kaW5nIGBUYXJnZXRgIG9mIHRoaXMgYFF1ZXJ5YCBpbnN0YW5jZS5cbiAgICAgICAgdGhpcy5TID0gbnVsbCwgdGhpcy5zdGFydEF0LCB0aGlzLmVuZEF0O1xuICAgIH1cbn1cblxuLyoqIENyZWF0ZXMgYSBuZXcgUXVlcnkgaW5zdGFuY2Ugd2l0aCB0aGUgb3B0aW9ucyBwcm92aWRlZC4gKi8gZnVuY3Rpb24gZmUodCwgZSwgbiwgcywgaSwgciwgbywgYSkge1xuICAgIHJldHVybiBuZXcgbGUodCwgZSwgbiwgcywgaSwgciwgbywgYSk7XG59XG5cbi8qKiBDcmVhdGVzIGEgbmV3IFF1ZXJ5IGZvciBhIHF1ZXJ5IHRoYXQgbWF0Y2hlcyBhbGwgZG9jdW1lbnRzIGF0IGBwYXRoYCAqLyBmdW5jdGlvbiBkZSh0KSB7XG4gICAgcmV0dXJuIG5ldyBsZSh0KTtcbn1cblxuLyoqXG4gKiBIZWxwZXIgdG8gY29udmVydCBhIGNvbGxlY3Rpb24gZ3JvdXAgcXVlcnkgaW50byBhIGNvbGxlY3Rpb24gcXVlcnkgYXQgYVxuICogc3BlY2lmaWMgcGF0aC4gVGhpcyBpcyB1c2VkIHdoZW4gZXhlY3V0aW5nIGNvbGxlY3Rpb24gZ3JvdXAgcXVlcmllcywgc2luY2VcbiAqIHdlIGhhdmUgdG8gc3BsaXQgdGhlIHF1ZXJ5IGludG8gYSBzZXQgb2YgY29sbGVjdGlvbiBxdWVyaWVzIGF0IG11bHRpcGxlXG4gKiBwYXRocy5cbiAqLyBmdW5jdGlvbiB3ZSh0KSB7XG4gICAgcmV0dXJuICFJdCh0LmxpbWl0KSAmJiBcIkZcIiAvKiBGaXJzdCAqLyA9PT0gdC5saW1pdFR5cGU7XG59XG5cbmZ1bmN0aW9uIF9lKHQpIHtcbiAgICByZXR1cm4gIUl0KHQubGltaXQpICYmIFwiTFwiIC8qIExhc3QgKi8gPT09IHQubGltaXRUeXBlO1xufVxuXG5mdW5jdGlvbiBtZSh0KSB7XG4gICAgcmV0dXJuIHQuZXhwbGljaXRPcmRlckJ5Lmxlbmd0aCA+IDAgPyB0LmV4cGxpY2l0T3JkZXJCeVswXS5maWVsZCA6IG51bGw7XG59XG5cbmZ1bmN0aW9uIGdlKHQpIHtcbiAgICBmb3IgKGNvbnN0IGUgb2YgdC5maWx0ZXJzKSBpZiAoZS52KCkpIHJldHVybiBlLmZpZWxkO1xuICAgIHJldHVybiBudWxsO1xufVxuXG4vKipcbiAqIENoZWNrcyBpZiBhbnkgb2YgdGhlIHByb3ZpZGVkIE9wZXJhdG9ycyBhcmUgaW5jbHVkZWQgaW4gdGhlIHF1ZXJ5IGFuZFxuICogcmV0dXJucyB0aGUgZmlyc3Qgb25lIHRoYXQgaXMsIG9yIG51bGwgaWYgbm9uZSBhcmUuXG4gKi9cbi8qKlxuICogUmV0dXJucyB3aGV0aGVyIHRoZSBxdWVyeSBtYXRjaGVzIGEgY29sbGVjdGlvbiBncm91cCByYXRoZXIgdGhhbiBhIHNwZWNpZmljXG4gKiBjb2xsZWN0aW9uLlxuICovXG5mdW5jdGlvbiB5ZSh0KSB7XG4gICAgcmV0dXJuIG51bGwgIT09IHQuY29sbGVjdGlvbkdyb3VwO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIGltcGxpY2l0IG9yZGVyIGJ5IGNvbnN0cmFpbnQgdGhhdCBpcyB1c2VkIHRvIGV4ZWN1dGUgdGhlIFF1ZXJ5LFxuICogd2hpY2ggY2FuIGJlIGRpZmZlcmVudCBmcm9tIHRoZSBvcmRlciBieSBjb25zdHJhaW50cyB0aGUgdXNlciBwcm92aWRlZCAoZS5nLlxuICogdGhlIFNESyBhbmQgYmFja2VuZCBhbHdheXMgb3JkZXJzIGJ5IGBfX25hbWVfX2ApLlxuICovIGZ1bmN0aW9uIHBlKHQpIHtcbiAgICBjb25zdCBlID0gVSh0KTtcbiAgICBpZiAobnVsbCA9PT0gZS5WKSB7XG4gICAgICAgIGUuViA9IFtdO1xuICAgICAgICBjb25zdCB0ID0gZ2UoZSksIG4gPSBtZShlKTtcbiAgICAgICAgaWYgKG51bGwgIT09IHQgJiYgbnVsbCA9PT0gbikgXG4gICAgICAgIC8vIEluIG9yZGVyIHRvIGltcGxpY2l0bHkgYWRkIGtleSBvcmRlcmluZywgd2UgbXVzdCBhbHNvIGFkZCB0aGVcbiAgICAgICAgLy8gaW5lcXVhbGl0eSBmaWx0ZXIgZmllbGQgZm9yIGl0IHRvIGJlIGEgdmFsaWQgcXVlcnkuXG4gICAgICAgIC8vIE5vdGUgdGhhdCB0aGUgZGVmYXVsdCBpbmVxdWFsaXR5IGZpZWxkIGFuZCBrZXkgb3JkZXJpbmcgaXMgYXNjZW5kaW5nLlxuICAgICAgICB0LmlzS2V5RmllbGQoKSB8fCBlLlYucHVzaChuZXcgYWUodCkpLCBlLlYucHVzaChuZXcgYWUobHQua2V5RmllbGQoKSwgXCJhc2NcIiAvKiBBU0NFTkRJTkcgKi8pKTsgZWxzZSB7XG4gICAgICAgICAgICBsZXQgdCA9ICExO1xuICAgICAgICAgICAgZm9yIChjb25zdCBuIG9mIGUuZXhwbGljaXRPcmRlckJ5KSBlLlYucHVzaChuKSwgbi5maWVsZC5pc0tleUZpZWxkKCkgJiYgKHQgPSAhMCk7XG4gICAgICAgICAgICBpZiAoIXQpIHtcbiAgICAgICAgICAgICAgICAvLyBUaGUgb3JkZXIgb2YgdGhlIGltcGxpY2l0IGtleSBvcmRlcmluZyBhbHdheXMgbWF0Y2hlcyB0aGUgbGFzdFxuICAgICAgICAgICAgICAgIC8vIGV4cGxpY2l0IG9yZGVyIGJ5XG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IGUuZXhwbGljaXRPcmRlckJ5Lmxlbmd0aCA+IDAgPyBlLmV4cGxpY2l0T3JkZXJCeVtlLmV4cGxpY2l0T3JkZXJCeS5sZW5ndGggLSAxXS5kaXIgOiBcImFzY1wiIC8qIEFTQ0VORElORyAqLztcbiAgICAgICAgICAgICAgICBlLlYucHVzaChuZXcgYWUobHQua2V5RmllbGQoKSwgdCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBlLlY7XG59XG5cbi8qKlxuICogQ29udmVydHMgdGhpcyBgUXVlcnlgIGluc3RhbmNlIHRvIGl0J3MgY29ycmVzcG9uZGluZyBgVGFyZ2V0YCByZXByZXNlbnRhdGlvbi5cbiAqLyBmdW5jdGlvbiBFZSh0KSB7XG4gICAgY29uc3QgZSA9IFUodCk7XG4gICAgaWYgKCFlLlMpIGlmIChcIkZcIiAvKiBGaXJzdCAqLyA9PT0gZS5saW1pdFR5cGUpIGUuUyA9IGp0KGUucGF0aCwgZS5jb2xsZWN0aW9uR3JvdXAsIHBlKGUpLCBlLmZpbHRlcnMsIGUubGltaXQsIGUuc3RhcnRBdCwgZS5lbmRBdCk7IGVsc2Uge1xuICAgICAgICAvLyBGbGlwIHRoZSBvcmRlckJ5IGRpcmVjdGlvbnMgc2luY2Ugd2Ugd2FudCB0aGUgbGFzdCByZXN1bHRzXG4gICAgICAgIGNvbnN0IHQgPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCBuIG9mIHBlKGUpKSB7XG4gICAgICAgICAgICBjb25zdCBlID0gXCJkZXNjXCIgLyogREVTQ0VORElORyAqLyA9PT0gbi5kaXIgPyBcImFzY1wiIC8qIEFTQ0VORElORyAqLyA6IFwiZGVzY1wiIC8qIERFU0NFTkRJTkcgKi87XG4gICAgICAgICAgICB0LnB1c2gobmV3IGFlKG4uZmllbGQsIGUpKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBXZSBuZWVkIHRvIHN3YXAgdGhlIGN1cnNvcnMgdG8gbWF0Y2ggdGhlIG5vdy1mbGlwcGVkIHF1ZXJ5IG9yZGVyaW5nLlxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBlLmVuZEF0ID8gbmV3IHJlKGUuZW5kQXQucG9zaXRpb24sICFlLmVuZEF0LmJlZm9yZSkgOiBudWxsLCBzID0gZS5zdGFydEF0ID8gbmV3IHJlKGUuc3RhcnRBdC5wb3NpdGlvbiwgIWUuc3RhcnRBdC5iZWZvcmUpIDogbnVsbDtcbiAgICAgICAgLy8gTm93IHJldHVybiBhcyBhIExpbWl0VHlwZS5GaXJzdCBxdWVyeS5cbiAgICAgICAgZS5TID0ganQoZS5wYXRoLCBlLmNvbGxlY3Rpb25Hcm91cCwgdCwgZS5maWx0ZXJzLCBlLmxpbWl0LCBuLCBzKTtcbiAgICB9XG4gICAgcmV0dXJuIGUuUztcbn1cblxuZnVuY3Rpb24gVGUodCwgZSwgbikge1xuICAgIHJldHVybiBuZXcgbGUodC5wYXRoLCB0LmNvbGxlY3Rpb25Hcm91cCwgdC5leHBsaWNpdE9yZGVyQnkuc2xpY2UoKSwgdC5maWx0ZXJzLnNsaWNlKCksIGUsIG4sIHQuc3RhcnRBdCwgdC5lbmRBdCk7XG59XG5cbmZ1bmN0aW9uIEllKHQsIGUpIHtcbiAgICByZXR1cm4gR3QoRWUodCksIEVlKGUpKSAmJiB0LmxpbWl0VHlwZSA9PT0gZS5saW1pdFR5cGU7XG59XG5cbi8vIFRPRE8oYi8yOTE4MzE2NSk6IFRoaXMgaXMgdXNlZCB0byBnZXQgYSB1bmlxdWUgc3RyaW5nIGZyb20gYSBxdWVyeSB0bywgZm9yXG4vLyBleGFtcGxlLCB1c2UgYXMgYSBkaWN0aW9uYXJ5IGtleSwgYnV0IHRoZSBpbXBsZW1lbnRhdGlvbiBpcyBzdWJqZWN0IHRvXG4vLyBjb2xsaXNpb25zLiBNYWtlIGl0IGNvbGxpc2lvbi1mcmVlLlxuZnVuY3Rpb24gQWUodCkge1xuICAgIHJldHVybiBgJHtRdChFZSh0KSl9fGx0OiR7dC5saW1pdFR5cGV9YDtcbn1cblxuZnVuY3Rpb24gUmUodCkge1xuICAgIHJldHVybiBgUXVlcnkodGFyZ2V0PSR7V3QoRWUodCkpfTsgbGltaXRUeXBlPSR7dC5saW1pdFR5cGV9KWA7XG59XG5cbi8qKiBSZXR1cm5zIHdoZXRoZXIgYGRvY2AgbWF0Y2hlcyB0aGUgY29uc3RyYWludHMgb2YgYHF1ZXJ5YC4gKi8gZnVuY3Rpb24gUGUodCwgZSkge1xuICAgIHJldHVybiBlLmlzRm91bmREb2N1bWVudCgpICYmIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IGUua2V5LnBhdGg7XG4gICAgICAgIHJldHVybiBudWxsICE9PSB0LmNvbGxlY3Rpb25Hcm91cCA/IGUua2V5Lmhhc0NvbGxlY3Rpb25JZCh0LmNvbGxlY3Rpb25Hcm91cCkgJiYgdC5wYXRoLmlzUHJlZml4T2YobikgOiBQdC5pc0RvY3VtZW50S2V5KHQucGF0aCkgPyB0LnBhdGguaXNFcXVhbChuKSA6IHQucGF0aC5pc0ltbWVkaWF0ZVBhcmVudE9mKG4pO1xuICAgIH1cbiAgICAvKipcbiAqIEEgZG9jdW1lbnQgbXVzdCBoYXZlIGEgdmFsdWUgZm9yIGV2ZXJ5IG9yZGVyaW5nIGNsYXVzZSBpbiBvcmRlciB0byBzaG93IHVwXG4gKiBpbiB0aGUgcmVzdWx0cy5cbiAqLyAodCwgZSkgJiYgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBmb3IgKGNvbnN0IG4gb2YgdC5leHBsaWNpdE9yZGVyQnkpIFxuICAgICAgICAvLyBvcmRlciBieSBrZXkgYWx3YXlzIG1hdGNoZXNcbiAgICAgICAgaWYgKCFuLmZpZWxkLmlzS2V5RmllbGQoKSAmJiBudWxsID09PSBlLmRhdGEuZmllbGQobi5maWVsZCkpIHJldHVybiAhMTtcbiAgICAgICAgcmV0dXJuICEwO1xuICAgIH0odCwgZSkgJiYgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBmb3IgKGNvbnN0IG4gb2YgdC5maWx0ZXJzKSBpZiAoIW4ubWF0Y2hlcyhlKSkgcmV0dXJuICExO1xuICAgICAgICByZXR1cm4gITA7XG4gICAgfVxuICAgIC8qKiBNYWtlcyBzdXJlIGEgZG9jdW1lbnQgaXMgd2l0aGluIHRoZSBib3VuZHMsIGlmIHByb3ZpZGVkLiAqLyAodCwgZSkgJiYgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBpZiAodC5zdGFydEF0ICYmICF1ZSh0LnN0YXJ0QXQsIHBlKHQpLCBlKSkgcmV0dXJuICExO1xuICAgICAgICBpZiAodC5lbmRBdCAmJiB1ZSh0LmVuZEF0LCBwZSh0KSwgZSkpIHJldHVybiAhMTtcbiAgICAgICAgcmV0dXJuICEwO1xuICAgIH1cbiAgICAvKipcbiAqIFJldHVybnMgYSBuZXcgY29tcGFyYXRvciBmdW5jdGlvbiB0aGF0IGNhbiBiZSB1c2VkIHRvIGNvbXBhcmUgdHdvIGRvY3VtZW50c1xuICogYmFzZWQgb24gdGhlIFF1ZXJ5J3Mgb3JkZXJpbmcgY29uc3RyYWludC5cbiAqLyAodCwgZSk7XG59XG5cbmZ1bmN0aW9uIGJlKHQpIHtcbiAgICByZXR1cm4gKGUsIG4pID0+IHtcbiAgICAgICAgbGV0IHMgPSAhMTtcbiAgICAgICAgZm9yIChjb25zdCBpIG9mIHBlKHQpKSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gdmUoaSwgZSwgbik7XG4gICAgICAgICAgICBpZiAoMCAhPT0gdCkgcmV0dXJuIHQ7XG4gICAgICAgICAgICBzID0gcyB8fCBpLmZpZWxkLmlzS2V5RmllbGQoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gMDtcbiAgICB9O1xufVxuXG5mdW5jdGlvbiB2ZSh0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9IHQuZmllbGQuaXNLZXlGaWVsZCgpID8gUHQuY29tcGFyYXRvcihlLmtleSwgbi5rZXkpIDogZnVuY3Rpb24odCwgZSwgbikge1xuICAgICAgICBjb25zdCBzID0gZS5kYXRhLmZpZWxkKHQpLCBpID0gbi5kYXRhLmZpZWxkKHQpO1xuICAgICAgICByZXR1cm4gbnVsbCAhPT0gcyAmJiBudWxsICE9PSBpID8gU3QocywgaSkgOiBNKCk7XG4gICAgfSh0LmZpZWxkLCBlLCBuKTtcbiAgICBzd2l0Y2ggKHQuZGlyKSB7XG4gICAgICBjYXNlIFwiYXNjXCIgLyogQVNDRU5ESU5HICovIDpcbiAgICAgICAgcmV0dXJuIHM7XG5cbiAgICAgIGNhc2UgXCJkZXNjXCIgLyogREVTQ0VORElORyAqLyA6XG4gICAgICAgIHJldHVybiAtMSAqIHM7XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBNKCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBSZXR1cm5zIGFuIERvdWJsZVZhbHVlIGZvciBgdmFsdWVgIHRoYXQgaXMgZW5jb2RlZCBiYXNlZCB0aGUgc2VyaWFsaXplcidzXG4gKiBgdXNlUHJvdG8zSnNvbmAgc2V0dGluZy5cbiAqLyBmdW5jdGlvbiBWZSh0LCBlKSB7XG4gICAgaWYgKHQuRCkge1xuICAgICAgICBpZiAoaXNOYU4oZSkpIHJldHVybiB7XG4gICAgICAgICAgICBkb3VibGVWYWx1ZTogXCJOYU5cIlxuICAgICAgICB9O1xuICAgICAgICBpZiAoZSA9PT0gMSAvIDApIHJldHVybiB7XG4gICAgICAgICAgICBkb3VibGVWYWx1ZTogXCJJbmZpbml0eVwiXG4gICAgICAgIH07XG4gICAgICAgIGlmIChlID09PSAtMSAvIDApIHJldHVybiB7XG4gICAgICAgICAgICBkb3VibGVWYWx1ZTogXCItSW5maW5pdHlcIlxuICAgICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBkb3VibGVWYWx1ZTogQXQoZSkgPyBcIi0wXCIgOiBlXG4gICAgfTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGFuIEludGVnZXJWYWx1ZSBmb3IgYHZhbHVlYC5cbiAqLyBmdW5jdGlvbiBTZSh0KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgaW50ZWdlclZhbHVlOiBcIlwiICsgdFxuICAgIH07XG59XG5cbi8qKlxuICogUmV0dXJucyBhIHZhbHVlIGZvciBhIG51bWJlciB0aGF0J3MgYXBwcm9wcmlhdGUgdG8gcHV0IGludG8gYSBwcm90by5cbiAqIFRoZSByZXR1cm4gdmFsdWUgaXMgYW4gSW50ZWdlclZhbHVlIGlmIGl0IGNhbiBzYWZlbHkgcmVwcmVzZW50IHRoZSB2YWx1ZSxcbiAqIG90aGVyd2lzZSBhIERvdWJsZVZhbHVlIGlzIHJldHVybmVkLlxuICovIGZ1bmN0aW9uIERlKHQsIGUpIHtcbiAgICByZXR1cm4gUnQoZSkgPyBTZShlKSA6IFZlKHQsIGUpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqIFVzZWQgdG8gcmVwcmVzZW50IGEgZmllbGQgdHJhbnNmb3JtIG9uIGEgbXV0YXRpb24uICovIGNsYXNzIENlIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgLy8gTWFrZSBzdXJlIHRoYXQgdGhlIHN0cnVjdHVyYWwgdHlwZSBvZiBgVHJhbnNmb3JtT3BlcmF0aW9uYCBpcyB1bmlxdWUuXG4gICAgICAgIC8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vbWljcm9zb2Z0L1R5cGVTY3JpcHQvaXNzdWVzLzU0NTFcbiAgICAgICAgdGhpcy5fID0gdm9pZCAwO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDb21wdXRlcyB0aGUgbG9jYWwgdHJhbnNmb3JtIHJlc3VsdCBhZ2FpbnN0IHRoZSBwcm92aWRlZCBgcHJldmlvdXNWYWx1ZWAsXG4gKiBvcHRpb25hbGx5IHVzaW5nIHRoZSBwcm92aWRlZCBsb2NhbFdyaXRlVGltZS5cbiAqLyBmdW5jdGlvbiBOZSh0LCBlLCBuKSB7XG4gICAgcmV0dXJuIHQgaW5zdGFuY2VvZiAkZSA/IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHtcbiAgICAgICAgICAgIGZpZWxkczoge1xuICAgICAgICAgICAgICAgIF9fdHlwZV9fOiB7XG4gICAgICAgICAgICAgICAgICAgIHN0cmluZ1ZhbHVlOiBcInNlcnZlcl90aW1lc3RhbXBcIlxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgX19sb2NhbF93cml0ZV90aW1lX186IHtcbiAgICAgICAgICAgICAgICAgICAgdGltZXN0YW1wVmFsdWU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlY29uZHM6IHQuc2Vjb25kcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbm9zOiB0Lm5hbm9zZWNvbmRzXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBlICYmIChuLmZpZWxkcy5fX3ByZXZpb3VzX3ZhbHVlX18gPSBlKSwge1xuICAgICAgICAgICAgbWFwVmFsdWU6IG5cbiAgICAgICAgfTtcbiAgICB9KG4sIGUpIDogdCBpbnN0YW5jZW9mIE9lID8gRmUodCwgZSkgOiB0IGluc3RhbmNlb2YgTWUgPyBMZSh0LCBlKSA6IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgLy8gUE9SVElORyBOT1RFOiBTaW5jZSBKYXZhU2NyaXB0J3MgaW50ZWdlciBhcml0aG1ldGljIGlzIGxpbWl0ZWQgdG8gNTMgYml0XG4gICAgICAgIC8vIHByZWNpc2lvbiBhbmQgcmVzb2x2ZXMgb3ZlcmZsb3dzIGJ5IHJlZHVjaW5nIHByZWNpc2lvbiwgd2UgZG8gbm90XG4gICAgICAgIC8vIG1hbnVhbGx5IGNhcCBvdmVyZmxvd3MgYXQgMl42My5cbiAgICAgICAgY29uc3QgbiA9IGtlKHQsIGUpLCBzID0gVWUobikgKyBVZSh0LkMpO1xuICAgICAgICByZXR1cm4ga3QobikgJiYga3QodC5DKSA/IFNlKHMpIDogVmUodC5OLCBzKTtcbiAgICB9KHQsIGUpO1xufVxuXG4vKipcbiAqIENvbXB1dGVzIGEgZmluYWwgdHJhbnNmb3JtIHJlc3VsdCBhZnRlciB0aGUgdHJhbnNmb3JtIGhhcyBiZWVuIGFja25vd2xlZGdlZFxuICogYnkgdGhlIHNlcnZlciwgcG90ZW50aWFsbHkgdXNpbmcgdGhlIHNlcnZlci1wcm92aWRlZCB0cmFuc2Zvcm1SZXN1bHQuXG4gKi8gZnVuY3Rpb24geGUodCwgZSwgbikge1xuICAgIC8vIFRoZSBzZXJ2ZXIganVzdCBzZW5kcyBudWxsIGFzIHRoZSB0cmFuc2Zvcm0gcmVzdWx0IGZvciBhcnJheSBvcGVyYXRpb25zLFxuICAgIC8vIHNvIHdlIGhhdmUgdG8gY2FsY3VsYXRlIGEgcmVzdWx0IHRoZSBzYW1lIGFzIHdlIGRvIGZvciBsb2NhbFxuICAgIC8vIGFwcGxpY2F0aW9ucy5cbiAgICByZXR1cm4gdCBpbnN0YW5jZW9mIE9lID8gRmUodCwgZSkgOiB0IGluc3RhbmNlb2YgTWUgPyBMZSh0LCBlKSA6IG47XG59XG5cbi8qKlxuICogSWYgdGhpcyB0cmFuc2Zvcm0gb3BlcmF0aW9uIGlzIG5vdCBpZGVtcG90ZW50LCByZXR1cm5zIHRoZSBiYXNlIHZhbHVlIHRvXG4gKiBwZXJzaXN0IGZvciB0aGlzIHRyYW5zZm9ybS4gSWYgYSBiYXNlIHZhbHVlIGlzIHJldHVybmVkLCB0aGUgdHJhbnNmb3JtXG4gKiBvcGVyYXRpb24gaXMgYWx3YXlzIGFwcGxpZWQgdG8gdGhpcyBiYXNlIHZhbHVlLCBldmVuIGlmIGRvY3VtZW50IGhhc1xuICogYWxyZWFkeSBiZWVuIHVwZGF0ZWQuXG4gKlxuICogQmFzZSB2YWx1ZXMgcHJvdmlkZSBjb25zaXN0ZW50IGJlaGF2aW9yIGZvciBub24taWRlbXBvdGVudCB0cmFuc2Zvcm1zIGFuZFxuICogYWxsb3cgdXMgdG8gcmV0dXJuIHRoZSBzYW1lIGxhdGVuY3ktY29tcGVuc2F0ZWQgdmFsdWUgZXZlbiBpZiB0aGUgYmFja2VuZFxuICogaGFzIGFscmVhZHkgYXBwbGllZCB0aGUgdHJhbnNmb3JtIG9wZXJhdGlvbi4gVGhlIGJhc2UgdmFsdWUgaXMgbnVsbCBmb3JcbiAqIGlkZW1wb3RlbnQgdHJhbnNmb3JtcywgYXMgdGhleSBjYW4gYmUgcmUtcGxheWVkIGV2ZW4gaWYgdGhlIGJhY2tlbmQgaGFzXG4gKiBhbHJlYWR5IGFwcGxpZWQgdGhlbS5cbiAqXG4gKiBAcmV0dXJucyBhIGJhc2UgdmFsdWUgdG8gc3RvcmUgYWxvbmcgd2l0aCB0aGUgbXV0YXRpb24sIG9yIG51bGwgZm9yXG4gKiBpZGVtcG90ZW50IHRyYW5zZm9ybXMuXG4gKi8gZnVuY3Rpb24ga2UodCwgZSkge1xuICAgIHJldHVybiB0IGluc3RhbmNlb2YgQmUgPyBrdChuID0gZSkgfHwgZnVuY3Rpb24odCkge1xuICAgICAgICByZXR1cm4gISF0ICYmIFwiZG91YmxlVmFsdWVcIiBpbiB0O1xuICAgIH1cbiAgICAvKiogUmV0dXJucyB0cnVlIGlmIGB2YWx1ZWAgaXMgZWl0aGVyIGFuIEludGVnZXJWYWx1ZSBvciBhIERvdWJsZVZhbHVlLiAqLyAobikgPyBlIDoge1xuICAgICAgICBpbnRlZ2VyVmFsdWU6IDBcbiAgICB9IDogbnVsbDtcbiAgICB2YXIgbjtcbn1cblxuLyoqIFRyYW5zZm9ybXMgYSB2YWx1ZSBpbnRvIGEgc2VydmVyLWdlbmVyYXRlZCB0aW1lc3RhbXAuICovXG5jbGFzcyAkZSBleHRlbmRzIENlIHt9XG5cbi8qKiBUcmFuc2Zvcm1zIGFuIGFycmF5IHZhbHVlIHZpYSBhIHVuaW9uIG9wZXJhdGlvbi4gKi8gY2xhc3MgT2UgZXh0ZW5kcyBDZSB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICBzdXBlcigpLCB0aGlzLmVsZW1lbnRzID0gdDtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIEZlKHQsIGUpIHtcbiAgICBjb25zdCBuID0gcWUoZSk7XG4gICAgZm9yIChjb25zdCBlIG9mIHQuZWxlbWVudHMpIG4uc29tZSgodCA9PiB2dCh0LCBlKSkpIHx8IG4ucHVzaChlKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBhcnJheVZhbHVlOiB7XG4gICAgICAgICAgICB2YWx1ZXM6IG5cbiAgICAgICAgfVxuICAgIH07XG59XG5cbi8qKiBUcmFuc2Zvcm1zIGFuIGFycmF5IHZhbHVlIHZpYSBhIHJlbW92ZSBvcGVyYXRpb24uICovIGNsYXNzIE1lIGV4dGVuZHMgQ2Uge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5lbGVtZW50cyA9IHQ7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBMZSh0LCBlKSB7XG4gICAgbGV0IG4gPSBxZShlKTtcbiAgICBmb3IgKGNvbnN0IGUgb2YgdC5lbGVtZW50cykgbiA9IG4uZmlsdGVyKCh0ID0+ICF2dCh0LCBlKSkpO1xuICAgIHJldHVybiB7XG4gICAgICAgIGFycmF5VmFsdWU6IHtcbiAgICAgICAgICAgIHZhbHVlczogblxuICAgICAgICB9XG4gICAgfTtcbn1cblxuLyoqXG4gKiBJbXBsZW1lbnRzIHRoZSBiYWNrZW5kIHNlbWFudGljcyBmb3IgbG9jYWxseSBjb21wdXRlZCBOVU1FUklDX0FERCAoaW5jcmVtZW50KVxuICogdHJhbnNmb3Jtcy4gQ29udmVydHMgYWxsIGZpZWxkIHZhbHVlcyB0byBpbnRlZ2VycyBvciBkb3VibGVzLCBidXQgdW5saWtlIHRoZVxuICogYmFja2VuZCBkb2VzIG5vdCBjYXAgaW50ZWdlciB2YWx1ZXMgYXQgMl42My4gSW5zdGVhZCwgSmF2YVNjcmlwdCBudW1iZXJcbiAqIGFyaXRobWV0aWMgaXMgdXNlZCBhbmQgcHJlY2lzaW9uIGxvc3MgY2FuIG9jY3VyIGZvciB2YWx1ZXMgZ3JlYXRlciB0aGFuIDJeNTMuXG4gKi8gY2xhc3MgQmUgZXh0ZW5kcyBDZSB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICBzdXBlcigpLCB0aGlzLk4gPSB0LCB0aGlzLkMgPSBlO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gVWUodCkge1xuICAgIHJldHVybiBndCh0LmludGVnZXJWYWx1ZSB8fCB0LmRvdWJsZVZhbHVlKTtcbn1cblxuZnVuY3Rpb24gcWUodCkge1xuICAgIHJldHVybiAkdCh0KSAmJiB0LmFycmF5VmFsdWUudmFsdWVzID8gdC5hcnJheVZhbHVlLnZhbHVlcy5zbGljZSgpIDogW107XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKiogQSBmaWVsZCBwYXRoIGFuZCB0aGUgVHJhbnNmb3JtT3BlcmF0aW9uIHRvIHBlcmZvcm0gdXBvbiBpdC4gKi8gY2xhc3MgS2Uge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5maWVsZCA9IHQsIHRoaXMudHJhbnNmb3JtID0gZTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGplKHQsIGUpIHtcbiAgICByZXR1cm4gdC5maWVsZC5pc0VxdWFsKGUuZmllbGQpICYmIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHQgaW5zdGFuY2VvZiBPZSAmJiBlIGluc3RhbmNlb2YgT2UgfHwgdCBpbnN0YW5jZW9mIE1lICYmIGUgaW5zdGFuY2VvZiBNZSA/IGV0KHQuZWxlbWVudHMsIGUuZWxlbWVudHMsIHZ0KSA6IHQgaW5zdGFuY2VvZiBCZSAmJiBlIGluc3RhbmNlb2YgQmUgPyB2dCh0LkMsIGUuQykgOiB0IGluc3RhbmNlb2YgJGUgJiYgZSBpbnN0YW5jZW9mICRlO1xuICAgIH0odC50cmFuc2Zvcm0sIGUudHJhbnNmb3JtKTtcbn1cblxuLyoqIFRoZSByZXN1bHQgb2Ygc3VjY2Vzc2Z1bGx5IGFwcGx5aW5nIGEgbXV0YXRpb24gdG8gdGhlIGJhY2tlbmQuICovXG5jbGFzcyBRZSB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgLyoqXG4gICAgICogVGhlIHZlcnNpb24gYXQgd2hpY2ggdGhlIG11dGF0aW9uIHdhcyBjb21taXR0ZWQ6XG4gICAgICpcbiAgICAgKiAtIEZvciBtb3N0IG9wZXJhdGlvbnMsIHRoaXMgaXMgdGhlIHVwZGF0ZVRpbWUgaW4gdGhlIFdyaXRlUmVzdWx0LlxuICAgICAqIC0gRm9yIGRlbGV0ZXMsIHRoZSBjb21taXRUaW1lIG9mIHRoZSBXcml0ZVJlc3BvbnNlIChiZWNhdXNlIGRlbGV0ZXMgYXJlXG4gICAgICogICBub3Qgc3RvcmVkIGFuZCBoYXZlIG5vIHVwZGF0ZVRpbWUpLlxuICAgICAqXG4gICAgICogTm90ZSB0aGF0IHRoZXNlIHZlcnNpb25zIGNhbiBiZSBkaWZmZXJlbnQ6IE5vLW9wIHdyaXRlcyB3aWxsIG5vdCBjaGFuZ2VcbiAgICAgKiB0aGUgdXBkYXRlVGltZSBldmVuIHRob3VnaCB0aGUgY29tbWl0VGltZSBhZHZhbmNlcy5cbiAgICAgKi9cbiAgICB0LCBcbiAgICAvKipcbiAgICAgKiBUaGUgcmVzdWx0aW5nIGZpZWxkcyByZXR1cm5lZCBmcm9tIHRoZSBiYWNrZW5kIGFmdGVyIGEgbXV0YXRpb25cbiAgICAgKiBjb250YWluaW5nIGZpZWxkIHRyYW5zZm9ybXMgaGFzIGJlZW4gY29tbWl0dGVkLiBDb250YWlucyBvbmUgRmllbGRWYWx1ZVxuICAgICAqIGZvciBlYWNoIEZpZWxkVHJhbnNmb3JtIHRoYXQgd2FzIGluIHRoZSBtdXRhdGlvbi5cbiAgICAgKlxuICAgICAqIFdpbGwgYmUgZW1wdHkgaWYgdGhlIG11dGF0aW9uIGRpZCBub3QgY29udGFpbiBhbnkgZmllbGQgdHJhbnNmb3Jtcy5cbiAgICAgKi9cbiAgICBlKSB7XG4gICAgICAgIHRoaXMudmVyc2lvbiA9IHQsIHRoaXMudHJhbnNmb3JtUmVzdWx0cyA9IGU7XG4gICAgfVxufVxuXG4vKipcbiAqIEVuY29kZXMgYSBwcmVjb25kaXRpb24gZm9yIGEgbXV0YXRpb24uIFRoaXMgZm9sbG93cyB0aGUgbW9kZWwgdGhhdCB0aGVcbiAqIGJhY2tlbmQgYWNjZXB0cyB3aXRoIHRoZSBzcGVjaWFsIGNhc2Ugb2YgYW4gZXhwbGljaXQgXCJlbXB0eVwiIHByZWNvbmRpdGlvblxuICogKG1lYW5pbmcgbm8gcHJlY29uZGl0aW9uKS5cbiAqLyBjbGFzcyBXZSB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLnVwZGF0ZVRpbWUgPSB0LCB0aGlzLmV4aXN0cyA9IGU7XG4gICAgfVxuICAgIC8qKiBDcmVhdGVzIGEgbmV3IGVtcHR5IFByZWNvbmRpdGlvbi4gKi8gICAgc3RhdGljIG5vbmUoKSB7XG4gICAgICAgIHJldHVybiBuZXcgV2U7XG4gICAgfVxuICAgIC8qKiBDcmVhdGVzIGEgbmV3IFByZWNvbmRpdGlvbiB3aXRoIGFuIGV4aXN0cyBmbGFnLiAqLyAgICBzdGF0aWMgZXhpc3RzKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBXZSh2b2lkIDAsIHQpO1xuICAgIH1cbiAgICAvKiogQ3JlYXRlcyBhIG5ldyBQcmVjb25kaXRpb24gYmFzZWQgb24gYSB2ZXJzaW9uIGEgZG9jdW1lbnQgZXhpc3RzIGF0LiAqLyAgICBzdGF0aWMgdXBkYXRlVGltZSh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgV2UodCk7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIHdoZXRoZXIgdGhpcyBQcmVjb25kaXRpb24gaXMgZW1wdHkuICovICAgIGdldCBpc05vbmUoKSB7XG4gICAgICAgIHJldHVybiB2b2lkIDAgPT09IHRoaXMudXBkYXRlVGltZSAmJiB2b2lkIDAgPT09IHRoaXMuZXhpc3RzO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZXhpc3RzID09PSB0LmV4aXN0cyAmJiAodGhpcy51cGRhdGVUaW1lID8gISF0LnVwZGF0ZVRpbWUgJiYgdGhpcy51cGRhdGVUaW1lLmlzRXF1YWwodC51cGRhdGVUaW1lKSA6ICF0LnVwZGF0ZVRpbWUpO1xuICAgIH1cbn1cblxuLyoqIFJldHVybnMgdHJ1ZSBpZiB0aGUgcHJlY29uZGl0aW9ucyBpcyB2YWxpZCBmb3IgdGhlIGdpdmVuIGRvY3VtZW50LiAqLyBmdW5jdGlvbiBHZSh0LCBlKSB7XG4gICAgcmV0dXJuIHZvaWQgMCAhPT0gdC51cGRhdGVUaW1lID8gZS5pc0ZvdW5kRG9jdW1lbnQoKSAmJiBlLnZlcnNpb24uaXNFcXVhbCh0LnVwZGF0ZVRpbWUpIDogdm9pZCAwID09PSB0LmV4aXN0cyB8fCB0LmV4aXN0cyA9PT0gZS5pc0ZvdW5kRG9jdW1lbnQoKTtcbn1cblxuLyoqXG4gKiBBIG11dGF0aW9uIGRlc2NyaWJlcyBhIHNlbGYtY29udGFpbmVkIGNoYW5nZSB0byBhIGRvY3VtZW50LiBNdXRhdGlvbnMgY2FuXG4gKiBjcmVhdGUsIHJlcGxhY2UsIGRlbGV0ZSwgYW5kIHVwZGF0ZSBzdWJzZXRzIG9mIGRvY3VtZW50cy5cbiAqXG4gKiBNdXRhdGlvbnMgbm90IG9ubHkgYWN0IG9uIHRoZSB2YWx1ZSBvZiB0aGUgZG9jdW1lbnQgYnV0IGFsc28gaXRzIHZlcnNpb24uXG4gKlxuICogRm9yIGxvY2FsIG11dGF0aW9ucyAobXV0YXRpb25zIHRoYXQgaGF2ZW4ndCBiZWVuIGNvbW1pdHRlZCB5ZXQpLCB3ZSBwcmVzZXJ2ZVxuICogdGhlIGV4aXN0aW5nIHZlcnNpb24gZm9yIFNldCBhbmQgUGF0Y2ggbXV0YXRpb25zLiBGb3IgRGVsZXRlIG11dGF0aW9ucywgd2VcbiAqIHJlc2V0IHRoZSB2ZXJzaW9uIHRvIDAuXG4gKlxuICogSGVyZSdzIHRoZSBleHBlY3RlZCB0cmFuc2l0aW9uIHRhYmxlLlxuICpcbiAqIE1VVEFUSU9OICAgICAgICAgICBBUFBMSUVEIFRPICAgICAgICAgICAgUkVTVUxUUyBJTlxuICpcbiAqIFNldE11dGF0aW9uICAgICAgICBEb2N1bWVudCh2MykgICAgICAgICAgRG9jdW1lbnQodjMpXG4gKiBTZXRNdXRhdGlvbiAgICAgICAgTm9Eb2N1bWVudCh2MykgICAgICAgIERvY3VtZW50KHYwKVxuICogU2V0TXV0YXRpb24gICAgICAgIEludmFsaWREb2N1bWVudCh2MCkgICBEb2N1bWVudCh2MClcbiAqIFBhdGNoTXV0YXRpb24gICAgICBEb2N1bWVudCh2MykgICAgICAgICAgRG9jdW1lbnQodjMpXG4gKiBQYXRjaE11dGF0aW9uICAgICAgTm9Eb2N1bWVudCh2MykgICAgICAgIE5vRG9jdW1lbnQodjMpXG4gKiBQYXRjaE11dGF0aW9uICAgICAgSW52YWxpZERvY3VtZW50KHYwKSAgIFVua25vd25Eb2N1bWVudCh2MylcbiAqIERlbGV0ZU11dGF0aW9uICAgICBEb2N1bWVudCh2MykgICAgICAgICAgTm9Eb2N1bWVudCh2MClcbiAqIERlbGV0ZU11dGF0aW9uICAgICBOb0RvY3VtZW50KHYzKSAgICAgICAgTm9Eb2N1bWVudCh2MClcbiAqIERlbGV0ZU11dGF0aW9uICAgICBJbnZhbGlkRG9jdW1lbnQodjApICAgTm9Eb2N1bWVudCh2MClcbiAqXG4gKiBGb3IgYWNrbm93bGVkZ2VkIG11dGF0aW9ucywgd2UgdXNlIHRoZSB1cGRhdGVUaW1lIG9mIHRoZSBXcml0ZVJlc3BvbnNlIGFzXG4gKiB0aGUgcmVzdWx0aW5nIHZlcnNpb24gZm9yIFNldCBhbmQgUGF0Y2ggbXV0YXRpb25zLiBBcyBkZWxldGVzIGhhdmUgbm9cbiAqIGV4cGxpY2l0IHVwZGF0ZSB0aW1lLCB3ZSB1c2UgdGhlIGNvbW1pdFRpbWUgb2YgdGhlIFdyaXRlUmVzcG9uc2UgZm9yXG4gKiBEZWxldGUgbXV0YXRpb25zLlxuICpcbiAqIElmIGEgbXV0YXRpb24gaXMgYWNrbm93bGVkZ2VkIGJ5IHRoZSBiYWNrZW5kIGJ1dCBmYWlscyB0aGUgcHJlY29uZGl0aW9uIGNoZWNrXG4gKiBsb2NhbGx5LCB3ZSB0cmFuc2l0aW9uIHRvIGFuIGBVbmtub3duRG9jdW1lbnRgIGFuZCByZWx5IG9uIFdhdGNoIHRvIHNlbmQgdXNcbiAqIHRoZSB1cGRhdGVkIHZlcnNpb24uXG4gKlxuICogRmllbGQgdHJhbnNmb3JtcyBhcmUgdXNlZCBvbmx5IHdpdGggUGF0Y2ggYW5kIFNldCBNdXRhdGlvbnMuIFdlIHVzZSB0aGVcbiAqIGB1cGRhdGVUcmFuc2Zvcm1zYCBtZXNzYWdlIHRvIHN0b3JlIHRyYW5zZm9ybXMsIHJhdGhlciB0aGFuIHRoZSBgdHJhbnNmb3Jtc2BzXG4gKiBtZXNzYWdlcy5cbiAqXG4gKiAjIyBTdWJjbGFzc2luZyBOb3Rlc1xuICpcbiAqIEV2ZXJ5IHR5cGUgb2YgbXV0YXRpb24gbmVlZHMgdG8gaW1wbGVtZW50IGl0cyBvd24gYXBwbHlUb1JlbW90ZURvY3VtZW50KCkgYW5kXG4gKiBhcHBseVRvTG9jYWxWaWV3KCkgdG8gaW1wbGVtZW50IHRoZSBhY3R1YWwgYmVoYXZpb3Igb2YgYXBwbHlpbmcgdGhlIG11dGF0aW9uXG4gKiB0byBzb21lIHNvdXJjZSBkb2N1bWVudCAoc2VlIGBhcHBseVNldE11dGF0aW9uVG9SZW1vdGVEb2N1bWVudCgpYCBmb3IgYW5cbiAqIGV4YW1wbGUpLlxuICovIGNsYXNzIHplIHt9XG5cbi8qKlxuICogQXBwbGllcyB0aGlzIG11dGF0aW9uIHRvIHRoZSBnaXZlbiBkb2N1bWVudCBmb3IgdGhlIHB1cnBvc2VzIG9mIGNvbXB1dGluZyBhXG4gKiBuZXcgcmVtb3RlIGRvY3VtZW50LiBJZiB0aGUgaW5wdXQgZG9jdW1lbnQgZG9lc24ndCBtYXRjaCB0aGUgZXhwZWN0ZWQgc3RhdGVcbiAqIChlLmcuIGl0IGlzIGludmFsaWQgb3Igb3V0ZGF0ZWQpLCB0aGUgZG9jdW1lbnQgdHlwZSBtYXkgdHJhbnNpdGlvbiB0b1xuICogdW5rbm93bi5cbiAqXG4gKiBAcGFyYW0gbXV0YXRpb24gLSBUaGUgbXV0YXRpb24gdG8gYXBwbHkuXG4gKiBAcGFyYW0gZG9jdW1lbnQgLSBUaGUgZG9jdW1lbnQgdG8gbXV0YXRlLiBUaGUgaW5wdXQgZG9jdW1lbnQgY2FuIGJlIGFuXG4gKiAgICAgaW52YWxpZCBkb2N1bWVudCBpZiB0aGUgY2xpZW50IGhhcyBubyBrbm93bGVkZ2Ugb2YgdGhlIHByZS1tdXRhdGlvbiBzdGF0ZVxuICogICAgIG9mIHRoZSBkb2N1bWVudC5cbiAqIEBwYXJhbSBtdXRhdGlvblJlc3VsdCAtIFRoZSByZXN1bHQgb2YgYXBwbHlpbmcgdGhlIG11dGF0aW9uIGZyb20gdGhlIGJhY2tlbmQuXG4gKi8gZnVuY3Rpb24gSGUodCwgZSwgbikge1xuICAgIHQgaW5zdGFuY2VvZiB0biA/IGZ1bmN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgLy8gVW5saWtlIGFwcGx5U2V0TXV0YXRpb25Ub0xvY2FsVmlldywgaWYgd2UncmUgYXBwbHlpbmcgYSBtdXRhdGlvbiB0byBhXG4gICAgICAgIC8vIHJlbW90ZSBkb2N1bWVudCB0aGUgc2VydmVyIGhhcyBhY2NlcHRlZCB0aGUgbXV0YXRpb24gc28gdGhlIHByZWNvbmRpdGlvblxuICAgICAgICAvLyBtdXN0IGhhdmUgaGVsZC5cbiAgICAgICAgY29uc3QgcyA9IHQudmFsdWUuY2xvbmUoKSwgaSA9IHNuKHQuZmllbGRUcmFuc2Zvcm1zLCBlLCBuLnRyYW5zZm9ybVJlc3VsdHMpO1xuICAgICAgICBzLnNldEFsbChpKSwgZS5jb252ZXJ0VG9Gb3VuZERvY3VtZW50KG4udmVyc2lvbiwgcykuc2V0SGFzQ29tbWl0dGVkTXV0YXRpb25zKCk7XG4gICAgfSh0LCBlLCBuKSA6IHQgaW5zdGFuY2VvZiBlbiA/IGZ1bmN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgaWYgKCFHZSh0LnByZWNvbmRpdGlvbiwgZSkpIFxuICAgICAgICAvLyBTaW5jZSB0aGUgbXV0YXRpb24gd2FzIG5vdCByZWplY3RlZCwgd2Uga25vdyB0aGF0IHRoZSBwcmVjb25kaXRpb25cbiAgICAgICAgLy8gbWF0Y2hlZCBvbiB0aGUgYmFja2VuZC4gV2UgdGhlcmVmb3JlIG11c3Qgbm90IGhhdmUgdGhlIGV4cGVjdGVkIHZlcnNpb25cbiAgICAgICAgLy8gb2YgdGhlIGRvY3VtZW50IGluIG91ciBjYWNoZSBhbmQgY29udmVydCB0byBhbiBVbmtub3duRG9jdW1lbnQgd2l0aCBhXG4gICAgICAgIC8vIGtub3duIHVwZGF0ZVRpbWUuXG4gICAgICAgIHJldHVybiB2b2lkIGUuY29udmVydFRvVW5rbm93bkRvY3VtZW50KG4udmVyc2lvbik7XG4gICAgICAgIGNvbnN0IHMgPSBzbih0LmZpZWxkVHJhbnNmb3JtcywgZSwgbi50cmFuc2Zvcm1SZXN1bHRzKSwgaSA9IGUuZGF0YTtcbiAgICAgICAgaS5zZXRBbGwobm4odCkpLCBpLnNldEFsbChzKSwgZS5jb252ZXJ0VG9Gb3VuZERvY3VtZW50KG4udmVyc2lvbiwgaSkuc2V0SGFzQ29tbWl0dGVkTXV0YXRpb25zKCk7XG4gICAgfSh0LCBlLCBuKSA6IGZ1bmN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgLy8gVW5saWtlIGFwcGx5VG9Mb2NhbFZpZXcsIGlmIHdlJ3JlIGFwcGx5aW5nIGEgbXV0YXRpb24gdG8gYSByZW1vdGVcbiAgICAgICAgLy8gZG9jdW1lbnQgdGhlIHNlcnZlciBoYXMgYWNjZXB0ZWQgdGhlIG11dGF0aW9uIHNvIHRoZSBwcmVjb25kaXRpb24gbXVzdFxuICAgICAgICAvLyBoYXZlIGhlbGQuXG4gICAgICAgIGUuY29udmVydFRvTm9Eb2N1bWVudChuLnZlcnNpb24pLnNldEhhc0NvbW1pdHRlZE11dGF0aW9ucygpO1xuICAgIH0oMCwgZSwgbik7XG59XG5cbi8qKlxuICogQXBwbGllcyB0aGlzIG11dGF0aW9uIHRvIHRoZSBnaXZlbiBkb2N1bWVudCBmb3IgdGhlIHB1cnBvc2VzIG9mIGNvbXB1dGluZ1xuICogdGhlIG5ldyBsb2NhbCB2aWV3IG9mIGEgZG9jdW1lbnQuIElmIHRoZSBpbnB1dCBkb2N1bWVudCBkb2Vzbid0IG1hdGNoIHRoZVxuICogZXhwZWN0ZWQgc3RhdGUsIHRoZSBkb2N1bWVudCBpcyBub3QgbW9kaWZpZWQuXG4gKlxuICogQHBhcmFtIG11dGF0aW9uIC0gVGhlIG11dGF0aW9uIHRvIGFwcGx5LlxuICogQHBhcmFtIGRvY3VtZW50IC0gVGhlIGRvY3VtZW50IHRvIG11dGF0ZS4gVGhlIGlucHV0IGRvY3VtZW50IGNhbiBiZSBhblxuICogICAgIGludmFsaWQgZG9jdW1lbnQgaWYgdGhlIGNsaWVudCBoYXMgbm8ga25vd2xlZGdlIG9mIHRoZSBwcmUtbXV0YXRpb24gc3RhdGVcbiAqICAgICBvZiB0aGUgZG9jdW1lbnQuXG4gKiBAcGFyYW0gbG9jYWxXcml0ZVRpbWUgLSBBIHRpbWVzdGFtcCBpbmRpY2F0aW5nIHRoZSBsb2NhbCB3cml0ZSB0aW1lIG9mIHRoZVxuICogICAgIGJhdGNoIHRoaXMgbXV0YXRpb24gaXMgYSBwYXJ0IG9mLlxuICovIGZ1bmN0aW9uIEplKHQsIGUsIG4pIHtcbiAgICB0IGluc3RhbmNlb2YgdG4gPyBmdW5jdGlvbih0LCBlLCBuKSB7XG4gICAgICAgIGlmICghR2UodC5wcmVjb25kaXRpb24sIGUpKSBcbiAgICAgICAgLy8gVGhlIG11dGF0aW9uIGZhaWxlZCB0byBhcHBseSAoZS5nLiBhIGRvY3VtZW50IElEIGNyZWF0ZWQgd2l0aCBhZGQoKVxuICAgICAgICAvLyBjYXVzZWQgYSBuYW1lIGNvbGxpc2lvbikuXG4gICAgICAgIHJldHVybjtcbiAgICAgICAgY29uc3QgcyA9IHQudmFsdWUuY2xvbmUoKSwgaSA9IHJuKHQuZmllbGRUcmFuc2Zvcm1zLCBuLCBlKTtcbiAgICAgICAgcy5zZXRBbGwoaSksIGUuY29udmVydFRvRm91bmREb2N1bWVudChaZShlKSwgcykuc2V0SGFzTG9jYWxNdXRhdGlvbnMoKTtcbiAgICB9XG4gICAgLyoqXG4gKiBBIG11dGF0aW9uIHRoYXQgbW9kaWZpZXMgZmllbGRzIG9mIHRoZSBkb2N1bWVudCBhdCB0aGUgZ2l2ZW4ga2V5IHdpdGggdGhlXG4gKiBnaXZlbiB2YWx1ZXMuIFRoZSB2YWx1ZXMgYXJlIGFwcGxpZWQgdGhyb3VnaCBhIGZpZWxkIG1hc2s6XG4gKlxuICogICogV2hlbiBhIGZpZWxkIGlzIGluIGJvdGggdGhlIG1hc2sgYW5kIHRoZSB2YWx1ZXMsIHRoZSBjb3JyZXNwb25kaW5nIGZpZWxkXG4gKiAgICBpcyB1cGRhdGVkLlxuICogICogV2hlbiBhIGZpZWxkIGlzIGluIG5laXRoZXIgdGhlIG1hc2sgbm9yIHRoZSB2YWx1ZXMsIHRoZSBjb3JyZXNwb25kaW5nXG4gKiAgICBmaWVsZCBpcyB1bm1vZGlmaWVkLlxuICogICogV2hlbiBhIGZpZWxkIGlzIGluIHRoZSBtYXNrIGJ1dCBub3QgaW4gdGhlIHZhbHVlcywgdGhlIGNvcnJlc3BvbmRpbmcgZmllbGRcbiAqICAgIGlzIGRlbGV0ZWQuXG4gKiAgKiBXaGVuIGEgZmllbGQgaXMgbm90IGluIHRoZSBtYXNrIGJ1dCBpcyBpbiB0aGUgdmFsdWVzLCB0aGUgdmFsdWVzIG1hcCBpc1xuICogICAgaWdub3JlZC5cbiAqLyAodCwgZSwgbikgOiB0IGluc3RhbmNlb2YgZW4gPyBmdW5jdGlvbih0LCBlLCBuKSB7XG4gICAgICAgIGlmICghR2UodC5wcmVjb25kaXRpb24sIGUpKSByZXR1cm47XG4gICAgICAgIGNvbnN0IHMgPSBybih0LmZpZWxkVHJhbnNmb3JtcywgbiwgZSksIGkgPSBlLmRhdGE7XG4gICAgICAgIGkuc2V0QWxsKG5uKHQpKSwgaS5zZXRBbGwocyksIGUuY29udmVydFRvRm91bmREb2N1bWVudChaZShlKSwgaSkuc2V0SGFzTG9jYWxNdXRhdGlvbnMoKTtcbiAgICB9XG4gICAgLyoqXG4gKiBSZXR1cm5zIGEgRmllbGRQYXRoL1ZhbHVlIG1hcCB3aXRoIHRoZSBjb250ZW50IG9mIHRoZSBQYXRjaE11dGF0aW9uLlxuICovICh0LCBlLCBuKSA6IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgR2UodC5wcmVjb25kaXRpb24sIGUpICYmIFxuICAgICAgICAvLyBXZSBkb24ndCBjYWxsIGBzZXRIYXNMb2NhbE11dGF0aW9ucygpYCBzaW5jZSB3ZSB3YW50IHRvIGJlIGJhY2t3YXJkc1xuICAgICAgICAvLyBjb21wYXRpYmxlIHdpdGggdGhlIGV4aXN0aW5nIFNESyBiZWhhdmlvci5cbiAgICAgICAgZS5jb252ZXJ0VG9Ob0RvY3VtZW50KGl0Lm1pbigpKTtcbiAgICB9XG4gICAgLyoqXG4gKiBBIG11dGF0aW9uIHRoYXQgdmVyaWZpZXMgdGhlIGV4aXN0ZW5jZSBvZiB0aGUgZG9jdW1lbnQgYXQgdGhlIGdpdmVuIGtleSB3aXRoXG4gKiB0aGUgcHJvdmlkZWQgcHJlY29uZGl0aW9uLlxuICpcbiAqIFRoZSBgdmVyaWZ5YCBvcGVyYXRpb24gaXMgb25seSB1c2VkIGluIFRyYW5zYWN0aW9ucywgYW5kIHRoaXMgY2xhc3Mgc2VydmVzXG4gKiBwcmltYXJpbHkgdG8gZmFjaWxpdGF0ZSBzZXJpYWxpemF0aW9uIGludG8gcHJvdG9zLlxuICovICh0LCBlKTtcbn1cblxuLyoqXG4gKiBJZiB0aGlzIG11dGF0aW9uIGlzIG5vdCBpZGVtcG90ZW50LCByZXR1cm5zIHRoZSBiYXNlIHZhbHVlIHRvIHBlcnNpc3Qgd2l0aFxuICogdGhpcyBtdXRhdGlvbi4gSWYgYSBiYXNlIHZhbHVlIGlzIHJldHVybmVkLCB0aGUgbXV0YXRpb24gaXMgYWx3YXlzIGFwcGxpZWRcbiAqIHRvIHRoaXMgYmFzZSB2YWx1ZSwgZXZlbiBpZiBkb2N1bWVudCBoYXMgYWxyZWFkeSBiZWVuIHVwZGF0ZWQuXG4gKlxuICogVGhlIGJhc2UgdmFsdWUgaXMgYSBzcGFyc2Ugb2JqZWN0IHRoYXQgY29uc2lzdHMgb2Ygb25seSB0aGUgZG9jdW1lbnRcbiAqIGZpZWxkcyBmb3Igd2hpY2ggdGhpcyBtdXRhdGlvbiBjb250YWlucyBhIG5vbi1pZGVtcG90ZW50IHRyYW5zZm9ybWF0aW9uXG4gKiAoZS5nLiBhIG51bWVyaWMgaW5jcmVtZW50KS4gVGhlIHByb3ZpZGVkIHZhbHVlIGd1YXJhbnRlZXMgY29uc2lzdGVudFxuICogYmVoYXZpb3IgZm9yIG5vbi1pZGVtcG90ZW50IHRyYW5zZm9ybXMgYW5kIGFsbG93IHVzIHRvIHJldHVybiB0aGUgc2FtZVxuICogbGF0ZW5jeS1jb21wZW5zYXRlZCB2YWx1ZSBldmVuIGlmIHRoZSBiYWNrZW5kIGhhcyBhbHJlYWR5IGFwcGxpZWQgdGhlXG4gKiBtdXRhdGlvbi4gVGhlIGJhc2UgdmFsdWUgaXMgbnVsbCBmb3IgaWRlbXBvdGVudCBtdXRhdGlvbnMsIGFzIHRoZXkgY2FuIGJlXG4gKiByZS1wbGF5ZWQgZXZlbiBpZiB0aGUgYmFja2VuZCBoYXMgYWxyZWFkeSBhcHBsaWVkIHRoZW0uXG4gKlxuICogQHJldHVybnMgYSBiYXNlIHZhbHVlIHRvIHN0b3JlIGFsb25nIHdpdGggdGhlIG11dGF0aW9uLCBvciBudWxsIGZvclxuICogaWRlbXBvdGVudCBtdXRhdGlvbnMuXG4gKi8gZnVuY3Rpb24gWWUodCwgZSkge1xuICAgIGxldCBuID0gbnVsbDtcbiAgICBmb3IgKGNvbnN0IHMgb2YgdC5maWVsZFRyYW5zZm9ybXMpIHtcbiAgICAgICAgY29uc3QgdCA9IGUuZGF0YS5maWVsZChzLmZpZWxkKSwgaSA9IGtlKHMudHJhbnNmb3JtLCB0IHx8IG51bGwpO1xuICAgICAgICBudWxsICE9IGkgJiYgKG51bGwgPT0gbiAmJiAobiA9IEJ0LmVtcHR5KCkpLCBuLnNldChzLmZpZWxkLCBpKSk7XG4gICAgfVxuICAgIHJldHVybiBuIHx8IG51bGw7XG59XG5cbmZ1bmN0aW9uIFhlKHQsIGUpIHtcbiAgICByZXR1cm4gdC50eXBlID09PSBlLnR5cGUgJiYgKCEhdC5rZXkuaXNFcXVhbChlLmtleSkgJiYgKCEhdC5wcmVjb25kaXRpb24uaXNFcXVhbChlLnByZWNvbmRpdGlvbikgJiYgKCEhZnVuY3Rpb24odCwgZSkge1xuICAgICAgICByZXR1cm4gdm9pZCAwID09PSB0ICYmIHZvaWQgMCA9PT0gZSB8fCAhKCF0IHx8ICFlKSAmJiBldCh0LCBlLCAoKHQsIGUpID0+IGplKHQsIGUpKSk7XG4gICAgfSh0LmZpZWxkVHJhbnNmb3JtcywgZS5maWVsZFRyYW5zZm9ybXMpICYmICgwIC8qIFNldCAqLyA9PT0gdC50eXBlID8gdC52YWx1ZS5pc0VxdWFsKGUudmFsdWUpIDogMSAvKiBQYXRjaCAqLyAhPT0gdC50eXBlIHx8IHQuZGF0YS5pc0VxdWFsKGUuZGF0YSkgJiYgdC5maWVsZE1hc2suaXNFcXVhbChlLmZpZWxkTWFzaykpKSkpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIHZlcnNpb24gZnJvbSB0aGUgZ2l2ZW4gZG9jdW1lbnQgZm9yIHVzZSBhcyB0aGUgcmVzdWx0IG9mIGFcbiAqIG11dGF0aW9uLiBNdXRhdGlvbnMgYXJlIGRlZmluZWQgdG8gcmV0dXJuIHRoZSB2ZXJzaW9uIG9mIHRoZSBiYXNlIGRvY3VtZW50XG4gKiBvbmx5IGlmIGl0IGlzIGFuIGV4aXN0aW5nIGRvY3VtZW50LiBEZWxldGVkIGFuZCB1bmtub3duIGRvY3VtZW50cyBoYXZlIGFcbiAqIHBvc3QtbXV0YXRpb24gdmVyc2lvbiBvZiBTbmFwc2hvdFZlcnNpb24ubWluKCkuXG4gKi8gZnVuY3Rpb24gWmUodCkge1xuICAgIHJldHVybiB0LmlzRm91bmREb2N1bWVudCgpID8gdC52ZXJzaW9uIDogaXQubWluKCk7XG59XG5cbi8qKlxuICogQSBtdXRhdGlvbiB0aGF0IGNyZWF0ZXMgb3IgcmVwbGFjZXMgdGhlIGRvY3VtZW50IGF0IHRoZSBnaXZlbiBrZXkgd2l0aCB0aGVcbiAqIG9iamVjdCB2YWx1ZSBjb250ZW50cy5cbiAqLyBjbGFzcyB0biBleHRlbmRzIHplIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzID0gW10pIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5rZXkgPSB0LCB0aGlzLnZhbHVlID0gZSwgdGhpcy5wcmVjb25kaXRpb24gPSBuLCB0aGlzLmZpZWxkVHJhbnNmb3JtcyA9IHMsIFxuICAgICAgICB0aGlzLnR5cGUgPSAwIC8qIFNldCAqLztcbiAgICB9XG59XG5cbmNsYXNzIGVuIGV4dGVuZHMgemUge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIHMsIGkgPSBbXSkge1xuICAgICAgICBzdXBlcigpLCB0aGlzLmtleSA9IHQsIHRoaXMuZGF0YSA9IGUsIHRoaXMuZmllbGRNYXNrID0gbiwgdGhpcy5wcmVjb25kaXRpb24gPSBzLCBcbiAgICAgICAgdGhpcy5maWVsZFRyYW5zZm9ybXMgPSBpLCB0aGlzLnR5cGUgPSAxIC8qIFBhdGNoICovO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gbm4odCkge1xuICAgIGNvbnN0IGUgPSBuZXcgTWFwO1xuICAgIHJldHVybiB0LmZpZWxkTWFzay5maWVsZHMuZm9yRWFjaCgobiA9PiB7XG4gICAgICAgIGlmICghbi5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSB0LmRhdGEuZmllbGQobik7XG4gICAgICAgICAgICBlLnNldChuLCBzKTtcbiAgICAgICAgfVxuICAgIH0pKSwgZTtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgbGlzdCBvZiBcInRyYW5zZm9ybSByZXN1bHRzXCIgKGEgdHJhbnNmb3JtIHJlc3VsdCBpcyBhIGZpZWxkIHZhbHVlXG4gKiByZXByZXNlbnRpbmcgdGhlIHJlc3VsdCBvZiBhcHBseWluZyBhIHRyYW5zZm9ybSkgZm9yIHVzZSBhZnRlciBhIG11dGF0aW9uXG4gKiBjb250YWluaW5nIHRyYW5zZm9ybXMgaGFzIGJlZW4gYWNrbm93bGVkZ2VkIGJ5IHRoZSBzZXJ2ZXIuXG4gKlxuICogQHBhcmFtIGZpZWxkVHJhbnNmb3JtcyAtIFRoZSBmaWVsZCB0cmFuc2Zvcm1zIHRvIGFwcGx5IHRoZSByZXN1bHQgdG8uXG4gKiBAcGFyYW0gbXV0YWJsZURvY3VtZW50IC0gVGhlIGN1cnJlbnQgc3RhdGUgb2YgdGhlIGRvY3VtZW50IGFmdGVyIGFwcGx5aW5nIGFsbFxuICogcHJldmlvdXMgbXV0YXRpb25zLlxuICogQHBhcmFtIHNlcnZlclRyYW5zZm9ybVJlc3VsdHMgLSBUaGUgdHJhbnNmb3JtIHJlc3VsdHMgcmVjZWl2ZWQgYnkgdGhlIHNlcnZlci5cbiAqIEByZXR1cm5zIFRoZSB0cmFuc2Zvcm0gcmVzdWx0cyBsaXN0LlxuICovIGZ1bmN0aW9uIHNuKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gbmV3IE1hcDtcbiAgICBMKHQubGVuZ3RoID09PSBuLmxlbmd0aCk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHIgPSB0W2ldLCBvID0gci50cmFuc2Zvcm0sIGEgPSBlLmRhdGEuZmllbGQoci5maWVsZCk7XG4gICAgICAgIHMuc2V0KHIuZmllbGQsIHhlKG8sIGEsIG5baV0pKTtcbiAgICB9XG4gICAgcmV0dXJuIHM7XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIGxpc3Qgb2YgXCJ0cmFuc2Zvcm0gcmVzdWx0c1wiIChhIHRyYW5zZm9ybSByZXN1bHQgaXMgYSBmaWVsZCB2YWx1ZVxuICogcmVwcmVzZW50aW5nIHRoZSByZXN1bHQgb2YgYXBwbHlpbmcgYSB0cmFuc2Zvcm0pIGZvciB1c2Ugd2hlbiBhcHBseWluZyBhXG4gKiB0cmFuc2Zvcm0gbG9jYWxseS5cbiAqXG4gKiBAcGFyYW0gZmllbGRUcmFuc2Zvcm1zIC0gVGhlIGZpZWxkIHRyYW5zZm9ybXMgdG8gYXBwbHkgdGhlIHJlc3VsdCB0by5cbiAqIEBwYXJhbSBsb2NhbFdyaXRlVGltZSAtIFRoZSBsb2NhbCB0aW1lIG9mIHRoZSBtdXRhdGlvbiAodXNlZCB0b1xuICogICAgIGdlbmVyYXRlIFNlcnZlclRpbWVzdGFtcFZhbHVlcykuXG4gKiBAcGFyYW0gbXV0YWJsZURvY3VtZW50IC0gVGhlIGN1cnJlbnQgc3RhdGUgb2YgdGhlIGRvY3VtZW50IGFmdGVyIGFwcGx5aW5nIGFsbFxuICogICAgIHByZXZpb3VzIG11dGF0aW9ucy5cbiAqIEByZXR1cm5zIFRoZSB0cmFuc2Zvcm0gcmVzdWx0cyBsaXN0LlxuICovIGZ1bmN0aW9uIHJuKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gbmV3IE1hcDtcbiAgICBmb3IgKGNvbnN0IGkgb2YgdCkge1xuICAgICAgICBjb25zdCB0ID0gaS50cmFuc2Zvcm0sIHIgPSBuLmRhdGEuZmllbGQoaS5maWVsZCk7XG4gICAgICAgIHMuc2V0KGkuZmllbGQsIE5lKHQsIHIsIGUpKTtcbiAgICB9XG4gICAgcmV0dXJuIHM7XG59XG5cbi8qKiBBIG11dGF0aW9uIHRoYXQgZGVsZXRlcyB0aGUgZG9jdW1lbnQgYXQgdGhlIGdpdmVuIGtleS4gKi8gY2xhc3Mgb24gZXh0ZW5kcyB6ZSB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICBzdXBlcigpLCB0aGlzLmtleSA9IHQsIHRoaXMucHJlY29uZGl0aW9uID0gZSwgdGhpcy50eXBlID0gMiAvKiBEZWxldGUgKi8gLCB0aGlzLmZpZWxkVHJhbnNmb3JtcyA9IFtdO1xuICAgIH1cbn1cblxuY2xhc3MgYW4gZXh0ZW5kcyB6ZSB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICBzdXBlcigpLCB0aGlzLmtleSA9IHQsIHRoaXMucHJlY29uZGl0aW9uID0gZSwgdGhpcy50eXBlID0gMyAvKiBWZXJpZnkgKi8gLCB0aGlzLmZpZWxkVHJhbnNmb3JtcyA9IFtdO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY2xhc3MgY24ge1xuICAgIC8vIFRPRE8oYi8zMzA3ODE2Myk6IGp1c3QgdXNlIHNpbXBsZXN0IGZvcm0gb2YgZXhpc3RlbmNlIGZpbHRlciBmb3Igbm93XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLmNvdW50ID0gdDtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEVycm9yIENvZGVzIGRlc2NyaWJpbmcgdGhlIGRpZmZlcmVudCB3YXlzIEdSUEMgY2FuIGZhaWwuIFRoZXNlIGFyZSBjb3BpZWRcbiAqIGRpcmVjdGx5IGZyb20gR1JQQydzIHNvdXJjZXMgaGVyZTpcbiAqXG4gKiBodHRwczovL2dpdGh1Yi5jb20vZ3JwYy9ncnBjL2Jsb2IvYmNlZWM5NGVhNGZjNWYwMDg1ZDgxMjM1ZDhlMWMwNjc5OGRjMzQxYS9pbmNsdWRlL2dycGMlMkIlMkIvaW1wbC9jb2RlZ2VuL3N0YXR1c19jb2RlX2VudW0uaFxuICpcbiAqIEltcG9ydGFudCEgVGhlIG5hbWVzIG9mIHRoZXNlIGlkZW50aWZpZXJzIG1hdHRlciBiZWNhdXNlIHRoZSBzdHJpbmcgZm9ybXNcbiAqIGFyZSB1c2VkIGZvciByZXZlcnNlIGxvb2t1cHMgZnJvbSB0aGUgd2ViY2hhbm5lbCBzdHJlYW0uIERvIE5PVCBjaGFuZ2UgdGhlXG4gKiBuYW1lcyBvZiB0aGVzZSBpZGVudGlmaWVycyBvciBjaGFuZ2UgdGhpcyBpbnRvIGEgY29uc3QgZW51bS5cbiAqLyB2YXIgdW4sIGhuO1xuXG4vKipcbiAqIERldGVybWluZXMgd2hldGhlciBhbiBlcnJvciBjb2RlIHJlcHJlc2VudHMgYSBwZXJtYW5lbnQgZXJyb3Igd2hlbiByZWNlaXZlZFxuICogaW4gcmVzcG9uc2UgdG8gYSBub24td3JpdGUgb3BlcmF0aW9uLlxuICpcbiAqIFNlZSBpc1Blcm1hbmVudFdyaXRlRXJyb3IgZm9yIGNsYXNzaWZ5aW5nIHdyaXRlIGVycm9ycy5cbiAqL1xuZnVuY3Rpb24gbG4odCkge1xuICAgIHN3aXRjaCAodCkge1xuICAgICAgY2FzZSBxLk9LOlxuICAgICAgICByZXR1cm4gTSgpO1xuXG4gICAgICBjYXNlIHEuQ0FOQ0VMTEVEOlxuICAgICAgY2FzZSBxLlVOS05PV046XG4gICAgICBjYXNlIHEuREVBRExJTkVfRVhDRUVERUQ6XG4gICAgICBjYXNlIHEuUkVTT1VSQ0VfRVhIQVVTVEVEOlxuICAgICAgY2FzZSBxLklOVEVSTkFMOlxuICAgICAgY2FzZSBxLlVOQVZBSUxBQkxFOlxuIC8vIFVuYXV0aGVudGljYXRlZCBtZWFucyBzb21ldGhpbmcgd2VudCB3cm9uZyB3aXRoIG91ciB0b2tlbiBhbmQgd2UgbmVlZFxuICAgICAgICAvLyB0byByZXRyeSB3aXRoIG5ldyBjcmVkZW50aWFscyB3aGljaCB3aWxsIGhhcHBlbiBhdXRvbWF0aWNhbGx5LlxuICAgICAgICAgICAgICBjYXNlIHEuVU5BVVRIRU5USUNBVEVEOlxuICAgICAgICByZXR1cm4gITE7XG5cbiAgICAgIGNhc2UgcS5JTlZBTElEX0FSR1VNRU5UOlxuICAgICAgY2FzZSBxLk5PVF9GT1VORDpcbiAgICAgIGNhc2UgcS5BTFJFQURZX0VYSVNUUzpcbiAgICAgIGNhc2UgcS5QRVJNSVNTSU9OX0RFTklFRDpcbiAgICAgIGNhc2UgcS5GQUlMRURfUFJFQ09ORElUSU9OOlxuIC8vIEFib3J0ZWQgbWlnaHQgYmUgcmV0cmllZCBpbiBzb21lIHNjZW5hcmlvcywgYnV0IHRoYXQgaXMgZGVwZW5kYW50IG9uXG4gICAgICAgIC8vIHRoZSBjb250ZXh0IGFuZCBzaG91bGQgaGFuZGxlZCBpbmRpdmlkdWFsbHkgYnkgdGhlIGNhbGxpbmcgY29kZS5cbiAgICAgICAgLy8gU2VlIGh0dHBzOi8vY2xvdWQuZ29vZ2xlLmNvbS9hcGlzL2Rlc2lnbi9lcnJvcnMuXG4gICAgICAgICAgICAgIGNhc2UgcS5BQk9SVEVEOlxuICAgICAgY2FzZSBxLk9VVF9PRl9SQU5HRTpcbiAgICAgIGNhc2UgcS5VTklNUExFTUVOVEVEOlxuICAgICAgY2FzZSBxLkRBVEFfTE9TUzpcbiAgICAgICAgcmV0dXJuICEwO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gTSgpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBEZXRlcm1pbmVzIHdoZXRoZXIgYW4gZXJyb3IgY29kZSByZXByZXNlbnRzIGEgcGVybWFuZW50IGVycm9yIHdoZW4gcmVjZWl2ZWRcbiAqIGluIHJlc3BvbnNlIHRvIGEgd3JpdGUgb3BlcmF0aW9uLlxuICpcbiAqIFdyaXRlIG9wZXJhdGlvbnMgbXVzdCBiZSBoYW5kbGVkIHNwZWNpYWxseSBiZWNhdXNlIGFzIG9mIGIvMTE5NDM3NzY0LCBBQk9SVEVEXG4gKiBlcnJvcnMgb24gdGhlIHdyaXRlIHN0cmVhbSBzaG91bGQgYmUgcmV0cmllZCB0b28gKGV2ZW4gdGhvdWdoIEFCT1JURUQgZXJyb3JzXG4gKiBhcmUgbm90IGdlbmVyYWxseSByZXRyeWFibGUpLlxuICpcbiAqIE5vdGUgdGhhdCBkdXJpbmcgdGhlIGluaXRpYWwgaGFuZHNoYWtlIG9uIHRoZSB3cml0ZSBzdHJlYW0gYW4gQUJPUlRFRCBlcnJvclxuICogc2lnbmFscyB0aGF0IHdlIHNob3VsZCBkaXNjYXJkIG91ciBzdHJlYW0gdG9rZW4gKGkuZS4gaXQgaXMgcGVybWFuZW50KS4gVGhpc1xuICogbWVhbnMgYSBoYW5kc2hha2UgZXJyb3Igc2hvdWxkIGJlIGNsYXNzaWZpZWQgd2l0aCBpc1Blcm1hbmVudEVycm9yLCBhYm92ZS5cbiAqL1xuLyoqXG4gKiBNYXBzIGFuIGVycm9yIENvZGUgZnJvbSBHUlBDIHN0YXR1cyBjb2RlIG51bWJlciwgbGlrZSAwLCAxLCBvciAxNC4gVGhlc2VcbiAqIGFyZSBub3QgdGhlIHNhbWUgYXMgSFRUUCBzdGF0dXMgY29kZXMuXG4gKlxuICogQHJldHVybnMgVGhlIENvZGUgZXF1aXZhbGVudCB0byB0aGUgZ2l2ZW4gR1JQQyBzdGF0dXMgY29kZS4gRmFpbHMgaWYgdGhlcmVcbiAqICAgICBpcyBubyBtYXRjaC5cbiAqL1xuZnVuY3Rpb24gZm4odCkge1xuICAgIGlmICh2b2lkIDAgPT09IHQpIFxuICAgIC8vIFRoaXMgc2hvdWxkbid0IG5vcm1hbGx5IGhhcHBlbiwgYnV0IGluIGNlcnRhaW4gZXJyb3IgY2FzZXMgKGxpa2UgdHJ5aW5nXG4gICAgLy8gdG8gc2VuZCBpbnZhbGlkIHByb3RvIG1lc3NhZ2VzKSB3ZSBtYXkgZ2V0IGFuIGVycm9yIHdpdGggbm8gR1JQQyBjb2RlLlxuICAgIHJldHVybiAkKFwiR1JQQyBlcnJvciBoYXMgbm8gLmNvZGVcIiksIHEuVU5LTk9XTjtcbiAgICBzd2l0Y2ggKHQpIHtcbiAgICAgIGNhc2UgdW4uT0s6XG4gICAgICAgIHJldHVybiBxLk9LO1xuXG4gICAgICBjYXNlIHVuLkNBTkNFTExFRDpcbiAgICAgICAgcmV0dXJuIHEuQ0FOQ0VMTEVEO1xuXG4gICAgICBjYXNlIHVuLlVOS05PV046XG4gICAgICAgIHJldHVybiBxLlVOS05PV047XG5cbiAgICAgIGNhc2UgdW4uREVBRExJTkVfRVhDRUVERUQ6XG4gICAgICAgIHJldHVybiBxLkRFQURMSU5FX0VYQ0VFREVEO1xuXG4gICAgICBjYXNlIHVuLlJFU09VUkNFX0VYSEFVU1RFRDpcbiAgICAgICAgcmV0dXJuIHEuUkVTT1VSQ0VfRVhIQVVTVEVEO1xuXG4gICAgICBjYXNlIHVuLklOVEVSTkFMOlxuICAgICAgICByZXR1cm4gcS5JTlRFUk5BTDtcblxuICAgICAgY2FzZSB1bi5VTkFWQUlMQUJMRTpcbiAgICAgICAgcmV0dXJuIHEuVU5BVkFJTEFCTEU7XG5cbiAgICAgIGNhc2UgdW4uVU5BVVRIRU5USUNBVEVEOlxuICAgICAgICByZXR1cm4gcS5VTkFVVEhFTlRJQ0FURUQ7XG5cbiAgICAgIGNhc2UgdW4uSU5WQUxJRF9BUkdVTUVOVDpcbiAgICAgICAgcmV0dXJuIHEuSU5WQUxJRF9BUkdVTUVOVDtcblxuICAgICAgY2FzZSB1bi5OT1RfRk9VTkQ6XG4gICAgICAgIHJldHVybiBxLk5PVF9GT1VORDtcblxuICAgICAgY2FzZSB1bi5BTFJFQURZX0VYSVNUUzpcbiAgICAgICAgcmV0dXJuIHEuQUxSRUFEWV9FWElTVFM7XG5cbiAgICAgIGNhc2UgdW4uUEVSTUlTU0lPTl9ERU5JRUQ6XG4gICAgICAgIHJldHVybiBxLlBFUk1JU1NJT05fREVOSUVEO1xuXG4gICAgICBjYXNlIHVuLkZBSUxFRF9QUkVDT05ESVRJT046XG4gICAgICAgIHJldHVybiBxLkZBSUxFRF9QUkVDT05ESVRJT047XG5cbiAgICAgIGNhc2UgdW4uQUJPUlRFRDpcbiAgICAgICAgcmV0dXJuIHEuQUJPUlRFRDtcblxuICAgICAgY2FzZSB1bi5PVVRfT0ZfUkFOR0U6XG4gICAgICAgIHJldHVybiBxLk9VVF9PRl9SQU5HRTtcblxuICAgICAgY2FzZSB1bi5VTklNUExFTUVOVEVEOlxuICAgICAgICByZXR1cm4gcS5VTklNUExFTUVOVEVEO1xuXG4gICAgICBjYXNlIHVuLkRBVEFfTE9TUzpcbiAgICAgICAgcmV0dXJuIHEuREFUQV9MT1NTO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gTSgpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDb252ZXJ0cyBhbiBIVFRQIHJlc3BvbnNlJ3MgZXJyb3Igc3RhdHVzIHRvIHRoZSBlcXVpdmFsZW50IGVycm9yIGNvZGUuXG4gKlxuICogQHBhcmFtIHN0YXR1cyAtIEFuIEhUVFAgZXJyb3IgcmVzcG9uc2Ugc3RhdHVzIChcIkZBSUxFRF9QUkVDT05ESVRJT05cIixcbiAqIFwiVU5LTk9XTlwiLCBldGMuKVxuICogQHJldHVybnMgVGhlIGVxdWl2YWxlbnQgQ29kZS4gTm9uLW1hdGNoaW5nIHJlc3BvbnNlcyBhcmUgbWFwcGVkIHRvXG4gKiAgICAgQ29kZS5VTktOT1dOLlxuICovIChobiA9IHVuIHx8ICh1biA9IHt9KSlbaG4uT0sgPSAwXSA9IFwiT0tcIiwgaG5baG4uQ0FOQ0VMTEVEID0gMV0gPSBcIkNBTkNFTExFRFwiLCBcbmhuW2huLlVOS05PV04gPSAyXSA9IFwiVU5LTk9XTlwiLCBobltobi5JTlZBTElEX0FSR1VNRU5UID0gM10gPSBcIklOVkFMSURfQVJHVU1FTlRcIiwgXG5obltobi5ERUFETElORV9FWENFRURFRCA9IDRdID0gXCJERUFETElORV9FWENFRURFRFwiLCBobltobi5OT1RfRk9VTkQgPSA1XSA9IFwiTk9UX0ZPVU5EXCIsIFxuaG5baG4uQUxSRUFEWV9FWElTVFMgPSA2XSA9IFwiQUxSRUFEWV9FWElTVFNcIiwgaG5baG4uUEVSTUlTU0lPTl9ERU5JRUQgPSA3XSA9IFwiUEVSTUlTU0lPTl9ERU5JRURcIiwgXG5obltobi5VTkFVVEhFTlRJQ0FURUQgPSAxNl0gPSBcIlVOQVVUSEVOVElDQVRFRFwiLCBobltobi5SRVNPVVJDRV9FWEhBVVNURUQgPSA4XSA9IFwiUkVTT1VSQ0VfRVhIQVVTVEVEXCIsIFxuaG5baG4uRkFJTEVEX1BSRUNPTkRJVElPTiA9IDldID0gXCJGQUlMRURfUFJFQ09ORElUSU9OXCIsIGhuW2huLkFCT1JURUQgPSAxMF0gPSBcIkFCT1JURURcIiwgXG5obltobi5PVVRfT0ZfUkFOR0UgPSAxMV0gPSBcIk9VVF9PRl9SQU5HRVwiLCBobltobi5VTklNUExFTUVOVEVEID0gMTJdID0gXCJVTklNUExFTUVOVEVEXCIsIFxuaG5baG4uSU5URVJOQUwgPSAxM10gPSBcIklOVEVSTkFMXCIsIGhuW2huLlVOQVZBSUxBQkxFID0gMTRdID0gXCJVTkFWQUlMQUJMRVwiLCBobltobi5EQVRBX0xPU1MgPSAxNV0gPSBcIkRBVEFfTE9TU1wiO1xuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLy8gQW4gaW1tdXRhYmxlIHNvcnRlZCBtYXAgaW1wbGVtZW50YXRpb24sIGJhc2VkIG9uIGEgTGVmdC1sZWFuaW5nIFJlZC1CbGFja1xuLy8gdHJlZS5cbmNsYXNzIGRuIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMuY29tcGFyYXRvciA9IHQsIHRoaXMucm9vdCA9IGUgfHwgX24uRU1QVFk7XG4gICAgfVxuICAgIC8vIFJldHVybnMgYSBjb3B5IG9mIHRoZSBtYXAsIHdpdGggdGhlIHNwZWNpZmllZCBrZXkvdmFsdWUgYWRkZWQgb3IgcmVwbGFjZWQuXG4gICAgaW5zZXJ0KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBkbih0aGlzLmNvbXBhcmF0b3IsIHRoaXMucm9vdC5pbnNlcnQodCwgZSwgdGhpcy5jb21wYXJhdG9yKS5jb3B5KG51bGwsIG51bGwsIF9uLkJMQUNLLCBudWxsLCBudWxsKSk7XG4gICAgfVxuICAgIC8vIFJldHVybnMgYSBjb3B5IG9mIHRoZSBtYXAsIHdpdGggdGhlIHNwZWNpZmllZCBrZXkgcmVtb3ZlZC5cbiAgICByZW1vdmUodCkge1xuICAgICAgICByZXR1cm4gbmV3IGRuKHRoaXMuY29tcGFyYXRvciwgdGhpcy5yb290LnJlbW92ZSh0LCB0aGlzLmNvbXBhcmF0b3IpLmNvcHkobnVsbCwgbnVsbCwgX24uQkxBQ0ssIG51bGwsIG51bGwpKTtcbiAgICB9XG4gICAgLy8gUmV0dXJucyB0aGUgdmFsdWUgb2YgdGhlIG5vZGUgd2l0aCB0aGUgZ2l2ZW4ga2V5LCBvciBudWxsLlxuICAgIGdldCh0KSB7XG4gICAgICAgIGxldCBlID0gdGhpcy5yb290O1xuICAgICAgICBmb3IgKDshZS5pc0VtcHR5KCk7ICkge1xuICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuY29tcGFyYXRvcih0LCBlLmtleSk7XG4gICAgICAgICAgICBpZiAoMCA9PT0gbikgcmV0dXJuIGUudmFsdWU7XG4gICAgICAgICAgICBuIDwgMCA/IGUgPSBlLmxlZnQgOiBuID4gMCAmJiAoZSA9IGUucmlnaHQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIHRoZSBpbmRleCBvZiB0aGUgZWxlbWVudCBpbiB0aGlzIHNvcnRlZCBtYXAsIG9yIC0xIGlmIGl0IGRvZXNuJ3RcbiAgICAvLyBleGlzdC5cbiAgICBpbmRleE9mKHQpIHtcbiAgICAgICAgLy8gTnVtYmVyIG9mIG5vZGVzIHRoYXQgd2VyZSBwcnVuZWQgd2hlbiBkZXNjZW5kaW5nIHJpZ2h0XG4gICAgICAgIGxldCBlID0gMCwgbiA9IHRoaXMucm9vdDtcbiAgICAgICAgZm9yICg7IW4uaXNFbXB0eSgpOyApIHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSB0aGlzLmNvbXBhcmF0b3IodCwgbi5rZXkpO1xuICAgICAgICAgICAgaWYgKDAgPT09IHMpIHJldHVybiBlICsgbi5sZWZ0LnNpemU7XG4gICAgICAgICAgICBzIDwgMCA/IG4gPSBuLmxlZnQgOiAoXG4gICAgICAgICAgICAvLyBDb3VudCBhbGwgbm9kZXMgbGVmdCBvZiB0aGUgbm9kZSBwbHVzIHRoZSBub2RlIGl0c2VsZlxuICAgICAgICAgICAgZSArPSBuLmxlZnQuc2l6ZSArIDEsIG4gPSBuLnJpZ2h0KTtcbiAgICAgICAgfVxuICAgICAgICAvLyBOb2RlIG5vdCBmb3VuZFxuICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgaXNFbXB0eSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucm9vdC5pc0VtcHR5KCk7XG4gICAgfVxuICAgIC8vIFJldHVybnMgdGhlIHRvdGFsIG51bWJlciBvZiBub2RlcyBpbiB0aGUgbWFwLlxuICAgIGdldCBzaXplKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yb290LnNpemU7XG4gICAgfVxuICAgIC8vIFJldHVybnMgdGhlIG1pbmltdW0ga2V5IGluIHRoZSBtYXAuXG4gICAgbWluS2V5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yb290Lm1pbktleSgpO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIHRoZSBtYXhpbXVtIGtleSBpbiB0aGUgbWFwLlxuICAgIG1heEtleSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucm9vdC5tYXhLZXkoKTtcbiAgICB9XG4gICAgLy8gVHJhdmVyc2VzIHRoZSBtYXAgaW4ga2V5IG9yZGVyIGFuZCBjYWxscyB0aGUgc3BlY2lmaWVkIGFjdGlvbiBmdW5jdGlvblxuICAgIC8vIGZvciBlYWNoIGtleS92YWx1ZSBwYWlyLiBJZiBhY3Rpb24gcmV0dXJucyB0cnVlLCB0cmF2ZXJzYWwgaXMgYWJvcnRlZC5cbiAgICAvLyBSZXR1cm5zIHRoZSBmaXJzdCB0cnV0aHkgdmFsdWUgcmV0dXJuZWQgYnkgYWN0aW9uLCBvciB0aGUgbGFzdCBmYWxzZXlcbiAgICAvLyB2YWx1ZSByZXR1cm5lZCBieSBhY3Rpb24uXG4gICAgaW5vcmRlclRyYXZlcnNhbCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJvb3QuaW5vcmRlclRyYXZlcnNhbCh0KTtcbiAgICB9XG4gICAgZm9yRWFjaCh0KSB7XG4gICAgICAgIHRoaXMuaW5vcmRlclRyYXZlcnNhbCgoKGUsIG4pID0+ICh0KGUsIG4pLCAhMSkpKTtcbiAgICB9XG4gICAgdG9TdHJpbmcoKSB7XG4gICAgICAgIGNvbnN0IHQgPSBbXTtcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5vcmRlclRyYXZlcnNhbCgoKGUsIG4pID0+ICh0LnB1c2goYCR7ZX06JHtufWApLCAhMSkpKSwgYHske3Quam9pbihcIiwgXCIpfX1gO1xuICAgIH1cbiAgICAvLyBUcmF2ZXJzZXMgdGhlIG1hcCBpbiByZXZlcnNlIGtleSBvcmRlciBhbmQgY2FsbHMgdGhlIHNwZWNpZmllZCBhY3Rpb25cbiAgICAvLyBmdW5jdGlvbiBmb3IgZWFjaCBrZXkvdmFsdWUgcGFpci4gSWYgYWN0aW9uIHJldHVybnMgdHJ1ZSwgdHJhdmVyc2FsIGlzXG4gICAgLy8gYWJvcnRlZC5cbiAgICAvLyBSZXR1cm5zIHRoZSBmaXJzdCB0cnV0aHkgdmFsdWUgcmV0dXJuZWQgYnkgYWN0aW9uLCBvciB0aGUgbGFzdCBmYWxzZXlcbiAgICAvLyB2YWx1ZSByZXR1cm5lZCBieSBhY3Rpb24uXG4gICAgcmV2ZXJzZVRyYXZlcnNhbCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJvb3QucmV2ZXJzZVRyYXZlcnNhbCh0KTtcbiAgICB9XG4gICAgLy8gUmV0dXJucyBhbiBpdGVyYXRvciBvdmVyIHRoZSBTb3J0ZWRNYXAuXG4gICAgZ2V0SXRlcmF0b3IoKSB7XG4gICAgICAgIHJldHVybiBuZXcgd24odGhpcy5yb290LCBudWxsLCB0aGlzLmNvbXBhcmF0b3IsICExKTtcbiAgICB9XG4gICAgZ2V0SXRlcmF0b3JGcm9tKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyB3bih0aGlzLnJvb3QsIHQsIHRoaXMuY29tcGFyYXRvciwgITEpO1xuICAgIH1cbiAgICBnZXRSZXZlcnNlSXRlcmF0b3IoKSB7XG4gICAgICAgIHJldHVybiBuZXcgd24odGhpcy5yb290LCBudWxsLCB0aGlzLmNvbXBhcmF0b3IsICEwKTtcbiAgICB9XG4gICAgZ2V0UmV2ZXJzZUl0ZXJhdG9yRnJvbSh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgd24odGhpcy5yb290LCB0LCB0aGlzLmNvbXBhcmF0b3IsICEwKTtcbiAgICB9XG59XG5cbiAvLyBlbmQgU29ydGVkTWFwXG4vLyBBbiBpdGVyYXRvciBvdmVyIGFuIExMUkJOb2RlLlxuY2xhc3Mgd24ge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgdGhpcy5pc1JldmVyc2UgPSBzLCB0aGlzLm5vZGVTdGFjayA9IFtdO1xuICAgICAgICBsZXQgaSA9IDE7XG4gICAgICAgIGZvciAoOyF0LmlzRW1wdHkoKTsgKSBpZiAoaSA9IGUgPyBuKHQua2V5LCBlKSA6IDEsIFxuICAgICAgICAvLyBmbGlwIHRoZSBjb21wYXJpc29uIGlmIHdlJ3JlIGdvaW5nIGluIHJldmVyc2VcbiAgICAgICAgcyAmJiAoaSAqPSAtMSksIGkgPCAwKSBcbiAgICAgICAgLy8gVGhpcyBub2RlIGlzIGxlc3MgdGhhbiBvdXIgc3RhcnQga2V5LiBpZ25vcmUgaXRcbiAgICAgICAgdCA9IHRoaXMuaXNSZXZlcnNlID8gdC5sZWZ0IDogdC5yaWdodDsgZWxzZSB7XG4gICAgICAgICAgICBpZiAoMCA9PT0gaSkge1xuICAgICAgICAgICAgICAgIC8vIFRoaXMgbm9kZSBpcyBleGFjdGx5IGVxdWFsIHRvIG91ciBzdGFydCBrZXkuIFB1c2ggaXQgb24gdGhlIHN0YWNrLFxuICAgICAgICAgICAgICAgIC8vIGJ1dCBzdG9wIGl0ZXJhdGluZztcbiAgICAgICAgICAgICAgICB0aGlzLm5vZGVTdGFjay5wdXNoKHQpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gVGhpcyBub2RlIGlzIGdyZWF0ZXIgdGhhbiBvdXIgc3RhcnQga2V5LCBhZGQgaXQgdG8gdGhlIHN0YWNrIGFuZCBtb3ZlXG4gICAgICAgICAgICAvLyB0byB0aGUgbmV4dCBvbmVcbiAgICAgICAgICAgIHRoaXMubm9kZVN0YWNrLnB1c2godCksIHQgPSB0aGlzLmlzUmV2ZXJzZSA/IHQucmlnaHQgOiB0LmxlZnQ7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0TmV4dCgpIHtcbiAgICAgICAgbGV0IHQgPSB0aGlzLm5vZGVTdGFjay5wb3AoKTtcbiAgICAgICAgY29uc3QgZSA9IHtcbiAgICAgICAgICAgIGtleTogdC5rZXksXG4gICAgICAgICAgICB2YWx1ZTogdC52YWx1ZVxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5pc1JldmVyc2UpIGZvciAodCA9IHQubGVmdDsgIXQuaXNFbXB0eSgpOyApIHRoaXMubm9kZVN0YWNrLnB1c2godCksIHQgPSB0LnJpZ2h0OyBlbHNlIGZvciAodCA9IHQucmlnaHQ7ICF0LmlzRW1wdHkoKTsgKSB0aGlzLm5vZGVTdGFjay5wdXNoKHQpLCBcbiAgICAgICAgdCA9IHQubGVmdDtcbiAgICAgICAgcmV0dXJuIGU7XG4gICAgfVxuICAgIGhhc05leHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5vZGVTdGFjay5sZW5ndGggPiAwO1xuICAgIH1cbiAgICBwZWVrKCkge1xuICAgICAgICBpZiAoMCA9PT0gdGhpcy5ub2RlU3RhY2subGVuZ3RoKSByZXR1cm4gbnVsbDtcbiAgICAgICAgY29uc3QgdCA9IHRoaXMubm9kZVN0YWNrW3RoaXMubm9kZVN0YWNrLmxlbmd0aCAtIDFdO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAga2V5OiB0LmtleSxcbiAgICAgICAgICAgIHZhbHVlOiB0LnZhbHVlXG4gICAgICAgIH07XG4gICAgfVxufVxuXG4gLy8gZW5kIFNvcnRlZE1hcEl0ZXJhdG9yXG4vLyBSZXByZXNlbnRzIGEgbm9kZSBpbiBhIExlZnQtbGVhbmluZyBSZWQtQmxhY2sgdHJlZS5cbmNsYXNzIF9uIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzLCBpKSB7XG4gICAgICAgIHRoaXMua2V5ID0gdCwgdGhpcy52YWx1ZSA9IGUsIHRoaXMuY29sb3IgPSBudWxsICE9IG4gPyBuIDogX24uUkVELCB0aGlzLmxlZnQgPSBudWxsICE9IHMgPyBzIDogX24uRU1QVFksIFxuICAgICAgICB0aGlzLnJpZ2h0ID0gbnVsbCAhPSBpID8gaSA6IF9uLkVNUFRZLCB0aGlzLnNpemUgPSB0aGlzLmxlZnQuc2l6ZSArIDEgKyB0aGlzLnJpZ2h0LnNpemU7XG4gICAgfVxuICAgIC8vIFJldHVybnMgYSBjb3B5IG9mIHRoZSBjdXJyZW50IG5vZGUsIG9wdGlvbmFsbHkgcmVwbGFjaW5nIHBpZWNlcyBvZiBpdC5cbiAgICBjb3B5KHQsIGUsIG4sIHMsIGkpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBfbihudWxsICE9IHQgPyB0IDogdGhpcy5rZXksIG51bGwgIT0gZSA/IGUgOiB0aGlzLnZhbHVlLCBudWxsICE9IG4gPyBuIDogdGhpcy5jb2xvciwgbnVsbCAhPSBzID8gcyA6IHRoaXMubGVmdCwgbnVsbCAhPSBpID8gaSA6IHRoaXMucmlnaHQpO1xuICAgIH1cbiAgICBpc0VtcHR5KCkge1xuICAgICAgICByZXR1cm4gITE7XG4gICAgfVxuICAgIC8vIFRyYXZlcnNlcyB0aGUgdHJlZSBpbiBrZXkgb3JkZXIgYW5kIGNhbGxzIHRoZSBzcGVjaWZpZWQgYWN0aW9uIGZ1bmN0aW9uXG4gICAgLy8gZm9yIGVhY2ggbm9kZS4gSWYgYWN0aW9uIHJldHVybnMgdHJ1ZSwgdHJhdmVyc2FsIGlzIGFib3J0ZWQuXG4gICAgLy8gUmV0dXJucyB0aGUgZmlyc3QgdHJ1dGh5IHZhbHVlIHJldHVybmVkIGJ5IGFjdGlvbiwgb3IgdGhlIGxhc3QgZmFsc2V5XG4gICAgLy8gdmFsdWUgcmV0dXJuZWQgYnkgYWN0aW9uLlxuICAgIGlub3JkZXJUcmF2ZXJzYWwodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5sZWZ0Lmlub3JkZXJUcmF2ZXJzYWwodCkgfHwgdCh0aGlzLmtleSwgdGhpcy52YWx1ZSkgfHwgdGhpcy5yaWdodC5pbm9yZGVyVHJhdmVyc2FsKHQpO1xuICAgIH1cbiAgICAvLyBUcmF2ZXJzZXMgdGhlIHRyZWUgaW4gcmV2ZXJzZSBrZXkgb3JkZXIgYW5kIGNhbGxzIHRoZSBzcGVjaWZpZWQgYWN0aW9uXG4gICAgLy8gZnVuY3Rpb24gZm9yIGVhY2ggbm9kZS4gSWYgYWN0aW9uIHJldHVybnMgdHJ1ZSwgdHJhdmVyc2FsIGlzIGFib3J0ZWQuXG4gICAgLy8gUmV0dXJucyB0aGUgZmlyc3QgdHJ1dGh5IHZhbHVlIHJldHVybmVkIGJ5IGFjdGlvbiwgb3IgdGhlIGxhc3QgZmFsc2V5XG4gICAgLy8gdmFsdWUgcmV0dXJuZWQgYnkgYWN0aW9uLlxuICAgIHJldmVyc2VUcmF2ZXJzYWwodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yaWdodC5yZXZlcnNlVHJhdmVyc2FsKHQpIHx8IHQodGhpcy5rZXksIHRoaXMudmFsdWUpIHx8IHRoaXMubGVmdC5yZXZlcnNlVHJhdmVyc2FsKHQpO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIHRoZSBtaW5pbXVtIG5vZGUgaW4gdGhlIHRyZWUuXG4gICAgbWluKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5sZWZ0LmlzRW1wdHkoKSA/IHRoaXMgOiB0aGlzLmxlZnQubWluKCk7XG4gICAgfVxuICAgIC8vIFJldHVybnMgdGhlIG1heGltdW0ga2V5IGluIHRoZSB0cmVlLlxuICAgIG1pbktleSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubWluKCkua2V5O1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIHRoZSBtYXhpbXVtIGtleSBpbiB0aGUgdHJlZS5cbiAgICBtYXhLZXkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJpZ2h0LmlzRW1wdHkoKSA/IHRoaXMua2V5IDogdGhpcy5yaWdodC5tYXhLZXkoKTtcbiAgICB9XG4gICAgLy8gUmV0dXJucyBuZXcgdHJlZSwgd2l0aCB0aGUga2V5L3ZhbHVlIGFkZGVkLlxuICAgIGluc2VydCh0LCBlLCBuKSB7XG4gICAgICAgIGxldCBzID0gdGhpcztcbiAgICAgICAgY29uc3QgaSA9IG4odCwgcy5rZXkpO1xuICAgICAgICByZXR1cm4gcyA9IGkgPCAwID8gcy5jb3B5KG51bGwsIG51bGwsIG51bGwsIHMubGVmdC5pbnNlcnQodCwgZSwgbiksIG51bGwpIDogMCA9PT0gaSA/IHMuY29weShudWxsLCBlLCBudWxsLCBudWxsLCBudWxsKSA6IHMuY29weShudWxsLCBudWxsLCBudWxsLCBudWxsLCBzLnJpZ2h0Lmluc2VydCh0LCBlLCBuKSksIFxuICAgICAgICBzLmZpeFVwKCk7XG4gICAgfVxuICAgIHJlbW92ZU1pbigpIHtcbiAgICAgICAgaWYgKHRoaXMubGVmdC5pc0VtcHR5KCkpIHJldHVybiBfbi5FTVBUWTtcbiAgICAgICAgbGV0IHQgPSB0aGlzO1xuICAgICAgICByZXR1cm4gdC5sZWZ0LmlzUmVkKCkgfHwgdC5sZWZ0LmxlZnQuaXNSZWQoKSB8fCAodCA9IHQubW92ZVJlZExlZnQoKSksIHQgPSB0LmNvcHkobnVsbCwgbnVsbCwgbnVsbCwgdC5sZWZ0LnJlbW92ZU1pbigpLCBudWxsKSwgXG4gICAgICAgIHQuZml4VXAoKTtcbiAgICB9XG4gICAgLy8gUmV0dXJucyBuZXcgdHJlZSwgd2l0aCB0aGUgc3BlY2lmaWVkIGl0ZW0gcmVtb3ZlZC5cbiAgICByZW1vdmUodCwgZSkge1xuICAgICAgICBsZXQgbiwgcyA9IHRoaXM7XG4gICAgICAgIGlmIChlKHQsIHMua2V5KSA8IDApIHMubGVmdC5pc0VtcHR5KCkgfHwgcy5sZWZ0LmlzUmVkKCkgfHwgcy5sZWZ0LmxlZnQuaXNSZWQoKSB8fCAocyA9IHMubW92ZVJlZExlZnQoKSksIFxuICAgICAgICBzID0gcy5jb3B5KG51bGwsIG51bGwsIG51bGwsIHMubGVmdC5yZW1vdmUodCwgZSksIG51bGwpOyBlbHNlIHtcbiAgICAgICAgICAgIGlmIChzLmxlZnQuaXNSZWQoKSAmJiAocyA9IHMucm90YXRlUmlnaHQoKSksIHMucmlnaHQuaXNFbXB0eSgpIHx8IHMucmlnaHQuaXNSZWQoKSB8fCBzLnJpZ2h0LmxlZnQuaXNSZWQoKSB8fCAocyA9IHMubW92ZVJlZFJpZ2h0KCkpLCBcbiAgICAgICAgICAgIDAgPT09IGUodCwgcy5rZXkpKSB7XG4gICAgICAgICAgICAgICAgaWYgKHMucmlnaHQuaXNFbXB0eSgpKSByZXR1cm4gX24uRU1QVFk7XG4gICAgICAgICAgICAgICAgbiA9IHMucmlnaHQubWluKCksIHMgPSBzLmNvcHkobi5rZXksIG4udmFsdWUsIG51bGwsIG51bGwsIHMucmlnaHQucmVtb3ZlTWluKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcyA9IHMuY29weShudWxsLCBudWxsLCBudWxsLCBudWxsLCBzLnJpZ2h0LnJlbW92ZSh0LCBlKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHMuZml4VXAoKTtcbiAgICB9XG4gICAgaXNSZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbG9yO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIG5ldyB0cmVlIGFmdGVyIHBlcmZvcm1pbmcgYW55IG5lZWRlZCByb3RhdGlvbnMuXG4gICAgZml4VXAoKSB7XG4gICAgICAgIGxldCB0ID0gdGhpcztcbiAgICAgICAgcmV0dXJuIHQucmlnaHQuaXNSZWQoKSAmJiAhdC5sZWZ0LmlzUmVkKCkgJiYgKHQgPSB0LnJvdGF0ZUxlZnQoKSksIHQubGVmdC5pc1JlZCgpICYmIHQubGVmdC5sZWZ0LmlzUmVkKCkgJiYgKHQgPSB0LnJvdGF0ZVJpZ2h0KCkpLCBcbiAgICAgICAgdC5sZWZ0LmlzUmVkKCkgJiYgdC5yaWdodC5pc1JlZCgpICYmICh0ID0gdC5jb2xvckZsaXAoKSksIHQ7XG4gICAgfVxuICAgIG1vdmVSZWRMZWZ0KCkge1xuICAgICAgICBsZXQgdCA9IHRoaXMuY29sb3JGbGlwKCk7XG4gICAgICAgIHJldHVybiB0LnJpZ2h0LmxlZnQuaXNSZWQoKSAmJiAodCA9IHQuY29weShudWxsLCBudWxsLCBudWxsLCBudWxsLCB0LnJpZ2h0LnJvdGF0ZVJpZ2h0KCkpLCBcbiAgICAgICAgdCA9IHQucm90YXRlTGVmdCgpLCB0ID0gdC5jb2xvckZsaXAoKSksIHQ7XG4gICAgfVxuICAgIG1vdmVSZWRSaWdodCgpIHtcbiAgICAgICAgbGV0IHQgPSB0aGlzLmNvbG9yRmxpcCgpO1xuICAgICAgICByZXR1cm4gdC5sZWZ0LmxlZnQuaXNSZWQoKSAmJiAodCA9IHQucm90YXRlUmlnaHQoKSwgdCA9IHQuY29sb3JGbGlwKCkpLCB0O1xuICAgIH1cbiAgICByb3RhdGVMZWZ0KCkge1xuICAgICAgICBjb25zdCB0ID0gdGhpcy5jb3B5KG51bGwsIG51bGwsIF9uLlJFRCwgbnVsbCwgdGhpcy5yaWdodC5sZWZ0KTtcbiAgICAgICAgcmV0dXJuIHRoaXMucmlnaHQuY29weShudWxsLCBudWxsLCB0aGlzLmNvbG9yLCB0LCBudWxsKTtcbiAgICB9XG4gICAgcm90YXRlUmlnaHQoKSB7XG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLmNvcHkobnVsbCwgbnVsbCwgX24uUkVELCB0aGlzLmxlZnQucmlnaHQsIG51bGwpO1xuICAgICAgICByZXR1cm4gdGhpcy5sZWZ0LmNvcHkobnVsbCwgbnVsbCwgdGhpcy5jb2xvciwgbnVsbCwgdCk7XG4gICAgfVxuICAgIGNvbG9yRmxpcCgpIHtcbiAgICAgICAgY29uc3QgdCA9IHRoaXMubGVmdC5jb3B5KG51bGwsIG51bGwsICF0aGlzLmxlZnQuY29sb3IsIG51bGwsIG51bGwpLCBlID0gdGhpcy5yaWdodC5jb3B5KG51bGwsIG51bGwsICF0aGlzLnJpZ2h0LmNvbG9yLCBudWxsLCBudWxsKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29weShudWxsLCBudWxsLCAhdGhpcy5jb2xvciwgdCwgZSk7XG4gICAgfVxuICAgIC8vIEZvciB0ZXN0aW5nLlxuICAgIGNoZWNrTWF4RGVwdGgoKSB7XG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLmNoZWNrKCk7XG4gICAgICAgIHJldHVybiBNYXRoLnBvdygyLCB0KSA8PSB0aGlzLnNpemUgKyAxO1xuICAgIH1cbiAgICAvLyBJbiBhIGJhbGFuY2VkIFJCIHRyZWUsIHRoZSBibGFjay1kZXB0aCAobnVtYmVyIG9mIGJsYWNrIG5vZGVzKSBmcm9tIHJvb3QgdG9cbiAgICAvLyBsZWF2ZXMgaXMgZXF1YWwgb24gYm90aCBzaWRlcy4gIFRoaXMgZnVuY3Rpb24gdmVyaWZpZXMgdGhhdCBvciBhc3NlcnRzLlxuICAgIGNoZWNrKCkge1xuICAgICAgICBpZiAodGhpcy5pc1JlZCgpICYmIHRoaXMubGVmdC5pc1JlZCgpKSB0aHJvdyBNKCk7XG4gICAgICAgIGlmICh0aGlzLnJpZ2h0LmlzUmVkKCkpIHRocm93IE0oKTtcbiAgICAgICAgY29uc3QgdCA9IHRoaXMubGVmdC5jaGVjaygpO1xuICAgICAgICBpZiAodCAhPT0gdGhpcy5yaWdodC5jaGVjaygpKSB0aHJvdyBNKCk7XG4gICAgICAgIHJldHVybiB0ICsgKHRoaXMuaXNSZWQoKSA/IDAgOiAxKTtcbiAgICB9XG59XG5cbiAvLyBlbmQgTExSQk5vZGVcbi8vIEVtcHR5IG5vZGUgaXMgc2hhcmVkIGJldHdlZW4gYWxsIExMUkIgdHJlZXMuXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuX24uRU1QVFkgPSBudWxsLCBfbi5SRUQgPSAhMCwgX24uQkxBQ0sgPSAhMTtcblxuLy8gZW5kIExMUkJFbXB0eU5vZGVcbl9uLkVNUFRZID0gbmV3IFxuLy8gUmVwcmVzZW50cyBhbiBlbXB0eSBub2RlIChhIGxlYWYgbm9kZSBpbiB0aGUgUmVkLUJsYWNrIFRyZWUpLlxuY2xhc3Mge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnNpemUgPSAwO1xuICAgIH1cbiAgICBnZXQga2V5KCkge1xuICAgICAgICB0aHJvdyBNKCk7XG4gICAgfVxuICAgIGdldCB2YWx1ZSgpIHtcbiAgICAgICAgdGhyb3cgTSgpO1xuICAgIH1cbiAgICBnZXQgY29sb3IoKSB7XG4gICAgICAgIHRocm93IE0oKTtcbiAgICB9XG4gICAgZ2V0IGxlZnQoKSB7XG4gICAgICAgIHRocm93IE0oKTtcbiAgICB9XG4gICAgZ2V0IHJpZ2h0KCkge1xuICAgICAgICB0aHJvdyBNKCk7XG4gICAgfVxuICAgIC8vIFJldHVybnMgYSBjb3B5IG9mIHRoZSBjdXJyZW50IG5vZGUuXG4gICAgY29weSh0LCBlLCBuLCBzLCBpKSB7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIGEgY29weSBvZiB0aGUgdHJlZSwgd2l0aCB0aGUgc3BlY2lmaWVkIGtleS92YWx1ZSBhZGRlZC5cbiAgICBpbnNlcnQodCwgZSwgbikge1xuICAgICAgICByZXR1cm4gbmV3IF9uKHQsIGUpO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIGEgY29weSBvZiB0aGUgdHJlZSwgd2l0aCB0aGUgc3BlY2lmaWVkIGtleSByZW1vdmVkLlxuICAgIHJlbW92ZSh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBpc0VtcHR5KCkge1xuICAgICAgICByZXR1cm4gITA7XG4gICAgfVxuICAgIGlub3JkZXJUcmF2ZXJzYWwodCkge1xuICAgICAgICByZXR1cm4gITE7XG4gICAgfVxuICAgIHJldmVyc2VUcmF2ZXJzYWwodCkge1xuICAgICAgICByZXR1cm4gITE7XG4gICAgfVxuICAgIG1pbktleSgpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIG1heEtleSgpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGlzUmVkKCkge1xuICAgICAgICByZXR1cm4gITE7XG4gICAgfVxuICAgIC8vIEZvciB0ZXN0aW5nLlxuICAgIGNoZWNrTWF4RGVwdGgoKSB7XG4gICAgICAgIHJldHVybiAhMDtcbiAgICB9XG4gICAgY2hlY2soKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbn07XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFNvcnRlZFNldCBpcyBhbiBpbW11dGFibGUgKGNvcHktb24td3JpdGUpIGNvbGxlY3Rpb24gdGhhdCBob2xkcyBlbGVtZW50c1xuICogaW4gb3JkZXIgc3BlY2lmaWVkIGJ5IHRoZSBwcm92aWRlZCBjb21wYXJhdG9yLlxuICpcbiAqIE5PVEU6IGlmIHByb3ZpZGVkIGNvbXBhcmF0b3IgcmV0dXJucyAwIGZvciB0d28gZWxlbWVudHMsIHdlIGNvbnNpZGVyIHRoZW0gdG9cbiAqIGJlIGVxdWFsIVxuICovXG5jbGFzcyBtbiB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLmNvbXBhcmF0b3IgPSB0LCB0aGlzLmRhdGEgPSBuZXcgZG4odGhpcy5jb21wYXJhdG9yKTtcbiAgICB9XG4gICAgaGFzKHQpIHtcbiAgICAgICAgcmV0dXJuIG51bGwgIT09IHRoaXMuZGF0YS5nZXQodCk7XG4gICAgfVxuICAgIGZpcnN0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYXRhLm1pbktleSgpO1xuICAgIH1cbiAgICBsYXN0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYXRhLm1heEtleSgpO1xuICAgIH1cbiAgICBnZXQgc2l6ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5zaXplO1xuICAgIH1cbiAgICBpbmRleE9mKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5pbmRleE9mKHQpO1xuICAgIH1cbiAgICAvKiogSXRlcmF0ZXMgZWxlbWVudHMgaW4gb3JkZXIgZGVmaW5lZCBieSBcImNvbXBhcmF0b3JcIiAqLyAgICBmb3JFYWNoKHQpIHtcbiAgICAgICAgdGhpcy5kYXRhLmlub3JkZXJUcmF2ZXJzYWwoKChlLCBuKSA9PiAodChlKSwgITEpKSk7XG4gICAgfVxuICAgIC8qKiBJdGVyYXRlcyBvdmVyIGBlbGVtYHMgc3VjaCB0aGF0OiByYW5nZVswXSAmbHQ7PSBlbGVtICZsdDsgcmFuZ2VbMV0uICovICAgIGZvckVhY2hJblJhbmdlKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMuZGF0YS5nZXRJdGVyYXRvckZyb20odFswXSk7XG4gICAgICAgIGZvciAoO24uaGFzTmV4dCgpOyApIHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBuLmdldE5leHQoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmNvbXBhcmF0b3Iocy5rZXksIHRbMV0pID49IDApIHJldHVybjtcbiAgICAgICAgICAgIGUocy5rZXkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEl0ZXJhdGVzIG92ZXIgYGVsZW1gcyBzdWNoIHRoYXQ6IHN0YXJ0ICZsdDs9IGVsZW0gdW50aWwgZmFsc2UgaXMgcmV0dXJuZWQuXG4gICAgICovICAgIGZvckVhY2hXaGlsZSh0LCBlKSB7XG4gICAgICAgIGxldCBuO1xuICAgICAgICBmb3IgKG4gPSB2b2lkIDAgIT09IGUgPyB0aGlzLmRhdGEuZ2V0SXRlcmF0b3JGcm9tKGUpIDogdGhpcy5kYXRhLmdldEl0ZXJhdG9yKCk7IG4uaGFzTmV4dCgpOyApIHtcbiAgICAgICAgICAgIGlmICghdChuLmdldE5leHQoKS5rZXkpKSByZXR1cm47XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqIEZpbmRzIHRoZSBsZWFzdCBlbGVtZW50IGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byBgZWxlbWAuICovICAgIGZpcnN0QWZ0ZXJPckVxdWFsKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuZGF0YS5nZXRJdGVyYXRvckZyb20odCk7XG4gICAgICAgIHJldHVybiBlLmhhc05leHQoKSA/IGUuZ2V0TmV4dCgpLmtleSA6IG51bGw7XG4gICAgfVxuICAgIGdldEl0ZXJhdG9yKCkge1xuICAgICAgICByZXR1cm4gbmV3IGduKHRoaXMuZGF0YS5nZXRJdGVyYXRvcigpKTtcbiAgICB9XG4gICAgZ2V0SXRlcmF0b3JGcm9tKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBnbih0aGlzLmRhdGEuZ2V0SXRlcmF0b3JGcm9tKHQpKTtcbiAgICB9XG4gICAgLyoqIEluc2VydHMgb3IgdXBkYXRlcyBhbiBlbGVtZW50ICovICAgIGFkZCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvcHkodGhpcy5kYXRhLnJlbW92ZSh0KS5pbnNlcnQodCwgITApKTtcbiAgICB9XG4gICAgLyoqIERlbGV0ZXMgYW4gZWxlbWVudCAqLyAgICBkZWxldGUodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5oYXModCkgPyB0aGlzLmNvcHkodGhpcy5kYXRhLnJlbW92ZSh0KSkgOiB0aGlzO1xuICAgIH1cbiAgICBpc0VtcHR5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYXRhLmlzRW1wdHkoKTtcbiAgICB9XG4gICAgdW5pb25XaXRoKHQpIHtcbiAgICAgICAgbGV0IGUgPSB0aGlzO1xuICAgICAgICAvLyBNYWtlIHN1cmUgYHJlc3VsdGAgYWx3YXlzIHJlZmVycyB0byB0aGUgbGFyZ2VyIG9uZSBvZiB0aGUgdHdvIHNldHMuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGUuc2l6ZSA8IHQuc2l6ZSAmJiAoZSA9IHQsIHQgPSB0aGlzKSwgdC5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgIGUgPSBlLmFkZCh0KTtcbiAgICAgICAgfSkpLCBlO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgaWYgKCEodCBpbnN0YW5jZW9mIG1uKSkgcmV0dXJuICExO1xuICAgICAgICBpZiAodGhpcy5zaXplICE9PSB0LnNpemUpIHJldHVybiAhMTtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuZGF0YS5nZXRJdGVyYXRvcigpLCBuID0gdC5kYXRhLmdldEl0ZXJhdG9yKCk7XG4gICAgICAgIGZvciAoO2UuaGFzTmV4dCgpOyApIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBlLmdldE5leHQoKS5rZXksIHMgPSBuLmdldE5leHQoKS5rZXk7XG4gICAgICAgICAgICBpZiAoMCAhPT0gdGhpcy5jb21wYXJhdG9yKHQsIHMpKSByZXR1cm4gITE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICEwO1xuICAgIH1cbiAgICB0b0FycmF5KCkge1xuICAgICAgICBjb25zdCB0ID0gW107XG4gICAgICAgIHJldHVybiB0aGlzLmZvckVhY2goKGUgPT4ge1xuICAgICAgICAgICAgdC5wdXNoKGUpO1xuICAgICAgICB9KSksIHQ7XG4gICAgfVxuICAgIHRvU3RyaW5nKCkge1xuICAgICAgICBjb25zdCB0ID0gW107XG4gICAgICAgIHJldHVybiB0aGlzLmZvckVhY2goKGUgPT4gdC5wdXNoKGUpKSksIFwiU29ydGVkU2V0KFwiICsgdC50b1N0cmluZygpICsgXCIpXCI7XG4gICAgfVxuICAgIGNvcHkodCkge1xuICAgICAgICBjb25zdCBlID0gbmV3IG1uKHRoaXMuY29tcGFyYXRvcik7XG4gICAgICAgIHJldHVybiBlLmRhdGEgPSB0LCBlO1xuICAgIH1cbn1cblxuY2xhc3MgZ24ge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5pdGVyID0gdDtcbiAgICB9XG4gICAgZ2V0TmV4dCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaXRlci5nZXROZXh0KCkua2V5O1xuICAgIH1cbiAgICBoYXNOZXh0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pdGVyLmhhc05leHQoKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNvbnN0IHluID0gbmV3IGRuKFB0LmNvbXBhcmF0b3IpO1xuXG5mdW5jdGlvbiBwbigpIHtcbiAgICByZXR1cm4geW47XG59XG5cbmNvbnN0IEVuID0gbmV3IGRuKFB0LmNvbXBhcmF0b3IpO1xuXG5mdW5jdGlvbiBUbigpIHtcbiAgICByZXR1cm4gRW47XG59XG5cbmNvbnN0IEluID0gbmV3IGRuKFB0LmNvbXBhcmF0b3IpO1xuXG5mdW5jdGlvbiBBbigpIHtcbiAgICByZXR1cm4gSW47XG59XG5cbmNvbnN0IFJuID0gbmV3IG1uKFB0LmNvbXBhcmF0b3IpO1xuXG5mdW5jdGlvbiBQbiguLi50KSB7XG4gICAgbGV0IGUgPSBSbjtcbiAgICBmb3IgKGNvbnN0IG4gb2YgdCkgZSA9IGUuYWRkKG4pO1xuICAgIHJldHVybiBlO1xufVxuXG5jb25zdCBibiA9IG5ldyBtbih0dCk7XG5cbmZ1bmN0aW9uIHZuKCkge1xuICAgIHJldHVybiBibjtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQW4gZXZlbnQgZnJvbSB0aGUgUmVtb3RlU3RvcmUuIEl0IGlzIHNwbGl0IGludG8gdGFyZ2V0Q2hhbmdlcyAoY2hhbmdlcyB0byB0aGVcbiAqIHN0YXRlIG9yIHRoZSBzZXQgb2YgZG9jdW1lbnRzIGluIG91ciB3YXRjaGVkIHRhcmdldHMpIGFuZCBkb2N1bWVudFVwZGF0ZXNcbiAqIChjaGFuZ2VzIHRvIHRoZSBhY3R1YWwgZG9jdW1lbnRzKS5cbiAqLyBjbGFzcyBWbiB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgLyoqXG4gICAgICogVGhlIHNuYXBzaG90IHZlcnNpb24gdGhpcyBldmVudCBicmluZ3MgdXMgdXAgdG8sIG9yIE1JTiBpZiBub3Qgc2V0LlxuICAgICAqL1xuICAgIHQsIFxuICAgIC8qKlxuICAgICAqIEEgbWFwIGZyb20gdGFyZ2V0IHRvIGNoYW5nZXMgdG8gdGhlIHRhcmdldC4gU2VlIFRhcmdldENoYW5nZS5cbiAgICAgKi9cbiAgICBlLCBcbiAgICAvKipcbiAgICAgKiBBIHNldCBvZiB0YXJnZXRzIHRoYXQgaXMga25vd24gdG8gYmUgaW5jb25zaXN0ZW50LiBMaXN0ZW5zIGZvciB0aGVzZVxuICAgICAqIHRhcmdldHMgc2hvdWxkIGJlIHJlLWVzdGFibGlzaGVkIHdpdGhvdXQgcmVzdW1lIHRva2Vucy5cbiAgICAgKi9cbiAgICBuLCBcbiAgICAvKipcbiAgICAgKiBBIHNldCBvZiB3aGljaCBkb2N1bWVudHMgaGF2ZSBjaGFuZ2VkIG9yIGJlZW4gZGVsZXRlZCwgYWxvbmcgd2l0aCB0aGVcbiAgICAgKiBkb2MncyBuZXcgdmFsdWVzIChpZiBub3QgZGVsZXRlZCkuXG4gICAgICovXG4gICAgcywgXG4gICAgLyoqXG4gICAgICogQSBzZXQgb2Ygd2hpY2ggZG9jdW1lbnQgdXBkYXRlcyBhcmUgZHVlIG9ubHkgdG8gbGltYm8gcmVzb2x1dGlvbiB0YXJnZXRzLlxuICAgICAqL1xuICAgIGkpIHtcbiAgICAgICAgdGhpcy5zbmFwc2hvdFZlcnNpb24gPSB0LCB0aGlzLnRhcmdldENoYW5nZXMgPSBlLCB0aGlzLnRhcmdldE1pc21hdGNoZXMgPSBuLCB0aGlzLmRvY3VtZW50VXBkYXRlcyA9IHMsIFxuICAgICAgICB0aGlzLnJlc29sdmVkTGltYm9Eb2N1bWVudHMgPSBpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBIQUNLOiBWaWV3cyByZXF1aXJlIFJlbW90ZUV2ZW50cyBpbiBvcmRlciB0byBkZXRlcm1pbmUgd2hldGhlciB0aGUgdmlldyBpc1xuICAgICAqIENVUlJFTlQsIGJ1dCBzZWNvbmRhcnkgdGFicyBkb24ndCByZWNlaXZlIHJlbW90ZSBldmVudHMuIFNvIHRoaXMgbWV0aG9kIGlzXG4gICAgICogdXNlZCB0byBjcmVhdGUgYSBzeW50aGVzaXplZCBSZW1vdGVFdmVudCB0aGF0IGNhbiBiZSB1c2VkIHRvIGFwcGx5IGFcbiAgICAgKiBDVVJSRU5UIHN0YXR1cyBjaGFuZ2UgdG8gYSBWaWV3LCBmb3IgcXVlcmllcyBleGVjdXRlZCBpbiBhIGRpZmZlcmVudCB0YWIuXG4gICAgICovXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seVxuICAgIHN0YXRpYyBjcmVhdGVTeW50aGVzaXplZFJlbW90ZUV2ZW50Rm9yQ3VycmVudENoYW5nZSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBuZXcgTWFwO1xuICAgICAgICByZXR1cm4gbi5zZXQodCwgU24uY3JlYXRlU3ludGhlc2l6ZWRUYXJnZXRDaGFuZ2VGb3JDdXJyZW50Q2hhbmdlKHQsIGUpKSwgbmV3IFZuKGl0Lm1pbigpLCBuLCB2bigpLCBwbigpLCBQbigpKTtcbiAgICB9XG59XG5cbi8qKlxuICogQSBUYXJnZXRDaGFuZ2Ugc3BlY2lmaWVzIHRoZSBzZXQgb2YgY2hhbmdlcyBmb3IgYSBzcGVjaWZpYyB0YXJnZXQgYXMgcGFydCBvZlxuICogYSBSZW1vdGVFdmVudC4gVGhlc2UgY2hhbmdlcyB0cmFjayB3aGljaCBkb2N1bWVudHMgYXJlIGFkZGVkLCBtb2RpZmllZCBvclxuICogcmVtb3ZlZCwgYXMgd2VsbCBhcyB0aGUgdGFyZ2V0J3MgcmVzdW1lIHRva2VuIGFuZCB3aGV0aGVyIHRoZSB0YXJnZXQgaXNcbiAqIG1hcmtlZCBDVVJSRU5ULlxuICogVGhlIGFjdHVhbCBjaGFuZ2VzICp0byogZG9jdW1lbnRzIGFyZSBub3QgcGFydCBvZiB0aGUgVGFyZ2V0Q2hhbmdlIHNpbmNlXG4gKiBkb2N1bWVudHMgbWF5IGJlIHBhcnQgb2YgbXVsdGlwbGUgdGFyZ2V0cy5cbiAqLyBjbGFzcyBTbiB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgLyoqXG4gICAgICogQW4gb3BhcXVlLCBzZXJ2ZXItYXNzaWduZWQgdG9rZW4gdGhhdCBhbGxvd3Mgd2F0Y2hpbmcgYSBxdWVyeSB0byBiZSByZXN1bWVkXG4gICAgICogYWZ0ZXIgZGlzY29ubmVjdGluZyB3aXRob3V0IHJldHJhbnNtaXR0aW5nIGFsbCB0aGUgZGF0YSB0aGF0IG1hdGNoZXMgdGhlXG4gICAgICogcXVlcnkuIFRoZSByZXN1bWUgdG9rZW4gZXNzZW50aWFsbHkgaWRlbnRpZmllcyBhIHBvaW50IGluIHRpbWUgZnJvbSB3aGljaFxuICAgICAqIHRoZSBzZXJ2ZXIgc2hvdWxkIHJlc3VtZSBzZW5kaW5nIHJlc3VsdHMuXG4gICAgICovXG4gICAgdCwgXG4gICAgLyoqXG4gICAgICogVGhlIFwiY3VycmVudFwiIChzeW5jZWQpIHN0YXR1cyBvZiB0aGlzIHRhcmdldC4gTm90ZSB0aGF0IFwiY3VycmVudFwiXG4gICAgICogaGFzIHNwZWNpYWwgbWVhbmluZyBpbiB0aGUgUlBDIHByb3RvY29sIHRoYXQgaW1wbGllcyB0aGF0IGEgdGFyZ2V0IGlzXG4gICAgICogYm90aCB1cC10by1kYXRlIGFuZCBjb25zaXN0ZW50IHdpdGggdGhlIHJlc3Qgb2YgdGhlIHdhdGNoIHN0cmVhbS5cbiAgICAgKi9cbiAgICBlLCBcbiAgICAvKipcbiAgICAgKiBUaGUgc2V0IG9mIGRvY3VtZW50cyB0aGF0IHdlcmUgbmV3bHkgYXNzaWduZWQgdG8gdGhpcyB0YXJnZXQgYXMgcGFydCBvZlxuICAgICAqIHRoaXMgcmVtb3RlIGV2ZW50LlxuICAgICAqL1xuICAgIG4sIFxuICAgIC8qKlxuICAgICAqIFRoZSBzZXQgb2YgZG9jdW1lbnRzIHRoYXQgd2VyZSBhbHJlYWR5IGFzc2lnbmVkIHRvIHRoaXMgdGFyZ2V0IGJ1dCByZWNlaXZlZFxuICAgICAqIGFuIHVwZGF0ZSBkdXJpbmcgdGhpcyByZW1vdGUgZXZlbnQuXG4gICAgICovXG4gICAgcywgXG4gICAgLyoqXG4gICAgICogVGhlIHNldCBvZiBkb2N1bWVudHMgdGhhdCB3ZXJlIHJlbW92ZWQgZnJvbSB0aGlzIHRhcmdldCBhcyBwYXJ0IG9mIHRoaXNcbiAgICAgKiByZW1vdGUgZXZlbnQuXG4gICAgICovXG4gICAgaSkge1xuICAgICAgICB0aGlzLnJlc3VtZVRva2VuID0gdCwgdGhpcy5jdXJyZW50ID0gZSwgdGhpcy5hZGRlZERvY3VtZW50cyA9IG4sIHRoaXMubW9kaWZpZWREb2N1bWVudHMgPSBzLCBcbiAgICAgICAgdGhpcy5yZW1vdmVkRG9jdW1lbnRzID0gaTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhpcyBtZXRob2QgaXMgdXNlZCB0byBjcmVhdGUgYSBzeW50aGVzaXplZCBUYXJnZXRDaGFuZ2VzIHRoYXQgY2FuIGJlIHVzZWQgdG9cbiAgICAgKiBhcHBseSBhIENVUlJFTlQgc3RhdHVzIGNoYW5nZSB0byBhIFZpZXcgKGZvciBxdWVyaWVzIGV4ZWN1dGVkIGluIGEgZGlmZmVyZW50XG4gICAgICogdGFiKSBvciBmb3IgbmV3IHF1ZXJpZXMgKHRvIHJhaXNlIHNuYXBzaG90cyB3aXRoIGNvcnJlY3QgQ1VSUkVOVCBzdGF0dXMpLlxuICAgICAqLyAgICBzdGF0aWMgY3JlYXRlU3ludGhlc2l6ZWRUYXJnZXRDaGFuZ2VGb3JDdXJyZW50Q2hhbmdlKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBTbih3dC5FTVBUWV9CWVRFX1NUUklORywgZSwgUG4oKSwgUG4oKSwgUG4oKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBSZXByZXNlbnRzIGEgY2hhbmdlZCBkb2N1bWVudCBhbmQgYSBsaXN0IG9mIHRhcmdldCBpZHMgdG8gd2hpY2ggdGhpcyBjaGFuZ2VcbiAqIGFwcGxpZXMuXG4gKlxuICogSWYgZG9jdW1lbnQgaGFzIGJlZW4gZGVsZXRlZCBOb0RvY3VtZW50IHdpbGwgYmUgcHJvdmlkZWQuXG4gKi8gY2xhc3MgRG4ge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKiBUaGUgbmV3IGRvY3VtZW50IGFwcGxpZXMgdG8gYWxsIG9mIHRoZXNlIHRhcmdldHMuICovXG4gICAgdCwgXG4gICAgLyoqIFRoZSBuZXcgZG9jdW1lbnQgaXMgcmVtb3ZlZCBmcm9tIGFsbCBvZiB0aGVzZSB0YXJnZXRzLiAqL1xuICAgIGUsIFxuICAgIC8qKiBUaGUga2V5IG9mIHRoZSBkb2N1bWVudCBmb3IgdGhpcyBjaGFuZ2UuICovXG4gICAgbiwgXG4gICAgLyoqXG4gICAgICogVGhlIG5ldyBkb2N1bWVudCBvciBOb0RvY3VtZW50IGlmIGl0IHdhcyBkZWxldGVkLiBJcyBudWxsIGlmIHRoZVxuICAgICAqIGRvY3VtZW50IHdlbnQgb3V0IG9mIHZpZXcgd2l0aG91dCB0aGUgc2VydmVyIHNlbmRpbmcgYSBuZXcgZG9jdW1lbnQuXG4gICAgICovXG4gICAgcykge1xuICAgICAgICB0aGlzLmsgPSB0LCB0aGlzLnJlbW92ZWRUYXJnZXRJZHMgPSBlLCB0aGlzLmtleSA9IG4sIHRoaXMuJCA9IHM7XG4gICAgfVxufVxuXG5jbGFzcyBDbiB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLnRhcmdldElkID0gdCwgdGhpcy5PID0gZTtcbiAgICB9XG59XG5cbmNsYXNzIE5uIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKiogV2hhdCBraW5kIG9mIGNoYW5nZSBvY2N1cnJlZCB0byB0aGUgd2F0Y2ggdGFyZ2V0LiAqL1xuICAgIHQsIFxuICAgIC8qKiBUaGUgdGFyZ2V0IElEcyB0aGF0IHdlcmUgYWRkZWQvcmVtb3ZlZC9zZXQuICovXG4gICAgZSwgXG4gICAgLyoqXG4gICAgICogQW4gb3BhcXVlLCBzZXJ2ZXItYXNzaWduZWQgdG9rZW4gdGhhdCBhbGxvd3Mgd2F0Y2hpbmcgYSB0YXJnZXQgdG8gYmVcbiAgICAgKiByZXN1bWVkIGFmdGVyIGRpc2Nvbm5lY3Rpbmcgd2l0aG91dCByZXRyYW5zbWl0dGluZyBhbGwgdGhlIGRhdGEgdGhhdFxuICAgICAqIG1hdGNoZXMgdGhlIHRhcmdldC4gVGhlIHJlc3VtZSB0b2tlbiBlc3NlbnRpYWxseSBpZGVudGlmaWVzIGEgcG9pbnQgaW5cbiAgICAgKiB0aW1lIGZyb20gd2hpY2ggdGhlIHNlcnZlciBzaG91bGQgcmVzdW1lIHNlbmRpbmcgcmVzdWx0cy5cbiAgICAgKi9cbiAgICBuID0gd3QuRU1QVFlfQllURV9TVFJJTkdcbiAgICAvKiogQW4gUlBDIGVycm9yIGluZGljYXRpbmcgd2h5IHRoZSB3YXRjaCBmYWlsZWQuICovICwgcyA9IG51bGwpIHtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHQsIHRoaXMudGFyZ2V0SWRzID0gZSwgdGhpcy5yZXN1bWVUb2tlbiA9IG4sIHRoaXMuY2F1c2UgPSBzO1xuICAgIH1cbn1cblxuLyoqIFRyYWNrcyB0aGUgaW50ZXJuYWwgc3RhdGUgb2YgYSBXYXRjaCB0YXJnZXQuICovIGNsYXNzIHhuIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBudW1iZXIgb2YgcGVuZGluZyByZXNwb25zZXMgKGFkZHMgb3IgcmVtb3ZlcykgdGhhdCB3ZSBhcmUgd2FpdGluZyBvbi5cbiAgICAgICAgICogV2Ugb25seSBjb25zaWRlciB0YXJnZXRzIGFjdGl2ZSB0aGF0IGhhdmUgbm8gcGVuZGluZyByZXNwb25zZXMuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLkYgPSAwLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEtlZXBzIHRyYWNrIG9mIHRoZSBkb2N1bWVudCBjaGFuZ2VzIHNpbmNlIHRoZSBsYXN0IHJhaXNlZCBzbmFwc2hvdC5cbiAgICAgICAgICpcbiAgICAgICAgICogVGhlc2UgY2hhbmdlcyBhcmUgY29udGludW91c2x5IHVwZGF0ZWQgYXMgd2UgcmVjZWl2ZSBkb2N1bWVudCB1cGRhdGVzIGFuZFxuICAgICAgICAgKiBhbHdheXMgcmVmbGVjdCB0aGUgY3VycmVudCBzZXQgb2YgY2hhbmdlcyBhZ2FpbnN0IHRoZSBsYXN0IGlzc3VlZCBzbmFwc2hvdC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuTSA9IE9uKCksIFxuICAgICAgICAvKiogU2VlIHB1YmxpYyBnZXR0ZXJzIGZvciBleHBsYW5hdGlvbnMgb2YgdGhlc2UgZmllbGRzLiAqL1xuICAgICAgICB0aGlzLkwgPSB3dC5FTVBUWV9CWVRFX1NUUklORywgdGhpcy5CID0gITEsIFxuICAgICAgICAvKipcbiAgICAgICAgICogV2hldGhlciB0aGlzIHRhcmdldCBzdGF0ZSBzaG91bGQgYmUgaW5jbHVkZWQgaW4gdGhlIG5leHQgc25hcHNob3QuIFdlXG4gICAgICAgICAqIGluaXRpYWxpemUgdG8gdHJ1ZSBzbyB0aGF0IG5ld2x5LWFkZGVkIHRhcmdldHMgYXJlIGluY2x1ZGVkIGluIHRoZSBuZXh0XG4gICAgICAgICAqIFJlbW90ZUV2ZW50LlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5VID0gITA7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFdoZXRoZXIgdGhpcyB0YXJnZXQgaGFzIGJlZW4gbWFya2VkICdjdXJyZW50Jy5cbiAgICAgKlxuICAgICAqICdDdXJyZW50JyBoYXMgc3BlY2lhbCBtZWFuaW5nIGluIHRoZSBSUEMgcHJvdG9jb2w6IEl0IGltcGxpZXMgdGhhdCB0aGVcbiAgICAgKiBXYXRjaCBiYWNrZW5kIGhhcyBzZW50IHVzIGFsbCBjaGFuZ2VzIHVwIHRvIHRoZSBwb2ludCBhdCB3aGljaCB0aGUgdGFyZ2V0XG4gICAgICogd2FzIGFkZGVkIGFuZCB0aGF0IHRoZSB0YXJnZXQgaXMgY29uc2lzdGVudCB3aXRoIHRoZSByZXN0IG9mIHRoZSB3YXRjaFxuICAgICAqIHN0cmVhbS5cbiAgICAgKi8gICAgZ2V0IGN1cnJlbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLkI7XG4gICAgfVxuICAgIC8qKiBUaGUgbGFzdCByZXN1bWUgdG9rZW4gc2VudCB0byB1cyBmb3IgdGhpcyB0YXJnZXQuICovICAgIGdldCByZXN1bWVUb2tlbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuTDtcbiAgICB9XG4gICAgLyoqIFdoZXRoZXIgdGhpcyB0YXJnZXQgaGFzIHBlbmRpbmcgdGFyZ2V0IGFkZHMgb3IgdGFyZ2V0IHJlbW92ZXMuICovICAgIGdldCBxKCkge1xuICAgICAgICByZXR1cm4gMCAhPT0gdGhpcy5GO1xuICAgIH1cbiAgICAvKiogV2hldGhlciB3ZSBoYXZlIG1vZGlmaWVkIGFueSBzdGF0ZSB0aGF0IHNob3VsZCB0cmlnZ2VyIGEgc25hcHNob3QuICovICAgIGdldCBLKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5VO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBcHBsaWVzIHRoZSByZXN1bWUgdG9rZW4gdG8gdGhlIFRhcmdldENoYW5nZSwgYnV0IG9ubHkgd2hlbiBpdCBoYXMgYSBuZXdcbiAgICAgKiB2YWx1ZS4gRW1wdHkgcmVzdW1lVG9rZW5zIGFyZSBkaXNjYXJkZWQuXG4gICAgICovICAgIGoodCkge1xuICAgICAgICB0LmFwcHJveGltYXRlQnl0ZVNpemUoKSA+IDAgJiYgKHRoaXMuVSA9ICEwLCB0aGlzLkwgPSB0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIHRhcmdldCBjaGFuZ2UgZnJvbSB0aGUgY3VycmVudCBzZXQgb2YgY2hhbmdlcy5cbiAgICAgKlxuICAgICAqIFRvIHJlc2V0IHRoZSBkb2N1bWVudCBjaGFuZ2VzIGFmdGVyIHJhaXNpbmcgdGhpcyBzbmFwc2hvdCwgY2FsbFxuICAgICAqIGBjbGVhclBlbmRpbmdDaGFuZ2VzKClgLlxuICAgICAqLyAgICBXKCkge1xuICAgICAgICBsZXQgdCA9IFBuKCksIGUgPSBQbigpLCBuID0gUG4oKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuTS5mb3JFYWNoKCgocywgaSkgPT4ge1xuICAgICAgICAgICAgc3dpdGNoIChpKSB7XG4gICAgICAgICAgICAgIGNhc2UgMCAvKiBBZGRlZCAqLyA6XG4gICAgICAgICAgICAgICAgdCA9IHQuYWRkKHMpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgIGNhc2UgMiAvKiBNb2RpZmllZCAqLyA6XG4gICAgICAgICAgICAgICAgZSA9IGUuYWRkKHMpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgIGNhc2UgMSAvKiBSZW1vdmVkICovIDpcbiAgICAgICAgICAgICAgICBuID0gbi5hZGQocyk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBNKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKSwgbmV3IFNuKHRoaXMuTCwgdGhpcy5CLCB0LCBlLCBuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVzZXRzIHRoZSBkb2N1bWVudCBjaGFuZ2VzIGFuZCBzZXRzIGBoYXNQZW5kaW5nQ2hhbmdlc2AgdG8gZmFsc2UuXG4gICAgICovICAgIEcoKSB7XG4gICAgICAgIHRoaXMuVSA9ICExLCB0aGlzLk0gPSBPbigpO1xuICAgIH1cbiAgICBIKHQsIGUpIHtcbiAgICAgICAgdGhpcy5VID0gITAsIHRoaXMuTSA9IHRoaXMuTS5pbnNlcnQodCwgZSk7XG4gICAgfVxuICAgIEoodCkge1xuICAgICAgICB0aGlzLlUgPSAhMCwgdGhpcy5NID0gdGhpcy5NLnJlbW92ZSh0KTtcbiAgICB9XG4gICAgWSgpIHtcbiAgICAgICAgdGhpcy5GICs9IDE7XG4gICAgfVxuICAgIFgoKSB7XG4gICAgICAgIHRoaXMuRiAtPSAxO1xuICAgIH1cbiAgICBaKCkge1xuICAgICAgICB0aGlzLlUgPSAhMCwgdGhpcy5CID0gITA7XG4gICAgfVxufVxuXG4vKipcbiAqIEEgaGVscGVyIGNsYXNzIHRvIGFjY3VtdWxhdGUgd2F0Y2ggY2hhbmdlcyBpbnRvIGEgUmVtb3RlRXZlbnQuXG4gKi9cbmNsYXNzIGtuIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMudHQgPSB0LCBcbiAgICAgICAgLyoqIFRoZSBpbnRlcm5hbCBzdGF0ZSBvZiBhbGwgdHJhY2tlZCB0YXJnZXRzLiAqL1xuICAgICAgICB0aGlzLmV0ID0gbmV3IE1hcCwgXG4gICAgICAgIC8qKiBLZWVwcyB0cmFjayBvZiB0aGUgZG9jdW1lbnRzIHRvIHVwZGF0ZSBzaW5jZSB0aGUgbGFzdCByYWlzZWQgc25hcHNob3QuICovXG4gICAgICAgIHRoaXMubnQgPSBwbigpLCBcbiAgICAgICAgLyoqIEEgbWFwcGluZyBvZiBkb2N1bWVudCBrZXlzIHRvIHRoZWlyIHNldCBvZiB0YXJnZXQgSURzLiAqL1xuICAgICAgICB0aGlzLnN0ID0gJG4oKSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIGxpc3Qgb2YgdGFyZ2V0cyB3aXRoIGV4aXN0ZW5jZSBmaWx0ZXIgbWlzbWF0Y2hlcy4gVGhlc2UgdGFyZ2V0cyBhcmVcbiAgICAgICAgICoga25vd24gdG8gYmUgaW5jb25zaXN0ZW50IGFuZCB0aGVpciBsaXN0ZW5zIG5lZWRzIHRvIGJlIHJlLWVzdGFibGlzaGVkIGJ5XG4gICAgICAgICAqIFJlbW90ZVN0b3JlLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5pdCA9IG5ldyBtbih0dCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFByb2Nlc3NlcyBhbmQgYWRkcyB0aGUgRG9jdW1lbnRXYXRjaENoYW5nZSB0byB0aGUgY3VycmVudCBzZXQgb2YgY2hhbmdlcy5cbiAgICAgKi8gICAgcnQodCkge1xuICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdC5rKSB0LiQgJiYgdC4kLmlzRm91bmREb2N1bWVudCgpID8gdGhpcy5vdChlLCB0LiQpIDogdGhpcy5hdChlLCB0LmtleSwgdC4kKTtcbiAgICAgICAgZm9yIChjb25zdCBlIG9mIHQucmVtb3ZlZFRhcmdldElkcykgdGhpcy5hdChlLCB0LmtleSwgdC4kKTtcbiAgICB9XG4gICAgLyoqIFByb2Nlc3NlcyBhbmQgYWRkcyB0aGUgV2F0Y2hUYXJnZXRDaGFuZ2UgdG8gdGhlIGN1cnJlbnQgc2V0IG9mIGNoYW5nZXMuICovICAgIGN0KHQpIHtcbiAgICAgICAgdGhpcy5mb3JFYWNoVGFyZ2V0KHQsIChlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLnV0KGUpO1xuICAgICAgICAgICAgc3dpdGNoICh0LnN0YXRlKSB7XG4gICAgICAgICAgICAgIGNhc2UgMCAvKiBOb0NoYW5nZSAqLyA6XG4gICAgICAgICAgICAgICAgdGhpcy5odChlKSAmJiBuLmoodC5yZXN1bWVUb2tlbik7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgY2FzZSAxIC8qIEFkZGVkICovIDpcbiAgICAgICAgICAgICAgICAvLyBXZSBuZWVkIHRvIGRlY3JlbWVudCB0aGUgbnVtYmVyIG9mIHBlbmRpbmcgYWNrcyBuZWVkZWQgZnJvbSB3YXRjaFxuICAgICAgICAgICAgICAgIC8vIGZvciB0aGlzIHRhcmdldElkLlxuICAgICAgICAgICAgICAgIG4uWCgpLCBuLnEgfHwgXG4gICAgICAgICAgICAgICAgLy8gV2UgaGF2ZSBhIGZyZXNobHkgYWRkZWQgdGFyZ2V0LCBzbyB3ZSBuZWVkIHRvIHJlc2V0IGFueSBzdGF0ZVxuICAgICAgICAgICAgICAgIC8vIHRoYXQgd2UgaGFkIHByZXZpb3VzbHkuIFRoaXMgY2FuIGhhcHBlbiBlLmcuIHdoZW4gcmVtb3ZlIGFuZCBhZGRcbiAgICAgICAgICAgICAgICAvLyBiYWNrIGEgdGFyZ2V0IGZvciBleGlzdGVuY2UgZmlsdGVyIG1pc21hdGNoZXMuXG4gICAgICAgICAgICAgICAgbi5HKCksIG4uaih0LnJlc3VtZVRva2VuKTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICBjYXNlIDIgLyogUmVtb3ZlZCAqLyA6XG4gICAgICAgICAgICAgICAgLy8gV2UgbmVlZCB0byBrZWVwIHRyYWNrIG9mIHJlbW92ZWQgdGFyZ2V0cyB0byB3ZSBjYW4gcG9zdC1maWx0ZXIgYW5kXG4gICAgICAgICAgICAgICAgLy8gcmVtb3ZlIGFueSB0YXJnZXQgY2hhbmdlcy5cbiAgICAgICAgICAgICAgICAvLyBXZSBuZWVkIHRvIGRlY3JlbWVudCB0aGUgbnVtYmVyIG9mIHBlbmRpbmcgYWNrcyBuZWVkZWQgZnJvbSB3YXRjaFxuICAgICAgICAgICAgICAgIC8vIGZvciB0aGlzIHRhcmdldElkLlxuICAgICAgICAgICAgICAgIG4uWCgpLCBuLnEgfHwgdGhpcy5yZW1vdmVUYXJnZXQoZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgY2FzZSAzIC8qIEN1cnJlbnQgKi8gOlxuICAgICAgICAgICAgICAgIHRoaXMuaHQoZSkgJiYgKG4uWigpLCBuLmoodC5yZXN1bWVUb2tlbikpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgIGNhc2UgNCAvKiBSZXNldCAqLyA6XG4gICAgICAgICAgICAgICAgdGhpcy5odChlKSAmJiAoXG4gICAgICAgICAgICAgICAgLy8gUmVzZXQgdGhlIHRhcmdldCBhbmQgc3ludGhlc2l6ZXMgcmVtb3ZlcyBmb3IgYWxsIGV4aXN0aW5nXG4gICAgICAgICAgICAgICAgLy8gZG9jdW1lbnRzLiBUaGUgYmFja2VuZCB3aWxsIHJlLWFkZCBhbnkgZG9jdW1lbnRzIHRoYXQgc3RpbGxcbiAgICAgICAgICAgICAgICAvLyBtYXRjaCB0aGUgdGFyZ2V0IGJlZm9yZSBpdCBzZW5kcyB0aGUgbmV4dCBnbG9iYWwgc25hcHNob3QuXG4gICAgICAgICAgICAgICAgdGhpcy5sdChlKSwgbi5qKHQucmVzdW1lVG9rZW4pKTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIE0oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJdGVyYXRlcyBvdmVyIGFsbCB0YXJnZXRJZHMgdGhhdCB0aGUgd2F0Y2ggY2hhbmdlIGFwcGxpZXMgdG86IGVpdGhlciB0aGVcbiAgICAgKiB0YXJnZXRJZHMgZXhwbGljaXRseSBsaXN0ZWQgaW4gdGhlIGNoYW5nZSBvciB0aGUgdGFyZ2V0SWRzIG9mIGFsbCBjdXJyZW50bHlcbiAgICAgKiBhY3RpdmUgdGFyZ2V0cy5cbiAgICAgKi8gICAgZm9yRWFjaFRhcmdldCh0LCBlKSB7XG4gICAgICAgIHQudGFyZ2V0SWRzLmxlbmd0aCA+IDAgPyB0LnRhcmdldElkcy5mb3JFYWNoKGUpIDogdGhpcy5ldC5mb3JFYWNoKCgodCwgbikgPT4ge1xuICAgICAgICAgICAgdGhpcy5odChuKSAmJiBlKG4pO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEhhbmRsZXMgZXhpc3RlbmNlIGZpbHRlcnMgYW5kIHN5bnRoZXNpemVzIGRlbGV0ZXMgZm9yIGZpbHRlciBtaXNtYXRjaGVzLlxuICAgICAqIFRhcmdldHMgdGhhdCBhcmUgaW52YWxpZGF0ZWQgYnkgZmlsdGVyIG1pc21hdGNoZXMgYXJlIGFkZGVkIHRvXG4gICAgICogYHBlbmRpbmdUYXJnZXRSZXNldHNgLlxuICAgICAqLyAgICBmdCh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0LnRhcmdldElkLCBuID0gdC5PLmNvdW50LCBzID0gdGhpcy5kdChlKTtcbiAgICAgICAgaWYgKHMpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBzLnRhcmdldDtcbiAgICAgICAgICAgIGlmICh6dCh0KSkgaWYgKDAgPT09IG4pIHtcbiAgICAgICAgICAgICAgICAvLyBUaGUgZXhpc3RlbmNlIGZpbHRlciB0b2xkIHVzIHRoZSBkb2N1bWVudCBkb2VzIG5vdCBleGlzdC4gV2UgZGVkdWNlXG4gICAgICAgICAgICAgICAgLy8gdGhhdCB0aGlzIGRvY3VtZW50IGRvZXMgbm90IGV4aXN0IGFuZCBhcHBseSBhIGRlbGV0ZWQgZG9jdW1lbnQgdG9cbiAgICAgICAgICAgICAgICAvLyBvdXIgdXBkYXRlcy4gV2l0aG91dCBhcHBseWluZyB0aGlzIGRlbGV0ZWQgZG9jdW1lbnQgdGhlcmUgbWlnaHQgYmVcbiAgICAgICAgICAgICAgICAvLyBhbm90aGVyIHF1ZXJ5IHRoYXQgd2lsbCByYWlzZSB0aGlzIGRvY3VtZW50IGFzIHBhcnQgb2YgYSBzbmFwc2hvdFxuICAgICAgICAgICAgICAgIC8vIHVudGlsIGl0IGlzIHJlc29sdmVkLCBlc3NlbnRpYWxseSBleHBvc2luZyBpbmNvbnNpc3RlbmN5IGJldHdlZW5cbiAgICAgICAgICAgICAgICAvLyBxdWVyaWVzLlxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBuZXcgUHQodC5wYXRoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmF0KGUsIG4sIHF0Lm5ld05vRG9jdW1lbnQobiwgaXQubWluKCkpKTtcbiAgICAgICAgICAgIH0gZWxzZSBMKDEgPT09IG4pOyBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnd0KGUpICE9PSBuICYmIChcbiAgICAgICAgICAgICAgICAvLyBFeGlzdGVuY2UgZmlsdGVyIG1pc21hdGNoOiBXZSByZXNldCB0aGUgbWFwcGluZyBhbmQgcmFpc2UgYSBuZXdcbiAgICAgICAgICAgICAgICAvLyBzbmFwc2hvdCB3aXRoIGBpc0Zyb21DYWNoZTp0cnVlYC5cbiAgICAgICAgICAgICAgICB0aGlzLmx0KGUpLCB0aGlzLml0ID0gdGhpcy5pdC5hZGQoZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENvbnZlcnRzIHRoZSBjdXJyZW50bHkgYWNjdW11bGF0ZWQgc3RhdGUgaW50byBhIHJlbW90ZSBldmVudCBhdCB0aGVcbiAgICAgKiBwcm92aWRlZCBzbmFwc2hvdCB2ZXJzaW9uLiBSZXNldHMgdGhlIGFjY3VtdWxhdGVkIGNoYW5nZXMgYmVmb3JlIHJldHVybmluZy5cbiAgICAgKi8gICAgX3QodCkge1xuICAgICAgICBjb25zdCBlID0gbmV3IE1hcDtcbiAgICAgICAgdGhpcy5ldC5mb3JFYWNoKCgobiwgcykgPT4ge1xuICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuZHQocyk7XG4gICAgICAgICAgICBpZiAoaSkge1xuICAgICAgICAgICAgICAgIGlmIChuLmN1cnJlbnQgJiYgenQoaS50YXJnZXQpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIERvY3VtZW50IHF1ZXJpZXMgZm9yIGRvY3VtZW50IHRoYXQgZG9uJ3QgZXhpc3QgY2FuIHByb2R1Y2UgYW4gZW1wdHlcbiAgICAgICAgICAgICAgICAgICAgLy8gcmVzdWx0IHNldC4gVG8gdXBkYXRlIG91ciBsb2NhbCBjYWNoZSwgd2Ugc3ludGhlc2l6ZSBhIGRvY3VtZW50XG4gICAgICAgICAgICAgICAgICAgIC8vIGRlbGV0ZSBpZiB3ZSBoYXZlIG5vdCBwcmV2aW91c2x5IHJlY2VpdmVkIHRoZSBkb2N1bWVudC4gVGhpc1xuICAgICAgICAgICAgICAgICAgICAvLyByZXNvbHZlcyB0aGUgbGltYm8gc3RhdGUgb2YgdGhlIGRvY3VtZW50LCByZW1vdmluZyBpdCBmcm9tXG4gICAgICAgICAgICAgICAgICAgIC8vIGxpbWJvRG9jdW1lbnRSZWZzLlxuICAgICAgICAgICAgICAgICAgICAvLyBUT0RPKGRpbW9uZCk6IElkZWFsbHkgd2Ugd291bGQgaGF2ZSBhbiBleHBsaWNpdCBsb29rdXAgdGFyZ2V0XG4gICAgICAgICAgICAgICAgICAgIC8vIGluc3RlYWQgcmVzdWx0aW5nIGluIGFuIGV4cGxpY2l0IGRlbGV0ZSBtZXNzYWdlIGFuZCB3ZSBjb3VsZFxuICAgICAgICAgICAgICAgICAgICAvLyByZW1vdmUgdGhpcyBzcGVjaWFsIGxvZ2ljLlxuICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gbmV3IFB0KGkudGFyZ2V0LnBhdGgpO1xuICAgICAgICAgICAgICAgICAgICBudWxsICE9PSB0aGlzLm50LmdldChlKSB8fCB0aGlzLmd0KHMsIGUpIHx8IHRoaXMuYXQocywgZSwgcXQubmV3Tm9Eb2N1bWVudChlLCB0KSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG4uSyAmJiAoZS5zZXQocywgbi5XKCkpLCBuLkcoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgbGV0IG4gPSBQbigpO1xuICAgICAgICAvLyBXZSBleHRyYWN0IHRoZSBzZXQgb2YgbGltYm8tb25seSBkb2N1bWVudCB1cGRhdGVzIGFzIHRoZSBHQyBsb2dpY1xuICAgICAgICAvLyBzcGVjaWFsLWNhc2VzIGRvY3VtZW50cyB0aGF0IGRvIG5vdCBhcHBlYXIgaW4gdGhlIHRhcmdldCBjYWNoZS5cbiAgICAgICAgXG4gICAgICAgIC8vIFRPRE8oZ3NvbHRpcyk6IEV4cGFuZCBvbiB0aGlzIGNvbW1lbnQgb25jZSBHQyBpcyBhdmFpbGFibGUgaW4gdGhlIEpTXG4gICAgICAgIC8vIGNsaWVudC5cbiAgICAgICAgICAgICAgICB0aGlzLnN0LmZvckVhY2goKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICBsZXQgcyA9ICEwO1xuICAgICAgICAgICAgZS5mb3JFYWNoV2hpbGUoKHQgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLmR0KHQpO1xuICAgICAgICAgICAgICAgIHJldHVybiAhZSB8fCAyIC8qIExpbWJvUmVzb2x1dGlvbiAqLyA9PT0gZS5wdXJwb3NlIHx8IChzID0gITEsICExKTtcbiAgICAgICAgICAgIH0pKSwgcyAmJiAobiA9IG4uYWRkKHQpKTtcbiAgICAgICAgfSkpO1xuICAgICAgICBjb25zdCBzID0gbmV3IFZuKHQsIGUsIHRoaXMuaXQsIHRoaXMubnQsIG4pO1xuICAgICAgICByZXR1cm4gdGhpcy5udCA9IHBuKCksIHRoaXMuc3QgPSAkbigpLCB0aGlzLml0ID0gbmV3IG1uKHR0KSwgcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkcyB0aGUgcHJvdmlkZWQgZG9jdW1lbnQgdG8gdGhlIGludGVybmFsIGxpc3Qgb2YgZG9jdW1lbnQgdXBkYXRlcyBhbmRcbiAgICAgKiBpdHMgZG9jdW1lbnQga2V5IHRvIHRoZSBnaXZlbiB0YXJnZXQncyBtYXBwaW5nLlxuICAgICAqL1xuICAgIC8vIFZpc2libGUgZm9yIHRlc3RpbmcuXG4gICAgb3QodCwgZSkge1xuICAgICAgICBpZiAoIXRoaXMuaHQodCkpIHJldHVybjtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMuZ3QodCwgZS5rZXkpID8gMiAvKiBNb2RpZmllZCAqLyA6IDAgLyogQWRkZWQgKi87XG4gICAgICAgIHRoaXMudXQodCkuSChlLmtleSwgbiksIHRoaXMubnQgPSB0aGlzLm50Lmluc2VydChlLmtleSwgZSksIHRoaXMuc3QgPSB0aGlzLnN0Lmluc2VydChlLmtleSwgdGhpcy55dChlLmtleSkuYWRkKHQpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyB0aGUgcHJvdmlkZWQgZG9jdW1lbnQgZnJvbSB0aGUgdGFyZ2V0IG1hcHBpbmcuIElmIHRoZVxuICAgICAqIGRvY3VtZW50IG5vIGxvbmdlciBtYXRjaGVzIHRoZSB0YXJnZXQsIGJ1dCB0aGUgZG9jdW1lbnQncyBzdGF0ZSBpcyBzdGlsbFxuICAgICAqIGtub3duIChlLmcuIHdlIGtub3cgdGhhdCB0aGUgZG9jdW1lbnQgd2FzIGRlbGV0ZWQgb3Igd2UgcmVjZWl2ZWQgdGhlIGNoYW5nZVxuICAgICAqIHRoYXQgY2F1c2VkIHRoZSBmaWx0ZXIgbWlzbWF0Y2gpLCB0aGUgbmV3IGRvY3VtZW50IGNhbiBiZSBwcm92aWRlZFxuICAgICAqIHRvIHVwZGF0ZSB0aGUgcmVtb3RlIGRvY3VtZW50IGNhY2hlLlxuICAgICAqL1xuICAgIC8vIFZpc2libGUgZm9yIHRlc3RpbmcuXG4gICAgYXQodCwgZSwgbikge1xuICAgICAgICBpZiAoIXRoaXMuaHQodCkpIHJldHVybjtcbiAgICAgICAgY29uc3QgcyA9IHRoaXMudXQodCk7XG4gICAgICAgIHRoaXMuZ3QodCwgZSkgPyBzLkgoZSwgMSAvKiBSZW1vdmVkICovKSA6IFxuICAgICAgICAvLyBUaGUgZG9jdW1lbnQgbWF5IGhhdmUgZW50ZXJlZCBhbmQgbGVmdCB0aGUgdGFyZ2V0IGJlZm9yZSB3ZSByYWlzZWQgYVxuICAgICAgICAvLyBzbmFwc2hvdCwgc28gd2UgY2FuIGp1c3QgaWdub3JlIHRoZSBjaGFuZ2UuXG4gICAgICAgIHMuSihlKSwgdGhpcy5zdCA9IHRoaXMuc3QuaW5zZXJ0KGUsIHRoaXMueXQoZSkuZGVsZXRlKHQpKSwgbiAmJiAodGhpcy5udCA9IHRoaXMubnQuaW5zZXJ0KGUsIG4pKTtcbiAgICB9XG4gICAgcmVtb3ZlVGFyZ2V0KHQpIHtcbiAgICAgICAgdGhpcy5ldC5kZWxldGUodCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIGN1cnJlbnQgY291bnQgb2YgZG9jdW1lbnRzIGluIHRoZSB0YXJnZXQuIFRoaXMgaW5jbHVkZXMgYm90aFxuICAgICAqIHRoZSBudW1iZXIgb2YgZG9jdW1lbnRzIHRoYXQgdGhlIExvY2FsU3RvcmUgY29uc2lkZXJzIHRvIGJlIHBhcnQgb2YgdGhlXG4gICAgICogdGFyZ2V0IGFzIHdlbGwgYXMgYW55IGFjY3VtdWxhdGVkIGNoYW5nZXMuXG4gICAgICovICAgIHd0KHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMudXQodCkuVygpO1xuICAgICAgICByZXR1cm4gdGhpcy50dC5nZXRSZW1vdGVLZXlzRm9yVGFyZ2V0KHQpLnNpemUgKyBlLmFkZGVkRG9jdW1lbnRzLnNpemUgLSBlLnJlbW92ZWREb2N1bWVudHMuc2l6ZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSW5jcmVtZW50IHRoZSBudW1iZXIgb2YgYWNrcyBuZWVkZWQgZnJvbSB3YXRjaCBiZWZvcmUgd2UgY2FuIGNvbnNpZGVyIHRoZVxuICAgICAqIHNlcnZlciB0byBiZSAnaW4tc3luYycgd2l0aCB0aGUgY2xpZW50J3MgYWN0aXZlIHRhcmdldHMuXG4gICAgICovICAgIFkodCkge1xuICAgICAgICB0aGlzLnV0KHQpLlkoKTtcbiAgICB9XG4gICAgdXQodCkge1xuICAgICAgICBsZXQgZSA9IHRoaXMuZXQuZ2V0KHQpO1xuICAgICAgICByZXR1cm4gZSB8fCAoZSA9IG5ldyB4biwgdGhpcy5ldC5zZXQodCwgZSkpLCBlO1xuICAgIH1cbiAgICB5dCh0KSB7XG4gICAgICAgIGxldCBlID0gdGhpcy5zdC5nZXQodCk7XG4gICAgICAgIHJldHVybiBlIHx8IChlID0gbmV3IG1uKHR0KSwgdGhpcy5zdCA9IHRoaXMuc3QuaW5zZXJ0KHQsIGUpKSwgZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVmVyaWZpZXMgdGhhdCB0aGUgdXNlciBpcyBzdGlsbCBpbnRlcmVzdGVkIGluIHRoaXMgdGFyZ2V0IChieSBjYWxsaW5nXG4gICAgICogYGdldFRhcmdldERhdGFGb3JUYXJnZXQoKWApIGFuZCB0aGF0IHdlIGFyZSBub3Qgd2FpdGluZyBmb3IgcGVuZGluZyBBRERzXG4gICAgICogZnJvbSB3YXRjaC5cbiAgICAgKi8gICAgaHQodCkge1xuICAgICAgICBjb25zdCBlID0gbnVsbCAhPT0gdGhpcy5kdCh0KTtcbiAgICAgICAgcmV0dXJuIGUgfHwgayhcIldhdGNoQ2hhbmdlQWdncmVnYXRvclwiLCBcIkRldGVjdGVkIGluYWN0aXZlIHRhcmdldFwiLCB0KSwgZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgVGFyZ2V0RGF0YSBmb3IgYW4gYWN0aXZlIHRhcmdldCAoaS5lLiBhIHRhcmdldCB0aGF0IHRoZSB1c2VyXG4gICAgICogaXMgc3RpbGwgaW50ZXJlc3RlZCBpbiB0aGF0IGhhcyBubyBvdXRzdGFuZGluZyB0YXJnZXQgY2hhbmdlIHJlcXVlc3RzKS5cbiAgICAgKi8gICAgZHQodCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5ldC5nZXQodCk7XG4gICAgICAgIHJldHVybiBlICYmIGUucSA/IG51bGwgOiB0aGlzLnR0LkV0KHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXNldHMgdGhlIHN0YXRlIG9mIGEgV2F0Y2ggdGFyZ2V0IHRvIGl0cyBpbml0aWFsIHN0YXRlIChlLmcuIHNldHNcbiAgICAgKiAnY3VycmVudCcgdG8gZmFsc2UsIGNsZWFycyB0aGUgcmVzdW1lIHRva2VuIGFuZCByZW1vdmVzIGl0cyB0YXJnZXQgbWFwcGluZ1xuICAgICAqIGZyb20gYWxsIGRvY3VtZW50cykuXG4gICAgICovICAgIGx0KHQpIHtcbiAgICAgICAgdGhpcy5ldC5zZXQodCwgbmV3IHhuKTtcbiAgICAgICAgdGhpcy50dC5nZXRSZW1vdGVLZXlzRm9yVGFyZ2V0KHQpLmZvckVhY2goKGUgPT4ge1xuICAgICAgICAgICAgdGhpcy5hdCh0LCBlLCAvKnVwZGF0ZWREb2N1bWVudD0qLyBudWxsKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHdoZXRoZXIgdGhlIExvY2FsU3RvcmUgY29uc2lkZXJzIHRoZSBkb2N1bWVudCB0byBiZSBwYXJ0IG9mIHRoZVxuICAgICAqIHNwZWNpZmllZCB0YXJnZXQuXG4gICAgICovICAgIGd0KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudHQuZ2V0UmVtb3RlS2V5c0ZvclRhcmdldCh0KS5oYXMoZSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiAkbigpIHtcbiAgICByZXR1cm4gbmV3IGRuKFB0LmNvbXBhcmF0b3IpO1xufVxuXG5mdW5jdGlvbiBPbigpIHtcbiAgICByZXR1cm4gbmV3IGRuKFB0LmNvbXBhcmF0b3IpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjb25zdCBGbiA9ICgoKSA9PiB7XG4gICAgY29uc3QgdCA9IHtcbiAgICAgICAgYXNjOiBcIkFTQ0VORElOR1wiLFxuICAgICAgICBkZXNjOiBcIkRFU0NFTkRJTkdcIlxuICAgIH07XG4gICAgcmV0dXJuIHQ7XG59KSgpLCBNbiA9ICgoKSA9PiB7XG4gICAgY29uc3QgdCA9IHtcbiAgICAgICAgXCI8XCI6IFwiTEVTU19USEFOXCIsXG4gICAgICAgIFwiPD1cIjogXCJMRVNTX1RIQU5fT1JfRVFVQUxcIixcbiAgICAgICAgXCI+XCI6IFwiR1JFQVRFUl9USEFOXCIsXG4gICAgICAgIFwiPj1cIjogXCJHUkVBVEVSX1RIQU5fT1JfRVFVQUxcIixcbiAgICAgICAgXCI9PVwiOiBcIkVRVUFMXCIsXG4gICAgICAgIFwiIT1cIjogXCJOT1RfRVFVQUxcIixcbiAgICAgICAgXCJhcnJheS1jb250YWluc1wiOiBcIkFSUkFZX0NPTlRBSU5TXCIsXG4gICAgICAgIGluOiBcIklOXCIsXG4gICAgICAgIFwibm90LWluXCI6IFwiTk9UX0lOXCIsXG4gICAgICAgIFwiYXJyYXktY29udGFpbnMtYW55XCI6IFwiQVJSQVlfQ09OVEFJTlNfQU5ZXCJcbiAgICB9O1xuICAgIHJldHVybiB0O1xufSkoKTtcblxuLyoqXG4gKiBUaGlzIGNsYXNzIGdlbmVyYXRlcyBKc29uT2JqZWN0IHZhbHVlcyBmb3IgdGhlIERhdGFzdG9yZSBBUEkgc3VpdGFibGUgZm9yXG4gKiBzZW5kaW5nIHRvIGVpdGhlciBHUlBDIHN0dWIgbWV0aG9kcyBvciB2aWEgdGhlIEpTT04vSFRUUCBSRVNUIEFQSS5cbiAqXG4gKiBUaGUgc2VyaWFsaXplciBzdXBwb3J0cyBib3RoIFByb3RvYnVmLmpzIGFuZCBQcm90bzMgSlNPTiBmb3JtYXRzLiBCeVxuICogc2V0dGluZyBgdXNlUHJvdG8zSnNvbmAgdG8gdHJ1ZSwgdGhlIHNlcmlhbGl6ZXIgd2lsbCB1c2UgdGhlIFByb3RvMyBKU09OXG4gKiBmb3JtYXQuXG4gKlxuICogRm9yIGEgZGVzY3JpcHRpb24gb2YgdGhlIFByb3RvMyBKU09OIGZvcm1hdCBjaGVja1xuICogaHR0cHM6Ly9kZXZlbG9wZXJzLmdvb2dsZS5jb20vcHJvdG9jb2wtYnVmZmVycy9kb2NzL3Byb3RvMyNqc29uXG4gKlxuICogVE9ETyhrbGltdCk6IFdlIGNhbiByZW1vdmUgdGhlIGRhdGFiYXNlSWQgYXJndW1lbnQgaWYgd2Uga2VlcCB0aGUgZnVsbFxuICogcmVzb3VyY2UgbmFtZSBpbiBkb2N1bWVudHMuXG4gKi9cbmNsYXNzIExuIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMuZGF0YWJhc2VJZCA9IHQsIHRoaXMuRCA9IGU7XG4gICAgfVxufVxuXG4vKipcbiAqIFJldHVybnMgYSB2YWx1ZSBmb3IgYSBEYXRlIHRoYXQncyBhcHByb3ByaWF0ZSB0byBwdXQgaW50byBhIHByb3RvLlxuICovXG5mdW5jdGlvbiBCbih0LCBlKSB7XG4gICAgaWYgKHQuRCkge1xuICAgICAgICByZXR1cm4gYCR7bmV3IERhdGUoMWUzICogZS5zZWNvbmRzKS50b0lTT1N0cmluZygpLnJlcGxhY2UoL1xcLlxcZCovLCBcIlwiKS5yZXBsYWNlKFwiWlwiLCBcIlwiKX0uJHsoXCIwMDAwMDAwMDBcIiArIGUubmFub3NlY29uZHMpLnNsaWNlKC05KX1aYDtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgc2Vjb25kczogXCJcIiArIGUuc2Vjb25kcyxcbiAgICAgICAgbmFub3M6IGUubmFub3NlY29uZHNcbiAgICB9O1xufVxuXG4vKipcbiAqIFJldHVybnMgYSB2YWx1ZSBmb3IgYnl0ZXMgdGhhdCdzIGFwcHJvcHJpYXRlIHRvIHB1dCBpbiBhIHByb3RvLlxuICpcbiAqIFZpc2libGUgZm9yIHRlc3RpbmcuXG4gKi9cbmZ1bmN0aW9uIFVuKHQsIGUpIHtcbiAgICByZXR1cm4gdC5EID8gZS50b0Jhc2U2NCgpIDogZS50b1VpbnQ4QXJyYXkoKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgQnl0ZVN0cmluZyBiYXNlZCBvbiB0aGUgcHJvdG8gc3RyaW5nIHZhbHVlLlxuICovIGZ1bmN0aW9uIHFuKHQsIGUpIHtcbiAgICByZXR1cm4gQm4odCwgZS50b1RpbWVzdGFtcCgpKTtcbn1cblxuZnVuY3Rpb24gS24odCkge1xuICAgIHJldHVybiBMKCEhdCksIGl0LmZyb21UaW1lc3RhbXAoZnVuY3Rpb24odCkge1xuICAgICAgICBjb25zdCBlID0gbXQodCk7XG4gICAgICAgIHJldHVybiBuZXcgc3QoZS5zZWNvbmRzLCBlLm5hbm9zKTtcbiAgICB9KHQpKTtcbn1cblxuZnVuY3Rpb24gam4odCwgZSkge1xuICAgIHJldHVybiBmdW5jdGlvbih0KSB7XG4gICAgICAgIHJldHVybiBuZXcgdXQoWyBcInByb2plY3RzXCIsIHQucHJvamVjdElkLCBcImRhdGFiYXNlc1wiLCB0LmRhdGFiYXNlIF0pO1xuICAgIH0odCkuY2hpbGQoXCJkb2N1bWVudHNcIikuY2hpbGQoZSkuY2Fub25pY2FsU3RyaW5nKCk7XG59XG5cbmZ1bmN0aW9uIFFuKHQpIHtcbiAgICBjb25zdCBlID0gdXQuZnJvbVN0cmluZyh0KTtcbiAgICByZXR1cm4gTChwcyhlKSksIGU7XG59XG5cbmZ1bmN0aW9uIFduKHQsIGUpIHtcbiAgICByZXR1cm4gam4odC5kYXRhYmFzZUlkLCBlLnBhdGgpO1xufVxuXG5mdW5jdGlvbiBHbih0LCBlKSB7XG4gICAgY29uc3QgbiA9IFFuKGUpO1xuICAgIGlmIChuLmdldCgxKSAhPT0gdC5kYXRhYmFzZUlkLnByb2plY3RJZCkgdGhyb3cgbmV3IEsocS5JTlZBTElEX0FSR1VNRU5ULCBcIlRyaWVkIHRvIGRlc2VyaWFsaXplIGtleSBmcm9tIGRpZmZlcmVudCBwcm9qZWN0OiBcIiArIG4uZ2V0KDEpICsgXCIgdnMgXCIgKyB0LmRhdGFiYXNlSWQucHJvamVjdElkKTtcbiAgICBpZiAobi5nZXQoMykgIT09IHQuZGF0YWJhc2VJZC5kYXRhYmFzZSkgdGhyb3cgbmV3IEsocS5JTlZBTElEX0FSR1VNRU5ULCBcIlRyaWVkIHRvIGRlc2VyaWFsaXplIGtleSBmcm9tIGRpZmZlcmVudCBkYXRhYmFzZTogXCIgKyBuLmdldCgzKSArIFwiIHZzIFwiICsgdC5kYXRhYmFzZUlkLmRhdGFiYXNlKTtcbiAgICByZXR1cm4gbmV3IFB0KFluKG4pKTtcbn1cblxuZnVuY3Rpb24gem4odCwgZSkge1xuICAgIHJldHVybiBqbih0LmRhdGFiYXNlSWQsIGUpO1xufVxuXG5mdW5jdGlvbiBIbih0KSB7XG4gICAgY29uc3QgZSA9IFFuKHQpO1xuICAgIC8vIEluIHYxYmV0YTEgcXVlcmllcyBmb3IgY29sbGVjdGlvbnMgYXQgdGhlIHJvb3QgZGlkIG5vdCBoYXZlIGEgdHJhaWxpbmdcbiAgICAvLyBcIi9kb2N1bWVudHNcIi4gSW4gdjEgYWxsIHJlc291cmNlIHBhdGhzIGNvbnRhaW4gXCIvZG9jdW1lbnRzXCIuIFByZXNlcnZlIHRoZVxuICAgIC8vIGFiaWxpdHkgdG8gcmVhZCB0aGUgdjFiZXRhMSBmb3JtIGZvciBjb21wYXRpYmlsaXR5IHdpdGggcXVlcmllcyBwZXJzaXN0ZWRcbiAgICAvLyBpbiB0aGUgbG9jYWwgdGFyZ2V0IGNhY2hlLlxuICAgICAgICByZXR1cm4gNCA9PT0gZS5sZW5ndGggPyB1dC5lbXB0eVBhdGgoKSA6IFluKGUpO1xufVxuXG5mdW5jdGlvbiBKbih0KSB7XG4gICAgcmV0dXJuIG5ldyB1dChbIFwicHJvamVjdHNcIiwgdC5kYXRhYmFzZUlkLnByb2plY3RJZCwgXCJkYXRhYmFzZXNcIiwgdC5kYXRhYmFzZUlkLmRhdGFiYXNlIF0pLmNhbm9uaWNhbFN0cmluZygpO1xufVxuXG5mdW5jdGlvbiBZbih0KSB7XG4gICAgcmV0dXJuIEwodC5sZW5ndGggPiA0ICYmIFwiZG9jdW1lbnRzXCIgPT09IHQuZ2V0KDQpKSwgdC5wb3BGaXJzdCg1KTtcbn1cblxuLyoqIENyZWF0ZXMgYSBEb2N1bWVudCBwcm90byBmcm9tIGtleSBhbmQgZmllbGRzIChidXQgbm8gY3JlYXRlL3VwZGF0ZSB0aW1lKSAqLyBmdW5jdGlvbiBYbih0LCBlLCBuKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgbmFtZTogV24odCwgZSksXG4gICAgICAgIGZpZWxkczogbi52YWx1ZS5tYXBWYWx1ZS5maWVsZHNcbiAgICB9O1xufVxuXG5mdW5jdGlvbiBabih0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9IEduKHQsIGUubmFtZSksIGkgPSBLbihlLnVwZGF0ZVRpbWUpLCByID0gbmV3IEJ0KHtcbiAgICAgICAgbWFwVmFsdWU6IHtcbiAgICAgICAgICAgIGZpZWxkczogZS5maWVsZHNcbiAgICAgICAgfVxuICAgIH0pLCBvID0gcXQubmV3Rm91bmREb2N1bWVudChzLCBpLCByKTtcbiAgICByZXR1cm4gbiAmJiBvLnNldEhhc0NvbW1pdHRlZE11dGF0aW9ucygpLCBuID8gby5zZXRIYXNDb21taXR0ZWRNdXRhdGlvbnMoKSA6IG87XG59XG5cbmZ1bmN0aW9uIHRzKHQsIGUpIHtcbiAgICByZXR1cm4gXCJmb3VuZFwiIGluIGUgPyBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIEwoISFlLmZvdW5kKSwgZS5mb3VuZC5uYW1lLCBlLmZvdW5kLnVwZGF0ZVRpbWU7XG4gICAgICAgIGNvbnN0IG4gPSBHbih0LCBlLmZvdW5kLm5hbWUpLCBzID0gS24oZS5mb3VuZC51cGRhdGVUaW1lKSwgaSA9IG5ldyBCdCh7XG4gICAgICAgICAgICBtYXBWYWx1ZToge1xuICAgICAgICAgICAgICAgIGZpZWxkczogZS5mb3VuZC5maWVsZHNcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBxdC5uZXdGb3VuZERvY3VtZW50KG4sIHMsIGkpO1xuICAgIH0odCwgZSkgOiBcIm1pc3NpbmdcIiBpbiBlID8gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBMKCEhZS5taXNzaW5nKSwgTCghIWUucmVhZFRpbWUpO1xuICAgICAgICBjb25zdCBuID0gR24odCwgZS5taXNzaW5nKSwgcyA9IEtuKGUucmVhZFRpbWUpO1xuICAgICAgICByZXR1cm4gcXQubmV3Tm9Eb2N1bWVudChuLCBzKTtcbiAgICB9KHQsIGUpIDogTSgpO1xufVxuXG5mdW5jdGlvbiBlcyh0LCBlKSB7XG4gICAgbGV0IG47XG4gICAgaWYgKFwidGFyZ2V0Q2hhbmdlXCIgaW4gZSkge1xuICAgICAgICBlLnRhcmdldENoYW5nZTtcbiAgICAgICAgLy8gcHJvdG8zIGRlZmF1bHQgdmFsdWUgaXMgdW5zZXQgaW4gSlNPTiAodW5kZWZpbmVkKSwgc28gdXNlICdOT19DSEFOR0UnXG4gICAgICAgIC8vIGlmIHVuc2V0XG4gICAgICAgIGNvbnN0IHMgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICByZXR1cm4gXCJOT19DSEFOR0VcIiA9PT0gdCA/IDAgLyogTm9DaGFuZ2UgKi8gOiBcIkFERFwiID09PSB0ID8gMSAvKiBBZGRlZCAqLyA6IFwiUkVNT1ZFXCIgPT09IHQgPyAyIC8qIFJlbW92ZWQgKi8gOiBcIkNVUlJFTlRcIiA9PT0gdCA/IDMgLyogQ3VycmVudCAqLyA6IFwiUkVTRVRcIiA9PT0gdCA/IDQgLyogUmVzZXQgKi8gOiBNKCk7XG4gICAgICAgIH0oZS50YXJnZXRDaGFuZ2UudGFyZ2V0Q2hhbmdlVHlwZSB8fCBcIk5PX0NIQU5HRVwiKSwgaSA9IGUudGFyZ2V0Q2hhbmdlLnRhcmdldElkcyB8fCBbXSwgciA9IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIHJldHVybiB0LkQgPyAoTCh2b2lkIDAgPT09IGUgfHwgXCJzdHJpbmdcIiA9PSB0eXBlb2YgZSksIHd0LmZyb21CYXNlNjRTdHJpbmcoZSB8fCBcIlwiKSkgOiAoTCh2b2lkIDAgPT09IGUgfHwgZSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpLCBcbiAgICAgICAgICAgIHd0LmZyb21VaW50OEFycmF5KGUgfHwgbmV3IFVpbnQ4QXJyYXkpKTtcbiAgICAgICAgfSh0LCBlLnRhcmdldENoYW5nZS5yZXN1bWVUb2tlbiksIG8gPSBlLnRhcmdldENoYW5nZS5jYXVzZSwgYSA9IG8gJiYgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgY29uc3QgZSA9IHZvaWQgMCA9PT0gdC5jb2RlID8gcS5VTktOT1dOIDogZm4odC5jb2RlKTtcbiAgICAgICAgICAgIHJldHVybiBuZXcgSyhlLCB0Lm1lc3NhZ2UgfHwgXCJcIik7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gKiBSZXR1cm5zIGEgdmFsdWUgZm9yIGEgbnVtYmVyIChvciBudWxsKSB0aGF0J3MgYXBwcm9wcmlhdGUgdG8gcHV0IGludG9cbiAqIGEgZ29vZ2xlLnByb3RvYnVmLkludDMyVmFsdWUgcHJvdG8uXG4gKiBETyBOT1QgVVNFIFRISVMgRk9SIEFOWVRISU5HIEVMU0UuXG4gKiBUaGlzIG1ldGhvZCBjaGVhdHMuIEl0J3MgdHlwZWQgYXMgcmV0dXJuaW5nIFwibnVtYmVyXCIgYmVjYXVzZSB0aGF0J3Mgd2hhdFxuICogb3VyIGdlbmVyYXRlZCBwcm90byBpbnRlcmZhY2VzIHNheSBJbnQzMlZhbHVlIG11c3QgYmUuIEJ1dCBHUlBDIGFjdHVhbGx5XG4gKiBleHBlY3RzIGEgeyB2YWx1ZTogPG51bWJlcj4gfSBzdHJ1Y3QuXG4gKi8gKG8pO1xuICAgICAgICBuID0gbmV3IE5uKHMsIGksIHIsIGEgfHwgbnVsbCk7XG4gICAgfSBlbHNlIGlmIChcImRvY3VtZW50Q2hhbmdlXCIgaW4gZSkge1xuICAgICAgICBlLmRvY3VtZW50Q2hhbmdlO1xuICAgICAgICBjb25zdCBzID0gZS5kb2N1bWVudENoYW5nZTtcbiAgICAgICAgcy5kb2N1bWVudCwgcy5kb2N1bWVudC5uYW1lLCBzLmRvY3VtZW50LnVwZGF0ZVRpbWU7XG4gICAgICAgIGNvbnN0IGkgPSBHbih0LCBzLmRvY3VtZW50Lm5hbWUpLCByID0gS24ocy5kb2N1bWVudC51cGRhdGVUaW1lKSwgbyA9IG5ldyBCdCh7XG4gICAgICAgICAgICBtYXBWYWx1ZToge1xuICAgICAgICAgICAgICAgIGZpZWxkczogcy5kb2N1bWVudC5maWVsZHNcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSksIGEgPSBxdC5uZXdGb3VuZERvY3VtZW50KGksIHIsIG8pLCBjID0gcy50YXJnZXRJZHMgfHwgW10sIHUgPSBzLnJlbW92ZWRUYXJnZXRJZHMgfHwgW107XG4gICAgICAgIG4gPSBuZXcgRG4oYywgdSwgYS5rZXksIGEpO1xuICAgIH0gZWxzZSBpZiAoXCJkb2N1bWVudERlbGV0ZVwiIGluIGUpIHtcbiAgICAgICAgZS5kb2N1bWVudERlbGV0ZTtcbiAgICAgICAgY29uc3QgcyA9IGUuZG9jdW1lbnREZWxldGU7XG4gICAgICAgIHMuZG9jdW1lbnQ7XG4gICAgICAgIGNvbnN0IGkgPSBHbih0LCBzLmRvY3VtZW50KSwgciA9IHMucmVhZFRpbWUgPyBLbihzLnJlYWRUaW1lKSA6IGl0Lm1pbigpLCBvID0gcXQubmV3Tm9Eb2N1bWVudChpLCByKSwgYSA9IHMucmVtb3ZlZFRhcmdldElkcyB8fCBbXTtcbiAgICAgICAgbiA9IG5ldyBEbihbXSwgYSwgby5rZXksIG8pO1xuICAgIH0gZWxzZSBpZiAoXCJkb2N1bWVudFJlbW92ZVwiIGluIGUpIHtcbiAgICAgICAgZS5kb2N1bWVudFJlbW92ZTtcbiAgICAgICAgY29uc3QgcyA9IGUuZG9jdW1lbnRSZW1vdmU7XG4gICAgICAgIHMuZG9jdW1lbnQ7XG4gICAgICAgIGNvbnN0IGkgPSBHbih0LCBzLmRvY3VtZW50KSwgciA9IHMucmVtb3ZlZFRhcmdldElkcyB8fCBbXTtcbiAgICAgICAgbiA9IG5ldyBEbihbXSwgciwgaSwgbnVsbCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKCEoXCJmaWx0ZXJcIiBpbiBlKSkgcmV0dXJuIE0oKTtcbiAgICAgICAge1xuICAgICAgICAgICAgZS5maWx0ZXI7XG4gICAgICAgICAgICBjb25zdCB0ID0gZS5maWx0ZXI7XG4gICAgICAgICAgICB0LnRhcmdldElkO1xuICAgICAgICAgICAgY29uc3QgcyA9IHQuY291bnQgfHwgMCwgaSA9IG5ldyBjbihzKSwgciA9IHQudGFyZ2V0SWQ7XG4gICAgICAgICAgICBuID0gbmV3IENuKHIsIGkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBuO1xufVxuXG5mdW5jdGlvbiBucyh0LCBlKSB7XG4gICAgbGV0IG47XG4gICAgaWYgKGUgaW5zdGFuY2VvZiB0bikgbiA9IHtcbiAgICAgICAgdXBkYXRlOiBYbih0LCBlLmtleSwgZS52YWx1ZSlcbiAgICB9OyBlbHNlIGlmIChlIGluc3RhbmNlb2Ygb24pIG4gPSB7XG4gICAgICAgIGRlbGV0ZTogV24odCwgZS5rZXkpXG4gICAgfTsgZWxzZSBpZiAoZSBpbnN0YW5jZW9mIGVuKSBuID0ge1xuICAgICAgICB1cGRhdGU6IFhuKHQsIGUua2V5LCBlLmRhdGEpLFxuICAgICAgICB1cGRhdGVNYXNrOiB5cyhlLmZpZWxkTWFzaylcbiAgICB9OyBlbHNlIHtcbiAgICAgICAgaWYgKCEoZSBpbnN0YW5jZW9mIGFuKSkgcmV0dXJuIE0oKTtcbiAgICAgICAgbiA9IHtcbiAgICAgICAgICAgIHZlcmlmeTogV24odCwgZS5rZXkpXG4gICAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiBlLmZpZWxkVHJhbnNmb3Jtcy5sZW5ndGggPiAwICYmIChuLnVwZGF0ZVRyYW5zZm9ybXMgPSBlLmZpZWxkVHJhbnNmb3Jtcy5tYXAoKHQgPT4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBjb25zdCBuID0gZS50cmFuc2Zvcm07XG4gICAgICAgIGlmIChuIGluc3RhbmNlb2YgJGUpIHJldHVybiB7XG4gICAgICAgICAgICBmaWVsZFBhdGg6IGUuZmllbGQuY2Fub25pY2FsU3RyaW5nKCksXG4gICAgICAgICAgICBzZXRUb1NlcnZlclZhbHVlOiBcIlJFUVVFU1RfVElNRVwiXG4gICAgICAgIH07XG4gICAgICAgIGlmIChuIGluc3RhbmNlb2YgT2UpIHJldHVybiB7XG4gICAgICAgICAgICBmaWVsZFBhdGg6IGUuZmllbGQuY2Fub25pY2FsU3RyaW5nKCksXG4gICAgICAgICAgICBhcHBlbmRNaXNzaW5nRWxlbWVudHM6IHtcbiAgICAgICAgICAgICAgICB2YWx1ZXM6IG4uZWxlbWVudHNcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgaWYgKG4gaW5zdGFuY2VvZiBNZSkgcmV0dXJuIHtcbiAgICAgICAgICAgIGZpZWxkUGF0aDogZS5maWVsZC5jYW5vbmljYWxTdHJpbmcoKSxcbiAgICAgICAgICAgIHJlbW92ZUFsbEZyb21BcnJheToge1xuICAgICAgICAgICAgICAgIHZhbHVlczogbi5lbGVtZW50c1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBpZiAobiBpbnN0YW5jZW9mIEJlKSByZXR1cm4ge1xuICAgICAgICAgICAgZmllbGRQYXRoOiBlLmZpZWxkLmNhbm9uaWNhbFN0cmluZygpLFxuICAgICAgICAgICAgaW5jcmVtZW50OiBuLkNcbiAgICAgICAgfTtcbiAgICAgICAgdGhyb3cgTSgpO1xuICAgIH0oMCwgdCkpKSksIGUucHJlY29uZGl0aW9uLmlzTm9uZSB8fCAobi5jdXJyZW50RG9jdW1lbnQgPSBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIHJldHVybiB2b2lkIDAgIT09IGUudXBkYXRlVGltZSA/IHtcbiAgICAgICAgICAgIHVwZGF0ZVRpbWU6IHFuKHQsIGUudXBkYXRlVGltZSlcbiAgICAgICAgfSA6IHZvaWQgMCAhPT0gZS5leGlzdHMgPyB7XG4gICAgICAgICAgICBleGlzdHM6IGUuZXhpc3RzXG4gICAgICAgIH0gOiBNKCk7XG4gICAgfSh0LCBlLnByZWNvbmRpdGlvbikpLCBuO1xufVxuXG5mdW5jdGlvbiBzcyh0LCBlKSB7XG4gICAgY29uc3QgbiA9IGUuY3VycmVudERvY3VtZW50ID8gZnVuY3Rpb24odCkge1xuICAgICAgICByZXR1cm4gdm9pZCAwICE9PSB0LnVwZGF0ZVRpbWUgPyBXZS51cGRhdGVUaW1lKEtuKHQudXBkYXRlVGltZSkpIDogdm9pZCAwICE9PSB0LmV4aXN0cyA/IFdlLmV4aXN0cyh0LmV4aXN0cykgOiBXZS5ub25lKCk7XG4gICAgfShlLmN1cnJlbnREb2N1bWVudCkgOiBXZS5ub25lKCksIHMgPSBlLnVwZGF0ZVRyYW5zZm9ybXMgPyBlLnVwZGF0ZVRyYW5zZm9ybXMubWFwKChlID0+IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgbGV0IG4gPSBudWxsO1xuICAgICAgICBpZiAoXCJzZXRUb1NlcnZlclZhbHVlXCIgaW4gZSkgTChcIlJFUVVFU1RfVElNRVwiID09PSBlLnNldFRvU2VydmVyVmFsdWUpLCBuID0gbmV3ICRlOyBlbHNlIGlmIChcImFwcGVuZE1pc3NpbmdFbGVtZW50c1wiIGluIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBlLmFwcGVuZE1pc3NpbmdFbGVtZW50cy52YWx1ZXMgfHwgW107XG4gICAgICAgICAgICBuID0gbmV3IE9lKHQpO1xuICAgICAgICB9IGVsc2UgaWYgKFwicmVtb3ZlQWxsRnJvbUFycmF5XCIgaW4gZSkge1xuICAgICAgICAgICAgY29uc3QgdCA9IGUucmVtb3ZlQWxsRnJvbUFycmF5LnZhbHVlcyB8fCBbXTtcbiAgICAgICAgICAgIG4gPSBuZXcgTWUodCk7XG4gICAgICAgIH0gZWxzZSBcImluY3JlbWVudFwiIGluIGUgPyBuID0gbmV3IEJlKHQsIGUuaW5jcmVtZW50KSA6IE0oKTtcbiAgICAgICAgY29uc3QgcyA9IGx0LmZyb21TZXJ2ZXJGb3JtYXQoZS5maWVsZFBhdGgpO1xuICAgICAgICByZXR1cm4gbmV3IEtlKHMsIG4pO1xuICAgIH0odCwgZSkpKSA6IFtdO1xuICAgIGlmIChlLnVwZGF0ZSkge1xuICAgICAgICBlLnVwZGF0ZS5uYW1lO1xuICAgICAgICBjb25zdCBpID0gR24odCwgZS51cGRhdGUubmFtZSksIHIgPSBuZXcgQnQoe1xuICAgICAgICAgICAgbWFwVmFsdWU6IHtcbiAgICAgICAgICAgICAgICBmaWVsZHM6IGUudXBkYXRlLmZpZWxkc1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKGUudXBkYXRlTWFzaykge1xuICAgICAgICAgICAgY29uc3QgdCA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5maWVsZFBhdGhzIHx8IFtdO1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgZnQoZS5tYXAoKHQgPT4gbHQuZnJvbVNlcnZlckZvcm1hdCh0KSkpKTtcbiAgICAgICAgICAgIH0oZS51cGRhdGVNYXNrKTtcbiAgICAgICAgICAgIHJldHVybiBuZXcgZW4oaSwgciwgdCwgbiwgcyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyB0bihpLCByLCBuLCBzKTtcbiAgICB9XG4gICAgaWYgKGUuZGVsZXRlKSB7XG4gICAgICAgIGNvbnN0IHMgPSBHbih0LCBlLmRlbGV0ZSk7XG4gICAgICAgIHJldHVybiBuZXcgb24ocywgbik7XG4gICAgfVxuICAgIGlmIChlLnZlcmlmeSkge1xuICAgICAgICBjb25zdCBzID0gR24odCwgZS52ZXJpZnkpO1xuICAgICAgICByZXR1cm4gbmV3IGFuKHMsIG4pO1xuICAgIH1cbiAgICByZXR1cm4gTSgpO1xufVxuXG5mdW5jdGlvbiBpcyh0LCBlKSB7XG4gICAgcmV0dXJuIHQgJiYgdC5sZW5ndGggPiAwID8gKEwodm9pZCAwICE9PSBlKSwgdC5tYXAoKHQgPT4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAvLyBOT1RFOiBEZWxldGVzIGRvbid0IGhhdmUgYW4gdXBkYXRlVGltZS5cbiAgICAgICAgbGV0IG4gPSB0LnVwZGF0ZVRpbWUgPyBLbih0LnVwZGF0ZVRpbWUpIDogS24oZSk7XG4gICAgICAgIHJldHVybiBuLmlzRXF1YWwoaXQubWluKCkpICYmIChcbiAgICAgICAgLy8gVGhlIEZpcmVzdG9yZSBFbXVsYXRvciBjdXJyZW50bHkgcmV0dXJucyBhbiB1cGRhdGUgdGltZSBvZiAwIGZvclxuICAgICAgICAvLyBkZWxldGVzIG9mIG5vbi1leGlzdGluZyBkb2N1bWVudHMgKHJhdGhlciB0aGFuIG51bGwpLiBUaGlzIGJyZWFrcyB0aGVcbiAgICAgICAgLy8gdGVzdCBcImdldCBkZWxldGVkIGRvYyB3aGlsZSBvZmZsaW5lIHdpdGggc291cmNlPWNhY2hlXCIgYXMgTm9Eb2N1bWVudHNcbiAgICAgICAgLy8gd2l0aCB2ZXJzaW9uIDAgYXJlIGZpbHRlcmVkIGJ5IEluZGV4ZWREYidzIFJlbW90ZURvY3VtZW50Q2FjaGUuXG4gICAgICAgIC8vIFRPRE8oIzIxNDkpOiBSZW1vdmUgdGhpcyB3aGVuIEVtdWxhdG9yIGlzIGZpeGVkXG4gICAgICAgIG4gPSBLbihlKSksIG5ldyBRZShuLCB0LnRyYW5zZm9ybVJlc3VsdHMgfHwgW10pO1xuICAgIH0odCwgZSkpKSkgOiBbXTtcbn1cblxuZnVuY3Rpb24gcnModCwgZSkge1xuICAgIHJldHVybiB7XG4gICAgICAgIGRvY3VtZW50czogWyB6bih0LCBlLnBhdGgpIF1cbiAgICB9O1xufVxuXG5mdW5jdGlvbiBvcyh0LCBlKSB7XG4gICAgLy8gRGlzc2VjdCB0aGUgcGF0aCBpbnRvIHBhcmVudCwgY29sbGVjdGlvbklkLCBhbmQgb3B0aW9uYWwga2V5IGZpbHRlci5cbiAgICBjb25zdCBuID0ge1xuICAgICAgICBzdHJ1Y3R1cmVkUXVlcnk6IHt9XG4gICAgfSwgcyA9IGUucGF0aDtcbiAgICBudWxsICE9PSBlLmNvbGxlY3Rpb25Hcm91cCA/IChuLnBhcmVudCA9IHpuKHQsIHMpLCBuLnN0cnVjdHVyZWRRdWVyeS5mcm9tID0gWyB7XG4gICAgICAgIGNvbGxlY3Rpb25JZDogZS5jb2xsZWN0aW9uR3JvdXAsXG4gICAgICAgIGFsbERlc2NlbmRhbnRzOiAhMFxuICAgIH0gXSkgOiAobi5wYXJlbnQgPSB6bih0LCBzLnBvcExhc3QoKSksIG4uc3RydWN0dXJlZFF1ZXJ5LmZyb20gPSBbIHtcbiAgICAgICAgY29sbGVjdGlvbklkOiBzLmxhc3RTZWdtZW50KClcbiAgICB9IF0pO1xuICAgIGNvbnN0IGkgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgIGlmICgwID09PSB0Lmxlbmd0aCkgcmV0dXJuO1xuICAgICAgICBjb25zdCBlID0gdC5tYXAoKHQgPT4gXG4gICAgICAgIC8vIHZpc2libGUgZm9yIHRlc3RpbmdcbiAgICAgICAgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgaWYgKFwiPT1cIiAvKiBFUVVBTCAqLyA9PT0gdC5vcCkge1xuICAgICAgICAgICAgICAgIGlmIChGdCh0LnZhbHVlKSkgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgdW5hcnlGaWx0ZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkOiB3cyh0LmZpZWxkKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wOiBcIklTX05BTlwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGlmIChPdCh0LnZhbHVlKSkgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgdW5hcnlGaWx0ZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkOiB3cyh0LmZpZWxkKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wOiBcIklTX05VTExcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoXCIhPVwiIC8qIE5PVF9FUVVBTCAqLyA9PT0gdC5vcCkge1xuICAgICAgICAgICAgICAgIGlmIChGdCh0LnZhbHVlKSkgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgdW5hcnlGaWx0ZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkOiB3cyh0LmZpZWxkKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wOiBcIklTX05PVF9OQU5cIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBpZiAoT3QodC52YWx1ZSkpIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHVuYXJ5RmlsdGVyOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaWVsZDogd3ModC5maWVsZCksXG4gICAgICAgICAgICAgICAgICAgICAgICBvcDogXCJJU19OT1RfTlVMTFwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBmaWVsZEZpbHRlcjoge1xuICAgICAgICAgICAgICAgICAgICBmaWVsZDogd3ModC5maWVsZCksXG4gICAgICAgICAgICAgICAgICAgIG9wOiBkcyh0Lm9wKSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHQudmFsdWVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KHQpKSk7XG4gICAgICAgIGlmICgxID09PSBlLmxlbmd0aCkgcmV0dXJuIGVbMF07XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBjb21wb3NpdGVGaWx0ZXI6IHtcbiAgICAgICAgICAgICAgICBvcDogXCJBTkRcIixcbiAgICAgICAgICAgICAgICBmaWx0ZXJzOiBlXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfShlLmZpbHRlcnMpO1xuICAgIGkgJiYgKG4uc3RydWN0dXJlZFF1ZXJ5LndoZXJlID0gaSk7XG4gICAgY29uc3QgciA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgaWYgKDAgPT09IHQubGVuZ3RoKSByZXR1cm47XG4gICAgICAgIHJldHVybiB0Lm1hcCgodCA9PiBcbiAgICAgICAgLy8gdmlzaWJsZSBmb3IgdGVzdGluZ1xuICAgICAgICBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGZpZWxkOiB3cyh0LmZpZWxkKSxcbiAgICAgICAgICAgICAgICBkaXJlY3Rpb246IGZzKHQuZGlyKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSh0KSkpO1xuICAgIH0oZS5vcmRlckJ5KTtcbiAgICByICYmIChuLnN0cnVjdHVyZWRRdWVyeS5vcmRlckJ5ID0gcik7XG4gICAgY29uc3QgbyA9IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHQuRCB8fCBJdChlKSA/IGUgOiB7XG4gICAgICAgICAgICB2YWx1ZTogZVxuICAgICAgICB9O1xuICAgIH1cbiAgICAvKipcbiAqIFJldHVybnMgYSBudW1iZXIgKG9yIG51bGwpIGZyb20gYSBnb29nbGUucHJvdG9idWYuSW50MzJWYWx1ZSBwcm90by5cbiAqLyAodCwgZS5saW1pdCk7XG4gICAgcmV0dXJuIG51bGwgIT09IG8gJiYgKG4uc3RydWN0dXJlZFF1ZXJ5LmxpbWl0ID0gbyksIGUuc3RhcnRBdCAmJiAobi5zdHJ1Y3R1cmVkUXVlcnkuc3RhcnRBdCA9IGhzKGUuc3RhcnRBdCkpLCBcbiAgICBlLmVuZEF0ICYmIChuLnN0cnVjdHVyZWRRdWVyeS5lbmRBdCA9IGhzKGUuZW5kQXQpKSwgbjtcbn1cblxuZnVuY3Rpb24gYXModCkge1xuICAgIGxldCBlID0gSG4odC5wYXJlbnQpO1xuICAgIGNvbnN0IG4gPSB0LnN0cnVjdHVyZWRRdWVyeSwgcyA9IG4uZnJvbSA/IG4uZnJvbS5sZW5ndGggOiAwO1xuICAgIGxldCBpID0gbnVsbDtcbiAgICBpZiAocyA+IDApIHtcbiAgICAgICAgTCgxID09PSBzKTtcbiAgICAgICAgY29uc3QgdCA9IG4uZnJvbVswXTtcbiAgICAgICAgdC5hbGxEZXNjZW5kYW50cyA/IGkgPSB0LmNvbGxlY3Rpb25JZCA6IGUgPSBlLmNoaWxkKHQuY29sbGVjdGlvbklkKTtcbiAgICB9XG4gICAgbGV0IHIgPSBbXTtcbiAgICBuLndoZXJlICYmIChyID0gdXMobi53aGVyZSkpO1xuICAgIGxldCBvID0gW107XG4gICAgbi5vcmRlckJ5ICYmIChvID0gbi5vcmRlckJ5Lm1hcCgodCA9PiBmdW5jdGlvbih0KSB7XG4gICAgICAgIHJldHVybiBuZXcgYWUoX3ModC5maWVsZCksIFxuICAgICAgICAvLyB2aXNpYmxlIGZvciB0ZXN0aW5nXG4gICAgICAgIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIHN3aXRjaCAodCkge1xuICAgICAgICAgICAgICBjYXNlIFwiQVNDRU5ESU5HXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiYXNjXCIgLyogQVNDRU5ESU5HICovO1xuXG4gICAgICAgICAgICAgIGNhc2UgXCJERVNDRU5ESU5HXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiZGVzY1wiIC8qIERFU0NFTkRJTkcgKi87XG5cbiAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gdmlzaWJsZSBmb3IgdGVzdGluZ1xuICAgICAgICAodC5kaXJlY3Rpb24pKTtcbiAgICB9KHQpKSkpO1xuICAgIGxldCBhID0gbnVsbDtcbiAgICBuLmxpbWl0ICYmIChhID0gZnVuY3Rpb24odCkge1xuICAgICAgICBsZXQgZTtcbiAgICAgICAgcmV0dXJuIGUgPSBcIm9iamVjdFwiID09IHR5cGVvZiB0ID8gdC52YWx1ZSA6IHQsIEl0KGUpID8gbnVsbCA6IGU7XG4gICAgfShuLmxpbWl0KSk7XG4gICAgbGV0IGMgPSBudWxsO1xuICAgIG4uc3RhcnRBdCAmJiAoYyA9IGxzKG4uc3RhcnRBdCkpO1xuICAgIGxldCB1ID0gbnVsbDtcbiAgICByZXR1cm4gbi5lbmRBdCAmJiAodSA9IGxzKG4uZW5kQXQpKSwgZmUoZSwgaSwgbywgciwgYSwgXCJGXCIgLyogRmlyc3QgKi8gLCBjLCB1KTtcbn1cblxuZnVuY3Rpb24gY3ModCwgZSkge1xuICAgIGNvbnN0IG4gPSBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIHN3aXRjaCAoZSkge1xuICAgICAgICAgIGNhc2UgMCAvKiBMaXN0ZW4gKi8gOlxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgICBjYXNlIDEgLyogRXhpc3RlbmNlRmlsdGVyTWlzbWF0Y2ggKi8gOlxuICAgICAgICAgICAgcmV0dXJuIFwiZXhpc3RlbmNlLWZpbHRlci1taXNtYXRjaFwiO1xuXG4gICAgICAgICAgY2FzZSAyIC8qIExpbWJvUmVzb2x1dGlvbiAqLyA6XG4gICAgICAgICAgICByZXR1cm4gXCJsaW1iby1kb2N1bWVudFwiO1xuXG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBNKCk7XG4gICAgICAgIH1cbiAgICB9KDAsIGUucHVycG9zZSk7XG4gICAgcmV0dXJuIG51bGwgPT0gbiA/IG51bGwgOiB7XG4gICAgICAgIFwiZ29vZy1saXN0ZW4tdGFnc1wiOiBuXG4gICAgfTtcbn1cblxuZnVuY3Rpb24gdXModCkge1xuICAgIHJldHVybiB0ID8gdm9pZCAwICE9PSB0LnVuYXJ5RmlsdGVyID8gWyBncyh0KSBdIDogdm9pZCAwICE9PSB0LmZpZWxkRmlsdGVyID8gWyBtcyh0KSBdIDogdm9pZCAwICE9PSB0LmNvbXBvc2l0ZUZpbHRlciA/IHQuY29tcG9zaXRlRmlsdGVyLmZpbHRlcnMubWFwKCh0ID0+IHVzKHQpKSkucmVkdWNlKCgodCwgZSkgPT4gdC5jb25jYXQoZSkpKSA6IE0oKSA6IFtdO1xufVxuXG5mdW5jdGlvbiBocyh0KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgYmVmb3JlOiB0LmJlZm9yZSxcbiAgICAgICAgdmFsdWVzOiB0LnBvc2l0aW9uXG4gICAgfTtcbn1cblxuZnVuY3Rpb24gbHModCkge1xuICAgIGNvbnN0IGUgPSAhIXQuYmVmb3JlLCBuID0gdC52YWx1ZXMgfHwgW107XG4gICAgcmV0dXJuIG5ldyByZShuLCBlKTtcbn1cblxuLy8gdmlzaWJsZSBmb3IgdGVzdGluZ1xuZnVuY3Rpb24gZnModCkge1xuICAgIHJldHVybiBGblt0XTtcbn1cblxuZnVuY3Rpb24gZHModCkge1xuICAgIHJldHVybiBNblt0XTtcbn1cblxuZnVuY3Rpb24gd3ModCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIGZpZWxkUGF0aDogdC5jYW5vbmljYWxTdHJpbmcoKVxuICAgIH07XG59XG5cbmZ1bmN0aW9uIF9zKHQpIHtcbiAgICByZXR1cm4gbHQuZnJvbVNlcnZlckZvcm1hdCh0LmZpZWxkUGF0aCk7XG59XG5cbmZ1bmN0aW9uIG1zKHQpIHtcbiAgICByZXR1cm4gSHQuY3JlYXRlKF9zKHQuZmllbGRGaWx0ZXIuZmllbGQpLCBmdW5jdGlvbih0KSB7XG4gICAgICAgIHN3aXRjaCAodCkge1xuICAgICAgICAgIGNhc2UgXCJFUVVBTFwiOlxuICAgICAgICAgICAgcmV0dXJuIFwiPT1cIiAvKiBFUVVBTCAqLztcblxuICAgICAgICAgIGNhc2UgXCJOT1RfRVFVQUxcIjpcbiAgICAgICAgICAgIHJldHVybiBcIiE9XCIgLyogTk9UX0VRVUFMICovO1xuXG4gICAgICAgICAgY2FzZSBcIkdSRUFURVJfVEhBTlwiOlxuICAgICAgICAgICAgcmV0dXJuIFwiPlwiIC8qIEdSRUFURVJfVEhBTiAqLztcblxuICAgICAgICAgIGNhc2UgXCJHUkVBVEVSX1RIQU5fT1JfRVFVQUxcIjpcbiAgICAgICAgICAgIHJldHVybiBcIj49XCIgLyogR1JFQVRFUl9USEFOX09SX0VRVUFMICovO1xuXG4gICAgICAgICAgY2FzZSBcIkxFU1NfVEhBTlwiOlxuICAgICAgICAgICAgcmV0dXJuIFwiPFwiIC8qIExFU1NfVEhBTiAqLztcblxuICAgICAgICAgIGNhc2UgXCJMRVNTX1RIQU5fT1JfRVFVQUxcIjpcbiAgICAgICAgICAgIHJldHVybiBcIjw9XCIgLyogTEVTU19USEFOX09SX0VRVUFMICovO1xuXG4gICAgICAgICAgY2FzZSBcIkFSUkFZX0NPTlRBSU5TXCI6XG4gICAgICAgICAgICByZXR1cm4gXCJhcnJheS1jb250YWluc1wiIC8qIEFSUkFZX0NPTlRBSU5TICovO1xuXG4gICAgICAgICAgY2FzZSBcIklOXCI6XG4gICAgICAgICAgICByZXR1cm4gXCJpblwiIC8qIElOICovO1xuXG4gICAgICAgICAgY2FzZSBcIk5PVF9JTlwiOlxuICAgICAgICAgICAgcmV0dXJuIFwibm90LWluXCIgLyogTk9UX0lOICovO1xuXG4gICAgICAgICAgY2FzZSBcIkFSUkFZX0NPTlRBSU5TX0FOWVwiOlxuICAgICAgICAgICAgcmV0dXJuIFwiYXJyYXktY29udGFpbnMtYW55XCIgLyogQVJSQVlfQ09OVEFJTlNfQU5ZICovO1xuXG4gICAgICAgICAgY2FzZSBcIk9QRVJBVE9SX1VOU1BFQ0lGSUVEXCI6XG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBNKCk7XG4gICAgICAgIH1cbiAgICB9KHQuZmllbGRGaWx0ZXIub3ApLCB0LmZpZWxkRmlsdGVyLnZhbHVlKTtcbn1cblxuZnVuY3Rpb24gZ3ModCkge1xuICAgIHN3aXRjaCAodC51bmFyeUZpbHRlci5vcCkge1xuICAgICAgY2FzZSBcIklTX05BTlwiOlxuICAgICAgICBjb25zdCBlID0gX3ModC51bmFyeUZpbHRlci5maWVsZCk7XG4gICAgICAgIHJldHVybiBIdC5jcmVhdGUoZSwgXCI9PVwiIC8qIEVRVUFMICovICwge1xuICAgICAgICAgICAgZG91YmxlVmFsdWU6IE5hTlxuICAgICAgICB9KTtcblxuICAgICAgY2FzZSBcIklTX05VTExcIjpcbiAgICAgICAgY29uc3QgbiA9IF9zKHQudW5hcnlGaWx0ZXIuZmllbGQpO1xuICAgICAgICByZXR1cm4gSHQuY3JlYXRlKG4sIFwiPT1cIiAvKiBFUVVBTCAqLyAsIHtcbiAgICAgICAgICAgIG51bGxWYWx1ZTogXCJOVUxMX1ZBTFVFXCJcbiAgICAgICAgfSk7XG5cbiAgICAgIGNhc2UgXCJJU19OT1RfTkFOXCI6XG4gICAgICAgIGNvbnN0IHMgPSBfcyh0LnVuYXJ5RmlsdGVyLmZpZWxkKTtcbiAgICAgICAgcmV0dXJuIEh0LmNyZWF0ZShzLCBcIiE9XCIgLyogTk9UX0VRVUFMICovICwge1xuICAgICAgICAgICAgZG91YmxlVmFsdWU6IE5hTlxuICAgICAgICB9KTtcblxuICAgICAgY2FzZSBcIklTX05PVF9OVUxMXCI6XG4gICAgICAgIGNvbnN0IGkgPSBfcyh0LnVuYXJ5RmlsdGVyLmZpZWxkKTtcbiAgICAgICAgcmV0dXJuIEh0LmNyZWF0ZShpLCBcIiE9XCIgLyogTk9UX0VRVUFMICovICwge1xuICAgICAgICAgICAgbnVsbFZhbHVlOiBcIk5VTExfVkFMVUVcIlxuICAgICAgICB9KTtcblxuICAgICAgY2FzZSBcIk9QRVJBVE9SX1VOU1BFQ0lGSUVEXCI6XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gTSgpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24geXModCkge1xuICAgIGNvbnN0IGUgPSBbXTtcbiAgICByZXR1cm4gdC5maWVsZHMuZm9yRWFjaCgodCA9PiBlLnB1c2godC5jYW5vbmljYWxTdHJpbmcoKSkpKSwge1xuICAgICAgICBmaWVsZFBhdGhzOiBlXG4gICAgfTtcbn1cblxuZnVuY3Rpb24gcHModCkge1xuICAgIC8vIFJlc291cmNlIG5hbWVzIGhhdmUgYXQgbGVhc3QgNCBjb21wb25lbnRzIChwcm9qZWN0IElELCBkYXRhYmFzZSBJRClcbiAgICByZXR1cm4gdC5sZW5ndGggPj0gNCAmJiBcInByb2plY3RzXCIgPT09IHQuZ2V0KDApICYmIFwiZGF0YWJhc2VzXCIgPT09IHQuZ2V0KDIpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBFbmNvZGVzIGEgcmVzb3VyY2UgcGF0aCBpbnRvIGEgSW5kZXhlZERiLWNvbXBhdGlibGUgc3RyaW5nIGZvcm0uXG4gKi9cbmZ1bmN0aW9uIEVzKHQpIHtcbiAgICBsZXQgZSA9IFwiXCI7XG4gICAgZm9yIChsZXQgbiA9IDA7IG4gPCB0Lmxlbmd0aDsgbisrKSBlLmxlbmd0aCA+IDAgJiYgKGUgPSBJcyhlKSksIGUgPSBUcyh0LmdldChuKSwgZSk7XG4gICAgcmV0dXJuIElzKGUpO1xufVxuXG4vKiogRW5jb2RlcyBhIHNpbmdsZSBzZWdtZW50IG9mIGEgcmVzb3VyY2UgcGF0aCBpbnRvIHRoZSBnaXZlbiByZXN1bHQgKi8gZnVuY3Rpb24gVHModCwgZSkge1xuICAgIGxldCBuID0gZTtcbiAgICBjb25zdCBzID0gdC5sZW5ndGg7XG4gICAgZm9yIChsZXQgZSA9IDA7IGUgPCBzOyBlKyspIHtcbiAgICAgICAgY29uc3QgcyA9IHQuY2hhckF0KGUpO1xuICAgICAgICBzd2l0Y2ggKHMpIHtcbiAgICAgICAgICBjYXNlIFwiXFwwXCI6XG4gICAgICAgICAgICBuICs9IFwiXHUwMDAxXHUwMDEwXCI7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgXCJcdTAwMDFcIjpcbiAgICAgICAgICAgIG4gKz0gXCJcdTAwMDFcdTAwMTFcIjtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIG4gKz0gcztcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbjtcbn1cblxuLyoqIEVuY29kZXMgYSBwYXRoIHNlcGFyYXRvciBpbnRvIHRoZSBnaXZlbiByZXN1bHQgKi8gZnVuY3Rpb24gSXModCkge1xuICAgIHJldHVybiB0ICsgXCJcdTAwMDFcdTAwMDFcIjtcbn1cblxuLyoqXG4gKiBEZWNvZGVzIHRoZSBnaXZlbiBJbmRleGVkRGItY29tcGF0aWJsZSBzdHJpbmcgZm9ybSBvZiBhIHJlc291cmNlIHBhdGggaW50b1xuICogYSBSZXNvdXJjZVBhdGggaW5zdGFuY2UuIE5vdGUgdGhhdCB0aGlzIG1ldGhvZCBpcyBub3Qgc3VpdGFibGUgZm9yIHVzZSB3aXRoXG4gKiBkZWNvZGluZyByZXNvdXJjZSBuYW1lcyBmcm9tIHRoZSBzZXJ2ZXI7IHRob3NlIGFyZSBPbmUgUGxhdGZvcm0gZm9ybWF0XG4gKiBzdHJpbmdzLlxuICovIGZ1bmN0aW9uIEFzKHQpIHtcbiAgICAvLyBFdmVudCB0aGUgZW1wdHkgcGF0aCBtdXN0IGVuY29kZSBhcyBhIHBhdGggb2YgYXQgbGVhc3QgbGVuZ3RoIDIuIEEgcGF0aFxuICAgIC8vIHdpdGggZXhhY3RseSAyIG11c3QgYmUgdGhlIGVtcHR5IHBhdGguXG4gICAgY29uc3QgZSA9IHQubGVuZ3RoO1xuICAgIGlmIChMKGUgPj0gMiksIDIgPT09IGUpIHJldHVybiBMKFwiXHUwMDAxXCIgPT09IHQuY2hhckF0KDApICYmIFwiXHUwMDAxXCIgPT09IHQuY2hhckF0KDEpKSwgdXQuZW1wdHlQYXRoKCk7XG4gICAgLy8gRXNjYXBlIGNoYXJhY3RlcnMgY2Fubm90IGV4aXN0IHBhc3QgdGhlIHNlY29uZC10by1sYXN0IHBvc2l0aW9uIGluIHRoZVxuICAgIC8vIHNvdXJjZSB2YWx1ZS5cbiAgICAgICAgY29uc3QgbiA9IGUgLSAyLCBzID0gW107XG4gICAgbGV0IGkgPSBcIlwiO1xuICAgIGZvciAobGV0IHIgPSAwOyByIDwgZTsgKSB7XG4gICAgICAgIC8vIFRoZSBsYXN0IHR3byBjaGFyYWN0ZXJzIG9mIGEgdmFsaWQgZW5jb2RlZCBwYXRoIG11c3QgYmUgYSBzZXBhcmF0b3IsIHNvXG4gICAgICAgIC8vIHRoZXJlIG11c3QgYmUgYW4gZW5kIHRvIHRoaXMgc2VnbWVudC5cbiAgICAgICAgY29uc3QgZSA9IHQuaW5kZXhPZihcIlx1MDAwMVwiLCByKTtcbiAgICAgICAgKGUgPCAwIHx8IGUgPiBuKSAmJiBNKCk7XG4gICAgICAgIHN3aXRjaCAodC5jaGFyQXQoZSArIDEpKSB7XG4gICAgICAgICAgY2FzZSBcIlx1MDAwMVwiOlxuICAgICAgICAgICAgY29uc3QgbiA9IHQuc3Vic3RyaW5nKHIsIGUpO1xuICAgICAgICAgICAgbGV0IG87XG4gICAgICAgICAgICAwID09PSBpLmxlbmd0aCA/IFxuICAgICAgICAgICAgLy8gQXZvaWQgY29weWluZyBmb3IgdGhlIGNvbW1vbiBjYXNlIG9mIGEgc2VnbWVudCB0aGF0IGV4Y2x1ZGVzIFxcMFxuICAgICAgICAgICAgLy8gYW5kIFxcMDAxXG4gICAgICAgICAgICBvID0gbiA6IChpICs9IG4sIG8gPSBpLCBpID0gXCJcIiksIHMucHVzaChvKTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSBcIlx1MDAxMFwiOlxuICAgICAgICAgICAgaSArPSB0LnN1YnN0cmluZyhyLCBlKSwgaSArPSBcIlxcMFwiO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBjYXNlIFwiXHUwMDExXCI6XG4gICAgICAgICAgICAvLyBUaGUgZXNjYXBlIGNoYXJhY3RlciBjYW4gYmUgdXNlZCBpbiB0aGUgb3V0cHV0IHRvIGVuY29kZSBpdHNlbGYuXG4gICAgICAgICAgICBpICs9IHQuc3Vic3RyaW5nKHIsIGUgKyAxKTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIE0oKTtcbiAgICAgICAgfVxuICAgICAgICByID0gZSArIDI7XG4gICAgfVxuICAgIHJldHVybiBuZXcgdXQocyk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFNjaGVtYSBWZXJzaW9uIGZvciB0aGUgV2ViIGNsaWVudDpcbiAqIDEuICBJbml0aWFsIHZlcnNpb24gaW5jbHVkaW5nIE11dGF0aW9uIFF1ZXVlLCBRdWVyeSBDYWNoZSwgYW5kIFJlbW90ZVxuICogICAgIERvY3VtZW50IENhY2hlXG4gKiAyLiAgVXNlZCB0byBlbnN1cmUgYSB0YXJnZXRHbG9iYWwgb2JqZWN0IGV4aXN0cyBhbmQgYWRkIHRhcmdldENvdW50IHRvIGl0LiBOb1xuICogICAgIGxvbmdlciByZXF1aXJlZCBiZWNhdXNlIG1pZ3JhdGlvbiAzIHVuY29uZGl0aW9uYWxseSBjbGVhcnMgaXQuXG4gKiAzLiAgRHJvcHBlZCBhbmQgcmUtY3JlYXRlZCBRdWVyeSBDYWNoZSB0byBkZWFsIHdpdGggY2FjaGUgY29ycnVwdGlvbiByZWxhdGVkXG4gKiAgICAgdG8gbGltYm8gcmVzb2x1dGlvbi4gQWRkcmVzc2VzXG4gKiAgICAgaHR0cHM6Ly9naXRodWIuY29tL2ZpcmViYXNlL2ZpcmViYXNlLWlvcy1zZGsvaXNzdWVzLzE1NDhcbiAqIDQuICBNdWx0aS1UYWIgU3VwcG9ydC5cbiAqIDUuICBSZW1vdmFsIG9mIGhlbGQgd3JpdGUgYWNrcy5cbiAqIDYuICBDcmVhdGUgZG9jdW1lbnQgZ2xvYmFsIGZvciB0cmFja2luZyBkb2N1bWVudCBjYWNoZSBzaXplLlxuICogNy4gIEVuc3VyZSBldmVyeSBjYWNoZWQgZG9jdW1lbnQgaGFzIGEgc2VudGluZWwgcm93IHdpdGggYSBzZXF1ZW5jZSBudW1iZXIuXG4gKiA4LiAgQWRkIGNvbGxlY3Rpb24tcGFyZW50IGluZGV4IGZvciBDb2xsZWN0aW9uIEdyb3VwIHF1ZXJpZXMuXG4gKiA5LiAgQ2hhbmdlIFJlbW90ZURvY3VtZW50Q2hhbmdlcyBzdG9yZSB0byBiZSBrZXllZCBieSByZWFkVGltZSByYXRoZXIgdGhhblxuICogICAgIGFuIGF1dG8taW5jcmVtZW50aW5nIElELiBUaGlzIGlzIHJlcXVpcmVkIGZvciBJbmRleC1GcmVlIHF1ZXJpZXMuXG4gKiAxMC4gUmV3cml0ZSB0aGUgY2Fub25pY2FsIElEcyB0byB0aGUgZXhwbGljaXQgUHJvdG9idWYtYmFzZWQgZm9ybWF0LlxuICogMTEuIEFkZCBidW5kbGVzIGFuZCBuYW1lZF9xdWVyaWVzIGZvciBidW5kbGUgc3VwcG9ydC5cbiAqL1xuLyoqXG4gKiBXcmFwcGVyIGNsYXNzIHRvIHN0b3JlIHRpbWVzdGFtcHMgKHNlY29uZHMgYW5kIG5hbm9zKSBpbiBJbmRleGVkRGIgb2JqZWN0cy5cbiAqL1xuY2xhc3MgUnMge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5zZWNvbmRzID0gdCwgdGhpcy5uYW5vc2Vjb25kcyA9IGU7XG4gICAgfVxufVxuXG4vKipcbiAqIEEgc2luZ2xldG9uIG9iamVjdCB0byBiZSBzdG9yZWQgaW4gdGhlICdvd25lcicgc3RvcmUgaW4gSW5kZXhlZERiLlxuICpcbiAqIEEgZ2l2ZW4gZGF0YWJhc2UgY2FuIGhhdmUgYSBzaW5nbGUgcHJpbWFyeSB0YWIgYXNzaWduZWQgYXQgYSBnaXZlbiB0aW1lLiBUaGF0XG4gKiB0YWIgbXVzdCB2YWxpZGF0ZSB0aGF0IGl0IGlzIHN0aWxsIGhvbGRpbmcgdGhlIHByaW1hcnkgbGVhc2UgYmVmb3JlIGV2ZXJ5XG4gKiBvcGVyYXRpb24gdGhhdCByZXF1aXJlcyBsb2NrZWQgYWNjZXNzLiBUaGUgcHJpbWFyeSB0YWIgc2hvdWxkIHJlZ3VsYXJseVxuICogd3JpdGUgYW4gdXBkYXRlZCB0aW1lc3RhbXAgdG8gdGhpcyBsZWFzZSB0byBwcmV2ZW50IG90aGVyIHRhYnMgZnJvbVxuICogXCJzdGVhbGluZ1wiIHRoZSBwcmltYXJ5IGxlYXNlXG4gKi8gY2xhc3MgUHMge1xuICAgIGNvbnN0cnVjdG9yKHQsIFxuICAgIC8qKiBXaGV0aGVyIHRvIGFsbG93IHNoYXJlZCBhY2Nlc3MgZnJvbSBtdWx0aXBsZSB0YWJzLiAqL1xuICAgIGUsIG4pIHtcbiAgICAgICAgdGhpcy5vd25lcklkID0gdCwgdGhpcy5hbGxvd1RhYlN5bmNocm9uaXphdGlvbiA9IGUsIHRoaXMubGVhc2VUaW1lc3RhbXBNcyA9IG47XG4gICAgfVxufVxuXG4vKipcbiAqIE5hbWUgb2YgdGhlIEluZGV4ZWREYiBvYmplY3Qgc3RvcmUuXG4gKlxuICogTm90ZSB0aGF0IHRoZSBuYW1lICdvd25lcicgaXMgY2hvc2VuIHRvIGVuc3VyZSBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eSB3aXRoXG4gKiBvbGRlciBjbGllbnRzIHRoYXQgb25seSBzdXBwb3J0ZWQgc2luZ2xlIGxvY2tlZCBhY2Nlc3MgdG8gdGhlIHBlcnNpc3RlbmNlXG4gKiBsYXllci5cbiAqLyBQcy5zdG9yZSA9IFwib3duZXJcIiwgXG4vKipcbiAqIFRoZSBrZXkgc3RyaW5nIHVzZWQgZm9yIHRoZSBzaW5nbGUgb2JqZWN0IHRoYXQgZXhpc3RzIGluIHRoZVxuICogRGJQcmltYXJ5Q2xpZW50IHN0b3JlLlxuICovXG5Qcy5rZXkgPSBcIm93bmVyXCI7XG5cbi8qKlxuICogQW4gb2JqZWN0IHRvIGJlIHN0b3JlZCBpbiB0aGUgJ211dGF0aW9uUXVldWVzJyBzdG9yZSBpbiBJbmRleGVkRGIuXG4gKlxuICogRWFjaCB1c2VyIGdldHMgYSBzaW5nbGUgcXVldWUgb2YgTXV0YXRpb25CYXRjaGVzIHRvIGFwcGx5IHRvIHRoZSBzZXJ2ZXIuXG4gKiBEYk11dGF0aW9uUXVldWUgdHJhY2tzIHRoZSBtZXRhZGF0YSBhYm91dCB0aGUgcXVldWUuXG4gKi9cbmNsYXNzIGJzIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKipcbiAgICAgKiBUaGUgbm9ybWFsaXplZCB1c2VyIElEIHRvIHdoaWNoIHRoaXMgcXVldWUgYmVsb25ncy5cbiAgICAgKi9cbiAgICB0LCBcbiAgICAvKipcbiAgICAgKiBBbiBpZGVudGlmaWVyIGZvciB0aGUgaGlnaGVzdCBudW1iZXJlZCBiYXRjaCB0aGF0IGhhcyBiZWVuIGFja25vd2xlZGdlZFxuICAgICAqIGJ5IHRoZSBzZXJ2ZXIuIEFsbCBNdXRhdGlvbkJhdGNoZXMgaW4gdGhpcyBxdWV1ZSB3aXRoIGJhdGNoSWRzIGxlc3NcbiAgICAgKiB0aGFuIG9yIGVxdWFsIHRvIHRoaXMgdmFsdWUgYXJlIGNvbnNpZGVyZWQgdG8gaGF2ZSBiZWVuIGFja25vd2xlZGdlZCBieVxuICAgICAqIHRoZSBzZXJ2ZXIuXG4gICAgICpcbiAgICAgKiBOT1RFOiB0aGlzIGlzIGRlcHJlY2F0ZWQgYW5kIG5vIGxvbmdlciB1c2VkIGJ5IHRoZSBjb2RlLlxuICAgICAqL1xuICAgIGUsIFxuICAgIC8qKlxuICAgICAqIEEgc3RyZWFtIHRva2VuIHRoYXQgd2FzIHByZXZpb3VzbHkgc2VudCBieSB0aGUgc2VydmVyLlxuICAgICAqXG4gICAgICogU2VlIFN0cmVhbWluZ1dyaXRlUmVxdWVzdCBpbiBkYXRhc3RvcmUucHJvdG8gZm9yIG1vcmUgZGV0YWlscyBhYm91dFxuICAgICAqIHVzYWdlLlxuICAgICAqXG4gICAgICogQWZ0ZXIgc2VuZGluZyB0aGlzIHRva2VuLCBlYXJsaWVyIHRva2VucyBtYXkgbm90IGJlIHVzZWQgYW55bW9yZSBzb1xuICAgICAqIG9ubHkgYSBzaW5nbGUgc3RyZWFtIHRva2VuIGlzIHJldGFpbmVkLlxuICAgICAqXG4gICAgICogTk9URTogdGhpcyBpcyBkZXByZWNhdGVkIGFuZCBubyBsb25nZXIgdXNlZCBieSB0aGUgY29kZS5cbiAgICAgKi9cbiAgICBuKSB7XG4gICAgICAgIHRoaXMudXNlcklkID0gdCwgdGhpcy5sYXN0QWNrbm93bGVkZ2VkQmF0Y2hJZCA9IGUsIHRoaXMubGFzdFN0cmVhbVRva2VuID0gbjtcbiAgICB9XG59XG5cbi8qKiBOYW1lIG9mIHRoZSBJbmRleGVkRGIgb2JqZWN0IHN0b3JlLiAgKi8gYnMuc3RvcmUgPSBcIm11dGF0aW9uUXVldWVzXCIsIFxuLyoqIEtleXMgYXJlIGF1dG9tYXRpY2FsbHkgYXNzaWduZWQgdmlhIHRoZSB1c2VySWQgcHJvcGVydHkuICovXG5icy5rZXlQYXRoID0gXCJ1c2VySWRcIjtcblxuLyoqXG4gKiBBbiBvYmplY3QgdG8gYmUgc3RvcmVkIGluIHRoZSAnbXV0YXRpb25zJyBzdG9yZSBpbiBJbmRleGVkRGIuXG4gKlxuICogUmVwcmVzZW50cyBhIGJhdGNoIG9mIHVzZXItbGV2ZWwgbXV0YXRpb25zIGludGVuZGVkIHRvIGJlIHNlbnQgdG8gdGhlIHNlcnZlclxuICogaW4gYSBzaW5nbGUgd3JpdGUuIEVhY2ggdXNlci1sZXZlbCBiYXRjaCBnZXRzIGEgc2VwYXJhdGUgRGJNdXRhdGlvbkJhdGNoXG4gKiB3aXRoIGEgbmV3IGJhdGNoSWQuXG4gKi9cbmNsYXNzIHZzIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKipcbiAgICAgKiBUaGUgbm9ybWFsaXplZCB1c2VyIElEIHRvIHdoaWNoIHRoaXMgYmF0Y2ggYmVsb25ncy5cbiAgICAgKi9cbiAgICB0LCBcbiAgICAvKipcbiAgICAgKiBBbiBpZGVudGlmaWVyIGZvciB0aGlzIGJhdGNoLCBhbGxvY2F0ZWQgdXNpbmcgYW4gYXV0by1nZW5lcmF0ZWQga2V5LlxuICAgICAqL1xuICAgIGUsIFxuICAgIC8qKlxuICAgICAqIFRoZSBsb2NhbCB3cml0ZSB0aW1lIG9mIHRoZSBiYXRjaCwgc3RvcmVkIGFzIG1pbGxpc2Vjb25kcyBzaW5jZSB0aGVcbiAgICAgKiBlcG9jaC5cbiAgICAgKi9cbiAgICBuLCBcbiAgICAvKipcbiAgICAgKiBBIGxpc3Qgb2YgXCJtdXRhdGlvbnNcIiB0aGF0IHJlcHJlc2VudCBhIHBhcnRpYWwgYmFzZSBzdGF0ZSBmcm9tIHdoZW4gdGhpc1xuICAgICAqIHdyaXRlIGJhdGNoIHdhcyBpbml0aWFsbHkgY3JlYXRlZC4gRHVyaW5nIGxvY2FsIGFwcGxpY2F0aW9uIG9mIHRoZSB3cml0ZVxuICAgICAqIGJhdGNoLCB0aGVzZSBiYXNlTXV0YXRpb25zIGFyZSBhcHBsaWVkIHByaW9yIHRvIHRoZSByZWFsIHdyaXRlcyBpbiBvcmRlclxuICAgICAqIHRvIG92ZXJyaWRlIGNlcnRhaW4gZG9jdW1lbnQgZmllbGRzIGZyb20gdGhlIHJlbW90ZSBkb2N1bWVudCBjYWNoZS4gVGhpc1xuICAgICAqIGlzIG5lY2Vzc2FyeSBpbiB0aGUgY2FzZSBvZiBub24taWRlbXBvdGVudCB3cml0ZXMgKGUuZy4gYGluY3JlbWVudCgpYFxuICAgICAqIHRyYW5zZm9ybXMpIHRvIG1ha2Ugc3VyZSB0aGF0IHRoZSBsb2NhbCB2aWV3IG9mIHRoZSBtb2RpZmllZCBkb2N1bWVudHNcbiAgICAgKiBkb2Vzbid0IGZsaWNrZXIgaWYgdGhlIHJlbW90ZSBkb2N1bWVudCBjYWNoZSByZWNlaXZlcyB0aGUgcmVzdWx0IG9mIHRoZVxuICAgICAqIG5vbi1pZGVtcG90ZW50IHdyaXRlIGJlZm9yZSB0aGUgd3JpdGUgaXMgcmVtb3ZlZCBmcm9tIHRoZSBxdWV1ZS5cbiAgICAgKlxuICAgICAqIFRoZXNlIG11dGF0aW9ucyBhcmUgbmV2ZXIgc2VudCB0byB0aGUgYmFja2VuZC5cbiAgICAgKi9cbiAgICBzLCBcbiAgICAvKipcbiAgICAgKiBBIGxpc3Qgb2YgbXV0YXRpb25zIHRvIGFwcGx5LiBBbGwgbXV0YXRpb25zIHdpbGwgYmUgYXBwbGllZCBhdG9taWNhbGx5LlxuICAgICAqXG4gICAgICogTXV0YXRpb25zIGFyZSBzZXJpYWxpemVkIHZpYSB0b011dGF0aW9uKCkuXG4gICAgICovXG4gICAgaSkge1xuICAgICAgICB0aGlzLnVzZXJJZCA9IHQsIHRoaXMuYmF0Y2hJZCA9IGUsIHRoaXMubG9jYWxXcml0ZVRpbWVNcyA9IG4sIHRoaXMuYmFzZU11dGF0aW9ucyA9IHMsIFxuICAgICAgICB0aGlzLm11dGF0aW9ucyA9IGk7XG4gICAgfVxufVxuXG4vKiogTmFtZSBvZiB0aGUgSW5kZXhlZERiIG9iamVjdCBzdG9yZS4gICovIHZzLnN0b3JlID0gXCJtdXRhdGlvbnNcIiwgXG4vKiogS2V5cyBhcmUgYXV0b21hdGljYWxseSBhc3NpZ25lZCB2aWEgdGhlIHVzZXJJZCwgYmF0Y2hJZCBwcm9wZXJ0aWVzLiAqL1xudnMua2V5UGF0aCA9IFwiYmF0Y2hJZFwiLCBcbi8qKiBUaGUgaW5kZXggbmFtZSBmb3IgbG9va3VwIG9mIG11dGF0aW9ucyBieSB1c2VyLiAqL1xudnMudXNlck11dGF0aW9uc0luZGV4ID0gXCJ1c2VyTXV0YXRpb25zSW5kZXhcIiwgXG4vKiogVGhlIHVzZXIgbXV0YXRpb25zIGluZGV4IGlzIGtleWVkIGJ5IFt1c2VySWQsIGJhdGNoSWRdIHBhaXJzLiAqL1xudnMudXNlck11dGF0aW9uc0tleVBhdGggPSBbIFwidXNlcklkXCIsIFwiYmF0Y2hJZFwiIF07XG5cbi8qKlxuICogQW4gb2JqZWN0IHRvIGJlIHN0b3JlZCBpbiB0aGUgJ2RvY3VtZW50TXV0YXRpb25zJyBzdG9yZSBpbiBJbmRleGVkRGIuXG4gKlxuICogQSBtYW51YWxseSBtYWludGFpbmVkIGluZGV4IG9mIGFsbCB0aGUgbXV0YXRpb24gYmF0Y2hlcyB0aGF0IGFmZmVjdCBhIGdpdmVuXG4gKiBkb2N1bWVudCBrZXkuIFRoZSByb3dzIGluIHRoaXMgdGFibGUgYXJlIHJlZmVyZW5jZXMgYmFzZWQgb24gdGhlIGNvbnRlbnRzIG9mXG4gKiBEYk11dGF0aW9uQmF0Y2gubXV0YXRpb25zLlxuICovXG5jbGFzcyBWcyB7XG4gICAgY29uc3RydWN0b3IoKSB7fVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBbdXNlcklkXSBrZXkgZm9yIHVzZSBpbiB0aGUgRGJEb2N1bWVudE11dGF0aW9ucyBpbmRleCB0byBpdGVyYXRlXG4gICAgICogb3ZlciBhbGwgb2YgYSB1c2VyJ3MgZG9jdW1lbnQgbXV0YXRpb25zLlxuICAgICAqLyAgICBzdGF0aWMgcHJlZml4Rm9yVXNlcih0KSB7XG4gICAgICAgIHJldHVybiBbIHQgXTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIFt1c2VySWQsIGVuY29kZWRQYXRoXSBrZXkgZm9yIHVzZSBpbiB0aGUgRGJEb2N1bWVudE11dGF0aW9uc1xuICAgICAqIGluZGV4IHRvIGl0ZXJhdGUgb3ZlciBhbGwgYXQgZG9jdW1lbnQgbXV0YXRpb25zIGZvciBhIGdpdmVuIHBhdGggb3IgbG93ZXIuXG4gICAgICovICAgIHN0YXRpYyBwcmVmaXhGb3JQYXRoKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIFsgdCwgRXMoZSkgXTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGZ1bGwgaW5kZXgga2V5IG9mIFt1c2VySWQsIGVuY29kZWRQYXRoLCBiYXRjaElkXSBmb3IgaW5zZXJ0aW5nXG4gICAgICogYW5kIGRlbGV0aW5nIGludG8gdGhlIERiRG9jdW1lbnRNdXRhdGlvbnMgaW5kZXguXG4gICAgICovICAgIHN0YXRpYyBrZXkodCwgZSwgbikge1xuICAgICAgICByZXR1cm4gWyB0LCBFcyhlKSwgbiBdO1xuICAgIH1cbn1cblxuVnMuc3RvcmUgPSBcImRvY3VtZW50TXV0YXRpb25zXCIsIFxuLyoqXG4gKiBCZWNhdXNlIHdlIHN0b3JlIGFsbCB0aGUgdXNlZnVsIGluZm9ybWF0aW9uIGZvciB0aGlzIHN0b3JlIGluIHRoZSBrZXksXG4gKiB0aGVyZSBpcyBubyB1c2VmdWwgaW5mb3JtYXRpb24gdG8gc3RvcmUgYXMgdGhlIHZhbHVlLiBUaGUgcmF3ICh1bmVuY29kZWQpXG4gKiBwYXRoIGNhbm5vdCBiZSBzdG9yZWQgYmVjYXVzZSBJbmRleGVkRGIgZG9lc24ndCBzdG9yZSBwcm90b3R5cGVcbiAqIGluZm9ybWF0aW9uLlxuICovXG5Wcy5QTEFDRUhPTERFUiA9IG5ldyBWcztcblxuLyoqXG4gKiBSZXByZXNlbnRzIHRoZSBrbm93biBhYnNlbmNlIG9mIGEgZG9jdW1lbnQgYXQgYSBwYXJ0aWN1bGFyIHZlcnNpb24uXG4gKiBTdG9yZWQgaW4gSW5kZXhlZERiIGFzIHBhcnQgb2YgYSBEYlJlbW90ZURvY3VtZW50IG9iamVjdC5cbiAqL1xuY2xhc3MgU3Mge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5wYXRoID0gdCwgdGhpcy5yZWFkVGltZSA9IGU7XG4gICAgfVxufVxuXG4vKipcbiAqIFJlcHJlc2VudHMgYSBkb2N1bWVudCB0aGF0IGlzIGtub3duIHRvIGV4aXN0IGJ1dCB3aG9zZSBkYXRhIGlzIHVua25vd24uXG4gKiBTdG9yZWQgaW4gSW5kZXhlZERiIGFzIHBhcnQgb2YgYSBEYlJlbW90ZURvY3VtZW50IG9iamVjdC5cbiAqLyBjbGFzcyBEcyB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLnBhdGggPSB0LCB0aGlzLnZlcnNpb24gPSBlO1xuICAgIH1cbn1cblxuLyoqXG4gKiBBbiBvYmplY3QgdG8gYmUgc3RvcmVkIGluIHRoZSAncmVtb3RlRG9jdW1lbnRzJyBzdG9yZSBpbiBJbmRleGVkRGIuXG4gKiBJdCByZXByZXNlbnRzIGVpdGhlcjpcbiAqXG4gKiAtIEEgY29tcGxldGUgZG9jdW1lbnQuXG4gKiAtIEEgXCJubyBkb2N1bWVudFwiIHJlcHJlc2VudGluZyBhIGRvY3VtZW50IHRoYXQgaXMga25vd24gbm90IHRvIGV4aXN0IChhdFxuICogc29tZSB2ZXJzaW9uKS5cbiAqIC0gQW4gXCJ1bmtub3duIGRvY3VtZW50XCIgcmVwcmVzZW50aW5nIGEgZG9jdW1lbnQgdGhhdCBpcyBrbm93biB0byBleGlzdCAoYXRcbiAqIHNvbWUgdmVyc2lvbikgYnV0IHdob3NlIGNvbnRlbnRzIGFyZSB1bmtub3duLlxuICpcbiAqIE5vdGU6IFRoaXMgaXMgdGhlIHBlcnNpc3RlZCBlcXVpdmFsZW50IG9mIGEgTWF5YmVEb2N1bWVudCBhbmQgY291bGQgcGVyaGFwc1xuICogYmUgbWFkZSBtb3JlIGdlbmVyYWwgaWYgbmVjZXNzYXJ5LlxuICovIGNsYXNzIENzIHtcbiAgICAvLyBUT0RPOiBXZSBhcmUgY3VycmVudGx5IHN0b3JpbmcgZnVsbCBkb2N1bWVudCBrZXlzIGFsbW9zdCB0aHJlZSB0aW1lc1xuICAgIC8vIChvbmNlIGFzIHBhcnQgb2YgdGhlIHByaW1hcnkga2V5LCBvbmNlIC0gcGFydGx5IC0gYXMgYHBhcmVudFBhdGhgIGFuZCBvbmNlXG4gICAgLy8gaW5zaWRlIHRoZSBlbmNvZGVkIGRvY3VtZW50cykuIER1cmluZyBvdXIgbmV4dCBtaWdyYXRpb24sIHdlIHNob3VsZFxuICAgIC8vIHJld3JpdGUgdGhlIHByaW1hcnkga2V5IGFzIHBhcmVudFBhdGggKyBkb2N1bWVudCBJRCB3aGljaCB3b3VsZCBhbGxvdyB1c1xuICAgIC8vIHRvIGRyb3Agb25lIHZhbHVlLlxuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIFNldCB0byBhbiBpbnN0YW5jZSBvZiBEYlVua25vd25Eb2N1bWVudCBpZiB0aGUgZGF0YSBmb3IgYSBkb2N1bWVudCBpc1xuICAgICAqIG5vdCBrbm93biwgYnV0IGl0IGlzIGtub3duIHRoYXQgYSBkb2N1bWVudCBleGlzdHMgYXQgdGhlIHNwZWNpZmllZFxuICAgICAqIHZlcnNpb24gKGUuZy4gaXQgaGFkIGEgc3VjY2Vzc2Z1bCB1cGRhdGUgYXBwbGllZCB0byBpdClcbiAgICAgKi9cbiAgICB0LCBcbiAgICAvKipcbiAgICAgKiBTZXQgdG8gYW4gaW5zdGFuY2Ugb2YgYSBEYk5vRG9jdW1lbnQgaWYgaXQgaXMga25vd24gdGhhdCBubyBkb2N1bWVudFxuICAgICAqIGV4aXN0cy5cbiAgICAgKi9cbiAgICBlLCBcbiAgICAvKipcbiAgICAgKiBTZXQgdG8gYW4gaW5zdGFuY2Ugb2YgYSBEb2N1bWVudCBpZiB0aGVyZSdzIGEgY2FjaGVkIHZlcnNpb24gb2YgdGhlXG4gICAgICogZG9jdW1lbnQuXG4gICAgICovXG4gICAgbiwgXG4gICAgLyoqXG4gICAgICogRG9jdW1lbnRzIHRoYXQgd2VyZSB3cml0dGVuIHRvIHRoZSByZW1vdGUgZG9jdW1lbnQgc3RvcmUgYmFzZWQgb25cbiAgICAgKiBhIHdyaXRlIGFja25vd2xlZGdtZW50IGFyZSBtYXJrZWQgd2l0aCBgaGFzQ29tbWl0dGVkTXV0YXRpb25zYC4gVGhlc2VcbiAgICAgKiBkb2N1bWVudHMgYXJlIHBvdGVudGlhbGx5IGluY29uc2lzdGVudCB3aXRoIHRoZSBiYWNrZW5kJ3MgY29weSBhbmQgdXNlXG4gICAgICogdGhlIHdyaXRlJ3MgY29tbWl0IHZlcnNpb24gYXMgdGhlaXIgZG9jdW1lbnQgdmVyc2lvbi5cbiAgICAgKi9cbiAgICBzLCBcbiAgICAvKipcbiAgICAgKiBXaGVuIHRoZSBkb2N1bWVudCB3YXMgcmVhZCBmcm9tIHRoZSBiYWNrZW5kLiBVbmRlZmluZWQgZm9yIGRhdGEgd3JpdHRlblxuICAgICAqIHByaW9yIHRvIHNjaGVtYSB2ZXJzaW9uIDkuXG4gICAgICovXG4gICAgaSwgXG4gICAgLyoqXG4gICAgICogVGhlIHBhdGggb2YgdGhlIGNvbGxlY3Rpb24gdGhpcyBkb2N1bWVudCBpcyBwYXJ0IG9mLiBVbmRlZmluZWQgZm9yIGRhdGFcbiAgICAgKiB3cml0dGVuIHByaW9yIHRvIHNjaGVtYSB2ZXJzaW9uIDkuXG4gICAgICovXG4gICAgcikge1xuICAgICAgICB0aGlzLnVua25vd25Eb2N1bWVudCA9IHQsIHRoaXMubm9Eb2N1bWVudCA9IGUsIHRoaXMuZG9jdW1lbnQgPSBuLCB0aGlzLmhhc0NvbW1pdHRlZE11dGF0aW9ucyA9IHMsIFxuICAgICAgICB0aGlzLnJlYWRUaW1lID0gaSwgdGhpcy5wYXJlbnRQYXRoID0gcjtcbiAgICB9XG59XG5cbkNzLnN0b3JlID0gXCJyZW1vdGVEb2N1bWVudHNcIiwgXG4vKipcbiAqIEFuIGluZGV4IHRoYXQgcHJvdmlkZXMgYWNjZXNzIHRvIGFsbCBlbnRyaWVzIHNvcnRlZCBieSByZWFkIHRpbWUgKHdoaWNoXG4gKiBjb3JyZXNwb25kcyB0byB0aGUgbGFzdCBtb2RpZmljYXRpb24gdGltZSBvZiBlYWNoIHJvdykuXG4gKlxuICogVGhpcyBpbmRleCBpcyB1c2VkIHRvIHByb3ZpZGUgYSBjaGFuZ2Vsb2cgZm9yIE11bHRpLVRhYi5cbiAqL1xuQ3MucmVhZFRpbWVJbmRleCA9IFwicmVhZFRpbWVJbmRleFwiLCBDcy5yZWFkVGltZUluZGV4UGF0aCA9IFwicmVhZFRpbWVcIiwgXG4vKipcbiAqIEFuIGluZGV4IHRoYXQgcHJvdmlkZXMgYWNjZXNzIHRvIGRvY3VtZW50cyBpbiBhIGNvbGxlY3Rpb24gc29ydGVkIGJ5IHJlYWRcbiAqIHRpbWUuXG4gKlxuICogVGhpcyBpbmRleCBpcyB1c2VkIHRvIGFsbG93IHRoZSBSZW1vdGVEb2N1bWVudENhY2hlIHRvIGZldGNoIG5ld2x5IGNoYW5nZWRcbiAqIGRvY3VtZW50cyBpbiBhIGNvbGxlY3Rpb24uXG4gKi9cbkNzLmNvbGxlY3Rpb25SZWFkVGltZUluZGV4ID0gXCJjb2xsZWN0aW9uUmVhZFRpbWVJbmRleFwiLCBDcy5jb2xsZWN0aW9uUmVhZFRpbWVJbmRleFBhdGggPSBbIFwicGFyZW50UGF0aFwiLCBcInJlYWRUaW1lXCIgXTtcblxuLyoqXG4gKiBDb250YWlucyBhIHNpbmdsZSBlbnRyeSB0aGF0IGhhcyBtZXRhZGF0YSBhYm91dCB0aGUgcmVtb3RlIGRvY3VtZW50IGNhY2hlLlxuICovXG5jbGFzcyBOcyB7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIGJ5dGVTaXplIC0gQXBwcm94aW1hdGVseSB0aGUgdG90YWwgc2l6ZSBpbiBieXRlcyBvZiBhbGwgdGhlXG4gICAgICogZG9jdW1lbnRzIGluIHRoZSBkb2N1bWVudCBjYWNoZS5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMuYnl0ZVNpemUgPSB0O1xuICAgIH1cbn1cblxuTnMuc3RvcmUgPSBcInJlbW90ZURvY3VtZW50R2xvYmFsXCIsIE5zLmtleSA9IFwicmVtb3RlRG9jdW1lbnRHbG9iYWxLZXlcIjtcblxuLyoqXG4gKiBBbiBvYmplY3QgdG8gYmUgc3RvcmVkIGluIHRoZSAndGFyZ2V0cycgc3RvcmUgaW4gSW5kZXhlZERiLlxuICpcbiAqIFRoaXMgaXMgYmFzZWQgb24gYW5kIHNob3VsZCBiZSBrZXB0IGluIHN5bmMgd2l0aCB0aGUgcHJvdG8gdXNlZCBpbiB0aGUgaU9TXG4gKiBjbGllbnQuXG4gKlxuICogRWFjaCBxdWVyeSB0aGUgY2xpZW50IGxpc3RlbnMgdG8gYWdhaW5zdCB0aGUgc2VydmVyIGlzIHRyYWNrZWQgb24gZGlzayBzb1xuICogdGhhdCB0aGUgcXVlcnkgY2FuIGJlIGVmZmljaWVudGx5IHJlc3VtZWQgb24gcmVzdGFydC5cbiAqL1xuY2xhc3MgeHMge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIEFuIGF1dG8tZ2VuZXJhdGVkIHNlcXVlbnRpYWwgbnVtZXJpYyBpZGVudGlmaWVyIGZvciB0aGUgcXVlcnkuXG4gICAgICpcbiAgICAgKiBRdWVyaWVzIGFyZSBzdG9yZWQgdXNpbmcgdGhlaXIgY2Fub25pY2FsSWQgYXMgdGhlIGtleSwgYnV0IHRoZXNlXG4gICAgICogY2Fub25pY2FsSWRzIGNhbiBiZSBxdWl0ZSBsb25nIHNvIHdlIGFkZGl0aW9uYWxseSBhc3NpZ24gYSB1bmlxdWVcbiAgICAgKiBxdWVyeUlkIHdoaWNoIGNhbiBiZSB1c2VkIGJ5IHJlZmVyZW5jZWQgZGF0YSBzdHJ1Y3R1cmVzIChlLmcuXG4gICAgICogaW5kZXhlcykgdG8gbWluaW1pemUgdGhlIG9uLWRpc2sgY29zdC5cbiAgICAgKi9cbiAgICB0LCBcbiAgICAvKipcbiAgICAgKiBUaGUgY2Fub25pY2FsIHN0cmluZyByZXByZXNlbnRpbmcgdGhpcyBxdWVyeS4gVGhpcyBpcyBub3QgdW5pcXVlLlxuICAgICAqL1xuICAgIGUsIFxuICAgIC8qKlxuICAgICAqIFRoZSBsYXN0IHJlYWRUaW1lIHJlY2VpdmVkIGZyb20gdGhlIFdhdGNoIFNlcnZpY2UgZm9yIHRoaXMgcXVlcnkuXG4gICAgICpcbiAgICAgKiBUaGlzIGlzIHRoZSBzYW1lIHZhbHVlIGFzIFRhcmdldENoYW5nZS5yZWFkX3RpbWUgaW4gdGhlIHByb3Rvcy5cbiAgICAgKi9cbiAgICBuLCBcbiAgICAvKipcbiAgICAgKiBBbiBvcGFxdWUsIHNlcnZlci1hc3NpZ25lZCB0b2tlbiB0aGF0IGFsbG93cyB3YXRjaGluZyBhIHF1ZXJ5IHRvIGJlXG4gICAgICogcmVzdW1lZCBhZnRlciBkaXNjb25uZWN0aW5nIHdpdGhvdXQgcmV0cmFuc21pdHRpbmcgYWxsIHRoZSBkYXRhXG4gICAgICogdGhhdCBtYXRjaGVzIHRoZSBxdWVyeS4gVGhlIHJlc3VtZSB0b2tlbiBlc3NlbnRpYWxseSBpZGVudGlmaWVzIGFcbiAgICAgKiBwb2ludCBpbiB0aW1lIGZyb20gd2hpY2ggdGhlIHNlcnZlciBzaG91bGQgcmVzdW1lIHNlbmRpbmcgcmVzdWx0cy5cbiAgICAgKlxuICAgICAqIFRoaXMgaXMgcmVsYXRlZCB0byB0aGUgc25hcHNob3RWZXJzaW9uIGluIHRoYXQgdGhlIHJlc3VtZVRva2VuXG4gICAgICogZWZmZWN0aXZlbHkgYWxzbyBlbmNvZGVzIHRoYXQgdmFsdWUsIGJ1dCB0aGUgcmVzdW1lVG9rZW4gaXMgb3BhcXVlXG4gICAgICogYW5kIHNvbWV0aW1lcyBlbmNvZGVzIGFkZGl0aW9uYWwgaW5mb3JtYXRpb24uXG4gICAgICpcbiAgICAgKiBBIGNvbnNlcXVlbmNlIG9mIHRoaXMgaXMgdGhhdCB0aGUgcmVzdW1lVG9rZW4gc2hvdWxkIGJlIHVzZWQgd2hlblxuICAgICAqIGFza2luZyB0aGUgc2VydmVyIHRvIHJlYXNvbiBhYm91dCB3aGVyZSB0aGlzIGNsaWVudCBpcyBpbiB0aGUgd2F0Y2hcbiAgICAgKiBzdHJlYW0sIGJ1dCB0aGUgY2xpZW50IHNob3VsZCB1c2UgdGhlIHNuYXBzaG90VmVyc2lvbiBmb3IgaXRzIG93blxuICAgICAqIHB1cnBvc2VzLlxuICAgICAqXG4gICAgICogVGhpcyBpcyB0aGUgc2FtZSB2YWx1ZSBhcyBUYXJnZXRDaGFuZ2UucmVzdW1lX3Rva2VuIGluIHRoZSBwcm90b3MuXG4gICAgICovXG4gICAgcywgXG4gICAgLyoqXG4gICAgICogQSBzZXF1ZW5jZSBudW1iZXIgcmVwcmVzZW50aW5nIHRoZSBsYXN0IHRpbWUgdGhpcyBxdWVyeSB3YXNcbiAgICAgKiBsaXN0ZW5lZCB0bywgdXNlZCBmb3IgZ2FyYmFnZSBjb2xsZWN0aW9uIHB1cnBvc2VzLlxuICAgICAqXG4gICAgICogQ29udmVudGlvbmFsbHkgdGhpcyB3b3VsZCBiZSBhIHRpbWVzdGFtcCB2YWx1ZSwgYnV0IGRldmljZS1sb2NhbFxuICAgICAqIGNsb2NrcyBhcmUgdW5yZWxpYWJsZSBhbmQgdGhleSBtdXN0IGJlIGFibGUgdG8gY3JlYXRlIG5ldyBsaXN0ZW5zXG4gICAgICogZXZlbiB3aGlsZSBkaXNjb25uZWN0ZWQuIEluc3RlYWQgdGhpcyBzaG91bGQgYmUgYSBtb25vdG9uaWNhbGx5XG4gICAgICogaW5jcmVhc2luZyBudW1iZXIgdGhhdCdzIGluY3JlbWVudGVkIG9uIGVhY2ggbGlzdGVuIGNhbGwuXG4gICAgICpcbiAgICAgKiBUaGlzIGlzIGRpZmZlcmVudCBmcm9tIHRoZSBxdWVyeUlkIHNpbmNlIHRoZSBxdWVyeUlkIGlzIGFuXG4gICAgICogaW1tdXRhYmxlIGlkZW50aWZpZXIgYXNzaWduZWQgdG8gdGhlIFF1ZXJ5IG9uIGZpcnN0IHVzZSB3aGlsZVxuICAgICAqIGxhc3RMaXN0ZW5TZXF1ZW5jZU51bWJlciBpcyB1cGRhdGVkIGV2ZXJ5IHRpbWUgdGhlIHF1ZXJ5IGlzXG4gICAgICogbGlzdGVuZWQgdG8uXG4gICAgICovXG4gICAgaSwgXG4gICAgLyoqXG4gICAgICogRGVub3RlcyB0aGUgbWF4aW11bSBzbmFwc2hvdCB2ZXJzaW9uIGF0IHdoaWNoIHRoZSBhc3NvY2lhdGVkIHF1ZXJ5IHZpZXdcbiAgICAgKiBjb250YWluZWQgbm8gbGltYm8gZG9jdW1lbnRzLiAgVW5kZWZpbmVkIGZvciBkYXRhIHdyaXR0ZW4gcHJpb3IgdG9cbiAgICAgKiBzY2hlbWEgdmVyc2lvbiA5LlxuICAgICAqL1xuICAgIHIsIFxuICAgIC8qKlxuICAgICAqIFRoZSBxdWVyeSBmb3IgdGhpcyB0YXJnZXQuXG4gICAgICpcbiAgICAgKiBCZWNhdXNlIGNhbm9uaWNhbCBpZHMgYXJlIG5vdCB1bmlxdWUgd2UgbXVzdCBzdG9yZSB0aGUgYWN0dWFsIHF1ZXJ5LiBXZVxuICAgICAqIHVzZSB0aGUgcHJvdG8gdG8gaGF2ZSBhbiBvYmplY3Qgd2UgY2FuIHBlcnNpc3Qgd2l0aG91dCBoYXZpbmcgdG9cbiAgICAgKiBkdXBsaWNhdGUgdHJhbnNsYXRpb24gbG9naWMgdG8gYW5kIGZyb20gYSBgUXVlcnlgIG9iamVjdC5cbiAgICAgKi9cbiAgICBvKSB7XG4gICAgICAgIHRoaXMudGFyZ2V0SWQgPSB0LCB0aGlzLmNhbm9uaWNhbElkID0gZSwgdGhpcy5yZWFkVGltZSA9IG4sIHRoaXMucmVzdW1lVG9rZW4gPSBzLCBcbiAgICAgICAgdGhpcy5sYXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIgPSBpLCB0aGlzLmxhc3RMaW1ib0ZyZWVTbmFwc2hvdFZlcnNpb24gPSByLCB0aGlzLnF1ZXJ5ID0gbztcbiAgICB9XG59XG5cbnhzLnN0b3JlID0gXCJ0YXJnZXRzXCIsIFxuLyoqIEtleXMgYXJlIGF1dG9tYXRpY2FsbHkgYXNzaWduZWQgdmlhIHRoZSB0YXJnZXRJZCBwcm9wZXJ0eS4gKi9cbnhzLmtleVBhdGggPSBcInRhcmdldElkXCIsIFxuLyoqIFRoZSBuYW1lIG9mIHRoZSBxdWVyeVRhcmdldHMgaW5kZXguICovXG54cy5xdWVyeVRhcmdldHNJbmRleE5hbWUgPSBcInF1ZXJ5VGFyZ2V0c0luZGV4XCIsIFxuLyoqXG4gKiBUaGUgaW5kZXggb2YgYWxsIGNhbm9uaWNhbElkcyB0byB0aGUgdGFyZ2V0cyB0aGF0IHRoZXkgbWF0Y2guIFRoaXMgaXMgbm90XG4gKiBhIHVuaXF1ZSBtYXBwaW5nIGJlY2F1c2UgY2Fub25pY2FsSWQgZG9lcyBub3QgcHJvbWlzZSBhIHVuaXF1ZSBuYW1lIGZvciBhbGxcbiAqIHBvc3NpYmxlIHF1ZXJpZXMsIHNvIHdlIGFwcGVuZCB0aGUgdGFyZ2V0SWQgdG8gbWFrZSB0aGUgbWFwcGluZyB1bmlxdWUuXG4gKi9cbnhzLnF1ZXJ5VGFyZ2V0c0tleVBhdGggPSBbIFwiY2Fub25pY2FsSWRcIiwgXCJ0YXJnZXRJZFwiIF07XG5cbi8qKlxuICogQW4gb2JqZWN0IHJlcHJlc2VudGluZyBhbiBhc3NvY2lhdGlvbiBiZXR3ZWVuIGEgdGFyZ2V0IGFuZCBhIGRvY3VtZW50LCBvciBhXG4gKiBzZW50aW5lbCByb3cgbWFya2luZyB0aGUgbGFzdCBzZXF1ZW5jZSBudW1iZXIgYXQgd2hpY2ggYSBkb2N1bWVudCB3YXMgdXNlZC5cbiAqIEVhY2ggZG9jdW1lbnQgY2FjaGVkIG11c3QgaGF2ZSBhIGNvcnJlc3BvbmRpbmcgc2VudGluZWwgcm93IGJlZm9yZSBscnVcbiAqIGdhcmJhZ2UgY29sbGVjdGlvbiBpcyBlbmFibGVkLlxuICpcbiAqIFRoZSB0YXJnZXQgYXNzb2NpYXRpb25zIGFuZCBzZW50aW5lbCByb3dzIGFyZSBjby1sb2NhdGVkIHNvIHRoYXQgb3JwaGFuZWRcbiAqIGRvY3VtZW50cyBhbmQgdGhlaXIgc2VxdWVuY2UgbnVtYmVycyBjYW4gYmUgaWRlbnRpZmllZCBlZmZpY2llbnRseSB2aWEgYSBzY2FuXG4gKiBvZiB0aGlzIHN0b3JlLlxuICovXG5jbGFzcyBrcyB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgLyoqXG4gICAgICogVGhlIHRhcmdldElkIGlkZW50aWZ5aW5nIGEgdGFyZ2V0IG9yIDAgZm9yIGEgc2VudGluZWwgcm93LlxuICAgICAqL1xuICAgIHQsIFxuICAgIC8qKlxuICAgICAqIFRoZSBwYXRoIHRvIHRoZSBkb2N1bWVudCwgYXMgZW5jb2RlZCBpbiB0aGUga2V5LlxuICAgICAqL1xuICAgIGUsIFxuICAgIC8qKlxuICAgICAqIElmIHRoaXMgaXMgYSBzZW50aW5lbCByb3csIHRoaXMgc2hvdWxkIGJlIHRoZSBzZXF1ZW5jZSBudW1iZXIgb2YgdGhlIGxhc3RcbiAgICAgKiB0aW1lIHRoZSBkb2N1bWVudCBzcGVjaWZpZWQgYnkgYHBhdGhgIHdhcyB1c2VkLiBPdGhlcndpc2UsIGl0IHNob3VsZCBiZVxuICAgICAqIGB1bmRlZmluZWRgLlxuICAgICAqL1xuICAgIG4pIHtcbiAgICAgICAgdGhpcy50YXJnZXRJZCA9IHQsIHRoaXMucGF0aCA9IGUsIHRoaXMuc2VxdWVuY2VOdW1iZXIgPSBuO1xuICAgIH1cbn1cblxuLyoqIE5hbWUgb2YgdGhlIEluZGV4ZWREYiBvYmplY3Qgc3RvcmUuICAqLyBrcy5zdG9yZSA9IFwidGFyZ2V0RG9jdW1lbnRzXCIsIFxuLyoqIEtleXMgYXJlIGF1dG9tYXRpY2FsbHkgYXNzaWduZWQgdmlhIHRoZSB0YXJnZXRJZCwgcGF0aCBwcm9wZXJ0aWVzLiAqL1xua3Mua2V5UGF0aCA9IFsgXCJ0YXJnZXRJZFwiLCBcInBhdGhcIiBdLCBcbi8qKiBUaGUgaW5kZXggbmFtZSBmb3IgdGhlIHJldmVyc2UgaW5kZXguICovXG5rcy5kb2N1bWVudFRhcmdldHNJbmRleCA9IFwiZG9jdW1lbnRUYXJnZXRzSW5kZXhcIiwgXG4vKiogV2UgYWxzbyBuZWVkIHRvIGNyZWF0ZSB0aGUgcmV2ZXJzZSBpbmRleCBmb3IgdGhlc2UgcHJvcGVydGllcy4gKi9cbmtzLmRvY3VtZW50VGFyZ2V0c0tleVBhdGggPSBbIFwicGF0aFwiLCBcInRhcmdldElkXCIgXTtcblxuLyoqXG4gKiBBIHJlY29yZCBvZiBnbG9iYWwgc3RhdGUgdHJhY2tlZCBhY3Jvc3MgYWxsIFRhcmdldHMsIHRyYWNrZWQgc2VwYXJhdGVseVxuICogdG8gYXZvaWQgdGhlIG5lZWQgZm9yIGV4dHJhIGluZGV4ZXMuXG4gKlxuICogVGhpcyBzaG91bGQgYmUga2VwdCBpbi1zeW5jIHdpdGggdGhlIHByb3RvIHVzZWQgaW4gdGhlIGlPUyBjbGllbnQuXG4gKi9cbmNsYXNzICRzIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKipcbiAgICAgKiBUaGUgaGlnaGVzdCBudW1iZXJlZCB0YXJnZXQgaWQgYWNyb3NzIGFsbCB0YXJnZXRzLlxuICAgICAqXG4gICAgICogU2VlIERiVGFyZ2V0LnRhcmdldElkLlxuICAgICAqL1xuICAgIHQsIFxuICAgIC8qKlxuICAgICAqIFRoZSBoaWdoZXN0IG51bWJlcmVkIGxhc3RMaXN0ZW5TZXF1ZW5jZU51bWJlciBhY3Jvc3MgYWxsIHRhcmdldHMuXG4gICAgICpcbiAgICAgKiBTZWUgRGJUYXJnZXQubGFzdExpc3RlblNlcXVlbmNlTnVtYmVyLlxuICAgICAqL1xuICAgIGUsIFxuICAgIC8qKlxuICAgICAqIEEgZ2xvYmFsIHNuYXBzaG90IHZlcnNpb24gcmVwcmVzZW50aW5nIHRoZSBsYXN0IGNvbnNpc3RlbnQgc25hcHNob3Qgd2VcbiAgICAgKiByZWNlaXZlZCBmcm9tIHRoZSBiYWNrZW5kLiBUaGlzIGlzIG1vbm90b25pY2FsbHkgaW5jcmVhc2luZyBhbmQgYW55XG4gICAgICogc25hcHNob3RzIHJlY2VpdmVkIGZyb20gdGhlIGJhY2tlbmQgcHJpb3IgdG8gdGhpcyB2ZXJzaW9uIChlLmcuIGZvclxuICAgICAqIHRhcmdldHMgcmVzdW1lZCB3aXRoIGEgcmVzdW1lVG9rZW4pIHNob3VsZCBiZSBzdXBwcmVzc2VkIChidWZmZXJlZClcbiAgICAgKiB1bnRpbCB0aGUgYmFja2VuZCBoYXMgY2F1Z2h0IHVwIHRvIHRoaXMgc25hcHNob3QgdmVyc2lvbiBhZ2Fpbi4gVGhpc1xuICAgICAqIHByZXZlbnRzIG91ciBjYWNoZSBmcm9tIGV2ZXIgZ29pbmcgYmFja3dhcmRzIGluIHRpbWUuXG4gICAgICovXG4gICAgbiwgXG4gICAgLyoqXG4gICAgICogVGhlIG51bWJlciBvZiB0YXJnZXRzIHBlcnNpc3RlZC5cbiAgICAgKi9cbiAgICBzKSB7XG4gICAgICAgIHRoaXMuaGlnaGVzdFRhcmdldElkID0gdCwgdGhpcy5oaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIgPSBlLCB0aGlzLmxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24gPSBuLCBcbiAgICAgICAgdGhpcy50YXJnZXRDb3VudCA9IHM7XG4gICAgfVxufVxuXG4vKipcbiAqIFRoZSBrZXkgc3RyaW5nIHVzZWQgZm9yIHRoZSBzaW5nbGUgb2JqZWN0IHRoYXQgZXhpc3RzIGluIHRoZVxuICogRGJUYXJnZXRHbG9iYWwgc3RvcmUuXG4gKi8gJHMua2V5ID0gXCJ0YXJnZXRHbG9iYWxLZXlcIiwgJHMuc3RvcmUgPSBcInRhcmdldEdsb2JhbFwiO1xuXG4vKipcbiAqIEFuIG9iamVjdCByZXByZXNlbnRpbmcgYW4gYXNzb2NpYXRpb24gYmV0d2VlbiBhIENvbGxlY3Rpb24gaWQgKGUuZy4gJ21lc3NhZ2VzJylcbiAqIHRvIGEgcGFyZW50IHBhdGggKGUuZy4gJy9jaGF0cy8xMjMnKSB0aGF0IGNvbnRhaW5zIGl0IGFzIGEgKHN1Yiljb2xsZWN0aW9uLlxuICogVGhpcyBpcyB1c2VkIHRvIGVmZmljaWVudGx5IGZpbmQgYWxsIGNvbGxlY3Rpb25zIHRvIHF1ZXJ5IHdoZW4gcGVyZm9ybWluZ1xuICogYSBDb2xsZWN0aW9uIEdyb3VwIHF1ZXJ5LlxuICovXG5jbGFzcyBPcyB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgLyoqXG4gICAgICogVGhlIGNvbGxlY3Rpb25JZCAoZS5nLiAnbWVzc2FnZXMnKVxuICAgICAqL1xuICAgIHQsIFxuICAgIC8qKlxuICAgICAqIFRoZSBwYXRoIHRvIHRoZSBwYXJlbnQgKGVpdGhlciBhIGRvY3VtZW50IGxvY2F0aW9uIG9yIGFuIGVtcHR5IHBhdGggZm9yXG4gICAgICogYSByb290LWxldmVsIGNvbGxlY3Rpb24pLlxuICAgICAqL1xuICAgIGUpIHtcbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uSWQgPSB0LCB0aGlzLnBhcmVudCA9IGU7XG4gICAgfVxufVxuXG4vKiogTmFtZSBvZiB0aGUgSW5kZXhlZERiIG9iamVjdCBzdG9yZS4gKi8gT3Muc3RvcmUgPSBcImNvbGxlY3Rpb25QYXJlbnRzXCIsIFxuLyoqIEtleXMgYXJlIGF1dG9tYXRpY2FsbHkgYXNzaWduZWQgdmlhIHRoZSBjb2xsZWN0aW9uSWQsIHBhcmVudCBwcm9wZXJ0aWVzLiAqL1xuT3Mua2V5UGF0aCA9IFsgXCJjb2xsZWN0aW9uSWRcIiwgXCJwYXJlbnRcIiBdO1xuXG4vKipcbiAqIEEgcmVjb3JkIG9mIHRoZSBtZXRhZGF0YSBzdGF0ZSBvZiBlYWNoIGNsaWVudC5cbiAqXG4gKiBQT1JUSU5HIE5PVEU6IFRoaXMgaXMgdXNlZCB0byBzeW5jaHJvbml6ZSBtdWx0aS10YWIgc3RhdGUgYW5kIGRvZXMgbm90IG5lZWRcbiAqIHRvIGJlIHBvcnRlZCB0byBpT1Mgb3IgQW5kcm9pZC5cbiAqL1xuY2xhc3MgRnMge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8vIE5vdGU6IFByZXZpb3VzIHNjaGVtYSB2ZXJzaW9ucyBpbmNsdWRlZCBhIGZpZWxkXG4gICAgLy8gXCJsYXN0UHJvY2Vzc2VkRG9jdW1lbnRDaGFuZ2VJZFwiLiBEb24ndCB1c2UgYW55bW9yZS5cbiAgICAvKiogVGhlIGF1dG8tZ2VuZXJhdGVkIGNsaWVudCBpZCBhc3NpZ25lZCBhdCBjbGllbnQgc3RhcnR1cC4gKi9cbiAgICB0LCBcbiAgICAvKiogVGhlIGxhc3QgdGltZSB0aGlzIHN0YXRlIHdhcyB1cGRhdGVkLiAqL1xuICAgIGUsIFxuICAgIC8qKiBXaGV0aGVyIHRoZSBjbGllbnQncyBuZXR3b3JrIGNvbm5lY3Rpb24gaXMgZW5hYmxlZC4gKi9cbiAgICBuLCBcbiAgICAvKiogV2hldGhlciB0aGlzIGNsaWVudCBpcyBydW5uaW5nIGluIGEgZm9yZWdyb3VuZCB0YWIuICovXG4gICAgcykge1xuICAgICAgICB0aGlzLmNsaWVudElkID0gdCwgdGhpcy51cGRhdGVUaW1lTXMgPSBlLCB0aGlzLm5ldHdvcmtFbmFibGVkID0gbiwgdGhpcy5pbkZvcmVncm91bmQgPSBzO1xuICAgIH1cbn1cblxuLyoqIE5hbWUgb2YgdGhlIEluZGV4ZWREYiBvYmplY3Qgc3RvcmUuICovIEZzLnN0b3JlID0gXCJjbGllbnRNZXRhZGF0YVwiLCBcbi8qKiBLZXlzIGFyZSBhdXRvbWF0aWNhbGx5IGFzc2lnbmVkIHZpYSB0aGUgY2xpZW50SWQgcHJvcGVydGllcy4gKi9cbkZzLmtleVBhdGggPSBcImNsaWVudElkXCI7XG5cbi8qKlxuICogQSBvYmplY3QgcmVwcmVzZW50aW5nIGEgYnVuZGxlIGxvYWRlZCBieSB0aGUgU0RLLlxuICovXG5jbGFzcyBNcyB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgLyoqIFRoZSBJRCBvZiB0aGUgbG9hZGVkIGJ1bmRsZS4gKi9cbiAgICB0LCBcbiAgICAvKiogVGhlIGNyZWF0ZSB0aW1lIG9mIHRoZSBsb2FkZWQgYnVuZGxlLiAqL1xuICAgIGUsIFxuICAgIC8qKiBUaGUgc2NoZW1hIHZlcnNpb24gb2YgdGhlIGxvYWRlZCBidW5kbGUuICovXG4gICAgbikge1xuICAgICAgICB0aGlzLmJ1bmRsZUlkID0gdCwgdGhpcy5jcmVhdGVUaW1lID0gZSwgdGhpcy52ZXJzaW9uID0gbjtcbiAgICB9XG59XG5cbi8qKiBOYW1lIG9mIHRoZSBJbmRleGVkRGIgb2JqZWN0IHN0b3JlLiAqLyBNcy5zdG9yZSA9IFwiYnVuZGxlc1wiLCBNcy5rZXlQYXRoID0gXCJidW5kbGVJZFwiO1xuXG4vKipcbiAqIEEgb2JqZWN0IHJlcHJlc2VudGluZyBhIG5hbWVkIHF1ZXJ5IGxvYWRlZCBieSB0aGUgU0RLIHZpYSBhIGJ1bmRsZS5cbiAqL1xuY2xhc3MgTHMge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKiBUaGUgbmFtZSBvZiB0aGUgcXVlcnkuICovXG4gICAgdCwgXG4gICAgLyoqIFRoZSByZWFkIHRpbWUgb2YgdGhlIHJlc3VsdHMgc2F2ZWQgaW4gdGhlIGJ1bmRsZSBmcm9tIHRoZSBuYW1lZCBxdWVyeS4gKi9cbiAgICBlLCBcbiAgICAvKiogVGhlIHF1ZXJ5IHNhdmVkIGluIHRoZSBidW5kbGUuICovXG4gICAgbikge1xuICAgICAgICB0aGlzLm5hbWUgPSB0LCB0aGlzLnJlYWRUaW1lID0gZSwgdGhpcy5idW5kbGVkUXVlcnkgPSBuO1xuICAgIH1cbn1cblxuLyoqIE5hbWUgb2YgdGhlIEluZGV4ZWREYiBvYmplY3Qgc3RvcmUuICovIExzLnN0b3JlID0gXCJuYW1lZFF1ZXJpZXNcIiwgTHMua2V5UGF0aCA9IFwibmFtZVwiO1xuXG4vLyBWaXNpYmxlIGZvciB0ZXN0aW5nXG5jb25zdCBCcyA9IFsgLi4uWyAuLi5bIC4uLlsgLi4uWyBicy5zdG9yZSwgdnMuc3RvcmUsIFZzLnN0b3JlLCBDcy5zdG9yZSwgeHMuc3RvcmUsIFBzLnN0b3JlLCAkcy5zdG9yZSwga3Muc3RvcmUgXSwgRnMuc3RvcmUgXSwgTnMuc3RvcmUgXSwgT3Muc3RvcmUgXSwgTXMuc3RvcmUsIExzLnN0b3JlIF0sIFVzID0gXCJUaGUgY3VycmVudCB0YWIgaXMgbm90IGluIHRoZSByZXF1aXJlZCBzdGF0ZSB0byBwZXJmb3JtIHRoaXMgb3BlcmF0aW9uLiBJdCBtaWdodCBiZSBuZWNlc3NhcnkgdG8gcmVmcmVzaCB0aGUgYnJvd3NlciB0YWIuXCI7XG5cbi8vIFYyIGlzIG5vIGxvbmdlciB1c2FibGUgKHNlZSBjb21tZW50IGF0IHRvcCBvZiBmaWxlKVxuLy8gVmlzaWJsZSBmb3IgdGVzdGluZ1xuLyoqXG4gKiBBIGJhc2UgY2xhc3MgcmVwcmVzZW50aW5nIGEgcGVyc2lzdGVuY2UgdHJhbnNhY3Rpb24sIGVuY2Fwc3VsYXRpbmcgYm90aCB0aGVcbiAqIHRyYW5zYWN0aW9uJ3Mgc2VxdWVuY2UgbnVtYmVycyBhcyB3ZWxsIGFzIGEgbGlzdCBvZiBvbkNvbW1pdHRlZCBsaXN0ZW5lcnMuXG4gKlxuICogV2hlbiB5b3UgY2FsbCBQZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbigpLCBpdCB3aWxsIGNyZWF0ZSBhIHRyYW5zYWN0aW9uIGFuZFxuICogcGFzcyBpdCB0byB5b3VyIGNhbGxiYWNrLiBZb3UgdGhlbiBwYXNzIGl0IHRvIGFueSBtZXRob2QgdGhhdCBvcGVyYXRlc1xuICogb24gcGVyc2lzdGVuY2UuXG4gKi9cbmNsYXNzIHFzIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5vbkNvbW1pdHRlZExpc3RlbmVycyA9IFtdO1xuICAgIH1cbiAgICBhZGRPbkNvbW1pdHRlZExpc3RlbmVyKHQpIHtcbiAgICAgICAgdGhpcy5vbkNvbW1pdHRlZExpc3RlbmVycy5wdXNoKHQpO1xuICAgIH1cbiAgICByYWlzZU9uQ29tbWl0dGVkRXZlbnQoKSB7XG4gICAgICAgIHRoaXMub25Db21taXR0ZWRMaXN0ZW5lcnMuZm9yRWFjaCgodCA9PiB0KCkpKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFBlcnNpc3RlbmNlUHJvbWlzZSBpcyBlc3NlbnRpYWxseSBhIHJlLWltcGxlbWVudGF0aW9uIG9mIFByb21pc2UgZXhjZXB0XG4gKiBpdCBoYXMgYSAubmV4dCgpIG1ldGhvZCBpbnN0ZWFkIG9mIC50aGVuKCkgYW5kIC5uZXh0KCkgYW5kIC5jYXRjaCgpIGNhbGxiYWNrc1xuICogYXJlIGV4ZWN1dGVkIHN5bmNocm9ub3VzbHkgd2hlbiBhIFBlcnNpc3RlbmNlUHJvbWlzZSByZXNvbHZlcyByYXRoZXIgdGhhblxuICogYXN5bmNocm9ub3VzbHkgKFByb21pc2UgaW1wbGVtZW50YXRpb25zIHVzZSBzZXRJbW1lZGlhdGUoKSBvciBzaW1pbGFyKS5cbiAqXG4gKiBUaGlzIGlzIG5lY2Vzc2FyeSB0byBpbnRlcm9wZXJhdGUgd2l0aCBJbmRleGVkREIgd2hpY2ggd2lsbCBhdXRvbWF0aWNhbGx5XG4gKiBjb21taXQgdHJhbnNhY3Rpb25zIGlmIGNvbnRyb2wgaXMgcmV0dXJuZWQgdG8gdGhlIGV2ZW50IGxvb3Agd2l0aG91dFxuICogc3luY2hyb25vdXNseSBpbml0aWF0aW5nIGFub3RoZXIgb3BlcmF0aW9uIG9uIHRoZSB0cmFuc2FjdGlvbi5cbiAqXG4gKiBOT1RFOiAudGhlbigpIGFuZCAuY2F0Y2goKSBvbmx5IGFsbG93IGEgc2luZ2xlIGNvbnN1bWVyLCB1bmxpa2Ugbm9ybWFsXG4gKiBQcm9taXNlcy5cbiAqLyBjbGFzcyBLcyB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICAvLyBOT1RFOiBuZXh0L2NhdGNoQ2FsbGJhY2sgd2lsbCBhbHdheXMgcG9pbnQgdG8gb3VyIG93biB3cmFwcGVyIGZ1bmN0aW9ucyxcbiAgICAgICAgLy8gbm90IHRoZSB1c2VyJ3MgcmF3IG5leHQoKSBvciBjYXRjaCgpIGNhbGxiYWNrcy5cbiAgICAgICAgdGhpcy5uZXh0Q2FsbGJhY2sgPSBudWxsLCB0aGlzLmNhdGNoQ2FsbGJhY2sgPSBudWxsLCBcbiAgICAgICAgLy8gV2hlbiB0aGUgb3BlcmF0aW9uIHJlc29sdmVzLCB3ZSdsbCBzZXQgcmVzdWx0IG9yIGVycm9yIGFuZCBtYXJrIGlzRG9uZS5cbiAgICAgICAgdGhpcy5yZXN1bHQgPSB2b2lkIDAsIHRoaXMuZXJyb3IgPSB2b2lkIDAsIHRoaXMuaXNEb25lID0gITEsIFxuICAgICAgICAvLyBTZXQgdG8gdHJ1ZSB3aGVuIC50aGVuKCkgb3IgLmNhdGNoKCkgYXJlIGNhbGxlZCBhbmQgcHJldmVudHMgYWRkaXRpb25hbFxuICAgICAgICAvLyBjaGFpbmluZy5cbiAgICAgICAgdGhpcy5jYWxsYmFja0F0dGFjaGVkID0gITEsIHQoKHQgPT4ge1xuICAgICAgICAgICAgdGhpcy5pc0RvbmUgPSAhMCwgdGhpcy5yZXN1bHQgPSB0LCB0aGlzLm5leHRDYWxsYmFjayAmJiBcbiAgICAgICAgICAgIC8vIHZhbHVlIHNob3VsZCBiZSBkZWZpbmVkIHVubGVzcyBUIGlzIFZvaWQsIGJ1dCB3ZSBjYW4ndCBleHByZXNzXG4gICAgICAgICAgICAvLyB0aGF0IGluIHRoZSB0eXBlIHN5c3RlbS5cbiAgICAgICAgICAgIHRoaXMubmV4dENhbGxiYWNrKHQpO1xuICAgICAgICB9KSwgKHQgPT4ge1xuICAgICAgICAgICAgdGhpcy5pc0RvbmUgPSAhMCwgdGhpcy5lcnJvciA9IHQsIHRoaXMuY2F0Y2hDYWxsYmFjayAmJiB0aGlzLmNhdGNoQ2FsbGJhY2sodCk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgY2F0Y2godCkge1xuICAgICAgICByZXR1cm4gdGhpcy5uZXh0KHZvaWQgMCwgdCk7XG4gICAgfVxuICAgIG5leHQodCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5jYWxsYmFja0F0dGFjaGVkICYmIE0oKSwgdGhpcy5jYWxsYmFja0F0dGFjaGVkID0gITAsIHRoaXMuaXNEb25lID8gdGhpcy5lcnJvciA/IHRoaXMud3JhcEZhaWx1cmUoZSwgdGhpcy5lcnJvcikgOiB0aGlzLndyYXBTdWNjZXNzKHQsIHRoaXMucmVzdWx0KSA6IG5ldyBLcygoKG4sIHMpID0+IHtcbiAgICAgICAgICAgIHRoaXMubmV4dENhbGxiYWNrID0gZSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy53cmFwU3VjY2Vzcyh0LCBlKS5uZXh0KG4sIHMpO1xuICAgICAgICAgICAgfSwgdGhpcy5jYXRjaENhbGxiYWNrID0gdCA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy53cmFwRmFpbHVyZShlLCB0KS5uZXh0KG4sIHMpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b1Byb21pc2UoKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgoKHQsIGUpID0+IHtcbiAgICAgICAgICAgIHRoaXMubmV4dCh0LCBlKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB3cmFwVXNlckZ1bmN0aW9uKHQpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0KCk7XG4gICAgICAgICAgICByZXR1cm4gZSBpbnN0YW5jZW9mIEtzID8gZSA6IEtzLnJlc29sdmUoZSk7XG4gICAgICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgICAgIHJldHVybiBLcy5yZWplY3QodCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgd3JhcFN1Y2Nlc3ModCwgZSkge1xuICAgICAgICByZXR1cm4gdCA/IHRoaXMud3JhcFVzZXJGdW5jdGlvbigoKCkgPT4gdChlKSkpIDogS3MucmVzb2x2ZShlKTtcbiAgICB9XG4gICAgd3JhcEZhaWx1cmUodCwgZSkge1xuICAgICAgICByZXR1cm4gdCA/IHRoaXMud3JhcFVzZXJGdW5jdGlvbigoKCkgPT4gdChlKSkpIDogS3MucmVqZWN0KGUpO1xuICAgIH1cbiAgICBzdGF0aWMgcmVzb2x2ZSh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgS3MoKChlLCBuKSA9PiB7XG4gICAgICAgICAgICBlKHQpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHN0YXRpYyByZWplY3QodCkge1xuICAgICAgICByZXR1cm4gbmV3IEtzKCgoZSwgbikgPT4ge1xuICAgICAgICAgICAgbih0KTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBzdGF0aWMgd2FpdEZvcihcbiAgICAvLyBBY2NlcHQgYWxsIFByb21pc2UgdHlwZXMgaW4gd2FpdEZvcigpLlxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgdCkge1xuICAgICAgICByZXR1cm4gbmV3IEtzKCgoZSwgbikgPT4ge1xuICAgICAgICAgICAgbGV0IHMgPSAwLCBpID0gMCwgciA9ICExO1xuICAgICAgICAgICAgdC5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgICAgICArK3MsIHQubmV4dCgoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICArK2ksIHIgJiYgaSA9PT0gcyAmJiBlKCk7XG4gICAgICAgICAgICAgICAgfSksICh0ID0+IG4odCkpKTtcbiAgICAgICAgICAgIH0pKSwgciA9ICEwLCBpID09PSBzICYmIGUoKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHaXZlbiBhbiBhcnJheSBvZiBwcmVkaWNhdGUgZnVuY3Rpb25zIHRoYXQgYXN5bmNocm9ub3VzbHkgZXZhbHVhdGUgdG8gYVxuICAgICAqIGJvb2xlYW4sIGltcGxlbWVudHMgYSBzaG9ydC1jaXJjdWl0aW5nIGBvcmAgYmV0d2VlbiB0aGUgcmVzdWx0cy4gUHJlZGljYXRlc1xuICAgICAqIHdpbGwgYmUgZXZhbHVhdGVkIHVudGlsIG9uZSBvZiB0aGVtIHJldHVybnMgYHRydWVgLCB0aGVuIHN0b3AuIFRoZSBmaW5hbFxuICAgICAqIHJlc3VsdCB3aWxsIGJlIHdoZXRoZXIgYW55IG9mIHRoZW0gcmV0dXJuZWQgYHRydWVgLlxuICAgICAqLyAgICBzdGF0aWMgb3IodCkge1xuICAgICAgICBsZXQgZSA9IEtzLnJlc29sdmUoITEpO1xuICAgICAgICBmb3IgKGNvbnN0IG4gb2YgdCkgZSA9IGUubmV4dCgodCA9PiB0ID8gS3MucmVzb2x2ZSh0KSA6IG4oKSkpO1xuICAgICAgICByZXR1cm4gZTtcbiAgICB9XG4gICAgc3RhdGljIGZvckVhY2godCwgZSkge1xuICAgICAgICBjb25zdCBuID0gW107XG4gICAgICAgIHJldHVybiB0LmZvckVhY2goKCh0LCBzKSA9PiB7XG4gICAgICAgICAgICBuLnB1c2goZS5jYWxsKHRoaXMsIHQsIHMpKTtcbiAgICAgICAgfSkpLCB0aGlzLndhaXRGb3Iobik7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLy8gUmVmZXJlbmNlcyB0byBgd2luZG93YCBhcmUgZ3VhcmRlZCBieSBTaW1wbGVEYi5pc0F2YWlsYWJsZSgpXG4vKiBlc2xpbnQtZGlzYWJsZSBuby1yZXN0cmljdGVkLWdsb2JhbHMgKi9cbi8qKlxuICogV3JhcHMgYW4gSURCVHJhbnNhY3Rpb24gYW5kIGV4cG9zZXMgYSBzdG9yZSgpIG1ldGhvZCB0byBnZXQgYSBoYW5kbGUgdG8gYVxuICogc3BlY2lmaWMgb2JqZWN0IHN0b3JlLlxuICovXG5jbGFzcyBqcyB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLmFjdGlvbiA9IHQsIHRoaXMudHJhbnNhY3Rpb24gPSBlLCB0aGlzLmFib3J0ZWQgPSAhMSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIGBQcm9taXNlYCB0aGF0IHJlc29sdmVzIHdpdGggdGhlIHJlc3VsdCBvZiB0aGUgSW5kZXhlZERiIHRyYW5zYWN0aW9uLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5UdCA9IG5ldyBqLCB0aGlzLnRyYW5zYWN0aW9uLm9uY29tcGxldGUgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLlR0LnJlc29sdmUoKTtcbiAgICAgICAgfSwgdGhpcy50cmFuc2FjdGlvbi5vbmFib3J0ID0gKCkgPT4ge1xuICAgICAgICAgICAgZS5lcnJvciA/IHRoaXMuVHQucmVqZWN0KG5ldyBHcyh0LCBlLmVycm9yKSkgOiB0aGlzLlR0LnJlc29sdmUoKTtcbiAgICAgICAgfSwgdGhpcy50cmFuc2FjdGlvbi5vbmVycm9yID0gZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuID0gWHMoZS50YXJnZXQuZXJyb3IpO1xuICAgICAgICAgICAgdGhpcy5UdC5yZWplY3QobmV3IEdzKHQsIG4pKTtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgc3RhdGljIG9wZW4odCwgZSwgbiwgcykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBqcyhlLCB0LnRyYW5zYWN0aW9uKHMsIG4pKTtcbiAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEdzKGUsIHQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldCBJdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuVHQucHJvbWlzZTtcbiAgICB9XG4gICAgYWJvcnQodCkge1xuICAgICAgICB0ICYmIHRoaXMuVHQucmVqZWN0KHQpLCB0aGlzLmFib3J0ZWQgfHwgKGsoXCJTaW1wbGVEYlwiLCBcIkFib3J0aW5nIHRyYW5zYWN0aW9uOlwiLCB0ID8gdC5tZXNzYWdlIDogXCJDbGllbnQtaW5pdGlhdGVkIGFib3J0XCIpLCBcbiAgICAgICAgdGhpcy5hYm9ydGVkID0gITAsIHRoaXMudHJhbnNhY3Rpb24uYWJvcnQoKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBTaW1wbGVEYlN0b3JlPEtleVR5cGUsIFZhbHVlVHlwZT4gZm9yIHRoZSBzcGVjaWZpZWQgc3RvcmUuIEFsbFxuICAgICAqIG9wZXJhdGlvbnMgcGVyZm9ybWVkIG9uIHRoZSBTaW1wbGVEYlN0b3JlIGhhcHBlbiB3aXRoaW4gdGhlIGNvbnRleHQgb2YgdGhpc1xuICAgICAqIHRyYW5zYWN0aW9uIGFuZCBpdCBjYW5ub3QgYmUgdXNlZCBhbnltb3JlIG9uY2UgdGhlIHRyYW5zYWN0aW9uIGlzXG4gICAgICogY29tcGxldGVkLlxuICAgICAqXG4gICAgICogTm90ZSB0aGF0IHdlIGNhbid0IGFjdHVhbGx5IGVuZm9yY2UgdGhhdCB0aGUgS2V5VHlwZSBhbmQgVmFsdWVUeXBlIGFyZVxuICAgICAqIGNvcnJlY3QsIGJ1dCB0aGV5IGFsbG93IHR5cGUgc2FmZXR5IHRocm91Z2ggdGhlIHJlc3Qgb2YgdGhlIGNvbnN1bWluZyBjb2RlLlxuICAgICAqLyAgICBzdG9yZSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLnRyYW5zYWN0aW9uLm9iamVjdFN0b3JlKHQpO1xuICAgICAgICByZXR1cm4gbmV3IEhzKGUpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBQcm92aWRlcyBhIHdyYXBwZXIgYXJvdW5kIEluZGV4ZWREYiB3aXRoIGEgc2ltcGxpZmllZCBpbnRlcmZhY2UgdGhhdCB1c2VzXG4gKiBQcm9taXNlLWxpa2UgcmV0dXJuIHZhbHVlcyB0byBjaGFpbiBvcGVyYXRpb25zLiBSZWFsIHByb21pc2VzIGNhbm5vdCBiZSB1c2VkXG4gKiBzaW5jZSAudGhlbigpIGNvbnRpbnVhdGlvbnMgYXJlIGV4ZWN1dGVkIGFzeW5jaHJvbm91c2x5IChlLmcuIHZpYVxuICogLnNldEltbWVkaWF0ZSksIHdoaWNoIHdvdWxkIGNhdXNlIEluZGV4ZWREQiB0byBlbmQgdGhlIHRyYW5zYWN0aW9uLlxuICogU2VlIFBlcnNpc3RlbmNlUHJvbWlzZSBmb3IgbW9yZSBkZXRhaWxzLlxuICovIGNsYXNzIFFzIHtcbiAgICAvKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgU2ltcGxlRGIgd3JhcHBlciBmb3IgSW5kZXhlZERiIGRhdGFiYXNlIGBuYW1lYC5cbiAgICAgKlxuICAgICAqIE5vdGUgdGhhdCBgdmVyc2lvbmAgbXVzdCBub3QgYmUgYSBkb3duZ3JhZGUuIEluZGV4ZWREQiBkb2VzIG5vdCBzdXBwb3J0XG4gICAgICogZG93bmdyYWRpbmcgdGhlIHNjaGVtYSB2ZXJzaW9uLiBXZSBjdXJyZW50bHkgZG8gbm90IHN1cHBvcnQgYW55IHdheSB0byBkb1xuICAgICAqIHZlcnNpb25pbmcgb3V0c2lkZSBvZiBJbmRleGVkREIncyB2ZXJzaW9uaW5nIG1lY2hhbmlzbSwgYXMgb25seVxuICAgICAqIHZlcnNpb24tdXBncmFkZSB0cmFuc2FjdGlvbnMgYXJlIGFsbG93ZWQgdG8gZG8gdGhpbmdzIGxpa2UgY3JlYXRlXG4gICAgICogb2JqZWN0c3RvcmVzLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4pIHtcbiAgICAgICAgdGhpcy5uYW1lID0gdCwgdGhpcy52ZXJzaW9uID0gZSwgdGhpcy5BdCA9IG47XG4gICAgICAgIC8vIE5PVEU6IEFjY29yZGluZyB0byBodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MTk3MDUwLCB0aGVcbiAgICAgICAgLy8gYnVnIHdlJ3JlIGNoZWNraW5nIGZvciBzaG91bGQgZXhpc3QgaW4gaU9TID49IDEyLjIgYW5kIDwgMTMsIGJ1dCBmb3JcbiAgICAgICAgLy8gd2hhdGV2ZXIgcmVhc29uIGl0J3MgbXVjaCBoYXJkZXIgdG8gaGl0IGFmdGVyIDEyLjIgc28gd2Ugb25seSBwcm9hY3RpdmVseVxuICAgICAgICAvLyBsb2cgb24gMTIuMi5cbiAgICAgICAgMTIuMiA9PT0gUXMuUnQodSgpKSAmJiAkKFwiRmlyZXN0b3JlIHBlcnNpc3RlbmNlIHN1ZmZlcnMgZnJvbSBhIGJ1ZyBpbiBpT1MgMTIuMiBTYWZhcmkgdGhhdCBtYXkgY2F1c2UgeW91ciBhcHAgdG8gc3RvcCB3b3JraW5nLiBTZWUgaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xLzU2NDk2Mjk2LzExMDkxNSBmb3IgZGV0YWlscyBhbmQgYSBwb3RlbnRpYWwgd29ya2Fyb3VuZC5cIik7XG4gICAgfVxuICAgIC8qKiBEZWxldGVzIHRoZSBzcGVjaWZpZWQgZGF0YWJhc2UuICovICAgIHN0YXRpYyBkZWxldGUodCkge1xuICAgICAgICByZXR1cm4gayhcIlNpbXBsZURiXCIsIFwiUmVtb3ZpbmcgZGF0YWJhc2U6XCIsIHQpLCBKcyh3aW5kb3cuaW5kZXhlZERCLmRlbGV0ZURhdGFiYXNlKHQpKS50b1Byb21pc2UoKTtcbiAgICB9XG4gICAgLyoqIFJldHVybnMgdHJ1ZSBpZiBJbmRleGVkREIgaXMgYXZhaWxhYmxlIGluIHRoZSBjdXJyZW50IGVudmlyb25tZW50LiAqLyAgICBzdGF0aWMgUHQoKSB7XG4gICAgICAgIGlmIChcInVuZGVmaW5lZFwiID09IHR5cGVvZiBpbmRleGVkREIpIHJldHVybiAhMTtcbiAgICAgICAgaWYgKFFzLmJ0KCkpIHJldHVybiAhMDtcbiAgICAgICAgLy8gV2UgZXh0ZW5zaXZlbHkgdXNlIGluZGV4ZWQgYXJyYXkgdmFsdWVzIGFuZCBjb21wb3VuZCBrZXlzLFxuICAgICAgICAvLyB3aGljaCBJRSBhbmQgRWRnZSBkbyBub3Qgc3VwcG9ydC4gSG93ZXZlciwgdGhleSBzdGlsbCBoYXZlIGluZGV4ZWREQlxuICAgICAgICAvLyBkZWZpbmVkIG9uIHRoZSB3aW5kb3csIHNvIHdlIG5lZWQgdG8gY2hlY2sgZm9yIHRoZW0gaGVyZSBhbmQgbWFrZSBzdXJlXG4gICAgICAgIC8vIHRvIHJldHVybiB0aGF0IHBlcnNpc3RlbmNlIGlzIG5vdCBlbmFibGVkIGZvciB0aG9zZSBicm93c2Vycy5cbiAgICAgICAgLy8gRm9yIHRyYWNraW5nIHN1cHBvcnQgb2YgdGhpcyBmZWF0dXJlLCBzZWUgaGVyZTpcbiAgICAgICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubWljcm9zb2Z0LmNvbS9lbi11cy9taWNyb3NvZnQtZWRnZS9wbGF0Zm9ybS9zdGF0dXMvaW5kZXhlZGRiYXJyYXlzYW5kbXVsdGllbnRyeXN1cHBvcnQvXG4gICAgICAgIC8vIENoZWNrIHRoZSBVQSBzdHJpbmcgdG8gZmluZCBvdXQgdGhlIGJyb3dzZXIuXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHUoKSwgZSA9IFFzLlJ0KHQpLCBuID0gMCA8IGUgJiYgZSA8IDEwLCBzID0gUXMudnQodCksIGkgPSAwIDwgcyAmJiBzIDwgNC41O1xuICAgICAgICAvLyBJRSAxMFxuICAgICAgICAvLyB1YSA9ICdNb3ppbGxhLzUuMCAoY29tcGF0aWJsZTsgTVNJRSAxMC4wOyBXaW5kb3dzIE5UIDYuMjsgVHJpZGVudC82LjApJztcbiAgICAgICAgLy8gSUUgMTFcbiAgICAgICAgLy8gdWEgPSAnTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4zOyBUcmlkZW50LzcuMDsgcnY6MTEuMCkgbGlrZSBHZWNrbyc7XG4gICAgICAgIC8vIEVkZ2VcbiAgICAgICAgLy8gdWEgPSAnTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV09XNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsXG4gICAgICAgIC8vIGxpa2UgR2Vja28pIENocm9tZS8zOS4wLjIxNzEuNzEgU2FmYXJpLzUzNy4zNiBFZGdlLzEyLjAnO1xuICAgICAgICAvLyBpT1MgU2FmYXJpOiBEaXNhYmxlIGZvciB1c2VycyBydW5uaW5nIGlPUyB2ZXJzaW9uIDwgMTAuXG4gICAgICAgICAgICAgICAgcmV0dXJuICEodC5pbmRleE9mKFwiTVNJRSBcIikgPiAwIHx8IHQuaW5kZXhPZihcIlRyaWRlbnQvXCIpID4gMCB8fCB0LmluZGV4T2YoXCJFZGdlL1wiKSA+IDAgfHwgbiB8fCBpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHRoZSBiYWNraW5nIEluZGV4ZWREQiBzdG9yZSBpcyB0aGUgTm9kZSBJbmRleGVkREJTaGltXG4gICAgICogKHNlZSBodHRwczovL2dpdGh1Yi5jb20vYXhlbWNsaW9uL0luZGV4ZWREQlNoaW0pLlxuICAgICAqLyAgICBzdGF0aWMgYnQoKSB7XG4gICAgICAgIHZhciB0O1xuICAgICAgICByZXR1cm4gXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgcHJvY2VzcyAmJiBcIllFU1wiID09PSAobnVsbCA9PT0gKHQgPSBwcm9jZXNzLmVudikgfHwgdm9pZCAwID09PSB0ID8gdm9pZCAwIDogdC5WdCk7XG4gICAgfVxuICAgIC8qKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmcm9tIGEgdHJhbnNhY3Rpb24uICovICAgIHN0YXRpYyBTdCh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0LnN0b3JlKGUpO1xuICAgIH1cbiAgICAvLyB2aXNpYmxlIGZvciB0ZXN0aW5nXG4gICAgLyoqIFBhcnNlIFVzZXIgQWdlbnQgdG8gZGV0ZXJtaW5lIGlPUyB2ZXJzaW9uLiBSZXR1cm5zIC0xIGlmIG5vdCBmb3VuZC4gKi9cbiAgICBzdGF0aWMgUnQodCkge1xuICAgICAgICBjb25zdCBlID0gdC5tYXRjaCgvaSg/OnBob25lfHBhZHxwb2QpIG9zIChbXFxkX10rKS9pKSwgbiA9IGUgPyBlWzFdLnNwbGl0KFwiX1wiKS5zbGljZSgwLCAyKS5qb2luKFwiLlwiKSA6IFwiLTFcIjtcbiAgICAgICAgcmV0dXJuIE51bWJlcihuKTtcbiAgICB9XG4gICAgLy8gdmlzaWJsZSBmb3IgdGVzdGluZ1xuICAgIC8qKiBQYXJzZSBVc2VyIEFnZW50IHRvIGRldGVybWluZSBBbmRyb2lkIHZlcnNpb24uIFJldHVybnMgLTEgaWYgbm90IGZvdW5kLiAqL1xuICAgIHN0YXRpYyB2dCh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0Lm1hdGNoKC9BbmRyb2lkIChbXFxkLl0rKS9pKSwgbiA9IGUgPyBlWzFdLnNwbGl0KFwiLlwiKS5zbGljZSgwLCAyKS5qb2luKFwiLlwiKSA6IFwiLTFcIjtcbiAgICAgICAgcmV0dXJuIE51bWJlcihuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogT3BlbnMgdGhlIHNwZWNpZmllZCBkYXRhYmFzZSwgY3JlYXRpbmcgb3IgdXBncmFkaW5nIGl0IGlmIG5lY2Vzc2FyeS5cbiAgICAgKi8gICAgYXN5bmMgRHQodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYiB8fCAoayhcIlNpbXBsZURiXCIsIFwiT3BlbmluZyBkYXRhYmFzZTpcIiwgdGhpcy5uYW1lKSwgdGhpcy5kYiA9IGF3YWl0IG5ldyBQcm9taXNlKCgoZSwgbikgPT4ge1xuICAgICAgICAgICAgLy8gVE9ETyhtaWtlbGVoZW4pOiBJbnZlc3RpZ2F0ZSBicm93c2VyIGNvbXBhdGliaWxpdHkuXG4gICAgICAgICAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvSW5kZXhlZERCX0FQSS9Vc2luZ19JbmRleGVkREJcbiAgICAgICAgICAgIC8vIHN1Z2dlc3RzIElFOSBhbmQgb2xkZXIgV2ViS2l0IGJyb3dzZXJzIGhhbmRsZSB1cGdyYWRlXG4gICAgICAgICAgICAvLyBkaWZmZXJlbnRseS4gVGhleSBleHBlY3Qgc2V0VmVyc2lvbiwgYXMgZGVzY3JpYmVkIGhlcmU6XG4gICAgICAgICAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvSURCVmVyc2lvbkNoYW5nZVJlcXVlc3Qvc2V0VmVyc2lvblxuICAgICAgICAgICAgY29uc3QgcyA9IGluZGV4ZWREQi5vcGVuKHRoaXMubmFtZSwgdGhpcy52ZXJzaW9uKTtcbiAgICAgICAgICAgIHMub25zdWNjZXNzID0gdCA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHQudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgICAgICAgICBlKG4pO1xuICAgICAgICAgICAgfSwgcy5vbmJsb2NrZWQgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgbihuZXcgR3ModCwgXCJDYW5ub3QgdXBncmFkZSBJbmRleGVkREIgc2NoZW1hIHdoaWxlIGFub3RoZXIgdGFiIGlzIG9wZW4uIENsb3NlIGFsbCB0YWJzIHRoYXQgYWNjZXNzIEZpcmVzdG9yZSBhbmQgcmVsb2FkIHRoaXMgcGFnZSB0byBwcm9jZWVkLlwiKSk7XG4gICAgICAgICAgICB9LCBzLm9uZXJyb3IgPSBlID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gZS50YXJnZXQuZXJyb3I7XG4gICAgICAgICAgICAgICAgXCJWZXJzaW9uRXJyb3JcIiA9PT0gcy5uYW1lID8gbihuZXcgSyhxLkZBSUxFRF9QUkVDT05ESVRJT04sIFwiQSBuZXdlciB2ZXJzaW9uIG9mIHRoZSBGaXJlc3RvcmUgU0RLIHdhcyBwcmV2aW91c2x5IHVzZWQgYW5kIHNvIHRoZSBwZXJzaXN0ZWQgZGF0YSBpcyBub3QgY29tcGF0aWJsZSB3aXRoIHRoZSB2ZXJzaW9uIG9mIHRoZSBTREsgeW91IGFyZSBub3cgdXNpbmcuIFRoZSBTREsgd2lsbCBvcGVyYXRlIHdpdGggcGVyc2lzdGVuY2UgZGlzYWJsZWQuIElmIHlvdSBuZWVkIHBlcnNpc3RlbmNlLCBwbGVhc2UgcmUtdXBncmFkZSB0byBhIG5ld2VyIHZlcnNpb24gb2YgdGhlIFNESyBvciBlbHNlIGNsZWFyIHRoZSBwZXJzaXN0ZWQgSW5kZXhlZERCIGRhdGEgZm9yIHlvdXIgYXBwIHRvIHN0YXJ0IGZyZXNoLlwiKSkgOiBuKG5ldyBHcyh0LCBzKSk7XG4gICAgICAgICAgICB9LCBzLm9udXBncmFkZW5lZWRlZCA9IHQgPT4ge1xuICAgICAgICAgICAgICAgIGsoXCJTaW1wbGVEYlwiLCAnRGF0YWJhc2UgXCInICsgdGhpcy5uYW1lICsgJ1wiIHJlcXVpcmVzIHVwZ3JhZGUgZnJvbSB2ZXJzaW9uOicsIHQub2xkVmVyc2lvbik7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgICAgICAgICB0aGlzLkF0LkN0KGUsIHMudHJhbnNhY3Rpb24sIHQub2xkVmVyc2lvbiwgdGhpcy52ZXJzaW9uKS5uZXh0KCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGsoXCJTaW1wbGVEYlwiLCBcIkRhdGFiYXNlIHVwZ3JhZGUgdG8gdmVyc2lvbiBcIiArIHRoaXMudmVyc2lvbiArIFwiIGNvbXBsZXRlXCIpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pKSksIHRoaXMuTnQgJiYgKHRoaXMuZGIub252ZXJzaW9uY2hhbmdlID0gdCA9PiB0aGlzLk50KHQpKSwgdGhpcy5kYjtcbiAgICB9XG4gICAgeHQodCkge1xuICAgICAgICB0aGlzLk50ID0gdCwgdGhpcy5kYiAmJiAodGhpcy5kYi5vbnZlcnNpb25jaGFuZ2UgPSBlID0+IHQoZSkpO1xuICAgIH1cbiAgICBhc3luYyBydW5UcmFuc2FjdGlvbih0LCBlLCBuLCBzKSB7XG4gICAgICAgIGNvbnN0IGkgPSBcInJlYWRvbmx5XCIgPT09IGU7XG4gICAgICAgIGxldCByID0gMDtcbiAgICAgICAgZm9yICg7Oykge1xuICAgICAgICAgICAgKytyO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0aGlzLmRiID0gYXdhaXQgdGhpcy5EdCh0KTtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0ganMub3Blbih0aGlzLmRiLCB0LCBpID8gXCJyZWFkb25seVwiIDogXCJyZWFkd3JpdGVcIiwgbiksIHIgPSBzKGUpLmNhdGNoKCh0ID0+IChcbiAgICAgICAgICAgICAgICAvLyBBYm9ydCB0aGUgdHJhbnNhY3Rpb24gaWYgdGhlcmUgd2FzIGFuIGVycm9yLlxuICAgICAgICAgICAgICAgIGUuYWJvcnQodCksIEtzLnJlamVjdCh0KSkpKS50b1Byb21pc2UoKTtcbiAgICAgICAgICAgICAgICAvLyBBcyBub3RlZCBhYm92ZSwgZXJyb3JzIGFyZSBwcm9wYWdhdGVkIGJ5IGFib3J0aW5nIHRoZSB0cmFuc2FjdGlvbi4gU29cbiAgICAgICAgICAgICAgICAvLyB3ZSBzd2FsbG93IGFueSBlcnJvciBoZXJlIHRvIGF2b2lkIHRoZSBicm93c2VyIGxvZ2dpbmcgaXQgYXMgdW5oYW5kbGVkLlxuICAgICAgICAgICAgICAgIHJldHVybiByLmNhdGNoKCgoKSA9PiB7fSkpLCBcbiAgICAgICAgICAgICAgICAvLyBXYWl0IGZvciB0aGUgdHJhbnNhY3Rpb24gdG8gY29tcGxldGUgKGkuZS4gSW5kZXhlZERiJ3Mgb25zdWNjZXNzIGV2ZW50IHRvXG4gICAgICAgICAgICAgICAgLy8gZmlyZSksIGJ1dCBzdGlsbCByZXR1cm4gdGhlIG9yaWdpbmFsIHRyYW5zYWN0aW9uRm5SZXN1bHQgYmFjayB0byB0aGVcbiAgICAgICAgICAgICAgICAvLyBjYWxsZXIuXG4gICAgICAgICAgICAgICAgYXdhaXQgZS5JdCwgcjtcbiAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgICAgICAgICAvLyBUT0RPKHNjaG1pZHQtc2ViYXN0aWFuKTogV2UgY291bGQgcHJvYmFibHkgYmUgc21hcnRlciBhYm91dCB0aGlzIGFuZFxuICAgICAgICAgICAgICAgIC8vIG5vdCByZXRyeSBleGNlcHRpb25zIHRoYXQgYXJlIGxpa2VseSB1bnJlY292ZXJhYmxlIChzdWNoIGFzIHF1b3RhXG4gICAgICAgICAgICAgICAgLy8gZXhjZWVkZWQgZXJyb3JzKS5cbiAgICAgICAgICAgICAgICAvLyBOb3RlOiBXZSBjYW5ub3QgdXNlIGFuIGluc3RhbmNlb2YgY2hlY2sgZm9yIEZpcmVzdG9yZUV4Y2VwdGlvbiwgc2luY2UgdGhlXG4gICAgICAgICAgICAgICAgLy8gZXhjZXB0aW9uIGlzIHdyYXBwZWQgaW4gYSBnZW5lcmljIGVycm9yIGJ5IG91ciBhc3luYy9hd2FpdCBoYW5kbGluZy5cbiAgICAgICAgICAgICAgICBjb25zdCBlID0gXCJGaXJlYmFzZUVycm9yXCIgIT09IHQubmFtZSAmJiByIDwgMztcbiAgICAgICAgICAgICAgICBpZiAoayhcIlNpbXBsZURiXCIsIFwiVHJhbnNhY3Rpb24gZmFpbGVkIHdpdGggZXJyb3I6XCIsIHQubWVzc2FnZSwgXCJSZXRyeWluZzpcIiwgZSksIFxuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKSwgIWUpIHJldHVybiBQcm9taXNlLnJlamVjdCh0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgdGhpcy5kYiAmJiB0aGlzLmRiLmNsb3NlKCksIHRoaXMuZGIgPSB2b2lkIDA7XG4gICAgfVxufVxuXG4vKipcbiAqIEEgY29udHJvbGxlciBmb3IgaXRlcmF0aW5nIG92ZXIgYSBrZXkgcmFuZ2Ugb3IgaW5kZXguIEl0IGFsbG93cyBhbiBpdGVyYXRlXG4gKiBjYWxsYmFjayB0byBkZWxldGUgdGhlIGN1cnJlbnRseS1yZWZlcmVuY2VkIG9iamVjdCwgb3IganVtcCB0byBhIG5ldyBrZXlcbiAqIHdpdGhpbiB0aGUga2V5IHJhbmdlIG9yIGluZGV4LlxuICovIGNsYXNzIFdzIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMua3QgPSB0LCB0aGlzLiR0ID0gITEsIHRoaXMuT3QgPSBudWxsO1xuICAgIH1cbiAgICBnZXQgaXNEb25lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy4kdDtcbiAgICB9XG4gICAgZ2V0IEZ0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5PdDtcbiAgICB9XG4gICAgc2V0IGN1cnNvcih0KSB7XG4gICAgICAgIHRoaXMua3QgPSB0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGlzIGZ1bmN0aW9uIGNhbiBiZSBjYWxsZWQgdG8gc3RvcCBpdGVyYXRpb24gYXQgYW55IHBvaW50LlxuICAgICAqLyAgICBkb25lKCkge1xuICAgICAgICB0aGlzLiR0ID0gITA7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoaXMgZnVuY3Rpb24gY2FuIGJlIGNhbGxlZCB0byBza2lwIHRvIHRoYXQgbmV4dCBrZXksIHdoaWNoIGNvdWxkIGJlXG4gICAgICogYW4gaW5kZXggb3IgYSBwcmltYXJ5IGtleS5cbiAgICAgKi8gICAgTXQodCkge1xuICAgICAgICB0aGlzLk90ID0gdDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRGVsZXRlIHRoZSBjdXJyZW50IGN1cnNvciB2YWx1ZSBmcm9tIHRoZSBvYmplY3Qgc3RvcmUuXG4gICAgICpcbiAgICAgKiBOT1RFOiBZb3UgQ0FOTk9UIGRvIHRoaXMgd2l0aCBhIGtleXNPbmx5IHF1ZXJ5LlxuICAgICAqLyAgICBkZWxldGUoKSB7XG4gICAgICAgIHJldHVybiBKcyh0aGlzLmt0LmRlbGV0ZSgpKTtcbiAgICB9XG59XG5cbi8qKiBBbiBlcnJvciB0aGF0IHdyYXBzIGV4Y2VwdGlvbnMgdGhhdCB0aHJvd24gZHVyaW5nIEluZGV4ZWREQiBleGVjdXRpb24uICovIGNsYXNzIEdzIGV4dGVuZHMgSyB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICBzdXBlcihxLlVOQVZBSUxBQkxFLCBgSW5kZXhlZERCIHRyYW5zYWN0aW9uICcke3R9JyBmYWlsZWQ6ICR7ZX1gKSwgdGhpcy5uYW1lID0gXCJJbmRleGVkRGJUcmFuc2FjdGlvbkVycm9yXCI7XG4gICAgfVxufVxuXG4vKiogVmVyaWZpZXMgd2hldGhlciBgZWAgaXMgYW4gSW5kZXhlZERiVHJhbnNhY3Rpb25FcnJvci4gKi8gZnVuY3Rpb24genModCkge1xuICAgIC8vIFVzZSBuYW1lIGVxdWFsaXR5LCBhcyBpbnN0YW5jZW9mIGNoZWNrcyBvbiBlcnJvcnMgZG9uJ3Qgd29yayB3aXRoIGVycm9yc1xuICAgIC8vIHRoYXQgd3JhcCBvdGhlciBlcnJvcnMuXG4gICAgcmV0dXJuIFwiSW5kZXhlZERiVHJhbnNhY3Rpb25FcnJvclwiID09PSB0Lm5hbWU7XG59XG5cbi8qKlxuICogQSB3cmFwcGVyIGFyb3VuZCBhbiBJREJPYmplY3RTdG9yZSBwcm92aWRpbmcgYW4gQVBJIHRoYXQ6XG4gKlxuICogMSkgSGFzIGdlbmVyaWMgS2V5VHlwZSAvIFZhbHVlVHlwZSBwYXJhbWV0ZXJzIHRvIHByb3ZpZGUgc3Ryb25nbHktdHlwZWRcbiAqIG1ldGhvZHMgZm9yIGFjdGluZyBhZ2FpbnN0IHRoZSBvYmplY3Qgc3RvcmUuXG4gKiAyKSBEZWFscyB3aXRoIEluZGV4ZWREQidzIG9uc3VjY2VzcyAvIG9uZXJyb3IgZXZlbnQgY2FsbGJhY2tzLCBtYWtpbmcgZXZlcnlcbiAqIG1ldGhvZCByZXR1cm4gYSBQZXJzaXN0ZW5jZVByb21pc2UgaW5zdGVhZC5cbiAqIDMpIFByb3ZpZGVzIGEgaGlnaGVyLWxldmVsIEFQSSB0byBhdm9pZCBuZWVkaW5nIHRvIGRvIGV4Y2Vzc2l2ZSB3cmFwcGluZyBvZlxuICogaW50ZXJtZWRpYXRlIEluZGV4ZWREQiB0eXBlcyAoSURCQ3Vyc29yV2l0aFZhbHVlLCBldGMuKVxuICovIGNsYXNzIEhzIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMuc3RvcmUgPSB0O1xuICAgIH1cbiAgICBwdXQodCwgZSkge1xuICAgICAgICBsZXQgbjtcbiAgICAgICAgcmV0dXJuIHZvaWQgMCAhPT0gZSA/IChrKFwiU2ltcGxlRGJcIiwgXCJQVVRcIiwgdGhpcy5zdG9yZS5uYW1lLCB0LCBlKSwgbiA9IHRoaXMuc3RvcmUucHV0KGUsIHQpKSA6IChrKFwiU2ltcGxlRGJcIiwgXCJQVVRcIiwgdGhpcy5zdG9yZS5uYW1lLCBcIjxhdXRvLWtleT5cIiwgdCksIFxuICAgICAgICBuID0gdGhpcy5zdG9yZS5wdXQodCkpLCBKcyhuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkcyBhIG5ldyB2YWx1ZSBpbnRvIGFuIE9iamVjdCBTdG9yZSBhbmQgcmV0dXJucyB0aGUgbmV3IGtleS4gU2ltaWxhciB0b1xuICAgICAqIEluZGV4ZWREYidzIGBhZGQoKWAsIHRoaXMgbWV0aG9kIHdpbGwgZmFpbCBvbiBwcmltYXJ5IGtleSBjb2xsaXNpb25zLlxuICAgICAqXG4gICAgICogQHBhcmFtIHZhbHVlIC0gVGhlIG9iamVjdCB0byB3cml0ZS5cbiAgICAgKiBAcmV0dXJucyBUaGUga2V5IG9mIHRoZSB2YWx1ZSB0byBhZGQuXG4gICAgICovICAgIGFkZCh0KSB7XG4gICAgICAgIGsoXCJTaW1wbGVEYlwiLCBcIkFERFwiLCB0aGlzLnN0b3JlLm5hbWUsIHQsIHQpO1xuICAgICAgICByZXR1cm4gSnModGhpcy5zdG9yZS5hZGQodCkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBvYmplY3Qgd2l0aCB0aGUgc3BlY2lmaWVkIGtleSBmcm9tIHRoZSBzcGVjaWZpZWQgc3RvcmUsIG9yIG51bGxcbiAgICAgKiBpZiBubyBvYmplY3QgZXhpc3RzIHdpdGggdGhlIHNwZWNpZmllZCBrZXkuXG4gICAgICpcbiAgICAgKiBAa2V5IFRoZSBrZXkgb2YgdGhlIG9iamVjdCB0byBnZXQuXG4gICAgICogQHJldHVybnMgVGhlIG9iamVjdCB3aXRoIHRoZSBzcGVjaWZpZWQga2V5IG9yIG51bGwgaWYgbm8gb2JqZWN0IGV4aXN0cy5cbiAgICAgKi8gICAgZ2V0KHQpIHtcbiAgICAgICAgLy8gV2UncmUgZG9pbmcgYW4gdW5zYWZlIGNhc3QgdG8gVmFsdWVUeXBlLlxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICByZXR1cm4gSnModGhpcy5zdG9yZS5nZXQodCkpLm5leHQoKGUgPT4gKFxuICAgICAgICAvLyBOb3JtYWxpemUgbm9uZXhpc3RlbmNlIHRvIG51bGwuXG4gICAgICAgIHZvaWQgMCA9PT0gZSAmJiAoZSA9IG51bGwpLCBrKFwiU2ltcGxlRGJcIiwgXCJHRVRcIiwgdGhpcy5zdG9yZS5uYW1lLCB0LCBlKSwgZSkpKTtcbiAgICB9XG4gICAgZGVsZXRlKHQpIHtcbiAgICAgICAgayhcIlNpbXBsZURiXCIsIFwiREVMRVRFXCIsIHRoaXMuc3RvcmUubmFtZSwgdCk7XG4gICAgICAgIHJldHVybiBKcyh0aGlzLnN0b3JlLmRlbGV0ZSh0KSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIElmIHdlIGV2ZXIgbmVlZCBtb3JlIG9mIHRoZSBjb3VudCB2YXJpYW50cywgd2UgY2FuIGFkZCBvdmVybG9hZHMuIEZvciBub3csXG4gICAgICogYWxsIHdlIG5lZWQgaXMgdG8gY291bnQgZXZlcnl0aGluZyBpbiBhIHN0b3JlLlxuICAgICAqXG4gICAgICogUmV0dXJucyB0aGUgbnVtYmVyIG9mIHJvd3MgaW4gdGhlIHN0b3JlLlxuICAgICAqLyAgICBjb3VudCgpIHtcbiAgICAgICAgayhcIlNpbXBsZURiXCIsIFwiQ09VTlRcIiwgdGhpcy5zdG9yZS5uYW1lKTtcbiAgICAgICAgcmV0dXJuIEpzKHRoaXMuc3RvcmUuY291bnQoKSk7XG4gICAgfVxuICAgIEx0KHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMuY3Vyc29yKHRoaXMub3B0aW9ucyh0LCBlKSksIHMgPSBbXTtcbiAgICAgICAgcmV0dXJuIHRoaXMuQnQobiwgKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICBzLnB1c2goZSk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBzKSk7XG4gICAgfVxuICAgIFV0KHQsIGUpIHtcbiAgICAgICAgayhcIlNpbXBsZURiXCIsIFwiREVMRVRFIEFMTFwiLCB0aGlzLnN0b3JlLm5hbWUpO1xuICAgICAgICBjb25zdCBuID0gdGhpcy5vcHRpb25zKHQsIGUpO1xuICAgICAgICBuLnF0ID0gITE7XG4gICAgICAgIGNvbnN0IHMgPSB0aGlzLmN1cnNvcihuKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuQnQocywgKCh0LCBlLCBuKSA9PiBuLmRlbGV0ZSgpKSk7XG4gICAgfVxuICAgIEt0KHQsIGUpIHtcbiAgICAgICAgbGV0IG47XG4gICAgICAgIGUgPyBuID0gdCA6IChuID0ge30sIGUgPSB0KTtcbiAgICAgICAgY29uc3QgcyA9IHRoaXMuY3Vyc29yKG4pO1xuICAgICAgICByZXR1cm4gdGhpcy5CdChzLCBlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSXRlcmF0ZXMgb3ZlciBhIHN0b3JlLCBidXQgd2FpdHMgZm9yIHRoZSBnaXZlbiBjYWxsYmFjayB0byBjb21wbGV0ZSBmb3JcbiAgICAgKiBlYWNoIGVudHJ5IGJlZm9yZSBpdGVyYXRpbmcgdGhlIG5leHQgZW50cnkuIFRoaXMgYWxsb3dzIHRoZSBjYWxsYmFjayB0byBkb1xuICAgICAqIGFzeW5jaHJvbm91cyB3b3JrIHRvIGRldGVybWluZSBpZiB0aGlzIGl0ZXJhdGlvbiBzaG91bGQgY29udGludWUuXG4gICAgICpcbiAgICAgKiBUaGUgcHJvdmlkZWQgY2FsbGJhY2sgc2hvdWxkIHJldHVybiBgdHJ1ZWAgdG8gY29udGludWUgaXRlcmF0aW9uLCBhbmRcbiAgICAgKiBgZmFsc2VgIG90aGVyd2lzZS5cbiAgICAgKi8gICAganQodCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5jdXJzb3Ioe30pO1xuICAgICAgICByZXR1cm4gbmV3IEtzKCgobiwgcykgPT4ge1xuICAgICAgICAgICAgZS5vbmVycm9yID0gdCA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IFhzKHQudGFyZ2V0LmVycm9yKTtcbiAgICAgICAgICAgICAgICBzKGUpO1xuICAgICAgICAgICAgfSwgZS5vbnN1Y2Nlc3MgPSBlID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gZS50YXJnZXQucmVzdWx0O1xuICAgICAgICAgICAgICAgIHMgPyB0KHMucHJpbWFyeUtleSwgcy52YWx1ZSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHQgPyBzLmNvbnRpbnVlKCkgOiBuKCk7XG4gICAgICAgICAgICAgICAgfSkpIDogbigpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBCdCh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBbXTtcbiAgICAgICAgcmV0dXJuIG5ldyBLcygoKHMsIGkpID0+IHtcbiAgICAgICAgICAgIHQub25lcnJvciA9IHQgPT4ge1xuICAgICAgICAgICAgICAgIGkodC50YXJnZXQuZXJyb3IpO1xuICAgICAgICAgICAgfSwgdC5vbnN1Y2Nlc3MgPSB0ID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdC50YXJnZXQucmVzdWx0O1xuICAgICAgICAgICAgICAgIGlmICghaSkgcmV0dXJuIHZvaWQgcygpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBuZXcgV3MoaSksIG8gPSBlKGkucHJpbWFyeUtleSwgaS52YWx1ZSwgcik7XG4gICAgICAgICAgICAgICAgaWYgKG8gaW5zdGFuY2VvZiBLcykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gby5jYXRjaCgodCA9PiAoci5kb25lKCksIEtzLnJlamVjdCh0KSkpKTtcbiAgICAgICAgICAgICAgICAgICAgbi5wdXNoKHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByLmlzRG9uZSA/IHMoKSA6IG51bGwgPT09IHIuRnQgPyBpLmNvbnRpbnVlKCkgOiBpLmNvbnRpbnVlKHIuRnQpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IEtzLndhaXRGb3IobikpKTtcbiAgICB9XG4gICAgb3B0aW9ucyh0LCBlKSB7XG4gICAgICAgIGxldCBuO1xuICAgICAgICByZXR1cm4gdm9pZCAwICE9PSB0ICYmIChcInN0cmluZ1wiID09IHR5cGVvZiB0ID8gbiA9IHQgOiBlID0gdCksIHtcbiAgICAgICAgICAgIGluZGV4OiBuLFxuICAgICAgICAgICAgcmFuZ2U6IGVcbiAgICAgICAgfTtcbiAgICB9XG4gICAgY3Vyc29yKHQpIHtcbiAgICAgICAgbGV0IGUgPSBcIm5leHRcIjtcbiAgICAgICAgaWYgKHQucmV2ZXJzZSAmJiAoZSA9IFwicHJldlwiKSwgdC5pbmRleCkge1xuICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuc3RvcmUuaW5kZXgodC5pbmRleCk7XG4gICAgICAgICAgICByZXR1cm4gdC5xdCA/IG4ub3BlbktleUN1cnNvcih0LnJhbmdlLCBlKSA6IG4ub3BlbkN1cnNvcih0LnJhbmdlLCBlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5zdG9yZS5vcGVuQ3Vyc29yKHQucmFuZ2UsIGUpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBXcmFwcyBhbiBJREJSZXF1ZXN0IGluIGEgUGVyc2lzdGVuY2VQcm9taXNlLCB1c2luZyB0aGUgb25zdWNjZXNzIC8gb25lcnJvclxuICogaGFuZGxlcnMgdG8gcmVzb2x2ZSAvIHJlamVjdCB0aGUgUGVyc2lzdGVuY2VQcm9taXNlIGFzIGFwcHJvcHJpYXRlLlxuICovIGZ1bmN0aW9uIEpzKHQpIHtcbiAgICByZXR1cm4gbmV3IEtzKCgoZSwgbikgPT4ge1xuICAgICAgICB0Lm9uc3VjY2VzcyA9IHQgPT4ge1xuICAgICAgICAgICAgY29uc3QgbiA9IHQudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgICAgIGUobik7XG4gICAgICAgIH0sIHQub25lcnJvciA9IHQgPT4ge1xuICAgICAgICAgICAgY29uc3QgZSA9IFhzKHQudGFyZ2V0LmVycm9yKTtcbiAgICAgICAgICAgIG4oZSk7XG4gICAgICAgIH07XG4gICAgfSkpO1xufVxuXG4vLyBHdWFyZCBzbyB3ZSBvbmx5IHJlcG9ydCB0aGUgZXJyb3Igb25jZS5cbmxldCBZcyA9ICExO1xuXG5mdW5jdGlvbiBYcyh0KSB7XG4gICAgY29uc3QgZSA9IFFzLlJ0KHUoKSk7XG4gICAgaWYgKGUgPj0gMTIuMiAmJiBlIDwgMTMpIHtcbiAgICAgICAgY29uc3QgZSA9IFwiQW4gaW50ZXJuYWwgZXJyb3Igd2FzIGVuY291bnRlcmVkIGluIHRoZSBJbmRleGVkIERhdGFiYXNlIHNlcnZlclwiO1xuICAgICAgICBpZiAodC5tZXNzYWdlLmluZGV4T2YoZSkgPj0gMCkge1xuICAgICAgICAgICAgLy8gV3JhcCBlcnJvciBpbiBhIG1vcmUgZGVzY3JpcHRpdmUgb25lLlxuICAgICAgICAgICAgY29uc3QgdCA9IG5ldyBLKFwiaW50ZXJuYWxcIiwgYElPU19JTkRFWEVEREJfQlVHMTogSW5kZXhlZERiIGhhcyB0aHJvd24gJyR7ZX0nLiBUaGlzIGlzIGxpa2VseSBkdWUgdG8gYW4gdW5hdm9pZGFibGUgYnVnIGluIGlPUy4gU2VlIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcS81NjQ5NjI5Ni8xMTA5MTUgZm9yIGRldGFpbHMgYW5kIGEgcG90ZW50aWFsIHdvcmthcm91bmQuYCk7XG4gICAgICAgICAgICByZXR1cm4gWXMgfHwgKFlzID0gITAsIFxuICAgICAgICAgICAgLy8gVGhyb3cgYSBnbG9iYWwgZXhjZXB0aW9uIG91dHNpZGUgb2YgdGhpcyBwcm9taXNlIGNoYWluLCBmb3IgdGhlIHVzZXIgdG9cbiAgICAgICAgICAgIC8vIHBvdGVudGlhbGx5IGNhdGNoLlxuICAgICAgICAgICAgc2V0VGltZW91dCgoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRocm93IHQ7XG4gICAgICAgICAgICB9KSwgMCkpLCB0O1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0O1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjbGFzcyBacyBleHRlbmRzIHFzIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMuUXQgPSB0LCB0aGlzLmN1cnJlbnRTZXF1ZW5jZU51bWJlciA9IGU7XG4gICAgfVxufVxuXG5mdW5jdGlvbiB0aSh0LCBlKSB7XG4gICAgY29uc3QgbiA9IFUodCk7XG4gICAgcmV0dXJuIFFzLlN0KG4uUXQsIGUpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBIGJhdGNoIG9mIG11dGF0aW9ucyB0aGF0IHdpbGwgYmUgc2VudCBhcyBvbmUgdW5pdCB0byB0aGUgYmFja2VuZC5cbiAqLyBjbGFzcyBlaSB7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIGJhdGNoSWQgLSBUaGUgdW5pcXVlIElEIG9mIHRoaXMgbXV0YXRpb24gYmF0Y2guXG4gICAgICogQHBhcmFtIGxvY2FsV3JpdGVUaW1lIC0gVGhlIG9yaWdpbmFsIHdyaXRlIHRpbWUgb2YgdGhpcyBtdXRhdGlvbi5cbiAgICAgKiBAcGFyYW0gYmFzZU11dGF0aW9ucyAtIE11dGF0aW9ucyB0aGF0IGFyZSB1c2VkIHRvIHBvcHVsYXRlIHRoZSBiYXNlXG4gICAgICogdmFsdWVzIHdoZW4gdGhpcyBtdXRhdGlvbiBpcyBhcHBsaWVkIGxvY2FsbHkuIFRoaXMgY2FuIGJlIHVzZWQgdG8gbG9jYWxseVxuICAgICAqIG92ZXJ3cml0ZSB2YWx1ZXMgdGhhdCBhcmUgcGVyc2lzdGVkIGluIHRoZSByZW1vdGUgZG9jdW1lbnQgY2FjaGUuIEJhc2VcbiAgICAgKiBtdXRhdGlvbnMgYXJlIG5ldmVyIHNlbnQgdG8gdGhlIGJhY2tlbmQuXG4gICAgICogQHBhcmFtIG11dGF0aW9ucyAtIFRoZSB1c2VyLXByb3ZpZGVkIG11dGF0aW9ucyBpbiB0aGlzIG11dGF0aW9uIGJhdGNoLlxuICAgICAqIFVzZXItcHJvdmlkZWQgbXV0YXRpb25zIGFyZSBhcHBsaWVkIGJvdGggbG9jYWxseSBhbmQgcmVtb3RlbHkgb24gdGhlXG4gICAgICogYmFja2VuZC5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzKSB7XG4gICAgICAgIHRoaXMuYmF0Y2hJZCA9IHQsIHRoaXMubG9jYWxXcml0ZVRpbWUgPSBlLCB0aGlzLmJhc2VNdXRhdGlvbnMgPSBuLCB0aGlzLm11dGF0aW9ucyA9IHM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFwcGxpZXMgYWxsIHRoZSBtdXRhdGlvbnMgaW4gdGhpcyBNdXRhdGlvbkJhdGNoIHRvIHRoZSBzcGVjaWZpZWQgZG9jdW1lbnRcbiAgICAgKiB0byBjb21wdXRlIHRoZSBzdGF0ZSBvZiB0aGUgcmVtb3RlIGRvY3VtZW50XG4gICAgICpcbiAgICAgKiBAcGFyYW0gZG9jdW1lbnQgLSBUaGUgZG9jdW1lbnQgdG8gYXBwbHkgbXV0YXRpb25zIHRvLlxuICAgICAqIEBwYXJhbSBiYXRjaFJlc3VsdCAtIFRoZSByZXN1bHQgb2YgYXBwbHlpbmcgdGhlIE11dGF0aW9uQmF0Y2ggdG8gdGhlXG4gICAgICogYmFja2VuZC5cbiAgICAgKi8gICAgYXBwbHlUb1JlbW90ZURvY3VtZW50KHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IGUubXV0YXRpb25SZXN1bHRzO1xuICAgICAgICBmb3IgKGxldCBlID0gMDsgZSA8IHRoaXMubXV0YXRpb25zLmxlbmd0aDsgZSsrKSB7XG4gICAgICAgICAgICBjb25zdCBzID0gdGhpcy5tdXRhdGlvbnNbZV07XG4gICAgICAgICAgICBpZiAocy5rZXkuaXNFcXVhbCh0LmtleSkpIHtcbiAgICAgICAgICAgICAgICBIZShzLCB0LCBuW2VdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb21wdXRlcyB0aGUgbG9jYWwgdmlldyBvZiBhIGRvY3VtZW50IGdpdmVuIGFsbCB0aGUgbXV0YXRpb25zIGluIHRoaXNcbiAgICAgKiBiYXRjaC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBkb2N1bWVudCAtIFRoZSBkb2N1bWVudCB0byBhcHBseSBtdXRhdGlvbnMgdG8uXG4gICAgICovICAgIGFwcGx5VG9Mb2NhbFZpZXcodCkge1xuICAgICAgICAvLyBGaXJzdCwgYXBwbHkgdGhlIGJhc2Ugc3RhdGUuIFRoaXMgYWxsb3dzIHVzIHRvIGFwcGx5IG5vbi1pZGVtcG90ZW50XG4gICAgICAgIC8vIHRyYW5zZm9ybSBhZ2FpbnN0IGEgY29uc2lzdGVudCBzZXQgb2YgdmFsdWVzLlxuICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdGhpcy5iYXNlTXV0YXRpb25zKSBlLmtleS5pc0VxdWFsKHQua2V5KSAmJiBKZShlLCB0LCB0aGlzLmxvY2FsV3JpdGVUaW1lKTtcbiAgICAgICAgLy8gU2Vjb25kLCBhcHBseSBhbGwgdXNlci1wcm92aWRlZCBtdXRhdGlvbnMuXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHRoaXMubXV0YXRpb25zKSBlLmtleS5pc0VxdWFsKHQua2V5KSAmJiBKZShlLCB0LCB0aGlzLmxvY2FsV3JpdGVUaW1lKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29tcHV0ZXMgdGhlIGxvY2FsIHZpZXcgZm9yIGFsbCBwcm92aWRlZCBkb2N1bWVudHMgZ2l2ZW4gdGhlIG11dGF0aW9ucyBpblxuICAgICAqIHRoaXMgYmF0Y2guXG4gICAgICovICAgIGFwcGx5VG9Mb2NhbERvY3VtZW50U2V0KHQpIHtcbiAgICAgICAgLy8gVE9ETyhtcnNjaG1pZHQpOiBUaGlzIGltcGxlbWVudGF0aW9uIGlzIE8obl4yKS4gSWYgd2UgYXBwbHkgdGhlIG11dGF0aW9uc1xuICAgICAgICAvLyBkaXJlY3RseSAoYXMgZG9uZSBpbiBgYXBwbHlUb0xvY2FsVmlldygpYCksIHdlIGNhbiByZWR1Y2UgdGhlIGNvbXBsZXhpdHlcbiAgICAgICAgLy8gdG8gTyhuKS5cbiAgICAgICAgdGhpcy5tdXRhdGlvbnMuZm9yRWFjaCgoZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuID0gdC5nZXQoZS5rZXkpLCBzID0gbjtcbiAgICAgICAgICAgIC8vIFRPRE8obXV0YWJsZWRvY3VtZW50cyk6IFRoaXMgbWV0aG9kIHNob3VsZCB0YWtlIGEgTXV0YWJsZURvY3VtZW50TWFwXG4gICAgICAgICAgICAvLyBhbmQgd2Ugc2hvdWxkIHJlbW92ZSB0aGlzIGNhc3QuXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcGx5VG9Mb2NhbFZpZXcocyksIG4uaXNWYWxpZERvY3VtZW50KCkgfHwgcy5jb252ZXJ0VG9Ob0RvY3VtZW50KGl0Lm1pbigpKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBrZXlzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tdXRhdGlvbnMucmVkdWNlKCgodCwgZSkgPT4gdC5hZGQoZS5rZXkpKSwgUG4oKSk7XG4gICAgfVxuICAgIGlzRXF1YWwodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5iYXRjaElkID09PSB0LmJhdGNoSWQgJiYgZXQodGhpcy5tdXRhdGlvbnMsIHQubXV0YXRpb25zLCAoKHQsIGUpID0+IFhlKHQsIGUpKSkgJiYgZXQodGhpcy5iYXNlTXV0YXRpb25zLCB0LmJhc2VNdXRhdGlvbnMsICgodCwgZSkgPT4gWGUodCwgZSkpKTtcbiAgICB9XG59XG5cbi8qKiBUaGUgcmVzdWx0IG9mIGFwcGx5aW5nIGEgbXV0YXRpb24gYmF0Y2ggdG8gdGhlIGJhY2tlbmQuICovIGNsYXNzIG5pIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBcbiAgICAvKipcbiAgICAgKiBBIHByZS1jb21wdXRlZCBtYXBwaW5nIGZyb20gZWFjaCBtdXRhdGVkIGRvY3VtZW50IHRvIHRoZSByZXN1bHRpbmdcbiAgICAgKiB2ZXJzaW9uLlxuICAgICAqL1xuICAgIHMpIHtcbiAgICAgICAgdGhpcy5iYXRjaCA9IHQsIHRoaXMuY29tbWl0VmVyc2lvbiA9IGUsIHRoaXMubXV0YXRpb25SZXN1bHRzID0gbiwgdGhpcy5kb2NWZXJzaW9ucyA9IHM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgTXV0YXRpb25CYXRjaFJlc3VsdCBmb3IgdGhlIGdpdmVuIGJhdGNoIGFuZCByZXN1bHRzLiBUaGVyZVxuICAgICAqIG11c3QgYmUgb25lIHJlc3VsdCBmb3IgZWFjaCBtdXRhdGlvbiBpbiB0aGUgYmF0Y2guIFRoaXMgc3RhdGljIGZhY3RvcnlcbiAgICAgKiBjYWNoZXMgYSBkb2N1bWVudD0mZ3Q7dmVyc2lvbiBtYXBwaW5nIChkb2NWZXJzaW9ucykuXG4gICAgICovICAgIHN0YXRpYyBmcm9tKHQsIGUsIG4pIHtcbiAgICAgICAgTCh0Lm11dGF0aW9ucy5sZW5ndGggPT09IG4ubGVuZ3RoKTtcbiAgICAgICAgbGV0IHMgPSBBbigpO1xuICAgICAgICBjb25zdCBpID0gdC5tdXRhdGlvbnM7XG4gICAgICAgIGZvciAobGV0IHQgPSAwOyB0IDwgaS5sZW5ndGg7IHQrKykgcyA9IHMuaW5zZXJ0KGlbdF0ua2V5LCBuW3RdLnZlcnNpb24pO1xuICAgICAgICByZXR1cm4gbmV3IG5pKHQsIGUsIG4sIHMpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQW4gaW1tdXRhYmxlIHNldCBvZiBtZXRhZGF0YSB0aGF0IHRoZSBsb2NhbCBzdG9yZSB0cmFja3MgZm9yIGVhY2ggdGFyZ2V0LlxuICovIGNsYXNzIHNpIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKiogVGhlIHRhcmdldCBiZWluZyBsaXN0ZW5lZCB0by4gKi9cbiAgICB0LCBcbiAgICAvKipcbiAgICAgKiBUaGUgdGFyZ2V0IElEIHRvIHdoaWNoIHRoZSB0YXJnZXQgY29ycmVzcG9uZHM7IEFzc2lnbmVkIGJ5IHRoZVxuICAgICAqIExvY2FsU3RvcmUgZm9yIHVzZXIgbGlzdGVucyBhbmQgYnkgdGhlIFN5bmNFbmdpbmUgZm9yIGxpbWJvIHdhdGNoZXMuXG4gICAgICovXG4gICAgZSwgXG4gICAgLyoqIFRoZSBwdXJwb3NlIG9mIHRoZSB0YXJnZXQuICovXG4gICAgbiwgXG4gICAgLyoqXG4gICAgICogVGhlIHNlcXVlbmNlIG51bWJlciBvZiB0aGUgbGFzdCB0cmFuc2FjdGlvbiBkdXJpbmcgd2hpY2ggdGhpcyB0YXJnZXQgZGF0YVxuICAgICAqIHdhcyBtb2RpZmllZC5cbiAgICAgKi9cbiAgICBzLCBcbiAgICAvKiogVGhlIGxhdGVzdCBzbmFwc2hvdCB2ZXJzaW9uIHNlZW4gZm9yIHRoaXMgdGFyZ2V0LiAqL1xuICAgIGkgPSBpdC5taW4oKVxuICAgIC8qKlxuICAgICAqIFRoZSBtYXhpbXVtIHNuYXBzaG90IHZlcnNpb24gYXQgd2hpY2ggdGhlIGFzc29jaWF0ZWQgdmlld1xuICAgICAqIGNvbnRhaW5lZCBubyBsaW1ibyBkb2N1bWVudHMuXG4gICAgICovICwgciA9IGl0Lm1pbigpXG4gICAgLyoqXG4gICAgICogQW4gb3BhcXVlLCBzZXJ2ZXItYXNzaWduZWQgdG9rZW4gdGhhdCBhbGxvd3Mgd2F0Y2hpbmcgYSB0YXJnZXQgdG8gYmVcbiAgICAgKiByZXN1bWVkIGFmdGVyIGRpc2Nvbm5lY3Rpbmcgd2l0aG91dCByZXRyYW5zbWl0dGluZyBhbGwgdGhlIGRhdGEgdGhhdFxuICAgICAqIG1hdGNoZXMgdGhlIHRhcmdldC4gVGhlIHJlc3VtZSB0b2tlbiBlc3NlbnRpYWxseSBpZGVudGlmaWVzIGEgcG9pbnQgaW5cbiAgICAgKiB0aW1lIGZyb20gd2hpY2ggdGhlIHNlcnZlciBzaG91bGQgcmVzdW1lIHNlbmRpbmcgcmVzdWx0cy5cbiAgICAgKi8gLCBvID0gd3QuRU1QVFlfQllURV9TVFJJTkcpIHtcbiAgICAgICAgdGhpcy50YXJnZXQgPSB0LCB0aGlzLnRhcmdldElkID0gZSwgdGhpcy5wdXJwb3NlID0gbiwgdGhpcy5zZXF1ZW5jZU51bWJlciA9IHMsIHRoaXMuc25hcHNob3RWZXJzaW9uID0gaSwgXG4gICAgICAgIHRoaXMubGFzdExpbWJvRnJlZVNuYXBzaG90VmVyc2lvbiA9IHIsIHRoaXMucmVzdW1lVG9rZW4gPSBvO1xuICAgIH1cbiAgICAvKiogQ3JlYXRlcyBhIG5ldyB0YXJnZXQgZGF0YSBpbnN0YW5jZSB3aXRoIGFuIHVwZGF0ZWQgc2VxdWVuY2UgbnVtYmVyLiAqLyAgICB3aXRoU2VxdWVuY2VOdW1iZXIodCkge1xuICAgICAgICByZXR1cm4gbmV3IHNpKHRoaXMudGFyZ2V0LCB0aGlzLnRhcmdldElkLCB0aGlzLnB1cnBvc2UsIHQsIHRoaXMuc25hcHNob3RWZXJzaW9uLCB0aGlzLmxhc3RMaW1ib0ZyZWVTbmFwc2hvdFZlcnNpb24sIHRoaXMucmVzdW1lVG9rZW4pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IHRhcmdldCBkYXRhIGluc3RhbmNlIHdpdGggYW4gdXBkYXRlZCByZXN1bWUgdG9rZW4gYW5kXG4gICAgICogc25hcHNob3QgdmVyc2lvbi5cbiAgICAgKi8gICAgd2l0aFJlc3VtZVRva2VuKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBzaSh0aGlzLnRhcmdldCwgdGhpcy50YXJnZXRJZCwgdGhpcy5wdXJwb3NlLCB0aGlzLnNlcXVlbmNlTnVtYmVyLCBlLCB0aGlzLmxhc3RMaW1ib0ZyZWVTbmFwc2hvdFZlcnNpb24sIHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IHRhcmdldCBkYXRhIGluc3RhbmNlIHdpdGggYW4gdXBkYXRlZCBsYXN0IGxpbWJvIGZyZWVcbiAgICAgKiBzbmFwc2hvdCB2ZXJzaW9uIG51bWJlci5cbiAgICAgKi8gICAgd2l0aExhc3RMaW1ib0ZyZWVTbmFwc2hvdFZlcnNpb24odCkge1xuICAgICAgICByZXR1cm4gbmV3IHNpKHRoaXMudGFyZ2V0LCB0aGlzLnRhcmdldElkLCB0aGlzLnB1cnBvc2UsIHRoaXMuc2VxdWVuY2VOdW1iZXIsIHRoaXMuc25hcHNob3RWZXJzaW9uLCB0LCB0aGlzLnJlc3VtZVRva2VuKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKiogU2VyaWFsaXplciBmb3IgdmFsdWVzIHN0b3JlZCBpbiB0aGUgTG9jYWxTdG9yZS4gKi8gY2xhc3MgaWkge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5XdCA9IHQ7XG4gICAgfVxufVxuXG4vKiogRGVjb2RlcyBhIHJlbW90ZSBkb2N1bWVudCBmcm9tIHN0b3JhZ2UgbG9jYWxseSB0byBhIERvY3VtZW50LiAqLyBmdW5jdGlvbiByaSh0LCBlKSB7XG4gICAgaWYgKGUuZG9jdW1lbnQpIHJldHVybiBabih0Lld0LCBlLmRvY3VtZW50LCAhIWUuaGFzQ29tbWl0dGVkTXV0YXRpb25zKTtcbiAgICBpZiAoZS5ub0RvY3VtZW50KSB7XG4gICAgICAgIGNvbnN0IHQgPSBQdC5mcm9tU2VnbWVudHMoZS5ub0RvY3VtZW50LnBhdGgpLCBuID0gaGkoZS5ub0RvY3VtZW50LnJlYWRUaW1lKSwgcyA9IHF0Lm5ld05vRG9jdW1lbnQodCwgbik7XG4gICAgICAgIHJldHVybiBlLmhhc0NvbW1pdHRlZE11dGF0aW9ucyA/IHMuc2V0SGFzQ29tbWl0dGVkTXV0YXRpb25zKCkgOiBzO1xuICAgIH1cbiAgICBpZiAoZS51bmtub3duRG9jdW1lbnQpIHtcbiAgICAgICAgY29uc3QgdCA9IFB0LmZyb21TZWdtZW50cyhlLnVua25vd25Eb2N1bWVudC5wYXRoKSwgbiA9IGhpKGUudW5rbm93bkRvY3VtZW50LnZlcnNpb24pO1xuICAgICAgICByZXR1cm4gcXQubmV3VW5rbm93bkRvY3VtZW50KHQsIG4pO1xuICAgIH1cbiAgICByZXR1cm4gTSgpO1xufVxuXG4vKiogRW5jb2RlcyBhIGRvY3VtZW50IGZvciBzdG9yYWdlIGxvY2FsbHkuICovIGZ1bmN0aW9uIG9pKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gYWkobiksIGkgPSBlLmtleS5wYXRoLnBvcExhc3QoKS50b0FycmF5KCk7XG4gICAgaWYgKGUuaXNGb3VuZERvY3VtZW50KCkpIHtcbiAgICAgICAgY29uc3QgbiA9IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgbmFtZTogV24odCwgZS5rZXkpLFxuICAgICAgICAgICAgICAgIGZpZWxkczogZS5kYXRhLnZhbHVlLm1hcFZhbHVlLmZpZWxkcyxcbiAgICAgICAgICAgICAgICB1cGRhdGVUaW1lOiBCbih0LCBlLnZlcnNpb24udG9UaW1lc3RhbXAoKSlcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0odC5XdCwgZSksIHIgPSBlLmhhc0NvbW1pdHRlZE11dGF0aW9ucztcbiAgICAgICAgcmV0dXJuIG5ldyBDcyhcbiAgICAgICAgLyogdW5rbm93bkRvY3VtZW50PSAqLyBudWxsLCBcbiAgICAgICAgLyogbm9Eb2N1bWVudD0gKi8gbnVsbCwgbiwgciwgcywgaSk7XG4gICAgfVxuICAgIGlmIChlLmlzTm9Eb2N1bWVudCgpKSB7XG4gICAgICAgIGNvbnN0IHQgPSBlLmtleS5wYXRoLnRvQXJyYXkoKSwgbiA9IHVpKGUudmVyc2lvbiksIHIgPSBlLmhhc0NvbW1pdHRlZE11dGF0aW9ucztcbiAgICAgICAgcmV0dXJuIG5ldyBDcyhcbiAgICAgICAgLyogdW5rbm93bkRvY3VtZW50PSAqLyBudWxsLCBuZXcgU3ModCwgbiksIFxuICAgICAgICAvKiBkb2N1bWVudD0gKi8gbnVsbCwgciwgcywgaSk7XG4gICAgfVxuICAgIGlmIChlLmlzVW5rbm93bkRvY3VtZW50KCkpIHtcbiAgICAgICAgY29uc3QgdCA9IGUua2V5LnBhdGgudG9BcnJheSgpLCBuID0gdWkoZS52ZXJzaW9uKTtcbiAgICAgICAgcmV0dXJuIG5ldyBDcyhuZXcgRHModCwgbiksIFxuICAgICAgICAvKiBub0RvY3VtZW50PSAqLyBudWxsLCBcbiAgICAgICAgLyogZG9jdW1lbnQ9ICovIG51bGwsIFxuICAgICAgICAvKiBoYXNDb21taXR0ZWRNdXRhdGlvbnM9ICovICEwLCBzLCBpKTtcbiAgICB9XG4gICAgcmV0dXJuIE0oKTtcbn1cblxuZnVuY3Rpb24gYWkodCkge1xuICAgIGNvbnN0IGUgPSB0LnRvVGltZXN0YW1wKCk7XG4gICAgcmV0dXJuIFsgZS5zZWNvbmRzLCBlLm5hbm9zZWNvbmRzIF07XG59XG5cbmZ1bmN0aW9uIGNpKHQpIHtcbiAgICBjb25zdCBlID0gbmV3IHN0KHRbMF0sIHRbMV0pO1xuICAgIHJldHVybiBpdC5mcm9tVGltZXN0YW1wKGUpO1xufVxuXG5mdW5jdGlvbiB1aSh0KSB7XG4gICAgY29uc3QgZSA9IHQudG9UaW1lc3RhbXAoKTtcbiAgICByZXR1cm4gbmV3IFJzKGUuc2Vjb25kcywgZS5uYW5vc2Vjb25kcyk7XG59XG5cbmZ1bmN0aW9uIGhpKHQpIHtcbiAgICBjb25zdCBlID0gbmV3IHN0KHQuc2Vjb25kcywgdC5uYW5vc2Vjb25kcyk7XG4gICAgcmV0dXJuIGl0LmZyb21UaW1lc3RhbXAoZSk7XG59XG5cbi8qKiBFbmNvZGVzIGEgYmF0Y2ggb2YgbXV0YXRpb25zIGludG8gYSBEYk11dGF0aW9uQmF0Y2ggZm9yIGxvY2FsIHN0b3JhZ2UuICovXG4vKiogRGVjb2RlcyBhIERiTXV0YXRpb25CYXRjaCBpbnRvIGEgTXV0YXRpb25CYXRjaCAqL1xuZnVuY3Rpb24gbGkodCwgZSkge1xuICAgIGNvbnN0IG4gPSAoZS5iYXNlTXV0YXRpb25zIHx8IFtdKS5tYXAoKGUgPT4gc3ModC5XdCwgZSkpKTtcbiAgICAvLyBTcXVhc2ggb2xkIHRyYW5zZm9ybSBtdXRhdGlvbnMgaW50byBleGlzdGluZyBwYXRjaCBvciBzZXQgbXV0YXRpb25zLlxuICAgIC8vIFRoZSByZXBsYWNlbWVudCBvZiByZXByZXNlbnRpbmcgYHRyYW5zZm9ybXNgIHdpdGggYHVwZGF0ZV90cmFuc2Zvcm1zYFxuICAgIC8vIG9uIHRoZSBTREsgbWVhbnMgdGhhdCBvbGQgYHRyYW5zZm9ybWAgbXV0YXRpb25zIHN0b3JlZCBpbiBJbmRleGVkREIgbmVlZFxuICAgIC8vIHRvIGJlIHVwZGF0ZWQgdG8gYHVwZGF0ZV90cmFuc2Zvcm1zYC5cbiAgICAvLyBUT0RPKGIvMTc0NjA4Mzc0KTogUmVtb3ZlIHRoaXMgY29kZSBvbmNlIHdlIHBlcmZvcm0gYSBzY2hlbWEgbWlncmF0aW9uLlxuICAgICAgICBmb3IgKGxldCB0ID0gMDsgdCA8IGUubXV0YXRpb25zLmxlbmd0aCAtIDE7ICsrdCkge1xuICAgICAgICBjb25zdCBuID0gZS5tdXRhdGlvbnNbdF07XG4gICAgICAgIGlmICh0ICsgMSA8IGUubXV0YXRpb25zLmxlbmd0aCAmJiB2b2lkIDAgIT09IGUubXV0YXRpb25zW3QgKyAxXS50cmFuc2Zvcm0pIHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBlLm11dGF0aW9uc1t0ICsgMV07XG4gICAgICAgICAgICBuLnVwZGF0ZVRyYW5zZm9ybXMgPSBzLnRyYW5zZm9ybS5maWVsZFRyYW5zZm9ybXMsIGUubXV0YXRpb25zLnNwbGljZSh0ICsgMSwgMSksIFxuICAgICAgICAgICAgKyt0O1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0IHMgPSBlLm11dGF0aW9ucy5tYXAoKGUgPT4gc3ModC5XdCwgZSkpKSwgaSA9IHN0LmZyb21NaWxsaXMoZS5sb2NhbFdyaXRlVGltZU1zKTtcbiAgICByZXR1cm4gbmV3IGVpKGUuYmF0Y2hJZCwgaSwgbiwgcyk7XG59XG5cbi8qKiBEZWNvZGVzIGEgRGJUYXJnZXQgaW50byBUYXJnZXREYXRhICovIGZ1bmN0aW9uIGZpKHQpIHtcbiAgICBjb25zdCBlID0gaGkodC5yZWFkVGltZSksIG4gPSB2b2lkIDAgIT09IHQubGFzdExpbWJvRnJlZVNuYXBzaG90VmVyc2lvbiA/IGhpKHQubGFzdExpbWJvRnJlZVNuYXBzaG90VmVyc2lvbikgOiBpdC5taW4oKTtcbiAgICBsZXQgcztcbiAgICB2YXIgaTtcbiAgICByZXR1cm4gdm9pZCAwICE9PSB0LnF1ZXJ5LmRvY3VtZW50cyA/IChMKDEgPT09IChpID0gdC5xdWVyeSkuZG9jdW1lbnRzLmxlbmd0aCksIFxuICAgIHMgPSBFZShkZShIbihpLmRvY3VtZW50c1swXSkpKSkgOiBzID0gZnVuY3Rpb24odCkge1xuICAgICAgICByZXR1cm4gRWUoYXModCkpO1xuICAgIH0odC5xdWVyeSksIG5ldyBzaShzLCB0LnRhcmdldElkLCAwIC8qIExpc3RlbiAqLyAsIHQubGFzdExpc3RlblNlcXVlbmNlTnVtYmVyLCBlLCBuLCB3dC5mcm9tQmFzZTY0U3RyaW5nKHQucmVzdW1lVG9rZW4pKTtcbn1cblxuLyoqIEVuY29kZXMgVGFyZ2V0RGF0YSBpbnRvIGEgRGJUYXJnZXQgZm9yIHN0b3JhZ2UgbG9jYWxseS4gKi8gZnVuY3Rpb24gZGkodCwgZSkge1xuICAgIGNvbnN0IG4gPSB1aShlLnNuYXBzaG90VmVyc2lvbiksIHMgPSB1aShlLmxhc3RMaW1ib0ZyZWVTbmFwc2hvdFZlcnNpb24pO1xuICAgIGxldCBpO1xuICAgIGkgPSB6dChlLnRhcmdldCkgPyBycyh0Lld0LCBlLnRhcmdldCkgOiBvcyh0Lld0LCBlLnRhcmdldCk7XG4gICAgLy8gV2UgY2FuJ3Qgc3RvcmUgdGhlIHJlc3VtZVRva2VuIGFzIGEgQnl0ZVN0cmluZyBpbiBJbmRleGVkRGIsIHNvIHdlXG4gICAgLy8gY29udmVydCBpdCB0byBhIGJhc2U2NCBzdHJpbmcgZm9yIHN0b3JhZ2UuXG4gICAgICAgIGNvbnN0IHIgPSBlLnJlc3VtZVRva2VuLnRvQmFzZTY0KCk7XG4gICAgLy8gbGFzdExpc3RlblNlcXVlbmNlTnVtYmVyIGlzIGFsd2F5cyAwIHVudGlsIHdlIGRvIHJlYWwgR0MuXG4gICAgICAgIHJldHVybiBuZXcgeHMoZS50YXJnZXRJZCwgUXQoZS50YXJnZXQpLCBuLCByLCBlLnNlcXVlbmNlTnVtYmVyLCBzLCBpKTtcbn1cblxuLyoqXG4gKiBBIGhlbHBlciBmdW5jdGlvbiBmb3IgZmlndXJpbmcgb3V0IHdoYXQga2luZCBvZiBxdWVyeSBoYXMgYmVlbiBzdG9yZWQuXG4gKi9cbi8qKlxuICogRW5jb2RlcyBhIGBCdW5kbGVkUXVlcnlgIGZyb20gYnVuZGxlIHByb3RvIHRvIGEgUXVlcnkgb2JqZWN0LlxuICpcbiAqIFRoaXMgcmVjb25zdHJ1Y3RzIHRoZSBvcmlnaW5hbCBxdWVyeSB1c2VkIHRvIGJ1aWxkIHRoZSBidW5kbGUgYmVpbmcgbG9hZGVkLFxuICogaW5jbHVkaW5nIGZlYXR1cmVzIGV4aXN0cyBvbmx5IGluIFNES3MgKGZvciBleGFtcGxlOiBsaW1pdC10by1sYXN0KS5cbiAqL1xuZnVuY3Rpb24gd2kodCkge1xuICAgIGNvbnN0IGUgPSBhcyh7XG4gICAgICAgIHBhcmVudDogdC5wYXJlbnQsXG4gICAgICAgIHN0cnVjdHVyZWRRdWVyeTogdC5zdHJ1Y3R1cmVkUXVlcnlcbiAgICB9KTtcbiAgICByZXR1cm4gXCJMQVNUXCIgPT09IHQubGltaXRUeXBlID8gVGUoZSwgZS5saW1pdCwgXCJMXCIgLyogTGFzdCAqLykgOiBlO1xufVxuXG4vKiogRW5jb2RlcyBhIE5hbWVkUXVlcnkgcHJvdG8gb2JqZWN0IHRvIGEgTmFtZWRRdWVyeSBtb2RlbCBvYmplY3QuICovXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY2xhc3MgX2kge1xuICAgIGdldEJ1bmRsZU1ldGFkYXRhKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIG1pKHQpLmdldChlKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgIGlmICh0KSByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGlkOiAoZSA9IHQpLmJ1bmRsZUlkLFxuICAgICAgICAgICAgICAgIGNyZWF0ZVRpbWU6IGhpKGUuY3JlYXRlVGltZSksXG4gICAgICAgICAgICAgICAgdmVyc2lvbjogZS52ZXJzaW9uXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgLyoqIEVuY29kZXMgYSBEYkJ1bmRsZSB0byBhIEJ1bmRsZU1ldGFkYXRhIG9iamVjdC4gKi9cbiAgICAgICAgICAgIHZhciBlO1xuICAgICAgICAgICAgLyoqIEVuY29kZXMgYSBCdW5kbGVNZXRhZGF0YSB0byBhIERiQnVuZGxlLiAqLyAgICAgICAgfSkpO1xuICAgIH1cbiAgICBzYXZlQnVuZGxlTWV0YWRhdGEodCwgZSkge1xuICAgICAgICByZXR1cm4gbWkodCkucHV0KHtcbiAgICAgICAgICAgIGJ1bmRsZUlkOiAobiA9IGUpLmlkLFxuICAgICAgICAgICAgY3JlYXRlVGltZTogdWkoS24obi5jcmVhdGVUaW1lKSksXG4gICAgICAgICAgICB2ZXJzaW9uOiBuLnZlcnNpb25cbiAgICAgICAgfSk7XG4gICAgICAgIHZhciBuO1xuICAgICAgICAvKiogRW5jb2RlcyBhIERiTmFtZWRRdWVyeSB0byBhIE5hbWVkUXVlcnkuICovICAgIH1cbiAgICBnZXROYW1lZFF1ZXJ5KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIGdpKHQpLmdldChlKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgIGlmICh0KSByZXR1cm4ge1xuICAgICAgICAgICAgICAgIG5hbWU6IChlID0gdCkubmFtZSxcbiAgICAgICAgICAgICAgICBxdWVyeTogd2koZS5idW5kbGVkUXVlcnkpLFxuICAgICAgICAgICAgICAgIHJlYWRUaW1lOiBoaShlLnJlYWRUaW1lKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBlO1xuICAgICAgICAgICAgLyoqIEVuY29kZXMgYSBOYW1lZFF1ZXJ5IGZyb20gYSBidW5kbGUgcHJvdG8gdG8gYSBEYk5hbWVkUXVlcnkuICovICAgICAgICB9KSk7XG4gICAgfVxuICAgIHNhdmVOYW1lZFF1ZXJ5KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIGdpKHQpLnB1dChmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIG5hbWU6IHQubmFtZSxcbiAgICAgICAgICAgICAgICByZWFkVGltZTogdWkoS24odC5yZWFkVGltZSkpLFxuICAgICAgICAgICAgICAgIGJ1bmRsZWRRdWVyeTogdC5idW5kbGVkUXVlcnlcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0oZSkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIGJ1bmRsZXMgb2JqZWN0IHN0b3JlLlxuICovIGZ1bmN0aW9uIG1pKHQpIHtcbiAgICByZXR1cm4gdGkodCwgTXMuc3RvcmUpO1xufVxuXG4vKipcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgbmFtZWRRdWVyaWVzIG9iamVjdCBzdG9yZS5cbiAqLyBmdW5jdGlvbiBnaSh0KSB7XG4gICAgcmV0dXJuIHRpKHQsIExzLnN0b3JlKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQW4gaW4tbWVtb3J5IGltcGxlbWVudGF0aW9uIG9mIEluZGV4TWFuYWdlci5cbiAqLyBjbGFzcyB5aSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuR3QgPSBuZXcgcGk7XG4gICAgfVxuICAgIGFkZFRvQ29sbGVjdGlvblBhcmVudEluZGV4KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuR3QuYWRkKGUpLCBLcy5yZXNvbHZlKCk7XG4gICAgfVxuICAgIGdldENvbGxlY3Rpb25QYXJlbnRzKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIEtzLnJlc29sdmUodGhpcy5HdC5nZXRFbnRyaWVzKGUpKTtcbiAgICB9XG59XG5cbi8qKlxuICogSW50ZXJuYWwgaW1wbGVtZW50YXRpb24gb2YgdGhlIGNvbGxlY3Rpb24tcGFyZW50IGluZGV4IGV4cG9zZWQgYnkgTWVtb3J5SW5kZXhNYW5hZ2VyLlxuICogQWxzbyB1c2VkIGZvciBpbi1tZW1vcnkgY2FjaGluZyBieSBJbmRleGVkRGJJbmRleE1hbmFnZXIgYW5kIGluaXRpYWwgaW5kZXggcG9wdWxhdGlvblxuICogaW4gaW5kZXhlZGRiX3NjaGVtYS50c1xuICovIGNsYXNzIHBpIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5pbmRleCA9IHt9O1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIGZhbHNlIGlmIHRoZSBlbnRyeSBhbHJlYWR5IGV4aXN0ZWQuXG4gICAgYWRkKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHQubGFzdFNlZ21lbnQoKSwgbiA9IHQucG9wTGFzdCgpLCBzID0gdGhpcy5pbmRleFtlXSB8fCBuZXcgbW4odXQuY29tcGFyYXRvciksIGkgPSAhcy5oYXMobik7XG4gICAgICAgIHJldHVybiB0aGlzLmluZGV4W2VdID0gcy5hZGQobiksIGk7XG4gICAgfVxuICAgIGhhcyh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0Lmxhc3RTZWdtZW50KCksIG4gPSB0LnBvcExhc3QoKSwgcyA9IHRoaXMuaW5kZXhbZV07XG4gICAgICAgIHJldHVybiBzICYmIHMuaGFzKG4pO1xuICAgIH1cbiAgICBnZXRFbnRyaWVzKHQpIHtcbiAgICAgICAgcmV0dXJuICh0aGlzLmluZGV4W3RdIHx8IG5ldyBtbih1dC5jb21wYXJhdG9yKSkudG9BcnJheSgpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSBwZXJzaXN0ZWQgaW1wbGVtZW50YXRpb24gb2YgSW5kZXhNYW5hZ2VyLlxuICovIGNsYXNzIEVpIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEFuIGluLW1lbW9yeSBjb3B5IG9mIHRoZSBpbmRleCBlbnRyaWVzIHdlJ3ZlIGFscmVhZHkgd3JpdHRlbiBzaW5jZSB0aGUgU0RLXG4gICAgICAgICAqIGxhdW5jaGVkLiBVc2VkIHRvIGF2b2lkIHJlLXdyaXRpbmcgdGhlIHNhbWUgZW50cnkgcmVwZWF0ZWRseS5cbiAgICAgICAgICpcbiAgICAgICAgICogVGhpcyBpcyAqTk9UKiBhIGNvbXBsZXRlIGNhY2hlIG9mIHdoYXQncyBpbiBwZXJzaXN0ZW5jZSBhbmQgc28gY2FuIG5ldmVyIGJlIHVzZWQgdG9cbiAgICAgICAgICogc2F0aXNmeSByZWFkcy5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuenQgPSBuZXcgcGk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZHMgYSBuZXcgZW50cnkgdG8gdGhlIGNvbGxlY3Rpb24gcGFyZW50IGluZGV4LlxuICAgICAqXG4gICAgICogUmVwZWF0ZWQgY2FsbHMgZm9yIHRoZSBzYW1lIGNvbGxlY3Rpb25QYXRoIHNob3VsZCBiZSBhdm9pZGVkIHdpdGhpbiBhXG4gICAgICogdHJhbnNhY3Rpb24gYXMgSW5kZXhlZERiSW5kZXhNYW5hZ2VyIG9ubHkgY2FjaGVzIHdyaXRlcyBvbmNlIGEgdHJhbnNhY3Rpb25cbiAgICAgKiBoYXMgYmVlbiBjb21taXR0ZWQuXG4gICAgICovICAgIGFkZFRvQ29sbGVjdGlvblBhcmVudEluZGV4KHQsIGUpIHtcbiAgICAgICAgaWYgKCF0aGlzLnp0LmhhcyhlKSkge1xuICAgICAgICAgICAgY29uc3QgbiA9IGUubGFzdFNlZ21lbnQoKSwgcyA9IGUucG9wTGFzdCgpO1xuICAgICAgICAgICAgdC5hZGRPbkNvbW1pdHRlZExpc3RlbmVyKCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gQWRkIHRoZSBjb2xsZWN0aW9uIHRvIHRoZSBpbiBtZW1vcnkgY2FjaGUgb25seSBpZiB0aGUgdHJhbnNhY3Rpb24gd2FzXG4gICAgICAgICAgICAgICAgLy8gc3VjY2Vzc2Z1bGx5IGNvbW1pdHRlZC5cbiAgICAgICAgICAgICAgICB0aGlzLnp0LmFkZChlKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIGNvbnN0IGkgPSB7XG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbklkOiBuLFxuICAgICAgICAgICAgICAgIHBhcmVudDogRXMocylcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gVGkodCkucHV0KGkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBLcy5yZXNvbHZlKCk7XG4gICAgfVxuICAgIGdldENvbGxlY3Rpb25QYXJlbnRzKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IFtdLCBzID0gSURCS2V5UmFuZ2UuYm91bmQoWyBlLCBcIlwiIF0sIFsgbnQoZSksIFwiXCIgXSwgXG4gICAgICAgIC8qbG93ZXJPcGVuPSovICExLCBcbiAgICAgICAgLyp1cHBlck9wZW49Ki8gITApO1xuICAgICAgICByZXR1cm4gVGkodCkuTHQocykubmV4dCgodCA9PiB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHMgb2YgdCkge1xuICAgICAgICAgICAgICAgIC8vIFRoaXMgY29sbGVjdGlvbklkIGd1YXJkIHNob3VsZG4ndCBiZSBuZWNlc3NhcnkgKGFuZCBpc24ndCBhcyBsb25nXG4gICAgICAgICAgICAgICAgLy8gYXMgd2UncmUgcnVubmluZyBpbiBhIHJlYWwgYnJvd3NlciksIGJ1dCB0aGVyZSdzIGEgYnVnIGluXG4gICAgICAgICAgICAgICAgLy8gaW5kZXhlZGRic2hpbSB0aGF0IGJyZWFrcyBvdXIgcmFuZ2UgaW4gb3VyIHRlc3RzIHJ1bm5pbmcgaW4gbm9kZTpcbiAgICAgICAgICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vYXhlbWNsaW9uL0luZGV4ZWREQlNoaW0vaXNzdWVzLzMzNFxuICAgICAgICAgICAgICAgIGlmIChzLmNvbGxlY3Rpb25JZCAhPT0gZSkgYnJlYWs7XG4gICAgICAgICAgICAgICAgbi5wdXNoKEFzKHMucGFyZW50KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbjtcbiAgICAgICAgfSkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIGNvbGxlY3Rpb25QYXJlbnRzXG4gKiBkb2N1bWVudCBzdG9yZS5cbiAqLyBmdW5jdGlvbiBUaSh0KSB7XG4gICAgcmV0dXJuIHRpKHQsIE9zLnN0b3JlKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTggR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY29uc3QgSWkgPSB7XG4gICAgZGlkUnVuOiAhMSxcbiAgICBzZXF1ZW5jZU51bWJlcnNDb2xsZWN0ZWQ6IDAsXG4gICAgdGFyZ2V0c1JlbW92ZWQ6IDAsXG4gICAgZG9jdW1lbnRzUmVtb3ZlZDogMFxufTtcblxuY2xhc3MgQWkge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8vIFdoZW4gd2UgYXR0ZW1wdCB0byBjb2xsZWN0LCB3ZSB3aWxsIG9ubHkgZG8gc28gaWYgdGhlIGNhY2hlIHNpemUgaXMgZ3JlYXRlciB0aGFuIHRoaXNcbiAgICAvLyB0aHJlc2hvbGQuIFBhc3NpbmcgYENPTExFQ1RJT05fRElTQUJMRURgIGhlcmUgd2lsbCBjYXVzZSBjb2xsZWN0aW9uIHRvIGFsd2F5cyBiZSBza2lwcGVkLlxuICAgIHQsIFxuICAgIC8vIFRoZSBwZXJjZW50YWdlIG9mIHNlcXVlbmNlIG51bWJlcnMgdGhhdCB3ZSB3aWxsIGF0dGVtcHQgdG8gY29sbGVjdFxuICAgIGUsIFxuICAgIC8vIEEgY2FwIG9uIHRoZSB0b3RhbCBudW1iZXIgb2Ygc2VxdWVuY2UgbnVtYmVycyB0aGF0IHdpbGwgYmUgY29sbGVjdGVkLiBUaGlzIHByZXZlbnRzXG4gICAgLy8gdXMgZnJvbSBjb2xsZWN0aW5nIGEgaHVnZSBudW1iZXIgb2Ygc2VxdWVuY2UgbnVtYmVycyBpZiB0aGUgY2FjaGUgaGFzIGdyb3duIHZlcnkgbGFyZ2UuXG4gICAgbikge1xuICAgICAgICB0aGlzLmNhY2hlU2l6ZUNvbGxlY3Rpb25UaHJlc2hvbGQgPSB0LCB0aGlzLnBlcmNlbnRpbGVUb0NvbGxlY3QgPSBlLCB0aGlzLm1heGltdW1TZXF1ZW5jZU51bWJlcnNUb0NvbGxlY3QgPSBuO1xuICAgIH1cbiAgICBzdGF0aWMgd2l0aENhY2hlU2l6ZSh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgQWkodCwgQWkuREVGQVVMVF9DT0xMRUNUSU9OX1BFUkNFTlRJTEUsIEFpLkRFRkFVTFRfTUFYX1NFUVVFTkNFX05VTUJFUlNfVE9fQ09MTEVDVCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBEZWxldGUgYSBtdXRhdGlvbiBiYXRjaCBhbmQgdGhlIGFzc29jaWF0ZWQgZG9jdW1lbnQgbXV0YXRpb25zLlxuICogQHJldHVybnMgQSBQZXJzaXN0ZW5jZVByb21pc2Ugb2YgdGhlIGRvY3VtZW50IG11dGF0aW9ucyB0aGF0IHdlcmUgcmVtb3ZlZC5cbiAqL1xuZnVuY3Rpb24gUmkodCwgZSwgbikge1xuICAgIGNvbnN0IHMgPSB0LnN0b3JlKHZzLnN0b3JlKSwgaSA9IHQuc3RvcmUoVnMuc3RvcmUpLCByID0gW10sIG8gPSBJREJLZXlSYW5nZS5vbmx5KG4uYmF0Y2hJZCk7XG4gICAgbGV0IGEgPSAwO1xuICAgIGNvbnN0IGMgPSBzLkt0KHtcbiAgICAgICAgcmFuZ2U6IG9cbiAgICB9LCAoKHQsIGUsIG4pID0+IChhKyssIG4uZGVsZXRlKCkpKSk7XG4gICAgci5wdXNoKGMubmV4dCgoKCkgPT4ge1xuICAgICAgICBMKDEgPT09IGEpO1xuICAgIH0pKSk7XG4gICAgY29uc3QgdSA9IFtdO1xuICAgIGZvciAoY29uc3QgdCBvZiBuLm11dGF0aW9ucykge1xuICAgICAgICBjb25zdCBzID0gVnMua2V5KGUsIHQua2V5LnBhdGgsIG4uYmF0Y2hJZCk7XG4gICAgICAgIHIucHVzaChpLmRlbGV0ZShzKSksIHUucHVzaCh0LmtleSk7XG4gICAgfVxuICAgIHJldHVybiBLcy53YWl0Rm9yKHIpLm5leHQoKCgpID0+IHUpKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGFuIGFwcHJveGltYXRlIHNpemUgZm9yIHRoZSBnaXZlbiBkb2N1bWVudC5cbiAqLyBmdW5jdGlvbiBQaSh0KSB7XG4gICAgaWYgKCF0KSByZXR1cm4gMDtcbiAgICBsZXQgZTtcbiAgICBpZiAodC5kb2N1bWVudCkgZSA9IHQuZG9jdW1lbnQ7IGVsc2UgaWYgKHQudW5rbm93bkRvY3VtZW50KSBlID0gdC51bmtub3duRG9jdW1lbnQ7IGVsc2Uge1xuICAgICAgICBpZiAoIXQubm9Eb2N1bWVudCkgdGhyb3cgTSgpO1xuICAgICAgICBlID0gdC5ub0RvY3VtZW50O1xuICAgIH1cbiAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoZSkubGVuZ3RoO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqIEEgbXV0YXRpb24gcXVldWUgZm9yIGEgc3BlY2lmaWMgdXNlciwgYmFja2VkIGJ5IEluZGV4ZWREQi4gKi8gQWkuREVGQVVMVF9DT0xMRUNUSU9OX1BFUkNFTlRJTEUgPSAxMCwgXG5BaS5ERUZBVUxUX01BWF9TRVFVRU5DRV9OVU1CRVJTX1RPX0NPTExFQ1QgPSAxZTMsIEFpLkRFRkFVTFQgPSBuZXcgQWkoNDE5NDMwNDAsIEFpLkRFRkFVTFRfQ09MTEVDVElPTl9QRVJDRU5USUxFLCBBaS5ERUZBVUxUX01BWF9TRVFVRU5DRV9OVU1CRVJTX1RPX0NPTExFQ1QpLCBcbkFpLkRJU0FCTEVEID0gbmV3IEFpKC0xLCAwLCAwKTtcblxuY2xhc3MgYmkge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIFRoZSBub3JtYWxpemVkIHVzZXJJZCAoZS5nLiBudWxsIFVJRCA9PiBcIlwiIHVzZXJJZCkgdXNlZCB0byBzdG9yZSAvXG4gICAgICogcmV0cmlldmUgbXV0YXRpb25zLlxuICAgICAqL1xuICAgIHQsIGUsIG4sIHMpIHtcbiAgICAgICAgdGhpcy51c2VySWQgPSB0LCB0aGlzLk4gPSBlLCB0aGlzLkh0ID0gbiwgdGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZSA9IHMsIFxuICAgICAgICAvKipcbiAgICAgICAgICogQ2FjaGVzIHRoZSBkb2N1bWVudCBrZXlzIGZvciBwZW5kaW5nIG11dGF0aW9uIGJhdGNoZXMuIElmIHRoZSBtdXRhdGlvblxuICAgICAgICAgKiBoYXMgYmVlbiByZW1vdmVkIGZyb20gSW5kZXhlZERiLCB0aGUgY2FjaGVkIHZhbHVlIG1heSBjb250aW51ZSB0b1xuICAgICAgICAgKiBiZSB1c2VkIHRvIHJldHJpZXZlIHRoZSBiYXRjaCdzIGRvY3VtZW50IGtleXMuIFRvIHJlbW92ZSBhIGNhY2hlZCB2YWx1ZVxuICAgICAgICAgKiBsb2NhbGx5LCBgcmVtb3ZlQ2FjaGVkTXV0YXRpb25LZXlzKClgIHNob3VsZCBiZSBpbnZva2VkIGVpdGhlciBkaXJlY3RseVxuICAgICAgICAgKiBvciB0aHJvdWdoIGByZW1vdmVNdXRhdGlvbkJhdGNoZXMoKWAuXG4gICAgICAgICAqXG4gICAgICAgICAqIFdpdGggbXVsdGktdGFiLCB3aGVuIHRoZSBwcmltYXJ5IGNsaWVudCBhY2tub3dsZWRnZXMgb3IgcmVqZWN0cyBhIG11dGF0aW9uLFxuICAgICAgICAgKiB0aGlzIGNhY2hlIGlzIHVzZWQgYnkgc2Vjb25kYXJ5IGNsaWVudHMgdG8gaW52YWxpZGF0ZSB0aGUgbG9jYWxcbiAgICAgICAgICogdmlldyBvZiB0aGUgZG9jdW1lbnRzIHRoYXQgd2VyZSBwcmV2aW91c2x5IGFmZmVjdGVkIGJ5IHRoZSBtdXRhdGlvbi5cbiAgICAgICAgICovXG4gICAgICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHkuXG4gICAgICAgIHRoaXMuSnQgPSB7fTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyBtdXRhdGlvbiBxdWV1ZSBmb3IgdGhlIGdpdmVuIHVzZXIuXG4gICAgICogQHBhcmFtIHVzZXIgLSBUaGUgdXNlciBmb3Igd2hpY2ggdG8gY3JlYXRlIGEgbXV0YXRpb24gcXVldWUuXG4gICAgICogQHBhcmFtIHNlcmlhbGl6ZXIgLSBUaGUgc2VyaWFsaXplciB0byB1c2Ugd2hlbiBwZXJzaXN0aW5nIHRvIEluZGV4ZWREYi5cbiAgICAgKi8gICAgc3RhdGljIFl0KHQsIGUsIG4sIHMpIHtcbiAgICAgICAgLy8gVE9ETyhtY2cpOiBGaWd1cmUgb3V0IHdoYXQgY29uc3RyYWludHMgdGhlcmUgYXJlIG9uIHVzZXJJRHNcbiAgICAgICAgLy8gSW4gcGFydGljdWxhciwgYXJlIHRoZXJlIGFueSByZXNlcnZlZCBjaGFyYWN0ZXJzPyBhcmUgZW1wdHkgaWRzIGFsbG93ZWQ/XG4gICAgICAgIC8vIEZvciB0aGUgbW9tZW50IHN0b3JlIHRoZXNlIHRvZ2V0aGVyIGluIHRoZSBzYW1lIG11dGF0aW9ucyB0YWJsZSBhc3N1bWluZ1xuICAgICAgICAvLyB0aGF0IGVtcHR5IHVzZXJJRHMgYXJlbid0IGFsbG93ZWQuXG4gICAgICAgIEwoXCJcIiAhPT0gdC51aWQpO1xuICAgICAgICBjb25zdCBpID0gdC5pc0F1dGhlbnRpY2F0ZWQoKSA/IHQudWlkIDogXCJcIjtcbiAgICAgICAgcmV0dXJuIG5ldyBiaShpLCBlLCBuLCBzKTtcbiAgICB9XG4gICAgY2hlY2tFbXB0eSh0KSB7XG4gICAgICAgIGxldCBlID0gITA7XG4gICAgICAgIGNvbnN0IG4gPSBJREJLZXlSYW5nZS5ib3VuZChbIHRoaXMudXNlcklkLCBOdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFkgXSwgWyB0aGlzLnVzZXJJZCwgTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZIF0pO1xuICAgICAgICByZXR1cm4gVmkodCkuS3Qoe1xuICAgICAgICAgICAgaW5kZXg6IHZzLnVzZXJNdXRhdGlvbnNJbmRleCxcbiAgICAgICAgICAgIHJhbmdlOiBuXG4gICAgICAgIH0sICgodCwgbiwgcykgPT4ge1xuICAgICAgICAgICAgZSA9ICExLCBzLmRvbmUoKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IGUpKTtcbiAgICB9XG4gICAgYWRkTXV0YXRpb25CYXRjaCh0LCBlLCBuLCBzKSB7XG4gICAgICAgIGNvbnN0IGkgPSBTaSh0KSwgciA9IFZpKHQpO1xuICAgICAgICAvLyBUaGUgSW5kZXhlZERiIGltcGxlbWVudGF0aW9uIGluIENocm9tZSAoYW5kIEZpcmVmb3gpIGRvZXMgbm90IGhhbmRsZVxuICAgICAgICAvLyBjb21wb3VuZCBpbmRpY2VzIHRoYXQgaW5jbHVkZSBhdXRvLWdlbmVyYXRlZCBrZXlzIGNvcnJlY3RseS4gVG8gZW5zdXJlXG4gICAgICAgIC8vIHRoYXQgdGhlIGluZGV4IGVudHJ5IGlzIGFkZGVkIGNvcnJlY3RseSBpbiBhbGwgYnJvd3NlcnMsIHdlIHBlcmZvcm0gdHdvXG4gICAgICAgIC8vIHdyaXRlczogVGhlIGZpcnN0IHdyaXRlIGlzIHVzZWQgdG8gcmV0cmlldmUgdGhlIG5leHQgYXV0by1nZW5lcmF0ZWQgQmF0Y2hcbiAgICAgICAgLy8gSUQsIGFuZCB0aGUgc2Vjb25kIHdyaXRlIHBvcHVsYXRlcyB0aGUgaW5kZXggYW5kIHN0b3JlcyB0aGUgYWN0dWFsXG4gICAgICAgIC8vIG11dGF0aW9uIGJhdGNoLlxuICAgICAgICAvLyBTZWU6IGh0dHBzOi8vYnVncy5jaHJvbWl1bS5vcmcvcC9jaHJvbWl1bS9pc3N1ZXMvZGV0YWlsP2lkPTcwMTk3MlxuICAgICAgICAvLyBXZSB3cml0ZSBhbiBlbXB0eSBvYmplY3QgdG8gb2J0YWluIGtleVxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICByZXR1cm4gci5hZGQoe30pLm5leHQoKG8gPT4ge1xuICAgICAgICAgICAgTChcIm51bWJlclwiID09IHR5cGVvZiBvKTtcbiAgICAgICAgICAgIGNvbnN0IGEgPSBuZXcgZWkobywgZSwgbiwgcyksIGMgPSBmdW5jdGlvbih0LCBlLCBuKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IG4uYmFzZU11dGF0aW9ucy5tYXAoKGUgPT4gbnModC5XdCwgZSkpKSwgaSA9IG4ubXV0YXRpb25zLm1hcCgoZSA9PiBucyh0Lld0LCBlKSkpO1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgdnMoZSwgbi5iYXRjaElkLCBuLmxvY2FsV3JpdGVUaW1lLnRvTWlsbGlzKCksIHMsIGkpO1xuICAgICAgICAgICAgfSh0aGlzLk4sIHRoaXMudXNlcklkLCBhKSwgdSA9IFtdO1xuICAgICAgICAgICAgbGV0IGggPSBuZXcgbW4oKCh0LCBlKSA9PiB0dCh0LmNhbm9uaWNhbFN0cmluZygpLCBlLmNhbm9uaWNhbFN0cmluZygpKSkpO1xuICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIHMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gVnMua2V5KHRoaXMudXNlcklkLCB0LmtleS5wYXRoLCBvKTtcbiAgICAgICAgICAgICAgICBoID0gaC5hZGQodC5rZXkucGF0aC5wb3BMYXN0KCkpLCB1LnB1c2goci5wdXQoYykpLCB1LnB1c2goaS5wdXQoZSwgVnMuUExBQ0VIT0xERVIpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBoLmZvckVhY2goKGUgPT4ge1xuICAgICAgICAgICAgICAgIHUucHVzaCh0aGlzLkh0LmFkZFRvQ29sbGVjdGlvblBhcmVudEluZGV4KHQsIGUpKTtcbiAgICAgICAgICAgIH0pKSwgdC5hZGRPbkNvbW1pdHRlZExpc3RlbmVyKCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5KdFtvXSA9IGEua2V5cygpO1xuICAgICAgICAgICAgfSkpLCBLcy53YWl0Rm9yKHUpLm5leHQoKCgpID0+IGEpKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBsb29rdXBNdXRhdGlvbkJhdGNoKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIFZpKHQpLmdldChlKS5uZXh0KCh0ID0+IHQgPyAoTCh0LnVzZXJJZCA9PT0gdGhpcy51c2VySWQpLCBsaSh0aGlzLk4sIHQpKSA6IG51bGwpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgZG9jdW1lbnQga2V5cyBmb3IgdGhlIG11dGF0aW9uIGJhdGNoIHdpdGggdGhlIGdpdmVuIGJhdGNoSWQuXG4gICAgICogRm9yIHByaW1hcnkgY2xpZW50cywgdGhpcyBtZXRob2QgcmV0dXJucyBgbnVsbGAgYWZ0ZXJcbiAgICAgKiBgcmVtb3ZlTXV0YXRpb25CYXRjaGVzKClgIGhhcyBiZWVuIGNhbGxlZC4gU2Vjb25kYXJ5IGNsaWVudHMgcmV0dXJuIGFcbiAgICAgKiBjYWNoZWQgcmVzdWx0IHVudGlsIGByZW1vdmVDYWNoZWRNdXRhdGlvbktleXMoKWAgaXMgaW52b2tlZC5cbiAgICAgKi9cbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5LlxuICAgIFh0KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuSnRbZV0gPyBLcy5yZXNvbHZlKHRoaXMuSnRbZV0pIDogdGhpcy5sb29rdXBNdXRhdGlvbkJhdGNoKHQsIGUpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgaWYgKHQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gdC5rZXlzKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuSnRbZV0gPSBuLCBuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZ2V0TmV4dE11dGF0aW9uQmF0Y2hBZnRlckJhdGNoSWQodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gZSArIDEsIHMgPSBJREJLZXlSYW5nZS5sb3dlckJvdW5kKFsgdGhpcy51c2VySWQsIG4gXSk7XG4gICAgICAgIGxldCBpID0gbnVsbDtcbiAgICAgICAgcmV0dXJuIFZpKHQpLkt0KHtcbiAgICAgICAgICAgIGluZGV4OiB2cy51c2VyTXV0YXRpb25zSW5kZXgsXG4gICAgICAgICAgICByYW5nZTogc1xuICAgICAgICB9LCAoKHQsIGUsIHMpID0+IHtcbiAgICAgICAgICAgIGUudXNlcklkID09PSB0aGlzLnVzZXJJZCAmJiAoTChlLmJhdGNoSWQgPj0gbiksIGkgPSBsaSh0aGlzLk4sIGUpKSwgcy5kb25lKCk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBpKSk7XG4gICAgfVxuICAgIGdldEhpZ2hlc3RVbmFja25vd2xlZGdlZEJhdGNoSWQodCkge1xuICAgICAgICBjb25zdCBlID0gSURCS2V5UmFuZ2UudXBwZXJCb3VuZChbIHRoaXMudXNlcklkLCBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkgXSk7XG4gICAgICAgIGxldCBuID0gLTE7XG4gICAgICAgIHJldHVybiBWaSh0KS5LdCh7XG4gICAgICAgICAgICBpbmRleDogdnMudXNlck11dGF0aW9uc0luZGV4LFxuICAgICAgICAgICAgcmFuZ2U6IGUsXG4gICAgICAgICAgICByZXZlcnNlOiAhMFxuICAgICAgICB9LCAoKHQsIGUsIHMpID0+IHtcbiAgICAgICAgICAgIG4gPSBlLmJhdGNoSWQsIHMuZG9uZSgpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gbikpO1xuICAgIH1cbiAgICBnZXRBbGxNdXRhdGlvbkJhdGNoZXModCkge1xuICAgICAgICBjb25zdCBlID0gSURCS2V5UmFuZ2UuYm91bmQoWyB0aGlzLnVzZXJJZCwgLTEgXSwgWyB0aGlzLnVzZXJJZCwgTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZIF0pO1xuICAgICAgICByZXR1cm4gVmkodCkuTHQodnMudXNlck11dGF0aW9uc0luZGV4LCBlKS5uZXh0KCh0ID0+IHQubWFwKCh0ID0+IGxpKHRoaXMuTiwgdCkpKSkpO1xuICAgIH1cbiAgICBnZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdEb2N1bWVudEtleSh0LCBlKSB7XG4gICAgICAgIC8vIFNjYW4gdGhlIGRvY3VtZW50LW11dGF0aW9uIGluZGV4IHN0YXJ0aW5nIHdpdGggYSBwcmVmaXggc3RhcnRpbmcgd2l0aFxuICAgICAgICAvLyB0aGUgZ2l2ZW4gZG9jdW1lbnRLZXkuXG4gICAgICAgIGNvbnN0IG4gPSBWcy5wcmVmaXhGb3JQYXRoKHRoaXMudXNlcklkLCBlLnBhdGgpLCBzID0gSURCS2V5UmFuZ2UubG93ZXJCb3VuZChuKSwgaSA9IFtdO1xuICAgICAgICByZXR1cm4gU2kodCkuS3Qoe1xuICAgICAgICAgICAgcmFuZ2U6IHNcbiAgICAgICAgfSwgKChuLCBzLCByKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBbbywgYSwgY10gPSBuLCB1ID0gQXMoYSk7XG4gICAgICAgICAgICAvLyBPbmx5IGNvbnNpZGVyIHJvd3MgbWF0Y2hpbmcgZXhhY3RseSB0aGUgc3BlY2lmaWMga2V5IG9mXG4gICAgICAgICAgICAvLyBpbnRlcmVzdC4gTm90ZSB0aGF0IGJlY2F1c2Ugd2Ugb3JkZXIgYnkgcGF0aCBmaXJzdCwgYW5kIHdlXG4gICAgICAgICAgICAvLyBvcmRlciB0ZXJtaW5hdG9ycyBiZWZvcmUgcGF0aCBzZXBhcmF0b3JzLCB3ZSdsbCBlbmNvdW50ZXIgYWxsXG4gICAgICAgICAgICAvLyB0aGUgaW5kZXggcm93cyBmb3IgZG9jdW1lbnRLZXkgY29udGlndW91c2x5LiBJbiBwYXJ0aWN1bGFyLCBhbGxcbiAgICAgICAgICAgIC8vIHRoZSByb3dzIGZvciBkb2N1bWVudEtleSB3aWxsIG9jY3VyIGJlZm9yZSBhbnkgcm93cyBmb3JcbiAgICAgICAgICAgIC8vIGRvY3VtZW50cyBuZXN0ZWQgaW4gYSBzdWJjb2xsZWN0aW9uIGJlbmVhdGggZG9jdW1lbnRLZXkgc28gd2VcbiAgICAgICAgICAgIC8vIGNhbiBzdG9wIGFzIHNvb24gYXMgd2UgaGl0IGFueSBzdWNoIHJvdy5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvID09PSB0aGlzLnVzZXJJZCAmJiBlLnBhdGguaXNFcXVhbCh1KSkgXG4gICAgICAgICAgICAvLyBMb29rIHVwIHRoZSBtdXRhdGlvbiBiYXRjaCBpbiB0aGUgc3RvcmUuXG4gICAgICAgICAgICByZXR1cm4gVmkodCkuZ2V0KGMpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghdCkgdGhyb3cgTSgpO1xuICAgICAgICAgICAgICAgIEwodC51c2VySWQgPT09IHRoaXMudXNlcklkKSwgaS5wdXNoKGxpKHRoaXMuTiwgdCkpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgci5kb25lKCk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBpKSk7XG4gICAgfVxuICAgIGdldEFsbE11dGF0aW9uQmF0Y2hlc0FmZmVjdGluZ0RvY3VtZW50S2V5cyh0LCBlKSB7XG4gICAgICAgIGxldCBuID0gbmV3IG1uKHR0KTtcbiAgICAgICAgY29uc3QgcyA9IFtdO1xuICAgICAgICByZXR1cm4gZS5mb3JFYWNoKChlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGkgPSBWcy5wcmVmaXhGb3JQYXRoKHRoaXMudXNlcklkLCBlLnBhdGgpLCByID0gSURCS2V5UmFuZ2UubG93ZXJCb3VuZChpKSwgbyA9IFNpKHQpLkt0KHtcbiAgICAgICAgICAgICAgICByYW5nZTogclxuICAgICAgICAgICAgfSwgKCh0LCBzLCBpKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgW3IsIG8sIGFdID0gdCwgYyA9IEFzKG8pO1xuICAgICAgICAgICAgICAgIC8vIE9ubHkgY29uc2lkZXIgcm93cyBtYXRjaGluZyBleGFjdGx5IHRoZSBzcGVjaWZpYyBrZXkgb2ZcbiAgICAgICAgICAgICAgICAvLyBpbnRlcmVzdC4gTm90ZSB0aGF0IGJlY2F1c2Ugd2Ugb3JkZXIgYnkgcGF0aCBmaXJzdCwgYW5kIHdlXG4gICAgICAgICAgICAgICAgLy8gb3JkZXIgdGVybWluYXRvcnMgYmVmb3JlIHBhdGggc2VwYXJhdG9ycywgd2UnbGwgZW5jb3VudGVyIGFsbFxuICAgICAgICAgICAgICAgIC8vIHRoZSBpbmRleCByb3dzIGZvciBkb2N1bWVudEtleSBjb250aWd1b3VzbHkuIEluIHBhcnRpY3VsYXIsIGFsbFxuICAgICAgICAgICAgICAgIC8vIHRoZSByb3dzIGZvciBkb2N1bWVudEtleSB3aWxsIG9jY3VyIGJlZm9yZSBhbnkgcm93cyBmb3JcbiAgICAgICAgICAgICAgICAvLyBkb2N1bWVudHMgbmVzdGVkIGluIGEgc3ViY29sbGVjdGlvbiBiZW5lYXRoIGRvY3VtZW50S2V5IHNvIHdlXG4gICAgICAgICAgICAgICAgLy8gY2FuIHN0b3AgYXMgc29vbiBhcyB3ZSBoaXQgYW55IHN1Y2ggcm93LlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByID09PSB0aGlzLnVzZXJJZCAmJiBlLnBhdGguaXNFcXVhbChjKSA/IG4gPSBuLmFkZChhKSA6IGkuZG9uZSgpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgcy5wdXNoKG8pO1xuICAgICAgICB9KSksIEtzLndhaXRGb3IocykubmV4dCgoKCkgPT4gdGhpcy5adCh0LCBuKSkpO1xuICAgIH1cbiAgICBnZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdRdWVyeSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBlLnBhdGgsIHMgPSBuLmxlbmd0aCArIDEsIGkgPSBWcy5wcmVmaXhGb3JQYXRoKHRoaXMudXNlcklkLCBuKSwgciA9IElEQktleVJhbmdlLmxvd2VyQm91bmQoaSk7XG4gICAgICAgIC8vIENvbGxlY3QgdXAgdW5pcXVlIGJhdGNoSURzIGVuY291bnRlcmVkIGR1cmluZyBhIHNjYW4gb2YgdGhlIGluZGV4LiBVc2UgYVxuICAgICAgICAvLyBTb3J0ZWRTZXQgdG8gYWNjdW11bGF0ZSBiYXRjaCBJRHMgc28gdGhleSBjYW4gYmUgdHJhdmVyc2VkIGluIG9yZGVyIGluIGFcbiAgICAgICAgLy8gc2NhbiBvZiB0aGUgbWFpbiB0YWJsZS5cbiAgICAgICAgbGV0IG8gPSBuZXcgbW4odHQpO1xuICAgICAgICByZXR1cm4gU2kodCkuS3Qoe1xuICAgICAgICAgICAgcmFuZ2U6IHJcbiAgICAgICAgfSwgKCh0LCBlLCBpKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBbciwgYSwgY10gPSB0LCB1ID0gQXMoYSk7XG4gICAgICAgICAgICByID09PSB0aGlzLnVzZXJJZCAmJiBuLmlzUHJlZml4T2YodSkgPyBcbiAgICAgICAgICAgIC8vIFJvd3Mgd2l0aCBkb2N1bWVudCBrZXlzIG1vcmUgdGhhbiBvbmUgc2VnbWVudCBsb25nZXIgdGhhbiB0aGVcbiAgICAgICAgICAgIC8vIHF1ZXJ5IHBhdGggY2FuJ3QgYmUgbWF0Y2hlcy4gRm9yIGV4YW1wbGUsIGEgcXVlcnkgb24gJ3Jvb21zJ1xuICAgICAgICAgICAgLy8gY2FuJ3QgbWF0Y2ggdGhlIGRvY3VtZW50IC9yb29tcy9hYmMvbWVzc2FnZXMveHl4LlxuICAgICAgICAgICAgLy8gVE9ETyhtY2cpOiB3ZSdsbCBuZWVkIGEgZGlmZmVyZW50IHNjYW5uZXIgd2hlbiB3ZSBpbXBsZW1lbnRcbiAgICAgICAgICAgIC8vIGFuY2VzdG9yIHF1ZXJpZXMuXG4gICAgICAgICAgICB1Lmxlbmd0aCA9PT0gcyAmJiAobyA9IG8uYWRkKGMpKSA6IGkuZG9uZSgpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gdGhpcy5adCh0LCBvKSkpO1xuICAgIH1cbiAgICBadCh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBbXSwgcyA9IFtdO1xuICAgICAgICAvLyBUT0RPKHJvY2t3b29kKTogSW1wbGVtZW50IHRoaXMgdXNpbmcgaXRlcmF0ZS5cbiAgICAgICAgcmV0dXJuIGUuZm9yRWFjaCgoZSA9PiB7XG4gICAgICAgICAgICBzLnB1c2goVmkodCkuZ2V0KGUpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChudWxsID09PSB0KSB0aHJvdyBNKCk7XG4gICAgICAgICAgICAgICAgTCh0LnVzZXJJZCA9PT0gdGhpcy51c2VySWQpLCBuLnB1c2gobGkodGhpcy5OLCB0KSk7XG4gICAgICAgICAgICB9KSkpO1xuICAgICAgICB9KSksIEtzLndhaXRGb3IocykubmV4dCgoKCkgPT4gbikpO1xuICAgIH1cbiAgICByZW1vdmVNdXRhdGlvbkJhdGNoKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIFJpKHQuUXQsIHRoaXMudXNlcklkLCBlKS5uZXh0KChuID0+ICh0LmFkZE9uQ29tbWl0dGVkTGlzdGVuZXIoKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMudGUoZS5iYXRjaElkKTtcbiAgICAgICAgfSkpLCBLcy5mb3JFYWNoKG4sIChlID0+IHRoaXMucmVmZXJlbmNlRGVsZWdhdGUubWFya1BvdGVudGlhbGx5T3JwaGFuZWQodCwgZSkpKSkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2xlYXJzIHRoZSBjYWNoZWQga2V5cyBmb3IgYSBtdXRhdGlvbiBiYXRjaC4gVGhpcyBtZXRob2Qgc2hvdWxkIGJlXG4gICAgICogY2FsbGVkIGJ5IHNlY29uZGFyeSBjbGllbnRzIGFmdGVyIHRoZXkgcHJvY2VzcyBtdXRhdGlvbiB1cGRhdGVzLlxuICAgICAqXG4gICAgICogTm90ZSB0aGF0IHRoaXMgbWV0aG9kIGRvZXMgbm90IGhhdmUgdG8gYmUgY2FsbGVkIGZyb20gcHJpbWFyeSBjbGllbnRzIGFzXG4gICAgICogdGhlIGNvcnJlc3BvbmRpbmcgY2FjaGUgZW50cmllcyBhcmUgY2xlYXJlZCB3aGVuIGFuIGFja25vd2xlZGdlZCBvclxuICAgICAqIHJlamVjdGVkIGJhdGNoIGlzIHJlbW92ZWQgZnJvbSB0aGUgbXV0YXRpb24gcXVldWUuXG4gICAgICovXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seVxuICAgIHRlKHQpIHtcbiAgICAgICAgZGVsZXRlIHRoaXMuSnRbdF07XG4gICAgfVxuICAgIHBlcmZvcm1Db25zaXN0ZW5jeUNoZWNrKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2hlY2tFbXB0eSh0KS5uZXh0KChlID0+IHtcbiAgICAgICAgICAgIGlmICghZSkgcmV0dXJuIEtzLnJlc29sdmUoKTtcbiAgICAgICAgICAgIC8vIFZlcmlmeSB0aGF0IHRoZXJlIGFyZSBubyBlbnRyaWVzIGluIHRoZSBkb2N1bWVudE11dGF0aW9ucyBpbmRleCBpZlxuICAgICAgICAgICAgLy8gdGhlIHF1ZXVlIGlzIGVtcHR5LlxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IElEQktleVJhbmdlLmxvd2VyQm91bmQoVnMucHJlZml4Rm9yVXNlcih0aGlzLnVzZXJJZCkpLCBzID0gW107XG4gICAgICAgICAgICByZXR1cm4gU2kodCkuS3Qoe1xuICAgICAgICAgICAgICAgIHJhbmdlOiBuXG4gICAgICAgICAgICB9LCAoKHQsIGUsIG4pID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodFswXSA9PT0gdGhpcy51c2VySWQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IEFzKHRbMV0pO1xuICAgICAgICAgICAgICAgICAgICBzLnB1c2goZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIG4uZG9uZSgpO1xuICAgICAgICAgICAgfSkpLm5leHQoKCgpID0+IHtcbiAgICAgICAgICAgICAgICBMKDAgPT09IHMubGVuZ3RoKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBjb250YWluc0tleSh0LCBlKSB7XG4gICAgICAgIHJldHVybiB2aSh0LCB0aGlzLnVzZXJJZCwgZSk7XG4gICAgfVxuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHkgKHN0YXRlIGlzIGhlbGQgaW4gbWVtb3J5IGluIG90aGVyIGNsaWVudHMpLlxuICAgIC8qKiBSZXR1cm5zIHRoZSBtdXRhdGlvbiBxdWV1ZSdzIG1ldGFkYXRhIGZyb20gSW5kZXhlZERiLiAqL1xuICAgIGVlKHQpIHtcbiAgICAgICAgcmV0dXJuIERpKHQpLmdldCh0aGlzLnVzZXJJZCkubmV4dCgodCA9PiB0IHx8IG5ldyBicyh0aGlzLnVzZXJJZCwgLTEsIFxuICAgICAgICAvKmxhc3RTdHJlYW1Ub2tlbj0qLyBcIlwiKSkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAcmV0dXJucyB0cnVlIGlmIHRoZSBtdXRhdGlvbiBxdWV1ZSBmb3IgdGhlIGdpdmVuIHVzZXIgY29udGFpbnMgYSBwZW5kaW5nXG4gKiAgICAgICAgIG11dGF0aW9uIGZvciB0aGUgZ2l2ZW4ga2V5LlxuICovIGZ1bmN0aW9uIHZpKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gVnMucHJlZml4Rm9yUGF0aChlLCBuLnBhdGgpLCBpID0gc1sxXSwgciA9IElEQktleVJhbmdlLmxvd2VyQm91bmQocyk7XG4gICAgbGV0IG8gPSAhMTtcbiAgICByZXR1cm4gU2kodCkuS3Qoe1xuICAgICAgICByYW5nZTogcixcbiAgICAgICAgcXQ6ICEwXG4gICAgfSwgKCh0LCBuLCBzKSA9PiB7XG4gICAgICAgIGNvbnN0IFtyLCBhLCAvKmJhdGNoSUQqLyBjXSA9IHQ7XG4gICAgICAgIHIgPT09IGUgJiYgYSA9PT0gaSAmJiAobyA9ICEwKSwgcy5kb25lKCk7XG4gICAgfSkpLm5leHQoKCgpID0+IG8pKTtcbn1cblxuLyoqIFJldHVybnMgdHJ1ZSBpZiBhbnkgbXV0YXRpb24gcXVldWUgY29udGFpbnMgdGhlIGdpdmVuIGRvY3VtZW50LiAqL1xuLyoqXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIG11dGF0aW9ucyBvYmplY3Qgc3RvcmUuXG4gKi9cbmZ1bmN0aW9uIFZpKHQpIHtcbiAgICByZXR1cm4gdGkodCwgdnMuc3RvcmUpO1xufVxuXG4vKipcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgbXV0YXRpb25RdWV1ZXMgb2JqZWN0IHN0b3JlLlxuICovIGZ1bmN0aW9uIFNpKHQpIHtcbiAgICByZXR1cm4gdGkodCwgVnMuc3RvcmUpO1xufVxuXG4vKipcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgbXV0YXRpb25RdWV1ZXMgb2JqZWN0IHN0b3JlLlxuICovIGZ1bmN0aW9uIERpKHQpIHtcbiAgICByZXR1cm4gdGkodCwgYnMuc3RvcmUpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqIE9mZnNldCB0byBlbnN1cmUgbm9uLW92ZXJsYXBwaW5nIHRhcmdldCBpZHMuICovXG4vKipcbiAqIEdlbmVyYXRlcyBtb25vdG9uaWNhbGx5IGluY3JlYXNpbmcgdGFyZ2V0IElEcyBmb3Igc2VuZGluZyB0YXJnZXRzIHRvIHRoZVxuICogd2F0Y2ggc3RyZWFtLlxuICpcbiAqIFRoZSBjbGllbnQgY29uc3RydWN0cyB0d28gZ2VuZXJhdG9ycywgb25lIGZvciB0aGUgdGFyZ2V0IGNhY2hlLCBhbmQgb25lIGZvclxuICogZm9yIHRoZSBzeW5jIGVuZ2luZSAodG8gZ2VuZXJhdGUgbGltYm8gZG9jdW1lbnRzIHRhcmdldHMpLiBUaGVzZVxuICogZ2VuZXJhdG9ycyBwcm9kdWNlIG5vbi1vdmVybGFwcGluZyBJRHMgKGJ5IHVzaW5nIGV2ZW4gYW5kIG9kZCBJRHNcbiAqIHJlc3BlY3RpdmVseSkuXG4gKlxuICogQnkgc2VwYXJhdGluZyB0aGUgdGFyZ2V0IElEIHNwYWNlLCB0aGUgcXVlcnkgY2FjaGUgY2FuIGdlbmVyYXRlIHRhcmdldCBJRHNcbiAqIHRoYXQgcGVyc2lzdCBhY3Jvc3MgY2xpZW50IHJlc3RhcnRzLCB3aGlsZSBzeW5jIGVuZ2luZSBjYW4gaW5kZXBlbmRlbnRseVxuICogZ2VuZXJhdGUgaW4tbWVtb3J5IHRhcmdldCBJRHMgdGhhdCBhcmUgdHJhbnNpZW50IGFuZCBjYW4gYmUgcmV1c2VkIGFmdGVyIGFcbiAqIHJlc3RhcnQuXG4gKi9cbmNsYXNzIENpIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMubmUgPSB0O1xuICAgIH1cbiAgICBuZXh0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5uZSArPSAyLCB0aGlzLm5lO1xuICAgIH1cbiAgICBzdGF0aWMgc2UoKSB7XG4gICAgICAgIC8vIFRoZSB0YXJnZXQgY2FjaGUgZ2VuZXJhdG9yIG11c3QgcmV0dXJuICcyJyBpbiBpdHMgZmlyc3QgY2FsbCB0byBgbmV4dCgpYFxuICAgICAgICAvLyBhcyB0aGVyZSBpcyBubyBkaWZmZXJlbnRpYXRpb24gaW4gdGhlIHByb3RvY29sIGxheWVyIGJldHdlZW4gYW4gdW5zZXRcbiAgICAgICAgLy8gbnVtYmVyIGFuZCB0aGUgbnVtYmVyICcwJy4gSWYgd2Ugd2VyZSB0byBzZW50IGEgdGFyZ2V0IHdpdGggdGFyZ2V0IElEXG4gICAgICAgIC8vICcwJywgdGhlIGJhY2tlbmQgd291bGQgY29uc2lkZXIgaXQgdW5zZXQgYW5kIHJlcGxhY2UgaXQgd2l0aCBpdHMgb3duIElELlxuICAgICAgICByZXR1cm4gbmV3IENpKDApO1xuICAgIH1cbiAgICBzdGF0aWMgaWUoKSB7XG4gICAgICAgIC8vIFN5bmMgZW5naW5lIGFzc2lnbnMgdGFyZ2V0IElEcyBmb3IgbGltYm8gZG9jdW1lbnQgZGV0ZWN0aW9uLlxuICAgICAgICByZXR1cm4gbmV3IENpKC0xKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNsYXNzIE5pIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMucmVmZXJlbmNlRGVsZWdhdGUgPSB0LCB0aGlzLk4gPSBlO1xuICAgIH1cbiAgICAvLyBQT1JUSU5HIE5PVEU6IFdlIGRvbid0IGNhY2hlIGdsb2JhbCBtZXRhZGF0YSBmb3IgdGhlIHRhcmdldCBjYWNoZSwgc2luY2VcbiAgICAvLyBzb21lIG9mIGl0IChpbiBwYXJ0aWN1bGFyIGBoaWdoZXN0VGFyZ2V0SWRgKSBjYW4gYmUgbW9kaWZpZWQgYnkgc2Vjb25kYXJ5XG4gICAgLy8gdGFicy4gV2UgY291bGQgcGVyaGFwcyBiZSBtb3JlIGdyYW51bGFyIChhbmQgZS5nLiBzdGlsbCBjYWNoZVxuICAgIC8vIGBsYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uYCBpbiBtZW1vcnkpIGJ1dCBmb3Igc2ltcGxpY2l0eSB3ZSBjdXJyZW50bHkgZ29cbiAgICAvLyB0byBJbmRleGVkRGIgd2hlbmV2ZXIgd2UgbmVlZCB0byByZWFkIG1ldGFkYXRhLiBXZSBjYW4gcmV2aXNpdCBpZiBpdCB0dXJuc1xuICAgIC8vIG91dCB0byBoYXZlIGEgbWVhbmluZ2Z1bCBwZXJmb3JtYW5jZSBpbXBhY3QuXG4gICAgYWxsb2NhdGVUYXJnZXRJZCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlKHQpLm5leHQoKGUgPT4ge1xuICAgICAgICAgICAgY29uc3QgbiA9IG5ldyBDaShlLmhpZ2hlc3RUYXJnZXRJZCk7XG4gICAgICAgICAgICByZXR1cm4gZS5oaWdoZXN0VGFyZ2V0SWQgPSBuLm5leHQoKSwgdGhpcy5vZSh0LCBlKS5uZXh0KCgoKSA9PiBlLmhpZ2hlc3RUYXJnZXRJZCkpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGdldExhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24odCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZSh0KS5uZXh0KCh0ID0+IGl0LmZyb21UaW1lc3RhbXAobmV3IHN0KHQubGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbi5zZWNvbmRzLCB0Lmxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24ubmFub3NlY29uZHMpKSkpO1xuICAgIH1cbiAgICBnZXRIaWdoZXN0U2VxdWVuY2VOdW1iZXIodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZSh0KS5uZXh0KCh0ID0+IHQuaGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyKSk7XG4gICAgfVxuICAgIHNldFRhcmdldHNNZXRhZGF0YSh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlKHQpLm5leHQoKHMgPT4gKHMuaGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyID0gZSwgbiAmJiAocy5sYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uID0gbi50b1RpbWVzdGFtcCgpKSwgXG4gICAgICAgIGUgPiBzLmhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlciAmJiAocy5oaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIgPSBlKSwgdGhpcy5vZSh0LCBzKSkpKTtcbiAgICB9XG4gICAgYWRkVGFyZ2V0RGF0YSh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFlKHQsIGUpLm5leHQoKCgpID0+IHRoaXMucmUodCkubmV4dCgobiA9PiAobi50YXJnZXRDb3VudCArPSAxLCB0aGlzLmNlKGUsIG4pLCBcbiAgICAgICAgdGhpcy5vZSh0LCBuKSkpKSkpO1xuICAgIH1cbiAgICB1cGRhdGVUYXJnZXREYXRhKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYWUodCwgZSk7XG4gICAgfVxuICAgIHJlbW92ZVRhcmdldERhdGEodCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZW1vdmVNYXRjaGluZ0tleXNGb3JUYXJnZXRJZCh0LCBlLnRhcmdldElkKS5uZXh0KCgoKSA9PiB4aSh0KS5kZWxldGUoZS50YXJnZXRJZCkpKS5uZXh0KCgoKSA9PiB0aGlzLnJlKHQpKSkubmV4dCgoZSA9PiAoTChlLnRhcmdldENvdW50ID4gMCksIFxuICAgICAgICBlLnRhcmdldENvdW50IC09IDEsIHRoaXMub2UodCwgZSkpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERyb3BzIGFueSB0YXJnZXRzIHdpdGggc2VxdWVuY2UgbnVtYmVyIGxlc3MgdGhhbiBvciBlcXVhbCB0byB0aGUgdXBwZXIgYm91bmQsIGV4Y2VwdGluZyB0aG9zZVxuICAgICAqIHByZXNlbnQgaW4gYGFjdGl2ZVRhcmdldElkc2AuIERvY3VtZW50IGFzc29jaWF0aW9ucyBmb3IgdGhlIHJlbW92ZWQgdGFyZ2V0cyBhcmUgYWxzbyByZW1vdmVkLlxuICAgICAqIFJldHVybnMgdGhlIG51bWJlciBvZiB0YXJnZXRzIHJlbW92ZWQuXG4gICAgICovICAgIHJlbW92ZVRhcmdldHModCwgZSwgbikge1xuICAgICAgICBsZXQgcyA9IDA7XG4gICAgICAgIGNvbnN0IGkgPSBbXTtcbiAgICAgICAgcmV0dXJuIHhpKHQpLkt0KCgociwgbykgPT4ge1xuICAgICAgICAgICAgY29uc3QgYSA9IGZpKG8pO1xuICAgICAgICAgICAgYS5zZXF1ZW5jZU51bWJlciA8PSBlICYmIG51bGwgPT09IG4uZ2V0KGEudGFyZ2V0SWQpICYmIChzKyssIGkucHVzaCh0aGlzLnJlbW92ZVRhcmdldERhdGEodCwgYSkpKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IEtzLndhaXRGb3IoaSkpKS5uZXh0KCgoKSA9PiBzKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGwgcHJvdmlkZWQgZnVuY3Rpb24gd2l0aCBlYWNoIGBUYXJnZXREYXRhYCB0aGF0IHdlIGhhdmUgY2FjaGVkLlxuICAgICAqLyAgICBmb3JFYWNoVGFyZ2V0KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHhpKHQpLkt0KCgodCwgbikgPT4ge1xuICAgICAgICAgICAgY29uc3QgcyA9IGZpKG4pO1xuICAgICAgICAgICAgZShzKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICByZSh0KSB7XG4gICAgICAgIHJldHVybiBraSh0KS5nZXQoJHMua2V5KS5uZXh0KCh0ID0+IChMKG51bGwgIT09IHQpLCB0KSkpO1xuICAgIH1cbiAgICBvZSh0LCBlKSB7XG4gICAgICAgIHJldHVybiBraSh0KS5wdXQoJHMua2V5LCBlKTtcbiAgICB9XG4gICAgYWUodCwgZSkge1xuICAgICAgICByZXR1cm4geGkodCkucHV0KGRpKHRoaXMuTiwgZSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJbi1wbGFjZSB1cGRhdGVzIHRoZSBwcm92aWRlZCBtZXRhZGF0YSB0byBhY2NvdW50IGZvciB2YWx1ZXMgaW4gdGhlIGdpdmVuXG4gICAgICogVGFyZ2V0RGF0YS4gU2F2aW5nIGlzIGRvbmUgc2VwYXJhdGVseS4gUmV0dXJucyB0cnVlIGlmIHRoZXJlIHdlcmUgYW55XG4gICAgICogY2hhbmdlcyB0byB0aGUgbWV0YWRhdGEuXG4gICAgICovICAgIGNlKHQsIGUpIHtcbiAgICAgICAgbGV0IG4gPSAhMTtcbiAgICAgICAgcmV0dXJuIHQudGFyZ2V0SWQgPiBlLmhpZ2hlc3RUYXJnZXRJZCAmJiAoZS5oaWdoZXN0VGFyZ2V0SWQgPSB0LnRhcmdldElkLCBuID0gITApLCBcbiAgICAgICAgdC5zZXF1ZW5jZU51bWJlciA+IGUuaGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyICYmIChlLmhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlciA9IHQuc2VxdWVuY2VOdW1iZXIsIFxuICAgICAgICBuID0gITApLCBuO1xuICAgIH1cbiAgICBnZXRUYXJnZXRDb3VudCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlKHQpLm5leHQoKHQgPT4gdC50YXJnZXRDb3VudCkpO1xuICAgIH1cbiAgICBnZXRUYXJnZXREYXRhKHQsIGUpIHtcbiAgICAgICAgLy8gSXRlcmF0aW5nIGJ5IHRoZSBjYW5vbmljYWxJZCBtYXkgeWllbGQgbW9yZSB0aGFuIG9uZSByZXN1bHQgYmVjYXVzZVxuICAgICAgICAvLyBjYW5vbmljYWxJZCB2YWx1ZXMgYXJlIG5vdCByZXF1aXJlZCB0byBiZSB1bmlxdWUgcGVyIHRhcmdldC4gVGhpcyBxdWVyeVxuICAgICAgICAvLyBkZXBlbmRzIG9uIHRoZSBxdWVyeVRhcmdldHMgaW5kZXggdG8gYmUgZWZmaWNpZW50LlxuICAgICAgICBjb25zdCBuID0gUXQoZSksIHMgPSBJREJLZXlSYW5nZS5ib3VuZChbIG4sIE51bWJlci5ORUdBVElWRV9JTkZJTklUWSBdLCBbIG4sIE51bWJlci5QT1NJVElWRV9JTkZJTklUWSBdKTtcbiAgICAgICAgbGV0IGkgPSBudWxsO1xuICAgICAgICByZXR1cm4geGkodCkuS3Qoe1xuICAgICAgICAgICAgcmFuZ2U6IHMsXG4gICAgICAgICAgICBpbmRleDogeHMucXVlcnlUYXJnZXRzSW5kZXhOYW1lXG4gICAgICAgIH0sICgodCwgbiwgcykgPT4ge1xuICAgICAgICAgICAgY29uc3QgciA9IGZpKG4pO1xuICAgICAgICAgICAgLy8gQWZ0ZXIgZmluZGluZyBhIHBvdGVudGlhbCBtYXRjaCwgY2hlY2sgdGhhdCB0aGUgdGFyZ2V0IGlzXG4gICAgICAgICAgICAvLyBhY3R1YWxseSBlcXVhbCB0byB0aGUgcmVxdWVzdGVkIHRhcmdldC5cbiAgICAgICAgICAgICAgICAgICAgICAgIEd0KGUsIHIudGFyZ2V0KSAmJiAoaSA9IHIsIHMuZG9uZSgpKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IGkpKTtcbiAgICB9XG4gICAgYWRkTWF0Y2hpbmdLZXlzKHQsIGUsIG4pIHtcbiAgICAgICAgLy8gUE9SVElORyBOT1RFOiBUaGUgcmV2ZXJzZSBpbmRleCAoZG9jdW1lbnRzVGFyZ2V0cykgaXMgbWFpbnRhaW5lZCBieVxuICAgICAgICAvLyBJbmRleGVkRGIuXG4gICAgICAgIGNvbnN0IHMgPSBbXSwgaSA9ICRpKHQpO1xuICAgICAgICByZXR1cm4gZS5mb3JFYWNoKChlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHIgPSBFcyhlLnBhdGgpO1xuICAgICAgICAgICAgcy5wdXNoKGkucHV0KG5ldyBrcyhuLCByKSkpLCBzLnB1c2godGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZS5hZGRSZWZlcmVuY2UodCwgbiwgZSkpO1xuICAgICAgICB9KSksIEtzLndhaXRGb3Iocyk7XG4gICAgfVxuICAgIHJlbW92ZU1hdGNoaW5nS2V5cyh0LCBlLCBuKSB7XG4gICAgICAgIC8vIFBPUlRJTkcgTk9URTogVGhlIHJldmVyc2UgaW5kZXggKGRvY3VtZW50c1RhcmdldHMpIGlzIG1haW50YWluZWQgYnlcbiAgICAgICAgLy8gSW5kZXhlZERiLlxuICAgICAgICBjb25zdCBzID0gJGkodCk7XG4gICAgICAgIHJldHVybiBLcy5mb3JFYWNoKGUsIChlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGkgPSBFcyhlLnBhdGgpO1xuICAgICAgICAgICAgcmV0dXJuIEtzLndhaXRGb3IoWyBzLmRlbGV0ZShbIG4sIGkgXSksIHRoaXMucmVmZXJlbmNlRGVsZWdhdGUucmVtb3ZlUmVmZXJlbmNlKHQsIG4sIGUpIF0pO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHJlbW92ZU1hdGNoaW5nS2V5c0ZvclRhcmdldElkKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9ICRpKHQpLCBzID0gSURCS2V5UmFuZ2UuYm91bmQoWyBlIF0sIFsgZSArIDEgXSwgXG4gICAgICAgIC8qbG93ZXJPcGVuPSovICExLCBcbiAgICAgICAgLyp1cHBlck9wZW49Ki8gITApO1xuICAgICAgICByZXR1cm4gbi5kZWxldGUocyk7XG4gICAgfVxuICAgIGdldE1hdGNoaW5nS2V5c0ZvclRhcmdldElkKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IElEQktleVJhbmdlLmJvdW5kKFsgZSBdLCBbIGUgKyAxIF0sIFxuICAgICAgICAvKmxvd2VyT3Blbj0qLyAhMSwgXG4gICAgICAgIC8qdXBwZXJPcGVuPSovICEwKSwgcyA9ICRpKHQpO1xuICAgICAgICBsZXQgaSA9IFBuKCk7XG4gICAgICAgIHJldHVybiBzLkt0KHtcbiAgICAgICAgICAgIHJhbmdlOiBuLFxuICAgICAgICAgICAgcXQ6ICEwXG4gICAgICAgIH0sICgodCwgZSwgbikgPT4ge1xuICAgICAgICAgICAgY29uc3QgcyA9IEFzKHRbMV0pLCByID0gbmV3IFB0KHMpO1xuICAgICAgICAgICAgaSA9IGkuYWRkKHIpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gaSkpO1xuICAgIH1cbiAgICBjb250YWluc0tleSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBFcyhlLnBhdGgpLCBzID0gSURCS2V5UmFuZ2UuYm91bmQoWyBuIF0sIFsgbnQobikgXSwgXG4gICAgICAgIC8qbG93ZXJPcGVuPSovICExLCBcbiAgICAgICAgLyp1cHBlck9wZW49Ki8gITApO1xuICAgICAgICBsZXQgaSA9IDA7XG4gICAgICAgIHJldHVybiAkaSh0KS5LdCh7XG4gICAgICAgICAgICBpbmRleDoga3MuZG9jdW1lbnRUYXJnZXRzSW5kZXgsXG4gICAgICAgICAgICBxdDogITAsXG4gICAgICAgICAgICByYW5nZTogc1xuICAgICAgICB9LCAoKFt0LCBlXSwgbiwgcykgPT4ge1xuICAgICAgICAgICAgLy8gSGF2aW5nIGEgc2VudGluZWwgcm93IGZvciBhIGRvY3VtZW50IGRvZXMgbm90IGNvdW50IGFzIGNvbnRhaW5pbmcgdGhhdCBkb2N1bWVudDtcbiAgICAgICAgICAgIC8vIEZvciB0aGUgdGFyZ2V0IGNhY2hlLCBjb250YWluaW5nIHRoZSBkb2N1bWVudCBtZWFucyB0aGUgZG9jdW1lbnQgaXMgcGFydCBvZiBzb21lXG4gICAgICAgICAgICAvLyB0YXJnZXQuXG4gICAgICAgICAgICAwICE9PSB0ICYmIChpKyssIHMuZG9uZSgpKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IGkgPiAwKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIExvb2tzIHVwIGEgVGFyZ2V0RGF0YSBlbnRyeSBieSB0YXJnZXQgSUQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdGFyZ2V0SWQgLSBUaGUgdGFyZ2V0IElEIG9mIHRoZSBUYXJnZXREYXRhIGVudHJ5IHRvIGxvb2sgdXAuXG4gICAgICogQHJldHVybnMgVGhlIGNhY2hlZCBUYXJnZXREYXRhIGVudHJ5LCBvciBudWxsIGlmIHRoZSBjYWNoZSBoYXMgbm8gZW50cnkgZm9yXG4gICAgICogdGhlIHRhcmdldC5cbiAgICAgKi9cbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5LlxuICAgIEV0KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHhpKHQpLmdldChlKS5uZXh0KCh0ID0+IHQgPyBmaSh0KSA6IG51bGwpKTtcbiAgICB9XG59XG5cbi8qKlxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSBxdWVyaWVzIG9iamVjdCBzdG9yZS5cbiAqLyBmdW5jdGlvbiB4aSh0KSB7XG4gICAgcmV0dXJuIHRpKHQsIHhzLnN0b3JlKTtcbn1cblxuLyoqXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIHRhcmdldCBnbG9iYWxzIG9iamVjdCBzdG9yZS5cbiAqLyBmdW5jdGlvbiBraSh0KSB7XG4gICAgcmV0dXJuIHRpKHQsICRzLnN0b3JlKTtcbn1cblxuLyoqXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIGRvY3VtZW50IHRhcmdldCBvYmplY3Qgc3RvcmUuXG4gKi8gZnVuY3Rpb24gJGkodCkge1xuICAgIHJldHVybiB0aSh0LCBrcy5zdG9yZSk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFZlcmlmaWVzIHRoZSBlcnJvciB0aHJvd24gYnkgYSBMb2NhbFN0b3JlIG9wZXJhdGlvbi4gSWYgYSBMb2NhbFN0b3JlXG4gKiBvcGVyYXRpb24gZmFpbHMgYmVjYXVzZSB0aGUgcHJpbWFyeSBsZWFzZSBoYXMgYmVlbiB0YWtlbiBieSBhbm90aGVyIGNsaWVudCxcbiAqIHdlIGlnbm9yZSB0aGUgZXJyb3IgKHRoZSBwZXJzaXN0ZW5jZSBsYXllciB3aWxsIGltbWVkaWF0ZWx5IGNhbGxcbiAqIGBhcHBseVByaW1hcnlMZWFzZWAgdG8gcHJvcGFnYXRlIHRoZSBwcmltYXJ5IHN0YXRlIGNoYW5nZSkuIEFsbCBvdGhlciBlcnJvcnNcbiAqIGFyZSByZS10aHJvd24uXG4gKlxuICogQHBhcmFtIGVyciAtIEFuIGVycm9yIHJldHVybmVkIGJ5IGEgTG9jYWxTdG9yZSBvcGVyYXRpb24uXG4gKiBAcmV0dXJucyBBIFByb21pc2UgdGhhdCByZXNvbHZlcyBhZnRlciB3ZSByZWNvdmVyZWQsIG9yIHRoZSBvcmlnaW5hbCBlcnJvci5cbiAqLyBhc3luYyBmdW5jdGlvbiBPaSh0KSB7XG4gICAgaWYgKHQuY29kZSAhPT0gcS5GQUlMRURfUFJFQ09ORElUSU9OIHx8IHQubWVzc2FnZSAhPT0gVXMpIHRocm93IHQ7XG4gICAgayhcIkxvY2FsU3RvcmVcIiwgXCJVbmV4cGVjdGVkbHkgbG9zdCBwcmltYXJ5IGxlYXNlXCIpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBmdW5jdGlvbiBGaShbdCwgZV0sIFtuLCBzXSkge1xuICAgIGNvbnN0IGkgPSB0dCh0LCBuKTtcbiAgICByZXR1cm4gMCA9PT0gaSA/IHR0KGUsIHMpIDogaTtcbn1cblxuLyoqXG4gKiBVc2VkIHRvIGNhbGN1bGF0ZSB0aGUgbnRoIHNlcXVlbmNlIG51bWJlci4gS2VlcHMgYSByb2xsaW5nIGJ1ZmZlciBvZiB0aGVcbiAqIGxvd2VzdCBuIHZhbHVlcyBwYXNzZWQgdG8gYGFkZEVsZW1lbnRgLCBhbmQgZmluYWxseSByZXBvcnRzIHRoZSBsYXJnZXN0IG9mXG4gKiB0aGVtIGluIGBtYXhWYWx1ZWAuXG4gKi8gY2xhc3MgTWkge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy51ZSA9IHQsIHRoaXMuYnVmZmVyID0gbmV3IG1uKEZpKSwgdGhpcy5oZSA9IDA7XG4gICAgfVxuICAgIGxlKCkge1xuICAgICAgICByZXR1cm4gKyt0aGlzLmhlO1xuICAgIH1cbiAgICBmZSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBbIHQsIHRoaXMubGUoKSBdO1xuICAgICAgICBpZiAodGhpcy5idWZmZXIuc2l6ZSA8IHRoaXMudWUpIHRoaXMuYnVmZmVyID0gdGhpcy5idWZmZXIuYWRkKGUpOyBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmJ1ZmZlci5sYXN0KCk7XG4gICAgICAgICAgICBGaShlLCB0KSA8IDAgJiYgKHRoaXMuYnVmZmVyID0gdGhpcy5idWZmZXIuZGVsZXRlKHQpLmFkZChlKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IG1heFZhbHVlKCkge1xuICAgICAgICAvLyBHdWFyYW50ZWVkIHRvIGJlIG5vbi1lbXB0eS4gSWYgd2UgZGVjaWRlIHdlIGFyZSBub3QgY29sbGVjdGluZyBhbnlcbiAgICAgICAgLy8gc2VxdWVuY2UgbnVtYmVycywgbnRoU2VxdWVuY2VOdW1iZXIgYmVsb3cgc2hvcnQtY2lyY3VpdHMuIElmIHdlIGhhdmVcbiAgICAgICAgLy8gZGVjaWRlZCB0aGF0IHdlIGFyZSBjb2xsZWN0aW5nIG4gc2VxdWVuY2UgbnVtYmVycywgaXQncyBiZWNhdXNlIG4gaXMgc29tZVxuICAgICAgICAvLyBwZXJjZW50YWdlIG9mIHRoZSBleGlzdGluZyBzZXF1ZW5jZSBudW1iZXJzLiBUaGF0IG1lYW5zIHdlIHNob3VsZCBuZXZlclxuICAgICAgICAvLyBiZSBpbiBhIHNpdHVhdGlvbiB3aGVyZSB3ZSBhcmUgY29sbGVjdGluZyBzZXF1ZW5jZSBudW1iZXJzIGJ1dCBkb24ndFxuICAgICAgICAvLyBhY3R1YWxseSBoYXZlIGFueS5cbiAgICAgICAgcmV0dXJuIHRoaXMuYnVmZmVyLmxhc3QoKVswXTtcbiAgICB9XG59XG5cbi8qKlxuICogVGhpcyBjbGFzcyBpcyByZXNwb25zaWJsZSBmb3IgdGhlIHNjaGVkdWxpbmcgb2YgTFJVIGdhcmJhZ2UgY29sbGVjdGlvbi4gSXQgaGFuZGxlcyBjaGVja2luZ1xuICogd2hldGhlciBvciBub3QgR0MgaXMgZW5hYmxlZCwgYXMgd2VsbCBhcyB3aGljaCBkZWxheSB0byB1c2UgYmVmb3JlIHRoZSBuZXh0IHJ1bi5cbiAqLyBjbGFzcyBMaSB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLmdhcmJhZ2VDb2xsZWN0b3IgPSB0LCB0aGlzLmFzeW5jUXVldWUgPSBlLCB0aGlzLmRlID0gITEsIHRoaXMud2UgPSBudWxsO1xuICAgIH1cbiAgICBzdGFydCh0KSB7XG4gICAgICAgIC0xICE9PSB0aGlzLmdhcmJhZ2VDb2xsZWN0b3IucGFyYW1zLmNhY2hlU2l6ZUNvbGxlY3Rpb25UaHJlc2hvbGQgJiYgdGhpcy5fZSh0KTtcbiAgICB9XG4gICAgc3RvcCgpIHtcbiAgICAgICAgdGhpcy53ZSAmJiAodGhpcy53ZS5jYW5jZWwoKSwgdGhpcy53ZSA9IG51bGwpO1xuICAgIH1cbiAgICBnZXQgc3RhcnRlZCgpIHtcbiAgICAgICAgcmV0dXJuIG51bGwgIT09IHRoaXMud2U7XG4gICAgfVxuICAgIF9lKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuZGUgPyAzZTUgOiA2ZTQ7XG4gICAgICAgIGsoXCJMcnVHYXJiYWdlQ29sbGVjdG9yXCIsIGBHYXJiYWdlIGNvbGxlY3Rpb24gc2NoZWR1bGVkIGluICR7ZX1tc2ApLCB0aGlzLndlID0gdGhpcy5hc3luY1F1ZXVlLmVucXVldWVBZnRlckRlbGF5KFwibHJ1X2dhcmJhZ2VfY29sbGVjdGlvblwiIC8qIExydUdhcmJhZ2VDb2xsZWN0aW9uICovICwgZSwgKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMud2UgPSBudWxsLCB0aGlzLmRlID0gITA7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGF3YWl0IHQuY29sbGVjdEdhcmJhZ2UodGhpcy5nYXJiYWdlQ29sbGVjdG9yKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgICAgICAgICB6cyh0KSA/IGsoXCJMcnVHYXJiYWdlQ29sbGVjdG9yXCIsIFwiSWdub3JpbmcgSW5kZXhlZERCIGVycm9yIGR1cmluZyBnYXJiYWdlIGNvbGxlY3Rpb246IFwiLCB0KSA6IGF3YWl0IE9pKHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYXdhaXQgdGhpcy5fZSh0KTtcbiAgICAgICAgfSkpO1xuICAgIH1cbn1cblxuLyoqIEltcGxlbWVudHMgdGhlIHN0ZXBzIGZvciBMUlUgZ2FyYmFnZSBjb2xsZWN0aW9uLiAqLyBjbGFzcyBCaSB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLm1lID0gdCwgdGhpcy5wYXJhbXMgPSBlO1xuICAgIH1cbiAgICBjYWxjdWxhdGVUYXJnZXRDb3VudCh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1lLmdlKHQpLm5leHQoKHQgPT4gTWF0aC5mbG9vcihlIC8gMTAwICogdCkpKTtcbiAgICB9XG4gICAgbnRoU2VxdWVuY2VOdW1iZXIodCwgZSkge1xuICAgICAgICBpZiAoMCA9PT0gZSkgcmV0dXJuIEtzLnJlc29sdmUoWS5UKTtcbiAgICAgICAgY29uc3QgbiA9IG5ldyBNaShlKTtcbiAgICAgICAgcmV0dXJuIHRoaXMubWUuZm9yRWFjaFRhcmdldCh0LCAodCA9PiBuLmZlKHQuc2VxdWVuY2VOdW1iZXIpKSkubmV4dCgoKCkgPT4gdGhpcy5tZS55ZSh0LCAodCA9PiBuLmZlKHQpKSkpKS5uZXh0KCgoKSA9PiBuLm1heFZhbHVlKSk7XG4gICAgfVxuICAgIHJlbW92ZVRhcmdldHModCwgZSwgbikge1xuICAgICAgICByZXR1cm4gdGhpcy5tZS5yZW1vdmVUYXJnZXRzKHQsIGUsIG4pO1xuICAgIH1cbiAgICByZW1vdmVPcnBoYW5lZERvY3VtZW50cyh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1lLnJlbW92ZU9ycGhhbmVkRG9jdW1lbnRzKHQsIGUpO1xuICAgIH1cbiAgICBjb2xsZWN0KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIC0xID09PSB0aGlzLnBhcmFtcy5jYWNoZVNpemVDb2xsZWN0aW9uVGhyZXNob2xkID8gKGsoXCJMcnVHYXJiYWdlQ29sbGVjdG9yXCIsIFwiR2FyYmFnZSBjb2xsZWN0aW9uIHNraXBwZWQ7IGRpc2FibGVkXCIpLCBcbiAgICAgICAgS3MucmVzb2x2ZShJaSkpIDogdGhpcy5nZXRDYWNoZVNpemUodCkubmV4dCgobiA9PiBuIDwgdGhpcy5wYXJhbXMuY2FjaGVTaXplQ29sbGVjdGlvblRocmVzaG9sZCA/IChrKFwiTHJ1R2FyYmFnZUNvbGxlY3RvclwiLCBgR2FyYmFnZSBjb2xsZWN0aW9uIHNraXBwZWQ7IENhY2hlIHNpemUgJHtufSBpcyBsb3dlciB0aGFuIHRocmVzaG9sZCAke3RoaXMucGFyYW1zLmNhY2hlU2l6ZUNvbGxlY3Rpb25UaHJlc2hvbGR9YCksIFxuICAgICAgICBJaSkgOiB0aGlzLnBlKHQsIGUpKSk7XG4gICAgfVxuICAgIGdldENhY2hlU2l6ZSh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1lLmdldENhY2hlU2l6ZSh0KTtcbiAgICB9XG4gICAgcGUodCwgZSkge1xuICAgICAgICBsZXQgbiwgcywgaSwgciwgbywgYSwgdTtcbiAgICAgICAgY29uc3QgaCA9IERhdGUubm93KCk7XG4gICAgICAgIHJldHVybiB0aGlzLmNhbGN1bGF0ZVRhcmdldENvdW50KHQsIHRoaXMucGFyYW1zLnBlcmNlbnRpbGVUb0NvbGxlY3QpLm5leHQoKGUgPT4gKFxuICAgICAgICAvLyBDYXAgYXQgdGhlIGNvbmZpZ3VyZWQgbWF4XG4gICAgICAgIGUgPiB0aGlzLnBhcmFtcy5tYXhpbXVtU2VxdWVuY2VOdW1iZXJzVG9Db2xsZWN0ID8gKGsoXCJMcnVHYXJiYWdlQ29sbGVjdG9yXCIsIGBDYXBwaW5nIHNlcXVlbmNlIG51bWJlcnMgdG8gY29sbGVjdCBkb3duIHRvIHRoZSBtYXhpbXVtIG9mICR7dGhpcy5wYXJhbXMubWF4aW11bVNlcXVlbmNlTnVtYmVyc1RvQ29sbGVjdH0gZnJvbSAke2V9YCksIFxuICAgICAgICBzID0gdGhpcy5wYXJhbXMubWF4aW11bVNlcXVlbmNlTnVtYmVyc1RvQ29sbGVjdCkgOiBzID0gZSwgciA9IERhdGUubm93KCksIHRoaXMubnRoU2VxdWVuY2VOdW1iZXIodCwgcykpKSkubmV4dCgocyA9PiAobiA9IHMsIFxuICAgICAgICBvID0gRGF0ZS5ub3coKSwgdGhpcy5yZW1vdmVUYXJnZXRzKHQsIG4sIGUpKSkpLm5leHQoKGUgPT4gKGkgPSBlLCBhID0gRGF0ZS5ub3coKSwgXG4gICAgICAgIHRoaXMucmVtb3ZlT3JwaGFuZWREb2N1bWVudHModCwgbikpKSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICBpZiAodSA9IERhdGUubm93KCksIE4oKSA8PSBjLkRFQlVHKSB7XG4gICAgICAgICAgICAgICAgayhcIkxydUdhcmJhZ2VDb2xsZWN0b3JcIiwgYExSVSBHYXJiYWdlIENvbGxlY3Rpb25cXG5cXHRDb3VudGVkIHRhcmdldHMgaW4gJHtyIC0gaH1tc1xcblxcdERldGVybWluZWQgbGVhc3QgcmVjZW50bHkgdXNlZCAke3N9IGluIGAgKyAobyAtIHIpICsgXCJtc1xcblwiICsgYFxcdFJlbW92ZWQgJHtpfSB0YXJnZXRzIGluIGAgKyAoYSAtIG8pICsgXCJtc1xcblwiICsgYFxcdFJlbW92ZWQgJHt0fSBkb2N1bWVudHMgaW4gYCArICh1IC0gYSkgKyBcIm1zXFxuXCIgKyBgVG90YWwgRHVyYXRpb246ICR7dSAtIGh9bXNgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBLcy5yZXNvbHZlKHtcbiAgICAgICAgICAgICAgICBkaWRSdW46ICEwLFxuICAgICAgICAgICAgICAgIHNlcXVlbmNlTnVtYmVyc0NvbGxlY3RlZDogcyxcbiAgICAgICAgICAgICAgICB0YXJnZXRzUmVtb3ZlZDogaSxcbiAgICAgICAgICAgICAgICBkb2N1bWVudHNSZW1vdmVkOiB0XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKiBQcm92aWRlcyBMUlUgZnVuY3Rpb25hbGl0eSBmb3IgSW5kZXhlZERCIHBlcnNpc3RlbmNlLiAqL1xuY2xhc3MgVWkge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5kYiA9IHQsIHRoaXMuZ2FyYmFnZUNvbGxlY3RvciA9IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgQmkodCwgZSk7XG4gICAgICAgIH0odGhpcywgZSk7XG4gICAgfVxuICAgIGdlKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuRWUodCk7XG4gICAgICAgIHJldHVybiB0aGlzLmRiLmdldFRhcmdldENhY2hlKCkuZ2V0VGFyZ2V0Q291bnQodCkubmV4dCgodCA9PiBlLm5leHQoKGUgPT4gdCArIGUpKSkpO1xuICAgIH1cbiAgICBFZSh0KSB7XG4gICAgICAgIGxldCBlID0gMDtcbiAgICAgICAgcmV0dXJuIHRoaXMueWUodCwgKHQgPT4ge1xuICAgICAgICAgICAgZSsrO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gZSkpO1xuICAgIH1cbiAgICBmb3JFYWNoVGFyZ2V0KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGIuZ2V0VGFyZ2V0Q2FjaGUoKS5mb3JFYWNoVGFyZ2V0KHQsIGUpO1xuICAgIH1cbiAgICB5ZSh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLlRlKHQsICgodCwgbikgPT4gZShuKSkpO1xuICAgIH1cbiAgICBhZGRSZWZlcmVuY2UodCwgZSwgbikge1xuICAgICAgICByZXR1cm4gcWkodCwgbik7XG4gICAgfVxuICAgIHJlbW92ZVJlZmVyZW5jZSh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiBxaSh0LCBuKTtcbiAgICB9XG4gICAgcmVtb3ZlVGFyZ2V0cyh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRiLmdldFRhcmdldENhY2hlKCkucmVtb3ZlVGFyZ2V0cyh0LCBlLCBuKTtcbiAgICB9XG4gICAgbWFya1BvdGVudGlhbGx5T3JwaGFuZWQodCwgZSkge1xuICAgICAgICByZXR1cm4gcWkodCwgZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiBhbnl0aGluZyB3b3VsZCBwcmV2ZW50IHRoaXMgZG9jdW1lbnQgZnJvbSBiZWluZyBnYXJiYWdlXG4gICAgICogY29sbGVjdGVkLCBnaXZlbiB0aGF0IHRoZSBkb2N1bWVudCBpbiBxdWVzdGlvbiBpcyBub3QgcHJlc2VudCBpbiBhbnlcbiAgICAgKiB0YXJnZXRzIGFuZCBoYXMgYSBzZXF1ZW5jZSBudW1iZXIgbGVzcyB0aGFuIG9yIGVxdWFsIHRvIHRoZSB1cHBlciBib3VuZCBmb3JcbiAgICAgKiB0aGUgY29sbGVjdGlvbiBydW4uXG4gICAgICovICAgIEllKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIGxldCBuID0gITE7XG4gICAgICAgICAgICByZXR1cm4gRGkodCkuanQoKHMgPT4gdmkodCwgcywgZSkubmV4dCgodCA9PiAodCAmJiAobiA9ICEwKSwgS3MucmVzb2x2ZSghdCkpKSkpKS5uZXh0KCgoKSA9PiBuKSk7XG4gICAgICAgIH0odCwgZSk7XG4gICAgfVxuICAgIHJlbW92ZU9ycGhhbmVkRG9jdW1lbnRzKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMuZGIuZ2V0UmVtb3RlRG9jdW1lbnRDYWNoZSgpLm5ld0NoYW5nZUJ1ZmZlcigpLCBzID0gW107XG4gICAgICAgIGxldCBpID0gMDtcbiAgICAgICAgcmV0dXJuIHRoaXMuVGUodCwgKChyLCBvKSA9PiB7XG4gICAgICAgICAgICBpZiAobyA8PSBlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuSWUodCwgcikubmV4dCgoZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghZSkgXG4gICAgICAgICAgICAgICAgICAgIC8vIE91ciBzaXplIGFjY291bnRpbmcgcmVxdWlyZXMgdXMgdG8gcmVhZCBhbGwgZG9jdW1lbnRzIGJlZm9yZVxuICAgICAgICAgICAgICAgICAgICAvLyByZW1vdmluZyB0aGVtLlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaSsrLCBuLmdldEVudHJ5KHQsIHIpLm5leHQoKCgpID0+IChuLnJlbW92ZUVudHJ5KHIpLCAkaSh0KS5kZWxldGUoWyAwLCBFcyhyLnBhdGgpIF0pKSkpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICBzLnB1c2goZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBLcy53YWl0Rm9yKHMpKSkubmV4dCgoKCkgPT4gbi5hcHBseSh0KSkpLm5leHQoKCgpID0+IGkpKTtcbiAgICB9XG4gICAgcmVtb3ZlVGFyZ2V0KHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IGUud2l0aFNlcXVlbmNlTnVtYmVyKHQuY3VycmVudFNlcXVlbmNlTnVtYmVyKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGIuZ2V0VGFyZ2V0Q2FjaGUoKS51cGRhdGVUYXJnZXREYXRhKHQsIG4pO1xuICAgIH1cbiAgICB1cGRhdGVMaW1ib0RvY3VtZW50KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHFpKHQsIGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsIHByb3ZpZGVkIGZ1bmN0aW9uIGZvciBlYWNoIGRvY3VtZW50IGluIHRoZSBjYWNoZSB0aGF0IGlzICdvcnBoYW5lZCcuIE9ycGhhbmVkXG4gICAgICogbWVhbnMgbm90IGEgcGFydCBvZiBhbnkgdGFyZ2V0LCBzbyB0aGUgb25seSBlbnRyeSBpbiB0aGUgdGFyZ2V0LWRvY3VtZW50IGluZGV4IGZvclxuICAgICAqIHRoYXQgZG9jdW1lbnQgd2lsbCBiZSB0aGUgc2VudGluZWwgcm93ICh0YXJnZXRJZCAwKSwgd2hpY2ggd2lsbCBhbHNvIGhhdmUgdGhlIHNlcXVlbmNlXG4gICAgICogbnVtYmVyIGZvciB0aGUgbGFzdCB0aW1lIHRoZSBkb2N1bWVudCB3YXMgYWNjZXNzZWQuXG4gICAgICovICAgIFRlKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9ICRpKHQpO1xuICAgICAgICBsZXQgcywgaSA9IFkuVDtcbiAgICAgICAgcmV0dXJuIG4uS3Qoe1xuICAgICAgICAgICAgaW5kZXg6IGtzLmRvY3VtZW50VGFyZ2V0c0luZGV4XG4gICAgICAgIH0sICgoW3QsIG5dLCB7cGF0aDogciwgc2VxdWVuY2VOdW1iZXI6IG99KSA9PiB7XG4gICAgICAgICAgICAwID09PSB0ID8gKFxuICAgICAgICAgICAgLy8gaWYgbmV4dFRvUmVwb3J0IGlzIHZhbGlkLCByZXBvcnQgaXQsIHRoaXMgaXMgYSBuZXcga2V5IHNvIHRoZVxuICAgICAgICAgICAgLy8gbGFzdCBvbmUgbXVzdCBub3QgYmUgYSBtZW1iZXIgb2YgYW55IHRhcmdldHMuXG4gICAgICAgICAgICBpICE9PSBZLlQgJiYgZShuZXcgUHQoQXMocykpLCBpKSwgXG4gICAgICAgICAgICAvLyBzZXQgbmV4dFRvUmVwb3J0IHRvIGJlIHRoaXMgc2VxdWVuY2UgbnVtYmVyLiBJdCdzIHRoZSBuZXh0IG9uZSB3ZVxuICAgICAgICAgICAgLy8gbWlnaHQgcmVwb3J0LCBpZiB3ZSBkb24ndCBmaW5kIGFueSB0YXJnZXRzIGZvciB0aGlzIGRvY3VtZW50LlxuICAgICAgICAgICAgLy8gTm90ZSB0aGF0IHRoZSBzZXF1ZW5jZSBudW1iZXIgbXVzdCBiZSBkZWZpbmVkIHdoZW4gdGhlIHRhcmdldElkXG4gICAgICAgICAgICAvLyBpcyAwLlxuICAgICAgICAgICAgaSA9IG8sIHMgPSByKSA6IFxuICAgICAgICAgICAgLy8gc2V0IG5leHRUb1JlcG9ydCB0byBiZSBpbnZhbGlkLCB3ZSBrbm93IHdlIGRvbid0IG5lZWQgdG8gcmVwb3J0XG4gICAgICAgICAgICAvLyB0aGlzIG9uZSBzaW5jZSB3ZSBmb3VuZCBhIHRhcmdldCBmb3IgaXQuXG4gICAgICAgICAgICBpID0gWS5UO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4ge1xuICAgICAgICAgICAgLy8gU2luY2Ugd2UgcmVwb3J0IHNlcXVlbmNlIG51bWJlcnMgYWZ0ZXIgZ2V0dGluZyB0byB0aGUgbmV4dCBrZXksIHdlXG4gICAgICAgICAgICAvLyBuZWVkIHRvIGNoZWNrIGlmIHRoZSBsYXN0IGtleSB3ZSBpdGVyYXRlZCBvdmVyIHdhcyBhbiBvcnBoYW5lZFxuICAgICAgICAgICAgLy8gZG9jdW1lbnQgYW5kIHJlcG9ydCBpdC5cbiAgICAgICAgICAgIGkgIT09IFkuVCAmJiBlKG5ldyBQdChBcyhzKSksIGkpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGdldENhY2hlU2l6ZSh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRiLmdldFJlbW90ZURvY3VtZW50Q2FjaGUoKS5nZXRTaXplKHQpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gcWkodCwgZSkge1xuICAgIHJldHVybiAkaSh0KS5wdXQoXG4gICAgLyoqXG4gKiBAcmV0dXJucyBBIHZhbHVlIHN1aXRhYmxlIGZvciB3cml0aW5nIGEgc2VudGluZWwgcm93IGluIHRoZSB0YXJnZXQtZG9jdW1lbnRcbiAqIHN0b3JlLlxuICovXG4gICAgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICByZXR1cm4gbmV3IGtzKDAsIEVzKHQucGF0aCksIGUpO1xuICAgIH0oZSwgdC5jdXJyZW50U2VxdWVuY2VOdW1iZXIpKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSBtYXAgaW1wbGVtZW50YXRpb24gdGhhdCB1c2VzIG9iamVjdHMgYXMga2V5cy4gT2JqZWN0cyBtdXN0IGhhdmUgYW5cbiAqIGFzc29jaWF0ZWQgZXF1YWxzIGZ1bmN0aW9uIGFuZCBtdXN0IGJlIGltbXV0YWJsZS4gRW50cmllcyBpbiB0aGUgbWFwIGFyZVxuICogc3RvcmVkIHRvZ2V0aGVyIHdpdGggdGhlIGtleSBiZWluZyBwcm9kdWNlZCBmcm9tIHRoZSBtYXBLZXlGbi4gVGhpcyBtYXBcbiAqIGF1dG9tYXRpY2FsbHkgaGFuZGxlcyBjb2xsaXNpb25zIG9mIGtleXMuXG4gKi8gY2xhc3MgS2kge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5tYXBLZXlGbiA9IHQsIHRoaXMuZXF1YWxzRm4gPSBlLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBpbm5lciBtYXAgZm9yIGEga2V5L3ZhbHVlIHBhaXIuIER1ZSB0byB0aGUgcG9zc2liaWxpdHkgb2YgY29sbGlzaW9ucyB3ZVxuICAgICAgICAgKiBrZWVwIGEgbGlzdCBvZiBlbnRyaWVzIHRoYXQgd2UgZG8gYSBsaW5lYXIgc2VhcmNoIHRocm91Z2ggdG8gZmluZCBhbiBhY3R1YWxcbiAgICAgICAgICogbWF0Y2guIE5vdGUgdGhhdCBjb2xsaXNpb25zIHNob3VsZCBiZSByYXJlLCBzbyB3ZSBzdGlsbCBleHBlY3QgbmVhclxuICAgICAgICAgKiBjb25zdGFudCB0aW1lIGxvb2t1cHMgaW4gcHJhY3RpY2UuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmlubmVyID0ge307XG4gICAgfVxuICAgIC8qKiBHZXQgYSB2YWx1ZSBmb3IgdGhpcyBrZXksIG9yIHVuZGVmaW5lZCBpZiBpdCBkb2VzIG5vdCBleGlzdC4gKi8gICAgZ2V0KHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMubWFwS2V5Rm4odCksIG4gPSB0aGlzLmlubmVyW2VdO1xuICAgICAgICBpZiAodm9pZCAwICE9PSBuKSBmb3IgKGNvbnN0IFtlLCBzXSBvZiBuKSBpZiAodGhpcy5lcXVhbHNGbihlLCB0KSkgcmV0dXJuIHM7XG4gICAgfVxuICAgIGhhcyh0KSB7XG4gICAgICAgIHJldHVybiB2b2lkIDAgIT09IHRoaXMuZ2V0KHQpO1xuICAgIH1cbiAgICAvKiogUHV0IHRoaXMga2V5IGFuZCB2YWx1ZSBpbiB0aGUgbWFwLiAqLyAgICBzZXQodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gdGhpcy5tYXBLZXlGbih0KSwgcyA9IHRoaXMuaW5uZXJbbl07XG4gICAgICAgIGlmICh2b2lkIDAgIT09IHMpIHtcbiAgICAgICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgcy5sZW5ndGg7IG4rKykgaWYgKHRoaXMuZXF1YWxzRm4oc1tuXVswXSwgdCkpIHJldHVybiB2b2lkIChzW25dID0gWyB0LCBlIF0pO1xuICAgICAgICAgICAgcy5wdXNoKFsgdCwgZSBdKTtcbiAgICAgICAgfSBlbHNlIHRoaXMuaW5uZXJbbl0gPSBbIFsgdCwgZSBdIF07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlbW92ZSB0aGlzIGtleSBmcm9tIHRoZSBtYXAuIFJldHVybnMgYSBib29sZWFuIGlmIGFueXRoaW5nIHdhcyBkZWxldGVkLlxuICAgICAqLyAgICBkZWxldGUodCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5tYXBLZXlGbih0KSwgbiA9IHRoaXMuaW5uZXJbZV07XG4gICAgICAgIGlmICh2b2lkIDAgPT09IG4pIHJldHVybiAhMTtcbiAgICAgICAgZm9yIChsZXQgcyA9IDA7IHMgPCBuLmxlbmd0aDsgcysrKSBpZiAodGhpcy5lcXVhbHNGbihuW3NdWzBdLCB0KSkgcmV0dXJuIDEgPT09IG4ubGVuZ3RoID8gZGVsZXRlIHRoaXMuaW5uZXJbZV0gOiBuLnNwbGljZShzLCAxKSwgXG4gICAgICAgICEwO1xuICAgICAgICByZXR1cm4gITE7XG4gICAgfVxuICAgIGZvckVhY2godCkge1xuICAgICAgICBvdCh0aGlzLmlubmVyLCAoKGUsIG4pID0+IHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgW2UsIHNdIG9mIG4pIHQoZSwgcyk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgaXNFbXB0eSgpIHtcbiAgICAgICAgcmV0dXJuIGF0KHRoaXMuaW5uZXIpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQW4gaW4tbWVtb3J5IGJ1ZmZlciBvZiBlbnRyaWVzIHRvIGJlIHdyaXR0ZW4gdG8gYSBSZW1vdGVEb2N1bWVudENhY2hlLlxuICogSXQgY2FuIGJlIHVzZWQgdG8gYmF0Y2ggdXAgYSBzZXQgb2YgY2hhbmdlcyB0byBiZSB3cml0dGVuIHRvIHRoZSBjYWNoZSwgYnV0XG4gKiBhZGRpdGlvbmFsbHkgc3VwcG9ydHMgcmVhZGluZyBlbnRyaWVzIGJhY2sgd2l0aCB0aGUgYGdldEVudHJ5KClgIG1ldGhvZCxcbiAqIGZhbGxpbmcgYmFjayB0byB0aGUgdW5kZXJseWluZyBSZW1vdGVEb2N1bWVudENhY2hlIGlmIG5vIGVudHJ5IGlzXG4gKiBidWZmZXJlZC5cbiAqXG4gKiBFbnRyaWVzIGFkZGVkIHRvIHRoZSBjYWNoZSAqbXVzdCogYmUgcmVhZCBmaXJzdC4gVGhpcyBpcyB0byBmYWNpbGl0YXRlXG4gKiBjYWxjdWxhdGluZyB0aGUgc2l6ZSBkZWx0YSBvZiB0aGUgcGVuZGluZyBjaGFuZ2VzLlxuICpcbiAqIFBPUlRJTkcgTk9URTogVGhpcyBjbGFzcyB3YXMgaW1wbGVtZW50ZWQgdGhlbiByZW1vdmVkIGZyb20gb3RoZXIgcGxhdGZvcm1zLlxuICogSWYgYnl0ZS1jb3VudGluZyBlbmRzIHVwIGJlaW5nIG5lZWRlZCBvbiB0aGUgb3RoZXIgcGxhdGZvcm1zLCBjb25zaWRlclxuICogcG9ydGluZyB0aGlzIGNsYXNzIGFzIHBhcnQgb2YgdGhhdCBpbXBsZW1lbnRhdGlvbiB3b3JrLlxuICovIGNsYXNzIGppIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgLy8gQSBtYXBwaW5nIG9mIGRvY3VtZW50IGtleSB0byB0aGUgbmV3IGNhY2hlIGVudHJ5IHRoYXQgc2hvdWxkIGJlIHdyaXR0ZW4gKG9yIG51bGwgaWYgYW55XG4gICAgICAgIC8vIGV4aXN0aW5nIGNhY2hlIGVudHJ5IHNob3VsZCBiZSByZW1vdmVkKS5cbiAgICAgICAgdGhpcy5jaGFuZ2VzID0gbmV3IEtpKCh0ID0+IHQudG9TdHJpbmcoKSksICgodCwgZSkgPT4gdC5pc0VxdWFsKGUpKSksIHRoaXMuY2hhbmdlc0FwcGxpZWQgPSAhMTtcbiAgICB9XG4gICAgZ2V0UmVhZFRpbWUodCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5jaGFuZ2VzLmdldCh0KTtcbiAgICAgICAgcmV0dXJuIGUgPyBlLnJlYWRUaW1lIDogaXQubWluKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEJ1ZmZlcnMgYSBgUmVtb3RlRG9jdW1lbnRDYWNoZS5hZGRFbnRyeSgpYCBjYWxsLlxuICAgICAqXG4gICAgICogWW91IGNhbiBvbmx5IG1vZGlmeSBkb2N1bWVudHMgdGhhdCBoYXZlIGFscmVhZHkgYmVlbiByZXRyaWV2ZWQgdmlhXG4gICAgICogYGdldEVudHJ5KCkvZ2V0RW50cmllcygpYCAoZW5mb3JjZWQgdmlhIEluZGV4ZWREYnMgYGFwcGx5KClgKS5cbiAgICAgKi8gICAgYWRkRW50cnkodCwgZSkge1xuICAgICAgICB0aGlzLmFzc2VydE5vdEFwcGxpZWQoKSwgdGhpcy5jaGFuZ2VzLnNldCh0LmtleSwge1xuICAgICAgICAgICAgZG9jdW1lbnQ6IHQsXG4gICAgICAgICAgICByZWFkVGltZTogZVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQnVmZmVycyBhIGBSZW1vdGVEb2N1bWVudENhY2hlLnJlbW92ZUVudHJ5KClgIGNhbGwuXG4gICAgICpcbiAgICAgKiBZb3UgY2FuIG9ubHkgcmVtb3ZlIGRvY3VtZW50cyB0aGF0IGhhdmUgYWxyZWFkeSBiZWVuIHJldHJpZXZlZCB2aWFcbiAgICAgKiBgZ2V0RW50cnkoKS9nZXRFbnRyaWVzKClgIChlbmZvcmNlZCB2aWEgSW5kZXhlZERicyBgYXBwbHkoKWApLlxuICAgICAqLyAgICByZW1vdmVFbnRyeSh0LCBlID0gbnVsbCkge1xuICAgICAgICB0aGlzLmFzc2VydE5vdEFwcGxpZWQoKSwgdGhpcy5jaGFuZ2VzLnNldCh0LCB7XG4gICAgICAgICAgICBkb2N1bWVudDogcXQubmV3SW52YWxpZERvY3VtZW50KHQpLFxuICAgICAgICAgICAgcmVhZFRpbWU6IGVcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIExvb2tzIHVwIGFuIGVudHJ5IGluIHRoZSBjYWNoZS4gVGhlIGJ1ZmZlcmVkIGNoYW5nZXMgd2lsbCBmaXJzdCBiZSBjaGVja2VkLFxuICAgICAqIGFuZCBpZiBubyBidWZmZXJlZCBjaGFuZ2UgYXBwbGllcywgdGhpcyB3aWxsIGZvcndhcmQgdG9cbiAgICAgKiBgUmVtb3RlRG9jdW1lbnRDYWNoZS5nZXRFbnRyeSgpYC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB0cmFuc2FjdGlvbiAtIFRoZSB0cmFuc2FjdGlvbiBpbiB3aGljaCB0byBwZXJmb3JtIGFueSBwZXJzaXN0ZW5jZVxuICAgICAqICAgICBvcGVyYXRpb25zLlxuICAgICAqIEBwYXJhbSBkb2N1bWVudEtleSAtIFRoZSBrZXkgb2YgdGhlIGVudHJ5IHRvIGxvb2sgdXAuXG4gICAgICogQHJldHVybnMgVGhlIGNhY2hlZCBkb2N1bWVudCBvciBhbiBpbnZhbGlkIGRvY3VtZW50IGlmIHdlIGhhdmUgbm90aGluZ1xuICAgICAqIGNhY2hlZC5cbiAgICAgKi8gICAgZ2V0RW50cnkodCwgZSkge1xuICAgICAgICB0aGlzLmFzc2VydE5vdEFwcGxpZWQoKTtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMuY2hhbmdlcy5nZXQoZSk7XG4gICAgICAgIHJldHVybiB2b2lkIDAgIT09IG4gPyBLcy5yZXNvbHZlKG4uZG9jdW1lbnQpIDogdGhpcy5nZXRGcm9tQ2FjaGUodCwgZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIExvb2tzIHVwIHNldmVyYWwgZW50cmllcyBpbiB0aGUgY2FjaGUsIGZvcndhcmRpbmcgdG9cbiAgICAgKiBgUmVtb3RlRG9jdW1lbnRDYWNoZS5nZXRFbnRyeSgpYC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB0cmFuc2FjdGlvbiAtIFRoZSB0cmFuc2FjdGlvbiBpbiB3aGljaCB0byBwZXJmb3JtIGFueSBwZXJzaXN0ZW5jZVxuICAgICAqICAgICBvcGVyYXRpb25zLlxuICAgICAqIEBwYXJhbSBkb2N1bWVudEtleXMgLSBUaGUga2V5cyBvZiB0aGUgZW50cmllcyB0byBsb29rIHVwLlxuICAgICAqIEByZXR1cm5zIEEgbWFwIG9mIGNhY2hlZCBkb2N1bWVudHMsIGluZGV4ZWQgYnkga2V5LiBJZiBhbiBlbnRyeSBjYW5ub3QgYmVcbiAgICAgKiAgICAgZm91bmQsIHRoZSBjb3JyZXNwb25kaW5nIGtleSB3aWxsIGJlIG1hcHBlZCB0byBhbiBpbnZhbGlkIGRvY3VtZW50LlxuICAgICAqLyAgICBnZXRFbnRyaWVzKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QWxsRnJvbUNhY2hlKHQsIGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBcHBsaWVzIGJ1ZmZlcmVkIGNoYW5nZXMgdG8gdGhlIHVuZGVybHlpbmcgUmVtb3RlRG9jdW1lbnRDYWNoZSwgdXNpbmdcbiAgICAgKiB0aGUgcHJvdmlkZWQgdHJhbnNhY3Rpb24uXG4gICAgICovICAgIGFwcGx5KHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXNzZXJ0Tm90QXBwbGllZCgpLCB0aGlzLmNoYW5nZXNBcHBsaWVkID0gITAsIHRoaXMuYXBwbHlDaGFuZ2VzKHQpO1xuICAgIH1cbiAgICAvKiogSGVscGVyIHRvIGFzc2VydCB0aGlzLmNoYW5nZXMgaXMgbm90IG51bGwgICovICAgIGFzc2VydE5vdEFwcGxpZWQoKSB7fVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBUaGUgUmVtb3RlRG9jdW1lbnRDYWNoZSBmb3IgSW5kZXhlZERiLiBUbyBjb25zdHJ1Y3QsIGludm9rZVxuICogYG5ld0luZGV4ZWREYlJlbW90ZURvY3VtZW50Q2FjaGUoKWAuXG4gKi8gY2xhc3MgUWkge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSBzZXJpYWxpemVyIC0gVGhlIGRvY3VtZW50IHNlcmlhbGl6ZXIuXG4gICAgICogQHBhcmFtIGluZGV4TWFuYWdlciAtIFRoZSBxdWVyeSBpbmRleGVzIHRoYXQgbmVlZCB0byBiZSBtYWludGFpbmVkLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5OID0gdCwgdGhpcy5IdCA9IGU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZHMgdGhlIHN1cHBsaWVkIGVudHJpZXMgdG8gdGhlIGNhY2hlLlxuICAgICAqXG4gICAgICogQWxsIGNhbGxzIG9mIGBhZGRFbnRyeWAgYXJlIHJlcXVpcmVkIHRvIGdvIHRocm91Z2ggdGhlIFJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyXG4gICAgICogcmV0dXJuZWQgYnkgYG5ld0NoYW5nZUJ1ZmZlcigpYCB0byBlbnN1cmUgcHJvcGVyIGFjY291bnRpbmcgb2YgbWV0YWRhdGEuXG4gICAgICovICAgIGFkZEVudHJ5KHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIHppKHQpLnB1dChIaShlKSwgbik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgYSBkb2N1bWVudCBmcm9tIHRoZSBjYWNoZS5cbiAgICAgKlxuICAgICAqIEFsbCBjYWxscyBvZiBgcmVtb3ZlRW50cnlgICBhcmUgcmVxdWlyZWQgdG8gZ28gdGhyb3VnaCB0aGUgUmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXJcbiAgICAgKiByZXR1cm5lZCBieSBgbmV3Q2hhbmdlQnVmZmVyKClgIHRvIGVuc3VyZSBwcm9wZXIgYWNjb3VudGluZyBvZiBtZXRhZGF0YS5cbiAgICAgKi8gICAgcmVtb3ZlRW50cnkodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gemkodCksIHMgPSBIaShlKTtcbiAgICAgICAgcmV0dXJuIG4uZGVsZXRlKHMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBVcGRhdGVzIHRoZSBjdXJyZW50IGNhY2hlIHNpemUuXG4gICAgICpcbiAgICAgKiBDYWxsZXJzIHRvIGBhZGRFbnRyeSgpYCBhbmQgYHJlbW92ZUVudHJ5KClgICptdXN0KiBjYWxsIHRoaXMgYWZ0ZXJ3YXJkcyB0byB1cGRhdGUgdGhlXG4gICAgICogY2FjaGUncyBtZXRhZGF0YS5cbiAgICAgKi8gICAgdXBkYXRlTWV0YWRhdGEodCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRNZXRhZGF0YSh0KS5uZXh0KChuID0+IChuLmJ5dGVTaXplICs9IGUsIHRoaXMuQWUodCwgbikpKSk7XG4gICAgfVxuICAgIGdldEVudHJ5KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHppKHQpLmdldChIaShlKSkubmV4dCgodCA9PiB0aGlzLlJlKGUsIHQpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIExvb2tzIHVwIGFuIGVudHJ5IGluIHRoZSBjYWNoZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBkb2N1bWVudEtleSAtIFRoZSBrZXkgb2YgdGhlIGVudHJ5IHRvIGxvb2sgdXAuXG4gICAgICogQHJldHVybnMgVGhlIGNhY2hlZCBkb2N1bWVudCBlbnRyeSBhbmQgaXRzIHNpemUuXG4gICAgICovICAgIFBlKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHppKHQpLmdldChIaShlKSkubmV4dCgodCA9PiAoe1xuICAgICAgICAgICAgZG9jdW1lbnQ6IHRoaXMuUmUoZSwgdCksXG4gICAgICAgICAgICBzaXplOiBQaSh0KVxuICAgICAgICB9KSkpO1xuICAgIH1cbiAgICBnZXRFbnRyaWVzKHQsIGUpIHtcbiAgICAgICAgbGV0IG4gPSBwbigpO1xuICAgICAgICByZXR1cm4gdGhpcy5iZSh0LCBlLCAoKHQsIGUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSB0aGlzLlJlKHQsIGUpO1xuICAgICAgICAgICAgbiA9IG4uaW5zZXJ0KHQsIHMpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gbikpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBMb29rcyB1cCBzZXZlcmFsIGVudHJpZXMgaW4gdGhlIGNhY2hlLlxuICAgICAqXG4gICAgICogQHBhcmFtIGRvY3VtZW50S2V5cyAtIFRoZSBzZXQgb2Yga2V5cyBlbnRyaWVzIHRvIGxvb2sgdXAuXG4gICAgICogQHJldHVybnMgQSBtYXAgb2YgZG9jdW1lbnRzIGluZGV4ZWQgYnkga2V5IGFuZCBhIG1hcCBvZiBzaXplcyBpbmRleGVkIGJ5XG4gICAgICogICAgIGtleSAoemVybyBpZiB0aGUgZG9jdW1lbnQgZG9lcyBub3QgZXhpc3QpLlxuICAgICAqLyAgICB2ZSh0LCBlKSB7XG4gICAgICAgIGxldCBuID0gcG4oKSwgcyA9IG5ldyBkbihQdC5jb21wYXJhdG9yKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuYmUodCwgZSwgKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBpID0gdGhpcy5SZSh0LCBlKTtcbiAgICAgICAgICAgIG4gPSBuLmluc2VydCh0LCBpKSwgcyA9IHMuaW5zZXJ0KHQsIFBpKGUpKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+ICh7XG4gICAgICAgICAgICBkb2N1bWVudHM6IG4sXG4gICAgICAgICAgICBWZTogc1xuICAgICAgICB9KSkpO1xuICAgIH1cbiAgICBiZSh0LCBlLCBuKSB7XG4gICAgICAgIGlmIChlLmlzRW1wdHkoKSkgcmV0dXJuIEtzLnJlc29sdmUoKTtcbiAgICAgICAgY29uc3QgcyA9IElEQktleVJhbmdlLmJvdW5kKGUuZmlyc3QoKS5wYXRoLnRvQXJyYXkoKSwgZS5sYXN0KCkucGF0aC50b0FycmF5KCkpLCBpID0gZS5nZXRJdGVyYXRvcigpO1xuICAgICAgICBsZXQgciA9IGkuZ2V0TmV4dCgpO1xuICAgICAgICByZXR1cm4gemkodCkuS3Qoe1xuICAgICAgICAgICAgcmFuZ2U6IHNcbiAgICAgICAgfSwgKCh0LCBlLCBzKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBvID0gUHQuZnJvbVNlZ21lbnRzKHQpO1xuICAgICAgICAgICAgLy8gR28gdGhyb3VnaCBrZXlzIG5vdCBmb3VuZCBpbiBjYWNoZS5cbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoO3IgJiYgUHQuY29tcGFyYXRvcihyLCBvKSA8IDA7ICkgbihyLCBudWxsKSwgciA9IGkuZ2V0TmV4dCgpO1xuICAgICAgICAgICAgciAmJiByLmlzRXF1YWwobykgJiYgKFxuICAgICAgICAgICAgLy8gS2V5IGZvdW5kIGluIGNhY2hlLlxuICAgICAgICAgICAgbihyLCBlKSwgciA9IGkuaGFzTmV4dCgpID8gaS5nZXROZXh0KCkgOiBudWxsKSwgXG4gICAgICAgICAgICAvLyBTa2lwIHRvIHRoZSBuZXh0IGtleSAoaWYgdGhlcmUgaXMgb25lKS5cbiAgICAgICAgICAgIHIgPyBzLk10KHIucGF0aC50b0FycmF5KCkpIDogcy5kb25lKCk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiB7XG4gICAgICAgICAgICAvLyBUaGUgcmVzdCBvZiB0aGUga2V5cyBhcmUgbm90IGluIHRoZSBjYWNoZS4gT25lIGNhc2Ugd2hlcmUgYGl0ZXJhdGVgXG4gICAgICAgICAgICAvLyBhYm92ZSB3b24ndCBnbyB0aHJvdWdoIHRoZW0gaXMgd2hlbiB0aGUgY2FjaGUgaXMgZW1wdHkuXG4gICAgICAgICAgICBmb3IgKDtyOyApIG4ociwgbnVsbCksIHIgPSBpLmhhc05leHQoKSA/IGkuZ2V0TmV4dCgpIDogbnVsbDtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBnZXREb2N1bWVudHNNYXRjaGluZ1F1ZXJ5KHQsIGUsIG4pIHtcbiAgICAgICAgbGV0IHMgPSBwbigpO1xuICAgICAgICBjb25zdCBpID0gZS5wYXRoLmxlbmd0aCArIDEsIHIgPSB7fTtcbiAgICAgICAgaWYgKG4uaXNFcXVhbChpdC5taW4oKSkpIHtcbiAgICAgICAgICAgIC8vIERvY3VtZW50cyBhcmUgb3JkZXJlZCBieSBrZXksIHNvIHdlIGNhbiB1c2UgYSBwcmVmaXggc2NhbiB0byBuYXJyb3dcbiAgICAgICAgICAgIC8vIGRvd24gdGhlIGRvY3VtZW50cyB3ZSBuZWVkIHRvIG1hdGNoIHRoZSBxdWVyeSBhZ2FpbnN0LlxuICAgICAgICAgICAgY29uc3QgdCA9IGUucGF0aC50b0FycmF5KCk7XG4gICAgICAgICAgICByLnJhbmdlID0gSURCS2V5UmFuZ2UubG93ZXJCb3VuZCh0KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIEV4ZWN1dGUgYW4gaW5kZXgtZnJlZSBxdWVyeSBhbmQgZmlsdGVyIGJ5IHJlYWQgdGltZS4gVGhpcyBpcyBzYWZlXG4gICAgICAgICAgICAvLyBzaW5jZSBhbGwgZG9jdW1lbnQgY2hhbmdlcyB0byBxdWVyaWVzIHRoYXQgaGF2ZSBhXG4gICAgICAgICAgICAvLyBsYXN0TGltYm9GcmVlU25hcHNob3RWZXJzaW9uIChgc2luY2VSZWFkVGltZWApIGhhdmUgYSByZWFkIHRpbWUgc2V0LlxuICAgICAgICAgICAgY29uc3QgdCA9IGUucGF0aC50b0FycmF5KCksIHMgPSBhaShuKTtcbiAgICAgICAgICAgIHIucmFuZ2UgPSBJREJLZXlSYW5nZS5sb3dlckJvdW5kKFsgdCwgcyBdLCBcbiAgICAgICAgICAgIC8qIG9wZW49ICovICEwKSwgci5pbmRleCA9IENzLmNvbGxlY3Rpb25SZWFkVGltZUluZGV4O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB6aSh0KS5LdChyLCAoKHQsIG4sIHIpID0+IHtcbiAgICAgICAgICAgIC8vIFRoZSBxdWVyeSBpcyBhY3R1YWxseSByZXR1cm5pbmcgYW55IHBhdGggdGhhdCBzdGFydHMgd2l0aCB0aGUgcXVlcnlcbiAgICAgICAgICAgIC8vIHBhdGggcHJlZml4IHdoaWNoIG1heSBpbmNsdWRlIGRvY3VtZW50cyBpbiBzdWJjb2xsZWN0aW9ucy4gRm9yXG4gICAgICAgICAgICAvLyBleGFtcGxlLCBhIHF1ZXJ5IG9uICdyb29tcycgd2lsbCByZXR1cm4gcm9vbXMvYWJjL21lc3NhZ2VzL3h5eCBidXQgd2VcbiAgICAgICAgICAgIC8vIHNob3VsZG4ndCBtYXRjaCBpdC4gRml4IHRoaXMgYnkgZGlzY2FyZGluZyByb3dzIHdpdGggZG9jdW1lbnQga2V5c1xuICAgICAgICAgICAgLy8gbW9yZSB0aGFuIG9uZSBzZWdtZW50IGxvbmdlciB0aGFuIHRoZSBxdWVyeSBwYXRoLlxuICAgICAgICAgICAgaWYgKHQubGVuZ3RoICE9PSBpKSByZXR1cm47XG4gICAgICAgICAgICBjb25zdCBvID0gcmkodGhpcy5OLCBuKTtcbiAgICAgICAgICAgIGUucGF0aC5pc1ByZWZpeE9mKG8ua2V5LnBhdGgpID8gUGUoZSwgbykgJiYgKHMgPSBzLmluc2VydChvLmtleSwgbykpIDogci5kb25lKCk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBzKSk7XG4gICAgfVxuICAgIG5ld0NoYW5nZUJ1ZmZlcih0KSB7XG4gICAgICAgIHJldHVybiBuZXcgV2kodGhpcywgISF0ICYmIHQudHJhY2tSZW1vdmFscyk7XG4gICAgfVxuICAgIGdldFNpemUodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRNZXRhZGF0YSh0KS5uZXh0KCh0ID0+IHQuYnl0ZVNpemUpKTtcbiAgICB9XG4gICAgZ2V0TWV0YWRhdGEodCkge1xuICAgICAgICByZXR1cm4gR2kodCkuZ2V0KE5zLmtleSkubmV4dCgodCA9PiAoTCghIXQpLCB0KSkpO1xuICAgIH1cbiAgICBBZSh0LCBlKSB7XG4gICAgICAgIHJldHVybiBHaSh0KS5wdXQoTnMua2V5LCBlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRGVjb2RlcyBgcmVtb3RlRG9jYCBhbmQgcmV0dXJucyB0aGUgZG9jdW1lbnQgKG9yIG51bGwsIGlmIHRoZSBkb2N1bWVudFxuICAgICAqIGNvcnJlc3BvbmRzIHRvIHRoZSBmb3JtYXQgdXNlZCBmb3Igc2VudGluZWwgZGVsZXRlcykuXG4gICAgICovICAgIFJlKHQsIGUpIHtcbiAgICAgICAgaWYgKGUpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSByaSh0aGlzLk4sIGUpO1xuICAgICAgICAgICAgLy8gV2hldGhlciB0aGUgZG9jdW1lbnQgaXMgYSBzZW50aW5lbCByZW1vdmFsIGFuZCBzaG91bGQgb25seSBiZSB1c2VkIGluIHRoZVxuICAgICAgICAgICAgLy8gYGdldE5ld0RvY3VtZW50Q2hhbmdlcygpYFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodC5pc05vRG9jdW1lbnQoKSAmJiB0LnZlcnNpb24uaXNFcXVhbChpdC5taW4oKSkpKSByZXR1cm4gdDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcXQubmV3SW52YWxpZERvY3VtZW50KHQpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IEluZGV4ZWREYlJlbW90ZURvY3VtZW50Q2FjaGUuXG4gKlxuICogQHBhcmFtIHNlcmlhbGl6ZXIgLSBUaGUgZG9jdW1lbnQgc2VyaWFsaXplci5cbiAqIEBwYXJhbSBpbmRleE1hbmFnZXIgLSBUaGUgcXVlcnkgaW5kZXhlcyB0aGF0IG5lZWQgdG8gYmUgbWFpbnRhaW5lZC5cbiAqL1xuLyoqXG4gKiBIYW5kbGVzIHRoZSBkZXRhaWxzIG9mIGFkZGluZyBhbmQgdXBkYXRpbmcgZG9jdW1lbnRzIGluIHRoZSBJbmRleGVkRGJSZW1vdGVEb2N1bWVudENhY2hlLlxuICpcbiAqIFVubGlrZSB0aGUgTWVtb3J5UmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXIsIHRoZSBJbmRleGVkRGIgaW1wbGVtZW50YXRpb24gY29tcHV0ZXMgdGhlIHNpemVcbiAqIGRlbHRhIGZvciBhbGwgc3VibWl0dGVkIGNoYW5nZXMuIFRoaXMgYXZvaWRzIGhhdmluZyB0byByZS1yZWFkIGFsbCBkb2N1bWVudHMgZnJvbSBJbmRleGVkRGJcbiAqIHdoZW4gd2UgYXBwbHkgdGhlIGNoYW5nZXMuXG4gKi9cbmNsYXNzIFdpIGV4dGVuZHMgamkge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSBkb2N1bWVudENhY2hlIC0gVGhlIEluZGV4ZWREYlJlbW90ZURvY3VtZW50Q2FjaGUgdG8gYXBwbHkgdGhlIGNoYW5nZXMgdG8uXG4gICAgICogQHBhcmFtIHRyYWNrUmVtb3ZhbHMgLSBXaGV0aGVyIHRvIGNyZWF0ZSBzZW50aW5lbCBkZWxldGVzIHRoYXQgY2FuIGJlIHRyYWNrZWQgYnlcbiAgICAgKiBgZ2V0TmV3RG9jdW1lbnRDaGFuZ2VzKClgLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5TZSA9IHQsIHRoaXMudHJhY2tSZW1vdmFscyA9IGUsIFxuICAgICAgICAvLyBBIG1hcCBvZiBkb2N1bWVudCBzaXplcyBwcmlvciB0byBhcHBseWluZyB0aGUgY2hhbmdlcyBpbiB0aGlzIGJ1ZmZlci5cbiAgICAgICAgdGhpcy5EZSA9IG5ldyBLaSgodCA9PiB0LnRvU3RyaW5nKCkpLCAoKHQsIGUpID0+IHQuaXNFcXVhbChlKSkpO1xuICAgIH1cbiAgICBhcHBseUNoYW5nZXModCkge1xuICAgICAgICBjb25zdCBlID0gW107XG4gICAgICAgIGxldCBuID0gMCwgcyA9IG5ldyBtbigoKHQsIGUpID0+IHR0KHQuY2Fub25pY2FsU3RyaW5nKCksIGUuY2Fub25pY2FsU3RyaW5nKCkpKSk7XG4gICAgICAgIHJldHVybiB0aGlzLmNoYW5nZXMuZm9yRWFjaCgoKGksIHIpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG8gPSB0aGlzLkRlLmdldChpKTtcbiAgICAgICAgICAgIGlmIChyLmRvY3VtZW50LmlzVmFsaWREb2N1bWVudCgpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgYSA9IG9pKHRoaXMuU2UuTiwgci5kb2N1bWVudCwgdGhpcy5nZXRSZWFkVGltZShpKSk7XG4gICAgICAgICAgICAgICAgcyA9IHMuYWRkKGkucGF0aC5wb3BMYXN0KCkpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGMgPSBQaShhKTtcbiAgICAgICAgICAgICAgICBuICs9IGMgLSBvLCBlLnB1c2godGhpcy5TZS5hZGRFbnRyeSh0LCBpLCBhKSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG4gLT0gbywgdGhpcy50cmFja1JlbW92YWxzKSB7XG4gICAgICAgICAgICAgICAgLy8gSW4gb3JkZXIgdG8gdHJhY2sgcmVtb3ZhbHMsIHdlIHN0b3JlIGEgXCJzZW50aW5lbCBkZWxldGVcIiBpbiB0aGVcbiAgICAgICAgICAgICAgICAvLyBSZW1vdGVEb2N1bWVudENhY2hlLiBUaGlzIGVudHJ5IGlzIHJlcHJlc2VudGVkIGJ5IGEgTm9Eb2N1bWVudFxuICAgICAgICAgICAgICAgIC8vIHdpdGggYSB2ZXJzaW9uIG9mIDAgYW5kIGlnbm9yZWQgYnkgYG1heWJlRGVjb2RlRG9jdW1lbnQoKWAgYnV0XG4gICAgICAgICAgICAgICAgLy8gcHJlc2VydmVkIGluIGBnZXROZXdEb2N1bWVudENoYW5nZXMoKWAuXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IG9pKHRoaXMuU2UuTiwgcXQubmV3Tm9Eb2N1bWVudChpLCBpdC5taW4oKSksIHRoaXMuZ2V0UmVhZFRpbWUoaSkpO1xuICAgICAgICAgICAgICAgIGUucHVzaCh0aGlzLlNlLmFkZEVudHJ5KHQsIGksIG4pKTtcbiAgICAgICAgICAgIH0gZWxzZSBlLnB1c2godGhpcy5TZS5yZW1vdmVFbnRyeSh0LCBpKSk7XG4gICAgICAgIH0pKSwgcy5mb3JFYWNoKChuID0+IHtcbiAgICAgICAgICAgIGUucHVzaCh0aGlzLlNlLkh0LmFkZFRvQ29sbGVjdGlvblBhcmVudEluZGV4KHQsIG4pKTtcbiAgICAgICAgfSkpLCBlLnB1c2godGhpcy5TZS51cGRhdGVNZXRhZGF0YSh0LCBuKSksIEtzLndhaXRGb3IoZSk7XG4gICAgfVxuICAgIGdldEZyb21DYWNoZSh0LCBlKSB7XG4gICAgICAgIC8vIFJlY29yZCB0aGUgc2l6ZSBvZiBldmVyeXRoaW5nIHdlIGxvYWQgZnJvbSB0aGUgY2FjaGUgc28gd2UgY2FuIGNvbXB1dGUgYSBkZWx0YSBsYXRlci5cbiAgICAgICAgcmV0dXJuIHRoaXMuU2UuUGUodCwgZSkubmV4dCgodCA9PiAodGhpcy5EZS5zZXQoZSwgdC5zaXplKSwgdC5kb2N1bWVudCkpKTtcbiAgICB9XG4gICAgZ2V0QWxsRnJvbUNhY2hlKHQsIGUpIHtcbiAgICAgICAgLy8gUmVjb3JkIHRoZSBzaXplIG9mIGV2ZXJ5dGhpbmcgd2UgbG9hZCBmcm9tIHRoZSBjYWNoZSBzbyB3ZSBjYW4gY29tcHV0ZVxuICAgICAgICAvLyBhIGRlbHRhIGxhdGVyLlxuICAgICAgICByZXR1cm4gdGhpcy5TZS52ZSh0LCBlKS5uZXh0KCgoe2RvY3VtZW50czogdCwgVmU6IGV9KSA9PiAoXG4gICAgICAgIC8vIE5vdGU6IGBnZXRBbGxGcm9tQ2FjaGVgIHJldHVybnMgdHdvIG1hcHMgaW5zdGVhZCBvZiBhIHNpbmdsZSBtYXAgZnJvbVxuICAgICAgICAvLyBrZXlzIHRvIGBEb2N1bWVudFNpemVFbnRyeWBzLiBUaGlzIGlzIHRvIGFsbG93IHJldHVybmluZyB0aGVcbiAgICAgICAgLy8gYE11dGFibGVEb2N1bWVudE1hcGAgZGlyZWN0bHksIHdpdGhvdXQgYSBjb252ZXJzaW9uLlxuICAgICAgICBlLmZvckVhY2goKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLkRlLnNldCh0LCBlKTtcbiAgICAgICAgfSkpLCB0KSkpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gR2kodCkge1xuICAgIHJldHVybiB0aSh0LCBOcy5zdG9yZSk7XG59XG5cbi8qKlxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSByZW1vdGVEb2N1bWVudHMgb2JqZWN0IHN0b3JlLlxuICovIGZ1bmN0aW9uIHppKHQpIHtcbiAgICByZXR1cm4gdGkodCwgQ3Muc3RvcmUpO1xufVxuXG5mdW5jdGlvbiBIaSh0KSB7XG4gICAgcmV0dXJuIHQucGF0aC50b0FycmF5KCk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKiogUGVyZm9ybXMgZGF0YWJhc2UgY3JlYXRpb24gYW5kIHNjaGVtYSB1cGdyYWRlcy4gKi8gY2xhc3MgSmkge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5OID0gdDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUGVyZm9ybXMgZGF0YWJhc2UgY3JlYXRpb24gYW5kIHNjaGVtYSB1cGdyYWRlcy5cbiAgICAgKlxuICAgICAqIE5vdGUgdGhhdCBpbiBwcm9kdWN0aW9uLCB0aGlzIG1ldGhvZCBpcyBvbmx5IGV2ZXIgdXNlZCB0byB1cGdyYWRlIHRoZSBzY2hlbWFcbiAgICAgKiB0byBTQ0hFTUFfVkVSU0lPTi4gRGlmZmVyZW50IHZhbHVlcyBvZiB0b1ZlcnNpb24gYXJlIG9ubHkgdXNlZCBmb3IgdGVzdGluZ1xuICAgICAqIGFuZCBsb2NhbCBmZWF0dXJlIGRldmVsb3BtZW50LlxuICAgICAqLyAgICBDdCh0LCBlLCBuLCBzKSB7XG4gICAgICAgIEwobiA8IHMgJiYgbiA+PSAwICYmIHMgPD0gMTEpO1xuICAgICAgICBjb25zdCBpID0gbmV3IGpzKFwiY3JlYXRlT3JVcGdyYWRlXCIsIGUpO1xuICAgICAgICBuIDwgMSAmJiBzID49IDEgJiYgKGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIHQuY3JlYXRlT2JqZWN0U3RvcmUoUHMuc3RvcmUpO1xuICAgICAgICB9KHQpLCBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICB0LmNyZWF0ZU9iamVjdFN0b3JlKGJzLnN0b3JlLCB7XG4gICAgICAgICAgICAgICAga2V5UGF0aDogYnMua2V5UGF0aFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0LmNyZWF0ZU9iamVjdFN0b3JlKHZzLnN0b3JlLCB7XG4gICAgICAgICAgICAgICAga2V5UGF0aDogdnMua2V5UGF0aCxcbiAgICAgICAgICAgICAgICBhdXRvSW5jcmVtZW50OiAhMFxuICAgICAgICAgICAgfSkuY3JlYXRlSW5kZXgodnMudXNlck11dGF0aW9uc0luZGV4LCB2cy51c2VyTXV0YXRpb25zS2V5UGF0aCwge1xuICAgICAgICAgICAgICAgIHVuaXF1ZTogITBcbiAgICAgICAgICAgIH0pLCB0LmNyZWF0ZU9iamVjdFN0b3JlKFZzLnN0b3JlKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAqIFVwZ3JhZGUgZnVuY3Rpb24gdG8gbWlncmF0ZSB0aGUgJ211dGF0aW9ucycgc3RvcmUgZnJvbSBWMSB0byBWMy4gTG9hZHNcbiAqIGFuZCByZXdyaXRlcyBhbGwgZGF0YS5cbiAqLyAodCksIFlpKHQpLCBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICB0LmNyZWF0ZU9iamVjdFN0b3JlKENzLnN0b3JlKTtcbiAgICAgICAgfSh0KSk7XG4gICAgICAgIC8vIE1pZ3JhdGlvbiAyIHRvIHBvcHVsYXRlIHRoZSB0YXJnZXRHbG9iYWwgb2JqZWN0IG5vIGxvbmdlciBuZWVkZWQgc2luY2VcbiAgICAgICAgLy8gbWlncmF0aW9uIDMgdW5jb25kaXRpb25hbGx5IGNsZWFycyBpdC5cbiAgICAgICAgICAgICAgICBsZXQgciA9IEtzLnJlc29sdmUoKTtcbiAgICAgICAgcmV0dXJuIG4gPCAzICYmIHMgPj0gMyAmJiAoXG4gICAgICAgIC8vIEJyYW5kIG5ldyBjbGllbnRzIGRvbid0IG5lZWQgdG8gZHJvcCBhbmQgcmVjcmVhdGUtLW9ubHkgY2xpZW50cyB0aGF0XG4gICAgICAgIC8vIHBvdGVudGlhbGx5IGhhdmUgY29ycnVwdCBkYXRhLlxuICAgICAgICAwICE9PSBuICYmICghZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgdC5kZWxldGVPYmplY3RTdG9yZShrcy5zdG9yZSksIHQuZGVsZXRlT2JqZWN0U3RvcmUoeHMuc3RvcmUpLCB0LmRlbGV0ZU9iamVjdFN0b3JlKCRzLnN0b3JlKTtcbiAgICAgICAgfSh0KSwgWWkodCkpLCByID0gci5uZXh0KCgoKSA9PiBcbiAgICAgICAgLyoqXG4gKiBDcmVhdGVzIHRoZSB0YXJnZXQgZ2xvYmFsIHNpbmdsZXRvbiByb3cuXG4gKlxuICogQHBhcmFtIHR4biAtIFRoZSB2ZXJzaW9uIHVwZ3JhZGUgdHJhbnNhY3Rpb24gZm9yIGluZGV4ZWRkYlxuICovXG4gICAgICAgIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0LnN0b3JlKCRzLnN0b3JlKSwgbiA9IG5ldyAkcyhcbiAgICAgICAgICAgIC8qaGlnaGVzdFRhcmdldElkPSovIDAsIFxuICAgICAgICAgICAgLypsYXN0TGlzdGVuU2VxdWVuY2VOdW1iZXI9Ki8gMCwgaXQubWluKCkudG9UaW1lc3RhbXAoKSwgXG4gICAgICAgICAgICAvKnRhcmdldENvdW50PSovIDApO1xuICAgICAgICAgICAgcmV0dXJuIGUucHV0KCRzLmtleSwgbik7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gKiBDcmVhdGVzIGluZGljZXMgb24gdGhlIFJlbW90ZURvY3VtZW50cyBzdG9yZSB1c2VkIGZvciBib3RoIG11bHRpLXRhYlxuICogYW5kIEluZGV4LUZyZWUgcXVlcmllcy5cbiAqLyAoaSkpKSksIG4gPCA0ICYmIHMgPj0gNCAmJiAoMCAhPT0gbiAmJiAoXG4gICAgICAgIC8vIFNjaGVtYSB2ZXJzaW9uIDMgdXNlcyBhdXRvLWdlbmVyYXRlZCBrZXlzIHRvIGdlbmVyYXRlIGdsb2JhbGx5IHVuaXF1ZVxuICAgICAgICAvLyBtdXRhdGlvbiBiYXRjaCBJRHMgKHRoaXMgd2FzIHByZXZpb3VzbHkgZW5zdXJlZCBpbnRlcm5hbGx5IGJ5IHRoZVxuICAgICAgICAvLyBjbGllbnQpLiBUbyBtaWdyYXRlIHRvIHRoZSBuZXcgc2NoZW1hLCB3ZSBoYXZlIHRvIHJlYWQgYWxsIG11dGF0aW9uc1xuICAgICAgICAvLyBhbmQgd3JpdGUgdGhlbSBiYWNrIG91dC4gV2UgcHJlc2VydmUgdGhlIGV4aXN0aW5nIGJhdGNoIElEcyB0byBndWFyYW50ZWVcbiAgICAgICAgLy8gY29uc2lzdGVuY3kgd2l0aCBvdGhlciBvYmplY3Qgc3RvcmVzLiBBbnkgZnVydGhlciBtdXRhdGlvbiBiYXRjaCBJRHMgd2lsbFxuICAgICAgICAvLyBiZSBhdXRvLWdlbmVyYXRlZC5cbiAgICAgICAgciA9IHIubmV4dCgoKCkgPT4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgcmV0dXJuIGUuc3RvcmUodnMuc3RvcmUpLkx0KCkubmV4dCgobiA9PiB7XG4gICAgICAgICAgICAgICAgdC5kZWxldGVPYmplY3RTdG9yZSh2cy5zdG9yZSk7XG4gICAgICAgICAgICAgICAgdC5jcmVhdGVPYmplY3RTdG9yZSh2cy5zdG9yZSwge1xuICAgICAgICAgICAgICAgICAgICBrZXlQYXRoOiB2cy5rZXlQYXRoLFxuICAgICAgICAgICAgICAgICAgICBhdXRvSW5jcmVtZW50OiAhMFxuICAgICAgICAgICAgICAgIH0pLmNyZWF0ZUluZGV4KHZzLnVzZXJNdXRhdGlvbnNJbmRleCwgdnMudXNlck11dGF0aW9uc0tleVBhdGgsIHtcbiAgICAgICAgICAgICAgICAgICAgdW5pcXVlOiAhMFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBlLnN0b3JlKHZzLnN0b3JlKSwgaSA9IG4ubWFwKCh0ID0+IHMucHV0KHQpKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEtzLndhaXRGb3IoaSk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH0odCwgaSkpKSksIHIgPSByLm5leHQoKCgpID0+IHtcbiAgICAgICAgICAgICFmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgdC5jcmVhdGVPYmplY3RTdG9yZShGcy5zdG9yZSwge1xuICAgICAgICAgICAgICAgICAgICBrZXlQYXRoOiBGcy5rZXlQYXRoXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KHQpO1xuICAgICAgICB9KSkpLCBuIDwgNSAmJiBzID49IDUgJiYgKHIgPSByLm5leHQoKCgpID0+IHRoaXMuQ2UoaSkpKSksIG4gPCA2ICYmIHMgPj0gNiAmJiAociA9IHIubmV4dCgoKCkgPT4gKGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIHQuY3JlYXRlT2JqZWN0U3RvcmUoTnMuc3RvcmUpO1xuICAgICAgICB9KHQpLCB0aGlzLk5lKGkpKSkpKSwgbiA8IDcgJiYgcyA+PSA3ICYmIChyID0gci5uZXh0KCgoKSA9PiB0aGlzLnhlKGkpKSkpLCBuIDwgOCAmJiBzID49IDggJiYgKHIgPSByLm5leHQoKCgpID0+IHRoaXMua2UodCwgaSkpKSksIFxuICAgICAgICBuIDwgOSAmJiBzID49IDkgJiYgKHIgPSByLm5leHQoKCgpID0+IHtcbiAgICAgICAgICAgIC8vIE11bHRpLVRhYiB1c2VkIHRvIG1hbmFnZSBpdHMgb3duIGNoYW5nZWxvZywgYnV0IHRoaXMgaGFzIGJlZW4gbW92ZWRcbiAgICAgICAgICAgIC8vIHRvIHRoZSBEYlJlbW90ZURvY3VtZW50IG9iamVjdCBzdG9yZSBpdHNlbGYuIFNpbmNlIHRoZSBwcmV2aW91cyBjaGFuZ2VcbiAgICAgICAgICAgIC8vIGxvZyBvbmx5IGNvbnRhaW5lZCB0cmFuc2llbnQgZGF0YSwgd2UgY2FuIGRyb3AgaXRzIG9iamVjdCBzdG9yZS5cbiAgICAgICAgICAgICFmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgdC5vYmplY3RTdG9yZU5hbWVzLmNvbnRhaW5zKFwicmVtb3RlRG9jdW1lbnRDaGFuZ2VzXCIpICYmIHQuZGVsZXRlT2JqZWN0U3RvcmUoXCJyZW1vdGVEb2N1bWVudENoYW5nZXNcIik7XG4gICAgICAgICAgICB9KHQpLCBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQub2JqZWN0U3RvcmUoQ3Muc3RvcmUpO1xuICAgICAgICAgICAgICAgIGUuY3JlYXRlSW5kZXgoQ3MucmVhZFRpbWVJbmRleCwgQ3MucmVhZFRpbWVJbmRleFBhdGgsIHtcbiAgICAgICAgICAgICAgICAgICAgdW5pcXVlOiAhMVxuICAgICAgICAgICAgICAgIH0pLCBlLmNyZWF0ZUluZGV4KENzLmNvbGxlY3Rpb25SZWFkVGltZUluZGV4LCBDcy5jb2xsZWN0aW9uUmVhZFRpbWVJbmRleFBhdGgsIHtcbiAgICAgICAgICAgICAgICAgICAgdW5pcXVlOiAhMVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfShlKTtcbiAgICAgICAgfSkpKSwgbiA8IDEwICYmIHMgPj0gMTAgJiYgKHIgPSByLm5leHQoKCgpID0+IHRoaXMuJGUoaSkpKSksIG4gPCAxMSAmJiBzID49IDExICYmIChyID0gci5uZXh0KCgoKSA9PiB7XG4gICAgICAgICAgICAhZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgICAgIHQuY3JlYXRlT2JqZWN0U3RvcmUoTXMuc3RvcmUsIHtcbiAgICAgICAgICAgICAgICAgICAga2V5UGF0aDogTXMua2V5UGF0aFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSh0KSwgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgICAgIHQuY3JlYXRlT2JqZWN0U3RvcmUoTHMuc3RvcmUsIHtcbiAgICAgICAgICAgICAgICAgICAga2V5UGF0aDogTHMua2V5UGF0aFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gKHQpO1xuICAgICAgICB9KSkpLCByO1xuICAgIH1cbiAgICBOZSh0KSB7XG4gICAgICAgIGxldCBlID0gMDtcbiAgICAgICAgcmV0dXJuIHQuc3RvcmUoQ3Muc3RvcmUpLkt0KCgodCwgbikgPT4ge1xuICAgICAgICAgICAgZSArPSBQaShuKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBuZXcgTnMoZSk7XG4gICAgICAgICAgICByZXR1cm4gdC5zdG9yZShOcy5zdG9yZSkucHV0KE5zLmtleSwgbik7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgQ2UodCkge1xuICAgICAgICBjb25zdCBlID0gdC5zdG9yZShicy5zdG9yZSksIG4gPSB0LnN0b3JlKHZzLnN0b3JlKTtcbiAgICAgICAgcmV0dXJuIGUuTHQoKS5uZXh0KChlID0+IEtzLmZvckVhY2goZSwgKGUgPT4ge1xuICAgICAgICAgICAgY29uc3QgcyA9IElEQktleVJhbmdlLmJvdW5kKFsgZS51c2VySWQsIC0xIF0sIFsgZS51c2VySWQsIGUubGFzdEFja25vd2xlZGdlZEJhdGNoSWQgXSk7XG4gICAgICAgICAgICByZXR1cm4gbi5MdCh2cy51c2VyTXV0YXRpb25zSW5kZXgsIHMpLm5leHQoKG4gPT4gS3MuZm9yRWFjaChuLCAobiA9PiB7XG4gICAgICAgICAgICAgICAgTChuLnVzZXJJZCA9PT0gZS51c2VySWQpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBsaSh0aGlzLk4sIG4pO1xuICAgICAgICAgICAgICAgIHJldHVybiBSaSh0LCBlLnVzZXJJZCwgcykubmV4dCgoKCkgPT4ge30pKTtcbiAgICAgICAgICAgIH0pKSkpO1xuICAgICAgICB9KSkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRW5zdXJlcyB0aGF0IGV2ZXJ5IGRvY3VtZW50IGluIHRoZSByZW1vdGUgZG9jdW1lbnQgY2FjaGUgaGFzIGEgY29ycmVzcG9uZGluZyBzZW50aW5lbCByb3dcbiAgICAgKiB3aXRoIGEgc2VxdWVuY2UgbnVtYmVyLiBNaXNzaW5nIHJvd3MgYXJlIGdpdmVuIHRoZSBtb3N0IHJlY2VudGx5IHVzZWQgc2VxdWVuY2UgbnVtYmVyLlxuICAgICAqLyAgICB4ZSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0LnN0b3JlKGtzLnN0b3JlKSwgbiA9IHQuc3RvcmUoQ3Muc3RvcmUpO1xuICAgICAgICByZXR1cm4gdC5zdG9yZSgkcy5zdG9yZSkuZ2V0KCRzLmtleSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICBjb25zdCBzID0gW107XG4gICAgICAgICAgICByZXR1cm4gbi5LdCgoKG4sIGkpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCByID0gbmV3IHV0KG4pLCBvID0gZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWyAwLCBFcyh0KSBdO1xuICAgICAgICAgICAgICAgIH0ocik7XG4gICAgICAgICAgICAgICAgcy5wdXNoKGUuZ2V0KG8pLm5leHQoKG4gPT4gbiA/IEtzLnJlc29sdmUoKSA6IChuID0+IGUucHV0KG5ldyBrcygwLCBFcyhuKSwgdC5oaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIpKSkocikpKSk7XG4gICAgICAgICAgICB9KSkubmV4dCgoKCkgPT4gS3Mud2FpdEZvcihzKSkpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGtlKHQsIGUpIHtcbiAgICAgICAgLy8gQ3JlYXRlIHRoZSBpbmRleC5cbiAgICAgICAgdC5jcmVhdGVPYmplY3RTdG9yZShPcy5zdG9yZSwge1xuICAgICAgICAgICAga2V5UGF0aDogT3Mua2V5UGF0aFxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgbiA9IGUuc3RvcmUoT3Muc3RvcmUpLCBzID0gbmV3IHBpLCBpID0gdCA9PiB7XG4gICAgICAgICAgICBpZiAocy5hZGQodCkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5sYXN0U2VnbWVudCgpLCBzID0gdC5wb3BMYXN0KCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG4ucHV0KHtcbiAgICAgICAgICAgICAgICAgICAgY29sbGVjdGlvbklkOiBlLFxuICAgICAgICAgICAgICAgICAgICBwYXJlbnQ6IEVzKHMpXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIC8vIEhlbHBlciB0byBhZGQgYW4gaW5kZXggZW50cnkgaWZmIHdlIGhhdmVuJ3QgYWxyZWFkeSB3cml0dGVuIGl0LlxuICAgICAgICAgICAgICAgIC8vIEluZGV4IGV4aXN0aW5nIHJlbW90ZSBkb2N1bWVudHMuXG4gICAgICAgIHJldHVybiBlLnN0b3JlKENzLnN0b3JlKS5LdCh7XG4gICAgICAgICAgICBxdDogITBcbiAgICAgICAgfSwgKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuID0gbmV3IHV0KHQpO1xuICAgICAgICAgICAgcmV0dXJuIGkobi5wb3BMYXN0KCkpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gZS5zdG9yZShWcy5zdG9yZSkuS3Qoe1xuICAgICAgICAgICAgcXQ6ICEwXG4gICAgICAgIH0sICgoW3QsIGUsIG5dLCBzKSA9PiB7XG4gICAgICAgICAgICBjb25zdCByID0gQXMoZSk7XG4gICAgICAgICAgICByZXR1cm4gaShyLnBvcExhc3QoKSk7XG4gICAgICAgIH0pKSkpO1xuICAgIH1cbiAgICAkZSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0LnN0b3JlKHhzLnN0b3JlKTtcbiAgICAgICAgcmV0dXJuIGUuS3QoKCh0LCBuKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzID0gZmkobiksIGkgPSBkaSh0aGlzLk4sIHMpO1xuICAgICAgICAgICAgcmV0dXJuIGUucHV0KGkpO1xuICAgICAgICB9KSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBZaSh0KSB7XG4gICAgdC5jcmVhdGVPYmplY3RTdG9yZShrcy5zdG9yZSwge1xuICAgICAgICBrZXlQYXRoOiBrcy5rZXlQYXRoXG4gICAgfSkuY3JlYXRlSW5kZXgoa3MuZG9jdW1lbnRUYXJnZXRzSW5kZXgsIGtzLmRvY3VtZW50VGFyZ2V0c0tleVBhdGgsIHtcbiAgICAgICAgdW5pcXVlOiAhMFxuICAgIH0pO1xuICAgIC8vIE5PVEU6IFRoaXMgaXMgdW5pcXVlIG9ubHkgYmVjYXVzZSB0aGUgVGFyZ2V0SWQgaXMgdGhlIHN1ZmZpeC5cbiAgICB0LmNyZWF0ZU9iamVjdFN0b3JlKHhzLnN0b3JlLCB7XG4gICAgICAgIGtleVBhdGg6IHhzLmtleVBhdGhcbiAgICB9KS5jcmVhdGVJbmRleCh4cy5xdWVyeVRhcmdldHNJbmRleE5hbWUsIHhzLnF1ZXJ5VGFyZ2V0c0tleVBhdGgsIHtcbiAgICAgICAgdW5pcXVlOiAhMFxuICAgIH0pLCB0LmNyZWF0ZU9iamVjdFN0b3JlKCRzLnN0b3JlKTtcbn1cblxuY29uc3QgWGkgPSBcIkZhaWxlZCB0byBvYnRhaW4gZXhjbHVzaXZlIGFjY2VzcyB0byB0aGUgcGVyc2lzdGVuY2UgbGF5ZXIuIFRvIGFsbG93IHNoYXJlZCBhY2Nlc3MsIG11bHRpLXRhYiBzeW5jaHJvbml6YXRpb24gaGFzIHRvIGJlIGVuYWJsZWQgaW4gYWxsIHRhYnMuIElmIHlvdSBhcmUgdXNpbmcgYGV4cGVyaW1lbnRhbEZvcmNlT3duaW5nVGFiOnRydWVgLCBtYWtlIHN1cmUgdGhhdCBvbmx5IG9uZSB0YWIgaGFzIHBlcnNpc3RlbmNlIGVuYWJsZWQgYXQgYW55IGdpdmVuIHRpbWUuXCI7XG5cbi8qKlxuICogT2xkZXN0IGFjY2VwdGFibGUgYWdlIGluIG1pbGxpc2Vjb25kcyBmb3IgY2xpZW50IG1ldGFkYXRhIGJlZm9yZSB0aGUgY2xpZW50XG4gKiBpcyBjb25zaWRlcmVkIGluYWN0aXZlIGFuZCBpdHMgYXNzb2NpYXRlZCBkYXRhIGlzIGdhcmJhZ2UgY29sbGVjdGVkLlxuICovXG4vKipcbiAqIEFuIEluZGV4ZWREQi1iYWNrZWQgaW5zdGFuY2Ugb2YgUGVyc2lzdGVuY2UuIERhdGEgaXMgc3RvcmVkIHBlcnNpc3RlbnRseVxuICogYWNyb3NzIHNlc3Npb25zLlxuICpcbiAqIE9uIFdlYiBvbmx5LCB0aGUgRmlyZXN0b3JlIFNES3Mgc3VwcG9ydCBzaGFyZWQgYWNjZXNzIHRvIGl0cyBwZXJzaXN0ZW5jZVxuICogbGF5ZXIuIFRoaXMgYWxsb3dzIG11bHRpcGxlIGJyb3dzZXIgdGFicyB0byByZWFkIGFuZCB3cml0ZSB0byBJbmRleGVkRGIgYW5kXG4gKiB0byBzeW5jaHJvbml6ZSBzdGF0ZSBldmVuIHdpdGhvdXQgbmV0d29yayBjb25uZWN0aXZpdHkuIFNoYXJlZCBhY2Nlc3MgaXNcbiAqIGN1cnJlbnRseSBvcHRpb25hbCBhbmQgbm90IGVuYWJsZWQgdW5sZXNzIGFsbCBjbGllbnRzIGludm9rZVxuICogYGVuYWJsZVBlcnNpc3RlbmNlKClgIHdpdGggYHtzeW5jaHJvbml6ZVRhYnM6dHJ1ZX1gLlxuICpcbiAqIEluIG11bHRpLXRhYiBtb2RlLCBpZiBtdWx0aXBsZSBjbGllbnRzIGFyZSBhY3RpdmUgYXQgdGhlIHNhbWUgdGltZSwgdGhlIFNES1xuICogd2lsbCBkZXNpZ25hdGUgb25lIGNsaWVudCBhcyB0aGUg4oCccHJpbWFyeSBjbGllbnTigJ0uIEFuIGVmZm9ydCBpcyBtYWRlIHRvIHBpY2tcbiAqIGEgdmlzaWJsZSwgbmV0d29yay1jb25uZWN0ZWQgYW5kIGFjdGl2ZSBjbGllbnQsIGFuZCB0aGlzIGNsaWVudCBpc1xuICogcmVzcG9uc2libGUgZm9yIGxldHRpbmcgb3RoZXIgY2xpZW50cyBrbm93IGFib3V0IGl0cyBwcmVzZW5jZS4gVGhlIHByaW1hcnlcbiAqIGNsaWVudCB3cml0ZXMgYSB1bmlxdWUgY2xpZW50LWdlbmVyYXRlZCBpZGVudGlmaWVyICh0aGUgY2xpZW50IElEKSB0b1xuICogSW5kZXhlZERi4oCZcyDigJxvd25lcuKAnSBzdG9yZSBldmVyeSA0IHNlY29uZHMuIElmIHRoZSBwcmltYXJ5IGNsaWVudCBmYWlscyB0b1xuICogdXBkYXRlIHRoaXMgZW50cnksIGFub3RoZXIgY2xpZW50IGNhbiBhY3F1aXJlIHRoZSBsZWFzZSBhbmQgdGFrZSBvdmVyIGFzXG4gKiBwcmltYXJ5LlxuICpcbiAqIFNvbWUgcGVyc2lzdGVuY2Ugb3BlcmF0aW9ucyBpbiB0aGUgU0RLIGFyZSBkZXNpZ25hdGVkIGFzIHByaW1hcnktY2xpZW50IG9ubHlcbiAqIG9wZXJhdGlvbnMuIFRoaXMgaW5jbHVkZXMgdGhlIGFja25vd2xlZGdtZW50IG9mIG11dGF0aW9ucyBhbmQgYWxsIHVwZGF0ZXMgb2ZcbiAqIHJlbW90ZSBkb2N1bWVudHMuIFRoZSBlZmZlY3RzIG9mIHRoZXNlIG9wZXJhdGlvbnMgYXJlIHdyaXR0ZW4gdG8gcGVyc2lzdGVuY2VcbiAqIGFuZCB0aGVuIGJyb2FkY2FzdCB0byBvdGhlciB0YWJzIHZpYSBMb2NhbFN0b3JhZ2UgKHNlZVxuICogYFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZWApLCB3aGljaCB0aGVuIHJlZnJlc2ggdGhlaXIgc3RhdGUgZnJvbVxuICogcGVyc2lzdGVuY2UuXG4gKlxuICogU2ltaWxhcmx5LCB0aGUgcHJpbWFyeSBjbGllbnQgbGlzdGVucyB0byBub3RpZmljYXRpb25zIHNlbnQgYnkgc2Vjb25kYXJ5XG4gKiBjbGllbnRzIHRvIGRpc2NvdmVyIHBlcnNpc3RlbmNlIGNoYW5nZXMgd3JpdHRlbiBieSBzZWNvbmRhcnkgY2xpZW50cywgc3VjaCBhc1xuICogdGhlIGFkZGl0aW9uIG9mIG5ldyBtdXRhdGlvbnMgYW5kIHF1ZXJ5IHRhcmdldHMuXG4gKlxuICogSWYgbXVsdGktdGFiIGlzIG5vdCBlbmFibGVkIGFuZCBhbm90aGVyIHRhYiBhbHJlYWR5IG9idGFpbmVkIHRoZSBwcmltYXJ5XG4gKiBsZWFzZSwgSW5kZXhlZERiUGVyc2lzdGVuY2UgZW50ZXJzIGEgZmFpbGVkIHN0YXRlIGFuZCBhbGwgc3Vic2VxdWVudFxuICogb3BlcmF0aW9ucyB3aWxsIGF1dG9tYXRpY2FsbHkgZmFpbC5cbiAqXG4gKiBBZGRpdGlvbmFsbHksIHRoZXJlIGlzIGFuIG9wdGltaXphdGlvbiBzbyB0aGF0IHdoZW4gYSB0YWIgaXMgY2xvc2VkLCB0aGVcbiAqIHByaW1hcnkgbGVhc2UgaXMgcmVsZWFzZWQgaW1tZWRpYXRlbHkgKHRoaXMgaXMgZXNwZWNpYWxseSBpbXBvcnRhbnQgdG8gbWFrZVxuICogc3VyZSB0aGF0IGEgcmVmcmVzaGVkIHRhYiBpcyBhYmxlIHRvIGltbWVkaWF0ZWx5IHJlLWFjcXVpcmUgdGhlIHByaW1hcnlcbiAqIGxlYXNlKS4gVW5mb3J0dW5hdGVseSwgSW5kZXhlZERCIGNhbm5vdCBiZSByZWxpYWJseSB1c2VkIGluIHdpbmRvdy51bmxvYWRcbiAqIHNpbmNlIGl0IGlzIGFuIGFzeW5jaHJvbm91cyBBUEkuIFNvIGluIGFkZGl0aW9uIHRvIGF0dGVtcHRpbmcgdG8gZ2l2ZSB1cCB0aGVcbiAqIGxlYXNlLCB0aGUgbGVhc2Vob2xkZXIgd3JpdGVzIGl0cyBjbGllbnQgSUQgdG8gYSBcInpvbWJpZWRDbGllbnRcIiBlbnRyeSBpblxuICogTG9jYWxTdG9yYWdlIHdoaWNoIGFjdHMgYXMgYW4gaW5kaWNhdG9yIHRoYXQgYW5vdGhlciB0YWIgc2hvdWxkIGdvIGFoZWFkIGFuZFxuICogdGFrZSB0aGUgcHJpbWFyeSBsZWFzZSBpbW1lZGlhdGVseSByZWdhcmRsZXNzIG9mIHRoZSBjdXJyZW50IGxlYXNlIHRpbWVzdGFtcC5cbiAqXG4gKiBUT0RPKGIvMTE0MjI2MjM0KTogUmVtb3ZlIGBzeW5jaHJvbml6ZVRhYnNgIHNlY3Rpb24gd2hlbiBtdWx0aS10YWIgaXMgbm9cbiAqIGxvbmdlciBvcHRpb25hbC5cbiAqL1xuY2xhc3MgWmkge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIFdoZXRoZXIgdG8gc3luY2hyb25pemUgdGhlIGluLW1lbW9yeSBzdGF0ZSBvZiBtdWx0aXBsZSB0YWJzIGFuZCBzaGFyZVxuICAgICAqIGFjY2VzcyB0byBsb2NhbCBwZXJzaXN0ZW5jZS5cbiAgICAgKi9cbiAgICB0LCBlLCBuLCBzLCBpLCByLCBvLCBhLCBjLCBcbiAgICAvKipcbiAgICAgKiBJZiBzZXQgdG8gdHJ1ZSwgZm9yY2VmdWxseSBvYnRhaW5zIGRhdGFiYXNlIGFjY2Vzcy4gRXhpc3RpbmcgdGFicyB3aWxsXG4gICAgICogbm8gbG9uZ2VyIGJlIGFibGUgdG8gYWNjZXNzIEluZGV4ZWREQi5cbiAgICAgKi9cbiAgICB1KSB7XG4gICAgICAgIGlmICh0aGlzLmFsbG93VGFiU3luY2hyb25pemF0aW9uID0gdCwgdGhpcy5wZXJzaXN0ZW5jZUtleSA9IGUsIHRoaXMuY2xpZW50SWQgPSBuLCBcbiAgICAgICAgdGhpcy5PZSA9IGksIHRoaXMud2luZG93ID0gciwgdGhpcy5kb2N1bWVudCA9IG8sIHRoaXMuRmUgPSBjLCB0aGlzLk1lID0gdSwgdGhpcy5MZSA9IG51bGwsIFxuICAgICAgICB0aGlzLkJlID0gITEsIHRoaXMuaXNQcmltYXJ5ID0gITEsIHRoaXMubmV0d29ya0VuYWJsZWQgPSAhMCwgXG4gICAgICAgIC8qKiBPdXIgd2luZG93LnVubG9hZCBoYW5kbGVyLCBpZiByZWdpc3RlcmVkLiAqL1xuICAgICAgICB0aGlzLlVlID0gbnVsbCwgdGhpcy5pbkZvcmVncm91bmQgPSAhMSwgXG4gICAgICAgIC8qKiBPdXIgJ3Zpc2liaWxpdHljaGFuZ2UnIGxpc3RlbmVyIGlmIHJlZ2lzdGVyZWQuICovXG4gICAgICAgIHRoaXMucWUgPSBudWxsLCBcbiAgICAgICAgLyoqIFRoZSBjbGllbnQgbWV0YWRhdGEgcmVmcmVzaCB0YXNrLiAqL1xuICAgICAgICB0aGlzLktlID0gbnVsbCwgXG4gICAgICAgIC8qKiBUaGUgbGFzdCB0aW1lIHdlIGdhcmJhZ2UgY29sbGVjdGVkIHRoZSBjbGllbnQgbWV0YWRhdGEgb2JqZWN0IHN0b3JlLiAqL1xuICAgICAgICB0aGlzLmplID0gTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZLCBcbiAgICAgICAgLyoqIEEgbGlzdGVuZXIgdG8gbm90aWZ5IG9uIHByaW1hcnkgc3RhdGUgY2hhbmdlcy4gKi9cbiAgICAgICAgdGhpcy5RZSA9IHQgPT4gUHJvbWlzZS5yZXNvbHZlKCksICFaaS5QdCgpKSB0aHJvdyBuZXcgSyhxLlVOSU1QTEVNRU5URUQsIFwiVGhpcyBwbGF0Zm9ybSBpcyBlaXRoZXIgbWlzc2luZyBJbmRleGVkREIgb3IgaXMga25vd24gdG8gaGF2ZSBhbiBpbmNvbXBsZXRlIGltcGxlbWVudGF0aW9uLiBPZmZsaW5lIHBlcnNpc3RlbmNlIGhhcyBiZWVuIGRpc2FibGVkLlwiKTtcbiAgICAgICAgdGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZSA9IG5ldyBVaSh0aGlzLCBzKSwgdGhpcy5XZSA9IGUgKyBcIm1haW5cIiwgdGhpcy5OID0gbmV3IGlpKGEpLCBcbiAgICAgICAgdGhpcy5HZSA9IG5ldyBRcyh0aGlzLldlLCAxMSwgbmV3IEppKHRoaXMuTikpLCB0aGlzLnplID0gbmV3IE5pKHRoaXMucmVmZXJlbmNlRGVsZWdhdGUsIHRoaXMuTiksIFxuICAgICAgICB0aGlzLkh0ID0gbmV3IEVpLCB0aGlzLkhlID0gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBRaSh0LCBlKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAqIFJldHVybnMgdGhlIHNldCBvZiBkb2N1bWVudHMgdGhhdCBoYXZlIGNoYW5nZWQgc2luY2UgdGhlIHNwZWNpZmllZCByZWFkXG4gKiB0aW1lLlxuICovXG4gICAgICAgIC8vIFBPUlRJTkcgTk9URTogVGhpcyBpcyBvbmx5IHVzZWQgZm9yIG11bHRpLXRhYiBzeW5jaHJvbml6YXRpb24uXG4gICAgICAgICh0aGlzLk4sIHRoaXMuSHQpLCB0aGlzLkplID0gbmV3IF9pLCB0aGlzLndpbmRvdyAmJiB0aGlzLndpbmRvdy5sb2NhbFN0b3JhZ2UgPyB0aGlzLlllID0gdGhpcy53aW5kb3cubG9jYWxTdG9yYWdlIDogKHRoaXMuWWUgPSBudWxsLCBcbiAgICAgICAgITEgPT09IHUgJiYgJChcIkluZGV4ZWREYlBlcnNpc3RlbmNlXCIsIFwiTG9jYWxTdG9yYWdlIGlzIHVuYXZhaWxhYmxlLiBBcyBhIHJlc3VsdCwgcGVyc2lzdGVuY2UgbWF5IG5vdCB3b3JrIHJlbGlhYmx5LiBJbiBwYXJ0aWN1bGFyIGVuYWJsZVBlcnNpc3RlbmNlKCkgY291bGQgZmFpbCBpbW1lZGlhdGVseSBhZnRlciByZWZyZXNoaW5nIHRoZSBwYWdlLlwiKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEF0dGVtcHQgdG8gc3RhcnQgSW5kZXhlZERiIHBlcnNpc3RlbmNlLlxuICAgICAqXG4gICAgICogQHJldHVybnMgV2hldGhlciBwZXJzaXN0ZW5jZSB3YXMgZW5hYmxlZC5cbiAgICAgKi8gICAgc3RhcnQoKSB7XG4gICAgICAgIC8vIE5PVEU6IFRoaXMgaXMgZXhwZWN0ZWQgdG8gZmFpbCBzb21ldGltZXMgKGluIHRoZSBjYXNlIG9mIGFub3RoZXIgdGFiXG4gICAgICAgIC8vIGFscmVhZHkgaGF2aW5nIHRoZSBwZXJzaXN0ZW5jZSBsb2NrKSwgc28gaXQncyB0aGUgZmlyc3QgdGhpbmcgd2Ugc2hvdWxkXG4gICAgICAgIC8vIGRvLlxuICAgICAgICByZXR1cm4gdGhpcy5YZSgpLnRoZW4oKCgpID0+IHtcbiAgICAgICAgICAgIGlmICghdGhpcy5pc1ByaW1hcnkgJiYgIXRoaXMuYWxsb3dUYWJTeW5jaHJvbml6YXRpb24pIFxuICAgICAgICAgICAgLy8gRmFpbCBgc3RhcnQoKWAgaWYgYHN5bmNocm9uaXplVGFic2AgaXMgZGlzYWJsZWQgYW5kIHdlIGNhbm5vdFxuICAgICAgICAgICAgLy8gb2J0YWluIHRoZSBwcmltYXJ5IGxlYXNlLlxuICAgICAgICAgICAgdGhyb3cgbmV3IEsocS5GQUlMRURfUFJFQ09ORElUSU9OLCBYaSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5aZSgpLCB0aGlzLnRuKCksIHRoaXMuZW4oKSwgdGhpcy5ydW5UcmFuc2FjdGlvbihcImdldEhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlclwiLCBcInJlYWRvbmx5XCIsICh0ID0+IHRoaXMuemUuZ2V0SGlnaGVzdFNlcXVlbmNlTnVtYmVyKHQpKSk7XG4gICAgICAgIH0pKS50aGVuKCh0ID0+IHtcbiAgICAgICAgICAgIHRoaXMuTGUgPSBuZXcgWSh0LCB0aGlzLkZlKTtcbiAgICAgICAgfSkpLnRoZW4oKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuQmUgPSAhMDtcbiAgICAgICAgfSkpLmNhdGNoKCh0ID0+ICh0aGlzLkdlICYmIHRoaXMuR2UuY2xvc2UoKSwgUHJvbWlzZS5yZWplY3QodCkpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlZ2lzdGVycyBhIGxpc3RlbmVyIHRoYXQgZ2V0cyBjYWxsZWQgd2hlbiB0aGUgcHJpbWFyeSBzdGF0ZSBvZiB0aGVcbiAgICAgKiBpbnN0YW5jZSBjaGFuZ2VzLiBVcG9uIHJlZ2lzdGVyaW5nLCB0aGlzIGxpc3RlbmVyIGlzIGludm9rZWQgaW1tZWRpYXRlbHlcbiAgICAgKiB3aXRoIHRoZSBjdXJyZW50IHByaW1hcnkgc3RhdGUuXG4gICAgICpcbiAgICAgKiBQT1JUSU5HIE5PVEU6IFRoaXMgaXMgb25seSB1c2VkIGZvciBXZWIgbXVsdGktdGFiLlxuICAgICAqLyAgICBubih0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLlFlID0gYXN5bmMgZSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5zdGFydGVkKSByZXR1cm4gdChlKTtcbiAgICAgICAgfSwgdCh0aGlzLmlzUHJpbWFyeSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlZ2lzdGVycyBhIGxpc3RlbmVyIHRoYXQgZ2V0cyBjYWxsZWQgd2hlbiB0aGUgZGF0YWJhc2UgcmVjZWl2ZXMgYVxuICAgICAqIHZlcnNpb24gY2hhbmdlIGV2ZW50IGluZGljYXRpbmcgdGhhdCBpdCBoYXMgZGVsZXRlZC5cbiAgICAgKlxuICAgICAqIFBPUlRJTkcgTk9URTogVGhpcyBpcyBvbmx5IHVzZWQgZm9yIFdlYiBtdWx0aS10YWIuXG4gICAgICovICAgIHNldERhdGFiYXNlRGVsZXRlZExpc3RlbmVyKHQpIHtcbiAgICAgICAgdGhpcy5HZS54dCgoYXN5bmMgZSA9PiB7XG4gICAgICAgICAgICAvLyBDaGVjayBpZiBhbiBhdHRlbXB0IGlzIG1hZGUgdG8gZGVsZXRlIEluZGV4ZWREQi5cbiAgICAgICAgICAgIG51bGwgPT09IGUubmV3VmVyc2lvbiAmJiBhd2FpdCB0KCk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRqdXN0cyB0aGUgY3VycmVudCBuZXR3b3JrIHN0YXRlIGluIHRoZSBjbGllbnQncyBtZXRhZGF0YSwgcG90ZW50aWFsbHlcbiAgICAgKiBhZmZlY3RpbmcgdGhlIHByaW1hcnkgbGVhc2UuXG4gICAgICpcbiAgICAgKiBQT1JUSU5HIE5PVEU6IFRoaXMgaXMgb25seSB1c2VkIGZvciBXZWIgbXVsdGktdGFiLlxuICAgICAqLyAgICBzZXROZXR3b3JrRW5hYmxlZCh0KSB7XG4gICAgICAgIHRoaXMubmV0d29ya0VuYWJsZWQgIT09IHQgJiYgKHRoaXMubmV0d29ya0VuYWJsZWQgPSB0LCBcbiAgICAgICAgLy8gU2NoZWR1bGUgYSBwcmltYXJ5IGxlYXNlIHJlZnJlc2ggZm9yIGltbWVkaWF0ZSBleGVjdXRpb24uIFRoZSBldmVudHVhbFxuICAgICAgICAvLyBsZWFzZSB1cGRhdGUgd2lsbCBiZSBwcm9wYWdhdGVkIHZpYSBgcHJpbWFyeVN0YXRlTGlzdGVuZXJgLlxuICAgICAgICB0aGlzLk9lLmVucXVldWVBbmRGb3JnZXQoKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc3RhcnRlZCAmJiBhd2FpdCB0aGlzLlhlKCk7XG4gICAgICAgIH0pKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVwZGF0ZXMgdGhlIGNsaWVudCBtZXRhZGF0YSBpbiBJbmRleGVkRGIgYW5kIGF0dGVtcHRzIHRvIGVpdGhlciBvYnRhaW4gb3JcbiAgICAgKiBleHRlbmQgdGhlIHByaW1hcnkgbGVhc2UgZm9yIHRoZSBsb2NhbCBjbGllbnQuIEFzeW5jaHJvbm91c2x5IG5vdGlmaWVzIHRoZVxuICAgICAqIHByaW1hcnkgc3RhdGUgbGlzdGVuZXIgaWYgdGhlIGNsaWVudCBlaXRoZXIgbmV3bHkgb2J0YWluZWQgb3IgcmVsZWFzZWQgaXRzXG4gICAgICogcHJpbWFyeSBsZWFzZS5cbiAgICAgKi8gICAgWGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJ1blRyYW5zYWN0aW9uKFwidXBkYXRlQ2xpZW50TWV0YWRhdGFBbmRUcnlCZWNvbWVQcmltYXJ5XCIsIFwicmVhZHdyaXRlXCIsICh0ID0+IGVyKHQpLnB1dChuZXcgRnModGhpcy5jbGllbnRJZCwgRGF0ZS5ub3coKSwgdGhpcy5uZXR3b3JrRW5hYmxlZCwgdGhpcy5pbkZvcmVncm91bmQpKS5uZXh0KCgoKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5pc1ByaW1hcnkpIHJldHVybiB0aGlzLnNuKHQpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgICAgIHQgfHwgKHRoaXMuaXNQcmltYXJ5ID0gITEsIHRoaXMuT2UuZW5xdWV1ZVJldHJ5YWJsZSgoKCkgPT4gdGhpcy5RZSghMSkpKSk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiB0aGlzLnJuKHQpKSkubmV4dCgoZSA9PiB0aGlzLmlzUHJpbWFyeSAmJiAhZSA/IHRoaXMub24odCkubmV4dCgoKCkgPT4gITEpKSA6ICEhZSAmJiB0aGlzLmFuKHQpLm5leHQoKCgpID0+ICEwKSkpKSkpLmNhdGNoKCh0ID0+IHtcbiAgICAgICAgICAgIGlmICh6cyh0KSkgXG4gICAgICAgICAgICAvLyBQcm9jZWVkIHdpdGggdGhlIGV4aXN0aW5nIHN0YXRlLiBBbnkgc3Vic2VxdWVudCBhY2Nlc3MgdG9cbiAgICAgICAgICAgIC8vIEluZGV4ZWREQiB3aWxsIHZlcmlmeSB0aGUgbGVhc2UuXG4gICAgICAgICAgICByZXR1cm4gayhcIkluZGV4ZWREYlBlcnNpc3RlbmNlXCIsIFwiRmFpbGVkIHRvIGV4dGVuZCBvd25lciBsZWFzZTogXCIsIHQpLCB0aGlzLmlzUHJpbWFyeTtcbiAgICAgICAgICAgIGlmICghdGhpcy5hbGxvd1RhYlN5bmNocm9uaXphdGlvbikgdGhyb3cgdDtcbiAgICAgICAgICAgIHJldHVybiBrKFwiSW5kZXhlZERiUGVyc2lzdGVuY2VcIiwgXCJSZWxlYXNpbmcgb3duZXIgbGVhc2UgYWZ0ZXIgZXJyb3IgZHVyaW5nIGxlYXNlIHJlZnJlc2hcIiwgdCksIFxuICAgICAgICAgICAgLyogaXNQcmltYXJ5PSAqLyAhMTtcbiAgICAgICAgfSkpLnRoZW4oKHQgPT4ge1xuICAgICAgICAgICAgdGhpcy5pc1ByaW1hcnkgIT09IHQgJiYgdGhpcy5PZS5lbnF1ZXVlUmV0cnlhYmxlKCgoKSA9PiB0aGlzLlFlKHQpKSksIHRoaXMuaXNQcmltYXJ5ID0gdDtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBzbih0KSB7XG4gICAgICAgIHJldHVybiB0cih0KS5nZXQoUHMua2V5KS5uZXh0KCh0ID0+IEtzLnJlc29sdmUodGhpcy5jbih0KSkpKTtcbiAgICB9XG4gICAgdW4odCkge1xuICAgICAgICByZXR1cm4gZXIodCkuZGVsZXRlKHRoaXMuY2xpZW50SWQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJZiB0aGUgZ2FyYmFnZSBjb2xsZWN0aW9uIHRocmVzaG9sZCBoYXMgcGFzc2VkLCBwcnVuZXMgdGhlXG4gICAgICogUmVtb3RlRG9jdW1lbnRDaGFuZ2VzIGFuZCB0aGUgQ2xpZW50TWV0YWRhdGEgc3RvcmUgYmFzZWQgb24gdGhlIGxhc3QgdXBkYXRlXG4gICAgICogdGltZSBvZiBhbGwgY2xpZW50cy5cbiAgICAgKi8gICAgYXN5bmMgaG4oKSB7XG4gICAgICAgIGlmICh0aGlzLmlzUHJpbWFyeSAmJiAhdGhpcy5sbih0aGlzLmplLCAxOGU1KSkge1xuICAgICAgICAgICAgdGhpcy5qZSA9IERhdGUubm93KCk7XG4gICAgICAgICAgICBjb25zdCB0ID0gYXdhaXQgdGhpcy5ydW5UcmFuc2FjdGlvbihcIm1heWJlR2FyYmFnZUNvbGxlY3RNdWx0aUNsaWVudFN0YXRlXCIsIFwicmVhZHdyaXRlLXByaW1hcnlcIiwgKHQgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aSh0LCBGcy5zdG9yZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGUuTHQoKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuZm4odCwgMThlNSksIHMgPSB0LmZpbHRlcigodCA9PiAtMSA9PT0gbi5pbmRleE9mKHQpKSk7XG4gICAgICAgICAgICAgICAgICAgIC8vIERlbGV0ZSBtZXRhZGF0YSBmb3IgY2xpZW50cyB0aGF0IGFyZSBubyBsb25nZXIgY29uc2lkZXJlZCBhY3RpdmUuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBLcy5mb3JFYWNoKHMsICh0ID0+IGUuZGVsZXRlKHQuY2xpZW50SWQpKSkubmV4dCgoKCkgPT4gcykpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH0pKS5jYXRjaCgoKCkgPT4gW10pKTtcbiAgICAgICAgICAgIC8vIERlbGV0ZSBwb3RlbnRpYWwgbGVmdG92ZXIgZW50cmllcyB0aGF0IG1heSBjb250aW51ZSB0byBtYXJrIHRoZVxuICAgICAgICAgICAgLy8gaW5hY3RpdmUgY2xpZW50cyBhcyB6b21iaWVkIGluIExvY2FsU3RvcmFnZS5cbiAgICAgICAgICAgIC8vIElkZWFsbHkgd2UnZCBkZWxldGUgdGhlIEluZGV4ZWREYiBhbmQgTG9jYWxTdG9yYWdlIHpvbWJpZSBlbnRyaWVzIGZvclxuICAgICAgICAgICAgLy8gdGhlIGNsaWVudCBhdG9taWNhbGx5LCBidXQgd2UgY2FuJ3QuIFNvIHdlIG9wdCB0byBkZWxldGUgdGhlIEluZGV4ZWREYlxuICAgICAgICAgICAgLy8gZW50cmllcyBmaXJzdCB0byBhdm9pZCBwb3RlbnRpYWxseSByZXZpdmluZyBhIHpvbWJpZWQgY2xpZW50LlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuWWUpIGZvciAoY29uc3QgZSBvZiB0KSB0aGlzLlllLnJlbW92ZUl0ZW0odGhpcy5kbihlLmNsaWVudElkKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogU2NoZWR1bGVzIGEgcmVjdXJyaW5nIHRpbWVyIHRvIHVwZGF0ZSB0aGUgY2xpZW50IG1ldGFkYXRhIGFuZCB0byBlaXRoZXJcbiAgICAgKiBleHRlbmQgb3IgYWNxdWlyZSB0aGUgcHJpbWFyeSBsZWFzZSBpZiB0aGUgY2xpZW50IGlzIGVsaWdpYmxlLlxuICAgICAqLyAgICBlbigpIHtcbiAgICAgICAgdGhpcy5LZSA9IHRoaXMuT2UuZW5xdWV1ZUFmdGVyRGVsYXkoXCJjbGllbnRfbWV0YWRhdGFfcmVmcmVzaFwiIC8qIENsaWVudE1ldGFkYXRhUmVmcmVzaCAqLyAsIDRlMywgKCgpID0+IHRoaXMuWGUoKS50aGVuKCgoKSA9PiB0aGlzLmhuKCkpKS50aGVuKCgoKSA9PiB0aGlzLmVuKCkpKSkpO1xuICAgIH1cbiAgICAvKiogQ2hlY2tzIHdoZXRoZXIgYGNsaWVudGAgaXMgdGhlIGxvY2FsIGNsaWVudC4gKi8gICAgY24odCkge1xuICAgICAgICByZXR1cm4gISF0ICYmIHQub3duZXJJZCA9PT0gdGhpcy5jbGllbnRJZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRXZhbHVhdGUgdGhlIHN0YXRlIG9mIGFsbCBhY3RpdmUgY2xpZW50cyBhbmQgZGV0ZXJtaW5lIHdoZXRoZXIgdGhlIGxvY2FsXG4gICAgICogY2xpZW50IGlzIG9yIGNhbiBhY3QgYXMgdGhlIGhvbGRlciBvZiB0aGUgcHJpbWFyeSBsZWFzZS4gUmV0dXJucyB3aGV0aGVyXG4gICAgICogdGhlIGNsaWVudCBpcyBlbGlnaWJsZSBmb3IgdGhlIGxlYXNlLCBidXQgZG9lcyBub3QgYWN0dWFsbHkgYWNxdWlyZSBpdC5cbiAgICAgKiBNYXkgcmV0dXJuICdmYWxzZScgZXZlbiBpZiB0aGVyZSBpcyBubyBhY3RpdmUgbGVhc2Vob2xkZXIgYW5kIGFub3RoZXJcbiAgICAgKiAoZm9yZWdyb3VuZCkgY2xpZW50IHNob3VsZCBiZWNvbWUgbGVhc2Vob2xkZXIgaW5zdGVhZC5cbiAgICAgKi8gICAgcm4odCkge1xuICAgICAgICBpZiAodGhpcy5NZSkgcmV0dXJuIEtzLnJlc29sdmUoITApO1xuICAgICAgICByZXR1cm4gdHIodCkuZ2V0KFBzLmtleSkubmV4dCgoZSA9PiB7XG4gICAgICAgICAgICAvLyBBIGNsaWVudCBpcyBlbGlnaWJsZSBmb3IgdGhlIHByaW1hcnkgbGVhc2UgaWY6XG4gICAgICAgICAgICAvLyAtIGl0cyBuZXR3b3JrIGlzIGVuYWJsZWQgYW5kIHRoZSBjbGllbnQncyB0YWIgaXMgaW4gdGhlIGZvcmVncm91bmQuXG4gICAgICAgICAgICAvLyAtIGl0cyBuZXR3b3JrIGlzIGVuYWJsZWQgYW5kIG5vIG90aGVyIGNsaWVudCdzIHRhYiBpcyBpbiB0aGVcbiAgICAgICAgICAgIC8vICAgZm9yZWdyb3VuZC5cbiAgICAgICAgICAgIC8vIC0gZXZlcnkgY2xpZW50cyBuZXR3b3JrIGlzIGRpc2FibGVkIGFuZCB0aGUgY2xpZW50J3MgdGFiIGlzIGluIHRoZVxuICAgICAgICAgICAgLy8gICBmb3JlZ3JvdW5kLlxuICAgICAgICAgICAgLy8gLSBldmVyeSBjbGllbnRzIG5ldHdvcmsgaXMgZGlzYWJsZWQgYW5kIG5vIG90aGVyIGNsaWVudCdzIHRhYiBpcyBpblxuICAgICAgICAgICAgLy8gICB0aGUgZm9yZWdyb3VuZC5cbiAgICAgICAgICAgIC8vIC0gdGhlIGBmb3JjZU93bmluZ1RhYmAgc2V0dGluZyB3YXMgcGFzc2VkIGluLlxuICAgICAgICAgICAgaWYgKG51bGwgIT09IGUgJiYgdGhpcy5sbihlLmxlYXNlVGltZXN0YW1wTXMsIDVlMykgJiYgIXRoaXMud24oZS5vd25lcklkKSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNuKGUpICYmIHRoaXMubmV0d29ya0VuYWJsZWQpIHJldHVybiAhMDtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuY24oZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFlLmFsbG93VGFiU3luY2hyb25pemF0aW9uKSBcbiAgICAgICAgICAgICAgICAgICAgLy8gRmFpbCB0aGUgYGNhbkFjdEFzUHJpbWFyeWAgY2hlY2sgaWYgdGhlIGN1cnJlbnQgbGVhc2Vob2xkZXIgaGFzXG4gICAgICAgICAgICAgICAgICAgIC8vIG5vdCBvcHRlZCBpbnRvIG11bHRpLXRhYiBzeW5jaHJvbml6YXRpb24uIElmIHRoaXMgaGFwcGVucyBhdFxuICAgICAgICAgICAgICAgICAgICAvLyBjbGllbnQgc3RhcnR1cCwgd2UgcmVqZWN0IHRoZSBQcm9taXNlIHJldHVybmVkIGJ5XG4gICAgICAgICAgICAgICAgICAgIC8vIGBlbmFibGVQZXJzaXN0ZW5jZSgpYCBhbmQgdGhlIHVzZXIgY2FuIGNvbnRpbnVlIHRvIHVzZSBGaXJlc3RvcmVcbiAgICAgICAgICAgICAgICAgICAgLy8gd2l0aCBpbi1tZW1vcnkgcGVyc2lzdGVuY2UuXG4gICAgICAgICAgICAgICAgICAgIC8vIElmIHRoaXMgZmFpbHMgZHVyaW5nIGEgbGVhc2UgcmVmcmVzaCwgd2Ugd2lsbCBpbnN0ZWFkIGJsb2NrIHRoZVxuICAgICAgICAgICAgICAgICAgICAvLyBBc3luY1F1ZXVlIGZyb20gZXhlY3V0aW5nIGZ1cnRoZXIgb3BlcmF0aW9ucy4gTm90ZSB0aGF0IHRoaXMgaXNcbiAgICAgICAgICAgICAgICAgICAgLy8gYWNjZXB0YWJsZSBzaW5jZSBtaXhpbmcgJiBtYXRjaGluZyBkaWZmZXJlbnQgYHN5bmNocm9uaXplVGFic2BcbiAgICAgICAgICAgICAgICAgICAgLy8gc2V0dGluZ3MgaXMgbm90IHN1cHBvcnRlZC5cbiAgICAgICAgICAgICAgICAgICAgLy8gVE9ETyhiLzExNDIyNjIzNCk6IFJlbW92ZSB0aGlzIGNoZWNrIHdoZW4gYHN5bmNocm9uaXplVGFic2AgY2FuXG4gICAgICAgICAgICAgICAgICAgIC8vIG5vIGxvbmdlciBiZSB0dXJuZWQgb2ZmLlxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSyhxLkZBSUxFRF9QUkVDT05ESVRJT04sIFhpKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICExO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAhKCF0aGlzLm5ldHdvcmtFbmFibGVkIHx8ICF0aGlzLmluRm9yZWdyb3VuZCkgfHwgZXIodCkuTHQoKS5uZXh0KCh0ID0+IHZvaWQgMCA9PT0gdGhpcy5mbih0LCA1ZTMpLmZpbmQoKHQgPT4ge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNsaWVudElkICE9PSB0LmNsaWVudElkKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSAhdGhpcy5uZXR3b3JrRW5hYmxlZCAmJiB0Lm5ldHdvcmtFbmFibGVkLCBuID0gIXRoaXMuaW5Gb3JlZ3JvdW5kICYmIHQuaW5Gb3JlZ3JvdW5kLCBzID0gdGhpcy5uZXR3b3JrRW5hYmxlZCA9PT0gdC5uZXR3b3JrRW5hYmxlZDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUgfHwgbiAmJiBzKSByZXR1cm4gITA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiAhMTtcbiAgICAgICAgICAgIH0pKSkpO1xuICAgICAgICB9KSkubmV4dCgodCA9PiAodGhpcy5pc1ByaW1hcnkgIT09IHQgJiYgayhcIkluZGV4ZWREYlBlcnNpc3RlbmNlXCIsIGBDbGllbnQgJHt0ID8gXCJpc1wiIDogXCJpcyBub3RcIn0gZWxpZ2libGUgZm9yIGEgcHJpbWFyeSBsZWFzZS5gKSwgXG4gICAgICAgIHQpKSk7XG4gICAgfVxuICAgIGFzeW5jIHNodXRkb3duKCkge1xuICAgICAgICAvLyBUaGUgc2h1dGRvd24oKSBvcGVyYXRpb25zIGFyZSBpZGVtcG90ZW50IGFuZCBjYW4gYmUgY2FsbGVkIGV2ZW4gd2hlblxuICAgICAgICAvLyBzdGFydCgpIGFib3J0ZWQgKGUuZy4gYmVjYXVzZSBpdCBjb3VsZG4ndCBhY3F1aXJlIHRoZSBwZXJzaXN0ZW5jZSBsZWFzZSkuXG4gICAgICAgIHRoaXMuQmUgPSAhMSwgdGhpcy5fbigpLCB0aGlzLktlICYmICh0aGlzLktlLmNhbmNlbCgpLCB0aGlzLktlID0gbnVsbCksIHRoaXMubW4oKSwgXG4gICAgICAgIHRoaXMuZ24oKSwgXG4gICAgICAgIC8vIFVzZSBgU2ltcGxlRGIucnVuVHJhbnNhY3Rpb25gIGRpcmVjdGx5IHRvIGF2b2lkIGZhaWxpbmcgaWYgYW5vdGhlciB0YWJcbiAgICAgICAgLy8gaGFzIG9idGFpbmVkIHRoZSBwcmltYXJ5IGxlYXNlLlxuICAgICAgICBhd2FpdCB0aGlzLkdlLnJ1blRyYW5zYWN0aW9uKFwic2h1dGRvd25cIiwgXCJyZWFkd3JpdGVcIiwgWyBQcy5zdG9yZSwgRnMuc3RvcmUgXSwgKHQgPT4ge1xuICAgICAgICAgICAgY29uc3QgZSA9IG5ldyBacyh0LCBZLlQpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMub24oZSkubmV4dCgoKCkgPT4gdGhpcy51bihlKSkpO1xuICAgICAgICB9KSksIHRoaXMuR2UuY2xvc2UoKSwgXG4gICAgICAgIC8vIFJlbW92ZSB0aGUgZW50cnkgbWFya2luZyB0aGUgY2xpZW50IGFzIHpvbWJpZWQgZnJvbSBMb2NhbFN0b3JhZ2Ugc2luY2VcbiAgICAgICAgLy8gd2Ugc3VjY2Vzc2Z1bGx5IGRlbGV0ZWQgaXRzIG1ldGFkYXRhIGZyb20gSW5kZXhlZERiLlxuICAgICAgICB0aGlzLnluKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgY2xpZW50cyB0aGF0IGFyZSBub3Qgem9tYmllZCBhbmQgaGF2ZSBhbiB1cGRhdGVUaW1lIHdpdGhpbiB0aGVcbiAgICAgKiBwcm92aWRlZCB0aHJlc2hvbGQuXG4gICAgICovICAgIGZuKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHQuZmlsdGVyKCh0ID0+IHRoaXMubG4odC51cGRhdGVUaW1lTXMsIGUpICYmICF0aGlzLnduKHQuY2xpZW50SWQpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIElEcyBvZiB0aGUgY2xpZW50cyB0aGF0IGFyZSBjdXJyZW50bHkgYWN0aXZlLiBJZiBtdWx0aS10YWJcbiAgICAgKiBpcyBub3Qgc3VwcG9ydGVkLCByZXR1cm5zIGFuIGFycmF5IHRoYXQgb25seSBjb250YWlucyB0aGUgbG9jYWwgY2xpZW50J3NcbiAgICAgKiBJRC5cbiAgICAgKlxuICAgICAqIFBPUlRJTkcgTk9URTogVGhpcyBpcyBvbmx5IHVzZWQgZm9yIFdlYiBtdWx0aS10YWIuXG4gICAgICovICAgIHBuKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5ydW5UcmFuc2FjdGlvbihcImdldEFjdGl2ZUNsaWVudHNcIiwgXCJyZWFkb25seVwiLCAodCA9PiBlcih0KS5MdCgpLm5leHQoKHQgPT4gdGhpcy5mbih0LCAxOGU1KS5tYXAoKHQgPT4gdC5jbGllbnRJZCkpKSkpKTtcbiAgICB9XG4gICAgZ2V0IHN0YXJ0ZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLkJlO1xuICAgIH1cbiAgICBnZXRNdXRhdGlvblF1ZXVlKHQpIHtcbiAgICAgICAgcmV0dXJuIGJpLll0KHQsIHRoaXMuTiwgdGhpcy5IdCwgdGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZSk7XG4gICAgfVxuICAgIGdldFRhcmdldENhY2hlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy56ZTtcbiAgICB9XG4gICAgZ2V0UmVtb3RlRG9jdW1lbnRDYWNoZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuSGU7XG4gICAgfVxuICAgIGdldEluZGV4TWFuYWdlcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuSHQ7XG4gICAgfVxuICAgIGdldEJ1bmRsZUNhY2hlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5KZTtcbiAgICB9XG4gICAgcnVuVHJhbnNhY3Rpb24odCwgZSwgbikge1xuICAgICAgICBrKFwiSW5kZXhlZERiUGVyc2lzdGVuY2VcIiwgXCJTdGFydGluZyB0cmFuc2FjdGlvbjpcIiwgdCk7XG4gICAgICAgIGNvbnN0IHMgPSBcInJlYWRvbmx5XCIgPT09IGUgPyBcInJlYWRvbmx5XCIgOiBcInJlYWR3cml0ZVwiO1xuICAgICAgICBsZXQgaTtcbiAgICAgICAgLy8gRG8gYWxsIHRyYW5zYWN0aW9ucyBhcyByZWFkd3JpdGUgYWdhaW5zdCBhbGwgb2JqZWN0IHN0b3Jlcywgc2luY2Ugd2VcbiAgICAgICAgLy8gYXJlIHRoZSBvbmx5IHJlYWRlci93cml0ZXIuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuR2UucnVuVHJhbnNhY3Rpb24odCwgcywgQnMsIChzID0+IChpID0gbmV3IFpzKHMsIHRoaXMuTGUgPyB0aGlzLkxlLm5leHQoKSA6IFkuVCksIFxuICAgICAgICBcInJlYWR3cml0ZS1wcmltYXJ5XCIgPT09IGUgPyB0aGlzLnNuKGkpLm5leHQoKHQgPT4gISF0IHx8IHRoaXMucm4oaSkpKS5uZXh0KChlID0+IHtcbiAgICAgICAgICAgIGlmICghZSkgdGhyb3cgJChgRmFpbGVkIHRvIG9idGFpbiBwcmltYXJ5IGxlYXNlIGZvciBhY3Rpb24gJyR7dH0nLmApLCB0aGlzLmlzUHJpbWFyeSA9ICExLCBcbiAgICAgICAgICAgIHRoaXMuT2UuZW5xdWV1ZVJldHJ5YWJsZSgoKCkgPT4gdGhpcy5RZSghMSkpKSwgbmV3IEsocS5GQUlMRURfUFJFQ09ORElUSU9OLCBVcyk7XG4gICAgICAgICAgICByZXR1cm4gbihpKTtcbiAgICAgICAgfSkpLm5leHQoKHQgPT4gdGhpcy5hbihpKS5uZXh0KCgoKSA9PiB0KSkpKSA6IHRoaXMuRW4oaSkubmV4dCgoKCkgPT4gbihpKSkpKSkpLnRoZW4oKHQgPT4gKGkucmFpc2VPbkNvbW1pdHRlZEV2ZW50KCksIFxuICAgICAgICB0KSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBWZXJpZmllcyB0aGF0IHRoZSBjdXJyZW50IHRhYiBpcyB0aGUgcHJpbWFyeSBsZWFzZWhvbGRlciBvciBhbHRlcm5hdGl2ZWx5XG4gICAgICogdGhhdCB0aGUgbGVhc2Vob2xkZXIgaGFzIG9wdGVkIGludG8gbXVsdGktdGFiIHN5bmNocm9uaXphdGlvbi5cbiAgICAgKi9cbiAgICAvLyBUT0RPKGIvMTE0MjI2MjM0KTogUmVtb3ZlIHRoaXMgY2hlY2sgd2hlbiBgc3luY2hyb25pemVUYWJzYCBjYW4gbm8gbG9uZ2VyXG4gICAgLy8gYmUgdHVybmVkIG9mZi5cbiAgICBFbih0KSB7XG4gICAgICAgIHJldHVybiB0cih0KS5nZXQoUHMua2V5KS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgIGlmIChudWxsICE9PSB0ICYmIHRoaXMubG4odC5sZWFzZVRpbWVzdGFtcE1zLCA1ZTMpICYmICF0aGlzLnduKHQub3duZXJJZCkgJiYgIXRoaXMuY24odCkgJiYgISh0aGlzLk1lIHx8IHRoaXMuYWxsb3dUYWJTeW5jaHJvbml6YXRpb24gJiYgdC5hbGxvd1RhYlN5bmNocm9uaXphdGlvbikpIHRocm93IG5ldyBLKHEuRkFJTEVEX1BSRUNPTkRJVElPTiwgWGkpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE9idGFpbnMgb3IgZXh0ZW5kcyB0aGUgbmV3IHByaW1hcnkgbGVhc2UgZm9yIHRoZSBsb2NhbCBjbGllbnQuIFRoaXNcbiAgICAgKiBtZXRob2QgZG9lcyBub3QgdmVyaWZ5IHRoYXQgdGhlIGNsaWVudCBpcyBlbGlnaWJsZSBmb3IgdGhpcyBsZWFzZS5cbiAgICAgKi8gICAgYW4odCkge1xuICAgICAgICBjb25zdCBlID0gbmV3IFBzKHRoaXMuY2xpZW50SWQsIHRoaXMuYWxsb3dUYWJTeW5jaHJvbml6YXRpb24sIERhdGUubm93KCkpO1xuICAgICAgICByZXR1cm4gdHIodCkucHV0KFBzLmtleSwgZSk7XG4gICAgfVxuICAgIHN0YXRpYyBQdCgpIHtcbiAgICAgICAgcmV0dXJuIFFzLlB0KCk7XG4gICAgfVxuICAgIC8qKiBDaGVja3MgdGhlIHByaW1hcnkgbGVhc2UgYW5kIHJlbW92ZXMgaXQgaWYgd2UgYXJlIHRoZSBjdXJyZW50IHByaW1hcnkuICovICAgIG9uKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRyKHQpO1xuICAgICAgICByZXR1cm4gZS5nZXQoUHMua2V5KS5uZXh0KCh0ID0+IHRoaXMuY24odCkgPyAoayhcIkluZGV4ZWREYlBlcnNpc3RlbmNlXCIsIFwiUmVsZWFzaW5nIHByaW1hcnkgbGVhc2UuXCIpLCBcbiAgICAgICAgZS5kZWxldGUoUHMua2V5KSkgOiBLcy5yZXNvbHZlKCkpKTtcbiAgICB9XG4gICAgLyoqIFZlcmlmaWVzIHRoYXQgYHVwZGF0ZVRpbWVNc2AgaXMgd2l0aGluIGBtYXhBZ2VNc2AuICovICAgIGxuKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IERhdGUubm93KCk7XG4gICAgICAgIHJldHVybiAhKHQgPCBuIC0gZSkgJiYgKCEodCA+IG4pIHx8ICgkKGBEZXRlY3RlZCBhbiB1cGRhdGUgdGltZSB0aGF0IGlzIGluIHRoZSBmdXR1cmU6ICR7dH0gPiAke259YCksIFxuICAgICAgICAhMSkpO1xuICAgIH1cbiAgICBaZSgpIHtcbiAgICAgICAgbnVsbCAhPT0gdGhpcy5kb2N1bWVudCAmJiBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIHRoaXMuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lciAmJiAodGhpcy5xZSA9ICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuT2UuZW5xdWV1ZUFuZEZvcmdldCgoKCkgPT4gKHRoaXMuaW5Gb3JlZ3JvdW5kID0gXCJ2aXNpYmxlXCIgPT09IHRoaXMuZG9jdW1lbnQudmlzaWJpbGl0eVN0YXRlLCBcbiAgICAgICAgICAgIHRoaXMuWGUoKSkpKTtcbiAgICAgICAgfSwgdGhpcy5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwidmlzaWJpbGl0eWNoYW5nZVwiLCB0aGlzLnFlKSwgdGhpcy5pbkZvcmVncm91bmQgPSBcInZpc2libGVcIiA9PT0gdGhpcy5kb2N1bWVudC52aXNpYmlsaXR5U3RhdGUpO1xuICAgIH1cbiAgICBtbigpIHtcbiAgICAgICAgdGhpcy5xZSAmJiAodGhpcy5kb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwidmlzaWJpbGl0eWNoYW5nZVwiLCB0aGlzLnFlKSwgdGhpcy5xZSA9IG51bGwpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBdHRhY2hlcyBhIHdpbmRvdy51bmxvYWQgaGFuZGxlciB0aGF0IHdpbGwgc3luY2hyb25vdXNseSB3cml0ZSBvdXJcbiAgICAgKiBjbGllbnRJZCB0byBhIFwiem9tYmllIGNsaWVudCBpZFwiIGxvY2F0aW9uIGluIExvY2FsU3RvcmFnZS4gVGhpcyBjYW4gYmUgdXNlZFxuICAgICAqIGJ5IHRhYnMgdHJ5aW5nIHRvIGFjcXVpcmUgdGhlIHByaW1hcnkgbGVhc2UgdG8gZGV0ZXJtaW5lIHRoYXQgdGhlIGxlYXNlXG4gICAgICogaXMgbm8gbG9uZ2VyIHZhbGlkIGV2ZW4gaWYgdGhlIHRpbWVzdGFtcCBpcyByZWNlbnQuIFRoaXMgaXMgcGFydGljdWxhcmx5XG4gICAgICogaW1wb3J0YW50IGZvciB0aGUgcmVmcmVzaCBjYXNlIChzbyB0aGUgdGFiIGNvcnJlY3RseSByZS1hY3F1aXJlcyB0aGVcbiAgICAgKiBwcmltYXJ5IGxlYXNlKS4gTG9jYWxTdG9yYWdlIGlzIHVzZWQgZm9yIHRoaXMgcmF0aGVyIHRoYW4gSW5kZXhlZERiIGJlY2F1c2VcbiAgICAgKiBpdCBpcyBhIHN5bmNocm9ub3VzIEFQSSBhbmQgc28gY2FuIGJlIHVzZWQgcmVsaWFibHkgZnJvbSAgYW4gdW5sb2FkXG4gICAgICogaGFuZGxlci5cbiAgICAgKi8gICAgdG4oKSB7XG4gICAgICAgIHZhciB0O1xuICAgICAgICBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIChudWxsID09PSAodCA9IHRoaXMud2luZG93KSB8fCB2b2lkIDAgPT09IHQgPyB2b2lkIDAgOiB0LmFkZEV2ZW50TGlzdGVuZXIpICYmICh0aGlzLlVlID0gKCkgPT4ge1xuICAgICAgICAgICAgLy8gTm90ZTogSW4gdGhlb3J5LCB0aGlzIHNob3VsZCBiZSBzY2hlZHVsZWQgb24gdGhlIEFzeW5jUXVldWUgc2luY2UgaXRcbiAgICAgICAgICAgIC8vIGFjY2Vzc2VzIGludGVybmFsIHN0YXRlLiBXZSBleGVjdXRlIHRoaXMgY29kZSBkaXJlY3RseSBkdXJpbmcgc2h1dGRvd25cbiAgICAgICAgICAgIC8vIHRvIG1ha2Ugc3VyZSBpdCBnZXRzIGEgY2hhbmNlIHRvIHJ1bi5cbiAgICAgICAgICAgIHRoaXMuX24oKSwgaCgpICYmIG5hdmlnYXRvci5hcHBWZXJzaW9uLm1hdGNoKFwiVmVyc2lvbi8xNFwiKSAmJiBcbiAgICAgICAgICAgIC8vIE9uIFNhZmFyaSAxNCwgd2UgZG8gbm90IHJ1biBhbnkgY2xlYW51cCBhY3Rpb25zIGFzIGl0IG1pZ2h0IHRyaWdnZXJcbiAgICAgICAgICAgIC8vIGEgYnVnIHRoYXQgcHJldmVudHMgU2FmYXJpIGZyb20gcmUtb3BlbmluZyBJbmRleGVkREIgZHVyaW5nIHRoZVxuICAgICAgICAgICAgLy8gbmV4dCBwYWdlIGxvYWQuXG4gICAgICAgICAgICAvLyBTZWUgaHR0cHM6Ly9idWdzLndlYmtpdC5vcmcvc2hvd19idWcuY2dpP2lkPTIyNjU0N1xuICAgICAgICAgICAgdGhpcy5PZS5lbnRlclJlc3RyaWN0ZWRNb2RlKC8qIHB1cmdlRXhpc3RpbmdUYXNrcz0gKi8gITApLCB0aGlzLk9lLmVucXVldWVBbmRGb3JnZXQoKCgpID0+IHRoaXMuc2h1dGRvd24oKSkpO1xuICAgICAgICB9LCB0aGlzLndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicGFnZWhpZGVcIiwgdGhpcy5VZSkpO1xuICAgIH1cbiAgICBnbigpIHtcbiAgICAgICAgdGhpcy5VZSAmJiAodGhpcy53aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInBhZ2VoaWRlXCIsIHRoaXMuVWUpLCB0aGlzLlVlID0gbnVsbCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgd2hldGhlciBhIGNsaWVudCBpcyBcInpvbWJpZWRcIiBiYXNlZCBvbiBpdHMgTG9jYWxTdG9yYWdlIGVudHJ5LlxuICAgICAqIENsaWVudHMgYmVjb21lIHpvbWJpZWQgd2hlbiB0aGVpciB0YWIgY2xvc2VzIHdpdGhvdXQgcnVubmluZyBhbGwgb2YgdGhlXG4gICAgICogY2xlYW51cCBsb2dpYyBpbiBgc2h1dGRvd24oKWAuXG4gICAgICovICAgIHduKHQpIHtcbiAgICAgICAgdmFyIGU7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBuID0gbnVsbCAhPT0gKG51bGwgPT09IChlID0gdGhpcy5ZZSkgfHwgdm9pZCAwID09PSBlID8gdm9pZCAwIDogZS5nZXRJdGVtKHRoaXMuZG4odCkpKTtcbiAgICAgICAgICAgIHJldHVybiBrKFwiSW5kZXhlZERiUGVyc2lzdGVuY2VcIiwgYENsaWVudCAnJHt0fScgJHtuID8gXCJpc1wiIDogXCJpcyBub3RcIn0gem9tYmllZCBpbiBMb2NhbFN0b3JhZ2VgKSwgXG4gICAgICAgICAgICBuO1xuICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICAvLyBHcmFjZWZ1bGx5IGhhbmRsZSBpZiBMb2NhbFN0b3JhZ2UgaXNuJ3Qgd29ya2luZy5cbiAgICAgICAgICAgIHJldHVybiAkKFwiSW5kZXhlZERiUGVyc2lzdGVuY2VcIiwgXCJGYWlsZWQgdG8gZ2V0IHpvbWJpZWQgY2xpZW50IGlkLlwiLCB0KSwgITE7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVjb3JkIGNsaWVudCBhcyB6b21iaWVkIChhIGNsaWVudCB0aGF0IGhhZCBpdHMgdGFiIGNsb3NlZCkuIFpvbWJpZWRcbiAgICAgKiBjbGllbnRzIGFyZSBpZ25vcmVkIGR1cmluZyBwcmltYXJ5IHRhYiBzZWxlY3Rpb24uXG4gICAgICovICAgIF9uKCkge1xuICAgICAgICBpZiAodGhpcy5ZZSkgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMuWWUuc2V0SXRlbSh0aGlzLmRuKHRoaXMuY2xpZW50SWQpLCBTdHJpbmcoRGF0ZS5ub3coKSkpO1xuICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICAvLyBHcmFjZWZ1bGx5IGhhbmRsZSBpZiBMb2NhbFN0b3JhZ2UgaXNuJ3QgYXZhaWxhYmxlIC8gd29ya2luZy5cbiAgICAgICAgICAgICQoXCJGYWlsZWQgdG8gc2V0IHpvbWJpZSBjbGllbnQgaWQuXCIsIHQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKiBSZW1vdmVzIHRoZSB6b21iaWVkIGNsaWVudCBlbnRyeSBpZiBpdCBleGlzdHMuICovICAgIHluKCkge1xuICAgICAgICBpZiAodGhpcy5ZZSkgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMuWWUucmVtb3ZlSXRlbSh0aGlzLmRuKHRoaXMuY2xpZW50SWQpKTtcbiAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgLy8gSWdub3JlXG4gICAgICAgIH1cbiAgICB9XG4gICAgZG4odCkge1xuICAgICAgICByZXR1cm4gYGZpcmVzdG9yZV96b21iaWVfJHt0aGlzLnBlcnNpc3RlbmNlS2V5fV8ke3R9YDtcbiAgICB9XG59XG5cbi8qKlxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSBwcmltYXJ5IGNsaWVudCBvYmplY3Qgc3RvcmUuXG4gKi8gZnVuY3Rpb24gdHIodCkge1xuICAgIHJldHVybiB0aSh0LCBQcy5zdG9yZSk7XG59XG5cbi8qKlxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSBjbGllbnQgbWV0YWRhdGEgb2JqZWN0IHN0b3JlLlxuICovIGZ1bmN0aW9uIGVyKHQpIHtcbiAgICByZXR1cm4gdGkodCwgRnMuc3RvcmUpO1xufVxuXG4vKipcbiAqIEdlbmVyYXRlcyBhIHN0cmluZyB1c2VkIGFzIGEgcHJlZml4IHdoZW4gc3RvcmluZyBkYXRhIGluIEluZGV4ZWREQiBhbmRcbiAqIExvY2FsU3RvcmFnZS5cbiAqLyBmdW5jdGlvbiBucih0LCBlKSB7XG4gICAgLy8gVXNlIHR3byBkaWZmZXJlbnQgcHJlZml4IGZvcm1hdHM6XG4gICAgLy8gICAqIGZpcmVzdG9yZSAvIHBlcnNpc3RlbmNlS2V5IC8gcHJvamVjdElEIC4gZGF0YWJhc2VJRCAvIC4uLlxuICAgIC8vICAgKiBmaXJlc3RvcmUgLyBwZXJzaXN0ZW5jZUtleSAvIHByb2plY3RJRCAvIC4uLlxuICAgIC8vIHByb2plY3RJRHMgYXJlIEROUy1jb21wYXRpYmxlIG5hbWVzIGFuZCBjYW5ub3QgY29udGFpbiBkb3RzXG4gICAgLy8gc28gdGhlcmUncyBubyBkYW5nZXIgb2YgY29sbGlzaW9ucy5cbiAgICBsZXQgbiA9IHQucHJvamVjdElkO1xuICAgIHJldHVybiB0LmlzRGVmYXVsdERhdGFiYXNlIHx8IChuICs9IFwiLlwiICsgdC5kYXRhYmFzZSksIFwiZmlyZXN0b3JlL1wiICsgZSArIFwiL1wiICsgbiArIFwiL1wiO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY2xhc3Mgc3Ige1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5wcm9ncmVzcyA9IHQsIHRoaXMuVG4gPSBlO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSByZWFkb25seSB2aWV3IG9mIHRoZSBsb2NhbCBzdGF0ZSBvZiBhbGwgZG9jdW1lbnRzIHdlJ3JlIHRyYWNraW5nIChpLmUuIHdlXG4gKiBoYXZlIGEgY2FjaGVkIHZlcnNpb24gaW4gcmVtb3RlRG9jdW1lbnRDYWNoZSBvciBsb2NhbCBtdXRhdGlvbnMgZm9yIHRoZVxuICogZG9jdW1lbnQpLiBUaGUgdmlldyBpcyBjb21wdXRlZCBieSBhcHBseWluZyB0aGUgbXV0YXRpb25zIGluIHRoZVxuICogTXV0YXRpb25RdWV1ZSB0byB0aGUgUmVtb3RlRG9jdW1lbnRDYWNoZS5cbiAqLyBjbGFzcyBpciB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbikge1xuICAgICAgICB0aGlzLkhlID0gdCwgdGhpcy5JbiA9IGUsIHRoaXMuSHQgPSBuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGxvY2FsIHZpZXcgb2YgdGhlIGRvY3VtZW50IGlkZW50aWZpZWQgYnkgYGtleWAuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBMb2NhbCB2aWV3IG9mIHRoZSBkb2N1bWVudCBvciBudWxsIGlmIHdlIGRvbid0IGhhdmUgYW55IGNhY2hlZFxuICAgICAqIHN0YXRlIGZvciBpdC5cbiAgICAgKi8gICAgQW4odCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5Jbi5nZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdEb2N1bWVudEtleSh0LCBlKS5uZXh0KChuID0+IHRoaXMuUm4odCwgZSwgbikpKTtcbiAgICB9XG4gICAgLyoqIEludGVybmFsIHZlcnNpb24gb2YgYGdldERvY3VtZW50YCB0aGF0IGFsbG93cyByZXVzaW5nIGJhdGNoZXMuICovICAgIFJuKHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuSGUuZ2V0RW50cnkodCwgZSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2YgbikgZS5hcHBseVRvTG9jYWxWaWV3KHQpO1xuICAgICAgICAgICAgcmV0dXJuIHQ7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgLy8gUmV0dXJucyB0aGUgdmlldyBvZiB0aGUgZ2l2ZW4gYGRvY3NgIGFzIHRoZXkgd291bGQgYXBwZWFyIGFmdGVyIGFwcGx5aW5nXG4gICAgLy8gYWxsIG11dGF0aW9ucyBpbiB0aGUgZ2l2ZW4gYGJhdGNoZXNgLlxuICAgIFBuKHQsIGUpIHtcbiAgICAgICAgdC5mb3JFYWNoKCgodCwgbikgPT4ge1xuICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIGUpIHQuYXBwbHlUb0xvY2FsVmlldyhuKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBsb2NhbCB2aWV3IG9mIHRoZSBkb2N1bWVudHMgaWRlbnRpZmllZCBieSBga2V5c2AuXG4gICAgICpcbiAgICAgKiBJZiB3ZSBkb24ndCBoYXZlIGNhY2hlZCBzdGF0ZSBmb3IgYSBkb2N1bWVudCBpbiBga2V5c2AsIGEgTm9Eb2N1bWVudCB3aWxsXG4gICAgICogYmUgc3RvcmVkIGZvciB0aGF0IGtleSBpbiB0aGUgcmVzdWx0aW5nIHNldC5cbiAgICAgKi8gICAgYm4odCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5IZS5nZXRFbnRyaWVzKHQsIGUpLm5leHQoKGUgPT4gdGhpcy52bih0LCBlKS5uZXh0KCgoKSA9PiBlKSkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQXBwbGllcyB0aGUgbG9jYWwgdmlldyB0aGUgZ2l2ZW4gYGJhc2VEb2NzYCB3aXRob3V0IHJldHJpZXZpbmcgZG9jdW1lbnRzXG4gICAgICogZnJvbSB0aGUgbG9jYWwgc3RvcmUuXG4gICAgICovICAgIHZuKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuSW4uZ2V0QWxsTXV0YXRpb25CYXRjaGVzQWZmZWN0aW5nRG9jdW1lbnRLZXlzKHQsIGUpLm5leHQoKHQgPT4gdGhpcy5QbihlLCB0KSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQZXJmb3JtcyBhIHF1ZXJ5IGFnYWluc3QgdGhlIGxvY2FsIHZpZXcgb2YgYWxsIGRvY3VtZW50cy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB0cmFuc2FjdGlvbiAtIFRoZSBwZXJzaXN0ZW5jZSB0cmFuc2FjdGlvbi5cbiAgICAgKiBAcGFyYW0gcXVlcnkgLSBUaGUgcXVlcnkgdG8gbWF0Y2ggZG9jdW1lbnRzIGFnYWluc3QuXG4gICAgICogQHBhcmFtIHNpbmNlUmVhZFRpbWUgLSBJZiBub3Qgc2V0IHRvIFNuYXBzaG90VmVyc2lvbi5taW4oKSwgcmV0dXJuIG9ubHlcbiAgICAgKiAgICAgZG9jdW1lbnRzIHRoYXQgaGF2ZSBiZWVuIHJlYWQgc2luY2UgdGhpcyBzbmFwc2hvdCB2ZXJzaW9uIChleGNsdXNpdmUpLlxuICAgICAqLyAgICBnZXREb2N1bWVudHNNYXRjaGluZ1F1ZXJ5KHQsIGUsIG4pIHtcbiAgICAgICAgLyoqXG4gKiBSZXR1cm5zIHdoZXRoZXIgdGhlIHF1ZXJ5IG1hdGNoZXMgYSBzaW5nbGUgZG9jdW1lbnQgYnkgcGF0aCAocmF0aGVyIHRoYW4gYVxuICogY29sbGVjdGlvbikuXG4gKi9cbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIHJldHVybiBQdC5pc0RvY3VtZW50S2V5KHQucGF0aCkgJiYgbnVsbCA9PT0gdC5jb2xsZWN0aW9uR3JvdXAgJiYgMCA9PT0gdC5maWx0ZXJzLmxlbmd0aDtcbiAgICAgICAgfShlKSA/IHRoaXMuVm4odCwgZS5wYXRoKSA6IHllKGUpID8gdGhpcy5Tbih0LCBlLCBuKSA6IHRoaXMuRG4odCwgZSwgbik7XG4gICAgfVxuICAgIFZuKHQsIGUpIHtcbiAgICAgICAgLy8gSnVzdCBkbyBhIHNpbXBsZSBkb2N1bWVudCBsb29rdXAuXG4gICAgICAgIHJldHVybiB0aGlzLkFuKHQsIG5ldyBQdChlKSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICBsZXQgZSA9IFRuKCk7XG4gICAgICAgICAgICByZXR1cm4gdC5pc0ZvdW5kRG9jdW1lbnQoKSAmJiAoZSA9IGUuaW5zZXJ0KHQua2V5LCB0KSksIGU7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgU24odCwgZSwgbikge1xuICAgICAgICBjb25zdCBzID0gZS5jb2xsZWN0aW9uR3JvdXA7XG4gICAgICAgIGxldCBpID0gVG4oKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuSHQuZ2V0Q29sbGVjdGlvblBhcmVudHModCwgcykubmV4dCgociA9PiBLcy5mb3JFYWNoKHIsIChyID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG8gPSBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBsZShlLCBcbiAgICAgICAgICAgICAgICAvKmNvbGxlY3Rpb25Hcm91cD0qLyBudWxsLCB0LmV4cGxpY2l0T3JkZXJCeS5zbGljZSgpLCB0LmZpbHRlcnMuc2xpY2UoKSwgdC5saW1pdCwgdC5saW1pdFR5cGUsIHQuc3RhcnRBdCwgdC5lbmRBdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvKipcbiAqIFJldHVybnMgdHJ1ZSBpZiB0aGlzIHF1ZXJ5IGRvZXMgbm90IHNwZWNpZnkgYW55IHF1ZXJ5IGNvbnN0cmFpbnRzIHRoYXRcbiAqIGNvdWxkIHJlbW92ZSByZXN1bHRzLlxuICovIChlLCByLmNoaWxkKHMpKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLkRuKHQsIG8sIG4pLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgICAgIHQuZm9yRWFjaCgoKHQsIGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaSA9IGkuaW5zZXJ0KHQsIGUpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IGkpKSkpO1xuICAgIH1cbiAgICBEbih0LCBlLCBuKSB7XG4gICAgICAgIC8vIFF1ZXJ5IHRoZSByZW1vdGUgZG9jdW1lbnRzIGFuZCBvdmVybGF5IG11dGF0aW9ucy5cbiAgICAgICAgbGV0IHMsIGk7XG4gICAgICAgIHJldHVybiB0aGlzLkhlLmdldERvY3VtZW50c01hdGNoaW5nUXVlcnkodCwgZSwgbikubmV4dCgobiA9PiAocyA9IG4sIHRoaXMuSW4uZ2V0QWxsTXV0YXRpb25CYXRjaGVzQWZmZWN0aW5nUXVlcnkodCwgZSkpKSkubmV4dCgoZSA9PiAoaSA9IGUsIFxuICAgICAgICB0aGlzLkNuKHQsIGksIHMpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgcyA9IHQ7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgaSkgZm9yIChjb25zdCBlIG9mIHQubXV0YXRpb25zKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IGUua2V5O1xuICAgICAgICAgICAgICAgIGxldCBpID0gcy5nZXQobik7XG4gICAgICAgICAgICAgICAgbnVsbCA9PSBpICYmIChcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgaW52YWxpZCBkb2N1bWVudCB0byBhcHBseSBtdXRhdGlvbnMgb24gdG9wIG9mXG4gICAgICAgICAgICAgICAgaSA9IHF0Lm5ld0ludmFsaWREb2N1bWVudChuKSwgcyA9IHMuaW5zZXJ0KG4sIGkpKSwgSmUoZSwgaSwgdC5sb2NhbFdyaXRlVGltZSksIGkuaXNGb3VuZERvY3VtZW50KCkgfHwgKHMgPSBzLnJlbW92ZShuKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKSkpKS5uZXh0KCgoKSA9PiAoXG4gICAgICAgIC8vIEZpbmFsbHksIGZpbHRlciBvdXQgYW55IGRvY3VtZW50cyB0aGF0IGRvbid0IGFjdHVhbGx5IG1hdGNoXG4gICAgICAgIC8vIHRoZSBxdWVyeS5cbiAgICAgICAgcy5mb3JFYWNoKCgodCwgbikgPT4ge1xuICAgICAgICAgICAgUGUoZSwgbikgfHwgKHMgPSBzLnJlbW92ZSh0KSk7XG4gICAgICAgIH0pKSwgcykpKTtcbiAgICB9XG4gICAgQ24odCwgZSwgbikge1xuICAgICAgICBsZXQgcyA9IFBuKCk7XG4gICAgICAgIGZvciAoY29uc3QgdCBvZiBlKSBmb3IgKGNvbnN0IGUgb2YgdC5tdXRhdGlvbnMpIGUgaW5zdGFuY2VvZiBlbiAmJiBudWxsID09PSBuLmdldChlLmtleSkgJiYgKHMgPSBzLmFkZChlLmtleSkpO1xuICAgICAgICBsZXQgaSA9IG47XG4gICAgICAgIHJldHVybiB0aGlzLkhlLmdldEVudHJpZXModCwgcykubmV4dCgodCA9PiAodC5mb3JFYWNoKCgodCwgZSkgPT4ge1xuICAgICAgICAgICAgZS5pc0ZvdW5kRG9jdW1lbnQoKSAmJiAoaSA9IGkuaW5zZXJ0KHQsIGUpKTtcbiAgICAgICAgfSkpLCBpKSkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSBzZXQgb2YgY2hhbmdlcyB0byB3aGF0IGRvY3VtZW50cyBhcmUgY3VycmVudGx5IGluIHZpZXcgYW5kIG91dCBvZiB2aWV3IGZvclxuICogYSBnaXZlbiBxdWVyeS4gVGhlc2UgY2hhbmdlcyBhcmUgc2VudCB0byB0aGUgTG9jYWxTdG9yZSBieSB0aGUgVmlldyAodmlhXG4gKiB0aGUgU3luY0VuZ2luZSkgYW5kIGFyZSB1c2VkIHRvIHBpbiAvIHVucGluIGRvY3VtZW50cyBhcyBhcHByb3ByaWF0ZS5cbiAqLyBjbGFzcyByciB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcykge1xuICAgICAgICB0aGlzLnRhcmdldElkID0gdCwgdGhpcy5mcm9tQ2FjaGUgPSBlLCB0aGlzLk5uID0gbiwgdGhpcy54biA9IHM7XG4gICAgfVxuICAgIHN0YXRpYyBrbih0LCBlKSB7XG4gICAgICAgIGxldCBuID0gUG4oKSwgcyA9IFBuKCk7XG4gICAgICAgIGZvciAoY29uc3QgdCBvZiBlLmRvY0NoYW5nZXMpIHN3aXRjaCAodC50eXBlKSB7XG4gICAgICAgICAgY2FzZSAwIC8qIEFkZGVkICovIDpcbiAgICAgICAgICAgIG4gPSBuLmFkZCh0LmRvYy5rZXkpO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBjYXNlIDEgLyogUmVtb3ZlZCAqLyA6XG4gICAgICAgICAgICBzID0gcy5hZGQodC5kb2Mua2V5KTtcbiAvLyBkbyBub3RoaW5nXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IHJyKHQsIGUuZnJvbUNhY2hlLCBuLCBzKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEEgcXVlcnkgZW5naW5lIHRoYXQgdGFrZXMgYWR2YW50YWdlIG9mIHRoZSB0YXJnZXQgZG9jdW1lbnQgbWFwcGluZyBpbiB0aGVcbiAqIFF1ZXJ5Q2FjaGUuIFF1ZXJ5IGV4ZWN1dGlvbiBpcyBvcHRpbWl6ZWQgYnkgb25seSByZWFkaW5nIHRoZSBkb2N1bWVudHMgdGhhdFxuICogcHJldmlvdXNseSBtYXRjaGVkIGEgcXVlcnkgcGx1cyBhbnkgZG9jdW1lbnRzIHRoYXQgd2VyZSBlZGl0ZWQgYWZ0ZXIgdGhlXG4gKiBxdWVyeSB3YXMgbGFzdCBsaXN0ZW5lZCB0by5cbiAqXG4gKiBUaGVyZSBhcmUgc29tZSBjYXNlcyB3aGVuIHRoaXMgb3B0aW1pemF0aW9uIGlzIG5vdCBndWFyYW50ZWVkIHRvIHByb2R1Y2VcbiAqIHRoZSBzYW1lIHJlc3VsdHMgYXMgZnVsbCBjb2xsZWN0aW9uIHNjYW5zLiBJbiB0aGVzZSBjYXNlcywgcXVlcnlcbiAqIHByb2Nlc3NpbmcgZmFsbHMgYmFjayB0byBmdWxsIHNjYW5zLiBUaGVzZSBjYXNlcyBhcmU6XG4gKlxuICogLSBMaW1pdCBxdWVyaWVzIHdoZXJlIGEgZG9jdW1lbnQgdGhhdCBtYXRjaGVkIHRoZSBxdWVyeSBwcmV2aW91c2x5IG5vIGxvbmdlclxuICogICBtYXRjaGVzIHRoZSBxdWVyeS5cbiAqXG4gKiAtIExpbWl0IHF1ZXJpZXMgd2hlcmUgYSBkb2N1bWVudCBlZGl0IG1heSBjYXVzZSB0aGUgZG9jdW1lbnQgdG8gc29ydCBiZWxvd1xuICogICBhbm90aGVyIGRvY3VtZW50IHRoYXQgaXMgaW4gdGhlIGxvY2FsIGNhY2hlLlxuICpcbiAqIC0gUXVlcmllcyB0aGF0IGhhdmUgbmV2ZXIgYmVlbiBDVVJSRU5UIG9yIGZyZWUgb2YgbGltYm8gZG9jdW1lbnRzLlxuICovIGNsYXNzIG9yIHtcbiAgICAvKiogU2V0cyB0aGUgZG9jdW1lbnQgdmlldyB0byBxdWVyeSBhZ2FpbnN0LiAqL1xuICAgICRuKHQpIHtcbiAgICAgICAgdGhpcy5PbiA9IHQ7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIGFsbCBsb2NhbCBkb2N1bWVudHMgbWF0Y2hpbmcgdGhlIHNwZWNpZmllZCBxdWVyeS4gKi8gICAgZ2V0RG9jdW1lbnRzTWF0Y2hpbmdRdWVyeSh0LCBlLCBuLCBzKSB7XG4gICAgICAgIC8vIFF1ZXJpZXMgdGhhdCBtYXRjaCBhbGwgZG9jdW1lbnRzIGRvbid0IGJlbmVmaXQgZnJvbSB1c2luZ1xuICAgICAgICAvLyBrZXktYmFzZWQgbG9va3Vwcy4gSXQgaXMgbW9yZSBlZmZpY2llbnQgdG8gc2NhbiBhbGwgZG9jdW1lbnRzIGluIGFcbiAgICAgICAgLy8gY29sbGVjdGlvbiwgcmF0aGVyIHRoYW4gdG8gcGVyZm9ybSBpbmRpdmlkdWFsIGxvb2t1cHMuXG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICByZXR1cm4gMCA9PT0gdC5maWx0ZXJzLmxlbmd0aCAmJiBudWxsID09PSB0LmxpbWl0ICYmIG51bGwgPT0gdC5zdGFydEF0ICYmIG51bGwgPT0gdC5lbmRBdCAmJiAoMCA9PT0gdC5leHBsaWNpdE9yZGVyQnkubGVuZ3RoIHx8IDEgPT09IHQuZXhwbGljaXRPcmRlckJ5Lmxlbmd0aCAmJiB0LmV4cGxpY2l0T3JkZXJCeVswXS5maWVsZC5pc0tleUZpZWxkKCkpO1xuICAgICAgICB9KGUpIHx8IG4uaXNFcXVhbChpdC5taW4oKSkgPyB0aGlzLkZuKHQsIGUpIDogdGhpcy5Pbi5ibih0LCBzKS5uZXh0KChpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLk1uKGUsIGkpO1xuICAgICAgICAgICAgcmV0dXJuICh3ZShlKSB8fCBfZShlKSkgJiYgdGhpcy5MbihlLmxpbWl0VHlwZSwgciwgcywgbikgPyB0aGlzLkZuKHQsIGUpIDogKE4oKSA8PSBjLkRFQlVHICYmIGsoXCJRdWVyeUVuZ2luZVwiLCBcIlJlLXVzaW5nIHByZXZpb3VzIHJlc3VsdCBmcm9tICVzIHRvIGV4ZWN1dGUgcXVlcnk6ICVzXCIsIG4udG9TdHJpbmcoKSwgUmUoZSkpLCBcbiAgICAgICAgICAgIHRoaXMuT24uZ2V0RG9jdW1lbnRzTWF0Y2hpbmdRdWVyeSh0LCBlLCBuKS5uZXh0KCh0ID0+IChcbiAgICAgICAgICAgIC8vIFdlIG1lcmdlIGBwcmV2aW91c1Jlc3VsdHNgIGludG8gYHVwZGF0ZVJlc3VsdHNgLCBzaW5jZVxuICAgICAgICAgICAgLy8gYHVwZGF0ZVJlc3VsdHNgIGlzIGFscmVhZHkgYSBEb2N1bWVudE1hcC4gSWYgYSBkb2N1bWVudCBpc1xuICAgICAgICAgICAgLy8gY29udGFpbmVkIGluIGJvdGggbGlzdHMsIHRoZW4gaXRzIGNvbnRlbnRzIGFyZSB0aGUgc2FtZS5cbiAgICAgICAgICAgIHIuZm9yRWFjaCgoZSA9PiB7XG4gICAgICAgICAgICAgICAgdCA9IHQuaW5zZXJ0KGUua2V5LCBlKTtcbiAgICAgICAgICAgIH0pKSwgdCkpKSk7XG4gICAgICAgIH0pKTtcbiAgICAgICAgLy8gUXVlcmllcyB0aGF0IGhhdmUgbmV2ZXIgc2VlbiBhIHNuYXBzaG90IHdpdGhvdXQgbGltYm8gZnJlZSBkb2N1bWVudHNcbiAgICAgICAgLy8gc2hvdWxkIGFsc28gYmUgcnVuIGFzIGEgZnVsbCBjb2xsZWN0aW9uIHNjYW4uXG4gICAgICAgIH1cbiAgICAvKiogQXBwbGllcyB0aGUgcXVlcnkgZmlsdGVyIGFuZCBzb3J0aW5nIHRvIHRoZSBwcm92aWRlZCBkb2N1bWVudHMuICAqLyAgICBNbih0LCBlKSB7XG4gICAgICAgIC8vIFNvcnQgdGhlIGRvY3VtZW50cyBhbmQgcmUtYXBwbHkgdGhlIHF1ZXJ5IGZpbHRlciBzaW5jZSBwcmV2aW91c2x5XG4gICAgICAgIC8vIG1hdGNoaW5nIGRvY3VtZW50cyBkbyBub3QgbmVjZXNzYXJpbHkgc3RpbGwgbWF0Y2ggdGhlIHF1ZXJ5LlxuICAgICAgICBsZXQgbiA9IG5ldyBtbihiZSh0KSk7XG4gICAgICAgIHJldHVybiBlLmZvckVhY2goKChlLCBzKSA9PiB7XG4gICAgICAgICAgICBQZSh0LCBzKSAmJiAobiA9IG4uYWRkKHMpKTtcbiAgICAgICAgfSkpLCBuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBEZXRlcm1pbmVzIGlmIGEgbGltaXQgcXVlcnkgbmVlZHMgdG8gYmUgcmVmaWxsZWQgZnJvbSBjYWNoZSwgbWFraW5nIGl0XG4gICAgICogaW5lbGlnaWJsZSBmb3IgaW5kZXgtZnJlZSBleGVjdXRpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gc29ydGVkUHJldmlvdXNSZXN1bHRzIC0gVGhlIGRvY3VtZW50cyB0aGF0IG1hdGNoZWQgdGhlIHF1ZXJ5IHdoZW4gaXRcbiAgICAgKiB3YXMgbGFzdCBzeW5jaHJvbml6ZWQsIHNvcnRlZCBieSB0aGUgcXVlcnkncyBjb21wYXJhdG9yLlxuICAgICAqIEBwYXJhbSByZW1vdGVLZXlzIC0gVGhlIGRvY3VtZW50IGtleXMgdGhhdCBtYXRjaGVkIHRoZSBxdWVyeSBhdCB0aGUgbGFzdFxuICAgICAqIHNuYXBzaG90LlxuICAgICAqIEBwYXJhbSBsaW1ib0ZyZWVTbmFwc2hvdFZlcnNpb24gLSBUaGUgdmVyc2lvbiBvZiB0aGUgc25hcHNob3Qgd2hlbiB0aGVcbiAgICAgKiBxdWVyeSB3YXMgbGFzdCBzeW5jaHJvbml6ZWQuXG4gICAgICovICAgIExuKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgLy8gVGhlIHF1ZXJ5IG5lZWRzIHRvIGJlIHJlZmlsbGVkIGlmIGEgcHJldmlvdXNseSBtYXRjaGluZyBkb2N1bWVudCBub1xuICAgICAgICAvLyBsb25nZXIgbWF0Y2hlcy5cbiAgICAgICAgaWYgKG4uc2l6ZSAhPT0gZS5zaXplKSByZXR1cm4gITA7XG4gICAgICAgIC8vIExpbWl0IHF1ZXJpZXMgYXJlIG5vdCBlbGlnaWJsZSBmb3IgaW5kZXgtZnJlZSBxdWVyeSBleGVjdXRpb24gaWYgdGhlcmUgaXNcbiAgICAgICAgLy8gYSBwb3RlbnRpYWwgdGhhdCBhbiBvbGRlciBkb2N1bWVudCBmcm9tIGNhY2hlIG5vdyBzb3J0cyBiZWZvcmUgYSBkb2N1bWVudFxuICAgICAgICAvLyB0aGF0IHdhcyBwcmV2aW91c2x5IHBhcnQgb2YgdGhlIGxpbWl0LiBUaGlzLCBob3dldmVyLCBjYW4gb25seSBoYXBwZW4gaWZcbiAgICAgICAgLy8gdGhlIGRvY3VtZW50IGF0IHRoZSBlZGdlIG9mIHRoZSBsaW1pdCBnb2VzIG91dCBvZiBsaW1pdC5cbiAgICAgICAgLy8gSWYgYSBkb2N1bWVudCB0aGF0IGlzIG5vdCB0aGUgbGltaXQgYm91bmRhcnkgc29ydHMgZGlmZmVyZW50bHksXG4gICAgICAgIC8vIHRoZSBib3VuZGFyeSBvZiB0aGUgbGltaXQgaXRzZWxmIGRpZCBub3QgY2hhbmdlIGFuZCBkb2N1bWVudHMgZnJvbSBjYWNoZVxuICAgICAgICAvLyB3aWxsIGNvbnRpbnVlIHRvIGJlIFwicmVqZWN0ZWRcIiBieSB0aGlzIGJvdW5kYXJ5LiBUaGVyZWZvcmUsIHdlIGNhbiBpZ25vcmVcbiAgICAgICAgLy8gYW55IG1vZGlmaWNhdGlvbnMgdGhhdCBkb24ndCBhZmZlY3QgdGhlIGxhc3QgZG9jdW1lbnQuXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IFwiRlwiIC8qIEZpcnN0ICovID09PSB0ID8gZS5sYXN0KCkgOiBlLmZpcnN0KCk7XG4gICAgICAgIHJldHVybiAhIWkgJiYgKGkuaGFzUGVuZGluZ1dyaXRlcyB8fCBpLnZlcnNpb24uY29tcGFyZVRvKHMpID4gMCk7XG4gICAgfVxuICAgIEZuKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIE4oKSA8PSBjLkRFQlVHICYmIGsoXCJRdWVyeUVuZ2luZVwiLCBcIlVzaW5nIGZ1bGwgY29sbGVjdGlvbiBzY2FuIHRvIGV4ZWN1dGUgcXVlcnk6XCIsIFJlKGUpKSwgXG4gICAgICAgIHRoaXMuT24uZ2V0RG9jdW1lbnRzTWF0Y2hpbmdRdWVyeSh0LCBlLCBpdC5taW4oKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBJbXBsZW1lbnRzIGBMb2NhbFN0b3JlYCBpbnRlcmZhY2UuXG4gKlxuICogTm90ZTogc29tZSBmaWVsZCBkZWZpbmVkIGluIHRoaXMgY2xhc3MgbWlnaHQgaGF2ZSBwdWJsaWMgYWNjZXNzIGxldmVsLCBidXRcbiAqIHRoZSBjbGFzcyBpcyBub3QgZXhwb3J0ZWQgc28gdGhleSBhcmUgb25seSBhY2Nlc3NpYmxlIGZyb20gdGhpcyBtb2R1bGUuXG4gKiBUaGlzIGlzIHVzZWZ1bCB0byBpbXBsZW1lbnQgb3B0aW9uYWwgZmVhdHVyZXMgKGxpa2UgYnVuZGxlcykgaW4gZnJlZVxuICogZnVuY3Rpb25zLCBzdWNoIHRoYXQgdGhleSBhcmUgdHJlZS1zaGFrZWFibGUuXG4gKi9cbmNsYXNzIGFyIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKiogTWFuYWdlcyBvdXIgaW4tbWVtb3J5IG9yIGR1cmFibGUgcGVyc2lzdGVuY2UuICovXG4gICAgdCwgZSwgbiwgcykge1xuICAgICAgICB0aGlzLnBlcnNpc3RlbmNlID0gdCwgdGhpcy5CbiA9IGUsIHRoaXMuTiA9IHMsIFxuICAgICAgICAvKipcbiAgICAgICAgICogTWFwcyBhIHRhcmdldElEIHRvIGRhdGEgYWJvdXQgaXRzIHRhcmdldC5cbiAgICAgICAgICpcbiAgICAgICAgICogUE9SVElORyBOT1RFOiBXZSBhcmUgdXNpbmcgYW4gaW1tdXRhYmxlIGRhdGEgc3RydWN0dXJlIG9uIFdlYiB0byBtYWtlIHJlLXJ1bnNcbiAgICAgICAgICogb2YgYGFwcGx5UmVtb3RlRXZlbnQoKWAgaWRlbXBvdGVudC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuVW4gPSBuZXcgZG4odHQpLCBcbiAgICAgICAgLyoqIE1hcHMgYSB0YXJnZXQgdG8gaXRzIHRhcmdldElELiAqL1xuICAgICAgICAvLyBUT0RPKHd1YW5keSk6IEV2YWx1YXRlIGlmIFRhcmdldElkIGNhbiBiZSBwYXJ0IG9mIFRhcmdldC5cbiAgICAgICAgdGhpcy5xbiA9IG5ldyBLaSgodCA9PiBRdCh0KSksIEd0KSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgcmVhZCB0aW1lIG9mIHRoZSBsYXN0IGVudHJ5IHByb2Nlc3NlZCBieSBgZ2V0TmV3RG9jdW1lbnRDaGFuZ2VzKClgLlxuICAgICAgICAgKlxuICAgICAgICAgKiBQT1JUSU5HIE5PVEU6IFRoaXMgaXMgb25seSB1c2VkIGZvciBtdWx0aS10YWIgc3luY2hyb25pemF0aW9uLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5LbiA9IGl0Lm1pbigpLCB0aGlzLkluID0gdC5nZXRNdXRhdGlvblF1ZXVlKG4pLCB0aGlzLmpuID0gdC5nZXRSZW1vdGVEb2N1bWVudENhY2hlKCksIFxuICAgICAgICB0aGlzLnplID0gdC5nZXRUYXJnZXRDYWNoZSgpLCB0aGlzLlFuID0gbmV3IGlyKHRoaXMuam4sIHRoaXMuSW4sIHRoaXMucGVyc2lzdGVuY2UuZ2V0SW5kZXhNYW5hZ2VyKCkpLCBcbiAgICAgICAgdGhpcy5KZSA9IHQuZ2V0QnVuZGxlQ2FjaGUoKSwgdGhpcy5Cbi4kbih0aGlzLlFuKTtcbiAgICB9XG4gICAgY29sbGVjdEdhcmJhZ2UodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIkNvbGxlY3QgZ2FyYmFnZVwiLCBcInJlYWR3cml0ZS1wcmltYXJ5XCIsIChlID0+IHQuY29sbGVjdChlLCB0aGlzLlVuKSkpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gY3IoXG4vKiogTWFuYWdlcyBvdXIgaW4tbWVtb3J5IG9yIGR1cmFibGUgcGVyc2lzdGVuY2UuICovXG50LCBlLCBuLCBzKSB7XG4gICAgcmV0dXJuIG5ldyBhcih0LCBlLCBuLCBzKTtcbn1cblxuLyoqXG4gKiBUZWxscyB0aGUgTG9jYWxTdG9yZSB0aGF0IHRoZSBjdXJyZW50bHkgYXV0aGVudGljYXRlZCB1c2VyIGhhcyBjaGFuZ2VkLlxuICpcbiAqIEluIHJlc3BvbnNlIHRoZSBsb2NhbCBzdG9yZSBzd2l0Y2hlcyB0aGUgbXV0YXRpb24gcXVldWUgdG8gdGhlIG5ldyB1c2VyIGFuZFxuICogcmV0dXJucyBhbnkgcmVzdWx0aW5nIGRvY3VtZW50IGNoYW5nZXMuXG4gKi9cbi8vIFBPUlRJTkcgTk9URTogQW5kcm9pZCBhbmQgaU9TIG9ubHkgcmV0dXJuIHRoZSBkb2N1bWVudHMgYWZmZWN0ZWQgYnkgdGhlXG4vLyBjaGFuZ2UuXG5hc3luYyBmdW5jdGlvbiB1cih0LCBlKSB7XG4gICAgY29uc3QgbiA9IFUodCk7XG4gICAgbGV0IHMgPSBuLkluLCBpID0gbi5RbjtcbiAgICBjb25zdCByID0gYXdhaXQgbi5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIkhhbmRsZSB1c2VyIGNoYW5nZVwiLCBcInJlYWRvbmx5XCIsICh0ID0+IHtcbiAgICAgICAgLy8gU3dhcCBvdXQgdGhlIG11dGF0aW9uIHF1ZXVlLCBncmFiYmluZyB0aGUgcGVuZGluZyBtdXRhdGlvbiBiYXRjaGVzXG4gICAgICAgIC8vIGJlZm9yZSBhbmQgYWZ0ZXIuXG4gICAgICAgIGxldCByO1xuICAgICAgICByZXR1cm4gbi5Jbi5nZXRBbGxNdXRhdGlvbkJhdGNoZXModCkubmV4dCgobyA9PiAociA9IG8sIHMgPSBuLnBlcnNpc3RlbmNlLmdldE11dGF0aW9uUXVldWUoZSksIFxuICAgICAgICAvLyBSZWNyZWF0ZSBvdXIgTG9jYWxEb2N1bWVudHNWaWV3IHVzaW5nIHRoZSBuZXdcbiAgICAgICAgLy8gTXV0YXRpb25RdWV1ZS5cbiAgICAgICAgaSA9IG5ldyBpcihuLmpuLCBzLCBuLnBlcnNpc3RlbmNlLmdldEluZGV4TWFuYWdlcigpKSwgcy5nZXRBbGxNdXRhdGlvbkJhdGNoZXModCkpKSkubmV4dCgoZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuID0gW10sIHMgPSBbXTtcbiAgICAgICAgICAgIC8vIFVuaW9uIHRoZSBvbGQvbmV3IGNoYW5nZWQga2V5cy5cbiAgICAgICAgICAgIGxldCBvID0gUG4oKTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiByKSB7XG4gICAgICAgICAgICAgICAgbi5wdXNoKHQuYmF0Y2hJZCk7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHQubXV0YXRpb25zKSBvID0gby5hZGQoZS5rZXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIGUpIHtcbiAgICAgICAgICAgICAgICBzLnB1c2godC5iYXRjaElkKTtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdC5tdXRhdGlvbnMpIG8gPSBvLmFkZChlLmtleSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBSZXR1cm4gdGhlIHNldCBvZiBhbGwgKHBvdGVudGlhbGx5KSBjaGFuZ2VkIGRvY3VtZW50cyBhbmQgdGhlIGxpc3RcbiAgICAgICAgICAgIC8vIG9mIG11dGF0aW9uIGJhdGNoIElEcyB0aGF0IHdlcmUgYWZmZWN0ZWQgYnkgY2hhbmdlLlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGkuYm4odCwgbykubmV4dCgodCA9PiAoe1xuICAgICAgICAgICAgICAgIFduOiB0LFxuICAgICAgICAgICAgICAgIHJlbW92ZWRCYXRjaElkczogbixcbiAgICAgICAgICAgICAgICBhZGRlZEJhdGNoSWRzOiBzXG4gICAgICAgICAgICB9KSkpO1xuICAgICAgICB9KSk7XG4gICAgfSkpO1xuICAgIHJldHVybiBuLkluID0gcywgbi5RbiA9IGksIG4uQm4uJG4obi5RbiksIHI7XG59XG5cbi8qIEFjY2VwdHMgbG9jYWxseSBnZW5lcmF0ZWQgTXV0YXRpb25zIGFuZCBjb21taXQgdGhlbSB0byBzdG9yYWdlLiAqL1xuLyoqXG4gKiBBY2tub3dsZWRnZXMgdGhlIGdpdmVuIGJhdGNoLlxuICpcbiAqIE9uIHRoZSBoYXBweSBwYXRoIHdoZW4gYSBiYXRjaCBpcyBhY2tub3dsZWRnZWQsIHRoZSBsb2NhbCBzdG9yZSB3aWxsXG4gKlxuICogICsgcmVtb3ZlIHRoZSBiYXRjaCBmcm9tIHRoZSBtdXRhdGlvbiBxdWV1ZTtcbiAqICArIGFwcGx5IHRoZSBjaGFuZ2VzIHRvIHRoZSByZW1vdGUgZG9jdW1lbnQgY2FjaGU7XG4gKiAgKyByZWNhbGN1bGF0ZSB0aGUgbGF0ZW5jeSBjb21wZW5zYXRlZCB2aWV3IGltcGxpZWQgYnkgdGhvc2UgY2hhbmdlcyAodGhlcmVcbiAqICAgIG1heSBiZSBtdXRhdGlvbnMgaW4gdGhlIHF1ZXVlIHRoYXQgYWZmZWN0IHRoZSBkb2N1bWVudHMgYnV0IGhhdmVuJ3QgYmVlblxuICogICAgYWNrbm93bGVkZ2VkIHlldCk7IGFuZFxuICogICsgZ2l2ZSB0aGUgY2hhbmdlZCBkb2N1bWVudHMgYmFjayB0aGUgc3luYyBlbmdpbmVcbiAqXG4gKiBAcmV0dXJucyBUaGUgcmVzdWx0aW5nIChtb2RpZmllZCkgZG9jdW1lbnRzLlxuICovXG5mdW5jdGlvbiBocih0LCBlKSB7XG4gICAgY29uc3QgbiA9IFUodCk7XG4gICAgcmV0dXJuIG4ucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJBY2tub3dsZWRnZSBiYXRjaFwiLCBcInJlYWR3cml0ZS1wcmltYXJ5XCIsICh0ID0+IHtcbiAgICAgICAgY29uc3QgcyA9IGUuYmF0Y2gua2V5cygpLCBpID0gbi5qbi5uZXdDaGFuZ2VCdWZmZXIoe1xuICAgICAgICAgICAgdHJhY2tSZW1vdmFsczogITBcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0LCBlLCBuLCBzKSB7XG4gICAgICAgICAgICBjb25zdCBpID0gbi5iYXRjaCwgciA9IGkua2V5cygpO1xuICAgICAgICAgICAgbGV0IG8gPSBLcy5yZXNvbHZlKCk7XG4gICAgICAgICAgICByZXR1cm4gci5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgICAgICBvID0gby5uZXh0KCgoKSA9PiBzLmdldEVudHJ5KGUsIHQpKSkubmV4dCgoZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBuLmRvY1ZlcnNpb25zLmdldCh0KTtcbiAgICAgICAgICAgICAgICAgICAgTChudWxsICE9PSByKSwgZS52ZXJzaW9uLmNvbXBhcmVUbyhyKSA8IDAgJiYgKGkuYXBwbHlUb1JlbW90ZURvY3VtZW50KGUsIG4pLCBlLmlzVmFsaWREb2N1bWVudCgpICYmIFxuICAgICAgICAgICAgICAgICAgICAvLyBXZSB1c2UgdGhlIGNvbW1pdFZlcnNpb24gYXMgdGhlIHJlYWRUaW1lIHJhdGhlciB0aGFuIHRoZVxuICAgICAgICAgICAgICAgICAgICAvLyBkb2N1bWVudCdzIHVwZGF0ZVRpbWUgc2luY2UgdGhlIHVwZGF0ZVRpbWUgaXMgbm90IGFkdmFuY2VkXG4gICAgICAgICAgICAgICAgICAgIC8vIGZvciB1cGRhdGVzIHRoYXQgZG8gbm90IG1vZGlmeSB0aGUgdW5kZXJseWluZyBkb2N1bWVudC5cbiAgICAgICAgICAgICAgICAgICAgcy5hZGRFbnRyeShlLCBuLmNvbW1pdFZlcnNpb24pKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9KSksIG8ubmV4dCgoKCkgPT4gdC5Jbi5yZW1vdmVNdXRhdGlvbkJhdGNoKGUsIGkpKSk7XG4gICAgICAgIH1cbiAgICAgICAgLyoqIFJldHVybnMgdGhlIGxvY2FsIHZpZXcgb2YgdGhlIGRvY3VtZW50cyBhZmZlY3RlZCBieSBhIG11dGF0aW9uIGJhdGNoLiAqL1xuICAgICAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLVRhYiBvbmx5LlxuICAgICAgICAobiwgdCwgZSwgaSkubmV4dCgoKCkgPT4gaS5hcHBseSh0KSkpLm5leHQoKCgpID0+IG4uSW4ucGVyZm9ybUNvbnNpc3RlbmN5Q2hlY2sodCkpKS5uZXh0KCgoKSA9PiBuLlFuLmJuKHQsIHMpKSk7XG4gICAgfSkpO1xufVxuXG4vKipcbiAqIFJlbW92ZXMgbXV0YXRpb25zIGZyb20gdGhlIE11dGF0aW9uUXVldWUgZm9yIHRoZSBzcGVjaWZpZWQgYmF0Y2g7XG4gKiBMb2NhbERvY3VtZW50cyB3aWxsIGJlIHJlY2FsY3VsYXRlZC5cbiAqXG4gKiBAcmV0dXJucyBUaGUgcmVzdWx0aW5nIG1vZGlmaWVkIGRvY3VtZW50cy5cbiAqL1xuLyoqXG4gKiBSZXR1cm5zIHRoZSBsYXN0IGNvbnNpc3RlbnQgc25hcHNob3QgcHJvY2Vzc2VkICh1c2VkIGJ5IHRoZSBSZW1vdGVTdG9yZSB0b1xuICogZGV0ZXJtaW5lIHdoZXRoZXIgdG8gYnVmZmVyIGluY29taW5nIHNuYXBzaG90cyBmcm9tIHRoZSBiYWNrZW5kKS5cbiAqL1xuZnVuY3Rpb24gbHIodCkge1xuICAgIGNvbnN0IGUgPSBVKHQpO1xuICAgIHJldHVybiBlLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiR2V0IGxhc3QgcmVtb3RlIHNuYXBzaG90IHZlcnNpb25cIiwgXCJyZWFkb25seVwiLCAodCA9PiBlLnplLmdldExhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24odCkpKTtcbn1cblxuLyoqXG4gKiBVcGRhdGVzIHRoZSBcImdyb3VuZC1zdGF0ZVwiIChyZW1vdGUpIGRvY3VtZW50cy4gV2UgYXNzdW1lIHRoYXQgdGhlIHJlbW90ZVxuICogZXZlbnQgcmVmbGVjdHMgYW55IHdyaXRlIGJhdGNoZXMgdGhhdCBoYXZlIGJlZW4gYWNrbm93bGVkZ2VkIG9yIHJlamVjdGVkXG4gKiAoaS5lLiB3ZSBkbyBub3QgcmUtYXBwbHkgbG9jYWwgbXV0YXRpb25zIHRvIHVwZGF0ZXMgZnJvbSB0aGlzIGV2ZW50KS5cbiAqXG4gKiBMb2NhbERvY3VtZW50cyBhcmUgcmUtY2FsY3VsYXRlZCBpZiB0aGVyZSBhcmUgcmVtYWluaW5nIG11dGF0aW9ucyBpbiB0aGVcbiAqIHF1ZXVlLlxuICovIGZ1bmN0aW9uIGZyKHQsIGUpIHtcbiAgICBjb25zdCBuID0gVSh0KSwgcyA9IGUuc25hcHNob3RWZXJzaW9uO1xuICAgIGxldCBpID0gbi5VbjtcbiAgICByZXR1cm4gbi5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIkFwcGx5IHJlbW90ZSBldmVudFwiLCBcInJlYWR3cml0ZS1wcmltYXJ5XCIsICh0ID0+IHtcbiAgICAgICAgY29uc3QgciA9IG4uam4ubmV3Q2hhbmdlQnVmZmVyKHtcbiAgICAgICAgICAgIHRyYWNrUmVtb3ZhbHM6ICEwXG4gICAgICAgIH0pO1xuICAgICAgICAvLyBSZXNldCBuZXdUYXJnZXREYXRhQnlUYXJnZXRNYXAgaW4gY2FzZSB0aGlzIHRyYW5zYWN0aW9uIGdldHMgcmUtcnVuLlxuICAgICAgICAgICAgICAgIGkgPSBuLlVuO1xuICAgICAgICBjb25zdCBvID0gW107XG4gICAgICAgIGUudGFyZ2V0Q2hhbmdlcy5mb3JFYWNoKCgoZSwgcikgPT4ge1xuICAgICAgICAgICAgY29uc3QgYSA9IGkuZ2V0KHIpO1xuICAgICAgICAgICAgaWYgKCFhKSByZXR1cm47XG4gICAgICAgICAgICAvLyBPbmx5IHVwZGF0ZSB0aGUgcmVtb3RlIGtleXMgaWYgdGhlIHRhcmdldCBpcyBzdGlsbCBhY3RpdmUuIFRoaXNcbiAgICAgICAgICAgIC8vIGVuc3VyZXMgdGhhdCB3ZSBjYW4gcGVyc2lzdCB0aGUgdXBkYXRlZCB0YXJnZXQgZGF0YSBhbG9uZyB3aXRoXG4gICAgICAgICAgICAvLyB0aGUgdXBkYXRlZCBhc3NpZ25tZW50LlxuICAgICAgICAgICAgICAgICAgICAgICAgby5wdXNoKG4uemUucmVtb3ZlTWF0Y2hpbmdLZXlzKHQsIGUucmVtb3ZlZERvY3VtZW50cywgcikubmV4dCgoKCkgPT4gbi56ZS5hZGRNYXRjaGluZ0tleXModCwgZS5hZGRlZERvY3VtZW50cywgcikpKSk7XG4gICAgICAgICAgICBjb25zdCBjID0gZS5yZXN1bWVUb2tlbjtcbiAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgcmVzdW1lIHRva2VuIGlmIHRoZSBjaGFuZ2UgaW5jbHVkZXMgb25lLlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGMuYXBwcm94aW1hdGVCeXRlU2l6ZSgpID4gMCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHUgPSBhLndpdGhSZXN1bWVUb2tlbihjLCBzKS53aXRoU2VxdWVuY2VOdW1iZXIodC5jdXJyZW50U2VxdWVuY2VOdW1iZXIpO1xuICAgICAgICAgICAgICAgIGkgPSBpLmluc2VydChyLCB1KSwgXG4gICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSB0YXJnZXQgZGF0YSBpZiB0aGVyZSBhcmUgdGFyZ2V0IGNoYW5nZXMgKG9yIGlmXG4gICAgICAgICAgICAgICAgLy8gc3VmZmljaWVudCB0aW1lIGhhcyBwYXNzZWQgc2luY2UgdGhlIGxhc3QgdXBkYXRlKS5cbiAgICAgICAgICAgICAgICAvKipcbiAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgbmV3VGFyZ2V0RGF0YSBzaG91bGQgYmUgcGVyc2lzdGVkIGR1cmluZyBhbiB1cGRhdGUgb2ZcbiAqIGFuIGFjdGl2ZSB0YXJnZXQuIFRhcmdldERhdGEgc2hvdWxkIGFsd2F5cyBiZSBwZXJzaXN0ZWQgd2hlbiBhIHRhcmdldCBpc1xuICogYmVpbmcgcmVsZWFzZWQgYW5kIHNob3VsZCBub3QgY2FsbCB0aGlzIGZ1bmN0aW9uLlxuICpcbiAqIFdoaWxlIHRoZSB0YXJnZXQgaXMgYWN0aXZlLCBUYXJnZXREYXRhIHVwZGF0ZXMgY2FuIGJlIG9taXR0ZWQgd2hlbiBub3RoaW5nXG4gKiBhYm91dCB0aGUgdGFyZ2V0IGhhcyBjaGFuZ2VkIGV4Y2VwdCBtZXRhZGF0YSBsaWtlIHRoZSByZXN1bWUgdG9rZW4gb3JcbiAqIHNuYXBzaG90IHZlcnNpb24uIE9jY2FzaW9uYWxseSBpdCdzIHdvcnRoIHRoZSBleHRyYSB3cml0ZSB0byBwcmV2ZW50IHRoZXNlXG4gKiB2YWx1ZXMgZnJvbSBnZXR0aW5nIHRvbyBzdGFsZSBhZnRlciBhIGNyYXNoLCBidXQgdGhpcyBkb2Vzbid0IGhhdmUgdG8gYmVcbiAqIHRvbyBmcmVxdWVudC5cbiAqL1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQWx3YXlzIHBlcnNpc3QgdGFyZ2V0IGRhdGEgaWYgd2UgZG9uJ3QgYWxyZWFkeSBoYXZlIGEgcmVzdW1lIHRva2VuLlxuICAgICAgICAgICAgICAgICAgICBpZiAoTChlLnJlc3VtZVRva2VuLmFwcHJveGltYXRlQnl0ZVNpemUoKSA+IDApLCAwID09PSB0LnJlc3VtZVRva2VuLmFwcHJveGltYXRlQnl0ZVNpemUoKSkgcmV0dXJuICEwO1xuICAgICAgICAgICAgICAgICAgICAvLyBEb24ndCBhbGxvdyByZXN1bWUgdG9rZW4gY2hhbmdlcyB0byBiZSBidWZmZXJlZCBpbmRlZmluaXRlbHkuIFRoaXNcbiAgICAgICAgICAgICAgICAgICAgLy8gYWxsb3dzIHVzIHRvIGJlIHJlYXNvbmFibHkgdXAtdG8tZGF0ZSBhZnRlciBhIGNyYXNoIGFuZCBhdm9pZHMgbmVlZGluZ1xuICAgICAgICAgICAgICAgICAgICAvLyB0byBsb29wIG92ZXIgYWxsIGFjdGl2ZSBxdWVyaWVzIG9uIHNodXRkb3duLiBFc3BlY2lhbGx5IGluIHRoZSBicm93c2VyXG4gICAgICAgICAgICAgICAgICAgIC8vIHdlIG1heSBub3QgZ2V0IHRpbWUgdG8gZG8gYW55dGhpbmcgaW50ZXJlc3Rpbmcgd2hpbGUgdGhlIGN1cnJlbnQgdGFiIGlzXG4gICAgICAgICAgICAgICAgICAgIC8vIGNsb3NpbmcuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUuc25hcHNob3RWZXJzaW9uLnRvTWljcm9zZWNvbmRzKCkgLSB0LnNuYXBzaG90VmVyc2lvbi50b01pY3Jvc2Vjb25kcygpID49IDNlOCkgcmV0dXJuICEwO1xuICAgICAgICAgICAgICAgICAgICAvLyBPdGhlcndpc2UgaWYgdGhlIG9ubHkgdGhpbmcgdGhhdCBoYXMgY2hhbmdlZCBhYm91dCBhIHRhcmdldCBpcyBpdHMgcmVzdW1lXG4gICAgICAgICAgICAgICAgICAgIC8vIHRva2VuIGl0J3Mgbm90IHdvcnRoIHBlcnNpc3RpbmcuIE5vdGUgdGhhdCB0aGUgUmVtb3RlU3RvcmUga2VlcHMgYW5cbiAgICAgICAgICAgICAgICAgICAgLy8gaW4tbWVtb3J5IHZpZXcgb2YgdGhlIGN1cnJlbnRseSBhY3RpdmUgdGFyZ2V0cyB3aGljaCBpbmNsdWRlcyB0aGUgY3VycmVudFxuICAgICAgICAgICAgICAgICAgICAvLyByZXN1bWUgdG9rZW4sIHNvIHN0cmVhbSBmYWlsdXJlIG9yIHVzZXIgY2hhbmdlcyB3aWxsIHN0aWxsIHVzZSBhblxuICAgICAgICAgICAgICAgICAgICAvLyB1cC10by1kYXRlIHJlc3VtZSB0b2tlbiByZWdhcmRsZXNzIG9mIHdoYXQgd2UgZG8gaGVyZS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbi5hZGRlZERvY3VtZW50cy5zaXplICsgbi5tb2RpZmllZERvY3VtZW50cy5zaXplICsgbi5yZW1vdmVkRG9jdW1lbnRzLnNpemUgPiAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvKipcbiAqIE5vdGlmaWVzIGxvY2FsIHN0b3JlIG9mIHRoZSBjaGFuZ2VkIHZpZXdzIHRvIGxvY2FsbHkgcGluIGRvY3VtZW50cy5cbiAqLyAoYSwgdSwgZSkgJiYgby5wdXNoKG4uemUudXBkYXRlVGFyZ2V0RGF0YSh0LCB1KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgbGV0IGEgPSBwbigpO1xuICAgICAgICAvLyBIQUNLOiBUaGUgb25seSByZWFzb24gd2UgYWxsb3cgYSBudWxsIHNuYXBzaG90IHZlcnNpb24gaXMgc28gdGhhdCB3ZVxuICAgICAgICAvLyBjYW4gc3ludGhlc2l6ZSByZW1vdGUgZXZlbnRzIHdoZW4gd2UgZ2V0IHBlcm1pc3Npb24gZGVuaWVkIGVycm9ycyB3aGlsZVxuICAgICAgICAvLyB0cnlpbmcgdG8gcmVzb2x2ZSB0aGUgc3RhdGUgb2YgYSBsb2NhbGx5IGNhY2hlZCBkb2N1bWVudCB0aGF0IGlzIGluXG4gICAgICAgIC8vIGxpbWJvLlxuICAgICAgICBpZiAoZS5kb2N1bWVudFVwZGF0ZXMuZm9yRWFjaCgoKHMsIGkpID0+IHtcbiAgICAgICAgICAgIGUucmVzb2x2ZWRMaW1ib0RvY3VtZW50cy5oYXMocykgJiYgby5wdXNoKG4ucGVyc2lzdGVuY2UucmVmZXJlbmNlRGVsZWdhdGUudXBkYXRlTGltYm9Eb2N1bWVudCh0LCBzKSk7XG4gICAgICAgIH0pKSwgXG4gICAgICAgIC8vIEVhY2ggbG9vcCBpdGVyYXRpb24gb25seSBhZmZlY3RzIGl0cyBcIm93blwiIGRvYywgc28gaXQncyBzYWZlIHRvIGdldCBhbGwgdGhlIHJlbW90ZVxuICAgICAgICAvLyBkb2N1bWVudHMgaW4gYWR2YW5jZSBpbiBhIHNpbmdsZSBjYWxsLlxuICAgICAgICBvLnB1c2goZHIodCwgciwgZS5kb2N1bWVudFVwZGF0ZXMsIHMsIHZvaWQgMCkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICBhID0gdDtcbiAgICAgICAgfSkpKSwgIXMuaXNFcXVhbChpdC5taW4oKSkpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSBuLnplLmdldExhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24odCkubmV4dCgoZSA9PiBuLnplLnNldFRhcmdldHNNZXRhZGF0YSh0LCB0LmN1cnJlbnRTZXF1ZW5jZU51bWJlciwgcykpKTtcbiAgICAgICAgICAgIG8ucHVzaChlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gS3Mud2FpdEZvcihvKS5uZXh0KCgoKSA9PiByLmFwcGx5KHQpKSkubmV4dCgoKCkgPT4gbi5Rbi52bih0LCBhKSkpLm5leHQoKCgpID0+IGEpKTtcbiAgICB9KSkudGhlbigodCA9PiAobi5VbiA9IGksIHQpKSk7XG59XG5cbi8qKlxuICogUG9wdWxhdGVzIGRvY3VtZW50IGNoYW5nZSBidWZmZXIgd2l0aCBkb2N1bWVudHMgZnJvbSBiYWNrZW5kIG9yIGEgYnVuZGxlLlxuICogUmV0dXJucyB0aGUgZG9jdW1lbnQgY2hhbmdlcyByZXN1bHRpbmcgZnJvbSBhcHBseWluZyB0aG9zZSBkb2N1bWVudHMuXG4gKlxuICogQHBhcmFtIHR4biAtIFRyYW5zYWN0aW9uIHRvIHVzZSB0byByZWFkIGV4aXN0aW5nIGRvY3VtZW50cyBmcm9tIHN0b3JhZ2UuXG4gKiBAcGFyYW0gZG9jdW1lbnRCdWZmZXIgLSBEb2N1bWVudCBidWZmZXIgdG8gY29sbGVjdCB0aGUgcmVzdWx0ZWQgY2hhbmdlcyB0byBiZVxuICogICAgICAgIGFwcGxpZWQgdG8gc3RvcmFnZS5cbiAqIEBwYXJhbSBkb2N1bWVudHMgLSBEb2N1bWVudHMgdG8gYmUgYXBwbGllZC5cbiAqIEBwYXJhbSBnbG9iYWxWZXJzaW9uIC0gQSBgU25hcHNob3RWZXJzaW9uYCByZXByZXNlbnRpbmcgdGhlIHJlYWQgdGltZSBpZiBhbGxcbiAqICAgICAgICBkb2N1bWVudHMgaGF2ZSB0aGUgc2FtZSByZWFkIHRpbWUuXG4gKiBAcGFyYW0gZG9jdW1lbnRWZXJzaW9ucyAtIEEgRG9jdW1lbnRLZXktdG8tU25hcHNob3RWZXJzaW9uIG1hcCBpZiBkb2N1bWVudHNcbiAqICAgICAgICBoYXZlIHRoZWlyIG93biByZWFkIHRpbWUuXG4gKlxuICogTm90ZTogdGhpcyBmdW5jdGlvbiB3aWxsIHVzZSBgZG9jdW1lbnRWZXJzaW9uc2AgaWYgaXQgaXMgZGVmaW5lZDtcbiAqIHdoZW4gaXQgaXMgbm90IGRlZmluZWQsIHJlc29ydHMgdG8gYGdsb2JhbFZlcnNpb25gLlxuICovIGZ1bmN0aW9uIGRyKHQsIGUsIG4sIHMsIFxuLy8gVE9ETyh3dWFuZHkpOiBXZSBjb3VsZCBhZGQgYHJlYWRUaW1lYCB0byBNYXliZURvY3VtZW50IGluc3RlYWQgdG8gcmVtb3ZlXG4vLyB0aGlzIHBhcmFtZXRlci5cbmkpIHtcbiAgICBsZXQgciA9IFBuKCk7XG4gICAgcmV0dXJuIG4uZm9yRWFjaCgodCA9PiByID0gci5hZGQodCkpKSwgZS5nZXRFbnRyaWVzKHQsIHIpLm5leHQoKHQgPT4ge1xuICAgICAgICBsZXQgciA9IHBuKCk7XG4gICAgICAgIHJldHVybiBuLmZvckVhY2goKChuLCBvKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBhID0gdC5nZXQobiksIGMgPSAobnVsbCA9PSBpID8gdm9pZCAwIDogaS5nZXQobikpIHx8IHM7XG4gICAgICAgICAgICAvLyBOb3RlOiBUaGUgb3JkZXIgb2YgdGhlIHN0ZXBzIGJlbG93IGlzIGltcG9ydGFudCwgc2luY2Ugd2Ugd2FudFxuICAgICAgICAgICAgLy8gdG8gZW5zdXJlIHRoYXQgcmVqZWN0ZWQgbGltYm8gcmVzb2x1dGlvbnMgKHdoaWNoIGZhYnJpY2F0ZVxuICAgICAgICAgICAgLy8gTm9Eb2N1bWVudHMgd2l0aCBTbmFwc2hvdFZlcnNpb24ubWluKCkpIG5ldmVyIGFkZCBkb2N1bWVudHMgdG9cbiAgICAgICAgICAgIC8vIGNhY2hlLlxuICAgICAgICAgICAgby5pc05vRG9jdW1lbnQoKSAmJiBvLnZlcnNpb24uaXNFcXVhbChpdC5taW4oKSkgPyAoXG4gICAgICAgICAgICAvLyBOb0RvY3VtZW50cyB3aXRoIFNuYXBzaG90VmVyc2lvbi5taW4oKSBhcmUgdXNlZCBpbiBtYW51ZmFjdHVyZWRcbiAgICAgICAgICAgIC8vIGV2ZW50cy4gV2UgcmVtb3ZlIHRoZXNlIGRvY3VtZW50cyBmcm9tIGNhY2hlIHNpbmNlIHdlIGxvc3RcbiAgICAgICAgICAgIC8vIGFjY2Vzcy5cbiAgICAgICAgICAgIGUucmVtb3ZlRW50cnkobiwgYyksIHIgPSByLmluc2VydChuLCBvKSkgOiAhYS5pc1ZhbGlkRG9jdW1lbnQoKSB8fCBvLnZlcnNpb24uY29tcGFyZVRvKGEudmVyc2lvbikgPiAwIHx8IDAgPT09IG8udmVyc2lvbi5jb21wYXJlVG8oYS52ZXJzaW9uKSAmJiBhLmhhc1BlbmRpbmdXcml0ZXMgPyAoZS5hZGRFbnRyeShvLCBjKSwgXG4gICAgICAgICAgICByID0gci5pbnNlcnQobiwgbykpIDogayhcIkxvY2FsU3RvcmVcIiwgXCJJZ25vcmluZyBvdXRkYXRlZCB3YXRjaCB1cGRhdGUgZm9yIFwiLCBuLCBcIi4gQ3VycmVudCB2ZXJzaW9uOlwiLCBhLnZlcnNpb24sIFwiIFdhdGNoIHZlcnNpb246XCIsIG8udmVyc2lvbik7XG4gICAgICAgIH0pKSwgcjtcbiAgICB9KSk7XG59XG5cbi8qKlxuICogR2V0cyB0aGUgbXV0YXRpb24gYmF0Y2ggYWZ0ZXIgdGhlIHBhc3NlZCBpbiBiYXRjaElkIGluIHRoZSBtdXRhdGlvbiBxdWV1ZVxuICogb3IgbnVsbCBpZiBlbXB0eS5cbiAqIEBwYXJhbSBhZnRlckJhdGNoSWQgLSBJZiBwcm92aWRlZCwgdGhlIGJhdGNoIHRvIHNlYXJjaCBhZnRlci5cbiAqIEByZXR1cm5zIFRoZSBuZXh0IG11dGF0aW9uIG9yIG51bGwgaWYgdGhlcmUgd2Fzbid0IG9uZS5cbiAqL1xuZnVuY3Rpb24gd3IodCwgZSkge1xuICAgIGNvbnN0IG4gPSBVKHQpO1xuICAgIHJldHVybiBuLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiR2V0IG5leHQgbXV0YXRpb24gYmF0Y2hcIiwgXCJyZWFkb25seVwiLCAodCA9PiAodm9pZCAwID09PSBlICYmIChlID0gLTEpLCBcbiAgICBuLkluLmdldE5leHRNdXRhdGlvbkJhdGNoQWZ0ZXJCYXRjaElkKHQsIGUpKSkpO1xufVxuXG4vKipcbiAqIFJlYWRzIHRoZSBjdXJyZW50IHZhbHVlIG9mIGEgRG9jdW1lbnQgd2l0aCBhIGdpdmVuIGtleSBvciBudWxsIGlmIG5vdFxuICogZm91bmQgLSB1c2VkIGZvciB0ZXN0aW5nLlxuICovXG4vKipcbiAqIEFzc2lnbnMgdGhlIGdpdmVuIHRhcmdldCBhbiBpbnRlcm5hbCBJRCBzbyB0aGF0IGl0cyByZXN1bHRzIGNhbiBiZSBwaW5uZWQgc29cbiAqIHRoZXkgZG9uJ3QgZ2V0IEdDJ2QuIEEgdGFyZ2V0IG11c3QgYmUgYWxsb2NhdGVkIGluIHRoZSBsb2NhbCBzdG9yZSBiZWZvcmVcbiAqIHRoZSBzdG9yZSBjYW4gYmUgdXNlZCB0byBtYW5hZ2UgaXRzIHZpZXcuXG4gKlxuICogQWxsb2NhdGluZyBhbiBhbHJlYWR5IGFsbG9jYXRlZCBgVGFyZ2V0YCB3aWxsIHJldHVybiB0aGUgZXhpc3RpbmcgYFRhcmdldERhdGFgXG4gKiBmb3IgdGhhdCBgVGFyZ2V0YC5cbiAqL1xuZnVuY3Rpb24gX3IodCwgZSkge1xuICAgIGNvbnN0IG4gPSBVKHQpO1xuICAgIHJldHVybiBuLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiQWxsb2NhdGUgdGFyZ2V0XCIsIFwicmVhZHdyaXRlXCIsICh0ID0+IHtcbiAgICAgICAgbGV0IHM7XG4gICAgICAgIHJldHVybiBuLnplLmdldFRhcmdldERhdGEodCwgZSkubmV4dCgoaSA9PiBpID8gKFxuICAgICAgICAvLyBUaGlzIHRhcmdldCBoYXMgYmVlbiBsaXN0ZW5lZCB0byBwcmV2aW91c2x5LCBzbyByZXVzZSB0aGVcbiAgICAgICAgLy8gcHJldmlvdXMgdGFyZ2V0SUQuXG4gICAgICAgIC8vIFRPRE8obWNnKTogZnJlc2hlbiBsYXN0IGFjY2Vzc2VkIGRhdGU/XG4gICAgICAgIHMgPSBpLCBLcy5yZXNvbHZlKHMpKSA6IG4uemUuYWxsb2NhdGVUYXJnZXRJZCh0KS5uZXh0KChpID0+IChzID0gbmV3IHNpKGUsIGksIDAgLyogTGlzdGVuICovICwgdC5jdXJyZW50U2VxdWVuY2VOdW1iZXIpLCBcbiAgICAgICAgbi56ZS5hZGRUYXJnZXREYXRhKHQsIHMpLm5leHQoKCgpID0+IHMpKSkpKSkpO1xuICAgIH0pKS50aGVuKCh0ID0+IHtcbiAgICAgICAgLy8gSWYgTXVsdGktVGFiIGlzIGVuYWJsZWQsIHRoZSBleGlzdGluZyB0YXJnZXQgZGF0YSBtYXkgYmUgbmV3ZXIgdGhhblxuICAgICAgICAvLyB0aGUgaW4tbWVtb3J5IGRhdGFcbiAgICAgICAgY29uc3QgcyA9IG4uVW4uZ2V0KHQudGFyZ2V0SWQpO1xuICAgICAgICByZXR1cm4gKG51bGwgPT09IHMgfHwgdC5zbmFwc2hvdFZlcnNpb24uY29tcGFyZVRvKHMuc25hcHNob3RWZXJzaW9uKSA+IDApICYmIChuLlVuID0gbi5Vbi5pbnNlcnQodC50YXJnZXRJZCwgdCksIFxuICAgICAgICBuLnFuLnNldChlLCB0LnRhcmdldElkKSksIHQ7XG4gICAgfSkpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIFRhcmdldERhdGEgYXMgc2VlbiBieSB0aGUgTG9jYWxTdG9yZSwgaW5jbHVkaW5nIHVwZGF0ZXMgdGhhdCBtYXlcbiAqIGhhdmUgbm90IHlldCBiZWVuIHBlcnNpc3RlZCB0byB0aGUgVGFyZ2V0Q2FjaGUuXG4gKi9cbi8vIFZpc2libGUgZm9yIHRlc3RpbmcuXG4vKipcbiAqIFVucGlucyBhbGwgdGhlIGRvY3VtZW50cyBhc3NvY2lhdGVkIHdpdGggdGhlIGdpdmVuIHRhcmdldC4gSWZcbiAqIGBrZWVwUGVyc2lzdGVkVGFyZ2V0RGF0YWAgaXMgc2V0IHRvIGZhbHNlIGFuZCBFYWdlciBHQyBlbmFibGVkLCB0aGUgbWV0aG9kXG4gKiBkaXJlY3RseSByZW1vdmVzIHRoZSBhc3NvY2lhdGVkIHRhcmdldCBkYXRhIGZyb20gdGhlIHRhcmdldCBjYWNoZS5cbiAqXG4gKiBSZWxlYXNpbmcgYSBub24tZXhpc3RpbmcgYFRhcmdldGAgaXMgYSBuby1vcC5cbiAqL1xuLy8gUE9SVElORyBOT1RFOiBga2VlcFBlcnNpc3RlZFRhcmdldERhdGFgIGlzIG11bHRpLXRhYiBvbmx5LlxuYXN5bmMgZnVuY3Rpb24gbXIodCwgZSwgbikge1xuICAgIGNvbnN0IHMgPSBVKHQpLCBpID0gcy5Vbi5nZXQoZSksIHIgPSBuID8gXCJyZWFkd3JpdGVcIiA6IFwicmVhZHdyaXRlLXByaW1hcnlcIjtcbiAgICB0cnkge1xuICAgICAgICBuIHx8IGF3YWl0IHMucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJSZWxlYXNlIHRhcmdldFwiLCByLCAodCA9PiBzLnBlcnNpc3RlbmNlLnJlZmVyZW5jZURlbGVnYXRlLnJlbW92ZVRhcmdldCh0LCBpKSkpO1xuICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgaWYgKCF6cyh0KSkgdGhyb3cgdDtcbiAgICAgICAgLy8gQWxsIGByZWxlYXNlVGFyZ2V0YCBkb2VzIGlzIHJlY29yZCB0aGUgZmluYWwgbWV0YWRhdGEgc3RhdGUgZm9yIHRoZVxuICAgICAgICAvLyB0YXJnZXQsIGJ1dCB3ZSd2ZSBiZWVuIHJlY29yZGluZyB0aGlzIHBlcmlvZGljYWxseSBkdXJpbmcgdGFyZ2V0XG4gICAgICAgIC8vIGFjdGl2aXR5LiBJZiB3ZSBsb3NlIHRoaXMgd3JpdGUgdGhpcyBjb3VsZCBjYXVzZSBhIHZlcnkgc2xpZ2h0XG4gICAgICAgIC8vIGRpZmZlcmVuY2UgaW4gdGhlIG9yZGVyIG9mIHRhcmdldCBkZWxldGlvbiBkdXJpbmcgR0MsIGJ1dCB3ZVxuICAgICAgICAvLyBkb24ndCBkZWZpbmUgZXhhY3QgTFJVIHNlbWFudGljcyBzbyB0aGlzIGlzIGFjY2VwdGFibGUuXG4gICAgICAgIGsoXCJMb2NhbFN0b3JlXCIsIGBGYWlsZWQgdG8gdXBkYXRlIHNlcXVlbmNlIG51bWJlcnMgZm9yIHRhcmdldCAke2V9OiAke3R9YCk7XG4gICAgfVxuICAgIHMuVW4gPSBzLlVuLnJlbW92ZShlKSwgcy5xbi5kZWxldGUoaS50YXJnZXQpO1xufVxuXG4vKipcbiAqIFJ1bnMgdGhlIHNwZWNpZmllZCBxdWVyeSBhZ2FpbnN0IHRoZSBsb2NhbCBzdG9yZSBhbmQgcmV0dXJucyB0aGUgcmVzdWx0cyxcbiAqIHBvdGVudGlhbGx5IHRha2luZyBhZHZhbnRhZ2Ugb2YgcXVlcnkgZGF0YSBmcm9tIHByZXZpb3VzIGV4ZWN1dGlvbnMgKHN1Y2hcbiAqIGFzIHRoZSBzZXQgb2YgcmVtb3RlIGtleXMpLlxuICpcbiAqIEBwYXJhbSB1c2VQcmV2aW91c1Jlc3VsdHMgLSBXaGV0aGVyIHJlc3VsdHMgZnJvbSBwcmV2aW91cyBleGVjdXRpb25zIGNhblxuICogYmUgdXNlZCB0byBvcHRpbWl6ZSB0aGlzIHF1ZXJ5IGV4ZWN1dGlvbi5cbiAqLyBmdW5jdGlvbiBncih0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9IFUodCk7XG4gICAgbGV0IGkgPSBpdC5taW4oKSwgciA9IFBuKCk7XG4gICAgcmV0dXJuIHMucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJFeGVjdXRlIHF1ZXJ5XCIsIFwicmVhZG9ubHlcIiwgKHQgPT4gZnVuY3Rpb24odCwgZSwgbikge1xuICAgICAgICBjb25zdCBzID0gVSh0KSwgaSA9IHMucW4uZ2V0KG4pO1xuICAgICAgICByZXR1cm4gdm9pZCAwICE9PSBpID8gS3MucmVzb2x2ZShzLlVuLmdldChpKSkgOiBzLnplLmdldFRhcmdldERhdGEoZSwgbik7XG4gICAgfShzLCB0LCBFZShlKSkubmV4dCgoZSA9PiB7XG4gICAgICAgIGlmIChlKSByZXR1cm4gaSA9IGUubGFzdExpbWJvRnJlZVNuYXBzaG90VmVyc2lvbiwgcy56ZS5nZXRNYXRjaGluZ0tleXNGb3JUYXJnZXRJZCh0LCBlLnRhcmdldElkKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgIHIgPSB0O1xuICAgICAgICB9KSk7XG4gICAgfSkpLm5leHQoKCgpID0+IHMuQm4uZ2V0RG9jdW1lbnRzTWF0Y2hpbmdRdWVyeSh0LCBlLCBuID8gaSA6IGl0Lm1pbigpLCBuID8gciA6IFBuKCkpKSkubmV4dCgodCA9PiAoe1xuICAgICAgICBkb2N1bWVudHM6IHQsXG4gICAgICAgIEduOiByXG4gICAgfSkpKSkpO1xufVxuXG4vLyBQT1JUSU5HIE5PVEU6IE11bHRpLVRhYiBvbmx5LlxuZnVuY3Rpb24geXIodCwgZSkge1xuICAgIGNvbnN0IG4gPSBVKHQpLCBzID0gVShuLnplKSwgaSA9IG4uVW4uZ2V0KGUpO1xuICAgIHJldHVybiBpID8gUHJvbWlzZS5yZXNvbHZlKGkudGFyZ2V0KSA6IG4ucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJHZXQgdGFyZ2V0IGRhdGFcIiwgXCJyZWFkb25seVwiLCAodCA9PiBzLkV0KHQsIGUpLm5leHQoKHQgPT4gdCA/IHQudGFyZ2V0IDogbnVsbCkpKSk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgc2V0IG9mIGRvY3VtZW50cyB0aGF0IGhhdmUgYmVlbiB1cGRhdGVkIHNpbmNlIHRoZSBsYXN0IGNhbGwuXG4gKiBJZiB0aGlzIGlzIHRoZSBmaXJzdCBjYWxsLCByZXR1cm5zIHRoZSBzZXQgb2YgY2hhbmdlcyBzaW5jZSBjbGllbnRcbiAqIGluaXRpYWxpemF0aW9uLiBGdXJ0aGVyIGludm9jYXRpb25zIHdpbGwgcmV0dXJuIGRvY3VtZW50IHRoYXQgaGF2ZSBjaGFuZ2VkXG4gKiBzaW5jZSB0aGUgcHJpb3IgY2FsbC5cbiAqL1xuLy8gUE9SVElORyBOT1RFOiBNdWx0aS1UYWIgb25seS5cbmZ1bmN0aW9uIHByKHQpIHtcbiAgICBjb25zdCBlID0gVSh0KTtcbiAgICByZXR1cm4gZS5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIkdldCBuZXcgZG9jdW1lbnQgY2hhbmdlc1wiLCBcInJlYWRvbmx5XCIsICh0ID0+IGZ1bmN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgY29uc3QgcyA9IFUodCk7XG4gICAgICAgIGxldCBpID0gcG4oKSwgciA9IGFpKG4pO1xuICAgICAgICBjb25zdCBvID0gemkoZSksIGEgPSBJREJLZXlSYW5nZS5sb3dlckJvdW5kKHIsICEwKTtcbiAgICAgICAgcmV0dXJuIG8uS3Qoe1xuICAgICAgICAgICAgaW5kZXg6IENzLnJlYWRUaW1lSW5kZXgsXG4gICAgICAgICAgICByYW5nZTogYVxuICAgICAgICB9LCAoKHQsIGUpID0+IHtcbiAgICAgICAgICAgIC8vIFVubGlrZSBgZ2V0RW50cnkoKWAgYW5kIG90aGVycywgYGdldE5ld0RvY3VtZW50Q2hhbmdlcygpYCBwYXJzZXNcbiAgICAgICAgICAgIC8vIHRoZSBkb2N1bWVudHMgZGlyZWN0bHkgc2luY2Ugd2Ugd2FudCB0byBrZWVwIHNlbnRpbmVsIGRlbGV0ZXMuXG4gICAgICAgICAgICBjb25zdCBuID0gcmkocy5OLCBlKTtcbiAgICAgICAgICAgIGkgPSBpLmluc2VydChuLmtleSwgbiksIHIgPSBlLnJlYWRUaW1lO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gKHtcbiAgICAgICAgICAgIFRuOiBpLFxuICAgICAgICAgICAgcmVhZFRpbWU6IGNpKHIpXG4gICAgICAgIH0pKSk7XG4gICAgfVxuICAgIC8qKlxuICogUmV0dXJucyB0aGUgcmVhZCB0aW1lIG9mIHRoZSBtb3N0IHJlY2VudGx5IHJlYWQgZG9jdW1lbnQgaW4gdGhlIGNhY2hlLCBvclxuICogU25hcHNob3RWZXJzaW9uLm1pbigpIGlmIG5vdCBhdmFpbGFibGUuXG4gKi9cbiAgICAvLyBQT1JUSU5HIE5PVEU6IFRoaXMgaXMgb25seSB1c2VkIGZvciBtdWx0aS10YWIgc3luY2hyb25pemF0aW9uLlxuICAgIChlLmpuLCB0LCBlLktuKSkpLnRoZW4oKCh7VG46IHQsIHJlYWRUaW1lOiBufSkgPT4gKGUuS24gPSBuLCB0KSkpO1xufVxuXG4vKipcbiAqIFJlYWRzIHRoZSBuZXdlc3QgZG9jdW1lbnQgY2hhbmdlIGZyb20gcGVyc2lzdGVuY2UgYW5kIG1vdmVzIHRoZSBpbnRlcm5hbFxuICogc3luY2hyb25pemF0aW9uIG1hcmtlciBmb3J3YXJkIHNvIHRoYXQgY2FsbHMgdG8gYGdldE5ld0RvY3VtZW50Q2hhbmdlcygpYFxuICogb25seSByZXR1cm4gY2hhbmdlcyB0aGF0IGhhcHBlbmVkIGFmdGVyIGNsaWVudCBpbml0aWFsaXphdGlvbi5cbiAqL1xuLy8gUE9SVElORyBOT1RFOiBNdWx0aS1UYWIgb25seS5cbmFzeW5jIGZ1bmN0aW9uIEVyKHQpIHtcbiAgICBjb25zdCBlID0gVSh0KTtcbiAgICByZXR1cm4gZS5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIlN5bmNocm9uaXplIGxhc3QgZG9jdW1lbnQgY2hhbmdlIHJlYWQgdGltZVwiLCBcInJlYWRvbmx5XCIsICh0ID0+IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHppKHQpO1xuICAgICAgICAvLyBJZiB0aGVyZSBhcmUgbm8gZXhpc3RpbmcgZW50cmllcywgd2UgcmV0dXJuIFNuYXBzaG90VmVyc2lvbi5taW4oKS5cbiAgICAgICAgICAgICAgICBsZXQgbiA9IGl0Lm1pbigpO1xuICAgICAgICByZXR1cm4gZS5LdCh7XG4gICAgICAgICAgICBpbmRleDogQ3MucmVhZFRpbWVJbmRleCxcbiAgICAgICAgICAgIHJldmVyc2U6ICEwXG4gICAgICAgIH0sICgodCwgZSwgcykgPT4ge1xuICAgICAgICAgICAgZS5yZWFkVGltZSAmJiAobiA9IGNpKGUucmVhZFRpbWUpKSwgcy5kb25lKCk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBuKSk7XG4gICAgfSh0KSkpLnRoZW4oKHQgPT4ge1xuICAgICAgICBlLktuID0gdDtcbiAgICB9KSk7XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyB0YXJnZXQgdXNpbmcgdGhlIGdpdmVuIGJ1bmRsZSBuYW1lLCB3aGljaCB3aWxsIGJlIHVzZWQgdG9cbiAqIGhvbGQgdGhlIGtleXMgb2YgYWxsIGRvY3VtZW50cyBmcm9tIHRoZSBidW5kbGUgaW4gcXVlcnktZG9jdW1lbnQgbWFwcGluZ3MuXG4gKiBUaGlzIGVuc3VyZXMgdGhhdCB0aGUgbG9hZGVkIGRvY3VtZW50cyBkbyBub3QgZ2V0IGdhcmJhZ2UgY29sbGVjdGVkXG4gKiByaWdodCBhd2F5LlxuICovXG4vKipcbiAqIEFwcGxpZXMgdGhlIGRvY3VtZW50cyBmcm9tIGEgYnVuZGxlIHRvIHRoZSBcImdyb3VuZC1zdGF0ZVwiIChyZW1vdGUpXG4gKiBkb2N1bWVudHMuXG4gKlxuICogTG9jYWxEb2N1bWVudHMgYXJlIHJlLWNhbGN1bGF0ZWQgaWYgdGhlcmUgYXJlIHJlbWFpbmluZyBtdXRhdGlvbnMgaW4gdGhlXG4gKiBxdWV1ZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gVHIodCwgZSwgbiwgcykge1xuICAgIGNvbnN0IGkgPSBVKHQpO1xuICAgIGxldCByID0gUG4oKSwgbyA9IHBuKCksIGEgPSBBbigpO1xuICAgIGZvciAoY29uc3QgdCBvZiBuKSB7XG4gICAgICAgIGNvbnN0IG4gPSBlLnpuKHQubWV0YWRhdGEubmFtZSk7XG4gICAgICAgIHQuZG9jdW1lbnQgJiYgKHIgPSByLmFkZChuKSksIG8gPSBvLmluc2VydChuLCBlLkhuKHQpKSwgYSA9IGEuaW5zZXJ0KG4sIGUuSm4odC5tZXRhZGF0YS5yZWFkVGltZSkpO1xuICAgIH1cbiAgICBjb25zdCBjID0gaS5qbi5uZXdDaGFuZ2VCdWZmZXIoe1xuICAgICAgICB0cmFja1JlbW92YWxzOiAhMFxuICAgIH0pLCB1ID0gYXdhaXQgX3IoaSwgZnVuY3Rpb24odCkge1xuICAgICAgICAvLyBJdCBpcyBPSyB0aGF0IHRoZSBwYXRoIHVzZWQgZm9yIHRoZSBxdWVyeSBpcyBub3QgdmFsaWQsIGJlY2F1c2UgdGhpcyB3aWxsXG4gICAgICAgIC8vIG5vdCBiZSByZWFkIGFuZCBxdWVyaWVkLlxuICAgICAgICByZXR1cm4gRWUoZGUodXQuZnJvbVN0cmluZyhgX19idW5kbGVfXy9kb2NzLyR7dH1gKSkpO1xuICAgIH0ocykpO1xuICAgIC8vIEFsbG9jYXRlcyBhIHRhcmdldCB0byBob2xkIGFsbCBkb2N1bWVudCBrZXlzIGZyb20gdGhlIGJ1bmRsZSwgc3VjaCB0aGF0XG4gICAgLy8gdGhleSB3aWxsIG5vdCBnZXQgZ2FyYmFnZSBjb2xsZWN0ZWQgcmlnaHQgYXdheS5cbiAgICAgICAgcmV0dXJuIGkucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJBcHBseSBidW5kbGUgZG9jdW1lbnRzXCIsIFwicmVhZHdyaXRlXCIsICh0ID0+IGRyKHQsIGMsIG8sIGl0Lm1pbigpLCBhKS5uZXh0KChlID0+IChjLmFwcGx5KHQpLCBcbiAgICBlKSkpLm5leHQoKGUgPT4gaS56ZS5yZW1vdmVNYXRjaGluZ0tleXNGb3JUYXJnZXRJZCh0LCB1LnRhcmdldElkKS5uZXh0KCgoKSA9PiBpLnplLmFkZE1hdGNoaW5nS2V5cyh0LCByLCB1LnRhcmdldElkKSkpLm5leHQoKCgpID0+IGkuUW4udm4odCwgZSkpKS5uZXh0KCgoKSA9PiBlKSkpKSkpO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBwcm9taXNlIG9mIGEgYm9vbGVhbiB0byBpbmRpY2F0ZSBpZiB0aGUgZ2l2ZW4gYnVuZGxlIGhhcyBhbHJlYWR5XG4gKiBiZWVuIGxvYWRlZCBhbmQgdGhlIGNyZWF0ZSB0aW1lIGlzIG5ld2VyIHRoYW4gdGhlIGN1cnJlbnQgbG9hZGluZyBidW5kbGUuXG4gKi9cbi8qKlxuICogU2F2ZXMgdGhlIGdpdmVuIGBOYW1lZFF1ZXJ5YCB0byBsb2NhbCBwZXJzaXN0ZW5jZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gSXIodCwgZSwgbiA9IFBuKCkpIHtcbiAgICAvLyBBbGxvY2F0ZSBhIHRhcmdldCBmb3IgdGhlIG5hbWVkIHF1ZXJ5IHN1Y2ggdGhhdCBpdCBjYW4gYmUgcmVzdW1lZFxuICAgIC8vIGZyb20gYXNzb2NpYXRlZCByZWFkIHRpbWUgaWYgdXNlcnMgdXNlIGl0IHRvIGxpc3Rlbi5cbiAgICAvLyBOT1RFOiB0aGlzIGFsc28gbWVhbnMgaWYgbm8gY29ycmVzcG9uZGluZyB0YXJnZXQgZXhpc3RzLCB0aGUgbmV3IHRhcmdldFxuICAgIC8vIHdpbGwgcmVtYWluIGFjdGl2ZSBhbmQgd2lsbCBub3QgZ2V0IGNvbGxlY3RlZCwgdW5sZXNzIHVzZXJzIGhhcHBlbiB0b1xuICAgIC8vIHVubGlzdGVuIHRoZSBxdWVyeSBzb21laG93LlxuICAgIGNvbnN0IHMgPSBhd2FpdCBfcih0LCBFZSh3aShlLmJ1bmRsZWRRdWVyeSkpKSwgaSA9IFUodCk7XG4gICAgcmV0dXJuIGkucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJTYXZlIG5hbWVkIHF1ZXJ5XCIsIFwicmVhZHdyaXRlXCIsICh0ID0+IHtcbiAgICAgICAgY29uc3QgciA9IEtuKGUucmVhZFRpbWUpO1xuICAgICAgICAvLyBTaW1wbHkgc2F2ZSB0aGUgcXVlcnkgaXRzZWxmIGlmIGl0IGlzIG9sZGVyIHRoYW4gd2hhdCB0aGUgU0RLIGFscmVhZHlcbiAgICAgICAgLy8gaGFzLlxuICAgICAgICAgICAgICAgIGlmIChzLnNuYXBzaG90VmVyc2lvbi5jb21wYXJlVG8ocikgPj0gMCkgcmV0dXJuIGkuSmUuc2F2ZU5hbWVkUXVlcnkodCwgZSk7XG4gICAgICAgIC8vIFVwZGF0ZSBleGlzdGluZyB0YXJnZXQgZGF0YSBiZWNhdXNlIHRoZSBxdWVyeSBmcm9tIHRoZSBidW5kbGUgaXMgbmV3ZXIuXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IHMud2l0aFJlc3VtZVRva2VuKHd0LkVNUFRZX0JZVEVfU1RSSU5HLCByKTtcbiAgICAgICAgcmV0dXJuIGkuVW4gPSBpLlVuLmluc2VydChvLnRhcmdldElkLCBvKSwgaS56ZS51cGRhdGVUYXJnZXREYXRhKHQsIG8pLm5leHQoKCgpID0+IGkuemUucmVtb3ZlTWF0Y2hpbmdLZXlzRm9yVGFyZ2V0SWQodCwgcy50YXJnZXRJZCkpKS5uZXh0KCgoKSA9PiBpLnplLmFkZE1hdGNoaW5nS2V5cyh0LCBuLCBzLnRhcmdldElkKSkpLm5leHQoKCgpID0+IGkuSmUuc2F2ZU5hbWVkUXVlcnkodCwgZSkpKTtcbiAgICB9KSk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNsYXNzIEFyIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMuTiA9IHQsIHRoaXMuWW4gPSBuZXcgTWFwLCB0aGlzLlhuID0gbmV3IE1hcDtcbiAgICB9XG4gICAgZ2V0QnVuZGxlTWV0YWRhdGEodCwgZSkge1xuICAgICAgICByZXR1cm4gS3MucmVzb2x2ZSh0aGlzLlluLmdldChlKSk7XG4gICAgfVxuICAgIHNhdmVCdW5kbGVNZXRhZGF0YSh0LCBlKSB7XG4gICAgICAgIC8qKiBEZWNvZGVzIGEgQnVuZGxlTWV0YWRhdGEgcHJvdG8gaW50byBhIEJ1bmRsZU1ldGFkYXRhIG9iamVjdC4gKi9cbiAgICAgICAgdmFyIG47XG4gICAgICAgIHJldHVybiB0aGlzLlluLnNldChlLmlkLCB7XG4gICAgICAgICAgICBpZDogKG4gPSBlKS5pZCxcbiAgICAgICAgICAgIHZlcnNpb246IG4udmVyc2lvbixcbiAgICAgICAgICAgIGNyZWF0ZVRpbWU6IEtuKG4uY3JlYXRlVGltZSlcbiAgICAgICAgfSksIEtzLnJlc29sdmUoKTtcbiAgICB9XG4gICAgZ2V0TmFtZWRRdWVyeSh0LCBlKSB7XG4gICAgICAgIHJldHVybiBLcy5yZXNvbHZlKHRoaXMuWG4uZ2V0KGUpKTtcbiAgICB9XG4gICAgc2F2ZU5hbWVkUXVlcnkodCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5Ybi5zZXQoZS5uYW1lLCBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIG5hbWU6IHQubmFtZSxcbiAgICAgICAgICAgICAgICBxdWVyeTogd2kodC5idW5kbGVkUXVlcnkpLFxuICAgICAgICAgICAgICAgIHJlYWRUaW1lOiBLbih0LnJlYWRUaW1lKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfShlKSksIEtzLnJlc29sdmUoKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEEgY29sbGVjdGlvbiBvZiByZWZlcmVuY2VzIHRvIGEgZG9jdW1lbnQgZnJvbSBzb21lIGtpbmQgb2YgbnVtYmVyZWQgZW50aXR5XG4gKiAoZWl0aGVyIGEgdGFyZ2V0IElEIG9yIGJhdGNoIElEKS4gQXMgcmVmZXJlbmNlcyBhcmUgYWRkZWQgdG8gb3IgcmVtb3ZlZCBmcm9tXG4gKiB0aGUgc2V0IGNvcnJlc3BvbmRpbmcgZXZlbnRzIGFyZSBlbWl0dGVkIHRvIGEgcmVnaXN0ZXJlZCBnYXJiYWdlIGNvbGxlY3Rvci5cbiAqXG4gKiBFYWNoIHJlZmVyZW5jZSBpcyByZXByZXNlbnRlZCBieSBhIERvY3VtZW50UmVmZXJlbmNlIG9iamVjdC4gRWFjaCBvZiB0aGVtXG4gKiBjb250YWlucyBlbm91Z2ggaW5mb3JtYXRpb24gdG8gdW5pcXVlbHkgaWRlbnRpZnkgdGhlIHJlZmVyZW5jZS4gVGhleSBhcmUgYWxsXG4gKiBzdG9yZWQgcHJpbWFyaWx5IGluIGEgc2V0IHNvcnRlZCBieSBrZXkuIEEgZG9jdW1lbnQgaXMgY29uc2lkZXJlZCBnYXJiYWdlIGlmXG4gKiB0aGVyZSdzIG5vIHJlZmVyZW5jZXMgaW4gdGhhdCBzZXQgKHRoaXMgY2FuIGJlIGVmZmljaWVudGx5IGNoZWNrZWQgdGhhbmtzIHRvXG4gKiBzb3J0aW5nIGJ5IGtleSkuXG4gKlxuICogUmVmZXJlbmNlU2V0IGFsc28ga2VlcHMgYSBzZWNvbmRhcnkgc2V0IHRoYXQgY29udGFpbnMgcmVmZXJlbmNlcyBzb3J0ZWQgYnlcbiAqIElEcy4gVGhpcyBvbmUgaXMgdXNlZCB0byBlZmZpY2llbnRseSBpbXBsZW1lbnQgcmVtb3ZhbCBvZiBhbGwgcmVmZXJlbmNlcyBieVxuICogc29tZSB0YXJnZXQgSUQuXG4gKi8gY2xhc3MgUnIge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAvLyBBIHNldCBvZiBvdXRzdGFuZGluZyByZWZlcmVuY2VzIHRvIGEgZG9jdW1lbnQgc29ydGVkIGJ5IGtleS5cbiAgICAgICAgdGhpcy5abiA9IG5ldyBtbihQci50cyksIFxuICAgICAgICAvLyBBIHNldCBvZiBvdXRzdGFuZGluZyByZWZlcmVuY2VzIHRvIGEgZG9jdW1lbnQgc29ydGVkIGJ5IHRhcmdldCBpZC5cbiAgICAgICAgdGhpcy5lcyA9IG5ldyBtbihQci5ucyk7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIHRydWUgaWYgdGhlIHJlZmVyZW5jZSBzZXQgY29udGFpbnMgbm8gcmVmZXJlbmNlcy4gKi8gICAgaXNFbXB0eSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuWm4uaXNFbXB0eSgpO1xuICAgIH1cbiAgICAvKiogQWRkcyBhIHJlZmVyZW5jZSB0byB0aGUgZ2l2ZW4gZG9jdW1lbnQga2V5IGZvciB0aGUgZ2l2ZW4gSUQuICovICAgIGFkZFJlZmVyZW5jZSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBuZXcgUHIodCwgZSk7XG4gICAgICAgIHRoaXMuWm4gPSB0aGlzLlpuLmFkZChuKSwgdGhpcy5lcyA9IHRoaXMuZXMuYWRkKG4pO1xuICAgIH1cbiAgICAvKiogQWRkIHJlZmVyZW5jZXMgdG8gdGhlIGdpdmVuIGRvY3VtZW50IGtleXMgZm9yIHRoZSBnaXZlbiBJRC4gKi8gICAgc3ModCwgZSkge1xuICAgICAgICB0LmZvckVhY2goKHQgPT4gdGhpcy5hZGRSZWZlcmVuY2UodCwgZSkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyBhIHJlZmVyZW5jZSB0byB0aGUgZ2l2ZW4gZG9jdW1lbnQga2V5IGZvciB0aGUgZ2l2ZW5cbiAgICAgKiBJRC5cbiAgICAgKi8gICAgcmVtb3ZlUmVmZXJlbmNlKHQsIGUpIHtcbiAgICAgICAgdGhpcy5ycyhuZXcgUHIodCwgZSkpO1xuICAgIH1cbiAgICBvcyh0LCBlKSB7XG4gICAgICAgIHQuZm9yRWFjaCgodCA9PiB0aGlzLnJlbW92ZVJlZmVyZW5jZSh0LCBlKSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDbGVhcnMgYWxsIHJlZmVyZW5jZXMgd2l0aCBhIGdpdmVuIElELiBDYWxscyByZW1vdmVSZWYoKSBmb3IgZWFjaCBrZXlcbiAgICAgKiByZW1vdmVkLlxuICAgICAqLyAgICBjcyh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBuZXcgUHQobmV3IHV0KFtdKSksIG4gPSBuZXcgUHIoZSwgdCksIHMgPSBuZXcgUHIoZSwgdCArIDEpLCBpID0gW107XG4gICAgICAgIHJldHVybiB0aGlzLmVzLmZvckVhY2hJblJhbmdlKFsgbiwgcyBdLCAodCA9PiB7XG4gICAgICAgICAgICB0aGlzLnJzKHQpLCBpLnB1c2godC5rZXkpO1xuICAgICAgICB9KSksIGk7XG4gICAgfVxuICAgIHVzKCkge1xuICAgICAgICB0aGlzLlpuLmZvckVhY2goKHQgPT4gdGhpcy5ycyh0KSkpO1xuICAgIH1cbiAgICBycyh0KSB7XG4gICAgICAgIHRoaXMuWm4gPSB0aGlzLlpuLmRlbGV0ZSh0KSwgdGhpcy5lcyA9IHRoaXMuZXMuZGVsZXRlKHQpO1xuICAgIH1cbiAgICBocyh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBuZXcgUHQobmV3IHV0KFtdKSksIG4gPSBuZXcgUHIoZSwgdCksIHMgPSBuZXcgUHIoZSwgdCArIDEpO1xuICAgICAgICBsZXQgaSA9IFBuKCk7XG4gICAgICAgIHJldHVybiB0aGlzLmVzLmZvckVhY2hJblJhbmdlKFsgbiwgcyBdLCAodCA9PiB7XG4gICAgICAgICAgICBpID0gaS5hZGQodC5rZXkpO1xuICAgICAgICB9KSksIGk7XG4gICAgfVxuICAgIGNvbnRhaW5zS2V5KHQpIHtcbiAgICAgICAgY29uc3QgZSA9IG5ldyBQcih0LCAwKSwgbiA9IHRoaXMuWm4uZmlyc3RBZnRlck9yRXF1YWwoZSk7XG4gICAgICAgIHJldHVybiBudWxsICE9PSBuICYmIHQuaXNFcXVhbChuLmtleSk7XG4gICAgfVxufVxuXG5jbGFzcyBQciB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLmtleSA9IHQsIHRoaXMubHMgPSBlO1xuICAgIH1cbiAgICAvKiogQ29tcGFyZSBieSBrZXkgdGhlbiBieSBJRCAqLyAgICBzdGF0aWMgdHModCwgZSkge1xuICAgICAgICByZXR1cm4gUHQuY29tcGFyYXRvcih0LmtleSwgZS5rZXkpIHx8IHR0KHQubHMsIGUubHMpO1xuICAgIH1cbiAgICAvKiogQ29tcGFyZSBieSBJRCB0aGVuIGJ5IGtleSAqLyAgICBzdGF0aWMgbnModCwgZSkge1xuICAgICAgICByZXR1cm4gdHQodC5scywgZS5scykgfHwgUHQuY29tcGFyYXRvcih0LmtleSwgZS5rZXkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY2xhc3MgYnIge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5IdCA9IHQsIHRoaXMucmVmZXJlbmNlRGVsZWdhdGUgPSBlLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBzZXQgb2YgYWxsIG11dGF0aW9ucyB0aGF0IGhhdmUgYmVlbiBzZW50IGJ1dCBub3QgeWV0IGJlZW4gYXBwbGllZCB0b1xuICAgICAgICAgKiB0aGUgYmFja2VuZC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuSW4gPSBbXSwgXG4gICAgICAgIC8qKiBOZXh0IHZhbHVlIHRvIHVzZSB3aGVuIGFzc2lnbmluZyBzZXF1ZW50aWFsIElEcyB0byBlYWNoIG11dGF0aW9uIGJhdGNoLiAqL1xuICAgICAgICB0aGlzLmZzID0gMSwgXG4gICAgICAgIC8qKiBBbiBvcmRlcmVkIG1hcHBpbmcgYmV0d2VlbiBkb2N1bWVudHMgYW5kIHRoZSBtdXRhdGlvbnMgYmF0Y2ggSURzLiAqL1xuICAgICAgICB0aGlzLmRzID0gbmV3IG1uKFByLnRzKTtcbiAgICB9XG4gICAgY2hlY2tFbXB0eSh0KSB7XG4gICAgICAgIHJldHVybiBLcy5yZXNvbHZlKDAgPT09IHRoaXMuSW4ubGVuZ3RoKTtcbiAgICB9XG4gICAgYWRkTXV0YXRpb25CYXRjaCh0LCBlLCBuLCBzKSB7XG4gICAgICAgIGNvbnN0IGkgPSB0aGlzLmZzO1xuICAgICAgICB0aGlzLmZzKyssIHRoaXMuSW4ubGVuZ3RoID4gMCAmJiB0aGlzLkluW3RoaXMuSW4ubGVuZ3RoIC0gMV07XG4gICAgICAgIGNvbnN0IHIgPSBuZXcgZWkoaSwgZSwgbiwgcyk7XG4gICAgICAgIHRoaXMuSW4ucHVzaChyKTtcbiAgICAgICAgLy8gVHJhY2sgcmVmZXJlbmNlcyBieSBkb2N1bWVudCBrZXkgYW5kIGluZGV4IGNvbGxlY3Rpb24gcGFyZW50cy5cbiAgICAgICAgZm9yIChjb25zdCBlIG9mIHMpIHRoaXMuZHMgPSB0aGlzLmRzLmFkZChuZXcgUHIoZS5rZXksIGkpKSwgdGhpcy5IdC5hZGRUb0NvbGxlY3Rpb25QYXJlbnRJbmRleCh0LCBlLmtleS5wYXRoLnBvcExhc3QoKSk7XG4gICAgICAgIHJldHVybiBLcy5yZXNvbHZlKHIpO1xuICAgIH1cbiAgICBsb29rdXBNdXRhdGlvbkJhdGNoKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIEtzLnJlc29sdmUodGhpcy53cyhlKSk7XG4gICAgfVxuICAgIGdldE5leHRNdXRhdGlvbkJhdGNoQWZ0ZXJCYXRjaElkKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IGUgKyAxLCBzID0gdGhpcy5fcyhuKSwgaSA9IHMgPCAwID8gMCA6IHM7XG4gICAgICAgIC8vIFRoZSByZXF1ZXN0ZWQgYmF0Y2hJZCBtYXkgc3RpbGwgYmUgb3V0IG9mIHJhbmdlIHNvIG5vcm1hbGl6ZSBpdCB0byB0aGVcbiAgICAgICAgLy8gc3RhcnQgb2YgdGhlIHF1ZXVlLlxuICAgICAgICAgICAgICAgIHJldHVybiBLcy5yZXNvbHZlKHRoaXMuSW4ubGVuZ3RoID4gaSA/IHRoaXMuSW5baV0gOiBudWxsKTtcbiAgICB9XG4gICAgZ2V0SGlnaGVzdFVuYWNrbm93bGVkZ2VkQmF0Y2hJZCgpIHtcbiAgICAgICAgcmV0dXJuIEtzLnJlc29sdmUoMCA9PT0gdGhpcy5Jbi5sZW5ndGggPyAtMSA6IHRoaXMuZnMgLSAxKTtcbiAgICB9XG4gICAgZ2V0QWxsTXV0YXRpb25CYXRjaGVzKHQpIHtcbiAgICAgICAgcmV0dXJuIEtzLnJlc29sdmUodGhpcy5Jbi5zbGljZSgpKTtcbiAgICB9XG4gICAgZ2V0QWxsTXV0YXRpb25CYXRjaGVzQWZmZWN0aW5nRG9jdW1lbnRLZXkodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gbmV3IFByKGUsIDApLCBzID0gbmV3IFByKGUsIE51bWJlci5QT1NJVElWRV9JTkZJTklUWSksIGkgPSBbXTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZHMuZm9yRWFjaEluUmFuZ2UoWyBuLCBzIF0sICh0ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLndzKHQubHMpO1xuICAgICAgICAgICAgaS5wdXNoKGUpO1xuICAgICAgICB9KSksIEtzLnJlc29sdmUoaSk7XG4gICAgfVxuICAgIGdldEFsbE11dGF0aW9uQmF0Y2hlc0FmZmVjdGluZ0RvY3VtZW50S2V5cyh0LCBlKSB7XG4gICAgICAgIGxldCBuID0gbmV3IG1uKHR0KTtcbiAgICAgICAgcmV0dXJuIGUuZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICBjb25zdCBlID0gbmV3IFByKHQsIDApLCBzID0gbmV3IFByKHQsIE51bWJlci5QT1NJVElWRV9JTkZJTklUWSk7XG4gICAgICAgICAgICB0aGlzLmRzLmZvckVhY2hJblJhbmdlKFsgZSwgcyBdLCAodCA9PiB7XG4gICAgICAgICAgICAgICAgbiA9IG4uYWRkKHQubHMpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9KSksIEtzLnJlc29sdmUodGhpcy5ncyhuKSk7XG4gICAgfVxuICAgIGdldEFsbE11dGF0aW9uQmF0Y2hlc0FmZmVjdGluZ1F1ZXJ5KHQsIGUpIHtcbiAgICAgICAgLy8gVXNlIHRoZSBxdWVyeSBwYXRoIGFzIGEgcHJlZml4IGZvciB0ZXN0aW5nIGlmIGEgZG9jdW1lbnQgbWF0Y2hlcyB0aGVcbiAgICAgICAgLy8gcXVlcnkuXG4gICAgICAgIGNvbnN0IG4gPSBlLnBhdGgsIHMgPSBuLmxlbmd0aCArIDE7XG4gICAgICAgIC8vIENvbnN0cnVjdCBhIGRvY3VtZW50IHJlZmVyZW5jZSBmb3IgYWN0dWFsbHkgc2Nhbm5pbmcgdGhlIGluZGV4LiBVbmxpa2VcbiAgICAgICAgLy8gdGhlIHByZWZpeCB0aGUgZG9jdW1lbnQga2V5IGluIHRoaXMgcmVmZXJlbmNlIG11c3QgaGF2ZSBhbiBldmVuIG51bWJlciBvZlxuICAgICAgICAvLyBzZWdtZW50cy4gVGhlIGVtcHR5IHNlZ21lbnQgY2FuIGJlIHVzZWQgYSBzdWZmaXggb2YgdGhlIHF1ZXJ5IHBhdGhcbiAgICAgICAgLy8gYmVjYXVzZSBpdCBwcmVjZWRlcyBhbGwgb3RoZXIgc2VnbWVudHMgaW4gYW4gb3JkZXJlZCB0cmF2ZXJzYWwuXG4gICAgICAgIGxldCBpID0gbjtcbiAgICAgICAgUHQuaXNEb2N1bWVudEtleShpKSB8fCAoaSA9IGkuY2hpbGQoXCJcIikpO1xuICAgICAgICBjb25zdCByID0gbmV3IFByKG5ldyBQdChpKSwgMCk7XG4gICAgICAgIC8vIEZpbmQgdW5pcXVlIGJhdGNoSURzIHJlZmVyZW5jZWQgYnkgYWxsIGRvY3VtZW50cyBwb3RlbnRpYWxseSBtYXRjaGluZyB0aGVcbiAgICAgICAgLy8gcXVlcnkuXG4gICAgICAgICAgICAgICAgbGV0IG8gPSBuZXcgbW4odHQpO1xuICAgICAgICByZXR1cm4gdGhpcy5kcy5mb3JFYWNoV2hpbGUoKHQgPT4ge1xuICAgICAgICAgICAgY29uc3QgZSA9IHQua2V5LnBhdGg7XG4gICAgICAgICAgICByZXR1cm4gISFuLmlzUHJlZml4T2YoZSkgJiYgKFxuICAgICAgICAgICAgLy8gUm93cyB3aXRoIGRvY3VtZW50IGtleXMgbW9yZSB0aGFuIG9uZSBzZWdtZW50IGxvbmdlciB0aGFuIHRoZSBxdWVyeVxuICAgICAgICAgICAgLy8gcGF0aCBjYW4ndCBiZSBtYXRjaGVzLiBGb3IgZXhhbXBsZSwgYSBxdWVyeSBvbiAncm9vbXMnIGNhbid0IG1hdGNoXG4gICAgICAgICAgICAvLyB0aGUgZG9jdW1lbnQgL3Jvb21zL2FiYy9tZXNzYWdlcy94eXguXG4gICAgICAgICAgICAvLyBUT0RPKG1jZyk6IHdlJ2xsIG5lZWQgYSBkaWZmZXJlbnQgc2Nhbm5lciB3aGVuIHdlIGltcGxlbWVudFxuICAgICAgICAgICAgLy8gYW5jZXN0b3IgcXVlcmllcy5cbiAgICAgICAgICAgIGUubGVuZ3RoID09PSBzICYmIChvID0gby5hZGQodC5scykpLCAhMCk7XG4gICAgICAgIH0pLCByKSwgS3MucmVzb2x2ZSh0aGlzLmdzKG8pKTtcbiAgICB9XG4gICAgZ3ModCkge1xuICAgICAgICAvLyBDb25zdHJ1Y3QgYW4gYXJyYXkgb2YgbWF0Y2hpbmcgYmF0Y2hlcywgc29ydGVkIGJ5IGJhdGNoSUQgdG8gZW5zdXJlIHRoYXRcbiAgICAgICAgLy8gbXVsdGlwbGUgbXV0YXRpb25zIGFmZmVjdGluZyB0aGUgc2FtZSBkb2N1bWVudCBrZXkgYXJlIGFwcGxpZWQgaW4gb3JkZXIuXG4gICAgICAgIGNvbnN0IGUgPSBbXTtcbiAgICAgICAgcmV0dXJuIHQuZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICBjb25zdCBuID0gdGhpcy53cyh0KTtcbiAgICAgICAgICAgIG51bGwgIT09IG4gJiYgZS5wdXNoKG4pO1xuICAgICAgICB9KSksIGU7XG4gICAgfVxuICAgIHJlbW92ZU11dGF0aW9uQmF0Y2godCwgZSkge1xuICAgICAgICBMKDAgPT09IHRoaXMueXMoZS5iYXRjaElkLCBcInJlbW92ZWRcIikpLCB0aGlzLkluLnNoaWZ0KCk7XG4gICAgICAgIGxldCBuID0gdGhpcy5kcztcbiAgICAgICAgcmV0dXJuIEtzLmZvckVhY2goZS5tdXRhdGlvbnMsIChzID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGkgPSBuZXcgUHIocy5rZXksIGUuYmF0Y2hJZCk7XG4gICAgICAgICAgICByZXR1cm4gbiA9IG4uZGVsZXRlKGkpLCB0aGlzLnJlZmVyZW5jZURlbGVnYXRlLm1hcmtQb3RlbnRpYWxseU9ycGhhbmVkKHQsIHMua2V5KTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZHMgPSBuO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRlKHQpIHtcbiAgICAgICAgLy8gTm8tb3Agc2luY2UgdGhlIG1lbW9yeSBtdXRhdGlvbiBxdWV1ZSBkb2VzIG5vdCBtYWludGFpbiBhIHNlcGFyYXRlIGNhY2hlLlxuICAgIH1cbiAgICBjb250YWluc0tleSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBuZXcgUHIoZSwgMCksIHMgPSB0aGlzLmRzLmZpcnN0QWZ0ZXJPckVxdWFsKG4pO1xuICAgICAgICByZXR1cm4gS3MucmVzb2x2ZShlLmlzRXF1YWwocyAmJiBzLmtleSkpO1xuICAgIH1cbiAgICBwZXJmb3JtQ29uc2lzdGVuY3lDaGVjayh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLkluLmxlbmd0aCwgS3MucmVzb2x2ZSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBGaW5kcyB0aGUgaW5kZXggb2YgdGhlIGdpdmVuIGJhdGNoSWQgaW4gdGhlIG11dGF0aW9uIHF1ZXVlIGFuZCBhc3NlcnRzIHRoYXRcbiAgICAgKiB0aGUgcmVzdWx0aW5nIGluZGV4IGlzIHdpdGhpbiB0aGUgYm91bmRzIG9mIHRoZSBxdWV1ZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBiYXRjaElkIC0gVGhlIGJhdGNoSWQgdG8gc2VhcmNoIGZvclxuICAgICAqIEBwYXJhbSBhY3Rpb24gLSBBIGRlc2NyaXB0aW9uIG9mIHdoYXQgdGhlIGNhbGxlciBpcyBkb2luZywgcGhyYXNlZCBpbiBwYXNzaXZlXG4gICAgICogZm9ybSAoZS5nLiBcImFja25vd2xlZGdlZFwiIGluIGEgcm91dGluZSB0aGF0IGFja25vd2xlZGdlcyBiYXRjaGVzKS5cbiAgICAgKi8gICAgeXModCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcyh0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRmluZHMgdGhlIGluZGV4IG9mIHRoZSBnaXZlbiBiYXRjaElkIGluIHRoZSBtdXRhdGlvbiBxdWV1ZS4gVGhpcyBvcGVyYXRpb25cbiAgICAgKiBpcyBPKDEpLlxuICAgICAqXG4gICAgICogQHJldHVybnMgVGhlIGNvbXB1dGVkIGluZGV4IG9mIHRoZSBiYXRjaCB3aXRoIHRoZSBnaXZlbiBiYXRjaElkLCBiYXNlZCBvblxuICAgICAqIHRoZSBzdGF0ZSBvZiB0aGUgcXVldWUuIE5vdGUgdGhpcyBpbmRleCBjYW4gYmUgbmVnYXRpdmUgaWYgdGhlIHJlcXVlc3RlZFxuICAgICAqIGJhdGNoSWQgaGFzIGFscmVhZHkgYmVlbiByZW12b2VkIGZyb20gdGhlIHF1ZXVlIG9yIHBhc3QgdGhlIGVuZCBvZiB0aGVcbiAgICAgKiBxdWV1ZSBpZiB0aGUgYmF0Y2hJZCBpcyBsYXJnZXIgdGhhbiB0aGUgbGFzdCBhZGRlZCBiYXRjaC5cbiAgICAgKi8gICAgX3ModCkge1xuICAgICAgICBpZiAoMCA9PT0gdGhpcy5Jbi5sZW5ndGgpIFxuICAgICAgICAvLyBBcyBhbiBpbmRleCB0aGlzIGlzIHBhc3QgdGhlIGVuZCBvZiB0aGUgcXVldWVcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIC8vIEV4YW1pbmUgdGhlIGZyb250IG9mIHRoZSBxdWV1ZSB0byBmaWd1cmUgb3V0IHRoZSBkaWZmZXJlbmNlIGJldHdlZW4gdGhlXG4gICAgICAgIC8vIGJhdGNoSWQgYW5kIGluZGV4ZXMgaW4gdGhlIGFycmF5LiBOb3RlIHRoYXQgc2luY2UgdGhlIHF1ZXVlIGlzIG9yZGVyZWRcbiAgICAgICAgLy8gYnkgYmF0Y2hJZCwgaWYgdGhlIGZpcnN0IGJhdGNoIGhhcyBhIGxhcmdlciBiYXRjaElkIHRoZW4gdGhlIHJlcXVlc3RlZFxuICAgICAgICAvLyBiYXRjaElkIGRvZXNuJ3QgZXhpc3QgaW4gdGhlIHF1ZXVlLlxuICAgICAgICAgICAgICAgIHJldHVybiB0IC0gdGhpcy5JblswXS5iYXRjaElkO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBIHZlcnNpb24gb2YgbG9va3VwTXV0YXRpb25CYXRjaCB0aGF0IGRvZXNuJ3QgcmV0dXJuIGEgcHJvbWlzZSwgdGhpcyBtYWtlc1xuICAgICAqIG90aGVyIGZ1bmN0aW9ucyB0aGF0IHVzZXMgdGhpcyBjb2RlIGVhc2llciB0byByZWFkIGFuZCBtb3JlIGVmZmljZW50LlxuICAgICAqLyAgICB3cyh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLl9zKHQpO1xuICAgICAgICBpZiAoZSA8IDAgfHwgZSA+PSB0aGlzLkluLmxlbmd0aCkgcmV0dXJuIG51bGw7XG4gICAgICAgIHJldHVybiB0aGlzLkluW2VdO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogVGhlIG1lbW9yeS1vbmx5IFJlbW90ZURvY3VtZW50Q2FjaGUgZm9yIEluZGV4ZWREYi4gVG8gY29uc3RydWN0LCBpbnZva2VcbiAqIGBuZXdNZW1vcnlSZW1vdGVEb2N1bWVudENhY2hlKClgLlxuICovXG5jbGFzcyB2ciB7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHNpemVyIC0gVXNlZCB0byBhc3Nlc3MgdGhlIHNpemUgb2YgYSBkb2N1bWVudC4gRm9yIGVhZ2VyIEdDLCB0aGlzIGlzXG4gICAgICogZXhwZWN0ZWQgdG8ganVzdCByZXR1cm4gMCB0byBhdm9pZCB1bm5lY2Vzc2FyaWx5IGRvaW5nIHRoZSB3b3JrIG9mXG4gICAgICogY2FsY3VsYXRpbmcgdGhlIHNpemUuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLkh0ID0gdCwgdGhpcy5wcyA9IGUsIFxuICAgICAgICAvKiogVW5kZXJseWluZyBjYWNoZSBvZiBkb2N1bWVudHMgYW5kIHRoZWlyIHJlYWQgdGltZXMuICovXG4gICAgICAgIHRoaXMuZG9jcyA9IG5ldyBkbihQdC5jb21wYXJhdG9yKSwgXG4gICAgICAgIC8qKiBTaXplIG9mIGFsbCBjYWNoZWQgZG9jdW1lbnRzLiAqL1xuICAgICAgICB0aGlzLnNpemUgPSAwO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGRzIHRoZSBzdXBwbGllZCBlbnRyeSB0byB0aGUgY2FjaGUgYW5kIHVwZGF0ZXMgdGhlIGNhY2hlIHNpemUgYXMgYXBwcm9wcmlhdGUuXG4gICAgICpcbiAgICAgKiBBbGwgY2FsbHMgb2YgYGFkZEVudHJ5YCAgYXJlIHJlcXVpcmVkIHRvIGdvIHRocm91Z2ggdGhlIFJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyXG4gICAgICogcmV0dXJuZWQgYnkgYG5ld0NoYW5nZUJ1ZmZlcigpYC5cbiAgICAgKi8gICAgYWRkRW50cnkodCwgZSwgbikge1xuICAgICAgICBjb25zdCBzID0gZS5rZXksIGkgPSB0aGlzLmRvY3MuZ2V0KHMpLCByID0gaSA/IGkuc2l6ZSA6IDAsIG8gPSB0aGlzLnBzKGUpO1xuICAgICAgICByZXR1cm4gdGhpcy5kb2NzID0gdGhpcy5kb2NzLmluc2VydChzLCB7XG4gICAgICAgICAgICBkb2N1bWVudDogZS5jbG9uZSgpLFxuICAgICAgICAgICAgc2l6ZTogbyxcbiAgICAgICAgICAgIHJlYWRUaW1lOiBuXG4gICAgICAgIH0pLCB0aGlzLnNpemUgKz0gbyAtIHIsIHRoaXMuSHQuYWRkVG9Db2xsZWN0aW9uUGFyZW50SW5kZXgodCwgcy5wYXRoLnBvcExhc3QoKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgdGhlIHNwZWNpZmllZCBlbnRyeSBmcm9tIHRoZSBjYWNoZSBhbmQgdXBkYXRlcyB0aGUgY2FjaGUgc2l6ZSBhcyBhcHByb3ByaWF0ZS5cbiAgICAgKlxuICAgICAqIEFsbCBjYWxscyBvZiBgcmVtb3ZlRW50cnlgIGFyZSByZXF1aXJlZCB0byBnbyB0aHJvdWdoIHRoZSBSZW1vdGVEb2N1bWVudENoYW5nZUJ1ZmZlclxuICAgICAqIHJldHVybmVkIGJ5IGBuZXdDaGFuZ2VCdWZmZXIoKWAuXG4gICAgICovICAgIHJlbW92ZUVudHJ5KHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuZG9jcy5nZXQodCk7XG4gICAgICAgIGUgJiYgKHRoaXMuZG9jcyA9IHRoaXMuZG9jcy5yZW1vdmUodCksIHRoaXMuc2l6ZSAtPSBlLnNpemUpO1xuICAgIH1cbiAgICBnZXRFbnRyeSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSB0aGlzLmRvY3MuZ2V0KGUpO1xuICAgICAgICByZXR1cm4gS3MucmVzb2x2ZShuID8gbi5kb2N1bWVudC5jbG9uZSgpIDogcXQubmV3SW52YWxpZERvY3VtZW50KGUpKTtcbiAgICB9XG4gICAgZ2V0RW50cmllcyh0LCBlKSB7XG4gICAgICAgIGxldCBuID0gcG4oKTtcbiAgICAgICAgcmV0dXJuIGUuZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICBjb25zdCBlID0gdGhpcy5kb2NzLmdldCh0KTtcbiAgICAgICAgICAgIG4gPSBuLmluc2VydCh0LCBlID8gZS5kb2N1bWVudC5jbG9uZSgpIDogcXQubmV3SW52YWxpZERvY3VtZW50KHQpKTtcbiAgICAgICAgfSkpLCBLcy5yZXNvbHZlKG4pO1xuICAgIH1cbiAgICBnZXREb2N1bWVudHNNYXRjaGluZ1F1ZXJ5KHQsIGUsIG4pIHtcbiAgICAgICAgbGV0IHMgPSBwbigpO1xuICAgICAgICAvLyBEb2N1bWVudHMgYXJlIG9yZGVyZWQgYnkga2V5LCBzbyB3ZSBjYW4gdXNlIGEgcHJlZml4IHNjYW4gdG8gbmFycm93IGRvd25cbiAgICAgICAgLy8gdGhlIGRvY3VtZW50cyB3ZSBuZWVkIHRvIG1hdGNoIHRoZSBxdWVyeSBhZ2FpbnN0LlxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBuZXcgUHQoZS5wYXRoLmNoaWxkKFwiXCIpKSwgciA9IHRoaXMuZG9jcy5nZXRJdGVyYXRvckZyb20oaSk7XG4gICAgICAgIGZvciAoO3IuaGFzTmV4dCgpOyApIHtcbiAgICAgICAgICAgIGNvbnN0IHtrZXk6IHQsIHZhbHVlOiB7ZG9jdW1lbnQ6IGksIHJlYWRUaW1lOiBvfX0gPSByLmdldE5leHQoKTtcbiAgICAgICAgICAgIGlmICghZS5wYXRoLmlzUHJlZml4T2YodC5wYXRoKSkgYnJlYWs7XG4gICAgICAgICAgICBvLmNvbXBhcmVUbyhuKSA8PSAwIHx8IFBlKGUsIGkpICYmIChzID0gcy5pbnNlcnQoaS5rZXksIGkuY2xvbmUoKSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBLcy5yZXNvbHZlKHMpO1xuICAgIH1cbiAgICBFcyh0LCBlKSB7XG4gICAgICAgIHJldHVybiBLcy5mb3JFYWNoKHRoaXMuZG9jcywgKHQgPT4gZSh0KSkpO1xuICAgIH1cbiAgICBuZXdDaGFuZ2VCdWZmZXIodCkge1xuICAgICAgICAvLyBgdHJhY2tSZW1vdmFsc2AgaXMgaWdub3JlcyBzaW5jZSB0aGUgTWVtb3J5UmVtb3RlRG9jdW1lbnRDYWNoZSBrZWVwc1xuICAgICAgICAvLyBhIHNlcGFyYXRlIGNoYW5nZWxvZyBhbmQgZG9lcyBub3QgbmVlZCBzcGVjaWFsIGhhbmRsaW5nIGZvciByZW1vdmFscy5cbiAgICAgICAgcmV0dXJuIG5ldyBWcih0aGlzKTtcbiAgICB9XG4gICAgZ2V0U2l6ZSh0KSB7XG4gICAgICAgIHJldHVybiBLcy5yZXNvbHZlKHRoaXMuc2l6ZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgbWVtb3J5LW9ubHkgUmVtb3RlRG9jdW1lbnRDYWNoZS5cbiAqXG4gKiBAcGFyYW0gaW5kZXhNYW5hZ2VyIC0gQSBjbGFzcyB0aGF0IG1hbmFnZXMgY29sbGVjdGlvbiBncm91cCBpbmRpY2VzLlxuICogQHBhcmFtIHNpemVyIC0gVXNlZCB0byBhc3Nlc3MgdGhlIHNpemUgb2YgYSBkb2N1bWVudC4gRm9yIGVhZ2VyIEdDLCB0aGlzIGlzXG4gKiBleHBlY3RlZCB0byBqdXN0IHJldHVybiAwIHRvIGF2b2lkIHVubmVjZXNzYXJpbHkgZG9pbmcgdGhlIHdvcmsgb2ZcbiAqIGNhbGN1bGF0aW5nIHRoZSBzaXplLlxuICovXG4vKipcbiAqIEhhbmRsZXMgdGhlIGRldGFpbHMgb2YgYWRkaW5nIGFuZCB1cGRhdGluZyBkb2N1bWVudHMgaW4gdGhlIE1lbW9yeVJlbW90ZURvY3VtZW50Q2FjaGUuXG4gKi9cbmNsYXNzIFZyIGV4dGVuZHMgamkge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5TZSA9IHQ7XG4gICAgfVxuICAgIGFwcGx5Q2hhbmdlcyh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBbXTtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2hhbmdlcy5mb3JFYWNoKCgobiwgcykgPT4ge1xuICAgICAgICAgICAgcy5kb2N1bWVudC5pc1ZhbGlkRG9jdW1lbnQoKSA/IGUucHVzaCh0aGlzLlNlLmFkZEVudHJ5KHQsIHMuZG9jdW1lbnQsIHRoaXMuZ2V0UmVhZFRpbWUobikpKSA6IHRoaXMuU2UucmVtb3ZlRW50cnkobik7XG4gICAgICAgIH0pKSwgS3Mud2FpdEZvcihlKTtcbiAgICB9XG4gICAgZ2V0RnJvbUNhY2hlKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuU2UuZ2V0RW50cnkodCwgZSk7XG4gICAgfVxuICAgIGdldEFsbEZyb21DYWNoZSh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLlNlLmdldEVudHJpZXModCwgZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjbGFzcyBTciB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLnBlcnNpc3RlbmNlID0gdCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNYXBzIGEgdGFyZ2V0IHRvIHRoZSBkYXRhIGFib3V0IHRoYXQgdGFyZ2V0XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLlRzID0gbmV3IEtpKCh0ID0+IFF0KHQpKSwgR3QpLCBcbiAgICAgICAgLyoqIFRoZSBsYXN0IHJlY2VpdmVkIHNuYXBzaG90IHZlcnNpb24uICovXG4gICAgICAgIHRoaXMubGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbiA9IGl0Lm1pbigpLCBcbiAgICAgICAgLyoqIFRoZSBoaWdoZXN0IG51bWJlcmVkIHRhcmdldCBJRCBlbmNvdW50ZXJlZC4gKi9cbiAgICAgICAgdGhpcy5oaWdoZXN0VGFyZ2V0SWQgPSAwLCBcbiAgICAgICAgLyoqIFRoZSBoaWdoZXN0IHNlcXVlbmNlIG51bWJlciBlbmNvdW50ZXJlZC4gKi9cbiAgICAgICAgdGhpcy5JcyA9IDAsIFxuICAgICAgICAvKipcbiAgICAgICAgICogQSBvcmRlcmVkIGJpZGlyZWN0aW9uYWwgbWFwcGluZyBiZXR3ZWVuIGRvY3VtZW50cyBhbmQgdGhlIHJlbW90ZSB0YXJnZXRcbiAgICAgICAgICogSURzLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5BcyA9IG5ldyBSciwgdGhpcy50YXJnZXRDb3VudCA9IDAsIHRoaXMuUnMgPSBDaS5zZSgpO1xuICAgIH1cbiAgICBmb3JFYWNoVGFyZ2V0KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuVHMuZm9yRWFjaCgoKHQsIG4pID0+IGUobikpKSwgS3MucmVzb2x2ZSgpO1xuICAgIH1cbiAgICBnZXRMYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uKHQpIHtcbiAgICAgICAgcmV0dXJuIEtzLnJlc29sdmUodGhpcy5sYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uKTtcbiAgICB9XG4gICAgZ2V0SGlnaGVzdFNlcXVlbmNlTnVtYmVyKHQpIHtcbiAgICAgICAgcmV0dXJuIEtzLnJlc29sdmUodGhpcy5Jcyk7XG4gICAgfVxuICAgIGFsbG9jYXRlVGFyZ2V0SWQodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5oaWdoZXN0VGFyZ2V0SWQgPSB0aGlzLlJzLm5leHQoKSwgS3MucmVzb2x2ZSh0aGlzLmhpZ2hlc3RUYXJnZXRJZCk7XG4gICAgfVxuICAgIHNldFRhcmdldHNNZXRhZGF0YSh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiBuICYmICh0aGlzLmxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24gPSBuKSwgZSA+IHRoaXMuSXMgJiYgKHRoaXMuSXMgPSBlKSwgXG4gICAgICAgIEtzLnJlc29sdmUoKTtcbiAgICB9XG4gICAgYWUodCkge1xuICAgICAgICB0aGlzLlRzLnNldCh0LnRhcmdldCwgdCk7XG4gICAgICAgIGNvbnN0IGUgPSB0LnRhcmdldElkO1xuICAgICAgICBlID4gdGhpcy5oaWdoZXN0VGFyZ2V0SWQgJiYgKHRoaXMuUnMgPSBuZXcgQ2koZSksIHRoaXMuaGlnaGVzdFRhcmdldElkID0gZSksIHQuc2VxdWVuY2VOdW1iZXIgPiB0aGlzLklzICYmICh0aGlzLklzID0gdC5zZXF1ZW5jZU51bWJlcik7XG4gICAgfVxuICAgIGFkZFRhcmdldERhdGEodCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5hZShlKSwgdGhpcy50YXJnZXRDb3VudCArPSAxLCBLcy5yZXNvbHZlKCk7XG4gICAgfVxuICAgIHVwZGF0ZVRhcmdldERhdGEodCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5hZShlKSwgS3MucmVzb2x2ZSgpO1xuICAgIH1cbiAgICByZW1vdmVUYXJnZXREYXRhKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuVHMuZGVsZXRlKGUudGFyZ2V0KSwgdGhpcy5Bcy5jcyhlLnRhcmdldElkKSwgdGhpcy50YXJnZXRDb3VudCAtPSAxLCBcbiAgICAgICAgS3MucmVzb2x2ZSgpO1xuICAgIH1cbiAgICByZW1vdmVUYXJnZXRzKHQsIGUsIG4pIHtcbiAgICAgICAgbGV0IHMgPSAwO1xuICAgICAgICBjb25zdCBpID0gW107XG4gICAgICAgIHJldHVybiB0aGlzLlRzLmZvckVhY2goKChyLCBvKSA9PiB7XG4gICAgICAgICAgICBvLnNlcXVlbmNlTnVtYmVyIDw9IGUgJiYgbnVsbCA9PT0gbi5nZXQoby50YXJnZXRJZCkgJiYgKHRoaXMuVHMuZGVsZXRlKHIpLCBpLnB1c2godGhpcy5yZW1vdmVNYXRjaGluZ0tleXNGb3JUYXJnZXRJZCh0LCBvLnRhcmdldElkKSksIFxuICAgICAgICAgICAgcysrKTtcbiAgICAgICAgfSkpLCBLcy53YWl0Rm9yKGkpLm5leHQoKCgpID0+IHMpKTtcbiAgICB9XG4gICAgZ2V0VGFyZ2V0Q291bnQodCkge1xuICAgICAgICByZXR1cm4gS3MucmVzb2x2ZSh0aGlzLnRhcmdldENvdW50KTtcbiAgICB9XG4gICAgZ2V0VGFyZ2V0RGF0YSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSB0aGlzLlRzLmdldChlKSB8fCBudWxsO1xuICAgICAgICByZXR1cm4gS3MucmVzb2x2ZShuKTtcbiAgICB9XG4gICAgYWRkTWF0Y2hpbmdLZXlzKHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuQXMuc3MoZSwgbiksIEtzLnJlc29sdmUoKTtcbiAgICB9XG4gICAgcmVtb3ZlTWF0Y2hpbmdLZXlzKHQsIGUsIG4pIHtcbiAgICAgICAgdGhpcy5Bcy5vcyhlLCBuKTtcbiAgICAgICAgY29uc3QgcyA9IHRoaXMucGVyc2lzdGVuY2UucmVmZXJlbmNlRGVsZWdhdGUsIGkgPSBbXTtcbiAgICAgICAgcmV0dXJuIHMgJiYgZS5mb3JFYWNoKChlID0+IHtcbiAgICAgICAgICAgIGkucHVzaChzLm1hcmtQb3RlbnRpYWxseU9ycGhhbmVkKHQsIGUpKTtcbiAgICAgICAgfSkpLCBLcy53YWl0Rm9yKGkpO1xuICAgIH1cbiAgICByZW1vdmVNYXRjaGluZ0tleXNGb3JUYXJnZXRJZCh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLkFzLmNzKGUpLCBLcy5yZXNvbHZlKCk7XG4gICAgfVxuICAgIGdldE1hdGNoaW5nS2V5c0ZvclRhcmdldElkKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMuQXMuaHMoZSk7XG4gICAgICAgIHJldHVybiBLcy5yZXNvbHZlKG4pO1xuICAgIH1cbiAgICBjb250YWluc0tleSh0LCBlKSB7XG4gICAgICAgIHJldHVybiBLcy5yZXNvbHZlKHRoaXMuQXMuY29udGFpbnNLZXkoZSkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSBtZW1vcnktYmFja2VkIGluc3RhbmNlIG9mIFBlcnNpc3RlbmNlLiBEYXRhIGlzIHN0b3JlZCBvbmx5IGluIFJBTSBhbmRcbiAqIG5vdCBwZXJzaXN0ZWQgYWNyb3NzIHNlc3Npb25zLlxuICovXG5jbGFzcyBEciB7XG4gICAgLyoqXG4gICAgICogVGhlIGNvbnN0cnVjdG9yIGFjY2VwdHMgYSBmYWN0b3J5IGZvciBjcmVhdGluZyBhIHJlZmVyZW5jZSBkZWxlZ2F0ZS4gVGhpc1xuICAgICAqIGFsbG93cyBib3RoIHRoZSBkZWxlZ2F0ZSBhbmQgdGhpcyBpbnN0YW5jZSB0byBoYXZlIHN0cm9uZyByZWZlcmVuY2VzIHRvXG4gICAgICogZWFjaCBvdGhlciB3aXRob3V0IGhhdmluZyBudWxsYWJsZSBmaWVsZHMgdGhhdCB3b3VsZCB0aGVuIG5lZWQgdG8gYmVcbiAgICAgKiBjaGVja2VkIG9yIGFzc2VydGVkIG9uIGV2ZXJ5IGFjY2Vzcy5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMuUHMgPSB7fSwgdGhpcy5MZSA9IG5ldyBZKDApLCB0aGlzLkJlID0gITEsIHRoaXMuQmUgPSAhMCwgdGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZSA9IHQodGhpcyksIFxuICAgICAgICB0aGlzLnplID0gbmV3IFNyKHRoaXMpO1xuICAgICAgICB0aGlzLkh0ID0gbmV3IHlpLCB0aGlzLkhlID0gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyB2cih0LCBlKTtcbiAgICAgICAgfSh0aGlzLkh0LCAodCA9PiB0aGlzLnJlZmVyZW5jZURlbGVnYXRlLmJzKHQpKSksIHRoaXMuTiA9IG5ldyBpaShlKSwgdGhpcy5KZSA9IG5ldyBBcih0aGlzLk4pO1xuICAgIH1cbiAgICBzdGFydCgpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cbiAgICBzaHV0ZG93bigpIHtcbiAgICAgICAgLy8gTm8gZHVyYWJsZSBzdGF0ZSB0byBlbnN1cmUgaXMgY2xvc2VkIG9uIHNodXRkb3duLlxuICAgICAgICByZXR1cm4gdGhpcy5CZSA9ICExLCBQcm9taXNlLnJlc29sdmUoKTtcbiAgICB9XG4gICAgZ2V0IHN0YXJ0ZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLkJlO1xuICAgIH1cbiAgICBzZXREYXRhYmFzZURlbGV0ZWRMaXN0ZW5lcigpIHtcbiAgICAgICAgLy8gTm8gb3AuXG4gICAgfVxuICAgIHNldE5ldHdvcmtFbmFibGVkKCkge1xuICAgICAgICAvLyBObyBvcC5cbiAgICB9XG4gICAgZ2V0SW5kZXhNYW5hZ2VyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5IdDtcbiAgICB9XG4gICAgZ2V0TXV0YXRpb25RdWV1ZSh0KSB7XG4gICAgICAgIGxldCBlID0gdGhpcy5Qc1t0LnRvS2V5KCldO1xuICAgICAgICByZXR1cm4gZSB8fCAoZSA9IG5ldyBicih0aGlzLkh0LCB0aGlzLnJlZmVyZW5jZURlbGVnYXRlKSwgdGhpcy5Qc1t0LnRvS2V5KCldID0gZSksIFxuICAgICAgICBlO1xuICAgIH1cbiAgICBnZXRUYXJnZXRDYWNoZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuemU7XG4gICAgfVxuICAgIGdldFJlbW90ZURvY3VtZW50Q2FjaGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLkhlO1xuICAgIH1cbiAgICBnZXRCdW5kbGVDYWNoZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuSmU7XG4gICAgfVxuICAgIHJ1blRyYW5zYWN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgayhcIk1lbW9yeVBlcnNpc3RlbmNlXCIsIFwiU3RhcnRpbmcgdHJhbnNhY3Rpb246XCIsIHQpO1xuICAgICAgICBjb25zdCBzID0gbmV3IENyKHRoaXMuTGUubmV4dCgpKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVmZXJlbmNlRGVsZWdhdGUudnMoKSwgbihzKS5uZXh0KCh0ID0+IHRoaXMucmVmZXJlbmNlRGVsZWdhdGUuVnMocykubmV4dCgoKCkgPT4gdCkpKSkudG9Qcm9taXNlKCkudGhlbigodCA9PiAocy5yYWlzZU9uQ29tbWl0dGVkRXZlbnQoKSwgXG4gICAgICAgIHQpKSk7XG4gICAgfVxuICAgIFNzKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIEtzLm9yKE9iamVjdC52YWx1ZXModGhpcy5QcykubWFwKChuID0+ICgpID0+IG4uY29udGFpbnNLZXkodCwgZSkpKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIE1lbW9yeSBwZXJzaXN0ZW5jZSBpcyBub3QgYWN0dWFsbHkgdHJhbnNhY3Rpb25hbCwgYnV0IGZ1dHVyZSBpbXBsZW1lbnRhdGlvbnNcbiAqIG1heSBoYXZlIHRyYW5zYWN0aW9uLXNjb3BlZCBzdGF0ZS5cbiAqLyBjbGFzcyBDciBleHRlbmRzIHFzIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMuY3VycmVudFNlcXVlbmNlTnVtYmVyID0gdDtcbiAgICB9XG59XG5cbmNsYXNzIE5yIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMucGVyc2lzdGVuY2UgPSB0LCBcbiAgICAgICAgLyoqIFRyYWNrcyBhbGwgZG9jdW1lbnRzIHRoYXQgYXJlIGFjdGl2ZSBpbiBRdWVyeSB2aWV3cy4gKi9cbiAgICAgICAgdGhpcy5EcyA9IG5ldyBSciwgXG4gICAgICAgIC8qKiBUaGUgbGlzdCBvZiBkb2N1bWVudHMgdGhhdCBhcmUgcG90ZW50aWFsbHkgR0NlZCBhZnRlciBlYWNoIHRyYW5zYWN0aW9uLiAqL1xuICAgICAgICB0aGlzLkNzID0gbnVsbDtcbiAgICB9XG4gICAgc3RhdGljIE5zKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBOcih0KTtcbiAgICB9XG4gICAgZ2V0IHhzKCkge1xuICAgICAgICBpZiAodGhpcy5DcykgcmV0dXJuIHRoaXMuQ3M7XG4gICAgICAgIHRocm93IE0oKTtcbiAgICB9XG4gICAgYWRkUmVmZXJlbmNlKHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuRHMuYWRkUmVmZXJlbmNlKG4sIGUpLCB0aGlzLnhzLmRlbGV0ZShuLnRvU3RyaW5nKCkpLCBLcy5yZXNvbHZlKCk7XG4gICAgfVxuICAgIHJlbW92ZVJlZmVyZW5jZSh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiB0aGlzLkRzLnJlbW92ZVJlZmVyZW5jZShuLCBlKSwgdGhpcy54cy5hZGQobi50b1N0cmluZygpKSwgS3MucmVzb2x2ZSgpO1xuICAgIH1cbiAgICBtYXJrUG90ZW50aWFsbHlPcnBoYW5lZCh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnhzLmFkZChlLnRvU3RyaW5nKCkpLCBLcy5yZXNvbHZlKCk7XG4gICAgfVxuICAgIHJlbW92ZVRhcmdldCh0LCBlKSB7XG4gICAgICAgIHRoaXMuRHMuY3MoZS50YXJnZXRJZCkuZm9yRWFjaCgodCA9PiB0aGlzLnhzLmFkZCh0LnRvU3RyaW5nKCkpKSk7XG4gICAgICAgIGNvbnN0IG4gPSB0aGlzLnBlcnNpc3RlbmNlLmdldFRhcmdldENhY2hlKCk7XG4gICAgICAgIHJldHVybiBuLmdldE1hdGNoaW5nS2V5c0ZvclRhcmdldElkKHQsIGUudGFyZ2V0SWQpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgdC5mb3JFYWNoKCh0ID0+IHRoaXMueHMuYWRkKHQudG9TdHJpbmcoKSkpKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IG4ucmVtb3ZlVGFyZ2V0RGF0YSh0LCBlKSkpO1xuICAgIH1cbiAgICB2cygpIHtcbiAgICAgICAgdGhpcy5DcyA9IG5ldyBTZXQ7XG4gICAgfVxuICAgIFZzKHQpIHtcbiAgICAgICAgLy8gUmVtb3ZlIG5ld2x5IG9ycGhhbmVkIGRvY3VtZW50cy5cbiAgICAgICAgY29uc3QgZSA9IHRoaXMucGVyc2lzdGVuY2UuZ2V0UmVtb3RlRG9jdW1lbnRDYWNoZSgpLm5ld0NoYW5nZUJ1ZmZlcigpO1xuICAgICAgICByZXR1cm4gS3MuZm9yRWFjaCh0aGlzLnhzLCAobiA9PiB7XG4gICAgICAgICAgICBjb25zdCBzID0gUHQuZnJvbVBhdGgobik7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5rcyh0LCBzKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgICAgICB0IHx8IGUucmVtb3ZlRW50cnkocyk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiAodGhpcy5DcyA9IG51bGwsIGUuYXBwbHkodCkpKSk7XG4gICAgfVxuICAgIHVwZGF0ZUxpbWJvRG9jdW1lbnQodCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5rcyh0LCBlKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgIHQgPyB0aGlzLnhzLmRlbGV0ZShlLnRvU3RyaW5nKCkpIDogdGhpcy54cy5hZGQoZS50b1N0cmluZygpKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBicyh0KSB7XG4gICAgICAgIC8vIEZvciBlYWdlciBHQywgd2UgZG9uJ3QgY2FyZSBhYm91dCB0aGUgZG9jdW1lbnQgc2l6ZSwgdGhlcmUgYXJlIG5vIHNpemUgdGhyZXNob2xkcy5cbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIGtzKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIEtzLm9yKFsgKCkgPT4gS3MucmVzb2x2ZSh0aGlzLkRzLmNvbnRhaW5zS2V5KGUpKSwgKCkgPT4gdGhpcy5wZXJzaXN0ZW5jZS5nZXRUYXJnZXRDYWNoZSgpLmNvbnRhaW5zS2V5KHQsIGUpLCAoKSA9PiB0aGlzLnBlcnNpc3RlbmNlLlNzKHQsIGUpIF0pO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8vIFRoZSBmb3JtYXQgb2YgdGhlIExvY2FsU3RvcmFnZSBrZXkgdGhhdCBzdG9yZXMgdGhlIGNsaWVudCBzdGF0ZSBpczpcbi8vICAgICBmaXJlc3RvcmVfY2xpZW50c188cGVyc2lzdGVuY2VfcHJlZml4Pl88aW5zdGFuY2Vfa2V5PlxuLyoqIEFzc2VtYmxlcyB0aGUga2V5IGZvciBhIGNsaWVudCBzdGF0ZSBpbiBXZWJTdG9yYWdlICovXG5mdW5jdGlvbiB4cih0LCBlKSB7XG4gICAgcmV0dXJuIGBmaXJlc3RvcmVfY2xpZW50c18ke3R9XyR7ZX1gO1xufVxuXG4vLyBUaGUgZm9ybWF0IG9mIHRoZSBXZWJTdG9yYWdlIGtleSB0aGF0IHN0b3JlcyB0aGUgbXV0YXRpb24gc3RhdGUgaXM6XG4vLyAgICAgZmlyZXN0b3JlX211dGF0aW9uc188cGVyc2lzdGVuY2VfcHJlZml4Pl88YmF0Y2hfaWQ+XG4vLyAgICAgKGZvciB1bmF1dGhlbnRpY2F0ZWQgdXNlcnMpXG4vLyBvcjogZmlyZXN0b3JlX211dGF0aW9uc188cGVyc2lzdGVuY2VfcHJlZml4Pl88YmF0Y2hfaWQ+Xzx1c2VyX3VpZD5cblxuLy8gJ3VzZXJfdWlkJyBpcyBsYXN0IHRvIGF2b2lkIG5lZWRpbmcgdG8gZXNjYXBlICdfJyBjaGFyYWN0ZXJzIHRoYXQgaXQgbWlnaHRcbi8vIGNvbnRhaW4uXG4vKiogQXNzZW1ibGVzIHRoZSBrZXkgZm9yIGEgbXV0YXRpb24gYmF0Y2ggaW4gV2ViU3RvcmFnZSAqL1xuZnVuY3Rpb24ga3IodCwgZSwgbikge1xuICAgIGxldCBzID0gYGZpcmVzdG9yZV9tdXRhdGlvbnNfJHt0fV8ke259YDtcbiAgICByZXR1cm4gZS5pc0F1dGhlbnRpY2F0ZWQoKSAmJiAocyArPSBgXyR7ZS51aWR9YCksIHM7XG59XG5cbi8vIFRoZSBmb3JtYXQgb2YgdGhlIFdlYlN0b3JhZ2Uga2V5IHRoYXQgc3RvcmVzIGEgcXVlcnkgdGFyZ2V0J3MgbWV0YWRhdGEgaXM6XG4vLyAgICAgZmlyZXN0b3JlX3RhcmdldHNfPHBlcnNpc3RlbmNlX3ByZWZpeD5fPHRhcmdldF9pZD5cbi8qKiBBc3NlbWJsZXMgdGhlIGtleSBmb3IgYSBxdWVyeSBzdGF0ZSBpbiBXZWJTdG9yYWdlICovXG5mdW5jdGlvbiAkcih0LCBlKSB7XG4gICAgcmV0dXJuIGBmaXJlc3RvcmVfdGFyZ2V0c18ke3R9XyR7ZX1gO1xufVxuXG4vLyBUaGUgV2ViU3RvcmFnZSBwcmVmaXggdGhhdCBzdG9yZXMgdGhlIHByaW1hcnkgdGFiJ3Mgb25saW5lIHN0YXRlLiBUaGVcbi8vIGZvcm1hdCBvZiB0aGUga2V5IGlzOlxuLy8gICAgIGZpcmVzdG9yZV9vbmxpbmVfc3RhdGVfPHBlcnNpc3RlbmNlX3ByZWZpeD5cbi8qKlxuICogSG9sZHMgdGhlIHN0YXRlIG9mIGEgbXV0YXRpb24gYmF0Y2gsIGluY2x1ZGluZyBpdHMgdXNlciBJRCwgYmF0Y2ggSUQgYW5kXG4gKiB3aGV0aGVyIHRoZSBiYXRjaCBpcyAncGVuZGluZycsICdhY2tub3dsZWRnZWQnIG9yICdyZWplY3RlZCcuXG4gKi9cbi8vIFZpc2libGUgZm9yIHRlc3RpbmdcbmNsYXNzIE9yIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzKSB7XG4gICAgICAgIHRoaXMudXNlciA9IHQsIHRoaXMuYmF0Y2hJZCA9IGUsIHRoaXMuc3RhdGUgPSBuLCB0aGlzLmVycm9yID0gcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogUGFyc2VzIGEgTXV0YXRpb25NZXRhZGF0YSBmcm9tIGl0cyBKU09OIHJlcHJlc2VudGF0aW9uIGluIFdlYlN0b3JhZ2UuXG4gICAgICogTG9ncyBhIHdhcm5pbmcgYW5kIHJldHVybnMgbnVsbCBpZiB0aGUgZm9ybWF0IG9mIHRoZSBkYXRhIGlzIG5vdCB2YWxpZC5cbiAgICAgKi8gICAgc3RhdGljICRzKHQsIGUsIG4pIHtcbiAgICAgICAgY29uc3QgcyA9IEpTT04ucGFyc2Uobik7XG4gICAgICAgIGxldCBpLCByID0gXCJvYmplY3RcIiA9PSB0eXBlb2YgcyAmJiAtMSAhPT0gWyBcInBlbmRpbmdcIiwgXCJhY2tub3dsZWRnZWRcIiwgXCJyZWplY3RlZFwiIF0uaW5kZXhPZihzLnN0YXRlKSAmJiAodm9pZCAwID09PSBzLmVycm9yIHx8IFwib2JqZWN0XCIgPT0gdHlwZW9mIHMuZXJyb3IpO1xuICAgICAgICByZXR1cm4gciAmJiBzLmVycm9yICYmIChyID0gXCJzdHJpbmdcIiA9PSB0eXBlb2Ygcy5lcnJvci5tZXNzYWdlICYmIFwic3RyaW5nXCIgPT0gdHlwZW9mIHMuZXJyb3IuY29kZSwgXG4gICAgICAgIHIgJiYgKGkgPSBuZXcgSyhzLmVycm9yLmNvZGUsIHMuZXJyb3IubWVzc2FnZSkpKSwgciA/IG5ldyBPcih0LCBlLCBzLnN0YXRlLCBpKSA6ICgkKFwiU2hhcmVkQ2xpZW50U3RhdGVcIiwgYEZhaWxlZCB0byBwYXJzZSBtdXRhdGlvbiBzdGF0ZSBmb3IgSUQgJyR7ZX0nOiAke259YCksIFxuICAgICAgICBudWxsKTtcbiAgICB9XG4gICAgT3MoKSB7XG4gICAgICAgIGNvbnN0IHQgPSB7XG4gICAgICAgICAgICBzdGF0ZTogdGhpcy5zdGF0ZSxcbiAgICAgICAgICAgIHVwZGF0ZVRpbWVNczogRGF0ZS5ub3coKVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gdGhpcy5lcnJvciAmJiAodC5lcnJvciA9IHtcbiAgICAgICAgICAgIGNvZGU6IHRoaXMuZXJyb3IuY29kZSxcbiAgICAgICAgICAgIG1lc3NhZ2U6IHRoaXMuZXJyb3IubWVzc2FnZVxuICAgICAgICB9KSwgSlNPTi5zdHJpbmdpZnkodCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEhvbGRzIHRoZSBzdGF0ZSBvZiBhIHF1ZXJ5IHRhcmdldCwgaW5jbHVkaW5nIGl0cyB0YXJnZXQgSUQgYW5kIHdoZXRoZXIgdGhlXG4gKiB0YXJnZXQgaXMgJ25vdC1jdXJyZW50JywgJ2N1cnJlbnQnIG9yICdyZWplY3RlZCcuXG4gKi9cbi8vIFZpc2libGUgZm9yIHRlc3RpbmdcbmNsYXNzIEZyIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHRoaXMudGFyZ2V0SWQgPSB0LCB0aGlzLnN0YXRlID0gZSwgdGhpcy5lcnJvciA9IG47XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBhcnNlcyBhIFF1ZXJ5VGFyZ2V0TWV0YWRhdGEgZnJvbSBpdHMgSlNPTiByZXByZXNlbnRhdGlvbiBpbiBXZWJTdG9yYWdlLlxuICAgICAqIExvZ3MgYSB3YXJuaW5nIGFuZCByZXR1cm5zIG51bGwgaWYgdGhlIGZvcm1hdCBvZiB0aGUgZGF0YSBpcyBub3QgdmFsaWQuXG4gICAgICovICAgIHN0YXRpYyAkcyh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBKU09OLnBhcnNlKGUpO1xuICAgICAgICBsZXQgcywgaSA9IFwib2JqZWN0XCIgPT0gdHlwZW9mIG4gJiYgLTEgIT09IFsgXCJub3QtY3VycmVudFwiLCBcImN1cnJlbnRcIiwgXCJyZWplY3RlZFwiIF0uaW5kZXhPZihuLnN0YXRlKSAmJiAodm9pZCAwID09PSBuLmVycm9yIHx8IFwib2JqZWN0XCIgPT0gdHlwZW9mIG4uZXJyb3IpO1xuICAgICAgICByZXR1cm4gaSAmJiBuLmVycm9yICYmIChpID0gXCJzdHJpbmdcIiA9PSB0eXBlb2Ygbi5lcnJvci5tZXNzYWdlICYmIFwic3RyaW5nXCIgPT0gdHlwZW9mIG4uZXJyb3IuY29kZSwgXG4gICAgICAgIGkgJiYgKHMgPSBuZXcgSyhuLmVycm9yLmNvZGUsIG4uZXJyb3IubWVzc2FnZSkpKSwgaSA/IG5ldyBGcih0LCBuLnN0YXRlLCBzKSA6ICgkKFwiU2hhcmVkQ2xpZW50U3RhdGVcIiwgYEZhaWxlZCB0byBwYXJzZSB0YXJnZXQgc3RhdGUgZm9yIElEICcke3R9JzogJHtlfWApLCBcbiAgICAgICAgbnVsbCk7XG4gICAgfVxuICAgIE9zKCkge1xuICAgICAgICBjb25zdCB0ID0ge1xuICAgICAgICAgICAgc3RhdGU6IHRoaXMuc3RhdGUsXG4gICAgICAgICAgICB1cGRhdGVUaW1lTXM6IERhdGUubm93KClcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZXJyb3IgJiYgKHQuZXJyb3IgPSB7XG4gICAgICAgICAgICBjb2RlOiB0aGlzLmVycm9yLmNvZGUsXG4gICAgICAgICAgICBtZXNzYWdlOiB0aGlzLmVycm9yLm1lc3NhZ2VcbiAgICAgICAgfSksIEpTT04uc3RyaW5naWZ5KHQpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBUaGlzIGNsYXNzIHJlcHJlc2VudHMgdGhlIGltbXV0YWJsZSBDbGllbnRTdGF0ZSBmb3IgYSBjbGllbnQgcmVhZCBmcm9tXG4gKiBXZWJTdG9yYWdlLCBjb250YWluaW5nIHRoZSBsaXN0IG9mIGFjdGl2ZSBxdWVyeSB0YXJnZXRzLlxuICovIGNsYXNzIE1yIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMuY2xpZW50SWQgPSB0LCB0aGlzLmFjdGl2ZVRhcmdldElkcyA9IGU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBhcnNlcyBhIFJlbW90ZUNsaWVudFN0YXRlIGZyb20gdGhlIEpTT04gcmVwcmVzZW50YXRpb24gaW4gV2ViU3RvcmFnZS5cbiAgICAgKiBMb2dzIGEgd2FybmluZyBhbmQgcmV0dXJucyBudWxsIGlmIHRoZSBmb3JtYXQgb2YgdGhlIGRhdGEgaXMgbm90IHZhbGlkLlxuICAgICAqLyAgICBzdGF0aWMgJHModCwgZSkge1xuICAgICAgICBjb25zdCBuID0gSlNPTi5wYXJzZShlKTtcbiAgICAgICAgbGV0IHMgPSBcIm9iamVjdFwiID09IHR5cGVvZiBuICYmIG4uYWN0aXZlVGFyZ2V0SWRzIGluc3RhbmNlb2YgQXJyYXksIGkgPSB2bigpO1xuICAgICAgICBmb3IgKGxldCB0ID0gMDsgcyAmJiB0IDwgbi5hY3RpdmVUYXJnZXRJZHMubGVuZ3RoOyArK3QpIHMgPSBSdChuLmFjdGl2ZVRhcmdldElkc1t0XSksIFxuICAgICAgICBpID0gaS5hZGQobi5hY3RpdmVUYXJnZXRJZHNbdF0pO1xuICAgICAgICByZXR1cm4gcyA/IG5ldyBNcih0LCBpKSA6ICgkKFwiU2hhcmVkQ2xpZW50U3RhdGVcIiwgYEZhaWxlZCB0byBwYXJzZSBjbGllbnQgZGF0YSBmb3IgaW5zdGFuY2UgJyR7dH0nOiAke2V9YCksIFxuICAgICAgICBudWxsKTtcbiAgICB9XG59XG5cbi8qKlxuICogVGhpcyBjbGFzcyByZXByZXNlbnRzIHRoZSBvbmxpbmUgc3RhdGUgZm9yIGFsbCBjbGllbnRzIHBhcnRpY2lwYXRpbmcgaW5cbiAqIG11bHRpLXRhYi4gVGhlIG9ubGluZSBzdGF0ZSBpcyBvbmx5IHdyaXR0ZW4gdG8gYnkgdGhlIHByaW1hcnkgY2xpZW50LCBhbmRcbiAqIHVzZWQgaW4gc2Vjb25kYXJ5IGNsaWVudHMgdG8gdXBkYXRlIHRoZWlyIHF1ZXJ5IHZpZXdzLlxuICovIGNsYXNzIExyIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMuY2xpZW50SWQgPSB0LCB0aGlzLm9ubGluZVN0YXRlID0gZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUGFyc2VzIGEgU2hhcmVkT25saW5lU3RhdGUgZnJvbSBpdHMgSlNPTiByZXByZXNlbnRhdGlvbiBpbiBXZWJTdG9yYWdlLlxuICAgICAqIExvZ3MgYSB3YXJuaW5nIGFuZCByZXR1cm5zIG51bGwgaWYgdGhlIGZvcm1hdCBvZiB0aGUgZGF0YSBpcyBub3QgdmFsaWQuXG4gICAgICovICAgIHN0YXRpYyAkcyh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBKU09OLnBhcnNlKHQpO1xuICAgICAgICByZXR1cm4gXCJvYmplY3RcIiA9PSB0eXBlb2YgZSAmJiAtMSAhPT0gWyBcIlVua25vd25cIiwgXCJPbmxpbmVcIiwgXCJPZmZsaW5lXCIgXS5pbmRleE9mKGUub25saW5lU3RhdGUpICYmIFwic3RyaW5nXCIgPT0gdHlwZW9mIGUuY2xpZW50SWQgPyBuZXcgTHIoZS5jbGllbnRJZCwgZS5vbmxpbmVTdGF0ZSkgOiAoJChcIlNoYXJlZENsaWVudFN0YXRlXCIsIGBGYWlsZWQgdG8gcGFyc2Ugb25saW5lIHN0YXRlOiAke3R9YCksIFxuICAgICAgICBudWxsKTtcbiAgICB9XG59XG5cbi8qKlxuICogTWV0YWRhdGEgc3RhdGUgb2YgdGhlIGxvY2FsIGNsaWVudC4gVW5saWtlIGBSZW1vdGVDbGllbnRTdGF0ZWAsIHRoaXMgY2xhc3MgaXNcbiAqIG11dGFibGUgYW5kIGtlZXBzIHRyYWNrIG9mIGFsbCBwZW5kaW5nIG11dGF0aW9ucywgd2hpY2ggYWxsb3dzIHVzIHRvXG4gKiB1cGRhdGUgdGhlIHJhbmdlIG9mIHBlbmRpbmcgbXV0YXRpb24gYmF0Y2ggSURzIGFzIG5ldyBtdXRhdGlvbnMgYXJlIGFkZGVkIG9yXG4gKiByZW1vdmVkLlxuICpcbiAqIFRoZSBkYXRhIGluIGBMb2NhbENsaWVudFN0YXRlYCBpcyBub3QgcmVhZCBmcm9tIFdlYlN0b3JhZ2UgYW5kIGluc3RlYWRcbiAqIHVwZGF0ZWQgdmlhIGl0cyBpbnN0YW5jZSBtZXRob2RzLiBUaGUgdXBkYXRlZCBzdGF0ZSBjYW4gYmUgc2VyaWFsaXplZCB2aWFcbiAqIGB0b1dlYlN0b3JhZ2VKU09OKClgLlxuICovXG4vLyBWaXNpYmxlIGZvciB0ZXN0aW5nLlxuY2xhc3MgQnIge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLmFjdGl2ZVRhcmdldElkcyA9IHZuKCk7XG4gICAgfVxuICAgIEZzKHQpIHtcbiAgICAgICAgdGhpcy5hY3RpdmVUYXJnZXRJZHMgPSB0aGlzLmFjdGl2ZVRhcmdldElkcy5hZGQodCk7XG4gICAgfVxuICAgIE1zKHQpIHtcbiAgICAgICAgdGhpcy5hY3RpdmVUYXJnZXRJZHMgPSB0aGlzLmFjdGl2ZVRhcmdldElkcy5kZWxldGUodCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENvbnZlcnRzIHRoaXMgZW50cnkgaW50byBhIEpTT04tZW5jb2RlZCBmb3JtYXQgd2UgY2FuIHVzZSBmb3IgV2ViU3RvcmFnZS5cbiAgICAgKiBEb2VzIG5vdCBlbmNvZGUgYGNsaWVudElkYCBhcyBpdCBpcyBwYXJ0IG9mIHRoZSBrZXkgaW4gV2ViU3RvcmFnZS5cbiAgICAgKi8gICAgT3MoKSB7XG4gICAgICAgIGNvbnN0IHQgPSB7XG4gICAgICAgICAgICBhY3RpdmVUYXJnZXRJZHM6IHRoaXMuYWN0aXZlVGFyZ2V0SWRzLnRvQXJyYXkoKSxcbiAgICAgICAgICAgIHVwZGF0ZVRpbWVNczogRGF0ZS5ub3coKVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodCk7XG4gICAgfVxufVxuXG4vKipcbiAqIGBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGVgIHVzZXMgV2ViU3RvcmFnZSAod2luZG93LmxvY2FsU3RvcmFnZSkgYXMgdGhlXG4gKiBiYWNraW5nIHN0b3JlIGZvciB0aGUgU2hhcmVkQ2xpZW50U3RhdGUuIEl0IGtlZXBzIHRyYWNrIG9mIGFsbCBhY3RpdmVcbiAqIGNsaWVudHMgYW5kIHN1cHBvcnRzIG1vZGlmaWNhdGlvbnMgb2YgdGhlIGxvY2FsIGNsaWVudCdzIGRhdGEuXG4gKi8gY2xhc3MgVXIge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIHMsIGkpIHtcbiAgICAgICAgdGhpcy53aW5kb3cgPSB0LCB0aGlzLk9lID0gZSwgdGhpcy5wZXJzaXN0ZW5jZUtleSA9IG4sIHRoaXMuTHMgPSBzLCB0aGlzLnN5bmNFbmdpbmUgPSBudWxsLCBcbiAgICAgICAgdGhpcy5vbmxpbmVTdGF0ZUhhbmRsZXIgPSBudWxsLCB0aGlzLnNlcXVlbmNlTnVtYmVySGFuZGxlciA9IG51bGwsIHRoaXMuQnMgPSB0aGlzLlVzLmJpbmQodGhpcyksIFxuICAgICAgICB0aGlzLnFzID0gbmV3IGRuKHR0KSwgdGhpcy5zdGFydGVkID0gITEsIFxuICAgICAgICAvKipcbiAgICAgICAgICogQ2FwdHVyZXMgV2ViU3RvcmFnZSBldmVudHMgdGhhdCBvY2N1ciBiZWZvcmUgYHN0YXJ0KClgIGlzIGNhbGxlZC4gVGhlc2VcbiAgICAgICAgICogZXZlbnRzIGFyZSByZXBsYXllZCBvbmNlIGBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGVgIGlzIHN0YXJ0ZWQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLktzID0gW107XG4gICAgICAgIC8vIEVzY2FwZSB0aGUgc3BlY2lhbCBjaGFyYWN0ZXJzIG1lbnRpb25lZCBoZXJlOlxuICAgICAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L0d1aWRlL1JlZ3VsYXJfRXhwcmVzc2lvbnNcbiAgICAgICAgY29uc3QgciA9IG4ucmVwbGFjZSgvWy4qKz9eJHt9KCl8W1xcXVxcXFxdL2csIFwiXFxcXCQmXCIpO1xuICAgICAgICB0aGlzLnN0b3JhZ2UgPSB0aGlzLndpbmRvdy5sb2NhbFN0b3JhZ2UsIHRoaXMuY3VycmVudFVzZXIgPSBpLCB0aGlzLmpzID0geHIodGhpcy5wZXJzaXN0ZW5jZUtleSwgdGhpcy5McyksIFxuICAgICAgICB0aGlzLlFzID0gXG4gICAgICAgIC8qKiBBc3NlbWJsZXMgdGhlIGtleSBmb3IgdGhlIGN1cnJlbnQgc2VxdWVuY2UgbnVtYmVyLiAqL1xuICAgICAgICBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICByZXR1cm4gYGZpcmVzdG9yZV9zZXF1ZW5jZV9udW1iZXJfJHt0fWA7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTggR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gKHRoaXMucGVyc2lzdGVuY2VLZXkpLCB0aGlzLnFzID0gdGhpcy5xcy5pbnNlcnQodGhpcy5McywgbmV3IEJyKSwgdGhpcy5XcyA9IG5ldyBSZWdFeHAoYF5maXJlc3RvcmVfY2xpZW50c18ke3J9XyhbXl9dKikkYCksIFxuICAgICAgICB0aGlzLkdzID0gbmV3IFJlZ0V4cChgXmZpcmVzdG9yZV9tdXRhdGlvbnNfJHtyfV8oXFxcXGQrKSg/Ol8oLiopKT8kYCksIHRoaXMuenMgPSBuZXcgUmVnRXhwKGBeZmlyZXN0b3JlX3RhcmdldHNfJHtyfV8oXFxcXGQrKSRgKSwgXG4gICAgICAgIHRoaXMuSHMgPSBcbiAgICAgICAgLyoqIEFzc2VtYmxlcyB0aGUga2V5IGZvciB0aGUgb25saW5lIHN0YXRlIG9mIHRoZSBwcmltYXJ5IHRhYi4gKi9cbiAgICAgICAgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgcmV0dXJuIGBmaXJlc3RvcmVfb25saW5lX3N0YXRlXyR7dH1gO1xuICAgICAgICB9XG4gICAgICAgIC8vIFRoZSBXZWJTdG9yYWdlIHByZWZpeCB0aGF0IHBsYXlzIGFzIGEgZXZlbnQgdG8gaW5kaWNhdGUgdGhlIHJlbW90ZSBkb2N1bWVudHNcbiAgICAgICAgLy8gbWlnaHQgaGF2ZSBjaGFuZ2VkIGR1ZSB0byBzb21lIHNlY29uZGFyeSB0YWJzIGxvYWRpbmcgYSBidW5kbGUuXG4gICAgICAgIC8vIGZvcm1hdCBvZiB0aGUga2V5IGlzOlxuICAgICAgICAvLyAgICAgZmlyZXN0b3JlX2J1bmRsZV9sb2FkZWRfPHBlcnNpc3RlbmNlS2V5PlxuICAgICAgICAodGhpcy5wZXJzaXN0ZW5jZUtleSksIHRoaXMuSnMgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICByZXR1cm4gYGZpcmVzdG9yZV9idW5kbGVfbG9hZGVkXyR7dH1gO1xuICAgICAgICB9XG4gICAgICAgIC8vIFRoZSBXZWJTdG9yYWdlIGtleSBwcmVmaXggZm9yIHRoZSBrZXkgdGhhdCBzdG9yZXMgdGhlIGxhc3Qgc2VxdWVuY2UgbnVtYmVyIGFsbG9jYXRlZC4gVGhlIGtleVxuICAgICAgICAvLyBsb29rcyBsaWtlICdmaXJlc3RvcmVfc2VxdWVuY2VfbnVtYmVyXzxwZXJzaXN0ZW5jZV9wcmVmaXg+Jy5cbiAgICAgICAgKHRoaXMucGVyc2lzdGVuY2VLZXkpLCBcbiAgICAgICAgLy8gUmF0aGVyIHRoYW4gYWRkaW5nIHRoZSBzdG9yYWdlIG9ic2VydmVyIGR1cmluZyBzdGFydCgpLCB3ZSBhZGQgdGhlXG4gICAgICAgIC8vIHN0b3JhZ2Ugb2JzZXJ2ZXIgZHVyaW5nIGluaXRpYWxpemF0aW9uLiBUaGlzIGVuc3VyZXMgdGhhdCB3ZSBjb2xsZWN0XG4gICAgICAgIC8vIGV2ZW50cyBiZWZvcmUgb3RoZXIgY29tcG9uZW50cyBwb3B1bGF0ZSB0aGVpciBpbml0aWFsIHN0YXRlIChkdXJpbmcgdGhlaXJcbiAgICAgICAgLy8gcmVzcGVjdGl2ZSBzdGFydCgpIGNhbGxzKS4gT3RoZXJ3aXNlLCB3ZSBtaWdodCBmb3IgZXhhbXBsZSBtaXNzIGFcbiAgICAgICAgLy8gbXV0YXRpb24gdGhhdCBpcyBhZGRlZCBhZnRlciBMb2NhbFN0b3JlJ3Mgc3RhcnQoKSBwcm9jZXNzZWQgdGhlIGV4aXN0aW5nXG4gICAgICAgIC8vIG11dGF0aW9ucyBidXQgYmVmb3JlIHdlIG9ic2VydmUgV2ViU3RvcmFnZSBldmVudHMuXG4gICAgICAgIHRoaXMud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJzdG9yYWdlXCIsIHRoaXMuQnMpO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyAndHJ1ZScgaWYgV2ViU3RvcmFnZSBpcyBhdmFpbGFibGUgaW4gdGhlIGN1cnJlbnQgZW52aXJvbm1lbnQuICovICAgIHN0YXRpYyBQdCh0KSB7XG4gICAgICAgIHJldHVybiAhKCF0IHx8ICF0LmxvY2FsU3RvcmFnZSk7XG4gICAgfVxuICAgIGFzeW5jIHN0YXJ0KCkge1xuICAgICAgICAvLyBSZXRyaWV2ZSB0aGUgbGlzdCBvZiBleGlzdGluZyBjbGllbnRzIHRvIGJhY2tmaWxsIHRoZSBkYXRhIGluXG4gICAgICAgIC8vIFNoYXJlZENsaWVudFN0YXRlLlxuICAgICAgICBjb25zdCB0ID0gYXdhaXQgdGhpcy5zeW5jRW5naW5lLnBuKCk7XG4gICAgICAgIGZvciAoY29uc3QgZSBvZiB0KSB7XG4gICAgICAgICAgICBpZiAoZSA9PT0gdGhpcy5McykgY29udGludWU7XG4gICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5nZXRJdGVtKHhyKHRoaXMucGVyc2lzdGVuY2VLZXksIGUpKTtcbiAgICAgICAgICAgIGlmICh0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IE1yLiRzKGUsIHQpO1xuICAgICAgICAgICAgICAgIG4gJiYgKHRoaXMucXMgPSB0aGlzLnFzLmluc2VydChuLmNsaWVudElkLCBuKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5ZcygpO1xuICAgICAgICAvLyBDaGVjayBpZiB0aGVyZSBpcyBhbiBleGlzdGluZyBvbmxpbmUgc3RhdGUgYW5kIGNhbGwgdGhlIGNhbGxiYWNrIGhhbmRsZXJcbiAgICAgICAgLy8gaWYgYXBwbGljYWJsZS5cbiAgICAgICAgY29uc3QgZSA9IHRoaXMuc3RvcmFnZS5nZXRJdGVtKHRoaXMuSHMpO1xuICAgICAgICBpZiAoZSkge1xuICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuWHMoZSk7XG4gICAgICAgICAgICB0ICYmIHRoaXMuWnModCk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChjb25zdCB0IG9mIHRoaXMuS3MpIHRoaXMuVXModCk7XG4gICAgICAgIHRoaXMuS3MgPSBbXSwgXG4gICAgICAgIC8vIFJlZ2lzdGVyIGEgd2luZG93IHVubG9hZCBob29rIHRvIHJlbW92ZSB0aGUgY2xpZW50IG1ldGFkYXRhIGVudHJ5IGZyb21cbiAgICAgICAgLy8gV2ViU3RvcmFnZSBldmVuIGlmIGBzaHV0ZG93bigpYCB3YXMgbm90IGNhbGxlZC5cbiAgICAgICAgdGhpcy53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInBhZ2VoaWRlXCIsICgoKSA9PiB0aGlzLnNodXRkb3duKCkpKSwgdGhpcy5zdGFydGVkID0gITA7XG4gICAgfVxuICAgIHdyaXRlU2VxdWVuY2VOdW1iZXIodCkge1xuICAgICAgICB0aGlzLnNldEl0ZW0odGhpcy5RcywgSlNPTi5zdHJpbmdpZnkodCkpO1xuICAgIH1cbiAgICBnZXRBbGxBY3RpdmVRdWVyeVRhcmdldHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRpKHRoaXMucXMpO1xuICAgIH1cbiAgICBpc0FjdGl2ZVF1ZXJ5VGFyZ2V0KHQpIHtcbiAgICAgICAgbGV0IGUgPSAhMTtcbiAgICAgICAgcmV0dXJuIHRoaXMucXMuZm9yRWFjaCgoKG4sIHMpID0+IHtcbiAgICAgICAgICAgIHMuYWN0aXZlVGFyZ2V0SWRzLmhhcyh0KSAmJiAoZSA9ICEwKTtcbiAgICAgICAgfSkpLCBlO1xuICAgIH1cbiAgICBhZGRQZW5kaW5nTXV0YXRpb24odCkge1xuICAgICAgICB0aGlzLmVpKHQsIFwicGVuZGluZ1wiKTtcbiAgICB9XG4gICAgdXBkYXRlTXV0YXRpb25TdGF0ZSh0LCBlLCBuKSB7XG4gICAgICAgIHRoaXMuZWkodCwgZSwgbiksIFxuICAgICAgICAvLyBPbmNlIGEgZmluYWwgbXV0YXRpb24gcmVzdWx0IGlzIG9ic2VydmVkIGJ5IG90aGVyIGNsaWVudHMsIHRoZXkgbm8gbG9uZ2VyXG4gICAgICAgIC8vIGFjY2VzcyB0aGUgbXV0YXRpb24ncyBtZXRhZGF0YSBlbnRyeS4gU2luY2UgV2ViU3RvcmFnZSByZXBsYXlzIGV2ZW50c1xuICAgICAgICAvLyBpbiBvcmRlciwgaXQgaXMgc2FmZSB0byBkZWxldGUgdGhlIGVudHJ5IHJpZ2h0IGFmdGVyIHVwZGF0aW5nIGl0LlxuICAgICAgICB0aGlzLm5pKHQpO1xuICAgIH1cbiAgICBhZGRMb2NhbFF1ZXJ5VGFyZ2V0KHQpIHtcbiAgICAgICAgbGV0IGUgPSBcIm5vdC1jdXJyZW50XCI7XG4gICAgICAgIC8vIExvb2t1cCBhbiBleGlzdGluZyBxdWVyeSBzdGF0ZSBpZiB0aGUgdGFyZ2V0IElEIHdhcyBhbHJlYWR5IHJlZ2lzdGVyZWRcbiAgICAgICAgLy8gYnkgYW5vdGhlciB0YWJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc0FjdGl2ZVF1ZXJ5VGFyZ2V0KHQpKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gdGhpcy5zdG9yYWdlLmdldEl0ZW0oJHIodGhpcy5wZXJzaXN0ZW5jZUtleSwgdCkpO1xuICAgICAgICAgICAgaWYgKG4pIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gRnIuJHModCwgbik7XG4gICAgICAgICAgICAgICAgcyAmJiAoZSA9IHMuc3RhdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnNpLkZzKHQpLCB0aGlzLllzKCksIGU7XG4gICAgfVxuICAgIHJlbW92ZUxvY2FsUXVlcnlUYXJnZXQodCkge1xuICAgICAgICB0aGlzLnNpLk1zKHQpLCB0aGlzLllzKCk7XG4gICAgfVxuICAgIGlzTG9jYWxRdWVyeVRhcmdldCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNpLmFjdGl2ZVRhcmdldElkcy5oYXModCk7XG4gICAgfVxuICAgIGNsZWFyUXVlcnlTdGF0ZSh0KSB7XG4gICAgICAgIHRoaXMucmVtb3ZlSXRlbSgkcih0aGlzLnBlcnNpc3RlbmNlS2V5LCB0KSk7XG4gICAgfVxuICAgIHVwZGF0ZVF1ZXJ5U3RhdGUodCwgZSwgbikge1xuICAgICAgICB0aGlzLmlpKHQsIGUsIG4pO1xuICAgIH1cbiAgICBoYW5kbGVVc2VyQ2hhbmdlKHQsIGUsIG4pIHtcbiAgICAgICAgZS5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgIHRoaXMubmkodCk7XG4gICAgICAgIH0pKSwgdGhpcy5jdXJyZW50VXNlciA9IHQsIG4uZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICB0aGlzLmFkZFBlbmRpbmdNdXRhdGlvbih0KTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBzZXRPbmxpbmVTdGF0ZSh0KSB7XG4gICAgICAgIHRoaXMucmkodCk7XG4gICAgfVxuICAgIG5vdGlmeUJ1bmRsZUxvYWRlZCgpIHtcbiAgICAgICAgdGhpcy5vaSgpO1xuICAgIH1cbiAgICBzaHV0ZG93bigpIHtcbiAgICAgICAgdGhpcy5zdGFydGVkICYmICh0aGlzLndpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwic3RvcmFnZVwiLCB0aGlzLkJzKSwgdGhpcy5yZW1vdmVJdGVtKHRoaXMuanMpLCBcbiAgICAgICAgdGhpcy5zdGFydGVkID0gITEpO1xuICAgIH1cbiAgICBnZXRJdGVtKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuc3RvcmFnZS5nZXRJdGVtKHQpO1xuICAgICAgICByZXR1cm4gayhcIlNoYXJlZENsaWVudFN0YXRlXCIsIFwiUkVBRFwiLCB0LCBlKSwgZTtcbiAgICB9XG4gICAgc2V0SXRlbSh0LCBlKSB7XG4gICAgICAgIGsoXCJTaGFyZWRDbGllbnRTdGF0ZVwiLCBcIlNFVFwiLCB0LCBlKSwgdGhpcy5zdG9yYWdlLnNldEl0ZW0odCwgZSk7XG4gICAgfVxuICAgIHJlbW92ZUl0ZW0odCkge1xuICAgICAgICBrKFwiU2hhcmVkQ2xpZW50U3RhdGVcIiwgXCJSRU1PVkVcIiwgdCksIHRoaXMuc3RvcmFnZS5yZW1vdmVJdGVtKHQpO1xuICAgIH1cbiAgICBVcyh0KSB7XG4gICAgICAgIC8vIE5vdGU6IFRoZSBmdW5jdGlvbiBpcyB0eXBlZCB0byB0YWtlIEV2ZW50IHRvIGJlIGludGVyZmFjZS1jb21wYXRpYmxlIHdpdGhcbiAgICAgICAgLy8gYFdpbmRvdy5hZGRFdmVudExpc3RlbmVyYC5cbiAgICAgICAgY29uc3QgZSA9IHQ7XG4gICAgICAgIGlmIChlLnN0b3JhZ2VBcmVhID09PSB0aGlzLnN0b3JhZ2UpIHtcbiAgICAgICAgICAgIGlmIChrKFwiU2hhcmVkQ2xpZW50U3RhdGVcIiwgXCJFVkVOVFwiLCBlLmtleSwgZS5uZXdWYWx1ZSksIGUua2V5ID09PSB0aGlzLmpzKSByZXR1cm4gdm9pZCAkKFwiUmVjZWl2ZWQgV2ViU3RvcmFnZSBub3RpZmljYXRpb24gZm9yIGxvY2FsIGNoYW5nZS4gQW5vdGhlciBjbGllbnQgbWlnaHQgaGF2ZSBnYXJiYWdlLWNvbGxlY3RlZCBvdXIgc3RhdGVcIik7XG4gICAgICAgICAgICB0aGlzLk9lLmVucXVldWVSZXRyeWFibGUoKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zdGFydGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChudWxsICE9PSBlLmtleSkgaWYgKHRoaXMuV3MudGVzdChlLmtleSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChudWxsID09IGUubmV3VmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5haShlLmtleSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2kodCwgbnVsbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMudWkoZS5rZXksIGUubmV3VmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0KSByZXR1cm4gdGhpcy5jaSh0LmNsaWVudElkLCB0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLkdzLnRlc3QoZS5rZXkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobnVsbCAhPT0gZS5uZXdWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmhpKGUua2V5LCBlLm5ld1ZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodCkgcmV0dXJuIHRoaXMubGkodCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy56cy50ZXN0KGUua2V5KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG51bGwgIT09IGUubmV3VmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5maShlLmtleSwgZS5uZXdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQpIHJldHVybiB0aGlzLmRpKHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGUua2V5ID09PSB0aGlzLkhzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobnVsbCAhPT0gZS5uZXdWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLlhzKGUubmV3VmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0KSByZXR1cm4gdGhpcy5acyh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlLmtleSA9PT0gdGhpcy5Rcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZSA9IFkuVDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobnVsbCAhPSB0KSB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gSlNPTi5wYXJzZSh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTChcIm51bWJlclwiID09IHR5cGVvZiBuKSwgZSA9IG47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKFwiU2hhcmVkQ2xpZW50U3RhdGVcIiwgXCJGYWlsZWQgdG8gcmVhZCBzZXF1ZW5jZSBudW1iZXIgZnJvbSBXZWJTdG9yYWdlXCIsIHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8qKlxuICogYE1lbW9yeVNoYXJlZENsaWVudFN0YXRlYCBpcyBhIHNpbXBsZSBpbXBsZW1lbnRhdGlvbiBvZiBTaGFyZWRDbGllbnRTdGF0ZSBmb3JcbiAqIGNsaWVudHMgdXNpbmcgbWVtb3J5IHBlcnNpc3RlbmNlLiBUaGUgc3RhdGUgaW4gdGhpcyBjbGFzcyByZW1haW5zIGZ1bGx5XG4gKiBpc29sYXRlZCBhbmQgbm8gc3luY2hyb25pemF0aW9uIGlzIHBlcmZvcm1lZC5cbiAqLyAoZS5uZXdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ICE9PSBZLlQgJiYgdGhpcy5zZXF1ZW5jZU51bWJlckhhbmRsZXIodCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZS5rZXkgPT09IHRoaXMuSnMpIHJldHVybiB0aGlzLnN5bmNFbmdpbmUud2koKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgdGhpcy5Lcy5wdXNoKGUpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldCBzaSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucXMuZ2V0KHRoaXMuTHMpO1xuICAgIH1cbiAgICBZcygpIHtcbiAgICAgICAgdGhpcy5zZXRJdGVtKHRoaXMuanMsIHRoaXMuc2kuT3MoKSk7XG4gICAgfVxuICAgIGVpKHQsIGUsIG4pIHtcbiAgICAgICAgY29uc3QgcyA9IG5ldyBPcih0aGlzLmN1cnJlbnRVc2VyLCB0LCBlLCBuKSwgaSA9IGtyKHRoaXMucGVyc2lzdGVuY2VLZXksIHRoaXMuY3VycmVudFVzZXIsIHQpO1xuICAgICAgICB0aGlzLnNldEl0ZW0oaSwgcy5PcygpKTtcbiAgICB9XG4gICAgbmkodCkge1xuICAgICAgICBjb25zdCBlID0ga3IodGhpcy5wZXJzaXN0ZW5jZUtleSwgdGhpcy5jdXJyZW50VXNlciwgdCk7XG4gICAgICAgIHRoaXMucmVtb3ZlSXRlbShlKTtcbiAgICB9XG4gICAgcmkodCkge1xuICAgICAgICBjb25zdCBlID0ge1xuICAgICAgICAgICAgY2xpZW50SWQ6IHRoaXMuTHMsXG4gICAgICAgICAgICBvbmxpbmVTdGF0ZTogdFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLnN0b3JhZ2Uuc2V0SXRlbSh0aGlzLkhzLCBKU09OLnN0cmluZ2lmeShlKSk7XG4gICAgfVxuICAgIGlpKHQsIGUsIG4pIHtcbiAgICAgICAgY29uc3QgcyA9ICRyKHRoaXMucGVyc2lzdGVuY2VLZXksIHQpLCBpID0gbmV3IEZyKHQsIGUsIG4pO1xuICAgICAgICB0aGlzLnNldEl0ZW0ocywgaS5PcygpKTtcbiAgICB9XG4gICAgb2koKSB7XG4gICAgICAgIHRoaXMuc2V0SXRlbSh0aGlzLkpzLCBcInZhbHVlLW5vdC11c2VkXCIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQYXJzZXMgYSBjbGllbnQgc3RhdGUga2V5IGluIFdlYlN0b3JhZ2UuIFJldHVybnMgbnVsbCBpZiB0aGUga2V5IGRvZXMgbm90XG4gICAgICogbWF0Y2ggdGhlIGV4cGVjdGVkIGtleSBmb3JtYXQuXG4gICAgICovICAgIGFpKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuV3MuZXhlYyh0KTtcbiAgICAgICAgcmV0dXJuIGUgPyBlWzFdIDogbnVsbDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUGFyc2VzIGEgY2xpZW50IHN0YXRlIGluIFdlYlN0b3JhZ2UuIFJldHVybnMgJ251bGwnIGlmIHRoZSB2YWx1ZSBjb3VsZCBub3RcbiAgICAgKiBiZSBwYXJzZWQuXG4gICAgICovICAgIHVpKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMuYWkodCk7XG4gICAgICAgIHJldHVybiBNci4kcyhuLCBlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUGFyc2VzIGEgbXV0YXRpb24gYmF0Y2ggc3RhdGUgaW4gV2ViU3RvcmFnZS4gUmV0dXJucyAnbnVsbCcgaWYgdGhlIHZhbHVlXG4gICAgICogY291bGQgbm90IGJlIHBhcnNlZC5cbiAgICAgKi8gICAgaGkodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gdGhpcy5Hcy5leGVjKHQpLCBzID0gTnVtYmVyKG5bMV0pLCBpID0gdm9pZCAwICE9PSBuWzJdID8gblsyXSA6IG51bGw7XG4gICAgICAgIHJldHVybiBPci4kcyhuZXcgUyhpKSwgcywgZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBhcnNlcyBhIHF1ZXJ5IHRhcmdldCBzdGF0ZSBmcm9tIFdlYlN0b3JhZ2UuIFJldHVybnMgJ251bGwnIGlmIHRoZSB2YWx1ZVxuICAgICAqIGNvdWxkIG5vdCBiZSBwYXJzZWQuXG4gICAgICovICAgIGZpKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMuenMuZXhlYyh0KSwgcyA9IE51bWJlcihuWzFdKTtcbiAgICAgICAgcmV0dXJuIEZyLiRzKHMsIGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQYXJzZXMgYW4gb25saW5lIHN0YXRlIGZyb20gV2ViU3RvcmFnZS4gUmV0dXJucyAnbnVsbCcgaWYgdGhlIHZhbHVlXG4gICAgICogY291bGQgbm90IGJlIHBhcnNlZC5cbiAgICAgKi8gICAgWHModCkge1xuICAgICAgICByZXR1cm4gTHIuJHModCk7XG4gICAgfVxuICAgIGFzeW5jIGxpKHQpIHtcbiAgICAgICAgaWYgKHQudXNlci51aWQgPT09IHRoaXMuY3VycmVudFVzZXIudWlkKSByZXR1cm4gdGhpcy5zeW5jRW5naW5lLl9pKHQuYmF0Y2hJZCwgdC5zdGF0ZSwgdC5lcnJvcik7XG4gICAgICAgIGsoXCJTaGFyZWRDbGllbnRTdGF0ZVwiLCBgSWdub3JpbmcgbXV0YXRpb24gZm9yIG5vbi1hY3RpdmUgdXNlciAke3QudXNlci51aWR9YCk7XG4gICAgfVxuICAgIGRpKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3luY0VuZ2luZS5taSh0LnRhcmdldElkLCB0LnN0YXRlLCB0LmVycm9yKTtcbiAgICB9XG4gICAgY2kodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gZSA/IHRoaXMucXMuaW5zZXJ0KHQsIGUpIDogdGhpcy5xcy5yZW1vdmUodCksIHMgPSB0aGlzLnRpKHRoaXMucXMpLCBpID0gdGhpcy50aShuKSwgciA9IFtdLCBvID0gW107XG4gICAgICAgIHJldHVybiBpLmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgcy5oYXModCkgfHwgci5wdXNoKHQpO1xuICAgICAgICB9KSksIHMuZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICBpLmhhcyh0KSB8fCBvLnB1c2godCk7XG4gICAgICAgIH0pKSwgdGhpcy5zeW5jRW5naW5lLmdpKHIsIG8pLnRoZW4oKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMucXMgPSBuO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIFpzKHQpIHtcbiAgICAgICAgLy8gV2UgY2hlY2sgd2hldGhlciB0aGUgY2xpZW50IHRoYXQgd3JvdGUgdGhpcyBvbmxpbmUgc3RhdGUgaXMgc3RpbGwgYWN0aXZlXG4gICAgICAgIC8vIGJ5IGNvbXBhcmluZyBpdHMgY2xpZW50IElEIHRvIHRoZSBsaXN0IG9mIGNsaWVudHMga2VwdCBhY3RpdmUgaW5cbiAgICAgICAgLy8gSW5kZXhlZERiLiBJZiBhIGNsaWVudCBkb2VzIG5vdCB1cGRhdGUgdGhlaXIgSW5kZXhlZERiIGNsaWVudCBzdGF0ZVxuICAgICAgICAvLyB3aXRoaW4gNSBzZWNvbmRzLCBpdCBpcyBjb25zaWRlcmVkIGluYWN0aXZlIGFuZCB3ZSBkb24ndCBlbWl0IGFuIG9ubGluZVxuICAgICAgICAvLyBzdGF0ZSBldmVudC5cbiAgICAgICAgdGhpcy5xcy5nZXQodC5jbGllbnRJZCkgJiYgdGhpcy5vbmxpbmVTdGF0ZUhhbmRsZXIodC5vbmxpbmVTdGF0ZSk7XG4gICAgfVxuICAgIHRpKHQpIHtcbiAgICAgICAgbGV0IGUgPSB2bigpO1xuICAgICAgICByZXR1cm4gdC5mb3JFYWNoKCgodCwgbikgPT4ge1xuICAgICAgICAgICAgZSA9IGUudW5pb25XaXRoKG4uYWN0aXZlVGFyZ2V0SWRzKTtcbiAgICAgICAgfSkpLCBlO1xuICAgIH1cbn1cblxuY2xhc3MgcXIge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnlpID0gbmV3IEJyLCB0aGlzLnBpID0ge30sIHRoaXMub25saW5lU3RhdGVIYW5kbGVyID0gbnVsbCwgdGhpcy5zZXF1ZW5jZU51bWJlckhhbmRsZXIgPSBudWxsO1xuICAgIH1cbiAgICBhZGRQZW5kaW5nTXV0YXRpb24odCkge1xuICAgICAgICAvLyBObyBvcC5cbiAgICB9XG4gICAgdXBkYXRlTXV0YXRpb25TdGF0ZSh0LCBlLCBuKSB7XG4gICAgICAgIC8vIE5vIG9wLlxuICAgIH1cbiAgICBhZGRMb2NhbFF1ZXJ5VGFyZ2V0KHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMueWkuRnModCksIHRoaXMucGlbdF0gfHwgXCJub3QtY3VycmVudFwiO1xuICAgIH1cbiAgICB1cGRhdGVRdWVyeVN0YXRlKHQsIGUsIG4pIHtcbiAgICAgICAgdGhpcy5waVt0XSA9IGU7XG4gICAgfVxuICAgIHJlbW92ZUxvY2FsUXVlcnlUYXJnZXQodCkge1xuICAgICAgICB0aGlzLnlpLk1zKHQpO1xuICAgIH1cbiAgICBpc0xvY2FsUXVlcnlUYXJnZXQodCkge1xuICAgICAgICByZXR1cm4gdGhpcy55aS5hY3RpdmVUYXJnZXRJZHMuaGFzKHQpO1xuICAgIH1cbiAgICBjbGVhclF1ZXJ5U3RhdGUodCkge1xuICAgICAgICBkZWxldGUgdGhpcy5waVt0XTtcbiAgICB9XG4gICAgZ2V0QWxsQWN0aXZlUXVlcnlUYXJnZXRzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy55aS5hY3RpdmVUYXJnZXRJZHM7XG4gICAgfVxuICAgIGlzQWN0aXZlUXVlcnlUYXJnZXQodCkge1xuICAgICAgICByZXR1cm4gdGhpcy55aS5hY3RpdmVUYXJnZXRJZHMuaGFzKHQpO1xuICAgIH1cbiAgICBzdGFydCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMueWkgPSBuZXcgQnIsIFByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cbiAgICBoYW5kbGVVc2VyQ2hhbmdlKHQsIGUsIG4pIHtcbiAgICAgICAgLy8gTm8gb3AuXG4gICAgfVxuICAgIHNldE9ubGluZVN0YXRlKHQpIHtcbiAgICAgICAgLy8gTm8gb3AuXG4gICAgfVxuICAgIHNodXRkb3duKCkge31cbiAgICB3cml0ZVNlcXVlbmNlTnVtYmVyKHQpIHt9XG4gICAgbm90aWZ5QnVuZGxlTG9hZGVkKCkge1xuICAgICAgICAvLyBObyBvcC5cbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNsYXNzIEtyIHtcbiAgICBFaSh0KSB7XG4gICAgICAgIC8vIE5vLW9wLlxuICAgIH1cbiAgICBzaHV0ZG93bigpIHtcbiAgICAgICAgLy8gTm8tb3AuXG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLy8gUmVmZXJlbmNlcyB0byBgd2luZG93YCBhcmUgZ3VhcmRlZCBieSBCcm93c2VyQ29ubmVjdGl2aXR5TW9uaXRvci5pc0F2YWlsYWJsZSgpXG4vKiBlc2xpbnQtZGlzYWJsZSBuby1yZXN0cmljdGVkLWdsb2JhbHMgKi9cbi8qKlxuICogQnJvd3NlciBpbXBsZW1lbnRhdGlvbiBvZiBDb25uZWN0aXZpdHlNb25pdG9yLlxuICovXG5jbGFzcyBqciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuVGkgPSAoKSA9PiB0aGlzLklpKCksIHRoaXMuQWkgPSAoKSA9PiB0aGlzLlJpKCksIHRoaXMuUGkgPSBbXSwgdGhpcy5iaSgpO1xuICAgIH1cbiAgICBFaSh0KSB7XG4gICAgICAgIHRoaXMuUGkucHVzaCh0KTtcbiAgICB9XG4gICAgc2h1dGRvd24oKSB7XG4gICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwib25saW5lXCIsIHRoaXMuVGkpLCB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm9mZmxpbmVcIiwgdGhpcy5BaSk7XG4gICAgfVxuICAgIGJpKCkge1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm9ubGluZVwiLCB0aGlzLlRpKSwgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJvZmZsaW5lXCIsIHRoaXMuQWkpO1xuICAgIH1cbiAgICBJaSgpIHtcbiAgICAgICAgayhcIkNvbm5lY3Rpdml0eU1vbml0b3JcIiwgXCJOZXR3b3JrIGNvbm5lY3Rpdml0eSBjaGFuZ2VkOiBBVkFJTEFCTEVcIik7XG4gICAgICAgIGZvciAoY29uc3QgdCBvZiB0aGlzLlBpKSB0KDAgLyogQVZBSUxBQkxFICovKTtcbiAgICB9XG4gICAgUmkoKSB7XG4gICAgICAgIGsoXCJDb25uZWN0aXZpdHlNb25pdG9yXCIsIFwiTmV0d29yayBjb25uZWN0aXZpdHkgY2hhbmdlZDogVU5BVkFJTEFCTEVcIik7XG4gICAgICAgIGZvciAoY29uc3QgdCBvZiB0aGlzLlBpKSB0KDEgLyogVU5BVkFJTEFCTEUgKi8pO1xuICAgIH1cbiAgICAvLyBUT0RPKGNoZW5icmlhbik6IENvbnNpZGVyIHBhc3NpbmcgaW4gd2luZG93IGVpdGhlciBpbnRvIHRoaXMgY29tcG9uZW50IG9yXG4gICAgLy8gaGVyZSBmb3IgdGVzdGluZyB2aWEgRmFrZVdpbmRvdy5cbiAgICAvKiogQ2hlY2tzIHRoYXQgYWxsIHVzZWQgYXR0cmlidXRlcyBvZiB3aW5kb3cgYXJlIGF2YWlsYWJsZS4gKi9cbiAgICBzdGF0aWMgUHQoKSB7XG4gICAgICAgIHJldHVybiBcInVuZGVmaW5lZFwiICE9IHR5cGVvZiB3aW5kb3cgJiYgdm9pZCAwICE9PSB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciAmJiB2b2lkIDAgIT09IHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY29uc3QgUXIgPSB7XG4gICAgQmF0Y2hHZXREb2N1bWVudHM6IFwiYmF0Y2hHZXRcIixcbiAgICBDb21taXQ6IFwiY29tbWl0XCIsXG4gICAgUnVuUXVlcnk6IFwicnVuUXVlcnlcIlxufTtcblxuLyoqXG4gKiBNYXBzIFJQQyBuYW1lcyB0byB0aGUgY29ycmVzcG9uZGluZyBSRVNUIGVuZHBvaW50IG5hbWUuXG4gKlxuICogV2UgdXNlIGFycmF5IG5vdGF0aW9uIHRvIGF2b2lkIG1hbmdsaW5nLlxuICovXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBQcm92aWRlcyBhIHNpbXBsZSBoZWxwZXIgY2xhc3MgdGhhdCBpbXBsZW1lbnRzIHRoZSBTdHJlYW0gaW50ZXJmYWNlIHRvXG4gKiBicmlkZ2UgdG8gb3RoZXIgaW1wbGVtZW50YXRpb25zIHRoYXQgYXJlIHN0cmVhbXMgYnV0IGRvIG5vdCBpbXBsZW1lbnQgdGhlXG4gKiBpbnRlcmZhY2UuIFRoZSBzdHJlYW0gY2FsbGJhY2tzIGFyZSBpbnZva2VkIHdpdGggdGhlIGNhbGxPbi4uLiBtZXRob2RzLlxuICovXG5jbGFzcyBXciB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLnZpID0gdC52aSwgdGhpcy5WaSA9IHQuVmk7XG4gICAgfVxuICAgIFNpKHQpIHtcbiAgICAgICAgdGhpcy5EaSA9IHQ7XG4gICAgfVxuICAgIENpKHQpIHtcbiAgICAgICAgdGhpcy5OaSA9IHQ7XG4gICAgfVxuICAgIG9uTWVzc2FnZSh0KSB7XG4gICAgICAgIHRoaXMueGkgPSB0O1xuICAgIH1cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgdGhpcy5WaSgpO1xuICAgIH1cbiAgICBzZW5kKHQpIHtcbiAgICAgICAgdGhpcy52aSh0KTtcbiAgICB9XG4gICAga2koKSB7XG4gICAgICAgIHRoaXMuRGkoKTtcbiAgICB9XG4gICAgJGkodCkge1xuICAgICAgICB0aGlzLk5pKHQpO1xuICAgIH1cbiAgICBPaSh0KSB7XG4gICAgICAgIHRoaXMueGkodCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjbGFzcyBHciBleHRlbmRzIFxuLyoqXG4gKiBCYXNlIGNsYXNzIGZvciBhbGwgUmVzdC1iYXNlZCBjb25uZWN0aW9ucyB0byB0aGUgYmFja2VuZCAoV2ViQ2hhbm5lbCBhbmRcbiAqIEhUVFApLlxuICovXG5jbGFzcyB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLmRhdGFiYXNlSW5mbyA9IHQsIHRoaXMuZGF0YWJhc2VJZCA9IHQuZGF0YWJhc2VJZDtcbiAgICAgICAgY29uc3QgZSA9IHQuc3NsID8gXCJodHRwc1wiIDogXCJodHRwXCI7XG4gICAgICAgIHRoaXMuRmkgPSBlICsgXCI6Ly9cIiArIHQuaG9zdCwgdGhpcy5NaSA9IFwicHJvamVjdHMvXCIgKyB0aGlzLmRhdGFiYXNlSWQucHJvamVjdElkICsgXCIvZGF0YWJhc2VzL1wiICsgdGhpcy5kYXRhYmFzZUlkLmRhdGFiYXNlICsgXCIvZG9jdW1lbnRzXCI7XG4gICAgfVxuICAgIExpKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgY29uc3QgaSA9IHRoaXMuQmkodCwgZSk7XG4gICAgICAgIGsoXCJSZXN0Q29ubmVjdGlvblwiLCBcIlNlbmRpbmc6IFwiLCBpLCBuKTtcbiAgICAgICAgY29uc3QgciA9IHt9O1xuICAgICAgICByZXR1cm4gdGhpcy5VaShyLCBzKSwgdGhpcy5xaSh0LCBpLCByLCBuKS50aGVuKCh0ID0+IChrKFwiUmVzdENvbm5lY3Rpb25cIiwgXCJSZWNlaXZlZDogXCIsIHQpLCBcbiAgICAgICAgdCkpLCAoZSA9PiB7XG4gICAgICAgICAgICB0aHJvdyBPKFwiUmVzdENvbm5lY3Rpb25cIiwgYCR7dH0gZmFpbGVkIHdpdGggZXJyb3I6IGAsIGUsIFwidXJsOiBcIiwgaSwgXCJyZXF1ZXN0OlwiLCBuKSwgXG4gICAgICAgICAgICBlO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIEtpKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgLy8gVGhlIFJFU1QgQVBJIGF1dG9tYXRpY2FsbHkgYWdncmVnYXRlcyBhbGwgb2YgdGhlIHN0cmVhbWVkIHJlc3VsdHMsIHNvIHdlXG4gICAgICAgIC8vIGNhbiBqdXN0IHVzZSB0aGUgbm9ybWFsIGludm9rZSgpIG1ldGhvZC5cbiAgICAgICAgcmV0dXJuIHRoaXMuTGkodCwgZSwgbiwgcyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE1vZGlmaWVzIHRoZSBoZWFkZXJzIGZvciBhIHJlcXVlc3QsIGFkZGluZyBhbnkgYXV0aG9yaXphdGlvbiB0b2tlbiBpZlxuICAgICAqIHByZXNlbnQgYW5kIGFueSBhZGRpdGlvbmFsIGhlYWRlcnMgZm9yIHRoZSByZXF1ZXN0LlxuICAgICAqLyAgICBVaSh0LCBlKSB7XG4gICAgICAgIGlmICh0W1wiWC1Hb29nLUFwaS1DbGllbnRcIl0gPSBcImdsLWpzLyBmaXJlL1wiICsgRCwgXG4gICAgICAgIC8vIENvbnRlbnQtVHlwZTogdGV4dC9wbGFpbiB3aWxsIGF2b2lkIHByZWZsaWdodCByZXF1ZXN0cyB3aGljaCBtaWdodFxuICAgICAgICAvLyBtZXNzIHdpdGggQ09SUyBhbmQgcmVkaXJlY3RzIGJ5IHByb3hpZXMuIElmIHdlIGFkZCBjdXN0b20gaGVhZGVyc1xuICAgICAgICAvLyB3ZSB3aWxsIG5lZWQgdG8gY2hhbmdlIHRoaXMgY29kZSB0byBwb3RlbnRpYWxseSB1c2UgdGhlICRodHRwT3ZlcndyaXRlXG4gICAgICAgIC8vIHBhcmFtZXRlciBzdXBwb3J0ZWQgYnkgRVNGIHRvIGF2b2lkIHRyaWdnZXJpbmcgcHJlZmxpZ2h0IHJlcXVlc3RzLlxuICAgICAgICB0W1wiQ29udGVudC1UeXBlXCJdID0gXCJ0ZXh0L3BsYWluXCIsIHRoaXMuZGF0YWJhc2VJbmZvLmFwcElkICYmICh0W1wiWC1GaXJlYmFzZS1HTVBJRFwiXSA9IHRoaXMuZGF0YWJhc2VJbmZvLmFwcElkKSwgXG4gICAgICAgIGUpIGZvciAoY29uc3QgbiBpbiBlLmF1dGhIZWFkZXJzKSBlLmF1dGhIZWFkZXJzLmhhc093blByb3BlcnR5KG4pICYmICh0W25dID0gZS5hdXRoSGVhZGVyc1tuXSk7XG4gICAgfVxuICAgIEJpKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IFFyW3RdO1xuICAgICAgICByZXR1cm4gYCR7dGhpcy5GaX0vdjEvJHtlfToke259YDtcbiAgICB9XG59IHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHN1cGVyKHQpLCB0aGlzLmZvcmNlTG9uZ1BvbGxpbmcgPSB0LmZvcmNlTG9uZ1BvbGxpbmcsIHRoaXMuYXV0b0RldGVjdExvbmdQb2xsaW5nID0gdC5hdXRvRGV0ZWN0TG9uZ1BvbGxpbmcsIFxuICAgICAgICB0aGlzLnVzZUZldGNoU3RyZWFtcyA9IHQudXNlRmV0Y2hTdHJlYW1zO1xuICAgIH1cbiAgICBxaSh0LCBlLCBuLCBzKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgoKGksIHIpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG8gPSBuZXcgRTtcbiAgICAgICAgICAgIG8ubGlzdGVuT25jZShULkNPTVBMRVRFLCAoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoby5nZXRMYXN0RXJyb3JDb2RlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICBjYXNlIEkuTk9fRVJST1I6XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gby5nZXRSZXNwb25zZUpzb24oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGsoXCJDb25uZWN0aW9uXCIsIFwiWEhSIHJlY2VpdmVkOlwiLCBKU09OLnN0cmluZ2lmeShlKSksIGkoZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICAgIGNhc2UgSS5USU1FT1VUOlxuICAgICAgICAgICAgICAgICAgICAgICAgayhcIkNvbm5lY3Rpb25cIiwgJ1JQQyBcIicgKyB0ICsgJ1wiIHRpbWVkIG91dCcpLCByKG5ldyBLKHEuREVBRExJTkVfRVhDRUVERUQsIFwiUmVxdWVzdCB0aW1lIG91dFwiKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICAgIGNhc2UgSS5IVFRQX0VSUk9SOlxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IG8uZ2V0U3RhdHVzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoayhcIkNvbm5lY3Rpb25cIiwgJ1JQQyBcIicgKyB0ICsgJ1wiIGZhaWxlZCB3aXRoIHN0YXR1czonLCBuLCBcInJlc3BvbnNlIHRleHQ6XCIsIG8uZ2V0UmVzcG9uc2VUZXh0KCkpLCBcbiAgICAgICAgICAgICAgICAgICAgICAgIG4gPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IG8uZ2V0UmVzcG9uc2VKc29uKCkuZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgdC5zdGF0dXMgJiYgdC5tZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gdC50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL18vZywgXCItXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC52YWx1ZXMocSkuaW5kZXhPZihlKSA+PSAwID8gZSA6IHEuVU5LTk9XTjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSh0LnN0YXR1cyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHIobmV3IEsoZSwgdC5tZXNzYWdlKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHIobmV3IEsocS5VTktOT1dOLCBcIlNlcnZlciByZXNwb25kZWQgd2l0aCBzdGF0dXMgXCIgKyBvLmdldFN0YXR1cygpKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB3ZSByZWNlaXZlZCBhbiBIVFRQX0VSUk9SIGJ1dCB0aGVyZSdzIG5vIHN0YXR1cyBjb2RlLFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaXQncyBtb3N0IHByb2JhYmx5IGEgY29ubmVjdGlvbiBpc3N1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgcihuZXcgSyhxLlVOQVZBSUxBQkxFLCBcIkNvbm5lY3Rpb24gZmFpbGVkLlwiKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBNKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgICAgICAgICBrKFwiQ29ubmVjdGlvblwiLCAnUlBDIFwiJyArIHQgKyAnXCIgY29tcGxldGVkLicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIGNvbnN0IGEgPSBKU09OLnN0cmluZ2lmeShzKTtcbiAgICAgICAgICAgIG8uc2VuZChlLCBcIlBPU1RcIiwgYSwgbiwgMTUpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGppKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IFsgdGhpcy5GaSwgXCIvXCIsIFwiZ29vZ2xlLmZpcmVzdG9yZS52MS5GaXJlc3RvcmVcIiwgXCIvXCIsIHQsIFwiL2NoYW5uZWxcIiBdLCBzID0gQSgpLCBpID0gUigpLCByID0ge1xuICAgICAgICAgICAgLy8gUmVxdWlyZWQgZm9yIGJhY2tlbmQgc3RpY2tpbmVzcywgcm91dGluZyBiZWhhdmlvciBpcyBiYXNlZCBvbiB0aGlzXG4gICAgICAgICAgICAvLyBwYXJhbWV0ZXIuXG4gICAgICAgICAgICBodHRwU2Vzc2lvbklkUGFyYW06IFwiZ3Nlc3Npb25pZFwiLFxuICAgICAgICAgICAgaW5pdE1lc3NhZ2VIZWFkZXJzOiB7fSxcbiAgICAgICAgICAgIG1lc3NhZ2VVcmxQYXJhbXM6IHtcbiAgICAgICAgICAgICAgICAvLyBUaGlzIHBhcmFtIGlzIHVzZWQgdG8gaW1wcm92ZSByb3V0aW5nIGFuZCBwcm9qZWN0IGlzb2xhdGlvbiBieSB0aGVcbiAgICAgICAgICAgICAgICAvLyBiYWNrZW5kIGFuZCBtdXN0IGJlIGluY2x1ZGVkIGluIGV2ZXJ5IHJlcXVlc3QuXG4gICAgICAgICAgICAgICAgZGF0YWJhc2U6IGBwcm9qZWN0cy8ke3RoaXMuZGF0YWJhc2VJZC5wcm9qZWN0SWR9L2RhdGFiYXNlcy8ke3RoaXMuZGF0YWJhc2VJZC5kYXRhYmFzZX1gXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2VuZFJhd0pzb246ICEwLFxuICAgICAgICAgICAgc3VwcG9ydHNDcm9zc0RvbWFpblhocjogITAsXG4gICAgICAgICAgICBpbnRlcm5hbENoYW5uZWxQYXJhbXM6IHtcbiAgICAgICAgICAgICAgICAvLyBPdmVycmlkZSB0aGUgZGVmYXVsdCB0aW1lb3V0IChyYW5kb21pemVkIGJldHdlZW4gMTAtMjAgc2Vjb25kcykgc2luY2VcbiAgICAgICAgICAgICAgICAvLyBhIGxhcmdlIHdyaXRlIGJhdGNoIG9uIGEgc2xvdyBpbnRlcm5ldCBjb25uZWN0aW9uIG1heSB0YWtlIGEgbG9uZ1xuICAgICAgICAgICAgICAgIC8vIHRpbWUgdG8gc2VuZCB0byB0aGUgYmFja2VuZC4gUmF0aGVyIHRoYW4gaGF2ZSBXZWJDaGFubmVsIGltcG9zZSBhXG4gICAgICAgICAgICAgICAgLy8gdGlnaHQgdGltZW91dCB3aGljaCBjb3VsZCBsZWFkIHRvIGluZmluaXRlIHRpbWVvdXRzIGFuZCByZXRyaWVzLCB3ZVxuICAgICAgICAgICAgICAgIC8vIHNldCBpdCB2ZXJ5IGxhcmdlICg1LTEwIG1pbnV0ZXMpIGFuZCByZWx5IG9uIHRoZSBicm93c2VyJ3MgYnVpbHRpblxuICAgICAgICAgICAgICAgIC8vIHRpbWVvdXRzIHRvIGtpY2sgaW4gaWYgdGhlIHJlcXVlc3QgaXNuJ3Qgd29ya2luZy5cbiAgICAgICAgICAgICAgICBmb3J3YXJkQ2hhbm5lbFJlcXVlc3RUaW1lb3V0TXM6IDZlNVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGZvcmNlTG9uZ1BvbGxpbmc6IHRoaXMuZm9yY2VMb25nUG9sbGluZyxcbiAgICAgICAgICAgIGRldGVjdEJ1ZmZlcmluZ1Byb3h5OiB0aGlzLmF1dG9EZXRlY3RMb25nUG9sbGluZ1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLnVzZUZldGNoU3RyZWFtcyAmJiAoci54bWxIdHRwRmFjdG9yeSA9IG5ldyBQKHt9KSksIHRoaXMuVWkoci5pbml0TWVzc2FnZUhlYWRlcnMsIGUpLCBcbiAgICAgICAgLy8gU2VuZGluZyB0aGUgY3VzdG9tIGhlYWRlcnMgd2UganVzdCBhZGRlZCB0byByZXF1ZXN0LmluaXRNZXNzYWdlSGVhZGVyc1xuICAgICAgICAvLyAoQXV0aG9yaXphdGlvbiwgZXRjLikgd2lsbCB0cmlnZ2VyIHRoZSBicm93c2VyIHRvIG1ha2UgYSBDT1JTIHByZWZsaWdodFxuICAgICAgICAvLyByZXF1ZXN0IGJlY2F1c2UgdGhlIFhIUiB3aWxsIG5vIGxvbmdlciBtZWV0IHRoZSBjcml0ZXJpYSBmb3IgYSBcInNpbXBsZVwiXG4gICAgICAgIC8vIENPUlMgcmVxdWVzdDpcbiAgICAgICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSFRUUC9DT1JTI1NpbXBsZV9yZXF1ZXN0c1xuICAgICAgICAvLyBUaGVyZWZvcmUgdG8gYXZvaWQgdGhlIENPUlMgcHJlZmxpZ2h0IHJlcXVlc3QgKGFuIGV4dHJhIG5ldHdvcmtcbiAgICAgICAgLy8gcm91bmR0cmlwKSwgd2UgdXNlIHRoZSBodHRwSGVhZGVyc092ZXJ3cml0ZVBhcmFtIG9wdGlvbiB0byBzcGVjaWZ5IHRoYXRcbiAgICAgICAgLy8gdGhlIGhlYWRlcnMgc2hvdWxkIGluc3RlYWQgYmUgZW5jb2RlZCBpbnRvIGEgc3BlY2lhbCBcIiRodHRwSGVhZGVyc1wiIHF1ZXJ5XG4gICAgICAgIC8vIHBhcmFtZXRlciwgd2hpY2ggaXMgcmVjb2duaXplZCBieSB0aGUgd2ViY2hhbm5lbCBiYWNrZW5kLiBUaGlzIGlzXG4gICAgICAgIC8vIGZvcm1hbGx5IGRlZmluZWQgaGVyZTpcbiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2dvb2dsZS9jbG9zdXJlLWxpYnJhcnkvYmxvYi9iMGUxODE1YjEzZmI5MmE0NmQ3YzliM2MzMGRlNWQ2YTM5NmEzMjQ1L2Nsb3N1cmUvZ29vZy9uZXQvcnBjL2h0dHBjb3JzLmpzI0wzMlxuICAgICAgICAvLyBUT0RPKGIvMTQ1NjI0NzU2KTogVGhlcmUgaXMgYSBiYWNrZW5kIGJ1ZyB3aGVyZSAkaHR0cEhlYWRlcnMgaXNuJ3QgcmVzcGVjdGVkIGlmIHRoZSByZXF1ZXN0XG4gICAgICAgIC8vIGRvZXNuJ3QgaGF2ZSBhbiBPcmlnaW4gaGVhZGVyLiBTbyB3ZSBoYXZlIHRvIGV4Y2x1ZGUgYSBmZXcgYnJvd3NlciBlbnZpcm9ubWVudHMgdGhhdCBhcmVcbiAgICAgICAgLy8ga25vd24gdG8gKHNvbWV0aW1lcykgbm90IGluY2x1ZGUgYW4gT3JpZ2luLiBTZWVcbiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2ZpcmViYXNlL2ZpcmViYXNlLWpzLXNkay9pc3N1ZXMvMTQ5MS5cbiAgICAgICAgbCgpIHx8IGYoKSB8fCBkKCkgfHwgdygpIHx8IF8oKSB8fCBtKCkgfHwgKHIuaHR0cEhlYWRlcnNPdmVyd3JpdGVQYXJhbSA9IFwiJGh0dHBIZWFkZXJzXCIpO1xuICAgICAgICBjb25zdCBvID0gbi5qb2luKFwiXCIpO1xuICAgICAgICBrKFwiQ29ubmVjdGlvblwiLCBcIkNyZWF0aW5nIFdlYkNoYW5uZWw6IFwiICsgbywgcik7XG4gICAgICAgIGNvbnN0IGEgPSBzLmNyZWF0ZVdlYkNoYW5uZWwobywgcik7XG4gICAgICAgIC8vIFdlYkNoYW5uZWwgc3VwcG9ydHMgc2VuZGluZyB0aGUgZmlyc3QgbWVzc2FnZSB3aXRoIHRoZSBoYW5kc2hha2UgLSBzYXZpbmdcbiAgICAgICAgLy8gYSBuZXR3b3JrIHJvdW5kIHRyaXAuIEhvd2V2ZXIsIGl0IHdpbGwgaGF2ZSB0byBjYWxsIHNlbmQgaW4gdGhlIHNhbWVcbiAgICAgICAgLy8gSlMgZXZlbnQgbG9vcCBhcyBvcGVuLiBJbiBvcmRlciB0byBlbmZvcmNlIHRoaXMsIHdlIGRlbGF5IGFjdHVhbGx5XG4gICAgICAgIC8vIG9wZW5pbmcgdGhlIFdlYkNoYW5uZWwgdW50aWwgc2VuZCBpcyBjYWxsZWQuIFdoZXRoZXIgd2UgaGF2ZSBjYWxsZWRcbiAgICAgICAgLy8gb3BlbiBpcyB0cmFja2VkIHdpdGggdGhpcyB2YXJpYWJsZS5cbiAgICAgICAgICAgICAgICBsZXQgYyA9ICExLCB1ID0gITE7XG4gICAgICAgIC8vIEEgZmxhZyB0byBkZXRlcm1pbmUgd2hldGhlciB0aGUgc3RyZWFtIHdhcyBjbG9zZWQgKGJ5IHVzIG9yIHRocm91Z2ggYW5cbiAgICAgICAgLy8gZXJyb3IvY2xvc2UgZXZlbnQpIHRvIGF2b2lkIGRlbGl2ZXJpbmcgbXVsdGlwbGUgY2xvc2UgZXZlbnRzIG9yIHNlbmRpbmdcbiAgICAgICAgLy8gb24gYSBjbG9zZWQgc3RyZWFtXG4gICAgICAgICAgICAgICAgY29uc3QgaCA9IG5ldyBXcih7XG4gICAgICAgICAgICB2aTogdCA9PiB7XG4gICAgICAgICAgICAgICAgdSA/IGsoXCJDb25uZWN0aW9uXCIsIFwiTm90IHNlbmRpbmcgYmVjYXVzZSBXZWJDaGFubmVsIGlzIGNsb3NlZDpcIiwgdCkgOiAoYyB8fCAoayhcIkNvbm5lY3Rpb25cIiwgXCJPcGVuaW5nIFdlYkNoYW5uZWwgdHJhbnNwb3J0LlwiKSwgXG4gICAgICAgICAgICAgICAgYS5vcGVuKCksIGMgPSAhMCksIGsoXCJDb25uZWN0aW9uXCIsIFwiV2ViQ2hhbm5lbCBzZW5kaW5nOlwiLCB0KSwgYS5zZW5kKHQpKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBWaTogKCkgPT4gYS5jbG9zZSgpXG4gICAgICAgIH0pLCBnID0gKHQsIGUsIG4pID0+IHtcbiAgICAgICAgICAgIC8vIFRPRE8oZGltb25kKTogY2xvc3VyZSB0eXBpbmcgc2VlbXMgYnJva2VuIGJlY2F1c2UgV2ViQ2hhbm5lbCBkb2VzXG4gICAgICAgICAgICAvLyBub3QgaW1wbGVtZW50IGdvb2cuZXZlbnRzLkxpc3RlbmFibGVcbiAgICAgICAgICAgIHQubGlzdGVuKGUsICh0ID0+IHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBuKHQpO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgdDtcbiAgICAgICAgICAgICAgICAgICAgfSksIDApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfTtcbiAgICAgICAgLy8gQ2xvc3VyZSBldmVudHMgYXJlIGd1YXJkZWQgYW5kIGV4Y2VwdGlvbnMgYXJlIHN3YWxsb3dlZCwgc28gY2F0Y2ggYW55XG4gICAgICAgIC8vIGV4Y2VwdGlvbiBhbmQgcmV0aHJvdyB1c2luZyBhIHNldFRpbWVvdXQgc28gdGhleSBiZWNvbWUgdmlzaWJsZSBhZ2Fpbi5cbiAgICAgICAgLy8gTm90ZSB0aGF0IGV2ZW50dWFsbHkgdGhpcyBmdW5jdGlvbiBjb3VsZCBnbyBhd2F5IGlmIHdlIGFyZSBjb25maWRlbnRcbiAgICAgICAgLy8gZW5vdWdoIHRoZSBjb2RlIGlzIGV4Y2VwdGlvbiBmcmVlLlxuICAgICAgICAgICAgICAgIHJldHVybiBnKGEsIGIuRXZlbnRUeXBlLk9QRU4sICgoKSA9PiB7XG4gICAgICAgICAgICB1IHx8IGsoXCJDb25uZWN0aW9uXCIsIFwiV2ViQ2hhbm5lbCB0cmFuc3BvcnQgb3BlbmVkLlwiKTtcbiAgICAgICAgfSkpLCBnKGEsIGIuRXZlbnRUeXBlLkNMT1NFLCAoKCkgPT4ge1xuICAgICAgICAgICAgdSB8fCAodSA9ICEwLCBrKFwiQ29ubmVjdGlvblwiLCBcIldlYkNoYW5uZWwgdHJhbnNwb3J0IGNsb3NlZFwiKSwgaC4kaSgpKTtcbiAgICAgICAgfSkpLCBnKGEsIGIuRXZlbnRUeXBlLkVSUk9SLCAodCA9PiB7XG4gICAgICAgICAgICB1IHx8ICh1ID0gITAsIE8oXCJDb25uZWN0aW9uXCIsIFwiV2ViQ2hhbm5lbCB0cmFuc3BvcnQgZXJyb3JlZDpcIiwgdCksIGguJGkobmV3IEsocS5VTkFWQUlMQUJMRSwgXCJUaGUgb3BlcmF0aW9uIGNvdWxkIG5vdCBiZSBjb21wbGV0ZWRcIikpKTtcbiAgICAgICAgfSkpLCBnKGEsIGIuRXZlbnRUeXBlLk1FU1NBR0UsICh0ID0+IHtcbiAgICAgICAgICAgIHZhciBlO1xuICAgICAgICAgICAgaWYgKCF1KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHQuZGF0YVswXTtcbiAgICAgICAgICAgICAgICBMKCEhbik7XG4gICAgICAgICAgICAgICAgLy8gVE9ETyhiLzM1MTQzODkxKTogVGhlcmUgaXMgYSBidWcgaW4gT25lIFBsYXRmb3JtIHRoYXQgY2F1c2VkIGVycm9yc1xuICAgICAgICAgICAgICAgIC8vIChhbmQgb25seSBlcnJvcnMpIHRvIGJlIHdyYXBwZWQgaW4gYW4gZXh0cmEgYXJyYXkuIFRvIGJlIGZvcndhcmRcbiAgICAgICAgICAgICAgICAvLyBjb21wYXRpYmxlIHdpdGggdGhlIGJ1ZyB3ZSBuZWVkIHRvIGNoZWNrIGVpdGhlciBjb25kaXRpb24uIFRoZSBsYXR0ZXJcbiAgICAgICAgICAgICAgICAvLyBjYW4gYmUgcmVtb3ZlZCBvbmNlIHRoZSBmaXggaGFzIGJlZW4gcm9sbGVkIG91dC5cbiAgICAgICAgICAgICAgICAvLyBVc2UgYW55IGJlY2F1c2UgbXNnRGF0YS5lcnJvciBpcyBub3QgdHlwZWQuXG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IG4sIGkgPSBzLmVycm9yIHx8IChudWxsID09PSAoZSA9IHNbMF0pIHx8IHZvaWQgMCA9PT0gZSA/IHZvaWQgMCA6IGUuZXJyb3IpO1xuICAgICAgICAgICAgICAgIGlmIChpKSB7XG4gICAgICAgICAgICAgICAgICAgIGsoXCJDb25uZWN0aW9uXCIsIFwiV2ViQ2hhbm5lbCByZWNlaXZlZCBlcnJvcjpcIiwgaSk7XG4gICAgICAgICAgICAgICAgICAgIC8vIGVycm9yLnN0YXR1cyB3aWxsIGJlIGEgc3RyaW5nIGxpa2UgJ09LJyBvciAnTk9UX0ZPVU5EJy5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGkuc3RhdHVzO1xuICAgICAgICAgICAgICAgICAgICBsZXQgZSA9IFxuICAgICAgICAgICAgICAgICAgICAvKipcbiAqIE1hcHMgYW4gZXJyb3IgQ29kZSBmcm9tIGEgR1JQQyBzdGF0dXMgaWRlbnRpZmllciBsaWtlICdOT1RfRk9VTkQnLlxuICpcbiAqIEByZXR1cm5zIFRoZSBDb2RlIGVxdWl2YWxlbnQgdG8gdGhlIGdpdmVuIHN0YXR1cyBzdHJpbmcgb3IgdW5kZWZpbmVkIGlmXG4gKiAgICAgdGhlcmUgaXMgbm8gbWF0Y2guXG4gKi9cbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbG9va3VwIGJ5IHN0cmluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB1blt0XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2b2lkIDAgIT09IGUpIHJldHVybiBmbihlKTtcbiAgICAgICAgICAgICAgICAgICAgfSh0KSwgbiA9IGkubWVzc2FnZTtcbiAgICAgICAgICAgICAgICAgICAgdm9pZCAwID09PSBlICYmIChlID0gcS5JTlRFUk5BTCwgbiA9IFwiVW5rbm93biBlcnJvciBzdGF0dXM6IFwiICsgdCArIFwiIHdpdGggbWVzc2FnZSBcIiArIGkubWVzc2FnZSksIFxuICAgICAgICAgICAgICAgICAgICAvLyBNYXJrIGNsb3NlZCBzbyBubyBmdXJ0aGVyIGV2ZW50cyBhcmUgcHJvcGFnYXRlZFxuICAgICAgICAgICAgICAgICAgICB1ID0gITAsIGguJGkobmV3IEsoZSwgbikpLCBhLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGsoXCJDb25uZWN0aW9uXCIsIFwiV2ViQ2hhbm5lbCByZWNlaXZlZDpcIiwgbiksIGguT2kobik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKSwgZyhpLCB2LlNUQVRfRVZFTlQsICh0ID0+IHtcbiAgICAgICAgICAgIHQuc3RhdCA9PT0gVi5QUk9YWSA/IGsoXCJDb25uZWN0aW9uXCIsIFwiRGV0ZWN0ZWQgYnVmZmVyaW5nIHByb3h5XCIpIDogdC5zdGF0ID09PSBWLk5PUFJPWFkgJiYgayhcIkNvbm5lY3Rpb25cIiwgXCJEZXRlY3RlZCBubyBidWZmZXJpbmcgcHJveHlcIik7XG4gICAgICAgIH0pKSwgc2V0VGltZW91dCgoKCkgPT4ge1xuICAgICAgICAgICAgLy8gVGVjaG5pY2FsbHkgd2UgY291bGQvc2hvdWxkIHdhaXQgZm9yIHRoZSBXZWJDaGFubmVsIG9wZW5lZCBldmVudCxcbiAgICAgICAgICAgIC8vIGJ1dCBiZWNhdXNlIHdlIHdhbnQgdG8gc2VuZCB0aGUgZmlyc3QgbWVzc2FnZSB3aXRoIHRoZSBXZWJDaGFubmVsXG4gICAgICAgICAgICAvLyBoYW5kc2hha2Ugd2UgcHJldGVuZCB0aGUgY2hhbm5lbCBvcGVuZWQgaGVyZSAoYXN5bmNocm9ub3VzbHkpLCBhbmRcbiAgICAgICAgICAgIC8vIHRoZW4gZGVsYXkgdGhlIGFjdHVhbCBvcGVuIHVudGlsIHRoZSBmaXJzdCBtZXNzYWdlIGlzIHNlbnQuXG4gICAgICAgICAgICBoLmtpKCk7XG4gICAgICAgIH0pLCAwKSwgaDtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKiogSW5pdGlhbGl6ZXMgdGhlIFdlYkNoYW5uZWxDb25uZWN0aW9uIGZvciB0aGUgYnJvd3Nlci4gKi9cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKiogVGhlIFBsYXRmb3JtJ3MgJ3dpbmRvdycgaW1wbGVtZW50YXRpb24gb3IgbnVsbCBpZiBub3QgYXZhaWxhYmxlLiAqL1xuZnVuY3Rpb24genIoKSB7XG4gICAgLy8gYHdpbmRvd2AgaXMgbm90IGFsd2F5cyBhdmFpbGFibGUsIGUuZy4gaW4gUmVhY3ROYXRpdmUgYW5kIFdlYldvcmtlcnMuXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXJlc3RyaWN0ZWQtZ2xvYmFsc1xuICAgIHJldHVybiBcInVuZGVmaW5lZFwiICE9IHR5cGVvZiB3aW5kb3cgPyB3aW5kb3cgOiBudWxsO1xufVxuXG4vKiogVGhlIFBsYXRmb3JtJ3MgJ2RvY3VtZW50JyBpbXBsZW1lbnRhdGlvbiBvciBudWxsIGlmIG5vdCBhdmFpbGFibGUuICovIGZ1bmN0aW9uIEhyKCkge1xuICAgIC8vIGBkb2N1bWVudGAgaXMgbm90IGFsd2F5cyBhdmFpbGFibGUsIGUuZy4gaW4gUmVhY3ROYXRpdmUgYW5kIFdlYldvcmtlcnMuXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXJlc3RyaWN0ZWQtZ2xvYmFsc1xuICAgIHJldHVybiBcInVuZGVmaW5lZFwiICE9IHR5cGVvZiBkb2N1bWVudCA/IGRvY3VtZW50IDogbnVsbDtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gZnVuY3Rpb24gSnIodCkge1xuICAgIHJldHVybiBuZXcgTG4odCwgLyogdXNlUHJvdG8zSnNvbj0gKi8gITApO1xufVxuXG4vKipcbiAqIEFuIGluc3RhbmNlIG9mIHRoZSBQbGF0Zm9ybSdzICdUZXh0RW5jb2RlcicgaW1wbGVtZW50YXRpb24uXG4gKi9cbi8qKlxuICogQSBoZWxwZXIgZm9yIHJ1bm5pbmcgZGVsYXllZCB0YXNrcyBmb2xsb3dpbmcgYW4gZXhwb25lbnRpYWwgYmFja29mZiBjdXJ2ZVxuICogYmV0d2VlbiBhdHRlbXB0cy5cbiAqXG4gKiBFYWNoIGRlbGF5IGlzIG1hZGUgdXAgb2YgYSBcImJhc2VcIiBkZWxheSB3aGljaCBmb2xsb3dzIHRoZSBleHBvbmVudGlhbFxuICogYmFja29mZiBjdXJ2ZSwgYW5kIGEgKy8tIDUwJSBcImppdHRlclwiIHRoYXQgaXMgY2FsY3VsYXRlZCBhbmQgYWRkZWQgdG8gdGhlXG4gKiBiYXNlIGRlbGF5LiBUaGlzIHByZXZlbnRzIGNsaWVudHMgZnJvbSBhY2NpZGVudGFsbHkgc3luY2hyb25pemluZyB0aGVpclxuICogZGVsYXlzIGNhdXNpbmcgc3Bpa2VzIG9mIGxvYWQgdG8gdGhlIGJhY2tlbmQuXG4gKi9cbmNsYXNzIFlyIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKipcbiAgICAgKiBUaGUgQXN5bmNRdWV1ZSB0byBydW4gYmFja29mZiBvcGVyYXRpb25zIG9uLlxuICAgICAqL1xuICAgIHQsIFxuICAgIC8qKlxuICAgICAqIFRoZSBJRCB0byB1c2Ugd2hlbiBzY2hlZHVsaW5nIGJhY2tvZmYgb3BlcmF0aW9ucyBvbiB0aGUgQXN5bmNRdWV1ZS5cbiAgICAgKi9cbiAgICBlLCBcbiAgICAvKipcbiAgICAgKiBUaGUgaW5pdGlhbCBkZWxheSAodXNlZCBhcyB0aGUgYmFzZSBkZWxheSBvbiB0aGUgZmlyc3QgcmV0cnkgYXR0ZW1wdCkuXG4gICAgICogTm90ZSB0aGF0IGppdHRlciB3aWxsIHN0aWxsIGJlIGFwcGxpZWQsIHNvIHRoZSBhY3R1YWwgZGVsYXkgY291bGQgYmUgYXNcbiAgICAgKiBsaXR0bGUgYXMgMC41KmluaXRpYWxEZWxheU1zLlxuICAgICAqL1xuICAgIG4gPSAxZTNcbiAgICAvKipcbiAgICAgKiBUaGUgbXVsdGlwbGllciB0byB1c2UgdG8gZGV0ZXJtaW5lIHRoZSBleHRlbmRlZCBiYXNlIGRlbGF5IGFmdGVyIGVhY2hcbiAgICAgKiBhdHRlbXB0LlxuICAgICAqLyAsIHMgPSAxLjVcbiAgICAvKipcbiAgICAgKiBUaGUgbWF4aW11bSBiYXNlIGRlbGF5IGFmdGVyIHdoaWNoIG5vIGZ1cnRoZXIgYmFja29mZiBpcyBwZXJmb3JtZWQuXG4gICAgICogTm90ZSB0aGF0IGppdHRlciB3aWxsIHN0aWxsIGJlIGFwcGxpZWQsIHNvIHRoZSBhY3R1YWwgZGVsYXkgY291bGQgYmUgYXNcbiAgICAgKiBtdWNoIGFzIDEuNSptYXhEZWxheU1zLlxuICAgICAqLyAsIGkgPSA2ZTQpIHtcbiAgICAgICAgdGhpcy5PZSA9IHQsIHRoaXMudGltZXJJZCA9IGUsIHRoaXMuUWkgPSBuLCB0aGlzLldpID0gcywgdGhpcy5HaSA9IGksIHRoaXMuemkgPSAwLCBcbiAgICAgICAgdGhpcy5IaSA9IG51bGwsIFxuICAgICAgICAvKiogVGhlIGxhc3QgYmFja29mZiBhdHRlbXB0LCBhcyBlcG9jaCBtaWxsaXNlY29uZHMuICovXG4gICAgICAgIHRoaXMuSmkgPSBEYXRlLm5vdygpLCB0aGlzLnJlc2V0KCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlc2V0cyB0aGUgYmFja29mZiBkZWxheS5cbiAgICAgKlxuICAgICAqIFRoZSB2ZXJ5IG5leHQgYmFja29mZkFuZFdhaXQoKSB3aWxsIGhhdmUgbm8gZGVsYXkuIElmIGl0IGlzIGNhbGxlZCBhZ2FpblxuICAgICAqIChpLmUuIGR1ZSB0byBhbiBlcnJvciksIGluaXRpYWxEZWxheU1zIChwbHVzIGppdHRlcikgd2lsbCBiZSB1c2VkLCBhbmRcbiAgICAgKiBzdWJzZXF1ZW50IG9uZXMgd2lsbCBpbmNyZWFzZSBhY2NvcmRpbmcgdG8gdGhlIGJhY2tvZmZGYWN0b3IuXG4gICAgICovICAgIHJlc2V0KCkge1xuICAgICAgICB0aGlzLnppID0gMDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVzZXRzIHRoZSBiYWNrb2ZmIGRlbGF5IHRvIHRoZSBtYXhpbXVtIGRlbGF5IChlLmcuIGZvciB1c2UgYWZ0ZXIgYVxuICAgICAqIFJFU09VUkNFX0VYSEFVU1RFRCBlcnJvcikuXG4gICAgICovICAgIFlpKCkge1xuICAgICAgICB0aGlzLnppID0gdGhpcy5HaTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIHByb21pc2UgdGhhdCByZXNvbHZlcyBhZnRlciBjdXJyZW50RGVsYXlNcywgYW5kIGluY3JlYXNlcyB0aGVcbiAgICAgKiBkZWxheSBmb3IgYW55IHN1YnNlcXVlbnQgYXR0ZW1wdHMuIElmIHRoZXJlIHdhcyBhIHBlbmRpbmcgYmFja29mZiBvcGVyYXRpb25cbiAgICAgKiBhbHJlYWR5LCBpdCB3aWxsIGJlIGNhbmNlbGVkLlxuICAgICAqLyAgICBYaSh0KSB7XG4gICAgICAgIC8vIENhbmNlbCBhbnkgcGVuZGluZyBiYWNrb2ZmIG9wZXJhdGlvbi5cbiAgICAgICAgdGhpcy5jYW5jZWwoKTtcbiAgICAgICAgLy8gRmlyc3Qgc2NoZWR1bGUgdXNpbmcgdGhlIGN1cnJlbnQgYmFzZSAod2hpY2ggbWF5IGJlIDAgYW5kIHNob3VsZCBiZVxuICAgICAgICAvLyBob25vcmVkIGFzIHN1Y2gpLlxuICAgICAgICBjb25zdCBlID0gTWF0aC5mbG9vcih0aGlzLnppICsgdGhpcy5aaSgpKSwgbiA9IE1hdGgubWF4KDAsIERhdGUubm93KCkgLSB0aGlzLkppKSwgcyA9IE1hdGgubWF4KDAsIGUgLSBuKTtcbiAgICAgICAgLy8gR3VhcmQgYWdhaW5zdCBsYXN0QXR0ZW1wdFRpbWUgYmVpbmcgaW4gdGhlIGZ1dHVyZSBkdWUgdG8gYSBjbG9jayBjaGFuZ2UuXG4gICAgICAgICAgICAgICAgcyA+IDAgJiYgayhcIkV4cG9uZW50aWFsQmFja29mZlwiLCBgQmFja2luZyBvZmYgZm9yICR7c30gbXMgKGJhc2UgZGVsYXk6ICR7dGhpcy56aX0gbXMsIGRlbGF5IHdpdGggaml0dGVyOiAke2V9IG1zLCBsYXN0IGF0dGVtcHQ6ICR7bn0gbXMgYWdvKWApLCBcbiAgICAgICAgdGhpcy5IaSA9IHRoaXMuT2UuZW5xdWV1ZUFmdGVyRGVsYXkodGhpcy50aW1lcklkLCBzLCAoKCkgPT4gKHRoaXMuSmkgPSBEYXRlLm5vdygpLCBcbiAgICAgICAgdCgpKSkpLCBcbiAgICAgICAgLy8gQXBwbHkgYmFja29mZiBmYWN0b3IgdG8gZGV0ZXJtaW5lIG5leHQgZGVsYXkgYW5kIGVuc3VyZSBpdCBpcyB3aXRoaW5cbiAgICAgICAgLy8gYm91bmRzLlxuICAgICAgICB0aGlzLnppICo9IHRoaXMuV2ksIHRoaXMuemkgPCB0aGlzLlFpICYmICh0aGlzLnppID0gdGhpcy5RaSksIHRoaXMuemkgPiB0aGlzLkdpICYmICh0aGlzLnppID0gdGhpcy5HaSk7XG4gICAgfVxuICAgIHRyKCkge1xuICAgICAgICBudWxsICE9PSB0aGlzLkhpICYmICh0aGlzLkhpLnNraXBEZWxheSgpLCB0aGlzLkhpID0gbnVsbCk7XG4gICAgfVxuICAgIGNhbmNlbCgpIHtcbiAgICAgICAgbnVsbCAhPT0gdGhpcy5IaSAmJiAodGhpcy5IaS5jYW5jZWwoKSwgdGhpcy5IaSA9IG51bGwpO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyBhIHJhbmRvbSB2YWx1ZSBpbiB0aGUgcmFuZ2UgWy1jdXJyZW50QmFzZU1zLzIsIGN1cnJlbnRCYXNlTXMvMl0gKi8gICAgWmkoKSB7XG4gICAgICAgIHJldHVybiAoTWF0aC5yYW5kb20oKSAtIC41KSAqIHRoaXMuemk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBIFBlcnNpc3RlbnRTdHJlYW0gaXMgYW4gYWJzdHJhY3QgYmFzZSBjbGFzcyB0aGF0IHJlcHJlc2VudHMgYSBzdHJlYW1pbmcgUlBDXG4gKiB0byB0aGUgRmlyZXN0b3JlIGJhY2tlbmQuIEl0J3MgYnVpbHQgb24gdG9wIG9mIHRoZSBjb25uZWN0aW9ucyBvd24gc3VwcG9ydFxuICogZm9yIHN0cmVhbWluZyBSUENzLCBhbmQgYWRkcyBzZXZlcmFsIGNyaXRpY2FsIGZlYXR1cmVzIGZvciBvdXIgY2xpZW50czpcbiAqXG4gKiAgIC0gRXhwb25lbnRpYWwgYmFja29mZiBvbiBmYWlsdXJlXG4gKiAgIC0gQXV0aGVudGljYXRpb24gdmlhIENyZWRlbnRpYWxzUHJvdmlkZXJcbiAqICAgLSBEaXNwYXRjaGluZyBhbGwgY2FsbGJhY2tzIGludG8gdGhlIHNoYXJlZCB3b3JrZXIgcXVldWVcbiAqICAgLSBDbG9zaW5nIGlkbGUgc3RyZWFtcyBhZnRlciA2MCBzZWNvbmRzIG9mIGluYWN0aXZpdHlcbiAqXG4gKiBTdWJjbGFzc2VzIG9mIFBlcnNpc3RlbnRTdHJlYW0gaW1wbGVtZW50IHNlcmlhbGl6YXRpb24gb2YgbW9kZWxzIHRvIGFuZFxuICogZnJvbSB0aGUgSlNPTiByZXByZXNlbnRhdGlvbiBvZiB0aGUgcHJvdG9jb2wgYnVmZmVycyBmb3IgYSBzcGVjaWZpY1xuICogc3RyZWFtaW5nIFJQQy5cbiAqXG4gKiAjIyBTdGFydGluZyBhbmQgU3RvcHBpbmdcbiAqXG4gKiBTdHJlYW1pbmcgUlBDcyBhcmUgc3RhdGVmdWwgYW5kIG5lZWQgdG8gYmUgc3RhcnQoKWVkIGJlZm9yZSBtZXNzYWdlcyBjYW5cbiAqIGJlIHNlbnQgYW5kIHJlY2VpdmVkLiBUaGUgUGVyc2lzdGVudFN0cmVhbSB3aWxsIGNhbGwgdGhlIG9uT3BlbigpIGZ1bmN0aW9uXG4gKiBvZiB0aGUgbGlzdGVuZXIgb25jZSB0aGUgc3RyZWFtIGlzIHJlYWR5IHRvIGFjY2VwdCByZXF1ZXN0cy5cbiAqXG4gKiBTaG91bGQgYSBzdGFydCgpIGZhaWwsIFBlcnNpc3RlbnRTdHJlYW0gd2lsbCBjYWxsIHRoZSByZWdpc3RlcmVkIG9uQ2xvc2UoKVxuICogbGlzdGVuZXIgd2l0aCBhIEZpcmVzdG9yZUVycm9yIGluZGljYXRpbmcgd2hhdCB3ZW50IHdyb25nLlxuICpcbiAqIEEgUGVyc2lzdGVudFN0cmVhbSBjYW4gYmUgc3RhcnRlZCBhbmQgc3RvcHBlZCByZXBlYXRlZGx5LlxuICpcbiAqIEdlbmVyaWMgdHlwZXM6XG4gKiAgU2VuZFR5cGU6IFRoZSB0eXBlIG9mIHRoZSBvdXRnb2luZyBtZXNzYWdlIG9mIHRoZSB1bmRlcmx5aW5nXG4gKiAgICBjb25uZWN0aW9uIHN0cmVhbVxuICogIFJlY2VpdmVUeXBlOiBUaGUgdHlwZSBvZiB0aGUgaW5jb21pbmcgbWVzc2FnZSBvZiB0aGUgdW5kZXJseWluZ1xuICogICAgY29ubmVjdGlvbiBzdHJlYW1cbiAqICBMaXN0ZW5lclR5cGU6IFRoZSB0eXBlIG9mIHRoZSBsaXN0ZW5lciB0aGF0IHdpbGwgYmUgdXNlZCBmb3IgY2FsbGJhY2tzXG4gKi9cbmNsYXNzIFhyIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzLCBpLCByKSB7XG4gICAgICAgIHRoaXMuT2UgPSB0LCB0aGlzLmVyID0gbiwgdGhpcy5uciA9IHMsIHRoaXMuY3JlZGVudGlhbHNQcm92aWRlciA9IGksIHRoaXMubGlzdGVuZXIgPSByLCBcbiAgICAgICAgdGhpcy5zdGF0ZSA9IDAgLyogSW5pdGlhbCAqLyAsIFxuICAgICAgICAvKipcbiAgICAgICAgICogQSBjbG9zZSBjb3VudCB0aGF0J3MgaW5jcmVtZW50ZWQgZXZlcnkgdGltZSB0aGUgc3RyZWFtIGlzIGNsb3NlZDsgdXNlZCBieVxuICAgICAgICAgKiBnZXRDbG9zZUd1YXJkZWREaXNwYXRjaGVyKCkgdG8gaW52YWxpZGF0ZSBjYWxsYmFja3MgdGhhdCBoYXBwZW4gYWZ0ZXJcbiAgICAgICAgICogY2xvc2UuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnNyID0gMCwgdGhpcy5pciA9IG51bGwsIHRoaXMuc3RyZWFtID0gbnVsbCwgdGhpcy5yciA9IG5ldyBZcih0LCBlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHN0YXJ0KCkgaGFzIGJlZW4gY2FsbGVkIGFuZCBubyBlcnJvciBoYXMgb2NjdXJyZWQuIFRydWVcbiAgICAgKiBpbmRpY2F0ZXMgdGhlIHN0cmVhbSBpcyBvcGVuIG9yIGluIHRoZSBwcm9jZXNzIG9mIG9wZW5pbmcgKHdoaWNoXG4gICAgICogZW5jb21wYXNzZXMgcmVzcGVjdGluZyBiYWNrb2ZmLCBnZXR0aW5nIGF1dGggdG9rZW5zLCBhbmQgc3RhcnRpbmcgdGhlXG4gICAgICogYWN0dWFsIFJQQykuIFVzZSBpc09wZW4oKSB0byBkZXRlcm1pbmUgaWYgdGhlIHN0cmVhbSBpcyBvcGVuIGFuZCByZWFkeSBmb3JcbiAgICAgKiBvdXRib3VuZCByZXF1ZXN0cy5cbiAgICAgKi8gICAgYXIoKSB7XG4gICAgICAgIHJldHVybiAxIC8qIFN0YXJ0aW5nICovID09PSB0aGlzLnN0YXRlIHx8IDIgLyogT3BlbiAqLyA9PT0gdGhpcy5zdGF0ZSB8fCA0IC8qIEJhY2tvZmYgKi8gPT09IHRoaXMuc3RhdGU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgdW5kZXJseWluZyBSUEMgaXMgb3BlbiAodGhlIG9uT3BlbigpIGxpc3RlbmVyIGhhcyBiZWVuXG4gICAgICogY2FsbGVkKSBhbmQgdGhlIHN0cmVhbSBpcyByZWFkeSBmb3Igb3V0Ym91bmQgcmVxdWVzdHMuXG4gICAgICovICAgIGNyKCkge1xuICAgICAgICByZXR1cm4gMiAvKiBPcGVuICovID09PSB0aGlzLnN0YXRlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdGFydHMgdGhlIFJQQy4gT25seSBhbGxvd2VkIGlmIGlzU3RhcnRlZCgpIHJldHVybnMgZmFsc2UuIFRoZSBzdHJlYW0gaXNcbiAgICAgKiBub3QgaW1tZWRpYXRlbHkgcmVhZHkgZm9yIHVzZTogb25PcGVuKCkgd2lsbCBiZSBpbnZva2VkIHdoZW4gdGhlIFJQQyBpc1xuICAgICAqIHJlYWR5IGZvciBvdXRib3VuZCByZXF1ZXN0cywgYXQgd2hpY2ggcG9pbnQgaXNPcGVuKCkgd2lsbCByZXR1cm4gdHJ1ZS5cbiAgICAgKlxuICAgICAqIFdoZW4gc3RhcnQgcmV0dXJucywgaXNTdGFydGVkKCkgd2lsbCByZXR1cm4gdHJ1ZS5cbiAgICAgKi8gICAgc3RhcnQoKSB7XG4gICAgICAgIDMgLyogRXJyb3IgKi8gIT09IHRoaXMuc3RhdGUgPyB0aGlzLmF1dGgoKSA6IHRoaXMudXIoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3RvcHMgdGhlIFJQQy4gVGhpcyBjYWxsIGlzIGlkZW1wb3RlbnQgYW5kIGFsbG93ZWQgcmVnYXJkbGVzcyBvZiB0aGVcbiAgICAgKiBjdXJyZW50IGlzU3RhcnRlZCgpIHN0YXRlLlxuICAgICAqXG4gICAgICogV2hlbiBzdG9wIHJldHVybnMsIGlzU3RhcnRlZCgpIGFuZCBpc09wZW4oKSB3aWxsIGJvdGggcmV0dXJuIGZhbHNlLlxuICAgICAqLyAgICBhc3luYyBzdG9wKCkge1xuICAgICAgICB0aGlzLmFyKCkgJiYgYXdhaXQgdGhpcy5jbG9zZSgwIC8qIEluaXRpYWwgKi8pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZnRlciBhbiBlcnJvciB0aGUgc3RyZWFtIHdpbGwgdXN1YWxseSBiYWNrIG9mZiBvbiB0aGUgbmV4dCBhdHRlbXB0IHRvXG4gICAgICogc3RhcnQgaXQuIElmIHRoZSBlcnJvciB3YXJyYW50cyBhbiBpbW1lZGlhdGUgcmVzdGFydCBvZiB0aGUgc3RyZWFtLCB0aGVcbiAgICAgKiBzZW5kZXIgY2FuIHVzZSB0aGlzIHRvIGluZGljYXRlIHRoYXQgdGhlIHJlY2VpdmVyIHNob3VsZCBub3QgYmFjayBvZmYuXG4gICAgICpcbiAgICAgKiBFYWNoIGVycm9yIHdpbGwgY2FsbCB0aGUgb25DbG9zZSgpIGxpc3RlbmVyLiBUaGF0IGZ1bmN0aW9uIGNhbiBkZWNpZGUgdG9cbiAgICAgKiBpbmhpYml0IGJhY2tvZmYgaWYgcmVxdWlyZWQuXG4gICAgICovICAgIGhyKCkge1xuICAgICAgICB0aGlzLnN0YXRlID0gMCAvKiBJbml0aWFsICovICwgdGhpcy5yci5yZXNldCgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBNYXJrcyB0aGlzIHN0cmVhbSBhcyBpZGxlLiBJZiBubyBmdXJ0aGVyIGFjdGlvbnMgYXJlIHBlcmZvcm1lZCBvbiB0aGVcbiAgICAgKiBzdHJlYW0gZm9yIG9uZSBtaW51dGUsIHRoZSBzdHJlYW0gd2lsbCBhdXRvbWF0aWNhbGx5IGNsb3NlIGl0c2VsZiBhbmRcbiAgICAgKiBub3RpZnkgdGhlIHN0cmVhbSdzIG9uQ2xvc2UoKSBoYW5kbGVyIHdpdGggU3RhdHVzLk9LLiBUaGUgc3RyZWFtIHdpbGwgdGhlblxuICAgICAqIGJlIGluIGEgIWlzU3RhcnRlZCgpIHN0YXRlLCByZXF1aXJpbmcgdGhlIGNhbGxlciB0byBzdGFydCB0aGUgc3RyZWFtIGFnYWluXG4gICAgICogYmVmb3JlIGZ1cnRoZXIgdXNlLlxuICAgICAqXG4gICAgICogT25seSBzdHJlYW1zIHRoYXQgYXJlIGluIHN0YXRlICdPcGVuJyBjYW4gYmUgbWFya2VkIGlkbGUsIGFzIGFsbCBvdGhlclxuICAgICAqIHN0YXRlcyBpbXBseSBwZW5kaW5nIG5ldHdvcmsgb3BlcmF0aW9ucy5cbiAgICAgKi8gICAgbHIoKSB7XG4gICAgICAgIC8vIFN0YXJ0cyB0aGUgaWRsZSB0aW1lIGlmIHdlIGFyZSBpbiBzdGF0ZSAnT3BlbicgYW5kIGFyZSBub3QgeWV0IGFscmVhZHlcbiAgICAgICAgLy8gcnVubmluZyBhIHRpbWVyIChpbiB3aGljaCBjYXNlIHRoZSBwcmV2aW91cyBpZGxlIHRpbWVvdXQgc3RpbGwgYXBwbGllcykuXG4gICAgICAgIHRoaXMuY3IoKSAmJiBudWxsID09PSB0aGlzLmlyICYmICh0aGlzLmlyID0gdGhpcy5PZS5lbnF1ZXVlQWZ0ZXJEZWxheSh0aGlzLmVyLCA2ZTQsICgoKSA9PiB0aGlzLmRyKCkpKSk7XG4gICAgfVxuICAgIC8qKiBTZW5kcyBhIG1lc3NhZ2UgdG8gdGhlIHVuZGVybHlpbmcgc3RyZWFtLiAqLyAgICB3cih0KSB7XG4gICAgICAgIHRoaXMuX3IoKSwgdGhpcy5zdHJlYW0uc2VuZCh0KTtcbiAgICB9XG4gICAgLyoqIENhbGxlZCBieSB0aGUgaWRsZSB0aW1lciB3aGVuIHRoZSBzdHJlYW0gc2hvdWxkIGNsb3NlIGR1ZSB0byBpbmFjdGl2aXR5LiAqLyAgICBhc3luYyBkcigpIHtcbiAgICAgICAgaWYgKHRoaXMuY3IoKSkgXG4gICAgICAgIC8vIFdoZW4gdGltaW5nIG91dCBhbiBpZGxlIHN0cmVhbSB0aGVyZSdzIG5vIHJlYXNvbiB0byBmb3JjZSB0aGUgc3RyZWFtIGludG8gYmFja29mZiB3aGVuXG4gICAgICAgIC8vIGl0IHJlc3RhcnRzIHNvIHNldCB0aGUgc3RyZWFtIHN0YXRlIHRvIEluaXRpYWwgaW5zdGVhZCBvZiBFcnJvci5cbiAgICAgICAgcmV0dXJuIHRoaXMuY2xvc2UoMCAvKiBJbml0aWFsICovKTtcbiAgICB9XG4gICAgLyoqIE1hcmtzIHRoZSBzdHJlYW0gYXMgYWN0aXZlIGFnYWluLiAqLyAgICBfcigpIHtcbiAgICAgICAgdGhpcy5pciAmJiAodGhpcy5pci5jYW5jZWwoKSwgdGhpcy5pciA9IG51bGwpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDbG9zZXMgdGhlIHN0cmVhbSBhbmQgY2xlYW5zIHVwIGFzIG5lY2Vzc2FyeTpcbiAgICAgKlxuICAgICAqICogY2xvc2VzIHRoZSB1bmRlcmx5aW5nIEdSUEMgc3RyZWFtO1xuICAgICAqICogY2FsbHMgdGhlIG9uQ2xvc2UgaGFuZGxlciB3aXRoIHRoZSBnaXZlbiAnZXJyb3InO1xuICAgICAqICogc2V0cyBpbnRlcm5hbCBzdHJlYW0gc3RhdGUgdG8gJ2ZpbmFsU3RhdGUnO1xuICAgICAqICogYWRqdXN0cyB0aGUgYmFja29mZiB0aW1lciBiYXNlZCBvbiB0aGUgZXJyb3JcbiAgICAgKlxuICAgICAqIEEgbmV3IHN0cmVhbSBjYW4gYmUgb3BlbmVkIGJ5IGNhbGxpbmcgc3RhcnQoKS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBmaW5hbFN0YXRlIC0gdGhlIGludGVuZGVkIHN0YXRlIG9mIHRoZSBzdHJlYW0gYWZ0ZXIgY2xvc2luZy5cbiAgICAgKiBAcGFyYW0gZXJyb3IgLSB0aGUgZXJyb3IgdGhlIGNvbm5lY3Rpb24gd2FzIGNsb3NlZCB3aXRoLlxuICAgICAqLyAgICBhc3luYyBjbG9zZSh0LCBlKSB7XG4gICAgICAgIC8vIENhbmNlbCBhbnkgb3V0c3RhbmRpbmcgdGltZXJzICh0aGV5J3JlIGd1YXJhbnRlZWQgbm90IHRvIGV4ZWN1dGUpLlxuICAgICAgICB0aGlzLl9yKCksIHRoaXMucnIuY2FuY2VsKCksIFxuICAgICAgICAvLyBJbnZhbGlkYXRlcyBhbnkgc3RyZWFtLXJlbGF0ZWQgY2FsbGJhY2tzIChlLmcuIGZyb20gYXV0aCBvciB0aGVcbiAgICAgICAgLy8gdW5kZXJseWluZyBzdHJlYW0pLCBndWFyYW50ZWVpbmcgdGhleSB3b24ndCBleGVjdXRlLlxuICAgICAgICB0aGlzLnNyKyssIDMgLyogRXJyb3IgKi8gIT09IHQgPyBcbiAgICAgICAgLy8gSWYgdGhpcyBpcyBhbiBpbnRlbnRpb25hbCBjbG9zZSBlbnN1cmUgd2UgZG9uJ3QgZGVsYXkgb3VyIG5leHQgY29ubmVjdGlvbiBhdHRlbXB0LlxuICAgICAgICB0aGlzLnJyLnJlc2V0KCkgOiBlICYmIGUuY29kZSA9PT0gcS5SRVNPVVJDRV9FWEhBVVNURUQgPyAoXG4gICAgICAgIC8vIExvZyB0aGUgZXJyb3IuIChQcm9iYWJseSBlaXRoZXIgJ3F1b3RhIGV4Y2VlZGVkJyBvciAnbWF4IHF1ZXVlIGxlbmd0aCByZWFjaGVkJy4pXG4gICAgICAgICQoZS50b1N0cmluZygpKSwgJChcIlVzaW5nIG1heGltdW0gYmFja29mZiBkZWxheSB0byBwcmV2ZW50IG92ZXJsb2FkaW5nIHRoZSBiYWNrZW5kLlwiKSwgXG4gICAgICAgIHRoaXMucnIuWWkoKSkgOiBlICYmIGUuY29kZSA9PT0gcS5VTkFVVEhFTlRJQ0FURUQgJiYgXG4gICAgICAgIC8vIFwidW5hdXRoZW50aWNhdGVkXCIgZXJyb3IgbWVhbnMgdGhlIHRva2VuIHdhcyByZWplY3RlZC4gVHJ5IGZvcmNlIHJlZnJlc2hpbmcgaXQgaW4gY2FzZSBpdFxuICAgICAgICAvLyBqdXN0IGV4cGlyZWQuXG4gICAgICAgIHRoaXMuY3JlZGVudGlhbHNQcm92aWRlci5pbnZhbGlkYXRlVG9rZW4oKSwgXG4gICAgICAgIC8vIENsZWFuIHVwIHRoZSB1bmRlcmx5aW5nIHN0cmVhbSBiZWNhdXNlIHdlIGFyZSBubyBsb25nZXIgaW50ZXJlc3RlZCBpbiBldmVudHMuXG4gICAgICAgIG51bGwgIT09IHRoaXMuc3RyZWFtICYmICh0aGlzLm1yKCksIHRoaXMuc3RyZWFtLmNsb3NlKCksIHRoaXMuc3RyZWFtID0gbnVsbCksIFxuICAgICAgICAvLyBUaGlzIHN0YXRlIG11c3QgYmUgYXNzaWduZWQgYmVmb3JlIGNhbGxpbmcgb25DbG9zZSgpIHRvIGFsbG93IHRoZSBjYWxsYmFjayB0b1xuICAgICAgICAvLyBpbmhpYml0IGJhY2tvZmYgb3Igb3RoZXJ3aXNlIG1hbmlwdWxhdGUgdGhlIHN0YXRlIGluIGl0cyBub24tc3RhcnRlZCBzdGF0ZS5cbiAgICAgICAgdGhpcy5zdGF0ZSA9IHQsIFxuICAgICAgICAvLyBOb3RpZnkgdGhlIGxpc3RlbmVyIHRoYXQgdGhlIHN0cmVhbSBjbG9zZWQuXG4gICAgICAgIGF3YWl0IHRoaXMubGlzdGVuZXIuQ2koZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbiBiZSBvdmVycmlkZGVuIHRvIHBlcmZvcm0gYWRkaXRpb25hbCBjbGVhbnVwIGJlZm9yZSB0aGUgc3RyZWFtIGlzIGNsb3NlZC5cbiAgICAgKiBDYWxsaW5nIHN1cGVyLnRlYXJEb3duKCkgaXMgbm90IHJlcXVpcmVkLlxuICAgICAqLyAgICBtcigpIHt9XG4gICAgYXV0aCgpIHtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IDEgLyogU3RhcnRpbmcgKi87XG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLmdyKHRoaXMuc3IpLCBlID0gdGhpcy5zcjtcbiAgICAgICAgLy8gVE9ETyhtaWtlbGVoZW4pOiBKdXN0IHVzZSBkaXNwYXRjaElmTm90Q2xvc2VkLCBidXQgc2VlIFRPRE8gYmVsb3cuXG4gICAgICAgICAgICAgICAgdGhpcy5jcmVkZW50aWFsc1Byb3ZpZGVyLmdldFRva2VuKCkudGhlbigodCA9PiB7XG4gICAgICAgICAgICAvLyBTdHJlYW0gY2FuIGJlIHN0b3BwZWQgd2hpbGUgd2FpdGluZyBmb3IgYXV0aGVudGljYXRpb24uXG4gICAgICAgICAgICAvLyBUT0RPKG1pa2VsZWhlbik6IFdlIHJlYWxseSBzaG91bGQganVzdCB1c2UgZGlzcGF0Y2hJZk5vdENsb3NlZFxuICAgICAgICAgICAgLy8gYW5kIGxldCB0aGlzIGRpc3BhdGNoIG9udG8gdGhlIHF1ZXVlLCBidXQgdGhhdCBvcGVuZWQgYSBzcGVjIHRlc3QgY2FuXG4gICAgICAgICAgICAvLyBvZiB3b3JtcyB0aGF0IEkgZG9uJ3Qgd2FudCB0byBkZWFsIHdpdGggaW4gdGhpcyBQUi5cbiAgICAgICAgICAgIHRoaXMuc3IgPT09IGUgJiYgXG4gICAgICAgICAgICAvLyBOb3JtYWxseSB3ZSdkIGhhdmUgdG8gc2NoZWR1bGUgdGhlIGNhbGxiYWNrIG9uIHRoZSBBc3luY1F1ZXVlLlxuICAgICAgICAgICAgLy8gSG93ZXZlciwgdGhlIGZvbGxvd2luZyBjYWxscyBhcmUgc2FmZSB0byBiZSBjYWxsZWQgb3V0c2lkZSB0aGVcbiAgICAgICAgICAgIC8vIEFzeW5jUXVldWUgc2luY2UgdGhleSBkb24ndCBjaGFpbiBhc3luY2hyb25vdXMgY2FsbHNcbiAgICAgICAgICAgIHRoaXMueXIodCk7XG4gICAgICAgIH0pLCAoZSA9PiB7XG4gICAgICAgICAgICB0KCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IG5ldyBLKHEuVU5LTk9XTiwgXCJGZXRjaGluZyBhdXRoIHRva2VuIGZhaWxlZDogXCIgKyBlLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnByKHQpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHlyKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuZ3IodGhpcy5zcik7XG4gICAgICAgIHRoaXMuc3RyZWFtID0gdGhpcy5Fcih0KSwgdGhpcy5zdHJlYW0uU2koKCgpID0+IHtcbiAgICAgICAgICAgIGUoKCgpID0+ICh0aGlzLnN0YXRlID0gMiAvKiBPcGVuICovICwgdGhpcy5saXN0ZW5lci5TaSgpKSkpO1xuICAgICAgICB9KSksIHRoaXMuc3RyZWFtLkNpKCh0ID0+IHtcbiAgICAgICAgICAgIGUoKCgpID0+IHRoaXMucHIodCkpKTtcbiAgICAgICAgfSkpLCB0aGlzLnN0cmVhbS5vbk1lc3NhZ2UoKHQgPT4ge1xuICAgICAgICAgICAgZSgoKCkgPT4gdGhpcy5vbk1lc3NhZ2UodCkpKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB1cigpIHtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IDQgLyogQmFja29mZiAqLyAsIHRoaXMucnIuWGkoKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc3RhdGUgPSAwIC8qIEluaXRpYWwgKi8gLCB0aGlzLnN0YXJ0KCk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgLy8gVmlzaWJsZSBmb3IgdGVzdHNcbiAgICBwcih0KSB7XG4gICAgICAgIC8vIEluIHRoZW9yeSB0aGUgc3RyZWFtIGNvdWxkIGNsb3NlIGNsZWFubHksIGhvd2V2ZXIsIGluIG91ciBjdXJyZW50IG1vZGVsXG4gICAgICAgIC8vIHdlIG5ldmVyIGV4cGVjdCB0aGlzIHRvIGhhcHBlbiBiZWNhdXNlIGlmIHdlIHN0b3AgYSBzdHJlYW0gb3Vyc2VsdmVzLFxuICAgICAgICAvLyB0aGlzIGNhbGxiYWNrIHdpbGwgbmV2ZXIgYmUgY2FsbGVkLiBUbyBwcmV2ZW50IGNhc2VzIHdoZXJlIHdlIHJldHJ5XG4gICAgICAgIC8vIHdpdGhvdXQgYSBiYWNrb2ZmIGFjY2lkZW50YWxseSwgd2Ugc2V0IHRoZSBzdHJlYW0gdG8gZXJyb3IgaW4gYWxsIGNhc2VzLlxuICAgICAgICByZXR1cm4gayhcIlBlcnNpc3RlbnRTdHJlYW1cIiwgYGNsb3NlIHdpdGggZXJyb3I6ICR7dH1gKSwgdGhpcy5zdHJlYW0gPSBudWxsLCB0aGlzLmNsb3NlKDMgLyogRXJyb3IgKi8gLCB0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIFwiZGlzcGF0Y2hlclwiIGZ1bmN0aW9uIHRoYXQgZGlzcGF0Y2hlcyBvcGVyYXRpb25zIG9udG8gdGhlXG4gICAgICogQXN5bmNRdWV1ZSBidXQgb25seSBydW5zIHRoZW0gaWYgY2xvc2VDb3VudCByZW1haW5zIHVuY2hhbmdlZC4gVGhpcyBhbGxvd3NcbiAgICAgKiB1cyB0byB0dXJuIGF1dGggLyBzdHJlYW0gY2FsbGJhY2tzIGludG8gbm8tb3BzIGlmIHRoZSBzdHJlYW0gaXMgY2xvc2VkIC9cbiAgICAgKiByZS1vcGVuZWQsIGV0Yy5cbiAgICAgKi8gICAgZ3IodCkge1xuICAgICAgICByZXR1cm4gZSA9PiB7XG4gICAgICAgICAgICB0aGlzLk9lLmVucXVldWVBbmRGb3JnZXQoKCgpID0+IHRoaXMuc3IgPT09IHQgPyBlKCkgOiAoayhcIlBlcnNpc3RlbnRTdHJlYW1cIiwgXCJzdHJlYW0gY2FsbGJhY2sgc2tpcHBlZCBieSBnZXRDbG9zZUd1YXJkZWREaXNwYXRjaGVyLlwiKSwgXG4gICAgICAgICAgICBQcm9taXNlLnJlc29sdmUoKSkpKTtcbiAgICAgICAgfTtcbiAgICB9XG59XG5cbi8qKlxuICogQSBQZXJzaXN0ZW50U3RyZWFtIHRoYXQgaW1wbGVtZW50cyB0aGUgTGlzdGVuIFJQQy5cbiAqXG4gKiBPbmNlIHRoZSBMaXN0ZW4gc3RyZWFtIGhhcyBjYWxsZWQgdGhlIG9uT3BlbigpIGxpc3RlbmVyLCBhbnkgbnVtYmVyIG9mXG4gKiBsaXN0ZW4oKSBhbmQgdW5saXN0ZW4oKSBjYWxscyBjYW4gYmUgbWFkZSB0byBjb250cm9sIHdoYXQgY2hhbmdlcyB3aWxsIGJlXG4gKiBzZW50IGZyb20gdGhlIHNlcnZlciBmb3IgTGlzdGVuUmVzcG9uc2VzLlxuICovIGNsYXNzIFpyIGV4dGVuZHMgWHIge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIHMsIGkpIHtcbiAgICAgICAgc3VwZXIodCwgXCJsaXN0ZW5fc3RyZWFtX2Nvbm5lY3Rpb25fYmFja29mZlwiIC8qIExpc3RlblN0cmVhbUNvbm5lY3Rpb25CYWNrb2ZmICovICwgXCJsaXN0ZW5fc3RyZWFtX2lkbGVcIiAvKiBMaXN0ZW5TdHJlYW1JZGxlICovICwgZSwgbiwgaSksIFxuICAgICAgICB0aGlzLk4gPSBzO1xuICAgIH1cbiAgICBFcih0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5yLmppKFwiTGlzdGVuXCIsIHQpO1xuICAgIH1cbiAgICBvbk1lc3NhZ2UodCkge1xuICAgICAgICAvLyBBIHN1Y2Nlc3NmdWwgcmVzcG9uc2UgbWVhbnMgdGhlIHN0cmVhbSBpcyBoZWFsdGh5XG4gICAgICAgIHRoaXMucnIucmVzZXQoKTtcbiAgICAgICAgY29uc3QgZSA9IGVzKHRoaXMuTiwgdCksIG4gPSBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAvLyBXZSBoYXZlIG9ubHkgcmVhY2hlZCBhIGNvbnNpc3RlbnQgc25hcHNob3QgZm9yIHRoZSBlbnRpcmUgc3RyZWFtIGlmIHRoZXJlXG4gICAgICAgICAgICAvLyBpcyBhIHJlYWRfdGltZSBzZXQgYW5kIGl0IGFwcGxpZXMgdG8gYWxsIHRhcmdldHMgKGkuZS4gdGhlIGxpc3Qgb2ZcbiAgICAgICAgICAgIC8vIHRhcmdldHMgaXMgZW1wdHkpLiBUaGUgYmFja2VuZCBpcyBndWFyYW50ZWVkIHRvIHNlbmQgc3VjaCByZXNwb25zZXMuXG4gICAgICAgICAgICBpZiAoIShcInRhcmdldENoYW5nZVwiIGluIHQpKSByZXR1cm4gaXQubWluKCk7XG4gICAgICAgICAgICBjb25zdCBlID0gdC50YXJnZXRDaGFuZ2U7XG4gICAgICAgICAgICByZXR1cm4gZS50YXJnZXRJZHMgJiYgZS50YXJnZXRJZHMubGVuZ3RoID8gaXQubWluKCkgOiBlLnJlYWRUaW1lID8gS24oZS5yZWFkVGltZSkgOiBpdC5taW4oKTtcbiAgICAgICAgfSh0KTtcbiAgICAgICAgcmV0dXJuIHRoaXMubGlzdGVuZXIuVHIoZSwgbik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlZ2lzdGVycyBpbnRlcmVzdCBpbiB0aGUgcmVzdWx0cyBvZiB0aGUgZ2l2ZW4gdGFyZ2V0LiBJZiB0aGUgdGFyZ2V0XG4gICAgICogaW5jbHVkZXMgYSByZXN1bWVUb2tlbiBpdCB3aWxsIGJlIGluY2x1ZGVkIGluIHRoZSByZXF1ZXN0LiBSZXN1bHRzIHRoYXRcbiAgICAgKiBhZmZlY3QgdGhlIHRhcmdldCB3aWxsIGJlIHN0cmVhbWVkIGJhY2sgYXMgV2F0Y2hDaGFuZ2UgbWVzc2FnZXMgdGhhdFxuICAgICAqIHJlZmVyZW5jZSB0aGUgdGFyZ2V0SWQuXG4gICAgICovICAgIElyKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHt9O1xuICAgICAgICBlLmRhdGFiYXNlID0gSm4odGhpcy5OKSwgZS5hZGRUYXJnZXQgPSBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBsZXQgbjtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBlLnRhcmdldDtcbiAgICAgICAgICAgIHJldHVybiBuID0genQocykgPyB7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnRzOiBycyh0LCBzKVxuICAgICAgICAgICAgfSA6IHtcbiAgICAgICAgICAgICAgICBxdWVyeTogb3ModCwgcylcbiAgICAgICAgICAgIH0sIG4udGFyZ2V0SWQgPSBlLnRhcmdldElkLCBlLnJlc3VtZVRva2VuLmFwcHJveGltYXRlQnl0ZVNpemUoKSA+IDAgPyBuLnJlc3VtZVRva2VuID0gVW4odCwgZS5yZXN1bWVUb2tlbikgOiBlLnNuYXBzaG90VmVyc2lvbi5jb21wYXJlVG8oaXQubWluKCkpID4gMCAmJiAoXG4gICAgICAgICAgICAvLyBUT0RPKHd1YW5keSk6IENvbnNpZGVyIHJlbW92aW5nIGFib3ZlIGNoZWNrIGJlY2F1c2UgaXQgaXMgbW9zdCBsaWtlbHkgdHJ1ZS5cbiAgICAgICAgICAgIC8vIFJpZ2h0IG5vdywgbWFueSB0ZXN0cyBkZXBlbmQgb24gdGhpcyBiZWhhdmlvdXIgdGhvdWdoIChsZWF2aW5nIG1pbigpIG91dFxuICAgICAgICAgICAgLy8gb2Ygc2VyaWFsaXphdGlvbikuXG4gICAgICAgICAgICBuLnJlYWRUaW1lID0gQm4odCwgZS5zbmFwc2hvdFZlcnNpb24udG9UaW1lc3RhbXAoKSkpLCBuO1xuICAgICAgICB9KHRoaXMuTiwgdCk7XG4gICAgICAgIGNvbnN0IG4gPSBjcyh0aGlzLk4sIHQpO1xuICAgICAgICBuICYmIChlLmxhYmVscyA9IG4pLCB0aGlzLndyKGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBVbnJlZ2lzdGVycyBpbnRlcmVzdCBpbiB0aGUgcmVzdWx0cyBvZiB0aGUgdGFyZ2V0IGFzc29jaWF0ZWQgd2l0aCB0aGVcbiAgICAgKiBnaXZlbiB0YXJnZXRJZC5cbiAgICAgKi8gICAgQXIodCkge1xuICAgICAgICBjb25zdCBlID0ge307XG4gICAgICAgIGUuZGF0YWJhc2UgPSBKbih0aGlzLk4pLCBlLnJlbW92ZVRhcmdldCA9IHQsIHRoaXMud3IoZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEEgU3RyZWFtIHRoYXQgaW1wbGVtZW50cyB0aGUgV3JpdGUgUlBDLlxuICpcbiAqIFRoZSBXcml0ZSBSUEMgcmVxdWlyZXMgdGhlIGNhbGxlciB0byBtYWludGFpbiBzcGVjaWFsIHN0cmVhbVRva2VuXG4gKiBzdGF0ZSBpbiBiZXR3ZWVuIGNhbGxzLCB0byBoZWxwIHRoZSBzZXJ2ZXIgdW5kZXJzdGFuZCB3aGljaCByZXNwb25zZXMgdGhlXG4gKiBjbGllbnQgaGFzIHByb2Nlc3NlZCBieSB0aGUgdGltZSB0aGUgbmV4dCByZXF1ZXN0IGlzIG1hZGUuIEV2ZXJ5IHJlc3BvbnNlXG4gKiB3aWxsIGNvbnRhaW4gYSBzdHJlYW1Ub2tlbjsgdGhpcyB2YWx1ZSBtdXN0IGJlIHBhc3NlZCB0byB0aGUgbmV4dFxuICogcmVxdWVzdC5cbiAqXG4gKiBBZnRlciBjYWxsaW5nIHN0YXJ0KCkgb24gdGhpcyBzdHJlYW0sIHRoZSBuZXh0IHJlcXVlc3QgbXVzdCBiZSBhIGhhbmRzaGFrZSxcbiAqIGNvbnRhaW5pbmcgd2hhdGV2ZXIgc3RyZWFtVG9rZW4gaXMgb24gaGFuZC4gT25jZSBhIHJlc3BvbnNlIHRvIHRoaXNcbiAqIHJlcXVlc3QgaXMgcmVjZWl2ZWQsIGFsbCBwZW5kaW5nIG11dGF0aW9ucyBtYXkgYmUgc3VibWl0dGVkLiBXaGVuXG4gKiBzdWJtaXR0aW5nIG11bHRpcGxlIGJhdGNoZXMgb2YgbXV0YXRpb25zIGF0IHRoZSBzYW1lIHRpbWUsIGl0J3NcbiAqIG9rYXkgdG8gdXNlIHRoZSBzYW1lIHN0cmVhbVRva2VuIGZvciB0aGUgY2FsbHMgdG8gd3JpdGVNdXRhdGlvbnMuXG4gKlxuICogVE9ETyhiLzMzMjcxMjM1KTogVXNlIHByb3RvIHR5cGVzXG4gKi8gY2xhc3MgdG8gZXh0ZW5kcyBYciB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcywgaSkge1xuICAgICAgICBzdXBlcih0LCBcIndyaXRlX3N0cmVhbV9jb25uZWN0aW9uX2JhY2tvZmZcIiAvKiBXcml0ZVN0cmVhbUNvbm5lY3Rpb25CYWNrb2ZmICovICwgXCJ3cml0ZV9zdHJlYW1faWRsZVwiIC8qIFdyaXRlU3RyZWFtSWRsZSAqLyAsIGUsIG4sIGkpLCBcbiAgICAgICAgdGhpcy5OID0gcywgdGhpcy5SciA9ICExO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUcmFja3Mgd2hldGhlciBvciBub3QgYSBoYW5kc2hha2UgaGFzIGJlZW4gc3VjY2Vzc2Z1bGx5IGV4Y2hhbmdlZCBhbmRcbiAgICAgKiB0aGUgc3RyZWFtIGlzIHJlYWR5IHRvIGFjY2VwdCBtdXRhdGlvbnMuXG4gICAgICovICAgIGdldCBQcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuUnI7XG4gICAgfVxuICAgIC8vIE92ZXJyaWRlIG9mIFBlcnNpc3RlbnRTdHJlYW0uc3RhcnRcbiAgICBzdGFydCgpIHtcbiAgICAgICAgdGhpcy5SciA9ICExLCB0aGlzLmxhc3RTdHJlYW1Ub2tlbiA9IHZvaWQgMCwgc3VwZXIuc3RhcnQoKTtcbiAgICB9XG4gICAgbXIoKSB7XG4gICAgICAgIHRoaXMuUnIgJiYgdGhpcy5icihbXSk7XG4gICAgfVxuICAgIEVyKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubnIuamkoXCJXcml0ZVwiLCB0KTtcbiAgICB9XG4gICAgb25NZXNzYWdlKHQpIHtcbiAgICAgICAgaWYgKFxuICAgICAgICAvLyBBbHdheXMgY2FwdHVyZSB0aGUgbGFzdCBzdHJlYW0gdG9rZW4uXG4gICAgICAgIEwoISF0LnN0cmVhbVRva2VuKSwgdGhpcy5sYXN0U3RyZWFtVG9rZW4gPSB0LnN0cmVhbVRva2VuLCB0aGlzLlJyKSB7XG4gICAgICAgICAgICAvLyBBIHN1Y2Nlc3NmdWwgZmlyc3Qgd3JpdGUgcmVzcG9uc2UgbWVhbnMgdGhlIHN0cmVhbSBpcyBoZWFsdGh5LFxuICAgICAgICAgICAgLy8gTm90ZSwgdGhhdCB3ZSBjb3VsZCBjb25zaWRlciBhIHN1Y2Nlc3NmdWwgaGFuZHNoYWtlIGhlYWx0aHksIGhvd2V2ZXIsXG4gICAgICAgICAgICAvLyB0aGUgd3JpdGUgaXRzZWxmIG1pZ2h0IGJlIGNhdXNpbmcgYW4gZXJyb3Igd2Ugd2FudCB0byBiYWNrIG9mZiBmcm9tLlxuICAgICAgICAgICAgdGhpcy5yci5yZXNldCgpO1xuICAgICAgICAgICAgY29uc3QgZSA9IGlzKHQud3JpdGVSZXN1bHRzLCB0LmNvbW1pdFRpbWUpLCBuID0gS24odC5jb21taXRUaW1lKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmxpc3RlbmVyLnZyKG4sIGUpO1xuICAgICAgICB9XG4gICAgICAgIC8vIFRoZSBmaXJzdCByZXNwb25zZSBpcyBhbHdheXMgdGhlIGhhbmRzaGFrZSByZXNwb25zZVxuICAgICAgICByZXR1cm4gTCghdC53cml0ZVJlc3VsdHMgfHwgMCA9PT0gdC53cml0ZVJlc3VsdHMubGVuZ3RoKSwgdGhpcy5SciA9ICEwLCB0aGlzLmxpc3RlbmVyLlZyKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlbmRzIGFuIGluaXRpYWwgc3RyZWFtVG9rZW4gdG8gdGhlIHNlcnZlciwgcGVyZm9ybWluZyB0aGUgaGFuZHNoYWtlXG4gICAgICogcmVxdWlyZWQgdG8gbWFrZSB0aGUgU3RyZWFtaW5nV3JpdGUgUlBDIHdvcmsuIFN1YnNlcXVlbnRcbiAgICAgKiBjYWxscyBzaG91bGQgd2FpdCB1bnRpbCBvbkhhbmRzaGFrZUNvbXBsZXRlIHdhcyBjYWxsZWQuXG4gICAgICovICAgIFNyKCkge1xuICAgICAgICAvLyBUT0RPKGRpbW9uZCk6IFN1cHBvcnQgc3RyZWFtIHJlc3VtcHRpb24uIFdlIGludGVudGlvbmFsbHkgZG8gbm90IHNldCB0aGVcbiAgICAgICAgLy8gc3RyZWFtIHRva2VuIG9uIHRoZSBoYW5kc2hha2UsIGlnbm9yaW5nIGFueSBzdHJlYW0gdG9rZW4gd2UgbWlnaHQgaGF2ZS5cbiAgICAgICAgY29uc3QgdCA9IHt9O1xuICAgICAgICB0LmRhdGFiYXNlID0gSm4odGhpcy5OKSwgdGhpcy53cih0KTtcbiAgICB9XG4gICAgLyoqIFNlbmRzIGEgZ3JvdXAgb2YgbXV0YXRpb25zIHRvIHRoZSBGaXJlc3RvcmUgYmFja2VuZCB0byBhcHBseS4gKi8gICAgYnIodCkge1xuICAgICAgICBjb25zdCBlID0ge1xuICAgICAgICAgICAgc3RyZWFtVG9rZW46IHRoaXMubGFzdFN0cmVhbVRva2VuLFxuICAgICAgICAgICAgd3JpdGVzOiB0Lm1hcCgodCA9PiBucyh0aGlzLk4sIHQpKSlcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy53cihlKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIERhdGFzdG9yZSBhbmQgaXRzIHJlbGF0ZWQgbWV0aG9kcyBhcmUgYSB3cmFwcGVyIGFyb3VuZCB0aGUgZXh0ZXJuYWwgR29vZ2xlXG4gKiBDbG91ZCBEYXRhc3RvcmUgZ3JwYyBBUEksIHdoaWNoIHByb3ZpZGVzIGFuIGludGVyZmFjZSB0aGF0IGlzIG1vcmUgY29udmVuaWVudFxuICogZm9yIHRoZSByZXN0IG9mIHRoZSBjbGllbnQgU0RLIGFyY2hpdGVjdHVyZSB0byBjb25zdW1lLlxuICovXG4vKipcbiAqIEFuIGltcGxlbWVudGF0aW9uIG9mIERhdGFzdG9yZSB0aGF0IGV4cG9zZXMgYWRkaXRpb25hbCBzdGF0ZSBmb3IgaW50ZXJuYWxcbiAqIGNvbnN1bXB0aW9uLlxuICovXG5jbGFzcyBlbyBleHRlbmRzIGNsYXNzIHt9IHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMuY3JlZGVudGlhbHMgPSB0LCB0aGlzLm5yID0gZSwgdGhpcy5OID0gbiwgdGhpcy5EciA9ICExO1xuICAgIH1cbiAgICBDcigpIHtcbiAgICAgICAgaWYgKHRoaXMuRHIpIHRocm93IG5ldyBLKHEuRkFJTEVEX1BSRUNPTkRJVElPTiwgXCJUaGUgY2xpZW50IGhhcyBhbHJlYWR5IGJlZW4gdGVybWluYXRlZC5cIik7XG4gICAgfVxuICAgIC8qKiBHZXRzIGFuIGF1dGggdG9rZW4gYW5kIGludm9rZXMgdGhlIHByb3ZpZGVkIFJQQy4gKi8gICAgTGkodCwgZSwgbikge1xuICAgICAgICByZXR1cm4gdGhpcy5DcigpLCB0aGlzLmNyZWRlbnRpYWxzLmdldFRva2VuKCkudGhlbigocyA9PiB0aGlzLm5yLkxpKHQsIGUsIG4sIHMpKSkuY2F0Y2goKHQgPT4ge1xuICAgICAgICAgICAgdGhyb3cgXCJGaXJlYmFzZUVycm9yXCIgPT09IHQubmFtZSA/ICh0LmNvZGUgPT09IHEuVU5BVVRIRU5USUNBVEVEICYmIHRoaXMuY3JlZGVudGlhbHMuaW52YWxpZGF0ZVRva2VuKCksIFxuICAgICAgICAgICAgdCkgOiBuZXcgSyhxLlVOS05PV04sIHQudG9TdHJpbmcoKSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgLyoqIEdldHMgYW4gYXV0aCB0b2tlbiBhbmQgaW52b2tlcyB0aGUgcHJvdmlkZWQgUlBDIHdpdGggc3RyZWFtZWQgcmVzdWx0cy4gKi8gICAgS2kodCwgZSwgbikge1xuICAgICAgICByZXR1cm4gdGhpcy5DcigpLCB0aGlzLmNyZWRlbnRpYWxzLmdldFRva2VuKCkudGhlbigocyA9PiB0aGlzLm5yLktpKHQsIGUsIG4sIHMpKSkuY2F0Y2goKHQgPT4ge1xuICAgICAgICAgICAgdGhyb3cgXCJGaXJlYmFzZUVycm9yXCIgPT09IHQubmFtZSA/ICh0LmNvZGUgPT09IHEuVU5BVVRIRU5USUNBVEVEICYmIHRoaXMuY3JlZGVudGlhbHMuaW52YWxpZGF0ZVRva2VuKCksIFxuICAgICAgICAgICAgdCkgOiBuZXcgSyhxLlVOS05PV04sIHQudG9TdHJpbmcoKSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdGVybWluYXRlKCkge1xuICAgICAgICB0aGlzLkRyID0gITA7XG4gICAgfVxufVxuXG4vLyBUT0RPKGZpcmVzdG9yZXhwKTogTWFrZSBzdXJlIHRoZXJlIGlzIG9ubHkgb25lIERhdGFzdG9yZSBpbnN0YW5jZSBwZXJcbi8vIGZpcmVzdG9yZS1leHAgY2xpZW50LlxuLyoqXG4gKiBBIGNvbXBvbmVudCB1c2VkIGJ5IHRoZSBSZW1vdGVTdG9yZSB0byB0cmFjayB0aGUgT25saW5lU3RhdGUgKHRoYXQgaXMsXG4gKiB3aGV0aGVyIG9yIG5vdCB0aGUgY2xpZW50IGFzIGEgd2hvbGUgc2hvdWxkIGJlIGNvbnNpZGVyZWQgdG8gYmUgb25saW5lIG9yXG4gKiBvZmZsaW5lKSwgaW1wbGVtZW50aW5nIHRoZSBhcHByb3ByaWF0ZSBoZXVyaXN0aWNzLlxuICpcbiAqIEluIHBhcnRpY3VsYXIsIHdoZW4gdGhlIGNsaWVudCBpcyB0cnlpbmcgdG8gY29ubmVjdCB0byB0aGUgYmFja2VuZCwgd2VcbiAqIGFsbG93IHVwIHRvIE1BWF9XQVRDSF9TVFJFQU1fRkFJTFVSRVMgd2l0aGluIE9OTElORV9TVEFURV9USU1FT1VUX01TIGZvclxuICogYSBjb25uZWN0aW9uIHRvIHN1Y2NlZWQuIElmIHdlIGhhdmUgdG9vIG1hbnkgZmFpbHVyZXMgb3IgdGhlIHRpbWVvdXQgZWxhcHNlcyxcbiAqIHRoZW4gd2Ugc2V0IHRoZSBPbmxpbmVTdGF0ZSB0byBPZmZsaW5lLCBhbmQgdGhlIGNsaWVudCB3aWxsIGJlaGF2ZSBhcyBpZlxuICogaXQgaXMgb2ZmbGluZSAoZ2V0KClzIHdpbGwgcmV0dXJuIGNhY2hlZCBkYXRhLCBldGMuKS5cbiAqL1xuY2xhc3Mgbm8ge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5hc3luY1F1ZXVlID0gdCwgdGhpcy5vbmxpbmVTdGF0ZUhhbmRsZXIgPSBlLCBcbiAgICAgICAgLyoqIFRoZSBjdXJyZW50IE9ubGluZVN0YXRlLiAqL1xuICAgICAgICB0aGlzLnN0YXRlID0gXCJVbmtub3duXCIgLyogVW5rbm93biAqLyAsIFxuICAgICAgICAvKipcbiAgICAgICAgICogQSBjb3VudCBvZiBjb25zZWN1dGl2ZSBmYWlsdXJlcyB0byBvcGVuIHRoZSBzdHJlYW0uIElmIGl0IHJlYWNoZXMgdGhlXG4gICAgICAgICAqIG1heGltdW0gZGVmaW5lZCBieSBNQVhfV0FUQ0hfU1RSRUFNX0ZBSUxVUkVTLCB3ZSdsbCBzZXQgdGhlIE9ubGluZVN0YXRlIHRvXG4gICAgICAgICAqIE9mZmxpbmUuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLk5yID0gMCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIHRpbWVyIHRoYXQgZWxhcHNlcyBhZnRlciBPTkxJTkVfU1RBVEVfVElNRU9VVF9NUywgYXQgd2hpY2ggcG9pbnQgd2VcbiAgICAgICAgICogdHJhbnNpdGlvbiBmcm9tIE9ubGluZVN0YXRlLlVua25vd24gdG8gT25saW5lU3RhdGUuT2ZmbGluZSB3aXRob3V0IHdhaXRpbmdcbiAgICAgICAgICogZm9yIHRoZSBzdHJlYW0gdG8gYWN0dWFsbHkgZmFpbCAoTUFYX1dBVENIX1NUUkVBTV9GQUlMVVJFUyB0aW1lcykuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmtyID0gbnVsbCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBXaGV0aGVyIHRoZSBjbGllbnQgc2hvdWxkIGxvZyBhIHdhcm5pbmcgbWVzc2FnZSBpZiBpdCBmYWlscyB0byBjb25uZWN0IHRvXG4gICAgICAgICAqIHRoZSBiYWNrZW5kIChpbml0aWFsbHkgdHJ1ZSwgY2xlYXJlZCBhZnRlciBhIHN1Y2Nlc3NmdWwgc3RyZWFtLCBvciBpZiB3ZSd2ZVxuICAgICAgICAgKiBsb2dnZWQgdGhlIG1lc3NhZ2UgYWxyZWFkeSkuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLiRyID0gITA7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxlZCBieSBSZW1vdGVTdG9yZSB3aGVuIGEgd2F0Y2ggc3RyZWFtIGlzIHN0YXJ0ZWQgKGluY2x1ZGluZyBvbiBlYWNoXG4gICAgICogYmFja29mZiBhdHRlbXB0KS5cbiAgICAgKlxuICAgICAqIElmIHRoaXMgaXMgdGhlIGZpcnN0IGF0dGVtcHQsIGl0IHNldHMgdGhlIE9ubGluZVN0YXRlIHRvIFVua25vd24gYW5kIHN0YXJ0c1xuICAgICAqIHRoZSBvbmxpbmVTdGF0ZVRpbWVyLlxuICAgICAqLyAgICBPcigpIHtcbiAgICAgICAgMCA9PT0gdGhpcy5OciAmJiAodGhpcy5GcihcIlVua25vd25cIiAvKiBVbmtub3duICovKSwgdGhpcy5rciA9IHRoaXMuYXN5bmNRdWV1ZS5lbnF1ZXVlQWZ0ZXJEZWxheShcIm9ubGluZV9zdGF0ZV90aW1lb3V0XCIgLyogT25saW5lU3RhdGVUaW1lb3V0ICovICwgMWU0LCAoKCkgPT4gKHRoaXMua3IgPSBudWxsLCBcbiAgICAgICAgdGhpcy5NcihcIkJhY2tlbmQgZGlkbid0IHJlc3BvbmQgd2l0aGluIDEwIHNlY29uZHMuXCIpLCB0aGlzLkZyKFwiT2ZmbGluZVwiIC8qIE9mZmxpbmUgKi8pLCBcbiAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkpKSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBVcGRhdGVzIG91ciBPbmxpbmVTdGF0ZSBhcyBhcHByb3ByaWF0ZSBhZnRlciB0aGUgd2F0Y2ggc3RyZWFtIHJlcG9ydHMgYVxuICAgICAqIGZhaWx1cmUuIFRoZSBmaXJzdCBmYWlsdXJlIG1vdmVzIHVzIHRvIHRoZSAnVW5rbm93bicgc3RhdGUuIFdlIHRoZW4gbWF5XG4gICAgICogYWxsb3cgbXVsdGlwbGUgZmFpbHVyZXMgKGJhc2VkIG9uIE1BWF9XQVRDSF9TVFJFQU1fRkFJTFVSRVMpIGJlZm9yZSB3ZVxuICAgICAqIGFjdHVhbGx5IHRyYW5zaXRpb24gdG8gdGhlICdPZmZsaW5lJyBzdGF0ZS5cbiAgICAgKi8gICAgTHIodCkge1xuICAgICAgICBcIk9ubGluZVwiIC8qIE9ubGluZSAqLyA9PT0gdGhpcy5zdGF0ZSA/IHRoaXMuRnIoXCJVbmtub3duXCIgLyogVW5rbm93biAqLykgOiAodGhpcy5OcisrLCBcbiAgICAgICAgdGhpcy5OciA+PSAxICYmICh0aGlzLkJyKCksIHRoaXMuTXIoYENvbm5lY3Rpb24gZmFpbGVkIDEgdGltZXMuIE1vc3QgcmVjZW50IGVycm9yOiAke3QudG9TdHJpbmcoKX1gKSwgXG4gICAgICAgIHRoaXMuRnIoXCJPZmZsaW5lXCIgLyogT2ZmbGluZSAqLykpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRXhwbGljaXRseSBzZXRzIHRoZSBPbmxpbmVTdGF0ZSB0byB0aGUgc3BlY2lmaWVkIHN0YXRlLlxuICAgICAqXG4gICAgICogTm90ZSB0aGF0IHRoaXMgcmVzZXRzIG91ciB0aW1lcnMgLyBmYWlsdXJlIGNvdW50ZXJzLCBldGMuIHVzZWQgYnkgb3VyXG4gICAgICogT2ZmbGluZSBoZXVyaXN0aWNzLCBzbyBtdXN0IG5vdCBiZSB1c2VkIGluIHBsYWNlIG9mXG4gICAgICogaGFuZGxlV2F0Y2hTdHJlYW1TdGFydCgpIGFuZCBoYW5kbGVXYXRjaFN0cmVhbUZhaWx1cmUoKS5cbiAgICAgKi8gICAgc2V0KHQpIHtcbiAgICAgICAgdGhpcy5CcigpLCB0aGlzLk5yID0gMCwgXCJPbmxpbmVcIiAvKiBPbmxpbmUgKi8gPT09IHQgJiYgKFxuICAgICAgICAvLyBXZSd2ZSBjb25uZWN0ZWQgdG8gd2F0Y2ggYXQgbGVhc3Qgb25jZS4gRG9uJ3Qgd2FybiB0aGUgZGV2ZWxvcGVyXG4gICAgICAgIC8vIGFib3V0IGJlaW5nIG9mZmxpbmUgZ29pbmcgZm9yd2FyZC5cbiAgICAgICAgdGhpcy4kciA9ICExKSwgdGhpcy5Gcih0KTtcbiAgICB9XG4gICAgRnIodCkge1xuICAgICAgICB0ICE9PSB0aGlzLnN0YXRlICYmICh0aGlzLnN0YXRlID0gdCwgdGhpcy5vbmxpbmVTdGF0ZUhhbmRsZXIodCkpO1xuICAgIH1cbiAgICBNcih0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBgQ291bGQgbm90IHJlYWNoIENsb3VkIEZpcmVzdG9yZSBiYWNrZW5kLiAke3R9XFxuVGhpcyB0eXBpY2FsbHkgaW5kaWNhdGVzIHRoYXQgeW91ciBkZXZpY2UgZG9lcyBub3QgaGF2ZSBhIGhlYWx0aHkgSW50ZXJuZXQgY29ubmVjdGlvbiBhdCB0aGUgbW9tZW50LiBUaGUgY2xpZW50IHdpbGwgb3BlcmF0ZSBpbiBvZmZsaW5lIG1vZGUgdW50aWwgaXQgaXMgYWJsZSB0byBzdWNjZXNzZnVsbHkgY29ubmVjdCB0byB0aGUgYmFja2VuZC5gO1xuICAgICAgICB0aGlzLiRyID8gKCQoZSksIHRoaXMuJHIgPSAhMSkgOiBrKFwiT25saW5lU3RhdGVUcmFja2VyXCIsIGUpO1xuICAgIH1cbiAgICBCcigpIHtcbiAgICAgICAgbnVsbCAhPT0gdGhpcy5rciAmJiAodGhpcy5rci5jYW5jZWwoKSwgdGhpcy5rciA9IG51bGwpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY2xhc3Mgc28ge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIFRoZSBsb2NhbCBzdG9yZSwgdXNlZCB0byBmaWxsIHRoZSB3cml0ZSBwaXBlbGluZSB3aXRoIG91dGJvdW5kIG11dGF0aW9ucy5cbiAgICAgKi9cbiAgICB0LCBcbiAgICAvKiogVGhlIGNsaWVudC1zaWRlIHByb3h5IGZvciBpbnRlcmFjdGluZyB3aXRoIHRoZSBiYWNrZW5kLiAqL1xuICAgIGUsIG4sIHMsIGkpIHtcbiAgICAgICAgdGhpcy5sb2NhbFN0b3JlID0gdCwgdGhpcy5kYXRhc3RvcmUgPSBlLCB0aGlzLmFzeW5jUXVldWUgPSBuLCB0aGlzLnJlbW90ZVN5bmNlciA9IHt9LCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgbGlzdCBvZiB1cCB0byBNQVhfUEVORElOR19XUklURVMgd3JpdGVzIHRoYXQgd2UgaGF2ZSBmZXRjaGVkIGZyb20gdGhlXG4gICAgICAgICAqIExvY2FsU3RvcmUgdmlhIGZpbGxXcml0ZVBpcGVsaW5lKCkgYW5kIGhhdmUgb3Igd2lsbCBzZW5kIHRvIHRoZSB3cml0ZVxuICAgICAgICAgKiBzdHJlYW0uXG4gICAgICAgICAqXG4gICAgICAgICAqIFdoZW5ldmVyIHdyaXRlUGlwZWxpbmUubGVuZ3RoID4gMCB0aGUgUmVtb3RlU3RvcmUgd2lsbCBhdHRlbXB0IHRvIHN0YXJ0IG9yXG4gICAgICAgICAqIHJlc3RhcnQgdGhlIHdyaXRlIHN0cmVhbS4gV2hlbiB0aGUgc3RyZWFtIGlzIGVzdGFibGlzaGVkIHRoZSB3cml0ZXMgaW4gdGhlXG4gICAgICAgICAqIHBpcGVsaW5lIHdpbGwgYmUgc2VudCBpbiBvcmRlci5cbiAgICAgICAgICpcbiAgICAgICAgICogV3JpdGVzIHJlbWFpbiBpbiB3cml0ZVBpcGVsaW5lIHVudGlsIHRoZXkgYXJlIGFja25vd2xlZGdlZCBieSB0aGUgYmFja2VuZFxuICAgICAgICAgKiBhbmQgdGh1cyB3aWxsIGF1dG9tYXRpY2FsbHkgYmUgcmUtc2VudCBpZiB0aGUgc3RyZWFtIGlzIGludGVycnVwdGVkIC9cbiAgICAgICAgICogcmVzdGFydGVkIGJlZm9yZSB0aGV5J3JlIGFja25vd2xlZGdlZC5cbiAgICAgICAgICpcbiAgICAgICAgICogV3JpdGUgcmVzcG9uc2VzIGZyb20gdGhlIGJhY2tlbmQgYXJlIGxpbmtlZCB0byB0aGVpciBvcmlnaW5hdGluZyByZXF1ZXN0XG4gICAgICAgICAqIHB1cmVseSBiYXNlZCBvbiBvcmRlciwgYW5kIHNvIHdlIGNhbiBqdXN0IHNoaWZ0KCkgd3JpdGVzIGZyb20gdGhlIGZyb250IG9mXG4gICAgICAgICAqIHRoZSB3cml0ZVBpcGVsaW5lIGFzIHdlIHJlY2VpdmUgcmVzcG9uc2VzLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5VciA9IFtdLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgbWFwcGluZyBvZiB3YXRjaGVkIHRhcmdldHMgdGhhdCB0aGUgY2xpZW50IGNhcmVzIGFib3V0IHRyYWNraW5nIGFuZCB0aGVcbiAgICAgICAgICogdXNlciBoYXMgZXhwbGljaXRseSBjYWxsZWQgYSAnbGlzdGVuJyBmb3IgdGhpcyB0YXJnZXQuXG4gICAgICAgICAqXG4gICAgICAgICAqIFRoZXNlIHRhcmdldHMgbWF5IG9yIG1heSBub3QgaGF2ZSBiZWVuIHNlbnQgdG8gb3IgYWNrbm93bGVkZ2VkIGJ5IHRoZVxuICAgICAgICAgKiBzZXJ2ZXIuIE9uIHJlLWVzdGFibGlzaGluZyB0aGUgbGlzdGVuIHN0cmVhbSwgdGhlc2UgdGFyZ2V0cyBzaG91bGQgYmUgc2VudFxuICAgICAgICAgKiB0byB0aGUgc2VydmVyLiBUaGUgdGFyZ2V0cyByZW1vdmVkIHdpdGggdW5saXN0ZW5zIGFyZSByZW1vdmVkIGVhZ2VybHlcbiAgICAgICAgICogd2l0aG91dCB3YWl0aW5nIGZvciBjb25maXJtYXRpb24gZnJvbSB0aGUgbGlzdGVuIHN0cmVhbS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucXIgPSBuZXcgTWFwLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgc2V0IG9mIHJlYXNvbnMgZm9yIHdoeSB0aGUgUmVtb3RlU3RvcmUgbWF5IGJlIG9mZmxpbmUuIElmIGVtcHR5LCB0aGVcbiAgICAgICAgICogUmVtb3RlU3RvcmUgbWF5IHN0YXJ0IGl0cyBuZXR3b3JrIGNvbm5lY3Rpb25zLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5LciA9IG5ldyBTZXQsIFxuICAgICAgICAvKipcbiAgICAgICAgICogRXZlbnQgaGFuZGxlcnMgdGhhdCBnZXQgY2FsbGVkIHdoZW4gdGhlIG5ldHdvcmsgaXMgZGlzYWJsZWQgb3IgZW5hYmxlZC5cbiAgICAgICAgICpcbiAgICAgICAgICogUE9SVElORyBOT1RFOiBUaGVzZSBmdW5jdGlvbnMgYXJlIHVzZWQgb24gdGhlIFdlYiBjbGllbnQgdG8gY3JlYXRlIHRoZVxuICAgICAgICAgKiB1bmRlcmx5aW5nIHN0cmVhbXMgKHRvIHN1cHBvcnQgdHJlZS1zaGFrZWFibGUgc3RyZWFtcykuIE9uIEFuZHJvaWQgYW5kIGlPUyxcbiAgICAgICAgICogdGhlIHN0cmVhbXMgYXJlIGNyZWF0ZWQgZHVyaW5nIGNvbnN0cnVjdGlvbiBvZiBSZW1vdGVTdG9yZS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuanIgPSBbXSwgdGhpcy5RciA9IGksIHRoaXMuUXIuRWkoKHQgPT4ge1xuICAgICAgICAgICAgbi5lbnF1ZXVlQW5kRm9yZ2V0KChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gUG9ydGluZyBOb3RlOiBVbmxpa2UgaU9TLCBgcmVzdGFydE5ldHdvcmsoKWAgaXMgY2FsbGVkIGV2ZW4gd2hlbiB0aGVcbiAgICAgICAgICAgICAgICAvLyBuZXR3b3JrIGJlY29tZXMgdW5yZWFjaGFibGUgYXMgd2UgZG9uJ3QgaGF2ZSBhbnkgb3RoZXIgd2F5IHRvIHRlYXJcbiAgICAgICAgICAgICAgICAvLyBkb3duIG91ciBzdHJlYW1zLlxuICAgICAgICAgICAgICAgIGZvKHRoaXMpICYmIChrKFwiUmVtb3RlU3RvcmVcIiwgXCJSZXN0YXJ0aW5nIHN0cmVhbXMgZm9yIG5ldHdvcmsgcmVhY2hhYmlsaXR5IGNoYW5nZS5cIiksIFxuICAgICAgICAgICAgICAgIGF3YWl0IGFzeW5jIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IFUodCk7XG4gICAgICAgICAgICAgICAgICAgIGUuS3IuYWRkKDQgLyogQ29ubmVjdGl2aXR5Q2hhbmdlICovKSwgYXdhaXQgcm8oZSksIGUuV3Iuc2V0KFwiVW5rbm93blwiIC8qIFVua25vd24gKi8pLCBcbiAgICAgICAgICAgICAgICAgICAgZS5Lci5kZWxldGUoNCAvKiBDb25uZWN0aXZpdHlDaGFuZ2UgKi8pLCBhd2FpdCBpbyhlKTtcbiAgICAgICAgICAgICAgICB9KHRoaXMpKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSkpLCB0aGlzLldyID0gbmV3IG5vKG4sIHMpO1xuICAgIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gaW8odCkge1xuICAgIGlmIChmbyh0KSkgZm9yIChjb25zdCBlIG9mIHQuanIpIGF3YWl0IGUoLyogZW5hYmxlZD0gKi8gITApO1xufVxuXG4vKipcbiAqIFRlbXBvcmFyaWx5IGRpc2FibGVzIHRoZSBuZXR3b3JrLiBUaGUgbmV0d29yayBjYW4gYmUgcmUtZW5hYmxlZCB1c2luZ1xuICogZW5hYmxlTmV0d29yaygpLlxuICovIGFzeW5jIGZ1bmN0aW9uIHJvKHQpIHtcbiAgICBmb3IgKGNvbnN0IGUgb2YgdC5qcikgYXdhaXQgZSgvKiBlbmFibGVkPSAqLyAhMSk7XG59XG5cbi8qKlxuICogU3RhcnRzIG5ldyBsaXN0ZW4gZm9yIHRoZSBnaXZlbiB0YXJnZXQuIFVzZXMgcmVzdW1lIHRva2VuIGlmIHByb3ZpZGVkLiBJdFxuICogaXMgYSBuby1vcCBpZiB0aGUgdGFyZ2V0IG9mIGdpdmVuIGBUYXJnZXREYXRhYCBpcyBhbHJlYWR5IGJlaW5nIGxpc3RlbmVkIHRvLlxuICovXG5mdW5jdGlvbiBvbyh0LCBlKSB7XG4gICAgY29uc3QgbiA9IFUodCk7XG4gICAgbi5xci5oYXMoZS50YXJnZXRJZCkgfHwgKFxuICAgIC8vIE1hcmsgdGhpcyBhcyBzb21ldGhpbmcgdGhlIGNsaWVudCBpcyBjdXJyZW50bHkgbGlzdGVuaW5nIGZvci5cbiAgICBuLnFyLnNldChlLnRhcmdldElkLCBlKSwgbG8obikgPyBcbiAgICAvLyBUaGUgbGlzdGVuIHdpbGwgYmUgc2VudCBpbiBvbldhdGNoU3RyZWFtT3BlblxuICAgIGhvKG4pIDogRG8obikuY3IoKSAmJiBjbyhuLCBlKSk7XG59XG5cbi8qKlxuICogUmVtb3ZlcyB0aGUgbGlzdGVuIGZyb20gc2VydmVyLiBJdCBpcyBhIG5vLW9wIGlmIHRoZSBnaXZlbiB0YXJnZXQgaWQgaXNcbiAqIG5vdCBiZWluZyBsaXN0ZW5lZCB0by5cbiAqLyBmdW5jdGlvbiBhbyh0LCBlKSB7XG4gICAgY29uc3QgbiA9IFUodCksIHMgPSBEbyhuKTtcbiAgICBuLnFyLmRlbGV0ZShlKSwgcy5jcigpICYmIHVvKG4sIGUpLCAwID09PSBuLnFyLnNpemUgJiYgKHMuY3IoKSA/IHMubHIoKSA6IGZvKG4pICYmIFxuICAgIC8vIFJldmVydCB0byBPbmxpbmVTdGF0ZS5Vbmtub3duIGlmIHRoZSB3YXRjaCBzdHJlYW0gaXMgbm90IG9wZW4gYW5kIHdlXG4gICAgLy8gaGF2ZSBubyBsaXN0ZW5lcnMsIHNpbmNlIHdpdGhvdXQgYW55IGxpc3RlbnMgdG8gc2VuZCB3ZSBjYW5ub3RcbiAgICAvLyBjb25maXJtIGlmIHRoZSBzdHJlYW0gaXMgaGVhbHRoeSBhbmQgdXBncmFkZSB0byBPbmxpbmVTdGF0ZS5PbmxpbmUuXG4gICAgbi5Xci5zZXQoXCJVbmtub3duXCIgLyogVW5rbm93biAqLykpO1xufVxuXG4vKipcbiAqIFdlIG5lZWQgdG8gaW5jcmVtZW50IHRoZSB0aGUgZXhwZWN0ZWQgbnVtYmVyIG9mIHBlbmRpbmcgcmVzcG9uc2VzIHdlJ3JlIGR1ZVxuICogZnJvbSB3YXRjaCBzbyB3ZSB3YWl0IGZvciB0aGUgYWNrIHRvIHByb2Nlc3MgYW55IG1lc3NhZ2VzIGZyb20gdGhpcyB0YXJnZXQuXG4gKi8gZnVuY3Rpb24gY28odCwgZSkge1xuICAgIHQuR3IuWShlLnRhcmdldElkKSwgRG8odCkuSXIoZSk7XG59XG5cbi8qKlxuICogV2UgbmVlZCB0byBpbmNyZW1lbnQgdGhlIGV4cGVjdGVkIG51bWJlciBvZiBwZW5kaW5nIHJlc3BvbnNlcyB3ZSdyZSBkdWVcbiAqIGZyb20gd2F0Y2ggc28gd2Ugd2FpdCBmb3IgdGhlIHJlbW92YWwgb24gdGhlIHNlcnZlciBiZWZvcmUgd2UgcHJvY2VzcyBhbnlcbiAqIG1lc3NhZ2VzIGZyb20gdGhpcyB0YXJnZXQuXG4gKi8gZnVuY3Rpb24gdW8odCwgZSkge1xuICAgIHQuR3IuWShlKSwgRG8odCkuQXIoZSk7XG59XG5cbmZ1bmN0aW9uIGhvKHQpIHtcbiAgICB0LkdyID0gbmV3IGtuKHtcbiAgICAgICAgZ2V0UmVtb3RlS2V5c0ZvclRhcmdldDogZSA9PiB0LnJlbW90ZVN5bmNlci5nZXRSZW1vdGVLZXlzRm9yVGFyZ2V0KGUpLFxuICAgICAgICBFdDogZSA9PiB0LnFyLmdldChlKSB8fCBudWxsXG4gICAgfSksIERvKHQpLnN0YXJ0KCksIHQuV3IuT3IoKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHdoZXRoZXIgdGhlIHdhdGNoIHN0cmVhbSBzaG91bGQgYmUgc3RhcnRlZCBiZWNhdXNlIGl0J3MgbmVjZXNzYXJ5XG4gKiBhbmQgaGFzIG5vdCB5ZXQgYmVlbiBzdGFydGVkLlxuICovIGZ1bmN0aW9uIGxvKHQpIHtcbiAgICByZXR1cm4gZm8odCkgJiYgIURvKHQpLmFyKCkgJiYgdC5xci5zaXplID4gMDtcbn1cblxuZnVuY3Rpb24gZm8odCkge1xuICAgIHJldHVybiAwID09PSBVKHQpLktyLnNpemU7XG59XG5cbmZ1bmN0aW9uIHdvKHQpIHtcbiAgICB0LkdyID0gdm9pZCAwO1xufVxuXG5hc3luYyBmdW5jdGlvbiBfbyh0KSB7XG4gICAgdC5xci5mb3JFYWNoKCgoZSwgbikgPT4ge1xuICAgICAgICBjbyh0LCBlKTtcbiAgICB9KSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIG1vKHQsIGUpIHtcbiAgICB3byh0KSwgXG4gICAgLy8gSWYgd2Ugc3RpbGwgbmVlZCB0aGUgd2F0Y2ggc3RyZWFtLCByZXRyeSB0aGUgY29ubmVjdGlvbi5cbiAgICBsbyh0KSA/ICh0LldyLkxyKGUpLCBobyh0KSkgOiBcbiAgICAvLyBObyBuZWVkIHRvIHJlc3RhcnQgd2F0Y2ggc3RyZWFtIGJlY2F1c2UgdGhlcmUgYXJlIG5vIGFjdGl2ZSB0YXJnZXRzLlxuICAgIC8vIFRoZSBvbmxpbmUgc3RhdGUgaXMgc2V0IHRvIHVua25vd24gYmVjYXVzZSB0aGVyZSBpcyBubyBhY3RpdmUgYXR0ZW1wdFxuICAgIC8vIGF0IGVzdGFibGlzaGluZyBhIGNvbm5lY3Rpb25cbiAgICB0LldyLnNldChcIlVua25vd25cIiAvKiBVbmtub3duICovKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gZ28odCwgZSwgbikge1xuICAgIGlmIChcbiAgICAvLyBNYXJrIHRoZSBjbGllbnQgYXMgb25saW5lIHNpbmNlIHdlIGdvdCBhIG1lc3NhZ2UgZnJvbSB0aGUgc2VydmVyXG4gICAgdC5Xci5zZXQoXCJPbmxpbmVcIiAvKiBPbmxpbmUgKi8pLCBlIGluc3RhbmNlb2YgTm4gJiYgMiAvKiBSZW1vdmVkICovID09PSBlLnN0YXRlICYmIGUuY2F1c2UpIFxuICAgIC8vIFRoZXJlIHdhcyBhbiBlcnJvciBvbiBhIHRhcmdldCwgZG9uJ3Qgd2FpdCBmb3IgYSBjb25zaXN0ZW50IHNuYXBzaG90XG4gICAgLy8gdG8gcmFpc2UgZXZlbnRzXG4gICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgXG4gICAgICAgIC8qKiBIYW5kbGVzIGFuIGVycm9yIG9uIGEgdGFyZ2V0ICovXG4gICAgICAgIGFzeW5jIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBlLmNhdXNlO1xuICAgICAgICAgICAgZm9yIChjb25zdCBzIG9mIGUudGFyZ2V0SWRzKSBcbiAgICAgICAgICAgIC8vIEEgd2F0Y2hlZCB0YXJnZXQgbWlnaHQgaGF2ZSBiZWVuIHJlbW92ZWQgYWxyZWFkeS5cbiAgICAgICAgICAgIHQucXIuaGFzKHMpICYmIChhd2FpdCB0LnJlbW90ZVN5bmNlci5yZWplY3RMaXN0ZW4ocywgbiksIHQucXIuZGVsZXRlKHMpLCB0LkdyLnJlbW92ZVRhcmdldChzKSk7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gKiBBdHRlbXB0cyB0byBmaWxsIG91ciB3cml0ZSBwaXBlbGluZSB3aXRoIHdyaXRlcyBmcm9tIHRoZSBMb2NhbFN0b3JlLlxuICpcbiAqIENhbGxlZCBpbnRlcm5hbGx5IHRvIGJvb3RzdHJhcCBvciByZWZpbGwgdGhlIHdyaXRlIHBpcGVsaW5lIGFuZCBieVxuICogU3luY0VuZ2luZSB3aGVuZXZlciB0aGVyZSBhcmUgbmV3IG11dGF0aW9ucyB0byBwcm9jZXNzLlxuICpcbiAqIFN0YXJ0cyB0aGUgd3JpdGUgc3RyZWFtIGlmIG5lY2Vzc2FyeS5cbiAqLyAodCwgZSk7XG4gICAgfSBjYXRjaCAobikge1xuICAgICAgICBrKFwiUmVtb3RlU3RvcmVcIiwgXCJGYWlsZWQgdG8gcmVtb3ZlIHRhcmdldHMgJXM6ICVzIFwiLCBlLnRhcmdldElkcy5qb2luKFwiLFwiKSwgbiksIFxuICAgICAgICBhd2FpdCB5byh0LCBuKTtcbiAgICB9IGVsc2UgaWYgKGUgaW5zdGFuY2VvZiBEbiA/IHQuR3IucnQoZSkgOiBlIGluc3RhbmNlb2YgQ24gPyB0LkdyLmZ0KGUpIDogdC5Hci5jdChlKSwgXG4gICAgIW4uaXNFcXVhbChpdC5taW4oKSkpIHRyeSB7XG4gICAgICAgIGNvbnN0IGUgPSBhd2FpdCBscih0LmxvY2FsU3RvcmUpO1xuICAgICAgICBuLmNvbXBhcmVUbyhlKSA+PSAwICYmIFxuICAgICAgICAvLyBXZSBoYXZlIHJlY2VpdmVkIGEgdGFyZ2V0IGNoYW5nZSB3aXRoIGEgZ2xvYmFsIHNuYXBzaG90IGlmIHRoZSBzbmFwc2hvdFxuICAgICAgICAvLyB2ZXJzaW9uIGlzIG5vdCBlcXVhbCB0byBTbmFwc2hvdFZlcnNpb24ubWluKCkuXG4gICAgICAgIGF3YWl0IFxuICAgICAgICAvKipcbiAqIFRha2VzIGEgYmF0Y2ggb2YgY2hhbmdlcyBmcm9tIHRoZSBEYXRhc3RvcmUsIHJlcGFja2FnZXMgdGhlbSBhcyBhXG4gKiBSZW1vdGVFdmVudCwgYW5kIHBhc3NlcyB0aGF0IG9uIHRvIHRoZSBsaXN0ZW5lciwgd2hpY2ggaXMgdHlwaWNhbGx5IHRoZVxuICogU3luY0VuZ2luZS5cbiAqL1xuICAgICAgICBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gdC5Hci5fdChlKTtcbiAgICAgICAgICAgIC8vIFVwZGF0ZSBpbi1tZW1vcnkgcmVzdW1lIHRva2Vucy4gTG9jYWxTdG9yZSB3aWxsIHVwZGF0ZSB0aGVcbiAgICAgICAgICAgIC8vIHBlcnNpc3RlbnQgdmlldyBvZiB0aGVzZSB3aGVuIGFwcGx5aW5nIHRoZSBjb21wbGV0ZWQgUmVtb3RlRXZlbnQuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbi50YXJnZXRDaGFuZ2VzLmZvckVhY2goKChuLCBzKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKG4ucmVzdW1lVG9rZW4uYXBwcm94aW1hdGVCeXRlU2l6ZSgpID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gdC5xci5nZXQocyk7XG4gICAgICAgICAgICAgICAgICAgIC8vIEEgd2F0Y2hlZCB0YXJnZXQgbWlnaHQgaGF2ZSBiZWVuIHJlbW92ZWQgYWxyZWFkeS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpICYmIHQucXIuc2V0KHMsIGkud2l0aFJlc3VtZVRva2VuKG4ucmVzdW1lVG9rZW4sIGUpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSksIFxuICAgICAgICAgICAgLy8gUmUtZXN0YWJsaXNoIGxpc3RlbnMgZm9yIHRoZSB0YXJnZXRzIHRoYXQgaGF2ZSBiZWVuIGludmFsaWRhdGVkIGJ5XG4gICAgICAgICAgICAvLyBleGlzdGVuY2UgZmlsdGVyIG1pc21hdGNoZXMuXG4gICAgICAgICAgICBuLnRhcmdldE1pc21hdGNoZXMuZm9yRWFjaCgoZSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHQucXIuZ2V0KGUpO1xuICAgICAgICAgICAgICAgIGlmICghbikgXG4gICAgICAgICAgICAgICAgLy8gQSB3YXRjaGVkIHRhcmdldCBtaWdodCBoYXZlIGJlZW4gcmVtb3ZlZCBhbHJlYWR5LlxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAvLyBDbGVhciB0aGUgcmVzdW1lIHRva2VuIGZvciB0aGUgdGFyZ2V0LCBzaW5jZSB3ZSdyZSBpbiBhIGtub3duIG1pc21hdGNoXG4gICAgICAgICAgICAgICAgLy8gc3RhdGUuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQucXIuc2V0KGUsIG4ud2l0aFJlc3VtZVRva2VuKHd0LkVNUFRZX0JZVEVfU1RSSU5HLCBuLnNuYXBzaG90VmVyc2lvbikpLCBcbiAgICAgICAgICAgICAgICAvLyBDYXVzZSBhIGhhcmQgcmVzZXQgYnkgdW53YXRjaGluZyBhbmQgcmV3YXRjaGluZyBpbW1lZGlhdGVseSwgYnV0XG4gICAgICAgICAgICAgICAgLy8gZGVsaWJlcmF0ZWx5IGRvbid0IHNlbmQgYSByZXN1bWUgdG9rZW4gc28gdGhhdCB3ZSBnZXQgYSBmdWxsIHVwZGF0ZS5cbiAgICAgICAgICAgICAgICB1byh0LCBlKTtcbiAgICAgICAgICAgICAgICAvLyBNYXJrIHRoZSB0YXJnZXQgd2Ugc2VuZCBhcyBiZWluZyBvbiBiZWhhbGYgb2YgYW4gZXhpc3RlbmNlIGZpbHRlclxuICAgICAgICAgICAgICAgIC8vIG1pc21hdGNoLCBidXQgZG9uJ3QgYWN0dWFsbHkgcmV0YWluIHRoYXQgaW4gbGlzdGVuVGFyZ2V0cy4gVGhpcyBlbnN1cmVzXG4gICAgICAgICAgICAgICAgLy8gdGhhdCB3ZSBmbGFnIHRoZSBmaXJzdCByZS1saXN0ZW4gdGhpcyB3YXkgd2l0aG91dCBpbXBhY3RpbmcgZnV0dXJlXG4gICAgICAgICAgICAgICAgLy8gbGlzdGVucyBvZiB0aGlzIHRhcmdldCAodGhhdCBtaWdodCBoYXBwZW4gZS5nLiBvbiByZWNvbm5lY3QpLlxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBuZXcgc2kobi50YXJnZXQsIGUsIDEgLyogRXhpc3RlbmNlRmlsdGVyTWlzbWF0Y2ggKi8gLCBuLnNlcXVlbmNlTnVtYmVyKTtcbiAgICAgICAgICAgICAgICBjbyh0LCBzKTtcbiAgICAgICAgICAgIH0pKSwgdC5yZW1vdGVTeW5jZXIuYXBwbHlSZW1vdGVFdmVudChuKTtcbiAgICAgICAgfSh0LCBuKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGsoXCJSZW1vdGVTdG9yZVwiLCBcIkZhaWxlZCB0byByYWlzZSBzbmFwc2hvdDpcIiwgZSksIGF3YWl0IHlvKHQsIGUpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBSZWNvdmVyeSBsb2dpYyBmb3IgSW5kZXhlZERCIGVycm9ycyB0aGF0IHRha2VzIHRoZSBuZXR3b3JrIG9mZmxpbmUgdW50aWxcbiAqIGBvcGAgc3VjY2VlZHMuIFJldHJpZXMgYXJlIHNjaGVkdWxlZCB3aXRoIGJhY2tvZmYgdXNpbmdcbiAqIGBlbnF1ZXVlUmV0cnlhYmxlKClgLiBJZiBgb3AoKWAgaXMgbm90IHByb3ZpZGVkLCBJbmRleGVkREIgYWNjZXNzIGlzXG4gKiB2YWxpZGF0ZWQgdmlhIGEgZ2VuZXJpYyBvcGVyYXRpb24uXG4gKlxuICogVGhlIHJldHVybmVkIFByb21pc2UgaXMgcmVzb2x2ZWQgb25jZSB0aGUgbmV0d29yayBpcyBkaXNhYmxlZCBhbmQgYmVmb3JlXG4gKiBhbnkgcmV0cnkgYXR0ZW1wdC5cbiAqLyBhc3luYyBmdW5jdGlvbiB5byh0LCBlLCBuKSB7XG4gICAgaWYgKCF6cyhlKSkgdGhyb3cgZTtcbiAgICB0LktyLmFkZCgxIC8qIEluZGV4ZWREYkZhaWxlZCAqLyksIFxuICAgIC8vIERpc2FibGUgbmV0d29yayBhbmQgcmFpc2Ugb2ZmbGluZSBzbmFwc2hvdHNcbiAgICBhd2FpdCBybyh0KSwgdC5Xci5zZXQoXCJPZmZsaW5lXCIgLyogT2ZmbGluZSAqLyksIG4gfHwgKFxuICAgIC8vIFVzZSBhIHNpbXBsZSByZWFkIG9wZXJhdGlvbiB0byBkZXRlcm1pbmUgaWYgSW5kZXhlZERCIHJlY292ZXJlZC5cbiAgICAvLyBJZGVhbGx5LCB3ZSB3b3VsZCBleHBvc2UgYSBoZWFsdGggY2hlY2sgZGlyZWN0bHkgb24gU2ltcGxlRGIsIGJ1dFxuICAgIC8vIFJlbW90ZVN0b3JlIG9ubHkgaGFzIGFjY2VzcyB0byBwZXJzaXN0ZW5jZSB0aHJvdWdoIExvY2FsU3RvcmUuXG4gICAgbiA9ICgpID0+IGxyKHQubG9jYWxTdG9yZSkpLCBcbiAgICAvLyBQcm9iZSBJbmRleGVkREIgcGVyaW9kaWNhbGx5IGFuZCByZS1lbmFibGUgbmV0d29ya1xuICAgIHQuYXN5bmNRdWV1ZS5lbnF1ZXVlUmV0cnlhYmxlKChhc3luYyAoKSA9PiB7XG4gICAgICAgIGsoXCJSZW1vdGVTdG9yZVwiLCBcIlJldHJ5aW5nIEluZGV4ZWREQiBhY2Nlc3NcIiksIGF3YWl0IG4oKSwgdC5Lci5kZWxldGUoMSAvKiBJbmRleGVkRGJGYWlsZWQgKi8pLCBcbiAgICAgICAgYXdhaXQgaW8odCk7XG4gICAgfSkpO1xufVxuXG4vKipcbiAqIEV4ZWN1dGVzIGBvcGAuIElmIGBvcGAgZmFpbHMsIHRha2VzIHRoZSBuZXR3b3JrIG9mZmxpbmUgdW50aWwgYG9wYFxuICogc3VjY2VlZHMuIFJldHVybnMgYWZ0ZXIgdGhlIGZpcnN0IGF0dGVtcHQuXG4gKi8gZnVuY3Rpb24gcG8odCwgZSkge1xuICAgIHJldHVybiBlKCkuY2F0Y2goKG4gPT4geW8odCwgbiwgZSkpKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gRW8odCkge1xuICAgIGNvbnN0IGUgPSBVKHQpLCBuID0gQ28oZSk7XG4gICAgbGV0IHMgPSBlLlVyLmxlbmd0aCA+IDAgPyBlLlVyW2UuVXIubGVuZ3RoIC0gMV0uYmF0Y2hJZCA6IC0xO1xuICAgIGZvciAoO1RvKGUpOyApIHRyeSB7XG4gICAgICAgIGNvbnN0IHQgPSBhd2FpdCB3cihlLmxvY2FsU3RvcmUsIHMpO1xuICAgICAgICBpZiAobnVsbCA9PT0gdCkge1xuICAgICAgICAgICAgMCA9PT0gZS5Vci5sZW5ndGggJiYgbi5scigpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgcyA9IHQuYmF0Y2hJZCwgSW8oZSwgdCk7XG4gICAgfSBjYXRjaCAodCkge1xuICAgICAgICBhd2FpdCB5byhlLCB0KTtcbiAgICB9XG4gICAgQW8oZSkgJiYgUm8oZSk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIHdlIGNhbiBhZGQgdG8gdGhlIHdyaXRlIHBpcGVsaW5lIChpLmUuIHRoZSBuZXR3b3JrIGlzXG4gKiBlbmFibGVkIGFuZCB0aGUgd3JpdGUgcGlwZWxpbmUgaXMgbm90IGZ1bGwpLlxuICovIGZ1bmN0aW9uIFRvKHQpIHtcbiAgICByZXR1cm4gZm8odCkgJiYgdC5Vci5sZW5ndGggPCAxMDtcbn1cblxuLyoqXG4gKiBRdWV1ZXMgYWRkaXRpb25hbCB3cml0ZXMgdG8gYmUgc2VudCB0byB0aGUgd3JpdGUgc3RyZWFtLCBzZW5kaW5nIHRoZW1cbiAqIGltbWVkaWF0ZWx5IGlmIHRoZSB3cml0ZSBzdHJlYW0gaXMgZXN0YWJsaXNoZWQuXG4gKi8gZnVuY3Rpb24gSW8odCwgZSkge1xuICAgIHQuVXIucHVzaChlKTtcbiAgICBjb25zdCBuID0gQ28odCk7XG4gICAgbi5jcigpICYmIG4uUHIgJiYgbi5icihlLm11dGF0aW9ucyk7XG59XG5cbmZ1bmN0aW9uIEFvKHQpIHtcbiAgICByZXR1cm4gZm8odCkgJiYgIUNvKHQpLmFyKCkgJiYgdC5Vci5sZW5ndGggPiAwO1xufVxuXG5mdW5jdGlvbiBSbyh0KSB7XG4gICAgQ28odCkuc3RhcnQoKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gUG8odCkge1xuICAgIENvKHQpLlNyKCk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGJvKHQpIHtcbiAgICBjb25zdCBlID0gQ28odCk7XG4gICAgLy8gU2VuZCB0aGUgd3JpdGUgcGlwZWxpbmUgbm93IHRoYXQgdGhlIHN0cmVhbSBpcyBlc3RhYmxpc2hlZC5cbiAgICAgICAgZm9yIChjb25zdCBuIG9mIHQuVXIpIGUuYnIobi5tdXRhdGlvbnMpO1xufVxuXG5hc3luYyBmdW5jdGlvbiB2byh0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9IHQuVXIuc2hpZnQoKSwgaSA9IG5pLmZyb20ocywgZSwgbik7XG4gICAgYXdhaXQgcG8odCwgKCgpID0+IHQucmVtb3RlU3luY2VyLmFwcGx5U3VjY2Vzc2Z1bFdyaXRlKGkpKSksIFxuICAgIC8vIEl0J3MgcG9zc2libGUgdGhhdCB3aXRoIHRoZSBjb21wbGV0aW9uIG9mIHRoaXMgbXV0YXRpb24gYW5vdGhlclxuICAgIC8vIHNsb3QgaGFzIGZyZWVkIHVwLlxuICAgIGF3YWl0IEVvKHQpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBWbyh0LCBlKSB7XG4gICAgLy8gSWYgdGhlIHdyaXRlIHN0cmVhbSBjbG9zZWQgYWZ0ZXIgdGhlIHdyaXRlIGhhbmRzaGFrZSBjb21wbGV0ZXMsIGEgd3JpdGVcbiAgICAvLyBvcGVyYXRpb24gZmFpbGVkIGFuZCB3ZSBmYWlsIHRoZSBwZW5kaW5nIG9wZXJhdGlvbi5cbiAgICBlICYmIENvKHQpLlByICYmIFxuICAgIC8vIFRoaXMgZXJyb3IgYWZmZWN0cyB0aGUgYWN0dWFsIHdyaXRlLlxuICAgIGF3YWl0IGFzeW5jIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgLy8gT25seSBoYW5kbGUgcGVybWFuZW50IGVycm9ycyBoZXJlLiBJZiBpdCdzIHRyYW5zaWVudCwganVzdCBsZXQgdGhlIHJldHJ5XG4gICAgICAgIC8vIGxvZ2ljIGtpY2sgaW4uXG4gICAgICAgIGlmIChuID0gZS5jb2RlLCBsbihuKSAmJiBuICE9PSBxLkFCT1JURUQpIHtcbiAgICAgICAgICAgIC8vIFRoaXMgd2FzIGEgcGVybWFuZW50IGVycm9yLCB0aGUgcmVxdWVzdCBpdHNlbGYgd2FzIHRoZSBwcm9ibGVtXG4gICAgICAgICAgICAvLyBzbyBpdCdzIG5vdCBnb2luZyB0byBzdWNjZWVkIGlmIHdlIHJlc2VuZCBpdC5cbiAgICAgICAgICAgIGNvbnN0IG4gPSB0LlVyLnNoaWZ0KCk7XG4gICAgICAgICAgICAvLyBJbiB0aGlzIGNhc2UgaXQncyBhbHNvIHVubGlrZWx5IHRoYXQgdGhlIHNlcnZlciBpdHNlbGYgaXMgbWVsdGluZ1xuICAgICAgICAgICAgLy8gZG93biAtLSB0aGlzIHdhcyBqdXN0IGEgYmFkIHJlcXVlc3Qgc28gaW5oaWJpdCBiYWNrb2ZmIG9uIHRoZSBuZXh0XG4gICAgICAgICAgICAvLyByZXN0YXJ0LlxuICAgICAgICAgICAgICAgICAgICAgICAgQ28odCkuaHIoKSwgYXdhaXQgcG8odCwgKCgpID0+IHQucmVtb3RlU3luY2VyLnJlamVjdEZhaWxlZFdyaXRlKG4uYmF0Y2hJZCwgZSkpKSwgXG4gICAgICAgICAgICAvLyBJdCdzIHBvc3NpYmxlIHRoYXQgd2l0aCB0aGUgY29tcGxldGlvbiBvZiB0aGlzIG11dGF0aW9uXG4gICAgICAgICAgICAvLyBhbm90aGVyIHNsb3QgaGFzIGZyZWVkIHVwLlxuICAgICAgICAgICAgYXdhaXQgRW8odCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG47XG4gICAgfSh0LCBlKSwgXG4gICAgLy8gVGhlIHdyaXRlIHN0cmVhbSBtaWdodCBoYXZlIGJlZW4gc3RhcnRlZCBieSByZWZpbGxpbmcgdGhlIHdyaXRlXG4gICAgLy8gcGlwZWxpbmUgZm9yIGZhaWxlZCB3cml0ZXNcbiAgICBBbyh0KSAmJiBSbyh0KTtcbn1cblxuLyoqXG4gKiBUb2dnbGVzIHRoZSBuZXR3b3JrIHN0YXRlIHdoZW4gdGhlIGNsaWVudCBnYWlucyBvciBsb3NlcyBpdHMgcHJpbWFyeSBsZWFzZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gU28odCwgZSkge1xuICAgIGNvbnN0IG4gPSBVKHQpO1xuICAgIGUgPyAobi5Lci5kZWxldGUoMiAvKiBJc1NlY29uZGFyeSAqLyksIGF3YWl0IGlvKG4pKSA6IGUgfHwgKG4uS3IuYWRkKDIgLyogSXNTZWNvbmRhcnkgKi8pLCBcbiAgICBhd2FpdCBybyhuKSwgbi5Xci5zZXQoXCJVbmtub3duXCIgLyogVW5rbm93biAqLykpO1xufVxuXG4vKipcbiAqIElmIG5vdCB5ZXQgaW5pdGlhbGl6ZWQsIHJlZ2lzdGVycyB0aGUgV2F0Y2hTdHJlYW0gYW5kIGl0cyBuZXR3b3JrIHN0YXRlXG4gKiBjYWxsYmFjayB3aXRoIGByZW1vdGVTdG9yZUltcGxgLiBSZXR1cm5zIHRoZSBleGlzdGluZyBzdHJlYW0gaWYgb25lIGlzXG4gKiBhbHJlYWR5IGF2YWlsYWJsZS5cbiAqXG4gKiBQT1JUSU5HIE5PVEU6IE9uIGlPUyBhbmQgQW5kcm9pZCwgdGhlIFdhdGNoU3RyZWFtIGdldHMgcmVnaXN0ZXJlZCBvbiBzdGFydHVwLlxuICogVGhpcyBpcyBub3QgZG9uZSBvbiBXZWIgdG8gYWxsb3cgaXQgdG8gYmUgdHJlZS1zaGFrZW4uXG4gKi8gZnVuY3Rpb24gRG8odCkge1xuICAgIHJldHVybiB0LnpyIHx8IChcbiAgICAvLyBDcmVhdGUgc3RyZWFtIChidXQgbm90ZSB0aGF0IGl0IGlzIG5vdCBzdGFydGVkIHlldCkuXG4gICAgdC56ciA9IGZ1bmN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgY29uc3QgcyA9IFUodCk7XG4gICAgICAgIHJldHVybiBzLkNyKCksIG5ldyBacihlLCBzLm5yLCBzLmNyZWRlbnRpYWxzLCBzLk4sIG4pO1xuICAgIH1cbiAgICAvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyAodC5kYXRhc3RvcmUsIHQuYXN5bmNRdWV1ZSwge1xuICAgICAgICBTaTogX28uYmluZChudWxsLCB0KSxcbiAgICAgICAgQ2k6IG1vLmJpbmQobnVsbCwgdCksXG4gICAgICAgIFRyOiBnby5iaW5kKG51bGwsIHQpXG4gICAgfSksIHQuanIucHVzaCgoYXN5bmMgZSA9PiB7XG4gICAgICAgIGUgPyAodC56ci5ocigpLCBsbyh0KSA/IGhvKHQpIDogdC5Xci5zZXQoXCJVbmtub3duXCIgLyogVW5rbm93biAqLykpIDogKGF3YWl0IHQuenIuc3RvcCgpLCBcbiAgICAgICAgd28odCkpO1xuICAgIH0pKSksIHQuenI7XG59XG5cbi8qKlxuICogSWYgbm90IHlldCBpbml0aWFsaXplZCwgcmVnaXN0ZXJzIHRoZSBXcml0ZVN0cmVhbSBhbmQgaXRzIG5ldHdvcmsgc3RhdGVcbiAqIGNhbGxiYWNrIHdpdGggYHJlbW90ZVN0b3JlSW1wbGAuIFJldHVybnMgdGhlIGV4aXN0aW5nIHN0cmVhbSBpZiBvbmUgaXNcbiAqIGFscmVhZHkgYXZhaWxhYmxlLlxuICpcbiAqIFBPUlRJTkcgTk9URTogT24gaU9TIGFuZCBBbmRyb2lkLCB0aGUgV3JpdGVTdHJlYW0gZ2V0cyByZWdpc3RlcmVkIG9uIHN0YXJ0dXAuXG4gKiBUaGlzIGlzIG5vdCBkb25lIG9uIFdlYiB0byBhbGxvdyBpdCB0byBiZSB0cmVlLXNoYWtlbi5cbiAqLyBmdW5jdGlvbiBDbyh0KSB7XG4gICAgcmV0dXJuIHQuSHIgfHwgKFxuICAgIC8vIENyZWF0ZSBzdHJlYW0gKGJ1dCBub3RlIHRoYXQgaXQgaXMgbm90IHN0YXJ0ZWQgeWV0KS5cbiAgICB0LkhyID0gZnVuY3Rpb24odCwgZSwgbikge1xuICAgICAgICBjb25zdCBzID0gVSh0KTtcbiAgICAgICAgcmV0dXJuIHMuQ3IoKSwgbmV3IHRvKGUsIHMubnIsIHMuY3JlZGVudGlhbHMsIHMuTiwgbik7XG4gICAgfSh0LmRhdGFzdG9yZSwgdC5hc3luY1F1ZXVlLCB7XG4gICAgICAgIFNpOiBQby5iaW5kKG51bGwsIHQpLFxuICAgICAgICBDaTogVm8uYmluZChudWxsLCB0KSxcbiAgICAgICAgVnI6IGJvLmJpbmQobnVsbCwgdCksXG4gICAgICAgIHZyOiB2by5iaW5kKG51bGwsIHQpXG4gICAgfSksIHQuanIucHVzaCgoYXN5bmMgZSA9PiB7XG4gICAgICAgIGUgPyAodC5Ici5ocigpLCBcbiAgICAgICAgLy8gVGhpcyB3aWxsIHN0YXJ0IHRoZSB3cml0ZSBzdHJlYW0gaWYgbmVjZXNzYXJ5LlxuICAgICAgICBhd2FpdCBFbyh0KSkgOiAoYXdhaXQgdC5Ici5zdG9wKCksIHQuVXIubGVuZ3RoID4gMCAmJiAoayhcIlJlbW90ZVN0b3JlXCIsIGBTdG9wcGluZyB3cml0ZSBzdHJlYW0gd2l0aCAke3QuVXIubGVuZ3RofSBwZW5kaW5nIHdyaXRlc2ApLCBcbiAgICAgICAgdC5VciA9IFtdKSk7XG4gICAgfSkpKSwgdC5Icjtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUmVwcmVzZW50cyBhbiBvcGVyYXRpb24gc2NoZWR1bGVkIHRvIGJlIHJ1biBpbiB0aGUgZnV0dXJlIG9uIGFuIEFzeW5jUXVldWUuXG4gKlxuICogSXQgaXMgY3JlYXRlZCB2aWEgRGVsYXllZE9wZXJhdGlvbi5jcmVhdGVBbmRTY2hlZHVsZSgpLlxuICpcbiAqIFN1cHBvcnRzIGNhbmNlbGxhdGlvbiAodmlhIGNhbmNlbCgpKSBhbmQgZWFybHkgZXhlY3V0aW9uICh2aWEgc2tpcERlbGF5KCkpLlxuICpcbiAqIE5vdGU6IFdlIGltcGxlbWVudCBgUHJvbWlzZUxpa2VgIGluc3RlYWQgb2YgYFByb21pc2VgLCBhcyB0aGUgYFByb21pc2VgIHR5cGVcbiAqIGluIG5ld2VyIHZlcnNpb25zIG9mIFR5cGVTY3JpcHQgZGVmaW5lcyBgZmluYWxseWAsIHdoaWNoIGlzIG5vdCBhdmFpbGFibGUgaW5cbiAqIElFLlxuICovXG5jbGFzcyBObyB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcywgaSkge1xuICAgICAgICB0aGlzLmFzeW5jUXVldWUgPSB0LCB0aGlzLnRpbWVySWQgPSBlLCB0aGlzLnRhcmdldFRpbWVNcyA9IG4sIHRoaXMub3AgPSBzLCB0aGlzLnJlbW92YWxDYWxsYmFjayA9IGksIFxuICAgICAgICB0aGlzLmRlZmVycmVkID0gbmV3IGosIHRoaXMudGhlbiA9IHRoaXMuZGVmZXJyZWQucHJvbWlzZS50aGVuLmJpbmQodGhpcy5kZWZlcnJlZC5wcm9taXNlKSwgXG4gICAgICAgIC8vIEl0J3Mgbm9ybWFsIGZvciB0aGUgZGVmZXJyZWQgcHJvbWlzZSB0byBiZSBjYW5jZWxlZCAoZHVlIHRvIGNhbmNlbGxhdGlvbilcbiAgICAgICAgLy8gYW5kIHNvIHdlIGF0dGFjaCBhIGR1bW15IGNhdGNoIGNhbGxiYWNrIHRvIGF2b2lkXG4gICAgICAgIC8vICdVbmhhbmRsZWRQcm9taXNlUmVqZWN0aW9uV2FybmluZycgbG9nIHNwYW0uXG4gICAgICAgIHRoaXMuZGVmZXJyZWQucHJvbWlzZS5jYXRjaCgodCA9PiB7fSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCByZXR1cm5zIGEgRGVsYXllZE9wZXJhdGlvbiB0aGF0IGhhcyBiZWVuIHNjaGVkdWxlZCB0byBiZVxuICAgICAqIGV4ZWN1dGVkIG9uIHRoZSBwcm92aWRlZCBhc3luY1F1ZXVlIGFmdGVyIHRoZSBwcm92aWRlZCBkZWxheU1zLlxuICAgICAqXG4gICAgICogQHBhcmFtIGFzeW5jUXVldWUgLSBUaGUgcXVldWUgdG8gc2NoZWR1bGUgdGhlIG9wZXJhdGlvbiBvbi5cbiAgICAgKiBAcGFyYW0gaWQgLSBBIFRpbWVyIElEIGlkZW50aWZ5aW5nIHRoZSB0eXBlIG9mIG9wZXJhdGlvbiB0aGlzIGlzLlxuICAgICAqIEBwYXJhbSBkZWxheU1zIC0gVGhlIGRlbGF5IChtcykgYmVmb3JlIHRoZSBvcGVyYXRpb24gc2hvdWxkIGJlIHNjaGVkdWxlZC5cbiAgICAgKiBAcGFyYW0gb3AgLSBUaGUgb3BlcmF0aW9uIHRvIHJ1bi5cbiAgICAgKiBAcGFyYW0gcmVtb3ZhbENhbGxiYWNrIC0gQSBjYWxsYmFjayB0byBiZSBjYWxsZWQgc3luY2hyb25vdXNseSBvbmNlIHRoZVxuICAgICAqICAgb3BlcmF0aW9uIGlzIGV4ZWN1dGVkIG9yIGNhbmNlbGVkLCBub3RpZnlpbmcgdGhlIEFzeW5jUXVldWUgdG8gcmVtb3ZlIGl0XG4gICAgICogICBmcm9tIGl0cyBkZWxheWVkT3BlcmF0aW9ucyBsaXN0LlxuICAgICAqICAgUE9SVElORyBOT1RFOiBUaGlzIGV4aXN0cyB0byBwcmV2ZW50IG1ha2luZyByZW1vdmVEZWxheWVkT3BlcmF0aW9uKCkgYW5kXG4gICAgICogICB0aGUgRGVsYXllZE9wZXJhdGlvbiBjbGFzcyBwdWJsaWMuXG4gICAgICovICAgIHN0YXRpYyBjcmVhdGVBbmRTY2hlZHVsZSh0LCBlLCBuLCBzLCBpKSB7XG4gICAgICAgIGNvbnN0IHIgPSBEYXRlLm5vdygpICsgbiwgbyA9IG5ldyBObyh0LCBlLCByLCBzLCBpKTtcbiAgICAgICAgcmV0dXJuIG8uc3RhcnQobiksIG87XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN0YXJ0cyB0aGUgdGltZXIuIFRoaXMgaXMgY2FsbGVkIGltbWVkaWF0ZWx5IGFmdGVyIGNvbnN0cnVjdGlvbiBieVxuICAgICAqIGNyZWF0ZUFuZFNjaGVkdWxlKCkuXG4gICAgICovICAgIHN0YXJ0KHQpIHtcbiAgICAgICAgdGhpcy50aW1lckhhbmRsZSA9IHNldFRpbWVvdXQoKCgpID0+IHRoaXMuaGFuZGxlRGVsYXlFbGFwc2VkKCkpLCB0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUXVldWVzIHRoZSBvcGVyYXRpb24gdG8gcnVuIGltbWVkaWF0ZWx5IChpZiBpdCBoYXNuJ3QgYWxyZWFkeSBiZWVuIHJ1biBvclxuICAgICAqIGNhbmNlbGVkKS5cbiAgICAgKi8gICAgc2tpcERlbGF5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5oYW5kbGVEZWxheUVsYXBzZWQoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FuY2VscyB0aGUgb3BlcmF0aW9uIGlmIGl0IGhhc24ndCBhbHJlYWR5IGJlZW4gZXhlY3V0ZWQgb3IgY2FuY2VsZWQuIFRoZVxuICAgICAqIHByb21pc2Ugd2lsbCBiZSByZWplY3RlZC5cbiAgICAgKlxuICAgICAqIEFzIGxvbmcgYXMgdGhlIG9wZXJhdGlvbiBoYXMgbm90IHlldCBiZWVuIHJ1biwgY2FsbGluZyBjYW5jZWwoKSBwcm92aWRlcyBhXG4gICAgICogZ3VhcmFudGVlIHRoYXQgdGhlIG9wZXJhdGlvbiB3aWxsIG5vdCBiZSBydW4uXG4gICAgICovICAgIGNhbmNlbCh0KSB7XG4gICAgICAgIG51bGwgIT09IHRoaXMudGltZXJIYW5kbGUgJiYgKHRoaXMuY2xlYXJUaW1lb3V0KCksIHRoaXMuZGVmZXJyZWQucmVqZWN0KG5ldyBLKHEuQ0FOQ0VMTEVELCBcIk9wZXJhdGlvbiBjYW5jZWxsZWRcIiArICh0ID8gXCI6IFwiICsgdCA6IFwiXCIpKSkpO1xuICAgIH1cbiAgICBoYW5kbGVEZWxheUVsYXBzZWQoKSB7XG4gICAgICAgIHRoaXMuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KCgoKSA9PiBudWxsICE9PSB0aGlzLnRpbWVySGFuZGxlID8gKHRoaXMuY2xlYXJUaW1lb3V0KCksIFxuICAgICAgICB0aGlzLm9wKCkudGhlbigodCA9PiB0aGlzLmRlZmVycmVkLnJlc29sdmUodCkpKSkgOiBQcm9taXNlLnJlc29sdmUoKSkpO1xuICAgIH1cbiAgICBjbGVhclRpbWVvdXQoKSB7XG4gICAgICAgIG51bGwgIT09IHRoaXMudGltZXJIYW5kbGUgJiYgKHRoaXMucmVtb3ZhbENhbGxiYWNrKHRoaXMpLCBjbGVhclRpbWVvdXQodGhpcy50aW1lckhhbmRsZSksIFxuICAgICAgICB0aGlzLnRpbWVySGFuZGxlID0gbnVsbCk7XG4gICAgfVxufVxuXG4vKipcbiAqIFJldHVybnMgYSBGaXJlc3RvcmVFcnJvciB0aGF0IGNhbiBiZSBzdXJmYWNlZCB0byB0aGUgdXNlciBpZiB0aGUgcHJvdmlkZWRcbiAqIGVycm9yIGlzIGFuIEluZGV4ZWREYlRyYW5zYWN0aW9uRXJyb3IuIFJlLXRocm93cyB0aGUgZXJyb3Igb3RoZXJ3aXNlLlxuICovIGZ1bmN0aW9uIHhvKHQsIGUpIHtcbiAgICBpZiAoJChcIkFzeW5jUXVldWVcIiwgYCR7ZX06ICR7dH1gKSwgenModCkpIHJldHVybiBuZXcgSyhxLlVOQVZBSUxBQkxFLCBgJHtlfTogJHt0fWApO1xuICAgIHRocm93IHQ7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIERvY3VtZW50U2V0IGlzIGFuIGltbXV0YWJsZSAoY29weS1vbi13cml0ZSkgY29sbGVjdGlvbiB0aGF0IGhvbGRzIGRvY3VtZW50c1xuICogaW4gb3JkZXIgc3BlY2lmaWVkIGJ5IHRoZSBwcm92aWRlZCBjb21wYXJhdG9yLiBXZSBhbHdheXMgYWRkIGEgZG9jdW1lbnQga2V5XG4gKiBjb21wYXJhdG9yIG9uIHRvcCBvZiB3aGF0IGlzIHByb3ZpZGVkIHRvIGd1YXJhbnRlZSBkb2N1bWVudCBlcXVhbGl0eSBiYXNlZCBvblxuICogdGhlIGtleS5cbiAqLyBjbGFzcyBrbyB7XG4gICAgLyoqIFRoZSBkZWZhdWx0IG9yZGVyaW5nIGlzIGJ5IGtleSBpZiB0aGUgY29tcGFyYXRvciBpcyBvbWl0dGVkICovXG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICAvLyBXZSBhcmUgYWRkaW5nIGRvY3VtZW50IGtleSBjb21wYXJhdG9yIHRvIHRoZSBlbmQgYXMgaXQncyB0aGUgb25seVxuICAgICAgICAvLyBndWFyYW50ZWVkIHVuaXF1ZSBwcm9wZXJ0eSBvZiBhIGRvY3VtZW50LlxuICAgICAgICB0aGlzLmNvbXBhcmF0b3IgPSB0ID8gKGUsIG4pID0+IHQoZSwgbikgfHwgUHQuY29tcGFyYXRvcihlLmtleSwgbi5rZXkpIDogKHQsIGUpID0+IFB0LmNvbXBhcmF0b3IodC5rZXksIGUua2V5KSwgXG4gICAgICAgIHRoaXMua2V5ZWRNYXAgPSBUbigpLCB0aGlzLnNvcnRlZFNldCA9IG5ldyBkbih0aGlzLmNvbXBhcmF0b3IpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGFuIGVtcHR5IGNvcHkgb2YgdGhlIGV4aXN0aW5nIERvY3VtZW50U2V0LCB1c2luZyB0aGUgc2FtZVxuICAgICAqIGNvbXBhcmF0b3IuXG4gICAgICovICAgIHN0YXRpYyBlbXB0eVNldCh0KSB7XG4gICAgICAgIHJldHVybiBuZXcga28odC5jb21wYXJhdG9yKTtcbiAgICB9XG4gICAgaGFzKHQpIHtcbiAgICAgICAgcmV0dXJuIG51bGwgIT0gdGhpcy5rZXllZE1hcC5nZXQodCk7XG4gICAgfVxuICAgIGdldCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmtleWVkTWFwLmdldCh0KTtcbiAgICB9XG4gICAgZmlyc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNvcnRlZFNldC5taW5LZXkoKTtcbiAgICB9XG4gICAgbGFzdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc29ydGVkU2V0Lm1heEtleSgpO1xuICAgIH1cbiAgICBpc0VtcHR5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zb3J0ZWRTZXQuaXNFbXB0eSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBpbmRleCBvZiB0aGUgcHJvdmlkZWQga2V5IGluIHRoZSBkb2N1bWVudCBzZXQsIG9yIC0xIGlmIHRoZVxuICAgICAqIGRvY3VtZW50IGtleSBpcyBub3QgcHJlc2VudCBpbiB0aGUgc2V0O1xuICAgICAqLyAgICBpbmRleE9mKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMua2V5ZWRNYXAuZ2V0KHQpO1xuICAgICAgICByZXR1cm4gZSA/IHRoaXMuc29ydGVkU2V0LmluZGV4T2YoZSkgOiAtMTtcbiAgICB9XG4gICAgZ2V0IHNpemUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNvcnRlZFNldC5zaXplO1xuICAgIH1cbiAgICAvKiogSXRlcmF0ZXMgZG9jdW1lbnRzIGluIG9yZGVyIGRlZmluZWQgYnkgXCJjb21wYXJhdG9yXCIgKi8gICAgZm9yRWFjaCh0KSB7XG4gICAgICAgIHRoaXMuc29ydGVkU2V0Lmlub3JkZXJUcmF2ZXJzYWwoKChlLCBuKSA9PiAodChlKSwgITEpKSk7XG4gICAgfVxuICAgIC8qKiBJbnNlcnRzIG9yIHVwZGF0ZXMgYSBkb2N1bWVudCB3aXRoIHRoZSBzYW1lIGtleSAqLyAgICBhZGQodCkge1xuICAgICAgICAvLyBGaXJzdCByZW1vdmUgdGhlIGVsZW1lbnQgaWYgd2UgaGF2ZSBpdC5cbiAgICAgICAgY29uc3QgZSA9IHRoaXMuZGVsZXRlKHQua2V5KTtcbiAgICAgICAgcmV0dXJuIGUuY29weShlLmtleWVkTWFwLmluc2VydCh0LmtleSwgdCksIGUuc29ydGVkU2V0Lmluc2VydCh0LCBudWxsKSk7XG4gICAgfVxuICAgIC8qKiBEZWxldGVzIGEgZG9jdW1lbnQgd2l0aCBhIGdpdmVuIGtleSAqLyAgICBkZWxldGUodCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5nZXQodCk7XG4gICAgICAgIHJldHVybiBlID8gdGhpcy5jb3B5KHRoaXMua2V5ZWRNYXAucmVtb3ZlKHQpLCB0aGlzLnNvcnRlZFNldC5yZW1vdmUoZSkpIDogdGhpcztcbiAgICB9XG4gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIGlmICghKHQgaW5zdGFuY2VvZiBrbykpIHJldHVybiAhMTtcbiAgICAgICAgaWYgKHRoaXMuc2l6ZSAhPT0gdC5zaXplKSByZXR1cm4gITE7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLnNvcnRlZFNldC5nZXRJdGVyYXRvcigpLCBuID0gdC5zb3J0ZWRTZXQuZ2V0SXRlcmF0b3IoKTtcbiAgICAgICAgZm9yICg7ZS5oYXNOZXh0KCk7ICkge1xuICAgICAgICAgICAgY29uc3QgdCA9IGUuZ2V0TmV4dCgpLmtleSwgcyA9IG4uZ2V0TmV4dCgpLmtleTtcbiAgICAgICAgICAgIGlmICghdC5pc0VxdWFsKHMpKSByZXR1cm4gITE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICEwO1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgY29uc3QgdCA9IFtdO1xuICAgICAgICByZXR1cm4gdGhpcy5mb3JFYWNoKChlID0+IHtcbiAgICAgICAgICAgIHQucHVzaChlLnRvU3RyaW5nKCkpO1xuICAgICAgICB9KSksIDAgPT09IHQubGVuZ3RoID8gXCJEb2N1bWVudFNldCAoKVwiIDogXCJEb2N1bWVudFNldCAoXFxuICBcIiArIHQuam9pbihcIiAgXFxuXCIpICsgXCJcXG4pXCI7XG4gICAgfVxuICAgIGNvcHkodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gbmV3IGtvO1xuICAgICAgICByZXR1cm4gbi5jb21wYXJhdG9yID0gdGhpcy5jb21wYXJhdG9yLCBuLmtleWVkTWFwID0gdCwgbi5zb3J0ZWRTZXQgPSBlLCBuO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogRG9jdW1lbnRDaGFuZ2VTZXQga2VlcHMgdHJhY2sgb2YgYSBzZXQgb2YgY2hhbmdlcyB0byBkb2NzIGluIGEgcXVlcnksIG1lcmdpbmdcbiAqIGR1cGxpY2F0ZSBldmVudHMgZm9yIHRoZSBzYW1lIGRvYy5cbiAqLyBjbGFzcyAkbyB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuSnIgPSBuZXcgZG4oUHQuY29tcGFyYXRvcik7XG4gICAgfVxuICAgIHRyYWNrKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHQuZG9jLmtleSwgbiA9IHRoaXMuSnIuZ2V0KGUpO1xuICAgICAgICBuID8gXG4gICAgICAgIC8vIE1lcmdlIHRoZSBuZXcgY2hhbmdlIHdpdGggdGhlIGV4aXN0aW5nIGNoYW5nZS5cbiAgICAgICAgMCAvKiBBZGRlZCAqLyAhPT0gdC50eXBlICYmIDMgLyogTWV0YWRhdGEgKi8gPT09IG4udHlwZSA/IHRoaXMuSnIgPSB0aGlzLkpyLmluc2VydChlLCB0KSA6IDMgLyogTWV0YWRhdGEgKi8gPT09IHQudHlwZSAmJiAxIC8qIFJlbW92ZWQgKi8gIT09IG4udHlwZSA/IHRoaXMuSnIgPSB0aGlzLkpyLmluc2VydChlLCB7XG4gICAgICAgICAgICB0eXBlOiBuLnR5cGUsXG4gICAgICAgICAgICBkb2M6IHQuZG9jXG4gICAgICAgIH0pIDogMiAvKiBNb2RpZmllZCAqLyA9PT0gdC50eXBlICYmIDIgLyogTW9kaWZpZWQgKi8gPT09IG4udHlwZSA/IHRoaXMuSnIgPSB0aGlzLkpyLmluc2VydChlLCB7XG4gICAgICAgICAgICB0eXBlOiAyIC8qIE1vZGlmaWVkICovICxcbiAgICAgICAgICAgIGRvYzogdC5kb2NcbiAgICAgICAgfSkgOiAyIC8qIE1vZGlmaWVkICovID09PSB0LnR5cGUgJiYgMCAvKiBBZGRlZCAqLyA9PT0gbi50eXBlID8gdGhpcy5KciA9IHRoaXMuSnIuaW5zZXJ0KGUsIHtcbiAgICAgICAgICAgIHR5cGU6IDAgLyogQWRkZWQgKi8gLFxuICAgICAgICAgICAgZG9jOiB0LmRvY1xuICAgICAgICB9KSA6IDEgLyogUmVtb3ZlZCAqLyA9PT0gdC50eXBlICYmIDAgLyogQWRkZWQgKi8gPT09IG4udHlwZSA/IHRoaXMuSnIgPSB0aGlzLkpyLnJlbW92ZShlKSA6IDEgLyogUmVtb3ZlZCAqLyA9PT0gdC50eXBlICYmIDIgLyogTW9kaWZpZWQgKi8gPT09IG4udHlwZSA/IHRoaXMuSnIgPSB0aGlzLkpyLmluc2VydChlLCB7XG4gICAgICAgICAgICB0eXBlOiAxIC8qIFJlbW92ZWQgKi8gLFxuICAgICAgICAgICAgZG9jOiBuLmRvY1xuICAgICAgICB9KSA6IDAgLyogQWRkZWQgKi8gPT09IHQudHlwZSAmJiAxIC8qIFJlbW92ZWQgKi8gPT09IG4udHlwZSA/IHRoaXMuSnIgPSB0aGlzLkpyLmluc2VydChlLCB7XG4gICAgICAgICAgICB0eXBlOiAyIC8qIE1vZGlmaWVkICovICxcbiAgICAgICAgICAgIGRvYzogdC5kb2NcbiAgICAgICAgfSkgOiBcbiAgICAgICAgLy8gVGhpcyBpbmNsdWRlcyB0aGVzZSBjYXNlcywgd2hpY2ggZG9uJ3QgbWFrZSBzZW5zZTpcbiAgICAgICAgLy8gQWRkZWQtPkFkZGVkXG4gICAgICAgIC8vIFJlbW92ZWQtPlJlbW92ZWRcbiAgICAgICAgLy8gTW9kaWZpZWQtPkFkZGVkXG4gICAgICAgIC8vIFJlbW92ZWQtPk1vZGlmaWVkXG4gICAgICAgIC8vIE1ldGFkYXRhLT5BZGRlZFxuICAgICAgICAvLyBSZW1vdmVkLT5NZXRhZGF0YVxuICAgICAgICBNKCkgOiB0aGlzLkpyID0gdGhpcy5Kci5pbnNlcnQoZSwgdCk7XG4gICAgfVxuICAgIFlyKCkge1xuICAgICAgICBjb25zdCB0ID0gW107XG4gICAgICAgIHJldHVybiB0aGlzLkpyLmlub3JkZXJUcmF2ZXJzYWwoKChlLCBuKSA9PiB7XG4gICAgICAgICAgICB0LnB1c2gobik7XG4gICAgICAgIH0pKSwgdDtcbiAgICB9XG59XG5cbmNsYXNzIE9vIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzLCBpLCByLCBvLCBhKSB7XG4gICAgICAgIHRoaXMucXVlcnkgPSB0LCB0aGlzLmRvY3MgPSBlLCB0aGlzLm9sZERvY3MgPSBuLCB0aGlzLmRvY0NoYW5nZXMgPSBzLCB0aGlzLm11dGF0ZWRLZXlzID0gaSwgXG4gICAgICAgIHRoaXMuZnJvbUNhY2hlID0gciwgdGhpcy5zeW5jU3RhdGVDaGFuZ2VkID0gbywgdGhpcy5leGNsdWRlc01ldGFkYXRhQ2hhbmdlcyA9IGE7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIGEgdmlldyBzbmFwc2hvdCBhcyBpZiBhbGwgZG9jdW1lbnRzIGluIHRoZSBzbmFwc2hvdCB3ZXJlIGFkZGVkLiAqLyAgICBzdGF0aWMgZnJvbUluaXRpYWxEb2N1bWVudHModCwgZSwgbiwgcykge1xuICAgICAgICBjb25zdCBpID0gW107XG4gICAgICAgIHJldHVybiBlLmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgaS5wdXNoKHtcbiAgICAgICAgICAgICAgICB0eXBlOiAwIC8qIEFkZGVkICovICxcbiAgICAgICAgICAgICAgICBkb2M6IHRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KSksIG5ldyBPbyh0LCBlLCBrby5lbXB0eVNldChlKSwgaSwgbiwgcywgXG4gICAgICAgIC8qIHN5bmNTdGF0ZUNoYW5nZWQ9ICovICEwLCBcbiAgICAgICAgLyogZXhjbHVkZXNNZXRhZGF0YUNoYW5nZXM9ICovICExKTtcbiAgICB9XG4gICAgZ2V0IGhhc1BlbmRpbmdXcml0ZXMoKSB7XG4gICAgICAgIHJldHVybiAhdGhpcy5tdXRhdGVkS2V5cy5pc0VtcHR5KCk7XG4gICAgfVxuICAgIGlzRXF1YWwodCkge1xuICAgICAgICBpZiAoISh0aGlzLmZyb21DYWNoZSA9PT0gdC5mcm9tQ2FjaGUgJiYgdGhpcy5zeW5jU3RhdGVDaGFuZ2VkID09PSB0LnN5bmNTdGF0ZUNoYW5nZWQgJiYgdGhpcy5tdXRhdGVkS2V5cy5pc0VxdWFsKHQubXV0YXRlZEtleXMpICYmIEllKHRoaXMucXVlcnksIHQucXVlcnkpICYmIHRoaXMuZG9jcy5pc0VxdWFsKHQuZG9jcykgJiYgdGhpcy5vbGREb2NzLmlzRXF1YWwodC5vbGREb2NzKSkpIHJldHVybiAhMTtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuZG9jQ2hhbmdlcywgbiA9IHQuZG9jQ2hhbmdlcztcbiAgICAgICAgaWYgKGUubGVuZ3RoICE9PSBuLmxlbmd0aCkgcmV0dXJuICExO1xuICAgICAgICBmb3IgKGxldCB0ID0gMDsgdCA8IGUubGVuZ3RoOyB0KyspIGlmIChlW3RdLnR5cGUgIT09IG5bdF0udHlwZSB8fCAhZVt0XS5kb2MuaXNFcXVhbChuW3RdLmRvYykpIHJldHVybiAhMTtcbiAgICAgICAgcmV0dXJuICEwO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogSG9sZHMgdGhlIGxpc3RlbmVycyBhbmQgdGhlIGxhc3QgcmVjZWl2ZWQgVmlld1NuYXBzaG90IGZvciBhIHF1ZXJ5IGJlaW5nXG4gKiB0cmFja2VkIGJ5IEV2ZW50TWFuYWdlci5cbiAqLyBjbGFzcyBGbyB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuWHIgPSB2b2lkIDAsIHRoaXMubGlzdGVuZXJzID0gW107XG4gICAgfVxufVxuXG5jbGFzcyBNbyB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMucXVlcmllcyA9IG5ldyBLaSgodCA9PiBBZSh0KSksIEllKSwgdGhpcy5vbmxpbmVTdGF0ZSA9IFwiVW5rbm93blwiIC8qIFVua25vd24gKi8gLCBcbiAgICAgICAgdGhpcy5aciA9IG5ldyBTZXQ7XG4gICAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBMbyh0LCBlKSB7XG4gICAgY29uc3QgbiA9IFUodCksIHMgPSBlLnF1ZXJ5O1xuICAgIGxldCBpID0gITEsIHIgPSBuLnF1ZXJpZXMuZ2V0KHMpO1xuICAgIGlmIChyIHx8IChpID0gITAsIHIgPSBuZXcgRm8pLCBpKSB0cnkge1xuICAgICAgICByLlhyID0gYXdhaXQgbi5vbkxpc3RlbihzKTtcbiAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgIGNvbnN0IG4gPSB4byh0LCBgSW5pdGlhbGl6YXRpb24gb2YgcXVlcnkgJyR7UmUoZS5xdWVyeSl9JyBmYWlsZWRgKTtcbiAgICAgICAgcmV0dXJuIHZvaWQgZS5vbkVycm9yKG4pO1xuICAgIH1cbiAgICBpZiAobi5xdWVyaWVzLnNldChzLCByKSwgci5saXN0ZW5lcnMucHVzaChlKSwgXG4gICAgLy8gUnVuIGdsb2JhbCBzbmFwc2hvdCBsaXN0ZW5lcnMgaWYgYSBjb25zaXN0ZW50IHNuYXBzaG90IGhhcyBiZWVuIGVtaXR0ZWQuXG4gICAgZS5lbyhuLm9ubGluZVN0YXRlKSwgci5Ycikge1xuICAgICAgICBlLm5vKHIuWHIpICYmIEtvKG4pO1xuICAgIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gQm8odCwgZSkge1xuICAgIGNvbnN0IG4gPSBVKHQpLCBzID0gZS5xdWVyeTtcbiAgICBsZXQgaSA9ICExO1xuICAgIGNvbnN0IHIgPSBuLnF1ZXJpZXMuZ2V0KHMpO1xuICAgIGlmIChyKSB7XG4gICAgICAgIGNvbnN0IHQgPSByLmxpc3RlbmVycy5pbmRleE9mKGUpO1xuICAgICAgICB0ID49IDAgJiYgKHIubGlzdGVuZXJzLnNwbGljZSh0LCAxKSwgaSA9IDAgPT09IHIubGlzdGVuZXJzLmxlbmd0aCk7XG4gICAgfVxuICAgIGlmIChpKSByZXR1cm4gbi5xdWVyaWVzLmRlbGV0ZShzKSwgbi5vblVubGlzdGVuKHMpO1xufVxuXG5mdW5jdGlvbiBVbyh0LCBlKSB7XG4gICAgY29uc3QgbiA9IFUodCk7XG4gICAgbGV0IHMgPSAhMTtcbiAgICBmb3IgKGNvbnN0IHQgb2YgZSkge1xuICAgICAgICBjb25zdCBlID0gdC5xdWVyeSwgaSA9IG4ucXVlcmllcy5nZXQoZSk7XG4gICAgICAgIGlmIChpKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2YgaS5saXN0ZW5lcnMpIGUubm8odCkgJiYgKHMgPSAhMCk7XG4gICAgICAgICAgICBpLlhyID0gdDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzICYmIEtvKG4pO1xufVxuXG5mdW5jdGlvbiBxbyh0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9IFUodCksIGkgPSBzLnF1ZXJpZXMuZ2V0KGUpO1xuICAgIGlmIChpKSBmb3IgKGNvbnN0IHQgb2YgaS5saXN0ZW5lcnMpIHQub25FcnJvcihuKTtcbiAgICAvLyBSZW1vdmUgYWxsIGxpc3RlbmVycy4gTk9URTogV2UgZG9uJ3QgbmVlZCB0byBjYWxsIHN5bmNFbmdpbmUudW5saXN0ZW4oKVxuICAgIC8vIGFmdGVyIGFuIGVycm9yLlxuICAgICAgICBzLnF1ZXJpZXMuZGVsZXRlKGUpO1xufVxuXG4vLyBDYWxsIGFsbCBnbG9iYWwgc25hcHNob3QgbGlzdGVuZXJzIHRoYXQgaGF2ZSBiZWVuIHNldC5cbmZ1bmN0aW9uIEtvKHQpIHtcbiAgICB0LlpyLmZvckVhY2goKHQgPT4ge1xuICAgICAgICB0Lm5leHQoKTtcbiAgICB9KSk7XG59XG5cbi8qKlxuICogUXVlcnlMaXN0ZW5lciB0YWtlcyBhIHNlcmllcyBvZiBpbnRlcm5hbCB2aWV3IHNuYXBzaG90cyBhbmQgZGV0ZXJtaW5lc1xuICogd2hlbiB0byByYWlzZSB0aGUgZXZlbnQuXG4gKlxuICogSXQgdXNlcyBhbiBPYnNlcnZlciB0byBkaXNwYXRjaCBldmVudHMuXG4gKi8gY2xhc3Mgam8ge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4pIHtcbiAgICAgICAgdGhpcy5xdWVyeSA9IHQsIHRoaXMuc28gPSBlLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEluaXRpYWwgc25hcHNob3RzIChlLmcuIGZyb20gY2FjaGUpIG1heSBub3QgYmUgcHJvcGFnYXRlZCB0byB0aGUgd3JhcHBlZFxuICAgICAgICAgKiBvYnNlcnZlci4gVGhpcyBmbGFnIGlzIHNldCB0byB0cnVlIG9uY2Ugd2UndmUgYWN0dWFsbHkgcmFpc2VkIGFuIGV2ZW50LlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5pbyA9ICExLCB0aGlzLnJvID0gbnVsbCwgdGhpcy5vbmxpbmVTdGF0ZSA9IFwiVW5rbm93blwiIC8qIFVua25vd24gKi8gLCB0aGlzLm9wdGlvbnMgPSBuIHx8IHt9O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBcHBsaWVzIHRoZSBuZXcgVmlld1NuYXBzaG90IHRvIHRoaXMgbGlzdGVuZXIsIHJhaXNpbmcgYSB1c2VyLWZhY2luZyBldmVudFxuICAgICAqIGlmIGFwcGxpY2FibGUgKGRlcGVuZGluZyBvbiB3aGF0IGNoYW5nZWQsIHdoZXRoZXIgdGhlIHVzZXIgaGFzIG9wdGVkIGludG9cbiAgICAgKiBtZXRhZGF0YS1vbmx5IGNoYW5nZXMsIGV0Yy4pLiBSZXR1cm5zIHRydWUgaWYgYSB1c2VyLWZhY2luZyBldmVudCB3YXNcbiAgICAgKiBpbmRlZWQgcmFpc2VkLlxuICAgICAqLyAgICBubyh0KSB7XG4gICAgICAgIGlmICghdGhpcy5vcHRpb25zLmluY2x1ZGVNZXRhZGF0YUNoYW5nZXMpIHtcbiAgICAgICAgICAgIC8vIFJlbW92ZSB0aGUgbWV0YWRhdGEgb25seSBjaGFuZ2VzLlxuICAgICAgICAgICAgY29uc3QgZSA9IFtdO1xuICAgICAgICAgICAgZm9yIChjb25zdCBuIG9mIHQuZG9jQ2hhbmdlcykgMyAvKiBNZXRhZGF0YSAqLyAhPT0gbi50eXBlICYmIGUucHVzaChuKTtcbiAgICAgICAgICAgIHQgPSBuZXcgT28odC5xdWVyeSwgdC5kb2NzLCB0Lm9sZERvY3MsIGUsIHQubXV0YXRlZEtleXMsIHQuZnJvbUNhY2hlLCB0LnN5bmNTdGF0ZUNoYW5nZWQsIFxuICAgICAgICAgICAgLyogZXhjbHVkZXNNZXRhZGF0YUNoYW5nZXM9ICovICEwKTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgZSA9ICExO1xuICAgICAgICByZXR1cm4gdGhpcy5pbyA/IHRoaXMub28odCkgJiYgKHRoaXMuc28ubmV4dCh0KSwgZSA9ICEwKSA6IHRoaXMuYW8odCwgdGhpcy5vbmxpbmVTdGF0ZSkgJiYgKHRoaXMuY28odCksIFxuICAgICAgICBlID0gITApLCB0aGlzLnJvID0gdCwgZTtcbiAgICB9XG4gICAgb25FcnJvcih0KSB7XG4gICAgICAgIHRoaXMuc28uZXJyb3IodCk7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIHdoZXRoZXIgYSBzbmFwc2hvdCB3YXMgcmFpc2VkLiAqLyAgICBlbyh0KSB7XG4gICAgICAgIHRoaXMub25saW5lU3RhdGUgPSB0O1xuICAgICAgICBsZXQgZSA9ICExO1xuICAgICAgICByZXR1cm4gdGhpcy5ybyAmJiAhdGhpcy5pbyAmJiB0aGlzLmFvKHRoaXMucm8sIHQpICYmICh0aGlzLmNvKHRoaXMucm8pLCBlID0gITApLCBcbiAgICAgICAgZTtcbiAgICB9XG4gICAgYW8odCwgZSkge1xuICAgICAgICAvLyBBbHdheXMgcmFpc2UgdGhlIGZpcnN0IGV2ZW50IHdoZW4gd2UncmUgc3luY2VkXG4gICAgICAgIGlmICghdC5mcm9tQ2FjaGUpIHJldHVybiAhMDtcbiAgICAgICAgLy8gTk9URTogV2UgY29uc2lkZXIgT25saW5lU3RhdGUuVW5rbm93biBhcyBvbmxpbmUgKGl0IHNob3VsZCBiZWNvbWUgT2ZmbGluZVxuICAgICAgICAvLyBvciBPbmxpbmUgaWYgd2Ugd2FpdCBsb25nIGVub3VnaCkuXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IFwiT2ZmbGluZVwiIC8qIE9mZmxpbmUgKi8gIT09IGU7XG4gICAgICAgIC8vIERvbid0IHJhaXNlIHRoZSBldmVudCBpZiB3ZSdyZSBvbmxpbmUsIGFyZW4ndCBzeW5jZWQgeWV0IChjaGVja2VkXG4gICAgICAgIC8vIGFib3ZlKSBhbmQgYXJlIHdhaXRpbmcgZm9yIGEgc3luYy5cbiAgICAgICAgICAgICAgICByZXR1cm4gKCF0aGlzLm9wdGlvbnMudW8gfHwgIW4pICYmICghdC5kb2NzLmlzRW1wdHkoKSB8fCBcIk9mZmxpbmVcIiAvKiBPZmZsaW5lICovID09PSBlKTtcbiAgICAgICAgLy8gUmFpc2UgZGF0YSBmcm9tIGNhY2hlIGlmIHdlIGhhdmUgYW55IGRvY3VtZW50cyBvciB3ZSBhcmUgb2ZmbGluZVxuICAgICAgICB9XG4gICAgb28odCkge1xuICAgICAgICAvLyBXZSBkb24ndCBuZWVkIHRvIGhhbmRsZSBpbmNsdWRlRG9jdW1lbnRNZXRhZGF0YUNoYW5nZXMgaGVyZSBiZWNhdXNlXG4gICAgICAgIC8vIHRoZSBNZXRhZGF0YSBvbmx5IGNoYW5nZXMgaGF2ZSBhbHJlYWR5IGJlZW4gc3RyaXBwZWQgb3V0IGlmIG5lZWRlZC5cbiAgICAgICAgLy8gQXQgdGhpcyBwb2ludCB0aGUgb25seSBjaGFuZ2VzIHdlIHdpbGwgc2VlIGFyZSB0aGUgb25lcyB3ZSBzaG91bGRcbiAgICAgICAgLy8gcHJvcGFnYXRlLlxuICAgICAgICBpZiAodC5kb2NDaGFuZ2VzLmxlbmd0aCA+IDApIHJldHVybiAhMDtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMucm8gJiYgdGhpcy5yby5oYXNQZW5kaW5nV3JpdGVzICE9PSB0Lmhhc1BlbmRpbmdXcml0ZXM7XG4gICAgICAgIHJldHVybiAhKCF0LnN5bmNTdGF0ZUNoYW5nZWQgJiYgIWUpICYmICEwID09PSB0aGlzLm9wdGlvbnMuaW5jbHVkZU1ldGFkYXRhQ2hhbmdlcztcbiAgICAgICAgLy8gR2VuZXJhbGx5IHdlIHNob3VsZCBoYXZlIGhpdCBvbmUgb2YgdGhlIGNhc2VzIGFib3ZlLCBidXQgaXQncyBwb3NzaWJsZVxuICAgICAgICAvLyB0byBnZXQgaGVyZSBpZiB0aGVyZSB3ZXJlIG9ubHkgbWV0YWRhdGEgZG9jQ2hhbmdlcyBhbmQgdGhleSBnb3RcbiAgICAgICAgLy8gc3RyaXBwZWQgb3V0LlxuICAgICAgICB9XG4gICAgY28odCkge1xuICAgICAgICB0ID0gT28uZnJvbUluaXRpYWxEb2N1bWVudHModC5xdWVyeSwgdC5kb2NzLCB0Lm11dGF0ZWRLZXlzLCB0LmZyb21DYWNoZSksIHRoaXMuaW8gPSAhMCwgXG4gICAgICAgIHRoaXMuc28ubmV4dCh0KTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEEgY29tcGxldGUgZWxlbWVudCBpbiB0aGUgYnVuZGxlIHN0cmVhbSwgdG9nZXRoZXIgd2l0aCB0aGUgYnl0ZSBsZW5ndGggaXRcbiAqIG9jY3VwaWVzIGluIHRoZSBzdHJlYW0uXG4gKi8gY2xhc3MgUW8ge1xuICAgIGNvbnN0cnVjdG9yKHQsIFxuICAgIC8vIEhvdyBtYW55IGJ5dGVzIHRoaXMgZWxlbWVudCB0YWtlcyB0byBzdG9yZSBpbiB0aGUgYnVuZGxlLlxuICAgIGUpIHtcbiAgICAgICAgdGhpcy5wYXlsb2FkID0gdCwgdGhpcy5ieXRlTGVuZ3RoID0gZTtcbiAgICB9XG4gICAgaG8oKSB7XG4gICAgICAgIHJldHVybiBcIm1ldGFkYXRhXCIgaW4gdGhpcy5wYXlsb2FkO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogSGVscGVyIHRvIGNvbnZlcnQgb2JqZWN0cyBmcm9tIGJ1bmRsZXMgdG8gbW9kZWwgb2JqZWN0cyBpbiB0aGUgU0RLLlxuICovIGNsYXNzIFdvIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMuTiA9IHQ7XG4gICAgfVxuICAgIHpuKHQpIHtcbiAgICAgICAgcmV0dXJuIEduKHRoaXMuTiwgdCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENvbnZlcnRzIGEgQnVuZGxlRG9jdW1lbnQgdG8gYSBNdXRhYmxlRG9jdW1lbnQuXG4gICAgICovICAgIEhuKHQpIHtcbiAgICAgICAgcmV0dXJuIHQubWV0YWRhdGEuZXhpc3RzID8gWm4odGhpcy5OLCB0LmRvY3VtZW50LCAhMSkgOiBxdC5uZXdOb0RvY3VtZW50KHRoaXMuem4odC5tZXRhZGF0YS5uYW1lKSwgdGhpcy5Kbih0Lm1ldGFkYXRhLnJlYWRUaW1lKSk7XG4gICAgfVxuICAgIEpuKHQpIHtcbiAgICAgICAgcmV0dXJuIEtuKHQpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBBIGNsYXNzIHRvIHByb2Nlc3MgdGhlIGVsZW1lbnRzIGZyb20gYSBidW5kbGUsIGxvYWQgdGhlbSBpbnRvIGxvY2FsXG4gKiBzdG9yYWdlIGFuZCBwcm92aWRlIHByb2dyZXNzIHVwZGF0ZSB3aGlsZSBsb2FkaW5nLlxuICovIGNsYXNzIEdvIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHRoaXMubG8gPSB0LCB0aGlzLmxvY2FsU3RvcmUgPSBlLCB0aGlzLk4gPSBuLCBcbiAgICAgICAgLyoqIEJhdGNoZWQgcXVlcmllcyB0byBiZSBzYXZlZCBpbnRvIHN0b3JhZ2UgKi9cbiAgICAgICAgdGhpcy5xdWVyaWVzID0gW10sIFxuICAgICAgICAvKiogQmF0Y2hlZCBkb2N1bWVudHMgdG8gYmUgc2F2ZWQgaW50byBzdG9yYWdlICovXG4gICAgICAgIHRoaXMuZG9jdW1lbnRzID0gW10sIHRoaXMucHJvZ3Jlc3MgPSB6byh0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkcyBhbiBlbGVtZW50IGZyb20gdGhlIGJ1bmRsZSB0byB0aGUgbG9hZGVyLlxuICAgICAqXG4gICAgICogUmV0dXJucyBhIG5ldyBwcm9ncmVzcyBpZiBhZGRpbmcgdGhlIGVsZW1lbnQgbGVhZHMgdG8gYSBuZXcgcHJvZ3Jlc3MsXG4gICAgICogb3RoZXJ3aXNlIHJldHVybnMgbnVsbC5cbiAgICAgKi8gICAgZm8odCkge1xuICAgICAgICB0aGlzLnByb2dyZXNzLmJ5dGVzTG9hZGVkICs9IHQuYnl0ZUxlbmd0aDtcbiAgICAgICAgbGV0IGUgPSB0aGlzLnByb2dyZXNzLmRvY3VtZW50c0xvYWRlZDtcbiAgICAgICAgcmV0dXJuIHQucGF5bG9hZC5uYW1lZFF1ZXJ5ID8gdGhpcy5xdWVyaWVzLnB1c2godC5wYXlsb2FkLm5hbWVkUXVlcnkpIDogdC5wYXlsb2FkLmRvY3VtZW50TWV0YWRhdGEgPyAodGhpcy5kb2N1bWVudHMucHVzaCh7XG4gICAgICAgICAgICBtZXRhZGF0YTogdC5wYXlsb2FkLmRvY3VtZW50TWV0YWRhdGFcbiAgICAgICAgfSksIHQucGF5bG9hZC5kb2N1bWVudE1ldGFkYXRhLmV4aXN0cyB8fCArK2UpIDogdC5wYXlsb2FkLmRvY3VtZW50ICYmICh0aGlzLmRvY3VtZW50c1t0aGlzLmRvY3VtZW50cy5sZW5ndGggLSAxXS5kb2N1bWVudCA9IHQucGF5bG9hZC5kb2N1bWVudCwgXG4gICAgICAgICsrZSksIGUgIT09IHRoaXMucHJvZ3Jlc3MuZG9jdW1lbnRzTG9hZGVkID8gKHRoaXMucHJvZ3Jlc3MuZG9jdW1lbnRzTG9hZGVkID0gZSwgXG4gICAgICAgIE9iamVjdC5hc3NpZ24oe30sIHRoaXMucHJvZ3Jlc3MpKSA6IG51bGw7XG4gICAgfVxuICAgIHdvKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IG5ldyBNYXAsIG4gPSBuZXcgV28odGhpcy5OKTtcbiAgICAgICAgZm9yIChjb25zdCBzIG9mIHQpIGlmIChzLm1ldGFkYXRhLnF1ZXJpZXMpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBuLnpuKHMubWV0YWRhdGEubmFtZSk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2Ygcy5tZXRhZGF0YS5xdWVyaWVzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IChlLmdldChuKSB8fCBQbigpKS5hZGQodCk7XG4gICAgICAgICAgICAgICAgZS5zZXQobiwgcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSB0aGUgcHJvZ3Jlc3MgdG8gJ1N1Y2Nlc3MnIGFuZCByZXR1cm4gdGhlIHVwZGF0ZWQgcHJvZ3Jlc3MuXG4gICAgICovICAgIGFzeW5jIGNvbXBsZXRlKCkge1xuICAgICAgICBjb25zdCB0ID0gYXdhaXQgVHIodGhpcy5sb2NhbFN0b3JlLCBuZXcgV28odGhpcy5OKSwgdGhpcy5kb2N1bWVudHMsIHRoaXMubG8uaWQpLCBlID0gdGhpcy53byh0aGlzLmRvY3VtZW50cyk7XG4gICAgICAgIGZvciAoY29uc3QgdCBvZiB0aGlzLnF1ZXJpZXMpIGF3YWl0IElyKHRoaXMubG9jYWxTdG9yZSwgdCwgZS5nZXQodC5uYW1lKSk7XG4gICAgICAgIHJldHVybiB0aGlzLnByb2dyZXNzLnRhc2tTdGF0ZSA9IFwiU3VjY2Vzc1wiLCBuZXcgc3IoT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5wcm9ncmVzcyksIHQpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgYExvYWRCdW5kbGVUYXNrUHJvZ3Jlc3NgIHJlcHJlc2VudGluZyB0aGUgaW5pdGlhbCBwcm9ncmVzcyBvZlxuICogbG9hZGluZyBhIGJ1bmRsZS5cbiAqLyBmdW5jdGlvbiB6byh0KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgdGFza1N0YXRlOiBcIlJ1bm5pbmdcIixcbiAgICAgICAgZG9jdW1lbnRzTG9hZGVkOiAwLFxuICAgICAgICBieXRlc0xvYWRlZDogMCxcbiAgICAgICAgdG90YWxEb2N1bWVudHM6IHQudG90YWxEb2N1bWVudHMsXG4gICAgICAgIHRvdGFsQnl0ZXM6IHQudG90YWxCeXRlc1xuICAgIH07XG59XG5cbi8qKlxuICogUmV0dXJucyBhIGBMb2FkQnVuZGxlVGFza1Byb2dyZXNzYCByZXByZXNlbnRpbmcgdGhlIHByb2dyZXNzIHRoYXQgdGhlIGxvYWRpbmdcbiAqIGhhcyBzdWNjZWVkZWQuXG4gKi9cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5jbGFzcyBIbyB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLmtleSA9IHQ7XG4gICAgfVxufVxuXG5jbGFzcyBKbyB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLmtleSA9IHQ7XG4gICAgfVxufVxuXG4vKipcbiAqIFZpZXcgaXMgcmVzcG9uc2libGUgZm9yIGNvbXB1dGluZyB0aGUgZmluYWwgbWVyZ2VkIHRydXRoIG9mIHdoYXQgZG9jcyBhcmUgaW5cbiAqIGEgcXVlcnkuIEl0IGdldHMgbm90aWZpZWQgb2YgbG9jYWwgYW5kIHJlbW90ZSBjaGFuZ2VzIHRvIGRvY3MsIGFuZCBhcHBsaWVzXG4gKiB0aGUgcXVlcnkgZmlsdGVycyBhbmQgbGltaXRzIHRvIGRldGVybWluZSB0aGUgbW9zdCBjb3JyZWN0IHBvc3NpYmxlIHJlc3VsdHMuXG4gKi8gY2xhc3MgWW8ge1xuICAgIGNvbnN0cnVjdG9yKHQsIFxuICAgIC8qKiBEb2N1bWVudHMgaW5jbHVkZWQgaW4gdGhlIHJlbW90ZSB0YXJnZXQgKi9cbiAgICBlKSB7XG4gICAgICAgIHRoaXMucXVlcnkgPSB0LCB0aGlzLl9vID0gZSwgdGhpcy5tbyA9IG51bGwsIFxuICAgICAgICAvKipcbiAgICAgICAgICogQSBmbGFnIHdoZXRoZXIgdGhlIHZpZXcgaXMgY3VycmVudCB3aXRoIHRoZSBiYWNrZW5kLiBBIHZpZXcgaXMgY29uc2lkZXJlZFxuICAgICAgICAgKiBjdXJyZW50IGFmdGVyIGl0IGhhcyBzZWVuIHRoZSBjdXJyZW50IGZsYWcgZnJvbSB0aGUgYmFja2VuZCBhbmQgZGlkIG5vdFxuICAgICAgICAgKiBsb3NlIGNvbnNpc3RlbmN5IHdpdGhpbiB0aGUgd2F0Y2ggc3RyZWFtIChlLmcuIGJlY2F1c2Ugb2YgYW4gZXhpc3RlbmNlXG4gICAgICAgICAqIGZpbHRlciBtaXNtYXRjaCkuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmN1cnJlbnQgPSAhMSwgXG4gICAgICAgIC8qKiBEb2N1bWVudHMgaW4gdGhlIHZpZXcgYnV0IG5vdCBpbiB0aGUgcmVtb3RlIHRhcmdldCAqL1xuICAgICAgICB0aGlzLnlvID0gUG4oKSwgXG4gICAgICAgIC8qKiBEb2N1bWVudCBLZXlzIHRoYXQgaGF2ZSBsb2NhbCBjaGFuZ2VzICovXG4gICAgICAgIHRoaXMubXV0YXRlZEtleXMgPSBQbigpLCB0aGlzLnBvID0gYmUodCksIHRoaXMuRW8gPSBuZXcga28odGhpcy5wbyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSBzZXQgb2YgcmVtb3RlIGRvY3VtZW50cyB0aGF0IHRoZSBzZXJ2ZXIgaGFzIHRvbGQgdXMgYmVsb25ncyB0byB0aGUgdGFyZ2V0IGFzc29jaWF0ZWQgd2l0aFxuICAgICAqIHRoaXMgdmlldy5cbiAgICAgKi8gICAgZ2V0IFRvKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbztcbiAgICB9XG4gICAgLyoqXG4gICAgICogSXRlcmF0ZXMgb3ZlciBhIHNldCBvZiBkb2MgY2hhbmdlcywgYXBwbGllcyB0aGUgcXVlcnkgbGltaXQsIGFuZCBjb21wdXRlc1xuICAgICAqIHdoYXQgdGhlIG5ldyByZXN1bHRzIHNob3VsZCBiZSwgd2hhdCB0aGUgY2hhbmdlcyB3ZXJlLCBhbmQgd2hldGhlciB3ZSBtYXlcbiAgICAgKiBuZWVkIHRvIGdvIGJhY2sgdG8gdGhlIGxvY2FsIGNhY2hlIGZvciBtb3JlIHJlc3VsdHMuIERvZXMgbm90IG1ha2UgYW55XG4gICAgICogY2hhbmdlcyB0byB0aGUgdmlldy5cbiAgICAgKiBAcGFyYW0gZG9jQ2hhbmdlcyAtIFRoZSBkb2MgY2hhbmdlcyB0byBhcHBseSB0byB0aGlzIHZpZXcuXG4gICAgICogQHBhcmFtIHByZXZpb3VzQ2hhbmdlcyAtIElmIHRoaXMgaXMgYmVpbmcgY2FsbGVkIHdpdGggYSByZWZpbGwsIHRoZW4gc3RhcnRcbiAgICAgKiAgICAgICAgd2l0aCB0aGlzIHNldCBvZiBkb2NzIGFuZCBjaGFuZ2VzIGluc3RlYWQgb2YgdGhlIGN1cnJlbnQgdmlldy5cbiAgICAgKiBAcmV0dXJucyBhIG5ldyBzZXQgb2YgZG9jcywgY2hhbmdlcywgYW5kIHJlZmlsbCBmbGFnLlxuICAgICAqLyAgICBJbyh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBlID8gZS5BbyA6IG5ldyAkbywgcyA9IGUgPyBlLkVvIDogdGhpcy5FbztcbiAgICAgICAgbGV0IGkgPSBlID8gZS5tdXRhdGVkS2V5cyA6IHRoaXMubXV0YXRlZEtleXMsIHIgPSBzLCBvID0gITE7XG4gICAgICAgIC8vIFRyYWNrIHRoZSBsYXN0IGRvYyBpbiBhIChmdWxsKSBsaW1pdC4gVGhpcyBpcyBuZWNlc3NhcnksIGJlY2F1c2Ugc29tZVxuICAgICAgICAvLyB1cGRhdGUgKGEgZGVsZXRlLCBvciBhbiB1cGRhdGUgbW92aW5nIGEgZG9jIHBhc3QgdGhlIG9sZCBsaW1pdCkgbWlnaHRcbiAgICAgICAgLy8gbWVhbiB0aGVyZSBpcyBzb21lIG90aGVyIGRvY3VtZW50IGluIHRoZSBsb2NhbCBjYWNoZSB0aGF0IGVpdGhlciBzaG91bGRcbiAgICAgICAgLy8gY29tZSAoMSkgYmV0d2VlbiB0aGUgb2xkIGxhc3QgbGltaXQgZG9jIGFuZCB0aGUgbmV3IGxhc3QgZG9jdW1lbnQsIGluIHRoZVxuICAgICAgICAvLyBjYXNlIG9mIHVwZGF0ZXMsIG9yICgyKSBhZnRlciB0aGUgbmV3IGxhc3QgZG9jdW1lbnQsIGluIHRoZSBjYXNlIG9mXG4gICAgICAgIC8vIGRlbGV0ZXMuIFNvIHdlIGtlZXAgdGhpcyBkb2MgYXQgdGhlIG9sZCBsaW1pdCB0byBjb21wYXJlIHRoZSB1cGRhdGVzIHRvLlxuICAgICAgICAvLyBOb3RlIHRoYXQgdGhpcyBzaG91bGQgbmV2ZXIgZ2V0IHVzZWQgaW4gYSByZWZpbGwgKHdoZW4gcHJldmlvdXNDaGFuZ2VzIGlzXG4gICAgICAgIC8vIHNldCksIGJlY2F1c2UgdGhlcmUgd2lsbCBvbmx5IGJlIGFkZHMgLS0gbm8gZGVsZXRlcyBvciB1cGRhdGVzLlxuICAgICAgICBjb25zdCBhID0gd2UodGhpcy5xdWVyeSkgJiYgcy5zaXplID09PSB0aGlzLnF1ZXJ5LmxpbWl0ID8gcy5sYXN0KCkgOiBudWxsLCBjID0gX2UodGhpcy5xdWVyeSkgJiYgcy5zaXplID09PSB0aGlzLnF1ZXJ5LmxpbWl0ID8gcy5maXJzdCgpIDogbnVsbDtcbiAgICAgICAgLy8gRHJvcCBkb2N1bWVudHMgb3V0IHRvIG1lZXQgbGltaXQvbGltaXRUb0xhc3QgcmVxdWlyZW1lbnQuXG4gICAgICAgIGlmICh0Lmlub3JkZXJUcmF2ZXJzYWwoKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB1ID0gcy5nZXQodCksIGggPSBQZSh0aGlzLnF1ZXJ5LCBlKSA/IGUgOiBudWxsLCBsID0gISF1ICYmIHRoaXMubXV0YXRlZEtleXMuaGFzKHUua2V5KSwgZiA9ICEhaCAmJiAoaC5oYXNMb2NhbE11dGF0aW9ucyB8fCBcbiAgICAgICAgICAgIC8vIFdlIG9ubHkgY29uc2lkZXIgY29tbWl0dGVkIG11dGF0aW9ucyBmb3IgZG9jdW1lbnRzIHRoYXQgd2VyZVxuICAgICAgICAgICAgLy8gbXV0YXRlZCBkdXJpbmcgdGhlIGxpZmV0aW1lIG9mIHRoZSB2aWV3LlxuICAgICAgICAgICAgdGhpcy5tdXRhdGVkS2V5cy5oYXMoaC5rZXkpICYmIGguaGFzQ29tbWl0dGVkTXV0YXRpb25zKTtcbiAgICAgICAgICAgIGxldCBkID0gITE7XG4gICAgICAgICAgICAvLyBDYWxjdWxhdGUgY2hhbmdlXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodSAmJiBoKSB7XG4gICAgICAgICAgICAgICAgdS5kYXRhLmlzRXF1YWwoaC5kYXRhKSA/IGwgIT09IGYgJiYgKG4udHJhY2soe1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAzIC8qIE1ldGFkYXRhICovICxcbiAgICAgICAgICAgICAgICAgICAgZG9jOiBoXG4gICAgICAgICAgICAgICAgfSksIGQgPSAhMCkgOiB0aGlzLlJvKHUsIGgpIHx8IChuLnRyYWNrKHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogMiAvKiBNb2RpZmllZCAqLyAsXG4gICAgICAgICAgICAgICAgICAgIGRvYzogaFxuICAgICAgICAgICAgICAgIH0pLCBkID0gITAsIChhICYmIHRoaXMucG8oaCwgYSkgPiAwIHx8IGMgJiYgdGhpcy5wbyhoLCBjKSA8IDApICYmIChcbiAgICAgICAgICAgICAgICAvLyBUaGlzIGRvYyBtb3ZlZCBmcm9tIGluc2lkZSB0aGUgbGltaXQgdG8gb3V0c2lkZSB0aGUgbGltaXQuXG4gICAgICAgICAgICAgICAgLy8gVGhhdCBtZWFucyB0aGVyZSBtYXkgYmUgc29tZSBvdGhlciBkb2MgaW4gdGhlIGxvY2FsIGNhY2hlXG4gICAgICAgICAgICAgICAgLy8gdGhhdCBzaG91bGQgYmUgaW5jbHVkZWQgaW5zdGVhZC5cbiAgICAgICAgICAgICAgICBvID0gITApKTtcbiAgICAgICAgICAgIH0gZWxzZSAhdSAmJiBoID8gKG4udHJhY2soe1xuICAgICAgICAgICAgICAgIHR5cGU6IDAgLyogQWRkZWQgKi8gLFxuICAgICAgICAgICAgICAgIGRvYzogaFxuICAgICAgICAgICAgfSksIGQgPSAhMCkgOiB1ICYmICFoICYmIChuLnRyYWNrKHtcbiAgICAgICAgICAgICAgICB0eXBlOiAxIC8qIFJlbW92ZWQgKi8gLFxuICAgICAgICAgICAgICAgIGRvYzogdVxuICAgICAgICAgICAgfSksIGQgPSAhMCwgKGEgfHwgYykgJiYgKFxuICAgICAgICAgICAgLy8gQSBkb2Mgd2FzIHJlbW92ZWQgZnJvbSBhIGZ1bGwgbGltaXQgcXVlcnkuIFdlJ2xsIG5lZWQgdG9cbiAgICAgICAgICAgIC8vIHJlcXVlcnkgZnJvbSB0aGUgbG9jYWwgY2FjaGUgdG8gc2VlIGlmIHdlIGtub3cgYWJvdXQgc29tZSBvdGhlclxuICAgICAgICAgICAgLy8gZG9jIHRoYXQgc2hvdWxkIGJlIGluIHRoZSByZXN1bHRzLlxuICAgICAgICAgICAgbyA9ICEwKSk7XG4gICAgICAgICAgICBkICYmIChoID8gKHIgPSByLmFkZChoKSwgaSA9IGYgPyBpLmFkZCh0KSA6IGkuZGVsZXRlKHQpKSA6IChyID0gci5kZWxldGUodCksIGkgPSBpLmRlbGV0ZSh0KSkpO1xuICAgICAgICB9KSksIHdlKHRoaXMucXVlcnkpIHx8IF9lKHRoaXMucXVlcnkpKSBmb3IgKDtyLnNpemUgPiB0aGlzLnF1ZXJ5LmxpbWl0OyApIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSB3ZSh0aGlzLnF1ZXJ5KSA/IHIubGFzdCgpIDogci5maXJzdCgpO1xuICAgICAgICAgICAgciA9IHIuZGVsZXRlKHQua2V5KSwgaSA9IGkuZGVsZXRlKHQua2V5KSwgbi50cmFjayh7XG4gICAgICAgICAgICAgICAgdHlwZTogMSAvKiBSZW1vdmVkICovICxcbiAgICAgICAgICAgICAgICBkb2M6IHRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBFbzogcixcbiAgICAgICAgICAgIEFvOiBuLFxuICAgICAgICAgICAgTG46IG8sXG4gICAgICAgICAgICBtdXRhdGVkS2V5czogaVxuICAgICAgICB9O1xuICAgIH1cbiAgICBSbyh0LCBlKSB7XG4gICAgICAgIC8vIFdlIHN1cHByZXNzIHRoZSBpbml0aWFsIGNoYW5nZSBldmVudCBmb3IgZG9jdW1lbnRzIHRoYXQgd2VyZSBtb2RpZmllZCBhc1xuICAgICAgICAvLyBwYXJ0IG9mIGEgd3JpdGUgYWNrbm93bGVkZ21lbnQgKGUuZy4gd2hlbiB0aGUgdmFsdWUgb2YgYSBzZXJ2ZXIgdHJhbnNmb3JtXG4gICAgICAgIC8vIGlzIGFwcGxpZWQpIGFzIFdhdGNoIHdpbGwgc2VuZCB1cyB0aGUgc2FtZSBkb2N1bWVudCBhZ2Fpbi5cbiAgICAgICAgLy8gQnkgc3VwcHJlc3NpbmcgdGhlIGV2ZW50LCB3ZSBvbmx5IHJhaXNlIHR3byB1c2VyIHZpc2libGUgZXZlbnRzIChvbmUgd2l0aFxuICAgICAgICAvLyBgaGFzUGVuZGluZ1dyaXRlc2AgYW5kIHRoZSBmaW5hbCBzdGF0ZSBvZiB0aGUgZG9jdW1lbnQpIGluc3RlYWQgb2YgdGhyZWVcbiAgICAgICAgLy8gKG9uZSB3aXRoIGBoYXNQZW5kaW5nV3JpdGVzYCwgdGhlIG1vZGlmaWVkIGRvY3VtZW50IHdpdGhcbiAgICAgICAgLy8gYGhhc1BlbmRpbmdXcml0ZXNgIGFuZCB0aGUgZmluYWwgc3RhdGUgb2YgdGhlIGRvY3VtZW50KS5cbiAgICAgICAgcmV0dXJuIHQuaGFzTG9jYWxNdXRhdGlvbnMgJiYgZS5oYXNDb21taXR0ZWRNdXRhdGlvbnMgJiYgIWUuaGFzTG9jYWxNdXRhdGlvbnM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVwZGF0ZXMgdGhlIHZpZXcgd2l0aCB0aGUgZ2l2ZW4gVmlld0RvY3VtZW50Q2hhbmdlcyBhbmQgb3B0aW9uYWxseSB1cGRhdGVzXG4gICAgICogbGltYm8gZG9jcyBhbmQgc3luYyBzdGF0ZSBmcm9tIHRoZSBwcm92aWRlZCB0YXJnZXQgY2hhbmdlLlxuICAgICAqIEBwYXJhbSBkb2NDaGFuZ2VzIC0gVGhlIHNldCBvZiBjaGFuZ2VzIHRvIG1ha2UgdG8gdGhlIHZpZXcncyBkb2NzLlxuICAgICAqIEBwYXJhbSB1cGRhdGVMaW1ib0RvY3VtZW50cyAtIFdoZXRoZXIgdG8gdXBkYXRlIGxpbWJvIGRvY3VtZW50cyBiYXNlZCBvblxuICAgICAqICAgICAgICB0aGlzIGNoYW5nZS5cbiAgICAgKiBAcGFyYW0gdGFyZ2V0Q2hhbmdlIC0gQSB0YXJnZXQgY2hhbmdlIHRvIGFwcGx5IGZvciBjb21wdXRpbmcgbGltYm8gZG9jcyBhbmRcbiAgICAgKiAgICAgICAgc3luYyBzdGF0ZS5cbiAgICAgKiBAcmV0dXJucyBBIG5ldyBWaWV3Q2hhbmdlIHdpdGggdGhlIGdpdmVuIGRvY3MsIGNoYW5nZXMsIGFuZCBzeW5jIHN0YXRlLlxuICAgICAqL1xuICAgIC8vIFBPUlRJTkcgTk9URTogVGhlIGlPUy9BbmRyb2lkIGNsaWVudHMgYWx3YXlzIGNvbXB1dGUgbGltYm8gZG9jdW1lbnQgY2hhbmdlcy5cbiAgICBhcHBseUNoYW5nZXModCwgZSwgbikge1xuICAgICAgICBjb25zdCBzID0gdGhpcy5FbztcbiAgICAgICAgdGhpcy5FbyA9IHQuRW8sIHRoaXMubXV0YXRlZEtleXMgPSB0Lm11dGF0ZWRLZXlzO1xuICAgICAgICAvLyBTb3J0IGNoYW5nZXMgYmFzZWQgb24gdHlwZSBhbmQgcXVlcnkgY29tcGFyYXRvclxuICAgICAgICBjb25zdCBpID0gdC5Bby5ZcigpO1xuICAgICAgICBpLnNvcnQoKCh0LCBlKSA9PiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gdCA9PiB7XG4gICAgICAgICAgICAgICAgc3dpdGNoICh0KSB7XG4gICAgICAgICAgICAgICAgICBjYXNlIDAgLyogQWRkZWQgKi8gOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTtcblxuICAgICAgICAgICAgICAgICAgY2FzZSAyIC8qIE1vZGlmaWVkICovIDpcbiAgICAgICAgICAgICAgICAgIGNhc2UgMyAvKiBNZXRhZGF0YSAqLyA6XG4gICAgICAgICAgICAgICAgICAgIC8vIEEgbWV0YWRhdGEgY2hhbmdlIGlzIGNvbnZlcnRlZCB0byBhIG1vZGlmaWVkIGNoYW5nZSBhdCB0aGUgcHVibGljXG4gICAgICAgICAgICAgICAgICAgIC8vIGFwaSBsYXllci4gIFNpbmNlIHdlIHNvcnQgYnkgZG9jdW1lbnQga2V5IGFuZCB0aGVuIGNoYW5nZSB0eXBlLFxuICAgICAgICAgICAgICAgICAgICAvLyBtZXRhZGF0YSBhbmQgbW9kaWZpZWQgY2hhbmdlcyBtdXN0IGJlIHNvcnRlZCBlcXVpdmFsZW50bHkuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAyO1xuXG4gICAgICAgICAgICAgICAgICBjYXNlIDEgLyogUmVtb3ZlZCAqLyA6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAwO1xuXG4gICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gTSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gbih0KSAtIG4oZSk7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gKHQudHlwZSwgZS50eXBlKSB8fCB0aGlzLnBvKHQuZG9jLCBlLmRvYykpKSwgdGhpcy5QbyhuKTtcbiAgICAgICAgY29uc3QgciA9IGUgPyB0aGlzLmJvKCkgOiBbXSwgbyA9IDAgPT09IHRoaXMueW8uc2l6ZSAmJiB0aGlzLmN1cnJlbnQgPyAxIC8qIFN5bmNlZCAqLyA6IDAgLyogTG9jYWwgKi8gLCBhID0gbyAhPT0gdGhpcy5tbztcbiAgICAgICAgaWYgKHRoaXMubW8gPSBvLCAwICE9PSBpLmxlbmd0aCB8fCBhKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHNuYXBzaG90OiBuZXcgT28odGhpcy5xdWVyeSwgdC5FbywgcywgaSwgdC5tdXRhdGVkS2V5cywgMCAvKiBMb2NhbCAqLyA9PT0gbywgYSwgXG4gICAgICAgICAgICAgICAgLyogZXhjbHVkZXNNZXRhZGF0YUNoYW5nZXM9ICovICExKSxcbiAgICAgICAgICAgICAgICB2bzogclxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICAvLyBubyBjaGFuZ2VzXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB2bzogclxuICAgICAgICB9O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBcHBsaWVzIGFuIE9ubGluZVN0YXRlIGNoYW5nZSB0byB0aGUgdmlldywgcG90ZW50aWFsbHkgZ2VuZXJhdGluZyBhXG4gICAgICogVmlld0NoYW5nZSBpZiB0aGUgdmlldydzIHN5bmNTdGF0ZSBjaGFuZ2VzIGFzIGEgcmVzdWx0LlxuICAgICAqLyAgICBlbyh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmN1cnJlbnQgJiYgXCJPZmZsaW5lXCIgLyogT2ZmbGluZSAqLyA9PT0gdCA/IChcbiAgICAgICAgLy8gSWYgd2UncmUgb2ZmbGluZSwgc2V0IGBjdXJyZW50YCB0byBmYWxzZSBhbmQgdGhlbiBjYWxsIGFwcGx5Q2hhbmdlcygpXG4gICAgICAgIC8vIHRvIHJlZnJlc2ggb3VyIHN5bmNTdGF0ZSBhbmQgZ2VuZXJhdGUgYSBWaWV3Q2hhbmdlIGFzIGFwcHJvcHJpYXRlLiBXZVxuICAgICAgICAvLyBhcmUgZ3VhcmFudGVlZCB0byBnZXQgYSBuZXcgVGFyZ2V0Q2hhbmdlIHRoYXQgc2V0cyBgY3VycmVudGAgYmFjayB0b1xuICAgICAgICAvLyB0cnVlIG9uY2UgdGhlIGNsaWVudCBpcyBiYWNrIG9ubGluZS5cbiAgICAgICAgdGhpcy5jdXJyZW50ID0gITEsIHRoaXMuYXBwbHlDaGFuZ2VzKHtcbiAgICAgICAgICAgIEVvOiB0aGlzLkVvLFxuICAgICAgICAgICAgQW86IG5ldyAkbyxcbiAgICAgICAgICAgIG11dGF0ZWRLZXlzOiB0aGlzLm11dGF0ZWRLZXlzLFxuICAgICAgICAgICAgTG46ICExXG4gICAgICAgIH0sIFxuICAgICAgICAvKiB1cGRhdGVMaW1ib0RvY3VtZW50cz0gKi8gITEpKSA6IHtcbiAgICAgICAgICAgIHZvOiBbXVxuICAgICAgICB9O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHdoZXRoZXIgdGhlIGRvYyBmb3IgdGhlIGdpdmVuIGtleSBzaG91bGQgYmUgaW4gbGltYm8uXG4gICAgICovICAgIFZvKHQpIHtcbiAgICAgICAgLy8gSWYgdGhlIHJlbW90ZSBlbmQgc2F5cyBpdCdzIHBhcnQgb2YgdGhpcyBxdWVyeSwgaXQncyBub3QgaW4gbGltYm8uXG4gICAgICAgIHJldHVybiAhdGhpcy5fby5oYXModCkgJiYgKFxuICAgICAgICAvLyBUaGUgbG9jYWwgc3RvcmUgZG9lc24ndCB0aGluayBpdCdzIGEgcmVzdWx0LCBzbyBpdCBzaG91bGRuJ3QgYmUgaW4gbGltYm8uXG4gICAgICAgICEhdGhpcy5Fby5oYXModCkgJiYgIXRoaXMuRW8uZ2V0KHQpLmhhc0xvY2FsTXV0YXRpb25zKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVXBkYXRlcyBzeW5jZWREb2N1bWVudHMsIGN1cnJlbnQsIGFuZCBsaW1ibyBkb2NzIGJhc2VkIG9uIHRoZSBnaXZlbiBjaGFuZ2UuXG4gICAgICogUmV0dXJucyB0aGUgbGlzdCBvZiBjaGFuZ2VzIHRvIHdoaWNoIGRvY3MgYXJlIGluIGxpbWJvLlxuICAgICAqLyAgICBQbyh0KSB7XG4gICAgICAgIHQgJiYgKHQuYWRkZWREb2N1bWVudHMuZm9yRWFjaCgodCA9PiB0aGlzLl9vID0gdGhpcy5fby5hZGQodCkpKSwgdC5tb2RpZmllZERvY3VtZW50cy5mb3JFYWNoKCh0ID0+IHt9KSksIFxuICAgICAgICB0LnJlbW92ZWREb2N1bWVudHMuZm9yRWFjaCgodCA9PiB0aGlzLl9vID0gdGhpcy5fby5kZWxldGUodCkpKSwgdGhpcy5jdXJyZW50ID0gdC5jdXJyZW50KTtcbiAgICB9XG4gICAgYm8oKSB7XG4gICAgICAgIC8vIFdlIGNhbiBvbmx5IGRldGVybWluZSBsaW1ibyBkb2N1bWVudHMgd2hlbiB3ZSdyZSBpbi1zeW5jIHdpdGggdGhlIHNlcnZlci5cbiAgICAgICAgaWYgKCF0aGlzLmN1cnJlbnQpIHJldHVybiBbXTtcbiAgICAgICAgLy8gVE9ETyhrbGltdCk6IERvIHRoaXMgaW5jcmVtZW50YWxseSBzbyB0aGF0IGl0J3Mgbm90IHF1YWRyYXRpYyB3aGVuXG4gICAgICAgIC8vIHVwZGF0aW5nIG1hbnkgZG9jdW1lbnRzLlxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLnlvO1xuICAgICAgICB0aGlzLnlvID0gUG4oKSwgdGhpcy5Fby5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgIHRoaXMuVm8odC5rZXkpICYmICh0aGlzLnlvID0gdGhpcy55by5hZGQodC5rZXkpKTtcbiAgICAgICAgfSkpO1xuICAgICAgICAvLyBEaWZmIHRoZSBuZXcgbGltYm8gZG9jcyB3aXRoIHRoZSBvbGQgbGltYm8gZG9jcy5cbiAgICAgICAgY29uc3QgZSA9IFtdO1xuICAgICAgICByZXR1cm4gdC5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgIHRoaXMueW8uaGFzKHQpIHx8IGUucHVzaChuZXcgSm8odCkpO1xuICAgICAgICB9KSksIHRoaXMueW8uZm9yRWFjaCgobiA9PiB7XG4gICAgICAgICAgICB0LmhhcyhuKSB8fCBlLnB1c2gobmV3IEhvKG4pKTtcbiAgICAgICAgfSkpLCBlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgdGhlIGluLW1lbW9yeSBzdGF0ZSBvZiB0aGUgY3VycmVudCB2aWV3IHdpdGggdGhlIHN0YXRlIHJlYWQgZnJvbVxuICAgICAqIHBlcnNpc3RlbmNlLlxuICAgICAqXG4gICAgICogV2UgdXBkYXRlIHRoZSBxdWVyeSB2aWV3IHdoZW5ldmVyIGEgY2xpZW50J3MgcHJpbWFyeSBzdGF0dXMgY2hhbmdlczpcbiAgICAgKiAtIFdoZW4gYSBjbGllbnQgdHJhbnNpdGlvbnMgZnJvbSBwcmltYXJ5IHRvIHNlY29uZGFyeSwgaXQgY2FuIG1pc3NcbiAgICAgKiAgIExvY2FsU3RvcmFnZSB1cGRhdGVzIGFuZCBpdHMgcXVlcnkgdmlld3MgbWF5IHRlbXBvcmFyaWx5IG5vdCBiZVxuICAgICAqICAgc3luY2hyb25pemVkIHdpdGggdGhlIHN0YXRlIG9uIGRpc2suXG4gICAgICogLSBGb3Igc2Vjb25kYXJ5IHRvIHByaW1hcnkgdHJhbnNpdGlvbnMsIHRoZSBjbGllbnQgbmVlZHMgdG8gdXBkYXRlIHRoZSBsaXN0XG4gICAgICogICBvZiBgc3luY2VkRG9jdW1lbnRzYCBzaW5jZSBzZWNvbmRhcnkgY2xpZW50cyB1cGRhdGUgdGhlaXIgcXVlcnkgdmlld3NcbiAgICAgKiAgIGJhc2VkIHB1cmVseSBvbiBzeW50aGVzaXplZCBSZW1vdGVFdmVudHMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcXVlcnlSZXN1bHQuZG9jdW1lbnRzIC0gVGhlIGRvY3VtZW50cyB0aGF0IG1hdGNoIHRoZSBxdWVyeSBhY2NvcmRpbmdcbiAgICAgKiB0byB0aGUgTG9jYWxTdG9yZS5cbiAgICAgKiBAcGFyYW0gcXVlcnlSZXN1bHQucmVtb3RlS2V5cyAtIFRoZSBrZXlzIG9mIHRoZSBkb2N1bWVudHMgdGhhdCBtYXRjaCB0aGVcbiAgICAgKiBxdWVyeSBhY2NvcmRpbmcgdG8gdGhlIGJhY2tlbmQuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBUaGUgVmlld0NoYW5nZSB0aGF0IHJlc3VsdGVkIGZyb20gdGhpcyBzeW5jaHJvbml6YXRpb24uXG4gICAgICovXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seS5cbiAgICBTbyh0KSB7XG4gICAgICAgIHRoaXMuX28gPSB0LkduLCB0aGlzLnlvID0gUG4oKTtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuSW8odC5kb2N1bWVudHMpO1xuICAgICAgICByZXR1cm4gdGhpcy5hcHBseUNoYW5nZXMoZSwgLyp1cGRhdGVMaW1ib0RvY3VtZW50cz0qLyAhMCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSB2aWV3IHNuYXBzaG90IGFzIGlmIHRoaXMgcXVlcnkgd2FzIGp1c3QgbGlzdGVuZWQgdG8uIENvbnRhaW5zXG4gICAgICogYSBkb2N1bWVudCBhZGQgZm9yIGV2ZXJ5IGV4aXN0aW5nIGRvY3VtZW50IGFuZCB0aGUgYGZyb21DYWNoZWAgYW5kXG4gICAgICogYGhhc1BlbmRpbmdXcml0ZXNgIHN0YXR1cyBvZiB0aGUgYWxyZWFkeSBlc3RhYmxpc2hlZCB2aWV3LlxuICAgICAqL1xuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHkuXG4gICAgRG8oKSB7XG4gICAgICAgIHJldHVybiBPby5mcm9tSW5pdGlhbERvY3VtZW50cyh0aGlzLnF1ZXJ5LCB0aGlzLkVvLCB0aGlzLm11dGF0ZWRLZXlzLCAwIC8qIExvY2FsICovID09PSB0aGlzLm1vKTtcbiAgICB9XG59XG5cbi8qKlxuICogUXVlcnlWaWV3IGNvbnRhaW5zIGFsbCBvZiB0aGUgZGF0YSB0aGF0IFN5bmNFbmdpbmUgbmVlZHMgdG8ga2VlcCB0cmFjayBvZiBmb3JcbiAqIGEgcGFydGljdWxhciBxdWVyeS5cbiAqL1xuY2xhc3MgWG8ge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIFRoZSBxdWVyeSBpdHNlbGYuXG4gICAgICovXG4gICAgdCwgXG4gICAgLyoqXG4gICAgICogVGhlIHRhcmdldCBudW1iZXIgY3JlYXRlZCBieSB0aGUgY2xpZW50IHRoYXQgaXMgdXNlZCBpbiB0aGUgd2F0Y2hcbiAgICAgKiBzdHJlYW0gdG8gaWRlbnRpZnkgdGhpcyBxdWVyeS5cbiAgICAgKi9cbiAgICBlLCBcbiAgICAvKipcbiAgICAgKiBUaGUgdmlldyBpcyByZXNwb25zaWJsZSBmb3IgY29tcHV0aW5nIHRoZSBmaW5hbCBtZXJnZWQgdHJ1dGggb2Ygd2hhdFxuICAgICAqIGRvY3MgYXJlIGluIHRoZSBxdWVyeS4gSXQgZ2V0cyBub3RpZmllZCBvZiBsb2NhbCBhbmQgcmVtb3RlIGNoYW5nZXMsXG4gICAgICogYW5kIGFwcGxpZXMgdGhlIHF1ZXJ5IGZpbHRlcnMgYW5kIGxpbWl0cyB0byBkZXRlcm1pbmUgdGhlIG1vc3QgY29ycmVjdFxuICAgICAqIHBvc3NpYmxlIHJlc3VsdHMuXG4gICAgICovXG4gICAgbikge1xuICAgICAgICB0aGlzLnF1ZXJ5ID0gdCwgdGhpcy50YXJnZXRJZCA9IGUsIHRoaXMudmlldyA9IG47XG4gICAgfVxufVxuXG4vKiogVHJhY2tzIGEgbGltYm8gcmVzb2x1dGlvbi4gKi8gY2xhc3MgWm8ge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5rZXkgPSB0LCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNldCB0byB0cnVlIG9uY2Ugd2UndmUgcmVjZWl2ZWQgYSBkb2N1bWVudC4gVGhpcyBpcyB1c2VkIGluXG4gICAgICAgICAqIGdldFJlbW90ZUtleXNGb3JUYXJnZXQoKSBhbmQgdWx0aW1hdGVseSB1c2VkIGJ5IFdhdGNoQ2hhbmdlQWdncmVnYXRvciB0b1xuICAgICAgICAgKiBkZWNpZGUgd2hldGhlciBpdCBuZWVkcyB0byBtYW51ZmFjdHVyZSBhIGRlbGV0ZSBldmVudCBmb3IgdGhlIHRhcmdldCBvbmNlXG4gICAgICAgICAqIHRoZSB0YXJnZXQgaXMgQ1VSUkVOVC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuQ28gPSAhMTtcbiAgICB9XG59XG5cbi8qKlxuICogQW4gaW1wbGVtZW50YXRpb24gb2YgYFN5bmNFbmdpbmVgIGNvb3JkaW5hdGluZyB3aXRoIG90aGVyIHBhcnRzIG9mIFNESy5cbiAqXG4gKiBUaGUgcGFydHMgb2YgU3luY0VuZ2luZSB0aGF0IGFjdCBhcyBhIGNhbGxiYWNrIHRvIFJlbW90ZVN0b3JlIG5lZWQgdG8gYmVcbiAqIHJlZ2lzdGVyZWQgaW5kaXZpZHVhbGx5LiBUaGlzIGlzIGRvbmUgaW4gYHN5bmNFbmdpbmVXcml0ZSgpYCBhbmRcbiAqIGBzeW5jRW5naW5lTGlzdGVuKClgIChhcyB3ZWxsIGFzIGBhcHBseVByaW1hcnlTdGF0ZSgpYCkgYXMgdGhlc2UgbWV0aG9kc1xuICogc2VydmUgYXMgZW50cnkgcG9pbnRzIHRvIFJlbW90ZVN0b3JlJ3MgZnVuY3Rpb25hbGl0eS5cbiAqXG4gKiBOb3RlOiBzb21lIGZpZWxkIGRlZmluZWQgaW4gdGhpcyBjbGFzcyBtaWdodCBoYXZlIHB1YmxpYyBhY2Nlc3MgbGV2ZWwsIGJ1dFxuICogdGhlIGNsYXNzIGlzIG5vdCBleHBvcnRlZCBzbyB0aGV5IGFyZSBvbmx5IGFjY2Vzc2libGUgZnJvbSB0aGlzIG1vZHVsZS5cbiAqIFRoaXMgaXMgdXNlZnVsIHRvIGltcGxlbWVudCBvcHRpb25hbCBmZWF0dXJlcyAobGlrZSBidW5kbGVzKSBpbiBmcmVlXG4gKiBmdW5jdGlvbnMsIHN1Y2ggdGhhdCB0aGV5IGFyZSB0cmVlLXNoYWtlYWJsZS5cbiAqLyBjbGFzcyB0YSB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgXG4gICAgLy8gUE9SVElORyBOT1RFOiBNYW5hZ2VzIHN0YXRlIHN5bmNocm9uaXphdGlvbiBpbiBtdWx0aS10YWIgZW52aXJvbm1lbnRzLlxuICAgIHMsIGksIHIpIHtcbiAgICAgICAgdGhpcy5sb2NhbFN0b3JlID0gdCwgdGhpcy5yZW1vdGVTdG9yZSA9IGUsIHRoaXMuZXZlbnRNYW5hZ2VyID0gbiwgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZSA9IHMsIFxuICAgICAgICB0aGlzLmN1cnJlbnRVc2VyID0gaSwgdGhpcy5tYXhDb25jdXJyZW50TGltYm9SZXNvbHV0aW9ucyA9IHIsIHRoaXMuTm8gPSB7fSwgdGhpcy54byA9IG5ldyBLaSgodCA9PiBBZSh0KSksIEllKSwgXG4gICAgICAgIHRoaXMua28gPSBuZXcgTWFwLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBrZXlzIG9mIGRvY3VtZW50cyB0aGF0IGFyZSBpbiBsaW1ibyBmb3Igd2hpY2ggd2UgaGF2ZW4ndCB5ZXQgc3RhcnRlZCBhXG4gICAgICAgICAqIGxpbWJvIHJlc29sdXRpb24gcXVlcnkuIFRoZSBzdHJpbmdzIGluIHRoaXMgc2V0IGFyZSB0aGUgcmVzdWx0IG9mIGNhbGxpbmdcbiAgICAgICAgICogYGtleS5wYXRoLmNhbm9uaWNhbFN0cmluZygpYCB3aGVyZSBga2V5YCBpcyBhIGBEb2N1bWVudEtleWAgb2JqZWN0LlxuICAgICAgICAgKlxuICAgICAgICAgKiBUaGUgYFNldGAgdHlwZSB3YXMgY2hvc2VuIGJlY2F1c2UgaXQgcHJvdmlkZXMgZWZmaWNpZW50IGxvb2t1cCBhbmQgcmVtb3ZhbFxuICAgICAgICAgKiBvZiBhcmJpdHJhcnkgZWxlbWVudHMgYW5kIGl0IGFsc28gbWFpbnRhaW5zIGluc2VydGlvbiBvcmRlciwgcHJvdmlkaW5nIHRoZVxuICAgICAgICAgKiBkZXNpcmVkIHF1ZXVlLWxpa2UgRklGTyBzZW1hbnRpY3MuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLiRvID0gbmV3IFNldCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBLZWVwcyB0cmFjayBvZiB0aGUgdGFyZ2V0IElEIGZvciBlYWNoIGRvY3VtZW50IHRoYXQgaXMgaW4gbGltYm8gd2l0aCBhblxuICAgICAgICAgKiBhY3RpdmUgdGFyZ2V0LlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5PbyA9IG5ldyBkbihQdC5jb21wYXJhdG9yKSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBLZWVwcyB0cmFjayBvZiB0aGUgaW5mb3JtYXRpb24gYWJvdXQgYW4gYWN0aXZlIGxpbWJvIHJlc29sdXRpb24gZm9yIGVhY2hcbiAgICAgICAgICogYWN0aXZlIHRhcmdldCBJRCB0aGF0IHdhcyBzdGFydGVkIGZvciB0aGUgcHVycG9zZSBvZiBsaW1ibyByZXNvbHV0aW9uLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5GbyA9IG5ldyBNYXAsIHRoaXMuTW8gPSBuZXcgUnIsIFxuICAgICAgICAvKiogU3RvcmVzIHVzZXIgY29tcGxldGlvbiBoYW5kbGVycywgaW5kZXhlZCBieSBVc2VyIGFuZCBCYXRjaElkLiAqL1xuICAgICAgICB0aGlzLkxvID0ge30sIFxuICAgICAgICAvKiogU3RvcmVzIHVzZXIgY2FsbGJhY2tzIHdhaXRpbmcgZm9yIGFsbCBwZW5kaW5nIHdyaXRlcyB0byBiZSBhY2tub3dsZWRnZWQuICovXG4gICAgICAgIHRoaXMuQm8gPSBuZXcgTWFwLCB0aGlzLlVvID0gQ2kuaWUoKSwgdGhpcy5vbmxpbmVTdGF0ZSA9IFwiVW5rbm93blwiIC8qIFVua25vd24gKi8gLCBcbiAgICAgICAgLy8gVGhlIHByaW1hcnkgc3RhdGUgaXMgc2V0IHRvIGB0cnVlYCBvciBgZmFsc2VgIGltbWVkaWF0ZWx5IGFmdGVyIEZpcmVzdG9yZVxuICAgICAgICAvLyBzdGFydHVwLiBJbiB0aGUgaW50ZXJpbSwgYSBjbGllbnQgc2hvdWxkIG9ubHkgYmUgY29uc2lkZXJlZCBwcmltYXJ5IGlmXG4gICAgICAgIC8vIGBpc1ByaW1hcnlgIGlzIHRydWUuXG4gICAgICAgIHRoaXMucW8gPSB2b2lkIDA7XG4gICAgfVxuICAgIGdldCBpc1ByaW1hcnlDbGllbnQoKSB7XG4gICAgICAgIHJldHVybiAhMCA9PT0gdGhpcy5xbztcbiAgICB9XG59XG5cbi8qKlxuICogSW5pdGlhdGVzIHRoZSBuZXcgbGlzdGVuLCByZXNvbHZlcyBwcm9taXNlIHdoZW4gbGlzdGVuIGVucXVldWVkIHRvIHRoZVxuICogc2VydmVyLiBBbGwgdGhlIHN1YnNlcXVlbnQgdmlldyBzbmFwc2hvdHMgb3IgZXJyb3JzIGFyZSBzZW50IHRvIHRoZVxuICogc3Vic2NyaWJlZCBoYW5kbGVycy4gUmV0dXJucyB0aGUgaW5pdGlhbCBzbmFwc2hvdC5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gZWEodCwgZSkge1xuICAgIGNvbnN0IG4gPSBEYSh0KTtcbiAgICBsZXQgcywgaTtcbiAgICBjb25zdCByID0gbi54by5nZXQoZSk7XG4gICAgaWYgKHIpIFxuICAgIC8vIFBPUlRJTkcgTk9URTogV2l0aCBNdWx0aS1UYWIgV2ViLCBpdCBpcyBwb3NzaWJsZSB0aGF0IGEgcXVlcnkgdmlld1xuICAgIC8vIGFscmVhZHkgZXhpc3RzIHdoZW4gRXZlbnRNYW5hZ2VyIGNhbGxzIHVzIGZvciB0aGUgZmlyc3QgdGltZS4gVGhpc1xuICAgIC8vIGhhcHBlbnMgd2hlbiB0aGUgcHJpbWFyeSB0YWIgaXMgYWxyZWFkeSBsaXN0ZW5pbmcgdG8gdGhpcyBxdWVyeSBvblxuICAgIC8vIGJlaGFsZiBvZiBhbm90aGVyIHRhYiBhbmQgdGhlIHVzZXIgb2YgdGhlIHByaW1hcnkgYWxzbyBzdGFydHMgbGlzdGVuaW5nXG4gICAgLy8gdG8gdGhlIHF1ZXJ5LiBFdmVudE1hbmFnZXIgd2lsbCBub3QgaGF2ZSBhbiBhc3NpZ25lZCB0YXJnZXQgSUQgaW4gdGhpc1xuICAgIC8vIGNhc2UgYW5kIGNhbGxzIGBsaXN0ZW5gIHRvIG9idGFpbiB0aGlzIElELlxuICAgIHMgPSByLnRhcmdldElkLCBuLnNoYXJlZENsaWVudFN0YXRlLmFkZExvY2FsUXVlcnlUYXJnZXQocyksIGkgPSByLnZpZXcuRG8oKTsgZWxzZSB7XG4gICAgICAgIGNvbnN0IHQgPSBhd2FpdCBfcihuLmxvY2FsU3RvcmUsIEVlKGUpKSwgciA9IG4uc2hhcmVkQ2xpZW50U3RhdGUuYWRkTG9jYWxRdWVyeVRhcmdldCh0LnRhcmdldElkKTtcbiAgICAgICAgcyA9IHQudGFyZ2V0SWQsIGkgPSBhd2FpdCBuYShuLCBlLCBzLCBcImN1cnJlbnRcIiA9PT0gciksIG4uaXNQcmltYXJ5Q2xpZW50ICYmIG9vKG4ucmVtb3RlU3RvcmUsIHQpO1xuICAgIH1cbiAgICByZXR1cm4gaTtcbn1cblxuLyoqXG4gKiBSZWdpc3RlcnMgYSB2aWV3IGZvciBhIHByZXZpb3VzbHkgdW5rbm93biBxdWVyeSBhbmQgY29tcHV0ZXMgaXRzIGluaXRpYWxcbiAqIHNuYXBzaG90LlxuICovIGFzeW5jIGZ1bmN0aW9uIG5hKHQsIGUsIG4sIHMpIHtcbiAgICAvLyBQT1JUSU5HIE5PVEU6IE9uIFdlYiBvbmx5LCB3ZSBpbmplY3QgdGhlIGNvZGUgdGhhdCByZWdpc3RlcnMgbmV3IExpbWJvXG4gICAgLy8gdGFyZ2V0cyBiYXNlZCBvbiB2aWV3IGNoYW5nZXMuIFRoaXMgYWxsb3dzIHVzIHRvIG9ubHkgZGVwZW5kIG9uIExpbWJvXG4gICAgLy8gY2hhbmdlcyB3aGVuIHVzZXIgY29kZSBpbmNsdWRlcyBxdWVyaWVzLlxuICAgIHQuS28gPSAoZSwgbiwgcykgPT4gYXN5bmMgZnVuY3Rpb24odCwgZSwgbiwgcykge1xuICAgICAgICBsZXQgaSA9IGUudmlldy5JbyhuKTtcbiAgICAgICAgaS5MbiAmJiAoXG4gICAgICAgIC8vIFRoZSBxdWVyeSBoYXMgYSBsaW1pdCBhbmQgc29tZSBkb2NzIHdlcmUgcmVtb3ZlZCwgc28gd2UgbmVlZFxuICAgICAgICAvLyB0byByZS1ydW4gdGhlIHF1ZXJ5IGFnYWluc3QgdGhlIGxvY2FsIHN0b3JlIHRvIG1ha2Ugc3VyZSB3ZVxuICAgICAgICAvLyBkaWRuJ3QgbG9zZSBhbnkgZ29vZCBkb2NzIHRoYXQgaGFkIGJlZW4gcGFzdCB0aGUgbGltaXQuXG4gICAgICAgIGkgPSBhd2FpdCBncih0LmxvY2FsU3RvcmUsIGUucXVlcnksIFxuICAgICAgICAvKiB1c2VQcmV2aW91c1Jlc3VsdHM9ICovICExKS50aGVuKCgoe2RvY3VtZW50czogdH0pID0+IGUudmlldy5Jbyh0LCBpKSkpKTtcbiAgICAgICAgY29uc3QgciA9IHMgJiYgcy50YXJnZXRDaGFuZ2VzLmdldChlLnRhcmdldElkKSwgbyA9IGUudmlldy5hcHBseUNoYW5nZXMoaSwgXG4gICAgICAgIC8qIHVwZGF0ZUxpbWJvRG9jdW1lbnRzPSAqLyB0LmlzUHJpbWFyeUNsaWVudCwgcik7XG4gICAgICAgIHJldHVybiBfYSh0LCBlLnRhcmdldElkLCBvLnZvKSwgby5zbmFwc2hvdDtcbiAgICB9KHQsIGUsIG4sIHMpO1xuICAgIGNvbnN0IGkgPSBhd2FpdCBncih0LmxvY2FsU3RvcmUsIGUsIFxuICAgIC8qIHVzZVByZXZpb3VzUmVzdWx0cz0gKi8gITApLCByID0gbmV3IFlvKGUsIGkuR24pLCBvID0gci5JbyhpLmRvY3VtZW50cyksIGEgPSBTbi5jcmVhdGVTeW50aGVzaXplZFRhcmdldENoYW5nZUZvckN1cnJlbnRDaGFuZ2UobiwgcyAmJiBcIk9mZmxpbmVcIiAvKiBPZmZsaW5lICovICE9PSB0Lm9ubGluZVN0YXRlKSwgYyA9IHIuYXBwbHlDaGFuZ2VzKG8sIFxuICAgIC8qIHVwZGF0ZUxpbWJvRG9jdW1lbnRzPSAqLyB0LmlzUHJpbWFyeUNsaWVudCwgYSk7XG4gICAgX2EodCwgbiwgYy52byk7XG4gICAgY29uc3QgdSA9IG5ldyBYbyhlLCBuLCByKTtcbiAgICByZXR1cm4gdC54by5zZXQoZSwgdSksIHQua28uaGFzKG4pID8gdC5rby5nZXQobikucHVzaChlKSA6IHQua28uc2V0KG4sIFsgZSBdKSwgYy5zbmFwc2hvdDtcbn1cblxuLyoqIFN0b3BzIGxpc3RlbmluZyB0byB0aGUgcXVlcnkuICovIGFzeW5jIGZ1bmN0aW9uIHNhKHQsIGUpIHtcbiAgICBjb25zdCBuID0gVSh0KSwgcyA9IG4ueG8uZ2V0KGUpLCBpID0gbi5rby5nZXQocy50YXJnZXRJZCk7XG4gICAgaWYgKGkubGVuZ3RoID4gMSkgcmV0dXJuIG4ua28uc2V0KHMudGFyZ2V0SWQsIGkuZmlsdGVyKCh0ID0+ICFJZSh0LCBlKSkpKSwgdm9pZCBuLnhvLmRlbGV0ZShlKTtcbiAgICAvLyBObyBvdGhlciBxdWVyaWVzIGFyZSBtYXBwZWQgdG8gdGhlIHRhcmdldCwgY2xlYW4gdXAgdGhlIHF1ZXJ5IGFuZCB0aGUgdGFyZ2V0LlxuICAgICAgICBpZiAobi5pc1ByaW1hcnlDbGllbnQpIHtcbiAgICAgICAgLy8gV2UgbmVlZCB0byByZW1vdmUgdGhlIGxvY2FsIHF1ZXJ5IHRhcmdldCBmaXJzdCB0byBhbGxvdyB1cyB0byB2ZXJpZnlcbiAgICAgICAgLy8gd2hldGhlciBhbnkgb3RoZXIgY2xpZW50IGlzIHN0aWxsIGludGVyZXN0ZWQgaW4gdGhpcyB0YXJnZXQuXG4gICAgICAgIG4uc2hhcmVkQ2xpZW50U3RhdGUucmVtb3ZlTG9jYWxRdWVyeVRhcmdldChzLnRhcmdldElkKTtcbiAgICAgICAgbi5zaGFyZWRDbGllbnRTdGF0ZS5pc0FjdGl2ZVF1ZXJ5VGFyZ2V0KHMudGFyZ2V0SWQpIHx8IGF3YWl0IG1yKG4ubG9jYWxTdG9yZSwgcy50YXJnZXRJZCwgXG4gICAgICAgIC8qa2VlcFBlcnNpc3RlZFRhcmdldERhdGE9Ki8gITEpLnRoZW4oKCgpID0+IHtcbiAgICAgICAgICAgIG4uc2hhcmVkQ2xpZW50U3RhdGUuY2xlYXJRdWVyeVN0YXRlKHMudGFyZ2V0SWQpLCBhbyhuLnJlbW90ZVN0b3JlLCBzLnRhcmdldElkKSwgXG4gICAgICAgICAgICBkYShuLCBzLnRhcmdldElkKTtcbiAgICAgICAgfSkpLmNhdGNoKE9pKTtcbiAgICB9IGVsc2UgZGEobiwgcy50YXJnZXRJZCksIGF3YWl0IG1yKG4ubG9jYWxTdG9yZSwgcy50YXJnZXRJZCwgXG4gICAgLyprZWVwUGVyc2lzdGVkVGFyZ2V0RGF0YT0qLyAhMCk7XG59XG5cbi8qKlxuICogSW5pdGlhdGVzIHRoZSB3cml0ZSBvZiBsb2NhbCBtdXRhdGlvbiBiYXRjaCB3aGljaCBpbnZvbHZlcyBhZGRpbmcgdGhlXG4gKiB3cml0ZXMgdG8gdGhlIG11dGF0aW9uIHF1ZXVlLCBub3RpZnlpbmcgdGhlIHJlbW90ZSBzdG9yZSBhYm91dCBuZXdcbiAqIG11dGF0aW9ucyBhbmQgcmFpc2luZyBldmVudHMgZm9yIGFueSBjaGFuZ2VzIHRoaXMgd3JpdGUgY2F1c2VkLlxuICpcbiAqIFRoZSBwcm9taXNlIHJldHVybmVkIGJ5IHRoaXMgY2FsbCBpcyByZXNvbHZlZCB3aGVuIHRoZSBhYm92ZSBzdGVwc1xuICogaGF2ZSBjb21wbGV0ZWQsICpub3QqIHdoZW4gdGhlIHdyaXRlIHdhcyBhY2tlZCBieSB0aGUgYmFja2VuZC4gVGhlXG4gKiB1c2VyQ2FsbGJhY2sgaXMgcmVzb2x2ZWQgb25jZSB0aGUgd3JpdGUgd2FzIGFja2VkL3JlamVjdGVkIGJ5IHRoZVxuICogYmFja2VuZCAob3IgZmFpbGVkIGxvY2FsbHkgZm9yIGFueSBvdGhlciByZWFzb24pLlxuICovIGFzeW5jIGZ1bmN0aW9uIGlhKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gQ2EodCk7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgdCA9IGF3YWl0IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBVKHQpLCBzID0gc3Qubm93KCksIGkgPSBlLnJlZHVjZSgoKHQsIGUpID0+IHQuYWRkKGUua2V5KSksIFBuKCkpO1xuICAgICAgICAgICAgbGV0IHI7XG4gICAgICAgICAgICByZXR1cm4gbi5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIkxvY2FsbHkgd3JpdGUgbXV0YXRpb25zXCIsIFwicmVhZHdyaXRlXCIsICh0ID0+IG4uUW4uYm4odCwgaSkubmV4dCgoaSA9PiB7XG4gICAgICAgICAgICAgICAgciA9IGk7XG4gICAgICAgICAgICAgICAgLy8gRm9yIG5vbi1pZGVtcG90ZW50IG11dGF0aW9ucyAoc3VjaCBhcyBgRmllbGRWYWx1ZS5pbmNyZW1lbnQoKWApLFxuICAgICAgICAgICAgICAgIC8vIHdlIHJlY29yZCB0aGUgYmFzZSBzdGF0ZSBpbiBhIHNlcGFyYXRlIHBhdGNoIG11dGF0aW9uLiBUaGlzIGlzXG4gICAgICAgICAgICAgICAgLy8gbGF0ZXIgdXNlZCB0byBndWFyYW50ZWUgY29uc2lzdGVudCB2YWx1ZXMgYW5kIHByZXZlbnRzIGZsaWNrZXJcbiAgICAgICAgICAgICAgICAvLyBldmVuIGlmIHRoZSBiYWNrZW5kIHNlbmRzIHVzIGFuIHVwZGF0ZSB0aGF0IGFscmVhZHkgaW5jbHVkZXMgb3VyXG4gICAgICAgICAgICAgICAgLy8gdHJhbnNmb3JtLlxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gWWUodCwgci5nZXQodC5rZXkpKTtcbiAgICAgICAgICAgICAgICAgICAgbnVsbCAhPSBlICYmIFxuICAgICAgICAgICAgICAgICAgICAvLyBOT1RFOiBUaGUgYmFzZSBzdGF0ZSBzaG91bGQgb25seSBiZSBhcHBsaWVkIGlmIHRoZXJlJ3Mgc29tZVxuICAgICAgICAgICAgICAgICAgICAvLyBleGlzdGluZyBkb2N1bWVudCB0byBvdmVycmlkZSwgc28gdXNlIGEgUHJlY29uZGl0aW9uIG9mXG4gICAgICAgICAgICAgICAgICAgIC8vIGV4aXN0cz10cnVlXG4gICAgICAgICAgICAgICAgICAgIG8ucHVzaChuZXcgZW4odC5rZXksIGUsIFV0KGUudmFsdWUubWFwVmFsdWUpLCBXZS5leGlzdHMoITApKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBuLkluLmFkZE11dGF0aW9uQmF0Y2godCwgcywgbywgZSk7XG4gICAgICAgICAgICB9KSkpKS50aGVuKCh0ID0+ICh0LmFwcGx5VG9Mb2NhbERvY3VtZW50U2V0KHIpLCB7XG4gICAgICAgICAgICAgICAgYmF0Y2hJZDogdC5iYXRjaElkLFxuICAgICAgICAgICAgICAgIGNoYW5nZXM6IHJcbiAgICAgICAgICAgIH0pKSk7XG4gICAgICAgIH0ocy5sb2NhbFN0b3JlLCBlKTtcbiAgICAgICAgcy5zaGFyZWRDbGllbnRTdGF0ZS5hZGRQZW5kaW5nTXV0YXRpb24odC5iYXRjaElkKSwgZnVuY3Rpb24odCwgZSwgbikge1xuICAgICAgICAgICAgbGV0IHMgPSB0LkxvW3QuY3VycmVudFVzZXIudG9LZXkoKV07XG4gICAgICAgICAgICBzIHx8IChzID0gbmV3IGRuKHR0KSk7XG4gICAgICAgICAgICBzID0gcy5pbnNlcnQoZSwgbiksIHQuTG9bdC5jdXJyZW50VXNlci50b0tleSgpXSA9IHM7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gKiBSZXNvbHZlcyBvciByZWplY3RzIHRoZSB1c2VyIGNhbGxiYWNrIGZvciB0aGUgZ2l2ZW4gYmF0Y2ggYW5kIHRoZW4gZGlzY2FyZHNcbiAqIGl0LlxuICovIChzLCB0LmJhdGNoSWQsIG4pLCBhd2FpdCB5YShzLCB0LmNoYW5nZXMpLCBhd2FpdCBFbyhzLnJlbW90ZVN0b3JlKTtcbiAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgIC8vIElmIHdlIGNhbid0IHBlcnNpc3QgdGhlIG11dGF0aW9uLCB3ZSByZWplY3QgdGhlIHVzZXIgY2FsbGJhY2sgYW5kXG4gICAgICAgIC8vIGRvbid0IHNlbmQgdGhlIG11dGF0aW9uLiBUaGUgdXNlciBjYW4gdGhlbiByZXRyeSB0aGUgd3JpdGUuXG4gICAgICAgIGNvbnN0IGUgPSB4byh0LCBcIkZhaWxlZCB0byBwZXJzaXN0IHdyaXRlXCIpO1xuICAgICAgICBuLnJlamVjdChlKTtcbiAgICB9XG59XG5cbi8qKlxuICogQXBwbGllcyBvbmUgcmVtb3RlIGV2ZW50IHRvIHRoZSBzeW5jIGVuZ2luZSwgbm90aWZ5aW5nIGFueSB2aWV3cyBvZiB0aGVcbiAqIGNoYW5nZXMsIGFuZCByZWxlYXNpbmcgYW55IHBlbmRpbmcgbXV0YXRpb24gYmF0Y2hlcyB0aGF0IHdvdWxkIGJlY29tZVxuICogdmlzaWJsZSBiZWNhdXNlIG9mIHRoZSBzbmFwc2hvdCB2ZXJzaW9uIHRoZSByZW1vdGUgZXZlbnQgY29udGFpbnMuXG4gKi8gYXN5bmMgZnVuY3Rpb24gcmEodCwgZSkge1xuICAgIGNvbnN0IG4gPSBVKHQpO1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHQgPSBhd2FpdCBmcihuLmxvY2FsU3RvcmUsIGUpO1xuICAgICAgICAvLyBVcGRhdGUgYHJlY2VpdmVkRG9jdW1lbnRgIGFzIGFwcHJvcHJpYXRlIGZvciBhbnkgbGltYm8gdGFyZ2V0cy5cbiAgICAgICAgICAgICAgICBlLnRhcmdldENoYW5nZXMuZm9yRWFjaCgoKHQsIGUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBuLkZvLmdldChlKTtcbiAgICAgICAgICAgIHMgJiYgKFxuICAgICAgICAgICAgLy8gU2luY2UgdGhpcyBpcyBhIGxpbWJvIHJlc29sdXRpb24gbG9va3VwLCBpdCdzIGZvciBhIHNpbmdsZSBkb2N1bWVudFxuICAgICAgICAgICAgLy8gYW5kIGl0IGNvdWxkIGJlIGFkZGVkLCBtb2RpZmllZCwgb3IgcmVtb3ZlZCwgYnV0IG5vdCBhIGNvbWJpbmF0aW9uLlxuICAgICAgICAgICAgTCh0LmFkZGVkRG9jdW1lbnRzLnNpemUgKyB0Lm1vZGlmaWVkRG9jdW1lbnRzLnNpemUgKyB0LnJlbW92ZWREb2N1bWVudHMuc2l6ZSA8PSAxKSwgXG4gICAgICAgICAgICB0LmFkZGVkRG9jdW1lbnRzLnNpemUgPiAwID8gcy5DbyA9ICEwIDogdC5tb2RpZmllZERvY3VtZW50cy5zaXplID4gMCA/IEwocy5DbykgOiB0LnJlbW92ZWREb2N1bWVudHMuc2l6ZSA+IDAgJiYgKEwocy5DbyksIFxuICAgICAgICAgICAgcy5DbyA9ICExKSk7XG4gICAgICAgIH0pKSwgYXdhaXQgeWEobiwgdCwgZSk7XG4gICAgfSBjYXRjaCAodCkge1xuICAgICAgICBhd2FpdCBPaSh0KTtcbiAgICB9XG59XG5cbi8qKlxuICogQXBwbGllcyBhbiBPbmxpbmVTdGF0ZSBjaGFuZ2UgdG8gdGhlIHN5bmMgZW5naW5lIGFuZCBub3RpZmllcyBhbnkgdmlld3Mgb2ZcbiAqIHRoZSBjaGFuZ2UuXG4gKi8gZnVuY3Rpb24gb2EodCwgZSwgbikge1xuICAgIGNvbnN0IHMgPSBVKHQpO1xuICAgIC8vIElmIHdlIGFyZSB0aGUgc2Vjb25kYXJ5IGNsaWVudCwgd2UgZXhwbGljaXRseSBpZ25vcmUgdGhlIHJlbW90ZSBzdG9yZSdzXG4gICAgLy8gb25saW5lIHN0YXRlICh0aGUgbG9jYWwgY2xpZW50IG1heSBnbyBvZmZsaW5lLCBldmVuIHRob3VnaCB0aGUgcHJpbWFyeVxuICAgIC8vIHRhYiByZW1haW5zIG9ubGluZSkgYW5kIG9ubHkgYXBwbHkgdGhlIHByaW1hcnkgdGFiJ3Mgb25saW5lIHN0YXRlIGZyb21cbiAgICAvLyBTaGFyZWRDbGllbnRTdGF0ZS5cbiAgICAgICAgaWYgKHMuaXNQcmltYXJ5Q2xpZW50ICYmIDAgLyogUmVtb3RlU3RvcmUgKi8gPT09IG4gfHwgIXMuaXNQcmltYXJ5Q2xpZW50ICYmIDEgLyogU2hhcmVkQ2xpZW50U3RhdGUgKi8gPT09IG4pIHtcbiAgICAgICAgY29uc3QgdCA9IFtdO1xuICAgICAgICBzLnhvLmZvckVhY2goKChuLCBzKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBpID0gcy52aWV3LmVvKGUpO1xuICAgICAgICAgICAgaS5zbmFwc2hvdCAmJiB0LnB1c2goaS5zbmFwc2hvdCk7XG4gICAgICAgIH0pKSwgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgY29uc3QgbiA9IFUodCk7XG4gICAgICAgICAgICBuLm9ubGluZVN0YXRlID0gZTtcbiAgICAgICAgICAgIGxldCBzID0gITE7XG4gICAgICAgICAgICBuLnF1ZXJpZXMuZm9yRWFjaCgoKHQsIG4pID0+IHtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2Ygbi5saXN0ZW5lcnMpIFxuICAgICAgICAgICAgICAgIC8vIFJ1biBnbG9iYWwgc25hcHNob3QgbGlzdGVuZXJzIGlmIGEgY29uc2lzdGVudCBzbmFwc2hvdCBoYXMgYmVlbiBlbWl0dGVkLlxuICAgICAgICAgICAgICAgIHQuZW8oZSkgJiYgKHMgPSAhMCk7XG4gICAgICAgICAgICB9KSksIHMgJiYgS28obik7XG4gICAgICAgIH0ocy5ldmVudE1hbmFnZXIsIGUpLCB0Lmxlbmd0aCAmJiBzLk5vLlRyKHQpLCBzLm9ubGluZVN0YXRlID0gZSwgcy5pc1ByaW1hcnlDbGllbnQgJiYgcy5zaGFyZWRDbGllbnRTdGF0ZS5zZXRPbmxpbmVTdGF0ZShlKTtcbiAgICB9XG59XG5cbi8qKlxuICogUmVqZWN0cyB0aGUgbGlzdGVuIGZvciB0aGUgZ2l2ZW4gdGFyZ2V0SUQuIFRoaXMgY2FuIGJlIHRyaWdnZXJlZCBieSB0aGVcbiAqIGJhY2tlbmQgZm9yIGFueSBhY3RpdmUgdGFyZ2V0LlxuICpcbiAqIEBwYXJhbSBzeW5jRW5naW5lIC0gVGhlIHN5bmMgZW5naW5lIGltcGxlbWVudGF0aW9uLlxuICogQHBhcmFtIHRhcmdldElkIC0gVGhlIHRhcmdldElEIGNvcnJlc3BvbmRzIHRvIG9uZSBwcmV2aW91c2x5IGluaXRpYXRlZCBieSB0aGVcbiAqIHVzZXIgYXMgcGFydCBvZiBUYXJnZXREYXRhIHBhc3NlZCB0byBsaXN0ZW4oKSBvbiBSZW1vdGVTdG9yZS5cbiAqIEBwYXJhbSBlcnIgLSBBIGRlc2NyaXB0aW9uIG9mIHRoZSBjb25kaXRpb24gdGhhdCBoYXMgZm9yY2VkIHRoZSByZWplY3Rpb24uXG4gKiBOZWFybHkgYWx3YXlzIHRoaXMgd2lsbCBiZSBhbiBpbmRpY2F0aW9uIHRoYXQgdGhlIHVzZXIgaXMgbm8gbG9uZ2VyXG4gKiBhdXRob3JpemVkIHRvIHNlZSB0aGUgZGF0YSBtYXRjaGluZyB0aGUgdGFyZ2V0LlxuICovIGFzeW5jIGZ1bmN0aW9uIGFhKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gVSh0KTtcbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5LlxuICAgICAgICBzLnNoYXJlZENsaWVudFN0YXRlLnVwZGF0ZVF1ZXJ5U3RhdGUoZSwgXCJyZWplY3RlZFwiLCBuKTtcbiAgICBjb25zdCBpID0gcy5Gby5nZXQoZSksIHIgPSBpICYmIGkua2V5O1xuICAgIGlmIChyKSB7XG4gICAgICAgIC8vIFRPRE8oa2xpbXQpOiBXZSByZWFsbHkgb25seSBzaG91bGQgZG8gdGhlIGZvbGxvd2luZyBvbiBwZXJtaXNzaW9uXG4gICAgICAgIC8vIGRlbmllZCBlcnJvcnMsIGJ1dCB3ZSBkb24ndCBoYXZlIHRoZSBjYXVzZSBjb2RlIGhlcmUuXG4gICAgICAgIC8vIEl0J3MgYSBsaW1ibyBkb2MuIENyZWF0ZSBhIHN5bnRoZXRpYyBldmVudCBzYXlpbmcgaXQgd2FzIGRlbGV0ZWQuXG4gICAgICAgIC8vIFRoaXMgaXMga2luZCBvZiBhIGhhY2suIElkZWFsbHksIHdlIHdvdWxkIGhhdmUgYSBtZXRob2QgaW4gdGhlIGxvY2FsXG4gICAgICAgIC8vIHN0b3JlIHRvIHB1cmdlIGEgZG9jdW1lbnQuIEhvd2V2ZXIsIGl0IHdvdWxkIGJlIHRyaWNreSB0byBrZWVwIGFsbCBvZlxuICAgICAgICAvLyB0aGUgbG9jYWwgc3RvcmUncyBpbnZhcmlhbnRzIHdpdGggYW5vdGhlciBtZXRob2QuXG4gICAgICAgIGxldCB0ID0gbmV3IGRuKFB0LmNvbXBhcmF0b3IpO1xuICAgICAgICB0ID0gdC5pbnNlcnQociwgcXQubmV3Tm9Eb2N1bWVudChyLCBpdC5taW4oKSkpO1xuICAgICAgICBjb25zdCBuID0gUG4oKS5hZGQociksIGkgPSBuZXcgVm4oaXQubWluKCksIFxuICAgICAgICAvKiB0YXJnZXRDaGFuZ2VzPSAqLyBuZXcgTWFwLCBcbiAgICAgICAgLyogdGFyZ2V0TWlzbWF0Y2hlcz0gKi8gbmV3IG1uKHR0KSwgdCwgbik7XG4gICAgICAgIGF3YWl0IHJhKHMsIGkpLCBcbiAgICAgICAgLy8gU2luY2UgdGhpcyBxdWVyeSBmYWlsZWQsIHdlIHdvbid0IHdhbnQgdG8gbWFudWFsbHkgdW5saXN0ZW4gdG8gaXQuXG4gICAgICAgIC8vIFdlIG9ubHkgcmVtb3ZlIGl0IGZyb20gYm9va2tlZXBpbmcgYWZ0ZXIgd2Ugc3VjY2Vzc2Z1bGx5IGFwcGxpZWQgdGhlXG4gICAgICAgIC8vIFJlbW90ZUV2ZW50LiBJZiBgYXBwbHlSZW1vdGVFdmVudCgpYCB0aHJvd3MsIHdlIHdhbnQgdG8gcmUtbGlzdGVuIHRvXG4gICAgICAgIC8vIHRoaXMgcXVlcnkgd2hlbiB0aGUgUmVtb3RlU3RvcmUgcmVzdGFydHMgdGhlIFdhdGNoIHN0cmVhbSwgd2hpY2ggc2hvdWxkXG4gICAgICAgIC8vIHJlLXRyaWdnZXIgdGhlIHRhcmdldCBmYWlsdXJlLlxuICAgICAgICBzLk9vID0gcy5Pby5yZW1vdmUociksIHMuRm8uZGVsZXRlKGUpLCBnYShzKTtcbiAgICB9IGVsc2UgYXdhaXQgbXIocy5sb2NhbFN0b3JlLCBlLCBcbiAgICAvKiBrZWVwUGVyc2lzdGVkVGFyZ2V0RGF0YSAqLyAhMSkudGhlbigoKCkgPT4gZGEocywgZSwgbikpKS5jYXRjaChPaSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGNhKHQsIGUpIHtcbiAgICBjb25zdCBuID0gVSh0KSwgcyA9IGUuYmF0Y2guYmF0Y2hJZDtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCB0ID0gYXdhaXQgaHIobi5sb2NhbFN0b3JlLCBlKTtcbiAgICAgICAgLy8gVGhlIGxvY2FsIHN0b3JlIG1heSBvciBtYXkgbm90IGJlIGFibGUgdG8gYXBwbHkgdGhlIHdyaXRlIHJlc3VsdCBhbmRcbiAgICAgICAgLy8gcmFpc2UgZXZlbnRzIGltbWVkaWF0ZWx5IChkZXBlbmRpbmcgb24gd2hldGhlciB0aGUgd2F0Y2hlciBpcyBjYXVnaHRcbiAgICAgICAgLy8gdXApLCBzbyB3ZSByYWlzZSB1c2VyIGNhbGxiYWNrcyBmaXJzdCBzbyB0aGF0IHRoZXkgY29uc2lzdGVudGx5IGhhcHBlblxuICAgICAgICAvLyBiZWZvcmUgbGlzdGVuIGV2ZW50cy5cbiAgICAgICAgICAgICAgICBmYShuLCBzLCAvKmVycm9yPSovIG51bGwpLCBsYShuLCBzKSwgbi5zaGFyZWRDbGllbnRTdGF0ZS51cGRhdGVNdXRhdGlvblN0YXRlKHMsIFwiYWNrbm93bGVkZ2VkXCIpLCBcbiAgICAgICAgYXdhaXQgeWEobiwgdCk7XG4gICAgfSBjYXRjaCAodCkge1xuICAgICAgICBhd2FpdCBPaSh0KTtcbiAgICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHVhKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gVSh0KTtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCB0ID0gYXdhaXQgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgY29uc3QgbiA9IFUodCk7XG4gICAgICAgICAgICByZXR1cm4gbi5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIlJlamVjdCBiYXRjaFwiLCBcInJlYWR3cml0ZS1wcmltYXJ5XCIsICh0ID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgcztcbiAgICAgICAgICAgICAgICByZXR1cm4gbi5Jbi5sb29rdXBNdXRhdGlvbkJhdGNoKHQsIGUpLm5leHQoKGUgPT4gKEwobnVsbCAhPT0gZSksIHMgPSBlLmtleXMoKSwgbi5Jbi5yZW1vdmVNdXRhdGlvbkJhdGNoKHQsIGUpKSkpLm5leHQoKCgpID0+IG4uSW4ucGVyZm9ybUNvbnNpc3RlbmN5Q2hlY2sodCkpKS5uZXh0KCgoKSA9PiBuLlFuLmJuKHQsIHMpKSk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gKiBSZXR1cm5zIHRoZSBsYXJnZXN0IChsYXRlc3QpIGJhdGNoIGlkIGluIG11dGF0aW9uIHF1ZXVlIHRoYXQgaXMgcGVuZGluZ1xuICogc2VydmVyIHJlc3BvbnNlLlxuICpcbiAqIFJldHVybnMgYEJBVENISURfVU5LTk9XTmAgaWYgdGhlIHF1ZXVlIGlzIGVtcHR5LlxuICovIChzLmxvY2FsU3RvcmUsIGUpO1xuICAgICAgICAvLyBUaGUgbG9jYWwgc3RvcmUgbWF5IG9yIG1heSBub3QgYmUgYWJsZSB0byBhcHBseSB0aGUgd3JpdGUgcmVzdWx0IGFuZFxuICAgICAgICAvLyByYWlzZSBldmVudHMgaW1tZWRpYXRlbHkgKGRlcGVuZGluZyBvbiB3aGV0aGVyIHRoZSB3YXRjaGVyIGlzIGNhdWdodCB1cCksXG4gICAgICAgIC8vIHNvIHdlIHJhaXNlIHVzZXIgY2FsbGJhY2tzIGZpcnN0IHNvIHRoYXQgdGhleSBjb25zaXN0ZW50bHkgaGFwcGVuIGJlZm9yZVxuICAgICAgICAvLyBsaXN0ZW4gZXZlbnRzLlxuICAgICAgICAgICAgICAgIGZhKHMsIGUsIG4pLCBsYShzLCBlKSwgcy5zaGFyZWRDbGllbnRTdGF0ZS51cGRhdGVNdXRhdGlvblN0YXRlKGUsIFwicmVqZWN0ZWRcIiwgbiksIFxuICAgICAgICBhd2FpdCB5YShzLCB0KTtcbiAgICB9IGNhdGNoIChuKSB7XG4gICAgICAgIGF3YWl0IE9pKG4pO1xuICAgIH1cbn1cblxuLyoqXG4gKiBSZWdpc3RlcnMgYSB1c2VyIGNhbGxiYWNrIHRoYXQgcmVzb2x2ZXMgd2hlbiBhbGwgcGVuZGluZyBtdXRhdGlvbnMgYXQgdGhlIG1vbWVudCBvZiBjYWxsaW5nXG4gKiBhcmUgYWNrbm93bGVkZ2VkIC5cbiAqLyBhc3luYyBmdW5jdGlvbiBoYSh0LCBlKSB7XG4gICAgY29uc3QgbiA9IFUodCk7XG4gICAgZm8obi5yZW1vdGVTdG9yZSkgfHwgayhcIlN5bmNFbmdpbmVcIiwgXCJUaGUgbmV0d29yayBpcyBkaXNhYmxlZC4gVGhlIHRhc2sgcmV0dXJuZWQgYnkgJ2F3YWl0UGVuZGluZ1dyaXRlcygpJyB3aWxsIG5vdCBjb21wbGV0ZSB1bnRpbCB0aGUgbmV0d29yayBpcyBlbmFibGVkLlwiKTtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCB0ID0gYXdhaXQgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgY29uc3QgZSA9IFUodCk7XG4gICAgICAgICAgICByZXR1cm4gZS5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIkdldCBoaWdoZXN0IHVuYWNrbm93bGVkZ2VkIGJhdGNoIGlkXCIsIFwicmVhZG9ubHlcIiwgKHQgPT4gZS5Jbi5nZXRIaWdoZXN0VW5hY2tub3dsZWRnZWRCYXRjaElkKHQpKSk7XG4gICAgICAgIH0obi5sb2NhbFN0b3JlKTtcbiAgICAgICAgaWYgKC0xID09PSB0KSBcbiAgICAgICAgLy8gVHJpZ2dlciB0aGUgY2FsbGJhY2sgcmlnaHQgYXdheSBpZiB0aGVyZSBpcyBubyBwZW5kaW5nIHdyaXRlcyBhdCB0aGUgbW9tZW50LlxuICAgICAgICByZXR1cm4gdm9pZCBlLnJlc29sdmUoKTtcbiAgICAgICAgY29uc3QgcyA9IG4uQm8uZ2V0KHQpIHx8IFtdO1xuICAgICAgICBzLnB1c2goZSksIG4uQm8uc2V0KHQsIHMpO1xuICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgY29uc3QgbiA9IHhvKHQsIFwiSW5pdGlhbGl6YXRpb24gb2Ygd2FpdEZvclBlbmRpbmdXcml0ZXMoKSBvcGVyYXRpb24gZmFpbGVkXCIpO1xuICAgICAgICBlLnJlamVjdChuKTtcbiAgICB9XG59XG5cbi8qKlxuICogVHJpZ2dlcnMgdGhlIGNhbGxiYWNrcyB0aGF0IGFyZSB3YWl0aW5nIGZvciB0aGlzIGJhdGNoIGlkIHRvIGdldCBhY2tub3dsZWRnZWQgYnkgc2VydmVyLFxuICogaWYgdGhlcmUgYXJlIGFueS5cbiAqLyBmdW5jdGlvbiBsYSh0LCBlKSB7XG4gICAgKHQuQm8uZ2V0KGUpIHx8IFtdKS5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgdC5yZXNvbHZlKCk7XG4gICAgfSkpLCB0LkJvLmRlbGV0ZShlKTtcbn1cblxuLyoqIFJlamVjdCBhbGwgb3V0c3RhbmRpbmcgY2FsbGJhY2tzIHdhaXRpbmcgZm9yIHBlbmRpbmcgd3JpdGVzIHRvIGNvbXBsZXRlLiAqLyBmdW5jdGlvbiBmYSh0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9IFUodCk7XG4gICAgbGV0IGkgPSBzLkxvW3MuY3VycmVudFVzZXIudG9LZXkoKV07XG4gICAgLy8gTk9URTogTXV0YXRpb25zIHJlc3RvcmVkIGZyb20gcGVyc2lzdGVuY2Ugd29uJ3QgaGF2ZSBjYWxsYmFja3MsIHNvIGl0J3NcbiAgICAvLyBva2F5IGZvciB0aGVyZSB0byBiZSBubyBjYWxsYmFjayBmb3IgdGhpcyBJRC5cbiAgICAgICAgaWYgKGkpIHtcbiAgICAgICAgY29uc3QgdCA9IGkuZ2V0KGUpO1xuICAgICAgICB0ICYmIChuID8gdC5yZWplY3QobikgOiB0LnJlc29sdmUoKSwgaSA9IGkucmVtb3ZlKGUpKSwgcy5Mb1tzLmN1cnJlbnRVc2VyLnRvS2V5KCldID0gaTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGRhKHQsIGUsIG4gPSBudWxsKSB7XG4gICAgdC5zaGFyZWRDbGllbnRTdGF0ZS5yZW1vdmVMb2NhbFF1ZXJ5VGFyZ2V0KGUpO1xuICAgIGZvciAoY29uc3QgcyBvZiB0LmtvLmdldChlKSkgdC54by5kZWxldGUocyksIG4gJiYgdC5Oby5qbyhzLCBuKTtcbiAgICBpZiAodC5rby5kZWxldGUoZSksIHQuaXNQcmltYXJ5Q2xpZW50KSB7XG4gICAgICAgIHQuTW8uY3MoZSkuZm9yRWFjaCgoZSA9PiB7XG4gICAgICAgICAgICB0Lk1vLmNvbnRhaW5zS2V5KGUpIHx8IFxuICAgICAgICAgICAgLy8gV2UgcmVtb3ZlZCB0aGUgbGFzdCByZWZlcmVuY2UgZm9yIHRoaXMga2V5XG4gICAgICAgICAgICB3YSh0LCBlKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gd2EodCwgZSkge1xuICAgIHQuJG8uZGVsZXRlKGUucGF0aC5jYW5vbmljYWxTdHJpbmcoKSk7XG4gICAgLy8gSXQncyBwb3NzaWJsZSB0aGF0IHRoZSB0YXJnZXQgYWxyZWFkeSBnb3QgcmVtb3ZlZCBiZWNhdXNlIHRoZSBxdWVyeSBmYWlsZWQuIEluIHRoYXQgY2FzZSxcbiAgICAvLyB0aGUga2V5IHdvbid0IGV4aXN0IGluIGBsaW1ib1RhcmdldHNCeUtleWAuIE9ubHkgZG8gdGhlIGNsZWFudXAgaWYgd2Ugc3RpbGwgaGF2ZSB0aGUgdGFyZ2V0LlxuICAgIGNvbnN0IG4gPSB0Lk9vLmdldChlKTtcbiAgICBudWxsICE9PSBuICYmIChhbyh0LnJlbW90ZVN0b3JlLCBuKSwgdC5PbyA9IHQuT28ucmVtb3ZlKGUpLCB0LkZvLmRlbGV0ZShuKSwgZ2EodCkpO1xufVxuXG5mdW5jdGlvbiBfYSh0LCBlLCBuKSB7XG4gICAgZm9yIChjb25zdCBzIG9mIG4pIGlmIChzIGluc3RhbmNlb2YgSG8pIHQuTW8uYWRkUmVmZXJlbmNlKHMua2V5LCBlKSwgbWEodCwgcyk7IGVsc2UgaWYgKHMgaW5zdGFuY2VvZiBKbykge1xuICAgICAgICBrKFwiU3luY0VuZ2luZVwiLCBcIkRvY3VtZW50IG5vIGxvbmdlciBpbiBsaW1ibzogXCIgKyBzLmtleSksIHQuTW8ucmVtb3ZlUmVmZXJlbmNlKHMua2V5LCBlKTtcbiAgICAgICAgdC5Nby5jb250YWluc0tleShzLmtleSkgfHwgXG4gICAgICAgIC8vIFdlIHJlbW92ZWQgdGhlIGxhc3QgcmVmZXJlbmNlIGZvciB0aGlzIGtleVxuICAgICAgICB3YSh0LCBzLmtleSk7XG4gICAgfSBlbHNlIE0oKTtcbn1cblxuZnVuY3Rpb24gbWEodCwgZSkge1xuICAgIGNvbnN0IG4gPSBlLmtleSwgcyA9IG4ucGF0aC5jYW5vbmljYWxTdHJpbmcoKTtcbiAgICB0Lk9vLmdldChuKSB8fCB0LiRvLmhhcyhzKSB8fCAoayhcIlN5bmNFbmdpbmVcIiwgXCJOZXcgZG9jdW1lbnQgaW4gbGltYm86IFwiICsgbiksIHQuJG8uYWRkKHMpLCBcbiAgICBnYSh0KSk7XG59XG5cbi8qKlxuICogU3RhcnRzIGxpc3RlbnMgZm9yIGRvY3VtZW50cyBpbiBsaW1ibyB0aGF0IGFyZSBlbnF1ZXVlZCBmb3IgcmVzb2x1dGlvbixcbiAqIHN1YmplY3QgdG8gYSBtYXhpbXVtIG51bWJlciBvZiBjb25jdXJyZW50IHJlc29sdXRpb25zLlxuICpcbiAqIFdpdGhvdXQgYm91bmRpbmcgdGhlIG51bWJlciBvZiBjb25jdXJyZW50IHJlc29sdXRpb25zLCB0aGUgc2VydmVyIGNhbiBmYWlsXG4gKiB3aXRoIFwicmVzb3VyY2UgZXhoYXVzdGVkXCIgZXJyb3JzIHdoaWNoIGNhbiBsZWFkIHRvIHBhdGhvbG9naWNhbCBjbGllbnRcbiAqIGJlaGF2aW9yIGFzIHNlZW4gaW4gaHR0cHM6Ly9naXRodWIuY29tL2ZpcmViYXNlL2ZpcmViYXNlLWpzLXNkay9pc3N1ZXMvMjY4My5cbiAqLyBmdW5jdGlvbiBnYSh0KSB7XG4gICAgZm9yICg7dC4kby5zaXplID4gMCAmJiB0Lk9vLnNpemUgPCB0Lm1heENvbmN1cnJlbnRMaW1ib1Jlc29sdXRpb25zOyApIHtcbiAgICAgICAgY29uc3QgZSA9IHQuJG8udmFsdWVzKCkubmV4dCgpLnZhbHVlO1xuICAgICAgICB0LiRvLmRlbGV0ZShlKTtcbiAgICAgICAgY29uc3QgbiA9IG5ldyBQdCh1dC5mcm9tU3RyaW5nKGUpKSwgcyA9IHQuVW8ubmV4dCgpO1xuICAgICAgICB0LkZvLnNldChzLCBuZXcgWm8obikpLCB0Lk9vID0gdC5Pby5pbnNlcnQobiwgcyksIG9vKHQucmVtb3RlU3RvcmUsIG5ldyBzaShFZShkZShuLnBhdGgpKSwgcywgMiAvKiBMaW1ib1Jlc29sdXRpb24gKi8gLCBZLlQpKTtcbiAgICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHlhKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gVSh0KSwgaSA9IFtdLCByID0gW10sIG8gPSBbXTtcbiAgICBzLnhvLmlzRW1wdHkoKSB8fCAocy54by5mb3JFYWNoKCgodCwgYSkgPT4ge1xuICAgICAgICBvLnB1c2gocy5LbyhhLCBlLCBuKS50aGVuKCh0ID0+IHtcbiAgICAgICAgICAgIGlmICh0KSB7XG4gICAgICAgICAgICAgICAgcy5pc1ByaW1hcnlDbGllbnQgJiYgcy5zaGFyZWRDbGllbnRTdGF0ZS51cGRhdGVRdWVyeVN0YXRlKGEudGFyZ2V0SWQsIHQuZnJvbUNhY2hlID8gXCJub3QtY3VycmVudFwiIDogXCJjdXJyZW50XCIpLCBcbiAgICAgICAgICAgICAgICBpLnB1c2godCk7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHJyLmtuKGEudGFyZ2V0SWQsIHQpO1xuICAgICAgICAgICAgICAgIHIucHVzaChlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpKTtcbiAgICB9KSksIGF3YWl0IFByb21pc2UuYWxsKG8pLCBzLk5vLlRyKGkpLCBhd2FpdCBhc3luYyBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBVKHQpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgbi5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIm5vdGlmeUxvY2FsVmlld0NoYW5nZXNcIiwgXCJyZWFkd3JpdGVcIiwgKHQgPT4gS3MuZm9yRWFjaChlLCAoZSA9PiBLcy5mb3JFYWNoKGUuTm4sIChzID0+IG4ucGVyc2lzdGVuY2UucmVmZXJlbmNlRGVsZWdhdGUuYWRkUmVmZXJlbmNlKHQsIGUudGFyZ2V0SWQsIHMpKSkubmV4dCgoKCkgPT4gS3MuZm9yRWFjaChlLnhuLCAocyA9PiBuLnBlcnNpc3RlbmNlLnJlZmVyZW5jZURlbGVnYXRlLnJlbW92ZVJlZmVyZW5jZSh0LCBlLnRhcmdldElkLCBzKSkpKSkpKSkpO1xuICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICBpZiAoIXpzKHQpKSB0aHJvdyB0O1xuICAgICAgICAgICAgLy8gSWYgYG5vdGlmeUxvY2FsVmlld0NoYW5nZXNgIGZhaWxzLCB3ZSBkaWQgbm90IGFkdmFuY2UgdGhlIHNlcXVlbmNlXG4gICAgICAgICAgICAvLyBudW1iZXIgZm9yIHRoZSBkb2N1bWVudHMgdGhhdCB3ZXJlIGluY2x1ZGVkIGluIHRoaXMgdHJhbnNhY3Rpb24uXG4gICAgICAgICAgICAvLyBUaGlzIG1pZ2h0IHRyaWdnZXIgdGhlbSB0byBiZSBkZWxldGVkIGVhcmxpZXIgdGhhbiB0aGV5IG90aGVyd2lzZVxuICAgICAgICAgICAgLy8gd291bGQgaGF2ZSwgYnV0IGl0IHNob3VsZCBub3QgaW52YWxpZGF0ZSB0aGUgaW50ZWdyaXR5IG9mIHRoZSBkYXRhLlxuICAgICAgICAgICAgayhcIkxvY2FsU3RvcmVcIiwgXCJGYWlsZWQgdG8gdXBkYXRlIHNlcXVlbmNlIG51bWJlcnM6IFwiICsgdCk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChjb25zdCB0IG9mIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0LnRhcmdldElkO1xuICAgICAgICAgICAgaWYgKCF0LmZyb21DYWNoZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBuLlVuLmdldChlKSwgcyA9IHQuc25hcHNob3RWZXJzaW9uLCBpID0gdC53aXRoTGFzdExpbWJvRnJlZVNuYXBzaG90VmVyc2lvbihzKTtcbiAgICAgICAgICAgICAgICAvLyBBZHZhbmNlIHRoZSBsYXN0IGxpbWJvIGZyZWUgc25hcHNob3QgdmVyc2lvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuLlVuID0gbi5Vbi5pbnNlcnQoZSwgaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KHMubG9jYWxTdG9yZSwgcikpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBwYSh0LCBlKSB7XG4gICAgY29uc3QgbiA9IFUodCk7XG4gICAgaWYgKCFuLmN1cnJlbnRVc2VyLmlzRXF1YWwoZSkpIHtcbiAgICAgICAgayhcIlN5bmNFbmdpbmVcIiwgXCJVc2VyIGNoYW5nZS4gTmV3IHVzZXI6XCIsIGUudG9LZXkoKSk7XG4gICAgICAgIGNvbnN0IHQgPSBhd2FpdCB1cihuLmxvY2FsU3RvcmUsIGUpO1xuICAgICAgICBuLmN1cnJlbnRVc2VyID0gZSwgXG4gICAgICAgIC8vIEZhaWxzIHRhc2tzIHdhaXRpbmcgZm9yIHBlbmRpbmcgd3JpdGVzIHJlcXVlc3RlZCBieSBwcmV2aW91cyB1c2VyLlxuICAgICAgICBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICB0LkJvLmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgICAgIHQuZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHQucmVqZWN0KG5ldyBLKHEuQ0FOQ0VMTEVELCBlKSk7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfSkpLCB0LkJvLmNsZWFyKCk7XG4gICAgICAgIH0obiwgXCInd2FpdEZvclBlbmRpbmdXcml0ZXMnIHByb21pc2UgaXMgcmVqZWN0ZWQgZHVlIHRvIGEgdXNlciBjaGFuZ2UuXCIpLCBcbiAgICAgICAgLy8gVE9ETyhiLzExNDIyNjQxNyk6IENvbnNpZGVyIGNhbGxpbmcgdGhpcyBvbmx5IGluIHRoZSBwcmltYXJ5IHRhYi5cbiAgICAgICAgbi5zaGFyZWRDbGllbnRTdGF0ZS5oYW5kbGVVc2VyQ2hhbmdlKGUsIHQucmVtb3ZlZEJhdGNoSWRzLCB0LmFkZGVkQmF0Y2hJZHMpLCBhd2FpdCB5YShuLCB0LlduKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIEVhKHQsIGUpIHtcbiAgICBjb25zdCBuID0gVSh0KSwgcyA9IG4uRm8uZ2V0KGUpO1xuICAgIGlmIChzICYmIHMuQ28pIHJldHVybiBQbigpLmFkZChzLmtleSk7XG4gICAge1xuICAgICAgICBsZXQgdCA9IFBuKCk7XG4gICAgICAgIGNvbnN0IHMgPSBuLmtvLmdldChlKTtcbiAgICAgICAgaWYgKCFzKSByZXR1cm4gdDtcbiAgICAgICAgZm9yIChjb25zdCBlIG9mIHMpIHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBuLnhvLmdldChlKTtcbiAgICAgICAgICAgIHQgPSB0LnVuaW9uV2l0aChzLnZpZXcuVG8pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0O1xuICAgIH1cbn1cblxuLyoqXG4gKiBSZWNvbmNpbGUgdGhlIGxpc3Qgb2Ygc3luY2VkIGRvY3VtZW50cyBpbiBhbiBleGlzdGluZyB2aWV3IHdpdGggdGhvc2VcbiAqIGZyb20gcGVyc2lzdGVuY2UuXG4gKi8gYXN5bmMgZnVuY3Rpb24gVGEodCwgZSkge1xuICAgIGNvbnN0IG4gPSBVKHQpLCBzID0gYXdhaXQgZ3Iobi5sb2NhbFN0b3JlLCBlLnF1ZXJ5LCBcbiAgICAvKiB1c2VQcmV2aW91c1Jlc3VsdHM9ICovICEwKSwgaSA9IGUudmlldy5TbyhzKTtcbiAgICByZXR1cm4gbi5pc1ByaW1hcnlDbGllbnQgJiYgX2EobiwgZS50YXJnZXRJZCwgaS52byksIGk7XG59XG5cbi8qKlxuICogUmV0cmlldmVzIG5ld2x5IGNoYW5nZWQgZG9jdW1lbnRzIGZyb20gcmVtb3RlIGRvY3VtZW50IGNhY2hlIGFuZCByYWlzZXNcbiAqIHNuYXBzaG90cyBpZiBuZWVkZWQuXG4gKi9cbi8vIFBPUlRJTkcgTk9URTogTXVsdGktVGFiIG9ubHkuXG5hc3luYyBmdW5jdGlvbiBJYSh0KSB7XG4gICAgY29uc3QgZSA9IFUodCk7XG4gICAgcmV0dXJuIHByKGUubG9jYWxTdG9yZSkudGhlbigodCA9PiB5YShlLCB0KSkpO1xufVxuXG4vKiogQXBwbGllcyBhIG11dGF0aW9uIHN0YXRlIHRvIGFuIGV4aXN0aW5nIGJhdGNoLiAgKi9cbi8vIFBPUlRJTkcgTk9URTogTXVsdGktVGFiIG9ubHkuXG5hc3luYyBmdW5jdGlvbiBBYSh0LCBlLCBuLCBzKSB7XG4gICAgY29uc3QgaSA9IFUodCksIHIgPSBhd2FpdCBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBVKHQpLCBzID0gVShuLkluKTtcbiAgICAgICAgcmV0dXJuIG4ucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJMb29rdXAgbXV0YXRpb24gZG9jdW1lbnRzXCIsIFwicmVhZG9ubHlcIiwgKHQgPT4gcy5YdCh0LCBlKS5uZXh0KChlID0+IGUgPyBuLlFuLmJuKHQsIGUpIDogS3MucmVzb2x2ZShudWxsKSkpKSk7XG4gICAgfVxuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktVGFiIG9ubHkuXG4gICAgKGkubG9jYWxTdG9yZSwgZSk7XG4gICAgbnVsbCAhPT0gciA/IChcInBlbmRpbmdcIiA9PT0gbiA/IFxuICAgIC8vIElmIHdlIGFyZSB0aGUgcHJpbWFyeSBjbGllbnQsIHdlIG5lZWQgdG8gc2VuZCB0aGlzIHdyaXRlIHRvIHRoZVxuICAgIC8vIGJhY2tlbmQuIFNlY29uZGFyeSBjbGllbnRzIHdpbGwgaWdub3JlIHRoZXNlIHdyaXRlcyBzaW5jZSB0aGVpciByZW1vdGVcbiAgICAvLyBjb25uZWN0aW9uIGlzIGRpc2FibGVkLlxuICAgIGF3YWl0IEVvKGkucmVtb3RlU3RvcmUpIDogXCJhY2tub3dsZWRnZWRcIiA9PT0gbiB8fCBcInJlamVjdGVkXCIgPT09IG4gPyAoXG4gICAgLy8gTk9URTogQm90aCB0aGVzZSBtZXRob2RzIGFyZSBuby1vcHMgZm9yIGJhdGNoZXMgdGhhdCBvcmlnaW5hdGVkIGZyb21cbiAgICAvLyBvdGhlciBjbGllbnRzLlxuICAgIGZhKGksIGUsIHMgfHwgbnVsbCksIGxhKGksIGUpLCBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIFUoVSh0KS5JbikudGUoZSk7XG4gICAgfVxuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktVGFiIG9ubHkuXG4gICAgKGkubG9jYWxTdG9yZSwgZSkpIDogTSgpLCBhd2FpdCB5YShpLCByKSkgOiBcbiAgICAvLyBBIHRocm90dGxlZCB0YWIgbWF5IG5vdCBoYXZlIHNlZW4gdGhlIG11dGF0aW9uIGJlZm9yZSBpdCB3YXMgY29tcGxldGVkXG4gICAgLy8gYW5kIHJlbW92ZWQgZnJvbSB0aGUgbXV0YXRpb24gcXVldWUsIGluIHdoaWNoIGNhc2Ugd2Ugd29uJ3QgaGF2ZSBjYWNoZWRcbiAgICAvLyB0aGUgYWZmZWN0ZWQgZG9jdW1lbnRzLiBJbiB0aGlzIGNhc2Ugd2UgY2FuIHNhZmVseSBpZ25vcmUgdGhlIHVwZGF0ZVxuICAgIC8vIHNpbmNlIHRoYXQgbWVhbnMgd2UgZGlkbid0IGFwcGx5IHRoZSBtdXRhdGlvbiBsb2NhbGx5IGF0IGFsbCAoaWYgd2VcbiAgICAvLyBoYWQsIHdlIHdvdWxkIGhhdmUgY2FjaGVkIHRoZSBhZmZlY3RlZCBkb2N1bWVudHMpLCBhbmQgc28gd2Ugd2lsbCBqdXN0XG4gICAgLy8gc2VlIGFueSByZXN1bHRpbmcgZG9jdW1lbnQgY2hhbmdlcyB2aWEgbm9ybWFsIHJlbW90ZSBkb2N1bWVudCB1cGRhdGVzXG4gICAgLy8gYXMgYXBwbGljYWJsZS5cbiAgICBrKFwiU3luY0VuZ2luZVwiLCBcIkNhbm5vdCBhcHBseSBtdXRhdGlvbiBiYXRjaCB3aXRoIGlkOiBcIiArIGUpO1xufVxuXG4vKiogQXBwbGllcyBhIHF1ZXJ5IHRhcmdldCBjaGFuZ2UgZnJvbSBhIGRpZmZlcmVudCB0YWIuICovXG4vLyBQT1JUSU5HIE5PVEU6IE11bHRpLVRhYiBvbmx5LlxuYXN5bmMgZnVuY3Rpb24gUmEodCwgZSkge1xuICAgIGNvbnN0IG4gPSBVKHQpO1xuICAgIGlmIChEYShuKSwgQ2EobiksICEwID09PSBlICYmICEwICE9PSBuLnFvKSB7XG4gICAgICAgIC8vIFNlY29uZGFyeSB0YWJzIG9ubHkgbWFpbnRhaW4gVmlld3MgZm9yIHRoZWlyIGxvY2FsIGxpc3RlbmVycyBhbmQgdGhlXG4gICAgICAgIC8vIFZpZXdzIGludGVybmFsIHN0YXRlIG1heSBub3QgYmUgMTAwJSBwb3B1bGF0ZWQgKGluIHBhcnRpY3VsYXJcbiAgICAgICAgLy8gc2Vjb25kYXJ5IHRhYnMgZG9uJ3QgdHJhY2sgc3luY2VkRG9jdW1lbnRzLCB0aGUgc2V0IG9mIGRvY3VtZW50cyB0aGVcbiAgICAgICAgLy8gc2VydmVyIGNvbnNpZGVycyB0byBiZSBpbiB0aGUgdGFyZ2V0KS4gU28gd2hlbiBhIHNlY29uZGFyeSBiZWNvbWVzXG4gICAgICAgIC8vIHByaW1hcnksIHdlIG5lZWQgdG8gbmVlZCB0byBtYWtlIHN1cmUgdGhhdCBhbGwgdmlld3MgZm9yIGFsbCB0YXJnZXRzXG4gICAgICAgIC8vIG1hdGNoIHRoZSBzdGF0ZSBvbiBkaXNrLlxuICAgICAgICBjb25zdCB0ID0gbi5zaGFyZWRDbGllbnRTdGF0ZS5nZXRBbGxBY3RpdmVRdWVyeVRhcmdldHMoKSwgZSA9IGF3YWl0IFBhKG4sIHQudG9BcnJheSgpKTtcbiAgICAgICAgbi5xbyA9ICEwLCBhd2FpdCBTbyhuLnJlbW90ZVN0b3JlLCAhMCk7XG4gICAgICAgIGZvciAoY29uc3QgdCBvZiBlKSBvbyhuLnJlbW90ZVN0b3JlLCB0KTtcbiAgICB9IGVsc2UgaWYgKCExID09PSBlICYmICExICE9PSBuLnFvKSB7XG4gICAgICAgIGNvbnN0IHQgPSBbXTtcbiAgICAgICAgbGV0IGUgPSBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgbi5rby5mb3JFYWNoKCgocywgaSkgPT4ge1xuICAgICAgICAgICAgbi5zaGFyZWRDbGllbnRTdGF0ZS5pc0xvY2FsUXVlcnlUYXJnZXQoaSkgPyB0LnB1c2goaSkgOiBlID0gZS50aGVuKCgoKSA9PiAoZGEobiwgaSksIFxuICAgICAgICAgICAgbXIobi5sb2NhbFN0b3JlLCBpLCBcbiAgICAgICAgICAgIC8qa2VlcFBlcnNpc3RlZFRhcmdldERhdGE9Ki8gITApKSkpLCBhbyhuLnJlbW90ZVN0b3JlLCBpKTtcbiAgICAgICAgfSkpLCBhd2FpdCBlLCBhd2FpdCBQYShuLCB0KSwgXG4gICAgICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktVGFiIG9ubHkuXG4gICAgICAgIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSBVKHQpO1xuICAgICAgICAgICAgZS5Gby5mb3JFYWNoKCgodCwgbikgPT4ge1xuICAgICAgICAgICAgICAgIGFvKGUucmVtb3RlU3RvcmUsIG4pO1xuICAgICAgICAgICAgfSkpLCBlLk1vLnVzKCksIGUuRm8gPSBuZXcgTWFwLCBlLk9vID0gbmV3IGRuKFB0LmNvbXBhcmF0b3IpO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICogUmVjb25jaWxlIHRoZSBxdWVyeSB2aWV3cyBvZiB0aGUgcHJvdmlkZWQgcXVlcnkgdGFyZ2V0cyB3aXRoIHRoZSBzdGF0ZSBmcm9tXG4gKiBwZXJzaXN0ZW5jZS4gUmFpc2VzIHNuYXBzaG90cyBmb3IgYW55IGNoYW5nZXMgdGhhdCBhZmZlY3QgdGhlIGxvY2FsXG4gKiBjbGllbnQgYW5kIHJldHVybnMgdGhlIHVwZGF0ZWQgc3RhdGUgb2YgYWxsIHRhcmdldCdzIHF1ZXJ5IGRhdGEuXG4gKlxuICogQHBhcmFtIHN5bmNFbmdpbmUgLSBUaGUgc3luYyBlbmdpbmUgaW1wbGVtZW50YXRpb25cbiAqIEBwYXJhbSB0YXJnZXRzIC0gdGhlIGxpc3Qgb2YgdGFyZ2V0cyB3aXRoIHZpZXdzIHRoYXQgbmVlZCB0byBiZSByZWNvbXB1dGVkXG4gKiBAcGFyYW0gdHJhbnNpdGlvblRvUHJpbWFyeSAtIGB0cnVlYCBpZmYgdGhlIHRhYiB0cmFuc2l0aW9ucyBmcm9tIGEgc2Vjb25kYXJ5XG4gKiB0YWIgdG8gYSBwcmltYXJ5IHRhYlxuICovXG4gICAgICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktVGFiIG9ubHkuXG4gICAgICAgIChuKSwgbi5xbyA9ICExLCBhd2FpdCBTbyhuLnJlbW90ZVN0b3JlLCAhMSk7XG4gICAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBQYSh0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9IFUodCksIGkgPSBbXSwgciA9IFtdO1xuICAgIGZvciAoY29uc3QgdCBvZiBlKSB7XG4gICAgICAgIGxldCBlO1xuICAgICAgICBjb25zdCBuID0gcy5rby5nZXQodCk7XG4gICAgICAgIGlmIChuICYmIDAgIT09IG4ubGVuZ3RoKSB7XG4gICAgICAgICAgICAvLyBGb3IgcXVlcmllcyB0aGF0IGhhdmUgYSBsb2NhbCBWaWV3LCB3ZSBmZXRjaCB0aGVpciBjdXJyZW50IHN0YXRlXG4gICAgICAgICAgICAvLyBmcm9tIExvY2FsU3RvcmUgKGFzIHRoZSByZXN1bWUgdG9rZW4gYW5kIHRoZSBzbmFwc2hvdCB2ZXJzaW9uXG4gICAgICAgICAgICAvLyBtaWdodCBoYXZlIGNoYW5nZWQpIGFuZCByZWNvbmNpbGUgdGhlaXIgdmlld3Mgd2l0aCB0aGUgcGVyc2lzdGVkXG4gICAgICAgICAgICAvLyBzdGF0ZSAodGhlIGxpc3Qgb2Ygc3luY2VkRG9jdW1lbnRzIG1heSBoYXZlIGdvdHRlbiBvdXQgb2Ygc3luYykuXG4gICAgICAgICAgICBlID0gYXdhaXQgX3Iocy5sb2NhbFN0b3JlLCBFZShuWzBdKSk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2Ygbikge1xuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBzLnhvLmdldCh0KSwgbiA9IGF3YWl0IFRhKHMsIGUpO1xuICAgICAgICAgICAgICAgIG4uc25hcHNob3QgJiYgci5wdXNoKG4uc25hcHNob3QpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gRm9yIHF1ZXJpZXMgdGhhdCBuZXZlciBleGVjdXRlZCBvbiB0aGlzIGNsaWVudCwgd2UgbmVlZCB0b1xuICAgICAgICAgICAgLy8gYWxsb2NhdGUgdGhlIHRhcmdldCBpbiBMb2NhbFN0b3JlIGFuZCBpbml0aWFsaXplIGEgbmV3IFZpZXcuXG4gICAgICAgICAgICBjb25zdCBuID0gYXdhaXQgeXIocy5sb2NhbFN0b3JlLCB0KTtcbiAgICAgICAgICAgIGUgPSBhd2FpdCBfcihzLmxvY2FsU3RvcmUsIG4pLCBhd2FpdCBuYShzLCBiYShuKSwgdCwgXG4gICAgICAgICAgICAvKmN1cnJlbnQ9Ki8gITEpO1xuICAgICAgICB9XG4gICAgICAgIGkucHVzaChlKTtcbiAgICB9XG4gICAgcmV0dXJuIHMuTm8uVHIociksIGk7XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIGBRdWVyeWAgb2JqZWN0IGZyb20gdGhlIHNwZWNpZmllZCBgVGFyZ2V0YC4gVGhlcmUgaXMgbm8gd2F5IHRvXG4gKiBvYnRhaW4gdGhlIG9yaWdpbmFsIGBRdWVyeWAsIHNvIHdlIHN5bnRoZXNpemUgYSBgUXVlcnlgIGZyb20gdGhlIGBUYXJnZXRgXG4gKiBvYmplY3QuXG4gKlxuICogVGhlIHN5bnRoZXNpemVkIHJlc3VsdCBtaWdodCBiZSBkaWZmZXJlbnQgZnJvbSB0aGUgb3JpZ2luYWwgYFF1ZXJ5YCwgYnV0XG4gKiBzaW5jZSB0aGUgc3ludGhlc2l6ZWQgYFF1ZXJ5YCBzaG91bGQgcmV0dXJuIHRoZSBzYW1lIHJlc3VsdHMgYXMgdGhlXG4gKiBvcmlnaW5hbCBvbmUgKG9ubHkgdGhlIHByZXNlbnRhdGlvbiBvZiByZXN1bHRzIG1pZ2h0IGRpZmZlciksIHRoZSBwb3RlbnRpYWxcbiAqIGRpZmZlcmVuY2Ugd2lsbCBub3QgY2F1c2UgaXNzdWVzLlxuICovXG4vLyBQT1JUSU5HIE5PVEU6IE11bHRpLVRhYiBvbmx5LlxuZnVuY3Rpb24gYmEodCkge1xuICAgIHJldHVybiBmZSh0LnBhdGgsIHQuY29sbGVjdGlvbkdyb3VwLCB0Lm9yZGVyQnksIHQuZmlsdGVycywgdC5saW1pdCwgXCJGXCIgLyogRmlyc3QgKi8gLCB0LnN0YXJ0QXQsIHQuZW5kQXQpO1xufVxuXG4vKiogUmV0dXJucyB0aGUgSURzIG9mIHRoZSBjbGllbnRzIHRoYXQgYXJlIGN1cnJlbnRseSBhY3RpdmUuICovXG4vLyBQT1JUSU5HIE5PVEU6IE11bHRpLVRhYiBvbmx5LlxuZnVuY3Rpb24gdmEodCkge1xuICAgIGNvbnN0IGUgPSBVKHQpO1xuICAgIHJldHVybiBVKFUoZS5sb2NhbFN0b3JlKS5wZXJzaXN0ZW5jZSkucG4oKTtcbn1cblxuLyoqIEFwcGxpZXMgYSBxdWVyeSB0YXJnZXQgY2hhbmdlIGZyb20gYSBkaWZmZXJlbnQgdGFiLiAqL1xuLy8gUE9SVElORyBOT1RFOiBNdWx0aS1UYWIgb25seS5cbmFzeW5jIGZ1bmN0aW9uIFZhKHQsIGUsIG4sIHMpIHtcbiAgICBjb25zdCBpID0gVSh0KTtcbiAgICBpZiAoaS5xbykgXG4gICAgLy8gSWYgd2UgcmVjZWl2ZSBhIHRhcmdldCBzdGF0ZSBub3RpZmljYXRpb24gdmlhIFdlYlN0b3JhZ2UsIHdlIGFyZVxuICAgIC8vIGVpdGhlciBhbHJlYWR5IHNlY29uZGFyeSBvciBhbm90aGVyIHRhYiBoYXMgdGFrZW4gdGhlIHByaW1hcnkgbGVhc2UuXG4gICAgayhcIlN5bmNFbmdpbmVcIiwgXCJJZ25vcmluZyB1bmV4cGVjdGVkIHF1ZXJ5IHN0YXRlIG5vdGlmaWNhdGlvbi5cIik7IGVsc2UgaWYgKGkua28uaGFzKGUpKSBzd2l0Y2ggKG4pIHtcbiAgICAgIGNhc2UgXCJjdXJyZW50XCI6XG4gICAgICBjYXNlIFwibm90LWN1cnJlbnRcIjpcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgdCA9IGF3YWl0IHByKGkubG9jYWxTdG9yZSksIHMgPSBWbi5jcmVhdGVTeW50aGVzaXplZFJlbW90ZUV2ZW50Rm9yQ3VycmVudENoYW5nZShlLCBcImN1cnJlbnRcIiA9PT0gbik7XG4gICAgICAgICAgICBhd2FpdCB5YShpLCB0LCBzKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgIGNhc2UgXCJyZWplY3RlZFwiOlxuICAgICAgICBhd2FpdCBtcihpLmxvY2FsU3RvcmUsIGUsIFxuICAgICAgICAvKiBrZWVwUGVyc2lzdGVkVGFyZ2V0RGF0YSAqLyAhMCksIGRhKGksIGUsIHMpO1xuICAgICAgICBicmVhaztcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgTSgpO1xuICAgIH1cbn1cblxuLyoqIEFkZHMgb3IgcmVtb3ZlcyBXYXRjaCB0YXJnZXRzIGZvciBxdWVyaWVzIGZyb20gZGlmZmVyZW50IHRhYnMuICovIGFzeW5jIGZ1bmN0aW9uIFNhKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gRGEodCk7XG4gICAgaWYgKHMucW8pIHtcbiAgICAgICAgZm9yIChjb25zdCB0IG9mIGUpIHtcbiAgICAgICAgICAgIGlmIChzLmtvLmhhcyh0KSkge1xuICAgICAgICAgICAgICAgIC8vIEEgdGFyZ2V0IG1pZ2h0IGhhdmUgYmVlbiBhZGRlZCBpbiBhIHByZXZpb3VzIGF0dGVtcHRcbiAgICAgICAgICAgICAgICBrKFwiU3luY0VuZ2luZVwiLCBcIkFkZGluZyBhbiBhbHJlYWR5IGFjdGl2ZSB0YXJnZXQgXCIgKyB0KTtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGUgPSBhd2FpdCB5cihzLmxvY2FsU3RvcmUsIHQpLCBuID0gYXdhaXQgX3Iocy5sb2NhbFN0b3JlLCBlKTtcbiAgICAgICAgICAgIGF3YWl0IG5hKHMsIGJhKGUpLCBuLnRhcmdldElkLCBcbiAgICAgICAgICAgIC8qY3VycmVudD0qLyAhMSksIG9vKHMucmVtb3RlU3RvcmUsIG4pO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgdCBvZiBuKSBcbiAgICAgICAgLy8gQ2hlY2sgdGhhdCB0aGUgdGFyZ2V0IGlzIHN0aWxsIGFjdGl2ZSBzaW5jZSB0aGUgdGFyZ2V0IG1pZ2h0IGhhdmUgYmVlblxuICAgICAgICAvLyByZW1vdmVkIGlmIGl0IGhhcyBiZWVuIHJlamVjdGVkIGJ5IHRoZSBiYWNrZW5kLlxuICAgICAgICBzLmtvLmhhcyh0KSAmJiBcbiAgICAgICAgLy8gUmVsZWFzZSBxdWVyaWVzIHRoYXQgYXJlIHN0aWxsIGFjdGl2ZS5cbiAgICAgICAgYXdhaXQgbXIocy5sb2NhbFN0b3JlLCB0LCBcbiAgICAgICAgLyoga2VlcFBlcnNpc3RlZFRhcmdldERhdGEgKi8gITEpLnRoZW4oKCgpID0+IHtcbiAgICAgICAgICAgIGFvKHMucmVtb3RlU3RvcmUsIHQpLCBkYShzLCB0KTtcbiAgICAgICAgfSkpLmNhdGNoKE9pKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIERhKHQpIHtcbiAgICBjb25zdCBlID0gVSh0KTtcbiAgICByZXR1cm4gZS5yZW1vdGVTdG9yZS5yZW1vdGVTeW5jZXIuYXBwbHlSZW1vdGVFdmVudCA9IHJhLmJpbmQobnVsbCwgZSksIGUucmVtb3RlU3RvcmUucmVtb3RlU3luY2VyLmdldFJlbW90ZUtleXNGb3JUYXJnZXQgPSBFYS5iaW5kKG51bGwsIGUpLCBcbiAgICBlLnJlbW90ZVN0b3JlLnJlbW90ZVN5bmNlci5yZWplY3RMaXN0ZW4gPSBhYS5iaW5kKG51bGwsIGUpLCBlLk5vLlRyID0gVW8uYmluZChudWxsLCBlLmV2ZW50TWFuYWdlciksIFxuICAgIGUuTm8uam8gPSBxby5iaW5kKG51bGwsIGUuZXZlbnRNYW5hZ2VyKSwgZTtcbn1cblxuZnVuY3Rpb24gQ2EodCkge1xuICAgIGNvbnN0IGUgPSBVKHQpO1xuICAgIHJldHVybiBlLnJlbW90ZVN0b3JlLnJlbW90ZVN5bmNlci5hcHBseVN1Y2Nlc3NmdWxXcml0ZSA9IGNhLmJpbmQobnVsbCwgZSksIGUucmVtb3RlU3RvcmUucmVtb3RlU3luY2VyLnJlamVjdEZhaWxlZFdyaXRlID0gdWEuYmluZChudWxsLCBlKSwgXG4gICAgZTtcbn1cblxuLyoqXG4gKiBMb2FkcyBhIEZpcmVzdG9yZSBidW5kbGUgaW50byB0aGUgU0RLLiBUaGUgcmV0dXJuZWQgcHJvbWlzZSByZXNvbHZlcyB3aGVuXG4gKiB0aGUgYnVuZGxlIGZpbmlzaGVkIGxvYWRpbmcuXG4gKlxuICogQHBhcmFtIHN5bmNFbmdpbmUgLSBTeW5jRW5naW5lIHRvIHVzZS5cbiAqIEBwYXJhbSBidW5kbGVSZWFkZXIgLSBCdW5kbGUgdG8gbG9hZCBpbnRvIHRoZSBTREsuXG4gKiBAcGFyYW0gdGFzayAtIExvYWRCdW5kbGVUYXNrIHVzZWQgdG8gdXBkYXRlIHRoZSBsb2FkaW5nIHByb2dyZXNzIHRvIHB1YmxpYyBBUEkuXG4gKi8gZnVuY3Rpb24gTmEodCwgZSwgbikge1xuICAgIGNvbnN0IHMgPSBVKHQpO1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZmxvYXRpbmctcHJvbWlzZXNcbiAgICAgICAgKGFzeW5jIGZ1bmN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBhd2FpdCBlLmdldE1ldGFkYXRhKCk7XG4gICAgICAgICAgICBpZiAoYXdhaXQgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBVKHQpLCBzID0gS24oZS5jcmVhdGVUaW1lKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbi5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcImhhc05ld2VyQnVuZGxlXCIsIFwicmVhZG9ubHlcIiwgKHQgPT4gbi5KZS5nZXRCdW5kbGVNZXRhZGF0YSh0LCBlLmlkKSkpLnRoZW4oKHQgPT4gISF0ICYmIHQuY3JlYXRlVGltZS5jb21wYXJlVG8ocykgPj0gMCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyoqXG4gKiBTYXZlcyB0aGUgZ2l2ZW4gYEJ1bmRsZU1ldGFkYXRhYCB0byBsb2NhbCBwZXJzaXN0ZW5jZS5cbiAqLyAodC5sb2NhbFN0b3JlLCBzKSkgcmV0dXJuIGF3YWl0IGUuY2xvc2UoKSwgdm9pZCBuLl9jb21wbGV0ZVdpdGgoZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHRhc2tTdGF0ZTogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50c0xvYWRlZDogdC50b3RhbERvY3VtZW50cyxcbiAgICAgICAgICAgICAgICAgICAgYnl0ZXNMb2FkZWQ6IHQudG90YWxCeXRlcyxcbiAgICAgICAgICAgICAgICAgICAgdG90YWxEb2N1bWVudHM6IHQudG90YWxEb2N1bWVudHMsXG4gICAgICAgICAgICAgICAgICAgIHRvdGFsQnl0ZXM6IHQudG90YWxCeXRlc1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KHMpKTtcbiAgICAgICAgICAgIG4uX3VwZGF0ZVByb2dyZXNzKHpvKHMpKTtcbiAgICAgICAgICAgIGNvbnN0IGkgPSBuZXcgR28ocywgdC5sb2NhbFN0b3JlLCBlLk4pO1xuICAgICAgICAgICAgbGV0IHIgPSBhd2FpdCBlLlFvKCk7XG4gICAgICAgICAgICBmb3IgKDtyOyApIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gYXdhaXQgaS5mbyhyKTtcbiAgICAgICAgICAgICAgICB0ICYmIG4uX3VwZGF0ZVByb2dyZXNzKHQpLCByID0gYXdhaXQgZS5RbygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgbyA9IGF3YWl0IGkuY29tcGxldGUoKTtcbiAgICAgICAgICAgIC8vIFRPRE8oYi8xNjA4NzY0NDMpOiBUaGlzIGN1cnJlbnRseSByYWlzZXMgc25hcHNob3RzIHdpdGhcbiAgICAgICAgICAgIC8vIGBmcm9tQ2FjaGU9ZmFsc2VgIGlmIHVzZXJzIGFscmVhZHkgbGlzdGVuIHRvIHNvbWUgcXVlcmllcyBhbmQgYnVuZGxlc1xuICAgICAgICAgICAgLy8gaGFzIG5ld2VyIHZlcnNpb24uXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB5YSh0LCBvLlRuLCBcbiAgICAgICAgICAgIC8qIHJlbW90ZUV2ZW50ICovIHZvaWQgMCksIFxuICAgICAgICAgICAgLy8gU2F2ZSBtZXRhZGF0YSwgc28gbG9hZGluZyB0aGUgc2FtZSBidW5kbGUgd2lsbCBza2lwLlxuICAgICAgICAgICAgYXdhaXQgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBVKHQpO1xuICAgICAgICAgICAgICAgIHJldHVybiBuLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiU2F2ZSBidW5kbGVcIiwgXCJyZWFkd3JpdGVcIiwgKHQgPT4gbi5KZS5zYXZlQnVuZGxlTWV0YWRhdGEodCwgZSkpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qKlxuICogUmV0dXJucyBhIHByb21pc2Ugb2YgYSBgTmFtZWRRdWVyeWAgYXNzb2NpYXRlZCB3aXRoIGdpdmVuIHF1ZXJ5IG5hbWUuIFByb21pc2VcbiAqIHJlc29sdmVzIHRvIHVuZGVmaW5lZCBpZiBubyBwZXJzaXN0ZWQgZGF0YSBjYW4gYmUgZm91bmQuXG4gKi8gKHQubG9jYWxTdG9yZSwgcyksIG4uX2NvbXBsZXRlV2l0aChvLnByb2dyZXNzKTtcbiAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgTyhcIlN5bmNFbmdpbmVcIiwgYExvYWRpbmcgYnVuZGxlIGZhaWxlZCB3aXRoICR7dH1gKSwgbi5fZmFpbFdpdGgodCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbiAgICAvKipcbiAqIFByb3ZpZGVzIGFsbCBjb21wb25lbnRzIG5lZWRlZCBmb3IgRmlyZXN0b3JlIHdpdGggaW4tbWVtb3J5IHBlcnNpc3RlbmNlLlxuICogVXNlcyBFYWdlckdDIGdhcmJhZ2UgY29sbGVjdGlvbi5cbiAqLykocywgZSwgbikudGhlbigoKCkgPT4ge1xuICAgICAgICBzLnNoYXJlZENsaWVudFN0YXRlLm5vdGlmeUJ1bmRsZUxvYWRlZCgpO1xuICAgIH0pKTtcbn1cblxuY2xhc3MgeGEge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnN5bmNocm9uaXplVGFicyA9ICExO1xuICAgIH1cbiAgICBhc3luYyBpbml0aWFsaXplKHQpIHtcbiAgICAgICAgdGhpcy5OID0gSnIodC5kYXRhYmFzZUluZm8uZGF0YWJhc2VJZCksIHRoaXMuc2hhcmVkQ2xpZW50U3RhdGUgPSB0aGlzLldvKHQpLCB0aGlzLnBlcnNpc3RlbmNlID0gdGhpcy5Hbyh0KSwgXG4gICAgICAgIGF3YWl0IHRoaXMucGVyc2lzdGVuY2Uuc3RhcnQoKSwgdGhpcy5nY1NjaGVkdWxlciA9IHRoaXMuem8odCksIHRoaXMubG9jYWxTdG9yZSA9IHRoaXMuSG8odCk7XG4gICAgfVxuICAgIHpvKHQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIEhvKHQpIHtcbiAgICAgICAgcmV0dXJuIGNyKHRoaXMucGVyc2lzdGVuY2UsIG5ldyBvciwgdC5pbml0aWFsVXNlciwgdGhpcy5OKTtcbiAgICB9XG4gICAgR28odCkge1xuICAgICAgICByZXR1cm4gbmV3IERyKE5yLk5zLCB0aGlzLk4pO1xuICAgIH1cbiAgICBXbyh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgcXI7XG4gICAgfVxuICAgIGFzeW5jIHRlcm1pbmF0ZSgpIHtcbiAgICAgICAgdGhpcy5nY1NjaGVkdWxlciAmJiB0aGlzLmdjU2NoZWR1bGVyLnN0b3AoKSwgYXdhaXQgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZS5zaHV0ZG93bigpLCBcbiAgICAgICAgYXdhaXQgdGhpcy5wZXJzaXN0ZW5jZS5zaHV0ZG93bigpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBQcm92aWRlcyBhbGwgY29tcG9uZW50cyBuZWVkZWQgZm9yIEZpcmVzdG9yZSB3aXRoIEluZGV4ZWREQiBwZXJzaXN0ZW5jZS5cbiAqLyBjbGFzcyBrYSBleHRlbmRzIHhhIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMuSm8gPSB0LCB0aGlzLmNhY2hlU2l6ZUJ5dGVzID0gZSwgdGhpcy5mb3JjZU93bmVyc2hpcCA9IG4sIHRoaXMuc3luY2hyb25pemVUYWJzID0gITE7XG4gICAgfVxuICAgIGFzeW5jIGluaXRpYWxpemUodCkge1xuICAgICAgICBhd2FpdCBzdXBlci5pbml0aWFsaXplKHQpLCBhd2FpdCBFcih0aGlzLmxvY2FsU3RvcmUpLCBhd2FpdCB0aGlzLkpvLmluaXRpYWxpemUodGhpcywgdCksIFxuICAgICAgICAvLyBFbnF1ZXVlIHdyaXRlcyBmcm9tIGEgcHJldmlvdXMgc2Vzc2lvblxuICAgICAgICBhd2FpdCBDYSh0aGlzLkpvLnN5bmNFbmdpbmUpLCBhd2FpdCBFbyh0aGlzLkpvLnJlbW90ZVN0b3JlKSwgXG4gICAgICAgIC8vIE5PVEU6IFRoaXMgd2lsbCBpbW1lZGlhdGVseSBjYWxsIHRoZSBsaXN0ZW5lciwgc28gd2UgbWFrZSBzdXJlIHRvXG4gICAgICAgIC8vIHNldCBpdCBhZnRlciBsb2NhbFN0b3JlIC8gcmVtb3RlU3RvcmUgYXJlIHN0YXJ0ZWQuXG4gICAgICAgIGF3YWl0IHRoaXMucGVyc2lzdGVuY2Uubm4oKCgpID0+ICh0aGlzLmdjU2NoZWR1bGVyICYmICF0aGlzLmdjU2NoZWR1bGVyLnN0YXJ0ZWQgJiYgdGhpcy5nY1NjaGVkdWxlci5zdGFydCh0aGlzLmxvY2FsU3RvcmUpLCBcbiAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkpKSk7XG4gICAgfVxuICAgIEhvKHQpIHtcbiAgICAgICAgcmV0dXJuIGNyKHRoaXMucGVyc2lzdGVuY2UsIG5ldyBvciwgdC5pbml0aWFsVXNlciwgdGhpcy5OKTtcbiAgICB9XG4gICAgem8odCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5wZXJzaXN0ZW5jZS5yZWZlcmVuY2VEZWxlZ2F0ZS5nYXJiYWdlQ29sbGVjdG9yO1xuICAgICAgICByZXR1cm4gbmV3IExpKGUsIHQuYXN5bmNRdWV1ZSk7XG4gICAgfVxuICAgIEdvKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IG5yKHQuZGF0YWJhc2VJbmZvLmRhdGFiYXNlSWQsIHQuZGF0YWJhc2VJbmZvLnBlcnNpc3RlbmNlS2V5KSwgbiA9IHZvaWQgMCAhPT0gdGhpcy5jYWNoZVNpemVCeXRlcyA/IEFpLndpdGhDYWNoZVNpemUodGhpcy5jYWNoZVNpemVCeXRlcykgOiBBaS5ERUZBVUxUO1xuICAgICAgICByZXR1cm4gbmV3IFppKHRoaXMuc3luY2hyb25pemVUYWJzLCBlLCB0LmNsaWVudElkLCBuLCB0LmFzeW5jUXVldWUsIHpyKCksIEhyKCksIHRoaXMuTiwgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZSwgISF0aGlzLmZvcmNlT3duZXJzaGlwKTtcbiAgICB9XG4gICAgV28odCkge1xuICAgICAgICByZXR1cm4gbmV3IHFyO1xuICAgIH1cbn1cblxuLyoqXG4gKiBQcm92aWRlcyBhbGwgY29tcG9uZW50cyBuZWVkZWQgZm9yIEZpcmVzdG9yZSB3aXRoIG11bHRpLXRhYiBJbmRleGVkREJcbiAqIHBlcnNpc3RlbmNlLlxuICpcbiAqIEluIHRoZSBsZWdhY3kgY2xpZW50LCB0aGlzIHByb3ZpZGVyIGlzIHVzZWQgdG8gcHJvdmlkZSBib3RoIG11bHRpLXRhYiBhbmRcbiAqIG5vbi1tdWx0aS10YWIgcGVyc2lzdGVuY2Ugc2luY2Ugd2UgY2Fubm90IHRlbGwgYXQgYnVpbGQgdGltZSB3aGV0aGVyXG4gKiBgc3luY2hyb25pemVUYWJzYCB3aWxsIGJlIGVuYWJsZWQuXG4gKi8gY2xhc3MgJGEgZXh0ZW5kcyBrYSB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICBzdXBlcih0LCBlLCAvKiBmb3JjZU93bmVyc2hpcD0gKi8gITEpLCB0aGlzLkpvID0gdCwgdGhpcy5jYWNoZVNpemVCeXRlcyA9IGUsIHRoaXMuc3luY2hyb25pemVUYWJzID0gITA7XG4gICAgfVxuICAgIGFzeW5jIGluaXRpYWxpemUodCkge1xuICAgICAgICBhd2FpdCBzdXBlci5pbml0aWFsaXplKHQpO1xuICAgICAgICBjb25zdCBlID0gdGhpcy5Kby5zeW5jRW5naW5lO1xuICAgICAgICB0aGlzLnNoYXJlZENsaWVudFN0YXRlIGluc3RhbmNlb2YgVXIgJiYgKHRoaXMuc2hhcmVkQ2xpZW50U3RhdGUuc3luY0VuZ2luZSA9IHtcbiAgICAgICAgICAgIF9pOiBBYS5iaW5kKG51bGwsIGUpLFxuICAgICAgICAgICAgbWk6IFZhLmJpbmQobnVsbCwgZSksXG4gICAgICAgICAgICBnaTogU2EuYmluZChudWxsLCBlKSxcbiAgICAgICAgICAgIHBuOiB2YS5iaW5kKG51bGwsIGUpLFxuICAgICAgICAgICAgd2k6IElhLmJpbmQobnVsbCwgZSlcbiAgICAgICAgfSwgYXdhaXQgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZS5zdGFydCgpKSwgXG4gICAgICAgIC8vIE5PVEU6IFRoaXMgd2lsbCBpbW1lZGlhdGVseSBjYWxsIHRoZSBsaXN0ZW5lciwgc28gd2UgbWFrZSBzdXJlIHRvXG4gICAgICAgIC8vIHNldCBpdCBhZnRlciBsb2NhbFN0b3JlIC8gcmVtb3RlU3RvcmUgYXJlIHN0YXJ0ZWQuXG4gICAgICAgIGF3YWl0IHRoaXMucGVyc2lzdGVuY2Uubm4oKGFzeW5jIHQgPT4ge1xuICAgICAgICAgICAgYXdhaXQgUmEodGhpcy5Kby5zeW5jRW5naW5lLCB0KSwgdGhpcy5nY1NjaGVkdWxlciAmJiAodCAmJiAhdGhpcy5nY1NjaGVkdWxlci5zdGFydGVkID8gdGhpcy5nY1NjaGVkdWxlci5zdGFydCh0aGlzLmxvY2FsU3RvcmUpIDogdCB8fCB0aGlzLmdjU2NoZWR1bGVyLnN0b3AoKSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgV28odCkge1xuICAgICAgICBjb25zdCBlID0genIoKTtcbiAgICAgICAgaWYgKCFVci5QdChlKSkgdGhyb3cgbmV3IEsocS5VTklNUExFTUVOVEVELCBcIkluZGV4ZWREQiBwZXJzaXN0ZW5jZSBpcyBvbmx5IGF2YWlsYWJsZSBvbiBwbGF0Zm9ybXMgdGhhdCBzdXBwb3J0IExvY2FsU3RvcmFnZS5cIik7XG4gICAgICAgIGNvbnN0IG4gPSBucih0LmRhdGFiYXNlSW5mby5kYXRhYmFzZUlkLCB0LmRhdGFiYXNlSW5mby5wZXJzaXN0ZW5jZUtleSk7XG4gICAgICAgIHJldHVybiBuZXcgVXIoZSwgdC5hc3luY1F1ZXVlLCBuLCB0LmNsaWVudElkLCB0LmluaXRpYWxVc2VyKTtcbiAgICB9XG59XG5cbi8qKlxuICogSW5pdGlhbGl6ZXMgYW5kIHdpcmVzIHRoZSBjb21wb25lbnRzIHRoYXQgYXJlIG5lZWRlZCB0byBpbnRlcmZhY2Ugd2l0aCB0aGVcbiAqIG5ldHdvcmsuXG4gKi8gY2xhc3MgT2Ege1xuICAgIGFzeW5jIGluaXRpYWxpemUodCwgZSkge1xuICAgICAgICB0aGlzLmxvY2FsU3RvcmUgfHwgKHRoaXMubG9jYWxTdG9yZSA9IHQubG9jYWxTdG9yZSwgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZSA9IHQuc2hhcmVkQ2xpZW50U3RhdGUsIFxuICAgICAgICB0aGlzLmRhdGFzdG9yZSA9IHRoaXMuY3JlYXRlRGF0YXN0b3JlKGUpLCB0aGlzLnJlbW90ZVN0b3JlID0gdGhpcy5jcmVhdGVSZW1vdGVTdG9yZShlKSwgXG4gICAgICAgIHRoaXMuZXZlbnRNYW5hZ2VyID0gdGhpcy5jcmVhdGVFdmVudE1hbmFnZXIoZSksIHRoaXMuc3luY0VuZ2luZSA9IHRoaXMuY3JlYXRlU3luY0VuZ2luZShlLCBcbiAgICAgICAgLyogc3RhcnRBc1ByaW1hcnk9Ki8gIXQuc3luY2hyb25pemVUYWJzKSwgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZS5vbmxpbmVTdGF0ZUhhbmRsZXIgPSB0ID0+IG9hKHRoaXMuc3luY0VuZ2luZSwgdCwgMSAvKiBTaGFyZWRDbGllbnRTdGF0ZSAqLyksIFxuICAgICAgICB0aGlzLnJlbW90ZVN0b3JlLnJlbW90ZVN5bmNlci5oYW5kbGVDcmVkZW50aWFsQ2hhbmdlID0gcGEuYmluZChudWxsLCB0aGlzLnN5bmNFbmdpbmUpLCBcbiAgICAgICAgYXdhaXQgU28odGhpcy5yZW1vdGVTdG9yZSwgdGhpcy5zeW5jRW5naW5lLmlzUHJpbWFyeUNsaWVudCkpO1xuICAgIH1cbiAgICBjcmVhdGVFdmVudE1hbmFnZXIodCkge1xuICAgICAgICByZXR1cm4gbmV3IE1vO1xuICAgIH1cbiAgICBjcmVhdGVEYXRhc3RvcmUodCkge1xuICAgICAgICBjb25zdCBlID0gSnIodC5kYXRhYmFzZUluZm8uZGF0YWJhc2VJZCksIG4gPSAocyA9IHQuZGF0YWJhc2VJbmZvLCBuZXcgR3IocykpO1xuICAgICAgICB2YXIgcztcbiAgICAgICAgLyoqIFJldHVybiB0aGUgUGxhdGZvcm0tc3BlY2lmaWMgY29ubmVjdGl2aXR5IG1vbml0b3IuICovICAgICAgICByZXR1cm4gZnVuY3Rpb24odCwgZSwgbikge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBlbyh0LCBlLCBuKTtcbiAgICAgICAgfSh0LmNyZWRlbnRpYWxzLCBuLCBlKTtcbiAgICB9XG4gICAgY3JlYXRlUmVtb3RlU3RvcmUodCkge1xuICAgICAgICByZXR1cm4gZSA9IHRoaXMubG9jYWxTdG9yZSwgbiA9IHRoaXMuZGF0YXN0b3JlLCBzID0gdC5hc3luY1F1ZXVlLCBpID0gdCA9PiBvYSh0aGlzLnN5bmNFbmdpbmUsIHQsIDAgLyogUmVtb3RlU3RvcmUgKi8pLCBcbiAgICAgICAgciA9IGpyLlB0KCkgPyBuZXcganIgOiBuZXcgS3IsIG5ldyBzbyhlLCBuLCBzLCBpLCByKTtcbiAgICAgICAgdmFyIGUsIG4sIHMsIGksIHI7XG4gICAgICAgIC8qKiBSZS1lbmFibGVzIHRoZSBuZXR3b3JrLiBJZGVtcG90ZW50LiAqLyAgICB9XG4gICAgY3JlYXRlU3luY0VuZ2luZSh0LCBlKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0LCBlLCBuLCBcbiAgICAgICAgLy8gUE9SVElORyBOT1RFOiBNYW5hZ2VzIHN0YXRlIHN5bmNocm9uaXphdGlvbiBpbiBtdWx0aS10YWIgZW52aXJvbm1lbnRzLlxuICAgICAgICBzLCBpLCByLCBvKSB7XG4gICAgICAgICAgICBjb25zdCBhID0gbmV3IHRhKHQsIGUsIG4sIHMsIGksIHIpO1xuICAgICAgICAgICAgcmV0dXJuIG8gJiYgKGEucW8gPSAhMCksIGE7XG4gICAgICAgIH0odGhpcy5sb2NhbFN0b3JlLCB0aGlzLnJlbW90ZVN0b3JlLCB0aGlzLmV2ZW50TWFuYWdlciwgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZSwgdC5pbml0aWFsVXNlciwgdC5tYXhDb25jdXJyZW50TGltYm9SZXNvbHV0aW9ucywgZSk7XG4gICAgfVxuICAgIHRlcm1pbmF0ZSgpIHtcbiAgICAgICAgcmV0dXJuIGFzeW5jIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSBVKHQpO1xuICAgICAgICAgICAgayhcIlJlbW90ZVN0b3JlXCIsIFwiUmVtb3RlU3RvcmUgc2h1dHRpbmcgZG93bi5cIiksIGUuS3IuYWRkKDUgLyogU2h1dGRvd24gKi8pLCBhd2FpdCBybyhlKSwgXG4gICAgICAgICAgICBlLlFyLnNodXRkb3duKCksIFxuICAgICAgICAgICAgLy8gU2V0IHRoZSBPbmxpbmVTdGF0ZSB0byBVbmtub3duIChyYXRoZXIgdGhhbiBPZmZsaW5lKSB0byBhdm9pZCBwb3RlbnRpYWxseVxuICAgICAgICAgICAgLy8gdHJpZ2dlcmluZyBzcHVyaW91cyBsaXN0ZW5lciBldmVudHMgd2l0aCBjYWNoZWQgZGF0YSwgZXRjLlxuICAgICAgICAgICAgZS5Xci5zZXQoXCJVbmtub3duXCIgLyogVW5rbm93biAqLyk7XG4gICAgICAgIH0odGhpcy5yZW1vdGVTdG9yZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBIb3cgbWFueSBieXRlcyB0byByZWFkIGVhY2ggdGltZSB3aGVuIGBSZWFkYWJsZVN0cmVhbVJlYWRlci5yZWFkKClgIGlzXG4gKiBjYWxsZWQuIE9ubHkgYXBwbGljYWJsZSBmb3IgYnl0ZSBzdHJlYW1zIHRoYXQgd2UgY29udHJvbCAoZS5nLiB0aG9zZSBiYWNrZWRcbiAqIGJ5IGFuIFVJbnQ4QXJyYXkpLlxuICovXG4vKipcbiAqIEJ1aWxkcyBhIGBCeXRlU3RyZWFtUmVhZGVyYCBmcm9tIGEgVUludDhBcnJheS5cbiAqIEBwYXJhbSBzb3VyY2UgLSBUaGUgZGF0YSBzb3VyY2UgdG8gdXNlLlxuICogQHBhcmFtIGJ5dGVzUGVyUmVhZCAtIEhvdyBtYW55IGJ5dGVzIGVhY2ggYHJlYWQoKWAgZnJvbSB0aGUgcmV0dXJuZWQgcmVhZGVyXG4gKiAgICAgICAgd2lsbCByZWFkLlxuICovXG5mdW5jdGlvbiBGYSh0LCBlID0gMTAyNDApIHtcbiAgICBsZXQgbiA9IDA7XG4gICAgLy8gVGhlIFR5cGVTY3JpcHQgZGVmaW5pdGlvbiBmb3IgUmVhZGFibGVTdHJlYW1SZWFkZXIgY2hhbmdlZC4gV2UgdXNlXG4gICAgLy8gYGFueWAgaGVyZSB0byBhbGxvdyB0aGlzIGNvZGUgdG8gY29tcGlsZSB3aXRoIGRpZmZlcmVudCB2ZXJzaW9ucy5cbiAgICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL21pY3Jvc29mdC9UeXBlU2NyaXB0L2lzc3Vlcy80Mjk3MFxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgIGFzeW5jIHJlYWQoKSB7XG4gICAgICAgICAgICBpZiAobiA8IHQuYnl0ZUxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiB0LnNsaWNlKG4sIG4gKyBlKSxcbiAgICAgICAgICAgICAgICAgICAgZG9uZTogITFcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHJldHVybiBuICs9IGUsIHM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGRvbmU6ICEwXG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuICAgICAgICBhc3luYyBjYW5jZWwoKSB7fSxcbiAgICAgICAgcmVsZWFzZUxvY2soKSB7fSxcbiAgICAgICAgY2xvc2VkOiBQcm9taXNlLnJlamVjdChcInVuaW1wbGVtZW50ZWRcIilcbiAgICB9O1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBPbiB3ZWIsIGEgYFJlYWRhYmxlU3RyZWFtYCBpcyB3cmFwcGVkIGFyb3VuZCBieSBhIGBCeXRlU3RyZWFtUmVhZGVyYC5cbiAqL1xuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qXG4gKiBBIHdyYXBwZXIgaW1wbGVtZW50YXRpb24gb2YgT2JzZXJ2ZXI8VD4gdGhhdCB3aWxsIGRpc3BhdGNoIGV2ZW50c1xuICogYXN5bmNocm9ub3VzbHkuIFRvIGFsbG93IGltbWVkaWF0ZSBzaWxlbmNpbmcsIGEgbXV0ZSBjYWxsIGlzIGFkZGVkIHdoaWNoXG4gKiBjYXVzZXMgZXZlbnRzIHNjaGVkdWxlZCB0byBubyBsb25nZXIgYmUgcmFpc2VkLlxuICovXG5jbGFzcyBNYSB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLm9ic2VydmVyID0gdCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBXaGVuIHNldCB0byB0cnVlLCB3aWxsIG5vdCByYWlzZSBmdXR1cmUgZXZlbnRzLiBOZWNlc3NhcnkgdG8gZGVhbCB3aXRoXG4gICAgICAgICAqIGFzeW5jIGRldGFjaG1lbnQgb2YgbGlzdGVuZXIuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm11dGVkID0gITE7XG4gICAgfVxuICAgIG5leHQodCkge1xuICAgICAgICB0aGlzLm9ic2VydmVyLm5leHQgJiYgdGhpcy5Zbyh0aGlzLm9ic2VydmVyLm5leHQsIHQpO1xuICAgIH1cbiAgICBlcnJvcih0KSB7XG4gICAgICAgIHRoaXMub2JzZXJ2ZXIuZXJyb3IgPyB0aGlzLllvKHRoaXMub2JzZXJ2ZXIuZXJyb3IsIHQpIDogY29uc29sZS5lcnJvcihcIlVuY2F1Z2h0IEVycm9yIGluIHNuYXBzaG90IGxpc3RlbmVyOlwiLCB0KTtcbiAgICB9XG4gICAgWG8oKSB7XG4gICAgICAgIHRoaXMubXV0ZWQgPSAhMDtcbiAgICB9XG4gICAgWW8odCwgZSkge1xuICAgICAgICB0aGlzLm11dGVkIHx8IHNldFRpbWVvdXQoKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMubXV0ZWQgfHwgdChlKTtcbiAgICAgICAgfSksIDApO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSBjbGFzcyByZXByZXNlbnRpbmcgYSBidW5kbGUuXG4gKlxuICogVGFrZXMgYSBidW5kbGUgc3RyZWFtIG9yIGJ1ZmZlciwgYW5kIHByZXNlbnRzIGFic3RyYWN0aW9ucyB0byByZWFkIGJ1bmRsZWRcbiAqIGVsZW1lbnRzIG91dCBvZiB0aGUgdW5kZXJseWluZyBjb250ZW50LlxuICovIGNsYXNzIExhIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKiogVGhlIHJlYWRlciB0byByZWFkIGZyb20gdW5kZXJseWluZyBiaW5hcnkgYnVuZGxlIGRhdGEgc291cmNlLiAqL1xuICAgIHQsIGUpIHtcbiAgICAgICAgdGhpcy5abyA9IHQsIHRoaXMuTiA9IGUsIFxuICAgICAgICAvKiogQ2FjaGVkIGJ1bmRsZSBtZXRhZGF0YS4gKi9cbiAgICAgICAgdGhpcy5tZXRhZGF0YSA9IG5ldyBqLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEludGVybmFsIGJ1ZmZlciB0byBob2xkIGJ1bmRsZSBjb250ZW50LCBhY2N1bXVsYXRpbmcgaW5jb21wbGV0ZSBlbGVtZW50XG4gICAgICAgICAqIGNvbnRlbnQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmJ1ZmZlciA9IG5ldyBVaW50OEFycmF5LCB0aGlzLnRhID0gbmV3IFRleHREZWNvZGVyKFwidXRmLThcIiksIFxuICAgICAgICAvLyBSZWFkIHRoZSBtZXRhZGF0YSAod2hpY2ggaXMgdGhlIGZpcnN0IGVsZW1lbnQpLlxuICAgICAgICB0aGlzLmVhKCkudGhlbigodCA9PiB7XG4gICAgICAgICAgICB0ICYmIHQuaG8oKSA/IHRoaXMubWV0YWRhdGEucmVzb2x2ZSh0LnBheWxvYWQubWV0YWRhdGEpIDogdGhpcy5tZXRhZGF0YS5yZWplY3QobmV3IEVycm9yKGBUaGUgZmlyc3QgZWxlbWVudCBvZiB0aGUgYnVuZGxlIGlzIG5vdCBhIG1ldGFkYXRhLCBpdCBpc1xcbiAgICAgICAgICAgICAke0pTT04uc3RyaW5naWZ5KG51bGwgPT0gdCA/IHZvaWQgMCA6IHQucGF5bG9hZCl9YCkpO1xuICAgICAgICB9KSwgKHQgPT4gdGhpcy5tZXRhZGF0YS5yZWplY3QodCkpKTtcbiAgICB9XG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLlpvLmNhbmNlbCgpO1xuICAgIH1cbiAgICBhc3luYyBnZXRNZXRhZGF0YSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubWV0YWRhdGEucHJvbWlzZTtcbiAgICB9XG4gICAgYXN5bmMgUW8oKSB7XG4gICAgICAgIC8vIE1ha2VzIHN1cmUgbWV0YWRhdGEgaXMgcmVhZCBiZWZvcmUgcHJvY2VlZGluZy5cbiAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZ2V0TWV0YWRhdGEoKSwgdGhpcy5lYSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZWFkcyBmcm9tIHRoZSBoZWFkIG9mIGludGVybmFsIGJ1ZmZlciwgYW5kIHB1bGxpbmcgbW9yZSBkYXRhIGZyb21cbiAgICAgKiB1bmRlcmx5aW5nIHN0cmVhbSBpZiBhIGNvbXBsZXRlIGVsZW1lbnQgY2Fubm90IGJlIGZvdW5kLCB1bnRpbCBhblxuICAgICAqIGVsZW1lbnQoaW5jbHVkaW5nIHRoZSBwcmVmaXhlZCBsZW5ndGggYW5kIHRoZSBKU09OIHN0cmluZykgaXMgZm91bmQuXG4gICAgICpcbiAgICAgKiBPbmNlIGEgY29tcGxldGUgZWxlbWVudCBpcyByZWFkLCBpdCBpcyBkcm9wcGVkIGZyb20gaW50ZXJuYWwgYnVmZmVyLlxuICAgICAqXG4gICAgICogUmV0dXJucyBlaXRoZXIgdGhlIGJ1bmRsZWQgZWxlbWVudCwgb3IgbnVsbCBpZiB3ZSBoYXZlIHJlYWNoZWQgdGhlIGVuZCBvZlxuICAgICAqIHRoZSBzdHJlYW0uXG4gICAgICovICAgIGFzeW5jIGVhKCkge1xuICAgICAgICBjb25zdCB0ID0gYXdhaXQgdGhpcy5uYSgpO1xuICAgICAgICBpZiAobnVsbCA9PT0gdCkgcmV0dXJuIG51bGw7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLnRhLmRlY29kZSh0KSwgbiA9IE51bWJlcihlKTtcbiAgICAgICAgaXNOYU4obikgJiYgdGhpcy5zYShgbGVuZ3RoIHN0cmluZyAoJHtlfSkgaXMgbm90IHZhbGlkIG51bWJlcmApO1xuICAgICAgICBjb25zdCBzID0gYXdhaXQgdGhpcy5pYShuKTtcbiAgICAgICAgcmV0dXJuIG5ldyBRbyhKU09OLnBhcnNlKHMpLCB0Lmxlbmd0aCArIG4pO1xuICAgIH1cbiAgICAvKiogRmlyc3QgaW5kZXggb2YgJ3snIGZyb20gdGhlIHVuZGVybHlpbmcgYnVmZmVyLiAqLyAgICByYSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYnVmZmVyLmZpbmRJbmRleCgodCA9PiB0ID09PSBcIntcIi5jaGFyQ29kZUF0KDApKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlYWRzIGZyb20gdGhlIGJlZ2lubmluZyBvZiB0aGUgaW50ZXJuYWwgYnVmZmVyLCB1bnRpbCB0aGUgZmlyc3QgJ3snLCBhbmRcbiAgICAgKiByZXR1cm4gdGhlIGNvbnRlbnQuXG4gICAgICpcbiAgICAgKiBJZiByZWFjaGVkIGVuZCBvZiB0aGUgc3RyZWFtLCByZXR1cm5zIGEgbnVsbC5cbiAgICAgKi8gICAgYXN5bmMgbmEoKSB7XG4gICAgICAgIGZvciAoO3RoaXMucmEoKSA8IDA7ICkge1xuICAgICAgICAgICAgaWYgKGF3YWl0IHRoaXMub2EoKSkgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQnJva2Ugb3V0IG9mIHRoZSBsb29wIGJlY2F1c2UgdW5kZXJseWluZyBzdHJlYW0gaXMgY2xvc2VkLCBhbmQgdGhlcmVcbiAgICAgICAgLy8gaGFwcGVucyB0byBiZSBubyBtb3JlIGRhdGEgdG8gcHJvY2Vzcy5cbiAgICAgICAgICAgICAgICBpZiAoMCA9PT0gdGhpcy5idWZmZXIubGVuZ3RoKSByZXR1cm4gbnVsbDtcbiAgICAgICAgY29uc3QgdCA9IHRoaXMucmEoKTtcbiAgICAgICAgLy8gQnJva2Ugb3V0IG9mIHRoZSBsb29wIGJlY2F1c2UgdW5kZXJseWluZyBzdHJlYW0gaXMgY2xvc2VkLCBidXQgc3RpbGxcbiAgICAgICAgLy8gY2Fubm90IGZpbmQgYW4gb3BlbiBicmFja2V0LlxuICAgICAgICAgICAgICAgIHQgPCAwICYmIHRoaXMuc2EoXCJSZWFjaGVkIHRoZSBlbmQgb2YgYnVuZGxlIHdoZW4gYSBsZW5ndGggc3RyaW5nIGlzIGV4cGVjdGVkLlwiKTtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuYnVmZmVyLnNsaWNlKDAsIHQpO1xuICAgICAgICAvLyBVcGRhdGUgdGhlIGludGVybmFsIGJ1ZmZlciB0byBkcm9wIHRoZSByZWFkIGxlbmd0aC5cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5idWZmZXIgPSB0aGlzLmJ1ZmZlci5zbGljZSh0KSwgZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVhZHMgZnJvbSBhIHNwZWNpZmllZCBwb3NpdGlvbiBmcm9tIHRoZSBpbnRlcm5hbCBidWZmZXIsIGZvciBhIHNwZWNpZmllZFxuICAgICAqIG51bWJlciBvZiBieXRlcywgcHVsbGluZyBtb3JlIGRhdGEgZnJvbSB0aGUgdW5kZXJseWluZyBzdHJlYW0gaWYgbmVlZGVkLlxuICAgICAqXG4gICAgICogUmV0dXJucyBhIHN0cmluZyBkZWNvZGVkIGZyb20gdGhlIHJlYWQgYnl0ZXMuXG4gICAgICovICAgIGFzeW5jIGlhKHQpIHtcbiAgICAgICAgZm9yICg7dGhpcy5idWZmZXIubGVuZ3RoIDwgdDsgKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLm9hKCkgJiYgdGhpcy5zYShcIlJlYWNoZWQgdGhlIGVuZCBvZiBidW5kbGUgd2hlbiBtb3JlIGlzIGV4cGVjdGVkLlwiKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBlID0gdGhpcy50YS5kZWNvZGUodGhpcy5idWZmZXIuc2xpY2UoMCwgdCkpO1xuICAgICAgICAvLyBVcGRhdGUgdGhlIGludGVybmFsIGJ1ZmZlciB0byBkcm9wIHRoZSByZWFkIGpzb24gc3RyaW5nLlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmJ1ZmZlciA9IHRoaXMuYnVmZmVyLnNsaWNlKHQpLCBlO1xuICAgIH1cbiAgICBzYSh0KSB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZmxvYXRpbmctcHJvbWlzZXNcbiAgICAgICAgdGhyb3cgdGhpcy5aby5jYW5jZWwoKSwgbmV3IEVycm9yKGBJbnZhbGlkIGJ1bmRsZSBmb3JtYXQ6ICR7dH1gKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUHVsbHMgbW9yZSBkYXRhIGZyb20gdW5kZXJseWluZyBzdHJlYW0gdG8gaW50ZXJuYWwgYnVmZmVyLlxuICAgICAqIFJldHVybnMgYSBib29sZWFuIGluZGljYXRpbmcgd2hldGhlciB0aGUgc3RyZWFtIGlzIGZpbmlzaGVkLlxuICAgICAqLyAgICBhc3luYyBvYSgpIHtcbiAgICAgICAgY29uc3QgdCA9IGF3YWl0IHRoaXMuWm8ucmVhZCgpO1xuICAgICAgICBpZiAoIXQuZG9uZSkge1xuICAgICAgICAgICAgY29uc3QgZSA9IG5ldyBVaW50OEFycmF5KHRoaXMuYnVmZmVyLmxlbmd0aCArIHQudmFsdWUubGVuZ3RoKTtcbiAgICAgICAgICAgIGUuc2V0KHRoaXMuYnVmZmVyKSwgZS5zZXQodC52YWx1ZSwgdGhpcy5idWZmZXIubGVuZ3RoKSwgdGhpcy5idWZmZXIgPSBlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0LmRvbmU7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBJbnRlcm5hbCB0cmFuc2FjdGlvbiBvYmplY3QgcmVzcG9uc2libGUgZm9yIGFjY3VtdWxhdGluZyB0aGUgbXV0YXRpb25zIHRvXG4gKiBwZXJmb3JtIGFuZCB0aGUgYmFzZSB2ZXJzaW9ucyBmb3IgYW55IGRvY3VtZW50cyByZWFkLlxuICovXG5jbGFzcyBCYSB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLmRhdGFzdG9yZSA9IHQsIFxuICAgICAgICAvLyBUaGUgdmVyc2lvbiBvZiBlYWNoIGRvY3VtZW50IHRoYXQgd2FzIHJlYWQgZHVyaW5nIHRoaXMgdHJhbnNhY3Rpb24uXG4gICAgICAgIHRoaXMucmVhZFZlcnNpb25zID0gbmV3IE1hcCwgdGhpcy5tdXRhdGlvbnMgPSBbXSwgdGhpcy5jb21taXR0ZWQgPSAhMSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIGRlZmVycmVkIHVzYWdlIGVycm9yIHRoYXQgb2NjdXJyZWQgcHJldmlvdXNseSBpbiB0aGlzIHRyYW5zYWN0aW9uIHRoYXRcbiAgICAgICAgICogd2lsbCBjYXVzZSB0aGUgdHJhbnNhY3Rpb24gdG8gZmFpbCBvbmNlIGl0IGFjdHVhbGx5IGNvbW1pdHMuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmxhc3RXcml0ZUVycm9yID0gbnVsbCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTZXQgb2YgZG9jdW1lbnRzIHRoYXQgaGF2ZSBiZWVuIHdyaXR0ZW4gaW4gdGhlIHRyYW5zYWN0aW9uLlxuICAgICAgICAgKlxuICAgICAgICAgKiBXaGVuIHRoZXJlJ3MgbW9yZSB0aGFuIG9uZSB3cml0ZSB0byB0aGUgc2FtZSBrZXkgaW4gYSB0cmFuc2FjdGlvbiwgYW55XG4gICAgICAgICAqIHdyaXRlcyBhZnRlciB0aGUgZmlyc3QgYXJlIGhhbmRsZWQgZGlmZmVyZW50bHkuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLndyaXR0ZW5Eb2NzID0gbmV3IFNldDtcbiAgICB9XG4gICAgYXN5bmMgbG9va3VwKHQpIHtcbiAgICAgICAgaWYgKHRoaXMuZW5zdXJlQ29tbWl0Tm90Q2FsbGVkKCksIHRoaXMubXV0YXRpb25zLmxlbmd0aCA+IDApIHRocm93IG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgXCJGaXJlc3RvcmUgdHJhbnNhY3Rpb25zIHJlcXVpcmUgYWxsIHJlYWRzIHRvIGJlIGV4ZWN1dGVkIGJlZm9yZSBhbGwgd3JpdGVzLlwiKTtcbiAgICAgICAgY29uc3QgZSA9IGF3YWl0IGFzeW5jIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBVKHQpLCBzID0gSm4obi5OKSArIFwiL2RvY3VtZW50c1wiLCBpID0ge1xuICAgICAgICAgICAgICAgIGRvY3VtZW50czogZS5tYXAoKHQgPT4gV24obi5OLCB0KSkpXG4gICAgICAgICAgICB9LCByID0gYXdhaXQgbi5LaShcIkJhdGNoR2V0RG9jdW1lbnRzXCIsIHMsIGkpLCBvID0gbmV3IE1hcDtcbiAgICAgICAgICAgIHIuZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRzKG4uTiwgdCk7XG4gICAgICAgICAgICAgICAgby5zZXQoZS5rZXkudG9TdHJpbmcoKSwgZSk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICBjb25zdCBhID0gW107XG4gICAgICAgICAgICByZXR1cm4gZS5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gby5nZXQodC50b1N0cmluZygpKTtcbiAgICAgICAgICAgICAgICBMKCEhZSksIGEucHVzaChlKTtcbiAgICAgICAgICAgIH0pKSwgYTtcbiAgICAgICAgfSh0aGlzLmRhdGFzdG9yZSwgdCk7XG4gICAgICAgIHJldHVybiBlLmZvckVhY2goKHQgPT4gdGhpcy5yZWNvcmRWZXJzaW9uKHQpKSksIGU7XG4gICAgfVxuICAgIHNldCh0LCBlKSB7XG4gICAgICAgIHRoaXMud3JpdGUoZS50b011dGF0aW9uKHQsIHRoaXMucHJlY29uZGl0aW9uKHQpKSksIHRoaXMud3JpdHRlbkRvY3MuYWRkKHQudG9TdHJpbmcoKSk7XG4gICAgfVxuICAgIHVwZGF0ZSh0LCBlKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aGlzLndyaXRlKGUudG9NdXRhdGlvbih0LCB0aGlzLnByZWNvbmRpdGlvbkZvclVwZGF0ZSh0KSkpO1xuICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICB0aGlzLmxhc3RXcml0ZUVycm9yID0gdDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLndyaXR0ZW5Eb2NzLmFkZCh0LnRvU3RyaW5nKCkpO1xuICAgIH1cbiAgICBkZWxldGUodCkge1xuICAgICAgICB0aGlzLndyaXRlKG5ldyBvbih0LCB0aGlzLnByZWNvbmRpdGlvbih0KSkpLCB0aGlzLndyaXR0ZW5Eb2NzLmFkZCh0LnRvU3RyaW5nKCkpO1xuICAgIH1cbiAgICBhc3luYyBjb21taXQoKSB7XG4gICAgICAgIGlmICh0aGlzLmVuc3VyZUNvbW1pdE5vdENhbGxlZCgpLCB0aGlzLmxhc3RXcml0ZUVycm9yKSB0aHJvdyB0aGlzLmxhc3RXcml0ZUVycm9yO1xuICAgICAgICBjb25zdCB0ID0gdGhpcy5yZWFkVmVyc2lvbnM7XG4gICAgICAgIC8vIEZvciBlYWNoIG11dGF0aW9uLCBub3RlIHRoYXQgdGhlIGRvYyB3YXMgd3JpdHRlbi5cbiAgICAgICAgICAgICAgICB0aGlzLm11dGF0aW9ucy5mb3JFYWNoKChlID0+IHtcbiAgICAgICAgICAgIHQuZGVsZXRlKGUua2V5LnRvU3RyaW5nKCkpO1xuICAgICAgICB9KSksIFxuICAgICAgICAvLyBGb3IgZWFjaCBkb2N1bWVudCB0aGF0IHdhcyByZWFkIGJ1dCBub3Qgd3JpdHRlbiB0bywgd2Ugd2FudCB0byBwZXJmb3JtXG4gICAgICAgIC8vIGEgYHZlcmlmeWAgb3BlcmF0aW9uLlxuICAgICAgICB0LmZvckVhY2goKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuID0gUHQuZnJvbVBhdGgoZSk7XG4gICAgICAgICAgICB0aGlzLm11dGF0aW9ucy5wdXNoKG5ldyBhbihuLCB0aGlzLnByZWNvbmRpdGlvbihuKSkpO1xuICAgICAgICB9KSksIGF3YWl0IGFzeW5jIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBVKHQpLCBzID0gSm4obi5OKSArIFwiL2RvY3VtZW50c1wiLCBpID0ge1xuICAgICAgICAgICAgICAgIHdyaXRlczogZS5tYXAoKHQgPT4gbnMobi5OLCB0KSkpXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgYXdhaXQgbi5MaShcIkNvbW1pdFwiLCBzLCBpKTtcbiAgICAgICAgfSh0aGlzLmRhdGFzdG9yZSwgdGhpcy5tdXRhdGlvbnMpLCB0aGlzLmNvbW1pdHRlZCA9ICEwO1xuICAgIH1cbiAgICByZWNvcmRWZXJzaW9uKHQpIHtcbiAgICAgICAgbGV0IGU7XG4gICAgICAgIGlmICh0LmlzRm91bmREb2N1bWVudCgpKSBlID0gdC52ZXJzaW9uOyBlbHNlIHtcbiAgICAgICAgICAgIGlmICghdC5pc05vRG9jdW1lbnQoKSkgdGhyb3cgTSgpO1xuICAgICAgICAgICAgLy8gRm9yIGRlbGV0ZWQgZG9jcywgd2UgbXVzdCB1c2UgYmFzZVZlcnNpb24gMCB3aGVuIHdlIG92ZXJ3cml0ZSB0aGVtLlxuICAgICAgICAgICAgZSA9IGl0Lm1pbigpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG4gPSB0aGlzLnJlYWRWZXJzaW9ucy5nZXQodC5rZXkudG9TdHJpbmcoKSk7XG4gICAgICAgIGlmIChuKSB7XG4gICAgICAgICAgICBpZiAoIWUuaXNFcXVhbChuKSkgXG4gICAgICAgICAgICAvLyBUaGlzIHRyYW5zYWN0aW9uIHdpbGwgZmFpbCBubyBtYXR0ZXIgd2hhdC5cbiAgICAgICAgICAgIHRocm93IG5ldyBLKHEuQUJPUlRFRCwgXCJEb2N1bWVudCB2ZXJzaW9uIGNoYW5nZWQgYmV0d2VlbiB0d28gcmVhZHMuXCIpO1xuICAgICAgICB9IGVsc2UgdGhpcy5yZWFkVmVyc2lvbnMuc2V0KHQua2V5LnRvU3RyaW5nKCksIGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSB2ZXJzaW9uIG9mIHRoaXMgZG9jdW1lbnQgd2hlbiBpdCB3YXMgcmVhZCBpbiB0aGlzIHRyYW5zYWN0aW9uLFxuICAgICAqIGFzIGEgcHJlY29uZGl0aW9uLCBvciBubyBwcmVjb25kaXRpb24gaWYgaXQgd2FzIG5vdCByZWFkLlxuICAgICAqLyAgICBwcmVjb25kaXRpb24odCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5yZWFkVmVyc2lvbnMuZ2V0KHQudG9TdHJpbmcoKSk7XG4gICAgICAgIHJldHVybiAhdGhpcy53cml0dGVuRG9jcy5oYXModC50b1N0cmluZygpKSAmJiBlID8gV2UudXBkYXRlVGltZShlKSA6IFdlLm5vbmUoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgcHJlY29uZGl0aW9uIGZvciBhIGRvY3VtZW50IGlmIHRoZSBvcGVyYXRpb24gaXMgYW4gdXBkYXRlLlxuICAgICAqLyAgICBwcmVjb25kaXRpb25Gb3JVcGRhdGUodCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5yZWFkVmVyc2lvbnMuZ2V0KHQudG9TdHJpbmcoKSk7XG4gICAgICAgIC8vIFRoZSBmaXJzdCB0aW1lIGEgZG9jdW1lbnQgaXMgd3JpdHRlbiwgd2Ugd2FudCB0byB0YWtlIGludG8gYWNjb3VudCB0aGVcbiAgICAgICAgLy8gcmVhZCB0aW1lIGFuZCBleGlzdGVuY2VcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMud3JpdHRlbkRvY3MuaGFzKHQudG9TdHJpbmcoKSkgJiYgZSkge1xuICAgICAgICAgICAgaWYgKGUuaXNFcXVhbChpdC5taW4oKSkpIFxuICAgICAgICAgICAgLy8gVGhlIGRvY3VtZW50IGRvZXNuJ3QgZXhpc3QsIHNvIGZhaWwgdGhlIHRyYW5zYWN0aW9uLlxuICAgICAgICAgICAgLy8gVGhpcyBoYXMgdG8gYmUgdmFsaWRhdGVkIGxvY2FsbHkgYmVjYXVzZSB5b3UgY2FuJ3Qgc2VuZCBhXG4gICAgICAgICAgICAvLyBwcmVjb25kaXRpb24gdGhhdCBhIGRvY3VtZW50IGRvZXMgbm90IGV4aXN0IHdpdGhvdXQgY2hhbmdpbmcgdGhlXG4gICAgICAgICAgICAvLyBzZW1hbnRpY3Mgb2YgdGhlIGJhY2tlbmQgd3JpdGUgdG8gYmUgYW4gaW5zZXJ0LiBUaGlzIGlzIHRoZSByZXZlcnNlXG4gICAgICAgICAgICAvLyBvZiB3aGF0IHdlIHdhbnQsIHNpbmNlIHdlIHdhbnQgdG8gYXNzZXJ0IHRoYXQgdGhlIGRvY3VtZW50IGRvZXNuJ3RcbiAgICAgICAgICAgIC8vIGV4aXN0IGJ1dCB0aGVuIHNlbmQgdGhlIHVwZGF0ZSBhbmQgaGF2ZSBpdCBmYWlsLiBTaW5jZSB3ZSBjYW4ndFxuICAgICAgICAgICAgLy8gZXhwcmVzcyB0aGF0IHRvIHRoZSBiYWNrZW5kLCB3ZSBoYXZlIHRvIHZhbGlkYXRlIGxvY2FsbHkuXG4gICAgICAgICAgICAvLyBOb3RlOiB0aGlzIGNhbiBjaGFuZ2Ugb25jZSB3ZSBjYW4gc2VuZCBzZXBhcmF0ZSB2ZXJpZnkgd3JpdGVzIGluIHRoZVxuICAgICAgICAgICAgLy8gdHJhbnNhY3Rpb24uXG4gICAgICAgICAgICB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIFwiQ2FuJ3QgdXBkYXRlIGEgZG9jdW1lbnQgdGhhdCBkb2Vzbid0IGV4aXN0LlwiKTtcbiAgICAgICAgICAgIC8vIERvY3VtZW50IGV4aXN0cywgYmFzZSBwcmVjb25kaXRpb24gb24gZG9jdW1lbnQgdXBkYXRlIHRpbWUuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gV2UudXBkYXRlVGltZShlKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBEb2N1bWVudCB3YXMgbm90IHJlYWQsIHNvIHdlIGp1c3QgdXNlIHRoZSBwcmVjb25kaXRpb25zIGZvciBhIGJsaW5kXG4gICAgICAgIC8vIHVwZGF0ZS5cbiAgICAgICAgcmV0dXJuIFdlLmV4aXN0cyghMCk7XG4gICAgfVxuICAgIHdyaXRlKHQpIHtcbiAgICAgICAgdGhpcy5lbnN1cmVDb21taXROb3RDYWxsZWQoKSwgdGhpcy5tdXRhdGlvbnMucHVzaCh0KTtcbiAgICB9XG4gICAgZW5zdXJlQ29tbWl0Tm90Q2FsbGVkKCkge31cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogVHJhbnNhY3Rpb25SdW5uZXIgZW5jYXBzdWxhdGVzIHRoZSBsb2dpYyBuZWVkZWQgdG8gcnVuIGFuZCByZXRyeSB0cmFuc2FjdGlvbnNcbiAqIHdpdGggYmFja29mZi5cbiAqL1xuY2xhc3MgVWEge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgdGhpcy5hc3luY1F1ZXVlID0gdCwgdGhpcy5kYXRhc3RvcmUgPSBlLCB0aGlzLnVwZGF0ZUZ1bmN0aW9uID0gbiwgdGhpcy5kZWZlcnJlZCA9IHMsIFxuICAgICAgICB0aGlzLmFhID0gNSwgdGhpcy5yciA9IG5ldyBZcih0aGlzLmFzeW5jUXVldWUsIFwidHJhbnNhY3Rpb25fcmV0cnlcIiAvKiBUcmFuc2FjdGlvblJldHJ5ICovKTtcbiAgICB9XG4gICAgLyoqIFJ1bnMgdGhlIHRyYW5zYWN0aW9uIGFuZCBzZXRzIHRoZSByZXN1bHQgb24gZGVmZXJyZWQuICovICAgIHJ1bigpIHtcbiAgICAgICAgdGhpcy5hYSAtPSAxLCB0aGlzLmNhKCk7XG4gICAgfVxuICAgIGNhKCkge1xuICAgICAgICB0aGlzLnJyLlhpKChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB0ID0gbmV3IEJhKHRoaXMuZGF0YXN0b3JlKSwgZSA9IHRoaXMudWEodCk7XG4gICAgICAgICAgICBlICYmIGUudGhlbigoZSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoKCgpID0+IHQuY29tbWl0KCkudGhlbigoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRlZmVycmVkLnJlc29sdmUoZSk7XG4gICAgICAgICAgICAgICAgfSkpLmNhdGNoKCh0ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYSh0KTtcbiAgICAgICAgICAgICAgICB9KSkpKTtcbiAgICAgICAgICAgIH0pKS5jYXRjaCgodCA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5oYSh0KTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB1YSh0KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBlID0gdGhpcy51cGRhdGVGdW5jdGlvbih0KTtcbiAgICAgICAgICAgIHJldHVybiAhSXQoZSkgJiYgZS5jYXRjaCAmJiBlLnRoZW4gPyBlIDogKHRoaXMuZGVmZXJyZWQucmVqZWN0KEVycm9yKFwiVHJhbnNhY3Rpb24gY2FsbGJhY2sgbXVzdCByZXR1cm4gYSBQcm9taXNlXCIpKSwgXG4gICAgICAgICAgICBudWxsKTtcbiAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgLy8gRG8gbm90IHJldHJ5IGVycm9ycyB0aHJvd24gYnkgdXNlciBwcm92aWRlZCB1cGRhdGVGdW5jdGlvbi5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLmRlZmVycmVkLnJlamVjdCh0KSwgbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBoYSh0KSB7XG4gICAgICAgIHRoaXMuYWEgPiAwICYmIHRoaXMubGEodCkgPyAodGhpcy5hYSAtPSAxLCB0aGlzLmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldCgoKCkgPT4gKHRoaXMuY2EoKSwgXG4gICAgICAgIFByb21pc2UucmVzb2x2ZSgpKSkpKSA6IHRoaXMuZGVmZXJyZWQucmVqZWN0KHQpO1xuICAgIH1cbiAgICBsYSh0KSB7XG4gICAgICAgIGlmIChcIkZpcmViYXNlRXJyb3JcIiA9PT0gdC5uYW1lKSB7XG4gICAgICAgICAgICAvLyBJbiB0cmFuc2FjdGlvbnMsIHRoZSBiYWNrZW5kIHdpbGwgZmFpbCBvdXRkYXRlZCByZWFkcyB3aXRoIEZBSUxFRF9QUkVDT05ESVRJT04gYW5kXG4gICAgICAgICAgICAvLyBub24tbWF0Y2hpbmcgZG9jdW1lbnQgdmVyc2lvbnMgd2l0aCBBQk9SVEVELiBUaGVzZSBlcnJvcnMgc2hvdWxkIGJlIHJldHJpZWQuXG4gICAgICAgICAgICBjb25zdCBlID0gdC5jb2RlO1xuICAgICAgICAgICAgcmV0dXJuIFwiYWJvcnRlZFwiID09PSBlIHx8IFwiZmFpbGVkLXByZWNvbmRpdGlvblwiID09PSBlIHx8ICFsbihlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gITE7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBGaXJlc3RvcmVDbGllbnQgaXMgYSB0b3AtbGV2ZWwgY2xhc3MgdGhhdCBjb25zdHJ1Y3RzIGFuZCBvd25zIGFsbCBvZiB0aGVcbiAqIHBpZWNlcyBvZiB0aGUgY2xpZW50IFNESyBhcmNoaXRlY3R1cmUuIEl0IGlzIHJlc3BvbnNpYmxlIGZvciBjcmVhdGluZyB0aGVcbiAqIGFzeW5jIHF1ZXVlIHRoYXQgaXMgc2hhcmVkIGJ5IGFsbCBvZiB0aGUgb3RoZXIgY29tcG9uZW50cyBpbiB0aGUgc3lzdGVtLlxuICovXG5jbGFzcyBxYSB7XG4gICAgY29uc3RydWN0b3IodCwgXG4gICAgLyoqXG4gICAgICogQXN5bmNocm9ub3VzIHF1ZXVlIHJlc3BvbnNpYmxlIGZvciBhbGwgb2Ygb3VyIGludGVybmFsIHByb2Nlc3NpbmcuIFdoZW5cbiAgICAgKiB3ZSBnZXQgaW5jb21pbmcgd29yayBmcm9tIHRoZSB1c2VyICh2aWEgcHVibGljIEFQSSkgb3IgdGhlIG5ldHdvcmtcbiAgICAgKiAoaW5jb21pbmcgR1JQQyBtZXNzYWdlcyksIHdlIHNob3VsZCBhbHdheXMgc2NoZWR1bGUgb250byB0aGlzIHF1ZXVlLlxuICAgICAqIFRoaXMgZW5zdXJlcyBhbGwgb2Ygb3VyIHdvcmsgaXMgcHJvcGVybHkgc2VyaWFsaXplZCAoZS5nLiB3ZSBkb24ndFxuICAgICAqIHN0YXJ0IHByb2Nlc3NpbmcgYSBuZXcgb3BlcmF0aW9uIHdoaWxlIHRoZSBwcmV2aW91cyBvbmUgaXMgd2FpdGluZyBmb3JcbiAgICAgKiBhbiBhc3luYyBJL08gdG8gY29tcGxldGUpLlxuICAgICAqL1xuICAgIGUsIG4pIHtcbiAgICAgICAgdGhpcy5jcmVkZW50aWFscyA9IHQsIHRoaXMuYXN5bmNRdWV1ZSA9IGUsIHRoaXMuZGF0YWJhc2VJbmZvID0gbiwgdGhpcy51c2VyID0gUy5VTkFVVEhFTlRJQ0FURUQsIFxuICAgICAgICB0aGlzLmNsaWVudElkID0gWi5JKCksIHRoaXMuY3JlZGVudGlhbExpc3RlbmVyID0gKCkgPT4gUHJvbWlzZS5yZXNvbHZlKCksIHRoaXMuY3JlZGVudGlhbHMuc3RhcnQoZSwgKGFzeW5jIHQgPT4ge1xuICAgICAgICAgICAgayhcIkZpcmVzdG9yZUNsaWVudFwiLCBcIlJlY2VpdmVkIHVzZXI9XCIsIHQudWlkKSwgYXdhaXQgdGhpcy5jcmVkZW50aWFsTGlzdGVuZXIodCksIFxuICAgICAgICAgICAgdGhpcy51c2VyID0gdDtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBhc3luYyBnZXRDb25maWd1cmF0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYXN5bmNRdWV1ZTogdGhpcy5hc3luY1F1ZXVlLFxuICAgICAgICAgICAgZGF0YWJhc2VJbmZvOiB0aGlzLmRhdGFiYXNlSW5mbyxcbiAgICAgICAgICAgIGNsaWVudElkOiB0aGlzLmNsaWVudElkLFxuICAgICAgICAgICAgY3JlZGVudGlhbHM6IHRoaXMuY3JlZGVudGlhbHMsXG4gICAgICAgICAgICBpbml0aWFsVXNlcjogdGhpcy51c2VyLFxuICAgICAgICAgICAgbWF4Q29uY3VycmVudExpbWJvUmVzb2x1dGlvbnM6IDEwMFxuICAgICAgICB9O1xuICAgIH1cbiAgICBzZXRDcmVkZW50aWFsQ2hhbmdlTGlzdGVuZXIodCkge1xuICAgICAgICB0aGlzLmNyZWRlbnRpYWxMaXN0ZW5lciA9IHQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENoZWNrcyB0aGF0IHRoZSBjbGllbnQgaGFzIG5vdCBiZWVuIHRlcm1pbmF0ZWQuIEVuc3VyZXMgdGhhdCBvdGhlciBtZXRob2RzIG9uXG4gICAgICogdGhpcyBjbGFzcyBjYW5ub3QgYmUgY2FsbGVkIGFmdGVyIHRoZSBjbGllbnQgaXMgdGVybWluYXRlZC5cbiAgICAgKi8gICAgdmVyaWZ5Tm90VGVybWluYXRlZCgpIHtcbiAgICAgICAgaWYgKHRoaXMuYXN5bmNRdWV1ZS5pc1NodXR0aW5nRG93bikgdGhyb3cgbmV3IEsocS5GQUlMRURfUFJFQ09ORElUSU9OLCBcIlRoZSBjbGllbnQgaGFzIGFscmVhZHkgYmVlbiB0ZXJtaW5hdGVkLlwiKTtcbiAgICB9XG4gICAgdGVybWluYXRlKCkge1xuICAgICAgICB0aGlzLmFzeW5jUXVldWUuZW50ZXJSZXN0cmljdGVkTW9kZSgpO1xuICAgICAgICBjb25zdCB0ID0gbmV3IGo7XG4gICAgICAgIHJldHVybiB0aGlzLmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldEV2ZW5XaGlsZVJlc3RyaWN0ZWQoKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vbmxpbmVDb21wb25lbnRzICYmIGF3YWl0IHRoaXMub25saW5lQ29tcG9uZW50cy50ZXJtaW5hdGUoKSwgdGhpcy5vZmZsaW5lQ29tcG9uZW50cyAmJiBhd2FpdCB0aGlzLm9mZmxpbmVDb21wb25lbnRzLnRlcm1pbmF0ZSgpLCBcbiAgICAgICAgICAgICAgICAvLyBUaGUgY3JlZGVudGlhbHMgcHJvdmlkZXIgbXVzdCBiZSB0ZXJtaW5hdGVkIGFmdGVyIHNodXR0aW5nIGRvd24gdGhlXG4gICAgICAgICAgICAgICAgLy8gUmVtb3RlU3RvcmUgYXMgaXQgd2lsbCBwcmV2ZW50IHRoZSBSZW1vdGVTdG9yZSBmcm9tIHJldHJpZXZpbmcgYXV0aFxuICAgICAgICAgICAgICAgIC8vIHRva2Vucy5cbiAgICAgICAgICAgICAgICB0aGlzLmNyZWRlbnRpYWxzLnNodXRkb3duKCksIHQucmVzb2x2ZSgpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB4byhlLCBcIkZhaWxlZCB0byBzaHV0ZG93biBwZXJzaXN0ZW5jZVwiKTtcbiAgICAgICAgICAgICAgICB0LnJlamVjdChuKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpLCB0LnByb21pc2U7XG4gICAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBLYSh0LCBlKSB7XG4gICAgdC5hc3luY1F1ZXVlLnZlcmlmeU9wZXJhdGlvbkluUHJvZ3Jlc3MoKSwgayhcIkZpcmVzdG9yZUNsaWVudFwiLCBcIkluaXRpYWxpemluZyBPZmZsaW5lQ29tcG9uZW50UHJvdmlkZXJcIik7XG4gICAgY29uc3QgbiA9IGF3YWl0IHQuZ2V0Q29uZmlndXJhdGlvbigpO1xuICAgIGF3YWl0IGUuaW5pdGlhbGl6ZShuKTtcbiAgICBsZXQgcyA9IG4uaW5pdGlhbFVzZXI7XG4gICAgdC5zZXRDcmVkZW50aWFsQ2hhbmdlTGlzdGVuZXIoKGFzeW5jIHQgPT4ge1xuICAgICAgICBzLmlzRXF1YWwodCkgfHwgKGF3YWl0IHVyKGUubG9jYWxTdG9yZSwgdCksIHMgPSB0KTtcbiAgICB9KSksIFxuICAgIC8vIFdoZW4gYSB1c2VyIGNhbGxzIGNsZWFyUGVyc2lzdGVuY2UoKSBpbiBvbmUgY2xpZW50LCBhbGwgb3RoZXIgY2xpZW50c1xuICAgIC8vIG5lZWQgdG8gYmUgdGVybWluYXRlZCB0byBhbGxvdyB0aGUgZGVsZXRlIHRvIHN1Y2NlZWQuXG4gICAgZS5wZXJzaXN0ZW5jZS5zZXREYXRhYmFzZURlbGV0ZWRMaXN0ZW5lcigoKCkgPT4gdC50ZXJtaW5hdGUoKSkpLCB0Lm9mZmxpbmVDb21wb25lbnRzID0gZTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gamEodCwgZSkge1xuICAgIHQuYXN5bmNRdWV1ZS52ZXJpZnlPcGVyYXRpb25JblByb2dyZXNzKCk7XG4gICAgY29uc3QgbiA9IGF3YWl0IFFhKHQpO1xuICAgIGsoXCJGaXJlc3RvcmVDbGllbnRcIiwgXCJJbml0aWFsaXppbmcgT25saW5lQ29tcG9uZW50UHJvdmlkZXJcIik7XG4gICAgY29uc3QgcyA9IGF3YWl0IHQuZ2V0Q29uZmlndXJhdGlvbigpO1xuICAgIGF3YWl0IGUuaW5pdGlhbGl6ZShuLCBzKSwgXG4gICAgLy8gVGhlIENyZWRlbnRpYWxDaGFuZ2VMaXN0ZW5lciBvZiB0aGUgb25saW5lIGNvbXBvbmVudCBwcm92aWRlciB0YWtlc1xuICAgIC8vIHByZWNlZGVuY2Ugb3ZlciB0aGUgb2ZmbGluZSBjb21wb25lbnQgcHJvdmlkZXIuXG4gICAgdC5zZXRDcmVkZW50aWFsQ2hhbmdlTGlzdGVuZXIoKHQgPT4gYXN5bmMgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBjb25zdCBuID0gVSh0KTtcbiAgICAgICAgbi5hc3luY1F1ZXVlLnZlcmlmeU9wZXJhdGlvbkluUHJvZ3Jlc3MoKSwgayhcIlJlbW90ZVN0b3JlXCIsIFwiUmVtb3RlU3RvcmUgcmVjZWl2ZWQgbmV3IGNyZWRlbnRpYWxzXCIpO1xuICAgICAgICBjb25zdCBzID0gZm8obik7XG4gICAgICAgIC8vIFRlYXIgZG93biBhbmQgcmUtY3JlYXRlIG91ciBuZXR3b3JrIHN0cmVhbXMuIFRoaXMgd2lsbCBlbnN1cmUgd2UgZ2V0IGFcbiAgICAgICAgLy8gZnJlc2ggYXV0aCB0b2tlbiBmb3IgdGhlIG5ldyB1c2VyIGFuZCByZS1maWxsIHRoZSB3cml0ZSBwaXBlbGluZSB3aXRoXG4gICAgICAgIC8vIG5ldyBtdXRhdGlvbnMgZnJvbSB0aGUgTG9jYWxTdG9yZSAoc2luY2UgbXV0YXRpb25zIGFyZSBwZXItdXNlcikuXG4gICAgICAgICAgICAgICAgbi5Lci5hZGQoMyAvKiBDcmVkZW50aWFsQ2hhbmdlICovKSwgYXdhaXQgcm8obiksIHMgJiYgXG4gICAgICAgIC8vIERvbid0IHNldCB0aGUgbmV0d29yayBzdGF0dXMgdG8gVW5rbm93biBpZiB3ZSBhcmUgb2ZmbGluZS5cbiAgICAgICAgbi5Xci5zZXQoXCJVbmtub3duXCIgLyogVW5rbm93biAqLyksIGF3YWl0IG4ucmVtb3RlU3luY2VyLmhhbmRsZUNyZWRlbnRpYWxDaGFuZ2UoZSksIFxuICAgICAgICBuLktyLmRlbGV0ZSgzIC8qIENyZWRlbnRpYWxDaGFuZ2UgKi8pLCBhd2FpdCBpbyhuKTtcbiAgICB9KGUucmVtb3RlU3RvcmUsIHQpKSksIHQub25saW5lQ29tcG9uZW50cyA9IGU7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIFFhKHQpIHtcbiAgICByZXR1cm4gdC5vZmZsaW5lQ29tcG9uZW50cyB8fCAoayhcIkZpcmVzdG9yZUNsaWVudFwiLCBcIlVzaW5nIGRlZmF1bHQgT2ZmbGluZUNvbXBvbmVudFByb3ZpZGVyXCIpLCBcbiAgICBhd2FpdCBLYSh0LCBuZXcgeGEpKSwgdC5vZmZsaW5lQ29tcG9uZW50cztcbn1cblxuYXN5bmMgZnVuY3Rpb24gV2EodCkge1xuICAgIHJldHVybiB0Lm9ubGluZUNvbXBvbmVudHMgfHwgKGsoXCJGaXJlc3RvcmVDbGllbnRcIiwgXCJVc2luZyBkZWZhdWx0IE9ubGluZUNvbXBvbmVudFByb3ZpZGVyXCIpLCBcbiAgICBhd2FpdCBqYSh0LCBuZXcgT2EpKSwgdC5vbmxpbmVDb21wb25lbnRzO1xufVxuXG5mdW5jdGlvbiBHYSh0KSB7XG4gICAgcmV0dXJuIFFhKHQpLnRoZW4oKHQgPT4gdC5wZXJzaXN0ZW5jZSkpO1xufVxuXG5mdW5jdGlvbiB6YSh0KSB7XG4gICAgcmV0dXJuIFFhKHQpLnRoZW4oKHQgPT4gdC5sb2NhbFN0b3JlKSk7XG59XG5cbmZ1bmN0aW9uIEhhKHQpIHtcbiAgICByZXR1cm4gV2EodCkudGhlbigodCA9PiB0LnJlbW90ZVN0b3JlKSk7XG59XG5cbmZ1bmN0aW9uIEphKHQpIHtcbiAgICByZXR1cm4gV2EodCkudGhlbigodCA9PiB0LnN5bmNFbmdpbmUpKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gWWEodCkge1xuICAgIGNvbnN0IGUgPSBhd2FpdCBXYSh0KSwgbiA9IGUuZXZlbnRNYW5hZ2VyO1xuICAgIHJldHVybiBuLm9uTGlzdGVuID0gZWEuYmluZChudWxsLCBlLnN5bmNFbmdpbmUpLCBuLm9uVW5saXN0ZW4gPSBzYS5iaW5kKG51bGwsIGUuc3luY0VuZ2luZSksIFxuICAgIG47XG59XG5cbi8qKiBFbmFibGVzIHRoZSBuZXR3b3JrIGNvbm5lY3Rpb24gYW5kIHJlLWVucXVldWVzIGFsbCBwZW5kaW5nIG9wZXJhdGlvbnMuICovIGZ1bmN0aW9uIFhhKHQpIHtcbiAgICByZXR1cm4gdC5hc3luY1F1ZXVlLmVucXVldWUoKGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgZSA9IGF3YWl0IEdhKHQpLCBuID0gYXdhaXQgSGEodCk7XG4gICAgICAgIHJldHVybiBlLnNldE5ldHdvcmtFbmFibGVkKCEwKSwgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgY29uc3QgZSA9IFUodCk7XG4gICAgICAgICAgICByZXR1cm4gZS5Lci5kZWxldGUoMCAvKiBVc2VyRGlzYWJsZWQgKi8pLCBpbyhlKTtcbiAgICAgICAgfShuKTtcbiAgICB9KSk7XG59XG5cbi8qKiBEaXNhYmxlcyB0aGUgbmV0d29yayBjb25uZWN0aW9uLiBQZW5kaW5nIG9wZXJhdGlvbnMgd2lsbCBub3QgY29tcGxldGUuICovIGZ1bmN0aW9uIFphKHQpIHtcbiAgICByZXR1cm4gdC5hc3luY1F1ZXVlLmVucXVldWUoKGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgZSA9IGF3YWl0IEdhKHQpLCBuID0gYXdhaXQgSGEodCk7XG4gICAgICAgIHJldHVybiBlLnNldE5ldHdvcmtFbmFibGVkKCExKSwgYXN5bmMgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgY29uc3QgZSA9IFUodCk7XG4gICAgICAgICAgICBlLktyLmFkZCgwIC8qIFVzZXJEaXNhYmxlZCAqLyksIGF3YWl0IHJvKGUpLCBcbiAgICAgICAgICAgIC8vIFNldCB0aGUgT25saW5lU3RhdGUgdG8gT2ZmbGluZSBzbyBnZXQoKXMgcmV0dXJuIGZyb20gY2FjaGUsIGV0Yy5cbiAgICAgICAgICAgIGUuV3Iuc2V0KFwiT2ZmbGluZVwiIC8qIE9mZmxpbmUgKi8pO1xuICAgICAgICB9KG4pO1xuICAgIH0pKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHdoZW4gYWxsIHdyaXRlcyB0aGF0IHdlcmUgcGVuZGluZyBhdCB0aGUgdGltZVxuICogdGhpcyBtZXRob2Qgd2FzIGNhbGxlZCByZWNlaXZlZCBzZXJ2ZXIgYWNrbm93bGVkZ2VtZW50LiBBbiBhY2tub3dsZWRnZW1lbnRcbiAqIGNhbiBiZSBlaXRoZXIgYWNjZXB0YW5jZSBvciByZWplY3Rpb24uXG4gKi8gZnVuY3Rpb24gdGModCwgZSkge1xuICAgIGNvbnN0IG4gPSBuZXcgajtcbiAgICByZXR1cm4gdC5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoKGFzeW5jICgpID0+IGFzeW5jIGZ1bmN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBhd2FpdCBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IFUodCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG4ucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJyZWFkIGRvY3VtZW50XCIsIFwicmVhZG9ubHlcIiwgKHQgPT4gbi5Rbi5Bbih0LCBlKSkpO1xuICAgICAgICAgICAgfSh0LCBlKTtcbiAgICAgICAgICAgIHMuaXNGb3VuZERvY3VtZW50KCkgPyBuLnJlc29sdmUocykgOiBzLmlzTm9Eb2N1bWVudCgpID8gbi5yZXNvbHZlKG51bGwpIDogbi5yZWplY3QobmV3IEsocS5VTkFWQUlMQUJMRSwgXCJGYWlsZWQgdG8gZ2V0IGRvY3VtZW50IGZyb20gY2FjaGUuIChIb3dldmVyLCB0aGlzIGRvY3VtZW50IG1heSBleGlzdCBvbiB0aGUgc2VydmVyLiBSdW4gYWdhaW4gd2l0aG91dCBzZXR0aW5nICdzb3VyY2UnIGluIHRoZSBHZXRPcHRpb25zIHRvIGF0dGVtcHQgdG8gcmV0cmlldmUgdGhlIGRvY3VtZW50IGZyb20gdGhlIHNlcnZlci4pXCIpKTtcbiAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgY29uc3QgcyA9IHhvKHQsIGBGYWlsZWQgdG8gZ2V0IGRvY3VtZW50ICcke2V9IGZyb20gY2FjaGVgKTtcbiAgICAgICAgICAgIG4ucmVqZWN0KHMpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICogUmV0cmlldmVzIGEgbGF0ZW5jeS1jb21wZW5zYXRlZCBkb2N1bWVudCBmcm9tIHRoZSBiYWNrZW5kIHZpYSBhXG4gKiBTbmFwc2hvdExpc3RlbmVyLlxuICovIChhd2FpdCB6YSh0KSwgZSwgbikpKSwgbi5wcm9taXNlO1xufVxuXG5mdW5jdGlvbiBlYyh0LCBlLCBuID0ge30pIHtcbiAgICBjb25zdCBzID0gbmV3IGo7XG4gICAgcmV0dXJuIHQuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KChhc3luYyAoKSA9PiBmdW5jdGlvbih0LCBlLCBuLCBzLCBpKSB7XG4gICAgICAgIGNvbnN0IHIgPSBuZXcgTWEoe1xuICAgICAgICAgICAgbmV4dDogciA9PiB7XG4gICAgICAgICAgICAgICAgLy8gUmVtb3ZlIHF1ZXJ5IGZpcnN0IGJlZm9yZSBwYXNzaW5nIGV2ZW50IHRvIHVzZXIgdG8gYXZvaWRcbiAgICAgICAgICAgICAgICAvLyB1c2VyIGFjdGlvbnMgYWZmZWN0aW5nIHRoZSBub3cgc3RhbGUgcXVlcnkuXG4gICAgICAgICAgICAgICAgZS5lbnF1ZXVlQW5kRm9yZ2V0KCgoKSA9PiBCbyh0LCBvKSkpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGEgPSByLmRvY3MuaGFzKG4pO1xuICAgICAgICAgICAgICAgICFhICYmIHIuZnJvbUNhY2hlID8gXG4gICAgICAgICAgICAgICAgLy8gVE9ETyhkaW1vbmQpOiBJZiB3ZSdyZSBvbmxpbmUgYW5kIHRoZSBkb2N1bWVudCBkb2Vzbid0XG4gICAgICAgICAgICAgICAgLy8gZXhpc3QgdGhlbiB3ZSByZXNvbHZlIHdpdGggYSBkb2MuZXhpc3RzIHNldCB0byBmYWxzZS4gSWZcbiAgICAgICAgICAgICAgICAvLyB3ZSdyZSBvZmZsaW5lIGhvd2V2ZXIsIHdlIHJlamVjdCB0aGUgUHJvbWlzZSBpbiB0aGlzXG4gICAgICAgICAgICAgICAgLy8gY2FzZS4gVHdvIG9wdGlvbnM6IDEpIENhY2hlIHRoZSBuZWdhdGl2ZSByZXNwb25zZSBmcm9tXG4gICAgICAgICAgICAgICAgLy8gdGhlIHNlcnZlciBzbyB3ZSBjYW4gZGVsaXZlciB0aGF0IGV2ZW4gd2hlbiB5b3UncmVcbiAgICAgICAgICAgICAgICAvLyBvZmZsaW5lIDIpIEFjdHVhbGx5IHJlamVjdCB0aGUgUHJvbWlzZSBpbiB0aGUgb25saW5lIGNhc2VcbiAgICAgICAgICAgICAgICAvLyBpZiB0aGUgZG9jdW1lbnQgZG9lc24ndCBleGlzdC5cbiAgICAgICAgICAgICAgICBpLnJlamVjdChuZXcgSyhxLlVOQVZBSUxBQkxFLCBcIkZhaWxlZCB0byBnZXQgZG9jdW1lbnQgYmVjYXVzZSB0aGUgY2xpZW50IGlzIG9mZmxpbmUuXCIpKSA6IGEgJiYgci5mcm9tQ2FjaGUgJiYgcyAmJiBcInNlcnZlclwiID09PSBzLnNvdXJjZSA/IGkucmVqZWN0KG5ldyBLKHEuVU5BVkFJTEFCTEUsICdGYWlsZWQgdG8gZ2V0IGRvY3VtZW50IGZyb20gc2VydmVyLiAoSG93ZXZlciwgdGhpcyBkb2N1bWVudCBkb2VzIGV4aXN0IGluIHRoZSBsb2NhbCBjYWNoZS4gUnVuIGFnYWluIHdpdGhvdXQgc2V0dGluZyBzb3VyY2UgdG8gXCJzZXJ2ZXJcIiB0byByZXRyaWV2ZSB0aGUgY2FjaGVkIGRvY3VtZW50LiknKSkgOiBpLnJlc29sdmUocik7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZXJyb3I6IHQgPT4gaS5yZWplY3QodClcbiAgICAgICAgfSksIG8gPSBuZXcgam8oZGUobi5wYXRoKSwgciwge1xuICAgICAgICAgICAgaW5jbHVkZU1ldGFkYXRhQ2hhbmdlczogITAsXG4gICAgICAgICAgICB1bzogITBcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBMbyh0LCBvKTtcbiAgICB9KGF3YWl0IFlhKHQpLCB0LmFzeW5jUXVldWUsIGUsIG4sIHMpKSksIHMucHJvbWlzZTtcbn1cblxuZnVuY3Rpb24gbmModCwgZSkge1xuICAgIGNvbnN0IG4gPSBuZXcgajtcbiAgICByZXR1cm4gdC5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoKGFzeW5jICgpID0+IGFzeW5jIGZ1bmN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBhd2FpdCBncih0LCBlLCBcbiAgICAgICAgICAgIC8qIHVzZVByZXZpb3VzUmVzdWx0cz0gKi8gITApLCBpID0gbmV3IFlvKGUsIHMuR24pLCByID0gaS5JbyhzLmRvY3VtZW50cyksIG8gPSBpLmFwcGx5Q2hhbmdlcyhyLCBcbiAgICAgICAgICAgIC8qIHVwZGF0ZUxpbWJvRG9jdW1lbnRzPSAqLyAhMSk7XG4gICAgICAgICAgICBuLnJlc29sdmUoby5zbmFwc2hvdCk7XG4gICAgICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSB4byh0LCBgRmFpbGVkIHRvIGV4ZWN1dGUgcXVlcnkgJyR7ZX0gYWdhaW5zdCBjYWNoZWApO1xuICAgICAgICAgICAgbi5yZWplY3Qocyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gKiBSZXRyaWV2ZXMgYSBsYXRlbmN5LWNvbXBlbnNhdGVkIHF1ZXJ5IHNuYXBzaG90IGZyb20gdGhlIGJhY2tlbmQgdmlhIGFcbiAqIFNuYXBzaG90TGlzdGVuZXIuXG4gKi8gKGF3YWl0IHphKHQpLCBlLCBuKSkpLCBuLnByb21pc2U7XG59XG5cbmZ1bmN0aW9uIHNjKHQsIGUsIG4gPSB7fSkge1xuICAgIGNvbnN0IHMgPSBuZXcgajtcbiAgICByZXR1cm4gdC5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoKGFzeW5jICgpID0+IGZ1bmN0aW9uKHQsIGUsIG4sIHMsIGkpIHtcbiAgICAgICAgY29uc3QgciA9IG5ldyBNYSh7XG4gICAgICAgICAgICBuZXh0OiBuID0+IHtcbiAgICAgICAgICAgICAgICAvLyBSZW1vdmUgcXVlcnkgZmlyc3QgYmVmb3JlIHBhc3NpbmcgZXZlbnQgdG8gdXNlciB0byBhdm9pZFxuICAgICAgICAgICAgICAgIC8vIHVzZXIgYWN0aW9ucyBhZmZlY3RpbmcgdGhlIG5vdyBzdGFsZSBxdWVyeS5cbiAgICAgICAgICAgICAgICBlLmVucXVldWVBbmRGb3JnZXQoKCgpID0+IEJvKHQsIG8pKSksIG4uZnJvbUNhY2hlICYmIFwic2VydmVyXCIgPT09IHMuc291cmNlID8gaS5yZWplY3QobmV3IEsocS5VTkFWQUlMQUJMRSwgJ0ZhaWxlZCB0byBnZXQgZG9jdW1lbnRzIGZyb20gc2VydmVyLiAoSG93ZXZlciwgdGhlc2UgZG9jdW1lbnRzIG1heSBleGlzdCBpbiB0aGUgbG9jYWwgY2FjaGUuIFJ1biBhZ2FpbiB3aXRob3V0IHNldHRpbmcgc291cmNlIHRvIFwic2VydmVyXCIgdG8gcmV0cmlldmUgdGhlIGNhY2hlZCBkb2N1bWVudHMuKScpKSA6IGkucmVzb2x2ZShuKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlcnJvcjogdCA9PiBpLnJlamVjdCh0KVxuICAgICAgICB9KSwgbyA9IG5ldyBqbyhuLCByLCB7XG4gICAgICAgICAgICBpbmNsdWRlTWV0YWRhdGFDaGFuZ2VzOiAhMCxcbiAgICAgICAgICAgIHVvOiAhMFxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIExvKHQsIG8pO1xuICAgIH0oYXdhaXQgWWEodCksIHQuYXN5bmNRdWV1ZSwgZSwgbiwgcykpKSwgcy5wcm9taXNlO1xufVxuXG5mdW5jdGlvbiBpYyh0LCBlKSB7XG4gICAgY29uc3QgbiA9IG5ldyBNYShlKTtcbiAgICByZXR1cm4gdC5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoKGFzeW5jICgpID0+IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgVSh0KS5aci5hZGQoZSksIFxuICAgICAgICAvLyBJbW1lZGlhdGVseSBmaXJlIGFuIGluaXRpYWwgZXZlbnQsIGluZGljYXRpbmcgYWxsIGV4aXN0aW5nIGxpc3RlbmVyc1xuICAgICAgICAvLyBhcmUgaW4tc3luYy5cbiAgICAgICAgZS5uZXh0KCk7XG4gICAgfShhd2FpdCBZYSh0KSwgbikpKSwgKCkgPT4ge1xuICAgICAgICBuLlhvKCksIHQuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KChhc3luYyAoKSA9PiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBVKHQpLlpyLmRlbGV0ZShlKTtcbiAgICAgICAgfShhd2FpdCBZYSh0KSwgbikpKTtcbiAgICB9O1xufVxuXG4vKipcbiAqIFRha2VzIGFuIHVwZGF0ZUZ1bmN0aW9uIGluIHdoaWNoIGEgc2V0IG9mIHJlYWRzIGFuZCB3cml0ZXMgY2FuIGJlIHBlcmZvcm1lZFxuICogYXRvbWljYWxseS4gSW4gdGhlIHVwZGF0ZUZ1bmN0aW9uLCB0aGUgY2xpZW50IGNhbiByZWFkIGFuZCB3cml0ZSB2YWx1ZXNcbiAqIHVzaW5nIHRoZSBzdXBwbGllZCB0cmFuc2FjdGlvbiBvYmplY3QuIEFmdGVyIHRoZSB1cGRhdGVGdW5jdGlvbiwgYWxsXG4gKiBjaGFuZ2VzIHdpbGwgYmUgY29tbWl0dGVkLiBJZiBhIHJldHJ5YWJsZSBlcnJvciBvY2N1cnMgKGV4OiBzb21lIG90aGVyXG4gKiBjbGllbnQgaGFzIGNoYW5nZWQgYW55IG9mIHRoZSBkYXRhIHJlZmVyZW5jZWQpLCB0aGVuIHRoZSB1cGRhdGVGdW5jdGlvblxuICogd2lsbCBiZSBjYWxsZWQgYWdhaW4gYWZ0ZXIgYSBiYWNrb2ZmLiBJZiB0aGUgdXBkYXRlRnVuY3Rpb24gc3RpbGwgZmFpbHNcbiAqIGFmdGVyIGFsbCByZXRyaWVzLCB0aGVuIHRoZSB0cmFuc2FjdGlvbiB3aWxsIGJlIHJlamVjdGVkLlxuICpcbiAqIFRoZSB0cmFuc2FjdGlvbiBvYmplY3QgcGFzc2VkIHRvIHRoZSB1cGRhdGVGdW5jdGlvbiBjb250YWlucyBtZXRob2RzIGZvclxuICogYWNjZXNzaW5nIGRvY3VtZW50cyBhbmQgY29sbGVjdGlvbnMuIFVubGlrZSBvdGhlciBkYXRhc3RvcmUgYWNjZXNzLCBkYXRhXG4gKiBhY2Nlc3NlZCB3aXRoIHRoZSB0cmFuc2FjdGlvbiB3aWxsIG5vdCByZWZsZWN0IGxvY2FsIGNoYW5nZXMgdGhhdCBoYXZlIG5vdFxuICogYmVlbiBjb21taXR0ZWQuIEZvciB0aGlzIHJlYXNvbiwgaXQgaXMgcmVxdWlyZWQgdGhhdCBhbGwgcmVhZHMgYXJlXG4gKiBwZXJmb3JtZWQgYmVmb3JlIGFueSB3cml0ZXMuIFRyYW5zYWN0aW9ucyBtdXN0IGJlIHBlcmZvcm1lZCB3aGlsZSBvbmxpbmUuXG4gKi8gZnVuY3Rpb24gcmModCwgZSkge1xuICAgIGNvbnN0IG4gPSBuZXcgajtcbiAgICByZXR1cm4gdC5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoKGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgcyA9IGF3YWl0IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIHJldHVybiBXYSh0KS50aGVuKCh0ID0+IHQuZGF0YXN0b3JlKSk7XG4gICAgICAgIH0odCk7XG4gICAgICAgIG5ldyBVYSh0LmFzeW5jUXVldWUsIHMsIGUsIG4pLnJ1bigpO1xuICAgIH0pKSwgbi5wcm9taXNlO1xufVxuXG5mdW5jdGlvbiBvYyh0LCBlLCBuLCBzKSB7XG4gICAgY29uc3QgaSA9IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgbGV0IG47XG4gICAgICAgIG4gPSBcInN0cmluZ1wiID09IHR5cGVvZiB0ID8gKG5ldyBUZXh0RW5jb2RlcikuZW5jb2RlKHQpIDogdDtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgTGEodCwgZSk7XG4gICAgICAgIH0oZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBVaW50OEFycmF5KSByZXR1cm4gRmEodCwgZSk7XG4gICAgICAgICAgICBpZiAodCBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSByZXR1cm4gRmEobmV3IFVpbnQ4QXJyYXkodCksIGUpO1xuICAgICAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBSZWFkYWJsZVN0cmVhbSkgcmV0dXJuIHQuZ2V0UmVhZGVyKCk7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJTb3VyY2Ugb2YgYHRvQnl0ZVN0cmVhbVJlYWRlcmAgaGFzIHRvIGJlIGEgQXJyYXlCdWZmZXIgb3IgUmVhZGFibGVTdHJlYW1cIik7XG4gICAgICAgIH0obiksIGUpO1xuICAgIH1cbiAgICAvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyAobiwgSnIoZSkpO1xuICAgIHQuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KChhc3luYyAoKSA9PiB7XG4gICAgICAgIE5hKGF3YWl0IEphKHQpLCBpLCBzKTtcbiAgICB9KSk7XG59XG5cbmZ1bmN0aW9uIGFjKHQsIGUpIHtcbiAgICByZXR1cm4gdC5hc3luY1F1ZXVlLmVucXVldWUoKGFzeW5jICgpID0+IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IFUodCk7XG4gICAgICAgIHJldHVybiBuLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiR2V0IG5hbWVkIHF1ZXJ5XCIsIFwicmVhZG9ubHlcIiwgKHQgPT4gbi5KZS5nZXROYW1lZFF1ZXJ5KHQsIGUpKSk7XG4gICAgfShhd2FpdCB6YSh0KSwgZSkpKTtcbn1cblxuY2xhc3MgY2Mge1xuICAgIC8qKlxuICAgICAqIENvbnN0cnVjdHMgYSBEYXRhYmFzZUluZm8gdXNpbmcgdGhlIHByb3ZpZGVkIGhvc3QsIGRhdGFiYXNlSWQgYW5kXG4gICAgICogcGVyc2lzdGVuY2VLZXkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZGF0YWJhc2VJZCAtIFRoZSBkYXRhYmFzZSB0byB1c2UuXG4gICAgICogQHBhcmFtIGFwcElkIC0gVGhlIEZpcmViYXNlIEFwcCBJZC5cbiAgICAgKiBAcGFyYW0gcGVyc2lzdGVuY2VLZXkgLSBBIHVuaXF1ZSBpZGVudGlmaWVyIGZvciB0aGlzIEZpcmVzdG9yZSdzIGxvY2FsXG4gICAgICogc3RvcmFnZSAodXNlZCBpbiBjb25qdW5jdGlvbiB3aXRoIHRoZSBkYXRhYmFzZUlkKS5cbiAgICAgKiBAcGFyYW0gaG9zdCAtIFRoZSBGaXJlc3RvcmUgYmFja2VuZCBob3N0IHRvIGNvbm5lY3QgdG8uXG4gICAgICogQHBhcmFtIHNzbCAtIFdoZXRoZXIgdG8gdXNlIFNTTCB3aGVuIGNvbm5lY3RpbmcuXG4gICAgICogQHBhcmFtIGZvcmNlTG9uZ1BvbGxpbmcgLSBXaGV0aGVyIHRvIHVzZSB0aGUgZm9yY2VMb25nUG9sbGluZyBvcHRpb25cbiAgICAgKiB3aGVuIHVzaW5nIFdlYkNoYW5uZWwgYXMgdGhlIG5ldHdvcmsgdHJhbnNwb3J0LlxuICAgICAqIEBwYXJhbSBhdXRvRGV0ZWN0TG9uZ1BvbGxpbmcgLSBXaGV0aGVyIHRvIHVzZSB0aGUgZGV0ZWN0QnVmZmVyaW5nUHJveHlcbiAgICAgKiBvcHRpb24gd2hlbiB1c2luZyBXZWJDaGFubmVsIGFzIHRoZSBuZXR3b3JrIHRyYW5zcG9ydC5cbiAgICAgKiBAcGFyYW0gdXNlRmV0Y2hTdHJlYW1zIFdoZXRoZXIgdG8gdXNlIHRoZSBGZXRjaCBBUEkgaW5zdGVhZCBvZlxuICAgICAqIFhNTEhUVFBSZXF1ZXN0XG4gICAgICovXG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcywgaSwgciwgbywgYSkge1xuICAgICAgICB0aGlzLmRhdGFiYXNlSWQgPSB0LCB0aGlzLmFwcElkID0gZSwgdGhpcy5wZXJzaXN0ZW5jZUtleSA9IG4sIHRoaXMuaG9zdCA9IHMsIHRoaXMuc3NsID0gaSwgXG4gICAgICAgIHRoaXMuZm9yY2VMb25nUG9sbGluZyA9IHIsIHRoaXMuYXV0b0RldGVjdExvbmdQb2xsaW5nID0gbywgdGhpcy51c2VGZXRjaFN0cmVhbXMgPSBhO1xuICAgIH1cbn1cblxuLyoqIFRoZSBkZWZhdWx0IGRhdGFiYXNlIG5hbWUgZm9yIGEgcHJvamVjdC4gKi9cbi8qKlxuICogUmVwcmVzZW50cyB0aGUgZGF0YWJhc2UgSUQgYSBGaXJlc3RvcmUgY2xpZW50IGlzIGFzc29jaWF0ZWQgd2l0aC5cbiAqIEBpbnRlcm5hbFxuICovXG5jbGFzcyB1YyB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLnByb2plY3RJZCA9IHQsIHRoaXMuZGF0YWJhc2UgPSBlIHx8IFwiKGRlZmF1bHQpXCI7XG4gICAgfVxuICAgIGdldCBpc0RlZmF1bHREYXRhYmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIFwiKGRlZmF1bHQpXCIgPT09IHRoaXMuZGF0YWJhc2U7XG4gICAgfVxuICAgIGlzRXF1YWwodCkge1xuICAgICAgICByZXR1cm4gdCBpbnN0YW5jZW9mIHVjICYmIHQucHJvamVjdElkID09PSB0aGlzLnByb2plY3RJZCAmJiB0LmRhdGFiYXNlID09PSB0aGlzLmRhdGFiYXNlO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY29uc3QgaGMgPSBuZXcgTWFwO1xuXG4vKipcbiAqIEFuIGluc3RhbmNlIG1hcCB0aGF0IGVuc3VyZXMgb25seSBvbmUgRGF0YXN0b3JlIGV4aXN0cyBwZXIgRmlyZXN0b3JlXG4gKiBpbnN0YW5jZS5cbiAqL1xuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmZ1bmN0aW9uIGxjKHQsIGUsIG4pIHtcbiAgICBpZiAoIW4pIHRocm93IG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgYEZ1bmN0aW9uICR7dH0oKSBjYW5ub3QgYmUgY2FsbGVkIHdpdGggYW4gZW1wdHkgJHtlfS5gKTtcbn1cblxuLyoqXG4gKiBWYWxpZGF0ZXMgdGhhdCB0d28gYm9vbGVhbiBvcHRpb25zIGFyZSBub3Qgc2V0IGF0IHRoZSBzYW1lIHRpbWUuXG4gKiBAaW50ZXJuYWxcbiAqLyBmdW5jdGlvbiBmYyh0LCBlLCBuLCBzKSB7XG4gICAgaWYgKCEwID09PSBlICYmICEwID09PSBzKSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIGAke3R9IGFuZCAke259IGNhbm5vdCBiZSB1c2VkIHRvZ2V0aGVyLmApO1xufVxuXG4vKipcbiAqIFZhbGlkYXRlcyB0aGF0IGBwYXRoYCByZWZlcnMgdG8gYSBkb2N1bWVudCAoaW5kaWNhdGVkIGJ5IHRoZSBmYWN0IGl0IGNvbnRhaW5zXG4gKiBhbiBldmVuIG51bWJlcnMgb2Ygc2VnbWVudHMpLlxuICovIGZ1bmN0aW9uIGRjKHQpIHtcbiAgICBpZiAoIVB0LmlzRG9jdW1lbnRLZXkodCkpIHRocm93IG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgYEludmFsaWQgZG9jdW1lbnQgcmVmZXJlbmNlLiBEb2N1bWVudCByZWZlcmVuY2VzIG11c3QgaGF2ZSBhbiBldmVuIG51bWJlciBvZiBzZWdtZW50cywgYnV0ICR7dH0gaGFzICR7dC5sZW5ndGh9LmApO1xufVxuXG4vKipcbiAqIFZhbGlkYXRlcyB0aGF0IGBwYXRoYCByZWZlcnMgdG8gYSBjb2xsZWN0aW9uIChpbmRpY2F0ZWQgYnkgdGhlIGZhY3QgaXRcbiAqIGNvbnRhaW5zIGFuIG9kZCBudW1iZXJzIG9mIHNlZ21lbnRzKS5cbiAqLyBmdW5jdGlvbiB3Yyh0KSB7XG4gICAgaWYgKFB0LmlzRG9jdW1lbnRLZXkodCkpIHRocm93IG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgYEludmFsaWQgY29sbGVjdGlvbiByZWZlcmVuY2UuIENvbGxlY3Rpb24gcmVmZXJlbmNlcyBtdXN0IGhhdmUgYW4gb2RkIG51bWJlciBvZiBzZWdtZW50cywgYnV0ICR7dH0gaGFzICR7dC5sZW5ndGh9LmApO1xufVxuXG4vKipcbiAqIFJldHVybnMgdHJ1ZSBpZiBpdCdzIGEgbm9uLW51bGwgb2JqZWN0IHdpdGhvdXQgYSBjdXN0b20gcHJvdG90eXBlXG4gKiAoaS5lLiBleGNsdWRlcyBBcnJheSwgRGF0ZSwgZXRjLikuXG4gKi9cbi8qKiBSZXR1cm5zIGEgc3RyaW5nIGRlc2NyaWJpbmcgdGhlIHR5cGUgLyB2YWx1ZSBvZiB0aGUgcHJvdmlkZWQgaW5wdXQuICovXG5mdW5jdGlvbiBfYyh0KSB7XG4gICAgaWYgKHZvaWQgMCA9PT0gdCkgcmV0dXJuIFwidW5kZWZpbmVkXCI7XG4gICAgaWYgKG51bGwgPT09IHQpIHJldHVybiBcIm51bGxcIjtcbiAgICBpZiAoXCJzdHJpbmdcIiA9PSB0eXBlb2YgdCkgcmV0dXJuIHQubGVuZ3RoID4gMjAgJiYgKHQgPSBgJHt0LnN1YnN0cmluZygwLCAyMCl9Li4uYCksIFxuICAgIEpTT04uc3RyaW5naWZ5KHQpO1xuICAgIGlmIChcIm51bWJlclwiID09IHR5cGVvZiB0IHx8IFwiYm9vbGVhblwiID09IHR5cGVvZiB0KSByZXR1cm4gXCJcIiArIHQ7XG4gICAgaWYgKFwib2JqZWN0XCIgPT0gdHlwZW9mIHQpIHtcbiAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBBcnJheSkgcmV0dXJuIFwiYW4gYXJyYXlcIjtcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgZSA9IFxuICAgICAgICAgICAgLyoqIEhhY2t5IG1ldGhvZCB0byB0cnkgdG8gZ2V0IHRoZSBjb25zdHJ1Y3RvciBuYW1lIGZvciBhbiBvYmplY3QuICovXG4gICAgICAgICAgICBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgaWYgKHQuY29uc3RydWN0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IC9mdW5jdGlvblxccysoW15cXHMoXSspXFxzKlxcKC8uZXhlYyh0LmNvbnN0cnVjdG9yLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZSAmJiBlLmxlbmd0aCA+IDEpIHJldHVybiBlWzFdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qKlxuICogQ2FzdHMgYG9iamAgdG8gYFRgLCBvcHRpb25hbGx5IHVud3JhcHBpbmcgQ29tcGF0IHR5cGVzIHRvIGV4cG9zZSB0aGVcbiAqIHVuZGVybHlpbmcgaW5zdGFuY2UuIFRocm93cyBpZiAgYG9iamAgaXMgbm90IGFuIGluc3RhbmNlIG9mIGBUYC5cbiAqXG4gKiBUaGlzIGNhc3QgaXMgdXNlZCBpbiB0aGUgTGl0ZSBhbmQgRnVsbCBTREsgdG8gdmVyaWZ5IGluc3RhbmNlIHR5cGVzIGZvclxuICogYXJndW1lbnRzIHBhc3NlZCB0byB0aGUgcHVibGljIEFQSS5cbiAqIEBpbnRlcm5hbFxuICovICh0KTtcbiAgICAgICAgICAgIHJldHVybiBlID8gYGEgY3VzdG9tICR7ZX0gb2JqZWN0YCA6IFwiYW4gb2JqZWN0XCI7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgdCA/IFwiYSBmdW5jdGlvblwiIDogTSgpO1xufVxuXG5mdW5jdGlvbiBtYyh0LCBcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG5lKSB7XG4gICAgaWYgKFwiX2RlbGVnYXRlXCIgaW4gdCAmJiAoXG4gICAgLy8gVW53cmFwIENvbXBhdCB0eXBlc1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgdCA9IHQuX2RlbGVnYXRlKSwgISh0IGluc3RhbmNlb2YgZSkpIHtcbiAgICAgICAgaWYgKGUubmFtZSA9PT0gdC5jb25zdHJ1Y3Rvci5uYW1lKSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIFwiVHlwZSBkb2VzIG5vdCBtYXRjaCB0aGUgZXhwZWN0ZWQgaW5zdGFuY2UuIERpZCB5b3UgcGFzcyBhIHJlZmVyZW5jZSBmcm9tIGEgZGlmZmVyZW50IEZpcmVzdG9yZSBTREs/XCIpO1xuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBuID0gX2ModCk7XG4gICAgICAgICAgICB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIGBFeHBlY3RlZCB0eXBlICcke2UubmFtZX0nLCBidXQgaXQgd2FzOiAke259YCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHQ7XG59XG5cbmZ1bmN0aW9uIGdjKHQsIGUpIHtcbiAgICBpZiAoZSA8PSAwKSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIGBGdW5jdGlvbiAke3R9KCkgcmVxdWlyZXMgYSBwb3NpdGl2ZSBudW1iZXIsIGJ1dCBpdCB3YXM6ICR7ZX0uYCk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vLyBzZXR0aW5ncygpIGRlZmF1bHRzOlxuLyoqXG4gKiBBIGNvbmNyZXRlIHR5cGUgZGVzY3JpYmluZyBhbGwgdGhlIHZhbHVlcyB0aGF0IGNhbiBiZSBhcHBsaWVkIHZpYSBhXG4gKiB1c2VyLXN1cHBsaWVkIGBGaXJlc3RvcmVTZXR0aW5nc2Agb2JqZWN0LiBUaGlzIGlzIGEgc2VwYXJhdGUgdHlwZSBzbyB0aGF0XG4gKiBkZWZhdWx0cyBjYW4gYmUgc3VwcGxpZWQgYW5kIHRoZSB2YWx1ZSBjYW4gYmUgY2hlY2tlZCBmb3IgZXF1YWxpdHkuXG4gKi9cbmNsYXNzIHljIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHZhciBlO1xuICAgICAgICBpZiAodm9pZCAwID09PSB0Lmhvc3QpIHtcbiAgICAgICAgICAgIGlmICh2b2lkIDAgIT09IHQuc3NsKSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIFwiQ2FuJ3QgcHJvdmlkZSBzc2wgb3B0aW9uIGlmIGhvc3Qgb3B0aW9uIGlzIG5vdCBzZXRcIik7XG4gICAgICAgICAgICB0aGlzLmhvc3QgPSBcImZpcmVzdG9yZS5nb29nbGVhcGlzLmNvbVwiLCB0aGlzLnNzbCA9IHRydWU7XG4gICAgICAgIH0gZWxzZSB0aGlzLmhvc3QgPSB0Lmhvc3QsIHRoaXMuc3NsID0gbnVsbCA9PT0gKGUgPSB0LnNzbCkgfHwgdm9pZCAwID09PSBlIHx8IGU7XG4gICAgICAgIGlmICh0aGlzLmNyZWRlbnRpYWxzID0gdC5jcmVkZW50aWFscywgdGhpcy5pZ25vcmVVbmRlZmluZWRQcm9wZXJ0aWVzID0gISF0Lmlnbm9yZVVuZGVmaW5lZFByb3BlcnRpZXMsIFxuICAgICAgICB2b2lkIDAgPT09IHQuY2FjaGVTaXplQnl0ZXMpIHRoaXMuY2FjaGVTaXplQnl0ZXMgPSA0MTk0MzA0MDsgZWxzZSB7XG4gICAgICAgICAgICBpZiAoLTEgIT09IHQuY2FjaGVTaXplQnl0ZXMgJiYgdC5jYWNoZVNpemVCeXRlcyA8IDEwNDg1NzYpIHRocm93IG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgXCJjYWNoZVNpemVCeXRlcyBtdXN0IGJlIGF0IGxlYXN0IDEwNDg1NzZcIik7XG4gICAgICAgICAgICB0aGlzLmNhY2hlU2l6ZUJ5dGVzID0gdC5jYWNoZVNpemVCeXRlcztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmV4cGVyaW1lbnRhbEZvcmNlTG9uZ1BvbGxpbmcgPSAhIXQuZXhwZXJpbWVudGFsRm9yY2VMb25nUG9sbGluZywgdGhpcy5leHBlcmltZW50YWxBdXRvRGV0ZWN0TG9uZ1BvbGxpbmcgPSAhIXQuZXhwZXJpbWVudGFsQXV0b0RldGVjdExvbmdQb2xsaW5nLCBcbiAgICAgICAgdGhpcy51c2VGZXRjaFN0cmVhbXMgPSAhIXQudXNlRmV0Y2hTdHJlYW1zLCBmYyhcImV4cGVyaW1lbnRhbEZvcmNlTG9uZ1BvbGxpbmdcIiwgdC5leHBlcmltZW50YWxGb3JjZUxvbmdQb2xsaW5nLCBcImV4cGVyaW1lbnRhbEF1dG9EZXRlY3RMb25nUG9sbGluZ1wiLCB0LmV4cGVyaW1lbnRhbEF1dG9EZXRlY3RMb25nUG9sbGluZyk7XG4gICAgfVxuICAgIGlzRXF1YWwodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5ob3N0ID09PSB0Lmhvc3QgJiYgdGhpcy5zc2wgPT09IHQuc3NsICYmIHRoaXMuY3JlZGVudGlhbHMgPT09IHQuY3JlZGVudGlhbHMgJiYgdGhpcy5jYWNoZVNpemVCeXRlcyA9PT0gdC5jYWNoZVNpemVCeXRlcyAmJiB0aGlzLmV4cGVyaW1lbnRhbEZvcmNlTG9uZ1BvbGxpbmcgPT09IHQuZXhwZXJpbWVudGFsRm9yY2VMb25nUG9sbGluZyAmJiB0aGlzLmV4cGVyaW1lbnRhbEF1dG9EZXRlY3RMb25nUG9sbGluZyA9PT0gdC5leHBlcmltZW50YWxBdXRvRGV0ZWN0TG9uZ1BvbGxpbmcgJiYgdGhpcy5pZ25vcmVVbmRlZmluZWRQcm9wZXJ0aWVzID09PSB0Lmlnbm9yZVVuZGVmaW5lZFByb3BlcnRpZXMgJiYgdGhpcy51c2VGZXRjaFN0cmVhbXMgPT09IHQudXNlRmV0Y2hTdHJlYW1zO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogVGhlIENsb3VkIEZpcmVzdG9yZSBzZXJ2aWNlIGludGVyZmFjZS5cbiAqXG4gKiBEbyBub3QgY2FsbCB0aGlzIGNvbnN0cnVjdG9yIGRpcmVjdGx5LiBJbnN0ZWFkLCB1c2Uge0BsaW5rIGdldEZpcmVzdG9yZX0uXG4gKi8gY2xhc3MgcGMge1xuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yICovXG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLl9jcmVkZW50aWFscyA9IGUsIFxuICAgICAgICAvKipcbiAgICAgICAgICogV2hldGhlciBpdCdzIGEgRmlyZXN0b3JlIG9yIEZpcmVzdG9yZSBMaXRlIGluc3RhbmNlLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy50eXBlID0gXCJmaXJlc3RvcmUtbGl0ZVwiLCB0aGlzLl9wZXJzaXN0ZW5jZUtleSA9IFwiKGxpdGUpXCIsIHRoaXMuX3NldHRpbmdzID0gbmV3IHljKHt9KSwgXG4gICAgICAgIHRoaXMuX3NldHRpbmdzRnJvemVuID0gITEsIHQgaW5zdGFuY2VvZiB1YyA/IHRoaXMuX2RhdGFiYXNlSWQgPSB0IDogKHRoaXMuX2FwcCA9IHQsIFxuICAgICAgICB0aGlzLl9kYXRhYmFzZUlkID0gZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgaWYgKCFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmFwcGx5KHQub3B0aW9ucywgWyBcInByb2plY3RJZFwiIF0pKSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsICdcInByb2plY3RJZFwiIG5vdCBwcm92aWRlZCBpbiBmaXJlYmFzZS5pbml0aWFsaXplQXBwLicpO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyB1Yyh0Lm9wdGlvbnMucHJvamVjdElkKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAqIE1vZGlmeSB0aGlzIGluc3RhbmNlIHRvIGNvbW11bmljYXRlIHdpdGggdGhlIENsb3VkIEZpcmVzdG9yZSBlbXVsYXRvci5cbiAqXG4gKiBOb3RlOiBUaGlzIG11c3QgYmUgY2FsbGVkIGJlZm9yZSB0aGlzIGluc3RhbmNlIGhhcyBiZWVuIHVzZWQgdG8gZG8gYW55XG4gKiBvcGVyYXRpb25zLlxuICpcbiAqIEBwYXJhbSBmaXJlc3RvcmUgLSBUaGUgYEZpcmVzdG9yZWAgaW5zdGFuY2UgdG8gY29uZmlndXJlIHRvIGNvbm5lY3QgdG8gdGhlXG4gKiBlbXVsYXRvci5cbiAqIEBwYXJhbSBob3N0IC0gdGhlIGVtdWxhdG9yIGhvc3QgKGV4OiBsb2NhbGhvc3QpLlxuICogQHBhcmFtIHBvcnQgLSB0aGUgZW11bGF0b3IgcG9ydCAoZXg6IDkwMDApLlxuICogQHBhcmFtIG9wdGlvbnMubW9ja1VzZXJUb2tlbiAtIHRoZSBtb2NrIGF1dGggdG9rZW4gdG8gdXNlIGZvciB1bml0IHRlc3RpbmdcbiAqIFNlY3VyaXR5IFJ1bGVzLlxuICovICh0KSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSB7QGxpbmsgQGZpcmViYXNlL2FwcCNGaXJlYmFzZUFwcH0gYXNzb2NpYXRlZCB3aXRoIHRoaXMgYEZpcmVzdG9yZWAgc2VydmljZVxuICAgICAqIGluc3RhbmNlLlxuICAgICAqLyAgICBnZXQgYXBwKCkge1xuICAgICAgICBpZiAoIXRoaXMuX2FwcCkgdGhyb3cgbmV3IEsocS5GQUlMRURfUFJFQ09ORElUSU9OLCBcIkZpcmVzdG9yZSB3YXMgbm90IGluaXRpYWxpemVkIHVzaW5nIHRoZSBGaXJlYmFzZSBTREsuICdhcHAnIGlzIG5vdCBhdmFpbGFibGVcIik7XG4gICAgICAgIHJldHVybiB0aGlzLl9hcHA7XG4gICAgfVxuICAgIGdldCBfaW5pdGlhbGl6ZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zZXR0aW5nc0Zyb3plbjtcbiAgICB9XG4gICAgZ2V0IF90ZXJtaW5hdGVkKCkge1xuICAgICAgICByZXR1cm4gdm9pZCAwICE9PSB0aGlzLl90ZXJtaW5hdGVUYXNrO1xuICAgIH1cbiAgICBfc2V0U2V0dGluZ3ModCkge1xuICAgICAgICBpZiAodGhpcy5fc2V0dGluZ3NGcm96ZW4pIHRocm93IG5ldyBLKHEuRkFJTEVEX1BSRUNPTkRJVElPTiwgXCJGaXJlc3RvcmUgaGFzIGFscmVhZHkgYmVlbiBzdGFydGVkIGFuZCBpdHMgc2V0dGluZ3MgY2FuIG5vIGxvbmdlciBiZSBjaGFuZ2VkLiBZb3UgY2FuIG9ubHkgbW9kaWZ5IHNldHRpbmdzIGJlZm9yZSBjYWxsaW5nIGFueSBvdGhlciBtZXRob2RzIG9uIGEgRmlyZXN0b3JlIG9iamVjdC5cIik7XG4gICAgICAgIHRoaXMuX3NldHRpbmdzID0gbmV3IHljKHQpLCB2b2lkIDAgIT09IHQuY3JlZGVudGlhbHMgJiYgKHRoaXMuX2NyZWRlbnRpYWxzID0gZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgaWYgKCF0KSByZXR1cm4gbmV3IFc7XG4gICAgICAgICAgICBzd2l0Y2ggKHQudHlwZSkge1xuICAgICAgICAgICAgICBjYXNlIFwiZ2FwaVwiOlxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LmNsaWVudDtcbiAgICAgICAgICAgICAgICAvLyBNYWtlIHN1cmUgdGhpcyByZWFsbHkgaXMgYSBHYXBpIGNsaWVudC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEwoIShcIm9iamVjdFwiICE9IHR5cGVvZiBlIHx8IG51bGwgPT09IGUgfHwgIWUuYXV0aCB8fCAhZS5hdXRoLmdldEF1dGhIZWFkZXJWYWx1ZUZvckZpcnN0UGFydHkpKSwgXG4gICAgICAgICAgICAgICAgbmV3IEooZSwgdC5zZXNzaW9uSW5kZXggfHwgXCIwXCIsIHQuaWFtVG9rZW4gfHwgbnVsbCk7XG5cbiAgICAgICAgICAgICAgY2FzZSBcInByb3ZpZGVyXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHQuY2xpZW50O1xuXG4gICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEsocS5JTlZBTElEX0FSR1VNRU5ULCBcIm1ha2VDcmVkZW50aWFsc1Byb3ZpZGVyIGZhaWxlZCBkdWUgdG8gaW52YWxpZCBjcmVkZW50aWFsIHR5cGVcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0odC5jcmVkZW50aWFscykpO1xuICAgIH1cbiAgICBfZ2V0U2V0dGluZ3MoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zZXR0aW5ncztcbiAgICB9XG4gICAgX2ZyZWV6ZVNldHRpbmdzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc2V0dGluZ3NGcm96ZW4gPSAhMCwgdGhpcy5fc2V0dGluZ3M7XG4gICAgfVxuICAgIF9kZWxldGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl90ZXJtaW5hdGVUYXNrIHx8ICh0aGlzLl90ZXJtaW5hdGVUYXNrID0gdGhpcy5fdGVybWluYXRlKCkpLCB0aGlzLl90ZXJtaW5hdGVUYXNrO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyBhIEpTT04tc2VyaWFsaXphYmxlIHJlcHJlc2VudGF0aW9uIG9mIHRoaXMgYEZpcmVzdG9yZWAgaW5zdGFuY2UuICovICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGFwcDogdGhpcy5fYXBwLFxuICAgICAgICAgICAgZGF0YWJhc2VJZDogdGhpcy5fZGF0YWJhc2VJZCxcbiAgICAgICAgICAgIHNldHRpbmdzOiB0aGlzLl9zZXR0aW5nc1xuICAgICAgICB9O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUZXJtaW5hdGVzIGFsbCBjb21wb25lbnRzIHVzZWQgYnkgdGhpcyBjbGllbnQuIFN1YmNsYXNzZXMgY2FuIG92ZXJyaWRlXG4gICAgICogdGhpcyBtZXRob2QgdG8gY2xlYW4gdXAgdGhlaXIgb3duIGRlcGVuZGVuY2llcywgYnV0IG11c3QgYWxzbyBjYWxsIHRoaXNcbiAgICAgKiBtZXRob2QuXG4gICAgICpcbiAgICAgKiBPbmx5IGV2ZXIgY2FsbGVkIG9uY2UuXG4gICAgICovICAgIF90ZXJtaW5hdGUoKSB7XG4gICAgICAgIC8qKlxuICogUmVtb3ZlcyBhbGwgY29tcG9uZW50cyBhc3NvY2lhdGVkIHdpdGggdGhlIHByb3ZpZGVkIGluc3RhbmNlLiBNdXN0IGJlIGNhbGxlZFxuICogd2hlbiB0aGUgYEZpcmVzdG9yZWAgaW5zdGFuY2UgaXMgdGVybWluYXRlZC5cbiAqL1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgY29uc3QgZSA9IGhjLmdldCh0KTtcbiAgICAgICAgICAgIGUgJiYgKGsoXCJDb21wb25lbnRQcm92aWRlclwiLCBcIlJlbW92aW5nIERhdGFzdG9yZVwiKSwgaGMuZGVsZXRlKHQpLCBlLnRlcm1pbmF0ZSgpKTtcbiAgICAgICAgfSh0aGlzKSwgUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBFYyh0LCBlLCBuLCBzID0ge30pIHtcbiAgICB2YXIgaTtcbiAgICBjb25zdCByID0gKHQgPSBtYyh0LCBwYykpLl9nZXRTZXR0aW5ncygpO1xuICAgIGlmIChcImZpcmVzdG9yZS5nb29nbGVhcGlzLmNvbVwiICE9PSByLmhvc3QgJiYgci5ob3N0ICE9PSBlICYmIE8oXCJIb3N0IGhhcyBiZWVuIHNldCBpbiBib3RoIHNldHRpbmdzKCkgYW5kIHVzZUVtdWxhdG9yKCksIGVtdWxhdG9yIGhvc3Qgd2lsbCBiZSB1c2VkXCIpLCBcbiAgICB0Ll9zZXRTZXR0aW5ncyhPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIHIpLCB7XG4gICAgICAgIGhvc3Q6IGAke2V9OiR7bn1gLFxuICAgICAgICBzc2w6ICExXG4gICAgfSkpLCBzLm1vY2tVc2VyVG9rZW4pIHtcbiAgICAgICAgbGV0IGUsIG47XG4gICAgICAgIGlmIChcInN0cmluZ1wiID09IHR5cGVvZiBzLm1vY2tVc2VyVG9rZW4pIGUgPSBzLm1vY2tVc2VyVG9rZW4sIG4gPSBTLk1PQ0tfVVNFUjsgZWxzZSB7XG4gICAgICAgICAgICAvLyBMZXQgY3JlYXRlTW9ja1VzZXJUb2tlbiB2YWxpZGF0ZSBmaXJzdCAoY2F0Y2hlcyBjb21tb24gbWlzdGFrZXMgbGlrZVxuICAgICAgICAgICAgLy8gaW52YWxpZCBmaWVsZCBcInVpZFwiIGFuZCBtaXNzaW5nIGZpZWxkIFwic3ViXCIgLyBcInVzZXJfaWRcIi4pXG4gICAgICAgICAgICBlID0gZyhzLm1vY2tVc2VyVG9rZW4sIG51bGwgPT09IChpID0gdC5fYXBwKSB8fCB2b2lkIDAgPT09IGkgPyB2b2lkIDAgOiBpLm9wdGlvbnMucHJvamVjdElkKTtcbiAgICAgICAgICAgIGNvbnN0IHIgPSBzLm1vY2tVc2VyVG9rZW4uc3ViIHx8IHMubW9ja1VzZXJUb2tlbi51c2VyX2lkO1xuICAgICAgICAgICAgaWYgKCFyKSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIFwibW9ja1VzZXJUb2tlbiBtdXN0IGNvbnRhaW4gJ3N1Yicgb3IgJ3VzZXJfaWQnIGZpZWxkIVwiKTtcbiAgICAgICAgICAgIG4gPSBuZXcgUyhyKTtcbiAgICAgICAgfVxuICAgICAgICB0Ll9jcmVkZW50aWFscyA9IG5ldyBHKG5ldyBRKGUsIG4pKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEEgYERvY3VtZW50UmVmZXJlbmNlYCByZWZlcnMgdG8gYSBkb2N1bWVudCBsb2NhdGlvbiBpbiBhIEZpcmVzdG9yZSBkYXRhYmFzZVxuICogYW5kIGNhbiBiZSB1c2VkIHRvIHdyaXRlLCByZWFkLCBvciBsaXN0ZW4gdG8gdGhlIGxvY2F0aW9uLiBUaGUgZG9jdW1lbnQgYXRcbiAqIHRoZSByZWZlcmVuY2VkIGxvY2F0aW9uIG1heSBvciBtYXkgbm90IGV4aXN0LlxuICovIGNsYXNzIFRjIHtcbiAgICAvKiogQGhpZGVjb25zdHJ1Y3RvciAqL1xuICAgIGNvbnN0cnVjdG9yKHQsIFxuICAgIC8qKlxuICAgICAqIElmIHByb3ZpZGVkLCB0aGUgYEZpcmVzdG9yZURhdGFDb252ZXJ0ZXJgIGFzc29jaWF0ZWQgd2l0aCB0aGlzIGluc3RhbmNlLlxuICAgICAqL1xuICAgIGUsIG4pIHtcbiAgICAgICAgdGhpcy5jb252ZXJ0ZXIgPSBlLCB0aGlzLl9rZXkgPSBuLCBcbiAgICAgICAgLyoqIFRoZSB0eXBlIG9mIHRoaXMgRmlyZXN0b3JlIHJlZmVyZW5jZS4gKi9cbiAgICAgICAgdGhpcy50eXBlID0gXCJkb2N1bWVudFwiLCB0aGlzLmZpcmVzdG9yZSA9IHQ7XG4gICAgfVxuICAgIGdldCBfcGF0aCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2tleS5wYXRoO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgZG9jdW1lbnQncyBpZGVudGlmaWVyIHdpdGhpbiBpdHMgY29sbGVjdGlvbi5cbiAgICAgKi8gICAgZ2V0IGlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fa2V5LnBhdGgubGFzdFNlZ21lbnQoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQSBzdHJpbmcgcmVwcmVzZW50aW5nIHRoZSBwYXRoIG9mIHRoZSByZWZlcmVuY2VkIGRvY3VtZW50IChyZWxhdGl2ZVxuICAgICAqIHRvIHRoZSByb290IG9mIHRoZSBkYXRhYmFzZSkuXG4gICAgICovICAgIGdldCBwYXRoKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fa2V5LnBhdGguY2Fub25pY2FsU3RyaW5nKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSBjb2xsZWN0aW9uIHRoaXMgYERvY3VtZW50UmVmZXJlbmNlYCBiZWxvbmdzIHRvLlxuICAgICAqLyAgICBnZXQgcGFyZW50KCkge1xuICAgICAgICByZXR1cm4gbmV3IEFjKHRoaXMuZmlyZXN0b3JlLCB0aGlzLmNvbnZlcnRlciwgdGhpcy5fa2V5LnBhdGgucG9wTGFzdCgpKTtcbiAgICB9XG4gICAgd2l0aENvbnZlcnRlcih0KSB7XG4gICAgICAgIHJldHVybiBuZXcgVGModGhpcy5maXJlc3RvcmUsIHQsIHRoaXMuX2tleSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEEgYFF1ZXJ5YCByZWZlcnMgdG8gYSBxdWVyeSB3aGljaCB5b3UgY2FuIHJlYWQgb3IgbGlzdGVuIHRvLiBZb3UgY2FuIGFsc29cbiAqIGNvbnN0cnVjdCByZWZpbmVkIGBRdWVyeWAgb2JqZWN0cyBieSBhZGRpbmcgZmlsdGVycyBhbmQgb3JkZXJpbmcuXG4gKi8gY2xhc3MgSWMge1xuICAgIC8vIFRoaXMgaXMgdGhlIGxpdGUgdmVyc2lvbiBvZiB0aGUgUXVlcnkgY2xhc3MgaW4gdGhlIG1haW4gU0RLLlxuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yIHByb3RlY3RlZCAqL1xuICAgIGNvbnN0cnVjdG9yKHQsIFxuICAgIC8qKlxuICAgICAqIElmIHByb3ZpZGVkLCB0aGUgYEZpcmVzdG9yZURhdGFDb252ZXJ0ZXJgIGFzc29jaWF0ZWQgd2l0aCB0aGlzIGluc3RhbmNlLlxuICAgICAqL1xuICAgIGUsIG4pIHtcbiAgICAgICAgdGhpcy5jb252ZXJ0ZXIgPSBlLCB0aGlzLl9xdWVyeSA9IG4sIFxuICAgICAgICAvKiogVGhlIHR5cGUgb2YgdGhpcyBGaXJlc3RvcmUgcmVmZXJlbmNlLiAqL1xuICAgICAgICB0aGlzLnR5cGUgPSBcInF1ZXJ5XCIsIHRoaXMuZmlyZXN0b3JlID0gdDtcbiAgICB9XG4gICAgd2l0aENvbnZlcnRlcih0KSB7XG4gICAgICAgIHJldHVybiBuZXcgSWModGhpcy5maXJlc3RvcmUsIHQsIHRoaXMuX3F1ZXJ5KTtcbiAgICB9XG59XG5cbi8qKlxuICogQSBgQ29sbGVjdGlvblJlZmVyZW5jZWAgb2JqZWN0IGNhbiBiZSB1c2VkIGZvciBhZGRpbmcgZG9jdW1lbnRzLCBnZXR0aW5nXG4gKiBkb2N1bWVudCByZWZlcmVuY2VzLCBhbmQgcXVlcnlpbmcgZm9yIGRvY3VtZW50cyAodXNpbmcge0BsaW5rIHF1ZXJ5fSkuXG4gKi8gY2xhc3MgQWMgZXh0ZW5kcyBJYyB7XG4gICAgLyoqIEBoaWRlY29uc3RydWN0b3IgKi9cbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHN1cGVyKHQsIGUsIGRlKG4pKSwgdGhpcy5fcGF0aCA9IG4sIFxuICAgICAgICAvKiogVGhlIHR5cGUgb2YgdGhpcyBGaXJlc3RvcmUgcmVmZXJlbmNlLiAqL1xuICAgICAgICB0aGlzLnR5cGUgPSBcImNvbGxlY3Rpb25cIjtcbiAgICB9XG4gICAgLyoqIFRoZSBjb2xsZWN0aW9uJ3MgaWRlbnRpZmllci4gKi8gICAgZ2V0IGlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcXVlcnkucGF0aC5sYXN0U2VnbWVudCgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBIHN0cmluZyByZXByZXNlbnRpbmcgdGhlIHBhdGggb2YgdGhlIHJlZmVyZW5jZWQgY29sbGVjdGlvbiAocmVsYXRpdmVcbiAgICAgKiB0byB0aGUgcm9vdCBvZiB0aGUgZGF0YWJhc2UpLlxuICAgICAqLyAgICBnZXQgcGF0aCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3F1ZXJ5LnBhdGguY2Fub25pY2FsU3RyaW5nKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEEgcmVmZXJlbmNlIHRvIHRoZSBjb250YWluaW5nIGBEb2N1bWVudFJlZmVyZW5jZWAgaWYgdGhpcyBpcyBhXG4gICAgICogc3ViY29sbGVjdGlvbi4gSWYgdGhpcyBpc24ndCBhIHN1YmNvbGxlY3Rpb24sIHRoZSByZWZlcmVuY2UgaXMgbnVsbC5cbiAgICAgKi8gICAgZ2V0IHBhcmVudCgpIHtcbiAgICAgICAgY29uc3QgdCA9IHRoaXMuX3BhdGgucG9wTGFzdCgpO1xuICAgICAgICByZXR1cm4gdC5pc0VtcHR5KCkgPyBudWxsIDogbmV3IFRjKHRoaXMuZmlyZXN0b3JlLCBcbiAgICAgICAgLyogY29udmVydGVyPSAqLyBudWxsLCBuZXcgUHQodCkpO1xuICAgIH1cbiAgICB3aXRoQ29udmVydGVyKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBBYyh0aGlzLmZpcmVzdG9yZSwgdCwgdGhpcy5fcGF0aCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBSYyh0LCBlLCAuLi5uKSB7XG4gICAgaWYgKHQgPSB5KHQpLCBsYyhcImNvbGxlY3Rpb25cIiwgXCJwYXRoXCIsIGUpLCB0IGluc3RhbmNlb2YgcGMpIHtcbiAgICAgICAgY29uc3QgcyA9IHV0LmZyb21TdHJpbmcoZSwgLi4ubik7XG4gICAgICAgIHJldHVybiB3YyhzKSwgbmV3IEFjKHQsIC8qIGNvbnZlcnRlcj0gKi8gbnVsbCwgcyk7XG4gICAgfVxuICAgIHtcbiAgICAgICAgaWYgKCEodCBpbnN0YW5jZW9mIFRjIHx8IHQgaW5zdGFuY2VvZiBBYykpIHRocm93IG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgXCJFeHBlY3RlZCBmaXJzdCBhcmd1bWVudCB0byBjb2xsZWN0aW9uKCkgdG8gYmUgYSBDb2xsZWN0aW9uUmVmZXJlbmNlLCBhIERvY3VtZW50UmVmZXJlbmNlIG9yIEZpcmViYXNlRmlyZXN0b3JlXCIpO1xuICAgICAgICBjb25zdCBzID0gdXQuZnJvbVN0cmluZyh0LnBhdGgsIC4uLm4pLmNoaWxkKHV0LmZyb21TdHJpbmcoZSkpO1xuICAgICAgICByZXR1cm4gd2MocyksIG5ldyBBYyh0LmZpcmVzdG9yZSwgXG4gICAgICAgIC8qIGNvbnZlcnRlcj0gKi8gbnVsbCwgcyk7XG4gICAgfVxufVxuXG4vLyBUT0RPKGZpcmVzdG9yZWxpdGUpOiBDb25zaWRlciB1c2luZyBFcnJvckZhY3RvcnkgLVxuLy8gaHR0cHM6Ly9naXRodWIuY29tL2ZpcmViYXNlL2ZpcmViYXNlLWpzLXNkay9ibG9iLzAxMzFlMWYvcGFja2FnZXMvdXRpbC9zcmMvZXJyb3JzLnRzI0wxMDZcbi8qKlxuICogQ3JlYXRlcyBhbmQgcmV0dXJucyBhIG5ldyBgUXVlcnlgIGluc3RhbmNlIHRoYXQgaW5jbHVkZXMgYWxsIGRvY3VtZW50cyBpbiB0aGVcbiAqIGRhdGFiYXNlIHRoYXQgYXJlIGNvbnRhaW5lZCBpbiBhIGNvbGxlY3Rpb24gb3Igc3ViY29sbGVjdGlvbiB3aXRoIHRoZVxuICogZ2l2ZW4gYGNvbGxlY3Rpb25JZGAuXG4gKlxuICogQHBhcmFtIGZpcmVzdG9yZSAtIEEgcmVmZXJlbmNlIHRvIHRoZSByb290IGBGaXJlc3RvcmVgIGluc3RhbmNlLlxuICogQHBhcmFtIGNvbGxlY3Rpb25JZCAtIElkZW50aWZpZXMgdGhlIGNvbGxlY3Rpb25zIHRvIHF1ZXJ5IG92ZXIuIEV2ZXJ5XG4gKiBjb2xsZWN0aW9uIG9yIHN1YmNvbGxlY3Rpb24gd2l0aCB0aGlzIElEIGFzIHRoZSBsYXN0IHNlZ21lbnQgb2YgaXRzIHBhdGhcbiAqIHdpbGwgYmUgaW5jbHVkZWQuIENhbm5vdCBjb250YWluIGEgc2xhc2guXG4gKiBAcmV0dXJucyBUaGUgY3JlYXRlZCBgUXVlcnlgLlxuICovIGZ1bmN0aW9uIFBjKHQsIGUpIHtcbiAgICBpZiAodCA9IG1jKHQsIHBjKSwgbGMoXCJjb2xsZWN0aW9uR3JvdXBcIiwgXCJjb2xsZWN0aW9uIGlkXCIsIGUpLCBlLmluZGV4T2YoXCIvXCIpID49IDApIHRocm93IG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgYEludmFsaWQgY29sbGVjdGlvbiBJRCAnJHtlfScgcGFzc2VkIHRvIGZ1bmN0aW9uIGNvbGxlY3Rpb25Hcm91cCgpLiBDb2xsZWN0aW9uIElEcyBtdXN0IG5vdCBjb250YWluICcvJy5gKTtcbiAgICByZXR1cm4gbmV3IEljKHQsIFxuICAgIC8qIGNvbnZlcnRlcj0gKi8gbnVsbCwgXG4gICAgLyoqXG4gKiBDcmVhdGVzIGEgbmV3IFF1ZXJ5IGZvciBhIGNvbGxlY3Rpb24gZ3JvdXAgcXVlcnkgdGhhdCBtYXRjaGVzIGFsbCBkb2N1bWVudHNcbiAqIHdpdGhpbiB0aGUgcHJvdmlkZWQgY29sbGVjdGlvbiBncm91cC5cbiAqL1xuICAgIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBsZSh1dC5lbXB0eVBhdGgoKSwgdCk7XG4gICAgfShlKSk7XG59XG5cbmZ1bmN0aW9uIGJjKHQsIGUsIC4uLm4pIHtcbiAgICBpZiAodCA9IHkodCksIFxuICAgIC8vIFdlIGFsbG93IG9taXNzaW9uIG9mICdwYXRoU3RyaW5nJyBidXQgZXhwbGljaXRseSBwcm9oaWJpdCBwYXNzaW5nIGluIGJvdGhcbiAgICAvLyAndW5kZWZpbmVkJyBhbmQgJ251bGwnLlxuICAgIDEgPT09IGFyZ3VtZW50cy5sZW5ndGggJiYgKGUgPSBaLkkoKSksIGxjKFwiZG9jXCIsIFwicGF0aFwiLCBlKSwgdCBpbnN0YW5jZW9mIHBjKSB7XG4gICAgICAgIGNvbnN0IHMgPSB1dC5mcm9tU3RyaW5nKGUsIC4uLm4pO1xuICAgICAgICByZXR1cm4gZGMocyksIG5ldyBUYyh0LCBcbiAgICAgICAgLyogY29udmVydGVyPSAqLyBudWxsLCBuZXcgUHQocykpO1xuICAgIH1cbiAgICB7XG4gICAgICAgIGlmICghKHQgaW5zdGFuY2VvZiBUYyB8fCB0IGluc3RhbmNlb2YgQWMpKSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIFwiRXhwZWN0ZWQgZmlyc3QgYXJndW1lbnQgdG8gY29sbGVjdGlvbigpIHRvIGJlIGEgQ29sbGVjdGlvblJlZmVyZW5jZSwgYSBEb2N1bWVudFJlZmVyZW5jZSBvciBGaXJlYmFzZUZpcmVzdG9yZVwiKTtcbiAgICAgICAgY29uc3QgcyA9IHQuX3BhdGguY2hpbGQodXQuZnJvbVN0cmluZyhlLCAuLi5uKSk7XG4gICAgICAgIHJldHVybiBkYyhzKSwgbmV3IFRjKHQuZmlyZXN0b3JlLCB0IGluc3RhbmNlb2YgQWMgPyB0LmNvbnZlcnRlciA6IG51bGwsIG5ldyBQdChzKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgcHJvdmlkZWQgcmVmZXJlbmNlcyBhcmUgZXF1YWwuXG4gKlxuICogQHBhcmFtIGxlZnQgLSBBIHJlZmVyZW5jZSB0byBjb21wYXJlLlxuICogQHBhcmFtIHJpZ2h0IC0gQSByZWZlcmVuY2UgdG8gY29tcGFyZS5cbiAqIEByZXR1cm5zIHRydWUgaWYgdGhlIHJlZmVyZW5jZXMgcG9pbnQgdG8gdGhlIHNhbWUgbG9jYXRpb24gaW4gdGhlIHNhbWVcbiAqIEZpcmVzdG9yZSBkYXRhYmFzZS5cbiAqLyBmdW5jdGlvbiB2Yyh0LCBlKSB7XG4gICAgcmV0dXJuIHQgPSB5KHQpLCBlID0geShlKSwgKHQgaW5zdGFuY2VvZiBUYyB8fCB0IGluc3RhbmNlb2YgQWMpICYmIChlIGluc3RhbmNlb2YgVGMgfHwgZSBpbnN0YW5jZW9mIEFjKSAmJiAodC5maXJlc3RvcmUgPT09IGUuZmlyZXN0b3JlICYmIHQucGF0aCA9PT0gZS5wYXRoICYmIHQuY29udmVydGVyID09PSBlLmNvbnZlcnRlcik7XG59XG5cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIHRoZSBwcm92aWRlZCBxdWVyaWVzIHBvaW50IHRvIHRoZSBzYW1lIGNvbGxlY3Rpb24gYW5kIGFwcGx5XG4gKiB0aGUgc2FtZSBjb25zdHJhaW50cy5cbiAqXG4gKiBAcGFyYW0gbGVmdCAtIEEgYFF1ZXJ5YCB0byBjb21wYXJlLlxuICogQHBhcmFtIHJpZ2h0IC0gQSBgUXVlcnlgIHRvIGNvbXBhcmUuXG4gKiBAcmV0dXJucyB0cnVlIGlmIHRoZSByZWZlcmVuY2VzIHBvaW50IHRvIHRoZSBzYW1lIGxvY2F0aW9uIGluIHRoZSBzYW1lXG4gKiBGaXJlc3RvcmUgZGF0YWJhc2UuXG4gKi8gZnVuY3Rpb24gVmModCwgZSkge1xuICAgIHJldHVybiB0ID0geSh0KSwgZSA9IHkoZSksIHQgaW5zdGFuY2VvZiBJYyAmJiBlIGluc3RhbmNlb2YgSWMgJiYgKHQuZmlyZXN0b3JlID09PSBlLmZpcmVzdG9yZSAmJiBJZSh0Ll9xdWVyeSwgZS5fcXVlcnkpICYmIHQuY29udmVydGVyID09PSBlLmNvbnZlcnRlcik7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNsYXNzIFNjIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgLy8gVGhlIGxhc3QgcHJvbWlzZSBpbiB0aGUgcXVldWUuXG4gICAgICAgIHRoaXMuZmEgPSBQcm9taXNlLnJlc29sdmUoKSwgXG4gICAgICAgIC8vIEEgbGlzdCBvZiByZXRyeWFibGUgb3BlcmF0aW9ucy4gUmV0cnlhYmxlIG9wZXJhdGlvbnMgYXJlIHJ1biBpbiBvcmRlciBhbmRcbiAgICAgICAgLy8gcmV0cmllZCB3aXRoIGJhY2tvZmYuXG4gICAgICAgIHRoaXMuZGEgPSBbXSwgXG4gICAgICAgIC8vIElzIHRoaXMgQXN5bmNRdWV1ZSBiZWluZyBzaHV0IGRvd24/IE9uY2UgaXQgaXMgc2V0IHRvIHRydWUsIGl0IHdpbGwgbm90XG4gICAgICAgIC8vIGJlIGNoYW5nZWQgYWdhaW4uXG4gICAgICAgIHRoaXMud2EgPSAhMSwgXG4gICAgICAgIC8vIE9wZXJhdGlvbnMgc2NoZWR1bGVkIHRvIGJlIHF1ZXVlZCBpbiB0aGUgZnV0dXJlLiBPcGVyYXRpb25zIGFyZVxuICAgICAgICAvLyBhdXRvbWF0aWNhbGx5IHJlbW92ZWQgYWZ0ZXIgdGhleSBhcmUgcnVuIG9yIGNhbmNlbGVkLlxuICAgICAgICB0aGlzLl9hID0gW10sIFxuICAgICAgICAvLyB2aXNpYmxlIGZvciB0ZXN0aW5nXG4gICAgICAgIHRoaXMubWEgPSBudWxsLCBcbiAgICAgICAgLy8gRmxhZyBzZXQgd2hpbGUgdGhlcmUncyBhbiBvdXRzdGFuZGluZyBBc3luY1F1ZXVlIG9wZXJhdGlvbiwgdXNlZCBmb3JcbiAgICAgICAgLy8gYXNzZXJ0aW9uIHNhbml0eS1jaGVja3MuXG4gICAgICAgIHRoaXMuZ2EgPSAhMSwgXG4gICAgICAgIC8vIEVuYWJsZWQgZHVyaW5nIHNodXRkb3duIG9uIFNhZmFyaSB0byBwcmV2ZW50IGZ1dHVyZSBhY2Nlc3MgdG8gSW5kZXhlZERCLlxuICAgICAgICB0aGlzLnlhID0gITEsIFxuICAgICAgICAvLyBMaXN0IG9mIFRpbWVySWRzIHRvIGZhc3QtZm9yd2FyZCBkZWxheXMgZm9yLlxuICAgICAgICB0aGlzLnBhID0gW10sIFxuICAgICAgICAvLyBCYWNrb2ZmIHRpbWVyIHVzZWQgdG8gc2NoZWR1bGUgcmV0cmllcyBmb3IgcmV0cnlhYmxlIG9wZXJhdGlvbnNcbiAgICAgICAgdGhpcy5yciA9IG5ldyBZcih0aGlzLCBcImFzeW5jX3F1ZXVlX3JldHJ5XCIgLyogQXN5bmNRdWV1ZVJldHJ5ICovKSwgXG4gICAgICAgIC8vIFZpc2liaWxpdHkgaGFuZGxlciB0aGF0IHRyaWdnZXJzIGFuIGltbWVkaWF0ZSByZXRyeSBvZiBhbGwgcmV0cnlhYmxlXG4gICAgICAgIC8vIG9wZXJhdGlvbnMuIE1lYW50IHRvIHNwZWVkIHVwIHJlY292ZXJ5IHdoZW4gd2UgcmVnYWluIGZpbGUgc3lzdGVtIGFjY2Vzc1xuICAgICAgICAvLyBhZnRlciBwYWdlIGNvbWVzIGludG8gZm9yZWdyb3VuZC5cbiAgICAgICAgdGhpcy5FYSA9ICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBIcigpO1xuICAgICAgICAgICAgdCAmJiBrKFwiQXN5bmNRdWV1ZVwiLCBcIlZpc2liaWxpdHkgc3RhdGUgY2hhbmdlZCB0byBcIiArIHQudmlzaWJpbGl0eVN0YXRlKSwgdGhpcy5yci50cigpO1xuICAgICAgICB9O1xuICAgICAgICBjb25zdCB0ID0gSHIoKTtcbiAgICAgICAgdCAmJiBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIHQuYWRkRXZlbnRMaXN0ZW5lciAmJiB0LmFkZEV2ZW50TGlzdGVuZXIoXCJ2aXNpYmlsaXR5Y2hhbmdlXCIsIHRoaXMuRWEpO1xuICAgIH1cbiAgICBnZXQgaXNTaHV0dGluZ0Rvd24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLndhO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGRzIGEgbmV3IG9wZXJhdGlvbiB0byB0aGUgcXVldWUgd2l0aG91dCB3YWl0aW5nIGZvciBpdCB0byBjb21wbGV0ZSAoaS5lLlxuICAgICAqIHdlIGlnbm9yZSB0aGUgUHJvbWlzZSByZXN1bHQpLlxuICAgICAqLyAgICBlbnF1ZXVlQW5kRm9yZ2V0KHQpIHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1mbG9hdGluZy1wcm9taXNlc1xuICAgICAgICB0aGlzLmVucXVldWUodCk7XG4gICAgfVxuICAgIGVucXVldWVBbmRGb3JnZXRFdmVuV2hpbGVSZXN0cmljdGVkKHQpIHtcbiAgICAgICAgdGhpcy5UYSgpLCBcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1mbG9hdGluZy1wcm9taXNlc1xuICAgICAgICB0aGlzLklhKHQpO1xuICAgIH1cbiAgICBlbnRlclJlc3RyaWN0ZWRNb2RlKHQpIHtcbiAgICAgICAgaWYgKCF0aGlzLndhKSB7XG4gICAgICAgICAgICB0aGlzLndhID0gITAsIHRoaXMueWEgPSB0IHx8ICExO1xuICAgICAgICAgICAgY29uc3QgZSA9IEhyKCk7XG4gICAgICAgICAgICBlICYmIFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgZS5yZW1vdmVFdmVudExpc3RlbmVyICYmIGUucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInZpc2liaWxpdHljaGFuZ2VcIiwgdGhpcy5FYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZW5xdWV1ZSh0KSB7XG4gICAgICAgIGlmICh0aGlzLlRhKCksIHRoaXMud2EpIFxuICAgICAgICAvLyBSZXR1cm4gYSBQcm9taXNlIHdoaWNoIG5ldmVyIHJlc29sdmVzLlxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKCgpID0+IHt9KSk7XG4gICAgICAgIC8vIENyZWF0ZSBhIGRlZmVycmVkIFByb21pc2UgdGhhdCB3ZSBjYW4gcmV0dXJuIHRvIHRoZSBjYWxsZWUuIFRoaXNcbiAgICAgICAgLy8gYWxsb3dzIHVzIHRvIHJldHVybiBhIFwiaGFuZ2luZyBQcm9taXNlXCIgb25seSB0byB0aGUgY2FsbGVlIGFuZCBzdGlsbFxuICAgICAgICAvLyBhZHZhbmNlIHRoZSBxdWV1ZSBldmVuIHdoZW4gdGhlIG9wZXJhdGlvbiBpcyBub3QgcnVuLlxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBuZXcgajtcbiAgICAgICAgcmV0dXJuIHRoaXMuSWEoKCgpID0+IHRoaXMud2EgJiYgdGhpcy55YSA/IFByb21pc2UucmVzb2x2ZSgpIDogKHQoKS50aGVuKGUucmVzb2x2ZSwgZS5yZWplY3QpLCBcbiAgICAgICAgZS5wcm9taXNlKSkpLnRoZW4oKCgpID0+IGUucHJvbWlzZSkpO1xuICAgIH1cbiAgICBlbnF1ZXVlUmV0cnlhYmxlKHQpIHtcbiAgICAgICAgdGhpcy5lbnF1ZXVlQW5kRm9yZ2V0KCgoKSA9PiAodGhpcy5kYS5wdXNoKHQpLCB0aGlzLkFhKCkpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJ1bnMgdGhlIG5leHQgb3BlcmF0aW9uIGZyb20gdGhlIHJldHJ5YWJsZSBxdWV1ZS4gSWYgdGhlIG9wZXJhdGlvbiBmYWlscyxcbiAgICAgKiByZXNjaGVkdWxlcyB3aXRoIGJhY2tvZmYuXG4gICAgICovICAgIGFzeW5jIEFhKCkge1xuICAgICAgICBpZiAoMCAhPT0gdGhpcy5kYS5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kYVswXSgpLCB0aGlzLmRhLnNoaWZ0KCksIHRoaXMucnIucmVzZXQoKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXpzKHQpKSB0aHJvdyB0O1xuIC8vIEZhaWx1cmUgd2lsbCBiZSBoYW5kbGVkIGJ5IEFzeW5jUXVldWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgayhcIkFzeW5jUXVldWVcIiwgXCJPcGVyYXRpb24gZmFpbGVkIHdpdGggcmV0cnlhYmxlIGVycm9yOiBcIiArIHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5kYS5sZW5ndGggPiAwICYmIFxuICAgICAgICAgICAgLy8gSWYgdGhlcmUgYXJlIGFkZGl0aW9uYWwgb3BlcmF0aW9ucywgd2UgcmUtc2NoZWR1bGUgYHJldHJ5TmV4dE9wKClgLlxuICAgICAgICAgICAgLy8gVGhpcyBpcyBuZWNlc3NhcnkgdG8gcnVuIHJldHJ5YWJsZSBvcGVyYXRpb25zIHRoYXQgZmFpbGVkIGR1cmluZ1xuICAgICAgICAgICAgLy8gdGhlaXIgaW5pdGlhbCBhdHRlbXB0IHNpbmNlIHdlIGRvbid0IGtub3cgd2hldGhlciB0aGV5IGFyZSBhbHJlYWR5XG4gICAgICAgICAgICAvLyBlbnF1ZXVlZC4gSWYsIGZvciBleGFtcGxlLCBgb3AxYCwgYG9wMmAsIGBvcDNgIGFyZSBlbnF1ZXVlZCBhbmQgYG9wMWBcbiAgICAgICAgICAgIC8vIG5lZWRzIHRvICBiZSByZS1ydW4sIHdlIHdpbGwgcnVuIGBvcDFgLCBgb3AxYCwgYG9wMmAgdXNpbmcgdGhlXG4gICAgICAgICAgICAvLyBhbHJlYWR5IGVucXVldWVkIGNhbGxzIHRvIGByZXRyeU5leHRPcCgpYC4gYG9wMygpYCB3aWxsIHRoZW4gcnVuIGluIHRoZVxuICAgICAgICAgICAgLy8gY2FsbCBzY2hlZHVsZWQgaGVyZS5cbiAgICAgICAgICAgIC8vIFNpbmNlIGBiYWNrb2ZmQW5kUnVuKClgIGNhbmNlbHMgYW4gZXhpc3RpbmcgYmFja29mZiBhbmQgc2NoZWR1bGVzIGFcbiAgICAgICAgICAgIC8vIG5ldyBiYWNrb2ZmIG9uIGV2ZXJ5IGNhbGwsIHRoZXJlIGlzIG9ubHkgZXZlciBhIHNpbmdsZSBhZGRpdGlvbmFsXG4gICAgICAgICAgICAvLyBvcGVyYXRpb24gaW4gdGhlIHF1ZXVlLlxuICAgICAgICAgICAgdGhpcy5yci5YaSgoKCkgPT4gdGhpcy5BYSgpKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgSWEodCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5mYS50aGVuKCgoKSA9PiAodGhpcy5nYSA9ICEwLCB0KCkuY2F0Y2goKHQgPT4ge1xuICAgICAgICAgICAgdGhpcy5tYSA9IHQsIHRoaXMuZ2EgPSAhMTtcbiAgICAgICAgICAgIC8vIFJlLXRocm93IHRoZSBlcnJvciBzbyB0aGF0IHRoaXMudGFpbCBiZWNvbWVzIGEgcmVqZWN0ZWQgUHJvbWlzZSBhbmRcbiAgICAgICAgICAgIC8vIGFsbCBmdXJ0aGVyIGF0dGVtcHRzIHRvIGNoYWluICh2aWEgLnRoZW4pIHdpbGwganVzdCBzaG9ydC1jaXJjdWl0XG4gICAgICAgICAgICAvLyBhbmQgcmV0dXJuIHRoZSByZWplY3RlZCBQcm9taXNlLlxuICAgICAgICAgICAgdGhyb3cgJChcIklOVEVSTkFMIFVOSEFORExFRCBFUlJPUjogXCIsIFxuICAgICAgICAgICAgLyoqXG4gKiBDaHJvbWUgaW5jbHVkZXMgRXJyb3IubWVzc2FnZSBpbiBFcnJvci5zdGFjay4gT3RoZXIgYnJvd3NlcnMgZG8gbm90LlxuICogVGhpcyByZXR1cm5zIGV4cGVjdGVkIG91dHB1dCBvZiBtZXNzYWdlICsgc3RhY2sgd2hlbiBhdmFpbGFibGUuXG4gKiBAcGFyYW0gZXJyb3IgLSBFcnJvciBvciBGaXJlc3RvcmVFcnJvclxuICovXG4gICAgICAgICAgICBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgbGV0IGUgPSB0Lm1lc3NhZ2UgfHwgXCJcIjtcbiAgICAgICAgICAgICAgICB0LnN0YWNrICYmIChlID0gdC5zdGFjay5pbmNsdWRlcyh0Lm1lc3NhZ2UpID8gdC5zdGFjayA6IHQubWVzc2FnZSArIFwiXFxuXCIgKyB0LnN0YWNrKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovICh0KSksIHQ7XG4gICAgICAgIH0pKS50aGVuKCh0ID0+ICh0aGlzLmdhID0gITEsIHQpKSkpKSk7XG4gICAgICAgIHJldHVybiB0aGlzLmZhID0gZSwgZTtcbiAgICB9XG4gICAgZW5xdWV1ZUFmdGVyRGVsYXkodCwgZSwgbikge1xuICAgICAgICB0aGlzLlRhKCksIFxuICAgICAgICAvLyBGYXN0LWZvcndhcmQgZGVsYXlzIGZvciB0aW1lcklkcyB0aGF0IGhhdmUgYmVlbiBvdmVycmlkZW4uXG4gICAgICAgIHRoaXMucGEuaW5kZXhPZih0KSA+IC0xICYmIChlID0gMCk7XG4gICAgICAgIGNvbnN0IHMgPSBOby5jcmVhdGVBbmRTY2hlZHVsZSh0aGlzLCB0LCBlLCBuLCAodCA9PiB0aGlzLlJhKHQpKSk7XG4gICAgICAgIHJldHVybiB0aGlzLl9hLnB1c2gocyksIHM7XG4gICAgfVxuICAgIFRhKCkge1xuICAgICAgICB0aGlzLm1hICYmIE0oKTtcbiAgICB9XG4gICAgdmVyaWZ5T3BlcmF0aW9uSW5Qcm9ncmVzcygpIHt9XG4gICAgLyoqXG4gICAgICogV2FpdHMgdW50aWwgYWxsIGN1cnJlbnRseSBxdWV1ZWQgdGFza3MgYXJlIGZpbmlzaGVkIGV4ZWN1dGluZy4gRGVsYXllZFxuICAgICAqIG9wZXJhdGlvbnMgYXJlIG5vdCBydW4uXG4gICAgICovICAgIGFzeW5jIFBhKCkge1xuICAgICAgICAvLyBPcGVyYXRpb25zIGluIHRoZSBxdWV1ZSBwcmlvciB0byBkcmFpbmluZyBtYXkgaGF2ZSBlbnF1ZXVlZCBhZGRpdGlvbmFsXG4gICAgICAgIC8vIG9wZXJhdGlvbnMuIEtlZXAgZHJhaW5pbmcgdGhlIHF1ZXVlIHVudGlsIHRoZSB0YWlsIGlzIG5vIGxvbmdlciBhZHZhbmNlZCxcbiAgICAgICAgLy8gd2hpY2ggaW5kaWNhdGVzIHRoYXQgbm8gbW9yZSBuZXcgb3BlcmF0aW9ucyB3ZXJlIGVucXVldWVkIGFuZCB0aGF0IGFsbFxuICAgICAgICAvLyBvcGVyYXRpb25zIHdlcmUgZXhlY3V0ZWQuXG4gICAgICAgIGxldCB0O1xuICAgICAgICBkbyB7XG4gICAgICAgICAgICB0ID0gdGhpcy5mYSwgYXdhaXQgdDtcbiAgICAgICAgfSB3aGlsZSAodCAhPT0gdGhpcy5mYSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZvciBUZXN0czogRGV0ZXJtaW5lIGlmIGEgZGVsYXllZCBvcGVyYXRpb24gd2l0aCBhIHBhcnRpY3VsYXIgVGltZXJJZFxuICAgICAqIGV4aXN0cy5cbiAgICAgKi8gICAgYmEodCkge1xuICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdGhpcy5fYSkgaWYgKGUudGltZXJJZCA9PT0gdCkgcmV0dXJuICEwO1xuICAgICAgICByZXR1cm4gITE7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZvciBUZXN0czogUnVucyBzb21lIG9yIGFsbCBkZWxheWVkIG9wZXJhdGlvbnMgZWFybHkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbGFzdFRpbWVySWQgLSBEZWxheWVkIG9wZXJhdGlvbnMgdXAgdG8gYW5kIGluY2x1ZGluZyB0aGlzIFRpbWVySWRcbiAgICAgKiB3aWxsIGJlIGRyYWluZWQuIFBhc3MgVGltZXJJZC5BbGwgdG8gcnVuIGFsbCBkZWxheWVkIG9wZXJhdGlvbnMuXG4gICAgICogQHJldHVybnMgYSBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgb25jZSBhbGwgb3BlcmF0aW9ucyBoYXZlIGJlZW4gcnVuLlxuICAgICAqLyAgICB2YSh0KSB7XG4gICAgICAgIC8vIE5vdGUgdGhhdCBkcmFpbmluZyBtYXkgZ2VuZXJhdGUgbW9yZSBkZWxheWVkIG9wcywgc28gd2UgZG8gdGhhdCBmaXJzdC5cbiAgICAgICAgcmV0dXJuIHRoaXMuUGEoKS50aGVuKCgoKSA9PiB7XG4gICAgICAgICAgICAvLyBSdW4gb3BzIGluIHRoZSBzYW1lIG9yZGVyIHRoZXknZCBydW4gaWYgdGhleSByYW4gbmF0dXJhbGx5LlxuICAgICAgICAgICAgdGhpcy5fYS5zb3J0KCgodCwgZSkgPT4gdC50YXJnZXRUaW1lTXMgLSBlLnRhcmdldFRpbWVNcykpO1xuICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHRoaXMuX2EpIGlmIChlLnNraXBEZWxheSgpLCBcImFsbFwiIC8qIEFsbCAqLyAhPT0gdCAmJiBlLnRpbWVySWQgPT09IHQpIGJyZWFrO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuUGEoKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBGb3IgVGVzdHM6IFNraXAgYWxsIHN1YnNlcXVlbnQgZGVsYXlzIGZvciBhIHRpbWVyIGlkLlxuICAgICAqLyAgICBWYSh0KSB7XG4gICAgICAgIHRoaXMucGEucHVzaCh0KTtcbiAgICB9XG4gICAgLyoqIENhbGxlZCBvbmNlIGEgRGVsYXllZE9wZXJhdGlvbiBpcyBydW4gb3IgY2FuY2VsZWQuICovICAgIFJhKHQpIHtcbiAgICAgICAgLy8gTk9URTogaW5kZXhPZiAvIHNsaWNlIGFyZSBPKG4pLCBidXQgZGVsYXllZE9wZXJhdGlvbnMgaXMgZXhwZWN0ZWQgdG8gYmUgc21hbGwuXG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLl9hLmluZGV4T2YodCk7XG4gICAgICAgIHRoaXMuX2Euc3BsaWNlKGUsIDEpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gRGModCkge1xuICAgIC8qKlxuICogUmV0dXJucyB0cnVlIGlmIG9iaiBpcyBhbiBvYmplY3QgYW5kIGNvbnRhaW5zIGF0IGxlYXN0IG9uZSBvZiB0aGUgc3BlY2lmaWVkXG4gKiBtZXRob2RzLlxuICovXG4gICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgaWYgKFwib2JqZWN0XCIgIT0gdHlwZW9mIHQgfHwgbnVsbCA9PT0gdCkgcmV0dXJuICExO1xuICAgICAgICBjb25zdCBuID0gdDtcbiAgICAgICAgZm9yIChjb25zdCB0IG9mIGUpIGlmICh0IGluIG4gJiYgXCJmdW5jdGlvblwiID09IHR5cGVvZiBuW3RdKSByZXR1cm4gITA7XG4gICAgICAgIHJldHVybiAhMTtcbiAgICB9XG4gICAgLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbiAgICAvKipcbiAqIFJlcHJlc2VudHMgdGhlIHRhc2sgb2YgbG9hZGluZyBhIEZpcmVzdG9yZSBidW5kbGUuIEl0IHByb3ZpZGVzIHByb2dyZXNzIG9mIGJ1bmRsZVxuICogbG9hZGluZywgYXMgd2VsbCBhcyB0YXNrIGNvbXBsZXRpb24gYW5kIGVycm9yIGV2ZW50cy5cbiAqXG4gKiBUaGUgQVBJIGlzIGNvbXBhdGlibGUgd2l0aCBgUHJvbWlzZTxMb2FkQnVuZGxlVGFza1Byb2dyZXNzPmAuXG4gKi8gKHQsIFsgXCJuZXh0XCIsIFwiZXJyb3JcIiwgXCJjb21wbGV0ZVwiIF0pO1xufVxuXG5jbGFzcyBDYyB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuX3Byb2dyZXNzT2JzZXJ2ZXIgPSB7fSwgdGhpcy5fdGFza0NvbXBsZXRpb25SZXNvbHZlciA9IG5ldyBqLCB0aGlzLl9sYXN0UHJvZ3Jlc3MgPSB7XG4gICAgICAgICAgICB0YXNrU3RhdGU6IFwiUnVubmluZ1wiLFxuICAgICAgICAgICAgdG90YWxCeXRlczogMCxcbiAgICAgICAgICAgIHRvdGFsRG9jdW1lbnRzOiAwLFxuICAgICAgICAgICAgYnl0ZXNMb2FkZWQ6IDAsXG4gICAgICAgICAgICBkb2N1bWVudHNMb2FkZWQ6IDBcbiAgICAgICAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVnaXN0ZXJzIGZ1bmN0aW9ucyB0byBsaXN0ZW4gdG8gYnVuZGxlIGxvYWRpbmcgcHJvZ3Jlc3MgZXZlbnRzLlxuICAgICAqIEBwYXJhbSBuZXh0IC0gQ2FsbGVkIHdoZW4gdGhlcmUgaXMgYSBwcm9ncmVzcyB1cGRhdGUgZnJvbSBidW5kbGUgbG9hZGluZy4gVHlwaWNhbGx5IGBuZXh0YCBjYWxscyBvY2N1clxuICAgICAqICAgZWFjaCB0aW1lIGEgRmlyZXN0b3JlIGRvY3VtZW50IGlzIGxvYWRlZCBmcm9tIHRoZSBidW5kbGUuXG4gICAgICogQHBhcmFtIGVycm9yIC0gQ2FsbGVkIHdoZW4gYW4gZXJyb3Igb2NjdXJzIGR1cmluZyBidW5kbGUgbG9hZGluZy4gVGhlIHRhc2sgYWJvcnRzIGFmdGVyIHJlcG9ydGluZyB0aGVcbiAgICAgKiAgIGVycm9yLCBhbmQgdGhlcmUgc2hvdWxkIGJlIG5vIG1vcmUgdXBkYXRlcyBhZnRlciB0aGlzLlxuICAgICAqIEBwYXJhbSBjb21wbGV0ZSAtIENhbGxlZCB3aGVuIHRoZSBsb2FkaW5nIHRhc2sgaXMgY29tcGxldGUuXG4gICAgICovICAgIG9uUHJvZ3Jlc3ModCwgZSwgbikge1xuICAgICAgICB0aGlzLl9wcm9ncmVzc09ic2VydmVyID0ge1xuICAgICAgICAgICAgbmV4dDogdCxcbiAgICAgICAgICAgIGVycm9yOiBlLFxuICAgICAgICAgICAgY29tcGxldGU6IG5cbiAgICAgICAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSW1wbGVtZW50cyB0aGUgYFByb21pc2U8TG9hZEJ1bmRsZVRhc2tQcm9ncmVzcz4uY2F0Y2hgIGludGVyZmFjZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBvblJlamVjdGVkIC0gQ2FsbGVkIHdoZW4gYW4gZXJyb3Igb2NjdXJzIGR1cmluZyBidW5kbGUgbG9hZGluZy5cbiAgICAgKi8gICAgY2F0Y2godCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdGFza0NvbXBsZXRpb25SZXNvbHZlci5wcm9taXNlLmNhdGNoKHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJbXBsZW1lbnRzIHRoZSBgUHJvbWlzZTxMb2FkQnVuZGxlVGFza1Byb2dyZXNzPi50aGVuYCBpbnRlcmZhY2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gb25GdWxmaWxsZWQgLSBDYWxsZWQgb24gdGhlIGNvbXBsZXRpb24gb2YgdGhlIGxvYWRpbmcgdGFzayB3aXRoIGEgZmluYWwgYExvYWRCdW5kbGVUYXNrUHJvZ3Jlc3NgIHVwZGF0ZS5cbiAgICAgKiAgIFRoZSB1cGRhdGUgd2lsbCBhbHdheXMgaGF2ZSBpdHMgYHRhc2tTdGF0ZWAgc2V0IHRvIGBcIlN1Y2Nlc3NcImAuXG4gICAgICogQHBhcmFtIG9uUmVqZWN0ZWQgLSBDYWxsZWQgd2hlbiBhbiBlcnJvciBvY2N1cnMgZHVyaW5nIGJ1bmRsZSBsb2FkaW5nLlxuICAgICAqLyAgICB0aGVuKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Rhc2tDb21wbGV0aW9uUmVzb2x2ZXIucHJvbWlzZS50aGVuKHQsIGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBOb3RpZmllcyBhbGwgb2JzZXJ2ZXJzIHRoYXQgYnVuZGxlIGxvYWRpbmcgaGFzIGNvbXBsZXRlZCwgd2l0aCBhIHByb3ZpZGVkXG4gICAgICogYExvYWRCdW5kbGVUYXNrUHJvZ3Jlc3NgIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovICAgIF9jb21wbGV0ZVdpdGgodCkge1xuICAgICAgICB0aGlzLl91cGRhdGVQcm9ncmVzcyh0KSwgdGhpcy5fcHJvZ3Jlc3NPYnNlcnZlci5jb21wbGV0ZSAmJiB0aGlzLl9wcm9ncmVzc09ic2VydmVyLmNvbXBsZXRlKCksIFxuICAgICAgICB0aGlzLl90YXNrQ29tcGxldGlvblJlc29sdmVyLnJlc29sdmUodCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE5vdGlmaWVzIGFsbCBvYnNlcnZlcnMgdGhhdCBidW5kbGUgbG9hZGluZyBoYXMgZmFpbGVkLCB3aXRoIGEgcHJvdmlkZWRcbiAgICAgKiBgRXJyb3JgIGFzIHRoZSByZWFzb24uXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqLyAgICBfZmFpbFdpdGgodCkge1xuICAgICAgICB0aGlzLl9sYXN0UHJvZ3Jlc3MudGFza1N0YXRlID0gXCJFcnJvclwiLCB0aGlzLl9wcm9ncmVzc09ic2VydmVyLm5leHQgJiYgdGhpcy5fcHJvZ3Jlc3NPYnNlcnZlci5uZXh0KHRoaXMuX2xhc3RQcm9ncmVzcyksIFxuICAgICAgICB0aGlzLl9wcm9ncmVzc09ic2VydmVyLmVycm9yICYmIHRoaXMuX3Byb2dyZXNzT2JzZXJ2ZXIuZXJyb3IodCksIHRoaXMuX3Rhc2tDb21wbGV0aW9uUmVzb2x2ZXIucmVqZWN0KHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBOb3RpZmllcyBhIHByb2dyZXNzIHVwZGF0ZSBvZiBsb2FkaW5nIGEgYnVuZGxlLlxuICAgICAqIEBwYXJhbSBwcm9ncmVzcyAtIFRoZSBuZXcgcHJvZ3Jlc3MuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqLyAgICBfdXBkYXRlUHJvZ3Jlc3ModCkge1xuICAgICAgICB0aGlzLl9sYXN0UHJvZ3Jlc3MgPSB0LCB0aGlzLl9wcm9ncmVzc09ic2VydmVyLm5leHQgJiYgdGhpcy5fcHJvZ3Jlc3NPYnNlcnZlci5uZXh0KHQpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKiBET01FeGNlcHRpb24gZXJyb3IgY29kZSBjb25zdGFudHMuICovIGNvbnN0IE5jID0gLTE7XG5cbi8qKlxuICogVGhlIENsb3VkIEZpcmVzdG9yZSBzZXJ2aWNlIGludGVyZmFjZS5cbiAqXG4gKiBEbyBub3QgY2FsbCB0aGlzIGNvbnN0cnVjdG9yIGRpcmVjdGx5LiBJbnN0ZWFkLCB1c2Uge0BsaW5rIGdldEZpcmVzdG9yZX0uXG4gKi9cbmNsYXNzIHhjIGV4dGVuZHMgcGMge1xuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yICovXG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICBzdXBlcih0LCBlKSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBXaGV0aGVyIGl0J3MgYSB7QGxpbmsgRmlyZXN0b3JlfSBvciBGaXJlc3RvcmUgTGl0ZSBpbnN0YW5jZS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudHlwZSA9IFwiZmlyZXN0b3JlXCIsIHRoaXMuX3F1ZXVlID0gbmV3IFNjLCB0aGlzLl9wZXJzaXN0ZW5jZUtleSA9IFwibmFtZVwiIGluIHQgPyB0Lm5hbWUgOiBcIltERUZBVUxUXVwiO1xuICAgIH1cbiAgICBfdGVybWluYXRlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZmlyZXN0b3JlQ2xpZW50IHx8IFxuICAgICAgICAvLyBUaGUgY2xpZW50IG11c3QgYmUgaW5pdGlhbGl6ZWQgdG8gZW5zdXJlIHRoYXQgYWxsIHN1YnNlcXVlbnQgQVBJXG4gICAgICAgIC8vIHVzYWdlIHRocm93cyBhbiBleGNlcHRpb24uXG4gICAgICAgIEZjKHRoaXMpLCB0aGlzLl9maXJlc3RvcmVDbGllbnQudGVybWluYXRlKCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEluaXRpYWxpemVzIGEgbmV3IGluc3RhbmNlIG9mIHtAbGluayBGaXJlc3RvcmV9IHdpdGggdGhlIHByb3ZpZGVkIHNldHRpbmdzLlxuICogQ2FuIG9ubHkgYmUgY2FsbGVkIGJlZm9yZSBhbnkgb3RoZXIgZnVuY3Rpb24sIGluY2x1ZGluZ1xuICoge0BsaW5rIGdldEZpcmVzdG9yZX0uIElmIHRoZSBjdXN0b20gc2V0dGluZ3MgYXJlIGVtcHR5LCB0aGlzIGZ1bmN0aW9uIGlzXG4gKiBlcXVpdmFsZW50IHRvIGNhbGxpbmcge0BsaW5rIGdldEZpcmVzdG9yZX0uXG4gKlxuICogQHBhcmFtIGFwcCAtIFRoZSB7QGxpbmsgQGZpcmViYXNlL2FwcCNGaXJlYmFzZUFwcH0gd2l0aCB3aGljaCB0aGUge0BsaW5rIEZpcmVzdG9yZX0gaW5zdGFuY2Ugd2lsbFxuICogYmUgYXNzb2NpYXRlZC5cbiAqIEBwYXJhbSBzZXR0aW5ncyAtIEEgc2V0dGluZ3Mgb2JqZWN0IHRvIGNvbmZpZ3VyZSB0aGUge0BsaW5rIEZpcmVzdG9yZX0gaW5zdGFuY2UuXG4gKiBAcmV0dXJucyBBIG5ld2x5IGluaXRpYWxpemVkIHtAbGluayBGaXJlc3RvcmV9IGluc3RhbmNlLlxuICovIGZ1bmN0aW9uIGtjKGUsIG4pIHtcbiAgICBjb25zdCBzID0gdChlLCBcImZpcmVzdG9yZVwiKTtcbiAgICBpZiAocy5pc0luaXRpYWxpemVkKCkpIHtcbiAgICAgICAgY29uc3QgdCA9IHMuZ2V0SW1tZWRpYXRlKCksIGUgPSBzLmdldE9wdGlvbnMoKTtcbiAgICAgICAgaWYgKHAoZSwgbikpIHJldHVybiB0O1xuICAgICAgICB0aHJvdyBuZXcgSyhxLkZBSUxFRF9QUkVDT05ESVRJT04sIFwiaW5pdGlhbGl6ZUZpcmVzdG9yZSgpIGhhcyBhbHJlYWR5IGJlZW4gY2FsbGVkIHdpdGggZGlmZmVyZW50IG9wdGlvbnMuIFRvIGF2b2lkIHRoaXMgZXJyb3IsIGNhbGwgaW5pdGlhbGl6ZUZpcmVzdG9yZSgpIHdpdGggdGhlIHNhbWUgb3B0aW9ucyBhcyB3aGVuIGl0IHdhcyBvcmlnaW5hbGx5IGNhbGxlZCwgb3IgY2FsbCBnZXRGaXJlc3RvcmUoKSB0byByZXR1cm4gdGhlIGFscmVhZHkgaW5pdGlhbGl6ZWQgaW5zdGFuY2UuXCIpO1xuICAgIH1cbiAgICBpZiAodm9pZCAwICE9PSBuLmNhY2hlU2l6ZUJ5dGVzICYmIC0xICE9PSBuLmNhY2hlU2l6ZUJ5dGVzICYmIG4uY2FjaGVTaXplQnl0ZXMgPCAxMDQ4NTc2KSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIFwiY2FjaGVTaXplQnl0ZXMgbXVzdCBiZSBhdCBsZWFzdCAxMDQ4NTc2XCIpO1xuICAgIHJldHVybiBzLmluaXRpYWxpemUoe1xuICAgICAgICBvcHRpb25zOiBuXG4gICAgfSk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgZXhpc3Rpbmcge0BsaW5rIEZpcmVzdG9yZX0gaW5zdGFuY2UgdGhhdCBpcyBhc3NvY2lhdGVkIHdpdGggdGhlXG4gKiBwcm92aWRlZCB7QGxpbmsgQGZpcmViYXNlL2FwcCNGaXJlYmFzZUFwcH0uIElmIG5vIGluc3RhbmNlIGV4aXN0cywgaW5pdGlhbGl6ZXMgYSBuZXdcbiAqIGluc3RhbmNlIHdpdGggZGVmYXVsdCBzZXR0aW5ncy5cbiAqXG4gKiBAcGFyYW0gYXBwIC0gVGhlIHtAbGluayBAZmlyZWJhc2UvYXBwI0ZpcmViYXNlQXBwfSBpbnN0YW5jZSB0aGF0IHRoZSByZXR1cm5lZCB7QGxpbmsgRmlyZXN0b3JlfVxuICogaW5zdGFuY2UgaXMgYXNzb2NpYXRlZCB3aXRoLlxuICogQHJldHVybnMgVGhlIHtAbGluayBGaXJlc3RvcmV9IGluc3RhbmNlIG9mIHRoZSBwcm92aWRlZCBhcHAuXG4gKi8gZnVuY3Rpb24gJGMobiA9IGUoKSkge1xuICAgIHJldHVybiB0KG4sIFwiZmlyZXN0b3JlXCIpLmdldEltbWVkaWF0ZSgpO1xufVxuXG4vKipcbiAqIEBpbnRlcm5hbFxuICovIGZ1bmN0aW9uIE9jKHQpIHtcbiAgICByZXR1cm4gdC5fZmlyZXN0b3JlQ2xpZW50IHx8IEZjKHQpLCB0Ll9maXJlc3RvcmVDbGllbnQudmVyaWZ5Tm90VGVybWluYXRlZCgpLCB0Ll9maXJlc3RvcmVDbGllbnQ7XG59XG5cbmZ1bmN0aW9uIEZjKHQpIHtcbiAgICB2YXIgZTtcbiAgICBjb25zdCBuID0gdC5fZnJlZXplU2V0dGluZ3MoKSwgcyA9IGZ1bmN0aW9uKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBjYyh0LCBlLCBuLCBzLmhvc3QsIHMuc3NsLCBzLmV4cGVyaW1lbnRhbEZvcmNlTG9uZ1BvbGxpbmcsIHMuZXhwZXJpbWVudGFsQXV0b0RldGVjdExvbmdQb2xsaW5nLCBzLnVzZUZldGNoU3RyZWFtcyk7XG4gICAgfSh0Ll9kYXRhYmFzZUlkLCAobnVsbCA9PT0gKGUgPSB0Ll9hcHApIHx8IHZvaWQgMCA9PT0gZSA/IHZvaWQgMCA6IGUub3B0aW9ucy5hcHBJZCkgfHwgXCJcIiwgdC5fcGVyc2lzdGVuY2VLZXksIG4pO1xuICAgIHQuX2ZpcmVzdG9yZUNsaWVudCA9IG5ldyBxYSh0Ll9jcmVkZW50aWFscywgdC5fcXVldWUsIHMpO1xufVxuXG4vKipcbiAqIEF0dGVtcHRzIHRvIGVuYWJsZSBwZXJzaXN0ZW50IHN0b3JhZ2UsIGlmIHBvc3NpYmxlLlxuICpcbiAqIE11c3QgYmUgY2FsbGVkIGJlZm9yZSBhbnkgb3RoZXIgZnVuY3Rpb25zIChvdGhlciB0aGFuXG4gKiB7QGxpbmsgaW5pdGlhbGl6ZUZpcmVzdG9yZX0sIHtAbGluayBnZXRGaXJlc3RvcmV9IG9yXG4gKiB7QGxpbmsgY2xlYXJJbmRleGVkRGJQZXJzaXN0ZW5jZX0uXG4gKlxuICogSWYgdGhpcyBmYWlscywgYGVuYWJsZUluZGV4ZWREYlBlcnNpc3RlbmNlKClgIHdpbGwgcmVqZWN0IHRoZSBwcm9taXNlIGl0XG4gKiByZXR1cm5zLiBOb3RlIHRoYXQgZXZlbiBhZnRlciB0aGlzIGZhaWx1cmUsIHRoZSB7QGxpbmsgRmlyZXN0b3JlfSBpbnN0YW5jZSB3aWxsXG4gKiByZW1haW4gdXNhYmxlLCBob3dldmVyIG9mZmxpbmUgcGVyc2lzdGVuY2Ugd2lsbCBiZSBkaXNhYmxlZC5cbiAqXG4gKiBUaGVyZSBhcmUgc2V2ZXJhbCByZWFzb25zIHdoeSB0aGlzIGNhbiBmYWlsLCB3aGljaCBjYW4gYmUgaWRlbnRpZmllZCBieVxuICogdGhlIGBjb2RlYCBvbiB0aGUgZXJyb3IuXG4gKlxuICogICAqIGZhaWxlZC1wcmVjb25kaXRpb246IFRoZSBhcHAgaXMgYWxyZWFkeSBvcGVuIGluIGFub3RoZXIgYnJvd3NlciB0YWIuXG4gKiAgICogdW5pbXBsZW1lbnRlZDogVGhlIGJyb3dzZXIgaXMgaW5jb21wYXRpYmxlIHdpdGggdGhlIG9mZmxpbmVcbiAqICAgICBwZXJzaXN0ZW5jZSBpbXBsZW1lbnRhdGlvbi5cbiAqXG4gKiBAcGFyYW0gZmlyZXN0b3JlIC0gVGhlIHtAbGluayBGaXJlc3RvcmV9IGluc3RhbmNlIHRvIGVuYWJsZSBwZXJzaXN0ZW5jZSBmb3IuXG4gKiBAcGFyYW0gcGVyc2lzdGVuY2VTZXR0aW5ncyAtIE9wdGlvbmFsIHNldHRpbmdzIG9iamVjdCB0byBjb25maWd1cmVcbiAqIHBlcnNpc3RlbmNlLlxuICogQHJldHVybnMgQSBgUHJvbWlzZWAgdGhhdCByZXByZXNlbnRzIHN1Y2Nlc3NmdWxseSBlbmFibGluZyBwZXJzaXN0ZW50IHN0b3JhZ2UuXG4gKi8gZnVuY3Rpb24gTWModCwgZSkge1xuICAgIHpjKHQgPSBtYyh0LCB4YykpO1xuICAgIGNvbnN0IG4gPSBPYyh0KSwgcyA9IHQuX2ZyZWV6ZVNldHRpbmdzKCksIGkgPSBuZXcgT2E7XG4gICAgcmV0dXJuIEJjKG4sIGksIG5ldyBrYShpLCBzLmNhY2hlU2l6ZUJ5dGVzLCBudWxsID09IGUgPyB2b2lkIDAgOiBlLmZvcmNlT3duZXJzaGlwKSk7XG59XG5cbi8qKlxuICogQXR0ZW1wdHMgdG8gZW5hYmxlIG11bHRpLXRhYiBwZXJzaXN0ZW50IHN0b3JhZ2UsIGlmIHBvc3NpYmxlLiBJZiBlbmFibGVkXG4gKiBhY3Jvc3MgYWxsIHRhYnMsIGFsbCBvcGVyYXRpb25zIHNoYXJlIGFjY2VzcyB0byBsb2NhbCBwZXJzaXN0ZW5jZSwgaW5jbHVkaW5nXG4gKiBzaGFyZWQgZXhlY3V0aW9uIG9mIHF1ZXJpZXMgYW5kIGxhdGVuY3ktY29tcGVuc2F0ZWQgbG9jYWwgZG9jdW1lbnQgdXBkYXRlc1xuICogYWNyb3NzIGFsbCBjb25uZWN0ZWQgaW5zdGFuY2VzLlxuICpcbiAqIElmIHRoaXMgZmFpbHMsIGBlbmFibGVNdWx0aVRhYkluZGV4ZWREYlBlcnNpc3RlbmNlKClgIHdpbGwgcmVqZWN0IHRoZSBwcm9taXNlXG4gKiBpdCByZXR1cm5zLiBOb3RlIHRoYXQgZXZlbiBhZnRlciB0aGlzIGZhaWx1cmUsIHRoZSB7QGxpbmsgRmlyZXN0b3JlfSBpbnN0YW5jZSB3aWxsXG4gKiByZW1haW4gdXNhYmxlLCBob3dldmVyIG9mZmxpbmUgcGVyc2lzdGVuY2Ugd2lsbCBiZSBkaXNhYmxlZC5cbiAqXG4gKiBUaGVyZSBhcmUgc2V2ZXJhbCByZWFzb25zIHdoeSB0aGlzIGNhbiBmYWlsLCB3aGljaCBjYW4gYmUgaWRlbnRpZmllZCBieVxuICogdGhlIGBjb2RlYCBvbiB0aGUgZXJyb3IuXG4gKlxuICogICAqIGZhaWxlZC1wcmVjb25kaXRpb246IFRoZSBhcHAgaXMgYWxyZWFkeSBvcGVuIGluIGFub3RoZXIgYnJvd3NlciB0YWIgYW5kXG4gKiAgICAgbXVsdGktdGFiIGlzIG5vdCBlbmFibGVkLlxuICogICAqIHVuaW1wbGVtZW50ZWQ6IFRoZSBicm93c2VyIGlzIGluY29tcGF0aWJsZSB3aXRoIHRoZSBvZmZsaW5lXG4gKiAgICAgcGVyc2lzdGVuY2UgaW1wbGVtZW50YXRpb24uXG4gKlxuICogQHBhcmFtIGZpcmVzdG9yZSAtIFRoZSB7QGxpbmsgRmlyZXN0b3JlfSBpbnN0YW5jZSB0byBlbmFibGUgcGVyc2lzdGVuY2UgZm9yLlxuICogQHJldHVybnMgQSBgUHJvbWlzZWAgdGhhdCByZXByZXNlbnRzIHN1Y2Nlc3NmdWxseSBlbmFibGluZyBwZXJzaXN0ZW50XG4gKiBzdG9yYWdlLlxuICovIGZ1bmN0aW9uIExjKHQpIHtcbiAgICB6Yyh0ID0gbWModCwgeGMpKTtcbiAgICBjb25zdCBlID0gT2ModCksIG4gPSB0Ll9mcmVlemVTZXR0aW5ncygpLCBzID0gbmV3IE9hO1xuICAgIHJldHVybiBCYyhlLCBzLCBuZXcgJGEocywgbi5jYWNoZVNpemVCeXRlcykpO1xufVxuXG4vKipcbiAqIFJlZ2lzdGVycyBib3RoIHRoZSBgT2ZmbGluZUNvbXBvbmVudFByb3ZpZGVyYCBhbmQgYE9ubGluZUNvbXBvbmVudFByb3ZpZGVyYC5cbiAqIElmIHRoZSBvcGVyYXRpb24gZmFpbHMgd2l0aCBhIHJlY292ZXJhYmxlIGVycm9yIChzZWVcbiAqIGBjYW5SZWNvdmVyRnJvbUluZGV4ZWREYkVycm9yKClgIGJlbG93KSwgdGhlIHJldHVybmVkIFByb21pc2UgaXMgcmVqZWN0ZWRcbiAqIGJ1dCB0aGUgY2xpZW50IHJlbWFpbnMgdXNhYmxlLlxuICovIGZ1bmN0aW9uIEJjKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gbmV3IGo7XG4gICAgcmV0dXJuIHQuYXN5bmNRdWV1ZS5lbnF1ZXVlKChhc3luYyAoKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCBLYSh0LCBuKSwgYXdhaXQgamEodCwgZSksIHMucmVzb2x2ZSgpO1xuICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICBpZiAoIVxuICAgICAgICAgICAgLyoqXG4gKiBEZWNpZGVzIHdoZXRoZXIgdGhlIHByb3ZpZGVkIGVycm9yIGFsbG93cyB1cyB0byBncmFjZWZ1bGx5IGRpc2FibGVcbiAqIHBlcnNpc3RlbmNlIChhcyBvcHBvc2VkIHRvIGNyYXNoaW5nIHRoZSBjbGllbnQpLlxuICovXG4gICAgICAgICAgICBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgaWYgKFwiRmlyZWJhc2VFcnJvclwiID09PSB0Lm5hbWUpIHJldHVybiB0LmNvZGUgPT09IHEuRkFJTEVEX1BSRUNPTkRJVElPTiB8fCB0LmNvZGUgPT09IHEuVU5JTVBMRU1FTlRFRDtcbiAgICAgICAgICAgICAgICBpZiAoXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgRE9NRXhjZXB0aW9uICYmIHQgaW5zdGFuY2VvZiBET01FeGNlcHRpb24pIFxuICAgICAgICAgICAgICAgIC8vIFRoZXJlIGFyZSBhIGZldyBrbm93biBjaXJjdW1zdGFuY2VzIHdoZXJlIHdlIGNhbiBvcGVuIEluZGV4ZWREYiBidXRcbiAgICAgICAgICAgICAgICAvLyB0cnlpbmcgdG8gcmVhZC93cml0ZSB3aWxsIGZhaWwgKGUuZy4gcXVvdGEgZXhjZWVkZWQpLiBGb3JcbiAgICAgICAgICAgICAgICAvLyB3ZWxsLXVuZGVyc3Rvb2QgY2FzZXMsIHdlIGF0dGVtcHQgdG8gZGV0ZWN0IHRoZXNlIGFuZCB0aGVuIGdyYWNlZnVsbHlcbiAgICAgICAgICAgICAgICAvLyBmYWxsIGJhY2sgdG8gbWVtb3J5IHBlcnNpc3RlbmNlLlxuICAgICAgICAgICAgICAgIC8vIE5PVEU6IFJhdGhlciB0aGFuIGNvbnRpbnVlIHRvIGFkZCB0byB0aGlzIGxpc3QsIHdlIGNvdWxkIGRlY2lkZSB0b1xuICAgICAgICAgICAgICAgIC8vIGFsd2F5cyBmYWxsIGJhY2ssIHdpdGggdGhlIHJpc2sgdGhhdCB3ZSBtaWdodCBhY2NpZGVudGFsbHkgaGlkZSBlcnJvcnNcbiAgICAgICAgICAgICAgICAvLyByZXByZXNlbnRpbmcgYWN0dWFsIFNESyBidWdzLlxuICAgICAgICAgICAgICAgIC8vIFdoZW4gdGhlIGJyb3dzZXIgaXMgb3V0IG9mIHF1b3RhIHdlIGNvdWxkIGdldCBlaXRoZXIgcXVvdGEgZXhjZWVkZWRcbiAgICAgICAgICAgICAgICAvLyBvciBhbiBhYm9ydGVkIGVycm9yIGRlcGVuZGluZyBvbiB3aGV0aGVyIHRoZSBlcnJvciBoYXBwZW5lZCBkdXJpbmdcbiAgICAgICAgICAgICAgICAvLyBzY2hlbWEgbWlncmF0aW9uLlxuICAgICAgICAgICAgICAgIHJldHVybiAyMiA9PT0gdC5jb2RlIHx8IDIwID09PSB0LmNvZGUgfHwgXG4gICAgICAgICAgICAgICAgLy8gRmlyZWZveCBQcml2YXRlIEJyb3dzaW5nIG1vZGUgZGlzYWJsZXMgSW5kZXhlZERiIGFuZCByZXR1cm5zXG4gICAgICAgICAgICAgICAgLy8gSU5WQUxJRF9TVEFURSBmb3IgYW55IHVzYWdlLlxuICAgICAgICAgICAgICAgIDExID09PSB0LmNvZGU7XG4gICAgICAgICAgICAgICAgcmV0dXJuICEwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyoqXG4gKiBDbGVhcnMgdGhlIHBlcnNpc3RlbnQgc3RvcmFnZS4gVGhpcyBpbmNsdWRlcyBwZW5kaW5nIHdyaXRlcyBhbmQgY2FjaGVkXG4gKiBkb2N1bWVudHMuXG4gKlxuICogTXVzdCBiZSBjYWxsZWQgd2hpbGUgdGhlIHtAbGluayBGaXJlc3RvcmV9IGluc3RhbmNlIGlzIG5vdCBzdGFydGVkIChhZnRlciB0aGUgYXBwIGlzXG4gKiB0ZXJtaW5hdGVkIG9yIHdoZW4gdGhlIGFwcCBpcyBmaXJzdCBpbml0aWFsaXplZCkuIE9uIHN0YXJ0dXAsIHRoaXMgZnVuY3Rpb25cbiAqIG11c3QgYmUgY2FsbGVkIGJlZm9yZSBvdGhlciBmdW5jdGlvbnMgKG90aGVyIHRoYW4ge0BsaW5rXG4gKiBpbml0aWFsaXplRmlyZXN0b3JlfSBvciB7QGxpbmsgZ2V0RmlyZXN0b3JlfSkpLiBJZiB0aGUge0BsaW5rIEZpcmVzdG9yZX1cbiAqIGluc3RhbmNlIGlzIHN0aWxsIHJ1bm5pbmcsIHRoZSBwcm9taXNlIHdpbGwgYmUgcmVqZWN0ZWQgd2l0aCB0aGUgZXJyb3IgY29kZVxuICogb2YgYGZhaWxlZC1wcmVjb25kaXRpb25gLlxuICpcbiAqIE5vdGU6IGBjbGVhckluZGV4ZWREYlBlcnNpc3RlbmNlKClgIGlzIHByaW1hcmlseSBpbnRlbmRlZCB0byBoZWxwIHdyaXRlXG4gKiByZWxpYWJsZSB0ZXN0cyB0aGF0IHVzZSBDbG91ZCBGaXJlc3RvcmUuIEl0IHVzZXMgYW4gZWZmaWNpZW50IG1lY2hhbmlzbSBmb3JcbiAqIGRyb3BwaW5nIGV4aXN0aW5nIGRhdGEgYnV0IGRvZXMgbm90IGF0dGVtcHQgdG8gc2VjdXJlbHkgb3ZlcndyaXRlIG9yXG4gKiBvdGhlcndpc2UgbWFrZSBjYWNoZWQgZGF0YSB1bnJlY292ZXJhYmxlLiBGb3IgYXBwbGljYXRpb25zIHRoYXQgYXJlIHNlbnNpdGl2ZVxuICogdG8gdGhlIGRpc2Nsb3N1cmUgb2YgY2FjaGVkIGRhdGEgaW4gYmV0d2VlbiB1c2VyIHNlc3Npb25zLCB3ZSBzdHJvbmdseVxuICogcmVjb21tZW5kIG5vdCBlbmFibGluZyBwZXJzaXN0ZW5jZSBhdCBhbGwuXG4gKlxuICogQHBhcmFtIGZpcmVzdG9yZSAtIFRoZSB7QGxpbmsgRmlyZXN0b3JlfSBpbnN0YW5jZSB0byBjbGVhciBwZXJzaXN0ZW5jZSBmb3IuXG4gKiBAcmV0dXJucyBBIGBQcm9taXNlYCB0aGF0IGlzIHJlc29sdmVkIHdoZW4gdGhlIHBlcnNpc3RlbnQgc3RvcmFnZSBpc1xuICogY2xlYXJlZC4gT3RoZXJ3aXNlLCB0aGUgcHJvbWlzZSBpcyByZWplY3RlZCB3aXRoIGFuIGVycm9yLlxuICovICh0KSkgdGhyb3cgdDtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihcIkVycm9yIGVuYWJsaW5nIG9mZmxpbmUgcGVyc2lzdGVuY2UuIEZhbGxpbmcgYmFjayB0byBwZXJzaXN0ZW5jZSBkaXNhYmxlZDogXCIgKyB0KSwgXG4gICAgICAgICAgICBzLnJlamVjdCh0KTtcbiAgICAgICAgfVxuICAgIH0pKS50aGVuKCgoKSA9PiBzLnByb21pc2UpKTtcbn1cblxuZnVuY3Rpb24gVWModCkge1xuICAgIGlmICh0Ll9pbml0aWFsaXplZCAmJiAhdC5fdGVybWluYXRlZCkgdGhyb3cgbmV3IEsocS5GQUlMRURfUFJFQ09ORElUSU9OLCBcIlBlcnNpc3RlbmNlIGNhbiBvbmx5IGJlIGNsZWFyZWQgYmVmb3JlIGEgRmlyZXN0b3JlIGluc3RhbmNlIGlzIGluaXRpYWxpemVkIG9yIGFmdGVyIGl0IGlzIHRlcm1pbmF0ZWQuXCIpO1xuICAgIGNvbnN0IGUgPSBuZXcgajtcbiAgICByZXR1cm4gdC5fcXVldWUuZW5xdWV1ZUFuZEZvcmdldEV2ZW5XaGlsZVJlc3RyaWN0ZWQoKGFzeW5jICgpID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IGFzeW5jIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgICAgICBpZiAoIVFzLlB0KCkpIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdCArIFwibWFpblwiO1xuICAgICAgICAgICAgICAgIGF3YWl0IFFzLmRlbGV0ZShlKTtcbiAgICAgICAgICAgIH0obnIodC5fZGF0YWJhc2VJZCwgdC5fcGVyc2lzdGVuY2VLZXkpKSwgZS5yZXNvbHZlKCk7XG4gICAgICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgICAgIGUucmVqZWN0KHQpO1xuICAgICAgICB9XG4gICAgfSkpLCBlLnByb21pc2U7XG59XG5cbi8qKlxuICogV2FpdHMgdW50aWwgYWxsIGN1cnJlbnRseSBwZW5kaW5nIHdyaXRlcyBmb3IgdGhlIGFjdGl2ZSB1c2VyIGhhdmUgYmVlblxuICogYWNrbm93bGVkZ2VkIGJ5IHRoZSBiYWNrZW5kLlxuICpcbiAqIFRoZSByZXR1cm5lZCBwcm9taXNlIHJlc29sdmVzIGltbWVkaWF0ZWx5IGlmIHRoZXJlIGFyZSBubyBvdXRzdGFuZGluZyB3cml0ZXMuXG4gKiBPdGhlcndpc2UsIHRoZSBwcm9taXNlIHdhaXRzIGZvciBhbGwgcHJldmlvdXNseSBpc3N1ZWQgd3JpdGVzIChpbmNsdWRpbmdcbiAqIHRob3NlIHdyaXR0ZW4gaW4gYSBwcmV2aW91cyBhcHAgc2Vzc2lvbiksIGJ1dCBpdCBkb2VzIG5vdCB3YWl0IGZvciB3cml0ZXNcbiAqIHRoYXQgd2VyZSBhZGRlZCBhZnRlciB0aGUgZnVuY3Rpb24gaXMgY2FsbGVkLiBJZiB5b3Ugd2FudCB0byB3YWl0IGZvclxuICogYWRkaXRpb25hbCB3cml0ZXMsIGNhbGwgYHdhaXRGb3JQZW5kaW5nV3JpdGVzKClgIGFnYWluLlxuICpcbiAqIEFueSBvdXRzdGFuZGluZyBgd2FpdEZvclBlbmRpbmdXcml0ZXMoKWAgcHJvbWlzZXMgYXJlIHJlamVjdGVkIGR1cmluZyB1c2VyXG4gKiBjaGFuZ2VzLlxuICpcbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHdoaWNoIHJlc29sdmVzIHdoZW4gYWxsIGN1cnJlbnRseSBwZW5kaW5nIHdyaXRlcyBoYXZlIGJlZW5cbiAqIGFja25vd2xlZGdlZCBieSB0aGUgYmFja2VuZC5cbiAqLyBmdW5jdGlvbiBxYyh0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IG5ldyBqO1xuICAgICAgICByZXR1cm4gdC5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoKGFzeW5jICgpID0+IGhhKGF3YWl0IEphKHQpLCBlKSkpLCBlLnByb21pc2U7XG4gICAgfShPYyh0ID0gbWModCwgeGMpKSk7XG59XG5cbi8qKlxuICogUmUtZW5hYmxlcyB1c2Ugb2YgdGhlIG5ldHdvcmsgZm9yIHRoaXMge0BsaW5rIEZpcmVzdG9yZX0gaW5zdGFuY2UgYWZ0ZXIgYSBwcmlvclxuICogY2FsbCB0byB7QGxpbmsgZGlzYWJsZU5ldHdvcmt9LlxuICpcbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHRoYXQgaXMgcmVzb2x2ZWQgb25jZSB0aGUgbmV0d29yayBoYXMgYmVlbiBlbmFibGVkLlxuICovIGZ1bmN0aW9uIEtjKHQpIHtcbiAgICByZXR1cm4gWGEoT2ModCA9IG1jKHQsIHhjKSkpO1xufVxuXG4vKipcbiAqIERpc2FibGVzIG5ldHdvcmsgdXNhZ2UgZm9yIHRoaXMgaW5zdGFuY2UuIEl0IGNhbiBiZSByZS1lbmFibGVkIHZpYSB7QGxpbmtcbiAqIGVuYWJsZU5ldHdvcmt9LiBXaGlsZSB0aGUgbmV0d29yayBpcyBkaXNhYmxlZCwgYW55IHNuYXBzaG90IGxpc3RlbmVycyxcbiAqIGBnZXREb2MoKWAgb3IgYGdldERvY3MoKWAgY2FsbHMgd2lsbCByZXR1cm4gcmVzdWx0cyBmcm9tIGNhY2hlLCBhbmQgYW55IHdyaXRlXG4gKiBvcGVyYXRpb25zIHdpbGwgYmUgcXVldWVkIHVudGlsIHRoZSBuZXR3b3JrIGlzIHJlc3RvcmVkLlxuICpcbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHRoYXQgaXMgcmVzb2x2ZWQgb25jZSB0aGUgbmV0d29yayBoYXMgYmVlbiBkaXNhYmxlZC5cbiAqLyBmdW5jdGlvbiBqYyh0KSB7XG4gICAgcmV0dXJuIFphKE9jKHQgPSBtYyh0LCB4YykpKTtcbn1cblxuLyoqXG4gKiBUZXJtaW5hdGVzIHRoZSBwcm92aWRlZCB7QGxpbmsgRmlyZXN0b3JlfSBpbnN0YW5jZS5cbiAqXG4gKiBBZnRlciBjYWxsaW5nIGB0ZXJtaW5hdGUoKWAgb25seSB0aGUgYGNsZWFySW5kZXhlZERiUGVyc2lzdGVuY2UoKWAgZnVuY3Rpb25cbiAqIG1heSBiZSB1c2VkLiBBbnkgb3RoZXIgZnVuY3Rpb24gd2lsbCB0aHJvdyBhIGBGaXJlc3RvcmVFcnJvcmAuXG4gKlxuICogVG8gcmVzdGFydCBhZnRlciB0ZXJtaW5hdGlvbiwgY3JlYXRlIGEgbmV3IGluc3RhbmNlIG9mIEZpcmViYXNlRmlyZXN0b3JlIHdpdGhcbiAqIHtAbGluayBnZXRGaXJlc3RvcmV9LlxuICpcbiAqIFRlcm1pbmF0aW9uIGRvZXMgbm90IGNhbmNlbCBhbnkgcGVuZGluZyB3cml0ZXMsIGFuZCBhbnkgcHJvbWlzZXMgdGhhdCBhcmVcbiAqIGF3YWl0aW5nIGEgcmVzcG9uc2UgZnJvbSB0aGUgc2VydmVyIHdpbGwgbm90IGJlIHJlc29sdmVkLiBJZiB5b3UgaGF2ZVxuICogcGVyc2lzdGVuY2UgZW5hYmxlZCwgdGhlIG5leHQgdGltZSB5b3Ugc3RhcnQgdGhpcyBpbnN0YW5jZSwgaXQgd2lsbCByZXN1bWVcbiAqIHNlbmRpbmcgdGhlc2Ugd3JpdGVzIHRvIHRoZSBzZXJ2ZXIuXG4gKlxuICogTm90ZTogVW5kZXIgbm9ybWFsIGNpcmN1bXN0YW5jZXMsIGNhbGxpbmcgYHRlcm1pbmF0ZSgpYCBpcyBub3QgcmVxdWlyZWQuIFRoaXNcbiAqIGZ1bmN0aW9uIGlzIHVzZWZ1bCBvbmx5IHdoZW4geW91IHdhbnQgdG8gZm9yY2UgdGhpcyBpbnN0YW5jZSB0byByZWxlYXNlIGFsbFxuICogb2YgaXRzIHJlc291cmNlcyBvciBpbiBjb21iaW5hdGlvbiB3aXRoIGBjbGVhckluZGV4ZWREYlBlcnNpc3RlbmNlKClgIHRvXG4gKiBlbnN1cmUgdGhhdCBhbGwgbG9jYWwgc3RhdGUgaXMgZGVzdHJveWVkIGJldHdlZW4gdGVzdCBydW5zLlxuICpcbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHRoYXQgaXMgcmVzb2x2ZWQgd2hlbiB0aGUgaW5zdGFuY2UgaGFzIGJlZW4gc3VjY2Vzc2Z1bGx5XG4gKiB0ZXJtaW5hdGVkLlxuICovIGZ1bmN0aW9uIFFjKHQpIHtcbiAgICByZXR1cm4gbih0LmFwcCwgXCJmaXJlc3RvcmVcIiksIHQuX2RlbGV0ZSgpO1xufVxuXG4vKipcbiAqIExvYWRzIGEgRmlyZXN0b3JlIGJ1bmRsZSBpbnRvIHRoZSBsb2NhbCBjYWNoZS5cbiAqXG4gKiBAcGFyYW0gZmlyZXN0b3JlIC0gVGhlIHtAbGluayBGaXJlc3RvcmV9IGluc3RhbmNlIHRvIGxvYWQgYnVuZGxlcyBmb3IgZm9yLlxuICogQHBhcmFtIGJ1bmRsZURhdGEgLSBBbiBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSBidW5kbGUgdG8gYmUgbG9hZGVkLiBWYWxpZCBvYmplY3RzIGFyZVxuICogICBgQXJyYXlCdWZmZXJgLCBgUmVhZGFibGVTdHJlYW08VWludDhBcnJheT5gIG9yIGBzdHJpbmdgLlxuICpcbiAqIEByZXR1cm5zXG4gKiAgIEEgYExvYWRCdW5kbGVUYXNrYCBvYmplY3QsIHdoaWNoIG5vdGlmaWVzIGNhbGxlcnMgd2l0aCBwcm9ncmVzcyB1cGRhdGVzLCBhbmQgY29tcGxldGlvblxuICogICBvciBlcnJvciBldmVudHMuIEl0IGNhbiBiZSB1c2VkIGFzIGEgYFByb21pc2U8TG9hZEJ1bmRsZVRhc2tQcm9ncmVzcz5gLlxuICovIGZ1bmN0aW9uIFdjKHQsIGUpIHtcbiAgICBjb25zdCBuID0gT2ModCA9IG1jKHQsIHhjKSksIHMgPSBuZXcgQ2M7XG4gICAgcmV0dXJuIG9jKG4sIHQuX2RhdGFiYXNlSWQsIGUsIHMpLCBzO1xufVxuXG4vKipcbiAqIFJlYWRzIGEgRmlyZXN0b3JlIHtAbGluayBRdWVyeX0gZnJvbSBsb2NhbCBjYWNoZSwgaWRlbnRpZmllZCBieSB0aGUgZ2l2ZW4gbmFtZS5cbiAqXG4gKiBUaGUgbmFtZWQgcXVlcmllcyBhcmUgcGFja2FnZWQgIGludG8gYnVuZGxlcyBvbiB0aGUgc2VydmVyIHNpZGUgKGFsb25nXG4gKiB3aXRoIHJlc3VsdGluZyBkb2N1bWVudHMpLCBhbmQgbG9hZGVkIHRvIGxvY2FsIGNhY2hlIHVzaW5nIGBsb2FkQnVuZGxlYC4gT25jZSBpbiBsb2NhbFxuICogY2FjaGUsIHVzZSB0aGlzIG1ldGhvZCB0byBleHRyYWN0IGEge0BsaW5rIFF1ZXJ5fSBieSBuYW1lLlxuICovIGZ1bmN0aW9uIEdjKHQsIGUpIHtcbiAgICByZXR1cm4gYWMoT2ModCA9IG1jKHQsIHhjKSksIGUpLnRoZW4oKGUgPT4gZSA/IG5ldyBJYyh0LCBudWxsLCBlLnF1ZXJ5KSA6IG51bGwpKTtcbn1cblxuZnVuY3Rpb24gemModCkge1xuICAgIGlmICh0Ll9pbml0aWFsaXplZCB8fCB0Ll90ZXJtaW5hdGVkKSB0aHJvdyBuZXcgSyhxLkZBSUxFRF9QUkVDT05ESVRJT04sIFwiRmlyZXN0b3JlIGhhcyBhbHJlYWR5IGJlZW4gc3RhcnRlZCBhbmQgcGVyc2lzdGVuY2UgY2FuIG5vIGxvbmdlciBiZSBlbmFibGVkLiBZb3UgY2FuIG9ubHkgZW5hYmxlIHBlcnNpc3RlbmNlIGJlZm9yZSBjYWxsaW5nIGFueSBvdGhlciBtZXRob2RzIG9uIGEgRmlyZXN0b3JlIG9iamVjdC5cIik7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBIGBGaWVsZFBhdGhgIHJlZmVycyB0byBhIGZpZWxkIGluIGEgZG9jdW1lbnQuIFRoZSBwYXRoIG1heSBjb25zaXN0IG9mIGFcbiAqIHNpbmdsZSBmaWVsZCBuYW1lIChyZWZlcnJpbmcgdG8gYSB0b3AtbGV2ZWwgZmllbGQgaW4gdGhlIGRvY3VtZW50KSwgb3IgYVxuICogbGlzdCBvZiBmaWVsZCBuYW1lcyAocmVmZXJyaW5nIHRvIGEgbmVzdGVkIGZpZWxkIGluIHRoZSBkb2N1bWVudCkuXG4gKlxuICogQ3JlYXRlIGEgYEZpZWxkUGF0aGAgYnkgcHJvdmlkaW5nIGZpZWxkIG5hbWVzLiBJZiBtb3JlIHRoYW4gb25lIGZpZWxkXG4gKiBuYW1lIGlzIHByb3ZpZGVkLCB0aGUgcGF0aCB3aWxsIHBvaW50IHRvIGEgbmVzdGVkIGZpZWxkIGluIGEgZG9jdW1lbnQuXG4gKi9cbmNsYXNzIEhjIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgYEZpZWxkUGF0aGAgZnJvbSB0aGUgcHJvdmlkZWQgZmllbGQgbmFtZXMuIElmIG1vcmUgdGhhbiBvbmUgZmllbGRcbiAgICAgKiBuYW1lIGlzIHByb3ZpZGVkLCB0aGUgcGF0aCB3aWxsIHBvaW50IHRvIGEgbmVzdGVkIGZpZWxkIGluIGEgZG9jdW1lbnQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZmllbGROYW1lcyAtIEEgbGlzdCBvZiBmaWVsZCBuYW1lcy5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvciguLi50KSB7XG4gICAgICAgIGZvciAobGV0IGUgPSAwOyBlIDwgdC5sZW5ndGg7ICsrZSkgaWYgKDAgPT09IHRbZV0ubGVuZ3RoKSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIFwiSW52YWxpZCBmaWVsZCBuYW1lIGF0IGFyZ3VtZW50ICQoaSArIDEpLiBGaWVsZCBuYW1lcyBtdXN0IG5vdCBiZSBlbXB0eS5cIik7XG4gICAgICAgIHRoaXMuX2ludGVybmFsUGF0aCA9IG5ldyBsdCh0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHRoaXMgYEZpZWxkUGF0aGAgaXMgZXF1YWwgdG8gdGhlIHByb3ZpZGVkIG9uZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBvdGhlciAtIFRoZSBgRmllbGRQYXRoYCB0byBjb21wYXJlIGFnYWluc3QuXG4gICAgICogQHJldHVybnMgdHJ1ZSBpZiB0aGlzIGBGaWVsZFBhdGhgIGlzIGVxdWFsIHRvIHRoZSBwcm92aWRlZCBvbmUuXG4gICAgICovICAgIGlzRXF1YWwodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5faW50ZXJuYWxQYXRoLmlzRXF1YWwodC5faW50ZXJuYWxQYXRoKTtcbiAgICB9XG59XG5cbi8qKlxuICogUmV0dXJucyBhIHNwZWNpYWwgc2VudGluZWwgYEZpZWxkUGF0aGAgdG8gcmVmZXIgdG8gdGhlIElEIG9mIGEgZG9jdW1lbnQuXG4gKiBJdCBjYW4gYmUgdXNlZCBpbiBxdWVyaWVzIHRvIHNvcnQgb3IgZmlsdGVyIGJ5IHRoZSBkb2N1bWVudCBJRC5cbiAqLyBmdW5jdGlvbiBKYygpIHtcbiAgICByZXR1cm4gbmV3IEhjKFwiX19uYW1lX19cIik7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEFuIGltbXV0YWJsZSBvYmplY3QgcmVwcmVzZW50aW5nIGFuIGFycmF5IG9mIGJ5dGVzLlxuICovIGNsYXNzIFljIHtcbiAgICAvKiogQGhpZGVjb25zdHJ1Y3RvciAqL1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5fYnl0ZVN0cmluZyA9IHQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgYEJ5dGVzYCBvYmplY3QgZnJvbSB0aGUgZ2l2ZW4gQmFzZTY0IHN0cmluZywgY29udmVydGluZyBpdCB0b1xuICAgICAqIGJ5dGVzLlxuICAgICAqXG4gICAgICogQHBhcmFtIGJhc2U2NCAtIFRoZSBCYXNlNjQgc3RyaW5nIHVzZWQgdG8gY3JlYXRlIHRoZSBgQnl0ZXNgIG9iamVjdC5cbiAgICAgKi8gICAgc3RhdGljIGZyb21CYXNlNjRTdHJpbmcodCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBZYyh3dC5mcm9tQmFzZTY0U3RyaW5nKHQpKTtcbiAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEsocS5JTlZBTElEX0FSR1VNRU5ULCBcIkZhaWxlZCB0byBjb25zdHJ1Y3QgZGF0YSBmcm9tIEJhc2U2NCBzdHJpbmc6IFwiICsgdCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyBgQnl0ZXNgIG9iamVjdCBmcm9tIHRoZSBnaXZlbiBVaW50OEFycmF5LlxuICAgICAqXG4gICAgICogQHBhcmFtIGFycmF5IC0gVGhlIFVpbnQ4QXJyYXkgdXNlZCB0byBjcmVhdGUgdGhlIGBCeXRlc2Agb2JqZWN0LlxuICAgICAqLyAgICBzdGF0aWMgZnJvbVVpbnQ4QXJyYXkodCkge1xuICAgICAgICByZXR1cm4gbmV3IFljKHd0LmZyb21VaW50OEFycmF5KHQpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgdW5kZXJseWluZyBieXRlcyBhcyBhIEJhc2U2NC1lbmNvZGVkIHN0cmluZy5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIFRoZSBCYXNlNjQtZW5jb2RlZCBzdHJpbmcgY3JlYXRlZCBmcm9tIHRoZSBgQnl0ZXNgIG9iamVjdC5cbiAgICAgKi8gICAgdG9CYXNlNjQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9ieXRlU3RyaW5nLnRvQmFzZTY0KCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIHVuZGVybHlpbmcgYnl0ZXMgaW4gYSBuZXcgYFVpbnQ4QXJyYXlgLlxuICAgICAqXG4gICAgICogQHJldHVybnMgVGhlIFVpbnQ4QXJyYXkgY3JlYXRlZCBmcm9tIHRoZSBgQnl0ZXNgIG9iamVjdC5cbiAgICAgKi8gICAgdG9VaW50OEFycmF5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fYnl0ZVN0cmluZy50b1VpbnQ4QXJyYXkoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgYEJ5dGVzYCBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBBIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgYEJ5dGVzYCBvYmplY3QuXG4gICAgICovICAgIHRvU3RyaW5nKCkge1xuICAgICAgICByZXR1cm4gXCJCeXRlcyhiYXNlNjQ6IFwiICsgdGhpcy50b0Jhc2U2NCgpICsgXCIpXCI7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGlzIGBCeXRlc2Agb2JqZWN0IGlzIGVxdWFsIHRvIHRoZSBwcm92aWRlZCBvbmUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gb3RoZXIgLSBUaGUgYEJ5dGVzYCBvYmplY3QgdG8gY29tcGFyZSBhZ2FpbnN0LlxuICAgICAqIEByZXR1cm5zIHRydWUgaWYgdGhpcyBgQnl0ZXNgIG9iamVjdCBpcyBlcXVhbCB0byB0aGUgcHJvdmlkZWQgb25lLlxuICAgICAqLyAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2J5dGVTdHJpbmcuaXNFcXVhbCh0Ll9ieXRlU3RyaW5nKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFNlbnRpbmVsIHZhbHVlcyB0aGF0IGNhbiBiZSB1c2VkIHdoZW4gd3JpdGluZyBkb2N1bWVudCBmaWVsZHMgd2l0aCBgc2V0KClgXG4gKiBvciBgdXBkYXRlKClgLlxuICovIGNsYXNzIFhjIHtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0gX21ldGhvZE5hbWUgLSBUaGUgcHVibGljIEFQSSBlbmRwb2ludCB0aGF0IHJldHVybnMgdGhpcyBjbGFzcy5cbiAgICAgKiBAaGlkZWNvbnN0cnVjdG9yXG4gICAgICovXG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLl9tZXRob2ROYW1lID0gdDtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEFuIGltbXV0YWJsZSBvYmplY3QgcmVwcmVzZW50aW5nIGEgZ2VvZ3JhcGhpYyBsb2NhdGlvbiBpbiBGaXJlc3RvcmUuIFRoZVxuICogbG9jYXRpb24gaXMgcmVwcmVzZW50ZWQgYXMgbGF0aXR1ZGUvbG9uZ2l0dWRlIHBhaXIuXG4gKlxuICogTGF0aXR1ZGUgdmFsdWVzIGFyZSBpbiB0aGUgcmFuZ2Ugb2YgWy05MCwgOTBdLlxuICogTG9uZ2l0dWRlIHZhbHVlcyBhcmUgaW4gdGhlIHJhbmdlIG9mIFstMTgwLCAxODBdLlxuICovIGNsYXNzIFpjIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IGltbXV0YWJsZSBgR2VvUG9pbnRgIG9iamVjdCB3aXRoIHRoZSBwcm92aWRlZCBsYXRpdHVkZSBhbmRcbiAgICAgKiBsb25naXR1ZGUgdmFsdWVzLlxuICAgICAqIEBwYXJhbSBsYXRpdHVkZSAtIFRoZSBsYXRpdHVkZSBhcyBudW1iZXIgYmV0d2VlbiAtOTAgYW5kIDkwLlxuICAgICAqIEBwYXJhbSBsb25naXR1ZGUgLSBUaGUgbG9uZ2l0dWRlIGFzIG51bWJlciBiZXR3ZWVuIC0xODAgYW5kIDE4MC5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIGlmICghaXNGaW5pdGUodCkgfHwgdCA8IC05MCB8fCB0ID4gOTApIHRocm93IG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgXCJMYXRpdHVkZSBtdXN0IGJlIGEgbnVtYmVyIGJldHdlZW4gLTkwIGFuZCA5MCwgYnV0IHdhczogXCIgKyB0KTtcbiAgICAgICAgaWYgKCFpc0Zpbml0ZShlKSB8fCBlIDwgLTE4MCB8fCBlID4gMTgwKSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIFwiTG9uZ2l0dWRlIG11c3QgYmUgYSBudW1iZXIgYmV0d2VlbiAtMTgwIGFuZCAxODAsIGJ1dCB3YXM6IFwiICsgZSk7XG4gICAgICAgIHRoaXMuX2xhdCA9IHQsIHRoaXMuX2xvbmcgPSBlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgbGF0aXR1ZGUgb2YgdGhpcyBgR2VvUG9pbnRgIGluc3RhbmNlLlxuICAgICAqLyAgICBnZXQgbGF0aXR1ZGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9sYXQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSBsb25naXR1ZGUgb2YgdGhpcyBgR2VvUG9pbnRgIGluc3RhbmNlLlxuICAgICAqLyAgICBnZXQgbG9uZ2l0dWRlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbG9uZztcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHRoaXMgYEdlb1BvaW50YCBpcyBlcXVhbCB0byB0aGUgcHJvdmlkZWQgb25lLlxuICAgICAqXG4gICAgICogQHBhcmFtIG90aGVyIC0gVGhlIGBHZW9Qb2ludGAgdG8gY29tcGFyZSBhZ2FpbnN0LlxuICAgICAqIEByZXR1cm5zIHRydWUgaWYgdGhpcyBgR2VvUG9pbnRgIGlzIGVxdWFsIHRvIHRoZSBwcm92aWRlZCBvbmUuXG4gICAgICovICAgIGlzRXF1YWwodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbGF0ID09PSB0Ll9sYXQgJiYgdGhpcy5fbG9uZyA9PT0gdC5fbG9uZztcbiAgICB9XG4gICAgLyoqIFJldHVybnMgYSBKU09OLXNlcmlhbGl6YWJsZSByZXByZXNlbnRhdGlvbiBvZiB0aGlzIEdlb1BvaW50LiAqLyAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBsYXRpdHVkZTogdGhpcy5fbGF0LFxuICAgICAgICAgICAgbG9uZ2l0dWRlOiB0aGlzLl9sb25nXG4gICAgICAgIH07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFjdHVhbGx5IHByaXZhdGUgdG8gSlMgY29uc3VtZXJzIG9mIG91ciBBUEksIHNvIHRoaXMgZnVuY3Rpb24gaXMgcHJlZml4ZWRcbiAgICAgKiB3aXRoIGFuIHVuZGVyc2NvcmUuXG4gICAgICovICAgIF9jb21wYXJlVG8odCkge1xuICAgICAgICByZXR1cm4gdHQodGhpcy5fbGF0LCB0Ll9sYXQpIHx8IHR0KHRoaXMuX2xvbmcsIHQuX2xvbmcpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY29uc3QgdHUgPSAvXl9fLipfXyQvO1xuXG4vKiogVGhlIHJlc3VsdCBvZiBwYXJzaW5nIGRvY3VtZW50IGRhdGEgKGUuZy4gZm9yIGEgc2V0RGF0YSBjYWxsKS4gKi8gY2xhc3MgZXUge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4pIHtcbiAgICAgICAgdGhpcy5kYXRhID0gdCwgdGhpcy5maWVsZE1hc2sgPSBlLCB0aGlzLmZpZWxkVHJhbnNmb3JtcyA9IG47XG4gICAgfVxuICAgIHRvTXV0YXRpb24odCwgZSkge1xuICAgICAgICByZXR1cm4gbnVsbCAhPT0gdGhpcy5maWVsZE1hc2sgPyBuZXcgZW4odCwgdGhpcy5kYXRhLCB0aGlzLmZpZWxkTWFzaywgZSwgdGhpcy5maWVsZFRyYW5zZm9ybXMpIDogbmV3IHRuKHQsIHRoaXMuZGF0YSwgZSwgdGhpcy5maWVsZFRyYW5zZm9ybXMpO1xuICAgIH1cbn1cblxuLyoqIFRoZSByZXN1bHQgb2YgcGFyc2luZyBcInVwZGF0ZVwiIGRhdGEgKGkuZS4gZm9yIGFuIHVwZGF0ZURhdGEgY2FsbCkuICovIGNsYXNzIG51IHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBcbiAgICAvLyBUaGUgZmllbGRNYXNrIGRvZXMgbm90IGluY2x1ZGUgZG9jdW1lbnQgdHJhbnNmb3Jtcy5cbiAgICBlLCBuKSB7XG4gICAgICAgIHRoaXMuZGF0YSA9IHQsIHRoaXMuZmllbGRNYXNrID0gZSwgdGhpcy5maWVsZFRyYW5zZm9ybXMgPSBuO1xuICAgIH1cbiAgICB0b011dGF0aW9uKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBlbih0LCB0aGlzLmRhdGEsIHRoaXMuZmllbGRNYXNrLCBlLCB0aGlzLmZpZWxkVHJhbnNmb3Jtcyk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBzdSh0KSB7XG4gICAgc3dpdGNoICh0KSB7XG4gICAgICBjYXNlIDAgLyogU2V0ICovIDpcbiAvLyBmYWxsIHRocm91Z2hcbiAgICAgICAgICAgICAgY2FzZSAyIC8qIE1lcmdlU2V0ICovIDpcbiAvLyBmYWxsIHRocm91Z2hcbiAgICAgICAgICAgICAgY2FzZSAxIC8qIFVwZGF0ZSAqLyA6XG4gICAgICAgIHJldHVybiAhMDtcblxuICAgICAgY2FzZSAzIC8qIEFyZ3VtZW50ICovIDpcbiAgICAgIGNhc2UgNCAvKiBBcnJheUFyZ3VtZW50ICovIDpcbiAgICAgICAgcmV0dXJuICExO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICB0aHJvdyBNKCk7XG4gICAgfVxufVxuXG4vKiogQSBcImNvbnRleHRcIiBvYmplY3QgcGFzc2VkIGFyb3VuZCB3aGlsZSBwYXJzaW5nIHVzZXIgZGF0YS4gKi8gY2xhc3MgaXUge1xuICAgIC8qKlxuICAgICAqIEluaXRpYWxpemVzIGEgUGFyc2VDb250ZXh0IHdpdGggdGhlIGdpdmVuIHNvdXJjZSBhbmQgcGF0aC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBzZXR0aW5ncyAtIFRoZSBzZXR0aW5ncyBmb3IgdGhlIHBhcnNlci5cbiAgICAgKiBAcGFyYW0gZGF0YWJhc2VJZCAtIFRoZSBkYXRhYmFzZSBJRCBvZiB0aGUgRmlyZXN0b3JlIGluc3RhbmNlLlxuICAgICAqIEBwYXJhbSBzZXJpYWxpemVyIC0gVGhlIHNlcmlhbGl6ZXIgdG8gdXNlIHRvIGdlbmVyYXRlIHRoZSBWYWx1ZSBwcm90by5cbiAgICAgKiBAcGFyYW0gaWdub3JlVW5kZWZpbmVkUHJvcGVydGllcyAtIFdoZXRoZXIgdG8gaWdub3JlIHVuZGVmaW5lZCBwcm9wZXJ0aWVzXG4gICAgICogcmF0aGVyIHRoYW4gdGhyb3cuXG4gICAgICogQHBhcmFtIGZpZWxkVHJhbnNmb3JtcyAtIEEgbXV0YWJsZSBsaXN0IG9mIGZpZWxkIHRyYW5zZm9ybXMgZW5jb3VudGVyZWRcbiAgICAgKiB3aGlsZSBwYXJzaW5nIHRoZSBkYXRhLlxuICAgICAqIEBwYXJhbSBmaWVsZE1hc2sgLSBBIG11dGFibGUgbGlzdCBvZiBmaWVsZCBwYXRocyBlbmNvdW50ZXJlZCB3aGlsZSBwYXJzaW5nXG4gICAgICogdGhlIGRhdGEuXG4gICAgICpcbiAgICAgKiBUT0RPKGIvMzQ4NzExMzEpOiBXZSBkb24ndCBzdXBwb3J0IGFycmF5IHBhdGhzIHJpZ2h0IG5vdywgc28gcGF0aCBjYW4gYmVcbiAgICAgKiBudWxsIHRvIGluZGljYXRlIHRoZSBjb250ZXh0IHJlcHJlc2VudHMgYW55IGxvY2F0aW9uIHdpdGhpbiBhbiBhcnJheSAoaW5cbiAgICAgKiB3aGljaCBjYXNlIGNlcnRhaW4gZmVhdHVyZXMgd2lsbCBub3Qgd29yayBhbmQgZXJyb3JzIHdpbGwgYmUgc29tZXdoYXRcbiAgICAgKiBjb21wcm9taXNlZCkuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcywgaSwgcikge1xuICAgICAgICB0aGlzLnNldHRpbmdzID0gdCwgdGhpcy5kYXRhYmFzZUlkID0gZSwgdGhpcy5OID0gbiwgdGhpcy5pZ25vcmVVbmRlZmluZWRQcm9wZXJ0aWVzID0gcywgXG4gICAgICAgIC8vIE1pbm9yIGhhY2s6IElmIGZpZWxkVHJhbnNmb3JtcyBpcyB1bmRlZmluZWQsIHdlIGFzc3VtZSB0aGlzIGlzIGFuXG4gICAgICAgIC8vIGV4dGVybmFsIGNhbGwgYW5kIHdlIG5lZWQgdG8gdmFsaWRhdGUgdGhlIGVudGlyZSBwYXRoLlxuICAgICAgICB2b2lkIDAgPT09IGkgJiYgdGhpcy5TYSgpLCB0aGlzLmZpZWxkVHJhbnNmb3JtcyA9IGkgfHwgW10sIHRoaXMuZmllbGRNYXNrID0gciB8fCBbXTtcbiAgICB9XG4gICAgZ2V0IHBhdGgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNldHRpbmdzLnBhdGg7XG4gICAgfVxuICAgIGdldCBEYSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2V0dGluZ3MuRGE7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIGEgbmV3IGNvbnRleHQgd2l0aCB0aGUgc3BlY2lmaWVkIHNldHRpbmdzIG92ZXJ3cml0dGVuLiAqLyAgICBDYSh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgaXUoT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCB0aGlzLnNldHRpbmdzKSwgdCksIHRoaXMuZGF0YWJhc2VJZCwgdGhpcy5OLCB0aGlzLmlnbm9yZVVuZGVmaW5lZFByb3BlcnRpZXMsIHRoaXMuZmllbGRUcmFuc2Zvcm1zLCB0aGlzLmZpZWxkTWFzayk7XG4gICAgfVxuICAgIE5hKHQpIHtcbiAgICAgICAgdmFyIGU7XG4gICAgICAgIGNvbnN0IG4gPSBudWxsID09PSAoZSA9IHRoaXMucGF0aCkgfHwgdm9pZCAwID09PSBlID8gdm9pZCAwIDogZS5jaGlsZCh0KSwgcyA9IHRoaXMuQ2Eoe1xuICAgICAgICAgICAgcGF0aDogbixcbiAgICAgICAgICAgIHhhOiAhMVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHMua2EodCksIHM7XG4gICAgfVxuICAgICRhKHQpIHtcbiAgICAgICAgdmFyIGU7XG4gICAgICAgIGNvbnN0IG4gPSBudWxsID09PSAoZSA9IHRoaXMucGF0aCkgfHwgdm9pZCAwID09PSBlID8gdm9pZCAwIDogZS5jaGlsZCh0KSwgcyA9IHRoaXMuQ2Eoe1xuICAgICAgICAgICAgcGF0aDogbixcbiAgICAgICAgICAgIHhhOiAhMVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHMuU2EoKSwgcztcbiAgICB9XG4gICAgT2EodCkge1xuICAgICAgICAvLyBUT0RPKGIvMzQ4NzExMzEpOiBXZSBkb24ndCBzdXBwb3J0IGFycmF5IHBhdGhzIHJpZ2h0IG5vdzsgc28gbWFrZSBwYXRoXG4gICAgICAgIC8vIHVuZGVmaW5lZC5cbiAgICAgICAgcmV0dXJuIHRoaXMuQ2Eoe1xuICAgICAgICAgICAgcGF0aDogdm9pZCAwLFxuICAgICAgICAgICAgeGE6ICEwXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBGYSh0KSB7XG4gICAgICAgIHJldHVybiBSdSh0LCB0aGlzLnNldHRpbmdzLm1ldGhvZE5hbWUsIHRoaXMuc2V0dGluZ3MuTWEgfHwgITEsIHRoaXMucGF0aCwgdGhpcy5zZXR0aW5ncy5MYSk7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zICd0cnVlJyBpZiAnZmllbGRQYXRoJyB3YXMgdHJhdmVyc2VkIHdoZW4gY3JlYXRpbmcgdGhpcyBjb250ZXh0LiAqLyAgICBjb250YWlucyh0KSB7XG4gICAgICAgIHJldHVybiB2b2lkIDAgIT09IHRoaXMuZmllbGRNYXNrLmZpbmQoKGUgPT4gdC5pc1ByZWZpeE9mKGUpKSkgfHwgdm9pZCAwICE9PSB0aGlzLmZpZWxkVHJhbnNmb3Jtcy5maW5kKChlID0+IHQuaXNQcmVmaXhPZihlLmZpZWxkKSkpO1xuICAgIH1cbiAgICBTYSgpIHtcbiAgICAgICAgLy8gVE9ETyhiLzM0ODcxMTMxKTogUmVtb3ZlIG51bGwgY2hlY2sgb25jZSB3ZSBoYXZlIHByb3BlciBwYXRocyBmb3IgZmllbGRzXG4gICAgICAgIC8vIHdpdGhpbiBhcnJheXMuXG4gICAgICAgIGlmICh0aGlzLnBhdGgpIGZvciAobGV0IHQgPSAwOyB0IDwgdGhpcy5wYXRoLmxlbmd0aDsgdCsrKSB0aGlzLmthKHRoaXMucGF0aC5nZXQodCkpO1xuICAgIH1cbiAgICBrYSh0KSB7XG4gICAgICAgIGlmICgwID09PSB0Lmxlbmd0aCkgdGhyb3cgdGhpcy5GYShcIkRvY3VtZW50IGZpZWxkcyBtdXN0IG5vdCBiZSBlbXB0eVwiKTtcbiAgICAgICAgaWYgKHN1KHRoaXMuRGEpICYmIHR1LnRlc3QodCkpIHRocm93IHRoaXMuRmEoJ0RvY3VtZW50IGZpZWxkcyBjYW5ub3QgYmVnaW4gYW5kIGVuZCB3aXRoIFwiX19cIicpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBIZWxwZXIgZm9yIHBhcnNpbmcgcmF3IHVzZXIgaW5wdXQgKHByb3ZpZGVkIHZpYSB0aGUgQVBJKSBpbnRvIGludGVybmFsIG1vZGVsXG4gKiBjbGFzc2VzLlxuICovIGNsYXNzIHJ1IHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHRoaXMuZGF0YWJhc2VJZCA9IHQsIHRoaXMuaWdub3JlVW5kZWZpbmVkUHJvcGVydGllcyA9IGUsIHRoaXMuTiA9IG4gfHwgSnIodCk7XG4gICAgfVxuICAgIC8qKiBDcmVhdGVzIGEgbmV3IHRvcC1sZXZlbCBwYXJzZSBjb250ZXh0LiAqLyAgICBCYSh0LCBlLCBuLCBzID0gITEpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBpdSh7XG4gICAgICAgICAgICBEYTogdCxcbiAgICAgICAgICAgIG1ldGhvZE5hbWU6IGUsXG4gICAgICAgICAgICBMYTogbixcbiAgICAgICAgICAgIHBhdGg6IGx0LmVtcHR5UGF0aCgpLFxuICAgICAgICAgICAgeGE6ICExLFxuICAgICAgICAgICAgTWE6IHNcbiAgICAgICAgfSwgdGhpcy5kYXRhYmFzZUlkLCB0aGlzLk4sIHRoaXMuaWdub3JlVW5kZWZpbmVkUHJvcGVydGllcyk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBvdSh0KSB7XG4gICAgY29uc3QgZSA9IHQuX2ZyZWV6ZVNldHRpbmdzKCksIG4gPSBKcih0Ll9kYXRhYmFzZUlkKTtcbiAgICByZXR1cm4gbmV3IHJ1KHQuX2RhdGFiYXNlSWQsICEhZS5pZ25vcmVVbmRlZmluZWRQcm9wZXJ0aWVzLCBuKTtcbn1cblxuLyoqIFBhcnNlIGRvY3VtZW50IGRhdGEgZnJvbSBhIHNldCgpIGNhbGwuICovIGZ1bmN0aW9uIGF1KHQsIGUsIG4sIHMsIGksIHIgPSB7fSkge1xuICAgIGNvbnN0IG8gPSB0LkJhKHIubWVyZ2UgfHwgci5tZXJnZUZpZWxkcyA/IDIgLyogTWVyZ2VTZXQgKi8gOiAwIC8qIFNldCAqLyAsIGUsIG4sIGkpO1xuICAgIEV1KFwiRGF0YSBtdXN0IGJlIGFuIG9iamVjdCwgYnV0IGl0IHdhczpcIiwgbywgcyk7XG4gICAgY29uc3QgYSA9IHl1KHMsIG8pO1xuICAgIGxldCBjLCB1O1xuICAgIGlmIChyLm1lcmdlKSBjID0gbmV3IGZ0KG8uZmllbGRNYXNrKSwgdSA9IG8uZmllbGRUcmFuc2Zvcm1zOyBlbHNlIGlmIChyLm1lcmdlRmllbGRzKSB7XG4gICAgICAgIGNvbnN0IHQgPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCBzIG9mIHIubWVyZ2VGaWVsZHMpIHtcbiAgICAgICAgICAgIGNvbnN0IGkgPSBUdShlLCBzLCBuKTtcbiAgICAgICAgICAgIGlmICghby5jb250YWlucyhpKSkgdGhyb3cgbmV3IEsocS5JTlZBTElEX0FSR1VNRU5ULCBgRmllbGQgJyR7aX0nIGlzIHNwZWNpZmllZCBpbiB5b3VyIGZpZWxkIG1hc2sgYnV0IG1pc3NpbmcgZnJvbSB5b3VyIGlucHV0IGRhdGEuYCk7XG4gICAgICAgICAgICBQdSh0LCBpKSB8fCB0LnB1c2goaSk7XG4gICAgICAgIH1cbiAgICAgICAgYyA9IG5ldyBmdCh0KSwgdSA9IG8uZmllbGRUcmFuc2Zvcm1zLmZpbHRlcigodCA9PiBjLmNvdmVycyh0LmZpZWxkKSkpO1xuICAgIH0gZWxzZSBjID0gbnVsbCwgdSA9IG8uZmllbGRUcmFuc2Zvcm1zO1xuICAgIHJldHVybiBuZXcgZXUobmV3IEJ0KGEpLCBjLCB1KTtcbn1cblxuY2xhc3MgY3UgZXh0ZW5kcyBYYyB7XG4gICAgX3RvRmllbGRUcmFuc2Zvcm0odCkge1xuICAgICAgICBpZiAoMiAvKiBNZXJnZVNldCAqLyAhPT0gdC5EYSkgdGhyb3cgMSAvKiBVcGRhdGUgKi8gPT09IHQuRGEgPyB0LkZhKGAke3RoaXMuX21ldGhvZE5hbWV9KCkgY2FuIG9ubHkgYXBwZWFyIGF0IHRoZSB0b3AgbGV2ZWwgb2YgeW91ciB1cGRhdGUgZGF0YWApIDogdC5GYShgJHt0aGlzLl9tZXRob2ROYW1lfSgpIGNhbm5vdCBiZSB1c2VkIHdpdGggc2V0KCkgdW5sZXNzIHlvdSBwYXNzIHttZXJnZTp0cnVlfWApO1xuICAgICAgICAvLyBObyB0cmFuc2Zvcm0gdG8gYWRkIGZvciBhIGRlbGV0ZSwgYnV0IHdlIG5lZWQgdG8gYWRkIGl0IHRvIG91clxuICAgICAgICAvLyBmaWVsZE1hc2sgc28gaXQgZ2V0cyBkZWxldGVkLlxuICAgICAgICByZXR1cm4gdC5maWVsZE1hc2sucHVzaCh0LnBhdGgpLCBudWxsO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgcmV0dXJuIHQgaW5zdGFuY2VvZiBjdTtcbiAgICB9XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIGNoaWxkIGNvbnRleHQgZm9yIHBhcnNpbmcgU2VyaWFsaXphYmxlRmllbGRWYWx1ZXMuXG4gKlxuICogVGhpcyBpcyBkaWZmZXJlbnQgdGhhbiBjYWxsaW5nIGBQYXJzZUNvbnRleHQuY29udGV4dFdpdGhgIGJlY2F1c2UgaXQga2VlcHNcbiAqIHRoZSBmaWVsZFRyYW5zZm9ybXMgYW5kIGZpZWxkTWFzayBzZXBhcmF0ZS5cbiAqXG4gKiBUaGUgY3JlYXRlZCBjb250ZXh0IGhhcyBpdHMgYGRhdGFTb3VyY2VgIHNldCB0byBgVXNlckRhdGFTb3VyY2UuQXJndW1lbnRgLlxuICogQWx0aG91Z2ggdGhlc2UgdmFsdWVzIGFyZSB1c2VkIHdpdGggd3JpdGVzLCBhbnkgZWxlbWVudHMgaW4gdGhlc2UgRmllbGRWYWx1ZXNcbiAqIGFyZSBub3QgY29uc2lkZXJlZCB3cml0ZXMgc2luY2UgdGhleSBjYW5ub3QgY29udGFpbiBhbnkgRmllbGRWYWx1ZSBzZW50aW5lbHMsXG4gKiBldGMuXG4gKlxuICogQHBhcmFtIGZpZWxkVmFsdWUgLSBUaGUgc2VudGluZWwgRmllbGRWYWx1ZSBmb3Igd2hpY2ggdG8gY3JlYXRlIGEgY2hpbGRcbiAqICAgICBjb250ZXh0LlxuICogQHBhcmFtIGNvbnRleHQgLSBUaGUgcGFyZW50IGNvbnRleHQuXG4gKiBAcGFyYW0gYXJyYXlFbGVtZW50IC0gV2hldGhlciBvciBub3QgdGhlIEZpZWxkVmFsdWUgaGFzIGFuIGFycmF5LlxuICovIGZ1bmN0aW9uIHV1KHQsIGUsIG4pIHtcbiAgICByZXR1cm4gbmV3IGl1KHtcbiAgICAgICAgRGE6IDMgLyogQXJndW1lbnQgKi8gLFxuICAgICAgICBMYTogZS5zZXR0aW5ncy5MYSxcbiAgICAgICAgbWV0aG9kTmFtZTogdC5fbWV0aG9kTmFtZSxcbiAgICAgICAgeGE6IG5cbiAgICB9LCBlLmRhdGFiYXNlSWQsIGUuTiwgZS5pZ25vcmVVbmRlZmluZWRQcm9wZXJ0aWVzKTtcbn1cblxuY2xhc3MgaHUgZXh0ZW5kcyBYYyB7XG4gICAgX3RvRmllbGRUcmFuc2Zvcm0odCkge1xuICAgICAgICByZXR1cm4gbmV3IEtlKHQucGF0aCwgbmV3ICRlKTtcbiAgICB9XG4gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIHJldHVybiB0IGluc3RhbmNlb2YgaHU7XG4gICAgfVxufVxuXG5jbGFzcyBsdSBleHRlbmRzIFhjIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHN1cGVyKHQpLCB0aGlzLlVhID0gZTtcbiAgICB9XG4gICAgX3RvRmllbGRUcmFuc2Zvcm0odCkge1xuICAgICAgICBjb25zdCBlID0gdXUodGhpcywgdCwgXG4gICAgICAgIC8qYXJyYXk9Ki8gITApLCBuID0gdGhpcy5VYS5tYXAoKHQgPT4gZ3UodCwgZSkpKSwgcyA9IG5ldyBPZShuKTtcbiAgICAgICAgcmV0dXJuIG5ldyBLZSh0LnBhdGgsIHMpO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgLy8gVE9ETyhtcnNjaG1pZHQpOiBJbXBsZW1lbnQgaXNFcXVhbHNcbiAgICAgICAgcmV0dXJuIHRoaXMgPT09IHQ7XG4gICAgfVxufVxuXG5jbGFzcyBmdSBleHRlbmRzIFhjIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHN1cGVyKHQpLCB0aGlzLlVhID0gZTtcbiAgICB9XG4gICAgX3RvRmllbGRUcmFuc2Zvcm0odCkge1xuICAgICAgICBjb25zdCBlID0gdXUodGhpcywgdCwgXG4gICAgICAgIC8qYXJyYXk9Ki8gITApLCBuID0gdGhpcy5VYS5tYXAoKHQgPT4gZ3UodCwgZSkpKSwgcyA9IG5ldyBNZShuKTtcbiAgICAgICAgcmV0dXJuIG5ldyBLZSh0LnBhdGgsIHMpO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgLy8gVE9ETyhtcnNjaG1pZHQpOiBJbXBsZW1lbnQgaXNFcXVhbHNcbiAgICAgICAgcmV0dXJuIHRoaXMgPT09IHQ7XG4gICAgfVxufVxuXG5jbGFzcyBkdSBleHRlbmRzIFhjIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHN1cGVyKHQpLCB0aGlzLnFhID0gZTtcbiAgICB9XG4gICAgX3RvRmllbGRUcmFuc2Zvcm0odCkge1xuICAgICAgICBjb25zdCBlID0gbmV3IEJlKHQuTiwgRGUodC5OLCB0aGlzLnFhKSk7XG4gICAgICAgIHJldHVybiBuZXcgS2UodC5wYXRoLCBlKTtcbiAgICB9XG4gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIC8vIFRPRE8obXJzY2htaWR0KTogSW1wbGVtZW50IGlzRXF1YWxzXG4gICAgICAgIHJldHVybiB0aGlzID09PSB0O1xuICAgIH1cbn1cblxuLyoqIFBhcnNlIHVwZGF0ZSBkYXRhIGZyb20gYW4gdXBkYXRlKCkgY2FsbC4gKi8gZnVuY3Rpb24gd3UodCwgZSwgbiwgcykge1xuICAgIGNvbnN0IGkgPSB0LkJhKDEgLyogVXBkYXRlICovICwgZSwgbik7XG4gICAgRXUoXCJEYXRhIG11c3QgYmUgYW4gb2JqZWN0LCBidXQgaXQgd2FzOlwiLCBpLCBzKTtcbiAgICBjb25zdCByID0gW10sIG8gPSBCdC5lbXB0eSgpO1xuICAgIG90KHMsICgodCwgcykgPT4ge1xuICAgICAgICBjb25zdCBhID0gQXUoZSwgdCwgbik7XG4gICAgICAgIC8vIEZvciBDb21wYXQgdHlwZXMsIHdlIGhhdmUgdG8gXCJleHRyYWN0XCIgdGhlIHVuZGVybHlpbmcgdHlwZXMgYmVmb3JlXG4gICAgICAgIC8vIHBlcmZvcm1pbmcgdmFsaWRhdGlvbi5cbiAgICAgICAgICAgICAgICBzID0geShzKTtcbiAgICAgICAgY29uc3QgYyA9IGkuJGEoYSk7XG4gICAgICAgIGlmIChzIGluc3RhbmNlb2YgY3UpIFxuICAgICAgICAvLyBBZGQgaXQgdG8gdGhlIGZpZWxkIG1hc2ssIGJ1dCBkb24ndCBhZGQgYW55dGhpbmcgdG8gdXBkYXRlRGF0YS5cbiAgICAgICAgci5wdXNoKGEpOyBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBndShzLCBjKTtcbiAgICAgICAgICAgIG51bGwgIT0gdCAmJiAoci5wdXNoKGEpLCBvLnNldChhLCB0KSk7XG4gICAgICAgIH1cbiAgICB9KSk7XG4gICAgY29uc3QgYSA9IG5ldyBmdChyKTtcbiAgICByZXR1cm4gbmV3IG51KG8sIGEsIGkuZmllbGRUcmFuc2Zvcm1zKTtcbn1cblxuLyoqIFBhcnNlIHVwZGF0ZSBkYXRhIGZyb20gYSBsaXN0IG9mIGZpZWxkL3ZhbHVlIGFyZ3VtZW50cy4gKi8gZnVuY3Rpb24gX3UodCwgZSwgbiwgcywgaSwgcikge1xuICAgIGNvbnN0IG8gPSB0LkJhKDEgLyogVXBkYXRlICovICwgZSwgbiksIGEgPSBbIFR1KGUsIHMsIG4pIF0sIGMgPSBbIGkgXTtcbiAgICBpZiAoci5sZW5ndGggJSAyICE9IDApIHRocm93IG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgYEZ1bmN0aW9uICR7ZX0oKSBuZWVkcyB0byBiZSBjYWxsZWQgd2l0aCBhbiBldmVuIG51bWJlciBvZiBhcmd1bWVudHMgdGhhdCBhbHRlcm5hdGUgYmV0d2VlbiBmaWVsZCBuYW1lcyBhbmQgdmFsdWVzLmApO1xuICAgIGZvciAobGV0IHQgPSAwOyB0IDwgci5sZW5ndGg7IHQgKz0gMikgYS5wdXNoKFR1KGUsIHJbdF0pKSwgYy5wdXNoKHJbdCArIDFdKTtcbiAgICBjb25zdCB1ID0gW10sIGggPSBCdC5lbXB0eSgpO1xuICAgIC8vIFdlIGl0ZXJhdGUgaW4gcmV2ZXJzZSBvcmRlciB0byBwaWNrIHRoZSBsYXN0IHZhbHVlIGZvciBhIGZpZWxkIGlmIHRoZVxuICAgIC8vIHVzZXIgc3BlY2lmaWVkIHRoZSBmaWVsZCBtdWx0aXBsZSB0aW1lcy5cbiAgICBmb3IgKGxldCB0ID0gYS5sZW5ndGggLSAxOyB0ID49IDA7IC0tdCkgaWYgKCFQdSh1LCBhW3RdKSkge1xuICAgICAgICBjb25zdCBlID0gYVt0XTtcbiAgICAgICAgbGV0IG4gPSBjW3RdO1xuICAgICAgICAvLyBGb3IgQ29tcGF0IHR5cGVzLCB3ZSBoYXZlIHRvIFwiZXh0cmFjdFwiIHRoZSB1bmRlcmx5aW5nIHR5cGVzIGJlZm9yZVxuICAgICAgICAvLyBwZXJmb3JtaW5nIHZhbGlkYXRpb24uXG4gICAgICAgICAgICAgICAgbiA9IHkobik7XG4gICAgICAgIGNvbnN0IHMgPSBvLiRhKGUpO1xuICAgICAgICBpZiAobiBpbnN0YW5jZW9mIGN1KSBcbiAgICAgICAgLy8gQWRkIGl0IHRvIHRoZSBmaWVsZCBtYXNrLCBidXQgZG9uJ3QgYWRkIGFueXRoaW5nIHRvIHVwZGF0ZURhdGEuXG4gICAgICAgIHUucHVzaChlKTsgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gZ3Uobiwgcyk7XG4gICAgICAgICAgICBudWxsICE9IHQgJiYgKHUucHVzaChlKSwgaC5zZXQoZSwgdCkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0IGwgPSBuZXcgZnQodSk7XG4gICAgcmV0dXJuIG5ldyBudShoLCBsLCBvLmZpZWxkVHJhbnNmb3Jtcyk7XG59XG5cbi8qKlxuICogUGFyc2UgYSBcInF1ZXJ5IHZhbHVlXCIgKGUuZy4gdmFsdWUgaW4gYSB3aGVyZSBmaWx0ZXIgb3IgYSB2YWx1ZSBpbiBhIGN1cnNvclxuICogYm91bmQpLlxuICpcbiAqIEBwYXJhbSBhbGxvd0FycmF5cyAtIFdoZXRoZXIgdGhlIHF1ZXJ5IHZhbHVlIGlzIGFuIGFycmF5IHRoYXQgbWF5IGRpcmVjdGx5XG4gKiBjb250YWluIGFkZGl0aW9uYWwgYXJyYXlzIChlLmcuIHRoZSBvcGVyYW5kIG9mIGFuIGBpbmAgcXVlcnkpLlxuICovIGZ1bmN0aW9uIG11KHQsIGUsIG4sIHMgPSAhMSkge1xuICAgIHJldHVybiBndShuLCB0LkJhKHMgPyA0IC8qIEFycmF5QXJndW1lbnQgKi8gOiAzIC8qIEFyZ3VtZW50ICovICwgZSkpO1xufVxuXG4vKipcbiAqIFBhcnNlcyB1c2VyIGRhdGEgdG8gUHJvdG9idWYgVmFsdWVzLlxuICpcbiAqIEBwYXJhbSBpbnB1dCAtIERhdGEgdG8gYmUgcGFyc2VkLlxuICogQHBhcmFtIGNvbnRleHQgLSBBIGNvbnRleHQgb2JqZWN0IHJlcHJlc2VudGluZyB0aGUgY3VycmVudCBwYXRoIGJlaW5nIHBhcnNlZCxcbiAqIHRoZSBzb3VyY2Ugb2YgdGhlIGRhdGEgYmVpbmcgcGFyc2VkLCBldGMuXG4gKiBAcmV0dXJucyBUaGUgcGFyc2VkIHZhbHVlLCBvciBudWxsIGlmIHRoZSB2YWx1ZSB3YXMgYSBGaWVsZFZhbHVlIHNlbnRpbmVsXG4gKiB0aGF0IHNob3VsZCBub3QgYmUgaW5jbHVkZWQgaW4gdGhlIHJlc3VsdGluZyBwYXJzZWQgZGF0YS5cbiAqLyBmdW5jdGlvbiBndSh0LCBlKSB7XG4gICAgaWYgKHB1KFxuICAgIC8vIFVud3JhcCB0aGUgQVBJIHR5cGUgZnJvbSB0aGUgQ29tcGF0IFNESy4gVGhpcyB3aWxsIHJldHVybiB0aGUgQVBJIHR5cGVcbiAgICAvLyBmcm9tIGZpcmVzdG9yZS1leHAuXG4gICAgdCA9IHkodCkpKSByZXR1cm4gRXUoXCJVbnN1cHBvcnRlZCBmaWVsZCB2YWx1ZTpcIiwgZSwgdCksIHl1KHQsIGUpO1xuICAgIGlmICh0IGluc3RhbmNlb2YgWGMpIFxuICAgIC8vIEZpZWxkVmFsdWVzIHVzdWFsbHkgcGFyc2UgaW50byB0cmFuc2Zvcm1zIChleGNlcHQgRmllbGRWYWx1ZS5kZWxldGUoKSlcbiAgICAvLyBpbiB3aGljaCBjYXNlIHdlIGRvIG5vdCB3YW50IHRvIGluY2x1ZGUgdGhpcyBmaWVsZCBpbiBvdXIgcGFyc2VkIGRhdGFcbiAgICAvLyAoYXMgZG9pbmcgc28gd2lsbCBvdmVyd3JpdGUgdGhlIGZpZWxkIGRpcmVjdGx5IHByaW9yIHRvIHRoZSB0cmFuc2Zvcm1cbiAgICAvLyB0cnlpbmcgdG8gdHJhbnNmb3JtIGl0KS4gU28gd2UgZG9uJ3QgYWRkIHRoaXMgbG9jYXRpb24gdG9cbiAgICAvLyBjb250ZXh0LmZpZWxkTWFzayBhbmQgd2UgcmV0dXJuIG51bGwgYXMgb3VyIHBhcnNpbmcgcmVzdWx0LlxuICAgIC8qKlxuICogXCJQYXJzZXNcIiB0aGUgcHJvdmlkZWQgRmllbGRWYWx1ZUltcGwsIGFkZGluZyBhbnkgbmVjZXNzYXJ5IHRyYW5zZm9ybXMgdG9cbiAqIGNvbnRleHQuZmllbGRUcmFuc2Zvcm1zLlxuICovXG4gICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgLy8gU2VudGluZWxzIGFyZSBvbmx5IHN1cHBvcnRlZCB3aXRoIHdyaXRlcywgYW5kIG5vdCB3aXRoaW4gYXJyYXlzLlxuICAgICAgICBpZiAoIXN1KGUuRGEpKSB0aHJvdyBlLkZhKGAke3QuX21ldGhvZE5hbWV9KCkgY2FuIG9ubHkgYmUgdXNlZCB3aXRoIHVwZGF0ZSgpIGFuZCBzZXQoKWApO1xuICAgICAgICBpZiAoIWUucGF0aCkgdGhyb3cgZS5GYShgJHt0Ll9tZXRob2ROYW1lfSgpIGlzIG5vdCBjdXJyZW50bHkgc3VwcG9ydGVkIGluc2lkZSBhcnJheXNgKTtcbiAgICAgICAgY29uc3QgbiA9IHQuX3RvRmllbGRUcmFuc2Zvcm0oZSk7XG4gICAgICAgIG4gJiYgZS5maWVsZFRyYW5zZm9ybXMucHVzaChuKTtcbiAgICB9XG4gICAgLyoqXG4gKiBIZWxwZXIgdG8gcGFyc2UgYSBzY2FsYXIgdmFsdWUgKGkuZS4gbm90IGFuIE9iamVjdCwgQXJyYXksIG9yIEZpZWxkVmFsdWUpXG4gKlxuICogQHJldHVybnMgVGhlIHBhcnNlZCB2YWx1ZVxuICovICh0LCBlKSwgbnVsbDtcbiAgICBpZiAodm9pZCAwID09PSB0ICYmIGUuaWdub3JlVW5kZWZpbmVkUHJvcGVydGllcykgXG4gICAgLy8gSWYgdGhlIGlucHV0IGlzIHVuZGVmaW5lZCBpdCBjYW4gbmV2ZXIgcGFydGljaXBhdGUgaW4gdGhlIGZpZWxkTWFzaywgc29cbiAgICAvLyBkb24ndCBoYW5kbGUgdGhpcyBiZWxvdy4gSWYgYGlnbm9yZVVuZGVmaW5lZFByb3BlcnRpZXNgIGlzIGZhbHNlLFxuICAgIC8vIGBwYXJzZVNjYWxhclZhbHVlYCB3aWxsIHJlamVjdCBhbiB1bmRlZmluZWQgdmFsdWUuXG4gICAgcmV0dXJuIG51bGw7XG4gICAgaWYgKFxuICAgIC8vIElmIGNvbnRleHQucGF0aCBpcyBudWxsIHdlIGFyZSBpbnNpZGUgYW4gYXJyYXkgYW5kIHdlIGRvbid0IHN1cHBvcnRcbiAgICAvLyBmaWVsZCBtYXNrIHBhdGhzIG1vcmUgZ3JhbnVsYXIgdGhhbiB0aGUgdG9wLWxldmVsIGFycmF5LlxuICAgIGUucGF0aCAmJiBlLmZpZWxkTWFzay5wdXNoKGUucGF0aCksIHQgaW5zdGFuY2VvZiBBcnJheSkge1xuICAgICAgICAvLyBUT0RPKGIvMzQ4NzExMzEpOiBJbmNsdWRlIHRoZSBwYXRoIGNvbnRhaW5pbmcgdGhlIGFycmF5IGluIHRoZSBlcnJvclxuICAgICAgICAvLyBtZXNzYWdlLlxuICAgICAgICAvLyBJbiB0aGUgY2FzZSBvZiBJTiBxdWVyaWVzLCB0aGUgcGFyc2VkIGRhdGEgaXMgYW4gYXJyYXkgKHJlcHJlc2VudGluZ1xuICAgICAgICAvLyB0aGUgc2V0IG9mIHZhbHVlcyB0byBiZSBpbmNsdWRlZCBmb3IgdGhlIElOIHF1ZXJ5KSB0aGF0IG1heSBkaXJlY3RseVxuICAgICAgICAvLyBjb250YWluIGFkZGl0aW9uYWwgYXJyYXlzIChlYWNoIHJlcHJlc2VudGluZyBhbiBpbmRpdmlkdWFsIGZpZWxkXG4gICAgICAgIC8vIHZhbHVlKSwgc28gd2UgZGlzYWJsZSB0aGlzIHZhbGlkYXRpb24uXG4gICAgICAgIGlmIChlLnNldHRpbmdzLnhhICYmIDQgLyogQXJyYXlBcmd1bWVudCAqLyAhPT0gZS5EYSkgdGhyb3cgZS5GYShcIk5lc3RlZCBhcnJheXMgYXJlIG5vdCBzdXBwb3J0ZWRcIik7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gW107XG4gICAgICAgICAgICBsZXQgcyA9IDA7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGkgb2YgdCkge1xuICAgICAgICAgICAgICAgIGxldCB0ID0gZ3UoaSwgZS5PYShzKSk7XG4gICAgICAgICAgICAgICAgbnVsbCA9PSB0ICYmIChcbiAgICAgICAgICAgICAgICAvLyBKdXN0IGluY2x1ZGUgbnVsbHMgaW4gdGhlIGFycmF5IGZvciBmaWVsZHMgYmVpbmcgcmVwbGFjZWQgd2l0aCBhXG4gICAgICAgICAgICAgICAgLy8gc2VudGluZWwuXG4gICAgICAgICAgICAgICAgdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgbnVsbFZhbHVlOiBcIk5VTExfVkFMVUVcIlxuICAgICAgICAgICAgICAgIH0pLCBuLnB1c2godCksIHMrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgYXJyYXlWYWx1ZToge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZXM6IG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KHQsIGUpO1xuICAgIH1cbiAgICByZXR1cm4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBpZiAobnVsbCA9PT0gKHQgPSB5KHQpKSkgcmV0dXJuIHtcbiAgICAgICAgICAgIG51bGxWYWx1ZTogXCJOVUxMX1ZBTFVFXCJcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKFwibnVtYmVyXCIgPT0gdHlwZW9mIHQpIHJldHVybiBEZShlLk4sIHQpO1xuICAgICAgICBpZiAoXCJib29sZWFuXCIgPT0gdHlwZW9mIHQpIHJldHVybiB7XG4gICAgICAgICAgICBib29sZWFuVmFsdWU6IHRcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKFwic3RyaW5nXCIgPT0gdHlwZW9mIHQpIHJldHVybiB7XG4gICAgICAgICAgICBzdHJpbmdWYWx1ZTogdFxuICAgICAgICB9O1xuICAgICAgICBpZiAodCBpbnN0YW5jZW9mIERhdGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBzdC5mcm9tRGF0ZSh0KTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdGltZXN0YW1wVmFsdWU6IEJuKGUuTiwgbilcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBzdCkge1xuICAgICAgICAgICAgLy8gRmlyZXN0b3JlIGJhY2tlbmQgdHJ1bmNhdGVzIHByZWNpc2lvbiBkb3duIHRvIG1pY3Jvc2Vjb25kcy4gVG8gZW5zdXJlXG4gICAgICAgICAgICAvLyBvZmZsaW5lIG1vZGUgd29ya3MgdGhlIHNhbWUgd2l0aCByZWdhcmRzIHRvIHRydW5jYXRpb24sIHBlcmZvcm0gdGhlXG4gICAgICAgICAgICAvLyB0cnVuY2F0aW9uIGltbWVkaWF0ZWx5IHdpdGhvdXQgd2FpdGluZyBmb3IgdGhlIGJhY2tlbmQgdG8gZG8gdGhhdC5cbiAgICAgICAgICAgIGNvbnN0IG4gPSBuZXcgc3QodC5zZWNvbmRzLCAxZTMgKiBNYXRoLmZsb29yKHQubmFub3NlY29uZHMgLyAxZTMpKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdGltZXN0YW1wVmFsdWU6IEJuKGUuTiwgbilcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBaYykgcmV0dXJuIHtcbiAgICAgICAgICAgIGdlb1BvaW50VmFsdWU6IHtcbiAgICAgICAgICAgICAgICBsYXRpdHVkZTogdC5sYXRpdHVkZSxcbiAgICAgICAgICAgICAgICBsb25naXR1ZGU6IHQubG9uZ2l0dWRlXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGlmICh0IGluc3RhbmNlb2YgWWMpIHJldHVybiB7XG4gICAgICAgICAgICBieXRlc1ZhbHVlOiBVbihlLk4sIHQuX2J5dGVTdHJpbmcpXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0IGluc3RhbmNlb2YgVGMpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBlLmRhdGFiYXNlSWQsIHMgPSB0LmZpcmVzdG9yZS5fZGF0YWJhc2VJZDtcbiAgICAgICAgICAgIGlmICghcy5pc0VxdWFsKG4pKSB0aHJvdyBlLkZhKGBEb2N1bWVudCByZWZlcmVuY2UgaXMgZm9yIGRhdGFiYXNlICR7cy5wcm9qZWN0SWR9LyR7cy5kYXRhYmFzZX0gYnV0IHNob3VsZCBiZSBmb3IgZGF0YWJhc2UgJHtuLnByb2plY3RJZH0vJHtuLmRhdGFiYXNlfWApO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICByZWZlcmVuY2VWYWx1ZTogam4odC5maXJlc3RvcmUuX2RhdGFiYXNlSWQgfHwgZS5kYXRhYmFzZUlkLCB0Ll9rZXkucGF0aClcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgZS5GYShgVW5zdXBwb3J0ZWQgZmllbGQgdmFsdWU6ICR7X2ModCl9YCk7XG4gICAgfVxuICAgIC8qKlxuICogQ2hlY2tzIHdoZXRoZXIgYW4gb2JqZWN0IGxvb2tzIGxpa2UgYSBKU09OIG9iamVjdCB0aGF0IHNob3VsZCBiZSBjb252ZXJ0ZWRcbiAqIGludG8gYSBzdHJ1Y3QuIE5vcm1hbCBjbGFzcy9wcm90b3R5cGUgaW5zdGFuY2VzIGFyZSBjb25zaWRlcmVkIHRvIGxvb2sgbGlrZVxuICogSlNPTiBvYmplY3RzIHNpbmNlIHRoZXkgc2hvdWxkIGJlIGNvbnZlcnRlZCB0byBhIHN0cnVjdCB2YWx1ZS4gQXJyYXlzLCBEYXRlcyxcbiAqIEdlb1BvaW50cywgZXRjLiBhcmUgbm90IGNvbnNpZGVyZWQgdG8gbG9vayBsaWtlIEpTT04gb2JqZWN0cyBzaW5jZSB0aGV5IG1hcFxuICogdG8gc3BlY2lmaWMgRmllbGRWYWx1ZSB0eXBlcyBvdGhlciB0aGFuIE9iamVjdFZhbHVlLlxuICovICh0LCBlKTtcbn1cblxuZnVuY3Rpb24geXUodCwgZSkge1xuICAgIGNvbnN0IG4gPSB7fTtcbiAgICByZXR1cm4gYXQodCkgPyBcbiAgICAvLyBJZiB3ZSBlbmNvdW50ZXIgYW4gZW1wdHkgb2JqZWN0LCB3ZSBleHBsaWNpdGx5IGFkZCBpdCB0byB0aGUgdXBkYXRlXG4gICAgLy8gbWFzayB0byBlbnN1cmUgdGhhdCB0aGUgc2VydmVyIGNyZWF0ZXMgYSBtYXAgZW50cnkuXG4gICAgZS5wYXRoICYmIGUucGF0aC5sZW5ndGggPiAwICYmIGUuZmllbGRNYXNrLnB1c2goZS5wYXRoKSA6IG90KHQsICgodCwgcykgPT4ge1xuICAgICAgICBjb25zdCBpID0gZ3UocywgZS5OYSh0KSk7XG4gICAgICAgIG51bGwgIT0gaSAmJiAoblt0XSA9IGkpO1xuICAgIH0pKSwge1xuICAgICAgICBtYXBWYWx1ZToge1xuICAgICAgICAgICAgZmllbGRzOiBuXG4gICAgICAgIH1cbiAgICB9O1xufVxuXG5mdW5jdGlvbiBwdSh0KSB7XG4gICAgcmV0dXJuICEoXCJvYmplY3RcIiAhPSB0eXBlb2YgdCB8fCBudWxsID09PSB0IHx8IHQgaW5zdGFuY2VvZiBBcnJheSB8fCB0IGluc3RhbmNlb2YgRGF0ZSB8fCB0IGluc3RhbmNlb2Ygc3QgfHwgdCBpbnN0YW5jZW9mIFpjIHx8IHQgaW5zdGFuY2VvZiBZYyB8fCB0IGluc3RhbmNlb2YgVGMgfHwgdCBpbnN0YW5jZW9mIFhjKTtcbn1cblxuZnVuY3Rpb24gRXUodCwgZSwgbikge1xuICAgIGlmICghcHUobikgfHwgIWZ1bmN0aW9uKHQpIHtcbiAgICAgICAgcmV0dXJuIFwib2JqZWN0XCIgPT0gdHlwZW9mIHQgJiYgbnVsbCAhPT0gdCAmJiAoT2JqZWN0LmdldFByb3RvdHlwZU9mKHQpID09PSBPYmplY3QucHJvdG90eXBlIHx8IG51bGwgPT09IE9iamVjdC5nZXRQcm90b3R5cGVPZih0KSk7XG4gICAgfShuKSkge1xuICAgICAgICBjb25zdCBzID0gX2Mobik7XG4gICAgICAgIHRocm93IFwiYW4gb2JqZWN0XCIgPT09IHMgPyBlLkZhKHQgKyBcIiBhIGN1c3RvbSBvYmplY3RcIikgOiBlLkZhKHQgKyBcIiBcIiArIHMpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBIZWxwZXIgdGhhdCBjYWxscyBmcm9tRG90U2VwYXJhdGVkU3RyaW5nKCkgYnV0IHdyYXBzIGFueSBlcnJvciB0aHJvd24uXG4gKi8gZnVuY3Rpb24gVHUodCwgZSwgbikge1xuICAgIGlmICgoXG4gICAgLy8gSWYgcmVxdWlyZWQsIHJlcGxhY2UgdGhlIEZpZWxkUGF0aCBDb21wYXQgY2xhc3Mgd2l0aCB3aXRoIHRoZSBmaXJlc3RvcmUtZXhwXG4gICAgLy8gRmllbGRQYXRoLlxuICAgIGUgPSB5KGUpKSBpbnN0YW5jZW9mIEhjKSByZXR1cm4gZS5faW50ZXJuYWxQYXRoO1xuICAgIGlmIChcInN0cmluZ1wiID09IHR5cGVvZiBlKSByZXR1cm4gQXUodCwgZSk7XG4gICAgdGhyb3cgUnUoXCJGaWVsZCBwYXRoIGFyZ3VtZW50cyBtdXN0IGJlIG9mIHR5cGUgc3RyaW5nIG9yIEZpZWxkUGF0aC5cIiwgdCwgXG4gICAgLyogaGFzQ29udmVydGVyPSAqLyAhMSwgXG4gICAgLyogcGF0aD0gKi8gdm9pZCAwLCBuKTtcbn1cblxuLyoqXG4gKiBNYXRjaGVzIGFueSBjaGFyYWN0ZXJzIGluIGEgZmllbGQgcGF0aCBzdHJpbmcgdGhhdCBhcmUgcmVzZXJ2ZWQuXG4gKi8gY29uc3QgSXUgPSBuZXcgUmVnRXhwKFwiW35cXFxcKi9cXFxcW1xcXFxdXVwiKTtcblxuLyoqXG4gKiBXcmFwcyBmcm9tRG90U2VwYXJhdGVkU3RyaW5nIHdpdGggYW4gZXJyb3IgbWVzc2FnZSBhYm91dCB0aGUgbWV0aG9kIHRoYXRcbiAqIHdhcyB0aHJvd24uXG4gKiBAcGFyYW0gbWV0aG9kTmFtZSAtIFRoZSBwdWJsaWNseSB2aXNpYmxlIG1ldGhvZCBuYW1lXG4gKiBAcGFyYW0gcGF0aCAtIFRoZSBkb3Qtc2VwYXJhdGVkIHN0cmluZyBmb3JtIG9mIGEgZmllbGQgcGF0aCB3aGljaCB3aWxsIGJlXG4gKiBzcGxpdCBvbiBkb3RzLlxuICogQHBhcmFtIHRhcmdldERvYyAtIFRoZSBkb2N1bWVudCBhZ2FpbnN0IHdoaWNoIHRoZSBmaWVsZCBwYXRoIHdpbGwgYmVcbiAqIGV2YWx1YXRlZC5cbiAqLyBmdW5jdGlvbiBBdSh0LCBlLCBuKSB7XG4gICAgaWYgKGUuc2VhcmNoKEl1KSA+PSAwKSB0aHJvdyBSdShgSW52YWxpZCBmaWVsZCBwYXRoICgke2V9KS4gUGF0aHMgbXVzdCBub3QgY29udGFpbiAnficsICcqJywgJy8nLCAnWycsIG9yICddJ2AsIHQsIFxuICAgIC8qIGhhc0NvbnZlcnRlcj0gKi8gITEsIFxuICAgIC8qIHBhdGg9ICovIHZvaWQgMCwgbik7XG4gICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIG5ldyBIYyguLi5lLnNwbGl0KFwiLlwiKSkuX2ludGVybmFsUGF0aDtcbiAgICB9IGNhdGNoIChzKSB7XG4gICAgICAgIHRocm93IFJ1KGBJbnZhbGlkIGZpZWxkIHBhdGggKCR7ZX0pLiBQYXRocyBtdXN0IG5vdCBiZSBlbXB0eSwgYmVnaW4gd2l0aCAnLicsIGVuZCB3aXRoICcuJywgb3IgY29udGFpbiAnLi4nYCwgdCwgXG4gICAgICAgIC8qIGhhc0NvbnZlcnRlcj0gKi8gITEsIFxuICAgICAgICAvKiBwYXRoPSAqLyB2b2lkIDAsIG4pO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gUnUodCwgZSwgbiwgcywgaSkge1xuICAgIGNvbnN0IHIgPSBzICYmICFzLmlzRW1wdHkoKSwgbyA9IHZvaWQgMCAhPT0gaTtcbiAgICBsZXQgYSA9IGBGdW5jdGlvbiAke2V9KCkgY2FsbGVkIHdpdGggaW52YWxpZCBkYXRhYDtcbiAgICBuICYmIChhICs9IFwiICh2aWEgYHRvRmlyZXN0b3JlKClgKVwiKSwgYSArPSBcIi4gXCI7XG4gICAgbGV0IGMgPSBcIlwiO1xuICAgIHJldHVybiAociB8fCBvKSAmJiAoYyArPSBcIiAoZm91bmRcIiwgciAmJiAoYyArPSBgIGluIGZpZWxkICR7c31gKSwgbyAmJiAoYyArPSBgIGluIGRvY3VtZW50ICR7aX1gKSwgXG4gICAgYyArPSBcIilcIiksIG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgYSArIHQgKyBjKTtcbn1cblxuLyoqIENoZWNrcyBgaGF5c3RhY2tgIGlmIEZpZWxkUGF0aCBgbmVlZGxlYCBpcyBwcmVzZW50LiBSdW5zIGluIE8obikuICovIGZ1bmN0aW9uIFB1KHQsIGUpIHtcbiAgICByZXR1cm4gdC5zb21lKCh0ID0+IHQuaXNFcXVhbChlKSkpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBIGBEb2N1bWVudFNuYXBzaG90YCBjb250YWlucyBkYXRhIHJlYWQgZnJvbSBhIGRvY3VtZW50IGluIHlvdXIgRmlyZXN0b3JlXG4gKiBkYXRhYmFzZS4gVGhlIGRhdGEgY2FuIGJlIGV4dHJhY3RlZCB3aXRoIGAuZGF0YSgpYCBvciBgLmdldCg8ZmllbGQ+KWAgdG9cbiAqIGdldCBhIHNwZWNpZmljIGZpZWxkLlxuICpcbiAqIEZvciBhIGBEb2N1bWVudFNuYXBzaG90YCB0aGF0IHBvaW50cyB0byBhIG5vbi1leGlzdGluZyBkb2N1bWVudCwgYW55IGRhdGFcbiAqIGFjY2VzcyB3aWxsIHJldHVybiAndW5kZWZpbmVkJy4gWW91IGNhbiB1c2UgdGhlIGBleGlzdHMoKWAgbWV0aG9kIHRvXG4gKiBleHBsaWNpdGx5IHZlcmlmeSBhIGRvY3VtZW50J3MgZXhpc3RlbmNlLlxuICovIGNsYXNzIGJ1IHtcbiAgICAvLyBOb3RlOiBUaGlzIGNsYXNzIGlzIHN0cmlwcGVkIGRvd24gdmVyc2lvbiBvZiB0aGUgRG9jdW1lbnRTbmFwc2hvdCBpblxuICAgIC8vIHRoZSBsZWdhY3kgU0RLLiBUaGUgY2hhbmdlcyBhcmU6XG4gICAgLy8gLSBObyBzdXBwb3J0IGZvciBTbmFwc2hvdE1ldGFkYXRhLlxuICAgIC8vIC0gTm8gc3VwcG9ydCBmb3IgU25hcHNob3RPcHRpb25zLlxuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yIHByb3RlY3RlZCAqL1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIHMsIGkpIHtcbiAgICAgICAgdGhpcy5fZmlyZXN0b3JlID0gdCwgdGhpcy5fdXNlckRhdGFXcml0ZXIgPSBlLCB0aGlzLl9rZXkgPSBuLCB0aGlzLl9kb2N1bWVudCA9IHMsIFxuICAgICAgICB0aGlzLl9jb252ZXJ0ZXIgPSBpO1xuICAgIH1cbiAgICAvKiogUHJvcGVydHkgb2YgdGhlIGBEb2N1bWVudFNuYXBzaG90YCB0aGF0IHByb3ZpZGVzIHRoZSBkb2N1bWVudCdzIElELiAqLyAgICBnZXQgaWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9rZXkucGF0aC5sYXN0U2VnbWVudCgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgYERvY3VtZW50UmVmZXJlbmNlYCBmb3IgdGhlIGRvY3VtZW50IGluY2x1ZGVkIGluIHRoZSBgRG9jdW1lbnRTbmFwc2hvdGAuXG4gICAgICovICAgIGdldCByZWYoKSB7XG4gICAgICAgIHJldHVybiBuZXcgVGModGhpcy5fZmlyZXN0b3JlLCB0aGlzLl9jb252ZXJ0ZXIsIHRoaXMuX2tleSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNpZ25hbHMgd2hldGhlciBvciBub3QgdGhlIGRvY3VtZW50IGF0IHRoZSBzbmFwc2hvdCdzIGxvY2F0aW9uIGV4aXN0cy5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHRydWUgaWYgdGhlIGRvY3VtZW50IGV4aXN0cy5cbiAgICAgKi8gICAgZXhpc3RzKCkge1xuICAgICAgICByZXR1cm4gbnVsbCAhPT0gdGhpcy5fZG9jdW1lbnQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHJpZXZlcyBhbGwgZmllbGRzIGluIHRoZSBkb2N1bWVudCBhcyBhbiBgT2JqZWN0YC4gUmV0dXJucyBgdW5kZWZpbmVkYCBpZlxuICAgICAqIHRoZSBkb2N1bWVudCBkb2Vzbid0IGV4aXN0LlxuICAgICAqXG4gICAgICogQHJldHVybnMgQW4gYE9iamVjdGAgY29udGFpbmluZyBhbGwgZmllbGRzIGluIHRoZSBkb2N1bWVudCBvciBgdW5kZWZpbmVkYFxuICAgICAqIGlmIHRoZSBkb2N1bWVudCBkb2Vzbid0IGV4aXN0LlxuICAgICAqLyAgICBkYXRhKCkge1xuICAgICAgICBpZiAodGhpcy5fZG9jdW1lbnQpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9jb252ZXJ0ZXIpIHtcbiAgICAgICAgICAgICAgICAvLyBXZSBvbmx5IHdhbnQgdG8gdXNlIHRoZSBjb252ZXJ0ZXIgYW5kIGNyZWF0ZSBhIG5ldyBEb2N1bWVudFNuYXBzaG90XG4gICAgICAgICAgICAgICAgLy8gaWYgYSBjb252ZXJ0ZXIgaGFzIGJlZW4gcHJvdmlkZWQuXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IG5ldyB2dSh0aGlzLl9maXJlc3RvcmUsIHRoaXMuX3VzZXJEYXRhV3JpdGVyLCB0aGlzLl9rZXksIHRoaXMuX2RvY3VtZW50LCBcbiAgICAgICAgICAgICAgICAvKiBjb252ZXJ0ZXI9ICovIG51bGwpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jb252ZXJ0ZXIuZnJvbUZpcmVzdG9yZSh0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl91c2VyRGF0YVdyaXRlci5jb252ZXJ0VmFsdWUodGhpcy5fZG9jdW1lbnQuZGF0YS52YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0cmlldmVzIHRoZSBmaWVsZCBzcGVjaWZpZWQgYnkgYGZpZWxkUGF0aGAuIFJldHVybnMgYHVuZGVmaW5lZGAgaWYgdGhlXG4gICAgICogZG9jdW1lbnQgb3IgZmllbGQgZG9lc24ndCBleGlzdC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBmaWVsZFBhdGggLSBUaGUgcGF0aCAoZm9yIGV4YW1wbGUgJ2Zvbycgb3IgJ2Zvby5iYXInKSB0byBhIHNwZWNpZmljXG4gICAgICogZmllbGQuXG4gICAgICogQHJldHVybnMgVGhlIGRhdGEgYXQgdGhlIHNwZWNpZmllZCBmaWVsZCBsb2NhdGlvbiBvciB1bmRlZmluZWQgaWYgbm8gc3VjaFxuICAgICAqIGZpZWxkIGV4aXN0cyBpbiB0aGUgZG9jdW1lbnQuXG4gICAgICovXG4gICAgLy8gV2UgYXJlIHVzaW5nIGBhbnlgIGhlcmUgdG8gYXZvaWQgYW4gZXhwbGljaXQgY2FzdCBieSBvdXIgdXNlcnMuXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICBnZXQodCkge1xuICAgICAgICBpZiAodGhpcy5fZG9jdW1lbnQpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLl9kb2N1bWVudC5kYXRhLmZpZWxkKFZ1KFwiRG9jdW1lbnRTbmFwc2hvdC5nZXRcIiwgdCkpO1xuICAgICAgICAgICAgaWYgKG51bGwgIT09IGUpIHJldHVybiB0aGlzLl91c2VyRGF0YVdyaXRlci5jb252ZXJ0VmFsdWUoZSk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbi8qKlxuICogQSBgUXVlcnlEb2N1bWVudFNuYXBzaG90YCBjb250YWlucyBkYXRhIHJlYWQgZnJvbSBhIGRvY3VtZW50IGluIHlvdXJcbiAqIEZpcmVzdG9yZSBkYXRhYmFzZSBhcyBwYXJ0IG9mIGEgcXVlcnkuIFRoZSBkb2N1bWVudCBpcyBndWFyYW50ZWVkIHRvIGV4aXN0XG4gKiBhbmQgaXRzIGRhdGEgY2FuIGJlIGV4dHJhY3RlZCB3aXRoIGAuZGF0YSgpYCBvciBgLmdldCg8ZmllbGQ+KWAgdG8gZ2V0IGFcbiAqIHNwZWNpZmljIGZpZWxkLlxuICpcbiAqIEEgYFF1ZXJ5RG9jdW1lbnRTbmFwc2hvdGAgb2ZmZXJzIHRoZSBzYW1lIEFQSSBzdXJmYWNlIGFzIGFcbiAqIGBEb2N1bWVudFNuYXBzaG90YC4gU2luY2UgcXVlcnkgcmVzdWx0cyBjb250YWluIG9ubHkgZXhpc3RpbmcgZG9jdW1lbnRzLCB0aGVcbiAqIGBleGlzdHNgIHByb3BlcnR5IHdpbGwgYWx3YXlzIGJlIHRydWUgYW5kIGBkYXRhKClgIHdpbGwgbmV2ZXIgcmV0dXJuXG4gKiAndW5kZWZpbmVkJy5cbiAqLyBjbGFzcyB2dSBleHRlbmRzIGJ1IHtcbiAgICAvKipcbiAgICAgKiBSZXRyaWV2ZXMgYWxsIGZpZWxkcyBpbiB0aGUgZG9jdW1lbnQgYXMgYW4gYE9iamVjdGAuXG4gICAgICpcbiAgICAgKiBAb3ZlcnJpZGVcbiAgICAgKiBAcmV0dXJucyBBbiBgT2JqZWN0YCBjb250YWluaW5nIGFsbCBmaWVsZHMgaW4gdGhlIGRvY3VtZW50LlxuICAgICAqL1xuICAgIGRhdGEoKSB7XG4gICAgICAgIHJldHVybiBzdXBlci5kYXRhKCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEhlbHBlciB0aGF0IGNhbGxzIGBmcm9tRG90U2VwYXJhdGVkU3RyaW5nKClgIGJ1dCB3cmFwcyBhbnkgZXJyb3IgdGhyb3duLlxuICovIGZ1bmN0aW9uIFZ1KHQsIGUpIHtcbiAgICByZXR1cm4gXCJzdHJpbmdcIiA9PSB0eXBlb2YgZSA/IEF1KHQsIGUpIDogZSBpbnN0YW5jZW9mIEhjID8gZS5faW50ZXJuYWxQYXRoIDogZS5fZGVsZWdhdGUuX2ludGVybmFsUGF0aDtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogTWV0YWRhdGEgYWJvdXQgYSBzbmFwc2hvdCwgZGVzY3JpYmluZyB0aGUgc3RhdGUgb2YgdGhlIHNuYXBzaG90LlxuICovIGNsYXNzIFN1IHtcbiAgICAvKiogQGhpZGVjb25zdHJ1Y3RvciAqL1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5oYXNQZW5kaW5nV3JpdGVzID0gdCwgdGhpcy5mcm9tQ2FjaGUgPSBlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhpcyBgU25hcHNob3RNZXRhZGF0YWAgaXMgZXF1YWwgdG8gdGhlIHByb3ZpZGVkIG9uZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBvdGhlciAtIFRoZSBgU25hcHNob3RNZXRhZGF0YWAgdG8gY29tcGFyZSBhZ2FpbnN0LlxuICAgICAqIEByZXR1cm5zIHRydWUgaWYgdGhpcyBgU25hcHNob3RNZXRhZGF0YWAgaXMgZXF1YWwgdG8gdGhlIHByb3ZpZGVkIG9uZS5cbiAgICAgKi8gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmhhc1BlbmRpbmdXcml0ZXMgPT09IHQuaGFzUGVuZGluZ1dyaXRlcyAmJiB0aGlzLmZyb21DYWNoZSA9PT0gdC5mcm9tQ2FjaGU7XG4gICAgfVxufVxuXG4vKipcbiAqIEEgYERvY3VtZW50U25hcHNob3RgIGNvbnRhaW5zIGRhdGEgcmVhZCBmcm9tIGEgZG9jdW1lbnQgaW4geW91ciBGaXJlc3RvcmVcbiAqIGRhdGFiYXNlLiBUaGUgZGF0YSBjYW4gYmUgZXh0cmFjdGVkIHdpdGggYC5kYXRhKClgIG9yIGAuZ2V0KDxmaWVsZD4pYCB0b1xuICogZ2V0IGEgc3BlY2lmaWMgZmllbGQuXG4gKlxuICogRm9yIGEgYERvY3VtZW50U25hcHNob3RgIHRoYXQgcG9pbnRzIHRvIGEgbm9uLWV4aXN0aW5nIGRvY3VtZW50LCBhbnkgZGF0YVxuICogYWNjZXNzIHdpbGwgcmV0dXJuICd1bmRlZmluZWQnLiBZb3UgY2FuIHVzZSB0aGUgYGV4aXN0cygpYCBtZXRob2QgdG9cbiAqIGV4cGxpY2l0bHkgdmVyaWZ5IGEgZG9jdW1lbnQncyBleGlzdGVuY2UuXG4gKi8gY2xhc3MgRHUgZXh0ZW5kcyBidSB7XG4gICAgLyoqIEBoaWRlY29uc3RydWN0b3IgcHJvdGVjdGVkICovXG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcywgaSwgcikge1xuICAgICAgICBzdXBlcih0LCBlLCBuLCBzLCByKSwgdGhpcy5fZmlyZXN0b3JlID0gdCwgdGhpcy5fZmlyZXN0b3JlSW1wbCA9IHQsIHRoaXMubWV0YWRhdGEgPSBpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQcm9wZXJ0eSBvZiB0aGUgYERvY3VtZW50U25hcHNob3RgIHRoYXQgc2lnbmFscyB3aGV0aGVyIG9yIG5vdCB0aGUgZGF0YVxuICAgICAqIGV4aXN0cy4gVHJ1ZSBpZiB0aGUgZG9jdW1lbnQgZXhpc3RzLlxuICAgICAqLyAgICBleGlzdHMoKSB7XG4gICAgICAgIHJldHVybiBzdXBlci5leGlzdHMoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0cmlldmVzIGFsbCBmaWVsZHMgaW4gdGhlIGRvY3VtZW50IGFzIGFuIGBPYmplY3RgLiBSZXR1cm5zIGB1bmRlZmluZWRgIGlmXG4gICAgICogdGhlIGRvY3VtZW50IGRvZXNuJ3QgZXhpc3QuXG4gICAgICpcbiAgICAgKiBCeSBkZWZhdWx0LCBgRmllbGRWYWx1ZS5zZXJ2ZXJUaW1lc3RhbXAoKWAgdmFsdWVzIHRoYXQgaGF2ZSBub3QgeWV0IGJlZW5cbiAgICAgKiBzZXQgdG8gdGhlaXIgZmluYWwgdmFsdWUgd2lsbCBiZSByZXR1cm5lZCBhcyBgbnVsbGAuIFlvdSBjYW4gb3ZlcnJpZGVcbiAgICAgKiB0aGlzIGJ5IHBhc3NpbmcgYW4gb3B0aW9ucyBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gb3B0aW9ucyAtIEFuIG9wdGlvbnMgb2JqZWN0IHRvIGNvbmZpZ3VyZSBob3cgZGF0YSBpcyByZXRyaWV2ZWQgZnJvbVxuICAgICAqIHRoZSBzbmFwc2hvdCAoZm9yIGV4YW1wbGUgdGhlIGRlc2lyZWQgYmVoYXZpb3IgZm9yIHNlcnZlciB0aW1lc3RhbXBzIHRoYXRcbiAgICAgKiBoYXZlIG5vdCB5ZXQgYmVlbiBzZXQgdG8gdGhlaXIgZmluYWwgdmFsdWUpLlxuICAgICAqIEByZXR1cm5zIEFuIGBPYmplY3RgIGNvbnRhaW5pbmcgYWxsIGZpZWxkcyBpbiB0aGUgZG9jdW1lbnQgb3IgYHVuZGVmaW5lZGAgaWZcbiAgICAgKiB0aGUgZG9jdW1lbnQgZG9lc24ndCBleGlzdC5cbiAgICAgKi8gICAgZGF0YSh0ID0ge30pIHtcbiAgICAgICAgaWYgKHRoaXMuX2RvY3VtZW50KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fY29udmVydGVyKSB7XG4gICAgICAgICAgICAgICAgLy8gV2Ugb25seSB3YW50IHRvIHVzZSB0aGUgY29udmVydGVyIGFuZCBjcmVhdGUgYSBuZXcgRG9jdW1lbnRTbmFwc2hvdFxuICAgICAgICAgICAgICAgIC8vIGlmIGEgY29udmVydGVyIGhhcyBiZWVuIHByb3ZpZGVkLlxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBuZXcgQ3UodGhpcy5fZmlyZXN0b3JlLCB0aGlzLl91c2VyRGF0YVdyaXRlciwgdGhpcy5fa2V5LCB0aGlzLl9kb2N1bWVudCwgdGhpcy5tZXRhZGF0YSwgXG4gICAgICAgICAgICAgICAgLyogY29udmVydGVyPSAqLyBudWxsKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY29udmVydGVyLmZyb21GaXJlc3RvcmUoZSwgdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdXNlckRhdGFXcml0ZXIuY29udmVydFZhbHVlKHRoaXMuX2RvY3VtZW50LmRhdGEudmFsdWUsIHQuc2VydmVyVGltZXN0YW1wcyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0cmlldmVzIHRoZSBmaWVsZCBzcGVjaWZpZWQgYnkgYGZpZWxkUGF0aGAuIFJldHVybnMgYHVuZGVmaW5lZGAgaWYgdGhlXG4gICAgICogZG9jdW1lbnQgb3IgZmllbGQgZG9lc24ndCBleGlzdC5cbiAgICAgKlxuICAgICAqIEJ5IGRlZmF1bHQsIGEgYEZpZWxkVmFsdWUuc2VydmVyVGltZXN0YW1wKClgIHRoYXQgaGFzIG5vdCB5ZXQgYmVlbiBzZXQgdG9cbiAgICAgKiBpdHMgZmluYWwgdmFsdWUgd2lsbCBiZSByZXR1cm5lZCBhcyBgbnVsbGAuIFlvdSBjYW4gb3ZlcnJpZGUgdGhpcyBieVxuICAgICAqIHBhc3NpbmcgYW4gb3B0aW9ucyBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZmllbGRQYXRoIC0gVGhlIHBhdGggKGZvciBleGFtcGxlICdmb28nIG9yICdmb28uYmFyJykgdG8gYSBzcGVjaWZpY1xuICAgICAqIGZpZWxkLlxuICAgICAqIEBwYXJhbSBvcHRpb25zIC0gQW4gb3B0aW9ucyBvYmplY3QgdG8gY29uZmlndXJlIGhvdyB0aGUgZmllbGQgaXMgcmV0cmlldmVkXG4gICAgICogZnJvbSB0aGUgc25hcHNob3QgKGZvciBleGFtcGxlIHRoZSBkZXNpcmVkIGJlaGF2aW9yIGZvciBzZXJ2ZXIgdGltZXN0YW1wc1xuICAgICAqIHRoYXQgaGF2ZSBub3QgeWV0IGJlZW4gc2V0IHRvIHRoZWlyIGZpbmFsIHZhbHVlKS5cbiAgICAgKiBAcmV0dXJucyBUaGUgZGF0YSBhdCB0aGUgc3BlY2lmaWVkIGZpZWxkIGxvY2F0aW9uIG9yIHVuZGVmaW5lZCBpZiBubyBzdWNoXG4gICAgICogZmllbGQgZXhpc3RzIGluIHRoZSBkb2N1bWVudC5cbiAgICAgKi9cbiAgICAvLyBXZSBhcmUgdXNpbmcgYGFueWAgaGVyZSB0byBhdm9pZCBhbiBleHBsaWNpdCBjYXN0IGJ5IG91ciB1c2Vycy5cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgIGdldCh0LCBlID0ge30pIHtcbiAgICAgICAgaWYgKHRoaXMuX2RvY3VtZW50KSB7XG4gICAgICAgICAgICBjb25zdCBuID0gdGhpcy5fZG9jdW1lbnQuZGF0YS5maWVsZChWdShcIkRvY3VtZW50U25hcHNob3QuZ2V0XCIsIHQpKTtcbiAgICAgICAgICAgIGlmIChudWxsICE9PSBuKSByZXR1cm4gdGhpcy5fdXNlckRhdGFXcml0ZXIuY29udmVydFZhbHVlKG4sIGUuc2VydmVyVGltZXN0YW1wcyk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbi8qKlxuICogQSBgUXVlcnlEb2N1bWVudFNuYXBzaG90YCBjb250YWlucyBkYXRhIHJlYWQgZnJvbSBhIGRvY3VtZW50IGluIHlvdXJcbiAqIEZpcmVzdG9yZSBkYXRhYmFzZSBhcyBwYXJ0IG9mIGEgcXVlcnkuIFRoZSBkb2N1bWVudCBpcyBndWFyYW50ZWVkIHRvIGV4aXN0XG4gKiBhbmQgaXRzIGRhdGEgY2FuIGJlIGV4dHJhY3RlZCB3aXRoIGAuZGF0YSgpYCBvciBgLmdldCg8ZmllbGQ+KWAgdG8gZ2V0IGFcbiAqIHNwZWNpZmljIGZpZWxkLlxuICpcbiAqIEEgYFF1ZXJ5RG9jdW1lbnRTbmFwc2hvdGAgb2ZmZXJzIHRoZSBzYW1lIEFQSSBzdXJmYWNlIGFzIGFcbiAqIGBEb2N1bWVudFNuYXBzaG90YC4gU2luY2UgcXVlcnkgcmVzdWx0cyBjb250YWluIG9ubHkgZXhpc3RpbmcgZG9jdW1lbnRzLCB0aGVcbiAqIGBleGlzdHNgIHByb3BlcnR5IHdpbGwgYWx3YXlzIGJlIHRydWUgYW5kIGBkYXRhKClgIHdpbGwgbmV2ZXIgcmV0dXJuXG4gKiAndW5kZWZpbmVkJy5cbiAqLyBjbGFzcyBDdSBleHRlbmRzIER1IHtcbiAgICAvKipcbiAgICAgKiBSZXRyaWV2ZXMgYWxsIGZpZWxkcyBpbiB0aGUgZG9jdW1lbnQgYXMgYW4gYE9iamVjdGAuXG4gICAgICpcbiAgICAgKiBCeSBkZWZhdWx0LCBgRmllbGRWYWx1ZS5zZXJ2ZXJUaW1lc3RhbXAoKWAgdmFsdWVzIHRoYXQgaGF2ZSBub3QgeWV0IGJlZW5cbiAgICAgKiBzZXQgdG8gdGhlaXIgZmluYWwgdmFsdWUgd2lsbCBiZSByZXR1cm5lZCBhcyBgbnVsbGAuIFlvdSBjYW4gb3ZlcnJpZGVcbiAgICAgKiB0aGlzIGJ5IHBhc3NpbmcgYW4gb3B0aW9ucyBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAb3ZlcnJpZGVcbiAgICAgKiBAcGFyYW0gb3B0aW9ucyAtIEFuIG9wdGlvbnMgb2JqZWN0IHRvIGNvbmZpZ3VyZSBob3cgZGF0YSBpcyByZXRyaWV2ZWQgZnJvbVxuICAgICAqIHRoZSBzbmFwc2hvdCAoZm9yIGV4YW1wbGUgdGhlIGRlc2lyZWQgYmVoYXZpb3IgZm9yIHNlcnZlciB0aW1lc3RhbXBzIHRoYXRcbiAgICAgKiBoYXZlIG5vdCB5ZXQgYmVlbiBzZXQgdG8gdGhlaXIgZmluYWwgdmFsdWUpLlxuICAgICAqIEByZXR1cm5zIEFuIGBPYmplY3RgIGNvbnRhaW5pbmcgYWxsIGZpZWxkcyBpbiB0aGUgZG9jdW1lbnQuXG4gICAgICovXG4gICAgZGF0YSh0ID0ge30pIHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmRhdGEodCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEEgYFF1ZXJ5U25hcHNob3RgIGNvbnRhaW5zIHplcm8gb3IgbW9yZSBgRG9jdW1lbnRTbmFwc2hvdGAgb2JqZWN0c1xuICogcmVwcmVzZW50aW5nIHRoZSByZXN1bHRzIG9mIGEgcXVlcnkuIFRoZSBkb2N1bWVudHMgY2FuIGJlIGFjY2Vzc2VkIGFzIGFuXG4gKiBhcnJheSB2aWEgdGhlIGBkb2NzYCBwcm9wZXJ0eSBvciBlbnVtZXJhdGVkIHVzaW5nIHRoZSBgZm9yRWFjaGAgbWV0aG9kLiBUaGVcbiAqIG51bWJlciBvZiBkb2N1bWVudHMgY2FuIGJlIGRldGVybWluZWQgdmlhIHRoZSBgZW1wdHlgIGFuZCBgc2l6ZWBcbiAqIHByb3BlcnRpZXMuXG4gKi8gY2xhc3MgTnUge1xuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yICovXG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcykge1xuICAgICAgICB0aGlzLl9maXJlc3RvcmUgPSB0LCB0aGlzLl91c2VyRGF0YVdyaXRlciA9IGUsIHRoaXMuX3NuYXBzaG90ID0gcywgdGhpcy5tZXRhZGF0YSA9IG5ldyBTdShzLmhhc1BlbmRpbmdXcml0ZXMsIHMuZnJvbUNhY2hlKSwgXG4gICAgICAgIHRoaXMucXVlcnkgPSBuO1xuICAgIH1cbiAgICAvKiogQW4gYXJyYXkgb2YgYWxsIHRoZSBkb2N1bWVudHMgaW4gdGhlIGBRdWVyeVNuYXBzaG90YC4gKi8gICAgZ2V0IGRvY3MoKSB7XG4gICAgICAgIGNvbnN0IHQgPSBbXTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZm9yRWFjaCgoZSA9PiB0LnB1c2goZSkpKSwgdDtcbiAgICB9XG4gICAgLyoqIFRoZSBudW1iZXIgb2YgZG9jdW1lbnRzIGluIHRoZSBgUXVlcnlTbmFwc2hvdGAuICovICAgIGdldCBzaXplKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc25hcHNob3QuZG9jcy5zaXplO1xuICAgIH1cbiAgICAvKiogVHJ1ZSBpZiB0aGVyZSBhcmUgbm8gZG9jdW1lbnRzIGluIHRoZSBgUXVlcnlTbmFwc2hvdGAuICovICAgIGdldCBlbXB0eSgpIHtcbiAgICAgICAgcmV0dXJuIDAgPT09IHRoaXMuc2l6ZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRW51bWVyYXRlcyBhbGwgb2YgdGhlIGRvY3VtZW50cyBpbiB0aGUgYFF1ZXJ5U25hcHNob3RgLlxuICAgICAqXG4gICAgICogQHBhcmFtIGNhbGxiYWNrIC0gQSBjYWxsYmFjayB0byBiZSBjYWxsZWQgd2l0aCBhIGBRdWVyeURvY3VtZW50U25hcHNob3RgIGZvclxuICAgICAqIGVhY2ggZG9jdW1lbnQgaW4gdGhlIHNuYXBzaG90LlxuICAgICAqIEBwYXJhbSB0aGlzQXJnIC0gVGhlIGB0aGlzYCBiaW5kaW5nIGZvciB0aGUgY2FsbGJhY2suXG4gICAgICovICAgIGZvckVhY2godCwgZSkge1xuICAgICAgICB0aGlzLl9zbmFwc2hvdC5kb2NzLmZvckVhY2goKG4gPT4ge1xuICAgICAgICAgICAgdC5jYWxsKGUsIG5ldyBDdSh0aGlzLl9maXJlc3RvcmUsIHRoaXMuX3VzZXJEYXRhV3JpdGVyLCBuLmtleSwgbiwgbmV3IFN1KHRoaXMuX3NuYXBzaG90Lm11dGF0ZWRLZXlzLmhhcyhuLmtleSksIHRoaXMuX3NuYXBzaG90LmZyb21DYWNoZSksIHRoaXMucXVlcnkuY29udmVydGVyKSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhbiBhcnJheSBvZiB0aGUgZG9jdW1lbnRzIGNoYW5nZXMgc2luY2UgdGhlIGxhc3Qgc25hcHNob3QuIElmIHRoaXNcbiAgICAgKiBpcyB0aGUgZmlyc3Qgc25hcHNob3QsIGFsbCBkb2N1bWVudHMgd2lsbCBiZSBpbiB0aGUgbGlzdCBhcyAnYWRkZWQnXG4gICAgICogY2hhbmdlcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBvcHRpb25zIC0gYFNuYXBzaG90TGlzdGVuT3B0aW9uc2AgdGhhdCBjb250cm9sIHdoZXRoZXIgbWV0YWRhdGEtb25seVxuICAgICAqIGNoYW5nZXMgKGkuZS4gb25seSBgRG9jdW1lbnRTbmFwc2hvdC5tZXRhZGF0YWAgY2hhbmdlZCkgc2hvdWxkIHRyaWdnZXJcbiAgICAgKiBzbmFwc2hvdCBldmVudHMuXG4gICAgICovICAgIGRvY0NoYW5nZXModCA9IHt9KSB7XG4gICAgICAgIGNvbnN0IGUgPSAhIXQuaW5jbHVkZU1ldGFkYXRhQ2hhbmdlcztcbiAgICAgICAgaWYgKGUgJiYgdGhpcy5fc25hcHNob3QuZXhjbHVkZXNNZXRhZGF0YUNoYW5nZXMpIHRocm93IG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgXCJUbyBpbmNsdWRlIG1ldGFkYXRhIGNoYW5nZXMgd2l0aCB5b3VyIGRvY3VtZW50IGNoYW5nZXMsIHlvdSBtdXN0IGFsc28gcGFzcyB7IGluY2x1ZGVNZXRhZGF0YUNoYW5nZXM6dHJ1ZSB9IHRvIG9uU25hcHNob3QoKS5cIik7XG4gICAgICAgIHJldHVybiB0aGlzLl9jYWNoZWRDaGFuZ2VzICYmIHRoaXMuX2NhY2hlZENoYW5nZXNJbmNsdWRlTWV0YWRhdGFDaGFuZ2VzID09PSBlIHx8ICh0aGlzLl9jYWNoZWRDaGFuZ2VzID0gXG4gICAgICAgIC8qKiBDYWxjdWxhdGVzIHRoZSBhcnJheSBvZiBgRG9jdW1lbnRDaGFuZ2VgcyBmb3IgYSBnaXZlbiBgVmlld1NuYXBzaG90YC4gKi9cbiAgICAgICAgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgaWYgKHQuX3NuYXBzaG90Lm9sZERvY3MuaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICAgICAgbGV0IGUgPSAwO1xuICAgICAgICAgICAgICAgIHJldHVybiB0Ll9zbmFwc2hvdC5kb2NDaGFuZ2VzLm1hcCgobiA9PiAoe1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImFkZGVkXCIsXG4gICAgICAgICAgICAgICAgICAgIGRvYzogbmV3IEN1KHQuX2ZpcmVzdG9yZSwgdC5fdXNlckRhdGFXcml0ZXIsIG4uZG9jLmtleSwgbi5kb2MsIG5ldyBTdSh0Ll9zbmFwc2hvdC5tdXRhdGVkS2V5cy5oYXMobi5kb2Mua2V5KSwgdC5fc25hcHNob3QuZnJvbUNhY2hlKSwgdC5xdWVyeS5jb252ZXJ0ZXIpLFxuICAgICAgICAgICAgICAgICAgICBvbGRJbmRleDogLTEsXG4gICAgICAgICAgICAgICAgICAgIG5ld0luZGV4OiBlKytcbiAgICAgICAgICAgICAgICB9KSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIC8vIEEgYERvY3VtZW50U2V0YCB0aGF0IGlzIHVwZGF0ZWQgaW5jcmVtZW50YWxseSBhcyBjaGFuZ2VzIGFyZSBhcHBsaWVkIHRvIHVzZVxuICAgICAgICAgICAgICAgIC8vIHRvIGxvb2t1cCB0aGUgaW5kZXggb2YgYSBkb2N1bWVudC5cbiAgICAgICAgICAgICAgICBsZXQgbiA9IHQuX3NuYXBzaG90Lm9sZERvY3M7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHQuX3NuYXBzaG90LmRvY0NoYW5nZXMuZmlsdGVyKCh0ID0+IGUgfHwgMyAvKiBNZXRhZGF0YSAqLyAhPT0gdC50eXBlKSkubWFwKChlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcyA9IG5ldyBDdSh0Ll9maXJlc3RvcmUsIHQuX3VzZXJEYXRhV3JpdGVyLCBlLmRvYy5rZXksIGUuZG9jLCBuZXcgU3UodC5fc25hcHNob3QubXV0YXRlZEtleXMuaGFzKGUuZG9jLmtleSksIHQuX3NuYXBzaG90LmZyb21DYWNoZSksIHQucXVlcnkuY29udmVydGVyKTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGkgPSAtMSwgciA9IC0xO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMCAvKiBBZGRlZCAqLyAhPT0gZS50eXBlICYmIChpID0gbi5pbmRleE9mKGUuZG9jLmtleSksIG4gPSBuLmRlbGV0ZShlLmRvYy5rZXkpKSwgXG4gICAgICAgICAgICAgICAgICAgIDEgLyogUmVtb3ZlZCAqLyAhPT0gZS50eXBlICYmIChuID0gbi5hZGQoZS5kb2MpLCByID0gbi5pbmRleE9mKGUuZG9jLmtleSkpLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiB4dShlLnR5cGUpLFxuICAgICAgICAgICAgICAgICAgICAgICAgZG9jOiBzLFxuICAgICAgICAgICAgICAgICAgICAgICAgb2xkSW5kZXg6IGksXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdJbmRleDogclxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSh0aGlzLCBlKSwgdGhpcy5fY2FjaGVkQ2hhbmdlc0luY2x1ZGVNZXRhZGF0YUNoYW5nZXMgPSBlKSwgdGhpcy5fY2FjaGVkQ2hhbmdlcztcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHh1KHQpIHtcbiAgICBzd2l0Y2ggKHQpIHtcbiAgICAgIGNhc2UgMCAvKiBBZGRlZCAqLyA6XG4gICAgICAgIHJldHVybiBcImFkZGVkXCI7XG5cbiAgICAgIGNhc2UgMiAvKiBNb2RpZmllZCAqLyA6XG4gICAgICBjYXNlIDMgLyogTWV0YWRhdGEgKi8gOlxuICAgICAgICByZXR1cm4gXCJtb2RpZmllZFwiO1xuXG4gICAgICBjYXNlIDEgLyogUmVtb3ZlZCAqLyA6XG4gICAgICAgIHJldHVybiBcInJlbW92ZWRcIjtcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIE0oKTtcbiAgICB9XG59XG5cbi8vIFRPRE8oZmlyZXN0b3JlZXhwKTogQWRkIHRlc3RzIGZvciBzbmFwc2hvdEVxdWFsIHdpdGggZGlmZmVyZW50IHNuYXBzaG90XG4vLyBtZXRhZGF0YVxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgdGhlIHByb3ZpZGVkIHNuYXBzaG90cyBhcmUgZXF1YWwuXG4gKlxuICogQHBhcmFtIGxlZnQgLSBBIHNuYXBzaG90IHRvIGNvbXBhcmUuXG4gKiBAcGFyYW0gcmlnaHQgLSBBIHNuYXBzaG90IHRvIGNvbXBhcmUuXG4gKiBAcmV0dXJucyB0cnVlIGlmIHRoZSBzbmFwc2hvdHMgYXJlIGVxdWFsLlxuICovIGZ1bmN0aW9uIGt1KHQsIGUpIHtcbiAgICByZXR1cm4gdCBpbnN0YW5jZW9mIER1ICYmIGUgaW5zdGFuY2VvZiBEdSA/IHQuX2ZpcmVzdG9yZSA9PT0gZS5fZmlyZXN0b3JlICYmIHQuX2tleS5pc0VxdWFsKGUuX2tleSkgJiYgKG51bGwgPT09IHQuX2RvY3VtZW50ID8gbnVsbCA9PT0gZS5fZG9jdW1lbnQgOiB0Ll9kb2N1bWVudC5pc0VxdWFsKGUuX2RvY3VtZW50KSkgJiYgdC5fY29udmVydGVyID09PSBlLl9jb252ZXJ0ZXIgOiB0IGluc3RhbmNlb2YgTnUgJiYgZSBpbnN0YW5jZW9mIE51ICYmICh0Ll9maXJlc3RvcmUgPT09IGUuX2ZpcmVzdG9yZSAmJiBWYyh0LnF1ZXJ5LCBlLnF1ZXJ5KSAmJiB0Lm1ldGFkYXRhLmlzRXF1YWwoZS5tZXRhZGF0YSkgJiYgdC5fc25hcHNob3QuaXNFcXVhbChlLl9zbmFwc2hvdCkpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBmdW5jdGlvbiAkdSh0KSB7XG4gICAgaWYgKF9lKHQpICYmIDAgPT09IHQuZXhwbGljaXRPcmRlckJ5Lmxlbmd0aCkgdGhyb3cgbmV3IEsocS5VTklNUExFTUVOVEVELCBcImxpbWl0VG9MYXN0KCkgcXVlcmllcyByZXF1aXJlIHNwZWNpZnlpbmcgYXQgbGVhc3Qgb25lIG9yZGVyQnkoKSBjbGF1c2VcIik7XG59XG5cbi8qKlxuICogQSBgUXVlcnlDb25zdHJhaW50YCBpcyB1c2VkIHRvIG5hcnJvdyB0aGUgc2V0IG9mIGRvY3VtZW50cyByZXR1cm5lZCBieSBhXG4gKiBGaXJlc3RvcmUgcXVlcnkuIGBRdWVyeUNvbnN0cmFpbnRgcyBhcmUgY3JlYXRlZCBieSBpbnZva2luZyB7QGxpbmsgd2hlcmV9LFxuICoge0BsaW5rIG9yZGVyQnl9LCB7QGxpbmsgKHN0YXJ0QXQ6MSl9LCB7QGxpbmsgKHN0YXJ0QWZ0ZXI6MSl9LCB7QGxpbmtcbiAqIGVuZEJlZm9yZToxfSwge0BsaW5rIChlbmRBdDoxKX0sIHtAbGluayBsaW1pdH0gb3Ige0BsaW5rIGxpbWl0VG9MYXN0fSBhbmRcbiAqIGNhbiB0aGVuIGJlIHBhc3NlZCB0byB7QGxpbmsgcXVlcnl9IHRvIGNyZWF0ZSBhIG5ldyBxdWVyeSBpbnN0YW5jZSB0aGF0XG4gKiBhbHNvIGNvbnRhaW5zIHRoaXMgYFF1ZXJ5Q29uc3RyYWludGAuXG4gKi8gY2xhc3MgT3Uge31cblxuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IGltbXV0YWJsZSBpbnN0YW5jZSBvZiB7QGxpbmsgUXVlcnl9IHRoYXQgaXMgZXh0ZW5kZWQgdG8gYWxzbyBpbmNsdWRlXG4gKiBhZGRpdGlvbmFsIHF1ZXJ5IGNvbnN0cmFpbnRzLlxuICpcbiAqIEBwYXJhbSBxdWVyeSAtIFRoZSB7QGxpbmsgUXVlcnl9IGluc3RhbmNlIHRvIHVzZSBhcyBhIGJhc2UgZm9yIHRoZSBuZXcgY29uc3RyYWludHMuXG4gKiBAcGFyYW0gcXVlcnlDb25zdHJhaW50cyAtIFRoZSBsaXN0IG9mIHtAbGluayBRdWVyeUNvbnN0cmFpbnR9cyB0byBhcHBseS5cbiAqIEB0aHJvd3MgaWYgYW55IG9mIHRoZSBwcm92aWRlZCBxdWVyeSBjb25zdHJhaW50cyBjYW5ub3QgYmUgY29tYmluZWQgd2l0aCB0aGVcbiAqIGV4aXN0aW5nIG9yIG5ldyBjb25zdHJhaW50cy5cbiAqLyBmdW5jdGlvbiBGdSh0LCAuLi5lKSB7XG4gICAgZm9yIChjb25zdCBuIG9mIGUpIHQgPSBuLl9hcHBseSh0KTtcbiAgICByZXR1cm4gdDtcbn1cblxuY2xhc3MgTXUgZXh0ZW5kcyBPdSB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbikge1xuICAgICAgICBzdXBlcigpLCB0aGlzLkthID0gdCwgdGhpcy5qYSA9IGUsIHRoaXMuUWEgPSBuLCB0aGlzLnR5cGUgPSBcIndoZXJlXCI7XG4gICAgfVxuICAgIF9hcHBseSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBvdSh0LmZpcmVzdG9yZSksIG4gPSBmdW5jdGlvbih0LCBlLCBuLCBzLCBpLCByLCBvKSB7XG4gICAgICAgICAgICBsZXQgYTtcbiAgICAgICAgICAgIGlmIChpLmlzS2V5RmllbGQoKSkge1xuICAgICAgICAgICAgICAgIGlmIChcImFycmF5LWNvbnRhaW5zXCIgLyogQVJSQVlfQ09OVEFJTlMgKi8gPT09IHIgfHwgXCJhcnJheS1jb250YWlucy1hbnlcIiAvKiBBUlJBWV9DT05UQUlOU19BTlkgKi8gPT09IHIpIHRocm93IG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgYEludmFsaWQgUXVlcnkuIFlvdSBjYW4ndCBwZXJmb3JtICcke3J9JyBxdWVyaWVzIG9uIEZpZWxkUGF0aC5kb2N1bWVudElkKCkuYCk7XG4gICAgICAgICAgICAgICAgaWYgKFwiaW5cIiAvKiBJTiAqLyA9PT0gciB8fCBcIm5vdC1pblwiIC8qIE5PVF9JTiAqLyA9PT0gcikge1xuICAgICAgICAgICAgICAgICAgICBadShvLCByKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgbykgZS5wdXNoKFh1KHMsIHQsIG4pKTtcbiAgICAgICAgICAgICAgICAgICAgYSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFycmF5VmFsdWU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXM6IGVcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgYSA9IFh1KHMsIHQsIG8pO1xuICAgICAgICAgICAgfSBlbHNlIFwiaW5cIiAvKiBJTiAqLyAhPT0gciAmJiBcIm5vdC1pblwiIC8qIE5PVF9JTiAqLyAhPT0gciAmJiBcImFycmF5LWNvbnRhaW5zLWFueVwiIC8qIEFSUkFZX0NPTlRBSU5TX0FOWSAqLyAhPT0gciB8fCBadShvLCByKSwgXG4gICAgICAgICAgICBhID0gbXUobiwgZSwgbywgXG4gICAgICAgICAgICAvKiBhbGxvd0FycmF5cz0gKi8gXCJpblwiIC8qIElOICovID09PSByIHx8IFwibm90LWluXCIgLyogTk9UX0lOICovID09PSByKTtcbiAgICAgICAgICAgIGNvbnN0IGMgPSBIdC5jcmVhdGUoaSwgciwgYSk7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgICAgIGlmIChlLnYoKSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gZ2UodCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChudWxsICE9PSBuICYmICFuLmlzRXF1YWwoZS5maWVsZCkpIHRocm93IG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgYEludmFsaWQgcXVlcnkuIEFsbCB3aGVyZSBmaWx0ZXJzIHdpdGggYW4gaW5lcXVhbGl0eSAoPCwgPD0sICE9LCBub3QtaW4sID4sIG9yID49KSBtdXN0IGJlIG9uIHRoZSBzYW1lIGZpZWxkLiBCdXQgeW91IGhhdmUgaW5lcXVhbGl0eSBmaWx0ZXJzIG9uICcke24udG9TdHJpbmcoKX0nIGFuZCAnJHtlLmZpZWxkLnRvU3RyaW5nKCl9J2ApO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzID0gbWUodCk7XG4gICAgICAgICAgICAgICAgICAgIG51bGwgIT09IHMgJiYgdGgodCwgZS5maWVsZCwgcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbiBvZiB0LmZpbHRlcnMpIGlmIChlLmluZGV4T2Yobi5vcCkgPj0gMCkgcmV0dXJuIG4ub3A7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgIH0odCwgXG4gICAgICAgICAgICAgICAgLyoqXG4gKiBHaXZlbiBhbiBvcGVyYXRvciwgcmV0dXJucyB0aGUgc2V0IG9mIG9wZXJhdG9ycyB0aGF0IGNhbm5vdCBiZSB1c2VkIHdpdGggaXQuXG4gKlxuICogT3BlcmF0b3JzIGluIGEgcXVlcnkgbXVzdCBhZGhlcmUgdG8gdGhlIGZvbGxvd2luZyBzZXQgb2YgcnVsZXM6XG4gKiAxLiBPbmx5IG9uZSBhcnJheSBvcGVyYXRvciBpcyBhbGxvd2VkLlxuICogMi4gT25seSBvbmUgZGlzanVuY3RpdmUgb3BlcmF0b3IgaXMgYWxsb3dlZC5cbiAqIDMuIGBOT1RfRVFVQUxgIGNhbm5vdCBiZSB1c2VkIHdpdGggYW5vdGhlciBgTk9UX0VRVUFMYCBvcGVyYXRvci5cbiAqIDQuIGBOT1RfSU5gIGNhbm5vdCBiZSB1c2VkIHdpdGggYXJyYXksIGRpc2p1bmN0aXZlLCBvciBgTk9UX0VRVUFMYCBvcGVyYXRvcnMuXG4gKlxuICogQXJyYXkgb3BlcmF0b3JzOiBgQVJSQVlfQ09OVEFJTlNgLCBgQVJSQVlfQ09OVEFJTlNfQU5ZYFxuICogRGlzanVuY3RpdmUgb3BlcmF0b3JzOiBgSU5gLCBgQVJSQVlfQ09OVEFJTlNfQU5ZYCwgYE5PVF9JTmBcbiAqL1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoICh0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIiE9XCIgLyogTk9UX0VRVUFMICovIDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbIFwiIT1cIiAvKiBOT1RfRVFVQUwgKi8gLCBcIm5vdC1pblwiIC8qIE5PVF9JTiAqLyBdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImFycmF5LWNvbnRhaW5zXCIgLyogQVJSQVlfQ09OVEFJTlMgKi8gOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsgXCJhcnJheS1jb250YWluc1wiIC8qIEFSUkFZX0NPTlRBSU5TICovICwgXCJhcnJheS1jb250YWlucy1hbnlcIiAvKiBBUlJBWV9DT05UQUlOU19BTlkgKi8gLCBcIm5vdC1pblwiIC8qIE5PVF9JTiAqLyBdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImluXCIgLyogSU4gKi8gOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsgXCJhcnJheS1jb250YWlucy1hbnlcIiAvKiBBUlJBWV9DT05UQUlOU19BTlkgKi8gLCBcImluXCIgLyogSU4gKi8gLCBcIm5vdC1pblwiIC8qIE5PVF9JTiAqLyBdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImFycmF5LWNvbnRhaW5zLWFueVwiIC8qIEFSUkFZX0NPTlRBSU5TX0FOWSAqLyA6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWyBcImFycmF5LWNvbnRhaW5zXCIgLyogQVJSQVlfQ09OVEFJTlMgKi8gLCBcImFycmF5LWNvbnRhaW5zLWFueVwiIC8qIEFSUkFZX0NPTlRBSU5TX0FOWSAqLyAsIFwiaW5cIiAvKiBJTiAqLyAsIFwibm90LWluXCIgLyogTk9UX0lOICovIF07XG5cbiAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwibm90LWluXCIgLyogTk9UX0lOICovIDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbIFwiYXJyYXktY29udGFpbnNcIiAvKiBBUlJBWV9DT05UQUlOUyAqLyAsIFwiYXJyYXktY29udGFpbnMtYW55XCIgLyogQVJSQVlfQ09OVEFJTlNfQU5ZICovICwgXCJpblwiIC8qIElOICovICwgXCJub3QtaW5cIiAvKiBOT1RfSU4gKi8gLCBcIiE9XCIgLyogTk9UX0VRVUFMICovIF07XG5cbiAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfShlLm9wKSk7XG4gICAgICAgICAgICAgICAgaWYgKG51bGwgIT09IG4pIFxuICAgICAgICAgICAgICAgIC8vIFNwZWNpYWwgY2FzZSB3aGVuIGl0J3MgYSBkdXBsaWNhdGUgb3AgdG8gZ2l2ZSBhIHNsaWdodGx5IGNsZWFyZXIgZXJyb3IgbWVzc2FnZS5cbiAgICAgICAgICAgICAgICB0aHJvdyBuID09PSBlLm9wID8gbmV3IEsocS5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBxdWVyeS4gWW91IGNhbm5vdCB1c2UgbW9yZSB0aGFuIG9uZSAnJHtlLm9wLnRvU3RyaW5nKCl9JyBmaWx0ZXIuYCkgOiBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIHF1ZXJ5LiBZb3UgY2Fubm90IHVzZSAnJHtlLm9wLnRvU3RyaW5nKCl9JyBmaWx0ZXJzIHdpdGggJyR7bi50b1N0cmluZygpfScgZmlsdGVycy5gKTtcbiAgICAgICAgICAgIH0odCwgYyksIGM7XG4gICAgICAgIH0odC5fcXVlcnksIFwid2hlcmVcIiwgZSwgdC5maXJlc3RvcmUuX2RhdGFiYXNlSWQsIHRoaXMuS2EsIHRoaXMuamEsIHRoaXMuUWEpO1xuICAgICAgICByZXR1cm4gbmV3IEljKHQuZmlyZXN0b3JlLCB0LmNvbnZlcnRlciwgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgY29uc3QgbiA9IHQuZmlsdGVycy5jb25jYXQoWyBlIF0pO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBsZSh0LnBhdGgsIHQuY29sbGVjdGlvbkdyb3VwLCB0LmV4cGxpY2l0T3JkZXJCeS5zbGljZSgpLCBuLCB0LmxpbWl0LCB0LmxpbWl0VHlwZSwgdC5zdGFydEF0LCB0LmVuZEF0KTtcbiAgICAgICAgfSh0Ll9xdWVyeSwgbikpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEge0BsaW5rIFF1ZXJ5Q29uc3RyYWludH0gdGhhdCBlbmZvcmNlcyB0aGF0IGRvY3VtZW50cyBtdXN0IGNvbnRhaW4gdGhlXG4gKiBzcGVjaWZpZWQgZmllbGQgYW5kIHRoYXQgdGhlIHZhbHVlIHNob3VsZCBzYXRpc2Z5IHRoZSByZWxhdGlvbiBjb25zdHJhaW50XG4gKiBwcm92aWRlZC5cbiAqXG4gKiBAcGFyYW0gZmllbGRQYXRoIC0gVGhlIHBhdGggdG8gY29tcGFyZVxuICogQHBhcmFtIG9wU3RyIC0gVGhlIG9wZXJhdGlvbiBzdHJpbmcgKGUuZyBcIiZsdDtcIiwgXCImbHQ7PVwiLCBcIj09XCIsIFwiJmx0O1wiLFxuICogICBcIiZsdDs9XCIsIFwiIT1cIikuXG4gKiBAcGFyYW0gdmFsdWUgLSBUaGUgdmFsdWUgZm9yIGNvbXBhcmlzb25cbiAqIEByZXR1cm5zIFRoZSBjcmVhdGVkIHtAbGluayBRdWVyeX0uXG4gKi8gZnVuY3Rpb24gTHUodCwgZSwgbikge1xuICAgIGNvbnN0IHMgPSBlLCBpID0gVnUoXCJ3aGVyZVwiLCB0KTtcbiAgICByZXR1cm4gbmV3IE11KGksIHMsIG4pO1xufVxuXG5jbGFzcyBCdSBleHRlbmRzIE91IHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMuS2EgPSB0LCB0aGlzLldhID0gZSwgdGhpcy50eXBlID0gXCJvcmRlckJ5XCI7XG4gICAgfVxuICAgIF9hcHBseSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBmdW5jdGlvbih0LCBlLCBuKSB7XG4gICAgICAgICAgICBpZiAobnVsbCAhPT0gdC5zdGFydEF0KSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIFwiSW52YWxpZCBxdWVyeS4gWW91IG11c3Qgbm90IGNhbGwgc3RhcnRBdCgpIG9yIHN0YXJ0QWZ0ZXIoKSBiZWZvcmUgY2FsbGluZyBvcmRlckJ5KCkuXCIpO1xuICAgICAgICAgICAgaWYgKG51bGwgIT09IHQuZW5kQXQpIHRocm93IG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgXCJJbnZhbGlkIHF1ZXJ5LiBZb3UgbXVzdCBub3QgY2FsbCBlbmRBdCgpIG9yIGVuZEJlZm9yZSgpIGJlZm9yZSBjYWxsaW5nIG9yZGVyQnkoKS5cIik7XG4gICAgICAgICAgICBjb25zdCBzID0gbmV3IGFlKGUsIG4pO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgICAgICBpZiAobnVsbCA9PT0gbWUodCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyBpcyB0aGUgZmlyc3Qgb3JkZXIgYnkuIEl0IG11c3QgbWF0Y2ggYW55IGluZXF1YWxpdHkuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBnZSh0KTtcbiAgICAgICAgICAgICAgICAgICAgbnVsbCAhPT0gbiAmJiB0aCh0LCBuLCBlLmZpZWxkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KHQsIHMpLCBzO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICogQ3JlYXRlIGEgYEJvdW5kYCBmcm9tIGEgcXVlcnkgYW5kIGEgZG9jdW1lbnQuXG4gKlxuICogTm90ZSB0aGF0IHRoZSBgQm91bmRgIHdpbGwgYWx3YXlzIGluY2x1ZGUgdGhlIGtleSBvZiB0aGUgZG9jdW1lbnRcbiAqIGFuZCBzbyBvbmx5IHRoZSBwcm92aWRlZCBkb2N1bWVudCB3aWxsIGNvbXBhcmUgZXF1YWwgdG8gdGhlIHJldHVybmVkXG4gKiBwb3NpdGlvbi5cbiAqXG4gKiBXaWxsIHRocm93IGlmIHRoZSBkb2N1bWVudCBkb2VzIG5vdCBjb250YWluIGFsbCBmaWVsZHMgb2YgdGhlIG9yZGVyIGJ5XG4gKiBvZiB0aGUgcXVlcnkgb3IgaWYgYW55IG9mIHRoZSBmaWVsZHMgaW4gdGhlIG9yZGVyIGJ5IGFyZSBhbiB1bmNvbW1pdHRlZFxuICogc2VydmVyIHRpbWVzdGFtcC5cbiAqLyAodC5fcXVlcnksIHRoaXMuS2EsIHRoaXMuV2EpO1xuICAgICAgICByZXR1cm4gbmV3IEljKHQuZmlyZXN0b3JlLCB0LmNvbnZlcnRlciwgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgLy8gVE9ETyhkaW1vbmQpOiB2YWxpZGF0ZSB0aGF0IG9yZGVyQnkgZG9lcyBub3QgbGlzdCB0aGUgc2FtZSBrZXkgdHdpY2UuXG4gICAgICAgICAgICBjb25zdCBuID0gdC5leHBsaWNpdE9yZGVyQnkuY29uY2F0KFsgZSBdKTtcbiAgICAgICAgICAgIHJldHVybiBuZXcgbGUodC5wYXRoLCB0LmNvbGxlY3Rpb25Hcm91cCwgbiwgdC5maWx0ZXJzLnNsaWNlKCksIHQubGltaXQsIHQubGltaXRUeXBlLCB0LnN0YXJ0QXQsIHQuZW5kQXQpO1xuICAgICAgICB9KHQuX3F1ZXJ5LCBlKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYSB7QGxpbmsgUXVlcnlDb25zdHJhaW50fSB0aGF0IHNvcnRzIHRoZSBxdWVyeSByZXN1bHQgYnkgdGhlXG4gKiBzcGVjaWZpZWQgZmllbGQsIG9wdGlvbmFsbHkgaW4gZGVzY2VuZGluZyBvcmRlciBpbnN0ZWFkIG9mIGFzY2VuZGluZy5cbiAqXG4gKiBAcGFyYW0gZmllbGRQYXRoIC0gVGhlIGZpZWxkIHRvIHNvcnQgYnkuXG4gKiBAcGFyYW0gZGlyZWN0aW9uU3RyIC0gT3B0aW9uYWwgZGlyZWN0aW9uIHRvIHNvcnQgYnkgKCdhc2MnIG9yICdkZXNjJykuIElmXG4gKiBub3Qgc3BlY2lmaWVkLCBvcmRlciB3aWxsIGJlIGFzY2VuZGluZy5cbiAqIEByZXR1cm5zIFRoZSBjcmVhdGVkIHtAbGluayBRdWVyeX0uXG4gKi8gZnVuY3Rpb24gVXUodCwgZSA9IFwiYXNjXCIpIHtcbiAgICBjb25zdCBuID0gZSwgcyA9IFZ1KFwib3JkZXJCeVwiLCB0KTtcbiAgICByZXR1cm4gbmV3IEJ1KHMsIG4pO1xufVxuXG5jbGFzcyBxdSBleHRlbmRzIE91IHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMudHlwZSA9IHQsIHRoaXMuR2EgPSBlLCB0aGlzLnphID0gbjtcbiAgICB9XG4gICAgX2FwcGx5KHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBJYyh0LmZpcmVzdG9yZSwgdC5jb252ZXJ0ZXIsIFRlKHQuX3F1ZXJ5LCB0aGlzLkdhLCB0aGlzLnphKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYSB7QGxpbmsgUXVlcnlDb25zdHJhaW50fSB0aGF0IG9ubHkgcmV0dXJucyB0aGUgZmlyc3QgbWF0Y2hpbmcgZG9jdW1lbnRzLlxuICpcbiAqIEBwYXJhbSBsaW1pdCAtIFRoZSBtYXhpbXVtIG51bWJlciBvZiBpdGVtcyB0byByZXR1cm4uXG4gKiBAcmV0dXJucyBUaGUgY3JlYXRlZCB7QGxpbmsgUXVlcnl9LlxuICovIGZ1bmN0aW9uIEt1KHQpIHtcbiAgICByZXR1cm4gZ2MoXCJsaW1pdFwiLCB0KSwgbmV3IHF1KFwibGltaXRcIiwgdCwgXCJGXCIgLyogRmlyc3QgKi8pO1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSB7QGxpbmsgUXVlcnlDb25zdHJhaW50fSB0aGF0IG9ubHkgcmV0dXJucyB0aGUgbGFzdCBtYXRjaGluZyBkb2N1bWVudHMuXG4gKlxuICogWW91IG11c3Qgc3BlY2lmeSBhdCBsZWFzdCBvbmUgYG9yZGVyQnlgIGNsYXVzZSBmb3IgYGxpbWl0VG9MYXN0YCBxdWVyaWVzLFxuICogb3RoZXJ3aXNlIGFuIGV4Y2VwdGlvbiB3aWxsIGJlIHRocm93biBkdXJpbmcgZXhlY3V0aW9uLlxuICpcbiAqIEBwYXJhbSBsaW1pdCAtIFRoZSBtYXhpbXVtIG51bWJlciBvZiBpdGVtcyB0byByZXR1cm4uXG4gKiBAcmV0dXJucyBUaGUgY3JlYXRlZCB7QGxpbmsgUXVlcnl9LlxuICovIGZ1bmN0aW9uIGp1KHQpIHtcbiAgICByZXR1cm4gZ2MoXCJsaW1pdFRvTGFzdFwiLCB0KSwgbmV3IHF1KFwibGltaXRUb0xhc3RcIiwgdCwgXCJMXCIgLyogTGFzdCAqLyk7XG59XG5cbmNsYXNzIFF1IGV4dGVuZHMgT3Uge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4pIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy50eXBlID0gdCwgdGhpcy5IYSA9IGUsIHRoaXMuSmEgPSBuO1xuICAgIH1cbiAgICBfYXBwbHkodCkge1xuICAgICAgICBjb25zdCBlID0gWXUodCwgdGhpcy50eXBlLCB0aGlzLkhhLCB0aGlzLkphKTtcbiAgICAgICAgcmV0dXJuIG5ldyBJYyh0LmZpcmVzdG9yZSwgdC5jb252ZXJ0ZXIsIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgbGUodC5wYXRoLCB0LmNvbGxlY3Rpb25Hcm91cCwgdC5leHBsaWNpdE9yZGVyQnkuc2xpY2UoKSwgdC5maWx0ZXJzLnNsaWNlKCksIHQubGltaXQsIHQubGltaXRUeXBlLCBlLCB0LmVuZEF0KTtcbiAgICAgICAgfSh0Ll9xdWVyeSwgZSkpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gV3UoLi4udCkge1xuICAgIHJldHVybiBuZXcgUXUoXCJzdGFydEF0XCIsIHQsIC8qYmVmb3JlPSovICEwKTtcbn1cblxuZnVuY3Rpb24gR3UoLi4udCkge1xuICAgIHJldHVybiBuZXcgUXUoXCJzdGFydEFmdGVyXCIsIHQsIFxuICAgIC8qYmVmb3JlPSovICExKTtcbn1cblxuY2xhc3MgenUgZXh0ZW5kcyBPdSB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbikge1xuICAgICAgICBzdXBlcigpLCB0aGlzLnR5cGUgPSB0LCB0aGlzLkhhID0gZSwgdGhpcy5KYSA9IG47XG4gICAgfVxuICAgIF9hcHBseSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBZdSh0LCB0aGlzLnR5cGUsIHRoaXMuSGEsIHRoaXMuSmEpO1xuICAgICAgICByZXR1cm4gbmV3IEljKHQuZmlyZXN0b3JlLCB0LmNvbnZlcnRlciwgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBsZSh0LnBhdGgsIHQuY29sbGVjdGlvbkdyb3VwLCB0LmV4cGxpY2l0T3JkZXJCeS5zbGljZSgpLCB0LmZpbHRlcnMuc2xpY2UoKSwgdC5saW1pdCwgdC5saW1pdFR5cGUsIHQuc3RhcnRBdCwgZSk7XG4gICAgICAgIH0odC5fcXVlcnksIGUpKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIEh1KC4uLnQpIHtcbiAgICByZXR1cm4gbmV3IHp1KFwiZW5kQmVmb3JlXCIsIHQsIC8qYmVmb3JlPSovICEwKTtcbn1cblxuZnVuY3Rpb24gSnUoLi4udCkge1xuICAgIHJldHVybiBuZXcgenUoXCJlbmRBdFwiLCB0LCAvKmJlZm9yZT0qLyAhMSk7XG59XG5cbi8qKiBIZWxwZXIgZnVuY3Rpb24gdG8gY3JlYXRlIGEgYm91bmQgZnJvbSBhIGRvY3VtZW50IG9yIGZpZWxkcyAqLyBmdW5jdGlvbiBZdSh0LCBlLCBuLCBzKSB7XG4gICAgaWYgKG5bMF0gPSB5KG5bMF0pLCBuWzBdIGluc3RhbmNlb2YgYnUpIHJldHVybiBmdW5jdGlvbih0LCBlLCBuLCBzLCBpKSB7XG4gICAgICAgIGlmICghcykgdGhyb3cgbmV3IEsocS5OT1RfRk9VTkQsIGBDYW4ndCB1c2UgYSBEb2N1bWVudFNuYXBzaG90IHRoYXQgZG9lc24ndCBleGlzdCBmb3IgJHtufSgpLmApO1xuICAgICAgICBjb25zdCByID0gW107XG4gICAgICAgIC8vIEJlY2F1c2UgcGVvcGxlIGV4cGVjdCB0byBjb250aW51ZS9lbmQgYSBxdWVyeSBhdCB0aGUgZXhhY3QgZG9jdW1lbnRcbiAgICAgICAgLy8gcHJvdmlkZWQsIHdlIG5lZWQgdG8gdXNlIHRoZSBpbXBsaWNpdCBzb3J0IG9yZGVyIHJhdGhlciB0aGFuIHRoZSBleHBsaWNpdFxuICAgICAgICAvLyBzb3J0IG9yZGVyLCBiZWNhdXNlIGl0J3MgZ3VhcmFudGVlZCB0byBjb250YWluIHRoZSBkb2N1bWVudCBrZXkuIFRoYXQgd2F5XG4gICAgICAgIC8vIHRoZSBwb3NpdGlvbiBiZWNvbWVzIHVuYW1iaWd1b3VzIGFuZCB0aGUgcXVlcnkgY29udGludWVzL2VuZHMgZXhhY3RseSBhdFxuICAgICAgICAvLyB0aGUgcHJvdmlkZWQgZG9jdW1lbnQuIFdpdGhvdXQgdGhlIGtleSAoYnkgdXNpbmcgdGhlIGV4cGxpY2l0IHNvcnRcbiAgICAgICAgLy8gb3JkZXJzKSwgbXVsdGlwbGUgZG9jdW1lbnRzIGNvdWxkIG1hdGNoIHRoZSBwb3NpdGlvbiwgeWllbGRpbmcgZHVwbGljYXRlXG4gICAgICAgIC8vIHJlc3VsdHMuXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBuIG9mIHBlKHQpKSBpZiAobi5maWVsZC5pc0tleUZpZWxkKCkpIHIucHVzaCh4dChlLCBzLmtleSkpOyBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBzLmRhdGEuZmllbGQobi5maWVsZCk7XG4gICAgICAgICAgICBpZiAocHQodCkpIHRocm93IG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgJ0ludmFsaWQgcXVlcnkuIFlvdSBhcmUgdHJ5aW5nIHRvIHN0YXJ0IG9yIGVuZCBhIHF1ZXJ5IHVzaW5nIGEgZG9jdW1lbnQgZm9yIHdoaWNoIHRoZSBmaWVsZCBcIicgKyBuLmZpZWxkICsgJ1wiIGlzIGFuIHVuY29tbWl0dGVkIHNlcnZlciB0aW1lc3RhbXAuIChTaW5jZSB0aGUgdmFsdWUgb2YgdGhpcyBmaWVsZCBpcyB1bmtub3duLCB5b3UgY2Fubm90IHN0YXJ0L2VuZCBhIHF1ZXJ5IHdpdGggaXQuKScpO1xuICAgICAgICAgICAgaWYgKG51bGwgPT09IHQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gbi5maWVsZC5jYW5vbmljYWxTdHJpbmcoKTtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIHF1ZXJ5LiBZb3UgYXJlIHRyeWluZyB0byBzdGFydCBvciBlbmQgYSBxdWVyeSB1c2luZyBhIGRvY3VtZW50IGZvciB3aGljaCB0aGUgZmllbGQgJyR7dH0nICh1c2VkIGFzIHRoZSBvcmRlckJ5KSBkb2VzIG5vdCBleGlzdC5gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHIucHVzaCh0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IHJlKHIsIGkpO1xuICAgIH1cbiAgICAvKipcbiAqIENvbnZlcnRzIGEgbGlzdCBvZiBmaWVsZCB2YWx1ZXMgdG8gYSBgQm91bmRgIGZvciB0aGUgZ2l2ZW4gcXVlcnkuXG4gKi8gKHQuX3F1ZXJ5LCB0LmZpcmVzdG9yZS5fZGF0YWJhc2VJZCwgZSwgblswXS5fZG9jdW1lbnQsIHMpO1xuICAgIHtcbiAgICAgICAgY29uc3QgaSA9IG91KHQuZmlyZXN0b3JlKTtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUsIG4sIHMsIGksIHIpIHtcbiAgICAgICAgICAgIC8vIFVzZSBleHBsaWNpdCBvcmRlciBieSdzIGJlY2F1c2UgaXQgaGFzIHRvIG1hdGNoIHRoZSBxdWVyeSB0aGUgdXNlciBtYWRlXG4gICAgICAgICAgICBjb25zdCBvID0gdC5leHBsaWNpdE9yZGVyQnk7XG4gICAgICAgICAgICBpZiAoaS5sZW5ndGggPiBvLmxlbmd0aCkgdGhyb3cgbmV3IEsocS5JTlZBTElEX0FSR1VNRU5ULCBgVG9vIG1hbnkgYXJndW1lbnRzIHByb3ZpZGVkIHRvICR7c30oKS4gVGhlIG51bWJlciBvZiBhcmd1bWVudHMgbXVzdCBiZSBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gdGhlIG51bWJlciBvZiBvcmRlckJ5KCkgY2xhdXNlc2ApO1xuICAgICAgICAgICAgY29uc3QgYSA9IFtdO1xuICAgICAgICAgICAgZm9yIChsZXQgciA9IDA7IHIgPCBpLmxlbmd0aDsgcisrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgYyA9IGlbcl07XG4gICAgICAgICAgICAgICAgaWYgKG9bcl0uZmllbGQuaXNLZXlGaWVsZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChcInN0cmluZ1wiICE9IHR5cGVvZiBjKSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIHF1ZXJ5LiBFeHBlY3RlZCBhIHN0cmluZyBmb3IgZG9jdW1lbnQgSUQgaW4gJHtzfSgpLCBidXQgZ290IGEgJHt0eXBlb2YgY31gKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF5ZSh0KSAmJiAtMSAhPT0gYy5pbmRleE9mKFwiL1wiKSkgdGhyb3cgbmV3IEsocS5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBxdWVyeS4gV2hlbiBxdWVyeWluZyBhIGNvbGxlY3Rpb24gYW5kIG9yZGVyaW5nIGJ5IEZpZWxkUGF0aC5kb2N1bWVudElkKCksIHRoZSB2YWx1ZSBwYXNzZWQgdG8gJHtzfSgpIG11c3QgYmUgYSBwbGFpbiBkb2N1bWVudCBJRCwgYnV0ICcke2N9JyBjb250YWlucyBhIHNsYXNoLmApO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gdC5wYXRoLmNoaWxkKHV0LmZyb21TdHJpbmcoYykpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIVB0LmlzRG9jdW1lbnRLZXkobikpIHRocm93IG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgYEludmFsaWQgcXVlcnkuIFdoZW4gcXVlcnlpbmcgYSBjb2xsZWN0aW9uIGdyb3VwIGFuZCBvcmRlcmluZyBieSBGaWVsZFBhdGguZG9jdW1lbnRJZCgpLCB0aGUgdmFsdWUgcGFzc2VkIHRvICR7c30oKSBtdXN0IHJlc3VsdCBpbiBhIHZhbGlkIGRvY3VtZW50IHBhdGgsIGJ1dCAnJHtufScgaXMgbm90IGJlY2F1c2UgaXQgY29udGFpbnMgYW4gb2RkIG51bWJlciBvZiBzZWdtZW50cy5gKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IG5ldyBQdChuKTtcbiAgICAgICAgICAgICAgICAgICAgYS5wdXNoKHh0KGUsIGkpKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gbXUobiwgcywgYyk7XG4gICAgICAgICAgICAgICAgICAgIGEucHVzaCh0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmV3IHJlKGEsIHIpO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICogUGFyc2VzIHRoZSBnaXZlbiBgZG9jdW1lbnRJZFZhbHVlYCBpbnRvIGEgYFJlZmVyZW5jZVZhbHVlYCwgdGhyb3dpbmdcbiAqIGFwcHJvcHJpYXRlIGVycm9ycyBpZiB0aGUgdmFsdWUgaXMgYW55dGhpbmcgb3RoZXIgdGhhbiBhIGBEb2N1bWVudFJlZmVyZW5jZWBcbiAqIG9yIGBzdHJpbmdgLCBvciBpZiB0aGUgc3RyaW5nIGlzIG1hbGZvcm1lZC5cbiAqLyAodC5fcXVlcnksIHQuZmlyZXN0b3JlLl9kYXRhYmFzZUlkLCBpLCBlLCBuLCBzKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIFh1KHQsIGUsIG4pIHtcbiAgICBpZiAoXCJzdHJpbmdcIiA9PSB0eXBlb2YgKG4gPSB5KG4pKSkge1xuICAgICAgICBpZiAoXCJcIiA9PT0gbikgdGhyb3cgbmV3IEsocS5JTlZBTElEX0FSR1VNRU5ULCBcIkludmFsaWQgcXVlcnkuIFdoZW4gcXVlcnlpbmcgd2l0aCBGaWVsZFBhdGguZG9jdW1lbnRJZCgpLCB5b3UgbXVzdCBwcm92aWRlIGEgdmFsaWQgZG9jdW1lbnQgSUQsIGJ1dCBpdCB3YXMgYW4gZW1wdHkgc3RyaW5nLlwiKTtcbiAgICAgICAgaWYgKCF5ZShlKSAmJiAtMSAhPT0gbi5pbmRleE9mKFwiL1wiKSkgdGhyb3cgbmV3IEsocS5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBxdWVyeS4gV2hlbiBxdWVyeWluZyBhIGNvbGxlY3Rpb24gYnkgRmllbGRQYXRoLmRvY3VtZW50SWQoKSwgeW91IG11c3QgcHJvdmlkZSBhIHBsYWluIGRvY3VtZW50IElELCBidXQgJyR7bn0nIGNvbnRhaW5zIGEgJy8nIGNoYXJhY3Rlci5gKTtcbiAgICAgICAgY29uc3QgcyA9IGUucGF0aC5jaGlsZCh1dC5mcm9tU3RyaW5nKG4pKTtcbiAgICAgICAgaWYgKCFQdC5pc0RvY3VtZW50S2V5KHMpKSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIHF1ZXJ5LiBXaGVuIHF1ZXJ5aW5nIGEgY29sbGVjdGlvbiBncm91cCBieSBGaWVsZFBhdGguZG9jdW1lbnRJZCgpLCB0aGUgdmFsdWUgcHJvdmlkZWQgbXVzdCByZXN1bHQgaW4gYSB2YWxpZCBkb2N1bWVudCBwYXRoLCBidXQgJyR7c30nIGlzIG5vdCBiZWNhdXNlIGl0IGhhcyBhbiBvZGQgbnVtYmVyIG9mIHNlZ21lbnRzICgke3MubGVuZ3RofSkuYCk7XG4gICAgICAgIHJldHVybiB4dCh0LCBuZXcgUHQocykpO1xuICAgIH1cbiAgICBpZiAobiBpbnN0YW5jZW9mIFRjKSByZXR1cm4geHQodCwgbi5fa2V5KTtcbiAgICB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIHF1ZXJ5LiBXaGVuIHF1ZXJ5aW5nIHdpdGggRmllbGRQYXRoLmRvY3VtZW50SWQoKSwgeW91IG11c3QgcHJvdmlkZSBhIHZhbGlkIHN0cmluZyBvciBhIERvY3VtZW50UmVmZXJlbmNlLCBidXQgaXQgd2FzOiAke19jKG4pfS5gKTtcbn1cblxuLyoqXG4gKiBWYWxpZGF0ZXMgdGhhdCB0aGUgdmFsdWUgcGFzc2VkIGludG8gYSBkaXNqdW5jdGl2ZSBmaWx0ZXIgc2F0aXNmaWVzIGFsbFxuICogYXJyYXkgcmVxdWlyZW1lbnRzLlxuICovIGZ1bmN0aW9uIFp1KHQsIGUpIHtcbiAgICBpZiAoIUFycmF5LmlzQXJyYXkodCkgfHwgMCA9PT0gdC5sZW5ndGgpIHRocm93IG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgYEludmFsaWQgUXVlcnkuIEEgbm9uLWVtcHR5IGFycmF5IGlzIHJlcXVpcmVkIGZvciAnJHtlLnRvU3RyaW5nKCl9JyBmaWx0ZXJzLmApO1xuICAgIGlmICh0Lmxlbmd0aCA+IDEwKSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIFF1ZXJ5LiAnJHtlLnRvU3RyaW5nKCl9JyBmaWx0ZXJzIHN1cHBvcnQgYSBtYXhpbXVtIG9mIDEwIGVsZW1lbnRzIGluIHRoZSB2YWx1ZSBhcnJheS5gKTtcbn1cblxuZnVuY3Rpb24gdGgodCwgZSwgbikge1xuICAgIGlmICghbi5pc0VxdWFsKGUpKSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIHF1ZXJ5LiBZb3UgaGF2ZSBhIHdoZXJlIGZpbHRlciB3aXRoIGFuIGluZXF1YWxpdHkgKDwsIDw9LCAhPSwgbm90LWluLCA+LCBvciA+PSkgb24gZmllbGQgJyR7ZS50b1N0cmluZygpfScgYW5kIHNvIHlvdSBtdXN0IGFsc28gdXNlICcke2UudG9TdHJpbmcoKX0nIGFzIHlvdXIgZmlyc3QgYXJndW1lbnQgdG8gb3JkZXJCeSgpLCBidXQgeW91ciBmaXJzdCBvcmRlckJ5KCkgaXMgb24gZmllbGQgJyR7bi50b1N0cmluZygpfScgaW5zdGVhZC5gKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQ29udmVydHMgRmlyZXN0b3JlJ3MgaW50ZXJuYWwgdHlwZXMgdG8gdGhlIEphdmFTY3JpcHQgdHlwZXMgdGhhdCB3ZSBleHBvc2VcbiAqIHRvIHRoZSB1c2VyLlxuICpcbiAqIEBpbnRlcm5hbFxuICovIGNsYXNzIGVoIHtcbiAgICBjb252ZXJ0VmFsdWUodCwgZSA9IFwibm9uZVwiKSB7XG4gICAgICAgIHN3aXRjaCAoYnQodCkpIHtcbiAgICAgICAgICBjYXNlIDAgLyogTnVsbFZhbHVlICovIDpcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuXG4gICAgICAgICAgY2FzZSAxIC8qIEJvb2xlYW5WYWx1ZSAqLyA6XG4gICAgICAgICAgICByZXR1cm4gdC5ib29sZWFuVmFsdWU7XG5cbiAgICAgICAgICBjYXNlIDIgLyogTnVtYmVyVmFsdWUgKi8gOlxuICAgICAgICAgICAgcmV0dXJuIGd0KHQuaW50ZWdlclZhbHVlIHx8IHQuZG91YmxlVmFsdWUpO1xuXG4gICAgICAgICAgY2FzZSAzIC8qIFRpbWVzdGFtcFZhbHVlICovIDpcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnRUaW1lc3RhbXAodC50aW1lc3RhbXBWYWx1ZSk7XG5cbiAgICAgICAgICBjYXNlIDQgLyogU2VydmVyVGltZXN0YW1wVmFsdWUgKi8gOlxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29udmVydFNlcnZlclRpbWVzdGFtcCh0LCBlKTtcblxuICAgICAgICAgIGNhc2UgNSAvKiBTdHJpbmdWYWx1ZSAqLyA6XG4gICAgICAgICAgICByZXR1cm4gdC5zdHJpbmdWYWx1ZTtcblxuICAgICAgICAgIGNhc2UgNiAvKiBCbG9iVmFsdWUgKi8gOlxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29udmVydEJ5dGVzKHl0KHQuYnl0ZXNWYWx1ZSkpO1xuXG4gICAgICAgICAgY2FzZSA3IC8qIFJlZlZhbHVlICovIDpcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnRSZWZlcmVuY2UodC5yZWZlcmVuY2VWYWx1ZSk7XG5cbiAgICAgICAgICBjYXNlIDggLyogR2VvUG9pbnRWYWx1ZSAqLyA6XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJ0R2VvUG9pbnQodC5nZW9Qb2ludFZhbHVlKTtcblxuICAgICAgICAgIGNhc2UgOSAvKiBBcnJheVZhbHVlICovIDpcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnRBcnJheSh0LmFycmF5VmFsdWUsIGUpO1xuXG4gICAgICAgICAgY2FzZSAxMCAvKiBPYmplY3RWYWx1ZSAqLyA6XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJ0T2JqZWN0KHQubWFwVmFsdWUsIGUpO1xuXG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHRocm93IE0oKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb252ZXJ0T2JqZWN0KHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHt9O1xuICAgICAgICByZXR1cm4gb3QodC5maWVsZHMsICgodCwgcykgPT4ge1xuICAgICAgICAgICAgblt0XSA9IHRoaXMuY29udmVydFZhbHVlKHMsIGUpO1xuICAgICAgICB9KSksIG47XG4gICAgfVxuICAgIGNvbnZlcnRHZW9Qb2ludCh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgWmMoZ3QodC5sYXRpdHVkZSksIGd0KHQubG9uZ2l0dWRlKSk7XG4gICAgfVxuICAgIGNvbnZlcnRBcnJheSh0LCBlKSB7XG4gICAgICAgIHJldHVybiAodC52YWx1ZXMgfHwgW10pLm1hcCgodCA9PiB0aGlzLmNvbnZlcnRWYWx1ZSh0LCBlKSkpO1xuICAgIH1cbiAgICBjb252ZXJ0U2VydmVyVGltZXN0YW1wKHQsIGUpIHtcbiAgICAgICAgc3dpdGNoIChlKSB7XG4gICAgICAgICAgY2FzZSBcInByZXZpb3VzXCI6XG4gICAgICAgICAgICBjb25zdCBuID0gRXQodCk7XG4gICAgICAgICAgICByZXR1cm4gbnVsbCA9PSBuID8gbnVsbCA6IHRoaXMuY29udmVydFZhbHVlKG4sIGUpO1xuXG4gICAgICAgICAgY2FzZSBcImVzdGltYXRlXCI6XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJ0VGltZXN0YW1wKFR0KHQpKTtcblxuICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb252ZXJ0VGltZXN0YW1wKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IG10KHQpO1xuICAgICAgICByZXR1cm4gbmV3IHN0KGUuc2Vjb25kcywgZS5uYW5vcyk7XG4gICAgfVxuICAgIGNvbnZlcnREb2N1bWVudEtleSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSB1dC5mcm9tU3RyaW5nKHQpO1xuICAgICAgICBMKHBzKG4pKTtcbiAgICAgICAgY29uc3QgcyA9IG5ldyB1YyhuLmdldCgxKSwgbi5nZXQoMykpLCBpID0gbmV3IFB0KG4ucG9wRmlyc3QoNSkpO1xuICAgICAgICByZXR1cm4gcy5pc0VxdWFsKGUpIHx8IFxuICAgICAgICAvLyBUT0RPKGIvNjQxMzAyMDIpOiBTb21laG93IHN1cHBvcnQgZm9yZWlnbiByZWZlcmVuY2VzLlxuICAgICAgICAkKGBEb2N1bWVudCAke2l9IGNvbnRhaW5zIGEgZG9jdW1lbnQgcmVmZXJlbmNlIHdpdGhpbiBhIGRpZmZlcmVudCBkYXRhYmFzZSAoJHtzLnByb2plY3RJZH0vJHtzLmRhdGFiYXNlfSkgd2hpY2ggaXMgbm90IHN1cHBvcnRlZC4gSXQgd2lsbCBiZSB0cmVhdGVkIGFzIGEgcmVmZXJlbmNlIGluIHRoZSBjdXJyZW50IGRhdGFiYXNlICgke2UucHJvamVjdElkfS8ke2UuZGF0YWJhc2V9KSBpbnN0ZWFkLmApLCBcbiAgICAgICAgaTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIENvbnZlcnRzIGN1c3RvbSBtb2RlbCBvYmplY3Qgb2YgdHlwZSBUIGludG8gYERvY3VtZW50RGF0YWAgYnkgYXBwbHlpbmcgdGhlXG4gKiBjb252ZXJ0ZXIgaWYgaXQgZXhpc3RzLlxuICpcbiAqIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCB3aGVuIGNvbnZlcnRpbmcgdXNlciBvYmplY3RzIHRvIGBEb2N1bWVudERhdGFgXG4gKiBiZWNhdXNlIHdlIHdhbnQgdG8gcHJvdmlkZSB0aGUgdXNlciB3aXRoIGEgbW9yZSBzcGVjaWZpYyBlcnJvciBtZXNzYWdlIGlmXG4gKiB0aGVpciBgc2V0KClgIG9yIGZhaWxzIGR1ZSB0byBpbnZhbGlkIGRhdGEgb3JpZ2luYXRpbmcgZnJvbSBhIGB0b0ZpcmVzdG9yZSgpYFxuICogY2FsbC5cbiAqLyBmdW5jdGlvbiBuaCh0LCBlLCBuKSB7XG4gICAgbGV0IHM7XG4gICAgLy8gQ2FzdCB0byBgYW55YCBpbiBvcmRlciB0byBzYXRpc2Z5IHRoZSB1bmlvbiB0eXBlIGNvbnN0cmFpbnQgb25cbiAgICAvLyB0b0ZpcmVzdG9yZSgpLlxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgcmV0dXJuIHMgPSB0ID8gbiAmJiAobi5tZXJnZSB8fCBuLm1lcmdlRmllbGRzKSA/IHQudG9GaXJlc3RvcmUoZSwgbikgOiB0LnRvRmlyZXN0b3JlKGUpIDogZSwgXG4gICAgcztcbn1cblxuY2xhc3Mgc2ggZXh0ZW5kcyBlaCB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICBzdXBlcigpLCB0aGlzLmZpcmVzdG9yZSA9IHQ7XG4gICAgfVxuICAgIGNvbnZlcnRCeXRlcyh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgWWModCk7XG4gICAgfVxuICAgIGNvbnZlcnRSZWZlcmVuY2UodCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5jb252ZXJ0RG9jdW1lbnRLZXkodCwgdGhpcy5maXJlc3RvcmUuX2RhdGFiYXNlSWQpO1xuICAgICAgICByZXR1cm4gbmV3IFRjKHRoaXMuZmlyZXN0b3JlLCAvKiBjb252ZXJ0ZXI9ICovIG51bGwsIGUpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSB3cml0ZSBiYXRjaCwgdXNlZCB0byBwZXJmb3JtIG11bHRpcGxlIHdyaXRlcyBhcyBhIHNpbmdsZSBhdG9taWMgdW5pdC5cbiAqXG4gKiBBIGBXcml0ZUJhdGNoYCBvYmplY3QgY2FuIGJlIGFjcXVpcmVkIGJ5IGNhbGxpbmcge0BsaW5rIHdyaXRlQmF0Y2h9LiBJdFxuICogcHJvdmlkZXMgbWV0aG9kcyBmb3IgYWRkaW5nIHdyaXRlcyB0byB0aGUgd3JpdGUgYmF0Y2guIE5vbmUgb2YgdGhlIHdyaXRlc1xuICogd2lsbCBiZSBjb21taXR0ZWQgKG9yIHZpc2libGUgbG9jYWxseSkgdW50aWwge0BsaW5rIFdyaXRlQmF0Y2guY29tbWl0fSBpc1xuICogY2FsbGVkLlxuICovIGNsYXNzIGloIHtcbiAgICAvKiogQGhpZGVjb25zdHJ1Y3RvciAqL1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5fZmlyZXN0b3JlID0gdCwgdGhpcy5fY29tbWl0SGFuZGxlciA9IGUsIHRoaXMuX211dGF0aW9ucyA9IFtdLCB0aGlzLl9jb21taXR0ZWQgPSAhMSwgXG4gICAgICAgIHRoaXMuX2RhdGFSZWFkZXIgPSBvdSh0KTtcbiAgICB9XG4gICAgc2V0KHQsIGUsIG4pIHtcbiAgICAgICAgdGhpcy5fdmVyaWZ5Tm90Q29tbWl0dGVkKCk7XG4gICAgICAgIGNvbnN0IHMgPSByaCh0LCB0aGlzLl9maXJlc3RvcmUpLCBpID0gbmgocy5jb252ZXJ0ZXIsIGUsIG4pLCByID0gYXUodGhpcy5fZGF0YVJlYWRlciwgXCJXcml0ZUJhdGNoLnNldFwiLCBzLl9rZXksIGksIG51bGwgIT09IHMuY29udmVydGVyLCBuKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX211dGF0aW9ucy5wdXNoKHIudG9NdXRhdGlvbihzLl9rZXksIFdlLm5vbmUoKSkpLCB0aGlzO1xuICAgIH1cbiAgICB1cGRhdGUodCwgZSwgbiwgLi4ucykge1xuICAgICAgICB0aGlzLl92ZXJpZnlOb3RDb21taXR0ZWQoKTtcbiAgICAgICAgY29uc3QgaSA9IHJoKHQsIHRoaXMuX2ZpcmVzdG9yZSk7XG4gICAgICAgIC8vIEZvciBDb21wYXQgdHlwZXMsIHdlIGhhdmUgdG8gXCJleHRyYWN0XCIgdGhlIHVuZGVybHlpbmcgdHlwZXMgYmVmb3JlXG4gICAgICAgIC8vIHBlcmZvcm1pbmcgdmFsaWRhdGlvbi5cbiAgICAgICAgICAgICAgICBsZXQgcjtcbiAgICAgICAgcmV0dXJuIHIgPSBcInN0cmluZ1wiID09IHR5cGVvZiAoZSA9IHkoZSkpIHx8IGUgaW5zdGFuY2VvZiBIYyA/IF91KHRoaXMuX2RhdGFSZWFkZXIsIFwiV3JpdGVCYXRjaC51cGRhdGVcIiwgaS5fa2V5LCBlLCBuLCBzKSA6IHd1KHRoaXMuX2RhdGFSZWFkZXIsIFwiV3JpdGVCYXRjaC51cGRhdGVcIiwgaS5fa2V5LCBlKSwgXG4gICAgICAgIHRoaXMuX211dGF0aW9ucy5wdXNoKHIudG9NdXRhdGlvbihpLl9rZXksIFdlLmV4aXN0cyghMCkpKSwgdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogRGVsZXRlcyB0aGUgZG9jdW1lbnQgcmVmZXJyZWQgdG8gYnkgdGhlIHByb3ZpZGVkIHtAbGluayBEb2N1bWVudFJlZmVyZW5jZX0uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZG9jdW1lbnRSZWYgLSBBIHJlZmVyZW5jZSB0byB0aGUgZG9jdW1lbnQgdG8gYmUgZGVsZXRlZC5cbiAgICAgKiBAcmV0dXJucyBUaGlzIGBXcml0ZUJhdGNoYCBpbnN0YW5jZS4gVXNlZCBmb3IgY2hhaW5pbmcgbWV0aG9kIGNhbGxzLlxuICAgICAqLyAgICBkZWxldGUodCkge1xuICAgICAgICB0aGlzLl92ZXJpZnlOb3RDb21taXR0ZWQoKTtcbiAgICAgICAgY29uc3QgZSA9IHJoKHQsIHRoaXMuX2ZpcmVzdG9yZSk7XG4gICAgICAgIHJldHVybiB0aGlzLl9tdXRhdGlvbnMgPSB0aGlzLl9tdXRhdGlvbnMuY29uY2F0KG5ldyBvbihlLl9rZXksIFdlLm5vbmUoKSkpLCB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb21taXRzIGFsbCBvZiB0aGUgd3JpdGVzIGluIHRoaXMgd3JpdGUgYmF0Y2ggYXMgYSBzaW5nbGUgYXRvbWljIHVuaXQuXG4gICAgICpcbiAgICAgKiBUaGUgcmVzdWx0IG9mIHRoZXNlIHdyaXRlcyB3aWxsIG9ubHkgYmUgcmVmbGVjdGVkIGluIGRvY3VtZW50IHJlYWRzIHRoYXRcbiAgICAgKiBvY2N1ciBhZnRlciB0aGUgcmV0dXJuZWQgcHJvbWlzZSByZXNvbHZlcy4gSWYgdGhlIGNsaWVudCBpcyBvZmZsaW5lLCB0aGVcbiAgICAgKiB3cml0ZSBmYWlscy4gSWYgeW91IHdvdWxkIGxpa2UgdG8gc2VlIGxvY2FsIG1vZGlmaWNhdGlvbnMgb3IgYnVmZmVyIHdyaXRlc1xuICAgICAqIHVudGlsIHRoZSBjbGllbnQgaXMgb25saW5lLCB1c2UgdGhlIGZ1bGwgRmlyZXN0b3JlIFNESy5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIEEgYFByb21pc2VgIHJlc29sdmVkIG9uY2UgYWxsIG9mIHRoZSB3cml0ZXMgaW4gdGhlIGJhdGNoIGhhdmUgYmVlblxuICAgICAqIHN1Y2Nlc3NmdWxseSB3cml0dGVuIHRvIHRoZSBiYWNrZW5kIGFzIGFuIGF0b21pYyB1bml0IChub3RlIHRoYXQgaXQgd29uJ3RcbiAgICAgKiByZXNvbHZlIHdoaWxlIHlvdSdyZSBvZmZsaW5lKS5cbiAgICAgKi8gICAgY29tbWl0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdmVyaWZ5Tm90Q29tbWl0dGVkKCksIHRoaXMuX2NvbW1pdHRlZCA9ICEwLCB0aGlzLl9tdXRhdGlvbnMubGVuZ3RoID4gMCA/IHRoaXMuX2NvbW1pdEhhbmRsZXIodGhpcy5fbXV0YXRpb25zKSA6IFByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cbiAgICBfdmVyaWZ5Tm90Q29tbWl0dGVkKCkge1xuICAgICAgICBpZiAodGhpcy5fY29tbWl0dGVkKSB0aHJvdyBuZXcgSyhxLkZBSUxFRF9QUkVDT05ESVRJT04sIFwiQSB3cml0ZSBiYXRjaCBjYW4gbm8gbG9uZ2VyIGJlIHVzZWQgYWZ0ZXIgY29tbWl0KCkgaGFzIGJlZW4gY2FsbGVkLlwiKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHJoKHQsIGUpIHtcbiAgICBpZiAoKHQgPSB5KHQpKS5maXJlc3RvcmUgIT09IGUpIHRocm93IG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgXCJQcm92aWRlZCBkb2N1bWVudCByZWZlcmVuY2UgaXMgZnJvbSBhIGRpZmZlcmVudCBGaXJlc3RvcmUgaW5zdGFuY2UuXCIpO1xuICAgIHJldHVybiB0O1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLy8gVE9ETyhtcnNjaG1pZHQpIENvbnNpZGVyIHVzaW5nIGBCYXNlVHJhbnNhY3Rpb25gIGFzIHRoZSBiYXNlIGNsYXNzIGluIHRoZVxuLy8gbGVnYWN5IFNESy5cbi8qKlxuICogQSByZWZlcmVuY2UgdG8gYSB0cmFuc2FjdGlvbi5cbiAqXG4gKiBUaGUgYFRyYW5zYWN0aW9uYCBvYmplY3QgcGFzc2VkIHRvIGEgdHJhbnNhY3Rpb24ncyBgdXBkYXRlRnVuY3Rpb25gIHByb3ZpZGVzXG4gKiB0aGUgbWV0aG9kcyB0byByZWFkIGFuZCB3cml0ZSBkYXRhIHdpdGhpbiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dC4gU2VlXG4gKiB7QGxpbmsgcnVuVHJhbnNhY3Rpb259LlxuICovXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBSZWFkcyB0aGUgZG9jdW1lbnQgcmVmZXJyZWQgdG8gYnkgdGhpcyBgRG9jdW1lbnRSZWZlcmVuY2VgLlxuICpcbiAqIE5vdGU6IGBnZXREb2MoKWAgYXR0ZW1wdHMgdG8gcHJvdmlkZSB1cC10by1kYXRlIGRhdGEgd2hlbiBwb3NzaWJsZSBieSB3YWl0aW5nXG4gKiBmb3IgZGF0YSBmcm9tIHRoZSBzZXJ2ZXIsIGJ1dCBpdCBtYXkgcmV0dXJuIGNhY2hlZCBkYXRhIG9yIGZhaWwgaWYgeW91IGFyZVxuICogb2ZmbGluZSBhbmQgdGhlIHNlcnZlciBjYW5ub3QgYmUgcmVhY2hlZC4gVG8gc3BlY2lmeSB0aGlzIGJlaGF2aW9yLCBpbnZva2VcbiAqIHtAbGluayBnZXREb2NGcm9tQ2FjaGV9IG9yIHtAbGluayBnZXREb2NGcm9tU2VydmVyfS5cbiAqXG4gKiBAcGFyYW0gcmVmZXJlbmNlIC0gVGhlIHJlZmVyZW5jZSBvZiB0aGUgZG9jdW1lbnQgdG8gZmV0Y2guXG4gKiBAcmV0dXJucyBBIFByb21pc2UgcmVzb2x2ZWQgd2l0aCBhIGBEb2N1bWVudFNuYXBzaG90YCBjb250YWluaW5nIHRoZVxuICogY3VycmVudCBkb2N1bWVudCBjb250ZW50cy5cbiAqL1xuZnVuY3Rpb24gb2godCkge1xuICAgIHQgPSBtYyh0LCBUYyk7XG4gICAgY29uc3QgZSA9IG1jKHQuZmlyZXN0b3JlLCB4Yyk7XG4gICAgcmV0dXJuIGVjKE9jKGUpLCB0Ll9rZXkpLnRoZW4oKG4gPT4gRWgoZSwgdCwgbikpKTtcbn1cblxuY2xhc3MgYWggZXh0ZW5kcyBlaCB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICBzdXBlcigpLCB0aGlzLmZpcmVzdG9yZSA9IHQ7XG4gICAgfVxuICAgIGNvbnZlcnRCeXRlcyh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgWWModCk7XG4gICAgfVxuICAgIGNvbnZlcnRSZWZlcmVuY2UodCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5jb252ZXJ0RG9jdW1lbnRLZXkodCwgdGhpcy5maXJlc3RvcmUuX2RhdGFiYXNlSWQpO1xuICAgICAgICByZXR1cm4gbmV3IFRjKHRoaXMuZmlyZXN0b3JlLCAvKiBjb252ZXJ0ZXI9ICovIG51bGwsIGUpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBSZWFkcyB0aGUgZG9jdW1lbnQgcmVmZXJyZWQgdG8gYnkgdGhpcyBgRG9jdW1lbnRSZWZlcmVuY2VgIGZyb20gY2FjaGUuXG4gKiBSZXR1cm5zIGFuIGVycm9yIGlmIHRoZSBkb2N1bWVudCBpcyBub3QgY3VycmVudGx5IGNhY2hlZC5cbiAqXG4gKiBAcmV0dXJucyBBIGBQcm9taXNlYCByZXNvbHZlZCB3aXRoIGEgYERvY3VtZW50U25hcHNob3RgIGNvbnRhaW5pbmcgdGhlXG4gKiBjdXJyZW50IGRvY3VtZW50IGNvbnRlbnRzLlxuICovIGZ1bmN0aW9uIGNoKHQpIHtcbiAgICB0ID0gbWModCwgVGMpO1xuICAgIGNvbnN0IGUgPSBtYyh0LmZpcmVzdG9yZSwgeGMpLCBuID0gT2MoZSksIHMgPSBuZXcgYWgoZSk7XG4gICAgcmV0dXJuIHRjKG4sIHQuX2tleSkudGhlbigobiA9PiBuZXcgRHUoZSwgcywgdC5fa2V5LCBuLCBuZXcgU3UobnVsbCAhPT0gbiAmJiBuLmhhc0xvY2FsTXV0YXRpb25zLCBcbiAgICAvKiBmcm9tQ2FjaGU9ICovICEwKSwgdC5jb252ZXJ0ZXIpKSk7XG59XG5cbi8qKlxuICogUmVhZHMgdGhlIGRvY3VtZW50IHJlZmVycmVkIHRvIGJ5IHRoaXMgYERvY3VtZW50UmVmZXJlbmNlYCBmcm9tIHRoZSBzZXJ2ZXIuXG4gKiBSZXR1cm5zIGFuIGVycm9yIGlmIHRoZSBuZXR3b3JrIGlzIG5vdCBhdmFpbGFibGUuXG4gKlxuICogQHJldHVybnMgQSBgUHJvbWlzZWAgcmVzb2x2ZWQgd2l0aCBhIGBEb2N1bWVudFNuYXBzaG90YCBjb250YWluaW5nIHRoZVxuICogY3VycmVudCBkb2N1bWVudCBjb250ZW50cy5cbiAqLyBmdW5jdGlvbiB1aCh0KSB7XG4gICAgdCA9IG1jKHQsIFRjKTtcbiAgICBjb25zdCBlID0gbWModC5maXJlc3RvcmUsIHhjKTtcbiAgICByZXR1cm4gZWMoT2MoZSksIHQuX2tleSwge1xuICAgICAgICBzb3VyY2U6IFwic2VydmVyXCJcbiAgICB9KS50aGVuKChuID0+IEVoKGUsIHQsIG4pKSk7XG59XG5cbi8qKlxuICogRXhlY3V0ZXMgdGhlIHF1ZXJ5IGFuZCByZXR1cm5zIHRoZSByZXN1bHRzIGFzIGEgYFF1ZXJ5U25hcHNob3RgLlxuICpcbiAqIE5vdGU6IGBnZXREb2NzKClgIGF0dGVtcHRzIHRvIHByb3ZpZGUgdXAtdG8tZGF0ZSBkYXRhIHdoZW4gcG9zc2libGUgYnlcbiAqIHdhaXRpbmcgZm9yIGRhdGEgZnJvbSB0aGUgc2VydmVyLCBidXQgaXQgbWF5IHJldHVybiBjYWNoZWQgZGF0YSBvciBmYWlsIGlmXG4gKiB5b3UgYXJlIG9mZmxpbmUgYW5kIHRoZSBzZXJ2ZXIgY2Fubm90IGJlIHJlYWNoZWQuIFRvIHNwZWNpZnkgdGhpcyBiZWhhdmlvcixcbiAqIGludm9rZSB7QGxpbmsgZ2V0RG9jc0Zyb21DYWNoZX0gb3Ige0BsaW5rIGdldERvY3NGcm9tU2VydmVyfS5cbiAqXG4gKiBAcmV0dXJucyBBIGBQcm9taXNlYCB0aGF0IHdpbGwgYmUgcmVzb2x2ZWQgd2l0aCB0aGUgcmVzdWx0cyBvZiB0aGUgcXVlcnkuXG4gKi8gZnVuY3Rpb24gaGgodCkge1xuICAgIHQgPSBtYyh0LCBJYyk7XG4gICAgY29uc3QgZSA9IG1jKHQuZmlyZXN0b3JlLCB4YyksIG4gPSBPYyhlKSwgcyA9IG5ldyBhaChlKTtcbiAgICByZXR1cm4gJHUodC5fcXVlcnkpLCBzYyhuLCB0Ll9xdWVyeSkudGhlbigobiA9PiBuZXcgTnUoZSwgcywgdCwgbikpKTtcbn1cblxuLyoqXG4gKiBFeGVjdXRlcyB0aGUgcXVlcnkgYW5kIHJldHVybnMgdGhlIHJlc3VsdHMgYXMgYSBgUXVlcnlTbmFwc2hvdGAgZnJvbSBjYWNoZS5cbiAqIFJldHVybnMgYW4gZXJyb3IgaWYgdGhlIGRvY3VtZW50IGlzIG5vdCBjdXJyZW50bHkgY2FjaGVkLlxuICpcbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHRoYXQgd2lsbCBiZSByZXNvbHZlZCB3aXRoIHRoZSByZXN1bHRzIG9mIHRoZSBxdWVyeS5cbiAqLyBmdW5jdGlvbiBsaCh0KSB7XG4gICAgdCA9IG1jKHQsIEljKTtcbiAgICBjb25zdCBlID0gbWModC5maXJlc3RvcmUsIHhjKSwgbiA9IE9jKGUpLCBzID0gbmV3IGFoKGUpO1xuICAgIHJldHVybiBuYyhuLCB0Ll9xdWVyeSkudGhlbigobiA9PiBuZXcgTnUoZSwgcywgdCwgbikpKTtcbn1cblxuLyoqXG4gKiBFeGVjdXRlcyB0aGUgcXVlcnkgYW5kIHJldHVybnMgdGhlIHJlc3VsdHMgYXMgYSBgUXVlcnlTbmFwc2hvdGAgZnJvbSB0aGVcbiAqIHNlcnZlci4gUmV0dXJucyBhbiBlcnJvciBpZiB0aGUgbmV0d29yayBpcyBub3QgYXZhaWxhYmxlLlxuICpcbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHRoYXQgd2lsbCBiZSByZXNvbHZlZCB3aXRoIHRoZSByZXN1bHRzIG9mIHRoZSBxdWVyeS5cbiAqLyBmdW5jdGlvbiBmaCh0KSB7XG4gICAgdCA9IG1jKHQsIEljKTtcbiAgICBjb25zdCBlID0gbWModC5maXJlc3RvcmUsIHhjKSwgbiA9IE9jKGUpLCBzID0gbmV3IGFoKGUpO1xuICAgIHJldHVybiBzYyhuLCB0Ll9xdWVyeSwge1xuICAgICAgICBzb3VyY2U6IFwic2VydmVyXCJcbiAgICB9KS50aGVuKChuID0+IG5ldyBOdShlLCBzLCB0LCBuKSkpO1xufVxuXG5mdW5jdGlvbiBkaCh0LCBlLCBuKSB7XG4gICAgdCA9IG1jKHQsIFRjKTtcbiAgICBjb25zdCBzID0gbWModC5maXJlc3RvcmUsIHhjKSwgaSA9IG5oKHQuY29udmVydGVyLCBlLCBuKTtcbiAgICByZXR1cm4gcGgocywgWyBhdShvdShzKSwgXCJzZXREb2NcIiwgdC5fa2V5LCBpLCBudWxsICE9PSB0LmNvbnZlcnRlciwgbikudG9NdXRhdGlvbih0Ll9rZXksIFdlLm5vbmUoKSkgXSk7XG59XG5cbmZ1bmN0aW9uIHdoKHQsIGUsIG4sIC4uLnMpIHtcbiAgICB0ID0gbWModCwgVGMpO1xuICAgIGNvbnN0IGkgPSBtYyh0LmZpcmVzdG9yZSwgeGMpLCByID0gb3UoaSk7XG4gICAgbGV0IG87XG4gICAgbyA9IFwic3RyaW5nXCIgPT0gdHlwZW9mIChcbiAgICAvLyBGb3IgQ29tcGF0IHR5cGVzLCB3ZSBoYXZlIHRvIFwiZXh0cmFjdFwiIHRoZSB1bmRlcmx5aW5nIHR5cGVzIGJlZm9yZVxuICAgIC8vIHBlcmZvcm1pbmcgdmFsaWRhdGlvbi5cbiAgICBlID0geShlKSkgfHwgZSBpbnN0YW5jZW9mIEhjID8gX3UociwgXCJ1cGRhdGVEb2NcIiwgdC5fa2V5LCBlLCBuLCBzKSA6IHd1KHIsIFwidXBkYXRlRG9jXCIsIHQuX2tleSwgZSk7XG4gICAgcmV0dXJuIHBoKGksIFsgby50b011dGF0aW9uKHQuX2tleSwgV2UuZXhpc3RzKCEwKSkgXSk7XG59XG5cbi8qKlxuICogRGVsZXRlcyB0aGUgZG9jdW1lbnQgcmVmZXJyZWQgdG8gYnkgdGhlIHNwZWNpZmllZCBgRG9jdW1lbnRSZWZlcmVuY2VgLlxuICpcbiAqIEBwYXJhbSByZWZlcmVuY2UgLSBBIHJlZmVyZW5jZSB0byB0aGUgZG9jdW1lbnQgdG8gZGVsZXRlLlxuICogQHJldHVybnMgQSBQcm9taXNlIHJlc29sdmVkIG9uY2UgdGhlIGRvY3VtZW50IGhhcyBiZWVuIHN1Y2Nlc3NmdWxseVxuICogZGVsZXRlZCBmcm9tIHRoZSBiYWNrZW5kIChub3RlIHRoYXQgaXQgd29uJ3QgcmVzb2x2ZSB3aGlsZSB5b3UncmUgb2ZmbGluZSkuXG4gKi8gZnVuY3Rpb24gX2godCkge1xuICAgIHJldHVybiBwaChtYyh0LmZpcmVzdG9yZSwgeGMpLCBbIG5ldyBvbih0Ll9rZXksIFdlLm5vbmUoKSkgXSk7XG59XG5cbi8qKlxuICogQWRkIGEgbmV3IGRvY3VtZW50IHRvIHNwZWNpZmllZCBgQ29sbGVjdGlvblJlZmVyZW5jZWAgd2l0aCB0aGUgZ2l2ZW4gZGF0YSxcbiAqIGFzc2lnbmluZyBpdCBhIGRvY3VtZW50IElEIGF1dG9tYXRpY2FsbHkuXG4gKlxuICogQHBhcmFtIHJlZmVyZW5jZSAtIEEgcmVmZXJlbmNlIHRvIHRoZSBjb2xsZWN0aW9uIHRvIGFkZCB0aGlzIGRvY3VtZW50IHRvLlxuICogQHBhcmFtIGRhdGEgLSBBbiBPYmplY3QgY29udGFpbmluZyB0aGUgZGF0YSBmb3IgdGhlIG5ldyBkb2N1bWVudC5cbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHJlc29sdmVkIHdpdGggYSBgRG9jdW1lbnRSZWZlcmVuY2VgIHBvaW50aW5nIHRvIHRoZVxuICogbmV3bHkgY3JlYXRlZCBkb2N1bWVudCBhZnRlciBpdCBoYXMgYmVlbiB3cml0dGVuIHRvIHRoZSBiYWNrZW5kIChOb3RlIHRoYXQgaXRcbiAqIHdvbid0IHJlc29sdmUgd2hpbGUgeW91J3JlIG9mZmxpbmUpLlxuICovIGZ1bmN0aW9uIG1oKHQsIGUpIHtcbiAgICBjb25zdCBuID0gbWModC5maXJlc3RvcmUsIHhjKSwgcyA9IGJjKHQpLCBpID0gbmgodC5jb252ZXJ0ZXIsIGUpO1xuICAgIHJldHVybiBwaChuLCBbIGF1KG91KHQuZmlyZXN0b3JlKSwgXCJhZGREb2NcIiwgcy5fa2V5LCBpLCBudWxsICE9PSB0LmNvbnZlcnRlciwge30pLnRvTXV0YXRpb24ocy5fa2V5LCBXZS5leGlzdHMoITEpKSBdKS50aGVuKCgoKSA9PiBzKSk7XG59XG5cbmZ1bmN0aW9uIGdoKHQsIC4uLmUpIHtcbiAgICB2YXIgbiwgcywgaTtcbiAgICB0ID0geSh0KTtcbiAgICBsZXQgciA9IHtcbiAgICAgICAgaW5jbHVkZU1ldGFkYXRhQ2hhbmdlczogITFcbiAgICB9LCBvID0gMDtcbiAgICBcIm9iamVjdFwiICE9IHR5cGVvZiBlW29dIHx8IERjKGVbb10pIHx8IChyID0gZVtvXSwgbysrKTtcbiAgICBjb25zdCBhID0ge1xuICAgICAgICBpbmNsdWRlTWV0YWRhdGFDaGFuZ2VzOiByLmluY2x1ZGVNZXRhZGF0YUNoYW5nZXNcbiAgICB9O1xuICAgIGlmIChEYyhlW29dKSkge1xuICAgICAgICBjb25zdCB0ID0gZVtvXTtcbiAgICAgICAgZVtvXSA9IG51bGwgPT09IChuID0gdC5uZXh0KSB8fCB2b2lkIDAgPT09IG4gPyB2b2lkIDAgOiBuLmJpbmQodCksIGVbbyArIDFdID0gbnVsbCA9PT0gKHMgPSB0LmVycm9yKSB8fCB2b2lkIDAgPT09IHMgPyB2b2lkIDAgOiBzLmJpbmQodCksIFxuICAgICAgICBlW28gKyAyXSA9IG51bGwgPT09IChpID0gdC5jb21wbGV0ZSkgfHwgdm9pZCAwID09PSBpID8gdm9pZCAwIDogaS5iaW5kKHQpO1xuICAgIH1cbiAgICBsZXQgYywgdSwgaDtcbiAgICBpZiAodCBpbnN0YW5jZW9mIFRjKSB1ID0gbWModC5maXJlc3RvcmUsIHhjKSwgaCA9IGRlKHQuX2tleS5wYXRoKSwgYyA9IHtcbiAgICAgICAgbmV4dDogbiA9PiB7XG4gICAgICAgICAgICBlW29dICYmIGVbb10oRWgodSwgdCwgbikpO1xuICAgICAgICB9LFxuICAgICAgICBlcnJvcjogZVtvICsgMV0sXG4gICAgICAgIGNvbXBsZXRlOiBlW28gKyAyXVxuICAgIH07IGVsc2Uge1xuICAgICAgICBjb25zdCBuID0gbWModCwgSWMpO1xuICAgICAgICB1ID0gbWMobi5maXJlc3RvcmUsIHhjKSwgaCA9IG4uX3F1ZXJ5O1xuICAgICAgICBjb25zdCBzID0gbmV3IGFoKHUpO1xuICAgICAgICBjID0ge1xuICAgICAgICAgICAgbmV4dDogdCA9PiB7XG4gICAgICAgICAgICAgICAgZVtvXSAmJiBlW29dKG5ldyBOdSh1LCBzLCBuLCB0KSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZXJyb3I6IGVbbyArIDFdLFxuICAgICAgICAgICAgY29tcGxldGU6IGVbbyArIDJdXG4gICAgICAgIH0sICR1KHQuX3F1ZXJ5KTtcbiAgICB9XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgY29uc3QgaSA9IG5ldyBNYShzKSwgciA9IG5ldyBqbyhlLCBpLCBuKTtcbiAgICAgICAgcmV0dXJuIHQuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KChhc3luYyAoKSA9PiBMbyhhd2FpdCBZYSh0KSwgcikpKSwgKCkgPT4ge1xuICAgICAgICAgICAgaS5YbygpLCB0LmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldCgoYXN5bmMgKCkgPT4gQm8oYXdhaXQgWWEodCksIHIpKSk7XG4gICAgICAgIH07XG4gICAgfShPYyh1KSwgaCwgYSwgYyk7XG59XG5cbmZ1bmN0aW9uIHloKHQsIGUpIHtcbiAgICByZXR1cm4gaWMoT2ModCA9IG1jKHQsIHhjKSksIERjKGUpID8gZSA6IHtcbiAgICAgICAgbmV4dDogZVxuICAgIH0pO1xufVxuXG4vKipcbiAqIExvY2FsbHkgd3JpdGVzIGBtdXRhdGlvbnNgIG9uIHRoZSBhc3luYyBxdWV1ZS5cbiAqIEBpbnRlcm5hbFxuICovIGZ1bmN0aW9uIHBoKHQsIGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBjb25zdCBuID0gbmV3IGo7XG4gICAgICAgIHJldHVybiB0LmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldCgoYXN5bmMgKCkgPT4gaWEoYXdhaXQgSmEodCksIGUsIG4pKSksIG4ucHJvbWlzZTtcbiAgICB9KE9jKHQpLCBlKTtcbn1cblxuLyoqXG4gKiBDb252ZXJ0cyBhIHtAbGluayBWaWV3U25hcHNob3R9IHRoYXQgY29udGFpbnMgdGhlIHNpbmdsZSBkb2N1bWVudCBzcGVjaWZpZWQgYnkgYHJlZmBcbiAqIHRvIGEge0BsaW5rIERvY3VtZW50U25hcHNob3R9LlxuICovIGZ1bmN0aW9uIEVoKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gbi5kb2NzLmdldChlLl9rZXkpLCBpID0gbmV3IGFoKHQpO1xuICAgIHJldHVybiBuZXcgRHUodCwgaSwgZS5fa2V5LCBzLCBuZXcgU3Uobi5oYXNQZW5kaW5nV3JpdGVzLCBuLmZyb21DYWNoZSksIGUuY29udmVydGVyKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSByZWZlcmVuY2UgdG8gYSB0cmFuc2FjdGlvbi5cbiAqXG4gKiBUaGUgYFRyYW5zYWN0aW9uYCBvYmplY3QgcGFzc2VkIHRvIGEgdHJhbnNhY3Rpb24ncyBgdXBkYXRlRnVuY3Rpb25gIHByb3ZpZGVzXG4gKiB0aGUgbWV0aG9kcyB0byByZWFkIGFuZCB3cml0ZSBkYXRhIHdpdGhpbiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dC4gU2VlXG4gKiB7QGxpbmsgcnVuVHJhbnNhY3Rpb259LlxuICovIGNsYXNzIFRoIGV4dGVuZHMgY2xhc3Mge1xuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yICovXG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLl9maXJlc3RvcmUgPSB0LCB0aGlzLl90cmFuc2FjdGlvbiA9IGUsIHRoaXMuX2RhdGFSZWFkZXIgPSBvdSh0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVhZHMgdGhlIGRvY3VtZW50IHJlZmVyZW5jZWQgYnkgdGhlIHByb3ZpZGVkIHtAbGluayBEb2N1bWVudFJlZmVyZW5jZX0uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZG9jdW1lbnRSZWYgLSBBIHJlZmVyZW5jZSB0byB0aGUgZG9jdW1lbnQgdG8gYmUgcmVhZC5cbiAgICAgKiBAcmV0dXJucyBBIGBEb2N1bWVudFNuYXBzaG90YCB3aXRoIHRoZSByZWFkIGRhdGEuXG4gICAgICovICAgIGdldCh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSByaCh0LCB0aGlzLl9maXJlc3RvcmUpLCBuID0gbmV3IHNoKHRoaXMuX2ZpcmVzdG9yZSk7XG4gICAgICAgIHJldHVybiB0aGlzLl90cmFuc2FjdGlvbi5sb29rdXAoWyBlLl9rZXkgXSkudGhlbigodCA9PiB7XG4gICAgICAgICAgICBpZiAoIXQgfHwgMSAhPT0gdC5sZW5ndGgpIHJldHVybiBNKCk7XG4gICAgICAgICAgICBjb25zdCBzID0gdFswXTtcbiAgICAgICAgICAgIGlmIChzLmlzRm91bmREb2N1bWVudCgpKSByZXR1cm4gbmV3IGJ1KHRoaXMuX2ZpcmVzdG9yZSwgbiwgcy5rZXksIHMsIGUuY29udmVydGVyKTtcbiAgICAgICAgICAgIGlmIChzLmlzTm9Eb2N1bWVudCgpKSByZXR1cm4gbmV3IGJ1KHRoaXMuX2ZpcmVzdG9yZSwgbiwgZS5fa2V5LCBudWxsLCBlLmNvbnZlcnRlcik7XG4gICAgICAgICAgICB0aHJvdyBNKCk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgc2V0KHQsIGUsIG4pIHtcbiAgICAgICAgY29uc3QgcyA9IHJoKHQsIHRoaXMuX2ZpcmVzdG9yZSksIGkgPSBuaChzLmNvbnZlcnRlciwgZSwgbiksIHIgPSBhdSh0aGlzLl9kYXRhUmVhZGVyLCBcIlRyYW5zYWN0aW9uLnNldFwiLCBzLl9rZXksIGksIG51bGwgIT09IHMuY29udmVydGVyLCBuKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RyYW5zYWN0aW9uLnNldChzLl9rZXksIHIpLCB0aGlzO1xuICAgIH1cbiAgICB1cGRhdGUodCwgZSwgbiwgLi4ucykge1xuICAgICAgICBjb25zdCBpID0gcmgodCwgdGhpcy5fZmlyZXN0b3JlKTtcbiAgICAgICAgLy8gRm9yIENvbXBhdCB0eXBlcywgd2UgaGF2ZSB0byBcImV4dHJhY3RcIiB0aGUgdW5kZXJseWluZyB0eXBlcyBiZWZvcmVcbiAgICAgICAgLy8gcGVyZm9ybWluZyB2YWxpZGF0aW9uLlxuICAgICAgICAgICAgICAgIGxldCByO1xuICAgICAgICByZXR1cm4gciA9IFwic3RyaW5nXCIgPT0gdHlwZW9mIChlID0geShlKSkgfHwgZSBpbnN0YW5jZW9mIEhjID8gX3UodGhpcy5fZGF0YVJlYWRlciwgXCJUcmFuc2FjdGlvbi51cGRhdGVcIiwgaS5fa2V5LCBlLCBuLCBzKSA6IHd1KHRoaXMuX2RhdGFSZWFkZXIsIFwiVHJhbnNhY3Rpb24udXBkYXRlXCIsIGkuX2tleSwgZSksIFxuICAgICAgICB0aGlzLl90cmFuc2FjdGlvbi51cGRhdGUoaS5fa2V5LCByKSwgdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogRGVsZXRlcyB0aGUgZG9jdW1lbnQgcmVmZXJyZWQgdG8gYnkgdGhlIHByb3ZpZGVkIHtAbGluayBEb2N1bWVudFJlZmVyZW5jZX0uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZG9jdW1lbnRSZWYgLSBBIHJlZmVyZW5jZSB0byB0aGUgZG9jdW1lbnQgdG8gYmUgZGVsZXRlZC5cbiAgICAgKiBAcmV0dXJucyBUaGlzIGBUcmFuc2FjdGlvbmAgaW5zdGFuY2UuIFVzZWQgZm9yIGNoYWluaW5nIG1ldGhvZCBjYWxscy5cbiAgICAgKi8gICAgZGVsZXRlKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHJoKHQsIHRoaXMuX2ZpcmVzdG9yZSk7XG4gICAgICAgIHJldHVybiB0aGlzLl90cmFuc2FjdGlvbi5kZWxldGUoZS5fa2V5KSwgdGhpcztcbiAgICB9XG59IHtcbiAgICAvLyBUaGlzIGNsYXNzIGltcGxlbWVudHMgdGhlIHNhbWUgbG9naWMgYXMgdGhlIFRyYW5zYWN0aW9uIEFQSSBpbiB0aGUgTGl0ZSBTREtcbiAgICAvLyBidXQgaXMgc3ViY2xhc3NlZCBpbiBvcmRlciB0byByZXR1cm4gaXRzIG93biBEb2N1bWVudFNuYXBzaG90IHR5cGVzLlxuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yICovXG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICBzdXBlcih0LCBlKSwgdGhpcy5fZmlyZXN0b3JlID0gdDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVhZHMgdGhlIGRvY3VtZW50IHJlZmVyZW5jZWQgYnkgdGhlIHByb3ZpZGVkIHtAbGluayBEb2N1bWVudFJlZmVyZW5jZX0uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZG9jdW1lbnRSZWYgLSBBIHJlZmVyZW5jZSB0byB0aGUgZG9jdW1lbnQgdG8gYmUgcmVhZC5cbiAgICAgKiBAcmV0dXJucyBBIGBEb2N1bWVudFNuYXBzaG90YCB3aXRoIHRoZSByZWFkIGRhdGEuXG4gICAgICovICAgIGdldCh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSByaCh0LCB0aGlzLl9maXJlc3RvcmUpLCBuID0gbmV3IGFoKHRoaXMuX2ZpcmVzdG9yZSk7XG4gICAgICAgIHJldHVybiBzdXBlci5nZXQodCkudGhlbigodCA9PiBuZXcgRHUodGhpcy5fZmlyZXN0b3JlLCBuLCBlLl9rZXksIHQuX2RvY3VtZW50LCBuZXcgU3UoXG4gICAgICAgIC8qIGhhc1BlbmRpbmdXcml0ZXM9ICovICExLCBcbiAgICAgICAgLyogZnJvbUNhY2hlPSAqLyAhMSksIGUuY29udmVydGVyKSkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBFeGVjdXRlcyB0aGUgZ2l2ZW4gYHVwZGF0ZUZ1bmN0aW9uYCBhbmQgdGhlbiBhdHRlbXB0cyB0byBjb21taXQgdGhlIGNoYW5nZXNcbiAqIGFwcGxpZWQgd2l0aGluIHRoZSB0cmFuc2FjdGlvbi4gSWYgYW55IGRvY3VtZW50IHJlYWQgd2l0aGluIHRoZSB0cmFuc2FjdGlvblxuICogaGFzIGNoYW5nZWQsIENsb3VkIEZpcmVzdG9yZSByZXRyaWVzIHRoZSBgdXBkYXRlRnVuY3Rpb25gLiBJZiBpdCBmYWlscyB0b1xuICogY29tbWl0IGFmdGVyIDUgYXR0ZW1wdHMsIHRoZSB0cmFuc2FjdGlvbiBmYWlscy5cbiAqXG4gKiBUaGUgbWF4aW11bSBudW1iZXIgb2Ygd3JpdGVzIGFsbG93ZWQgaW4gYSBzaW5nbGUgdHJhbnNhY3Rpb24gaXMgNTAwLlxuICpcbiAqIEBwYXJhbSBmaXJlc3RvcmUgLSBBIHJlZmVyZW5jZSB0byB0aGUgRmlyZXN0b3JlIGRhdGFiYXNlIHRvIHJ1biB0aGlzXG4gKiB0cmFuc2FjdGlvbiBhZ2FpbnN0LlxuICogQHBhcmFtIHVwZGF0ZUZ1bmN0aW9uIC0gVGhlIGZ1bmN0aW9uIHRvIGV4ZWN1dGUgd2l0aGluIHRoZSB0cmFuc2FjdGlvblxuICogY29udGV4dC5cbiAqIEByZXR1cm5zIElmIHRoZSB0cmFuc2FjdGlvbiBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5IG9yIHdhcyBleHBsaWNpdGx5IGFib3J0ZWRcbiAqICh0aGUgYHVwZGF0ZUZ1bmN0aW9uYCByZXR1cm5lZCBhIGZhaWxlZCBwcm9taXNlKSwgdGhlIHByb21pc2UgcmV0dXJuZWQgYnkgdGhlXG4gKiBgdXBkYXRlRnVuY3Rpb24gYGlzIHJldHVybmVkIGhlcmUuIE90aGVyd2lzZSwgaWYgdGhlIHRyYW5zYWN0aW9uIGZhaWxlZCwgYVxuICogcmVqZWN0ZWQgcHJvbWlzZSB3aXRoIHRoZSBjb3JyZXNwb25kaW5nIGZhaWx1cmUgZXJyb3IgaXMgcmV0dXJuZWQuXG4gKi8gZnVuY3Rpb24gSWgodCwgZSkge1xuICAgIHJldHVybiByYyhPYyh0KSwgKG4gPT4gZShuZXcgVGgodCwgbikpKSk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFJldHVybnMgYSBzZW50aW5lbCBmb3IgdXNlIHdpdGgge0BsaW5rIEBmaXJlYmFzZS9maXJlc3RvcmUvbGl0ZSModXBkYXRlRG9jOjEpfSBvclxuICoge0BsaW5rIEBmaXJlYmFzZS9maXJlc3RvcmUvbGl0ZSMoc2V0RG9jOjEpfSB3aXRoIGB7bWVyZ2U6IHRydWV9YCB0byBtYXJrIGEgZmllbGQgZm9yIGRlbGV0aW9uLlxuICovIGZ1bmN0aW9uIEFoKCkge1xuICAgIHJldHVybiBuZXcgY3UoXCJkZWxldGVGaWVsZFwiKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgc2VudGluZWwgdXNlZCB3aXRoIHtAbGluayBAZmlyZWJhc2UvZmlyZXN0b3JlL2xpdGUjKHNldERvYzoxKX0gb3Ige0BsaW5rIEBmaXJlYmFzZS9maXJlc3RvcmUvbGl0ZSModXBkYXRlRG9jOjEpfSB0b1xuICogaW5jbHVkZSBhIHNlcnZlci1nZW5lcmF0ZWQgdGltZXN0YW1wIGluIHRoZSB3cml0dGVuIGRhdGEuXG4gKi8gZnVuY3Rpb24gUmgoKSB7XG4gICAgcmV0dXJuIG5ldyBodShcInNlcnZlclRpbWVzdGFtcFwiKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgc3BlY2lhbCB2YWx1ZSB0aGF0IGNhbiBiZSB1c2VkIHdpdGgge0BsaW5rIEBmaXJlYmFzZS9maXJlc3RvcmUvbGl0ZSMoc2V0RG9jOjEpfSBvciB7QGxpbmtcbiAqIEBmaXJlYmFzZS9maXJlc3RvcmUvbGl0ZSModXBkYXRlRG9jOjEpfSB0aGF0IHRlbGxzIHRoZSBzZXJ2ZXIgdG8gdW5pb24gdGhlIGdpdmVuIGVsZW1lbnRzIHdpdGggYW55IGFycmF5XG4gKiB2YWx1ZSB0aGF0IGFscmVhZHkgZXhpc3RzIG9uIHRoZSBzZXJ2ZXIuIEVhY2ggc3BlY2lmaWVkIGVsZW1lbnQgdGhhdCBkb2Vzbid0XG4gKiBhbHJlYWR5IGV4aXN0IGluIHRoZSBhcnJheSB3aWxsIGJlIGFkZGVkIHRvIHRoZSBlbmQuIElmIHRoZSBmaWVsZCBiZWluZ1xuICogbW9kaWZpZWQgaXMgbm90IGFscmVhZHkgYW4gYXJyYXkgaXQgd2lsbCBiZSBvdmVyd3JpdHRlbiB3aXRoIGFuIGFycmF5XG4gKiBjb250YWluaW5nIGV4YWN0bHkgdGhlIHNwZWNpZmllZCBlbGVtZW50cy5cbiAqXG4gKiBAcGFyYW0gZWxlbWVudHMgLSBUaGUgZWxlbWVudHMgdG8gdW5pb24gaW50byB0aGUgYXJyYXkuXG4gKiBAcmV0dXJucyBUaGUgYEZpZWxkVmFsdWVgIHNlbnRpbmVsIGZvciB1c2UgaW4gYSBjYWxsIHRvIGBzZXREb2MoKWAgb3JcbiAqIGB1cGRhdGVEb2MoKWAuXG4gKi8gZnVuY3Rpb24gUGgoLi4udCkge1xuICAgIC8vIE5PVEU6IFdlIGRvbid0IGFjdHVhbGx5IHBhcnNlIHRoZSBkYXRhIHVudGlsIGl0J3MgdXNlZCBpbiBzZXQoKSBvclxuICAgIC8vIHVwZGF0ZSgpIHNpbmNlIHdlJ2QgbmVlZCB0aGUgRmlyZXN0b3JlIGluc3RhbmNlIHRvIGRvIHRoaXMuXG4gICAgcmV0dXJuIG5ldyBsdShcImFycmF5VW5pb25cIiwgdCk7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIHNwZWNpYWwgdmFsdWUgdGhhdCBjYW4gYmUgdXNlZCB3aXRoIHtAbGluayAoc2V0RG9jOjEpfSBvciB7QGxpbmtcbiAqIHVwZGF0ZURvYzoxfSB0aGF0IHRlbGxzIHRoZSBzZXJ2ZXIgdG8gcmVtb3ZlIHRoZSBnaXZlbiBlbGVtZW50cyBmcm9tIGFueVxuICogYXJyYXkgdmFsdWUgdGhhdCBhbHJlYWR5IGV4aXN0cyBvbiB0aGUgc2VydmVyLiBBbGwgaW5zdGFuY2VzIG9mIGVhY2ggZWxlbWVudFxuICogc3BlY2lmaWVkIHdpbGwgYmUgcmVtb3ZlZCBmcm9tIHRoZSBhcnJheS4gSWYgdGhlIGZpZWxkIGJlaW5nIG1vZGlmaWVkIGlzIG5vdFxuICogYWxyZWFkeSBhbiBhcnJheSBpdCB3aWxsIGJlIG92ZXJ3cml0dGVuIHdpdGggYW4gZW1wdHkgYXJyYXkuXG4gKlxuICogQHBhcmFtIGVsZW1lbnRzIC0gVGhlIGVsZW1lbnRzIHRvIHJlbW92ZSBmcm9tIHRoZSBhcnJheS5cbiAqIEByZXR1cm5zIFRoZSBgRmllbGRWYWx1ZWAgc2VudGluZWwgZm9yIHVzZSBpbiBhIGNhbGwgdG8gYHNldERvYygpYCBvclxuICogYHVwZGF0ZURvYygpYFxuICovIGZ1bmN0aW9uIGJoKC4uLnQpIHtcbiAgICAvLyBOT1RFOiBXZSBkb24ndCBhY3R1YWxseSBwYXJzZSB0aGUgZGF0YSB1bnRpbCBpdCdzIHVzZWQgaW4gc2V0KCkgb3JcbiAgICAvLyB1cGRhdGUoKSBzaW5jZSB3ZSdkIG5lZWQgdGhlIEZpcmVzdG9yZSBpbnN0YW5jZSB0byBkbyB0aGlzLlxuICAgIHJldHVybiBuZXcgZnUoXCJhcnJheVJlbW92ZVwiLCB0KTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgc3BlY2lhbCB2YWx1ZSB0aGF0IGNhbiBiZSB1c2VkIHdpdGgge0BsaW5rIEBmaXJlYmFzZS9maXJlc3RvcmUvbGl0ZSMoc2V0RG9jOjEpfSBvciB7QGxpbmtcbiAqIEBmaXJlYmFzZS9maXJlc3RvcmUvbGl0ZSModXBkYXRlRG9jOjEpfSB0aGF0IHRlbGxzIHRoZSBzZXJ2ZXIgdG8gaW5jcmVtZW50IHRoZSBmaWVsZCdzIGN1cnJlbnQgdmFsdWUgYnlcbiAqIHRoZSBnaXZlbiB2YWx1ZS5cbiAqXG4gKiBJZiBlaXRoZXIgdGhlIG9wZXJhbmQgb3IgdGhlIGN1cnJlbnQgZmllbGQgdmFsdWUgdXNlcyBmbG9hdGluZyBwb2ludFxuICogcHJlY2lzaW9uLCBhbGwgYXJpdGhtZXRpYyBmb2xsb3dzIElFRUUgNzU0IHNlbWFudGljcy4gSWYgYm90aCB2YWx1ZXMgYXJlXG4gKiBpbnRlZ2VycywgdmFsdWVzIG91dHNpZGUgb2YgSmF2YVNjcmlwdCdzIHNhZmUgbnVtYmVyIHJhbmdlXG4gKiAoYE51bWJlci5NSU5fU0FGRV9JTlRFR0VSYCB0byBgTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVJgKSBhcmUgYWxzbyBzdWJqZWN0IHRvXG4gKiBwcmVjaXNpb24gbG9zcy4gRnVydGhlcm1vcmUsIG9uY2UgcHJvY2Vzc2VkIGJ5IHRoZSBGaXJlc3RvcmUgYmFja2VuZCwgYWxsXG4gKiBpbnRlZ2VyIG9wZXJhdGlvbnMgYXJlIGNhcHBlZCBiZXR3ZWVuIC0yXjYzIGFuZCAyXjYzLTEuXG4gKlxuICogSWYgdGhlIGN1cnJlbnQgZmllbGQgdmFsdWUgaXMgbm90IG9mIHR5cGUgYG51bWJlcmAsIG9yIGlmIHRoZSBmaWVsZCBkb2VzIG5vdFxuICogeWV0IGV4aXN0LCB0aGUgdHJhbnNmb3JtYXRpb24gc2V0cyB0aGUgZmllbGQgdG8gdGhlIGdpdmVuIHZhbHVlLlxuICpcbiAqIEBwYXJhbSBuIC0gVGhlIHZhbHVlIHRvIGluY3JlbWVudCBieS5cbiAqIEByZXR1cm5zIFRoZSBgRmllbGRWYWx1ZWAgc2VudGluZWwgZm9yIHVzZSBpbiBhIGNhbGwgdG8gYHNldERvYygpYCBvclxuICogYHVwZGF0ZURvYygpYFxuICovIGZ1bmN0aW9uIHZoKHQpIHtcbiAgICByZXR1cm4gbmV3IGR1KFwiaW5jcmVtZW50XCIsIHQpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBDcmVhdGVzIGEgd3JpdGUgYmF0Y2gsIHVzZWQgZm9yIHBlcmZvcm1pbmcgbXVsdGlwbGUgd3JpdGVzIGFzIGEgc2luZ2xlXG4gKiBhdG9taWMgb3BlcmF0aW9uLiBUaGUgbWF4aW11bSBudW1iZXIgb2Ygd3JpdGVzIGFsbG93ZWQgaW4gYSBzaW5nbGUge0BsaW5rIFdyaXRlQmF0Y2h9XG4gKiBpcyA1MDAuXG4gKlxuICogVW5saWtlIHRyYW5zYWN0aW9ucywgd3JpdGUgYmF0Y2hlcyBhcmUgcGVyc2lzdGVkIG9mZmxpbmUgYW5kIHRoZXJlZm9yZSBhcmVcbiAqIHByZWZlcmFibGUgd2hlbiB5b3UgZG9uJ3QgbmVlZCB0byBjb25kaXRpb24geW91ciB3cml0ZXMgb24gcmVhZCBkYXRhLlxuICpcbiAqIEByZXR1cm5zIEEge0BsaW5rIFdyaXRlQmF0Y2h9IHRoYXQgY2FuIGJlIHVzZWQgdG8gYXRvbWljYWxseSBleGVjdXRlIG11bHRpcGxlXG4gKiB3cml0ZXMuXG4gKi8gZnVuY3Rpb24gVmgodCkge1xuICAgIHJldHVybiBPYyh0ID0gbWModCwgeGMpKSwgbmV3IGloKHQsIChlID0+IHBoKHQsIGUpKSk7XG59XG5cbi8qKlxuICogQ2xvdWQgRmlyZXN0b3JlXG4gKlxuICogQHBhY2thZ2VEb2N1bWVudGF0aW9uXG4gKi8gdmFyIFNoO1xuXG4hZnVuY3Rpb24odCkge1xuICAgIEQgPSB0O1xufShyKSwgcyhuZXcgbyhcImZpcmVzdG9yZVwiLCAoKHQsIHtvcHRpb25zOiBlfSkgPT4ge1xuICAgIGNvbnN0IG4gPSB0LmdldFByb3ZpZGVyKFwiYXBwXCIpLmdldEltbWVkaWF0ZSgpLCBzID0gbmV3IHhjKG4sIG5ldyB6KHQuZ2V0UHJvdmlkZXIoXCJhdXRoLWludGVybmFsXCIpKSk7XG4gICAgcmV0dXJuIGUgPSBPYmplY3QuYXNzaWduKHtcbiAgICAgICAgdXNlRmV0Y2hTdHJlYW1zOiAhMFxuICAgIH0sIGUpLCBzLl9zZXRTZXR0aW5ncyhlKSwgcztcbn0pLCBcIlBVQkxJQ1wiIC8qIFBVQkxJQyAqLykpLCBpKFwiQGZpcmViYXNlL2ZpcmVzdG9yZVwiLCBcIjMuMC4xXCIsIFNoKTtcblxuZXhwb3J0IHsgZWggYXMgQWJzdHJhY3RVc2VyRGF0YVdyaXRlciwgWWMgYXMgQnl0ZXMsIE5jIGFzIENBQ0hFX1NJWkVfVU5MSU1JVEVELCBBYyBhcyBDb2xsZWN0aW9uUmVmZXJlbmNlLCBUYyBhcyBEb2N1bWVudFJlZmVyZW5jZSwgRHUgYXMgRG9jdW1lbnRTbmFwc2hvdCwgSGMgYXMgRmllbGRQYXRoLCBYYyBhcyBGaWVsZFZhbHVlLCB4YyBhcyBGaXJlc3RvcmUsIEsgYXMgRmlyZXN0b3JlRXJyb3IsIFpjIGFzIEdlb1BvaW50LCBDYyBhcyBMb2FkQnVuZGxlVGFzaywgSWMgYXMgUXVlcnksIE91IGFzIFF1ZXJ5Q29uc3RyYWludCwgQ3UgYXMgUXVlcnlEb2N1bWVudFNuYXBzaG90LCBOdSBhcyBRdWVyeVNuYXBzaG90LCBTdSBhcyBTbmFwc2hvdE1ldGFkYXRhLCBzdCBhcyBUaW1lc3RhbXAsIFRoIGFzIFRyYW5zYWN0aW9uLCBpaCBhcyBXcml0ZUJhdGNoLCB1YyBhcyBfRGF0YWJhc2VJZCwgUHQgYXMgX0RvY3VtZW50S2V5LCBsdCBhcyBfRmllbGRQYXRoLCBtYyBhcyBfY2FzdCwgQiBhcyBfZGVidWdBc3NlcnQsIGR0IGFzIF9pc0Jhc2U2NEF2YWlsYWJsZSwgTyBhcyBfbG9nV2FybiwgZmMgYXMgX3ZhbGlkYXRlSXNOb3RVc2VkVG9nZXRoZXIsIG1oIGFzIGFkZERvYywgYmggYXMgYXJyYXlSZW1vdmUsIFBoIGFzIGFycmF5VW5pb24sIFVjIGFzIGNsZWFySW5kZXhlZERiUGVyc2lzdGVuY2UsIFJjIGFzIGNvbGxlY3Rpb24sIFBjIGFzIGNvbGxlY3Rpb25Hcm91cCwgRWMgYXMgY29ubmVjdEZpcmVzdG9yZUVtdWxhdG9yLCBfaCBhcyBkZWxldGVEb2MsIEFoIGFzIGRlbGV0ZUZpZWxkLCBqYyBhcyBkaXNhYmxlTmV0d29yaywgYmMgYXMgZG9jLCBKYyBhcyBkb2N1bWVudElkLCBNYyBhcyBlbmFibGVJbmRleGVkRGJQZXJzaXN0ZW5jZSwgTGMgYXMgZW5hYmxlTXVsdGlUYWJJbmRleGVkRGJQZXJzaXN0ZW5jZSwgS2MgYXMgZW5hYmxlTmV0d29yaywgSnUgYXMgZW5kQXQsIEh1IGFzIGVuZEJlZm9yZSwgT2MgYXMgZW5zdXJlRmlyZXN0b3JlQ29uZmlndXJlZCwgcGggYXMgZXhlY3V0ZVdyaXRlLCBvaCBhcyBnZXREb2MsIGNoIGFzIGdldERvY0Zyb21DYWNoZSwgdWggYXMgZ2V0RG9jRnJvbVNlcnZlciwgaGggYXMgZ2V0RG9jcywgbGggYXMgZ2V0RG9jc0Zyb21DYWNoZSwgZmggYXMgZ2V0RG9jc0Zyb21TZXJ2ZXIsICRjIGFzIGdldEZpcmVzdG9yZSwgdmggYXMgaW5jcmVtZW50LCBrYyBhcyBpbml0aWFsaXplRmlyZXN0b3JlLCBLdSBhcyBsaW1pdCwganUgYXMgbGltaXRUb0xhc3QsIFdjIGFzIGxvYWRCdW5kbGUsIEdjIGFzIG5hbWVkUXVlcnksIGdoIGFzIG9uU25hcHNob3QsIHloIGFzIG9uU25hcHNob3RzSW5TeW5jLCBVdSBhcyBvcmRlckJ5LCBGdSBhcyBxdWVyeSwgVmMgYXMgcXVlcnlFcXVhbCwgdmMgYXMgcmVmRXF1YWwsIEloIGFzIHJ1blRyYW5zYWN0aW9uLCBSaCBhcyBzZXJ2ZXJUaW1lc3RhbXAsIGRoIGFzIHNldERvYywgeCBhcyBzZXRMb2dMZXZlbCwga3UgYXMgc25hcHNob3RFcXVhbCwgR3UgYXMgc3RhcnRBZnRlciwgV3UgYXMgc3RhcnRBdCwgUWMgYXMgdGVybWluYXRlLCB3aCBhcyB1cGRhdGVEb2MsIHFjIGFzIHdhaXRGb3JQZW5kaW5nV3JpdGVzLCBMdSBhcyB3aGVyZSwgVmggYXMgd3JpdGVCYXRjaCB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguZXNtMjAxNy5qcy5tYXBcbiIsImltcG9ydCB7aW5pdGlhbGl6ZUFwcH0gZnJvbSAnZmlyZWJhc2UvYXBwJztcbmltcG9ydCB7Z2V0QXV0aCwgUmVjYXB0Y2hhVmVyaWZpZXJ9IGZyb20gJ2ZpcmViYXNlL2F1dGgnO1xuLy8gRmlyZXN0b3JlIChmb3Igc3RvcmluZyBtZXRhZGF0YSlcbmltcG9ydCB7IGdldEZpcmVzdG9yZSwgY29sbGVjdGlvbiwgYWRkRG9jIH0gZnJvbSBcImZpcmViYXNlL2ZpcmVzdG9yZVwiO1xuXG4vLyBGaXJlYmFzZSBTdG9yYWdlIChmb3IgdXBsb2FkaW5nIGZpbGVzKVxuaW1wb3J0IHsgZ2V0U3RvcmFnZSwgcmVmLCB1cGxvYWRCeXRlcywgZ2V0RG93bmxvYWRVUkwgfSBmcm9tIFwiZmlyZWJhc2Uvc3RvcmFnZVwiO1xuXG5jb25zdCBmaXJlYmFzZUNvbmZpZyA9IHtcblx0YXBpS2V5OiBcIkFJemFTeURFYlgtZ1E2RndKRDVvWkduYW9pSnU5cUlhQUcyTFowTVwiLFxuXHRhdXRoRG9tYWluOiBcInVwbG9hZC0yNWYwMS5maXJlYmFzZWFwcC5jb21cIixcblx0cHJvamVjdElkOiBcInVwbG9hZC0yNWYwMVwiLFxuXHRzdG9yYWdlQnVja2V0OiBcInVwbG9hZC0yNWYwMS5maXJlYmFzZXN0b3JhZ2UuYXBwXCIsXG5cdG1lc3NhZ2luZ1NlbmRlcklkOiBcIjk3MTY3NDg3NjkwXCIsXG5cdGFwcElkOiBcIjE6OTcxNjc0ODc2OTA6d2ViOjg4NDA5YWRlZDBhMWRkMTNmODdhMzNcIixcblx0bWVhc3VyZW1lbnRJZDogXCJHLTNZOTRLMVhDQktcIlxuICB9O1xuICBcbiAgLy8gSW5pdGlhbGl6ZSBGaXJlYmFzZVxuY29uc3QgYXBwID0gaW5pdGlhbGl6ZUFwcChmaXJlYmFzZUNvbmZpZyk7XG5jb25zdCBhdXRoID0gZ2V0QXV0aChhcHApOyAvLyBVc2UgY29tcGF0IHZlcnNpb24gb2YgYXV0aFxuXG4vLyBJbml0aWFsaXplIEZpcmVzdG9yZSBhbmQgU3RvcmFnZVxuY29uc3QgZGIgPSBnZXRGaXJlc3RvcmUoYXBwKTtcbmNvbnN0IHN0b3JhZ2UgPSBnZXRTdG9yYWdlKGFwcCk7XG5cbmV4cG9ydHthcHAsIGF1dGgsIFJlY2FwdGNoYVZlcmlmaWVyLCBkYiwgc3RvcmFnZX0iLCJpbXBvcnQgeyByZWdpc3RlclZlcnNpb24gfSBmcm9tICdAZmlyZWJhc2UvYXBwJztcbmV4cG9ydCAqIGZyb20gJ0BmaXJlYmFzZS9hcHAnO1xuXG52YXIgbmFtZSA9IFwiZmlyZWJhc2VcIjtcbnZhciB2ZXJzaW9uID0gXCI5LjAuMVwiO1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5yZWdpc3RlclZlcnNpb24obmFtZSwgdmVyc2lvbiwgJ2FwcCcpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguZXNtLmpzLm1hcFxuIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18uZyA9IChmdW5jdGlvbigpIHtcblx0aWYgKHR5cGVvZiBnbG9iYWxUaGlzID09PSAnb2JqZWN0JykgcmV0dXJuIGdsb2JhbFRoaXM7XG5cdHRyeSB7XG5cdFx0cmV0dXJuIHRoaXMgfHwgbmV3IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCk7XG5cdH0gY2F0Y2ggKGUpIHtcblx0XHRpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcpIHJldHVybiB3aW5kb3c7XG5cdH1cbn0pKCk7IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsImltcG9ydCB7IGRiLCBzdG9yYWdlIH0gZnJvbSAnLi9zZXR1cC5qcyc7XG5pbXBvcnQgeyByZWYgYXMgc3RvcmFnZVJlZiwgdXBsb2FkQnl0ZXMsIGdldERvd25sb2FkVVJMIH0gZnJvbSBcImZpcmViYXNlL3N0b3JhZ2VcIjtcbmltcG9ydCB7IGRvYyBhcyBmaXJlc3RvcmVEb2MsIHVwZGF0ZURvYywgc2VydmVyVGltZXN0YW1wIH0gZnJvbSBcImZpcmViYXNlL2ZpcmVzdG9yZVwiO1xuaW1wb3J0IHsgaGlnaGxpZ2h0QWN0aXZlTmF2IH0gZnJvbSAnLi9uYXZiYXIuanMnO1xuXG53aW5kb3cub25sb2FkID0gZnVuY3Rpb24oKSB7XG4gICAgY29uc3QgdXNlckRhdGEgPSBKU09OLnBhcnNlKHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ3VzZXJEYXRhJykpO1xuICAgIGlmICghdXNlckRhdGEgfHwgIXVzZXJEYXRhLnBob25lKSB7XG4gICAgICAgIGFsZXJ0KFwiVXNlciBzZXNzaW9uIGV4cGlyZWQuIFBsZWFzZSBsb2cgaW4gYWdhaW4uXCIpO1xuICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwiaW5kZXguaHRtbFwiO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IGRvY1N0cmluZyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdkb2N1bWVudFRvQmVFZGl0ZWQnKTtcbiAgICBpZiAoZG9jU3RyaW5nKSB7XG4gICAgICAgIGNvbnN0IGRvYyA9IEpTT04ucGFyc2UoZG9jU3RyaW5nKTtcbiAgICAgICAgZWRpdERvY3VtZW50KGRvYyk7IFxuICAgIH0gZWxzZSB7XG4gICAgICAgIGFsZXJ0KFwiTm8gZG9jdW1lbnQgZm91bmQgdG8gZWRpdCFcIik7XG4gICAgfVxufVxuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKCkgPT4ge1xuICAgIGhpZ2hsaWdodEFjdGl2ZU5hdigpO1xufSk7XG5cbmZ1bmN0aW9uIGVkaXREb2N1bWVudChkb2Mpe1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlZGl0LWRvY3VtZW50LXBhZ2UtY29udGFpbmVyJykuaW5uZXJIVE1MID0gXG4gICAgYCBcbiAgICA8ZGl2IGNsYXNzPVwiY29udGFpbmVyXCI+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJyb3cgbS0zXCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29sLTEyIHJvdyBtYi01IGFsaWduLWl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNvbnRlbnQtY2VudGVyXCI+XG4gICAgICAgICAgICAgICAgPGRpdiBpZD1cImVkaXQtZG9jdW1lbnQtZm9ybS13cmFwcGVyXCIgY2xhc3M9XCJjb2wtbGctNyBjb2wtbWQtMTAgY29sLTEyIG15LTMgcC1tZC01IHAtMyBib3JkZXIgYm9yZGVyLTIgcm91bmRlZCBzaGFkb3dcIj5cbiAgICAgICAgICAgICAgICAgICAgPGgyIGNsYXNzPVwidGV4dC1jZW50ZXIgbWItNFwiPkVkaXQgRG9jdW1lbnQ8L2gyPlxuICAgICAgICAgICAgICAgICAgICA8Zm9ybSBhY3Rpb249XCJcIiBpZD1cImVkaXQtZG9jdW1lbnQtcGFnZS1mb3JtXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8IS0tIERvY3VtZW50IE5hbWUgLS0+XG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibWItNFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9XCJlZGl0LWRvY3VtZW50LXBhZ2UtZG9jdW1lbnQtbmFtZVwiIGNsYXNzPVwiZm9ybS1sYWJlbFwiPkVudGVyIG5hbWUgb2YgdGhlIGRvY3VtZW50PC9sYWJlbD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cInRleHRcIiBjbGFzcz1cImZvcm0tY29udHJvbFwiIGlkPVwiZWRpdC1kb2N1bWVudC1wYWdlLWRvY3VtZW50LW5hbWVcIiB2YWx1ZT1cIiR7ZG9jLmRvY3VtZW50TmFtZX1cIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgICAgICAgICA8IS0tIERvY3VtZW50IFR5cGUgLS0+XG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibWItNFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9XCJlZGl0LWRvY3VtZW50LXBhZ2UtdHlwZS1vZi1kb2N1bWVudFwiIGNsYXNzPVwiZm9ybS1sYWJlbFwiPlNlbGVjdCB0aGUgdHlwZSBvZiB0aGUgZG9jdW1lbnQ8L2xhYmVsPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzZWxlY3QgY2xhc3M9XCJmb3JtLXNlbGVjdFwiIGlkPVwiZWRpdC1kb2N1bWVudC1wYWdlLXR5cGUtb2YtZG9jdW1lbnRcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiBzZWxlY3RlZD5TZWxlY3QgdGhlIHR5cGUgb2YgZG9jdW1lbnQ8L29wdGlvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIjFcIj5BYWRoYWFyIGNhcmQ8L29wdGlvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIjJcIj5Bcm1zIGxpY2Vuc2U8L29wdGlvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIjNcIj5CYW5rIHBhc3Nib29rPC9vcHRpb24+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCI0XCI+QmFuayBzdGF0ZW1lbnRzPC9vcHRpb24+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCI1XCI+QmlydGggY2VydGlmaWNhdGU8L29wdGlvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIjZcIj5Eb21pY2lsZSBjZXJ0aWZpY2F0ZSBpc3N1ZWQgYnkgZ292ZXJubWVudDwvb3B0aW9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiN1wiPkRyaXZpbmcgTGljZW5zZTwvb3B0aW9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiOFwiPkVkdWNhdGlvbmFsIGNlcnRpZmljYXRlPC9vcHRpb24+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCI5XCI+RWxlY3RvcnMgcGhvdG8gaWRlbnRpdHkgY2FyZDwvb3B0aW9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiMTBcIj5FbGVjdHJpY2l0eSBiaWxsPC9vcHRpb24+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCIxMVwiPkdhemV0dGVkIG9mZmljZXIgaXNzdWVkIGRvY3VtZW50czwvb3B0aW9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiMTJcIj5HYXMgY29ubmVjdGlvbiBkZXRhaWxzPC9vcHRpb24+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCIxM1wiPkxldHRlciBmcm9tIGVtcGxveWVyPC9vcHRpb24+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCIxNFwiPk1hcnJpYWdlIGNlcnRpZmljYXRlPC9vcHRpb24+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCIxNVwiPk1OUkVHQSBKb2IgY2FyZDwvb3B0aW9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiMTZcIj5QQU4gY2FyZDwvb3B0aW9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiMTdcIj5QYXNzcG9ydDwvb3B0aW9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiMThcIj5QZW5zaW9uIGNhcmQ8L29wdGlvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIjE5XCI+UGhvdG8gY3JlZGl0IGNhcmQ8L29wdGlvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIjIwXCI+UmVudCBhZ3JlZW1lbnQ8L29wdGlvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIjIxXCI+UmF0aW9uIGNhcmQ8L29wdGlvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIjIyXCI+VGF4IGNhcmQ8L29wdGlvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIjIzXCI+VGVsZXBob25lIGJpbGw8L29wdGlvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIjI0XCI+Vm90ZXIgSUQ8L29wdGlvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NlbGVjdD5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgICAgICAgICA8IS0tIEZpbGUgVXBsb2FkIC0tPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1iLTRcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAke2RvYy5maWxlVXJsID8gYDxwPkFscmVhZHkgdXBsb2FkZWQ6IDxhIGhyZWY9XCIke2RvYy5maWxlVXJsfVwiIHRhcmdldD1cIl9ibGFua1wiPiR7ZG9jLmRvY3VtZW50TmFtZX08L2E+PC9wPmAgOiAnJ31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgZm9yPVwiZWRpdC1kb2N1bWVudC1wYWdlLWRvY3VtZW50LXVwbG9hZFwiIGNsYXNzPVwiZm9ybS1sYWJlbFwiPlVwbG9hZCB5b3VyIG5ldyBkb2N1bWVudDwvbGFiZWw+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJmaWxlXCIgY2xhc3M9XCJmb3JtLWNvbnRyb2xcIiBpZD1cImVkaXQtZG9jdW1lbnQtcGFnZS1kb2N1bWVudC11cGxvYWRcIiBuYW1lPVwiZG9jdW1lbnRcIiBhY2NlcHQ9XCJhcHBsaWNhdGlvbi9wZGYsIGltYWdlLypcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgICAgICAgICA8IS0tIFN1Ym1pdCBCdXR0b24gLS0+XG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZC1ncmlkXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBpZD1cImVkaXQtZG9jdW1lbnQtcGFnZS1zdWJtaXQtYnV0dG9uXCIgdHlwZT1cInN1Ym1pdFwiIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5IGJ0bi1sZ1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTdWJtaXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8L2Zvcm0+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgPC9kaXY+YDtcbiAgICAvLyBOb3cgc2VsZWN0IHRoZSBvcHRpb24gYmFzZWQgb24gVEVYVFxuICAgIGNvbnN0IHNlbGVjdEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZWRpdC1kb2N1bWVudC1wYWdlLXR5cGUtb2YtZG9jdW1lbnQnKTtcbiAgICBjb25zdCBvcHRpb25zID0gc2VsZWN0RWxlbWVudC5vcHRpb25zO1xuXG4gICAgY29uc3QgZWRpdERvY3VtZW50UGFnZUZvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZWRpdC1kb2N1bWVudC1wYWdlLWZvcm0nKTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgb3B0aW9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAob3B0aW9uc1tpXS50ZXh0ID09PSBkb2MuZG9jdW1lbnRUeXBlKSB7XG4gICAgICAgICAgICBzZWxlY3RFbGVtZW50LnNlbGVjdGVkSW5kZXggPSBpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBlZGl0RG9jdW1lbnRQYWdlRm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBhc3luYyBmdW5jdGlvbiAoZSl7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICBjb25zdCBkb2NTdHJpbmcgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnZWRpdERvYycpO1xuICAgICAgICBpZiAoIWRvY1N0cmluZykge1xuICAgICAgICAgICAgYWxlcnQoJ05vIGRvY3VtZW50IHRvIGVkaXQuJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICBcbiAgICAgICAgY29uc3QgZWRpdERvY3VtZW50UGFnZU5hbWVPZkRvY3VtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJlZGl0LWRvY3VtZW50LXBhZ2UtZG9jdW1lbnQtbmFtZVwiKS52YWx1ZTtcbiAgICAgICAgY29uc3QgZWRpdERvY3VtZW50UGFnZVR5cGVPZkRvY3VtZW50T3B0aW9ucyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZWRpdC1kb2N1bWVudC1wYWdlLXR5cGUtb2YtZG9jdW1lbnRcIik7XG4gICAgICAgIGNvbnN0IGVkaXREb2N1bWVudFBhZ2VUeXBlT2ZEb2N1bWVudFNlbGVjdGVkID0gZWRpdERvY3VtZW50UGFnZVR5cGVPZkRvY3VtZW50T3B0aW9ucy5vcHRpb25zW2VkaXREb2N1bWVudFBhZ2VUeXBlT2ZEb2N1bWVudE9wdGlvbnMuc2VsZWN0ZWRJbmRleF0udGV4dDtcblxuICAgICAgICBjb25zdCBvbGREb2MgPSBKU09OLnBhcnNlKGRvY1N0cmluZyk7XG4gICAgICAgIGxldCBuZXdGaWxlVVJMID0gb2xkRG9jLmZpbGVVcmw7XG5cbiAgICAgICAgY29uc3QgZWRpdERvY3VtZW50UGFnZUZpbGVJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlZGl0LWRvY3VtZW50LXBhZ2UtZG9jdW1lbnQtdXBsb2FkJyk7XG4gICAgICAgIHZhciBlZGl0RG9jdW1lbnRQYWdlRmlsZVVwbG9hZGVkO1xuICAgICAgICB2YXIgZWRpdERvY3VtZW50UGFnZURvd25sb2FkVVJMO1xuXG4gICAgICAgIGlmKGVkaXREb2N1bWVudFBhZ2VGaWxlSW5wdXQuZmlsZXMubGVuZ3RoKXtcbiAgICAgICAgICAgIGVkaXREb2N1bWVudFBhZ2VGaWxlVXBsb2FkZWQgPSBlZGl0RG9jdW1lbnRQYWdlRmlsZUlucHV0LmZpbGVzWzBdO1xuXG4gICAgICAgICAgICBpZiAoZWRpdERvY3VtZW50UGFnZUZpbGVVcGxvYWRlZC5zaXplID4gMiAqIDEwMjQgKiAxMDI0KSB7XG4gICAgICAgICAgICAgICAgYWxlcnQoXCJGaWxlIHNpemUgbXVzdCBiZSBsZXNzIHRoYW4gMk1CLlwiKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFByb2NlZWQgd2l0aCB1cGxvYWQgdG8gRmlyZWJhc2UgU3RvcmFnZVxuICAgICAgICAgICAgY29uc3QgbmV3U3RvcmFnZVJlZiA9IHN0b3JhZ2VSZWYoc3RvcmFnZSwgYGRvY3VtZW50cy8ke2VkaXREb2N1bWVudFBhZ2VGaWxlVXBsb2FkZWQubmFtZX1fJHtEYXRlLm5vdygpfWApO1xuICAgICAgICAgICAgYXdhaXQgdXBsb2FkQnl0ZXMobmV3U3RvcmFnZVJlZiwgZWRpdERvY3VtZW50UGFnZUZpbGVVcGxvYWRlZCk7XG4gICAgICAgICAgICBlZGl0RG9jdW1lbnRQYWdlRG93bmxvYWRVUkwgPSBhd2FpdCBnZXREb3dubG9hZFVSTChuZXdTdG9yYWdlUmVmKTtcbiAgICAgICAgICAgIG5ld0ZpbGVVUkwgPSBlZGl0RG9jdW1lbnRQYWdlRG93bmxvYWRVUkw7XG4gICAgICAgIH1cbiAgICAgICBcbiAgICAgICAgY29uc3QgZG9jUmVmID0gZmlyZXN0b3JlRG9jKGRiLCBcImRvY3VtZW50c1wiLCBvbGREb2MuaWQpO1xuICAgICAgIFxuICAgICAgICAvLyBUaGVuIHNhdmUgbWV0YWRhdGEgdG8gRmlyZXN0b3JlXG4gICAgICAgIGF3YWl0IHVwZGF0ZURvYyhkb2NSZWYsIHtcbiAgICAgICAgICAgIGRvY3VtZW50TmFtZTogZWRpdERvY3VtZW50UGFnZU5hbWVPZkRvY3VtZW50LFxuICAgICAgICAgICAgZG9jdW1lbnRUeXBlOiBlZGl0RG9jdW1lbnRQYWdlVHlwZU9mRG9jdW1lbnRTZWxlY3RlZCxcbiAgICAgICAgICAgIGZpbGVOYW1lOiBlZGl0RG9jdW1lbnRQYWdlRmlsZVVwbG9hZGVkID8gZWRpdERvY3VtZW50UGFnZUZpbGVVcGxvYWRlZC5uYW1lIDogb2xkRG9jLmZpbGVOYW1lLFxuICAgICAgICAgICAgZmlsZVR5cGU6IGVkaXREb2N1bWVudFBhZ2VGaWxlVXBsb2FkZWQgPyBlZGl0RG9jdW1lbnRQYWdlRmlsZVVwbG9hZGVkLnR5cGUgOiBvbGREb2MuZmlsZVR5cGUsXG4gICAgICAgICAgICBmaWxlU2l6ZTogZWRpdERvY3VtZW50UGFnZUZpbGVVcGxvYWRlZCA/IGVkaXREb2N1bWVudFBhZ2VGaWxlVXBsb2FkZWQuc2l6ZSA6IG9sZERvYy5maWxlU2l6ZSxcbiAgICAgICAgICAgIGZpbGVVcmw6IG5ld0ZpbGVVUkwsXG4gICAgICAgICAgICB1cGRhdGVkQXQ6IHNlcnZlclRpbWVzdGFtcCgpXG4gICAgICAgIH0pO1xuICAgIFxuICAgICAgICBhbGVydChcIkRvY3VtZW50IHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5IVwiKTtcbiAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSAndmlld19kb2N1bWVudHNfcGFnZS5odG1sJzsgIC8vIFJlZGlyZWN0IGJhY2tcbiAgICB9KVxuXG59XG4iXSwibmFtZXMiOlsiZXh0ZW5kU3RhdGljcyIsImQiLCJiIiwiT2JqZWN0Iiwic2V0UHJvdG90eXBlT2YiLCJfX3Byb3RvX18iLCJBcnJheSIsInAiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJfX3ZhbHVlcyIsIm8iLCJzIiwiU3ltYm9sIiwiaXRlcmF0b3IiLCJtIiwiaSIsImxlbmd0aCIsIm5leHQiLCJ2YWx1ZSIsImRvbmUiLCJUeXBlRXJyb3IiLCJrIiwiY29tbW9uanNHbG9iYWwiLCJnbG9iYWxUaGlzIiwid2luZG93IiwiZyIsInNlbGYiLCJnb29nIiwibCIsImFhIiwiYmEiLCJhIiwiaXNBcnJheSIsImVhIiwiTWF0aCIsInJhbmRvbSIsImZhIiwiaGEiLCJjIiwiYXBwbHkiLCJiaW5kIiwiYXJndW1lbnRzIiwiaWEiLCJFcnJvciIsInNsaWNlIiwiZSIsInVuc2hpZnQiLCJxIiwiRnVuY3Rpb24iLCJ0b1N0cmluZyIsImluZGV4T2YiLCJqYSIsInB1c2giLCJ0aGlzIiwidCIsIloiLCJjb25zdHJ1Y3RvciIsIlZiIiwiZiIsImgiLCJuIiwidiIsImxhIiwibmEiLCJNIiwiZGEiLCJzaGlmdCIsIm1hIiwiZm9yRWFjaCIsInNwbGl0IiwicWEiLCJjb25jYXQiLCJyYSIsInNhIiwidGVzdCIsIngiLCJ0YSIsIlN0cmluZyIsInRyaW0iLCJleGVjIiwidyIsInVhIiwidmEiLCJuYXZpZ2F0b3IiLCJ3YSIsInVzZXJBZ2VudCIsInhhIiwieWEiLCJ6YSIsIkFhIiwiQ2EiLCJOYSIsIkhhIiwieSIsIklhIiwiSmEiLCJLYSIsInRvTG93ZXJDYXNlIiwiTGEiLCJNYSIsImRvY3VtZW50IiwiZG9jdW1lbnRNb2RlIiwiT2EiLCJQYSIsIlFhIiwicGFyc2VGbG9hdCIsIlNhIiwiR2EiLCJSYSIsIm1heCIsInBhcnNlSW50IiwiVWEiLCJWYSIsImFkZEV2ZW50TGlzdGVuZXIiLCJkZWZpbmVQcm9wZXJ0eSIsImdldCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJ6IiwidHlwZSIsInRhcmdldCIsImRlZmF1bHRQcmV2ZW50ZWQiLCJBIiwicmVsYXRlZFRhcmdldCIsImJ1dHRvbiIsInNjcmVlblkiLCJzY3JlZW5YIiwiY2xpZW50WSIsImNsaWVudFgiLCJrZXkiLCJtZXRhS2V5Iiwic2hpZnRLZXkiLCJhbHRLZXkiLCJjdHJsS2V5Iiwic3RhdGUiLCJwb2ludGVySWQiLCJwb2ludGVyVHlwZSIsImNoYW5nZWRUb3VjaGVzIiwic3JjRWxlbWVudCIsIm5vZGVOYW1lIiwiZnJvbUVsZW1lbnQiLCJ0b0VsZW1lbnQiLCJwYWdlWCIsInBhZ2VZIiwiV2EiLCJwcmV2ZW50RGVmYXVsdCIsInJldHVyblZhbHVlIiwiQiIsIlhhIiwiWWEiLCJsaXN0ZW5lciIsInByb3h5Iiwic3JjIiwiY2FwdHVyZSIsImNhIiwiWmEiLCIkYSIsImJiIiwic3BsaWNlIiwiYWIiLCJhZGQiLCJjYiIsImRiIiwiZmIiLCJvbmNlIiwiZ2IiLCJoYiIsIk4iLCJpYiIsImpiIiwibWIiLCJrYiIsImF0dGFjaEV2ZW50IiwibGIiLCJhZGRMaXN0ZW5lciIsInJlbW92ZUxpc3RlbmVyIiwiTyIsIm5iIiwib2IiLCJkZXRhY2hFdmVudCIsInBiIiwiaGFuZGxlRXZlbnQiLCJDIiwiUCIsIkkiLCJEIiwicWIiLCJ1IiwicmIiLCJKU09OIiwic3RyaW5naWZ5Iiwic2IiLCJ0YiIsIkFiIiwidWIiLCJ2YiIsInNldCIsImNsYXNzXzIiLCJqIiwid2IiLCJyZXNldCIsInliIiwic2V0VGltZW91dCIsInpiIiwiUHJvbWlzZSIsInJlc29sdmUiLCJ0aGVuIiwiRGIiLCJCYiIsIkNiIiwiRWIiLCJEYXRlIiwibm93IiwiRmIiLCJTIiwiY2xlYXJUaW1lb3V0IiwiR2IiLCJOdW1iZXIiLCJIYiIsInN0YXJ0IiwiSWIiLCJfc3VwZXIiLCJfdGhpcyIsIl9fIiwiY3JlYXRlIiwiX19leHRlbmRzIiwiRSIsIkpiIiwiS2IiLCJMYiIsIk1iIiwiRiIsImluZm8iLCJwYXJzZSIsIlBiIiwiSCIsIlJiIiwiU2IiLCJUYiIsIlViIiwiU1RBVF9FVkVOVCIsInN0YXQiLCJKIiwic2l6ZSIsIksiLCJXYiIsIk5PX0VSUk9SIiwieGIiLCJUSU1FT1VUIiwiWGIiLCJZYiIsIlpiIiwiJGIiLCJjYyIsIkwiLCJPUEVOIiwiYWMiLCJiYyIsImRjIiwiWCIsIlYiLCJlYyIsIlciLCJZIiwiJCIsIlUiLCJmYyIsIlhNTEh0dHBSZXF1ZXN0IiwiZ2MiLCJoYyIsImljIiwiamMiLCJrYyIsImxjIiwibWMiLCJuYyIsInIiLCJHIiwiTmIiLCJxYyIsIkJhIiwidGMiLCJ2YyIsInNjIiwid2MiLCJyYyIsInN1YnN0cmluZyIsImlzTmFOIiwic3Vic3RyIiwieGMiLCJlYiIsInBjIiwidWMiLCJhYm9ydCIsInljIiwiemMiLCJBYyIsIkJjIiwiQ2MiLCJrYSIsIlEiLCJEYSIsIkVhIiwiZ2V0UmVzcG9uc2VIZWFkZXIiLCJTZXQiLCJEYyIsIlIiLCJvYSIsIkVjIiwiRmMiLCJHYyIsIkhjIiwiSWMiLCJLYyIsIlQiLCJKYyIsIkxjIiwiZ2EiLCJvYyIsIlRleHREZWNvZGVyIiwiZGVjb2RlIiwic3RyZWFtIiwiT2IiLCJjYW5jZWwiLCJRYiIsIk1jIiwiT2MiLCJQYyIsIlFjIiwiUmMiLCJTYyIsIm1hdGNoIiwiVGMiLCJyZXBsYWNlIiwiZGQiLCJaYyIsIlVjIiwiJGMiLCJmbG9vciIsImFicyIsImRlY29kZVVSSSIsImRlY29kZVVSSUNvbXBvbmVudCIsImVuY29kZVVSSSIsImNkIiwiY2hhckNvZGVBdCIsIlZjIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwiY2hhckF0IiwiV2MiLCJYYyIsIlljIiwiam9pbiIsIk5jIiwiZWQiLCJmZCIsImdkIiwiaGQiLCJQZXJmb3JtYW5jZU5hdmlnYXRpb25UaW1pbmciLCJwZXJmb3JtYW5jZSIsImdldEVudHJpZXNCeVR5cGUiLCJuZXh0SG9wUHJvdG9jb2wiLCJpZCIsImhhcyIsImRlbGV0ZSIsImpkIiwiZV8yIiwiX2EiLCJfYiIsInZhbHVlcyIsIl9jIiwiZV8yXzEiLCJlcnJvciIsInJldHVybiIsImtkIiwibGQiLCJtZCIsIm9kIiwib25sb2FkIiwib25lcnJvciIsIm9uYWJvcnQiLCJvbnRpbWVvdXQiLCJwZCIsInFkIiwicmVhZHlTdGF0ZSIsInJkIiwic3RhdHVzIiwicmVzcG9uc2VUeXBlIiwicmVzcG9uc2VUZXh0IiwicmVzcG9uc2UiLCJzdGF0dXNUZXh0Iiwib25yZWFkeXN0YXRlY2hhbmdlIiwiSGVhZGVycyIsImVfMSIsImVfMV8xIiwiY2xlYXIiLCJ1ZCIsInJlYWQiLCJjYXRjaCIsInRkIiwic2QiLCJvcGVuIiwic2VuZCIsImhlYWRlcnMiLCJtZXRob2QiLCJjcmVkZW50aWFscyIsImNhY2hlIiwiYm9keSIsImZldGNoIiwiUmVxdWVzdCIsImFycmF5QnVmZmVyIiwiVGEiLCJSZWFkYWJsZVN0cmVhbSIsImdldFJlYWRlciIsInRleHQiLCJVaW50OEFycmF5Iiwic2V0UmVxdWVzdEhlYWRlciIsImFwcGVuZCIsImdldEFsbFJlc3BvbnNlSGVhZGVycyIsImVudHJpZXMiLCJ2ZCIsIndkIiwieGQiLCJ5ZCIsInBhIiwiemQiLCJDZCIsIkRkIiwiRWQiLCJGYSIsImxvY2F0aW9uIiwicHJvdG9jb2wiLCJBZCIsIm1velJlc3BvbnNlQXJyYXlCdWZmZXIiLCJHZCIsIkZkIiwiSGQiLCJpbnRlcm5hbENoYW5uZWxQYXJhbXMiLCJJZCIsInhtbEh0dHBGYWN0b3J5Iiwic3VwcG9ydHNDcm9zc0RvbWFpblhociIsImNvbmN1cnJlbnRSZXF1ZXN0TGltaXQiLCJmYXN0SGFuZHNoYWtlIiwiZm9yY2VMb25nUG9sbGluZyIsImRldGVjdEJ1ZmZlcmluZ1Byb3h5IiwiSmQiLCJLZCIsInNlbmRCZWFjb24iLCJJbWFnZSIsIkxkIiwiTWQiLCJRZCIsIlBkIiwicm91bmQiLCJtaW4iLCJPZCIsIlJkIiwiTmQiLCJkXzEiLCJuZCIsImFkIiwiYmQiLCJob3N0bmFtZSIsInBvcnQiLCJTZCIsIlRkIiwibWVzc2FnZVVybFBhcmFtcyIsIm1lc3NhZ2VIZWFkZXJzIiwiY2xpZW50UHJvdG9jb2xIZWFkZXJSZXF1aXJlZCIsImluaXRNZXNzYWdlSGVhZGVycyIsIm1lc3NhZ2VDb250ZW50VHlwZSIsImh0dHBIZWFkZXJzT3ZlcndyaXRlUGFyYW0iLCJzZW5kUmF3SnNvbiIsImh0dHBTZXNzaW9uSWRQYXJhbSIsIlVkIiwiX19zbV9fIiwiZGF0YSIsIlZkIiwidG9VcHBlckNhc2UiLCJGb3JtRGF0YSIsIndpdGhDcmVkZW50aWFscyIsInRpbWVvdXQiLCJCZCIsIl9fZGF0YV9fIiwiY2xvc2UiLCJjcmVhdGVXZWJDaGFubmVsIiwiSFRUUF9FUlJPUiIsIkNPTVBMRVRFIiwiRXZlbnRUeXBlIiwiQ0xPU0UiLCJFUlJPUiIsIk1FU1NBR0UiLCJsaXN0ZW4iLCJsaXN0ZW5PbmNlIiwiZ2V0TGFzdEVycm9yIiwiZ2V0TGFzdEVycm9yQ29kZSIsImdldFN0YXR1cyIsImdldFJlc3BvbnNlSnNvbiIsImdldFJlc3BvbnNlVGV4dCIsImNyZWF0ZVdlYkNoYW5uZWxUcmFuc3BvcnQiLCJnZXRTdGF0RXZlbnRUYXJnZXQiLCJFcnJvckNvZGUiLCJFdmVudCIsIlN0YXQiLCJQUk9YWSIsIk5PUFJPWFkiLCJGZXRjaFhtbEh0dHBGYWN0b3J5IiwiV2ViQ2hhbm5lbCIsIlhocklvIiwiaGlnaGxpZ2h0QWN0aXZlTmF2IiwibmF2TGlua3MiLCJxdWVyeVNlbGVjdG9yQWxsIiwiY3VycmVudFBhdGgiLCJwYXRobmFtZSIsInBvcCIsImxpbmsiLCJsaW5rUGF0aCIsImdldEF0dHJpYnV0ZSIsImluY2x1ZGVzIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwiQ29tcG9uZW50IiwibmFtZSIsImluc3RhbmNlRmFjdG9yeSIsIm11bHRpcGxlSW5zdGFuY2VzIiwic2VydmljZVByb3BzIiwiaW5zdGFudGlhdGlvbk1vZGUiLCJvbkluc3RhbmNlQ3JlYXRlZCIsInNldEluc3RhbnRpYXRpb25Nb2RlIiwibW9kZSIsInNldE11bHRpcGxlSW5zdGFuY2VzIiwic2V0U2VydmljZVByb3BzIiwicHJvcHMiLCJzZXRJbnN0YW5jZUNyZWF0ZWRDYWxsYmFjayIsImNhbGxiYWNrIiwiREVGQVVMVF9FTlRSWV9OQU1FIiwiUHJvdmlkZXIiLCJjb250YWluZXIiLCJjb21wb25lbnQiLCJpbnN0YW5jZXMiLCJNYXAiLCJpbnN0YW5jZXNEZWZlcnJlZCIsImluc3RhbmNlc09wdGlvbnMiLCJvbkluaXRDYWxsYmFja3MiLCJpZGVudGlmaWVyIiwibm9ybWFsaXplZElkZW50aWZpZXIiLCJub3JtYWxpemVJbnN0YW5jZUlkZW50aWZpZXIiLCJkZWZlcnJlZCIsImlzSW5pdGlhbGl6ZWQiLCJzaG91bGRBdXRvSW5pdGlhbGl6ZSIsImluc3RhbmNlIiwiZ2V0T3JJbml0aWFsaXplU2VydmljZSIsImluc3RhbmNlSWRlbnRpZmllciIsInByb21pc2UiLCJnZXRJbW1lZGlhdGUiLCJvcHRpb25zIiwib3B0aW9uYWwiLCJnZXRDb21wb25lbnQiLCJzZXRDb21wb25lbnQiLCJpc0NvbXBvbmVudEVhZ2VyIiwiX2QiLCJpbnN0YW5jZURlZmVycmVkIiwiY2xlYXJJbnN0YW5jZSIsInNlcnZpY2VzIiwibGFiZWwiLCJmcm9tIiwiYWxsIiwiZmlsdGVyIiwic2VydmljZSIsIm1hcCIsIklOVEVSTkFMIiwiX2RlbGV0ZSIsInNlbnQiLCJpc0NvbXBvbmVudFNldCIsImdldE9wdGlvbnMiLCJpbml0aWFsaXplIiwib3B0cyIsIl9lIiwib25Jbml0IiwiZXhpc3RpbmdDYWxsYmFja3MiLCJleGlzdGluZ0luc3RhbmNlIiwiaW52b2tlT25Jbml0Q2FsbGJhY2tzIiwiZV8zIiwiY2FsbGJhY2tzIiwiY2FsbGJhY2tzXzEiLCJjYWxsYmFja3NfMV8xIiwiZV8zXzEiLCJ1bmRlZmluZWQiLCJDb21wb25lbnRDb250YWluZXIiLCJwcm92aWRlcnMiLCJhZGRDb21wb25lbnQiLCJwcm92aWRlciIsImdldFByb3ZpZGVyIiwiYWRkT3JPdmVyd3JpdGVDb21wb25lbnQiLCJnZXRQcm92aWRlcnMiLCJfREVGQVVMVF9BVVRIX0VSUk9SX0ZBQ1RPUlkiLCJsb2dDbGllbnQiLCJfbG9nRXJyb3IiLCJtc2ciLCJhcmdzIiwibG9nTGV2ZWwiLCJfZmFpbCIsImF1dGhPckNvZGUiLCJyZXN0IiwiY3JlYXRlRXJyb3JJbnRlcm5hbCIsIl9jcmVhdGVFcnJvciIsImNvZGUiLCJmdWxsUGFyYW1zIiwiYXBwTmFtZSIsIl9lcnJvckZhY3RvcnkiLCJfYXNzZXJ0IiwiYXNzZXJ0aW9uIiwiZGVidWdGYWlsIiwiZmFpbHVyZSIsIm1lc3NhZ2UiLCJkZWJ1Z0Fzc2VydCIsImluc3RhbmNlQ2FjaGUiLCJfZ2V0SW5zdGFuY2UiLCJjbHMiLCJfZ2V0Q3VycmVudFVybCIsImhyZWYiLCJfZ2V0Q3VycmVudFNjaGVtZSIsIkRlbGF5Iiwic2hvcnREZWxheSIsImxvbmdEZWxheSIsImlzTW9iaWxlIiwib25MaW5lIiwiX2VtdWxhdG9yVXJsIiwiY29uZmlnIiwicGF0aCIsImVtdWxhdG9yIiwidXJsIiwic3RhcnRzV2l0aCIsIkZldGNoUHJvdmlkZXIiLCJmZXRjaEltcGwiLCJoZWFkZXJzSW1wbCIsInJlc3BvbnNlSW1wbCIsIlJlc3BvbnNlIiwiU0VSVkVSX0VSUk9SX01BUCIsIkRFRkFVTFRfQVBJX1RJTUVPVVRfTVMiLCJfYWRkVGlkSWZOZWNlc3NhcnkiLCJhdXRoIiwicmVxdWVzdCIsInRlbmFudElkIiwiYXNzaWduIiwiYXN5bmMiLCJfcGVyZm9ybUFwaVJlcXVlc3QiLCJjdXN0b21FcnJvck1hcCIsIl9wZXJmb3JtRmV0Y2hXaXRoRXJyb3JIYW5kbGluZyIsInBhcmFtcyIsInF1ZXJ5IiwiYXBpS2V5IiwiX2dldFNka0NsaWVudFZlcnNpb24iLCJsYW5ndWFnZUNvZGUiLCJfZ2V0RmluYWxUYXJnZXQiLCJhcGlIb3N0IiwicmVmZXJyZXJQb2xpY3kiLCJmZXRjaEZuIiwiX2NhbkluaXRFbXVsYXRvciIsImVycm9yTWFwIiwibmV0d29ya1RpbWVvdXQiLCJOZXR3b3JrVGltZW91dCIsInJhY2UiLCJjbGVhck5ldHdvcmtUaW1lb3V0IiwianNvbiIsIl9tYWtlVGFnZ2VkRXJyb3IiLCJvayIsInNlcnZlckVycm9yQ29kZSIsImVycm9yTWVzc2FnZSIsIl9wZXJmb3JtU2lnbkluUmVxdWVzdCIsInNlcnZlclJlc3BvbnNlIiwiaG9zdCIsImJhc2UiLCJhcGlTY2hlbWUiLCJ0aW1lciIsIl8iLCJyZWplY3QiLCJlcnJvclBhcmFtcyIsImVtYWlsIiwicGhvbmVOdW1iZXIiLCJjdXN0b21EYXRhIiwiX3Rva2VuUmVzcG9uc2UiLCJ1dGNUaW1lc3RhbXBUb0RhdGVTdHJpbmciLCJ1dGNUaW1lc3RhbXAiLCJkYXRlIiwiZ2V0VGltZSIsInRvVVRDU3RyaW5nIiwic2Vjb25kc1N0cmluZ1RvTWlsbGlzZWNvbmRzIiwic2Vjb25kcyIsIl9wYXJzZVRva2VuIiwidG9rZW4iLCJhbGdvcml0aG0iLCJwYXlsb2FkIiwic2lnbmF0dXJlIiwiZGVjb2RlZCIsIl9sb2dvdXRJZkludmFsaWRhdGVkIiwidXNlciIsImJ5cGFzc0F1dGhTdGF0ZSIsImlzVXNlckludmFsaWRhdGVkIiwiY3VycmVudFVzZXIiLCJzaWduT3V0IiwiUHJvYWN0aXZlUmVmcmVzaCIsImlzUnVubmluZyIsInRpbWVySWQiLCJlcnJvckJhY2tvZmYiLCJfc3RhcnQiLCJzY2hlZHVsZSIsIl9zdG9wIiwiZ2V0SW50ZXJ2YWwiLCJ3YXNFcnJvciIsImludGVydmFsIiwic3RzVG9rZW5NYW5hZ2VyIiwiZXhwaXJhdGlvblRpbWUiLCJpdGVyYXRpb24iLCJnZXRJZFRva2VuIiwiVXNlck1ldGFkYXRhIiwiY3JlYXRlZEF0IiwibGFzdExvZ2luQXQiLCJfaW5pdGlhbGl6ZVRpbWUiLCJsYXN0U2lnbkluVGltZSIsImNyZWF0aW9uVGltZSIsIl9jb3B5IiwibWV0YWRhdGEiLCJ0b0pTT04iLCJfcmVsb2FkV2l0aG91dFNhdmluZyIsImlkVG9rZW4iLCJnZXRBY2NvdW50SW5mbyIsInVzZXJzIiwiY29yZUFjY291bnQiLCJfbm90aWZ5UmVsb2FkTGlzdGVuZXIiLCJuZXdQcm92aWRlckRhdGEiLCJwcm92aWRlclVzZXJJbmZvIiwicHJvdmlkZXJJZCIsInVpZCIsInJhd0lkIiwiZGlzcGxheU5hbWUiLCJwaG90b1VSTCIsInBob3RvVXJsIiwicHJvdmlkZXJEYXRhIiwib3JpZ2luYWwiLCJuZXdEYXRhIiwic29tZSIsIm9sZElzQW5vbnltb3VzIiwiaXNBbm9ueW1vdXMiLCJuZXdJc0Fub255bW91cyIsInBhc3N3b3JkSGFzaCIsInVwZGF0ZXMiLCJsb2NhbElkIiwiZW1haWxWZXJpZmllZCIsIlN0c1Rva2VuTWFuYWdlciIsInJlZnJlc2hUb2tlbiIsImFjY2Vzc1Rva2VuIiwiaXNFeHBpcmVkIiwidXBkYXRlRnJvbVNlcnZlclJlc3BvbnNlIiwiZXhwaXJlc0luIiwicGFyc2VkVG9rZW4iLCJleHAiLCJpYXQiLCJfdG9rZW5FeHBpcmVzSW4iLCJ1cGRhdGVUb2tlbnNBbmRFeHBpcmF0aW9uIiwiZ2V0VG9rZW4iLCJmb3JjZVJlZnJlc2giLCJyZWZyZXNoIiwiY2xlYXJSZWZyZXNoVG9rZW4iLCJvbGRUb2tlbiIsInRva2VuQXBpSG9zdCIsImFjY2Vzc190b2tlbiIsImV4cGlyZXNfaW4iLCJyZWZyZXNoX3Rva2VuIiwicmVxdWVzdFN0c1Rva2VuIiwiZXhwaXJlc0luU2VjIiwiZnJvbUpTT04iLCJvYmplY3QiLCJtYW5hZ2VyIiwiX2Fzc2lnbiIsIl9jbG9uZSIsIl9wZXJmb3JtUmVmcmVzaCIsImFzc2VydFN0cmluZ09yVW5kZWZpbmVkIiwiVXNlckltcGwiLCJvcHQiLCJwcm9hY3RpdmVSZWZyZXNoIiwicmVsb2FkVXNlckluZm8iLCJyZWxvYWRMaXN0ZW5lciIsIl9wZXJzaXN0VXNlcklmQ3VycmVudCIsIl9ub3RpZnlMaXN0ZW5lcnNJZkN1cnJlbnQiLCJnZXRJZFRva2VuUmVzdWx0IiwidXNlckludGVybmFsIiwiY2xhaW1zIiwiYXV0aF90aW1lIiwiZmlyZWJhc2UiLCJzaWduSW5Qcm92aWRlciIsImF1dGhUaW1lIiwiaXNzdWVkQXRUaW1lIiwic2lnbkluU2Vjb25kRmFjdG9yIiwicmVsb2FkIiwidXNlckluZm8iLCJfb25SZWxvYWQiLCJfc3RhcnRQcm9hY3RpdmVSZWZyZXNoIiwiX3N0b3BQcm9hY3RpdmVSZWZyZXNoIiwiX3VwZGF0ZVRva2Vuc0lmTmVjZXNzYXJ5IiwidG9rZW5zUmVmcmVzaGVkIiwiZGVsZXRlQWNjb3VudCIsIl9yZWRpcmVjdEV2ZW50SWQiLCJfZnJvbUpTT04iLCJfZiIsIl9nIiwiX2giLCJwbGFpbk9iamVjdFRva2VuTWFuYWdlciIsIl9mcm9tSWRUb2tlblJlc3BvbnNlIiwiaWRUb2tlblJlc3BvbnNlIiwiSW5NZW1vcnlQZXJzaXN0ZW5jZSIsInN0b3JhZ2UiLCJfaXNBdmFpbGFibGUiLCJfc2V0IiwiX2dldCIsIl9yZW1vdmUiLCJfYWRkTGlzdGVuZXIiLCJfa2V5IiwiX2xpc3RlbmVyIiwiX3JlbW92ZUxpc3RlbmVyIiwiaW5NZW1vcnlQZXJzaXN0ZW5jZSIsIl9wZXJzaXN0ZW5jZUtleU5hbWUiLCJQZXJzaXN0ZW5jZVVzZXJNYW5hZ2VyIiwicGVyc2lzdGVuY2UiLCJ1c2VyS2V5IiwiZnVsbFVzZXJLZXkiLCJmdWxsUGVyc2lzdGVuY2VLZXkiLCJib3VuZEV2ZW50SGFuZGxlciIsIl9vblN0b3JhZ2VFdmVudCIsInNldEN1cnJlbnRVc2VyIiwiZ2V0Q3VycmVudFVzZXIiLCJibG9iIiwicmVtb3ZlQ3VycmVudFVzZXIiLCJzYXZlUGVyc2lzdGVuY2VGb3JSZWRpcmVjdCIsInNldFBlcnNpc3RlbmNlIiwibmV3UGVyc2lzdGVuY2UiLCJwZXJzaXN0ZW5jZUhpZXJhcmNoeSIsImF2YWlsYWJsZVBlcnNpc3RlbmNlcyIsInNlbGVjdGVkUGVyc2lzdGVuY2UiLCJ1c2VyVG9NaWdyYXRlIiwibWlncmF0aW9uSGllcmFyY2h5IiwiX3Nob3VsZEFsbG93TWlncmF0aW9uIiwiX2dldEJyb3dzZXJOYW1lIiwiX2lzSUVNb2JpbGUiLCJfaXNGaXJlZm94IiwiX2lzQmxhY2tCZXJyeSIsIl9pc1dlYk9TIiwiX2lzU2FmYXJpIiwiX2lzQ2hyb21lSU9TIiwiX2lzQW5kcm9pZCIsInJlIiwibWF0Y2hlcyIsIl9pc0lPUyIsIl9pc01vYmlsZUJyb3dzZXIiLCJfZ2V0Q2xpZW50VmVyc2lvbiIsImNsaWVudFBsYXRmb3JtIiwiZnJhbWV3b3JrcyIsInJlcG9ydGVkUGxhdGZvcm0iLCJyZXBvcnRlZEZyYW1ld29ya3MiLCJBdXRoSW1wbCIsImFwcCIsImVtdWxhdG9yQ29uZmlnIiwib3BlcmF0aW9ucyIsImF1dGhTdGF0ZVN1YnNjcmlwdGlvbiIsIlN1YnNjcmlwdGlvbiIsImlkVG9rZW5TdWJzY3JpcHRpb24iLCJyZWRpcmVjdFVzZXIiLCJpc1Byb2FjdGl2ZVJlZnJlc2hFbmFibGVkIiwiX2lzSW5pdGlhbGl6ZWQiLCJfZGVsZXRlZCIsIl9pbml0aWFsaXphdGlvblByb21pc2UiLCJfcG9wdXBSZWRpcmVjdFJlc29sdmVyIiwibGFzdE5vdGlmaWVkVWlkIiwic2V0dGluZ3MiLCJhcHBWZXJpZmljYXRpb25EaXNhYmxlZEZvclRlc3RpbmciLCJjbGllbnRWZXJzaW9uIiwic2RrQ2xpZW50VmVyc2lvbiIsIl9pbml0aWFsaXplV2l0aFBlcnNpc3RlbmNlIiwicG9wdXBSZWRpcmVjdFJlc29sdmVyIiwicXVldWUiLCJwZXJzaXN0ZW5jZU1hbmFnZXIiLCJfc2hvdWxkSW5pdFByb2FjdGl2ZWx5IiwiX2luaXRpYWxpemUiLCJpbml0aWFsaXplQ3VycmVudFVzZXIiLCJhc3NlcnRlZFBlcnNpc3RlbmNlIiwiX2N1cnJlbnRVc2VyIiwiX3VwZGF0ZUN1cnJlbnRVc2VyIiwic3RvcmVkVXNlciIsImF1dGhEb21haW4iLCJnZXRPckluaXRSZWRpcmVjdFBlcnNpc3RlbmNlTWFuYWdlciIsInJlZGlyZWN0VXNlckV2ZW50SWQiLCJzdG9yZWRVc2VyRXZlbnRJZCIsInJlc3VsdCIsInRyeVJlZGlyZWN0U2lnbkluIiwiZGlyZWN0bHlTZXRDdXJyZW50VXNlciIsInJlbG9hZEFuZFNldEN1cnJlbnRVc2VyT3JDbGVhciIsInJlZGlyZWN0UmVzb2x2ZXIiLCJfY29tcGxldGVSZWRpcmVjdEZuIiwiX3NldFJlZGlyZWN0VXNlciIsInVzZURldmljZUxhbmd1YWdlIiwibmF2aWdhdG9yTGFuZ3VhZ2UiLCJsYW5ndWFnZXMiLCJsYW5ndWFnZSIsIl9nZXRVc2VyTGFuZ3VhZ2UiLCJ1cGRhdGVDdXJyZW50VXNlciIsInVzZXJFeHRlcm4iLCJub3RpZnlBdXRoTGlzdGVuZXJzIiwicmVkaXJlY3RQZXJzaXN0ZW5jZU1hbmFnZXIiLCJfZ2V0UGVyc2lzdGVuY2UiLCJfdXBkYXRlRXJyb3JNYXAiLCJvbkF1dGhTdGF0ZUNoYW5nZWQiLCJuZXh0T3JPYnNlcnZlciIsImNvbXBsZXRlZCIsInJlZ2lzdGVyU3RhdGVMaXN0ZW5lciIsIm9uSWRUb2tlbkNoYW5nZWQiLCJyZWRpcmVjdE1hbmFnZXIiLCJyZXNvbHZlciIsIl9yZWRpcmVjdFBlcnNpc3RlbmNlIiwiX3JlZGlyZWN0VXNlckZvcklkIiwiY3VycmVudFVpZCIsInN1YnNjcmlwdGlvbiIsImFkZE9ic2VydmVyIiwiYWN0aW9uIiwiX2xvZ0ZyYW1ld29yayIsImZyYW1ld29yayIsInNvcnQiLCJfZ2V0RnJhbWV3b3JrcyIsIl9jYXN0QXV0aCIsIm9ic2VydmVyIiwiQXV0aENyZWRlbnRpYWwiLCJzaWduSW5NZXRob2QiLCJfZ2V0SWRUb2tlblJlc3BvbnNlIiwiX2F1dGgiLCJfbGlua1RvSWRUb2tlbiIsIl9pZFRva2VuIiwiX2dldFJlYXV0aGVudGljYXRpb25SZXNvbHZlciIsIkVtYWlsQXV0aENyZWRlbnRpYWwiLCJfZW1haWwiLCJfcGFzc3dvcmQiLCJfdGVuYW50SWQiLCJzdXBlciIsIl9mcm9tRW1haWxBbmRQYXNzd29yZCIsInBhc3N3b3JkIiwiX2Zyb21FbWFpbEFuZENvZGUiLCJvb2JDb2RlIiwib2JqIiwic2lnbkluV2l0aFBhc3N3b3JkIiwicmV0dXJuU2VjdXJlVG9rZW4iLCJzaWduSW5XaXRoRW1haWxMaW5rJDEiLCJ1cGRhdGVFbWFpbFBhc3N3b3JkIiwic2lnbkluV2l0aEVtYWlsTGlua0ZvckxpbmtpbmciLCJzaWduSW5XaXRoSWRwIiwiT0F1dGhDcmVkZW50aWFsIiwicGVuZGluZ1Rva2VuIiwiX2Zyb21QYXJhbXMiLCJjcmVkIiwibm9uY2UiLCJvYXV0aFRva2VuIiwib2F1dGhUb2tlblNlY3JldCIsInNlY3JldCIsImJ1aWxkUmVxdWVzdCIsImF1dG9DcmVhdGUiLCJyZXF1ZXN0VXJpIiwicG9zdEJvZHkiLCJWRVJJRllfUEhPTkVfTlVNQkVSX0ZPUl9FWElTVElOR19FUlJPUl9NQVBfIiwiUGhvbmVBdXRoQ3JlZGVudGlhbCIsIl9mcm9tVmVyaWZpY2F0aW9uIiwidmVyaWZpY2F0aW9uSWQiLCJ2ZXJpZmljYXRpb25Db2RlIiwiX2Zyb21Ub2tlblJlc3BvbnNlIiwidGVtcG9yYXJ5UHJvb2YiLCJzaWduSW5XaXRoUGhvbmVOdW1iZXIkMSIsIl9tYWtlVmVyaWZpY2F0aW9uUmVxdWVzdCIsImxpbmtXaXRoUGhvbmVOdW1iZXIkMSIsIm9wZXJhdGlvbiIsInZlcmlmeVBob25lTnVtYmVyRm9yRXhpc3RpbmciLCJzZXNzaW9uSW5mbyIsIkFjdGlvbkNvZGVVUkwiLCJhY3Rpb25MaW5rIiwic2VhcmNoUGFyYW1zIiwicGFyc2VNb2RlIiwiY29udGludWVVcmwiLCJwYXJzZUxpbmsiLCJkb3VibGVEZWVwTGluayIsImlPU0RlZXBMaW5rIiwicGFyc2VEZWVwTGluayIsIkVtYWlsQXV0aFByb3ZpZGVyIiwiUFJPVklERVJfSUQiLCJjcmVkZW50aWFsIiwiY3JlZGVudGlhbFdpdGhMaW5rIiwiZW1haWxMaW5rIiwiYWN0aW9uQ29kZVVybCIsIkVNQUlMX1BBU1NXT1JEX1NJR05fSU5fTUVUSE9EIiwiRU1BSUxfTElOS19TSUdOX0lOX01FVEhPRCIsIkZlZGVyYXRlZEF1dGhQcm92aWRlciIsImRlZmF1bHRMYW5ndWFnZUNvZGUiLCJjdXN0b21QYXJhbWV0ZXJzIiwic2V0RGVmYXVsdExhbmd1YWdlIiwic2V0Q3VzdG9tUGFyYW1ldGVycyIsImN1c3RvbU9BdXRoUGFyYW1ldGVycyIsImdldEN1c3RvbVBhcmFtZXRlcnMiLCJCYXNlT0F1dGhQcm92aWRlciIsInNjb3BlcyIsImFkZFNjb3BlIiwic2NvcGUiLCJnZXRTY29wZXMiLCJGYWNlYm9va0F1dGhQcm92aWRlciIsIkZBQ0VCT09LX1NJR05fSU5fTUVUSE9EIiwiY3JlZGVudGlhbEZyb21SZXN1bHQiLCJ1c2VyQ3JlZGVudGlhbCIsImNyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0IiwiY3JlZGVudGlhbEZyb21FcnJvciIsInRva2VuUmVzcG9uc2UiLCJvYXV0aEFjY2Vzc1Rva2VuIiwiR29vZ2xlQXV0aFByb3ZpZGVyIiwiR09PR0xFX1NJR05fSU5fTUVUSE9EIiwib2F1dGhJZFRva2VuIiwiR2l0aHViQXV0aFByb3ZpZGVyIiwiR0lUSFVCX1NJR05fSU5fTUVUSE9EIiwiVHdpdHRlckF1dGhQcm92aWRlciIsIlRXSVRURVJfU0lHTl9JTl9NRVRIT0QiLCJVc2VyQ3JlZGVudGlhbEltcGwiLCJvcGVyYXRpb25UeXBlIiwicHJvdmlkZXJJZEZvclJlc3BvbnNlIiwiX2Zvck9wZXJhdGlvbiIsIk11bHRpRmFjdG9yRXJyb3IiLCJfZnJvbUVycm9yQW5kT3BlcmF0aW9uIiwiX3Byb2Nlc3NDcmVkZW50aWFsU2F2aW5nTWZhQ29udGV4dElmTmVjZXNzYXJ5IiwiV2Vha01hcCIsIlNUT1JBR0VfQVZBSUxBQkxFX0tFWSIsIkJyb3dzZXJQZXJzaXN0ZW5jZUNsYXNzIiwic2V0SXRlbSIsInJlbW92ZUl0ZW0iLCJnZXRJdGVtIiwiQnJvd3NlckxvY2FsUGVyc2lzdGVuY2UiLCJsb2NhbFN0b3JhZ2UiLCJsaXN0ZW5lcnMiLCJsb2NhbENhY2hlIiwicG9sbFRpbWVyIiwic2FmYXJpTG9jYWxTdG9yYWdlTm90U3luY2VkIiwiX2lmcmFtZUNhbm5vdFN5bmNXZWJTdG9yYWdlIiwidG9wIiwiX2lzSWZyYW1lIiwiZmFsbGJhY2tUb1BvbGxpbmciLCJvblN0b3JhZ2VFdmVudCIsImZvckFsbENoYW5nZWRLZXlzIiwia2V5cyIsIm5ld1ZhbHVlIiwib2xkVmFsdWUiLCJldmVudCIsInBvbGwiLCJfb2xkVmFsdWUiLCJub3RpZnlMaXN0ZW5lcnMiLCJkZXRhY2hMaXN0ZW5lciIsInN0b3BQb2xsaW5nIiwic3RvcmVkVmFsdWUiLCJ0cmlnZ2VyTGlzdGVuZXJzIiwic3RhcnRQb2xsaW5nIiwic2V0SW50ZXJ2YWwiLCJTdG9yYWdlRXZlbnQiLCJjbGVhckludGVydmFsIiwiYXR0YWNoTGlzdGVuZXIiLCJicm93c2VyTG9jYWxQZXJzaXN0ZW5jZSIsIkJyb3dzZXJTZXNzaW9uUGVyc2lzdGVuY2UiLCJzZXNzaW9uU3RvcmFnZSIsImJyb3dzZXJTZXNzaW9uUGVyc2lzdGVuY2UiLCJSZWNlaXZlciIsImV2ZW50VGFyZ2V0IiwiaGFuZGxlcnNNYXAiLCJyZWNlaXZlcnMiLCJmaW5kIiwicmVjZWl2ZXIiLCJpc0xpc3RlbmluZ3RvIiwibmV3SW5zdGFuY2UiLCJtZXNzYWdlRXZlbnQiLCJldmVudElkIiwiZXZlbnRUeXBlIiwiaGFuZGxlcnMiLCJwb3J0cyIsInBvc3RNZXNzYWdlIiwicHJvbWlzZXMiLCJoYW5kbGVyIiwib3JpZ2luIiwiZnVsZmlsbGVkIiwicmVhc29uIiwiX2FsbFNldHRsZWQiLCJfc3Vic2NyaWJlIiwiZXZlbnRIYW5kbGVyIiwiX3Vuc3Vic2NyaWJlIiwiX2dlbmVyYXRlRXZlbnRJZCIsInByZWZpeCIsImRpZ2l0cyIsIlNlbmRlciIsInJlbW92ZU1lc3NhZ2VIYW5kbGVyIiwibWVzc2FnZUNoYW5uZWwiLCJwb3J0MSIsIm9uTWVzc2FnZSIsIl9zZW5kIiwiTWVzc2FnZUNoYW5uZWwiLCJjb21wbGV0aW9uVGltZXIiLCJhY2tUaW1lciIsInBvcnQyIiwiZmluYWxseSIsIl93aW5kb3ciLCJfaXNXb3JrZXIiLCJEQl9OQU1FIiwiREJfT0JKRUNUU1RPUkVfTkFNRSIsIkRCX0RBVEFfS0VZUEFUSCIsIkRCUHJvbWlzZSIsInRvUHJvbWlzZSIsImdldE9iamVjdFN0b3JlIiwiaXNSZWFkV3JpdGUiLCJ0cmFuc2FjdGlvbiIsIm9iamVjdFN0b3JlIiwiX29wZW5EYXRhYmFzZSIsImluZGV4ZWREQiIsImNyZWF0ZU9iamVjdFN0b3JlIiwia2V5UGF0aCIsIm9iamVjdFN0b3JlTmFtZXMiLCJjb250YWlucyIsImRlbGV0ZURhdGFiYXNlIiwiX2RlbGV0ZURhdGFiYXNlIiwiX3B1dE9iamVjdCIsInB1dCIsIl9kZWxldGVPYmplY3QiLCJJbmRleGVkREJMb2NhbFBlcnNpc3RlbmNlIiwicGVuZGluZ1dyaXRlcyIsInNlbmRlciIsInNlcnZpY2VXb3JrZXJSZWNlaXZlckF2YWlsYWJsZSIsImFjdGl2ZVNlcnZpY2VXb3JrZXIiLCJfd29ya2VySW5pdGlhbGl6YXRpb25Qcm9taXNlIiwiaW5pdGlhbGl6ZVNlcnZpY2VXb3JrZXJNZXNzYWdpbmciLCJfb3BlbkRiIiwiX3dpdGhSZXRyaWVzIiwib3AiLCJudW1BdHRlbXB0cyIsImluaXRpYWxpemVSZWNlaXZlciIsImluaXRpYWxpemVTZW5kZXIiLCJfb3JpZ2luIiwia2V5UHJvY2Vzc2VkIiwiX3BvbGwiLCJfZGF0YSIsInNlcnZpY2VXb3JrZXIiLCJyZWFkeSIsImFjdGl2ZSIsIl9nZXRBY3RpdmVTZXJ2aWNlV29ya2VyIiwicmVzdWx0cyIsIm5vdGlmeVNlcnZpY2VXb3JrZXIiLCJjb250cm9sbGVyIiwiX3dpdGhQZW5kaW5nV3JpdGUiLCJ3cml0ZSIsImdldE9iamVjdCIsImdldEFsbFJlcXVlc3QiLCJnZXRBbGwiLCJrZXlzSW5SZXN1bHQiLCJmYmFzZV9rZXkiLCJsb2NhbEtleSIsImluZGV4ZWREQkxvY2FsUGVyc2lzdGVuY2UiLCJfZ2VuZXJhdGVDYWxsYmFja05hbWUiLCJQaG9uZUF1dGhQcm92aWRlciIsInZlcmlmeVBob25lTnVtYmVyIiwicGhvbmVPcHRpb25zIiwiYXBwbGljYXRpb25WZXJpZmllciIsInZlcmlmaWVyIiwicmVjYXB0Y2hhVG9rZW4iLCJ2ZXJpZnkiLCJwaG9uZUluZm9PcHRpb25zIiwic2Vzc2lvbiIsInN0YXJ0RW5yb2xsUGhvbmVNZmEiLCJwaG9uZUVucm9sbG1lbnRJbmZvIiwicGhvbmVTZXNzaW9uSW5mbyIsIm1mYUVucm9sbG1lbnRJZCIsIm11bHRpRmFjdG9ySGludCIsIm11bHRpRmFjdG9yVWlkIiwic3RhcnRTaWduSW5QaG9uZU1mYSIsIm1mYVBlbmRpbmdDcmVkZW50aWFsIiwicGhvbmVTaWduSW5JbmZvIiwicGhvbmVSZXNwb25zZUluZm8iLCJzZW5kUGhvbmVWZXJpZmljYXRpb25Db2RlIiwiX3Jlc2V0IiwiX3ZlcmlmeVBob25lTnVtYmVyIiwiUEhPTkVfU0lHTl9JTl9NRVRIT0QiLCJJZHBDcmVkZW50aWFsIiwiX2J1aWxkSWRwUmVxdWVzdCIsInNlc3Npb25JZCIsInJldHVybklkcENyZWRlbnRpYWwiLCJfc2lnbkluIiwiX3NpZ25JbldpdGhDcmVkZW50aWFsIiwiX3JlYXV0aCIsInBhcnNlZCIsInN1YiIsIl9yZWF1dGhlbnRpY2F0ZSIsIl9saW5rIiwiX2xpbmskMSIsIkFic3RyYWN0UG9wdXBSZWRpcmVjdE9wZXJhdGlvbiIsInBlbmRpbmdQcm9taXNlIiwiZXZlbnRNYW5hZ2VyIiwiZXhlY3V0ZSIsIm9uRXhlY3V0aW9uIiwicmVnaXN0ZXJDb25zdW1lciIsIm9uQXV0aEV2ZW50IiwidXJsUmVzcG9uc2UiLCJnZXRJZHBUYXNrIiwib25FcnJvciIsInVucmVnaXN0ZXJBbmRDbGVhblVwIiwidW5yZWdpc3RlckNvbnN1bWVyIiwiY2xlYW5VcCIsIl9QT0xMX1dJTkRPV19DTE9TRV9USU1FT1VUIiwiUG9wdXBPcGVyYXRpb24iLCJhdXRoV2luZG93IiwicG9sbElkIiwiY3VycmVudFBvcHVwQWN0aW9uIiwiZXhlY3V0ZU5vdE51bGwiLCJfb3BlblBvcHVwIiwiYXNzb2NpYXRlZEV2ZW50IiwiX29yaWdpblZhbGlkYXRpb24iLCJfaXNJZnJhbWVXZWJTdG9yYWdlU3VwcG9ydGVkIiwiaXNTdXBwb3J0ZWQiLCJwb2xsVXNlckNhbmNlbGxhdGlvbiIsImNsb3NlZCIsInJlZGlyZWN0T3V0Y29tZU1hcCIsIlJlZGlyZWN0QWN0aW9uIiwicmVhZHlPdXRjb21lIiwicGVuZGluZ1JlZGlyZWN0S2V5IiwiaGFzUGVuZGluZ1JlZGlyZWN0IiwicmVzb2x2ZXJQZXJzaXN0ZW5jZSIsIl9nZXRBbmRDbGVhclBlbmRpbmdSZWRpcmVjdFN0YXR1cyIsIl9nZXRSZWRpcmVjdFJlc3VsdCIsInJlc29sdmVyRXh0ZXJuIiwiYXV0aEludGVybmFsIiwicmVzb2x2ZXJPdmVycmlkZSIsIl93aXRoRGVmYXVsdFJlc29sdmVyIiwiQXV0aEV2ZW50TWFuYWdlciIsImNhY2hlZEV2ZW50VWlkcyIsImNvbnN1bWVycyIsInF1ZXVlZFJlZGlyZWN0RXZlbnQiLCJoYXNIYW5kbGVkUG90ZW50aWFsUmVkaXJlY3QiLCJsYXN0UHJvY2Vzc2VkRXZlbnRUaW1lIiwiYXV0aEV2ZW50Q29uc3VtZXIiLCJpc0V2ZW50Rm9yQ29uc3VtZXIiLCJzZW5kVG9Db25zdW1lciIsInNhdmVFdmVudFRvQ2FjaGUiLCJvbkV2ZW50IiwiaGFzRXZlbnRCZWVuSGFuZGxlZCIsImhhbmRsZWQiLCJjb25zdW1lciIsImlzTnVsbFJlZGlyZWN0RXZlbnQiLCJpc1JlZGlyZWN0RXZlbnQiLCJldmVudElkTWF0Y2hlcyIsImV2ZW50VWlkIiwiSVBfQUREUkVTU19SRUdFWCIsIkhUVFBfUkVHRVgiLCJtYXRjaERvbWFpbiIsImV4cGVjdGVkIiwiY3VycmVudFVybCIsIlVSTCIsImNlVXJsIiwiZXNjYXBlZERvbWFpblBhdHRlcm4iLCJSZWdFeHAiLCJORVRXT1JLX1RJTUVPVVQiLCJyZXNldFVubG9hZGVkR2FwaU1vZHVsZXMiLCJiZWFjb24iLCJfX19qc2wiLCJoaW50IiwiQ1AiLCJjYWNoZWRHQXBpTG9hZGVyIiwiX2xvYWRHYXBpIiwibG9hZEdhcGlJZnJhbWUiLCJnYXBpIiwibG9hZCIsImlmcmFtZXMiLCJnZXRDb250ZXh0IiwiSWZyYW1lIiwiY2JOYW1lIiwiZWwiLCJjcmVhdGVFbGVtZW50Iiwic2V0QXR0cmlidXRlIiwiY2hhcnNldCIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwiYXBwZW5kQ2hpbGQiLCJsb2FkR2FwaSIsIlBJTkdfVElNRU9VVCIsIklGUkFNRV9BVFRSSUJVVEVTIiwic3R5bGUiLCJwb3NpdGlvbiIsIndpZHRoIiwiaGVpZ2h0IiwiRUlEX0ZST01fQVBJSE9TVCIsImdldElmcmFtZVVybCIsImVpZCIsImZ3IiwiQkFTRV9QT1BVUF9PUFRJT05TIiwicmVzaXphYmxlIiwic3RhdHVzYmFyIiwidG9vbGJhciIsIkF1dGhQb3B1cCIsIl9nZXRSZWRpcmVjdFVybCIsImF1dGhUeXBlIiwicmVkaXJlY3RVcmwiLCJhZGRpdGlvbmFsUGFyYW1zIiwidGlkIiwicGFyYW1zRGljdCIsImdldEhhbmRsZXJCYXNlIiwiV0VCX1NUT1JBR0VfU1VQUE9SVF9LRVkiLCJicm93c2VyUG9wdXBSZWRpcmVjdFJlc29sdmVyIiwiZXZlbnRNYW5hZ2VycyIsIm9yaWdpblZhbGlkYXRpb25Qcm9taXNlcyIsInNjcmVlbiIsImF2YWlsSGVpZ2h0IiwibGVmdCIsImF2YWlsV2lkdGgiLCJzY3JvbGxiYXJzIiwib3B0aW9uc1N0cmluZyIsInJlZHVjZSIsImFjY3VtIiwic3RhbmRhbG9uZSIsIl9pc0lPU1N0YW5kYWxvbmUiLCJjbGljayIsImNyZWF0ZUV2ZW50IiwiaW5pdE1vdXNlRXZlbnQiLCJkaXNwYXRjaEV2ZW50Iiwib3BlbkFzTmV3V2luZG93SU9TIiwibmV3V2luIiwiZm9jdXMiLCJfb3BlbiIsIl9vcGVuUmVkaXJlY3QiLCJpbml0QW5kR2V0TWFuYWdlciIsImlmcmFtZSIsImNvbnRleHQiLCJ3aGVyZSIsIm1lc3NhZ2VIYW5kbGVyc0ZpbHRlciIsIkNST1NTX09SSUdJTl9JRlJBTUVTX0ZJTFRFUiIsImF0dHJpYnV0ZXMiLCJkb250Y2xlYXIiLCJyZXN0eWxlIiwic2V0SGlkZU9uTGVhdmUiLCJuZXR3b3JrRXJyb3IiLCJuZXR3b3JrRXJyb3JUaW1lciIsImNsZWFyVGltZXJBbmRSZXNvbHZlIiwicGluZyIsIl9vcGVuSWZyYW1lIiwicmVnaXN0ZXIiLCJpZnJhbWVFdmVudCIsImF1dGhFdmVudCIsImF1dGhvcml6ZWREb21haW5zIiwiX2dldFByb2plY3RDb25maWciLCJkb21haW4iLCJfdmFsaWRhdGVPcmlnaW4iLCJBdXRoSW50ZXJvcCIsImludGVybmFsTGlzdGVuZXJzIiwiZ2V0VWlkIiwiYXNzZXJ0QXV0aENvbmZpZ3VyZWQiLCJhZGRBdXRoVG9rZW5MaXN0ZW5lciIsInVuc3Vic2NyaWJlIiwidXBkYXRlUHJvYWN0aXZlUmVmcmVzaCIsInJlbW92ZUF1dGhUb2tlbkxpc3RlbmVyIiwiZ2V0QXV0aCIsImRlcHMiLCJpbml0aWFsT3B0aW9ucyIsImluaXRpYWxpemVBdXRoIiwiYXV0aEluc3RhbmNlIiwiaGllcmFyY2h5IiwiX2luaXRpYWxpemVBdXRoSW5zdGFuY2UiLCJfaW5zdGFuY2VJZGVudGlmaWVyIiwiX2luc3RhbmNlIiwiZ2V0VmVyc2lvbkZvclBsYXRmb3JtIiwiREVGQVVMVF9IT1NUIiwiQ09ORklHX1NUT1JBR0VfQlVDS0VUX0tFWSIsIlN0b3JhZ2VFcnJvciIsInByZXBlbmRDb2RlIiwiX2Jhc2VNZXNzYWdlIiwiX2NvZGVFcXVhbHMiLCJ1bmtub3duIiwiaW52YWxpZEFyZ3VtZW50IiwiYXBwRGVsZXRlZCIsImludmFsaWRGb3JtYXQiLCJmb3JtYXQiLCJpbnRlcm5hbEVycm9yIiwiWGhyQ29ubmVjdGlvbiIsInNlbnRfIiwieGhyXyIsImVycm9yQ29kZV8iLCJzZW5kUHJvbWlzZV8iLCJBQk9SVCIsIk5FVFdPUktfRVJST1IiLCJnZXRFcnJvckNvZGUiLCJoZWFkZXIiLCJhZGRVcGxvYWRQcm9ncmVzc0xpc3RlbmVyIiwidXBsb2FkIiwicmVtb3ZlVXBsb2FkUHJvZ3Jlc3NMaXN0ZW5lciIsIkNvbm5lY3Rpb25Qb29sIiwiY3JlYXRlQ29ubmVjdGlvbiIsIkxvY2F0aW9uIiwiYnVja2V0IiwicGF0aF8iLCJpc1Jvb3QiLCJmdWxsU2VydmVyVXJsIiwiZW5jb2RlIiwiYnVja2V0T25seVNlcnZlclVybCIsIm1ha2VGcm9tQnVja2V0U3BlYyIsImJ1Y2tldFN0cmluZyIsImJ1Y2tldExvY2F0aW9uIiwibWFrZUZyb21VcmwiLCJidWNrZXREb21haW4iLCJnc1JlZ2V4IiwiaHR0cE1vZGlmeSIsImxvYyIsImZpcmViYXNlU3RvcmFnZUhvc3QiLCJncm91cHMiLCJyZWdleCIsImluZGljZXMiLCJwb3N0TW9kaWZ5IiwiZ3JvdXAiLCJjYXB0dXJlcyIsImJ1Y2tldFZhbHVlIiwicGF0aFZhbHVlIiwiaW52YWxpZFVybCIsIkZhaWxSZXF1ZXN0IiwicHJvbWlzZV8iLCJnZXRQcm9taXNlIiwiX2FwcERlbGV0ZSIsImlzU3RyaW5nIiwiaXNOYXRpdmVCbG9iIiwiaXNOYXRpdmVCbG9iRGVmaW5lZCIsIkJsb2IiLCJ2YWxpZGF0ZU51bWJlciIsImFyZ3VtZW50IiwibWluVmFsdWUiLCJtYXhWYWx1ZSIsIm1ha2VVcmwiLCJ1cmxQYXJ0IiwicHJvdG9jb2xNYXRjaCIsIm1ha2VRdWVyeVN0cmluZyIsInF1ZXJ5UGFydCIsIk5ldHdvcmtSZXF1ZXN0Iiwic3VjY2Vzc0NvZGVzIiwiYWRkaXRpb25hbFJldHJ5Q29kZXMiLCJlcnJvckNhbGxiYWNrIiwicHJvZ3Jlc3NDYWxsYmFjayIsInBvb2wiLCJwZW5kaW5nQ29ubmVjdGlvbl8iLCJiYWNrb2ZmSWRfIiwiY2FuY2VsZWRfIiwiYXBwRGVsZXRlXyIsInVybF8iLCJtZXRob2RfIiwiaGVhZGVyc18iLCJib2R5XyIsInN1Y2Nlc3NDb2Rlc18iLCJhZGRpdGlvbmFsUmV0cnlDb2Rlc18iLCJjYWxsYmFja18iLCJlcnJvckNhbGxiYWNrXyIsInByb2dyZXNzQ2FsbGJhY2tfIiwidGltZW91dF8iLCJwb29sXyIsInJlc29sdmVfIiwicmVqZWN0XyIsInN0YXJ0XyIsImJhY2tvZmZEb25lIiwicmVxdWVzdFdlbnRUaHJvdWdoIiwiY29ubmVjdGlvbiIsIndhc1N1Y2Nlc3NDb2RlIiwiZXJyIiwiY2FuY2VsZWQiLCJSZXF1ZXN0RW5kU3RhdHVzIiwid2FpdFNlY29uZHMiLCJ0aW1lb3V0SWQiLCJoaXRUaW1lb3V0IiwiY2FuY2VsU3RhdGUiLCJ0cmlnZ2VyZWRDYWxsYmFjayIsInRyaWdnZXJDYWxsYmFjayIsImNhbGxXaXRoRGVsYXkiLCJtaWxsaXMiLCJiYWNrb2ZmQ2FsbGJhY2siLCJwcm9ncmVzc0xpc3RlbmVyIiwicHJvZ3Jlc3NFdmVudCIsImxvYWRlZCIsInRvdGFsIiwibGVuZ3RoQ29tcHV0YWJsZSIsImhpdFNlcnZlciIsImlzUmV0cnlTdGF0dXNDb2RlXyIsIndhc0NhbmNlbGVkIiwic3VjY2Vzc0NvZGUiLCJzdWNjZXNzIiwid2FpdE1pbGxpcyIsInN0b3BwZWQiLCJzdG9wIiwid2FzVGltZW91dCIsImFwcERlbGV0ZSIsImlzRml2ZUh1bmRyZWRDb2RlIiwiaXNFeHRyYVJldHJ5Q29kZSIsImlzUmVxdWVzdFNwZWNpZmljUmV0cnlDb2RlIiwiZ2V0QmxvYkJ1aWxkZXIiLCJCbG9iQnVpbGRlciIsIldlYktpdEJsb2JCdWlsZGVyIiwiZ2V0QmxvYiIsIlN0cmluZ0Zvcm1hdCIsIlN0cmluZ0RhdGEiLCJjb250ZW50VHlwZSIsInV0ZjhCeXRlc18iLCJiYXNlNjRCeXRlc18iLCJoYXNNaW51cyIsImhhc1VuZGVyIiwiaGFzUGx1cyIsImhhc1NsYXNoIiwiYnl0ZXMiLCJhdG9iIiwiYXJyYXkiLCJEYXRhVVJMUGFydHMiLCJkYXRhVVJMIiwiYmFzZTY0IiwibWlkZGxlIiwiZW5kIiwiRmJzQmxvYiIsImVsaWRlQ29weSIsImJsb2JUeXBlIiwiZGF0YV8iLCJBcnJheUJ1ZmZlciIsImJ5dGVMZW5ndGgiLCJzaXplXyIsInR5cGVfIiwic3RhcnRCeXRlIiwiZW5kQnl0ZSIsInNsaWNlZCIsIndlYmtpdFNsaWNlIiwibW96U2xpY2UiLCJidWZmZXIiLCJibG9iYnkiLCJ2YWwiLCJ1aW50OEFycmF5cyIsInN0cmluZ0RhdGEiLCJkYXRhVXJsIiwicGFydHMiLCJwZXJjZW50RW5jb2RlZEJ5dGVzXyIsImRhdGFVUkxCeXRlc18iLCJkYXRhRnJvbVN0cmluZyIsImZpbmFsTGVuZ3RoIiwibWVyZ2VkIiwiaW5kZXgiLCJ1cGxvYWREYXRhIiwianNvbk9iamVjdE9yTnVsbCIsImxhc3RDb21wb25lbnQiLCJsYXN0SW5kZXhPZiIsIm5vWGZvcm1fIiwiTWFwcGluZyIsInNlcnZlciIsImxvY2FsIiwid3JpdGFibGUiLCJ4Zm9ybSIsIm1hcHBpbmdzXyIsImdldE1hcHBpbmdzIiwibWFwcGluZ3MiLCJuYW1lTWFwcGluZyIsIl9tZXRhZGF0YSIsImZ1bGxQYXRoIiwieGZvcm1QYXRoIiwic2l6ZU1hcHBpbmciLCJmcm9tUmVzb3VyY2VTdHJpbmciLCJyZXNvdXJjZVN0cmluZyIsInJlc291cmNlIiwibGVuIiwibWFwcGluZyIsIl9tYWtlU3RvcmFnZVJlZmVyZW5jZSIsImFkZFJlZiIsImZyb21SZXNvdXJjZSIsIlJlcXVlc3RJbmZvIiwidXJsUGFyYW1zIiwiZXJyb3JIYW5kbGVyIiwiaGFuZGxlckNoZWNrIiwiY25kbiIsInNoYXJlZEVycm9ySGFuZGxlciIsInhociIsIm5ld0VyciIsIm11bHRpcGFydFVwbG9hZCIsImJvdW5kYXJ5Iiwic3RyIiwiZ2VuQm91bmRhcnkiLCJtZXRhZGF0YV8iLCJtZXRhZGF0YUNsb25lIiwiZGV0ZXJtaW5lQ29udGVudFR5cGVfIiwibWV0YWRhdGFGb3JVcGxvYWRfIiwicHJlQmxvYlBhcnQiLCJ0b1Jlc291cmNlU3RyaW5nIiwicG9zdEJsb2JQYXJ0IiwibWF4VXBsb2FkUmV0cnlUaW1lIiwicmVxdWVzdEluZm8iLCJtZXRhZGF0YUhhbmRsZXIiLCJSZWZlcmVuY2UiLCJfc2VydmljZSIsIl9sb2NhdGlvbiIsIl9uZXdSZWYiLCJyb290IiwicGFyZW50IiwibmV3UGF0aCIsIl90aHJvd0lmUm9vdCIsImludmFsaWRSb290T3BlcmF0aW9uIiwiZ2V0RG93bmxvYWRVUkwkMSIsInJlZiIsIm1heE9wZXJhdGlvblJldHJ5VGltZSIsInRva2VucyIsImFsdCIsImRvd25sb2FkVXJsRnJvbVJlc291cmNlU3RyaW5nIiwiZG93bmxvYWRVcmxIYW5kbGVyIiwic2hhcmVkIiwib2JqZWN0RXJyb3JIYW5kbGVyIiwiZ2V0RG93bmxvYWRVcmwiLCJtYWtlUmVxdWVzdFdpdGhUb2tlbnMiLCJyZWZGcm9tUGF0aCIsIkZpcmViYXNlU3RvcmFnZUltcGwiLCJfYnVja2V0IiwicmVmZXJlbmNlIiwiY2hpbGRQYXRoIiwiY2Fub25pY2FsQ2hpbGRQYXRoIiwiY2hpbGQiLCJfZ2V0Q2hpbGQkMSIsImV4dHJhY3RCdWNrZXQiLCJfYXV0aFByb3ZpZGVyIiwiX2FwcENoZWNrUHJvdmlkZXIiLCJfcG9vbCIsIl91cmwiLCJfZmlyZWJhc2VWZXJzaW9uIiwiX2hvc3QiLCJfYXBwSWQiLCJfbWF4T3BlcmF0aW9uUmV0cnlUaW1lIiwiX21heFVwbG9hZFJldHJ5VGltZSIsIl9yZXF1ZXN0cyIsInRpbWUiLCJQT1NJVElWRV9JTkZJTklUWSIsIl9nZXRBdXRoVG9rZW4iLCJfb3ZlcnJpZGVBdXRoVG9rZW4iLCJ0b2tlbkRhdGEiLCJfZ2V0QXBwQ2hlY2tUb2tlbiIsImFwcENoZWNrIiwiX21ha2VSZXF1ZXN0IiwiYXV0aFRva2VuIiwiYXBwQ2hlY2tUb2tlbiIsImFwcElkIiwiZmlyZWJhc2VWZXJzaW9uIiwiYWRkR21waWRIZWFkZXJfIiwiYWRkQXV0aEhlYWRlcl8iLCJhZGRWZXJzaW9uSGVhZGVyXyIsImFkZEFwcENoZWNrSGVhZGVyXyIsIm1ha2VSZXF1ZXN0IiwiU1RPUkFHRV9UWVBFIiwidXBsb2FkQnl0ZXMiLCJmaW5hbE1ldGFkYXRhIiwidXBsb2FkQnl0ZXMkMSIsImdldERvd25sb2FkVVJMIiwic2VydmljZU9yUmVmIiwicGF0aE9yVXJsIiwicmVmJDEiLCJnZXRTdG9yYWdlIiwiYnVja2V0VXJsIiwiYXV0aFByb3ZpZGVyIiwiYXBwQ2hlY2tQcm92aWRlciIsIlBsYXRmb3JtTG9nZ2VyU2VydmljZUltcGwiLCJnZXRQbGF0Zm9ybUluZm9TdHJpbmciLCJpc1ZlcnNpb25TZXJ2aWNlUHJvdmlkZXIiLCJsaWJyYXJ5IiwidmVyc2lvbiIsImxvZ1N0cmluZyIsIm5hbWUkbyIsImxvZ2dlciIsIm5hbWUkbiIsIm5hbWUkbSIsIm5hbWUkbCIsIm5hbWUkayIsIm5hbWUkaiIsIm5hbWUkaSIsIm5hbWUkaCIsIm5hbWUkZyIsIm5hbWUkZiIsIm5hbWUkZSIsIm5hbWUkZCIsIm5hbWUkYyIsIm5hbWUkYiIsIm5hbWUkYSIsIm5hbWUkOSIsIm5hbWUkOCIsIm5hbWUkNyIsIm5hbWUkNiIsIm5hbWUkNSIsIm5hbWUkNCIsIm5hbWUkMyIsIm5hbWUkMiIsIm5hbWUkMSIsIlBMQVRGT1JNX0xPR19TVFJJTkciLCJfYXBwcyIsIl9jb21wb25lbnRzIiwiX2FkZENvbXBvbmVudCIsImRlYnVnIiwiX3JlZ2lzdGVyQ29tcG9uZW50IiwiY29tcG9uZW50TmFtZSIsIl9nZXRQcm92aWRlciIsIkVSUk9SX0ZBQ1RPUlkiLCJGaXJlYmFzZUFwcEltcGwiLCJfaXNEZWxldGVkIiwiX29wdGlvbnMiLCJfY29uZmlnIiwiX25hbWUiLCJfYXV0b21hdGljRGF0YUNvbGxlY3Rpb25FbmFibGVkIiwiYXV0b21hdGljRGF0YUNvbGxlY3Rpb25FbmFibGVkIiwiX2NvbnRhaW5lciIsImNoZWNrRGVzdHJveWVkIiwiaXNEZWxldGVkIiwiU0RLX1ZFUlNJT04iLCJpbml0aWFsaXplQXBwIiwicmF3Q29uZmlnIiwiZXhpc3RpbmdBcHAiLCJuZXdBcHAiLCJnZXRBcHAiLCJyZWdpc3RlclZlcnNpb24iLCJsaWJyYXJ5S2V5T3JOYW1lIiwidmFyaWFudCIsImxpYnJhcnlNaXNtYXRjaCIsInZlcnNpb25NaXNtYXRjaCIsIndhcm5pbmciLCJ3YXJuIiwiX19zcHJlYWRBcnJheXMiLCJpbCIsImpsIiwiTG9nTGV2ZWwiLCJsZXZlbFN0cmluZ1RvRW51bSIsIkRFQlVHIiwiVkVSQk9TRSIsIklORk8iLCJXQVJOIiwiU0lMRU5UIiwiZGVmYXVsdExvZ0xldmVsIiwiQ29uc29sZU1ldGhvZCIsImRlZmF1bHRMb2dIYW5kbGVyIiwibG9nVHlwZSIsIl9pIiwidG9JU09TdHJpbmciLCJjb25zb2xlIiwiTG9nZ2VyIiwiX2xvZ0xldmVsIiwiX2xvZ0hhbmRsZXIiLCJfdXNlckxvZ0hhbmRsZXIiLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwic2V0TG9nTGV2ZWwiLCJsb2ciLCJieXRlVG9DaGFyTWFwXyIsImNoYXJUb0J5dGVNYXBfIiwiYnl0ZVRvQ2hhck1hcFdlYlNhZmVfIiwiY2hhclRvQnl0ZU1hcFdlYlNhZmVfIiwiRU5DT0RFRF9WQUxTX0JBU0UiLCJFTkNPREVEX1ZBTFMiLCJFTkNPREVEX1ZBTFNfV0VCU0FGRSIsIkhBU19OQVRJVkVfU1VQUE9SVCIsImVuY29kZUJ5dGVBcnJheSIsImlucHV0Iiwid2ViU2FmZSIsImluaXRfIiwiYnl0ZVRvQ2hhck1hcCIsIm91dHB1dCIsImJ5dGUxIiwiaGF2ZUJ5dGUyIiwiYnl0ZTIiLCJoYXZlQnl0ZTMiLCJieXRlMyIsIm91dEJ5dGUxIiwib3V0Qnl0ZTIiLCJvdXRCeXRlMyIsIm91dEJ5dGU0IiwiZW5jb2RlU3RyaW5nIiwiYnRvYSIsIm91dCIsInN0cmluZ1RvQnl0ZUFycmF5JDEiLCJkZWNvZGVTdHJpbmciLCJwb3MiLCJjMSIsImZyb21DaGFyQ29kZSIsImMyIiwiYzMiLCJieXRlQXJyYXlUb1N0cmluZyIsImRlY29kZVN0cmluZ1RvQnl0ZUFycmF5IiwiY2hhclRvQnl0ZU1hcCIsImJ5dGU0IiwiYmFzZTY0RGVjb2RlIiwiRGVmZXJyZWQiLCJ3cmFwQ2FsbGJhY2siLCJnZXRVQSIsImlzTW9iaWxlQ29yZG92YSIsImlzQnJvd3NlckV4dGVuc2lvbiIsInJ1bnRpbWUiLCJjaHJvbWUiLCJicm93c2VyIiwiaXNSZWFjdE5hdGl2ZSIsImlzRWxlY3Ryb24iLCJpc0lFIiwiaXNVV1AiLCJpc1NhZmFyaSIsInByb2Nlc3MiLCJpc05vZGUiLCJGaXJlYmFzZUVycm9yIiwiY2FwdHVyZVN0YWNrVHJhY2UiLCJFcnJvckZhY3RvcnkiLCJzZXJ2aWNlTmFtZSIsImVycm9ycyIsImZ1bGxDb2RlIiwidGVtcGxhdGUiLCJQQVRURVJOIiwicmVwbGFjZVRlbXBsYXRlIiwiZnVsbE1lc3NhZ2UiLCJpc0VtcHR5IiwiZGVlcEVxdWFsIiwiYUtleXMiLCJiS2V5cyIsImFLZXlzXzEiLCJhUHJvcCIsImJQcm9wIiwiaXNPYmplY3QiLCJiS2V5c18xIiwidGhpbmciLCJxdWVyeXN0cmluZyIsInF1ZXJ5c3RyaW5nUGFyYW1zIiwiX2xvb3BfMSIsImFycmF5VmFsIiwicXVlcnlzdHJpbmdEZWNvZGUiLCJleHRyYWN0UXVlcnlzdHJpbmciLCJxdWVyeVN0YXJ0IiwiZnJhZ21lbnRTdGFydCIsImNyZWF0ZVN1YnNjcmliZSIsImV4ZWN1dG9yIiwib25Ob09ic2VydmVycyIsIk9ic2VydmVyUHJveHkiLCJzdWJzY3JpYmUiLCJTaGExIiwiY2hhaW5fIiwiYnVmXyIsIldfIiwicGFkXyIsImluYnVmXyIsInRvdGFsXyIsImJsb2NrU2l6ZSIsImNvbXByZXNzXyIsImJ1ZiIsIm9mZnNldCIsInVwZGF0ZSIsImxlbmd0aE1pbnVzQmxvY2siLCJpbmJ1ZiIsImRpZ2VzdCIsInRvdGFsQml0cyIsIm9ic2VydmVycyIsInVuc3Vic2NyaWJlcyIsIm9ic2VydmVyQ291bnQiLCJ0YXNrIiwiZmluYWxpemVkIiwiZm9yRWFjaE9ic2VydmVyIiwiY29tcGxldGUiLCJtZXRob2RzXzEiLCJpbXBsZW1lbnRzQW55TWV0aG9kcyIsIm5vb3AiLCJ1bnN1YiIsInVuc3Vic2NyaWJlT25lIiwiZmluYWxFcnJvciIsImZuIiwic2VuZE9uZSIsImdldE1vZHVsYXJJbnN0YW5jZSIsIl9kZWxlZ2F0ZSIsIl9fcmVzdCIsImdldE93blByb3BlcnR5U3ltYm9scyIsInByb3BlcnR5SXNFbnVtZXJhYmxlIiwiX19hd2FpdGVyIiwidGhpc0FyZyIsIl9hcmd1bWVudHMiLCJnZW5lcmF0b3IiLCJzdGVwIiwicmVqZWN0ZWQiLCJfX2dlbmVyYXRvciIsInRyeXMiLCJvcHMiLCJJdGVyYXRvciIsInZlcmIiLCJfX3JlYWQiLCJhciIsIl9fc3ByZWFkQXJyYXkiLCJ0byIsInBhY2siLCJTdXBwcmVzc2VkRXJyb3IiLCJpc0F1dGhlbnRpY2F0ZWQiLCJ0b0tleSIsImlzRXF1YWwiLCJVTkFVVEhFTlRJQ0FURUQiLCJHT09HTEVfQ1JFREVOVElBTFMiLCJGSVJTVF9QQVJUWSIsIk1PQ0tfVVNFUiIsIk9LIiwiQ0FOQ0VMTEVEIiwiVU5LTk9XTiIsIklOVkFMSURfQVJHVU1FTlQiLCJERUFETElORV9FWENFRURFRCIsIk5PVF9GT1VORCIsIkFMUkVBRFlfRVhJU1RTIiwiUEVSTUlTU0lPTl9ERU5JRUQiLCJSRVNPVVJDRV9FWEhBVVNURUQiLCJGQUlMRURfUFJFQ09ORElUSU9OIiwiQUJPUlRFRCIsIk9VVF9PRl9SQU5HRSIsIlVOSU1QTEVNRU5URUQiLCJVTkFWQUlMQUJMRSIsIkRBVEFfTE9TUyIsImF1dGhIZWFkZXJzIiwiQXV0aG9yaXphdGlvbiIsImludmFsaWRhdGVUb2tlbiIsImVucXVldWVSZXRyeWFibGUiLCJzaHV0ZG93biIsImdldEF1dGhIZWFkZXJWYWx1ZUZvckZpcnN0UGFydHkiLCJwcmV2aW91c1ZhbHVlIiwic2VxdWVuY2VOdW1iZXJIYW5kbGVyIiwid3JpdGVTZXF1ZW5jZU51bWJlciIsImNyeXB0byIsIm1zQ3J5cHRvIiwiZ2V0UmFuZG9tVmFsdWVzIiwidHQiLCJldCIsImV2ZXJ5Iiwic3QiLCJuYW5vc2Vjb25kcyIsImZyb21NaWxsaXMiLCJmcm9tRGF0ZSIsInRvRGF0ZSIsInRvTWlsbGlzIiwiX2NvbXBhcmVUbyIsInZhbHVlT2YiLCJwYWRTdGFydCIsIml0IiwidGltZXN0YW1wIiwiZnJvbVRpbWVzdGFtcCIsImNvbXBhcmVUbyIsInRvTWljcm9zZWNvbmRzIiwidG9UaW1lc3RhbXAiLCJydCIsIm90IiwiYXQiLCJjdCIsInNlZ21lbnRzIiwiY29tcGFyYXRvciIsImxpbWl0IiwiY29uc3RydWN0IiwicG9wRmlyc3QiLCJwb3BMYXN0IiwiZmlyc3RTZWdtZW50IiwibGFzdFNlZ21lbnQiLCJpc1ByZWZpeE9mIiwiaXNJbW1lZGlhdGVQYXJlbnRPZiIsInRvQXJyYXkiLCJ1dCIsImNhbm9uaWNhbFN0cmluZyIsImZyb21TdHJpbmciLCJlbXB0eVBhdGgiLCJodCIsImx0IiwiaXNWYWxpZElkZW50aWZpZXIiLCJpc0tleUZpZWxkIiwia2V5RmllbGQiLCJmcm9tU2VydmVyRm9ybWF0IiwiZnQiLCJmaWVsZHMiLCJjb3ZlcnMiLCJ3dCIsImJpbmFyeVN0cmluZyIsImZyb21CYXNlNjRTdHJpbmciLCJmcm9tVWludDhBcnJheSIsInRvQmFzZTY0IiwidG9VaW50OEFycmF5IiwiYXBwcm94aW1hdGVCeXRlU2l6ZSIsIkVNUFRZX0JZVEVfU1RSSU5HIiwiX3QiLCJtdCIsIm5hbm9zIiwiZ3QiLCJ5dCIsIlR0IiwibWFwVmFsdWUiLCJfX2xvY2FsX3dyaXRlX3RpbWVfXyIsInRpbWVzdGFtcFZhbHVlIiwiSXQiLCJBdCIsIlB0IiwiZnJvbVBhdGgiLCJmcm9tTmFtZSIsImhhc0NvbGxlY3Rpb25JZCIsImlzRG9jdW1lbnRLZXkiLCJmcm9tU2VnbWVudHMiLCJidCIsIl9fdHlwZV9fIiwic3RyaW5nVmFsdWUiLCJwdCIsInZ0IiwiYm9vbGVhblZhbHVlIiwiYnl0ZXNWYWx1ZSIsInJlZmVyZW5jZVZhbHVlIiwiZ2VvUG9pbnRWYWx1ZSIsImxhdGl0dWRlIiwibG9uZ2l0dWRlIiwiaW50ZWdlclZhbHVlIiwiZG91YmxlVmFsdWUiLCJhcnJheVZhbHVlIiwiVnQiLCJTdCIsIkR0IiwiQ3QiLCJOdCIsImt0IiwiJHQiLCJNdCIsIkx0IiwiQnQiLCJlbXB0eSIsImZpZWxkIiwiZ2V0RmllbGRzTWFwIiwic2V0QWxsIiwiYXBwbHlDaGFuZ2VzIiwiY2xvbmUiLCJVdCIsInF0IiwiZG9jdW1lbnRUeXBlIiwiZG9jdW1lbnRTdGF0ZSIsIm5ld0ludmFsaWREb2N1bWVudCIsIm5ld0ZvdW5kRG9jdW1lbnQiLCJuZXdOb0RvY3VtZW50IiwibmV3VW5rbm93bkRvY3VtZW50IiwiY29udmVydFRvRm91bmREb2N1bWVudCIsImNvbnZlcnRUb05vRG9jdW1lbnQiLCJjb252ZXJ0VG9Vbmtub3duRG9jdW1lbnQiLCJzZXRIYXNDb21taXR0ZWRNdXRhdGlvbnMiLCJzZXRIYXNMb2NhbE11dGF0aW9ucyIsImhhc0xvY2FsTXV0YXRpb25zIiwiaGFzQ29tbWl0dGVkTXV0YXRpb25zIiwiaGFzUGVuZGluZ1dyaXRlcyIsImlzVmFsaWREb2N1bWVudCIsImlzRm91bmREb2N1bWVudCIsImlzTm9Eb2N1bWVudCIsImlzVW5rbm93bkRvY3VtZW50IiwiS3QiLCJjb2xsZWN0aW9uR3JvdXAiLCJvcmRlckJ5IiwiZmlsdGVycyIsInN0YXJ0QXQiLCJlbmRBdCIsImp0IiwiUXQiLCJKdCIsImRpciIsIm9lIiwiR3QiLCJjZSIsImhlIiwiSHQiLCJZdCIsImVlIiwibmUiLCJzZSIsImllIiwiWHQiLCJadCIsInRlIiwibnVsbFZhbHVlIiwiYmVmb3JlIiwiYWUiLCJ1ZSIsImxlIiwiZXhwbGljaXRPcmRlckJ5IiwibGltaXRUeXBlIiwicGUiLCJnZSIsIm1lIiwiRWUiLCJJZSIsIkFlIiwiUmUiLCJXdCIsIlBlIiwidmUiLCJWZSIsIlNlIiwiRGUiLCJpc0ludGVnZXIiLCJNQVhfU0FGRV9JTlRFR0VSIiwiTUlOX1NBRkVfSU5URUdFUiIsIlJ0IiwiQ2UiLCJOZSIsIiRlIiwiX19wcmV2aW91c192YWx1ZV9fIiwiT2UiLCJGZSIsIk1lIiwiTGUiLCJrZSIsIlVlIiwieGUiLCJCZSIsImVsZW1lbnRzIiwicWUiLCJLZSIsInRyYW5zZm9ybSIsIlFlIiwidHJhbnNmb3JtUmVzdWx0cyIsIldlIiwidXBkYXRlVGltZSIsImV4aXN0cyIsIm5vbmUiLCJpc05vbmUiLCJHZSIsInplIiwiSGUiLCJ0biIsInNuIiwiZmllbGRUcmFuc2Zvcm1zIiwiZW4iLCJwcmVjb25kaXRpb24iLCJubiIsIkplIiwicm4iLCJaZSIsIlllIiwiWGUiLCJqZSIsImZpZWxkTWFzayIsIm9uIiwiYW4iLCJ1biIsImhuIiwiZG4iLCJfbiIsIkVNUFRZIiwiaW5zZXJ0IiwiY29weSIsIkJMQUNLIiwicmlnaHQiLCJtaW5LZXkiLCJtYXhLZXkiLCJpbm9yZGVyVHJhdmVyc2FsIiwicmV2ZXJzZVRyYXZlcnNhbCIsImdldEl0ZXJhdG9yIiwid24iLCJnZXRJdGVyYXRvckZyb20iLCJnZXRSZXZlcnNlSXRlcmF0b3IiLCJnZXRSZXZlcnNlSXRlcmF0b3JGcm9tIiwiaXNSZXZlcnNlIiwibm9kZVN0YWNrIiwiZ2V0TmV4dCIsImhhc05leHQiLCJwZWVrIiwiY29sb3IiLCJSRUQiLCJmaXhVcCIsInJlbW92ZU1pbiIsImlzUmVkIiwibW92ZVJlZExlZnQiLCJyb3RhdGVSaWdodCIsIm1vdmVSZWRSaWdodCIsInJvdGF0ZUxlZnQiLCJjb2xvckZsaXAiLCJjaGVja01heERlcHRoIiwiY2hlY2siLCJwb3ciLCJtbiIsImZpcnN0IiwibGFzdCIsImZvckVhY2hJblJhbmdlIiwiZm9yRWFjaFdoaWxlIiwiZmlyc3RBZnRlck9yRXF1YWwiLCJnbiIsInVuaW9uV2l0aCIsIml0ZXIiLCJ5biIsInBuIiwiRW4iLCJUbiIsIkluIiwiUm4iLCJQbiIsImJuIiwiTG4iLCJkYXRhYmFzZUlkIiwiQm4iLCJVbiIsInFuIiwiS24iLCJqbiIsInByb2plY3RJZCIsImRhdGFiYXNlIiwiV24iLCJIbiIsInBzIiwiUW4iLCJZbiIsIlhuIiwiYXMiLCJzdHJ1Y3R1cmVkUXVlcnkiLCJhbGxEZXNjZW5kYW50cyIsImNvbGxlY3Rpb25JZCIsInVzIiwiX3MiLCJkaXJlY3Rpb24iLCJscyIsImZlIiwidW5hcnlGaWx0ZXIiLCJncyIsImZpZWxkRmlsdGVyIiwibXMiLCJjb21wb3NpdGVGaWx0ZXIiLCJmaWVsZFBhdGgiLCJOYU4iLCJ5cyIsImZpZWxkUGF0aHMiLCJFcyIsIklzIiwiVHMiLCJQcyIsIm93bmVySWQiLCJhbGxvd1RhYlN5bmNocm9uaXphdGlvbiIsImxlYXNlVGltZXN0YW1wTXMiLCJzdG9yZSIsImJzIiwidXNlcklkIiwibGFzdEFja25vd2xlZGdlZEJhdGNoSWQiLCJsYXN0U3RyZWFtVG9rZW4iLCJ2cyIsImJhdGNoSWQiLCJsb2NhbFdyaXRlVGltZU1zIiwiYmFzZU11dGF0aW9ucyIsIm11dGF0aW9ucyIsInVzZXJNdXRhdGlvbnNJbmRleCIsInVzZXJNdXRhdGlvbnNLZXlQYXRoIiwiVnMiLCJwcmVmaXhGb3JVc2VyIiwicHJlZml4Rm9yUGF0aCIsIlBMQUNFSE9MREVSIiwiQ3MiLCJ1bmtub3duRG9jdW1lbnQiLCJub0RvY3VtZW50IiwicmVhZFRpbWUiLCJwYXJlbnRQYXRoIiwicmVhZFRpbWVJbmRleCIsInJlYWRUaW1lSW5kZXhQYXRoIiwiY29sbGVjdGlvblJlYWRUaW1lSW5kZXgiLCJjb2xsZWN0aW9uUmVhZFRpbWVJbmRleFBhdGgiLCJOcyIsImJ5dGVTaXplIiwieHMiLCJ0YXJnZXRJZCIsImNhbm9uaWNhbElkIiwicmVzdW1lVG9rZW4iLCJsYXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIiLCJsYXN0TGltYm9GcmVlU25hcHNob3RWZXJzaW9uIiwicXVlcnlUYXJnZXRzSW5kZXhOYW1lIiwicXVlcnlUYXJnZXRzS2V5UGF0aCIsImtzIiwic2VxdWVuY2VOdW1iZXIiLCJkb2N1bWVudFRhcmdldHNJbmRleCIsImRvY3VtZW50VGFyZ2V0c0tleVBhdGgiLCIkcyIsImhpZ2hlc3RUYXJnZXRJZCIsImhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlciIsImxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24iLCJ0YXJnZXRDb3VudCIsIk9zIiwiRnMiLCJjbGllbnRJZCIsInVwZGF0ZVRpbWVNcyIsIm5ldHdvcmtFbmFibGVkIiwiaW5Gb3JlZ3JvdW5kIiwiTXMiLCJidW5kbGVJZCIsImNyZWF0ZVRpbWUiLCJMcyIsImJ1bmRsZWRRdWVyeSIsIlVzIiwicXMiLCJvbkNvbW1pdHRlZExpc3RlbmVycyIsImFkZE9uQ29tbWl0dGVkTGlzdGVuZXIiLCJyYWlzZU9uQ29tbWl0dGVkRXZlbnQiLCJLcyIsIm5leHRDYWxsYmFjayIsImNhdGNoQ2FsbGJhY2siLCJpc0RvbmUiLCJjYWxsYmFja0F0dGFjaGVkIiwid3JhcEZhaWx1cmUiLCJ3cmFwU3VjY2VzcyIsIndyYXBVc2VyRnVuY3Rpb24iLCJ3YWl0Rm9yIiwib3IiLCJ6cyIsImVpIiwibG9jYWxXcml0ZVRpbWUiLCJhcHBseVRvUmVtb3RlRG9jdW1lbnQiLCJtdXRhdGlvblJlc3VsdHMiLCJhcHBseVRvTG9jYWxWaWV3IiwiYXBwbHlUb0xvY2FsRG9jdW1lbnRTZXQiLCJuaSIsImJhdGNoIiwiY29tbWl0VmVyc2lvbiIsImRvY1ZlcnNpb25zIiwiaWkiLCJ3aSIsIlRlIiwieWkiLCJwaSIsImFkZFRvQ29sbGVjdGlvblBhcmVudEluZGV4IiwiZ2V0Q29sbGVjdGlvblBhcmVudHMiLCJnZXRFbnRyaWVzIiwiQWkiLCJjYWNoZVNpemVDb2xsZWN0aW9uVGhyZXNob2xkIiwicGVyY2VudGlsZVRvQ29sbGVjdCIsIm1heGltdW1TZXF1ZW5jZU51bWJlcnNUb0NvbGxlY3QiLCJ3aXRoQ2FjaGVTaXplIiwiREVGQVVMVF9DT0xMRUNUSU9OX1BFUkNFTlRJTEUiLCJERUZBVUxUX01BWF9TRVFVRU5DRV9OVU1CRVJTX1RPX0NPTExFQ1QiLCJERUZBVUxUIiwiRElTQUJMRUQiLCJDaSIsIk9pIiwiS2kiLCJtYXBLZXlGbiIsImVxdWFsc0ZuIiwiaW5uZXIiLCJqaSIsImNoYW5nZXMiLCJjaGFuZ2VzQXBwbGllZCIsImdldFJlYWRUaW1lIiwiYWRkRW50cnkiLCJhc3NlcnROb3RBcHBsaWVkIiwicmVtb3ZlRW50cnkiLCJnZXRFbnRyeSIsImdldEZyb21DYWNoZSIsImdldEFsbEZyb21DYWNoZSIsImlyIiwiQW4iLCJnZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdEb2N1bWVudEtleSIsInZuIiwiZ2V0QWxsTXV0YXRpb25CYXRjaGVzQWZmZWN0aW5nRG9jdW1lbnRLZXlzIiwiZ2V0RG9jdW1lbnRzTWF0Y2hpbmdRdWVyeSIsIlZuIiwieWUiLCJTbiIsIkRuIiwiZ2V0QWxsTXV0YXRpb25CYXRjaGVzQWZmZWN0aW5nUXVlcnkiLCJDbiIsInJyIiwiZnJvbUNhY2hlIiwiTm4iLCJ4biIsImtuIiwiZG9jQ2hhbmdlcyIsImRvYyIsIiRuIiwiT24iLCJGbiIsIk1uIiwid2UiLCJiZSIsImdldE11dGF0aW9uUXVldWUiLCJnZXRSZW1vdGVEb2N1bWVudENhY2hlIiwiZ2V0VGFyZ2V0Q2FjaGUiLCJnZXRJbmRleE1hbmFnZXIiLCJnZXRCdW5kbGVDYWNoZSIsImNvbGxlY3RHYXJiYWdlIiwicnVuVHJhbnNhY3Rpb24iLCJjb2xsZWN0IiwidXIiLCJnZXRBbGxNdXRhdGlvbkJhdGNoZXMiLCJyZW1vdmVkQmF0Y2hJZHMiLCJhZGRlZEJhdGNoSWRzIiwid3IiLCJnZXROZXh0TXV0YXRpb25CYXRjaEFmdGVyQmF0Y2hJZCIsIkFyIiwiZ2V0QnVuZGxlTWV0YWRhdGEiLCJzYXZlQnVuZGxlTWV0YWRhdGEiLCJnZXROYW1lZFF1ZXJ5Iiwic2F2ZU5hbWVkUXVlcnkiLCJSciIsIlpuIiwiUHIiLCJ0cyIsImVzIiwibnMiLCJhZGRSZWZlcmVuY2UiLCJzcyIsInJlbW92ZVJlZmVyZW5jZSIsInJzIiwib3MiLCJjcyIsImhzIiwiY29udGFpbnNLZXkiLCJiciIsInJlZmVyZW5jZURlbGVnYXRlIiwiZnMiLCJkcyIsImNoZWNrRW1wdHkiLCJhZGRNdXRhdGlvbkJhdGNoIiwibG9va3VwTXV0YXRpb25CYXRjaCIsIndzIiwiZ2V0SGlnaGVzdFVuYWNrbm93bGVkZ2VkQmF0Y2hJZCIsInJlbW92ZU11dGF0aW9uQmF0Y2giLCJtYXJrUG90ZW50aWFsbHlPcnBoYW5lZCIsInBlcmZvcm1Db25zaXN0ZW5jeUNoZWNrIiwidnIiLCJkb2NzIiwibmV3Q2hhbmdlQnVmZmVyIiwiVnIiLCJnZXRTaXplIiwiU3IiLCJBcyIsIlJzIiwiZm9yRWFjaFRhcmdldCIsImdldExhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24iLCJnZXRIaWdoZXN0U2VxdWVuY2VOdW1iZXIiLCJhbGxvY2F0ZVRhcmdldElkIiwic2V0VGFyZ2V0c01ldGFkYXRhIiwiYWRkVGFyZ2V0RGF0YSIsInVwZGF0ZVRhcmdldERhdGEiLCJyZW1vdmVUYXJnZXREYXRhIiwicmVtb3ZlVGFyZ2V0cyIsInJlbW92ZU1hdGNoaW5nS2V5c0ZvclRhcmdldElkIiwiZ2V0VGFyZ2V0Q291bnQiLCJnZXRUYXJnZXREYXRhIiwiYWRkTWF0Y2hpbmdLZXlzIiwicmVtb3ZlTWF0Y2hpbmdLZXlzIiwiZ2V0TWF0Y2hpbmdLZXlzRm9yVGFyZ2V0SWQiLCJEciIsInN0YXJ0ZWQiLCJzZXREYXRhYmFzZURlbGV0ZWRMaXN0ZW5lciIsInNldE5ldHdvcmtFbmFibGVkIiwiQ3IiLCJTcyIsImN1cnJlbnRTZXF1ZW5jZU51bWJlciIsIk5yIiwiRHMiLCJyZW1vdmVUYXJnZXQiLCJ1cGRhdGVMaW1ib0RvY3VtZW50IiwiQnIiLCJhY3RpdmVUYXJnZXRJZHMiLCJxciIsIm9ubGluZVN0YXRlSGFuZGxlciIsImFkZFBlbmRpbmdNdXRhdGlvbiIsInVwZGF0ZU11dGF0aW9uU3RhdGUiLCJhZGRMb2NhbFF1ZXJ5VGFyZ2V0IiwidXBkYXRlUXVlcnlTdGF0ZSIsInJlbW92ZUxvY2FsUXVlcnlUYXJnZXQiLCJpc0xvY2FsUXVlcnlUYXJnZXQiLCJjbGVhclF1ZXJ5U3RhdGUiLCJnZXRBbGxBY3RpdmVRdWVyeVRhcmdldHMiLCJpc0FjdGl2ZVF1ZXJ5VGFyZ2V0IiwiaGFuZGxlVXNlckNoYW5nZSIsInNldE9ubGluZVN0YXRlIiwibm90aWZ5QnVuZGxlTG9hZGVkIiwiS3IiLCJFaSIsImpyIiwiVGkiLCJJaSIsIlJpIiwiUGkiLCJiaSIsIlFyIiwiQmF0Y2hHZXREb2N1bWVudHMiLCJDb21taXQiLCJSdW5RdWVyeSIsIldyIiwidmkiLCJWaSIsIlNpIiwiRGkiLCJOaSIsInhpIiwia2kiLCIkaSIsIkdyIiwiZGF0YWJhc2VJbmZvIiwic3NsIiwiRmkiLCJNaSIsIkxpIiwiQmkiLCJVaSIsInFpIiwiYXV0b0RldGVjdExvbmdQb2xsaW5nIiwidXNlRmV0Y2hTdHJlYW1zIiwiZm9yd2FyZENoYW5uZWxSZXF1ZXN0VGltZW91dE1zIiwiSHIiLCJKciIsIllyIiwiUWkiLCJXaSIsIkdpIiwiemkiLCJIaSIsIkppIiwiWWkiLCJYaSIsIlppIiwiZW5xdWV1ZUFmdGVyRGVsYXkiLCJ0ciIsInNraXBEZWxheSIsIlhyIiwiZXIiLCJuciIsImNyZWRlbnRpYWxzUHJvdmlkZXIiLCJzciIsImNyIiwiaHIiLCJsciIsImRyIiwiX3IiLCJtciIsImdyIiwieXIiLCJwciIsIkVyIiwiZW5xdWV1ZUFuZEZvcmdldCIsInN0cmVhbVRva2VuIiwiaXMiLCJ3cml0ZVJlc3VsdHMiLCJjb21taXRUaW1lIiwiSm4iLCJ3cml0ZXMiLCJ1cGRhdGVNYXNrIiwidXBkYXRlVHJhbnNmb3JtcyIsInNldFRvU2VydmVyVmFsdWUiLCJhcHBlbmRNaXNzaW5nRWxlbWVudHMiLCJyZW1vdmVBbGxGcm9tQXJyYXkiLCJpbmNyZW1lbnQiLCJjdXJyZW50RG9jdW1lbnQiLCJlbyIsInRlcm1pbmF0ZSIsIm5vIiwiYXN5bmNRdWV1ZSIsImtyIiwiJHIiLCJPciIsIkZyIiwiTXIiLCJMciIsInNvIiwibG9jYWxTdG9yZSIsImRhdGFzdG9yZSIsInJlbW90ZVN5bmNlciIsIlVyIiwiZm8iLCJybyIsImlvIiwieW8iLCJwbyIsIkVvIiwiQ28iLCJUbyIsIklvIiwiQW8iLCJSbyIsIlBvIiwiYm8iLCJ2byIsImFwcGx5U3VjY2Vzc2Z1bFdyaXRlIiwiVm8iLCJsbiIsInJlamVjdEZhaWxlZFdyaXRlIiwiTm8iLCJ0YXJnZXRUaW1lTXMiLCJyZW1vdmFsQ2FsbGJhY2siLCJjcmVhdGVBbmRTY2hlZHVsZSIsInRpbWVySGFuZGxlIiwiaGFuZGxlRGVsYXlFbGFwc2VkIiwieG8iLCJNbyIsInF1ZXJpZXMiLCJvbmxpbmVTdGF0ZSIsIlpyIiwicmVtb3RlU3RvcmUiLCJzaGFyZWRDbGllbnRTdGF0ZSIsIm1heENvbmN1cnJlbnRMaW1ib1Jlc29sdXRpb25zIiwia28iLCIkbyIsIk9vIiwiRm8iLCJMbyIsIkJvIiwiVW8iLCJxbyIsImlzUHJpbWFyeUNsaWVudCIsInZpZXciLCJzbmFwc2hvdCIsIktvIiwiVHIiLCJ0cmFja1JlbW92YWxzIiwic25hcHNob3RWZXJzaW9uIiwid2l0aExhc3RMaW1ib0ZyZWVTbmFwc2hvdFZlcnNpb24iLCJzeW5jaHJvbml6ZVRhYnMiLCJXbyIsIkdvIiwiZ2NTY2hlZHVsZXIiLCJ6byIsIkhvIiwiaW5pdGlhbFVzZXIiLCJjcmVhdGVEYXRhc3RvcmUiLCJjcmVhdGVSZW1vdGVTdG9yZSIsImNyZWF0ZUV2ZW50TWFuYWdlciIsInN5bmNFbmdpbmUiLCJjcmVhdGVTeW5jRW5naW5lIiwiaGFuZGxlQ3JlZGVudGlhbENoYW5nZSIsIlNvIiwiY3JlZGVudGlhbExpc3RlbmVyIiwiZ2V0Q29uZmlndXJhdGlvbiIsInNldENyZWRlbnRpYWxDaGFuZ2VMaXN0ZW5lciIsInZlcmlmeU5vdFRlcm1pbmF0ZWQiLCJpc1NodXR0aW5nRG93biIsImVudGVyUmVzdHJpY3RlZE1vZGUiLCJlbnF1ZXVlQW5kRm9yZ2V0RXZlbldoaWxlUmVzdHJpY3RlZCIsIm9ubGluZUNvbXBvbmVudHMiLCJvZmZsaW5lQ29tcG9uZW50cyIsInZlcmlmeU9wZXJhdGlvbkluUHJvZ3Jlc3MiLCJwZXJzaXN0ZW5jZUtleSIsImlzRGVmYXVsdERhdGFiYXNlIiwiaWdub3JlVW5kZWZpbmVkUHJvcGVydGllcyIsImNhY2hlU2l6ZUJ5dGVzIiwiZXhwZXJpbWVudGFsRm9yY2VMb25nUG9sbGluZyIsImV4cGVyaW1lbnRhbEF1dG9EZXRlY3RMb25nUG9sbGluZyIsIl9jcmVkZW50aWFscyIsIl9wZXJzaXN0ZW5jZUtleSIsIl9zZXR0aW5ncyIsIl9zZXR0aW5nc0Zyb3plbiIsIl9kYXRhYmFzZUlkIiwiX2FwcCIsIl9pbml0aWFsaXplZCIsIl90ZXJtaW5hdGVkIiwiX3Rlcm1pbmF0ZVRhc2siLCJfc2V0U2V0dGluZ3MiLCJjbGllbnQiLCJzZXNzaW9uSW5kZXgiLCJpYW1Ub2tlbiIsIl9nZXRTZXR0aW5ncyIsIl9mcmVlemVTZXR0aW5ncyIsIl90ZXJtaW5hdGUiLCJjb252ZXJ0ZXIiLCJmaXJlc3RvcmUiLCJfcGF0aCIsIndpdGhDb252ZXJ0ZXIiLCJfcXVlcnkiLCJkZSIsInZpc2liaWxpdHlTdGF0ZSIsImVucXVldWUiLCJzdGFjayIsIl9xdWV1ZSIsIl9maXJlc3RvcmVDbGllbnQiLCJfaW50ZXJuYWxQYXRoIiwiX2J5dGVTdHJpbmciLCJfbWV0aG9kTmFtZSIsImlzRmluaXRlIiwiX2xhdCIsIl9sb25nIiwidHUiLCJudSIsInRvTXV0YXRpb24iLCJzdSIsIml1IiwiUnUiLCJtZXRob2ROYW1lIiwicnUiLCJjdSIsIl90b0ZpZWxkVHJhbnNmb3JtIiwiaHUiLCJndSIsInB1IiwiRXUiLCJ5dSIsImdldFByb3RvdHlwZU9mIiwiVHUiLCJBdSIsIkl1Iiwic2VhcmNoIiwiUHUiLCJ3aCIsIm91IiwiX3UiLCJ3dSIsInBoIiwiUmgiLCJTaCIsInN0b3JhZ2VCdWNrZXQiLCJtZXNzYWdpbmdTZW5kZXJJZCIsIm1lYXN1cmVtZW50SWQiLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsImRlZmluaXRpb24iLCJwcm9wIiwidXNlckRhdGEiLCJwaG9uZSIsImFsZXJ0IiwiZG9jU3RyaW5nIiwiZ2V0RWxlbWVudEJ5SWQiLCJpbm5lckhUTUwiLCJkb2N1bWVudE5hbWUiLCJmaWxlVXJsIiwic2VsZWN0RWxlbWVudCIsImVkaXREb2N1bWVudFBhZ2VGb3JtIiwic2VsZWN0ZWRJbmRleCIsImVkaXREb2N1bWVudFBhZ2VOYW1lT2ZEb2N1bWVudCIsImVkaXREb2N1bWVudFBhZ2VUeXBlT2ZEb2N1bWVudE9wdGlvbnMiLCJlZGl0RG9jdW1lbnRQYWdlVHlwZU9mRG9jdW1lbnRTZWxlY3RlZCIsIm9sZERvYyIsIm5ld0ZpbGVVUkwiLCJlZGl0RG9jdW1lbnRQYWdlRmlsZUlucHV0IiwiZWRpdERvY3VtZW50UGFnZUZpbGVVcGxvYWRlZCIsImZpbGVzIiwibmV3U3RvcmFnZVJlZiIsImRvY1JlZiIsImZpbGVOYW1lIiwiZmlsZVR5cGUiLCJmaWxlU2l6ZSIsInVwZGF0ZWRBdCIsImVkaXREb2N1bWVudCJdLCJzb3VyY2VSb290IjoiIn0=