/*! For license information please see edit_document_page.bundle.js.LICENSE.txt */
(()=>{"use strict";var t={36:(t,e,n)=>{n.d(e,{Ao:()=>ui,Bx:()=>hi,Jh:()=>di,O4:()=>li,ZS:()=>mi,_L:()=>pi,fF:()=>ci,iO:()=>gi,ro:()=>fi});var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},i(t,e)};function r(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var s,o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{},a=a||{},c=o||self;function u(){}function l(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function h(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var d="closure_uid_"+(1e9*Math.random()>>>0),f=0;function p(t,e,n){return t.call.apply(t.bind,arguments)}function g(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function m(t,e,n){return(m=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?p:g).apply(null,arguments)}function y(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function v(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(t,n,i){for(var r=Array(arguments.length-2),s=2;s<arguments.length;s++)r[s-2]=arguments[s];return e.prototype[n].apply(t,r)}}function w(){this.s=this.s,this.o=this.o}var b={};w.prototype.s=!1,w.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var t=function(t){return Object.prototype.hasOwnProperty.call(t,d)&&t[d]||(t[d]=++f)}(this);delete b[t]}},w.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var _=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},I=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var i=t.length,r="string"==typeof t?t.split(""):t,s=0;s<i;s++)s in r&&e.call(n,r[s],s,t)};function T(t){return Array.prototype.concat.apply([],arguments)}function E(t){var e=t.length;if(0<e){for(var n=Array(e),i=0;i<e;i++)n[i]=t[i];return n}return[]}function S(t){return/^[\s\xa0]*$/.test(t)}var A,k=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function R(t,e){return-1!=t.indexOf(e)}function N(t,e){return t<e?-1:t>e?1:0}t:{var C=c.navigator;if(C){var O=C.userAgent;if(O){A=O;break t}}A=""}function D(t,e,n){for(var i in t)e.call(n,t[i],i,t)}function P(t){var e={};for(var n in t)e[n]=t[n];return e}var L="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function x(t,e){for(var n,i,r=1;r<arguments.length;r++){for(n in i=arguments[r])t[n]=i[n];for(var s=0;s<L.length;s++)n=L[s],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function M(t){return M[" "](t),t}M[" "]=u;var U,F,V=R(A,"Opera"),j=R(A,"Trident")||R(A,"MSIE"),B=R(A,"Edge"),H=B||j,K=R(A,"Gecko")&&!(R(A.toLowerCase(),"webkit")&&!R(A,"Edge"))&&!(R(A,"Trident")||R(A,"MSIE"))&&!R(A,"Edge"),q=R(A.toLowerCase(),"webkit")&&!R(A,"Edge");function z(){var t=c.document;return t?t.documentMode:void 0}t:{var $="",G=(F=A,K?/rv:([^\);]+)(\)|;)/.exec(F):B?/Edge\/([\d\.]+)/.exec(F):j?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(F):q?/WebKit\/(\S+)/.exec(F):V?/(?:Version)[ \/]?(\S+)/.exec(F):void 0);if(G&&($=G?G[1]:""),j){var W=z();if(null!=W&&W>parseFloat($)){U=String(W);break t}}U=$}var X,Q={};function J(){return t=Q,Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=function(){for(var t=0,e=k(String(U)).split("."),n=k("9").split("."),i=Math.max(e.length,n.length),r=0;0==t&&r<i;r++){var s=e[r]||"",o=n[r]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],0==s[0].length&&0==o[0].length)break;t=N(0==s[1].length?0:parseInt(s[1],10),0==o[1].length?0:parseInt(o[1],10))||N(0==s[2].length,0==o[2].length)||N(s[2],o[2]),s=s[3],o=o[3]}while(0==t)}return 0<=t}();var t}c.document&&j?X=z()||parseInt(U,10)||void 0:X=void 0;var Y=X,Z=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{c.addEventListener("test",u,e),c.removeEventListener("test",u,e)}catch(t){}return t}();function tt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}function et(t,e){if(tt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(K){t:{try{M(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:nt[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&et.Z.h.call(this)}}tt.prototype.h=function(){this.defaultPrevented=!0},v(et,tt);var nt={2:"touch",3:"pen",4:"mouse"};et.prototype.h=function(){et.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var it="closure_listenable_"+(1e6*Math.random()|0),rt=0;function st(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.ia=r,this.key=++rt,this.ca=this.fa=!1}function ot(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function at(t){this.src=t,this.g={},this.h=0}function ct(t,e){var n=e.type;if(n in t.g){var i,r=t.g[n],s=_(r,e);(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(ot(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function ut(t,e,n,i){for(var r=0;r<t.length;++r){var s=t[r];if(!s.ca&&s.listener==e&&s.capture==!!n&&s.ia==i)return r}return-1}at.prototype.add=function(t,e,n,i,r){var s=t.toString();(t=this.g[s])||(t=this.g[s]=[],this.h++);var o=ut(t,e,i,r);return-1<o?(e=t[o],n||(e.fa=!1)):((e=new st(e,this.src,s,!!i,r)).fa=n,t.push(e)),e};var lt="closure_lm_"+(1e6*Math.random()|0),ht={};function dt(t,e,n,i,r){if(i&&i.once)return pt(t,e,n,i,r);if(Array.isArray(e)){for(var s=0;s<e.length;s++)dt(t,e[s],n,i,r);return null}return n=_t(n),t&&t[it]?t.N(e,n,h(i)?!!i.capture:!!i,r):ft(t,e,n,!1,i,r)}function ft(t,e,n,i,r,s){if(!e)throw Error("Invalid event type");var o=h(r)?!!r.capture:!!r,a=wt(t);if(a||(t[lt]=a=new at(t)),(n=a.add(e,n,i,o,s)).proxy)return n;if(i=function(){var t=vt;return function e(n){return t.call(e.src,e.listener,n)}}(),n.proxy=i,i.src=t,i.listener=n,t.addEventListener)Z||(r=o),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(yt(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function pt(t,e,n,i,r){if(Array.isArray(e)){for(var s=0;s<e.length;s++)pt(t,e[s],n,i,r);return null}return n=_t(n),t&&t[it]?t.O(e,n,h(i)?!!i.capture:!!i,r):ft(t,e,n,!0,i,r)}function gt(t,e,n,i,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)gt(t,e[s],n,i,r);else i=h(i)?!!i.capture:!!i,n=_t(n),t&&t[it]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=ut(s=t.g[e],n,i,r))&&(ot(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete t.g[e],t.h--))):t&&(t=wt(t))&&(e=t.g[e.toString()],t=-1,e&&(t=ut(e,n,i,r)),(n=-1<t?e[t]:null)&&mt(n))}function mt(t){if("number"!=typeof t&&t&&!t.ca){var e=t.src;if(e&&e[it])ct(e.i,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(yt(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=wt(e))?(ct(n,t),0==n.h&&(n.src=null,e[lt]=null)):ot(t)}}}function yt(t){return t in ht?ht[t]:ht[t]="on"+t}function vt(t,e){if(t.ca)t=!0;else{e=new et(e,this);var n=t.listener,i=t.ia||t.src;t.fa&&mt(t),t=n.call(i,e)}return t}function wt(t){return(t=t[lt])instanceof at?t:null}var bt="__closure_events_fn_"+(1e9*Math.random()>>>0);function _t(t){return"function"==typeof t?t:(t[bt]||(t[bt]=function(e){return t.handleEvent(e)}),t[bt])}function It(){w.call(this),this.i=new at(this),this.P=this,this.I=null}function Tt(t,e){var n,i=t.I;if(i)for(n=[];i;i=i.I)n.push(i);if(t=t.P,i=e.type||e,"string"==typeof e)e=new tt(e,t);else if(e instanceof tt)e.target=e.target||t;else{var r=e;x(e=new tt(i,t),r)}if(r=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];r=Et(o,i,!0,e)&&r}if(r=Et(o=e.g=t,i,!0,e)&&r,r=Et(o,i,!1,e)&&r,n)for(s=0;s<n.length;s++)r=Et(o=e.g=n[s],i,!1,e)&&r}function Et(t,e,n,i){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var r=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.ca&&o.capture==n){var a=o.listener,c=o.ia||o.src;o.fa&&ct(t.i,o),r=!1!==a.call(c,i)&&r}}return r&&!i.defaultPrevented}v(It,w),It.prototype[it]=!0,It.prototype.removeEventListener=function(t,e,n,i){gt(this,t,e,n,i)},It.prototype.M=function(){if(It.Z.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],i=0;i<n.length;i++)ot(n[i]);delete e.g[t],e.h--}}this.I=null},It.prototype.N=function(t,e,n,i){return this.i.add(String(t),e,!1,n,i)},It.prototype.O=function(t,e,n,i){return this.i.add(String(t),e,!0,n,i)};var St=c.JSON.stringify;function At(){var t=Lt,e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var kt,Rt=function(){function t(){this.h=this.g=null}return t.prototype.add=function(t,e){var n=Nt.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n},t}(),Nt=new(function(){function t(t,e){this.i=t,this.j=e,this.h=0,this.g=null}return t.prototype.get=function(){var t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t},t}())((function(){return new Ct}),(function(t){return t.reset()})),Ct=function(){function t(){this.next=this.g=this.h=null}return t.prototype.set=function(t,e){this.h=t,this.g=e,this.next=null},t.prototype.reset=function(){this.next=this.g=this.h=null},t}();function Ot(t){c.setTimeout((function(){throw t}),0)}function Dt(t,e){kt||function(){var t=c.Promise.resolve(void 0);kt=function(){t.then(xt)}}(),Pt||(kt(),Pt=!0),Lt.add(t,e)}var Pt=!1,Lt=new Rt;function xt(){for(var t;t=At();){try{t.h.call(t.g)}catch(t){Ot(t)}var e=Nt;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Pt=!1}function Mt(t,e){It.call(this),this.h=t||1,this.g=e||c,this.j=m(this.kb,this),this.l=Date.now()}function Ut(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}function Ft(t,e,n){if("function"==typeof t)n&&(t=m(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=m(t.handleEvent,t)}return 2147483647<Number(e)?-1:c.setTimeout(t,e||0)}function Vt(t){t.g=Ft((function(){t.g=null,t.i&&(t.i=!1,Vt(t))}),t.j);var e=t.h;t.h=null,t.m.apply(null,e)}v(Mt,It),(s=Mt.prototype).da=!1,s.S=null,s.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Tt(this,"tick"),this.da&&(Ut(this),this.start()))}},s.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},s.M=function(){Mt.Z.M.call(this),Ut(this),delete this.g};var jt=function(t){function e(e,n){var i=t.call(this)||this;return i.m=e,i.j=n,i.h=null,i.i=!1,i.g=null,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.l=function(t){this.h=arguments,this.g?this.i=!0:Vt(this)},e.prototype.M=function(){t.prototype.M.call(this),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},e}(w);function Bt(t){w.call(this),this.h=t,this.g={}}v(Bt,w);var Ht=[];function Kt(t,e,n,i){Array.isArray(n)||(n&&(Ht[0]=n.toString()),n=Ht);for(var r=0;r<n.length;r++){var s=dt(e,n[r],i||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function qt(t){D(t.g,(function(t,e){this.g.hasOwnProperty(e)&&mt(t)}),t),t.g={}}function zt(){this.g=!0}function $t(t,e,n,i){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var i=n[t];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<r.length;o++)r[o]=""}}}return St(n)}catch(t){return e}}(t,n)+(i?" "+i:"")}))}Bt.prototype.M=function(){Bt.Z.M.call(this),qt(this)},Bt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},zt.prototype.Aa=function(){this.g=!1},zt.prototype.info=function(){};var Gt={},Wt=null;function Xt(){return Wt=Wt||new It}function Qt(t){tt.call(this,Gt.Ma,t)}function Jt(t){var e=Xt();Tt(e,new Qt(e,t))}function Yt(t,e){tt.call(this,Gt.STAT_EVENT,t),this.stat=e}function Zt(t){var e=Xt();Tt(e,new Yt(e,t))}function te(t,e){tt.call(this,Gt.Na,t),this.size=e}function ee(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return c.setTimeout((function(){t()}),e)}Gt.Ma="serverreachability",v(Qt,tt),Gt.STAT_EVENT="statevent",v(Yt,tt),Gt.Na="timingevent",v(te,tt);var ne={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},ie={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function re(){}function se(t){return t.h||(t.h=t.i())}function oe(){}re.prototype.h=null;var ae,ce={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function ue(){tt.call(this,"d")}function le(){tt.call(this,"c")}function he(){}function de(t,e,n,i){this.l=t,this.j=e,this.m=n,this.X=i||1,this.V=new Bt(this),this.P=pe,t=H?125:void 0,this.W=new Mt(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new fe}function fe(){this.i=null,this.g="",this.h=!1}v(ue,tt),v(le,tt),v(he,re),he.prototype.g=function(){return new XMLHttpRequest},he.prototype.i=function(){return{}},ae=new he;var pe=45e3,ge={},me={};function ye(t,e,n){t.K=1,t.v=je(Le(e)),t.s=n,t.U=!0,ve(t,null)}function ve(t,e){t.F=Date.now(),Ie(t),t.A=Le(t.v);var n=t.A,i=t.X;Array.isArray(i)||(i=[String(i)]),Ze(n.h,"t",i),t.C=0,n=t.l.H,t.h=new fe,t.g=ei(t.l,n?e:null,!t.s),0<t.O&&(t.L=new jt(m(t.Ia,t,t.g),t.O)),Kt(t.V,t.g,"readystatechange",t.gb),e=t.H?P(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),Jt(1),function(t,e,n,i,r,s){t.info((function(){if(t.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+u+"&":o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+e+"\n"+n+"\n"+o}))}(t.j,t.u,t.A,t.m,t.X,t.s)}function we(t){return!!t.g&&"GET"==t.u&&2!=t.K&&t.l.Ba}function be(t,e,n){for(var i,r=!0;!t.I&&t.C<n.length;){if((i=_e(t,n))==me){4==e&&(t.o=4,Zt(14),r=!1),$t(t.j,t.m,null,"[Incomplete Response]");break}if(i==ge){t.o=4,Zt(15),$t(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}$t(t.j,t.m,i,null),ke(t,i)}we(t)&&i!=me&&i!=ge&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,Zt(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.aa&&(t.aa=!0,(e=t.l).g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),Gn(e),e.L=!0,Zt(11))):($t(t.j,t.m,n,"[Invalid Chunked Response]"),Ae(t),Se(t))}function _e(t,e){var n=t.C,i=e.indexOf("\n",n);return-1==i?me:(n=Number(e.substring(n,i)),isNaN(n)?ge:(i+=1)+n>e.length?me:(e=e.substr(i,n),t.C=i+n,e))}function Ie(t){t.Y=Date.now()+t.P,Te(t,t.P)}function Te(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=ee(m(t.eb,t),e)}function Ee(t){t.B&&(c.clearTimeout(t.B),t.B=null)}function Se(t){0==t.l.G||t.I||Qn(t.l,t)}function Ae(t){Ee(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,Ut(t.W),qt(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function ke(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||an(n.i,t)))if(n.I=t.N,!t.J&&an(n.i,t)&&3==n.G){try{var i=n.Ca.g.parse(e)}catch(s){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;Xn(n),Fn(n)}$n(n),Zt(18)}}else n.ta=r[1],0<n.ta-n.U&&37500>r[2]&&n.N&&0==n.A&&!n.v&&(n.v=ee(m(n.ab,n),6e3));if(1>=on(n.i)&&n.ka){try{n.ka()}catch(s){}n.ka=void 0}}else Yn(n,11)}else if((t.J||n.g==t)&&Xn(n),!S(e))for(r=n.Ca.g.parse(e),e=0;e<r.length;e++){var s=r[e];if(n.U=s[0],s=s[1],2==n.G)if("c"==s[0]){n.J=s[1],n.la=s[2];var o=s[3];null!=o&&(n.ma=o,n.h.info("VER="+n.ma));var a=s[4];null!=a&&(n.za=a,n.h.info("SVER="+n.za));var c=s[5];null!=c&&"number"==typeof c&&0<c&&(i=1.5*c,n.K=i,n.h.info("backChannelRequestTimeoutMs_="+i)),i=n;var u=t.g;if(u){var l=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=i.i;!h.g&&(R(l,"spdy")||R(l,"quic")||R(l,"h2"))&&(h.j=h.l,h.g=new Set,h.h&&(cn(h,h.h),h.h=null))}if(i.D){var d=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null;d&&(i.sa=d,Ve(i.F,i.D,d))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms"));var f=t;if((i=n).oa=ti(i,i.H?i.la:null,i.W),f.J){un(i.i,f);var p=f,g=i.K;g&&p.setTimeout(g),p.B&&(Ee(p),Ie(p)),i.g=f}else zn(i);0<n.l.length&&Bn(n)}else"stop"!=s[0]&&"close"!=s[0]||Yn(n,7);else 3==n.G&&("stop"==s[0]||"close"==s[0]?"stop"==s[0]?Yn(n,7):Un(n):"noop"!=s[0]&&n.j&&n.j.wa(s),n.A=0)}Jt(4)}catch(s){}}function Re(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(l(t)||"string"==typeof t)I(t,e,void 0);else{if(t.T&&"function"==typeof t.T)var n=t.T();else if(t.R&&"function"==typeof t.R)n=void 0;else if(l(t)||"string"==typeof t){n=[];for(var i=t.length,r=0;r<i;r++)n.push(r)}else for(r in n=[],i=0,t)n[i++]=r;i=function(t){if(t.R&&"function"==typeof t.R)return t.R();if("string"==typeof t)return t.split("");if(l(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t),r=i.length;for(var s=0;s<r;s++)e.call(void 0,i[s],n&&n[s],t)}}function Ne(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof Ne)for(n=t.T(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function Ce(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var i=t.g[e];Oe(t.h,i)&&(t.g[n++]=i),e++}t.g.length=n}if(t.i!=t.g.length){var r={};for(n=e=0;e<t.g.length;)Oe(r,i=t.g[e])||(t.g[n++]=i,r[i]=1),e++;t.g.length=n}}function Oe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(s=de.prototype).setTimeout=function(t){this.P=t},s.gb=function(t){t=t.target;var e=this.L;e&&3==Dn(t)?e.l():this.Ia(t)},s.Ia=function(t){try{if(t==this.g)t:{var e=Dn(this.g),n=this.g.Da(),i=this.g.ba();if(!(3>e)&&(3!=e||H||this.g&&(this.h.h||this.g.ga()||Pn(this.g)))){this.I||4!=e||7==n||Jt(8==n||0>=i?3:2),Ee(this);var r=this.g.ba();this.N=r;e:if(we(this)){var s=Pn(this.g);t="";var o=s.length,a=4==Dn(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Ae(this),Se(this);var u="";break e}this.h.i=new c.TextDecoder}for(n=0;n<o;n++)this.h.h=!0,t+=this.h.i.decode(s[n],{stream:a&&n==o-1});s.splice(0,o),this.h.g+=t,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==r,function(t,e,n,i,r,s,o){t.info((function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+e+"\n"+n+"\n"+s+" "+o}))}(this.j,this.u,this.A,this.m,this.X,e,r),this.i){if(this.$&&!this.J){e:{if(this.g){var l,h=this.g;if((l=h.g?h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!S(l)){var d=l;break e}}d=null}if(!(r=d)){this.i=!1,this.o=3,Zt(12),Ae(this),Se(this);break t}$t(this.j,this.m,r,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,ke(this,r)}this.U?(be(this,e,u),H&&this.i&&3==e&&(Kt(this.V,this.W,"tick",this.fb),this.W.start())):($t(this.j,this.m,u,null),ke(this,u)),4==e&&Ae(this),this.i&&!this.I&&(4==e?Qn(this.l,this):(this.i=!1,Ie(this)))}else 400==r&&0<u.indexOf("Unknown SID")?(this.o=3,Zt(12)):(this.o=0,Zt(13)),Ae(this),Se(this)}}}catch(e){}},s.fb=function(){if(this.g){var t=Dn(this.g),e=this.g.ga();this.C<e.length&&(Ee(this),be(this,t,e),this.i&&4!=t&&Ie(this))}},s.cancel=function(){this.I=!0,Ae(this)},s.eb=function(){this.B=null;var t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.K&&(Jt(3),Zt(17)),Ae(this),this.o=2,Se(this)):Te(this,this.Y-t)},(s=Ne.prototype).R=function(){Ce(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t},s.T=function(){return Ce(this),this.g.concat()},s.get=function(t,e){return Oe(this.h,t)?this.h[t]:e},s.set=function(t,e){Oe(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e},s.forEach=function(t,e){for(var n=this.T(),i=0;i<n.length;i++){var r=n[i],s=this.get(r);t.call(e,s,r,this)}};var De=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Pe(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof Pe){this.g=void 0!==e?e:t.g,xe(this,t.j),this.s=t.s,Me(this,t.i),Ue(this,t.m),this.l=t.l,e=t.h;var n=new Xe;n.i=e.i,e.g&&(n.g=new Ne(e.g),n.h=e.h),Fe(this,n),this.o=t.o}else t&&(n=String(t).match(De))?(this.g=!!e,xe(this,n[1]||"",!0),this.s=Be(n[2]||""),Me(this,n[3]||"",!0),Ue(this,n[4]),this.l=Be(n[5]||"",!0),Fe(this,n[6]||"",!0),this.o=Be(n[7]||"")):(this.g=!!e,this.h=new Xe(null,this.g))}function Le(t){return new Pe(t)}function xe(t,e,n){t.j=n?Be(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Me(t,e,n){t.i=n?Be(e,!0):e}function Ue(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Fe(t,e,n){e instanceof Xe?(t.h=e,function(t,e){e&&!t.j&&(Qe(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Je(this,e),Ze(this,n,t))}),t)),t.j=e}(t.h,t.g)):(n||(e=He(e,Ge)),t.h=new Xe(e,t.g))}function Ve(t,e,n){t.h.set(e,n)}function je(t){return Ve(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Be(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function He(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Ke),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Ke(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Pe.prototype.toString=function(){var t=[],e=this.j;e&&t.push(He(e,qe,!0),":");var n=this.i;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(He(e,qe,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&t.push("/"),t.push(He(n,"/"==n.charAt(0)?$e:ze,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",He(n,We)),t.join("")};var qe=/[#\/\?@]/g,ze=/[#\?:]/g,$e=/[#\?]/g,Ge=/[#\?@]/g,We=/#/g;function Xe(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Qe(t){t.g||(t.g=new Ne,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var s=t[n].substring(0,i);r=t[n].substring(i+1)}else s=t[n];e(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Je(t,e){Qe(t),e=tn(t,e),Oe(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,Oe((t=t.g).h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&Ce(t)))}function Ye(t,e){return Qe(t),e=tn(t,e),Oe(t.g.h,e)}function Ze(t,e,n){Je(t,e),0<n.length&&(t.i=null,t.g.set(tn(t,e),E(n)),t.h+=n.length)}function tn(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(s=Xe.prototype).add=function(t,e){Qe(this),this.i=null,t=tn(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},s.forEach=function(t,e){Qe(this),this.g.forEach((function(n,i){I(n,(function(n){t.call(e,n,i,this)}),this)}),this)},s.T=function(){Qe(this);for(var t=this.g.R(),e=this.g.T(),n=[],i=0;i<e.length;i++)for(var r=t[i],s=0;s<r.length;s++)n.push(e[i]);return n},s.R=function(t){Qe(this);var e=[];if("string"==typeof t)Ye(this,t)&&(e=T(e,this.g.get(tn(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=T(e,t[n])}return e},s.set=function(t,e){return Qe(this),this.i=null,Ye(this,t=tn(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},s.get=function(t,e){return t&&0<(t=this.R(t)).length?String(t[0]):e},s.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var i=e[n],r=encodeURIComponent(String(i));i=this.R(i);for(var s=0;s<i.length;s++){var o=r;""!==i[s]&&(o+="="+encodeURIComponent(String(i[s]))),t.push(o)}}return this.i=t.join("&")};var en=function(t,e){this.h=t,this.g=e};function nn(t){this.l=t||rn,t=c.PerformanceNavigationTiming?0<(t=c.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(c.g&&c.g.Ea&&c.g.Ea()&&c.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var rn=10;function sn(t){return!!t.h||!!t.g&&t.g.size>=t.j}function on(t){return t.h?1:t.g?t.g.size:0}function an(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function cn(t,e){t.g?t.g.add(e):t.h=e}function un(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function ln(t){var e,n;if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){var i=t.i;try{for(var s=r(t.g.values()),o=s.next();!o.done;o=s.next()){var a=o.value;i=i.concat(a.D)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return i}return E(t.i)}function hn(){}function dn(){this.g=new hn}function fn(t,e,n){var i=n||"";try{Re(t,(function(t,n){var r=t;h(t)&&(r=St(t)),e.push(i+n+"="+encodeURIComponent(r))}))}catch(t){throw e.push(i+"type="+encodeURIComponent("_badmap")),t}}function pn(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(t){}}function gn(t){this.l=t.$b||null,this.j=t.ib||!1}function mn(t,e){It.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=yn,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}nn.prototype.cancel=function(){var t,e;if(this.i=ln(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){try{for(var n=r(this.g.values()),i=n.next();!i.done;i=n.next())i.value.cancel()}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.g.clear()}},hn.prototype.stringify=function(t){return c.JSON.stringify(t,void 0)},hn.prototype.parse=function(t){return c.JSON.parse(t,void 0)},v(gn,re),gn.prototype.g=function(){return new mn(this.l,this.j)},gn.prototype.i=function(t){return function(){return t}}({}),v(mn,It);var yn=0;function vn(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}function wn(t){t.readyState=4,t.l=null,t.j=null,t.A=null,bn(t)}function bn(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(s=mn.prototype).open=function(t,e){if(this.readyState!=yn)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,bn(this)},s.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||c).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},s.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,wn(this)),this.readyState=yn},s.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,bn(this)),this.g&&(this.readyState=3,bn(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==c.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;vn(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))},s.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?wn(this):bn(this),3==this.readyState&&vn(this)}},s.Ua=function(t){this.g&&(this.response=this.responseText=t,wn(this))},s.Ta=function(t){this.g&&(this.response=t,wn(this))},s.ha=function(){this.g&&wn(this)},s.setRequestHeader=function(t,e){this.v.append(t,e)},s.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";for(var t=[],e=this.h.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(mn.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var _n=c.JSON.parse;function In(t){It.call(this),this.headers=new Ne,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Tn,this.K=this.L=!1}v(In,It);var Tn="",En=/^https?$/i,Sn=["POST","PUT"];function An(t){return"content-type"==t.toLowerCase()}function kn(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Rn(t),Cn(t)}function Rn(t){t.D||(t.D=!0,Tt(t,"complete"),Tt(t,"error"))}function Nn(t){if(t.h&&void 0!==a&&(!t.C[1]||4!=Dn(t)||2!=t.ba()))if(t.v&&4==Dn(t))Ft(t.Fa,0,t);else if(Tt(t,"readystatechange"),4==Dn(t)){t.h=!1;try{var e,n=t.ba();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var i=!0;break t;default:i=!1}if(!(e=i)){var r;if(r=0===n){var s=String(t.H).match(De)[1]||null;if(!s&&c.self&&c.self.location){var o=c.self.location.protocol;s=o.substr(0,o.length-1)}r=!En.test(s?s.toLowerCase():"")}e=r}if(e)Tt(t,"complete"),Tt(t,"success");else{t.m=6;try{var u=2<Dn(t)?t.g.statusText:""}catch(t){u=""}t.j=u+" ["+t.ba()+"]",Rn(t)}}finally{Cn(t)}}}function Cn(t,e){if(t.g){On(t);var n=t.g,i=t.C[0]?u:null;t.g=null,t.C=null,e||Tt(t,"ready");try{n.onreadystatechange=i}catch(t){}}}function On(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(c.clearTimeout(t.A),t.A=null)}function Dn(t){return t.g?t.g.readyState:0}function Pn(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case Tn:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Ln(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}i||(n=function(t){var e="";return D(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Ve(t,e,n))}function xn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Mn(t){this.za=0,this.l=[],this.h=new zt,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=xn("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=xn("baseRetryDelayMs",5e3,t),this.$a=xn("retryDelaySeedMs",1e4,t),this.Ya=xn("forwardChannelMaxRetries",2,t),this.ra=xn("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new nn(t&&t.concurrentRequestLimit),this.Ca=new dn,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||!1!==t.Xb}function Un(t){if(Vn(t),3==t.G){var e=t.V++,n=Le(t.F);Ve(n,"SID",t.J),Ve(n,"RID",e),Ve(n,"TYPE","terminate"),Kn(t,n),(e=new de(t,t.h,e,void 0)).K=2,e.v=je(Le(n)),n=!1,c.navigator&&c.navigator.sendBeacon&&(n=c.navigator.sendBeacon(e.v.toString(),"")),!n&&c.Image&&((new Image).src=e.v,n=!0),n||(e.g=ei(e.l,null),e.g.ea(e.v)),e.F=Date.now(),Ie(e)}Zn(t)}function Fn(t){t.g&&(Gn(t),t.g.cancel(),t.g=null)}function Vn(t){Fn(t),t.u&&(c.clearTimeout(t.u),t.u=null),Xn(t),t.i.cancel(),t.m&&("number"==typeof t.m&&c.clearTimeout(t.m),t.m=null)}function jn(t,e){t.l.push(new en(t.Za++,e)),3==t.G&&Bn(t)}function Bn(t){sn(t.i)||t.m||(t.m=!0,Dt(t.Ha,t),t.C=0)}function Hn(t,e){var n;n=e?e.m:t.V++;var i=Le(t.F);Ve(i,"SID",t.J),Ve(i,"RID",n),Ve(i,"AID",t.U),Kn(t,i),t.o&&t.s&&Ln(i,t.o,t.s),n=new de(t,t.h,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=qn(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),cn(t.i,n),ye(n,i,e)}function Kn(t,e){t.j&&Re({},(function(t,n){Ve(e,n,t)}))}function qn(t,e,n){n=Math.min(t.l.length,n);var i=t.j?m(t.j.Oa,t.j,t):null;t:for(var r=t.l,s=-1;;){var o=["count="+n];-1==s?0<n?(s=r[0].h,o.push("ofs="+s)):s=0:o.push("ofs="+s);for(var a=!0,c=0;c<n;c++){var u=r[c].h,l=r[c].g;if(0>(u-=s))s=Math.max(0,r[c].h-100),a=!1;else try{fn(l,o,"req"+u+"_")}catch(t){i&&i(l)}}if(a){i=o.join("&");break t}}return t=t.l.splice(0,n),e.D=t,i}function zn(t){t.g||t.u||(t.Y=1,Dt(t.Ga,t),t.A=0)}function $n(t){return!(t.g||t.u||3<=t.A||(t.Y++,t.u=ee(m(t.Ga,t),Jn(t,t.A)),t.A++,0))}function Gn(t){null!=t.B&&(c.clearTimeout(t.B),t.B=null)}function Wn(t){t.g=new de(t,t.h,"rpc",t.Y),null===t.o&&(t.g.H=t.s),t.g.O=0;var e=Le(t.oa);Ve(e,"RID","rpc"),Ve(e,"SID",t.J),Ve(e,"CI",t.N?"0":"1"),Ve(e,"AID",t.U),Kn(t,e),Ve(e,"TYPE","xmlhttp"),t.o&&t.s&&Ln(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=je(Le(e)),n.s=null,n.U=!0,ve(n,t)}function Xn(t){null!=t.v&&(c.clearTimeout(t.v),t.v=null)}function Qn(t,e){var n=null;if(t.g==e){Xn(t),Gn(t),t.g=null;var i=2}else{if(!an(t.i,e))return;n=e.D,un(t.i,e),i=1}if(t.I=e.N,0!=t.G)if(e.i)if(1==i){n=e.s?e.s.length:0,e=Date.now()-e.F;var r=t.C;Tt(i=Xt(),new te(i,n,e,r)),Bn(t)}else zn(t);else if(3==(r=e.o)||0==r&&0<t.I||!(1==i&&function(t,e){return!(on(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.l=e.D.concat(t.l),0):1==t.G||2==t.G||t.C>=(t.Xa?0:t.Ya)||(t.m=ee(m(t.Ha,t,e),Jn(t,t.C)),t.C++,0)))}(t,e)||2==i&&$n(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),r){case 1:Yn(t,5);break;case 4:Yn(t,10);break;case 3:Yn(t,6);break;default:Yn(t,2)}}function Jn(t,e){var n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function Yn(t,e){if(t.h.info("Error code "+e),2==e){var n=null;t.j&&(n=null);var i=m(t.jb,t);n||(n=new Pe("//www.google.com/images/cleardot.gif"),c.location&&"http"==c.location.protocol||xe(n,"https"),je(n)),function(t,e){var n=new zt;if(c.Image){var i=new Image;i.onload=y(pn,n,i,"TestLoadImage: loaded",!0,e),i.onerror=y(pn,n,i,"TestLoadImage: error",!1,e),i.onabort=y(pn,n,i,"TestLoadImage: abort",!1,e),i.ontimeout=y(pn,n,i,"TestLoadImage: timeout",!1,e),c.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=t}else e(!1)}(n.toString(),i)}else Zt(2);t.G=0,t.j&&t.j.va(e),Zn(t),Vn(t)}function Zn(t){t.G=0,t.I=-1,t.j&&(0==ln(t.i).length&&0==t.l.length||(t.i.i.length=0,E(t.l),t.l.length=0),t.j.ua())}function ti(t,e,n){var i=function(t){return t instanceof Pe?Le(t):new Pe(t,void 0)}(n);if(""!=i.i)e&&Me(i,e+"."+i.i),Ue(i,i.m);else{var r=c.location;i=function(t,e,n,i){var r=new Pe(null,void 0);return t&&xe(r,t),e&&Me(r,e),n&&Ue(r,n),i&&(r.l=i),r}(r.protocol,e?e+"."+r.hostname:r.hostname,+r.port,n)}return t.aa&&D(t.aa,(function(t,e){Ve(i,e,t)})),e=t.D,n=t.sa,e&&n&&Ve(i,e,n),Ve(i,"VER",t.ma),Kn(t,i),i}function ei(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Ba&&!t.qa?new In(new gn({ib:!0})):new In(t.qa)).L=t.H,e}function ni(){}function ii(){if(j&&!(10<=Number(Y)))throw Error("Environmental error: no available transport.")}function ri(t,e){It.call(this),this.g=new Mn(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!S(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!S(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new ai(this)}function si(t){ue.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function oi(){le.call(this),this.status=1}function ai(t){this.g=t}(s=In.prototype).ea=function(t,e,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():ae.g(),this.C=this.u?se(this.u):se(ae),this.g.onreadystatechange=m(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(t){return void kn(this,t)}t=n||"";var r=new Ne(this.headers);i&&Re(i,(function(t,e){r.set(e,t)})),i=function(t){t:{for(var e=An,n=t.length,i="string"==typeof t?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t)){e=r;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(r.T()),n=c.FormData&&t instanceof c.FormData,!(0<=_(Sn,e))||i||n||r.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),r.forEach((function(t,e){this.g.setRequestHeader(e,t)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{On(this),0<this.B&&((this.K=function(t){return j&&J()&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=m(this.pa,this)):this.A=Ft(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){kn(this,t)}},s.pa=function(){void 0!==a&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Tt(this,"timeout"),this.abort(8))},s.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Tt(this,"complete"),Tt(this,"abort"),Cn(this))},s.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Cn(this,!0)),In.Z.M.call(this)},s.Fa=function(){this.s||(this.F||this.v||this.l?Nn(this):this.cb())},s.cb=function(){Nn(this)},s.ba=function(){try{return 2<Dn(this)?this.g.status:-1}catch(t){return-1}},s.ga=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},s.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),_n(e)}},s.Da=function(){return this.m},s.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(s=Mn.prototype).ma=8,s.G=1,s.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch(t){}},s.Ha=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;var e=new de(this,this.h,t,void 0),n=this.s;if(this.P&&(n?x(n=P(n),this.P):n=this.P),null===this.o&&(e.H=n),this.ja)t:{for(var i=0,r=0;r<this.l.length;r++){var s=this.l[r];if(void 0===(s="__data__"in s.g&&"string"==typeof(s=s.g.__data__)?s.length:void 0))break;if(4096<(i+=s)){i=r;break t}if(4096===i||r===this.l.length-1){i=r+1;break t}}i=1e3}else i=1e3;i=qn(this,e,i),Ve(r=Le(this.F),"RID",t),Ve(r,"CVER",22),this.D&&Ve(r,"X-HTTP-Session-Id",this.D),Kn(this,r),this.o&&n&&Ln(r,this.o,n),cn(this.i,e),this.Ra&&Ve(r,"TYPE","init"),this.ja?(Ve(r,"$req",i),Ve(r,"SID","null"),e.$=!0,ye(e,r,null)):ye(e,r,i),this.G=2}}else 3==this.G&&(t?Hn(this,t):0==this.l.length||sn(this.i)||Hn(this))},s.Ga=function(){if(this.u=null,Wn(this),this.$&&!(this.L||null==this.g||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=ee(m(this.bb,this),t)}},s.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,Zt(10),Fn(this),Wn(this))},s.ab=function(){null!=this.v&&(this.v=null,Fn(this),$n(this),Zt(19))},s.jb=function(t){t?(this.h.info("Successfully pinged google.com"),Zt(2)):(this.h.info("Failed to ping google.com"),Zt(1))},(s=ni.prototype).xa=function(){},s.wa=function(){},s.va=function(){},s.ua=function(){},s.Oa=function(){},ii.prototype.g=function(t,e){return new ri(t,e)},v(ri,It),ri.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),Dt(m(t.hb,t,e))),Zt(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=ti(t,null,t.W),Bn(t)},ri.prototype.close=function(){Un(this.g)},ri.prototype.u=function(t){if("string"==typeof t){var e={};e.__data__=t,jn(this.g,e)}else this.v?((e={}).__data__=St(t),jn(this.g,e)):jn(this.g,t)},ri.prototype.M=function(){this.g.j=null,delete this.j,Un(this.g),delete this.g,ri.Z.M.call(this)},v(si,ue),v(oi,le),v(ai,ni),ai.prototype.xa=function(){Tt(this.g,"a")},ai.prototype.wa=function(t){Tt(this.g,new si(t))},ai.prototype.va=function(t){Tt(this.g,new oi(t))},ai.prototype.ua=function(){Tt(this.g,"b")},ii.prototype.createWebChannel=ii.prototype.g,ri.prototype.send=ri.prototype.u,ri.prototype.open=ri.prototype.m,ri.prototype.close=ri.prototype.close,ne.NO_ERROR=0,ne.TIMEOUT=8,ne.HTTP_ERROR=6,ie.COMPLETE="complete",oe.EventType=ce,ce.OPEN="a",ce.CLOSE="b",ce.ERROR="c",ce.MESSAGE="d",It.prototype.listen=It.prototype.N,In.prototype.listenOnce=In.prototype.O,In.prototype.getLastError=In.prototype.La,In.prototype.getLastErrorCode=In.prototype.Da,In.prototype.getStatus=In.prototype.ba,In.prototype.getResponseJson=In.prototype.Qa,In.prototype.getResponseText=In.prototype.ga,In.prototype.send=In.prototype.ea;var ci=function(){return new ii},ui=function(){return Xt()},li=ne,hi=ie,di=Gt,fi={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},pi=gn,gi=oe,mi=In},134:(t,e,n)=>{n.d(e,{h1:()=>c,uA:()=>s});var i=n(635),r=n(625),s=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},t}(),o="[DEFAULT]",a=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return t.prototype.get=function(t){var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new r.cY;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{var i=this.getOrInitializeService({instanceIdentifier:e});i&&n.resolve(i)}catch(t){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e,n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),i=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(i)return null;throw t}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:o})}catch(t){}try{for(var r=(0,i.Ju)(this.instancesDeferred.entries()),s=r.next();!s.done;s=r.next()){var a=(0,i.zs)(s.value,2),c=a[0],u=a[1],l=this.normalizeInstanceIdentifier(c);try{var h=this.getOrInitializeService({instanceIdentifier:l});u.resolve(h)}catch(t){}}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}},t.prototype.clearInstance=function(t){void 0===t&&(t=o),this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return(0,i.sH)(this,void 0,void 0,(function(){var t;return(0,i.YH)(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all((0,i.fX)((0,i.fX)([],(0,i.zs)(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))),(0,i.zs)(t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()})))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.isInitialized=function(t){return void 0===t&&(t=o),this.instances.has(t)},t.prototype.getOptions=function(t){return void 0===t&&(t=o),this.instancesOptions.get(t)||{}},t.prototype.initialize=function(t){var e,n;void 0===t&&(t={});var r=t.options,s=void 0===r?{}:r,o=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(o))throw Error(this.name+"("+o+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var a=this.getOrInitializeService({instanceIdentifier:o,options:s});try{for(var c=(0,i.Ju)(this.instancesDeferred.entries()),u=c.next();!u.done;u=c.next()){var l=(0,i.zs)(u.value,2),h=l[0],d=l[1];o===this.normalizeInstanceIdentifier(h)&&d.resolve(a)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(e)throw e.error}}return a},t.prototype.onInit=function(t,e){var n,i=this.normalizeInstanceIdentifier(e),r=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;r.add(t),this.onInitCallbacks.set(i,r);var s=this.instances.get(i);return s&&t(s,i),function(){r.delete(t)}},t.prototype.invokeOnInitCallbacks=function(t,e){var n,r,s=this.onInitCallbacks.get(e);if(s)try{for(var o=(0,i.Ju)(s),a=o.next();!a.done;a=o.next()){var c=a.value;try{c(t,e)}catch(t){}}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},t.prototype.getOrInitializeService=function(t){var e,n=t.instanceIdentifier,i=t.options,r=void 0===i?{}:i,s=this.instances.get(n);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:(e=n,e===o?void 0:e),options:r}),this.instances.set(n,s),this.instancesOptions.set(n,r),this.invokeOnInitCallbacks(s,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,s)}catch(t){}return s||null},t.prototype.normalizeInstanceIdentifier=function(t){return void 0===t&&(t=o),this.component?this.component.multipleInstances?t:o:t},t.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},t}(),c=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new a(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}()},137:(t,e,n)=>{n.d(e,{n:()=>Ae});var i=n(625),r=n(468),s=n(635),o=n(477),a=n(134);const c=new i.FA("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),u=new o.Vy("@firebase/auth");function l(t,...e){u.logLevel<=o.$b.ERROR&&u.error(`Auth (${r.MF}): ${t}`,...e)}function h(t,...e){throw f(t,...e)}function d(t,...e){return f(t,...e)}function f(t,...e){if("string"!=typeof t){const n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(n,...i)}return c.create(t,...e)}function p(t,e,...n){if(!t)throw f(e,...n)}function g(t){const e="INTERNAL ASSERTION FAILED: "+t;throw l(e),new Error(e)}function m(t,e){t||g(e)}const y=new Map;function v(t){m(t instanceof Function,"Expected a class definition");let e=y.get(t);return e?(m(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,y.set(t,e),e)}function w(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.href)||""}function b(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.protocol)||null}class _{constructor(t,e){this.shortDelay=t,this.longDelay=e,m(e>t,"Short delay should be less than long delay!"),this.isMobile=(0,i.jZ)()||(0,i.lV)()}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===b()||"https:"===b()||(0,i.sr)()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function I(t,e){m(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class T{static initialize(t,e,n){this.fetchImpl=t,e&&(this.headersImpl=e),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void g("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void g("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void g("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const E={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded"},S=new _(3e4,6e4);function A(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function k(t,e,n,r,s={}){return R(t,s,(()=>{let s={},o={};r&&("GET"===e?o=r:s={body:JSON.stringify(r)});const a=(0,i.Am)(Object.assign({key:t.config.apiKey},o)).slice(1),c=new(T.headers());return c.set("Content-Type","application/json"),c.set("X-Client-Version",t._getSdkClientVersion()),t.languageCode&&c.set("X-Firebase-Locale",t.languageCode),T.fetch()(C(t,t.config.apiHost,n,a),Object.assign({method:e,headers:c,referrerPolicy:"no-referrer"},s))}))}async function R(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},E),e);try{const e=new O(t),i=await Promise.race([n(),e.promise]);e.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw D(t,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const e=(i.ok?s.errorMessage:s.error.message).split(" : ")[0];if("FEDERATED_USER_ID_ALREADY_LINKED"===e)throw D(t,"credential-already-in-use",s);if("EMAIL_EXISTS"===e)throw D(t,"email-already-in-use",s);h(t,r[e]||e.toLowerCase().replace(/[_\s]+/g,"-"))}}catch(e){if(e instanceof i.g)throw e;h(t,"network-request-failed")}}async function N(t,e,n,i,r={}){const s=await k(t,e,n,i,r);return"mfaPendingCredential"in s&&h(t,"multi-factor-auth-required",{serverResponse:s}),s}function C(t,e,n,i){const r=`${e}${n}?${i}`;return t.config.emulator?I(t.config,r):`${t.config.apiScheme}://${r}`}class O{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise(((t,e)=>{this.timer=setTimeout((()=>e(d(this.auth,"timeout"))),S.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function D(t,e,n){const i={appName:t.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=d(t,e,i);return r.customData._tokenResponse=n,r}function P(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch(t){}}function L(t){return 1e3*Number(t)}function x(t){const[e,n,r]=t.split(".");if(void 0===e||void 0===n||void 0===r)return l("JWT malformed, contained fewer than 3 sections"),null;try{const t=(0,i.u)(n);return t?JSON.parse(t):(l("Failed to decode base64 JWT payload"),null)}catch(t){return l("Caught error parsing JWT payload as JSON",t),null}}async function M(t,e,n=!1){if(n)return e;try{return await e}catch(e){throw e instanceof i.g&&function({code:t}){return"auth/user-disabled"===t||"auth/user-token-expired"===t}(e)&&t.auth.currentUser===t&&await t.auth.signOut(),e}}class U{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(t){var e;if(t){const t=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),t}{this.errorBackoff=3e4;const t=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,t)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout((async()=>{await this.iteration()}),e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){return void("auth/network-request-failed"===t.code&&this.schedule(!0))}this.schedule()}}class F{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=P(this.lastLoginAt),this.creationTime=P(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function V(t){var e;const n=t.auth,i=await t.getIdToken(),r=await M(t,async function(t,e){return k(t,"POST","/v1/accounts:lookup",e)}(n,{idToken:i}));p(null==r?void 0:r.users.length,n,"internal-error");const o=r.users[0];t._notifyReloadListener(o);const a=(null===(e=o.providerUserInfo)||void 0===e?void 0:e.length)?o.providerUserInfo.map((t=>{var{providerId:e}=t,n=(0,s.Tt)(t,["providerId"]);return{providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[],c=(u=t.providerData,l=a,[...u.filter((t=>!l.some((e=>e.providerId===t.providerId)))),...l]);var u,l;const h=t.isAnonymous,d=!(t.email&&o.passwordHash||(null==c?void 0:c.length)),f=!!h&&d,g={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:c,metadata:new F(o.createdAt,o.lastLoginAt),isAnonymous:f};Object.assign(t,g)}class j{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){p(t.idToken,"internal-error"),p(void 0!==t.idToken,"internal-error"),p(void 0!==t.refreshToken,"internal-error");const e="expiresIn"in t&&void 0!==t.expiresIn?Number(t.expiresIn):function(t){const e=x(t);return p(e,"internal-error"),p(void 0!==e.exp,"internal-error"),p(void 0!==e.iat,"internal-error"),Number(e.exp)-Number(e.iat)}(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}async getToken(t,e=!1){return p(!this.accessToken||this.refreshToken,t,"user-token-expired"),e||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:n,refreshToken:r,expiresIn:s}=await async function(t,e){const n=await R(t,{},(()=>{const n=(0,i.Am)({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=t.config,o=C(t,r,"/v1/token",`key=${s}`);return T.fetch()(o,{method:"POST",headers:{"X-Client-Version":t._getSdkClientVersion(),"Content-Type":"application/x-www-form-urlencoded"},body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(t,e);this.updateTokensAndExpiration(n,r,Number(s))}updateTokensAndExpiration(t,e,n){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(t,e){const{refreshToken:n,accessToken:i,expirationTime:r}=e,s=new j;return n&&(p("string"==typeof n,"internal-error",{appName:t}),s.refreshToken=n),i&&(p("string"==typeof i,"internal-error",{appName:t}),s.accessToken=i),r&&(p("number"==typeof r,"internal-error",{appName:t}),s.expirationTime=r),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new j,this.toJSON())}_performRefresh(){return g("not implemented")}}function B(t,e){p("string"==typeof t||void 0===t,"internal-error",{appName:e})}class H{constructor(t){var{uid:e,auth:n,stsTokenManager:i}=t,r=(0,s.Tt)(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.emailVerified=!1,this.isAnonymous=!1,this.tenantId=null,this.providerData=[],this.proactiveRefresh=new U(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.metadata=new F(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(t){const e=await M(this,this.stsTokenManager.getToken(this.auth,t));return p(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return async function(t,e=!1){const n=(0,i.Ku)(t),r=await n.getIdToken(e),s=x(r);p(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const o="object"==typeof s.firebase?s.firebase:void 0,a=null==o?void 0:o.sign_in_provider;return{claims:s,token:r,authTime:P(L(s.auth_time)),issuedAtTime:P(L(s.iat)),expirationTime:P(L(s.exp)),signInProvider:a||null,signInSecondFactor:(null==o?void 0:o.sign_in_second_factor)||null}}(this,t)}reload(){return async function(t){const e=(0,i.Ku)(t);await V(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}(this)}_assign(t){this!==t&&(p(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map((t=>Object.assign({},t))),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){return new H(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(t){p(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),e&&await V(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const t=await this.getIdToken();return await M(this,async function(t,e){return k(t,"POST","/v1/accounts:delete",e)}(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((t=>Object.assign({},t))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var n,i,r,s,o,a,c,u;const l=null!==(n=e.displayName)&&void 0!==n?n:void 0,h=null!==(i=e.email)&&void 0!==i?i:void 0,d=null!==(r=e.phoneNumber)&&void 0!==r?r:void 0,f=null!==(s=e.photoURL)&&void 0!==s?s:void 0,g=null!==(o=e.tenantId)&&void 0!==o?o:void 0,m=null!==(a=e._redirectEventId)&&void 0!==a?a:void 0,y=null!==(c=e.createdAt)&&void 0!==c?c:void 0,v=null!==(u=e.lastLoginAt)&&void 0!==u?u:void 0,{uid:w,emailVerified:b,isAnonymous:_,providerData:I,stsTokenManager:T}=e;p(w&&T,t,"internal-error");const E=j.fromJSON(this.name,T);p("string"==typeof w,t,"internal-error"),B(l,t.name),B(h,t.name),p("boolean"==typeof b,t,"internal-error"),p("boolean"==typeof _,t,"internal-error"),B(d,t.name),B(f,t.name),B(g,t.name),B(m,t.name),B(y,t.name),B(v,t.name);const S=new H({uid:w,auth:t,email:h,emailVerified:b,displayName:l,isAnonymous:_,photoURL:f,phoneNumber:d,tenantId:g,stsTokenManager:E,createdAt:y,lastLoginAt:v});return I&&Array.isArray(I)&&(S.providerData=I.map((t=>Object.assign({},t)))),m&&(S._redirectEventId=m),S}static async _fromIdTokenResponse(t,e,n=!1){const i=new j;i.updateFromServerResponse(e);const r=new H({uid:e.localId,auth:t,stsTokenManager:i,isAnonymous:n});return await V(r),r}}class K{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return void 0===e?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}K.type="NONE";const q=K;function z(t,e,n){return`firebase:${t}:${e}:${n}`}class ${constructor(t,e,n){this.persistence=t,this.auth=e,this.userKey=n;const{config:i,name:r}=this.auth;this.fullUserKey=z(this.userKey,i.apiKey,r),this.fullPersistenceKey=z("persistence",i.apiKey,r),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);return t?H._fromJSON(this.auth,t):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=t,e?this.setCurrentUser(e):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,n="authUser"){if(!e.length)return new $(v(q),t,n);const i=(await Promise.all(e.map((async t=>{if(await t._isAvailable())return t})))).filter((t=>t));let r=i[0]||v(q);const s=z(n,t.config.apiKey,t.name);let o=null;for(const n of e)try{const e=await n._get(s);if(e){const i=H._fromJSON(t,e);n!==r&&(o=i),r=n;break}}catch(t){}const a=i.filter((t=>t._shouldAllowMigration));return r._shouldAllowMigration&&a.length?(r=a[0],o&&await r._set(s,o.toJSON()),await Promise.all(e.map((async t=>{if(t!==r)try{await t._remove(s)}catch(t){}}))),new $(r,t,n)):new $(r,t,n)}}function G(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(J(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(W(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Z(e))return"Blackberry";if(tt(e))return"Webos";if(X(e))return"Safari";if((e.includes("chrome/")||Q(e))&&!e.includes("edge/"))return"Chrome";if(Y(e))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(e);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function W(t=(0,i.ZQ)()){return/firefox\//i.test(t)}function X(t=(0,i.ZQ)()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Q(t=(0,i.ZQ)()){return/crios\//i.test(t)}function J(t=(0,i.ZQ)()){return/iemobile/i.test(t)}function Y(t=(0,i.ZQ)()){return/android/i.test(t)}function Z(t=(0,i.ZQ)()){return/blackberry/i.test(t)}function tt(t=(0,i.ZQ)()){return/webos/i.test(t)}function et(t=(0,i.ZQ)()){return/iphone|ipad|ipod/i.test(t)}function nt(t=(0,i.ZQ)()){return et(t)||Y(t)||tt(t)||Z(t)||/windows phone/i.test(t)||J(t)}function it(t,e=[]){let n;switch(t){case"Browser":n=G((0,i.ZQ)());break;case"Worker":n=`${G((0,i.ZQ)())}-${t}`;break;default:n=t}const s=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${r.MF}/${s}`}class rt{constructor(t,e){this.app=t,this.config=e,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ot(this),this.idTokenSubscription=new ot(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=c,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=e.sdkClientVersion}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=v(e)),this._initializationPromise=this.queue((async()=>{var n;this._deleted||(this.persistenceManager=await $.create(this,t),this._deleted||((null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)&&await this._popupRedirectResolver._initialize(this),await this.initializeCurrentUser(e),this._deleted||(this._isInitialized=!0)))})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();return this.currentUser||t?this.currentUser&&t&&this.currentUser.uid===t.uid?(this._currentUser._assign(t),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(t):void 0}async initializeCurrentUser(t){var e;let n=await this.assertedPersistence.getCurrentUser();if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=null===(e=this.redirectUser)||void 0===e?void 0:e._redirectEventId,r=null==n?void 0:n._redirectEventId,s=await this.tryRedirectSignIn(t);i&&i!==r||!(null==s?void 0:s.user)||(n=s.user)}return n?n._redirectEventId?(p(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)):this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch(t){await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await V(t)}catch(t){if("auth/network-request-failed"!==t.code)return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(t){const e=t?(0,i.Ku)(t):null;return e&&p(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t){if(!this._deleted)return t&&p(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),this.queue((async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()}))}async signOut(){return(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null)}setPersistence(t){return this.queue((async()=>{await this.assertedPersistence.setPersistence(v(t))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new i.FA("auth","Firebase",t())}onAuthStateChanged(t,e,n){return this.registerStateListener(this.authStateSubscription,t,e,n)}onIdTokenChanged(t,e,n){return this.registerStateListener(this.idTokenSubscription,t,e,n)}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}}async _setRedirectUser(t,e){const n=await this.getOrInitRedirectPersistenceManager(e);return null===t?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&v(t)||this._popupRedirectResolver;p(e,this,"argument-error"),this.redirectPersistenceManager=await $.create(this,[v(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var e,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(e=this._currentUser)||void 0===e?void 0:e._redirectEventId)===t?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(t)))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,n,i){if(this._deleted)return()=>{};const r="function"==typeof e?e:e.next.bind(e),s=this._isInitialized?Promise.resolve():this._initializationPromise;return p(s,this,"internal-error"),s.then((()=>r(this.currentUser))),"function"==typeof e?t.addObserver(e,n,i):t.addObserver(e)}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&(this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh()),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return p(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){t&&!this.frameworks.includes(t)&&(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=it(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getSdkClientVersion(){return this.clientVersion}}function st(t){return(0,i.Ku)(t)}class ot{constructor(t){this.auth=t,this.observer=null,this.addObserver=(0,i.tD)((t=>this.observer=t))}get next(){return p(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}class at{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return g("not implemented")}_getIdTokenResponse(t){return g("not implemented")}_linkToIdToken(t,e){return g("not implemented")}_getReauthenticationResolver(t){return g("not implemented")}}class ct extends at{constructor(t,e,n,i=null){super("password",n),this._email=t,this._password=e,this._tenantId=i}static _fromEmailAndPassword(t,e){return new ct(t,e,"password")}static _fromEmailAndCode(t,e,n=null){return new ct(t,e,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t;if((null==e?void 0:e.email)&&(null==e?void 0:e.password)){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":return async function(t,e){return N(t,"POST","/v1/accounts:signInWithPassword",A(t,e))}(t,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(t,e){return N(t,"POST","/v1/accounts:signInWithEmailLink",A(t,e))}(t,{email:this._email,oobCode:this._password});default:h(t,"internal-error")}}async _linkToIdToken(t,e){switch(this.signInMethod){case"password":return async function(t,e){return k(t,"POST","/v1/accounts:update",e)}(t,{idToken:e,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(t,e){return N(t,"POST","/v1/accounts:signInWithEmailLink",A(t,e))}(t,{idToken:e,email:this._email,oobCode:this._password});default:h(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}async function ut(t,e){return N(t,"POST","/v1/accounts:signInWithIdp",A(t,e))}class lt extends at{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new lt(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):h("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t,{providerId:n,signInMethod:i}=e,r=(0,s.Tt)(e,["providerId","signInMethod"]);if(!n||!i)return null;const o=new lt(n,i);return Object.assign(o,r),o}_getIdTokenResponse(t){return ut(t,this.buildRequest())}_linkToIdToken(t,e){const n=this.buildRequest();return n.idToken=e,ut(t,n)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,ut(t,e)}buildRequest(){const t={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=(0,i.Am)(e)}return t}}const ht={USER_NOT_FOUND:"user-not-found"};class dt extends at{constructor(t){super("phone","phone"),this.params=t}static _fromVerification(t,e){return new dt({verificationId:t,verificationCode:e})}static _fromTokenResponse(t,e){return new dt({phoneNumber:t,temporaryProof:e})}_getIdTokenResponse(t){return async function(t,e){return N(t,"POST","/v1/accounts:signInWithPhoneNumber",A(t,e))}(t,this._makeVerificationRequest())}_linkToIdToken(t,e){return async function(t,e){const n=await N(t,"POST","/v1/accounts:signInWithPhoneNumber",A(t,e));if(n.temporaryProof)throw D(t,"account-exists-with-different-credential",n);return n}(t,Object.assign({idToken:e},this._makeVerificationRequest()))}_getReauthenticationResolver(t){return async function(t,e){return N(t,"POST","/v1/accounts:signInWithPhoneNumber",A(t,Object.assign(Object.assign({},e),{operation:"REAUTH"})),ht)}(t,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:t,phoneNumber:e,verificationId:n,verificationCode:i}=this.params;return t&&e?{temporaryProof:t,phoneNumber:e}:{sessionInfo:n,code:i}}toJSON(){const t={providerId:this.providerId};return this.params.phoneNumber&&(t.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(t.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(t.verificationCode=this.params.verificationCode),this.params.verificationId&&(t.verificationId=this.params.verificationId),t}static fromJSON(t){"string"==typeof t&&(t=JSON.parse(t));const{verificationId:e,verificationCode:n,phoneNumber:i,temporaryProof:r}=t;return n||e||i||r?new dt({verificationId:e,verificationCode:n,phoneNumber:i,temporaryProof:r}):null}}class ft{constructor(t){var e,n,r,s,o,a;const c=(0,i.I9)((0,i.hp)(t)),u=null!==(e=c.apiKey)&&void 0!==e?e:null,l=null!==(n=c.oobCode)&&void 0!==n?n:null,h=function(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=c.mode)&&void 0!==r?r:null);p(u&&l&&h,"argument-error"),this.apiKey=u,this.operation=h,this.code=l,this.continueUrl=null!==(s=c.continueUrl)&&void 0!==s?s:null,this.languageCode=null!==(o=c.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(a=c.tenantId)&&void 0!==a?a:null}static parseLink(t){const e=function(t){const e=(0,i.I9)((0,i.hp)(t)).link,n=e?(0,i.I9)((0,i.hp)(e)).deep_link_id:null,r=(0,i.I9)((0,i.hp)(t)).deep_link_id;return(r?(0,i.I9)((0,i.hp)(r)).link:null)||r||n||e||t}(t);try{return new ft(e)}catch(t){return null}}}class pt{constructor(){this.providerId=pt.PROVIDER_ID}static credential(t,e){return ct._fromEmailAndPassword(t,e)}static credentialWithLink(t,e){const n=ft.parseLink(e);return p(n,"argument-error"),ct._fromEmailAndCode(t,n.code,n.tenantId)}}pt.PROVIDER_ID="password",pt.EMAIL_PASSWORD_SIGN_IN_METHOD="password",pt.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class gt{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class mt extends gt{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class yt extends mt{constructor(){super("facebook.com")}static credential(t){return lt._fromParams({providerId:yt.PROVIDER_ID,signInMethod:yt.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return yt.credentialFromTaggedObject(t)}static credentialFromError(t){return yt.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return yt.credential(t.oauthAccessToken)}catch(t){return null}}}yt.FACEBOOK_SIGN_IN_METHOD="facebook.com",yt.PROVIDER_ID="facebook.com";class vt extends mt{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return lt._fromParams({providerId:vt.PROVIDER_ID,signInMethod:vt.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return vt.credentialFromTaggedObject(t)}static credentialFromError(t){return vt.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:n}=t;if(!e&&!n)return null;try{return vt.credential(e,n)}catch(t){return null}}}vt.GOOGLE_SIGN_IN_METHOD="google.com",vt.PROVIDER_ID="google.com";class wt extends mt{constructor(){super("github.com")}static credential(t){return lt._fromParams({providerId:wt.PROVIDER_ID,signInMethod:wt.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return wt.credentialFromTaggedObject(t)}static credentialFromError(t){return wt.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return wt.credential(t.oauthAccessToken)}catch(t){return null}}}wt.GITHUB_SIGN_IN_METHOD="github.com",wt.PROVIDER_ID="github.com";class bt extends mt{constructor(){super("twitter.com")}static credential(t,e){return lt._fromParams({providerId:bt.PROVIDER_ID,signInMethod:bt.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return bt.credentialFromTaggedObject(t)}static credentialFromError(t){return bt.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:n}=t;if(!e||!n)return null;try{return bt.credential(e,n)}catch(t){return null}}}bt.TWITTER_SIGN_IN_METHOD="twitter.com",bt.PROVIDER_ID="twitter.com";class _t{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,n,i=!1){const r=await H._fromIdTokenResponse(t,n,i),s=It(n);return new _t({user:r,providerId:s,_tokenResponse:n,operationType:e})}static async _forOperation(t,e,n){await t._updateTokensIfNecessary(n,!0);const i=It(n);return new _t({user:t,providerId:i,_tokenResponse:n,operationType:e})}}function It(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class Tt extends i.g{constructor(t,e,n,i){var r;super(e.code,e.message),this.operationType=n,this.user=i,this.name="FirebaseError",Object.setPrototypeOf(this,Tt.prototype),this.appName=t.name,this.code=e.code,this.tenantId=null!==(r=t.tenantId)&&void 0!==r?r:void 0,this.serverResponse=e.customData.serverResponse}static _fromErrorAndOperation(t,e,n,i){return new Tt(t,e,n,i)}}function Et(t,e,n,i){return("reauthenticate"===e?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw Tt._fromErrorAndOperation(t,n,e,i);throw n}))}new WeakMap;const St="__sak";class At{constructor(t,e){this.storage=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(St,"1"),this.storage.removeItem(St),Promise.resolve(!0)):Promise.resolve(!1)}catch(t){return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}}class kt extends At{constructor(){super(window.localStorage,"LOCAL"),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const t=(0,i.ZQ)();return X(t)||et(t)}()&&function(){try{return!(!window||window===window.top)}catch(t){return!1}}(),this.fallbackToPolling=nt(),this._shouldAllowMigration=!0,this.boundEventHandler=this.onStorageEvent.bind(this)}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const n=this.storage.getItem(e),i=this.localCache[e];n!==i&&t(e,i,n)}}onStorageEvent(t,e=!1){if(!t.key)return void this.forAllChangedKeys(((t,e,n)=>{this.notifyListeners(t,n)}));const n=t.key;if(e?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(n);if(t.newValue!==i)null!==t.newValue?this.storage.setItem(n,t.newValue):this.storage.removeItem(n);else if(this.localCache[n]===t.newValue&&!e)return}const r=()=>{const t=this.storage.getItem(n);(e||this.localCache[n]!==t)&&this.notifyListeners(n,t)},s=this.storage.getItem(n);(0,i.lT)()&&10===document.documentMode&&s!==t.newValue&&t.newValue!==t.oldValue?setTimeout(r,10):r()}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e?JSON.parse(e):e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((t,e,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}kt.type="LOCAL";const Rt=kt;class Nt extends At{constructor(){super(window.sessionStorage,"SESSION")}_addListener(t,e){}_removeListener(t,e){}}Nt.type="SESSION";const Ct=Nt;class Ot{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find((e=>e.isListeningto(t)));if(e)return e;const n=new Ot(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:n,eventType:i,data:r}=e.data,s=this.handlersMap[i];if(!(null==s?void 0:s.size))return;e.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(s).map((async t=>t(e.origin,r))),a=await function(t){return Promise.all(t.map((async t=>{try{return{fulfilled:!0,value:await t}}catch(t){return{fulfilled:!1,reason:t}}})))}(o);e.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:a})}_subscribe(t,e){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),e&&0!==this.handlersMap[t].size||delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Dt(t="",e=10){let n="";for(let t=0;t<e;t++)n+=Math.floor(10*Math.random());return t+n}Ot.receivers=[];class Pt{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,n=50){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,s;return new Promise(((o,a)=>{const c=Dt("",20);i.port1.start();const u=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:i,onMessage(t){const e=t;if(e.data.eventId===c)switch(e.data.status){case"ack":clearTimeout(u),r=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(r),o(e.data.response);break;default:clearTimeout(u),clearTimeout(r),a(new Error("invalid_response"))}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:t,eventId:c,data:e},[i.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function Lt(){return window}function xt(){return void 0!==Lt().WorkerGlobalScope&&"function"==typeof Lt().importScripts}const Mt="firebaseLocalStorageDb",Ut="firebaseLocalStorage",Ft="fbase_key";class Vt{constructor(t){this.request=t}toPromise(){return new Promise(((t,e)=>{this.request.addEventListener("success",(()=>{t(this.request.result)})),this.request.addEventListener("error",(()=>{e(this.request.error)}))}))}}function jt(t,e){return t.transaction([Ut],e?"readwrite":"readonly").objectStore(Ut)}function Bt(){const t=indexedDB.open(Mt,1);return new Promise(((e,n)=>{t.addEventListener("error",(()=>{n(t.error)})),t.addEventListener("upgradeneeded",(()=>{const e=t.result;try{e.createObjectStore(Ut,{keyPath:Ft})}catch(t){n(t)}})),t.addEventListener("success",(async()=>{const n=t.result;n.objectStoreNames.contains(Ut)?e(n):(n.close(),await function(){const t=indexedDB.deleteDatabase(Mt);return new Vt(t).toPromise()}(),e(await Bt()))}))}))}async function Ht(t,e,n){const i=jt(t,!0).put({[Ft]:e,value:n});return new Vt(i).toPromise()}function Kt(t,e){const n=jt(t,!0).delete(e);return new Vt(n).toPromise()}class qt{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await Bt()),this.db}async _withRetries(t){let e=0;for(;;)try{const e=await this._openDb();return await t(e)}catch(t){if(e++>3)throw t;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return xt()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ot._getInstance(xt()?self:null),this.receiver._subscribe("keyChanged",(async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)}))),this.receiver._subscribe("ping",(async(t,e)=>["keyChanged"]))}async initializeSender(){var t,e;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(t){return null}}(),!this.activeServiceWorker)return;this.sender=new Pt(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(t=n[0])||void 0===t?void 0:t.fulfilled)&&(null===(e=n[0])||void 0===e?void 0:e.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){var e;if(this.sender&&this.activeServiceWorker&&((null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch(e){}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await Bt();return await Ht(t,St,"1"),await Kt(t,St),!0}catch(t){}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite((async()=>(await this._withRetries((n=>Ht(n,t,e))),this.localCache[t]=e,this.notifyServiceWorker(t))))}async _get(t){const e=await this._withRetries((e=>async function(t,e){const n=jt(t,!1).get(e),i=await new Vt(n).toPromise();return void 0===i?null:i.value}(e,t)));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite((async()=>(await this._withRetries((e=>Kt(e,t))),delete this.localCache[t],this.notifyServiceWorker(t))))}async _poll(){const t=await this._withRetries((t=>{const e=jt(t,!1).getAll();return new Vt(e).toPromise()}));if(!t)return[];if(0!==this.pendingWrites)return[];const e=[],n=new Set;for(const{fbase_key:i,value:r}of t)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),e.push(i));for(const t of Object.keys(this.localCache))this.localCache[t]&&!n.has(t)&&(this.notifyListeners(t,null),e.push(t));return e}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&this.stopPolling()}}qt.type="LOCAL";const zt=qt;function $t(t){return`__${t}${Math.floor(1e6*Math.random())}`}$t("rcb"),new _(3e4,6e4);class Gt{constructor(t){this.providerId=Gt.PROVIDER_ID,this.auth=st(t)}verifyPhoneNumber(t,e){return async function(t,e,n){var i;const r=await n.verify();try{let s;if(p("string"==typeof r,t,"argument-error"),p("recaptcha"===n.type,t,"argument-error"),s="string"==typeof e?{phoneNumber:e}:e,"session"in s){const e=s.session;if("phoneNumber"in s){p("enroll"===e.type,t,"internal-error");const n=await function(t,e){return k(t,"POST","/v2/accounts/mfaEnrollment:start",Object.assign({tenantId:t.tenantId},e))}(t,{idToken:e.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:r}});return n.phoneSessionInfo.sessionInfo}{p("signin"===e.type,t,"internal-error");const n=(null===(i=s.multiFactorHint)||void 0===i?void 0:i.uid)||s.multiFactorUid;p(n,t,"missing-multi-factor-info");const o=await function(t,e){return k(t,"POST","/v2/accounts/mfaSignIn:start",Object.assign({tenantId:t.tenantId},e))}(t,{mfaPendingCredential:e.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:r}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:e}=await async function(t,e){return k(t,"POST","/v1/accounts:sendVerificationCode",A(t,e))}(t,{phoneNumber:s.phoneNumber,recaptchaToken:r});return e}}finally{n._reset()}}(this.auth,t,(0,i.Ku)(e))}static credential(t,e){return dt._fromVerification(t,e)}static credentialFromResult(t){const e=t;return Gt.credentialFromTaggedObject(e)}static credentialFromError(t){return Gt.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{phoneNumber:e,temporaryProof:n}=t;return e&&n?dt._fromTokenResponse(e,n):null}}Gt.PROVIDER_ID="phone",Gt.PHONE_SIGN_IN_METHOD="phone";class Wt extends at{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return ut(t,this._buildIdpRequest())}_linkToIdToken(t,e){return ut(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return ut(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function Xt(t){return async function(t,e,n=!1){const i="signIn",r=await Et(t,i,e),s=await _t._fromIdTokenResponse(t,i,r);return n||await t._updateCurrentUser(s.user),s}(t.auth,new Wt(t),t.bypassAuthState)}function Qt(t){const{auth:e,user:n}=t;return p(n,e,"internal-error"),async function(t,e,n=!1){const{auth:i}=t,r="reauthenticate";try{const s=await M(t,Et(i,r,e,t),n);p(s.idToken,i,"internal-error");const o=x(s.idToken);p(o,i,"internal-error");const{sub:a}=o;return p(t.uid===a,i,"user-mismatch"),_t._forOperation(t,r,s)}catch(t){throw"auth/user-not-found"===(null==t?void 0:t.code)&&h(i,"user-mismatch"),t}}(n,new Wt(t),t.bypassAuthState)}async function Jt(t){const{auth:e,user:n}=t;return p(n,e,"internal-error"),async function(t,e,n=!1){const i=await M(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return _t._forOperation(t,"link",i)}(n,new Wt(t),t.bypassAuthState)}class Yt{constructor(t,e,n,i,r=!1){this.auth=t,this.resolver=n,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise((async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(t){this.reject(t)}}))}async onAuthEvent(t){const{urlResponse:e,sessionId:n,postBody:i,tenantId:r,error:s,type:o}=t;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:e,sessionId:n,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(t){this.reject(t)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return Xt;case"linkViaPopup":case"linkViaRedirect":return Jt;case"reauthViaPopup":case"reauthViaRedirect":return Qt;default:h(this.auth,"internal-error")}}resolve(t){m(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){m(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Zt=new _(2e3,1e4);class te extends Yt{constructor(t,e,n,i,r){super(t,e,i,r),this.provider=n,this.authWindow=null,this.pollId=null,te.currentPopupAction&&te.currentPopupAction.cancel(),te.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return p(t,this.auth,"internal-error"),t}async onExecution(){m(1===this.filter.length,"Popup operations only handle one event");const t=Dt();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch((t=>{this.reject(t)})),this.resolver._isIframeWebStorageSupported(this.auth,(t=>{t||this.reject(d(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null}cancel(){this.reject(d(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,te.currentPopupAction=null}pollUserCancellation(){const t=()=>{var e,n;(null===(n=null===(e=this.authWindow)||void 0===e?void 0:e.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(d(this.auth,"popup-closed-by-user"))}),2e3):this.pollId=window.setTimeout(t,Zt.get())};t()}}te.currentPopupAction=null;const ee=new Map;class ne extends Yt{constructor(t,e,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,n),this.eventId=null}async execute(){let t=ee.get(this.auth._key());if(!t){try{const e=await async function(t,e){const n=function(t){return z("pendingRedirect",t.config.apiKey,t.name)}(e),i="true"===await ie(t)._get(n);return await ie(t)._remove(n),i}(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(e)}catch(e){t=()=>Promise.reject(e)}ee.set(this.auth._key(),t)}return t()}async onAuthEvent(t){if("signInViaRedirect"===t.type)return super.onAuthEvent(t);if("unknown"!==t.type){if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function ie(t){return v(t._redirectPersistence)}async function re(t,e,n=!1){const i=st(t),r=function(t,e){return e?v(e):(p(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}(i,e),s=new ne(i,r,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}class se{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(t,n)&&(e=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))})),this.hasHandledPotentialRedirect||!function(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ae(t);default:return!1}}(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){var n;if(t.error&&!ae(t)){const i=(null===(n=t.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";e.onError(d(this.auth,i))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const n=null===e.eventId||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(oe(t))}saveEventToCache(t){this.cachedEventUids.add(oe(t)),this.lastProcessedEventTime=Date.now()}}function oe(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter((t=>t)).join("-")}function ae({type:t,error:e}){return"unknown"===t&&"auth/no-auth-event"===(null==e?void 0:e.code)}const ce=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ue=/^https?/;function le(t){const e=w(),{protocol:n,hostname:i}=new URL(e);if(t.startsWith("chrome-extension://")){const r=new URL(t);return""===r.hostname&&""===i?"chrome-extension:"===n&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===n&&r.hostname===i}if(!ue.test(n))return!1;if(ce.test(t))return i===t;const r=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const he=new _(3e4,6e4);function de(){const t=Lt().___jsl;if(null==t?void 0:t.H)for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let e=0;e<t.CP.length;e++)t.CP[e]=null}let fe=null;function pe(t){return fe=fe||function(t){return new Promise(((e,n)=>{var i,r,s,o;function a(){de(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{de(),n(d(t,"network-request-failed"))},timeout:he.get()})}if(null===(r=null===(i=Lt().gapi)||void 0===i?void 0:i.iframes)||void 0===r?void 0:r.Iframe)e(gapi.iframes.getContext());else{if(!(null===(s=Lt().gapi)||void 0===s?void 0:s.load)){const e=$t("iframefcb");return Lt()[e]=()=>{gapi.load?a():n(d(t,"network-request-failed"))},o=`https://apis.google.com/js/api.js?onload=${e}`,new Promise(((t,e)=>{const n=document.createElement("script");var i,r;n.setAttribute("src",o),n.onload=t,n.onerror=t=>{const n=d("internal-error");n.customData=t,e(n)},n.type="text/javascript",n.charset="UTF-8",(null!==(r=null===(i=document.getElementsByTagName("head"))||void 0===i?void 0:i[0])&&void 0!==r?r:document).appendChild(n)}))}a()}})).catch((t=>{throw fe=null,t}))}(t),fe}const ge=new _(5e3,15e3),me={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},ye=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function ve(t){const e=t.config;p(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?I(e,"emulator/auth/iframe"):`https://${t.config.authDomain}/__/auth/iframe`,s={apiKey:e.apiKey,appName:t.name,v:r.MF},o=ye.get(t.config.apiHost);o&&(s.eid=o);const a=t._getFrameworks();return a.length&&(s.fw=a.join(",")),`${n}?${(0,i.Am)(s).slice(1)}`}const we={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class be{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(t){}}}function _e(t,e,n,s,o,a){p(t.config.authDomain,t,"auth-domain-config-required"),p(t.config.apiKey,t,"invalid-api-key");const c={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:s,v:r.MF,eventId:o};if(e instanceof gt){e.setDefaultLanguage(t.languageCode),c.providerId=e.providerId||"",(0,i.Im)(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[t,e]of Object.entries(a||{}))c[t]=e}if(e instanceof mt){const t=e.getScopes().filter((t=>""!==t));t.length>0&&(c.scopes=t.join(","))}t.tenantId&&(c.tid=t.tenantId);const u=c;for(const t of Object.keys(u))void 0===u[t]&&delete u[t];return`${function({config:t}){return t.emulator?I(t,"emulator/auth/handler"):`https://${t.authDomain}/__/auth/handler`}(t)}?${(0,i.Am)(u).slice(1)}`}const Ie="webStorageSupport",Te=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ct,this._completeRedirectFn=re}async _openPopup(t,e,n,r){var s;return m(null===(s=this.eventManagers[t._key()])||void 0===s?void 0:s.manager,"_initialize() not called before _openPopup()"),function(t,e,n,r=500,s=600){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u=Object.assign(Object.assign({},we),{width:r.toString(),height:s.toString(),top:o,left:a}),l=(0,i.ZQ)().toLowerCase();n&&(c=Q(l)?"_blank":n),W(l)&&(e=e||"http://localhost",u.scrollbars="yes");const h=Object.entries(u).reduce(((t,[e,n])=>`${t}${e}=${n},`),"");if(function(t=(0,i.ZQ)()){var e;return et(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(l)&&"_self"!==c)return function(t,e){const n=document.createElement("a");n.href=t,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}(e||"",c),new be(null);const d=window.open(e||"",c,h);p(d,t,"popup-blocked");try{d.focus()}catch(t){}return new be(d)}(t,_e(t,e,n,w(),r),Dt())}async _openRedirect(t,e,n,i){var r;return await this._originValidation(t),r=_e(t,e,n,w(),i),Lt().location.href=r,new Promise((()=>{}))}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:t,promise:n}=this.eventManagers[e];return t?Promise.resolve(t):(m(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(t);return this.eventManagers[e]={promise:n},n}async initAndGetManager(t){const e=await async function(t){const e=await pe(t),n=Lt().gapi;return p(n,t,"internal-error"),e.open({where:document.body,url:ve(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:me,dontclear:!0},(e=>new Promise((async(n,i)=>{await e.restyle({setHideOnLeave:!1});const r=d(t,"network-request-failed"),s=Lt().setTimeout((()=>{i(r)}),ge.get());function o(){Lt().clearTimeout(s),n(e)}e.ping(o).then(o,(()=>{i(r)}))}))))}(t),n=new se(t);return e.register("authEvent",(e=>(p(null==e?void 0:e.authEvent,t,"invalid-auth-event"),{status:n.onEvent(e.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=e,n}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(Ie,{type:Ie},(n=>{var i;const r=null===(i=null==n?void 0:n[0])||void 0===i?void 0:i[Ie];void 0!==r&&e(!!r),h(t,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=async function(t){if(t.config.emulator)return;const{authorizedDomains:e}=await async function(t,e={}){return k(t,"GET","/v1/projects",e)}(t);for(const t of e)try{if(le(t))return}catch(t){}h(t,"unauthorized-domain")}(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return nt()||X()||et()}};var Ee;class Se{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged((e=>{var n;t((null===(n=e)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)}));this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){p(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Ae(t=(0,r.Sx)()){const e=(0,r.j6)(t,"auth");return e.isInitialized()?e.getImmediate():function(t,e){const n=(0,r.j6)(t,"auth");if(n.isInitialized()){const t=n.getImmediate(),r=n.getOptions();if((0,i.bD)(r,null!=e?e:{}))return t;h(t,"already-initialized")}return n.initialize({options:e})}(t,{popupRedirectResolver:Te,persistence:[zt,Rt,Ct]})}Ee="Browser",(0,r.om)(new a.uA("auth",((t,{options:e})=>{const n=t.getProvider("app").getImmediate(),{apiKey:i,authDomain:r}=n.options;return(t=>{p(i&&!i.includes(":"),"invalid-api-key",{appName:t.name}),p(!(null==r?void 0:r.includes(":")),"argument-error",{appName:t.name});const n={apiKey:i,authDomain:r,clientPlatform:Ee,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:it(Ee)},s=new rt(t,n);return function(t,e){const n=(null==e?void 0:e.persistence)||[],i=(Array.isArray(n)?n:[n]).map(v);(null==e?void 0:e.errorMap)&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,null==e?void 0:e.popupRedirectResolver)}(s,e),s})(n)}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((t,e,n)=>{t.getProvider("auth-internal").initialize()}))),(0,r.om)(new a.uA("auth-internal",(t=>{return e=st(t.getProvider("auth").getImmediate()),new Se(e);var e}),"PRIVATE").setInstantiationMode("EXPLICIT")),(0,r.KO)("@firebase/auth","0.17.1",function(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(Ee))},205:(t,e,n)=>{n.d(e,{IG:()=>u,db:()=>c});var i=n(944),r=n(237),s=n(982),o=n(226);const a=(0,i.Wp)({apiKey:"AIzaSyDEbX-gQ6FwJD5oZGnaoiJu9qIaAG2LZ0M",authDomain:"upload-25f01.firebaseapp.com",projectId:"upload-25f01",storageBucket:"upload-25f01.firebasestorage.app",messagingSenderId:"97167487690",appId:"1:97167487690:web:88409aded0a1dd13f87a33",measurementId:"G-3Y94K1XCBK"}),c=((0,r.xI)(a),(0,s.aU)(a)),u=(0,o.c7)(a)},226:(t,e,n)=>{n.d(e,{D:()=>i.D,KR:()=>i.KR,c7:()=>i.c7,qk:()=>i.qk});var i=n(334)},237:(t,e,n)=>{n.d(e,{xI:()=>i.xI});var i=n(440)},334:(t,e,n)=>{n.d(e,{D:()=>et,KR:()=>it,c7:()=>rt,qk:()=>nt});var i,r=n(468),s=n(625),o=n(134);!function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"}(i||(i={}));const a="firebasestorage.googleapis.com",c="storageBucket";class u extends s.g{constructor(t,e){super(l(t),`Firebase Storage: ${e} (${l(t)})`),this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,u.prototype)}_codeEquals(t){return l(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}}function l(t){return"storage/"+t}function h(){return new u("unknown","An unknown error occurred, please check the error payload for server response.")}function d(t){return new u("invalid-argument",t)}function f(){return new u("app-deleted","The Firebase app was deleted.")}function p(t,e){return new u("invalid-format","String does not match format '"+t+"': "+e)}function g(t){throw new u("internal-error","Internal error: "+t)}class m{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=i.NO_ERROR,this.sendPromise_=new Promise((t=>{this.xhr_.addEventListener("abort",(()=>{this.errorCode_=i.ABORT,t()})),this.xhr_.addEventListener("error",(()=>{this.errorCode_=i.NETWORK_ERROR,t()})),this.xhr_.addEventListener("load",(()=>{t()}))}))}send(t,e,n,i){if(this.sent_)throw g("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(e,t,!0),void 0!==i)for(const t in i)i.hasOwnProperty(t)&&this.xhr_.setRequestHeader(t,i[t].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw g("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw g("cannot .getStatus() before sending");try{return this.xhr_.status}catch(t){return-1}}getResponseText(){if(!this.sent_)throw g("cannot .getResponseText() before sending");return this.xhr_.responseText}abort(){this.xhr_.abort()}getResponseHeader(t){return this.xhr_.getResponseHeader(t)}addUploadProgressListener(t){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",t)}removeUploadProgressListener(t){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",t)}}class y{createConnection(){return new m}}class v{constructor(t,e){this.bucket=t,this.path_=e}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,e){let n;try{n=v.makeFromUrl(t,e)}catch(e){return new v(t,"")}if(""===n.path)return n;throw new u("invalid-default-bucket","Invalid default bucket '"+t+"'.")}static makeFromUrl(t,e){let n=null;const i="([A-Za-z0-9.\\-_]+)",r=new RegExp("^gs://"+i+"(/(.*))?$","i");function s(t){t.path_=decodeURIComponent(t.path)}const o=e.replace(/[.]/g,"\\."),c=[{regex:r,indices:{bucket:1,path:3},postModify:function(t){"/"===t.path.charAt(t.path.length-1)&&(t.path_=t.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${o}/v[A-Za-z0-9_]+/b/${i}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:s},{regex:new RegExp(`^https?://${e===a?"(?:storage.googleapis.com|storage.cloud.google.com)":e}/${i}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:s}];for(let e=0;e<c.length;e++){const i=c[e],r=i.regex.exec(t);if(r){const t=r[i.indices.bucket];let e=r[i.indices.path];e||(e=""),n=new v(t,e),i.postModify(n);break}}if(null==n)throw function(t){return new u("invalid-url","Invalid URL '"+t+"'.")}(t);return n}}class w{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}function b(t){return"string"==typeof t||t instanceof String}function _(t){return I()&&t instanceof Blob}function I(){return"undefined"!=typeof Blob}function T(t,e,n,i){if(i<e)throw d(`Invalid value for '${t}'. Expected ${e} or greater.`);if(i>n)throw d(`Invalid value for '${t}'. Expected ${n} or less.`)}function E(t,e){const n=e.match(/^(\w+):\/\/.+/);let i=e;return null==(null==n?void 0:n[1])&&(i=`https://${e}`),`${i}/v0${t}`}function S(t){const e=encodeURIComponent;let n="?";for(const i in t)t.hasOwnProperty(i)&&(n=n+(e(i)+"=")+e(t[i])+"&");return n=n.slice(0,-1),n}class A{constructor(t,e,n,i,r,s,o,a,c,u,l){this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=t,this.method_=e,this.headers_=n,this.body_=i,this.successCodes_=r.slice(),this.additionalRetryCodes_=s.slice(),this.callback_=o,this.errorCallback_=a,this.progressCallback_=u,this.timeout_=c,this.pool_=l,this.promise_=new Promise(((t,e)=>{this.resolve_=t,this.reject_=e,this.start_()}))}start_(){const t=this;function e(e,n){const i=t.resolve_,r=t.reject_,s=n.connection;if(n.wasSuccessCode)try{const e=t.callback_(s,s.getResponseText());void 0===e?i():i(e)}catch(t){r(t)}else if(null!==s){const e=h();e.serverResponse=s.getResponseText(),t.errorCallback_?r(t.errorCallback_(s,e)):r(e)}else n.canceled?r(t.appDelete_?f():new u("canceled","User canceled the upload/download.")):r(new u("retry-limit-exceeded","Max retry time for operation exceeded, please try again."))}this.canceled_?e(0,new k(!1,null,!0)):this.backoffId_=function(e,n,r){let s=1,o=null,a=!1,c=0;function u(){return 2===c}let l=!1;function h(...t){l||(l=!0,n.apply(null,t))}function d(e){o=setTimeout((()=>{o=null,function(e,n){if(n)return void e(!1,new k(!1,null,!0));const r=t.pool_.createConnection();function s(e){const n=e.loaded,i=e.lengthComputable?e.total:-1;null!==t.progressCallback_&&t.progressCallback_(n,i)}t.pendingConnection_=r,null!==t.progressCallback_&&r.addUploadProgressListener(s),r.send(t.url_,t.method_,t.body_,t.headers_).then((()=>{null!==t.progressCallback_&&r.removeUploadProgressListener(s),t.pendingConnection_=null;const n=r.getErrorCode()===i.NO_ERROR,o=r.getStatus();if(!n||t.isRetryStatusCode_(o)){const t=r.getErrorCode()===i.ABORT;return void e(!1,new k(!1,null,t))}const a=-1!==t.successCodes_.indexOf(o);e(!0,new k(a,r))}))}(f,u())}),e)}function f(t,...e){if(l)return;if(t)return void h.call(null,t,...e);if(u()||a)return void h.call(null,t,...e);let n;s<64&&(s*=2),1===c?(c=2,n=0):n=1e3*(s+Math.random()),d(n)}let p=!1;function g(t){p||(p=!0,l||(null!==o?(t||(c=2),clearTimeout(o),d(0)):t||(c=1)))}return d(0),setTimeout((()=>{a=!0,g(!0)}),r),g}(0,e,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()}isRetryStatusCode_(t){const e=t>=500&&t<600,n=-1!==[408,429].indexOf(t),i=-1!==this.additionalRetryCodes_.indexOf(t);return e||n||i}}class k{constructor(t,e,n){this.wasSuccessCode=t,this.connection=e,this.canceled=!!n}}function R(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function N(...t){const e=R();if(void 0!==e){const n=new e;for(let e=0;e<t.length;e++)n.append(t[e]);return n.getBlob()}if(I())return new Blob(t);throw new u("unsupported-environment","This browser doesn't seem to support creating Blobs")}const C="base64",O="base64url",D="data_url";class P{constructor(t,e){this.data=t,this.contentType=e||null}}function L(t){const e=[];for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<=127?e.push(i):i<=2047?e.push(192|i>>6,128|63&i):55296==(64512&i)?n<t.length-1&&56320==(64512&t.charCodeAt(n+1))?(i=65536|(1023&i)<<10|1023&t.charCodeAt(++n),e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i)):e.push(239,191,189):56320==(64512&i)?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|63&i)}return new Uint8Array(e)}function x(t,e){switch(t){case C:{const n=-1!==e.indexOf("-"),i=-1!==e.indexOf("_");if(n||i)throw p(t,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break}case O:{const n=-1!==e.indexOf("+"),i=-1!==e.indexOf("/");if(n||i)throw p(t,"Invalid character '"+(n?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=atob(e)}catch(e){throw p(t,"Invalid character found")}const i=new Uint8Array(n.length);for(let t=0;t<n.length;t++)i[t]=n.charCodeAt(t);return i}class M{constructor(t){this.base64=!1,this.contentType=null;const e=t.match(/^data:([^,]+)?,/);if(null===e)throw p(D,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=e[1]||null;var i,r;null!=n&&(this.base64=(r=";base64",(i=n).length>=7&&i.substring(i.length-7)===r),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=t.substring(t.indexOf(",")+1)}}class U{constructor(t,e){let n=0,i="";_(t)?(this.data_=t,n=t.size,i=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=i}size(){return this.size_}type(){return this.type_}slice(t,e){if(_(this.data_)){const s=(n=this.data_,i=t,r=e,n.webkitSlice?n.webkitSlice(i,r):n.mozSlice?n.mozSlice(i,r):n.slice?n.slice(i,r):null);return null===s?null:new U(s)}var n,i,r;{const n=new Uint8Array(this.data_.buffer,t,e-t);return new U(n,!0)}}static getBlob(...t){if(I()){const e=t.map((t=>t instanceof U?t.data_:t));return new U(N.apply(null,e))}{const e=t.map((t=>b(t)?function(t,e){switch(t){case"raw":return new P(L(e));case C:case O:return new P(x(t,e));case D:return new P(function(t){const e=new M(t);return e.base64?x(C,e.rest):function(t){let e;try{e=decodeURIComponent(t)}catch(t){throw p(D,"Malformed data URL.")}return L(e)}(e.rest)}(e),new M(e).contentType)}throw h()}("raw",t).data:t.data_));let n=0;e.forEach((t=>{n+=t.byteLength}));const i=new Uint8Array(n);let r=0;return e.forEach((t=>{for(let e=0;e<t.length;e++)i[r++]=t[e]})),new U(i,!0)}}uploadData(){return this.data_}}function F(t){let e;try{e=JSON.parse(t)}catch(t){return null}return"object"!=typeof(n=e)||Array.isArray(n)?null:e;var n}function V(t){const e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}function j(t,e){return e}class B{constructor(t,e,n,i){this.server=t,this.local=e||t,this.writable=!!n,this.xform=i||j}}let H=null;function K(){if(H)return H;const t=[];t.push(new B("bucket")),t.push(new B("generation")),t.push(new B("metageneration")),t.push(new B("name","fullPath",!0));const e=new B("name");e.xform=function(t,e){return function(t){return!b(t)||t.length<2?t:V(t)}(e)},t.push(e);const n=new B("size");return n.xform=function(t,e){return void 0!==e?Number(e):e},t.push(n),t.push(new B("timeCreated")),t.push(new B("updated")),t.push(new B("md5Hash",null,!0)),t.push(new B("cacheControl",null,!0)),t.push(new B("contentDisposition",null,!0)),t.push(new B("contentEncoding",null,!0)),t.push(new B("contentLanguage",null,!0)),t.push(new B("contentType",null,!0)),t.push(new B("metadata","customMetadata",!0)),H=t,H}function q(t,e,n){const i=F(e);return null===i?null:function(t,e,n){const i={type:"file"},r=n.length;for(let t=0;t<r;t++){const r=n[t];i[r.local]=r.xform(i,e[r.server])}return function(t,e){Object.defineProperty(t,"ref",{get:function(){const n=t.bucket,i=t.fullPath,r=new v(n,i);return e._makeStorageReference(r)}})}(i,t),i}(t,i,n)}class z{constructor(t,e,n,i){this.url=t,this.method=e,this.handler=n,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function $(t){if(!t)throw h()}function G(t){return function(e,n){let i;var r,s;return 401===e.getStatus()?i=e.getResponseText().includes("Firebase App Check token is invalid")?new u("unauthorized-app","This app does not have permission to access Firebase Storage on this project."):new u("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again."):402===e.getStatus()?(s=t.bucket,i=new u("quota-exceeded","Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===e.getStatus()?(r=t.path,i=new u("unauthorized","User does not have permission to access '"+r+"'.")):i=n,i.serverResponse=n.serverResponse,i}}function W(t,e,n,i,r){const s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"},a=function(){let t="";for(let e=0;e<2;e++)t+=Math.random().toString().slice(2);return t}();o["Content-Type"]="multipart/related; boundary="+a;const c=function(t,e,n){const i=Object.assign({},n);return i.fullPath=t.path,i.size=e.size(),i.contentType||(i.contentType=function(t,e){return e&&e.type()||"application/octet-stream"}(0,e)),i}(e,i,r),l="--"+a+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+function(t,e){const n={},i=e.length;for(let r=0;r<i;r++){const i=e[r];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}(c,n)+"\r\n--"+a+"\r\nContent-Type: "+c.contentType+"\r\n\r\n",h="\r\n--"+a+"--",d=U.getBlob(l,i,h);if(null===d)throw new u("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.");const f={name:c.fullPath},p=E(s,t.host),g=t.maxUploadRetryTime,m=new z(p,"POST",function(t,e){return function(n,i){const r=q(t,i,e);return $(null!==r),r}}(t,n),g);return m.urlParams=f,m.headers=o,m.body=d.uploadData(),m.errorHandler=G(e),m}class X{constructor(t,e){this._service=t,this._location=e instanceof v?e:v.makeFromUrl(e,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,e){return new X(t,e)}get root(){const t=new v(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return V(this._location.path)}get storage(){return this._service}get parent(){const t=function(t){if(0===t.length)return null;const e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}(this._location.path);if(null===t)return null;const e=new v(this._location.bucket,t);return new X(this._service,e)}_throwIfRoot(t){if(""===this._location.path)throw function(t){return new u("invalid-root-operation","The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(t)}}async function Q(t){t._throwIfRoot("getDownloadURL");const e=function(t,e,n){const i=E(e.fullServerUrl(),t.host),r=t.maxOperationRetryTime,s=new z(i,"GET",function(t,e){return function(n,i){const r=q(t,i,e);return $(null!==r),function(t,e,n){const i=F(e);if(null===i)return null;if(!b(i.downloadTokens))return null;const r=i.downloadTokens;if(0===r.length)return null;const s=encodeURIComponent;return r.split(",").map((e=>{const i=t.bucket,r=t.fullPath;return E("/b/"+s(i)+"/o/"+s(r),n)+S({alt:"media",token:e})}))[0]}(r,i,t.host)}}(t,n),r);return s.errorHandler=function(t){const e=G(t);return function(n,i){let r=e(n,i);var s;return 404===n.getStatus()&&(s=t.path,r=new u("object-not-found","Object '"+s+"' does not exist.")),r.serverResponse=i.serverResponse,r}}(e),s}(t.storage,t._location,K());return(await t.storage.makeRequestWithTokens(e)).getPromise().then((t=>{if(null===t)throw new u("no-download-url","The given file does not have any download URLs.");return t}))}function J(t,e){if(t instanceof Z){const n=t;if(null==n._bucket)throw new u("no-default-bucket","No default bucket found. Did you set the '"+c+"' property when initializing the app?");const i=new X(n,n._bucket);return null!=e?J(i,e):i}return void 0!==e?function(t,e){const n=function(t,e){const n=e.split("/").filter((t=>t.length>0)).join("/");return 0===t.length?n:t+"/"+n}(t._location.path,e),i=new v(t._location.bucket,n);return new X(t.storage,i)}(t,e):t}function Y(t,e){const n=null==e?void 0:e[c];return null==n?null:v.makeFromBucketSpec(n,t)}class Z{constructor(t,e,n,i,r,s){this.app=t,this._authProvider=e,this._appCheckProvider=n,this._pool=i,this._url=r,this._firebaseVersion=s,this._bucket=null,this._host=a,this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=r?v.makeFromBucketSpec(r,this._host):Y(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,null!=this._url?this._bucket=v.makeFromBucketSpec(this._url,t):this._bucket=Y(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){T("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){T("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const e=await t.getToken();if(null!==e)return e.accessToken}return null}async _getAppCheckToken(){const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach((t=>t.cancel())),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new X(this,t)}_makeRequest(t,e,n){if(this._deleted)return new w(f());{const i=function(t,e,n,i,r,s){const o=S(t.urlParams),a=t.url+o,c=Object.assign({},t.headers);return function(t,e){e&&(t["X-Firebase-GMPID"]=e)}(c,e),function(t,e){null!==e&&e.length>0&&(t.Authorization="Firebase "+e)}(c,n),function(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(null!=e?e:"AppManager")}(c,s),function(t,e){null!==e&&(t["X-Firebase-AppCheck"]=e)}(c,i),new A(a,t.method,c,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,r)}(t,this._appId,e,n,this._pool,this._firebaseVersion);return this._requests.add(i),i.getPromise().then((()=>this._requests.delete(i)),(()=>this._requests.delete(i))),i}}async makeRequestWithTokens(t){const[e,n]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,e,n)}}const tt="storage";function et(t,e,n){return function(t,e,n){t._throwIfRoot("uploadBytes");const i=W(t.storage,t._location,K(),new U(e,!0),n);return t.storage.makeRequestWithTokens(i).then((t=>t.getPromise())).then((e=>({metadata:e,ref:t})))}(t=(0,s.Ku)(t),e,n)}function nt(t){return Q(t=(0,s.Ku)(t))}function it(t,e){return function(t,e){if(e&&/^[A-Za-z]+:\/\//.test(e)){if(t instanceof Z)return new X(t,e);throw d("To use ref(service, url), the first argument must be a Storage instance.")}return J(t,e)}(t=(0,s.Ku)(t),e)}function rt(t=(0,r.Sx)(),e){return t=(0,s.Ku)(t),(0,r.j6)(t,tt).getImmediate({identifier:e})}(0,r.om)(new o.uA(tt,(function(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new Z(n,i,s,new y,e,r.MF)}),"PUBLIC").setMultipleInstances(!0)),(0,r.KO)("@firebase/storage","0.8.1")},440:(t,e,n)=>{n.d(e,{xI:()=>i.n});var i=n(137);n(625),n(468),n(477),n(134)},468:(t,e,n)=>{n.d(e,{KO:()=>z,MF:()=>H,Sx:()=>q,Wp:()=>K,j6:()=>V,om:()=>F});var i=n(134),r=n(477),s=n(625);class o{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const a="@firebase/app",c=new r.Vy("@firebase/app"),u="@firebase/app-compat",l="@firebase/analytics-compat",h="@firebase/analytics",d="@firebase/app-check-compat",f="@firebase/app-check",p="@firebase/auth",g="@firebase/auth-compat",m="@firebase/database",y="@firebase/database-compat",v="@firebase/functions",w="@firebase/functions-compat",b="@firebase/installations",_="@firebase/installations-compat",I="@firebase/messaging",T="@firebase/messaging-compat",E="@firebase/performance",S="@firebase/performance-compat",A="@firebase/remote-config",k="@firebase/remote-config-compat",R="@firebase/storage",N="@firebase/storage-compat",C="@firebase/firestore",O="@firebase/firestore-compat",D="firebase",P="[DEFAULT]",L={[a]:"fire-core",[u]:"fire-core-compat",[h]:"fire-analytics",[l]:"fire-analytics-compat",[f]:"fire-app-check",[d]:"fire-app-check-compat",[p]:"fire-auth",[g]:"fire-auth-compat",[m]:"fire-rtdb",[y]:"fire-rtdb-compat",[v]:"fire-fn",[w]:"fire-fn-compat",[b]:"fire-iid",[_]:"fire-iid-compat",[I]:"fire-fcm",[T]:"fire-fcm-compat",[E]:"fire-perf",[S]:"fire-perf-compat",[A]:"fire-rc",[k]:"fire-rc-compat",[R]:"fire-gcs",[N]:"fire-gcs-compat",[C]:"fire-fst",[O]:"fire-fst-compat","fire-js":"fire-js",[D]:"fire-js-all"},x=new Map,M=new Map;function U(t,e){try{t.container.addComponent(e)}catch(n){c.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function F(t){const e=t.name;if(M.has(e))return c.debug(`There were multiple attempts to register component ${e}.`),!1;M.set(e,t);for(const e of x.values())U(e,t);return!0}function V(t,e){return t.container.getProvider(e)}const j=new s.FA("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function."});class B{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new i.uA("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw j.create("app-deleted",{appName:this._name})}}const H="9.0.0";function K(t,e={}){"object"!=typeof e&&(e={name:e});const n=Object.assign({name:P,automaticDataCollectionEnabled:!1},e),r=n.name;if("string"!=typeof r||!r)throw j.create("bad-app-name",{appName:String(r)});const o=x.get(r);if(o){if((0,s.bD)(t,o.options)&&(0,s.bD)(n,o.config))return o;throw j.create("duplicate-app",{appName:r})}const a=new i.h1(r);for(const t of M.values())a.addComponent(t);const c=new B(t,n,a);return x.set(r,c),c}function q(t=P){const e=x.get(t);if(!e)throw j.create("no-app",{appName:t});return e}function z(t,e,n){var r;let s=null!==(r=L[t])&&void 0!==r?r:t;n&&(s+=`-${n}`);const o=s.match(/\s|\//),a=e.match(/\s|\//);if(o||a){const t=[`Unable to register library "${s}" with version "${e}":`];return o&&t.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&a&&t.push("and"),a&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void c.warn(t.join(" "))}F(new i.uA(`${s}-version`,(()=>({library:s,version:e})),"VERSION"))}F(new i.uA("platform-logger",(t=>new o(t)),"PRIVATE")),z(a,"0.7.0",undefined),z("fire-js","")},477:(t,e,n)=>{function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,r++)i[r]=s[o];return i}var r;n.d(e,{$b:()=>s,Vy:()=>h});var s,o=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(s||(s={}));var a={debug:s.DEBUG,verbose:s.VERBOSE,info:s.INFO,warn:s.WARN,error:s.ERROR,silent:s.SILENT},c=s.INFO,u=((r={})[s.DEBUG]="log",r[s.VERBOSE]="log",r[s.INFO]="info",r[s.WARN]="warn",r[s.ERROR]="error",r),l=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var s=(new Date).toISOString(),o=u[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,i(["["+s+"]  "+t.name+":"],n))}},h=function(){function t(t){this.name=t,this._logLevel=c,this._logHandler=l,this._userLogHandler=null,o.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in s))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?a[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,i([this,s.DEBUG],t)),this._logHandler.apply(this,i([this,s.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,i([this,s.VERBOSE],t)),this._logHandler.apply(this,i([this,s.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,i([this,s.INFO],t)),this._logHandler.apply(this,i([this,s.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,i([this,s.WARN],t)),this._logHandler.apply(this,i([this,s.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,i([this,s.ERROR],t)),this._logHandler.apply(this,i([this,s.ERROR],t))},t}()},625:(t,e,n)=>{n.d(e,{Am:()=>_,FA:()=>m,I9:()=>I,Im:()=>v,Ku:()=>k,ZQ:()=>a,b8:()=>h,bD:()=>w,cY:()=>o,g:()=>g,hp:()=>T,jZ:()=>c,lT:()=>d,lV:()=>l,n4:()=>f,nr:()=>p,sr:()=>u,tD:()=>E,u:()=>s});var i=n(635),r={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[],r=0;r<t.length;r+=3){var s=t[r],o=r+1<t.length,a=o?t[r+1]:0,c=r+2<t.length,u=c?t[r+2]:0,l=s>>2,h=(3&s)<<4|a>>4,d=(15&a)<<2|u>>6,f=63&u;c||(f=64,o||(d=64)),i.push(n[l],n[h],n[d],n[f])}return i.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(function(t){for(var e=[],n=0,i=0;i<t.length;i++){var r=t.charCodeAt(i);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=63&r|128):55296==(64512&r)&&i+1<t.length&&56320==(64512&t.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&t.charCodeAt(++i)),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=63&r|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=63&r|128)}return e}(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,i=0;n<t.length;){var r=t[n++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){var s=t[n++];e[i++]=String.fromCharCode((31&r)<<6|63&s)}else if(r>239&&r<365){var o=((7&r)<<18|(63&(s=t[n++]))<<12|(63&(a=t[n++]))<<6|63&t[n++])-65536;e[i++]=String.fromCharCode(55296+(o>>10)),e[i++]=String.fromCharCode(56320+(1023&o))}else{s=t[n++];var a=t[n++];e[i++]=String.fromCharCode((15&r)<<12|(63&s)<<6|63&a)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[],r=0;r<t.length;){var s=n[t.charAt(r++)],o=r<t.length?n[t.charAt(r)]:0,a=++r<t.length?n[t.charAt(r)]:64,c=++r<t.length?n[t.charAt(r)]:64;if(++r,null==s||null==o||null==a||null==c)throw Error();var u=s<<2|o>>4;if(i.push(u),64!==a){var l=o<<4&240|a>>2;if(i.push(l),64!==c){var h=a<<6&192|c;i.push(h)}}}return i},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},s=function(t){try{return r.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null},o=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,i){n?e.reject(n):e.resolve(i),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,i))}},t}();function a(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function c(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(a())}function u(){var t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function l(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function h(){return a().indexOf("Electron/")>=0}function d(){var t=a();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function f(){return a().indexOf("MSAppHost/")>=0}function p(){return!function(){try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(t){return!1}}()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}var g=function(t){function e(n,i,r){var s=t.call(this,i)||this;return s.code=n,s.customData=r,s.name="FirebaseError",Object.setPrototypeOf(s,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(s,m.prototype.create),s}return(0,i.C6)(e,t),e}(Error),m=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var i=e[0]||{},r=this.service+"/"+t,s=this.errors[t],o=s?function(t,e){return t.replace(y,(function(t,n){var i=e[n];return null!=i?String(i):"<"+n+"?>"}))}(s,i):"Error",a=this.serviceName+": "+o+" ("+r+").";return new g(r,a,i)},t}(),y=/\{\$([^}]+)}/g;function v(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function w(t,e){if(t===e)return!0;for(var n=Object.keys(t),i=Object.keys(e),r=0,s=n;r<s.length;r++){var o=s[r];if(!i.includes(o))return!1;var a=t[o],c=e[o];if(b(a)&&b(c)){if(!w(a,c))return!1}else if(a!==c)return!1}for(var u=0,l=i;u<l.length;u++)if(o=l[u],!n.includes(o))return!1;return!0}function b(t){return null!==t&&"object"==typeof t}function _(t){for(var e=[],n=function(t,n){Array.isArray(n)?n.forEach((function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))})):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))},i=0,r=Object.entries(t);i<r.length;i++){var s=r[i];n(s[0],s[1])}return e.length?"&"+e.join("&"):""}function I(t){var e={};return t.replace(/^\?/,"").split("&").forEach((function(t){if(t){var n=t.split("="),i=n[0],r=n[1];e[decodeURIComponent(i)]=decodeURIComponent(r)}})),e}function T(t){var e=t.indexOf("?");if(!e)return"";var n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function E(t,e){var n=new S(t,e);return n.subscribe.bind(n)}!function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var i=0;i<16;i++)n[i]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(i=0;i<16;i++)n[i]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(i=16;i<80;i++){var r=n[i-3]^n[i-8]^n[i-14]^n[i-16];n[i]=4294967295&(r<<1|r>>>31)}var s,o,a=this.chain_[0],c=this.chain_[1],u=this.chain_[2],l=this.chain_[3],h=this.chain_[4];for(i=0;i<80;i++)i<40?i<20?(s=l^c&(u^l),o=1518500249):(s=c^u^l,o=1859775393):i<60?(s=c&u|l&(c|u),o=2400959708):(s=c^u^l,o=3395469782),r=(a<<5|a>>>27)+s+h+o+n[i]&4294967295,h=l,l=u,u=4294967295&(c<<30|c>>>2),c=a,a=r;this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+c&4294967295,this.chain_[2]=this.chain_[2]+u&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,i=0,r=this.buf_,s=this.inbuf_;i<e;){if(0===s)for(;i<=n;)this.compress_(t,i),i+=this.blockSize;if("string"==typeof t){for(;i<e;)if(r[s]=t.charCodeAt(i),++i,++s===this.blockSize){this.compress_(r),s=0;break}}else for(;i<e;)if(r[s]=t[i],++i,++s===this.blockSize){this.compress_(r),s=0;break}}this.inbuf_=s,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var i=0;for(n=0;n<5;n++)for(var r=24;r>=0;r-=8)t[i]=this.chain_[n]>>r&255,++i;return t}}();var S=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var i,r=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(i=function(t){if("object"!=typeof t||null===t)return!1;for(var e=0,n=["next","error","complete"];e<n.length;e++){var i=n[e];if(i in t&&"function"==typeof t[i])return!0}return!1}(t)?t:{next:t,error:e,complete:n}).next&&(i.next=A),void 0===i.error&&(i.error=A),void 0===i.complete&&(i.complete=A);var s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{r.finalError?i.error(r.finalError):i.complete()}catch(t){}})),this.observers.push(i),s},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function A(){}function k(t){return t&&t._delegate?t._delegate:t}},635:(t,e,n)=>{n.d(e,{C6:()=>r,Ju:()=>c,Tt:()=>s,YH:()=>a,fX:()=>l,sH:()=>o,zs:()=>u});var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},i(t,e)};function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function s(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}function o(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))}function a(t,e){var n,i,r,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=a(0),o.throw=a(1),o.return=a(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,i=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(6===a[0]&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(t,s)}catch(t){a=[6,t],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}function c(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function u(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,s=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(i=s.next()).done;)o.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return o}function l(t,e,n){if(n||2===arguments.length)for(var i,r=0,s=e.length;r<s;r++)!i&&r in e||(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError},756:(t,e,n)=>{function i(){const t=document.querySelectorAll(".custom-navbar .nav-link"),e=window.location.pathname.split("/").pop();t.forEach((t=>{const n=t.getAttribute("href");n===e||"#"===n&&e.includes("faq")?t.classList.add("active"):t.classList.remove("active")}))}n.d(e,{S:()=>i})},790:(t,e,n)=>{n.d(e,{H9:()=>zi,O5:()=>mr,aU:()=>Wi,mZ:()=>gr});var i=n(468),r=n(134),s=n(477),o=n(625),a=n(36);class c{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}c.UNAUTHENTICATED=new c(null),c.GOOGLE_CREDENTIALS=new c("google-credentials-uid"),c.FIRST_PARTY=new c("first-party-uid"),c.MOCK_USER=new c("mock-user");let u="9.0.1";const l=new s.Vy("@firebase/firestore");function h(){return l.logLevel}function d(t,...e){if(l.logLevel<=s.$b.DEBUG){const n=e.map(g);l.debug(`Firestore (${u}): ${t}`,...n)}}function f(t,...e){if(l.logLevel<=s.$b.ERROR){const n=e.map(g);l.error(`Firestore (${u}): ${t}`,...n)}}function p(t,...e){if(l.logLevel<=s.$b.WARN){const n=e.map(g);l.warn(`Firestore (${u}): ${t}`,...n)}}function g(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function m(t="Unexpected state"){const e=`FIRESTORE (${u}) INTERNAL ASSERTION FAILED: `+t;throw f(e),new Error(e)}function y(t,e){t||m()}function v(t,e){return t}const w={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class b extends Error{constructor(t,e){super(e),this.code=t,this.message=e,this.name="FirebaseError",this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class _{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class I{constructor(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization=`Bearer ${t}`}}class T{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(c.UNAUTHENTICATED)))}shutdown(){}}class E{constructor(t){this.t=t,this.currentUser=c.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let n=this.i;const i=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let r=new _;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new _,t.enqueueRetryable((()=>i(this.currentUser)))};const s=e=>{t.enqueueRetryable((async()=>{d("FirebaseCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),await r.promise,await i(this.currentUser)}))};this.t.onInit((t=>s(t))),setTimeout((()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?s(t):(d("FirebaseCredentialsProvider","Auth not yet detected"),r.resolve(),r=new _)}}),0),t.enqueueRetryable((async()=>{0===this.i&&(await r.promise,await i(this.currentUser))}))}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((e=>this.i!==t?(d("FirebaseCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(y("string"==typeof e.accessToken),new I(e.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return y(null===t||"string"==typeof t),new c(t)}}class S{constructor(t,e,n){this.h=t,this.l=e,this.m=n,this.type="FirstParty",this.user=c.FIRST_PARTY}get authHeaders(){const t={"X-Goog-AuthUser":this.l},e=this.h.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.m&&(t["X-Goog-Iam-Authorization-Token"]=this.m),t}}class A{constructor(t,e,n){this.h=t,this.l=e,this.m=n}getToken(){return Promise.resolve(new S(this.h,this.l,this.m))}start(t,e){t.enqueueRetryable((()=>e(c.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class k{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.g(t),this.p=t=>e.writeSequenceNumber(t))}g(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.p&&this.p(t),t}}function R(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}k.T=-1;class N{static I(){const t=62*Math.floor(256/62);let e="";for(;e.length<20;){const n=R(40);for(let i=0;i<n.length;++i)e.length<20&&n[i]<t&&(e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[i]%62))}return e}}function C(t,e){return t<e?-1:t>e?1:0}function O(t,e,n){return t.length===e.length&&t.every(((t,i)=>n(t,e[i])))}class D{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new b(w.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new b(w.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new b(w.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new b(w.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return D.fromMillis(Date.now())}static fromDate(t){return D.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*e));return new D(e,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?C(this.nanoseconds,t.nanoseconds):C(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class P{constructor(t){this.timestamp=t}static fromTimestamp(t){return new P(t)}static min(){return new P(new D(0,0))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}function L(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function x(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function M(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class U{constructor(t,e,n){void 0===e?e=0:e>t.length&&m(),void 0===n?n=t.length-e:n>t.length-e&&m(),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===U.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof U?t.forEach((t=>{e.push(t)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const n=t.get(i),r=e.get(i);if(n<r)return-1;if(n>r)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class F extends U{construct(t,e,n){return new F(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new b(w.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((t=>t.length>0)))}return new F(e)}static emptyPath(){return new F([])}}const V=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class j extends U{construct(t,e,n){return new j(t,e,n)}static isValidIdentifier(t){return V.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),j.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new j(["__name__"])}static fromServerFormat(t){const e=[];let n="",i=0;const r=()=>{if(0===n.length)throw new b(w.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let s=!1;for(;i<t.length;){const e=t[i];if("\\"===e){if(i+1===t.length)throw new b(w.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[i+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new b(w.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,i+=2}else"`"===e?(s=!s,i++):"."!==e||s?(n+=e,i++):(r(),i++)}if(r(),s)throw new b(w.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new j(e)}static emptyPath(){return new j([])}}class B{constructor(t){this.fields=t,t.sort(j.comparator)}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return O(this.fields,t.fields,((t,e)=>t.isEqual(e)))}}class H{constructor(t){this.binaryString=t}static fromBase64String(t){const e=atob(t);return new H(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new H(e)}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return C(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}H.EMPTY_BYTE_STRING=new H("");const K=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function q(t){if(y(!!t),"string"==typeof t){let e=0;const n=K.exec(t);if(y(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:z(t.seconds),nanos:z(t.nanos)}}function z(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function $(t){return"string"==typeof t?H.fromBase64String(t):H.fromUint8Array(t)}function G(t){const e=q(t.mapValue.fields.__local_write_time__.timestampValue);return new D(e.seconds,e.nanos)}function W(t){return null==t}function X(t){return 0===t&&1/t==-1/0}class Q{constructor(t){this.path=t}static fromPath(t){return new Q(F.fromString(t))}static fromName(t){return new Q(F.fromString(t).popFirst(5))}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}isEqual(t){return null!==t&&0===F.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return F.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Q(new F(t.slice()))}}function J(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?function(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}(t)?4:10:m()}function Y(t,e){const n=J(t);if(n!==J(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return G(t).isEqual(G(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=q(t.timestampValue),i=q(e.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return $(t.bytesValue).isEqual($(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return z(t.geoPointValue.latitude)===z(e.geoPointValue.latitude)&&z(t.geoPointValue.longitude)===z(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return z(t.integerValue)===z(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=z(t.doubleValue),i=z(e.doubleValue);return n===i?X(n)===X(i):isNaN(n)&&isNaN(i)}return!1}(t,e);case 9:return O(t.arrayValue.values||[],e.arrayValue.values||[],Y);case 10:return function(t,e){const n=t.mapValue.fields||{},i=e.mapValue.fields||{};if(L(n)!==L(i))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===i[t]||!Y(n[t],i[t])))return!1;return!0}(t,e);default:return m()}}function Z(t,e){return void 0!==(t.values||[]).find((t=>Y(t,e)))}function tt(t,e){const n=J(t),i=J(e);if(n!==i)return C(n,i);switch(n){case 0:return 0;case 1:return C(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=z(t.integerValue||t.doubleValue),i=z(e.integerValue||e.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(t,e);case 3:return et(t.timestampValue,e.timestampValue);case 4:return et(G(t),G(e));case 5:return C(t.stringValue,e.stringValue);case 6:return function(t,e){const n=$(t),i=$(e);return n.compareTo(i)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),i=e.split("/");for(let t=0;t<n.length&&t<i.length;t++){const e=C(n[t],i[t]);if(0!==e)return e}return C(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=C(z(t.latitude),z(e.latitude));return 0!==n?n:C(z(t.longitude),z(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],i=e.values||[];for(let t=0;t<n.length&&t<i.length;++t){const e=tt(n[t],i[t]);if(e)return e}return C(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){const n=t.fields||{},i=Object.keys(n),r=e.fields||{},s=Object.keys(r);i.sort(),s.sort();for(let t=0;t<i.length&&t<s.length;++t){const e=C(i[t],s[t]);if(0!==e)return e;const o=tt(n[i[t]],r[s[t]]);if(0!==o)return o}return C(i.length,s.length)}(t.mapValue,e.mapValue);default:throw m()}}function et(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return C(t,e);const n=q(t),i=q(e),r=C(n.seconds,i.seconds);return 0!==r?r:C(n.nanos,i.nanos)}function nt(t){return it(t)}function it(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=q(t);return`time(${e.seconds},${e.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?$(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,Q.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(t){let e="[",n=!0;for(const i of t.values||[])n?n=!1:e+=",",e+=it(i);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",i=!0;for(const r of e)i?i=!1:n+=",",n+=`${r}:${it(t.fields[r])}`;return n+"}"}(t.mapValue):m();var e,n}function rt(t){return!!t&&"integerValue"in t}function st(t){return!!t&&"arrayValue"in t}function ot(t){return!!t&&"mapValue"in t}function at(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return x(t.mapValue.fields,((t,n)=>e.mapValue.fields[t]=at(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=at(t.arrayValue.values[n]);return e}return Object.assign({},t)}class ct{constructor(t){this.value=t}static empty(){return new ct({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!ot(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=at(e)}setAll(t){let e=j.emptyPath(),n={},i=[];t.forEach(((t,r)=>{if(!e.isImmediateParentOf(r)){const t=this.getFieldsMap(e);this.applyChanges(t,n,i),n={},i=[],e=r.popLast()}t?n[r.lastSegment()]=at(t):i.push(r.lastSegment())}));const r=this.getFieldsMap(e);this.applyChanges(r,n,i)}delete(t){const e=this.field(t.popLast());ot(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Y(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let i=e.mapValue.fields[t.get(n)];ot(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,n){x(e,((e,n)=>t[e]=n));for(const e of n)delete t[e]}clone(){return new ct(at(this.value))}}function ut(t){const e=[];return x(t.fields,((t,n)=>{const i=new j([t]);if(ot(n)){const t=ut(n.mapValue).fields;if(0===t.length)e.push(i);else for(const n of t)e.push(i.child(n))}else e.push(i)})),new B(e)}class lt{constructor(t,e,n,i,r){this.key=t,this.documentType=e,this.version=n,this.data=i,this.documentState=r}static newInvalidDocument(t){return new lt(t,0,P.min(),ct.empty(),0)}static newFoundDocument(t,e,n){return new lt(t,1,e,n,0)}static newNoDocument(t,e){return new lt(t,2,e,ct.empty(),0)}static newUnknownDocument(t,e){return new lt(t,3,e,ct.empty(),2)}convertToFoundDocument(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=ct.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=ct.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof lt&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}clone(){return new lt(this.key,this.documentType,this.version,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class ht{constructor(t,e=null,n=[],i=[],r=null,s=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=s,this.endAt=o,this.A=null}}function dt(t,e=null,n=[],i=[],r=null,s=null,o=null){return new ht(t,e,n,i,r,s,o)}function ft(t){const e=v(t);if(null===e.A){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((t=>function(t){return t.field.canonicalString()+t.op.toString()+nt(t.value)}(t))).join(","),t+="|ob:",t+=e.orderBy.map((t=>function(t){return t.field.canonicalString()+t.dir}(t))).join(","),W(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=St(e.startAt)),e.endAt&&(t+="|ub:",t+=St(e.endAt)),e.A=t}return e.A}function pt(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!kt(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(n=t.filters[r],i=e.filters[r],n.op!==i.op||!n.field.isEqual(i.field)||!Y(n.value,i.value))return!1;var n,i;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Nt(t.startAt,e.startAt)&&Nt(t.endAt,e.endAt)}class gt extends class{}{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.R(t,e,n):new mt(t,e,n):"array-contains"===e?new bt(t,n):"in"===e?new _t(t,n):"not-in"===e?new It(t,n):"array-contains-any"===e?new Tt(t,n):new gt(t,e,n)}static R(t,e,n){return"in"===e?new yt(t,n):new vt(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.P(tt(e,this.value)):null!==e&&J(this.value)===J(e)&&this.P(tt(e,this.value))}P(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return m()}}v(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class mt extends gt{constructor(t,e,n){super(t,e,n),this.key=Q.fromName(n.referenceValue)}matches(t){const e=Q.comparator(t.key,this.key);return this.P(e)}}class yt extends gt{constructor(t,e){super(t,"in",e),this.keys=wt(0,e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class vt extends gt{constructor(t,e){super(t,"not-in",e),this.keys=wt(0,e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function wt(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((t=>Q.fromName(t.referenceValue)))}class bt extends gt{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return st(e)&&Z(e.arrayValue,this.value)}}class _t extends gt{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&Z(this.value.arrayValue,e)}}class It extends gt{constructor(t,e){super(t,"not-in",e)}matches(t){if(Z(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!Z(this.value.arrayValue,e)}}class Tt extends gt{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!st(e)||!e.arrayValue.values)&&e.arrayValue.values.some((t=>Z(this.value.arrayValue,t)))}}class Et{constructor(t,e){this.position=t,this.before=e}}function St(t){return`${t.before?"b":"a"}:${t.position.map((t=>nt(t))).join(",")}`}class At{constructor(t,e="asc"){this.field=t,this.dir=e}}function kt(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function Rt(t,e,n){let i=0;for(let r=0;r<t.position.length;r++){const s=e[r],o=t.position[r];if(i=s.field.isKeyField()?Q.comparator(Q.fromName(o.referenceValue),n.key):tt(o,n.data.field(s.field)),"desc"===s.dir&&(i*=-1),0!==i)break}return t.before?i<=0:i<0}function Nt(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Y(t.position[n],e.position[n]))return!1;return!0}class Ct{constructor(t,e=null,n=[],i=[],r=null,s="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=i,this.limit=r,this.limitType=s,this.startAt=o,this.endAt=a,this.V=null,this.S=null,this.startAt,this.endAt}}function Ot(t){const e=v(t);if(null===e.V){e.V=[];const t=function(t){for(const e of t.filters)if(e.v())return e.field;return null}(e),n=function(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}(e);if(null!==t&&null===n)t.isKeyField()||e.V.push(new At(t)),e.V.push(new At(j.keyField(),"asc"));else{let t=!1;for(const n of e.explicitOrderBy)e.V.push(n),n.field.isKeyField()&&(t=!0);if(!t){const t=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.V.push(new At(j.keyField(),t))}}}return e.V}function Dt(t){const e=v(t);if(!e.S)if("F"===e.limitType)e.S=dt(e.path,e.collectionGroup,Ot(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const n of Ot(e)){const e="desc"===n.dir?"asc":"desc";t.push(new At(n.field,e))}const n=e.endAt?new Et(e.endAt.position,!e.endAt.before):null,i=e.startAt?new Et(e.startAt.position,!e.startAt.before):null;e.S=dt(e.path,e.collectionGroup,t,e.filters,e.limit,n,i)}return e.S}function Pt(t,e){return pt(Dt(t),Dt(e))&&t.limitType===e.limitType}function Lt(t){return`${ft(Dt(t))}|lt:${t.limitType}`}function xt(t){return`Query(target=${function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map((t=>{return`${(e=t).field.canonicalString()} ${e.op} ${nt(e.value)}`;var e})).join(", ")}]`),W(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map((t=>function(t){return`${t.field.canonicalString()} (${t.dir})`}(t))).join(", ")}]`),t.startAt&&(e+=", startAt: "+St(t.startAt)),t.endAt&&(e+=", endAt: "+St(t.endAt)),`Target(${e})`}(Dt(t))}; limitType=${t.limitType})`}function Mt(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):Q.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of t.explicitOrderBy)if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!Rt(t.startAt,Ot(t),e)||t.endAt&&Rt(t.endAt,Ot(t),e))}(t,e)}function Ut(t,e,n){const i=t.field.isKeyField()?Q.comparator(e.key,n.key):function(t,e,n){const i=e.data.field(t),r=n.data.field(t);return null!==i&&null!==r?tt(i,r):m()}(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return m()}}function Ft(t,e){if(t.D){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:X(e)?"-0":e}}function Vt(t){return{integerValue:""+t}}function jt(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!X(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?Vt(e):Ft(t,e)}class Bt{constructor(){this._=void 0}}function Ht(t,e,n){return t instanceof zt?function(t,e){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof $t?Gt(t,e):t instanceof Wt?Xt(t,e):function(t,e){const n=qt(t,e),i=Jt(n)+Jt(t.C);return rt(n)&&rt(t.C)?Vt(i):Ft(t.N,i)}(t,e)}function Kt(t,e,n){return t instanceof $t?Gt(t,e):t instanceof Wt?Xt(t,e):n}function qt(t,e){return t instanceof Qt?rt(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}class zt extends Bt{}class $t extends Bt{constructor(t){super(),this.elements=t}}function Gt(t,e){const n=Yt(e);for(const e of t.elements)n.some((t=>Y(t,e)))||n.push(e);return{arrayValue:{values:n}}}class Wt extends Bt{constructor(t){super(),this.elements=t}}function Xt(t,e){let n=Yt(e);for(const e of t.elements)n=n.filter((t=>!Y(t,e)));return{arrayValue:{values:n}}}class Qt extends Bt{constructor(t,e){super(),this.N=t,this.C=e}}function Jt(t){return z(t.integerValue||t.doubleValue)}function Yt(t){return st(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class Zt{constructor(t,e){this.field=t,this.transform=e}}class te{constructor(t,e){this.version=t,this.transformResults=e}}class ee{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new ee}static exists(t){return new ee(void 0,t)}static updateTime(t){return new ee(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function ne(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class ie{}function re(t,e,n){t instanceof ue?function(t,e,n){const i=t.value.clone(),r=de(t.fieldTransforms,e,n.transformResults);i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(t,e,n):t instanceof le?function(t,e,n){if(!ne(t.precondition,e))return void e.convertToUnknownDocument(n.version);const i=de(t.fieldTransforms,e,n.transformResults),r=e.data;r.setAll(he(t)),r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function se(t,e,n){t instanceof ue?function(t,e,n){if(!ne(t.precondition,e))return;const i=t.value.clone(),r=fe(t.fieldTransforms,n,e);i.setAll(r),e.convertToFoundDocument(ce(e),i).setHasLocalMutations()}(t,e,n):t instanceof le?function(t,e,n){if(!ne(t.precondition,e))return;const i=fe(t.fieldTransforms,n,e),r=e.data;r.setAll(he(t)),r.setAll(i),e.convertToFoundDocument(ce(e),r).setHasLocalMutations()}(t,e,n):function(t,e){ne(t.precondition,e)&&e.convertToNoDocument(P.min())}(t,e)}function oe(t,e){let n=null;for(const i of t.fieldTransforms){const t=e.data.field(i.field),r=qt(i.transform,t||null);null!=r&&(null==n&&(n=ct.empty()),n.set(i.field,r))}return n||null}function ae(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&O(t,e,((t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof $t&&e instanceof $t||t instanceof Wt&&e instanceof Wt?O(t.elements,e.elements,Y):t instanceof Qt&&e instanceof Qt?Y(t.C,e.C):t instanceof zt&&e instanceof zt}(t.transform,e.transform)}(t,e)))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function ce(t){return t.isFoundDocument()?t.version:P.min()}class ue extends ie{constructor(t,e,n,i=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=i,this.type=0}}class le extends ie{constructor(t,e,n,i,r=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=i,this.fieldTransforms=r,this.type=1}}function he(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}})),e}function de(t,e,n){const i=new Map;y(t.length===n.length);for(let r=0;r<n.length;r++){const s=t[r],o=s.transform,a=e.data.field(s.field);i.set(s.field,Kt(o,a,n[r]))}return i}function fe(t,e,n){const i=new Map;for(const r of t){const t=r.transform,s=n.data.field(r.field);i.set(r.field,Ht(t,s,e))}return i}class pe extends ie{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}}class ge extends ie{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}}var me,ye;(ye=me||(me={}))[ye.OK=0]="OK",ye[ye.CANCELLED=1]="CANCELLED",ye[ye.UNKNOWN=2]="UNKNOWN",ye[ye.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ye[ye.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ye[ye.NOT_FOUND=5]="NOT_FOUND",ye[ye.ALREADY_EXISTS=6]="ALREADY_EXISTS",ye[ye.PERMISSION_DENIED=7]="PERMISSION_DENIED",ye[ye.UNAUTHENTICATED=16]="UNAUTHENTICATED",ye[ye.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ye[ye.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ye[ye.ABORTED=10]="ABORTED",ye[ye.OUT_OF_RANGE=11]="OUT_OF_RANGE",ye[ye.UNIMPLEMENTED=12]="UNIMPLEMENTED",ye[ye.INTERNAL=13]="INTERNAL",ye[ye.UNAVAILABLE=14]="UNAVAILABLE",ye[ye.DATA_LOSS=15]="DATA_LOSS";class ve{constructor(t,e){this.comparator=t,this.root=e||be.EMPTY}insert(t,e){return new ve(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,be.BLACK,null,null))}remove(t){return new ve(this.comparator,this.root.remove(t,this.comparator).copy(null,null,be.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(0===i)return e+n.left.size;i<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new we(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new we(this.root,t,this.comparator,!1)}getReverseIterator(){return new we(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new we(this.root,t,this.comparator,!0)}}class we{constructor(t,e,n,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!t.isEmpty();)if(r=e?n(t.key,e):1,i&&(r*=-1),r<0)t=this.isReverse?t.left:t.right;else{if(0===r){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class be{constructor(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:be.RED,this.left=null!=i?i:be.EMPTY,this.right=null!=r?r:be.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,i,r){return new be(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let i=this;const r=n(t,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return be.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===e(t,i.key)){if(i.right.isEmpty())return be.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,be.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,be.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw m();if(this.right.isRed())throw m();const t=this.left.check();if(t!==this.right.check())throw m();return t+(this.isRed()?0:1)}}be.EMPTY=null,be.RED=!0,be.BLACK=!1,be.EMPTY=new class{constructor(){this.size=0}get key(){throw m()}get value(){throw m()}get color(){throw m()}get left(){throw m()}get right(){throw m()}copy(t,e,n,i,r){return this}insert(t,e,n){return new be(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class _e{constructor(t){this.comparator=t,this.data=new ve(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new Ie(this.data.getIterator())}getIteratorFrom(t){return new Ie(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((t=>{e=e.add(t)})),e}isEqual(t){if(!(t instanceof _e))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(0!==this.comparator(t,i))return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new _e(this.comparator);return e.data=t,e}}class Ie{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}const Te=new ve(Q.comparator);function Ee(){return Te}const Se=new ve(Q.comparator);function Ae(){return Se}const ke=new ve(Q.comparator);const Re=new _e(Q.comparator);function Ne(...t){let e=Re;for(const n of t)e=e.add(n);return e}const Ce=new _e(C);class Oe{constructor(t,e){this.databaseId=t,this.D=e}}function De(t,e){return t.D?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Pe(t,e){return t.D?e.toBase64():e.toUint8Array()}function Le(t,e){return De(t,e.toTimestamp())}function xe(t){return y(!!t),P.fromTimestamp(function(t){const e=q(t);return new D(e.seconds,e.nanos)}(t))}function Me(t,e){return function(t){return new F(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function Ue(t,e){return Me(t.databaseId,e.path)}function Fe(t){const e=function(t){const e=F.fromString(t);return y(function(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}(e)),e}(t);return 4===e.length?F.emptyPath():function(t){return y(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}(e)}function Ve(t,e,n){return{name:Ue(t,e),fields:n.value.mapValue.fields}}function je(t){let e=Fe(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){y(1===i);const t=n.from[0];t.allDescendants?r=t.collectionId:e=e.child(t.collectionId)}let s=[];n.where&&(s=Be(n.where));let o=[];n.orderBy&&(o=n.orderBy.map((t=>function(t){return new At(Ke(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t))));let a=null;n.limit&&(a=function(t){let e;return e="object"==typeof t?t.value:t,W(e)?null:e}(n.limit));let c=null;n.startAt&&(c=He(n.startAt));let u=null;return n.endAt&&(u=He(n.endAt)),function(t,e,n,i,r,s,o,a){return new Ct(t,e,n,i,r,s,o,a)}(e,r,o,s,a,"F",c,u)}function Be(t){return t?void 0!==t.unaryFilter?[ze(t)]:void 0!==t.fieldFilter?[qe(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((t=>Be(t))).reduce(((t,e)=>t.concat(e))):m():[]}function He(t){const e=!!t.before,n=t.values||[];return new Et(n,e)}function Ke(t){return j.fromServerFormat(t.fieldPath)}function qe(t){return gt.create(Ke(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return m()}}(t.fieldFilter.op),t.fieldFilter.value)}function ze(t){switch(t.unaryFilter.op){case"IS_NAN":const e=Ke(t.unaryFilter.field);return gt.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=Ke(t.unaryFilter.field);return gt.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Ke(t.unaryFilter.field);return gt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=Ke(t.unaryFilter.field);return gt.create(r,"!=",{nullValue:"NULL_VALUE"});default:return m()}}function $e(t){const e=[];return t.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Ge(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=Xe(e)),e=We(t.get(n),e);return Xe(e)}function We(t,e){let n=e;const i=t.length;for(let e=0;e<i;e++){const i=t.charAt(e);switch(i){case"\0":n+="";break;case"":n+="";break;default:n+=i}}return n}function Xe(t){return t+""}class Qe{constructor(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n}}Qe.store="owner",Qe.key="owner";class Je{constructor(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}}Je.store="mutationQueues",Je.keyPath="userId";class Ye{constructor(t,e,n,i,r){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=i,this.mutations=r}}Ye.store="mutations",Ye.keyPath="batchId",Ye.userMutationsIndex="userMutationsIndex",Ye.userMutationsKeyPath=["userId","batchId"];class Ze{constructor(){}static prefixForUser(t){return[t]}static prefixForPath(t,e){return[t,Ge(e)]}static key(t,e,n){return[t,Ge(e),n]}}Ze.store="documentMutations",Ze.PLACEHOLDER=new Ze;class tn{constructor(t,e,n,i,r,s){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=i,this.readTime=r,this.parentPath=s}}tn.store="remoteDocuments",tn.readTimeIndex="readTimeIndex",tn.readTimeIndexPath="readTime",tn.collectionReadTimeIndex="collectionReadTimeIndex",tn.collectionReadTimeIndexPath=["parentPath","readTime"];class en{constructor(t){this.byteSize=t}}en.store="remoteDocumentGlobal",en.key="remoteDocumentGlobalKey";class nn{constructor(t,e,n,i,r,s,o){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=i,this.lastListenSequenceNumber=r,this.lastLimboFreeSnapshotVersion=s,this.query=o}}nn.store="targets",nn.keyPath="targetId",nn.queryTargetsIndexName="queryTargetsIndex",nn.queryTargetsKeyPath=["canonicalId","targetId"];class rn{constructor(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n}}rn.store="targetDocuments",rn.keyPath=["targetId","path"],rn.documentTargetsIndex="documentTargetsIndex",rn.documentTargetsKeyPath=["path","targetId"];class sn{constructor(t,e,n,i){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=i}}sn.key="targetGlobalKey",sn.store="targetGlobal";class on{constructor(t,e){this.collectionId=t,this.parent=e}}on.store="collectionParents",on.keyPath=["collectionId","parent"];class an{constructor(t,e,n,i){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=i}}an.store="clientMetadata",an.keyPath="clientId";class cn{constructor(t,e,n){this.bundleId=t,this.createTime=e,this.version=n}}cn.store="bundles",cn.keyPath="bundleId";class un{constructor(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n}}un.store="namedQueries",un.keyPath="name",Je.store,Ye.store,Ze.store,tn.store,nn.store,Qe.store,sn.store,rn.store,an.store,en.store,on.store,cn.store,un.store;const ln="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class hn{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}class dn{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&m(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new dn(((n,i)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,i)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,i)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof dn?e:dn.resolve(e)}catch(t){return dn.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):dn.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):dn.reject(e)}static resolve(t){return new dn(((e,n)=>{e(t)}))}static reject(t){return new dn(((e,n)=>{n(t)}))}static waitFor(t){return new dn(((e,n)=>{let i=0,r=0,s=!1;t.forEach((t=>{++i,t.next((()=>{++r,s&&r===i&&e()}),(t=>n(t)))})),s=!0,r===i&&e()}))}static or(t){let e=dn.resolve(!1);for(const n of t)e=e.next((t=>t?dn.resolve(t):n()));return e}static forEach(t,e){const n=[];return t.forEach(((t,i)=>{n.push(e.call(this,t,i))})),this.waitFor(n)}}function fn(t){return"IndexedDbTransactionError"===t.name}class pn{constructor(t,e,n,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let e=0;e<this.mutations.length;e++){const i=this.mutations[e];i.key.isEqual(t.key)&&re(i,t,n[e])}}applyToLocalView(t){for(const e of this.baseMutations)e.key.isEqual(t.key)&&se(e,t,this.localWriteTime);for(const e of this.mutations)e.key.isEqual(t.key)&&se(e,t,this.localWriteTime)}applyToLocalDocumentSet(t){this.mutations.forEach((e=>{const n=t.get(e.key),i=n;this.applyToLocalView(i),n.isValidDocument()||i.convertToNoDocument(P.min())}))}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),Ne())}isEqual(t){return this.batchId===t.batchId&&O(this.mutations,t.mutations,((t,e)=>ae(t,e)))&&O(this.baseMutations,t.baseMutations,((t,e)=>ae(t,e)))}}class gn{constructor(t,e,n,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=i}static from(t,e,n){y(t.mutations.length===n.length);let i=ke;const r=t.mutations;for(let t=0;t<r.length;t++)i=i.insert(r[t].key,n[t].version);return new gn(t,e,n,i)}}class mn{constructor(t){this.Wt=t}}function yn(t){const e=je({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?function(t,e,n){return new Ct(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}(e,e.limit,"L"):e}class vn{constructor(){this.Gt=new wn}addToCollectionParentIndex(t,e){return this.Gt.add(e),dn.resolve()}getCollectionParents(t,e){return dn.resolve(this.Gt.getEntries(e))}}class wn{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e]||new _e(F.comparator),r=!i.has(n);return this.index[e]=i.add(n),r}has(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e];return i&&i.has(n)}getEntries(t){return(this.index[t]||new _e(F.comparator)).toArray()}}class bn{constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}static withCacheSize(t){return new bn(t,bn.DEFAULT_COLLECTION_PERCENTILE,bn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}bn.DEFAULT_COLLECTION_PERCENTILE=10,bn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,bn.DEFAULT=new bn(41943040,bn.DEFAULT_COLLECTION_PERCENTILE,bn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),bn.DISABLED=new bn(-1,0,0);class _n{constructor(t){this.ne=t}next(){return this.ne+=2,this.ne}static se(){return new _n(0)}static ie(){return new _n(-1)}}async function In(t){if(t.code!==w.FAILED_PRECONDITION||t.message!==ln)throw t;d("LocalStore","Unexpectedly lost primary lease")}class Tn{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[e,i]of n)if(this.equalsFn(e,t))return i}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),i=this.inner[n];if(void 0!==i){for(let n=0;n<i.length;n++)if(this.equalsFn(i[n][0],t))return void(i[n]=[t,e]);i.push([t,e])}else this.inner[n]=[[t,e]]}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return 1===n.length?delete this.inner[e]:n.splice(i,1),!0;return!1}forEach(t){x(this.inner,((e,n)=>{for(const[e,i]of n)t(e,i)}))}isEmpty(){return M(this.inner)}}class En{constructor(){this.changes=new Tn((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}getReadTime(t){const e=this.changes.get(t);return e?e.readTime:P.min()}addEntry(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})}removeEntry(t,e=null){this.assertNotApplied(),this.changes.set(t,{document:lt.newInvalidDocument(t),readTime:e})}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?dn.resolve(n.document):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class Sn{constructor(t,e,n){this.He=t,this.In=e,this.Ht=n}An(t,e){return this.In.getAllMutationBatchesAffectingDocumentKey(t,e).next((n=>this.Rn(t,e,n)))}Rn(t,e,n){return this.He.getEntry(t,e).next((t=>{for(const e of n)e.applyToLocalView(t);return t}))}Pn(t,e){t.forEach(((t,n)=>{for(const t of e)t.applyToLocalView(n)}))}bn(t,e){return this.He.getEntries(t,e).next((e=>this.vn(t,e).next((()=>e))))}vn(t,e){return this.In.getAllMutationBatchesAffectingDocumentKeys(t,e).next((t=>this.Pn(e,t)))}getDocumentsMatchingQuery(t,e,n){return function(t){return Q.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Vn(t,e.path):function(t){return null!==t.collectionGroup}(e)?this.Sn(t,e,n):this.Dn(t,e,n)}Vn(t,e){return this.An(t,new Q(e)).next((t=>{let e=Ae();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))}Sn(t,e,n){const i=e.collectionGroup;let r=Ae();return this.Ht.getCollectionParents(t,i).next((s=>dn.forEach(s,(s=>{const o=function(t,e){return new Ct(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return this.Dn(t,o,n).next((t=>{t.forEach(((t,e)=>{r=r.insert(t,e)}))}))})).next((()=>r))))}Dn(t,e,n){let i,r;return this.He.getDocumentsMatchingQuery(t,e,n).next((n=>(i=n,this.In.getAllMutationBatchesAffectingQuery(t,e)))).next((e=>(r=e,this.Cn(t,r,i).next((t=>{i=t;for(const t of r)for(const e of t.mutations){const n=e.key;let r=i.get(n);null==r&&(r=lt.newInvalidDocument(n),i=i.insert(n,r)),se(e,r,t.localWriteTime),r.isFoundDocument()||(i=i.remove(n))}}))))).next((()=>(i.forEach(((t,n)=>{Mt(e,n)||(i=i.remove(t))})),i)))}Cn(t,e,n){let i=Ne();for(const t of e)for(const e of t.mutations)e instanceof le&&null===n.get(e.key)&&(i=i.add(e.key));let r=n;return this.He.getEntries(t,i).next((t=>(t.forEach(((t,e)=>{e.isFoundDocument()&&(r=r.insert(t,e))})),r)))}}class An{constructor(t,e,n,i){this.targetId=t,this.fromCache=e,this.Nn=n,this.xn=i}static kn(t,e){let n=Ne(),i=Ne();for(const t of e.docChanges)switch(t.type){case 0:n=n.add(t.doc.key);break;case 1:i=i.add(t.doc.key)}return new An(t,e.fromCache,n,i)}}class kn{$n(t){this.On=t}getDocumentsMatchingQuery(t,e,n,i){return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(P.min())?this.Fn(t,e):this.On.bn(t,i).next((r=>{const o=this.Mn(e,r);return(function(t){return!W(t.limit)&&"F"===t.limitType}(e)||function(t){return!W(t.limit)&&"L"===t.limitType}(e))&&this.Ln(e.limitType,o,i,n)?this.Fn(t,e):(h()<=s.$b.DEBUG&&d("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),xt(e)),this.On.getDocumentsMatchingQuery(t,e,n).next((t=>(o.forEach((e=>{t=t.insert(e.key,e)})),t))))}))}Mn(t,e){let n=new _e(function(t){return(e,n)=>{let i=!1;for(const r of Ot(t)){const t=Ut(r,e,n);if(0!==t)return t;i=i||r.field.isKeyField()}return 0}}(t));return e.forEach(((e,i)=>{Mt(t,i)&&(n=n.add(i))})),n}Ln(t,e,n,i){if(n.size!==e.size)return!0;const r="F"===t?e.last():e.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}Fn(t,e){return h()<=s.$b.DEBUG&&d("QueryEngine","Using full collection scan to execute query:",xt(e)),this.On.getDocumentsMatchingQuery(t,e,P.min())}}class Rn{constructor(t,e,n,i){this.persistence=t,this.Bn=e,this.N=i,this.Un=new ve(C),this.qn=new Tn((t=>ft(t)),pt),this.Kn=P.min(),this.In=t.getMutationQueue(n),this.jn=t.getRemoteDocumentCache(),this.ze=t.getTargetCache(),this.Qn=new Sn(this.jn,this.In,this.persistence.getIndexManager()),this.Je=t.getBundleCache(),this.Bn.$n(this.Qn)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.Un)))}}async function Nn(t,e){const n=v(t);let i=n.In,r=n.Qn;const s=await n.persistence.runTransaction("Handle user change","readonly",(t=>{let s;return n.In.getAllMutationBatches(t).next((o=>(s=o,i=n.persistence.getMutationQueue(e),r=new Sn(n.jn,i,n.persistence.getIndexManager()),i.getAllMutationBatches(t)))).next((e=>{const n=[],i=[];let o=Ne();for(const t of s){n.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}for(const t of e){i.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}return r.bn(t,o).next((t=>({Wn:t,removedBatchIds:n,addedBatchIds:i})))}))}));return n.In=i,n.Qn=r,n.Bn.$n(n.Qn),s}function Cn(t,e){const n=v(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(t=>(void 0===e&&(e=-1),n.In.getNextMutationBatchAfterBatchId(t,e))))}class On{constructor(t){this.N=t,this.Yn=new Map,this.Xn=new Map}getBundleMetadata(t,e){return dn.resolve(this.Yn.get(e))}saveBundleMetadata(t,e){var n;return this.Yn.set(e.id,{id:(n=e).id,version:n.version,createTime:xe(n.createTime)}),dn.resolve()}getNamedQuery(t,e){return dn.resolve(this.Xn.get(e))}saveNamedQuery(t,e){return this.Xn.set(e.name,function(t){return{name:t.name,query:yn(t.bundledQuery),readTime:xe(t.readTime)}}(e)),dn.resolve()}}class Dn{constructor(){this.Zn=new _e(Pn.ts),this.es=new _e(Pn.ns)}isEmpty(){return this.Zn.isEmpty()}addReference(t,e){const n=new Pn(t,e);this.Zn=this.Zn.add(n),this.es=this.es.add(n)}ss(t,e){t.forEach((t=>this.addReference(t,e)))}removeReference(t,e){this.rs(new Pn(t,e))}os(t,e){t.forEach((t=>this.removeReference(t,e)))}cs(t){const e=new Q(new F([])),n=new Pn(e,t),i=new Pn(e,t+1),r=[];return this.es.forEachInRange([n,i],(t=>{this.rs(t),r.push(t.key)})),r}us(){this.Zn.forEach((t=>this.rs(t)))}rs(t){this.Zn=this.Zn.delete(t),this.es=this.es.delete(t)}hs(t){const e=new Q(new F([])),n=new Pn(e,t),i=new Pn(e,t+1);let r=Ne();return this.es.forEachInRange([n,i],(t=>{r=r.add(t.key)})),r}containsKey(t){const e=new Pn(t,0),n=this.Zn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class Pn{constructor(t,e){this.key=t,this.ls=e}static ts(t,e){return Q.comparator(t.key,e.key)||C(t.ls,e.ls)}static ns(t,e){return C(t.ls,e.ls)||Q.comparator(t.key,e.key)}}class Ln{constructor(t,e){this.Ht=t,this.referenceDelegate=e,this.In=[],this.fs=1,this.ds=new _e(Pn.ts)}checkEmpty(t){return dn.resolve(0===this.In.length)}addMutationBatch(t,e,n,i){const r=this.fs;this.fs++,this.In.length>0&&this.In[this.In.length-1];const s=new pn(r,e,n,i);this.In.push(s);for(const e of i)this.ds=this.ds.add(new Pn(e.key,r)),this.Ht.addToCollectionParentIndex(t,e.key.path.popLast());return dn.resolve(s)}lookupMutationBatch(t,e){return dn.resolve(this.ws(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,i=this._s(n),r=i<0?0:i;return dn.resolve(this.In.length>r?this.In[r]:null)}getHighestUnacknowledgedBatchId(){return dn.resolve(0===this.In.length?-1:this.fs-1)}getAllMutationBatches(t){return dn.resolve(this.In.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new Pn(e,0),i=new Pn(e,Number.POSITIVE_INFINITY),r=[];return this.ds.forEachInRange([n,i],(t=>{const e=this.ws(t.ls);r.push(e)})),dn.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new _e(C);return e.forEach((t=>{const e=new Pn(t,0),i=new Pn(t,Number.POSITIVE_INFINITY);this.ds.forEachInRange([e,i],(t=>{n=n.add(t.ls)}))})),dn.resolve(this.gs(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,i=n.length+1;let r=n;Q.isDocumentKey(r)||(r=r.child(""));const s=new Pn(new Q(r),0);let o=new _e(C);return this.ds.forEachWhile((t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===i&&(o=o.add(t.ls)),!0)}),s),dn.resolve(this.gs(o))}gs(t){const e=[];return t.forEach((t=>{const n=this.ws(t);null!==n&&e.push(n)})),e}removeMutationBatch(t,e){y(0===this.ys(e.batchId,"removed")),this.In.shift();let n=this.ds;return dn.forEach(e.mutations,(i=>{const r=new Pn(i.key,e.batchId);return n=n.delete(r),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((()=>{this.ds=n}))}te(t){}containsKey(t,e){const n=new Pn(e,0),i=this.ds.firstAfterOrEqual(n);return dn.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return this.In.length,dn.resolve()}ys(t,e){return this._s(t)}_s(t){return 0===this.In.length?0:t-this.In[0].batchId}ws(t){const e=this._s(t);return e<0||e>=this.In.length?null:this.In[e]}}class xn{constructor(t,e){this.Ht=t,this.ps=e,this.docs=new ve(Q.comparator),this.size=0}addEntry(t,e,n){const i=e.key,r=this.docs.get(i),s=r?r.size:0,o=this.ps(e);return this.docs=this.docs.insert(i,{document:e.clone(),size:o,readTime:n}),this.size+=o-s,this.Ht.addToCollectionParentIndex(t,i.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return dn.resolve(n?n.document.clone():lt.newInvalidDocument(e))}getEntries(t,e){let n=Ee();return e.forEach((t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.clone():lt.newInvalidDocument(t))})),dn.resolve(n)}getDocumentsMatchingQuery(t,e,n){let i=Ee();const r=new Q(e.path.child("")),s=this.docs.getIteratorFrom(r);for(;s.hasNext();){const{key:t,value:{document:r,readTime:o}}=s.getNext();if(!e.path.isPrefixOf(t.path))break;o.compareTo(n)<=0||Mt(e,r)&&(i=i.insert(r.key,r.clone()))}return dn.resolve(i)}Es(t,e){return dn.forEach(this.docs,(t=>e(t)))}newChangeBuffer(t){return new Mn(this)}getSize(t){return dn.resolve(this.size)}}class Mn extends En{constructor(t){super(),this.Se=t}applyChanges(t){const e=[];return this.changes.forEach(((n,i)=>{i.document.isValidDocument()?e.push(this.Se.addEntry(t,i.document,this.getReadTime(n))):this.Se.removeEntry(n)})),dn.waitFor(e)}getFromCache(t,e){return this.Se.getEntry(t,e)}getAllFromCache(t,e){return this.Se.getEntries(t,e)}}class Un{constructor(t){this.persistence=t,this.Ts=new Tn((t=>ft(t)),pt),this.lastRemoteSnapshotVersion=P.min(),this.highestTargetId=0,this.Is=0,this.As=new Dn,this.targetCount=0,this.Rs=_n.se()}forEachTarget(t,e){return this.Ts.forEach(((t,n)=>e(n))),dn.resolve()}getLastRemoteSnapshotVersion(t){return dn.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return dn.resolve(this.Is)}allocateTargetId(t){return this.highestTargetId=this.Rs.next(),dn.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Is&&(this.Is=e),dn.resolve()}ae(t){this.Ts.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.Rs=new _n(e),this.highestTargetId=e),t.sequenceNumber>this.Is&&(this.Is=t.sequenceNumber)}addTargetData(t,e){return this.ae(e),this.targetCount+=1,dn.resolve()}updateTargetData(t,e){return this.ae(e),dn.resolve()}removeTargetData(t,e){return this.Ts.delete(e.target),this.As.cs(e.targetId),this.targetCount-=1,dn.resolve()}removeTargets(t,e,n){let i=0;const r=[];return this.Ts.forEach(((s,o)=>{o.sequenceNumber<=e&&null===n.get(o.targetId)&&(this.Ts.delete(s),r.push(this.removeMatchingKeysForTargetId(t,o.targetId)),i++)})),dn.waitFor(r).next((()=>i))}getTargetCount(t){return dn.resolve(this.targetCount)}getTargetData(t,e){const n=this.Ts.get(e)||null;return dn.resolve(n)}addMatchingKeys(t,e,n){return this.As.ss(e,n),dn.resolve()}removeMatchingKeys(t,e,n){this.As.os(e,n);const i=this.persistence.referenceDelegate,r=[];return i&&e.forEach((e=>{r.push(i.markPotentiallyOrphaned(t,e))})),dn.waitFor(r)}removeMatchingKeysForTargetId(t,e){return this.As.cs(e),dn.resolve()}getMatchingKeysForTargetId(t,e){const n=this.As.hs(e);return dn.resolve(n)}containsKey(t,e){return dn.resolve(this.As.containsKey(e))}}class Fn{constructor(t,e){this.Ps={},this.Le=new k(0),this.Be=!1,this.Be=!0,this.referenceDelegate=t(this),this.ze=new Un(this),this.Ht=new vn,this.He=function(t,e){return new xn(t,e)}(this.Ht,(t=>this.referenceDelegate.bs(t))),this.N=new mn(e),this.Je=new On(this.N)}start(){return Promise.resolve()}shutdown(){return this.Be=!1,Promise.resolve()}get started(){return this.Be}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(){return this.Ht}getMutationQueue(t){let e=this.Ps[t.toKey()];return e||(e=new Ln(this.Ht,this.referenceDelegate),this.Ps[t.toKey()]=e),e}getTargetCache(){return this.ze}getRemoteDocumentCache(){return this.He}getBundleCache(){return this.Je}runTransaction(t,e,n){d("MemoryPersistence","Starting transaction:",t);const i=new Vn(this.Le.next());return this.referenceDelegate.vs(),n(i).next((t=>this.referenceDelegate.Vs(i).next((()=>t)))).toPromise().then((t=>(i.raiseOnCommittedEvent(),t)))}Ss(t,e){return dn.or(Object.values(this.Ps).map((n=>()=>n.containsKey(t,e))))}}class Vn extends hn{constructor(t){super(),this.currentSequenceNumber=t}}class jn{constructor(t){this.persistence=t,this.Ds=new Dn,this.Cs=null}static Ns(t){return new jn(t)}get xs(){if(this.Cs)return this.Cs;throw m()}addReference(t,e,n){return this.Ds.addReference(n,e),this.xs.delete(n.toString()),dn.resolve()}removeReference(t,e,n){return this.Ds.removeReference(n,e),this.xs.add(n.toString()),dn.resolve()}markPotentiallyOrphaned(t,e){return this.xs.add(e.toString()),dn.resolve()}removeTarget(t,e){this.Ds.cs(e.targetId).forEach((t=>this.xs.add(t.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((t=>{t.forEach((t=>this.xs.add(t.toString())))})).next((()=>n.removeTargetData(t,e)))}vs(){this.Cs=new Set}Vs(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return dn.forEach(this.xs,(n=>{const i=Q.fromPath(n);return this.ks(t,i).next((t=>{t||e.removeEntry(i)}))})).next((()=>(this.Cs=null,e.apply(t))))}updateLimboDocument(t,e){return this.ks(t,e).next((t=>{t?this.xs.delete(e.toString()):this.xs.add(e.toString())}))}bs(t){return 0}ks(t,e){return dn.or([()=>dn.resolve(this.Ds.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ss(t,e)])}}class Bn{constructor(){this.activeTargetIds=Ce}Fs(t){this.activeTargetIds=this.activeTargetIds.add(t)}Ms(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Os(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class Hn{constructor(){this.yi=new Bn,this.pi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t){return this.yi.Fs(t),this.pi[t]||"not-current"}updateQueryState(t,e,n){this.pi[t]=e}removeLocalQueryTarget(t){this.yi.Ms(t)}isLocalQueryTarget(t){return this.yi.activeTargetIds.has(t)}clearQueryState(t){delete this.pi[t]}getAllActiveQueryTargets(){return this.yi.activeTargetIds}isActiveQueryTarget(t){return this.yi.activeTargetIds.has(t)}start(){return this.yi=new Bn,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(){}}class Kn{Ei(t){}shutdown(){}}class qn{constructor(){this.Ti=()=>this.Ii(),this.Ai=()=>this.Ri(),this.Pi=[],this.bi()}Ei(t){this.Pi.push(t)}shutdown(){window.removeEventListener("online",this.Ti),window.removeEventListener("offline",this.Ai)}bi(){window.addEventListener("online",this.Ti),window.addEventListener("offline",this.Ai)}Ii(){d("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.Pi)t(0)}Ri(){d("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.Pi)t(1)}static Pt(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const zn={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class $n{constructor(t){this.vi=t.vi,this.Vi=t.Vi}Si(t){this.Di=t}Ci(t){this.Ni=t}onMessage(t){this.xi=t}close(){this.Vi()}send(t){this.vi(t)}ki(){this.Di()}$i(t){this.Ni(t)}Oi(t){this.xi(t)}}class Gn extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http";this.Fi=e+"://"+t.host,this.Mi="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}Li(t,e,n,i){const r=this.Bi(t,e);d("RestConnection","Sending: ",r,n);const s={};return this.Ui(s,i),this.qi(t,r,s,n).then((t=>(d("RestConnection","Received: ",t),t)),(e=>{throw p("RestConnection",`${t} failed with error: `,e,"url: ",r,"request:",n),e}))}Ki(t,e,n,i){return this.Li(t,e,n,i)}Ui(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/"+u,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(const n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])}Bi(t,e){const n=zn[t];return`${this.Fi}/v1/${e}:${n}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams}qi(t,e,n,i){return new Promise(((r,s)=>{const o=new a.ZS;o.listenOnce(a.Bx.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case a.O4.NO_ERROR:const e=o.getResponseJson();d("Connection","XHR received:",JSON.stringify(e)),r(e);break;case a.O4.TIMEOUT:d("Connection",'RPC "'+t+'" timed out'),s(new b(w.DEADLINE_EXCEEDED,"Request time out"));break;case a.O4.HTTP_ERROR:const n=o.getStatus();if(d("Connection",'RPC "'+t+'" failed with status:',n,"response text:",o.getResponseText()),n>0){const t=o.getResponseJson().error;if(t&&t.status&&t.message){const e=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(w).indexOf(e)>=0?e:w.UNKNOWN}(t.status);s(new b(e,t.message))}else s(new b(w.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new b(w.UNAVAILABLE,"Connection failed."));break;default:m()}}finally{d("Connection",'RPC "'+t+'" completed.')}}));const c=JSON.stringify(i);o.send(e,"POST",c,n,15)}))}ji(t,e){const n=[this.Fi,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=(0,a.fF)(),r=(0,a.Ao)(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(s.xmlHttpFactory=new a._L({})),this.Ui(s.initMessageHeaders,e),(0,o.jZ)()||(0,o.lV)()||(0,o.b8)()||(0,o.lT)()||(0,o.n4)()||(0,o.sr)()||(s.httpHeadersOverwriteParam="$httpHeaders");const c=n.join("");d("Connection","Creating WebChannel: "+c,s);const u=i.createWebChannel(c,s);let l=!1,h=!1;const g=new $n({vi:t=>{h?d("Connection","Not sending because WebChannel is closed:",t):(l||(d("Connection","Opening WebChannel transport."),u.open(),l=!0),d("Connection","WebChannel sending:",t),u.send(t))},Vi:()=>u.close()}),v=(t,e,n)=>{t.listen(e,(t=>{try{n(t)}catch(t){setTimeout((()=>{throw t}),0)}}))};return v(u,a.iO.EventType.OPEN,(()=>{h||d("Connection","WebChannel transport opened.")})),v(u,a.iO.EventType.CLOSE,(()=>{h||(h=!0,d("Connection","WebChannel transport closed"),g.$i())})),v(u,a.iO.EventType.ERROR,(t=>{h||(h=!0,p("Connection","WebChannel transport errored:",t),g.$i(new b(w.UNAVAILABLE,"The operation could not be completed")))})),v(u,a.iO.EventType.MESSAGE,(t=>{var e;if(!h){const n=t.data[0];y(!!n);const i=n,r=i.error||(null===(e=i[0])||void 0===e?void 0:e.error);if(r){d("Connection","WebChannel received error:",r);const t=r.status;let e=function(t){const e=me[t];if(void 0!==e)return function(t){if(void 0===t)return f("GRPC error has no .code"),w.UNKNOWN;switch(t){case me.OK:return w.OK;case me.CANCELLED:return w.CANCELLED;case me.UNKNOWN:return w.UNKNOWN;case me.DEADLINE_EXCEEDED:return w.DEADLINE_EXCEEDED;case me.RESOURCE_EXHAUSTED:return w.RESOURCE_EXHAUSTED;case me.INTERNAL:return w.INTERNAL;case me.UNAVAILABLE:return w.UNAVAILABLE;case me.UNAUTHENTICATED:return w.UNAUTHENTICATED;case me.INVALID_ARGUMENT:return w.INVALID_ARGUMENT;case me.NOT_FOUND:return w.NOT_FOUND;case me.ALREADY_EXISTS:return w.ALREADY_EXISTS;case me.PERMISSION_DENIED:return w.PERMISSION_DENIED;case me.FAILED_PRECONDITION:return w.FAILED_PRECONDITION;case me.ABORTED:return w.ABORTED;case me.OUT_OF_RANGE:return w.OUT_OF_RANGE;case me.UNIMPLEMENTED:return w.UNIMPLEMENTED;case me.DATA_LOSS:return w.DATA_LOSS;default:return m()}}(e)}(t),n=r.message;void 0===e&&(e=w.INTERNAL,n="Unknown error status: "+t+" with message "+r.message),h=!0,g.$i(new b(e,n)),u.close()}else d("Connection","WebChannel received:",n),g.Oi(n)}})),v(r,a.Jh.STAT_EVENT,(t=>{t.stat===a.ro.PROXY?d("Connection","Detected buffering proxy"):t.stat===a.ro.NOPROXY&&d("Connection","Detected no buffering proxy")})),setTimeout((()=>{g.ki()}),0),g}}function Wn(){return"undefined"!=typeof document?document:null}function Xn(t){return new Oe(t,!0)}class Qn{constructor(t,e,n=1e3,i=1.5,r=6e4){this.Oe=t,this.timerId=e,this.Qi=n,this.Wi=i,this.Gi=r,this.zi=0,this.Hi=null,this.Ji=Date.now(),this.reset()}reset(){this.zi=0}Yi(){this.zi=this.Gi}Xi(t){this.cancel();const e=Math.floor(this.zi+this.Zi()),n=Math.max(0,Date.now()-this.Ji),i=Math.max(0,e-n);i>0&&d("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.zi} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.Hi=this.Oe.enqueueAfterDelay(this.timerId,i,(()=>(this.Ji=Date.now(),t()))),this.zi*=this.Wi,this.zi<this.Qi&&(this.zi=this.Qi),this.zi>this.Gi&&(this.zi=this.Gi)}tr(){null!==this.Hi&&(this.Hi.skipDelay(),this.Hi=null)}cancel(){null!==this.Hi&&(this.Hi.cancel(),this.Hi=null)}Zi(){return(Math.random()-.5)*this.zi}}class Jn{constructor(t,e,n,i,r,s){this.Oe=t,this.er=n,this.nr=i,this.credentialsProvider=r,this.listener=s,this.state=0,this.sr=0,this.ir=null,this.stream=null,this.rr=new Qn(t,e)}ar(){return 1===this.state||2===this.state||4===this.state}cr(){return 2===this.state}start(){3!==this.state?this.auth():this.ur()}async stop(){this.ar()&&await this.close(0)}hr(){this.state=0,this.rr.reset()}lr(){this.cr()&&null===this.ir&&(this.ir=this.Oe.enqueueAfterDelay(this.er,6e4,(()=>this.dr())))}wr(t){this._r(),this.stream.send(t)}async dr(){if(this.cr())return this.close(0)}_r(){this.ir&&(this.ir.cancel(),this.ir=null)}async close(t,e){this._r(),this.rr.cancel(),this.sr++,3!==t?this.rr.reset():e&&e.code===w.RESOURCE_EXHAUSTED?(f(e.toString()),f("Using maximum backoff delay to prevent overloading the backend."),this.rr.Yi()):e&&e.code===w.UNAUTHENTICATED&&this.credentialsProvider.invalidateToken(),null!==this.stream&&(this.mr(),this.stream.close(),this.stream=null),this.state=t,await this.listener.Ci(e)}mr(){}auth(){this.state=1;const t=this.gr(this.sr),e=this.sr;this.credentialsProvider.getToken().then((t=>{this.sr===e&&this.yr(t)}),(e=>{t((()=>{const t=new b(w.UNKNOWN,"Fetching auth token failed: "+e.message);return this.pr(t)}))}))}yr(t){const e=this.gr(this.sr);this.stream=this.Er(t),this.stream.Si((()=>{e((()=>(this.state=2,this.listener.Si())))})),this.stream.Ci((t=>{e((()=>this.pr(t)))})),this.stream.onMessage((t=>{e((()=>this.onMessage(t)))}))}ur(){this.state=4,this.rr.Xi((async()=>{this.state=0,this.start()}))}pr(t){return d("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(3,t)}gr(t){return e=>{this.Oe.enqueueAndForget((()=>this.sr===t?e():(d("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Yn extends Jn{constructor(t,e,n,i,r){super(t,"write_stream_connection_backoff","write_stream_idle",e,n,r),this.N=i,this.Rr=!1}get Pr(){return this.Rr}start(){this.Rr=!1,this.lastStreamToken=void 0,super.start()}mr(){this.Rr&&this.br([])}Er(t){return this.nr.ji("Write",t)}onMessage(t){if(y(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Rr){this.rr.reset();const e=function(t,e){return t&&t.length>0?(y(void 0!==e),t.map((t=>function(t,e){let n=t.updateTime?xe(t.updateTime):xe(e);return n.isEqual(P.min())&&(n=xe(e)),new te(n,t.transformResults||[])}(t,e)))):[]}(t.writeResults,t.commitTime),n=xe(t.commitTime);return this.listener.vr(n,e)}return y(!t.writeResults||0===t.writeResults.length),this.Rr=!0,this.listener.Vr()}Sr(){const t={};t.database=function(t){return new F(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}(this.N),this.wr(t)}br(t){const e={streamToken:this.lastStreamToken,writes:t.map((t=>function(t,e){let n;if(e instanceof ue)n={update:Ve(t,e.key,e.value)};else if(e instanceof pe)n={delete:Ue(t,e.key)};else if(e instanceof le)n={update:Ve(t,e.key,e.data),updateMask:$e(e.fieldMask)};else{if(!(e instanceof ge))return m();n={verify:Ue(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((t=>function(t,e){const n=e.transform;if(n instanceof zt)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof $t)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Wt)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Qt)return{fieldPath:e.field.canonicalString(),increment:n.C};throw m()}(0,t)))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Le(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:m()}(t,e.precondition)),n}(this.N,t)))};this.wr(e)}}class Zn extends class{}{constructor(t,e,n){super(),this.credentials=t,this.nr=e,this.N=n,this.Dr=!1}Cr(){if(this.Dr)throw new b(w.FAILED_PRECONDITION,"The client has already been terminated.")}Li(t,e,n){return this.Cr(),this.credentials.getToken().then((i=>this.nr.Li(t,e,n,i))).catch((t=>{throw"FirebaseError"===t.name?(t.code===w.UNAUTHENTICATED&&this.credentials.invalidateToken(),t):new b(w.UNKNOWN,t.toString())}))}Ki(t,e,n){return this.Cr(),this.credentials.getToken().then((i=>this.nr.Ki(t,e,n,i))).catch((t=>{throw"FirebaseError"===t.name?(t.code===w.UNAUTHENTICATED&&this.credentials.invalidateToken(),t):new b(w.UNKNOWN,t.toString())}))}terminate(){this.Dr=!0}}class ti{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.Nr=0,this.kr=null,this.$r=!0}Or(){0===this.Nr&&(this.Fr("Unknown"),this.kr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.kr=null,this.Mr("Backend didn't respond within 10 seconds."),this.Fr("Offline"),Promise.resolve()))))}Lr(t){"Online"===this.state?this.Fr("Unknown"):(this.Nr++,this.Nr>=1&&(this.Br(),this.Mr(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.Fr("Offline")))}set(t){this.Br(),this.Nr=0,"Online"===t&&(this.$r=!1),this.Fr(t)}Fr(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}Mr(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.$r?(f(e),this.$r=!1):d("OnlineStateTracker",e)}Br(){null!==this.kr&&(this.kr.cancel(),this.kr=null)}}class ei{constructor(t,e,n,i,r){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.Ur=[],this.qr=new Map,this.Kr=new Set,this.jr=[],this.Qr=r,this.Qr.Ei((t=>{n.enqueueAndForget((async()=>{ri(this)&&(d("RemoteStore","Restarting streams for network reachability change."),await async function(t){const e=v(t);e.Kr.add(4),await ii(e),e.Wr.set("Unknown"),e.Kr.delete(4),await ni(e)}(this))}))})),this.Wr=new ti(n,i)}}async function ni(t){if(ri(t))for(const e of t.jr)await e(!0)}async function ii(t){for(const e of t.jr)await e(!1)}function ri(t){return 0===v(t).Kr.size}async function si(t,e,n){if(!fn(e))throw e;t.Kr.add(1),await ii(t),t.Wr.set("Offline"),n||(n=()=>function(t){const e=v(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.ze.getLastRemoteSnapshotVersion(t)))}(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{d("RemoteStore","Retrying IndexedDB access"),await n(),t.Kr.delete(1),await ni(t)}))}function oi(t,e){return e().catch((n=>si(t,n,e)))}async function ai(t){const e=v(t),n=mi(e);let i=e.Ur.length>0?e.Ur[e.Ur.length-1].batchId:-1;for(;ci(e);)try{const t=await Cn(e.localStore,i);if(null===t){0===e.Ur.length&&n.lr();break}i=t.batchId,ui(e,t)}catch(t){await si(e,t)}li(e)&&hi(e)}function ci(t){return ri(t)&&t.Ur.length<10}function ui(t,e){t.Ur.push(e);const n=mi(t);n.cr()&&n.Pr&&n.br(e.mutations)}function li(t){return ri(t)&&!mi(t).ar()&&t.Ur.length>0}function hi(t){mi(t).start()}async function di(t){mi(t).Sr()}async function fi(t){const e=mi(t);for(const n of t.Ur)e.br(n.mutations)}async function pi(t,e,n){const i=t.Ur.shift(),r=gn.from(i,e,n);await oi(t,(()=>t.remoteSyncer.applySuccessfulWrite(r))),await ai(t)}async function gi(t,e){e&&mi(t).Pr&&await async function(t,e){if(function(t){switch(t){case w.OK:return m();case w.CANCELLED:case w.UNKNOWN:case w.DEADLINE_EXCEEDED:case w.RESOURCE_EXHAUSTED:case w.INTERNAL:case w.UNAVAILABLE:case w.UNAUTHENTICATED:return!1;case w.INVALID_ARGUMENT:case w.NOT_FOUND:case w.ALREADY_EXISTS:case w.PERMISSION_DENIED:case w.FAILED_PRECONDITION:case w.ABORTED:case w.OUT_OF_RANGE:case w.UNIMPLEMENTED:case w.DATA_LOSS:return!0;default:return m()}}(n=e.code)&&n!==w.ABORTED){const n=t.Ur.shift();mi(t).hr(),await oi(t,(()=>t.remoteSyncer.rejectFailedWrite(n.batchId,e))),await ai(t)}var n}(t,e),li(t)&&hi(t)}function mi(t){return t.Hr||(t.Hr=function(t,e,n){const i=v(t);return i.Cr(),new Yn(e,i.nr,i.credentials,i.N,n)}(t.datastore,t.asyncQueue,{Si:di.bind(null,t),Ci:gi.bind(null,t),Vr:fi.bind(null,t),vr:pi.bind(null,t)}),t.jr.push((async e=>{e?(t.Hr.hr(),await ai(t)):(await t.Hr.stop(),t.Ur.length>0&&(d("RemoteStore",`Stopping write stream with ${t.Ur.length} pending writes`),t.Ur=[]))}))),t.Hr}class yi{constructor(t,e,n,i,r){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=i,this.removalCallback=r,this.deferred=new _,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((t=>{}))}static createAndSchedule(t,e,n,i,r){const s=Date.now()+n,o=new yi(t,e,s,i,r);return o.start(n),o}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new b(w.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function vi(t,e){if(f("AsyncQueue",`${e}: ${t}`),fn(t))return new b(w.UNAVAILABLE,`${e}: ${t}`);throw t}class wi{constructor(){this.queries=new Tn((t=>Lt(t)),Pt),this.onlineState="Unknown",this.Zr=new Set}}class bi{constructor(t,e,n,i,r,s){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=s,this.No={},this.xo=new Tn((t=>Lt(t)),Pt),this.ko=new Map,this.$o=new Set,this.Oo=new ve(Q.comparator),this.Fo=new Map,this.Mo=new Dn,this.Lo={},this.Bo=new Map,this.Uo=_n.ie(),this.onlineState="Unknown",this.qo=void 0}get isPrimaryClient(){return!0===this.qo}}function _i(t,e,n){const i=v(t);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const t=[];i.xo.forEach(((n,i)=>{const r=i.view.eo(e);r.snapshot&&t.push(r.snapshot)})),function(t,e){const n=v(t);n.onlineState=e;let i=!1;n.queries.forEach(((t,n)=>{for(const t of n.listeners)t.eo(e)&&(i=!0)})),i&&function(t){t.Zr.forEach((t=>{t.next()}))}(n)}(i.eventManager,e),t.length&&i.No.Tr(t),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function Ii(t,e){const n=v(t),i=e.batch.batchId;try{const t=await function(t,e){const n=v(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(t=>{const i=e.batch.keys(),r=n.jn.newChangeBuffer({trackRemovals:!0});return function(t,e,n,i){const r=n.batch,s=r.keys();let o=dn.resolve();return s.forEach((t=>{o=o.next((()=>i.getEntry(e,t))).next((e=>{const s=n.docVersions.get(t);y(null!==s),e.version.compareTo(s)<0&&(r.applyToRemoteDocument(e,n),e.isValidDocument()&&i.addEntry(e,n.commitVersion))}))})),o.next((()=>t.In.removeMutationBatch(e,r)))}(n,t,e,r).next((()=>r.apply(t))).next((()=>n.In.performConsistencyCheck(t))).next((()=>n.Qn.bn(t,i)))}))}(n.localStore,e);Si(n,i,null),Ei(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await Ai(n,t)}catch(t){await In(t)}}async function Ti(t,e,n){const i=v(t);try{const t=await function(t,e){const n=v(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(t=>{let i;return n.In.lookupMutationBatch(t,e).next((e=>(y(null!==e),i=e.keys(),n.In.removeMutationBatch(t,e)))).next((()=>n.In.performConsistencyCheck(t))).next((()=>n.Qn.bn(t,i)))}))}(i.localStore,e);Si(i,e,n),Ei(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await Ai(i,t)}catch(n){await In(n)}}function Ei(t,e){(t.Bo.get(e)||[]).forEach((t=>{t.resolve()})),t.Bo.delete(e)}function Si(t,e,n){const i=v(t);let r=i.Lo[i.currentUser.toKey()];if(r){const t=r.get(e);t&&(n?t.reject(n):t.resolve(),r=r.remove(e)),i.Lo[i.currentUser.toKey()]=r}}async function Ai(t,e,n){const i=v(t),r=[],s=[],o=[];i.xo.isEmpty()||(i.xo.forEach(((t,a)=>{o.push(i.Ko(a,e,n).then((t=>{if(t){i.isPrimaryClient&&i.sharedClientState.updateQueryState(a.targetId,t.fromCache?"not-current":"current"),r.push(t);const e=An.kn(a.targetId,t);s.push(e)}})))})),await Promise.all(o),i.No.Tr(r),await async function(t,e){const n=v(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(t=>dn.forEach(e,(e=>dn.forEach(e.Nn,(i=>n.persistence.referenceDelegate.addReference(t,e.targetId,i))).next((()=>dn.forEach(e.xn,(i=>n.persistence.referenceDelegate.removeReference(t,e.targetId,i)))))))))}catch(t){if(!fn(t))throw t;d("LocalStore","Failed to update sequence numbers: "+t)}for(const t of e){const e=t.targetId;if(!t.fromCache){const t=n.Un.get(e),i=t.snapshotVersion,r=t.withLastLimboFreeSnapshotVersion(i);n.Un=n.Un.insert(e,r)}}}(i.localStore,s))}async function ki(t,e){const n=v(t);if(!n.currentUser.isEqual(e)){d("SyncEngine","User change. New user:",e.toKey());const t=await Nn(n.localStore,e);n.currentUser=e,function(t){t.Bo.forEach((t=>{t.forEach((t=>{t.reject(new b(w.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Bo.clear()}(n),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await Ai(n,t.Wn)}}function Ri(t){const e=v(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Ii.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Ti.bind(null,e),e}class Ni{constructor(){this.synchronizeTabs=!1}async initialize(t){this.N=Xn(t.databaseInfo.databaseId),this.sharedClientState=this.Wo(t),this.persistence=this.Go(t),await this.persistence.start(),this.gcScheduler=this.zo(t),this.localStore=this.Ho(t)}zo(t){return null}Ho(t){return function(t,e,n,i){return new Rn(t,e,n,i)}(this.persistence,new kn,t.initialUser,this.N)}Go(t){return new Fn(jn.Ns,this.N)}Wo(t){return new Hn}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Ci{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>_i(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=ki.bind(null,this.syncEngine),await async function(t,e){const n=v(t);e?(n.Kr.delete(2),await ni(n)):e||(n.Kr.add(2),await ii(n),n.Wr.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new wi}createDatastore(t){const e=Xn(t.databaseInfo.databaseId),n=(i=t.databaseInfo,new Gn(i));var i;return function(t,e,n){return new Zn(t,e,n)}(t.credentials,n,e)}createRemoteStore(t){return e=this.localStore,n=this.datastore,i=t.asyncQueue,r=t=>_i(this.syncEngine,t,0),s=qn.Pt()?new qn:new Kn,new ei(e,n,i,r,s);var e,n,i,r,s}createSyncEngine(t,e){return function(t,e,n,i,r,s,o){const a=new bi(t,e,n,i,r,s);return o&&(a.qo=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}terminate(){return async function(t){const e=v(t);d("RemoteStore","RemoteStore shutting down."),e.Kr.add(5),await ii(e),e.Qr.shutdown(),e.Wr.set("Unknown")}(this.remoteStore)}}class Oi{constructor(t,e,n){this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=c.UNAUTHENTICATED,this.clientId=N.I(),this.credentialListener=()=>Promise.resolve(),this.credentials.start(e,(async t=>{d("FirestoreClient","Received user=",t.uid),await this.credentialListener(t),this.user=t}))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.credentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new b(w.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new _;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.credentials.shutdown(),t.resolve()}catch(e){const n=vi(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function Di(t,e){t.asyncQueue.verifyOperationInProgress();const n=await async function(t){return t.offlineComponents||(d("FirestoreClient","Using default OfflineComponentProvider"),await async function(t,e){t.asyncQueue.verifyOperationInProgress(),d("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener((async t=>{i.isEqual(t)||(await Nn(e.localStore,t),i=t)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t.offlineComponents=e}(t,new Ni)),t.offlineComponents}(t);d("FirestoreClient","Initializing OnlineComponentProvider");const i=await t.getConfiguration();await e.initialize(n,i),t.setCredentialChangeListener((t=>async function(t,e){const n=v(t);n.asyncQueue.verifyOperationInProgress(),d("RemoteStore","RemoteStore received new credentials");const i=ri(n);n.Kr.add(3),await ii(n),i&&n.Wr.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Kr.delete(3),await ni(n)}(e.remoteStore,t))),t.onlineComponents=e}function Pi(t){return async function(t){return t.onlineComponents||(d("FirestoreClient","Using default OnlineComponentProvider"),await Di(t,new Ci)),t.onlineComponents}(t).then((t=>t.syncEngine))}class Li{constructor(t,e,n,i,r,s,o,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=i,this.ssl=r,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.useFetchStreams=a}}class xi{constructor(t,e){this.projectId=t,this.database=e||"(default)"}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof xi&&t.projectId===this.projectId&&t.database===this.database}}const Mi=new Map;function Ui(t){if(!Q.isDocumentKey(t))throw new b(w.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Fi(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){if(t.constructor){const e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":m()}function Vi(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new b(w.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Fi(t);throw new b(w.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}class ji{constructor(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new b(w.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new b(w.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,function(t,e,n,i){if(!0===e&&!0===i)throw new b(w.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling)}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Bi{constructor(t,e){this._credentials=e,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ji({}),this._settingsFrozen=!1,t instanceof xi?this._databaseId=t:(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new b(w.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new xi(t.options.projectId)}(t))}get app(){if(!this._app)throw new b(w.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new b(w.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ji(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new T;switch(t.type){case"gapi":const e=t.client;return y(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new A(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new b(w.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=Mi.get(t);e&&(d("ComponentProvider","Removing Datastore"),Mi.delete(t),e.terminate())}(this),Promise.resolve()}}class Hi{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new qi(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Hi(this.firestore,t,this._key)}}class Ki{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new Ki(this.firestore,t,this._query)}}class qi extends Ki{constructor(t,e,n){super(t,e,function(t){return new Ct(t)}(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Hi(this.firestore,null,new Q(t))}withConverter(t){return new qi(this.firestore,t,this._path)}}function zi(t,e,...n){if(t=(0,o.Ku)(t),1===arguments.length&&(e=N.I()),function(t,e,n){if(!n)throw new b(w.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}("doc","path",e),t instanceof Bi){const i=F.fromString(e,...n);return Ui(i),new Hi(t,null,new Q(i))}{if(!(t instanceof Hi||t instanceof qi))throw new b(w.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(F.fromString(e,...n));return Ui(i),new Hi(t.firestore,t instanceof qi?t.converter:null,new Q(i))}}class $i{constructor(){this.fa=Promise.resolve(),this.da=[],this.wa=!1,this._a=[],this.ma=null,this.ga=!1,this.ya=!1,this.pa=[],this.rr=new Qn(this,"async_queue_retry"),this.Ea=()=>{const t=Wn();t&&d("AsyncQueue","Visibility state changed to "+t.visibilityState),this.rr.tr()};const t=Wn();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Ea)}get isShuttingDown(){return this.wa}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.Ta(),this.Ia(t)}enterRestrictedMode(t){if(!this.wa){this.wa=!0,this.ya=t||!1;const e=Wn();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Ea)}}enqueue(t){if(this.Ta(),this.wa)return new Promise((()=>{}));const e=new _;return this.Ia((()=>this.wa&&this.ya?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.da.push(t),this.Aa())))}async Aa(){if(0!==this.da.length){try{await this.da[0](),this.da.shift(),this.rr.reset()}catch(t){if(!fn(t))throw t;d("AsyncQueue","Operation failed with retryable error: "+t)}this.da.length>0&&this.rr.Xi((()=>this.Aa()))}}Ia(t){const e=this.fa.then((()=>(this.ga=!0,t().catch((t=>{throw this.ma=t,this.ga=!1,f("INTERNAL UNHANDLED ERROR: ",function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((t=>(this.ga=!1,t))))));return this.fa=e,e}enqueueAfterDelay(t,e,n){this.Ta(),this.pa.indexOf(t)>-1&&(e=0);const i=yi.createAndSchedule(this,t,e,n,(t=>this.Ra(t)));return this._a.push(i),i}Ta(){this.ma&&m()}verifyOperationInProgress(){}async Pa(){let t;do{t=this.fa,await t}while(t!==this.fa)}ba(t){for(const e of this._a)if(e.timerId===t)return!0;return!1}va(t){return this.Pa().then((()=>{this._a.sort(((t,e)=>t.targetTimeMs-e.targetTimeMs));for(const e of this._a)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.Pa()}))}Va(t){this.pa.push(t)}Ra(t){const e=this._a.indexOf(t);this._a.splice(e,1)}}class Gi extends Bi{constructor(t,e){super(t,e),this.type="firestore",this._queue=new $i,this._persistenceKey="name"in t?t.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||Xi(this),this._firestoreClient.terminate()}}function Wi(t=(0,i.Sx)()){return(0,i.j6)(t,"firestore").getImmediate()}function Xi(t){var e;const n=t._freezeSettings(),i=function(t,e,n,i){return new Li(t,e,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,i.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new Oi(t._credentials,t._queue,i)}class Qi{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new b(w.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new j(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class Ji{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Ji(H.fromBase64String(t))}catch(t){throw new b(w.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new Ji(H.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class Yi{constructor(t){this._methodName=t}}class Zi{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new b(w.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new b(w.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return C(this._lat,t._lat)||C(this._long,t._long)}}const tr=/^__.*__$/;class er{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return new le(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function nr(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw m()}}class ir{constructor(t,e,n,i,r,s){this.settings=t,this.databaseId=e,this.N=n,this.ignoreUndefinedProperties=i,void 0===r&&this.Sa(),this.fieldTransforms=r||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Da(){return this.settings.Da}Ca(t){return new ir(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.N,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Na(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Ca({path:n,xa:!1});return i.ka(t),i}$a(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Ca({path:n,xa:!1});return i.Sa(),i}Oa(t){return this.Ca({path:void 0,xa:!0})}Fa(t){return fr(t,this.settings.methodName,this.settings.Ma||!1,this.path,this.settings.La)}contains(t){return void 0!==this.fieldMask.find((e=>t.isPrefixOf(e)))||void 0!==this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))}Sa(){if(this.path)for(let t=0;t<this.path.length;t++)this.ka(this.path.get(t))}ka(t){if(0===t.length)throw this.Fa("Document fields must not be empty");if(nr(this.Da)&&tr.test(t))throw this.Fa('Document fields cannot begin and end with "__"')}}class rr{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.N=n||Xn(t)}Ba(t,e,n,i=!1){return new ir({Da:t,methodName:e,La:n,path:j.emptyPath(),xa:!1,Ma:i},this.databaseId,this.N,this.ignoreUndefinedProperties)}}class sr extends Yi{_toFieldTransform(t){if(2!==t.Da)throw 1===t.Da?t.Fa(`${this._methodName}() can only appear at the top level of your update data`):t.Fa(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof sr}}class or extends Yi{_toFieldTransform(t){return new Zt(t.path,new zt)}isEqual(t){return t instanceof or}}function ar(t,e){if(cr(t=(0,o.Ku)(t)))return ur("Unsupported field value:",e,t),function(t,e){const n={};return M(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):x(t,((t,i)=>{const r=ar(i,e.Na(t));null!=r&&(n[t]=r)})),{mapValue:{fields:n}}}(t,e);if(t instanceof Yi)return function(t,e){if(!nr(e.Da))throw e.Fa(`${t._methodName}() can only be used with update() and set()`);if(!e.path)throw e.Fa(`${t._methodName}() is not currently supported inside arrays`);const n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xa&&4!==e.Da)throw e.Fa("Nested arrays are not supported");return function(t,e){const n=[];let i=0;for(const r of t){let t=ar(r,e.Oa(i));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),i++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=(0,o.Ku)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return jt(e.N,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=D.fromDate(t);return{timestampValue:De(e.N,n)}}if(t instanceof D){const n=new D(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:De(e.N,n)}}if(t instanceof Zi)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Ji)return{bytesValue:Pe(e.N,t._byteString)};if(t instanceof Hi){const n=e.databaseId,i=t.firestore._databaseId;if(!i.isEqual(n))throw e.Fa(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Me(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Fa(`Unsupported field value: ${Fi(t)}`)}(t,e)}function cr(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof D||t instanceof Zi||t instanceof Ji||t instanceof Hi||t instanceof Yi)}function ur(t,e,n){if(!cr(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){const i=Fi(n);throw"an object"===i?e.Fa(t+" a custom object"):e.Fa(t+" "+i)}}function lr(t,e,n){if((e=(0,o.Ku)(e))instanceof Qi)return e._internalPath;if("string"==typeof e)return dr(t,e);throw fr("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}const hr=new RegExp("[~\\*/\\[\\]]");function dr(t,e,n){if(e.search(hr)>=0)throw fr(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Qi(...e.split("."))._internalPath}catch(i){throw fr(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function fr(t,e,n,i,r){const s=i&&!i.isEmpty(),o=void 0!==r;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${i}`),o&&(c+=` in document ${r}`),c+=")"),new b(w.INVALID_ARGUMENT,a+t+c)}function pr(t,e){return t.some((t=>t.isEqual(e)))}function gr(t,e,n,...i){t=Vi(t,Hi);const r=Vi(t.firestore,Gi),s=function(t){const e=t._freezeSettings(),n=Xn(t._databaseId);return new rr(t._databaseId,!!e.ignoreUndefinedProperties,n)}(r);let a;return a="string"==typeof(e=(0,o.Ku)(e))||e instanceof Qi?function(t,e,n,i,r,s){const a=t.Ba(1,e,n),c=[lr(e,i,n)],u=[r];if(s.length%2!=0)throw new b(w.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let t=0;t<s.length;t+=2)c.push(lr(e,s[t])),u.push(s[t+1]);const l=[],h=ct.empty();for(let t=c.length-1;t>=0;--t)if(!pr(l,c[t])){const e=c[t];let n=u[t];n=(0,o.Ku)(n);const i=a.$a(e);if(n instanceof sr)l.push(e);else{const t=ar(n,i);null!=t&&(l.push(e),h.set(e,t))}}const d=new B(l);return new er(h,d,a.fieldTransforms)}(s,"updateDoc",t._key,e,n,i):function(t,e,n,i){const r=t.Ba(1,e,n);ur("Data must be an object, but it was:",r,i);const s=[],a=ct.empty();x(i,((t,i)=>{const c=dr(e,t,n);i=(0,o.Ku)(i);const u=r.$a(c);if(i instanceof sr)s.push(c);else{const t=ar(i,u);null!=t&&(s.push(c),a.set(c,t))}}));const c=new B(s);return new er(a,c,r.fieldTransforms)}(s,"updateDoc",t._key,e),function(t,e){return function(t,e){const n=new _;return t.asyncQueue.enqueueAndForget((async()=>async function(t,e,n){const i=Ri(t);try{const t=await function(t,e){const n=v(t),i=D.now(),r=e.reduce(((t,e)=>t.add(e.key)),Ne());let s;return n.persistence.runTransaction("Locally write mutations","readwrite",(t=>n.Qn.bn(t,r).next((r=>{s=r;const o=[];for(const t of e){const e=oe(t,s.get(t.key));null!=e&&o.push(new le(t.key,e,ut(e.value.mapValue),ee.exists(!0)))}return n.In.addMutationBatch(t,i,o,e)})))).then((t=>(t.applyToLocalDocumentSet(s),{batchId:t.batchId,changes:s})))}(i.localStore,e);i.sharedClientState.addPendingMutation(t.batchId),function(t,e,n){let i=t.Lo[t.currentUser.toKey()];i||(i=new ve(C)),i=i.insert(e,n),t.Lo[t.currentUser.toKey()]=i}(i,t.batchId,n),await Ai(i,t.changes),await ai(i.remoteStore)}catch(t){const e=vi(t,"Failed to persist write");n.reject(e)}}(await Pi(t),e,n))),n.promise}(function(t){return t._firestoreClient||Xi(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}(t),e)}(r,[a.toMutation(t._key,ee.exists(!0))])}function mr(){return new or("serverTimestamp")}var yr;yr=i.MF,u=yr,(0,i.om)(new r.uA("firestore",((t,{options:e})=>{const n=t.getProvider("app").getImmediate(),i=new Gi(n,new E(t.getProvider("auth-internal")));return e=Object.assign({useFetchStreams:!0},e),i._setSettings(e),i}),"PUBLIC")),(0,i.KO)("@firebase/firestore","3.0.1",void 0)},944:(t,e,n)=>{n.d(e,{Wp:()=>i.Wp});var i=n(468);(0,i.KO)("firebase","9.0.1","app")},982:(t,e,n)=>{n.d(e,{H9:()=>i.H9,O5:()=>i.O5,aU:()=>i.aU,mZ:()=>i.mZ});var i=n(790)}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var s=e[i]={exports:{}};return t[i](s,s.exports,n),s.exports}n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var i=n(205),r=n(226),s=n(982),o=n(756);window.onload=function(){const t=JSON.parse(sessionStorage.getItem("userData"));if(!t||!t.phone)return alert("User session expired. Please log in again."),void(window.location.href="index.html");const e=localStorage.getItem("documentToBeEdited");e?function(t){document.getElementById("edit-document-page-container").innerHTML=` \n    <div class="container">\n        <div class="row m-3">\n            <div class="col-12 row mb-5 align-items-center justify-content-center">\n                <div id="edit-document-form-wrapper" class="col-lg-7 col-md-10 col-12 my-3 p-md-5 p-3 border border-2 rounded shadow">\n                    <h2 class="text-center mb-4">Edit Document</h2>\n                    <form action="" id="edit-document-page-form">\n                        \x3c!-- Document Name --\x3e\n                        <div class="mb-4">\n                            <label for="edit-document-page-document-name" class="form-label">Enter name of the document</label>\n                            <input type="text" class="form-control" id="edit-document-page-document-name" value="${t.documentName}">\n                        </div>\n\n                        \x3c!-- Document Type --\x3e\n                        <div class="mb-4">\n                            <label for="edit-document-page-type-of-document" class="form-label">Select the type of the document</label>\n                            <select class="form-select" id="edit-document-page-type-of-document">\n                                <option selected>Select the type of document</option>\n                                <option value="1">Aadhaar card</option>\n                                <option value="2">Arms license</option>\n                                <option value="3">Bank passbook</option>\n                                <option value="4">Bank statements</option>\n                                <option value="5">Birth certificate</option>\n                                <option value="6">Domicile certificate issued by government</option>\n                                <option value="7">Driving License</option>\n                                <option value="8">Educational certificate</option>\n                                <option value="9">Electors photo identity card</option>\n                                <option value="10">Electricity bill</option>\n                                <option value="11">Gazetted officer issued documents</option>\n                                <option value="12">Gas connection details</option>\n                                <option value="13">Letter from employer</option>\n                                <option value="14">Marriage certificate</option>\n                                <option value="15">MNREGA Job card</option>\n                                <option value="16">PAN card</option>\n                                <option value="17">Passport</option>\n                                <option value="18">Pension card</option>\n                                <option value="19">Photo credit card</option>\n                                <option value="20">Rent agreement</option>\n                                <option value="21">Ration card</option>\n                                <option value="22">Tax card</option>\n                                <option value="23">Telephone bill</option>\n                                <option value="24">Voter ID</option>\n                            </select>\n                        </div>\n\n                        \x3c!-- File Upload --\x3e\n                        <div class="mb-4">\n                            ${t.fileUrl?`<p>Already uploaded: <a href="${t.fileUrl}" target="_blank">${t.documentName}</a></p>`:""}\n                            <label for="edit-document-page-document-upload" class="form-label">Upload your new document</label>\n                            <input type="file" class="form-control" id="edit-document-page-document-upload" name="document" accept="application/pdf, image/*">\n                        </div>\n\n                        \x3c!-- Submit Button --\x3e\n                        <div class="d-grid">\n                            <button id="edit-document-page-submit-button" type="submit" class="btn btn-primary btn-lg">\n                                Submit\n                            </button>\n                        </div>\n                    </form>\n                </div>\n            </div>\n        </div>\n    </div>`;const e=document.getElementById("edit-document-page-type-of-document"),n=e.options,o=document.getElementById("edit-document-page-form");for(let i=0;i<n.length;i++)if(n[i].text===t.documentType){e.selectedIndex=i;break}o.addEventListener("submit",(async function(t){t.preventDefault();const e=localStorage.getItem("editDoc");if(!e)return void alert("No document to edit.");const n=document.getElementById("edit-document-page-document-name").value,o=document.getElementById("edit-document-page-type-of-document"),a=o.options[o.selectedIndex].text,c=JSON.parse(e);let u=c.fileUrl;const l=document.getElementById("edit-document-page-document-upload");var h;if(l.files.length){if((h=l.files[0]).size>2097152)return void alert("File size must be less than 2MB.");const t=(0,r.KR)(i.IG,`documents/${h.name}_${Date.now()}`);await(0,r.D)(t,h),u=await(0,r.qk)(t)}const d=(0,s.H9)(i.db,"documents",c.id);await(0,s.mZ)(d,{documentName:n,documentType:a,fileName:h?h.name:c.fileName,fileType:h?h.type:c.fileType,fileSize:h?h.size:c.fileSize,fileUrl:u,updatedAt:(0,s.O5)()}),alert("Document updated successfully!"),window.location.href="view_documents_page.html"}))}(JSON.parse(e)):alert("No document found to edit!")},document.addEventListener("DOMContentLoaded",(()=>{(0,o.S)()}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QkFDM0IsR0FFSixDQTdJUWdrRSxDQURZbCtFLEtBQUs0QyxNQUFNZzZFLElBR3ZCRCxNQUFNLDZCQUVkLEVBRUFuaUYsU0FBU2EsaUJBQWlCLG9CQUFvQixNQUMxQyxRQUFvQiIsInNvdXJjZXMiOlsid2VicGFjazovL3NlY3VyZS1kb2N1bWVudC11cGxvYWQvLi9ub2RlX21vZHVsZXMvQGZpcmViYXNlL3dlYmNoYW5uZWwtd3JhcHBlci9kaXN0L2luZGV4LmVzbS5qcyIsIndlYnBhY2s6Ly9zZWN1cmUtZG9jdW1lbnQtdXBsb2FkLy4vbm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9jb21wb25lbnQvZGlzdC9pbmRleC5lc20uanMiLCJ3ZWJwYWNrOi8vc2VjdXJlLWRvY3VtZW50LXVwbG9hZC8uL25vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9kaXN0L2VzbTIwMTcvaW5kZXgtOWZmMGZhOWMuanMiLCJ3ZWJwYWNrOi8vc2VjdXJlLWRvY3VtZW50LXVwbG9hZC8uL3NyYy9zZXR1cC5qcyIsIndlYnBhY2s6Ly9zZWN1cmUtZG9jdW1lbnQtdXBsb2FkLy4vbm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9zdG9yYWdlL2Rpc3QvaW5kZXguZXNtMjAxNy5qcyIsIndlYnBhY2s6Ly9zZWN1cmUtZG9jdW1lbnQtdXBsb2FkLy4vbm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hcHAvZGlzdC9pbmRleC5lc20yMDE3LmpzIiwid2VicGFjazovL3NlY3VyZS1kb2N1bWVudC11cGxvYWQvLi9ub2RlX21vZHVsZXMvQGZpcmViYXNlL2xvZ2dlci9kaXN0L2luZGV4LmVzbS5qcyIsIndlYnBhY2s6Ly9zZWN1cmUtZG9jdW1lbnQtdXBsb2FkLy4vbm9kZV9tb2R1bGVzL0BmaXJlYmFzZS91dGlsL2Rpc3QvaW5kZXguZXNtLmpzIiwid2VicGFjazovL3NlY3VyZS1kb2N1bWVudC11cGxvYWQvLi9ub2RlX21vZHVsZXMvdHNsaWIvdHNsaWIuZXM2Lm1qcyIsIndlYnBhY2s6Ly9zZWN1cmUtZG9jdW1lbnQtdXBsb2FkLy4vc3JjL25hdmJhci5qcyIsIndlYnBhY2s6Ly9zZWN1cmUtZG9jdW1lbnQtdXBsb2FkLy4vbm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9maXJlc3RvcmUvZGlzdC9pbmRleC5lc20yMDE3LmpzIiwid2VicGFjazovL3NlY3VyZS1kb2N1bWVudC11cGxvYWQvLi9ub2RlX21vZHVsZXMvZmlyZWJhc2UvYXBwL2Rpc3QvaW5kZXguZXNtLmpzIiwid2VicGFjazovL3NlY3VyZS1kb2N1bWVudC11cGxvYWQvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vc2VjdXJlLWRvY3VtZW50LXVwbG9hZC93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vc2VjdXJlLWRvY3VtZW50LXVwbG9hZC93ZWJwYWNrL3J1bnRpbWUvZ2xvYmFsIiwid2VicGFjazovL3NlY3VyZS1kb2N1bWVudC11cGxvYWQvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9zZWN1cmUtZG9jdW1lbnQtdXBsb2FkLy4vc3JjL2VkaXRfZG9jdW1lbnRfcGFnZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uXHJcblxyXG5QZXJtaXNzaW9uIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBhbmQvb3IgZGlzdHJpYnV0ZSB0aGlzIHNvZnR3YXJlIGZvciBhbnlcclxucHVycG9zZSB3aXRoIG9yIHdpdGhvdXQgZmVlIGlzIGhlcmVieSBncmFudGVkLlxyXG5cclxuVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiBBTkQgVEhFIEFVVEhPUiBESVNDTEFJTVMgQUxMIFdBUlJBTlRJRVMgV0lUSFxyXG5SRUdBUkQgVE8gVEhJUyBTT0ZUV0FSRSBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFlcclxuQU5EIEZJVE5FU1MuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1IgQkUgTElBQkxFIEZPUiBBTlkgU1BFQ0lBTCwgRElSRUNULFxyXG5JTkRJUkVDVCwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTIE9SIEFOWSBEQU1BR0VTIFdIQVRTT0VWRVIgUkVTVUxUSU5HIEZST01cclxuTE9TUyBPRiBVU0UsIERBVEEgT1IgUFJPRklUUywgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIE5FR0xJR0VOQ0UgT1JcclxuT1RIRVIgVE9SVElPVVMgQUNUSU9OLCBBUklTSU5HIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUlxyXG5QRVJGT1JNQU5DRSBPRiBUSElTIFNPRlRXQVJFLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG4vKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSAqL1xyXG5cclxudmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbihkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XHJcbiAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxufTtcclxuXHJcbmZ1bmN0aW9uIF9fZXh0ZW5kcyhkLCBiKSB7XHJcbiAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxyXG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcclxuICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxufVxyXG5cclxuZnVuY3Rpb24gX192YWx1ZXMobykge1xyXG4gICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDtcclxuICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pO1xyXG4gICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSBcIm51bWJlclwiKSByZXR1cm4ge1xyXG4gICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDtcclxuICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyBcIk9iamVjdCBpcyBub3QgaXRlcmFibGUuXCIgOiBcIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbn1cblxudmFyIGNvbW1vbmpzR2xvYmFsID0gdHlwZW9mIGdsb2JhbFRoaXMgIT09ICd1bmRlZmluZWQnID8gZ2xvYmFsVGhpcyA6IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnID8gd2luZG93IDogdHlwZW9mIGdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcgPyBnbG9iYWwgOiB0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcgPyBzZWxmIDoge307XG5cbnZhciBrLCBnb29nID0gZ29vZyB8fCB7fSwgbCA9IGNvbW1vbmpzR2xvYmFsIHx8IHNlbGY7XHJcbmZ1bmN0aW9uIGFhKCkgeyB9XHJcbmZ1bmN0aW9uIGJhKGEpIHsgdmFyIGIgPSB0eXBlb2YgYTsgYiA9IFwib2JqZWN0XCIgIT0gYiA/IGIgOiBhID8gQXJyYXkuaXNBcnJheShhKSA/IFwiYXJyYXlcIiA6IGIgOiBcIm51bGxcIjsgcmV0dXJuIFwiYXJyYXlcIiA9PSBiIHx8IFwib2JqZWN0XCIgPT0gYiAmJiBcIm51bWJlclwiID09IHR5cGVvZiBhLmxlbmd0aDsgfVxyXG5mdW5jdGlvbiBwKGEpIHsgdmFyIGIgPSB0eXBlb2YgYTsgcmV0dXJuIFwib2JqZWN0XCIgPT0gYiAmJiBudWxsICE9IGEgfHwgXCJmdW5jdGlvblwiID09IGI7IH1cclxuZnVuY3Rpb24gZGEoYSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGEsIGVhKSAmJiBhW2VhXSB8fCAoYVtlYV0gPSArK2ZhKTsgfVxyXG52YXIgZWEgPSBcImNsb3N1cmVfdWlkX1wiICsgKDFFOSAqIE1hdGgucmFuZG9tKCkgPj4+IDApLCBmYSA9IDA7XHJcbmZ1bmN0aW9uIGhhKGEsIGIsIGMpIHsgcmV0dXJuIGEuY2FsbC5hcHBseShhLmJpbmQsIGFyZ3VtZW50cyk7IH1cclxuZnVuY3Rpb24gaWEoYSwgYiwgYykgeyBpZiAoIWEpXHJcbiAgICB0aHJvdyBFcnJvcigpOyBpZiAoMiA8IGFyZ3VtZW50cy5sZW5ndGgpIHtcclxuICAgIHZhciBkID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKTtcclxuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7IHZhciBlID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKTsgQXJyYXkucHJvdG90eXBlLnVuc2hpZnQuYXBwbHkoZSwgZCk7IHJldHVybiBhLmFwcGx5KGIsIGUpOyB9O1xyXG59IHJldHVybiBmdW5jdGlvbiAoKSB7IHJldHVybiBhLmFwcGx5KGIsIGFyZ3VtZW50cyk7IH07IH1cclxuZnVuY3Rpb24gcShhLCBiLCBjKSB7IEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kICYmIC0xICE9IEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kLnRvU3RyaW5nKCkuaW5kZXhPZihcIm5hdGl2ZSBjb2RlXCIpID8gcSA9IGhhIDogcSA9IGlhOyByZXR1cm4gcS5hcHBseShudWxsLCBhcmd1bWVudHMpOyB9XHJcbmZ1bmN0aW9uIGphKGEsIGIpIHsgdmFyIGMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpOyByZXR1cm4gZnVuY3Rpb24gKCkgeyB2YXIgZCA9IGMuc2xpY2UoKTsgZC5wdXNoLmFwcGx5KGQsIGFyZ3VtZW50cyk7IHJldHVybiBhLmFwcGx5KHRoaXMsIGQpOyB9OyB9XHJcbmZ1bmN0aW9uIHQoYSwgYikgeyBmdW5jdGlvbiBjKCkgeyB9IGMucHJvdG90eXBlID0gYi5wcm90b3R5cGU7IGEuWiA9IGIucHJvdG90eXBlOyBhLnByb3RvdHlwZSA9IG5ldyBjOyBhLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IGE7IGEuVmIgPSBmdW5jdGlvbiAoZCwgZSwgZikgeyBmb3IgKHZhciBoID0gQXJyYXkoYXJndW1lbnRzLmxlbmd0aCAtIDIpLCBuID0gMjsgbiA8IGFyZ3VtZW50cy5sZW5ndGg7IG4rKylcclxuICAgIGhbbiAtIDJdID0gYXJndW1lbnRzW25dOyByZXR1cm4gYi5wcm90b3R5cGVbZV0uYXBwbHkoZCwgaCk7IH07IH1cclxuZnVuY3Rpb24gdigpIHsgdGhpcy5zID0gdGhpcy5zOyB0aGlzLm8gPSB0aGlzLm87IH1cclxudmFyIGthID0gMCwgbGEgPSB7fTtcclxudi5wcm90b3R5cGUucyA9ICExO1xyXG52LnByb3RvdHlwZS5uYSA9IGZ1bmN0aW9uICgpIHsgaWYgKCF0aGlzLnMgJiYgKHRoaXMucyA9ICEwLCB0aGlzLk0oKSwgMCAhPSBrYSkpIHtcclxuICAgIHZhciBhID0gZGEodGhpcyk7XHJcbiAgICBkZWxldGUgbGFbYV07XHJcbn0gfTtcclxudi5wcm90b3R5cGUuTSA9IGZ1bmN0aW9uICgpIHsgaWYgKHRoaXMubylcclxuICAgIGZvciAoOyB0aGlzLm8ubGVuZ3RoOylcclxuICAgICAgICB0aGlzLm8uc2hpZnQoKSgpOyB9O1xyXG52YXIgbWEgPSBBcnJheS5wcm90b3R5cGUuaW5kZXhPZiA/IGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKGEsIGIsIHZvaWQgMCk7IH0gOiBmdW5jdGlvbiAoYSwgYikgeyBpZiAoXCJzdHJpbmdcIiA9PT0gdHlwZW9mIGEpXHJcbiAgICByZXR1cm4gXCJzdHJpbmdcIiAhPT0gdHlwZW9mIGIgfHwgMSAhPSBiLmxlbmd0aCA/IC0xIDogYS5pbmRleE9mKGIsIDApOyBmb3IgKHZhciBjID0gMDsgYyA8IGEubGVuZ3RoOyBjKyspXHJcbiAgICBpZiAoYyBpbiBhICYmIGFbY10gPT09IGIpXHJcbiAgICAgICAgcmV0dXJuIGM7IHJldHVybiAtMTsgfSwgbmEgPSBBcnJheS5wcm90b3R5cGUuZm9yRWFjaCA/IGZ1bmN0aW9uIChhLCBiLCBjKSB7IEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoYSwgYiwgYyk7IH0gOiBmdW5jdGlvbiAoYSwgYiwgYykgeyB2YXIgZCA9IGEubGVuZ3RoLCBlID0gXCJzdHJpbmdcIiA9PT0gdHlwZW9mIGEgPyBhLnNwbGl0KFwiXCIpIDogYTsgZm9yICh2YXIgZiA9IDA7IGYgPCBkOyBmKyspXHJcbiAgICBmIGluIGUgJiYgYi5jYWxsKGMsIGVbZl0sIGYsIGEpOyB9O1xyXG5mdW5jdGlvbiBvYShhKSB7IGE6IHtcclxuICAgIHZhciBiID0gcGE7XHJcbiAgICB2YXIgYyA9IGEubGVuZ3RoLCBkID0gXCJzdHJpbmdcIiA9PT0gdHlwZW9mIGEgPyBhLnNwbGl0KFwiXCIpIDogYTtcclxuICAgIGZvciAodmFyIGUgPSAwOyBlIDwgYzsgZSsrKVxyXG4gICAgICAgIGlmIChlIGluIGQgJiYgYi5jYWxsKHZvaWQgMCwgZFtlXSwgZSwgYSkpIHtcclxuICAgICAgICAgICAgYiA9IGU7XHJcbiAgICAgICAgICAgIGJyZWFrIGE7XHJcbiAgICAgICAgfVxyXG4gICAgYiA9IC0xO1xyXG59IHJldHVybiAwID4gYiA/IG51bGwgOiBcInN0cmluZ1wiID09PSB0eXBlb2YgYSA/IGEuY2hhckF0KGIpIDogYVtiXTsgfVxyXG5mdW5jdGlvbiBxYShhKSB7IHJldHVybiBBcnJheS5wcm90b3R5cGUuY29uY2F0LmFwcGx5KFtdLCBhcmd1bWVudHMpOyB9XHJcbmZ1bmN0aW9uIHJhKGEpIHsgdmFyIGIgPSBhLmxlbmd0aDsgaWYgKDAgPCBiKSB7XHJcbiAgICB2YXIgYyA9IEFycmF5KGIpO1xyXG4gICAgZm9yICh2YXIgZCA9IDA7IGQgPCBiOyBkKyspXHJcbiAgICAgICAgY1tkXSA9IGFbZF07XHJcbiAgICByZXR1cm4gYztcclxufSByZXR1cm4gW107IH1cclxuZnVuY3Rpb24gc2EoYSkgeyByZXR1cm4gL15bXFxzXFx4YTBdKiQvLnRlc3QoYSk7IH1cclxudmFyIHRhID0gU3RyaW5nLnByb3RvdHlwZS50cmltID8gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGEudHJpbSgpOyB9IDogZnVuY3Rpb24gKGEpIHsgcmV0dXJuIC9eW1xcc1xceGEwXSooW1xcc1xcU10qPylbXFxzXFx4YTBdKiQvLmV4ZWMoYSlbMV07IH07XHJcbmZ1bmN0aW9uIHcoYSwgYikgeyByZXR1cm4gLTEgIT0gYS5pbmRleE9mKGIpOyB9XHJcbmZ1bmN0aW9uIHVhKGEsIGIpIHsgcmV0dXJuIGEgPCBiID8gLTEgOiBhID4gYiA/IDEgOiAwOyB9XHJcbnZhciB4O1xyXG5hOiB7XHJcbiAgICB2YXIgdmEgPSBsLm5hdmlnYXRvcjtcclxuICAgIGlmICh2YSkge1xyXG4gICAgICAgIHZhciB3YSA9IHZhLnVzZXJBZ2VudDtcclxuICAgICAgICBpZiAod2EpIHtcclxuICAgICAgICAgICAgeCA9IHdhO1xyXG4gICAgICAgICAgICBicmVhayBhO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHggPSBcIlwiO1xyXG59XHJcbmZ1bmN0aW9uIHhhKGEsIGIsIGMpIHsgZm9yICh2YXIgZCBpbiBhKVxyXG4gICAgYi5jYWxsKGMsIGFbZF0sIGQsIGEpOyB9XHJcbmZ1bmN0aW9uIHlhKGEpIHsgdmFyIGIgPSB7fTsgZm9yICh2YXIgYyBpbiBhKVxyXG4gICAgYltjXSA9IGFbY107IHJldHVybiBiOyB9XHJcbnZhciB6YSA9IFwiY29uc3RydWN0b3IgaGFzT3duUHJvcGVydHkgaXNQcm90b3R5cGVPZiBwcm9wZXJ0eUlzRW51bWVyYWJsZSB0b0xvY2FsZVN0cmluZyB0b1N0cmluZyB2YWx1ZU9mXCIuc3BsaXQoXCIgXCIpO1xyXG5mdW5jdGlvbiBBYShhLCBiKSB7IHZhciBjLCBkOyBmb3IgKHZhciBlID0gMTsgZSA8IGFyZ3VtZW50cy5sZW5ndGg7IGUrKykge1xyXG4gICAgZCA9IGFyZ3VtZW50c1tlXTtcclxuICAgIGZvciAoYyBpbiBkKVxyXG4gICAgICAgIGFbY10gPSBkW2NdO1xyXG4gICAgZm9yICh2YXIgZiA9IDA7IGYgPCB6YS5sZW5ndGg7IGYrKylcclxuICAgICAgICBjID0gemFbZl0sIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChkLCBjKSAmJiAoYVtjXSA9IGRbY10pO1xyXG59IH1cclxuZnVuY3Rpb24gQ2EoYSkgeyBDYVtcIiBcIl0oYSk7IHJldHVybiBhOyB9XHJcbkNhW1wiIFwiXSA9IGFhO1xyXG5mdW5jdGlvbiBGYShhKSB7IHZhciBiID0gR2E7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgOSkgPyBiWzldIDogYls5XSA9IGEoOSk7IH1cclxudmFyIEhhID0gdyh4LCBcIk9wZXJhXCIpLCB5ID0gdyh4LCBcIlRyaWRlbnRcIikgfHwgdyh4LCBcIk1TSUVcIiksIElhID0gdyh4LCBcIkVkZ2VcIiksIEphID0gSWEgfHwgeSwgS2EgPSB3KHgsIFwiR2Vja29cIikgJiYgISh3KHgudG9Mb3dlckNhc2UoKSwgXCJ3ZWJraXRcIikgJiYgIXcoeCwgXCJFZGdlXCIpKSAmJiAhKHcoeCwgXCJUcmlkZW50XCIpIHx8IHcoeCwgXCJNU0lFXCIpKSAmJiAhdyh4LCBcIkVkZ2VcIiksIExhID0gdyh4LnRvTG93ZXJDYXNlKCksIFwid2Via2l0XCIpICYmICF3KHgsIFwiRWRnZVwiKTtcclxuZnVuY3Rpb24gTWEoKSB7IHZhciBhID0gbC5kb2N1bWVudDsgcmV0dXJuIGEgPyBhLmRvY3VtZW50TW9kZSA6IHZvaWQgMDsgfVxyXG52YXIgTmE7XHJcbmE6IHtcclxuICAgIHZhciBPYSA9IFwiXCIsIFBhID0gZnVuY3Rpb24gKCkgeyB2YXIgYSA9IHg7IGlmIChLYSlcclxuICAgICAgICByZXR1cm4gL3J2OihbXlxcKTtdKykoXFwpfDspLy5leGVjKGEpOyBpZiAoSWEpXHJcbiAgICAgICAgcmV0dXJuIC9FZGdlXFwvKFtcXGRcXC5dKykvLmV4ZWMoYSk7IGlmICh5KVxyXG4gICAgICAgIHJldHVybiAvXFxiKD86TVNJRXxydilbOiBdKFteXFwpO10rKShcXCl8OykvLmV4ZWMoYSk7IGlmIChMYSlcclxuICAgICAgICByZXR1cm4gL1dlYktpdFxcLyhcXFMrKS8uZXhlYyhhKTsgaWYgKEhhKVxyXG4gICAgICAgIHJldHVybiAvKD86VmVyc2lvbilbIFxcL10/KFxcUyspLy5leGVjKGEpOyB9KCk7XHJcbiAgICBQYSAmJiAoT2EgPSBQYSA/IFBhWzFdIDogXCJcIik7XHJcbiAgICBpZiAoeSkge1xyXG4gICAgICAgIHZhciBRYSA9IE1hKCk7XHJcbiAgICAgICAgaWYgKG51bGwgIT0gUWEgJiYgUWEgPiBwYXJzZUZsb2F0KE9hKSkge1xyXG4gICAgICAgICAgICBOYSA9IFN0cmluZyhRYSk7XHJcbiAgICAgICAgICAgIGJyZWFrIGE7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgTmEgPSBPYTtcclxufVxyXG52YXIgR2EgPSB7fTtcclxuZnVuY3Rpb24gUmEoKSB7IHJldHVybiBGYShmdW5jdGlvbiAoKSB7IHZhciBhID0gMDsgdmFyIGIgPSB0YShTdHJpbmcoTmEpKS5zcGxpdChcIi5cIiksIGMgPSB0YShcIjlcIikuc3BsaXQoXCIuXCIpLCBkID0gTWF0aC5tYXgoYi5sZW5ndGgsIGMubGVuZ3RoKTsgZm9yICh2YXIgaCA9IDA7IDAgPT0gYSAmJiBoIDwgZDsgaCsrKSB7XHJcbiAgICB2YXIgZSA9IGJbaF0gfHwgXCJcIiwgZiA9IGNbaF0gfHwgXCJcIjtcclxuICAgIGRvIHtcclxuICAgICAgICBlID0gLyhcXGQqKShcXEQqKSguKikvLmV4ZWMoZSkgfHwgW1wiXCIsIFwiXCIsIFwiXCIsIFwiXCJdO1xyXG4gICAgICAgIGYgPSAvKFxcZCopKFxcRCopKC4qKS8uZXhlYyhmKSB8fCBbXCJcIiwgXCJcIiwgXCJcIiwgXCJcIl07XHJcbiAgICAgICAgaWYgKDAgPT0gZVswXS5sZW5ndGggJiYgMCA9PSBmWzBdLmxlbmd0aClcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgYSA9IHVhKDAgPT0gZVsxXS5sZW5ndGggPyAwIDogcGFyc2VJbnQoZVsxXSwgMTApLCAwID09IGZbMV0ubGVuZ3RoID8gMCA6IHBhcnNlSW50KGZbMV0sIDEwKSkgfHwgdWEoMCA9PSBlWzJdLmxlbmd0aCwgMCA9PSBmWzJdLmxlbmd0aCkgfHwgdWEoZVsyXSwgZlsyXSk7XHJcbiAgICAgICAgZSA9IGVbM107XHJcbiAgICAgICAgZiA9IGZbM107XHJcbiAgICB9IHdoaWxlICgwID09IGEpO1xyXG59IHJldHVybiAwIDw9IGE7IH0pOyB9XHJcbnZhciBTYTtcclxuaWYgKGwuZG9jdW1lbnQgJiYgeSkge1xyXG4gICAgdmFyIFRhID0gTWEoKTtcclxuICAgIFNhID0gVGEgPyBUYSA6IHBhcnNlSW50KE5hLCAxMCkgfHwgdm9pZCAwO1xyXG59XHJcbmVsc2VcclxuICAgIFNhID0gdm9pZCAwO1xyXG52YXIgVWEgPSBTYTtcclxudmFyIFZhID0gZnVuY3Rpb24gKCkgeyBpZiAoIWwuYWRkRXZlbnRMaXN0ZW5lciB8fCAhT2JqZWN0LmRlZmluZVByb3BlcnR5KVxyXG4gICAgcmV0dXJuICExOyB2YXIgYSA9ICExLCBiID0gT2JqZWN0LmRlZmluZVByb3BlcnR5KHt9LCBcInBhc3NpdmVcIiwgeyBnZXQ6IGZ1bmN0aW9uICgpIHsgYSA9ICEwOyB9IH0pOyB0cnkge1xyXG4gICAgbC5hZGRFdmVudExpc3RlbmVyKFwidGVzdFwiLCBhYSwgYiksIGwucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInRlc3RcIiwgYWEsIGIpO1xyXG59XHJcbmNhdGNoIChjKSB7IH0gcmV0dXJuIGE7IH0oKTtcclxuZnVuY3Rpb24geihhLCBiKSB7IHRoaXMudHlwZSA9IGE7IHRoaXMuZyA9IHRoaXMudGFyZ2V0ID0gYjsgdGhpcy5kZWZhdWx0UHJldmVudGVkID0gITE7IH1cclxuei5wcm90b3R5cGUuaCA9IGZ1bmN0aW9uICgpIHsgdGhpcy5kZWZhdWx0UHJldmVudGVkID0gITA7IH07XHJcbmZ1bmN0aW9uIEEoYSwgYikge1xyXG4gICAgei5jYWxsKHRoaXMsIGEgPyBhLnR5cGUgOiBcIlwiKTtcclxuICAgIHRoaXMucmVsYXRlZFRhcmdldCA9IHRoaXMuZyA9IHRoaXMudGFyZ2V0ID0gbnVsbDtcclxuICAgIHRoaXMuYnV0dG9uID0gdGhpcy5zY3JlZW5ZID0gdGhpcy5zY3JlZW5YID0gdGhpcy5jbGllbnRZID0gdGhpcy5jbGllbnRYID0gMDtcclxuICAgIHRoaXMua2V5ID0gXCJcIjtcclxuICAgIHRoaXMubWV0YUtleSA9IHRoaXMuc2hpZnRLZXkgPSB0aGlzLmFsdEtleSA9IHRoaXMuY3RybEtleSA9ICExO1xyXG4gICAgdGhpcy5zdGF0ZSA9IG51bGw7XHJcbiAgICB0aGlzLnBvaW50ZXJJZCA9IDA7XHJcbiAgICB0aGlzLnBvaW50ZXJUeXBlID0gXCJcIjtcclxuICAgIHRoaXMuaSA9IG51bGw7XHJcbiAgICBpZiAoYSkge1xyXG4gICAgICAgIHZhciBjID0gdGhpcy50eXBlID0gYS50eXBlLCBkID0gYS5jaGFuZ2VkVG91Y2hlcyAmJiBhLmNoYW5nZWRUb3VjaGVzLmxlbmd0aCA/IGEuY2hhbmdlZFRvdWNoZXNbMF0gOiBudWxsO1xyXG4gICAgICAgIHRoaXMudGFyZ2V0ID0gYS50YXJnZXQgfHwgYS5zcmNFbGVtZW50O1xyXG4gICAgICAgIHRoaXMuZyA9IGI7XHJcbiAgICAgICAgaWYgKGIgPSBhLnJlbGF0ZWRUYXJnZXQpIHtcclxuICAgICAgICAgICAgaWYgKEthKSB7XHJcbiAgICAgICAgICAgICAgICBhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgQ2EoYi5ub2RlTmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlID0gITA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrIGE7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNhdGNoIChmKSB7IH1cclxuICAgICAgICAgICAgICAgICAgICBlID1cclxuICAgICAgICAgICAgICAgICAgICAgICAgITE7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlIHx8IChiID0gbnVsbCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICBcIm1vdXNlb3ZlclwiID09IGMgPyBiID0gYS5mcm9tRWxlbWVudCA6IFwibW91c2VvdXRcIiA9PSBjICYmIChiID0gYS50b0VsZW1lbnQpO1xyXG4gICAgICAgIHRoaXMucmVsYXRlZFRhcmdldCA9IGI7XHJcbiAgICAgICAgZCA/ICh0aGlzLmNsaWVudFggPSB2b2lkIDAgIT09IGQuY2xpZW50WCA/IGQuY2xpZW50WCA6IGQucGFnZVgsIHRoaXMuY2xpZW50WSA9IHZvaWQgMCAhPT0gZC5jbGllbnRZID8gZC5jbGllbnRZIDogZC5wYWdlWSwgdGhpcy5zY3JlZW5YID0gZC5zY3JlZW5YIHx8IDAsIHRoaXMuc2NyZWVuWSA9IGQuc2NyZWVuWSB8fCAwKSA6ICh0aGlzLmNsaWVudFggPSB2b2lkIDAgIT09IGEuY2xpZW50WCA/IGEuY2xpZW50WCA6IGEucGFnZVgsIHRoaXMuY2xpZW50WSA9IHZvaWQgMCAhPT0gYS5jbGllbnRZID8gYS5jbGllbnRZIDogYS5wYWdlWSwgdGhpcy5zY3JlZW5YID0gYS5zY3JlZW5YIHx8IDAsIHRoaXMuc2NyZWVuWSA9IGEuc2NyZWVuWSB8fCAwKTtcclxuICAgICAgICB0aGlzLmJ1dHRvbiA9IGEuYnV0dG9uO1xyXG4gICAgICAgIHRoaXMua2V5ID0gYS5rZXkgfHwgXCJcIjtcclxuICAgICAgICB0aGlzLmN0cmxLZXkgPSBhLmN0cmxLZXk7XHJcbiAgICAgICAgdGhpcy5hbHRLZXkgPSBhLmFsdEtleTtcclxuICAgICAgICB0aGlzLnNoaWZ0S2V5ID1cclxuICAgICAgICAgICAgYS5zaGlmdEtleTtcclxuICAgICAgICB0aGlzLm1ldGFLZXkgPSBhLm1ldGFLZXk7XHJcbiAgICAgICAgdGhpcy5wb2ludGVySWQgPSBhLnBvaW50ZXJJZCB8fCAwO1xyXG4gICAgICAgIHRoaXMucG9pbnRlclR5cGUgPSBcInN0cmluZ1wiID09PSB0eXBlb2YgYS5wb2ludGVyVHlwZSA/IGEucG9pbnRlclR5cGUgOiBXYVthLnBvaW50ZXJUeXBlXSB8fCBcIlwiO1xyXG4gICAgICAgIHRoaXMuc3RhdGUgPSBhLnN0YXRlO1xyXG4gICAgICAgIHRoaXMuaSA9IGE7XHJcbiAgICAgICAgYS5kZWZhdWx0UHJldmVudGVkICYmIEEuWi5oLmNhbGwodGhpcyk7XHJcbiAgICB9XHJcbn1cclxudChBLCB6KTtcclxudmFyIFdhID0geyAyOiBcInRvdWNoXCIsIDM6IFwicGVuXCIsIDQ6IFwibW91c2VcIiB9O1xyXG5BLnByb3RvdHlwZS5oID0gZnVuY3Rpb24gKCkgeyBBLlouaC5jYWxsKHRoaXMpOyB2YXIgYSA9IHRoaXMuaTsgYS5wcmV2ZW50RGVmYXVsdCA/IGEucHJldmVudERlZmF1bHQoKSA6IGEucmV0dXJuVmFsdWUgPSAhMTsgfTtcclxudmFyIEIgPSBcImNsb3N1cmVfbGlzdGVuYWJsZV9cIiArICgxRTYgKiBNYXRoLnJhbmRvbSgpIHwgMCk7XHJcbnZhciBYYSA9IDA7XHJcbmZ1bmN0aW9uIFlhKGEsIGIsIGMsIGQsIGUpIHsgdGhpcy5saXN0ZW5lciA9IGE7IHRoaXMucHJveHkgPSBudWxsOyB0aGlzLnNyYyA9IGI7IHRoaXMudHlwZSA9IGM7IHRoaXMuY2FwdHVyZSA9ICEhZDsgdGhpcy5pYSA9IGU7IHRoaXMua2V5ID0gKytYYTsgdGhpcy5jYSA9IHRoaXMuZmEgPSAhMTsgfVxyXG5mdW5jdGlvbiBaYShhKSB7IGEuY2EgPSAhMDsgYS5saXN0ZW5lciA9IG51bGw7IGEucHJveHkgPSBudWxsOyBhLnNyYyA9IG51bGw7IGEuaWEgPSBudWxsOyB9XHJcbmZ1bmN0aW9uICRhKGEpIHsgdGhpcy5zcmMgPSBhOyB0aGlzLmcgPSB7fTsgdGhpcy5oID0gMDsgfVxyXG4kYS5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24gKGEsIGIsIGMsIGQsIGUpIHsgdmFyIGYgPSBhLnRvU3RyaW5nKCk7IGEgPSB0aGlzLmdbZl07IGEgfHwgKGEgPSB0aGlzLmdbZl0gPSBbXSwgdGhpcy5oKyspOyB2YXIgaCA9IGFiKGEsIGIsIGQsIGUpOyAtMSA8IGggPyAoYiA9IGFbaF0sIGMgfHwgKGIuZmEgPSAhMSkpIDogKGIgPSBuZXcgWWEoYiwgdGhpcy5zcmMsIGYsICEhZCwgZSksIGIuZmEgPSBjLCBhLnB1c2goYikpOyByZXR1cm4gYjsgfTtcclxuZnVuY3Rpb24gYmIoYSwgYikgeyB2YXIgYyA9IGIudHlwZTsgaWYgKGMgaW4gYS5nKSB7XHJcbiAgICB2YXIgZCA9IGEuZ1tjXSwgZSA9IG1hKGQsIGIpLCBmO1xyXG4gICAgKGYgPSAwIDw9IGUpICYmIEFycmF5LnByb3RvdHlwZS5zcGxpY2UuY2FsbChkLCBlLCAxKTtcclxuICAgIGYgJiYgKFphKGIpLCAwID09IGEuZ1tjXS5sZW5ndGggJiYgKGRlbGV0ZSBhLmdbY10sIGEuaC0tKSk7XHJcbn0gfVxyXG5mdW5jdGlvbiBhYihhLCBiLCBjLCBkKSB7IGZvciAodmFyIGUgPSAwOyBlIDwgYS5sZW5ndGg7ICsrZSkge1xyXG4gICAgdmFyIGYgPSBhW2VdO1xyXG4gICAgaWYgKCFmLmNhICYmIGYubGlzdGVuZXIgPT0gYiAmJiBmLmNhcHR1cmUgPT0gISFjICYmIGYuaWEgPT0gZClcclxuICAgICAgICByZXR1cm4gZTtcclxufSByZXR1cm4gLTE7IH1cclxudmFyIGNiID0gXCJjbG9zdXJlX2xtX1wiICsgKDFFNiAqIE1hdGgucmFuZG9tKCkgfCAwKSwgZGIgPSB7fTtcclxuZnVuY3Rpb24gZmIoYSwgYiwgYywgZCwgZSkgeyBpZiAoZCAmJiBkLm9uY2UpXHJcbiAgICByZXR1cm4gZ2IoYSwgYiwgYywgZCwgZSk7IGlmIChBcnJheS5pc0FycmF5KGIpKSB7XHJcbiAgICBmb3IgKHZhciBmID0gMDsgZiA8IGIubGVuZ3RoOyBmKyspXHJcbiAgICAgICAgZmIoYSwgYltmXSwgYywgZCwgZSk7XHJcbiAgICByZXR1cm4gbnVsbDtcclxufSBjID0gaGIoYyk7IHJldHVybiBhICYmIGFbQl0gPyBhLk4oYiwgYywgcChkKSA/ICEhZC5jYXB0dXJlIDogISFkLCBlKSA6IGliKGEsIGIsIGMsICExLCBkLCBlKTsgfVxyXG5mdW5jdGlvbiBpYihhLCBiLCBjLCBkLCBlLCBmKSB7IGlmICghYilcclxuICAgIHRocm93IEVycm9yKFwiSW52YWxpZCBldmVudCB0eXBlXCIpOyB2YXIgaCA9IHAoZSkgPyAhIWUuY2FwdHVyZSA6ICEhZSwgbiA9IGpiKGEpOyBuIHx8IChhW2NiXSA9IG4gPSBuZXcgJGEoYSkpOyBjID0gbi5hZGQoYiwgYywgZCwgaCwgZik7IGlmIChjLnByb3h5KVxyXG4gICAgcmV0dXJuIGM7IGQgPSBrYigpOyBjLnByb3h5ID0gZDsgZC5zcmMgPSBhOyBkLmxpc3RlbmVyID0gYzsgaWYgKGEuYWRkRXZlbnRMaXN0ZW5lcilcclxuICAgIFZhIHx8IChlID0gaCksIHZvaWQgMCA9PT0gZSAmJiAoZSA9ICExKSwgYS5hZGRFdmVudExpc3RlbmVyKGIudG9TdHJpbmcoKSwgZCwgZSk7XHJcbmVsc2UgaWYgKGEuYXR0YWNoRXZlbnQpXHJcbiAgICBhLmF0dGFjaEV2ZW50KGxiKGIudG9TdHJpbmcoKSksIGQpO1xyXG5lbHNlIGlmIChhLmFkZExpc3RlbmVyICYmIGEucmVtb3ZlTGlzdGVuZXIpXHJcbiAgICBhLmFkZExpc3RlbmVyKGQpO1xyXG5lbHNlXHJcbiAgICB0aHJvdyBFcnJvcihcImFkZEV2ZW50TGlzdGVuZXIgYW5kIGF0dGFjaEV2ZW50IGFyZSB1bmF2YWlsYWJsZS5cIik7IHJldHVybiBjOyB9XHJcbmZ1bmN0aW9uIGtiKCkgeyBmdW5jdGlvbiBhKGMpIHsgcmV0dXJuIGIuY2FsbChhLnNyYywgYS5saXN0ZW5lciwgYyk7IH0gdmFyIGIgPSBtYjsgcmV0dXJuIGE7IH1cclxuZnVuY3Rpb24gZ2IoYSwgYiwgYywgZCwgZSkgeyBpZiAoQXJyYXkuaXNBcnJheShiKSkge1xyXG4gICAgZm9yICh2YXIgZiA9IDA7IGYgPCBiLmxlbmd0aDsgZisrKVxyXG4gICAgICAgIGdiKGEsIGJbZl0sIGMsIGQsIGUpO1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbn0gYyA9IGhiKGMpOyByZXR1cm4gYSAmJiBhW0JdID8gYS5PKGIsIGMsIHAoZCkgPyAhIWQuY2FwdHVyZSA6ICEhZCwgZSkgOiBpYihhLCBiLCBjLCAhMCwgZCwgZSk7IH1cclxuZnVuY3Rpb24gbmIoYSwgYiwgYywgZCwgZSkgeyBpZiAoQXJyYXkuaXNBcnJheShiKSlcclxuICAgIGZvciAodmFyIGYgPSAwOyBmIDwgYi5sZW5ndGg7IGYrKylcclxuICAgICAgICBuYihhLCBiW2ZdLCBjLCBkLCBlKTtcclxuZWxzZVxyXG4gICAgKGQgPSBwKGQpID8gISFkLmNhcHR1cmUgOiAhIWQsIGMgPSBoYihjKSwgYSAmJiBhW0JdKSA/IChhID0gYS5pLCBiID0gU3RyaW5nKGIpLnRvU3RyaW5nKCksIGIgaW4gYS5nICYmIChmID0gYS5nW2JdLCBjID0gYWIoZiwgYywgZCwgZSksIC0xIDwgYyAmJiAoWmEoZltjXSksIEFycmF5LnByb3RvdHlwZS5zcGxpY2UuY2FsbChmLCBjLCAxKSwgMCA9PSBmLmxlbmd0aCAmJiAoZGVsZXRlIGEuZ1tiXSwgYS5oLS0pKSkpIDogYSAmJiAoYSA9IGpiKGEpKSAmJiAoYiA9IGEuZ1tiLnRvU3RyaW5nKCldLCBhID0gLTEsIGIgJiYgKGEgPSBhYihiLCBjLCBkLCBlKSksIChjID0gLTEgPCBhID8gYlthXSA6IG51bGwpICYmIG9iKGMpKTsgfVxyXG5mdW5jdGlvbiBvYihhKSB7IGlmIChcIm51bWJlclwiICE9PSB0eXBlb2YgYSAmJiBhICYmICFhLmNhKSB7XHJcbiAgICB2YXIgYiA9IGEuc3JjO1xyXG4gICAgaWYgKGIgJiYgYltCXSlcclxuICAgICAgICBiYihiLmksIGEpO1xyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgdmFyIGMgPSBhLnR5cGUsIGQgPSBhLnByb3h5O1xyXG4gICAgICAgIGIucmVtb3ZlRXZlbnRMaXN0ZW5lciA/IGIucmVtb3ZlRXZlbnRMaXN0ZW5lcihjLCBkLCBhLmNhcHR1cmUpIDogYi5kZXRhY2hFdmVudCA/IGIuZGV0YWNoRXZlbnQobGIoYyksIGQpIDogYi5hZGRMaXN0ZW5lciAmJiBiLnJlbW92ZUxpc3RlbmVyICYmIGIucmVtb3ZlTGlzdGVuZXIoZCk7XHJcbiAgICAgICAgKGMgPSBqYihiKSkgPyAoYmIoYywgYSksIDAgPT0gYy5oICYmIChjLnNyYyA9IG51bGwsIGJbY2JdID0gbnVsbCkpIDogWmEoYSk7XHJcbiAgICB9XHJcbn0gfVxyXG5mdW5jdGlvbiBsYihhKSB7IHJldHVybiBhIGluIGRiID8gZGJbYV0gOiBkYlthXSA9IFwib25cIiArIGE7IH1cclxuZnVuY3Rpb24gbWIoYSwgYikgeyBpZiAoYS5jYSlcclxuICAgIGEgPSAhMDtcclxuZWxzZSB7XHJcbiAgICBiID0gbmV3IEEoYiwgdGhpcyk7XHJcbiAgICB2YXIgYyA9IGEubGlzdGVuZXIsIGQgPSBhLmlhIHx8IGEuc3JjO1xyXG4gICAgYS5mYSAmJiBvYihhKTtcclxuICAgIGEgPSBjLmNhbGwoZCwgYik7XHJcbn0gcmV0dXJuIGE7IH1cclxuZnVuY3Rpb24gamIoYSkgeyBhID0gYVtjYl07IHJldHVybiBhIGluc3RhbmNlb2YgJGEgPyBhIDogbnVsbDsgfVxyXG52YXIgcGIgPSBcIl9fY2xvc3VyZV9ldmVudHNfZm5fXCIgKyAoMUU5ICogTWF0aC5yYW5kb20oKSA+Pj4gMCk7XHJcbmZ1bmN0aW9uIGhiKGEpIHsgaWYgKFwiZnVuY3Rpb25cIiA9PT0gdHlwZW9mIGEpXHJcbiAgICByZXR1cm4gYTsgYVtwYl0gfHwgKGFbcGJdID0gZnVuY3Rpb24gKGIpIHsgcmV0dXJuIGEuaGFuZGxlRXZlbnQoYik7IH0pOyByZXR1cm4gYVtwYl07IH1cclxuZnVuY3Rpb24gQygpIHsgdi5jYWxsKHRoaXMpOyB0aGlzLmkgPSBuZXcgJGEodGhpcyk7IHRoaXMuUCA9IHRoaXM7IHRoaXMuSSA9IG51bGw7IH1cclxudChDLCB2KTtcclxuQy5wcm90b3R5cGVbQl0gPSAhMDtcclxuQy5wcm90b3R5cGUucmVtb3ZlRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uIChhLCBiLCBjLCBkKSB7IG5iKHRoaXMsIGEsIGIsIGMsIGQpOyB9O1xyXG5mdW5jdGlvbiBEKGEsIGIpIHsgdmFyIGMsIGQgPSBhLkk7IGlmIChkKVxyXG4gICAgZm9yIChjID0gW107IGQ7IGQgPSBkLkkpXHJcbiAgICAgICAgYy5wdXNoKGQpOyBhID0gYS5QOyBkID0gYi50eXBlIHx8IGI7IGlmIChcInN0cmluZ1wiID09PSB0eXBlb2YgYilcclxuICAgIGIgPSBuZXcgeihiLCBhKTtcclxuZWxzZSBpZiAoYiBpbnN0YW5jZW9mIHopXHJcbiAgICBiLnRhcmdldCA9IGIudGFyZ2V0IHx8IGE7XHJcbmVsc2Uge1xyXG4gICAgdmFyIGUgPSBiO1xyXG4gICAgYiA9IG5ldyB6KGQsIGEpO1xyXG4gICAgQWEoYiwgZSk7XHJcbn0gZSA9ICEwOyBpZiAoYylcclxuICAgIGZvciAodmFyIGYgPSBjLmxlbmd0aCAtIDE7IDAgPD0gZjsgZi0tKSB7XHJcbiAgICAgICAgdmFyIGggPSBiLmcgPSBjW2ZdO1xyXG4gICAgICAgIGUgPSBxYihoLCBkLCAhMCwgYikgJiYgZTtcclxuICAgIH0gaCA9IGIuZyA9IGE7IGUgPSBxYihoLCBkLCAhMCwgYikgJiYgZTsgZSA9IHFiKGgsIGQsICExLCBiKSAmJiBlOyBpZiAoYylcclxuICAgIGZvciAoZiA9IDA7IGYgPCBjLmxlbmd0aDsgZisrKVxyXG4gICAgICAgIGggPSBiLmcgPSBjW2ZdLCBlID0gcWIoaCwgZCwgITEsIGIpICYmIGU7IH1cclxuQy5wcm90b3R5cGUuTSA9IGZ1bmN0aW9uICgpIHsgQy5aLk0uY2FsbCh0aGlzKTsgaWYgKHRoaXMuaSkge1xyXG4gICAgdmFyIGEgPSB0aGlzLmksIGM7XHJcbiAgICBmb3IgKGMgaW4gYS5nKSB7XHJcbiAgICAgICAgZm9yICh2YXIgZCA9IGEuZ1tjXSwgZSA9IDA7IGUgPCBkLmxlbmd0aDsgZSsrKVxyXG4gICAgICAgICAgICBaYShkW2VdKTtcclxuICAgICAgICBkZWxldGUgYS5nW2NdO1xyXG4gICAgICAgIGEuaC0tO1xyXG4gICAgfVxyXG59IHRoaXMuSSA9IG51bGw7IH07XHJcbkMucHJvdG90eXBlLk4gPSBmdW5jdGlvbiAoYSwgYiwgYywgZCkgeyByZXR1cm4gdGhpcy5pLmFkZChTdHJpbmcoYSksIGIsICExLCBjLCBkKTsgfTtcclxuQy5wcm90b3R5cGUuTyA9IGZ1bmN0aW9uIChhLCBiLCBjLCBkKSB7IHJldHVybiB0aGlzLmkuYWRkKFN0cmluZyhhKSwgYiwgITAsIGMsIGQpOyB9O1xyXG5mdW5jdGlvbiBxYihhLCBiLCBjLCBkKSB7IGIgPSBhLmkuZ1tTdHJpbmcoYildOyBpZiAoIWIpXHJcbiAgICByZXR1cm4gITA7IGIgPSBiLmNvbmNhdCgpOyBmb3IgKHZhciBlID0gITAsIGYgPSAwOyBmIDwgYi5sZW5ndGg7ICsrZikge1xyXG4gICAgdmFyIGggPSBiW2ZdO1xyXG4gICAgaWYgKGggJiYgIWguY2EgJiYgaC5jYXB0dXJlID09IGMpIHtcclxuICAgICAgICB2YXIgbiA9IGgubGlzdGVuZXIsIHUgPSBoLmlhIHx8IGguc3JjO1xyXG4gICAgICAgIGguZmEgJiYgYmIoYS5pLCBoKTtcclxuICAgICAgICBlID0gITEgIT09IG4uY2FsbCh1LCBkKSAmJiBlO1xyXG4gICAgfVxyXG59IHJldHVybiBlICYmICFkLmRlZmF1bHRQcmV2ZW50ZWQ7IH1cclxudmFyIHJiID0gbC5KU09OLnN0cmluZ2lmeTtcclxuZnVuY3Rpb24gc2IoKSB7IHZhciBhID0gdGI7IHZhciBiID0gbnVsbDsgYS5nICYmIChiID0gYS5nLCBhLmcgPSBhLmcubmV4dCwgYS5nIHx8IChhLmggPSBudWxsKSwgYi5uZXh0ID0gbnVsbCk7IHJldHVybiBiOyB9XHJcbnZhciB1YiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIHViKCkge1xyXG4gICAgICAgIHRoaXMuaCA9IHRoaXMuZyA9IG51bGw7XHJcbiAgICB9XHJcbiAgICB1Yi5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24gKGEsIGIpIHsgdmFyIGMgPSB2Yi5nZXQoKTsgYy5zZXQoYSwgYik7IHRoaXMuaCA/IHRoaXMuaC5uZXh0ID0gYyA6IHRoaXMuZyA9IGM7IHRoaXMuaCA9IGM7IH07XHJcbiAgICByZXR1cm4gdWI7XHJcbn0oKSk7XHJcbnZhciB2YiA9IG5ldyAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBjbGFzc18yKGEsIGIpIHtcclxuICAgICAgICB0aGlzLmkgPSBhO1xyXG4gICAgICAgIHRoaXMuaiA9IGI7XHJcbiAgICAgICAgdGhpcy5oID0gMDtcclxuICAgICAgICB0aGlzLmcgPSBudWxsO1xyXG4gICAgfVxyXG4gICAgY2xhc3NfMi5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKCkgeyB2YXIgYTsgMCA8IHRoaXMuaCA/ICh0aGlzLmgtLSwgYSA9IHRoaXMuZywgdGhpcy5nID0gYS5uZXh0LCBhLm5leHQgPSBudWxsKSA6IGEgPSB0aGlzLmkoKTsgcmV0dXJuIGE7IH07XHJcbiAgICByZXR1cm4gY2xhc3NfMjtcclxufSgpKShmdW5jdGlvbiAoKSB7IHJldHVybiBuZXcgd2I7IH0sIGZ1bmN0aW9uIChhKSB7IHJldHVybiBhLnJlc2V0KCk7IH0pO1xyXG52YXIgd2IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiB3YigpIHtcclxuICAgICAgICB0aGlzLm5leHQgPSB0aGlzLmcgPSB0aGlzLmggPSBudWxsO1xyXG4gICAgfVxyXG4gICAgd2IucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uIChhLCBiKSB7IHRoaXMuaCA9IGE7IHRoaXMuZyA9IGI7IHRoaXMubmV4dCA9IG51bGw7IH07XHJcbiAgICB3Yi5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbiAoKSB7IHRoaXMubmV4dCA9IHRoaXMuZyA9IHRoaXMuaCA9IG51bGw7IH07XHJcbiAgICByZXR1cm4gd2I7XHJcbn0oKSk7XHJcbmZ1bmN0aW9uIHliKGEpIHsgbC5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgdGhyb3cgYTsgfSwgMCk7IH1cclxuZnVuY3Rpb24gemIoYSwgYikgeyBBYiB8fCBCYigpOyBDYiB8fCAoQWIoKSwgQ2IgPSAhMCk7IHRiLmFkZChhLCBiKTsgfVxyXG52YXIgQWI7XHJcbmZ1bmN0aW9uIEJiKCkgeyB2YXIgYSA9IGwuUHJvbWlzZS5yZXNvbHZlKHZvaWQgMCk7IEFiID0gZnVuY3Rpb24gKCkgeyBhLnRoZW4oRGIpOyB9OyB9XHJcbnZhciBDYiA9ICExLCB0YiA9IG5ldyB1YjtcclxuZnVuY3Rpb24gRGIoKSB7IGZvciAodmFyIGE7IGEgPSBzYigpOykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBhLmguY2FsbChhLmcpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGMpIHtcclxuICAgICAgICB5YihjKTtcclxuICAgIH1cclxuICAgIHZhciBiID0gdmI7XHJcbiAgICBiLmooYSk7XHJcbiAgICAxMDAgPiBiLmggJiYgKGIuaCsrLCBhLm5leHQgPSBiLmcsIGIuZyA9IGEpO1xyXG59IENiID0gITE7IH1cclxuZnVuY3Rpb24gRWIoYSwgYikgeyBDLmNhbGwodGhpcyk7IHRoaXMuaCA9IGEgfHwgMTsgdGhpcy5nID0gYiB8fCBsOyB0aGlzLmogPSBxKHRoaXMua2IsIHRoaXMpOyB0aGlzLmwgPSBEYXRlLm5vdygpOyB9XHJcbnQoRWIsIEMpO1xyXG5rID0gRWIucHJvdG90eXBlO1xyXG5rLmRhID0gITE7XHJcbmsuUyA9IG51bGw7XHJcbmsua2IgPSBmdW5jdGlvbiAoKSB7IGlmICh0aGlzLmRhKSB7XHJcbiAgICB2YXIgYSA9IERhdGUubm93KCkgLSB0aGlzLmw7XHJcbiAgICAwIDwgYSAmJiBhIDwgLjggKiB0aGlzLmggPyB0aGlzLlMgPSB0aGlzLmcuc2V0VGltZW91dCh0aGlzLmosIHRoaXMuaCAtIGEpIDogKHRoaXMuUyAmJiAodGhpcy5nLmNsZWFyVGltZW91dCh0aGlzLlMpLCB0aGlzLlMgPSBudWxsKSwgRCh0aGlzLCBcInRpY2tcIiksIHRoaXMuZGEgJiYgKEZiKHRoaXMpLCB0aGlzLnN0YXJ0KCkpKTtcclxufSB9O1xyXG5rLnN0YXJ0ID0gZnVuY3Rpb24gKCkgeyB0aGlzLmRhID0gITA7IHRoaXMuUyB8fCAodGhpcy5TID0gdGhpcy5nLnNldFRpbWVvdXQodGhpcy5qLCB0aGlzLmgpLCB0aGlzLmwgPSBEYXRlLm5vdygpKTsgfTtcclxuZnVuY3Rpb24gRmIoYSkgeyBhLmRhID0gITE7IGEuUyAmJiAoYS5nLmNsZWFyVGltZW91dChhLlMpLCBhLlMgPSBudWxsKTsgfVxyXG5rLk0gPSBmdW5jdGlvbiAoKSB7IEViLlouTS5jYWxsKHRoaXMpOyBGYih0aGlzKTsgZGVsZXRlIHRoaXMuZzsgfTtcclxuZnVuY3Rpb24gR2IoYSwgYiwgYykgeyBpZiAoXCJmdW5jdGlvblwiID09PSB0eXBlb2YgYSlcclxuICAgIGMgJiYgKGEgPSBxKGEsIGMpKTtcclxuZWxzZSBpZiAoYSAmJiBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIGEuaGFuZGxlRXZlbnQpXHJcbiAgICBhID0gcShhLmhhbmRsZUV2ZW50LCBhKTtcclxuZWxzZVxyXG4gICAgdGhyb3cgRXJyb3IoXCJJbnZhbGlkIGxpc3RlbmVyIGFyZ3VtZW50XCIpOyByZXR1cm4gMjE0NzQ4MzY0NyA8IE51bWJlcihiKSA/IC0xIDogbC5zZXRUaW1lb3V0KGEsIGIgfHwgMCk7IH1cclxuZnVuY3Rpb24gSGIoYSkgeyBhLmcgPSBHYihmdW5jdGlvbiAoKSB7IGEuZyA9IG51bGw7IGEuaSAmJiAoYS5pID0gITEsIEhiKGEpKTsgfSwgYS5qKTsgdmFyIGIgPSBhLmg7IGEuaCA9IG51bGw7IGEubS5hcHBseShudWxsLCBiKTsgfVxyXG52YXIgSWIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICBfX2V4dGVuZHMoSWIsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBJYihhLCBiKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5tID0gYTtcclxuICAgICAgICBfdGhpcy5qID0gYjtcclxuICAgICAgICBfdGhpcy5oID0gbnVsbDtcclxuICAgICAgICBfdGhpcy5pID0gITE7XHJcbiAgICAgICAgX3RoaXMuZyA9IG51bGw7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgSWIucHJvdG90eXBlLmwgPSBmdW5jdGlvbiAoYSkgeyB0aGlzLmggPSBhcmd1bWVudHM7IHRoaXMuZyA/IHRoaXMuaSA9ICEwIDogSGIodGhpcyk7IH07XHJcbiAgICBJYi5wcm90b3R5cGUuTSA9IGZ1bmN0aW9uICgpIHsgX3N1cGVyLnByb3RvdHlwZS5NLmNhbGwodGhpcyk7IHRoaXMuZyAmJiAobC5jbGVhclRpbWVvdXQodGhpcy5nKSwgdGhpcy5nID0gbnVsbCwgdGhpcy5pID0gITEsIHRoaXMuaCA9IG51bGwpOyB9O1xyXG4gICAgcmV0dXJuIEliO1xyXG59KHYpKTtcclxuZnVuY3Rpb24gRShhKSB7IHYuY2FsbCh0aGlzKTsgdGhpcy5oID0gYTsgdGhpcy5nID0ge307IH1cclxudChFLCB2KTtcclxudmFyIEpiID0gW107XHJcbmZ1bmN0aW9uIEtiKGEsIGIsIGMsIGQpIHsgQXJyYXkuaXNBcnJheShjKSB8fCAoYyAmJiAoSmJbMF0gPSBjLnRvU3RyaW5nKCkpLCBjID0gSmIpOyBmb3IgKHZhciBlID0gMDsgZSA8IGMubGVuZ3RoOyBlKyspIHtcclxuICAgIHZhciBmID0gZmIoYiwgY1tlXSwgZCB8fCBhLmhhbmRsZUV2ZW50LCAhMSwgYS5oIHx8IGEpO1xyXG4gICAgaWYgKCFmKVxyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgYS5nW2Yua2V5XSA9IGY7XHJcbn0gfVxyXG5mdW5jdGlvbiBMYihhKSB7IHhhKGEuZywgZnVuY3Rpb24gKGIsIGMpIHsgdGhpcy5nLmhhc093blByb3BlcnR5KGMpICYmIG9iKGIpOyB9LCBhKTsgYS5nID0ge307IH1cclxuRS5wcm90b3R5cGUuTSA9IGZ1bmN0aW9uICgpIHsgRS5aLk0uY2FsbCh0aGlzKTsgTGIodGhpcyk7IH07XHJcbkUucHJvdG90eXBlLmhhbmRsZUV2ZW50ID0gZnVuY3Rpb24gKCkgeyB0aHJvdyBFcnJvcihcIkV2ZW50SGFuZGxlci5oYW5kbGVFdmVudCBub3QgaW1wbGVtZW50ZWRcIik7IH07XHJcbmZ1bmN0aW9uIE1iKCkgeyB0aGlzLmcgPSAhMDsgfVxyXG5NYi5wcm90b3R5cGUuQWEgPSBmdW5jdGlvbiAoKSB7IHRoaXMuZyA9ICExOyB9O1xyXG5mdW5jdGlvbiBOYihhLCBiLCBjLCBkLCBlLCBmKSB7IGEuaW5mbyhmdW5jdGlvbiAoKSB7IGlmIChhLmcpXHJcbiAgICBpZiAoZikge1xyXG4gICAgICAgIHZhciBoID0gXCJcIjtcclxuICAgICAgICBmb3IgKHZhciBuID0gZi5zcGxpdChcIiZcIiksIHUgPSAwOyB1IDwgbi5sZW5ndGg7IHUrKykge1xyXG4gICAgICAgICAgICB2YXIgbSA9IG5bdV0uc3BsaXQoXCI9XCIpO1xyXG4gICAgICAgICAgICBpZiAoMSA8IG0ubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgciA9IG1bMF07XHJcbiAgICAgICAgICAgICAgICBtID0gbVsxXTtcclxuICAgICAgICAgICAgICAgIHZhciBHID0gci5zcGxpdChcIl9cIik7XHJcbiAgICAgICAgICAgICAgICBoID0gMiA8PSBHLmxlbmd0aCAmJiBcInR5cGVcIiA9PSBHWzFdID8gaCArIChyICsgXCI9XCIgKyBtICsgXCImXCIpIDogaCArIChyICsgXCI9cmVkYWN0ZWQmXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZVxyXG4gICAgICAgIGggPSBudWxsO1xyXG5lbHNlXHJcbiAgICBoID0gZjsgcmV0dXJuIFwiWE1MSFRUUCBSRVEgKFwiICsgZCArIFwiKSBbYXR0ZW1wdCBcIiArIGUgKyBcIl06IFwiICsgYiArIFwiXFxuXCIgKyBjICsgXCJcXG5cIiArIGg7IH0pOyB9XHJcbmZ1bmN0aW9uIE9iKGEsIGIsIGMsIGQsIGUsIGYsIGgpIHsgYS5pbmZvKGZ1bmN0aW9uICgpIHsgcmV0dXJuIFwiWE1MSFRUUCBSRVNQIChcIiArIGQgKyBcIikgWyBhdHRlbXB0IFwiICsgZSArIFwiXTogXCIgKyBiICsgXCJcXG5cIiArIGMgKyBcIlxcblwiICsgZiArIFwiIFwiICsgaDsgfSk7IH1cclxuZnVuY3Rpb24gRihhLCBiLCBjLCBkKSB7IGEuaW5mbyhmdW5jdGlvbiAoKSB7IHJldHVybiBcIlhNTEhUVFAgVEVYVCAoXCIgKyBiICsgXCIpOiBcIiArIFBiKGEsIGMpICsgKGQgPyBcIiBcIiArIGQgOiBcIlwiKTsgfSk7IH1cclxuZnVuY3Rpb24gUWIoYSwgYikgeyBhLmluZm8oZnVuY3Rpb24gKCkgeyByZXR1cm4gXCJUSU1FT1VUOiBcIiArIGI7IH0pOyB9XHJcbk1iLnByb3RvdHlwZS5pbmZvID0gZnVuY3Rpb24gKCkgeyB9O1xyXG5mdW5jdGlvbiBQYihhLCBiKSB7IGlmICghYS5nKVxyXG4gICAgcmV0dXJuIGI7IGlmICghYilcclxuICAgIHJldHVybiBudWxsOyB0cnkge1xyXG4gICAgdmFyIGMgPSBKU09OLnBhcnNlKGIpO1xyXG4gICAgaWYgKGMpXHJcbiAgICAgICAgZm9yIChhID0gMDsgYSA8IGMubGVuZ3RoOyBhKyspXHJcbiAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGNbYV0pKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZCA9IGNbYV07XHJcbiAgICAgICAgICAgICAgICBpZiAoISgyID4gZC5sZW5ndGgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSBkWzFdO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGUpICYmICEoMSA+IGUubGVuZ3RoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZiA9IGVbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChcIm5vb3BcIiAhPSBmICYmIFwic3RvcFwiICE9IGYgJiYgXCJjbG9zZVwiICE9IGYpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBoID0gMTsgaCA8IGUubGVuZ3RoOyBoKyspXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZVtoXSA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICByZXR1cm4gcmIoYyk7XHJcbn1cclxuY2F0Y2ggKG4pIHtcclxuICAgIHJldHVybiBiO1xyXG59IH1cclxudmFyIEggPSB7fSwgUmIgPSBudWxsO1xyXG5mdW5jdGlvbiBTYigpIHsgcmV0dXJuIFJiID0gUmIgfHwgbmV3IEM7IH1cclxuSC5NYSA9IFwic2VydmVycmVhY2hhYmlsaXR5XCI7XHJcbmZ1bmN0aW9uIFRiKGEpIHsgei5jYWxsKHRoaXMsIEguTWEsIGEpOyB9XHJcbnQoVGIsIHopO1xyXG5mdW5jdGlvbiBJKGEpIHsgdmFyIGIgPSBTYigpOyBEKGIsIG5ldyBUYihiLCBhKSk7IH1cclxuSC5TVEFUX0VWRU5UID0gXCJzdGF0ZXZlbnRcIjtcclxuZnVuY3Rpb24gVWIoYSwgYikgeyB6LmNhbGwodGhpcywgSC5TVEFUX0VWRU5ULCBhKTsgdGhpcy5zdGF0ID0gYjsgfVxyXG50KFViLCB6KTtcclxuZnVuY3Rpb24gSihhKSB7IHZhciBiID0gU2IoKTsgRChiLCBuZXcgVWIoYiwgYSkpOyB9XHJcbkguTmEgPSBcInRpbWluZ2V2ZW50XCI7XHJcbmZ1bmN0aW9uIFZiKGEsIGIpIHsgei5jYWxsKHRoaXMsIEguTmEsIGEpOyB0aGlzLnNpemUgPSBiOyB9XHJcbnQoVmIsIHopO1xyXG5mdW5jdGlvbiBLKGEsIGIpIHsgaWYgKFwiZnVuY3Rpb25cIiAhPT0gdHlwZW9mIGEpXHJcbiAgICB0aHJvdyBFcnJvcihcIkZuIG11c3Qgbm90IGJlIG51bGwgYW5kIG11c3QgYmUgYSBmdW5jdGlvblwiKTsgcmV0dXJuIGwuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IGEoKTsgfSwgYik7IH1cclxudmFyIFdiID0geyBOT19FUlJPUjogMCwgbGI6IDEsIHliOiAyLCB4YjogMywgc2I6IDQsIHdiOiA1LCB6YjogNiwgSmE6IDcsIFRJTUVPVVQ6IDgsIENiOiA5IH07XHJcbnZhciBYYiA9IHsgcWI6IFwiY29tcGxldGVcIiwgTWI6IFwic3VjY2Vzc1wiLCBLYTogXCJlcnJvclwiLCBKYTogXCJhYm9ydFwiLCBFYjogXCJyZWFkeVwiLCBGYjogXCJyZWFkeXN0YXRlY2hhbmdlXCIsIFRJTUVPVVQ6IFwidGltZW91dFwiLCBBYjogXCJpbmNyZW1lbnRhbGRhdGFcIiwgRGI6IFwicHJvZ3Jlc3NcIiwgdGI6IFwiZG93bmxvYWRwcm9ncmVzc1wiLCBVYjogXCJ1cGxvYWRwcm9ncmVzc1wiIH07XHJcbmZ1bmN0aW9uIFliKCkgeyB9XHJcblliLnByb3RvdHlwZS5oID0gbnVsbDtcclxuZnVuY3Rpb24gWmIoYSkgeyByZXR1cm4gYS5oIHx8IChhLmggPSBhLmkoKSk7IH1cclxuZnVuY3Rpb24gJGIoKSB7IH1cclxudmFyIEwgPSB7IE9QRU46IFwiYVwiLCBwYjogXCJiXCIsIEthOiBcImNcIiwgQmI6IFwiZFwiIH07XHJcbmZ1bmN0aW9uIGFjKCkgeyB6LmNhbGwodGhpcywgXCJkXCIpOyB9XHJcbnQoYWMsIHopO1xyXG5mdW5jdGlvbiBiYygpIHsgei5jYWxsKHRoaXMsIFwiY1wiKTsgfVxyXG50KGJjLCB6KTtcclxudmFyIGNjO1xyXG5mdW5jdGlvbiBkYygpIHsgfVxyXG50KGRjLCBZYik7XHJcbmRjLnByb3RvdHlwZS5nID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gbmV3IFhNTEh0dHBSZXF1ZXN0OyB9O1xyXG5kYy5wcm90b3R5cGUuaSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHt9OyB9O1xyXG5jYyA9IG5ldyBkYztcclxuZnVuY3Rpb24gTShhLCBiLCBjLCBkKSB7IHRoaXMubCA9IGE7IHRoaXMuaiA9IGI7IHRoaXMubSA9IGM7IHRoaXMuWCA9IGQgfHwgMTsgdGhpcy5WID0gbmV3IEUodGhpcyk7IHRoaXMuUCA9IGVjOyBhID0gSmEgPyAxMjUgOiB2b2lkIDA7IHRoaXMuVyA9IG5ldyBFYihhKTsgdGhpcy5IID0gbnVsbDsgdGhpcy5pID0gITE7IHRoaXMucyA9IHRoaXMuQSA9IHRoaXMudiA9IHRoaXMuSyA9IHRoaXMuRiA9IHRoaXMuWSA9IHRoaXMuQiA9IG51bGw7IHRoaXMuRCA9IFtdOyB0aGlzLmcgPSBudWxsOyB0aGlzLkMgPSAwOyB0aGlzLm8gPSB0aGlzLnUgPSBudWxsOyB0aGlzLk4gPSAtMTsgdGhpcy5JID0gITE7IHRoaXMuTyA9IDA7IHRoaXMuTCA9IG51bGw7IHRoaXMuYWEgPSB0aGlzLkogPSB0aGlzLiQgPSB0aGlzLlUgPSAhMTsgdGhpcy5oID0gbmV3IGZjOyB9XHJcbmZ1bmN0aW9uIGZjKCkgeyB0aGlzLmkgPSBudWxsOyB0aGlzLmcgPSBcIlwiOyB0aGlzLmggPSAhMTsgfVxyXG52YXIgZWMgPSA0NUUzLCBnYyA9IHt9LCBoYyA9IHt9O1xyXG5rID0gTS5wcm90b3R5cGU7XHJcbmsuc2V0VGltZW91dCA9IGZ1bmN0aW9uIChhKSB7IHRoaXMuUCA9IGE7IH07XHJcbmZ1bmN0aW9uIGljKGEsIGIsIGMpIHsgYS5LID0gMTsgYS52ID0gamMoTihiKSk7IGEucyA9IGM7IGEuVSA9ICEwOyBrYyhhLCBudWxsKTsgfVxyXG5mdW5jdGlvbiBrYyhhLCBiKSB7IGEuRiA9IERhdGUubm93KCk7IGxjKGEpOyBhLkEgPSBOKGEudik7IHZhciBjID0gYS5BLCBkID0gYS5YOyBBcnJheS5pc0FycmF5KGQpIHx8IChkID0gW1N0cmluZyhkKV0pOyBtYyhjLmgsIFwidFwiLCBkKTsgYS5DID0gMDsgYyA9IGEubC5IOyBhLmggPSBuZXcgZmM7IGEuZyA9IG5jKGEubCwgYyA/IGIgOiBudWxsLCAhYS5zKTsgMCA8IGEuTyAmJiAoYS5MID0gbmV3IEliKHEoYS5JYSwgYSwgYS5nKSwgYS5PKSk7IEtiKGEuViwgYS5nLCBcInJlYWR5c3RhdGVjaGFuZ2VcIiwgYS5nYik7IGIgPSBhLkggPyB5YShhLkgpIDoge307IGEucyA/IChhLnUgfHwgKGEudSA9IFwiUE9TVFwiKSwgYltcIkNvbnRlbnQtVHlwZVwiXSA9IFwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkXCIsIGEuZy5lYShhLkEsIGEudSwgYS5zLCBiKSkgOiAoYS51ID0gXCJHRVRcIiwgYS5nLmVhKGEuQSwgYS51LCBudWxsLCBiKSk7IEkoMSk7IE5iKGEuaiwgYS51LCBhLkEsIGEubSwgYS5YLCBhLnMpOyB9XHJcbmsuZ2IgPSBmdW5jdGlvbiAoYSkgeyBhID0gYS50YXJnZXQ7IHZhciBiID0gdGhpcy5MOyBiICYmIDMgPT0gTyhhKSA/IGIubCgpIDogdGhpcy5JYShhKTsgfTtcclxuay5JYSA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGlmIChhID09IHRoaXMuZylcclxuICAgICAgICAgICAgYToge1xyXG4gICAgICAgICAgICAgICAgdmFyIHIgPSBPKHRoaXMuZyk7XHJcbiAgICAgICAgICAgICAgICB2YXIgYiA9IHRoaXMuZy5EYSgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIEcgPSB0aGlzLmcuYmEoKTtcclxuICAgICAgICAgICAgICAgIGlmICghKDMgPiByKSAmJiAoMyAhPSByIHx8IEphIHx8IHRoaXMuZyAmJiAodGhpcy5oLmggfHwgdGhpcy5nLmdhKCkgfHwgb2ModGhpcy5nKSkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5JIHx8IDQgIT0gciB8fCA3ID09IGIgfHwgKDggPT0gYiB8fCAwID49IEcgPyBJKDMpIDogSSgyKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcGModGhpcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSB0aGlzLmcuYmEoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLk4gPSBjO1xyXG4gICAgICAgICAgICAgICAgICAgIGI6IGlmIChxYyh0aGlzKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IG9jKHRoaXMuZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGEgPSBcIlwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IGQubGVuZ3RoLCBmID0gNCA9PSBPKHRoaXMuZyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5oLmkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChcInVuZGVmaW5lZFwiID09PSB0eXBlb2YgVGV4dERlY29kZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJjKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoID0gXCJcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhayBiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oLmkgPSBuZXcgbC5UZXh0RGVjb2RlcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGIgPSAwOyBiIDwgZTsgYisrKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oLmggPSAhMCwgYSArPSB0aGlzLmguaS5kZWNvZGUoZFtiXSwgeyBzdHJlYW06IGYgJiYgYiA9PSBlIC0gMSB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZC5zcGxpY2UoMCwgZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaC5nICs9IGE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuQyA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGggPSB0aGlzLmguZztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBoID0gdGhpcy5nLmdhKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pID0gMjAwID09IGM7XHJcbiAgICAgICAgICAgICAgICAgICAgT2IodGhpcy5qLCB0aGlzLnUsIHRoaXMuQSwgdGhpcy5tLCB0aGlzLlgsIHIsIGMpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuJCAmJiAhdGhpcy5KKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbiwgdSA9IHRoaXMuZztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChuID0gdS5nID8gdS5nLmdldFJlc3BvbnNlSGVhZGVyKFwiWC1IVFRQLUluaXRpYWwtUmVzcG9uc2VcIikgOiBudWxsKSAmJiAhc2EobikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtID0gbjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrIGI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYyA9IG0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRih0aGlzLmosIHRoaXMubSwgYywgXCJJbml0aWFsIGhhbmRzaGFrZSByZXNwb25zZSB2aWEgWC1IVFRQLUluaXRpYWwtUmVzcG9uc2VcIiksIHRoaXMuSiA9ICEwLCBzYyh0aGlzLCBjKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaSA9ICExO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubyA9IDM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSigxMik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUCh0aGlzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYyh0aGlzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhayBhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuVSA/ICh0Yyh0aGlzLCByLCBoKSwgSmEgJiYgdGhpcy5pICYmIDMgPT0gciAmJiAoS2IodGhpcy5WLCB0aGlzLlcsIFwidGlja1wiLCB0aGlzLmZiKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuVy5zdGFydCgpKSkgOiAoRih0aGlzLmosIHRoaXMubSwgaCwgbnVsbCksIHNjKHRoaXMsIGgpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgNCA9PSByICYmIFAodGhpcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaSAmJiAhdGhpcy5JICYmICg0ID09IHIgPyB1Yyh0aGlzLmwsIHRoaXMpIDogKHRoaXMuaSA9ICExLCBsYyh0aGlzKSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDQwMCA9PSBjICYmIDAgPCBoLmluZGV4T2YoXCJVbmtub3duIFNJRFwiKSA/ICh0aGlzLm8gPSAzLCBKKDEyKSkgOiAodGhpcy5vID0gMCwgSigxMykpLCBQKHRoaXMpLCByYyh0aGlzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgY2F0Y2ggKHIpIHsgfVxyXG4gICAgZmluYWxseSB7IH1cclxufTtcclxuZnVuY3Rpb24gcWMoYSkgeyByZXR1cm4gYS5nID8gXCJHRVRcIiA9PSBhLnUgJiYgMiAhPSBhLksgJiYgYS5sLkJhIDogITE7IH1cclxuZnVuY3Rpb24gdGMoYSwgYiwgYykge1xyXG4gICAgdmFyIGQgPSAhMCwgZTtcclxuICAgIGZvciAoOyAhYS5JICYmIGEuQyA8IGMubGVuZ3RoOylcclxuICAgICAgICBpZiAoZSA9IHZjKGEsIGMpLCBlID09IGhjKSB7XHJcbiAgICAgICAgICAgIDQgPT0gYiAmJiAoYS5vID0gNCwgSigxNCksIGQgPSAhMSk7XHJcbiAgICAgICAgICAgIEYoYS5qLCBhLm0sIG51bGwsIFwiW0luY29tcGxldGUgUmVzcG9uc2VdXCIpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoZSA9PSBnYykge1xyXG4gICAgICAgICAgICBhLm8gPSA0O1xyXG4gICAgICAgICAgICBKKDE1KTtcclxuICAgICAgICAgICAgRihhLmosIGEubSwgYywgXCJbSW52YWxpZCBDaHVua11cIik7XHJcbiAgICAgICAgICAgIGQgPSAhMTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgRihhLmosIGEubSwgZSwgbnVsbCksIHNjKGEsIGUpO1xyXG4gICAgcWMoYSkgJiYgZSAhPSBoYyAmJiBlICE9IGdjICYmIChhLmguZyA9IFwiXCIsIGEuQyA9IDApO1xyXG4gICAgNCAhPSBiIHx8IDAgIT0gYy5sZW5ndGggfHwgYS5oLmggfHwgKGEubyA9IDEsIEooMTYpLCBkID0gITEpO1xyXG4gICAgYS5pID0gYS5pICYmIGQ7XHJcbiAgICBkID8gMCA8IGMubGVuZ3RoICYmICFhLmFhICYmIChhLmFhID0gITAsIGIgPSBhLmwsIGIuZyA9PSBhICYmIGIuJCAmJiAhYi5MICYmIChiLmguaW5mbyhcIkdyZWF0LCBubyBidWZmZXJpbmcgcHJveHkgZGV0ZWN0ZWQuIEJ5dGVzIHJlY2VpdmVkOiBcIiArIGMubGVuZ3RoKSwgd2MoYiksIGIuTCA9ICEwLCBKKDExKSkpIDogKEYoYS5qLCBhLm0sIGMsIFwiW0ludmFsaWQgQ2h1bmtlZCBSZXNwb25zZV1cIiksIFAoYSksIHJjKGEpKTtcclxufVxyXG5rLmZiID0gZnVuY3Rpb24gKCkgeyBpZiAodGhpcy5nKSB7XHJcbiAgICB2YXIgYSA9IE8odGhpcy5nKSwgYiA9IHRoaXMuZy5nYSgpO1xyXG4gICAgdGhpcy5DIDwgYi5sZW5ndGggJiYgKHBjKHRoaXMpLCB0Yyh0aGlzLCBhLCBiKSwgdGhpcy5pICYmIDQgIT0gYSAmJiBsYyh0aGlzKSk7XHJcbn0gfTtcclxuZnVuY3Rpb24gdmMoYSwgYikgeyB2YXIgYyA9IGEuQywgZCA9IGIuaW5kZXhPZihcIlxcblwiLCBjKTsgaWYgKC0xID09IGQpXHJcbiAgICByZXR1cm4gaGM7IGMgPSBOdW1iZXIoYi5zdWJzdHJpbmcoYywgZCkpOyBpZiAoaXNOYU4oYykpXHJcbiAgICByZXR1cm4gZ2M7IGQgKz0gMTsgaWYgKGQgKyBjID4gYi5sZW5ndGgpXHJcbiAgICByZXR1cm4gaGM7IGIgPSBiLnN1YnN0cihkLCBjKTsgYS5DID0gZCArIGM7IHJldHVybiBiOyB9XHJcbmsuY2FuY2VsID0gZnVuY3Rpb24gKCkgeyB0aGlzLkkgPSAhMDsgUCh0aGlzKTsgfTtcclxuZnVuY3Rpb24gbGMoYSkgeyBhLlkgPSBEYXRlLm5vdygpICsgYS5QOyB4YyhhLCBhLlApOyB9XHJcbmZ1bmN0aW9uIHhjKGEsIGIpIHsgaWYgKG51bGwgIT0gYS5CKVxyXG4gICAgdGhyb3cgRXJyb3IoXCJXYXRjaERvZyB0aW1lciBub3QgbnVsbFwiKTsgYS5CID0gSyhxKGEuZWIsIGEpLCBiKTsgfVxyXG5mdW5jdGlvbiBwYyhhKSB7IGEuQiAmJiAobC5jbGVhclRpbWVvdXQoYS5CKSwgYS5CID0gbnVsbCk7IH1cclxuay5lYiA9IGZ1bmN0aW9uICgpIHsgdGhpcy5CID0gbnVsbDsgdmFyIGEgPSBEYXRlLm5vdygpOyAwIDw9IGEgLSB0aGlzLlkgPyAoUWIodGhpcy5qLCB0aGlzLkEpLCAyICE9IHRoaXMuSyAmJiAoSSgzKSwgSigxNykpLCBQKHRoaXMpLCB0aGlzLm8gPSAyLCByYyh0aGlzKSkgOiB4Yyh0aGlzLCB0aGlzLlkgLSBhKTsgfTtcclxuZnVuY3Rpb24gcmMoYSkgeyAwID09IGEubC5HIHx8IGEuSSB8fCB1YyhhLmwsIGEpOyB9XHJcbmZ1bmN0aW9uIFAoYSkgeyBwYyhhKTsgdmFyIGIgPSBhLkw7IGIgJiYgXCJmdW5jdGlvblwiID09IHR5cGVvZiBiLm5hICYmIGIubmEoKTsgYS5MID0gbnVsbDsgRmIoYS5XKTsgTGIoYS5WKTsgYS5nICYmIChiID0gYS5nLCBhLmcgPSBudWxsLCBiLmFib3J0KCksIGIubmEoKSk7IH1cclxuZnVuY3Rpb24gc2MoYSwgYikge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICB2YXIgYyA9IGEubDtcclxuICAgICAgICBpZiAoMCAhPSBjLkcgJiYgKGMuZyA9PSBhIHx8IHljKGMuaSwgYSkpKVxyXG4gICAgICAgICAgICBpZiAoYy5JID0gYS5OLCAhYS5KICYmIHljKGMuaSwgYSkgJiYgMyA9PSBjLkcpIHtcclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSBjLkNhLmcucGFyc2UoYik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYXRjaCAobSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZCkgJiYgMyA9PSBkLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBlID0gZDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoMCA9PSBlWzBdKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWMudSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjLmcpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjLmcuRiArIDNFMyA8IGEuRilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHpjKGMpLCBBYyhjKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsgYTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBCYyhjKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBKKDE4KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgYy50YSA9IGVbMV0sIDAgPCBjLnRhIC0gYy5VICYmIDM3NTAwID4gZVsyXSAmJiBjLk4gJiYgMCA9PSBjLkEgJiYgIWMudiAmJiAoYy52ID0gSyhxKGMuYWIsIGMpLCA2RTMpKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoMSA+PSBDYyhjLmkpICYmIGMua2EpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMua2EoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAobSkgeyB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGMua2EgPSB2b2lkIDA7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIFEoYywgMTEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKChhLkogfHwgYy5nID09IGEpICYmIHpjKGMpLCAhc2EoYikpXHJcbiAgICAgICAgICAgICAgICBmb3IgKGUgPSBjLkNhLmcucGFyc2UoYiksIGIgPSAwOyBiIDwgZS5sZW5ndGg7IGIrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBtID0gZVtiXTtcclxuICAgICAgICAgICAgICAgICAgICBjLlUgPSBtWzBdO1xyXG4gICAgICAgICAgICAgICAgICAgIG0gPSBtWzFdO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgyID09IGMuRylcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFwiY1wiID09IG1bMF0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMuSiA9IG1bMV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjLmxhID0gbVsyXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByID0gbVszXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bGwgIT0gciAmJiAoYy5tYSA9IHIsIGMuaC5pbmZvKFwiVkVSPVwiICsgYy5tYSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIEcgPSBtWzRdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVsbCAhPSBHICYmIChjLnphID0gRywgYy5oLmluZm8oXCJTVkVSPVwiICsgYy56YSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIERhID0gbVs1XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bGwgIT0gRGEgJiYgXCJudW1iZXJcIiA9PT0gdHlwZW9mIERhICYmIDAgPCBEYSAmJiAoZCA9IDEuNSAqIERhLCBjLksgPSBkLCBjLmguaW5mbyhcImJhY2tDaGFubmVsUmVxdWVzdFRpbWVvdXRNc189XCIgKyBkKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkID0gYztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYSA9IGEuZztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjYSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBFYSA9IGNhLmcgPyBjYS5nLmdldFJlc3BvbnNlSGVhZGVyKFwiWC1DbGllbnQtV2lyZS1Qcm90b2NvbFwiKSA6IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEVhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmID0gZC5pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAhZi5nICYmICh3KEVhLCBcInNwZHlcIikgfHwgdyhFYSwgXCJxdWljXCIpIHx8IHcoRWEsIFwiaDJcIikpICYmIChmLmogPSBmLmwsIGYuZyA9IG5ldyBTZXQsIGYuaCAmJiAoRGMoZiwgZi5oKSwgZi5oID0gbnVsbCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZC5EKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4YiA9IGNhLmcgPyBjYS5nLmdldFJlc3BvbnNlSGVhZGVyKFwiWC1IVFRQLVNlc3Npb24tSWRcIikgOiBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4YiAmJiAoZC5zYSA9IHhiLCBSKGQuRiwgZC5ELCB4YikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMuRyA9IDM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjLmogJiYgYy5qLnhhKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjLiQgJiYgKGMuTyA9IERhdGUubm93KCkgLSBhLkYsIGMuaC5pbmZvKFwiSGFuZHNoYWtlIFJUVDogXCIgKyBjLk8gKyBcIm1zXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQgPSBjO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGggPSBhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5vYSA9IEVjKGQsIGQuSCA/IGQubGEgOiBudWxsLCBkLlcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGguSikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZjKGQuaSwgaCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG4gPSBoLCB1ID0gZC5LO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHUgJiYgbi5zZXRUaW1lb3V0KHUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4uQiAmJiAocGMobiksIGxjKG4pKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLmcgPSBoO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdjKGQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgMCA8IGMubC5sZW5ndGggJiYgSGMoYyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdG9wXCIgIT0gbVswXSAmJiBcImNsb3NlXCIgIT0gbVswXSB8fCBRKGMsIDcpO1xyXG4gICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgMyA9PSBjLkcgJiYgKFwic3RvcFwiID09IG1bMF0gfHwgXCJjbG9zZVwiID09IG1bMF0gPyBcInN0b3BcIiA9PSBtWzBdID8gUShjLCA3KSA6IEljKGMpIDogXCJub29wXCIgIT0gbVswXSAmJiBjLmogJiYgYy5qLndhKG0pLCBjLkEgPSAwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICBJKDQpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKG0pIHsgfVxyXG59XHJcbmZ1bmN0aW9uIEpjKGEpIHsgaWYgKGEuUiAmJiBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIGEuUilcclxuICAgIHJldHVybiBhLlIoKTsgaWYgKFwic3RyaW5nXCIgPT09IHR5cGVvZiBhKVxyXG4gICAgcmV0dXJuIGEuc3BsaXQoXCJcIik7IGlmIChiYShhKSkge1xyXG4gICAgZm9yICh2YXIgYiA9IFtdLCBjID0gYS5sZW5ndGgsIGQgPSAwOyBkIDwgYzsgZCsrKVxyXG4gICAgICAgIGIucHVzaChhW2RdKTtcclxuICAgIHJldHVybiBiO1xyXG59IGIgPSBbXTsgYyA9IDA7IGZvciAoZCBpbiBhKVxyXG4gICAgYltjKytdID0gYVtkXTsgcmV0dXJuIGI7IH1cclxuZnVuY3Rpb24gS2MoYSwgYikgeyBpZiAoYS5mb3JFYWNoICYmIFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgYS5mb3JFYWNoKVxyXG4gICAgYS5mb3JFYWNoKGIsIHZvaWQgMCk7XHJcbmVsc2UgaWYgKGJhKGEpIHx8IFwic3RyaW5nXCIgPT09IHR5cGVvZiBhKVxyXG4gICAgbmEoYSwgYiwgdm9pZCAwKTtcclxuZWxzZSB7XHJcbiAgICBpZiAoYS5UICYmIFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgYS5UKVxyXG4gICAgICAgIHZhciBjID0gYS5UKCk7XHJcbiAgICBlbHNlIGlmIChhLlIgJiYgXCJmdW5jdGlvblwiID09IHR5cGVvZiBhLlIpXHJcbiAgICAgICAgYyA9IHZvaWQgMDtcclxuICAgIGVsc2UgaWYgKGJhKGEpIHx8IFwic3RyaW5nXCIgPT09IHR5cGVvZiBhKSB7XHJcbiAgICAgICAgYyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIGQgPSBhLmxlbmd0aCwgZSA9IDA7IGUgPCBkOyBlKyspXHJcbiAgICAgICAgICAgIGMucHVzaChlKTtcclxuICAgIH1cclxuICAgIGVsc2VcclxuICAgICAgICBmb3IgKGUgaW4gYyA9IFtdLCBkID0gMCwgYSlcclxuICAgICAgICAgICAgY1tkKytdID0gZTtcclxuICAgIGQgPSBKYyhhKTtcclxuICAgIGUgPSBkLmxlbmd0aDtcclxuICAgIGZvciAodmFyIGYgPSAwOyBmIDwgZTsgZisrKVxyXG4gICAgICAgIGIuY2FsbCh2b2lkIDAsIGRbZl0sIGMgJiYgY1tmXSwgYSk7XHJcbn0gfVxyXG5mdW5jdGlvbiBTKGEsIGIpIHsgdGhpcy5oID0ge307IHRoaXMuZyA9IFtdOyB0aGlzLmkgPSAwOyB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGg7IGlmICgxIDwgYykge1xyXG4gICAgaWYgKGMgJSAyKVxyXG4gICAgICAgIHRocm93IEVycm9yKFwiVW5ldmVuIG51bWJlciBvZiBhcmd1bWVudHNcIik7XHJcbiAgICBmb3IgKHZhciBkID0gMDsgZCA8IGM7IGQgKz0gMilcclxuICAgICAgICB0aGlzLnNldChhcmd1bWVudHNbZF0sIGFyZ3VtZW50c1tkICsgMV0pO1xyXG59XHJcbmVsc2UgaWYgKGEpXHJcbiAgICBpZiAoYSBpbnN0YW5jZW9mIFMpXHJcbiAgICAgICAgZm9yIChjID0gYS5UKCksIGQgPSAwOyBkIDwgYy5sZW5ndGg7IGQrKylcclxuICAgICAgICAgICAgdGhpcy5zZXQoY1tkXSwgYS5nZXQoY1tkXSkpO1xyXG4gICAgZWxzZVxyXG4gICAgICAgIGZvciAoZCBpbiBhKVxyXG4gICAgICAgICAgICB0aGlzLnNldChkLCBhW2RdKTsgfVxyXG5rID0gUy5wcm90b3R5cGU7XHJcbmsuUiA9IGZ1bmN0aW9uICgpIHsgTGModGhpcyk7IGZvciAodmFyIGEgPSBbXSwgYiA9IDA7IGIgPCB0aGlzLmcubGVuZ3RoOyBiKyspXHJcbiAgICBhLnB1c2godGhpcy5oW3RoaXMuZ1tiXV0pOyByZXR1cm4gYTsgfTtcclxuay5UID0gZnVuY3Rpb24gKCkgeyBMYyh0aGlzKTsgcmV0dXJuIHRoaXMuZy5jb25jYXQoKTsgfTtcclxuZnVuY3Rpb24gTGMoYSkgeyBpZiAoYS5pICE9IGEuZy5sZW5ndGgpIHtcclxuICAgIGZvciAodmFyIGIgPSAwLCBjID0gMDsgYiA8IGEuZy5sZW5ndGg7KSB7XHJcbiAgICAgICAgdmFyIGQgPSBhLmdbYl07XHJcbiAgICAgICAgVChhLmgsIGQpICYmIChhLmdbYysrXSA9IGQpO1xyXG4gICAgICAgIGIrKztcclxuICAgIH1cclxuICAgIGEuZy5sZW5ndGggPSBjO1xyXG59IGlmIChhLmkgIT0gYS5nLmxlbmd0aCkge1xyXG4gICAgdmFyIGUgPSB7fTtcclxuICAgIGZvciAoYyA9IGIgPSAwOyBiIDwgYS5nLmxlbmd0aDspXHJcbiAgICAgICAgZCA9IGEuZ1tiXSwgVChlLCBkKSB8fCAoYS5nW2MrK10gPSBkLCBlW2RdID0gMSksIGIrKztcclxuICAgIGEuZy5sZW5ndGggPSBjO1xyXG59IH1cclxuay5nZXQgPSBmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gVCh0aGlzLmgsIGEpID8gdGhpcy5oW2FdIDogYjsgfTtcclxuay5zZXQgPSBmdW5jdGlvbiAoYSwgYikgeyBUKHRoaXMuaCwgYSkgfHwgKHRoaXMuaSsrLCB0aGlzLmcucHVzaChhKSk7IHRoaXMuaFthXSA9IGI7IH07XHJcbmsuZm9yRWFjaCA9IGZ1bmN0aW9uIChhLCBiKSB7IGZvciAodmFyIGMgPSB0aGlzLlQoKSwgZCA9IDA7IGQgPCBjLmxlbmd0aDsgZCsrKSB7XHJcbiAgICB2YXIgZSA9IGNbZF0sIGYgPSB0aGlzLmdldChlKTtcclxuICAgIGEuY2FsbChiLCBmLCBlLCB0aGlzKTtcclxufSB9O1xyXG5mdW5jdGlvbiBUKGEsIGIpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChhLCBiKTsgfVxyXG52YXIgTWMgPSAvXig/OihbXjovPyMuXSspOik/KD86XFwvXFwvKD86KFteXFxcXC8/I10qKUApPyhbXlxcXFwvPyNdKj8pKD86OihbMC05XSspKT8oPz1bXFxcXC8/I118JCkpPyhbXj8jXSspPyg/OlxcPyhbXiNdKikpPyg/OiMoW1xcc1xcU10qKSk/JC87XHJcbmZ1bmN0aW9uIE5jKGEsIGIpIHsgaWYgKGEpIHtcclxuICAgIGEgPSBhLnNwbGl0KFwiJlwiKTtcclxuICAgIGZvciAodmFyIGMgPSAwOyBjIDwgYS5sZW5ndGg7IGMrKykge1xyXG4gICAgICAgIHZhciBkID0gYVtjXS5pbmRleE9mKFwiPVwiKSwgZSA9IG51bGw7XHJcbiAgICAgICAgaWYgKDAgPD0gZCkge1xyXG4gICAgICAgICAgICB2YXIgZiA9IGFbY10uc3Vic3RyaW5nKDAsIGQpO1xyXG4gICAgICAgICAgICBlID0gYVtjXS5zdWJzdHJpbmcoZCArIDEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIGYgPSBhW2NdO1xyXG4gICAgICAgIGIoZiwgZSA/IGRlY29kZVVSSUNvbXBvbmVudChlLnJlcGxhY2UoL1xcKy9nLCBcIiBcIikpIDogXCJcIik7XHJcbiAgICB9XHJcbn0gfVxyXG5mdW5jdGlvbiBVKGEsIGIpIHsgdGhpcy5pID0gdGhpcy5zID0gdGhpcy5qID0gXCJcIjsgdGhpcy5tID0gbnVsbDsgdGhpcy5vID0gdGhpcy5sID0gXCJcIjsgdGhpcy5nID0gITE7IGlmIChhIGluc3RhbmNlb2YgVSkge1xyXG4gICAgdGhpcy5nID0gdm9pZCAwICE9PSBiID8gYiA6IGEuZztcclxuICAgIE9jKHRoaXMsIGEuaik7XHJcbiAgICB0aGlzLnMgPSBhLnM7XHJcbiAgICBQYyh0aGlzLCBhLmkpO1xyXG4gICAgUWModGhpcywgYS5tKTtcclxuICAgIHRoaXMubCA9IGEubDtcclxuICAgIGIgPSBhLmg7XHJcbiAgICB2YXIgYyA9IG5ldyBSYztcclxuICAgIGMuaSA9IGIuaTtcclxuICAgIGIuZyAmJiAoYy5nID0gbmV3IFMoYi5nKSwgYy5oID0gYi5oKTtcclxuICAgIFNjKHRoaXMsIGMpO1xyXG4gICAgdGhpcy5vID0gYS5vO1xyXG59XHJcbmVsc2VcclxuICAgIGEgJiYgKGMgPSBTdHJpbmcoYSkubWF0Y2goTWMpKSA/ICh0aGlzLmcgPSAhIWIsIE9jKHRoaXMsIGNbMV0gfHwgXCJcIiwgITApLCB0aGlzLnMgPSBUYyhjWzJdIHx8IFwiXCIpLCBQYyh0aGlzLCBjWzNdIHx8IFwiXCIsICEwKSwgUWModGhpcywgY1s0XSksIHRoaXMubCA9IFRjKGNbNV0gfHwgXCJcIiwgITApLCBTYyh0aGlzLCBjWzZdIHx8IFwiXCIsICEwKSwgdGhpcy5vID0gVGMoY1s3XSB8fCBcIlwiKSkgOiAodGhpcy5nID0gISFiLCB0aGlzLmggPSBuZXcgUmMobnVsbCwgdGhpcy5nKSk7IH1cclxuVS5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7IHZhciBhID0gW10sIGIgPSB0aGlzLmo7IGIgJiYgYS5wdXNoKFVjKGIsIFZjLCAhMCksIFwiOlwiKTsgdmFyIGMgPSB0aGlzLmk7IGlmIChjIHx8IFwiZmlsZVwiID09IGIpXHJcbiAgICBhLnB1c2goXCIvL1wiKSwgKGIgPSB0aGlzLnMpICYmIGEucHVzaChVYyhiLCBWYywgITApLCBcIkBcIiksIGEucHVzaChlbmNvZGVVUklDb21wb25lbnQoU3RyaW5nKGMpKS5yZXBsYWNlKC8lMjUoWzAtOWEtZkEtRl17Mn0pL2csIFwiJSQxXCIpKSwgYyA9IHRoaXMubSwgbnVsbCAhPSBjICYmIGEucHVzaChcIjpcIiwgU3RyaW5nKGMpKTsgaWYgKGMgPSB0aGlzLmwpXHJcbiAgICB0aGlzLmkgJiYgXCIvXCIgIT0gYy5jaGFyQXQoMCkgJiYgYS5wdXNoKFwiL1wiKSwgYS5wdXNoKFVjKGMsIFwiL1wiID09IGMuY2hhckF0KDApID8gV2MgOiBYYywgITApKTsgKGMgPSB0aGlzLmgudG9TdHJpbmcoKSkgJiYgYS5wdXNoKFwiP1wiLCBjKTsgKGMgPSB0aGlzLm8pICYmIGEucHVzaChcIiNcIiwgVWMoYywgWWMpKTsgcmV0dXJuIGEuam9pbihcIlwiKTsgfTtcclxuZnVuY3Rpb24gTihhKSB7IHJldHVybiBuZXcgVShhKTsgfVxyXG5mdW5jdGlvbiBPYyhhLCBiLCBjKSB7IGEuaiA9IGMgPyBUYyhiLCAhMCkgOiBiOyBhLmogJiYgKGEuaiA9IGEuai5yZXBsYWNlKC86JC8sIFwiXCIpKTsgfVxyXG5mdW5jdGlvbiBQYyhhLCBiLCBjKSB7IGEuaSA9IGMgPyBUYyhiLCAhMCkgOiBiOyB9XHJcbmZ1bmN0aW9uIFFjKGEsIGIpIHsgaWYgKGIpIHtcclxuICAgIGIgPSBOdW1iZXIoYik7XHJcbiAgICBpZiAoaXNOYU4oYikgfHwgMCA+IGIpXHJcbiAgICAgICAgdGhyb3cgRXJyb3IoXCJCYWQgcG9ydCBudW1iZXIgXCIgKyBiKTtcclxuICAgIGEubSA9IGI7XHJcbn1cclxuZWxzZVxyXG4gICAgYS5tID0gbnVsbDsgfVxyXG5mdW5jdGlvbiBTYyhhLCBiLCBjKSB7IGIgaW5zdGFuY2VvZiBSYyA/IChhLmggPSBiLCBaYyhhLmgsIGEuZykpIDogKGMgfHwgKGIgPSBVYyhiLCAkYykpLCBhLmggPSBuZXcgUmMoYiwgYS5nKSk7IH1cclxuZnVuY3Rpb24gUihhLCBiLCBjKSB7IGEuaC5zZXQoYiwgYyk7IH1cclxuZnVuY3Rpb24gamMoYSkgeyBSKGEsIFwienhcIiwgTWF0aC5mbG9vcigyMTQ3NDgzNjQ4ICogTWF0aC5yYW5kb20oKSkudG9TdHJpbmcoMzYpICsgTWF0aC5hYnMoTWF0aC5mbG9vcigyMTQ3NDgzNjQ4ICogTWF0aC5yYW5kb20oKSkgXiBEYXRlLm5vdygpKS50b1N0cmluZygzNikpOyByZXR1cm4gYTsgfVxyXG5mdW5jdGlvbiBhZChhKSB7IHJldHVybiBhIGluc3RhbmNlb2YgVSA/IE4oYSkgOiBuZXcgVShhLCB2b2lkIDApOyB9XHJcbmZ1bmN0aW9uIGJkKGEsIGIsIGMsIGQpIHsgdmFyIGUgPSBuZXcgVShudWxsLCB2b2lkIDApOyBhICYmIE9jKGUsIGEpOyBiICYmIFBjKGUsIGIpOyBjICYmIFFjKGUsIGMpOyBkICYmIChlLmwgPSBkKTsgcmV0dXJuIGU7IH1cclxuZnVuY3Rpb24gVGMoYSwgYikgeyByZXR1cm4gYSA/IGIgPyBkZWNvZGVVUkkoYS5yZXBsYWNlKC8lMjUvZywgXCIlMjUyNVwiKSkgOiBkZWNvZGVVUklDb21wb25lbnQoYSkgOiBcIlwiOyB9XHJcbmZ1bmN0aW9uIFVjKGEsIGIsIGMpIHsgcmV0dXJuIFwic3RyaW5nXCIgPT09IHR5cGVvZiBhID8gKGEgPSBlbmNvZGVVUkkoYSkucmVwbGFjZShiLCBjZCksIGMgJiYgKGEgPSBhLnJlcGxhY2UoLyUyNShbMC05YS1mQS1GXXsyfSkvZywgXCIlJDFcIikpLCBhKSA6IG51bGw7IH1cclxuZnVuY3Rpb24gY2QoYSkgeyBhID0gYS5jaGFyQ29kZUF0KDApOyByZXR1cm4gXCIlXCIgKyAoYSA+PiA0ICYgMTUpLnRvU3RyaW5nKDE2KSArIChhICYgMTUpLnRvU3RyaW5nKDE2KTsgfVxyXG52YXIgVmMgPSAvWyNcXC9cXD9AXS9nLCBYYyA9IC9bI1xcPzpdL2csIFdjID0gL1sjXFw/XS9nLCAkYyA9IC9bI1xcP0BdL2csIFljID0gLyMvZztcclxuZnVuY3Rpb24gUmMoYSwgYikgeyB0aGlzLmggPSB0aGlzLmcgPSBudWxsOyB0aGlzLmkgPSBhIHx8IG51bGw7IHRoaXMuaiA9ICEhYjsgfVxyXG5mdW5jdGlvbiBWKGEpIHsgYS5nIHx8IChhLmcgPSBuZXcgUywgYS5oID0gMCwgYS5pICYmIE5jKGEuaSwgZnVuY3Rpb24gKGIsIGMpIHsgYS5hZGQoZGVjb2RlVVJJQ29tcG9uZW50KGIucmVwbGFjZSgvXFwrL2csIFwiIFwiKSksIGMpOyB9KSk7IH1cclxuayA9IFJjLnByb3RvdHlwZTtcclxuay5hZGQgPSBmdW5jdGlvbiAoYSwgYikgeyBWKHRoaXMpOyB0aGlzLmkgPSBudWxsOyBhID0gVyh0aGlzLCBhKTsgdmFyIGMgPSB0aGlzLmcuZ2V0KGEpOyBjIHx8IHRoaXMuZy5zZXQoYSwgYyA9IFtdKTsgYy5wdXNoKGIpOyB0aGlzLmggKz0gMTsgcmV0dXJuIHRoaXM7IH07XHJcbmZ1bmN0aW9uIGRkKGEsIGIpIHsgVihhKTsgYiA9IFcoYSwgYik7IFQoYS5nLmgsIGIpICYmIChhLmkgPSBudWxsLCBhLmggLT0gYS5nLmdldChiKS5sZW5ndGgsIGEgPSBhLmcsIFQoYS5oLCBiKSAmJiAoZGVsZXRlIGEuaFtiXSwgYS5pLS0sIGEuZy5sZW5ndGggPiAyICogYS5pICYmIExjKGEpKSk7IH1cclxuZnVuY3Rpb24gZWQoYSwgYikgeyBWKGEpOyBiID0gVyhhLCBiKTsgcmV0dXJuIFQoYS5nLmgsIGIpOyB9XHJcbmsuZm9yRWFjaCA9IGZ1bmN0aW9uIChhLCBiKSB7IFYodGhpcyk7IHRoaXMuZy5mb3JFYWNoKGZ1bmN0aW9uIChjLCBkKSB7IG5hKGMsIGZ1bmN0aW9uIChlKSB7IGEuY2FsbChiLCBlLCBkLCB0aGlzKTsgfSwgdGhpcyk7IH0sIHRoaXMpOyB9O1xyXG5rLlQgPSBmdW5jdGlvbiAoKSB7IFYodGhpcyk7IGZvciAodmFyIGEgPSB0aGlzLmcuUigpLCBiID0gdGhpcy5nLlQoKSwgYyA9IFtdLCBkID0gMDsgZCA8IGIubGVuZ3RoOyBkKyspXHJcbiAgICBmb3IgKHZhciBlID0gYVtkXSwgZiA9IDA7IGYgPCBlLmxlbmd0aDsgZisrKVxyXG4gICAgICAgIGMucHVzaChiW2RdKTsgcmV0dXJuIGM7IH07XHJcbmsuUiA9IGZ1bmN0aW9uIChhKSB7IFYodGhpcyk7IHZhciBiID0gW107IGlmIChcInN0cmluZ1wiID09PSB0eXBlb2YgYSlcclxuICAgIGVkKHRoaXMsIGEpICYmIChiID0gcWEoYiwgdGhpcy5nLmdldChXKHRoaXMsIGEpKSkpO1xyXG5lbHNlIHtcclxuICAgIGEgPSB0aGlzLmcuUigpO1xyXG4gICAgZm9yICh2YXIgYyA9IDA7IGMgPCBhLmxlbmd0aDsgYysrKVxyXG4gICAgICAgIGIgPSBxYShiLCBhW2NdKTtcclxufSByZXR1cm4gYjsgfTtcclxuay5zZXQgPSBmdW5jdGlvbiAoYSwgYikgeyBWKHRoaXMpOyB0aGlzLmkgPSBudWxsOyBhID0gVyh0aGlzLCBhKTsgZWQodGhpcywgYSkgJiYgKHRoaXMuaCAtPSB0aGlzLmcuZ2V0KGEpLmxlbmd0aCk7IHRoaXMuZy5zZXQoYSwgW2JdKTsgdGhpcy5oICs9IDE7IHJldHVybiB0aGlzOyB9O1xyXG5rLmdldCA9IGZ1bmN0aW9uIChhLCBiKSB7IGlmICghYSlcclxuICAgIHJldHVybiBiOyBhID0gdGhpcy5SKGEpOyByZXR1cm4gMCA8IGEubGVuZ3RoID8gU3RyaW5nKGFbMF0pIDogYjsgfTtcclxuZnVuY3Rpb24gbWMoYSwgYiwgYykgeyBkZChhLCBiKTsgMCA8IGMubGVuZ3RoICYmIChhLmkgPSBudWxsLCBhLmcuc2V0KFcoYSwgYiksIHJhKGMpKSwgYS5oICs9IGMubGVuZ3RoKTsgfVxyXG5rLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgeyBpZiAodGhpcy5pKVxyXG4gICAgcmV0dXJuIHRoaXMuaTsgaWYgKCF0aGlzLmcpXHJcbiAgICByZXR1cm4gXCJcIjsgZm9yICh2YXIgYSA9IFtdLCBiID0gdGhpcy5nLlQoKSwgYyA9IDA7IGMgPCBiLmxlbmd0aDsgYysrKSB7XHJcbiAgICB2YXIgZCA9IGJbY10sIGUgPSBlbmNvZGVVUklDb21wb25lbnQoU3RyaW5nKGQpKTtcclxuICAgIGQgPSB0aGlzLlIoZCk7XHJcbiAgICBmb3IgKHZhciBmID0gMDsgZiA8IGQubGVuZ3RoOyBmKyspIHtcclxuICAgICAgICB2YXIgaCA9IGU7XHJcbiAgICAgICAgXCJcIiAhPT0gZFtmXSAmJiAoaCArPSBcIj1cIiArIGVuY29kZVVSSUNvbXBvbmVudChTdHJpbmcoZFtmXSkpKTtcclxuICAgICAgICBhLnB1c2goaCk7XHJcbiAgICB9XHJcbn0gcmV0dXJuIHRoaXMuaSA9IGEuam9pbihcIiZcIik7IH07XHJcbmZ1bmN0aW9uIFcoYSwgYikgeyBiID0gU3RyaW5nKGIpOyBhLmogJiYgKGIgPSBiLnRvTG93ZXJDYXNlKCkpOyByZXR1cm4gYjsgfVxyXG5mdW5jdGlvbiBaYyhhLCBiKSB7IGIgJiYgIWEuaiAmJiAoVihhKSwgYS5pID0gbnVsbCwgYS5nLmZvckVhY2goZnVuY3Rpb24gKGMsIGQpIHsgdmFyIGUgPSBkLnRvTG93ZXJDYXNlKCk7IGQgIT0gZSAmJiAoZGQodGhpcywgZCksIG1jKHRoaXMsIGUsIGMpKTsgfSwgYSkpOyBhLmogPSBiOyB9XHJcbnZhciBmZCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIGZkKGEsIGIpIHtcclxuICAgICAgICB0aGlzLmggPSBhO1xyXG4gICAgICAgIHRoaXMuZyA9IGI7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZmQ7XHJcbn0oKSk7XHJcbmZ1bmN0aW9uIGdkKGEpIHsgdGhpcy5sID0gYSB8fCBoZDsgbC5QZXJmb3JtYW5jZU5hdmlnYXRpb25UaW1pbmcgPyAoYSA9IGwucGVyZm9ybWFuY2UuZ2V0RW50cmllc0J5VHlwZShcIm5hdmlnYXRpb25cIiksIGEgPSAwIDwgYS5sZW5ndGggJiYgKFwiaHFcIiA9PSBhWzBdLm5leHRIb3BQcm90b2NvbCB8fCBcImgyXCIgPT0gYVswXS5uZXh0SG9wUHJvdG9jb2wpKSA6IGEgPSAhIShsLmcgJiYgbC5nLkVhICYmIGwuZy5FYSgpICYmIGwuZy5FYSgpLlpiKTsgdGhpcy5qID0gYSA/IHRoaXMubCA6IDE7IHRoaXMuZyA9IG51bGw7IDEgPCB0aGlzLmogJiYgKHRoaXMuZyA9IG5ldyBTZXQpOyB0aGlzLmggPSBudWxsOyB0aGlzLmkgPSBbXTsgfVxyXG52YXIgaGQgPSAxMDtcclxuZnVuY3Rpb24gaWQoYSkgeyByZXR1cm4gYS5oID8gITAgOiBhLmcgPyBhLmcuc2l6ZSA+PSBhLmogOiAhMTsgfVxyXG5mdW5jdGlvbiBDYyhhKSB7IHJldHVybiBhLmggPyAxIDogYS5nID8gYS5nLnNpemUgOiAwOyB9XHJcbmZ1bmN0aW9uIHljKGEsIGIpIHsgcmV0dXJuIGEuaCA/IGEuaCA9PSBiIDogYS5nID8gYS5nLmhhcyhiKSA6ICExOyB9XHJcbmZ1bmN0aW9uIERjKGEsIGIpIHsgYS5nID8gYS5nLmFkZChiKSA6IGEuaCA9IGI7IH1cclxuZnVuY3Rpb24gRmMoYSwgYikgeyBhLmggJiYgYS5oID09IGIgPyBhLmggPSBudWxsIDogYS5nICYmIGEuZy5oYXMoYikgJiYgYS5nLmRlbGV0ZShiKTsgfVxyXG5nZC5wcm90b3R5cGUuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGVfMSwgX2E7XHJcbiAgICB0aGlzLmkgPSBqZCh0aGlzKTtcclxuICAgIGlmICh0aGlzLmgpXHJcbiAgICAgICAgdGhpcy5oLmNhbmNlbCgpLCB0aGlzLmggPSBudWxsO1xyXG4gICAgZWxzZSBpZiAodGhpcy5nICYmIDAgIT09IHRoaXMuZy5zaXplKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgZm9yICh2YXIgX2IgPSBfX3ZhbHVlcyh0aGlzLmcudmFsdWVzKCkpLCBfYyA9IF9iLm5leHQoKTsgIV9jLmRvbmU7IF9jID0gX2IubmV4dCgpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYSA9IF9jLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgYS5jYW5jZWwoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfVxyXG4gICAgICAgIGZpbmFsbHkge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgaWYgKF9jICYmICFfYy5kb25lICYmIChfYSA9IF9iLnJldHVybikpIF9hLmNhbGwoX2IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5nLmNsZWFyKCk7XHJcbiAgICB9XHJcbn07XHJcbmZ1bmN0aW9uIGpkKGEpIHtcclxuICAgIHZhciBlXzIsIF9hO1xyXG4gICAgaWYgKG51bGwgIT0gYS5oKVxyXG4gICAgICAgIHJldHVybiBhLmkuY29uY2F0KGEuaC5EKTtcclxuICAgIGlmIChudWxsICE9IGEuZyAmJiAwICE9PSBhLmcuc2l6ZSkge1xyXG4gICAgICAgIHZhciBiID0gYS5pO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIF9iID0gX192YWx1ZXMoYS5nLnZhbHVlcygpKSwgX2MgPSBfYi5uZXh0KCk7ICFfYy5kb25lOyBfYyA9IF9iLm5leHQoKSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGMgPSBfYy52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGIgPSBiLmNvbmNhdChjLkQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChlXzJfMSkgeyBlXzIgPSB7IGVycm9yOiBlXzJfMSB9OyB9XHJcbiAgICAgICAgZmluYWxseSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoX2MgJiYgIV9jLmRvbmUgJiYgKF9hID0gX2IucmV0dXJuKSkgX2EuY2FsbChfYik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZmluYWxseSB7IGlmIChlXzIpIHRocm93IGVfMi5lcnJvcjsgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYjtcclxuICAgIH1cclxuICAgIHJldHVybiByYShhLmkpO1xyXG59XHJcbmZ1bmN0aW9uIGtkKCkgeyB9XHJcbmtkLnByb3RvdHlwZS5zdHJpbmdpZnkgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gbC5KU09OLnN0cmluZ2lmeShhLCB2b2lkIDApOyB9O1xyXG5rZC5wcm90b3R5cGUucGFyc2UgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gbC5KU09OLnBhcnNlKGEsIHZvaWQgMCk7IH07XHJcbmZ1bmN0aW9uIGxkKCkgeyB0aGlzLmcgPSBuZXcga2Q7IH1cclxuZnVuY3Rpb24gbWQoYSwgYiwgYykgeyB2YXIgZCA9IGMgfHwgXCJcIjsgdHJ5IHtcclxuICAgIEtjKGEsIGZ1bmN0aW9uIChlLCBmKSB7IHZhciBoID0gZTsgcChlKSAmJiAoaCA9IHJiKGUpKTsgYi5wdXNoKGQgKyBmICsgXCI9XCIgKyBlbmNvZGVVUklDb21wb25lbnQoaCkpOyB9KTtcclxufVxyXG5jYXRjaCAoZSkge1xyXG4gICAgdGhyb3cgYi5wdXNoKGQgKyBcInR5cGU9XCIgKyBlbmNvZGVVUklDb21wb25lbnQoXCJfYmFkbWFwXCIpKSwgZTtcclxufSB9XHJcbmZ1bmN0aW9uIG5kKGEsIGIpIHsgdmFyIGMgPSBuZXcgTWI7IGlmIChsLkltYWdlKSB7XHJcbiAgICB2YXIgZF8xID0gbmV3IEltYWdlO1xyXG4gICAgZF8xLm9ubG9hZCA9IGphKG9kLCBjLCBkXzEsIFwiVGVzdExvYWRJbWFnZTogbG9hZGVkXCIsICEwLCBiKTtcclxuICAgIGRfMS5vbmVycm9yID0gamEob2QsIGMsIGRfMSwgXCJUZXN0TG9hZEltYWdlOiBlcnJvclwiLCAhMSwgYik7XHJcbiAgICBkXzEub25hYm9ydCA9IGphKG9kLCBjLCBkXzEsIFwiVGVzdExvYWRJbWFnZTogYWJvcnRcIiwgITEsIGIpO1xyXG4gICAgZF8xLm9udGltZW91dCA9IGphKG9kLCBjLCBkXzEsIFwiVGVzdExvYWRJbWFnZTogdGltZW91dFwiLCAhMSwgYik7XHJcbiAgICBsLnNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyBpZiAoZF8xLm9udGltZW91dClcclxuICAgICAgICBkXzEub250aW1lb3V0KCk7IH0sIDFFNCk7XHJcbiAgICBkXzEuc3JjID0gYTtcclxufVxyXG5lbHNlXHJcbiAgICBiKCExKTsgfVxyXG5mdW5jdGlvbiBvZChhLCBiLCBjLCBkLCBlKSB7IHRyeSB7XHJcbiAgICBiLm9ubG9hZCA9IG51bGwsIGIub25lcnJvciA9IG51bGwsIGIub25hYm9ydCA9IG51bGwsIGIub250aW1lb3V0ID0gbnVsbCwgZShkKTtcclxufVxyXG5jYXRjaCAoZikgeyB9IH1cclxuZnVuY3Rpb24gcGQoYSkgeyB0aGlzLmwgPSBhLiRiIHx8IG51bGw7IHRoaXMuaiA9IGEuaWIgfHwgITE7IH1cclxudChwZCwgWWIpO1xyXG5wZC5wcm90b3R5cGUuZyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5ldyBxZCh0aGlzLmwsIHRoaXMuaik7IH07XHJcbnBkLnByb3RvdHlwZS5pID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGZ1bmN0aW9uICgpIHsgcmV0dXJuIGE7IH07IH0oe30pO1xyXG5mdW5jdGlvbiBxZChhLCBiKSB7IEMuY2FsbCh0aGlzKTsgdGhpcy5EID0gYTsgdGhpcy51ID0gYjsgdGhpcy5tID0gdm9pZCAwOyB0aGlzLnJlYWR5U3RhdGUgPSByZDsgdGhpcy5zdGF0dXMgPSAwOyB0aGlzLnJlc3BvbnNlVHlwZSA9IHRoaXMucmVzcG9uc2VUZXh0ID0gdGhpcy5yZXNwb25zZSA9IHRoaXMuc3RhdHVzVGV4dCA9IFwiXCI7IHRoaXMub25yZWFkeXN0YXRlY2hhbmdlID0gbnVsbDsgdGhpcy52ID0gbmV3IEhlYWRlcnM7IHRoaXMuaCA9IG51bGw7IHRoaXMuQyA9IFwiR0VUXCI7IHRoaXMuQiA9IFwiXCI7IHRoaXMuZyA9ICExOyB0aGlzLkEgPSB0aGlzLmogPSB0aGlzLmwgPSBudWxsOyB9XHJcbnQocWQsIEMpO1xyXG52YXIgcmQgPSAwO1xyXG5rID0gcWQucHJvdG90eXBlO1xyXG5rLm9wZW4gPSBmdW5jdGlvbiAoYSwgYikgeyBpZiAodGhpcy5yZWFkeVN0YXRlICE9IHJkKVxyXG4gICAgdGhyb3cgdGhpcy5hYm9ydCgpLCBFcnJvcihcIkVycm9yIHJlb3BlbmluZyBhIGNvbm5lY3Rpb25cIik7IHRoaXMuQyA9IGE7IHRoaXMuQiA9IGI7IHRoaXMucmVhZHlTdGF0ZSA9IDE7IHNkKHRoaXMpOyB9O1xyXG5rLnNlbmQgPSBmdW5jdGlvbiAoYSkgeyBpZiAoMSAhPSB0aGlzLnJlYWR5U3RhdGUpXHJcbiAgICB0aHJvdyB0aGlzLmFib3J0KCksIEVycm9yKFwibmVlZCB0byBjYWxsIG9wZW4oKSBmaXJzdC4gXCIpOyB0aGlzLmcgPSAhMDsgdmFyIGIgPSB7IGhlYWRlcnM6IHRoaXMudiwgbWV0aG9kOiB0aGlzLkMsIGNyZWRlbnRpYWxzOiB0aGlzLm0sIGNhY2hlOiB2b2lkIDAgfTsgYSAmJiAoYi5ib2R5ID0gYSk7ICh0aGlzLkQgfHwgbCkuZmV0Y2gobmV3IFJlcXVlc3QodGhpcy5CLCBiKSkudGhlbih0aGlzLlZhLmJpbmQodGhpcyksIHRoaXMuaGEuYmluZCh0aGlzKSk7IH07XHJcbmsuYWJvcnQgPSBmdW5jdGlvbiAoKSB7IHRoaXMucmVzcG9uc2UgPSB0aGlzLnJlc3BvbnNlVGV4dCA9IFwiXCI7IHRoaXMudiA9IG5ldyBIZWFkZXJzOyB0aGlzLnN0YXR1cyA9IDA7IHRoaXMuaiAmJiB0aGlzLmouY2FuY2VsKFwiUmVxdWVzdCB3YXMgYWJvcnRlZC5cIik7IDEgPD0gdGhpcy5yZWFkeVN0YXRlICYmIHRoaXMuZyAmJiA0ICE9IHRoaXMucmVhZHlTdGF0ZSAmJiAodGhpcy5nID0gITEsIHRkKHRoaXMpKTsgdGhpcy5yZWFkeVN0YXRlID0gcmQ7IH07XHJcbmsuVmEgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgaWYgKHRoaXMuZyAmJiAodGhpcy5sID0gYSwgdGhpcy5oIHx8ICh0aGlzLnN0YXR1cyA9IHRoaXMubC5zdGF0dXMsIHRoaXMuc3RhdHVzVGV4dCA9IHRoaXMubC5zdGF0dXNUZXh0LCB0aGlzLmggPSBhLmhlYWRlcnMsIHRoaXMucmVhZHlTdGF0ZSA9IDIsIHNkKHRoaXMpKSwgdGhpcy5nICYmICh0aGlzLnJlYWR5U3RhdGUgPSAzLCBzZCh0aGlzKSwgdGhpcy5nKSkpXHJcbiAgICAgICAgaWYgKFwiYXJyYXlidWZmZXJcIiA9PT0gdGhpcy5yZXNwb25zZVR5cGUpXHJcbiAgICAgICAgICAgIGEuYXJyYXlCdWZmZXIoKS50aGVuKHRoaXMuVGEuYmluZCh0aGlzKSwgdGhpcy5oYS5iaW5kKHRoaXMpKTtcclxuICAgICAgICBlbHNlIGlmIChcInVuZGVmaW5lZFwiICE9PSB0eXBlb2YgbC5SZWFkYWJsZVN0cmVhbSAmJiBcImJvZHlcIiBpbiBhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaiA9IGEuYm9keS5nZXRSZWFkZXIoKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMudSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucmVzcG9uc2VUeXBlKVxyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IEVycm9yKCdyZXNwb25zZVR5cGUgbXVzdCBiZSBlbXB0eSBmb3IgXCJzdHJlYW1CaW5hcnlDaHVua3NcIiBtb2RlIHJlc3BvbnNlcy4nKTtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVzcG9uc2UgPVxyXG4gICAgICAgICAgICAgICAgICAgIFtdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIHRoaXMucmVzcG9uc2UgPSB0aGlzLnJlc3BvbnNlVGV4dCA9IFwiXCIsIHRoaXMuQSA9IG5ldyBUZXh0RGVjb2RlcjtcclxuICAgICAgICAgICAgdWQodGhpcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgYS50ZXh0KCkudGhlbih0aGlzLlVhLmJpbmQodGhpcyksIHRoaXMuaGEuYmluZCh0aGlzKSk7XHJcbn07XHJcbmZ1bmN0aW9uIHVkKGEpIHsgYS5qLnJlYWQoKS50aGVuKGEuU2EuYmluZChhKSkuY2F0Y2goYS5oYS5iaW5kKGEpKTsgfVxyXG5rLlNhID0gZnVuY3Rpb24gKGEpIHsgaWYgKHRoaXMuZykge1xyXG4gICAgaWYgKHRoaXMudSAmJiBhLnZhbHVlKVxyXG4gICAgICAgIHRoaXMucmVzcG9uc2UucHVzaChhLnZhbHVlKTtcclxuICAgIGVsc2UgaWYgKCF0aGlzLnUpIHtcclxuICAgICAgICB2YXIgYiA9IGEudmFsdWUgPyBhLnZhbHVlIDogbmV3IFVpbnQ4QXJyYXkoMCk7XHJcbiAgICAgICAgaWYgKGIgPSB0aGlzLkEuZGVjb2RlKGIsIHsgc3RyZWFtOiAhYS5kb25lIH0pKVxyXG4gICAgICAgICAgICB0aGlzLnJlc3BvbnNlID0gdGhpcy5yZXNwb25zZVRleHQgKz0gYjtcclxuICAgIH1cclxuICAgIGEuZG9uZSA/IHRkKHRoaXMpIDogc2QodGhpcyk7XHJcbiAgICAzID09IHRoaXMucmVhZHlTdGF0ZSAmJiB1ZCh0aGlzKTtcclxufSB9O1xyXG5rLlVhID0gZnVuY3Rpb24gKGEpIHsgdGhpcy5nICYmICh0aGlzLnJlc3BvbnNlID0gdGhpcy5yZXNwb25zZVRleHQgPSBhLCB0ZCh0aGlzKSk7IH07XHJcbmsuVGEgPSBmdW5jdGlvbiAoYSkgeyB0aGlzLmcgJiYgKHRoaXMucmVzcG9uc2UgPSBhLCB0ZCh0aGlzKSk7IH07XHJcbmsuaGEgPSBmdW5jdGlvbiAoKSB7IHRoaXMuZyAmJiB0ZCh0aGlzKTsgfTtcclxuZnVuY3Rpb24gdGQoYSkgeyBhLnJlYWR5U3RhdGUgPSA0OyBhLmwgPSBudWxsOyBhLmogPSBudWxsOyBhLkEgPSBudWxsOyBzZChhKTsgfVxyXG5rLnNldFJlcXVlc3RIZWFkZXIgPSBmdW5jdGlvbiAoYSwgYikgeyB0aGlzLnYuYXBwZW5kKGEsIGIpOyB9O1xyXG5rLmdldFJlc3BvbnNlSGVhZGVyID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIHRoaXMuaCA/IHRoaXMuaC5nZXQoYS50b0xvd2VyQ2FzZSgpKSB8fCBcIlwiIDogXCJcIjsgfTtcclxuay5nZXRBbGxSZXNwb25zZUhlYWRlcnMgPSBmdW5jdGlvbiAoKSB7IGlmICghdGhpcy5oKVxyXG4gICAgcmV0dXJuIFwiXCI7IHZhciBhID0gW10sIGIgPSB0aGlzLmguZW50cmllcygpOyBmb3IgKHZhciBjID0gYi5uZXh0KCk7ICFjLmRvbmU7KVxyXG4gICAgYyA9IGMudmFsdWUsIGEucHVzaChjWzBdICsgXCI6IFwiICsgY1sxXSksIGMgPSBiLm5leHQoKTsgcmV0dXJuIGEuam9pbihcIlxcclxcblwiKTsgfTtcclxuZnVuY3Rpb24gc2QoYSkgeyBhLm9ucmVhZHlzdGF0ZWNoYW5nZSAmJiBhLm9ucmVhZHlzdGF0ZWNoYW5nZS5jYWxsKGEpOyB9XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShxZC5wcm90b3R5cGUsIFwid2l0aENyZWRlbnRpYWxzXCIsIHsgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBcImluY2x1ZGVcIiA9PT0gdGhpcy5tOyB9LCBzZXQ6IGZ1bmN0aW9uIChhKSB7IHRoaXMubSA9IGEgPyBcImluY2x1ZGVcIiA6IFwic2FtZS1vcmlnaW5cIjsgfSB9KTtcclxudmFyIHZkID0gbC5KU09OLnBhcnNlO1xyXG5mdW5jdGlvbiBYKGEpIHsgQy5jYWxsKHRoaXMpOyB0aGlzLmhlYWRlcnMgPSBuZXcgUzsgdGhpcy51ID0gYSB8fCBudWxsOyB0aGlzLmggPSAhMTsgdGhpcy5DID0gdGhpcy5nID0gbnVsbDsgdGhpcy5IID0gXCJcIjsgdGhpcy5tID0gMDsgdGhpcy5qID0gXCJcIjsgdGhpcy5sID0gdGhpcy5GID0gdGhpcy52ID0gdGhpcy5EID0gITE7IHRoaXMuQiA9IDA7IHRoaXMuQSA9IG51bGw7IHRoaXMuSiA9IHdkOyB0aGlzLksgPSB0aGlzLkwgPSAhMTsgfVxyXG50KFgsIEMpO1xyXG52YXIgd2QgPSBcIlwiLCB4ZCA9IC9eaHR0cHM/JC9pLCB5ZCA9IFtcIlBPU1RcIiwgXCJQVVRcIl07XHJcbmsgPSBYLnByb3RvdHlwZTtcclxuay5lYSA9IGZ1bmN0aW9uIChhLCBiLCBjLCBkKSB7XHJcbiAgICBpZiAodGhpcy5nKVxyXG4gICAgICAgIHRocm93IEVycm9yKFwiW2dvb2cubmV0LlhocklvXSBPYmplY3QgaXMgYWN0aXZlIHdpdGggYW5vdGhlciByZXF1ZXN0PVwiICsgdGhpcy5IICsgXCI7IG5ld1VyaT1cIiArIGEpO1xyXG4gICAgYiA9IGIgPyBiLnRvVXBwZXJDYXNlKCkgOiBcIkdFVFwiO1xyXG4gICAgdGhpcy5IID0gYTtcclxuICAgIHRoaXMuaiA9IFwiXCI7XHJcbiAgICB0aGlzLm0gPSAwO1xyXG4gICAgdGhpcy5EID0gITE7XHJcbiAgICB0aGlzLmggPSAhMDtcclxuICAgIHRoaXMuZyA9IHRoaXMudSA/IHRoaXMudS5nKCkgOiBjYy5nKCk7XHJcbiAgICB0aGlzLkMgPSB0aGlzLnUgPyBaYih0aGlzLnUpIDogWmIoY2MpO1xyXG4gICAgdGhpcy5nLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IHEodGhpcy5GYSwgdGhpcyk7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHRoaXMuRiA9ICEwLCB0aGlzLmcub3BlbihiLCBTdHJpbmcoYSksICEwKSwgdGhpcy5GID0gITE7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZikge1xyXG4gICAgICAgIHpkKHRoaXMsIGYpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGEgPSBjIHx8IFwiXCI7XHJcbiAgICB2YXIgZSA9IG5ldyBTKHRoaXMuaGVhZGVycyk7XHJcbiAgICBkICYmIEtjKGQsIGZ1bmN0aW9uIChmLCBoKSB7IGUuc2V0KGgsIGYpOyB9KTtcclxuICAgIGQgPSBvYShlLlQoKSk7XHJcbiAgICBjID0gbC5Gb3JtRGF0YSAmJiBhIGluc3RhbmNlb2YgbC5Gb3JtRGF0YTtcclxuICAgICEoMCA8PSBtYSh5ZCwgYikpIHx8IGQgfHwgYyB8fCBlLnNldChcIkNvbnRlbnQtVHlwZVwiLCBcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDtjaGFyc2V0PXV0Zi04XCIpO1xyXG4gICAgZS5mb3JFYWNoKGZ1bmN0aW9uIChmLCBoKSB7IHRoaXMuZy5zZXRSZXF1ZXN0SGVhZGVyKGgsIGYpOyB9LCB0aGlzKTtcclxuICAgIHRoaXMuSiAmJiAodGhpcy5nLnJlc3BvbnNlVHlwZSA9IHRoaXMuSik7XHJcbiAgICBcIndpdGhDcmVkZW50aWFsc1wiIGluIHRoaXMuZyAmJiB0aGlzLmcud2l0aENyZWRlbnRpYWxzICE9PSB0aGlzLkwgJiYgKHRoaXMuZy53aXRoQ3JlZGVudGlhbHMgPSB0aGlzLkwpO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBBZCh0aGlzKSwgMCA8IHRoaXMuQiAmJiAoKHRoaXMuSyA9IEJkKHRoaXMuZykpID8gKHRoaXMuZy50aW1lb3V0ID0gdGhpcy5CLCB0aGlzLmcub250aW1lb3V0ID0gcSh0aGlzLnBhLCB0aGlzKSkgOiB0aGlzLkEgPSBHYih0aGlzLnBhLCB0aGlzLkIsIHRoaXMpKSwgdGhpcy52ID0gITAsIHRoaXMuZy5zZW5kKGEpLCB0aGlzLnYgPSAhMTtcclxuICAgIH1cclxuICAgIGNhdGNoIChmKSB7XHJcbiAgICAgICAgemQodGhpcywgZik7XHJcbiAgICB9XHJcbn07XHJcbmZ1bmN0aW9uIEJkKGEpIHsgcmV0dXJuIHkgJiYgUmEoKSAmJiBcIm51bWJlclwiID09PSB0eXBlb2YgYS50aW1lb3V0ICYmIHZvaWQgMCAhPT0gYS5vbnRpbWVvdXQ7IH1cclxuZnVuY3Rpb24gcGEoYSkgeyByZXR1cm4gXCJjb250ZW50LXR5cGVcIiA9PSBhLnRvTG93ZXJDYXNlKCk7IH1cclxuay5wYSA9IGZ1bmN0aW9uICgpIHsgXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgZ29vZyAmJiB0aGlzLmcgJiYgKHRoaXMuaiA9IFwiVGltZWQgb3V0IGFmdGVyIFwiICsgdGhpcy5CICsgXCJtcywgYWJvcnRpbmdcIiwgdGhpcy5tID0gOCwgRCh0aGlzLCBcInRpbWVvdXRcIiksIHRoaXMuYWJvcnQoOCkpOyB9O1xyXG5mdW5jdGlvbiB6ZChhLCBiKSB7IGEuaCA9ICExOyBhLmcgJiYgKGEubCA9ICEwLCBhLmcuYWJvcnQoKSwgYS5sID0gITEpOyBhLmogPSBiOyBhLm0gPSA1OyBDZChhKTsgRGQoYSk7IH1cclxuZnVuY3Rpb24gQ2QoYSkgeyBhLkQgfHwgKGEuRCA9ICEwLCBEKGEsIFwiY29tcGxldGVcIiksIEQoYSwgXCJlcnJvclwiKSk7IH1cclxuay5hYm9ydCA9IGZ1bmN0aW9uIChhKSB7IHRoaXMuZyAmJiB0aGlzLmggJiYgKHRoaXMuaCA9ICExLCB0aGlzLmwgPSAhMCwgdGhpcy5nLmFib3J0KCksIHRoaXMubCA9ICExLCB0aGlzLm0gPSBhIHx8IDcsIEQodGhpcywgXCJjb21wbGV0ZVwiKSwgRCh0aGlzLCBcImFib3J0XCIpLCBEZCh0aGlzKSk7IH07XHJcbmsuTSA9IGZ1bmN0aW9uICgpIHsgdGhpcy5nICYmICh0aGlzLmggJiYgKHRoaXMuaCA9ICExLCB0aGlzLmwgPSAhMCwgdGhpcy5nLmFib3J0KCksIHRoaXMubCA9ICExKSwgRGQodGhpcywgITApKTsgWC5aLk0uY2FsbCh0aGlzKTsgfTtcclxuay5GYSA9IGZ1bmN0aW9uICgpIHsgdGhpcy5zIHx8ICh0aGlzLkYgfHwgdGhpcy52IHx8IHRoaXMubCA/IEVkKHRoaXMpIDogdGhpcy5jYigpKTsgfTtcclxuay5jYiA9IGZ1bmN0aW9uICgpIHsgRWQodGhpcyk7IH07XHJcbmZ1bmN0aW9uIEVkKGEpIHtcclxuICAgIGlmIChhLmggJiYgXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgZ29vZyAmJiAoIWEuQ1sxXSB8fCA0ICE9IE8oYSkgfHwgMiAhPSBhLmJhKCkpKVxyXG4gICAgICAgIGlmIChhLnYgJiYgNCA9PSBPKGEpKVxyXG4gICAgICAgICAgICBHYihhLkZhLCAwLCBhKTtcclxuICAgICAgICBlbHNlIGlmIChEKGEsIFwicmVhZHlzdGF0ZWNoYW5nZVwiKSwgNCA9PSBPKGEpKSB7XHJcbiAgICAgICAgICAgIGEuaCA9ICExO1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG4gPSBhLmJhKCk7XHJcbiAgICAgICAgICAgICAgICBhOiBzd2l0Y2ggKG4pIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDIwMDpcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDIwMTpcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDIwMjpcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDIwNDpcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDIwNjpcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDMwNDpcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDEyMjM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiID0gITA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrIGE7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDogYiA9ICExO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIGM7XHJcbiAgICAgICAgICAgICAgICBpZiAoIShjID0gYikpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZCA9IDAgPT09IG4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSBTdHJpbmcoYS5IKS5tYXRjaChNYylbMV0gfHwgbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlICYmIGwuc2VsZiAmJiBsLnNlbGYubG9jYXRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmID0gbC5zZWxmLmxvY2F0aW9uLnByb3RvY29sO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZSA9IGYuc3Vic3RyKDAsIGYubGVuZ3RoIC0gMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZCA9ICF4ZC50ZXN0KGUgPyBlLnRvTG93ZXJDYXNlKCkgOiBcIlwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYyA9IGQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoYylcclxuICAgICAgICAgICAgICAgICAgICBEKGEsIFwiY29tcGxldGVcIiksIEQoYSwgXCJzdWNjZXNzXCIpO1xyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYS5tID0gNjtcclxuICAgICAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaCA9IDIgPCBPKGEpID8gYS5nLnN0YXR1c1RleHQgOiBcIlwiO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjYXRjaCAodSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBoID0gXCJcIjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYS5qID0gaCArIFwiIFtcIiArIGEuYmEoKSArIFwiXVwiO1xyXG4gICAgICAgICAgICAgICAgICAgIENkKGEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZpbmFsbHkge1xyXG4gICAgICAgICAgICAgICAgRGQoYSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbn1cclxuZnVuY3Rpb24gRGQoYSwgYikgeyBpZiAoYS5nKSB7XHJcbiAgICBBZChhKTtcclxuICAgIHZhciBjID0gYS5nLCBkID0gYS5DWzBdID8gYWEgOiBudWxsO1xyXG4gICAgYS5nID0gbnVsbDtcclxuICAgIGEuQyA9IG51bGw7XHJcbiAgICBiIHx8IEQoYSwgXCJyZWFkeVwiKTtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYy5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBkO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGUpIHsgfVxyXG59IH1cclxuZnVuY3Rpb24gQWQoYSkgeyBhLmcgJiYgYS5LICYmIChhLmcub250aW1lb3V0ID0gbnVsbCk7IGEuQSAmJiAobC5jbGVhclRpbWVvdXQoYS5BKSwgYS5BID0gbnVsbCk7IH1cclxuZnVuY3Rpb24gTyhhKSB7IHJldHVybiBhLmcgPyBhLmcucmVhZHlTdGF0ZSA6IDA7IH1cclxuay5iYSA9IGZ1bmN0aW9uICgpIHsgdHJ5IHtcclxuICAgIHJldHVybiAyIDwgTyh0aGlzKSA/IHRoaXMuZy5zdGF0dXMgOiAtMTtcclxufVxyXG5jYXRjaCAoYSkge1xyXG4gICAgcmV0dXJuIC0xO1xyXG59IH07XHJcbmsuZ2EgPSBmdW5jdGlvbiAoKSB7IHRyeSB7XHJcbiAgICByZXR1cm4gdGhpcy5nID8gdGhpcy5nLnJlc3BvbnNlVGV4dCA6IFwiXCI7XHJcbn1cclxuY2F0Y2ggKGEpIHtcclxuICAgIHJldHVybiBcIlwiO1xyXG59IH07XHJcbmsuUWEgPSBmdW5jdGlvbiAoYSkgeyBpZiAodGhpcy5nKSB7XHJcbiAgICB2YXIgYiA9IHRoaXMuZy5yZXNwb25zZVRleHQ7XHJcbiAgICBhICYmIDAgPT0gYi5pbmRleE9mKGEpICYmIChiID0gYi5zdWJzdHJpbmcoYS5sZW5ndGgpKTtcclxuICAgIHJldHVybiB2ZChiKTtcclxufSB9O1xyXG5mdW5jdGlvbiBvYyhhKSB7IHRyeSB7XHJcbiAgICBpZiAoIWEuZylcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIGlmIChcInJlc3BvbnNlXCIgaW4gYS5nKVxyXG4gICAgICAgIHJldHVybiBhLmcucmVzcG9uc2U7XHJcbiAgICBzd2l0Y2ggKGEuSikge1xyXG4gICAgICAgIGNhc2Ugd2Q6XHJcbiAgICAgICAgY2FzZSBcInRleHRcIjogcmV0dXJuIGEuZy5yZXNwb25zZVRleHQ7XHJcbiAgICAgICAgY2FzZSBcImFycmF5YnVmZmVyXCI6IGlmIChcIm1velJlc3BvbnNlQXJyYXlCdWZmZXJcIiBpbiBhLmcpXHJcbiAgICAgICAgICAgIHJldHVybiBhLmcubW96UmVzcG9uc2VBcnJheUJ1ZmZlcjtcclxuICAgIH1cclxuICAgIHJldHVybiBudWxsO1xyXG59XHJcbmNhdGNoIChiKSB7XHJcbiAgICByZXR1cm4gbnVsbDtcclxufSB9XHJcbmsuRGEgPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLm07IH07XHJcbmsuTGEgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBcInN0cmluZ1wiID09PSB0eXBlb2YgdGhpcy5qID8gdGhpcy5qIDogU3RyaW5nKHRoaXMuaik7IH07XHJcbmZ1bmN0aW9uIEZkKGEpIHsgdmFyIGIgPSBcIlwiOyB4YShhLCBmdW5jdGlvbiAoYywgZCkgeyBiICs9IGQ7IGIgKz0gXCI6XCI7IGIgKz0gYzsgYiArPSBcIlxcclxcblwiOyB9KTsgcmV0dXJuIGI7IH1cclxuZnVuY3Rpb24gR2QoYSwgYiwgYykgeyBhOiB7XHJcbiAgICBmb3IgKGQgaW4gYykge1xyXG4gICAgICAgIHZhciBkID0gITE7XHJcbiAgICAgICAgYnJlYWsgYTtcclxuICAgIH1cclxuICAgIGQgPSAhMDtcclxufSBkIHx8IChjID0gRmQoYyksIFwic3RyaW5nXCIgPT09IHR5cGVvZiBhID8gKG51bGwgIT0gYyAmJiBlbmNvZGVVUklDb21wb25lbnQoU3RyaW5nKGMpKSkgOiBSKGEsIGIsIGMpKTsgfVxyXG5mdW5jdGlvbiBIZChhLCBiLCBjKSB7IHJldHVybiBjICYmIGMuaW50ZXJuYWxDaGFubmVsUGFyYW1zID8gYy5pbnRlcm5hbENoYW5uZWxQYXJhbXNbYV0gfHwgYiA6IGI7IH1cclxuZnVuY3Rpb24gSWQoYSkge1xyXG4gICAgdGhpcy56YSA9IDA7XHJcbiAgICB0aGlzLmwgPSBbXTtcclxuICAgIHRoaXMuaCA9IG5ldyBNYjtcclxuICAgIHRoaXMubGEgPSB0aGlzLm9hID0gdGhpcy5GID0gdGhpcy5XID0gdGhpcy5nID0gdGhpcy5zYSA9IHRoaXMuRCA9IHRoaXMuYWEgPSB0aGlzLm8gPSB0aGlzLlAgPSB0aGlzLnMgPSBudWxsO1xyXG4gICAgdGhpcy5aYSA9IHRoaXMuViA9IDA7XHJcbiAgICB0aGlzLlhhID0gSGQoXCJmYWlsRmFzdFwiLCAhMSwgYSk7XHJcbiAgICB0aGlzLk4gPSB0aGlzLnYgPSB0aGlzLnUgPSB0aGlzLm0gPSB0aGlzLmogPSBudWxsO1xyXG4gICAgdGhpcy5YID0gITA7XHJcbiAgICB0aGlzLkkgPSB0aGlzLnRhID0gdGhpcy5VID0gLTE7XHJcbiAgICB0aGlzLlkgPSB0aGlzLkEgPSB0aGlzLkMgPSAwO1xyXG4gICAgdGhpcy5QYSA9IEhkKFwiYmFzZVJldHJ5RGVsYXlNc1wiLCA1RTMsIGEpO1xyXG4gICAgdGhpcy4kYSA9IEhkKFwicmV0cnlEZWxheVNlZWRNc1wiLCAxRTQsIGEpO1xyXG4gICAgdGhpcy5ZYSA9IEhkKFwiZm9yd2FyZENoYW5uZWxNYXhSZXRyaWVzXCIsIDIsIGEpO1xyXG4gICAgdGhpcy5yYSA9IEhkKFwiZm9yd2FyZENoYW5uZWxSZXF1ZXN0VGltZW91dE1zXCIsIDJFNCwgYSk7XHJcbiAgICB0aGlzLnFhID0gYSAmJiBhLnhtbEh0dHBGYWN0b3J5IHx8IHZvaWQgMDtcclxuICAgIHRoaXMuQmEgPSBhICYmIGEuWWIgfHwgITE7XHJcbiAgICB0aGlzLksgPSB2b2lkIDA7XHJcbiAgICB0aGlzLkggPSBhICYmIGEuc3VwcG9ydHNDcm9zc0RvbWFpblhociB8fCAhMTtcclxuICAgIHRoaXMuSiA9IFwiXCI7XHJcbiAgICB0aGlzLmkgPSBuZXcgZ2QoYSAmJiBhLmNvbmN1cnJlbnRSZXF1ZXN0TGltaXQpO1xyXG4gICAgdGhpcy5DYSA9IG5ldyBsZDtcclxuICAgIHRoaXMuamEgPSBhICYmIGEuZmFzdEhhbmRzaGFrZSB8fCAhMTtcclxuICAgIHRoaXMuUmEgPSBhICYmIGEuV2IgfHwgITE7XHJcbiAgICBhICYmIGEuQWEgJiYgdGhpcy5oLkFhKCk7XHJcbiAgICBhICYmIGEuZm9yY2VMb25nUG9sbGluZyAmJiAodGhpcy5YID0gITEpO1xyXG4gICAgdGhpcy4kID0gIXRoaXMuamEgJiYgdGhpcy5YICYmIGEgJiYgYS5kZXRlY3RCdWZmZXJpbmdQcm94eSB8fCAhMTtcclxuICAgIHRoaXMua2EgPSB2b2lkIDA7XHJcbiAgICB0aGlzLk8gPSAwO1xyXG4gICAgdGhpcy5MID0gITE7XHJcbiAgICB0aGlzLkIgPSBudWxsO1xyXG4gICAgdGhpcy5XYSA9ICFhIHx8ICExICE9PSBhLlhiO1xyXG59XHJcbmsgPSBJZC5wcm90b3R5cGU7XHJcbmsubWEgPSA4O1xyXG5rLkcgPSAxO1xyXG5mdW5jdGlvbiBJYyhhKSB7IEpkKGEpOyBpZiAoMyA9PSBhLkcpIHtcclxuICAgIHZhciBiID0gYS5WKyssIGMgPSBOKGEuRik7XHJcbiAgICBSKGMsIFwiU0lEXCIsIGEuSik7XHJcbiAgICBSKGMsIFwiUklEXCIsIGIpO1xyXG4gICAgUihjLCBcIlRZUEVcIiwgXCJ0ZXJtaW5hdGVcIik7XHJcbiAgICBLZChhLCBjKTtcclxuICAgIGIgPSBuZXcgTShhLCBhLmgsIGIsIHZvaWQgMCk7XHJcbiAgICBiLksgPSAyO1xyXG4gICAgYi52ID0gamMoTihjKSk7XHJcbiAgICBjID0gITE7XHJcbiAgICBsLm5hdmlnYXRvciAmJiBsLm5hdmlnYXRvci5zZW5kQmVhY29uICYmIChjID0gbC5uYXZpZ2F0b3Iuc2VuZEJlYWNvbihiLnYudG9TdHJpbmcoKSwgXCJcIikpO1xyXG4gICAgIWMgJiYgbC5JbWFnZSAmJiAoKG5ldyBJbWFnZSkuc3JjID0gYi52LCBjID0gITApO1xyXG4gICAgYyB8fCAoYi5nID0gbmMoYi5sLCBudWxsKSwgYi5nLmVhKGIudikpO1xyXG4gICAgYi5GID0gRGF0ZS5ub3coKTtcclxuICAgIGxjKGIpO1xyXG59IExkKGEpOyB9XHJcbmsuaGIgPSBmdW5jdGlvbiAoYSkgeyB0cnkge1xyXG4gICAgdGhpcy5oLmluZm8oXCJPcmlnaW4gVHJpYWxzIGludm9rZWQ6IFwiICsgYSk7XHJcbn1cclxuY2F0Y2ggKGIpIHsgfSB9O1xyXG5mdW5jdGlvbiBBYyhhKSB7IGEuZyAmJiAod2MoYSksIGEuZy5jYW5jZWwoKSwgYS5nID0gbnVsbCk7IH1cclxuZnVuY3Rpb24gSmQoYSkgeyBBYyhhKTsgYS51ICYmIChsLmNsZWFyVGltZW91dChhLnUpLCBhLnUgPSBudWxsKTsgemMoYSk7IGEuaS5jYW5jZWwoKTsgYS5tICYmIChcIm51bWJlclwiID09PSB0eXBlb2YgYS5tICYmIGwuY2xlYXJUaW1lb3V0KGEubSksIGEubSA9IG51bGwpOyB9XHJcbmZ1bmN0aW9uIE1kKGEsIGIpIHsgYS5sLnB1c2gobmV3IGZkKGEuWmErKywgYikpOyAzID09IGEuRyAmJiBIYyhhKTsgfVxyXG5mdW5jdGlvbiBIYyhhKSB7IGlkKGEuaSkgfHwgYS5tIHx8IChhLm0gPSAhMCwgemIoYS5IYSwgYSksIGEuQyA9IDApOyB9XHJcbmZ1bmN0aW9uIE5kKGEsIGIpIHsgaWYgKENjKGEuaSkgPj0gYS5pLmogLSAoYS5tID8gMSA6IDApKVxyXG4gICAgcmV0dXJuICExOyBpZiAoYS5tKVxyXG4gICAgcmV0dXJuIGEubCA9IGIuRC5jb25jYXQoYS5sKSwgITA7IGlmICgxID09IGEuRyB8fCAyID09IGEuRyB8fCBhLkMgPj0gKGEuWGEgPyAwIDogYS5ZYSkpXHJcbiAgICByZXR1cm4gITE7IGEubSA9IEsocShhLkhhLCBhLCBiKSwgT2QoYSwgYS5DKSk7IGEuQysrOyByZXR1cm4gITA7IH1cclxuay5IYSA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICBpZiAodGhpcy5tKVxyXG4gICAgICAgIGlmICh0aGlzLm0gPSBudWxsLCAxID09IHRoaXMuRykge1xyXG4gICAgICAgICAgICBpZiAoIWEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuViA9IE1hdGguZmxvb3IoMUU1ICogTWF0aC5yYW5kb20oKSk7XHJcbiAgICAgICAgICAgICAgICBhID0gdGhpcy5WKys7XHJcbiAgICAgICAgICAgICAgICB2YXIgZSA9IG5ldyBNKHRoaXMsIHRoaXMuaCwgYSwgdm9pZCAwKTtcclxuICAgICAgICAgICAgICAgIHZhciBmID0gdGhpcy5zO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5QICYmIChmID8gKGYgPSB5YShmKSwgQWEoZiwgdGhpcy5QKSkgOiBmID0gdGhpcy5QKTtcclxuICAgICAgICAgICAgICAgIG51bGwgPT09IHRoaXMubyAmJiAoZS5IID0gZik7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5qYSlcclxuICAgICAgICAgICAgICAgICAgICBhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYyA9IDA7IGMgPCB0aGlzLmwubGVuZ3RoOyBjKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGI6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IHRoaXMubFtjXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoXCJfX2RhdGFfX1wiIGluIGQuZyAmJiAoZCA9IGQuZy5fX2RhdGFfXywgXCJzdHJpbmdcIiA9PT0gdHlwZW9mIGQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQgPSBkLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsgYjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZCA9IHZvaWQgMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2b2lkIDAgPT09IGQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiICs9IGQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoNDA5NiA8IGIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiID0gYztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhayBhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKDQwOTYgPT09IGIgfHwgYyA9PT0gdGhpcy5sLmxlbmd0aCAtIDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiID0gYyArIDE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsgYTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBiID0gMUUzO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICBiID0gMUUzO1xyXG4gICAgICAgICAgICAgICAgYiA9XHJcbiAgICAgICAgICAgICAgICAgICAgUGQodGhpcywgZSwgYik7XHJcbiAgICAgICAgICAgICAgICBjID0gTih0aGlzLkYpO1xyXG4gICAgICAgICAgICAgICAgUihjLCBcIlJJRFwiLCBhKTtcclxuICAgICAgICAgICAgICAgIFIoYywgXCJDVkVSXCIsIDIyKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuRCAmJiBSKGMsIFwiWC1IVFRQLVNlc3Npb24tSWRcIiwgdGhpcy5EKTtcclxuICAgICAgICAgICAgICAgIEtkKHRoaXMsIGMpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vICYmIGYgJiYgR2QoYywgdGhpcy5vLCBmKTtcclxuICAgICAgICAgICAgICAgIERjKHRoaXMuaSwgZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLlJhICYmIFIoYywgXCJUWVBFXCIsIFwiaW5pdFwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuamEgPyAoUihjLCBcIiRyZXFcIiwgYiksIFIoYywgXCJTSURcIiwgXCJudWxsXCIpLCBlLiQgPSAhMCwgaWMoZSwgYywgbnVsbCkpIDogaWMoZSwgYywgYik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLkcgPSAyO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgMyA9PSB0aGlzLkcgJiYgKGEgPyBRZCh0aGlzLCBhKSA6IDAgPT0gdGhpcy5sLmxlbmd0aCB8fCBpZCh0aGlzLmkpIHx8IFFkKHRoaXMpKTtcclxufTtcclxuZnVuY3Rpb24gUWQoYSwgYikgeyB2YXIgYzsgYiA/IGMgPSBiLm0gOiBjID0gYS5WKys7IHZhciBkID0gTihhLkYpOyBSKGQsIFwiU0lEXCIsIGEuSik7IFIoZCwgXCJSSURcIiwgYyk7IFIoZCwgXCJBSURcIiwgYS5VKTsgS2QoYSwgZCk7IGEubyAmJiBhLnMgJiYgR2QoZCwgYS5vLCBhLnMpOyBjID0gbmV3IE0oYSwgYS5oLCBjLCBhLkMgKyAxKTsgbnVsbCA9PT0gYS5vICYmIChjLkggPSBhLnMpOyBiICYmIChhLmwgPSBiLkQuY29uY2F0KGEubCkpOyBiID0gUGQoYSwgYywgMUUzKTsgYy5zZXRUaW1lb3V0KE1hdGgucm91bmQoLjUgKiBhLnJhKSArIE1hdGgucm91bmQoLjUgKiBhLnJhICogTWF0aC5yYW5kb20oKSkpOyBEYyhhLmksIGMpOyBpYyhjLCBkLCBiKTsgfVxyXG5mdW5jdGlvbiBLZChhLCBiKSB7IGEuaiAmJiBLYyh7fSwgZnVuY3Rpb24gKGMsIGQpIHsgUihiLCBkLCBjKTsgfSk7IH1cclxuZnVuY3Rpb24gUGQoYSwgYiwgYykgeyBjID0gTWF0aC5taW4oYS5sLmxlbmd0aCwgYyk7IHZhciBkID0gYS5qID8gcShhLmouT2EsIGEuaiwgYSkgOiBudWxsOyBhOiB7XHJcbiAgICB2YXIgZSA9IGEubDtcclxuICAgIHZhciBmID0gLTE7XHJcbiAgICBmb3IgKDs7KSB7XHJcbiAgICAgICAgdmFyIGggPSBbXCJjb3VudD1cIiArIGNdO1xyXG4gICAgICAgIC0xID09IGYgPyAwIDwgYyA/IChmID0gZVswXS5oLCBoLnB1c2goXCJvZnM9XCIgKyBmKSkgOiBmID0gMCA6IGgucHVzaChcIm9mcz1cIiArIGYpO1xyXG4gICAgICAgIHZhciBuID0gITA7XHJcbiAgICAgICAgZm9yICh2YXIgdSA9IDA7IHUgPCBjOyB1KyspIHtcclxuICAgICAgICAgICAgdmFyIG0gPSBlW3VdLmg7XHJcbiAgICAgICAgICAgIHZhciByID0gZVt1XS5nO1xyXG4gICAgICAgICAgICBtIC09IGY7XHJcbiAgICAgICAgICAgIGlmICgwID4gbSlcclxuICAgICAgICAgICAgICAgIGYgPSBNYXRoLm1heCgwLCBlW3VdLmggLSAxMDApLCBuID0gITE7XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWQociwgaCwgXCJyZXFcIiArIG0gKyBcIl9cIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYXRjaCAoRykge1xyXG4gICAgICAgICAgICAgICAgICAgIGQgJiYgZChyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKG4pIHtcclxuICAgICAgICAgICAgZCA9IGguam9pbihcIiZcIik7XHJcbiAgICAgICAgICAgIGJyZWFrIGE7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IGEgPSBhLmwuc3BsaWNlKDAsIGMpOyBiLkQgPSBhOyByZXR1cm4gZDsgfVxyXG5mdW5jdGlvbiBHYyhhKSB7IGEuZyB8fCBhLnUgfHwgKGEuWSA9IDEsIHpiKGEuR2EsIGEpLCBhLkEgPSAwKTsgfVxyXG5mdW5jdGlvbiBCYyhhKSB7IGlmIChhLmcgfHwgYS51IHx8IDMgPD0gYS5BKVxyXG4gICAgcmV0dXJuICExOyBhLlkrKzsgYS51ID0gSyhxKGEuR2EsIGEpLCBPZChhLCBhLkEpKTsgYS5BKys7IHJldHVybiAhMDsgfVxyXG5rLkdhID0gZnVuY3Rpb24gKCkgeyB0aGlzLnUgPSBudWxsOyBSZCh0aGlzKTsgaWYgKHRoaXMuJCAmJiAhKHRoaXMuTCB8fCBudWxsID09IHRoaXMuZyB8fCAwID49IHRoaXMuTykpIHtcclxuICAgIHZhciBhID0gMiAqIHRoaXMuTztcclxuICAgIHRoaXMuaC5pbmZvKFwiQlAgZGV0ZWN0aW9uIHRpbWVyIGVuYWJsZWQ6IFwiICsgYSk7XHJcbiAgICB0aGlzLkIgPSBLKHEodGhpcy5iYiwgdGhpcyksIGEpO1xyXG59IH07XHJcbmsuYmIgPSBmdW5jdGlvbiAoKSB7IHRoaXMuQiAmJiAodGhpcy5CID0gbnVsbCwgdGhpcy5oLmluZm8oXCJCUCBkZXRlY3Rpb24gdGltZW91dCByZWFjaGVkLlwiKSwgdGhpcy5oLmluZm8oXCJCdWZmZXJpbmcgcHJveHkgZGV0ZWN0ZWQgYW5kIHN3aXRjaCB0byBsb25nLXBvbGxpbmchXCIpLCB0aGlzLk4gPSAhMSwgdGhpcy5MID0gITAsIEooMTApLCBBYyh0aGlzKSwgUmQodGhpcykpOyB9O1xyXG5mdW5jdGlvbiB3YyhhKSB7IG51bGwgIT0gYS5CICYmIChsLmNsZWFyVGltZW91dChhLkIpLCBhLkIgPSBudWxsKTsgfVxyXG5mdW5jdGlvbiBSZChhKSB7IGEuZyA9IG5ldyBNKGEsIGEuaCwgXCJycGNcIiwgYS5ZKTsgbnVsbCA9PT0gYS5vICYmIChhLmcuSCA9IGEucyk7IGEuZy5PID0gMDsgdmFyIGIgPSBOKGEub2EpOyBSKGIsIFwiUklEXCIsIFwicnBjXCIpOyBSKGIsIFwiU0lEXCIsIGEuSik7IFIoYiwgXCJDSVwiLCBhLk4gPyBcIjBcIiA6IFwiMVwiKTsgUihiLCBcIkFJRFwiLCBhLlUpOyBLZChhLCBiKTsgUihiLCBcIlRZUEVcIiwgXCJ4bWxodHRwXCIpOyBhLm8gJiYgYS5zICYmIEdkKGIsIGEubywgYS5zKTsgYS5LICYmIGEuZy5zZXRUaW1lb3V0KGEuSyk7IHZhciBjID0gYS5nOyBhID0gYS5sYTsgYy5LID0gMTsgYy52ID0gamMoTihiKSk7IGMucyA9IG51bGw7IGMuVSA9ICEwOyBrYyhjLCBhKTsgfVxyXG5rLmFiID0gZnVuY3Rpb24gKCkgeyBudWxsICE9IHRoaXMudiAmJiAodGhpcy52ID0gbnVsbCwgQWModGhpcyksIEJjKHRoaXMpLCBKKDE5KSk7IH07XHJcbmZ1bmN0aW9uIHpjKGEpIHsgbnVsbCAhPSBhLnYgJiYgKGwuY2xlYXJUaW1lb3V0KGEudiksIGEudiA9IG51bGwpOyB9XHJcbmZ1bmN0aW9uIHVjKGEsIGIpIHsgdmFyIGMgPSBudWxsOyBpZiAoYS5nID09IGIpIHtcclxuICAgIHpjKGEpO1xyXG4gICAgd2MoYSk7XHJcbiAgICBhLmcgPSBudWxsO1xyXG4gICAgdmFyIGQgPSAyO1xyXG59XHJcbmVsc2UgaWYgKHljKGEuaSwgYikpXHJcbiAgICBjID0gYi5ELCBGYyhhLmksIGIpLCBkID0gMTtcclxuZWxzZVxyXG4gICAgcmV0dXJuOyBhLkkgPSBiLk47IGlmICgwICE9IGEuRylcclxuICAgIGlmIChiLmkpXHJcbiAgICAgICAgaWYgKDEgPT0gZCkge1xyXG4gICAgICAgICAgICBjID0gYi5zID8gYi5zLmxlbmd0aCA6IDA7XHJcbiAgICAgICAgICAgIGIgPSBEYXRlLm5vdygpIC0gYi5GO1xyXG4gICAgICAgICAgICB2YXIgZSA9IGEuQztcclxuICAgICAgICAgICAgZCA9IFNiKCk7XHJcbiAgICAgICAgICAgIEQoZCwgbmV3IFZiKGQsIGMsIGIsIGUpKTtcclxuICAgICAgICAgICAgSGMoYSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgR2MoYSk7XHJcbiAgICBlbHNlIGlmIChlID0gYi5vLCAzID09IGUgfHwgMCA9PSBlICYmIDAgPCBhLkkgfHwgISgxID09IGQgJiYgTmQoYSwgYikgfHwgMiA9PSBkICYmIEJjKGEpKSlcclxuICAgICAgICBzd2l0Y2ggKGMgJiYgMCA8IGMubGVuZ3RoICYmIChiID0gYS5pLCBiLmkgPSBiLmkuY29uY2F0KGMpKSwgZSkge1xyXG4gICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICBRKGEsIDUpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgNDpcclxuICAgICAgICAgICAgICAgIFEoYSwgMTApO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgICAgIFEoYSwgNik7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgZGVmYXVsdDogUShhLCAyKTtcclxuICAgICAgICB9IH1cclxuZnVuY3Rpb24gT2QoYSwgYikgeyB2YXIgYyA9IGEuUGEgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBhLiRhKTsgYS5qIHx8IChjICo9IDIpOyByZXR1cm4gYyAqIGI7IH1cclxuZnVuY3Rpb24gUShhLCBiKSB7IGEuaC5pbmZvKFwiRXJyb3IgY29kZSBcIiArIGIpOyBpZiAoMiA9PSBiKSB7XHJcbiAgICB2YXIgYyA9IG51bGw7XHJcbiAgICBhLmogJiYgKGMgPSBudWxsKTtcclxuICAgIHZhciBkID0gcShhLmpiLCBhKTtcclxuICAgIGMgfHwgKGMgPSBuZXcgVShcIi8vd3d3Lmdvb2dsZS5jb20vaW1hZ2VzL2NsZWFyZG90LmdpZlwiKSwgbC5sb2NhdGlvbiAmJiBcImh0dHBcIiA9PSBsLmxvY2F0aW9uLnByb3RvY29sIHx8IE9jKGMsIFwiaHR0cHNcIiksIGpjKGMpKTtcclxuICAgIG5kKGMudG9TdHJpbmcoKSwgZCk7XHJcbn1cclxuZWxzZVxyXG4gICAgSigyKTsgYS5HID0gMDsgYS5qICYmIGEuai52YShiKTsgTGQoYSk7IEpkKGEpOyB9XHJcbmsuamIgPSBmdW5jdGlvbiAoYSkgeyBhID8gKHRoaXMuaC5pbmZvKFwiU3VjY2Vzc2Z1bGx5IHBpbmdlZCBnb29nbGUuY29tXCIpLCBKKDIpKSA6ICh0aGlzLmguaW5mbyhcIkZhaWxlZCB0byBwaW5nIGdvb2dsZS5jb21cIiksIEooMSkpOyB9O1xyXG5mdW5jdGlvbiBMZChhKSB7IGEuRyA9IDA7IGEuSSA9IC0xOyBpZiAoYS5qKSB7XHJcbiAgICBpZiAoMCAhPSBqZChhLmkpLmxlbmd0aCB8fCAwICE9IGEubC5sZW5ndGgpXHJcbiAgICAgICAgYS5pLmkubGVuZ3RoID0gMCwgcmEoYS5sKSwgYS5sLmxlbmd0aCA9IDA7XHJcbiAgICBhLmoudWEoKTtcclxufSB9XHJcbmZ1bmN0aW9uIEVjKGEsIGIsIGMpIHsgdmFyIGQgPSBhZChjKTsgaWYgKFwiXCIgIT0gZC5pKVxyXG4gICAgYiAmJiBQYyhkLCBiICsgXCIuXCIgKyBkLmkpLCBRYyhkLCBkLm0pO1xyXG5lbHNlIHtcclxuICAgIHZhciBlID0gbC5sb2NhdGlvbjtcclxuICAgIGQgPSBiZChlLnByb3RvY29sLCBiID8gYiArIFwiLlwiICsgZS5ob3N0bmFtZSA6IGUuaG9zdG5hbWUsICtlLnBvcnQsIGMpO1xyXG59IGEuYWEgJiYgeGEoYS5hYSwgZnVuY3Rpb24gKGUsIGYpIHsgUihkLCBmLCBlKTsgfSk7IGIgPSBhLkQ7IGMgPSBhLnNhOyBiICYmIGMgJiYgUihkLCBiLCBjKTsgUihkLCBcIlZFUlwiLCBhLm1hKTsgS2QoYSwgZCk7IHJldHVybiBkOyB9XHJcbmZ1bmN0aW9uIG5jKGEsIGIsIGMpIHsgaWYgKGIgJiYgIWEuSClcclxuICAgIHRocm93IEVycm9yKFwiQ2FuJ3QgY3JlYXRlIHNlY29uZGFyeSBkb21haW4gY2FwYWJsZSBYaHJJbyBvYmplY3QuXCIpOyBiID0gYyAmJiBhLkJhICYmICFhLnFhID8gbmV3IFgobmV3IHBkKHsgaWI6ICEwIH0pKSA6IG5ldyBYKGEucWEpOyBiLkwgPSBhLkg7IHJldHVybiBiOyB9XHJcbmZ1bmN0aW9uIFNkKCkgeyB9XHJcbmsgPSBTZC5wcm90b3R5cGU7XHJcbmsueGEgPSBmdW5jdGlvbiAoKSB7IH07XHJcbmsud2EgPSBmdW5jdGlvbiAoKSB7IH07XHJcbmsudmEgPSBmdW5jdGlvbiAoKSB7IH07XHJcbmsudWEgPSBmdW5jdGlvbiAoKSB7IH07XHJcbmsuT2EgPSBmdW5jdGlvbiAoKSB7IH07XHJcbmZ1bmN0aW9uIFRkKCkgeyBpZiAoeSAmJiAhKDEwIDw9IE51bWJlcihVYSkpKVxyXG4gICAgdGhyb3cgRXJyb3IoXCJFbnZpcm9ubWVudGFsIGVycm9yOiBubyBhdmFpbGFibGUgdHJhbnNwb3J0LlwiKTsgfVxyXG5UZC5wcm90b3R5cGUuZyA9IGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBuZXcgWShhLCBiKTsgfTtcclxuZnVuY3Rpb24gWShhLCBiKSB7XHJcbiAgICBDLmNhbGwodGhpcyk7XHJcbiAgICB0aGlzLmcgPSBuZXcgSWQoYik7XHJcbiAgICB0aGlzLmwgPSBhO1xyXG4gICAgdGhpcy5oID0gYiAmJiBiLm1lc3NhZ2VVcmxQYXJhbXMgfHwgbnVsbDtcclxuICAgIGEgPSBiICYmIGIubWVzc2FnZUhlYWRlcnMgfHwgbnVsbDtcclxuICAgIGIgJiYgYi5jbGllbnRQcm90b2NvbEhlYWRlclJlcXVpcmVkICYmIChhID8gYVtcIlgtQ2xpZW50LVByb3RvY29sXCJdID0gXCJ3ZWJjaGFubmVsXCIgOiBhID0geyBcIlgtQ2xpZW50LVByb3RvY29sXCI6IFwid2ViY2hhbm5lbFwiIH0pO1xyXG4gICAgdGhpcy5nLnMgPSBhO1xyXG4gICAgYSA9IGIgJiYgYi5pbml0TWVzc2FnZUhlYWRlcnMgfHwgbnVsbDtcclxuICAgIGIgJiYgYi5tZXNzYWdlQ29udGVudFR5cGUgJiYgKGEgPyBhW1wiWC1XZWJDaGFubmVsLUNvbnRlbnQtVHlwZVwiXSA9IGIubWVzc2FnZUNvbnRlbnRUeXBlIDogYSA9IHsgXCJYLVdlYkNoYW5uZWwtQ29udGVudC1UeXBlXCI6IGIubWVzc2FnZUNvbnRlbnRUeXBlIH0pO1xyXG4gICAgYiAmJiBiLnlhICYmIChhID8gYVtcIlgtV2ViQ2hhbm5lbC1DbGllbnQtUHJvZmlsZVwiXSA9IGIueWEgOiBhID0geyBcIlgtV2ViQ2hhbm5lbC1DbGllbnQtUHJvZmlsZVwiOiBiLnlhIH0pO1xyXG4gICAgdGhpcy5nLlAgPVxyXG4gICAgICAgIGE7XHJcbiAgICAoYSA9IGIgJiYgYi5odHRwSGVhZGVyc092ZXJ3cml0ZVBhcmFtKSAmJiAhc2EoYSkgJiYgKHRoaXMuZy5vID0gYSk7XHJcbiAgICB0aGlzLkEgPSBiICYmIGIuc3VwcG9ydHNDcm9zc0RvbWFpblhociB8fCAhMTtcclxuICAgIHRoaXMudiA9IGIgJiYgYi5zZW5kUmF3SnNvbiB8fCAhMTtcclxuICAgIChiID0gYiAmJiBiLmh0dHBTZXNzaW9uSWRQYXJhbSkgJiYgIXNhKGIpICYmICh0aGlzLmcuRCA9IGIsIGEgPSB0aGlzLmgsIG51bGwgIT09IGEgJiYgYiBpbiBhICYmIChhID0gdGhpcy5oLCBiIGluIGEgJiYgZGVsZXRlIGFbYl0pKTtcclxuICAgIHRoaXMuaiA9IG5ldyBaKHRoaXMpO1xyXG59XHJcbnQoWSwgQyk7XHJcblkucHJvdG90eXBlLm0gPSBmdW5jdGlvbiAoKSB7IHRoaXMuZy5qID0gdGhpcy5qOyB0aGlzLkEgJiYgKHRoaXMuZy5IID0gITApOyB2YXIgYSA9IHRoaXMuZywgYiA9IHRoaXMubCwgYyA9IHRoaXMuaCB8fCB2b2lkIDA7IGEuV2EgJiYgKGEuaC5pbmZvKFwiT3JpZ2luIFRyaWFscyBlbmFibGVkLlwiKSwgemIocShhLmhiLCBhLCBiKSkpOyBKKDApOyBhLlcgPSBiOyBhLmFhID0gYyB8fCB7fTsgYS5OID0gYS5YOyBhLkYgPSBFYyhhLCBudWxsLCBhLlcpOyBIYyhhKTsgfTtcclxuWS5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiAoKSB7IEljKHRoaXMuZyk7IH07XHJcblkucHJvdG90eXBlLnUgPSBmdW5jdGlvbiAoYSkgeyBpZiAoXCJzdHJpbmdcIiA9PT0gdHlwZW9mIGEpIHtcclxuICAgIHZhciBiID0ge307XHJcbiAgICBiLl9fZGF0YV9fID0gYTtcclxuICAgIE1kKHRoaXMuZywgYik7XHJcbn1cclxuZWxzZVxyXG4gICAgdGhpcy52ID8gKGIgPSB7fSwgYi5fX2RhdGFfXyA9IHJiKGEpLCBNZCh0aGlzLmcsIGIpKSA6IE1kKHRoaXMuZywgYSk7IH07XHJcblkucHJvdG90eXBlLk0gPSBmdW5jdGlvbiAoKSB7IHRoaXMuZy5qID0gbnVsbDsgZGVsZXRlIHRoaXMuajsgSWModGhpcy5nKTsgZGVsZXRlIHRoaXMuZzsgWS5aLk0uY2FsbCh0aGlzKTsgfTtcclxuZnVuY3Rpb24gVWQoYSkgeyBhYy5jYWxsKHRoaXMpOyB2YXIgYiA9IGEuX19zbV9fOyBpZiAoYikge1xyXG4gICAgYToge1xyXG4gICAgICAgIGZvciAodmFyIGMgaW4gYikge1xyXG4gICAgICAgICAgICBhID0gYztcclxuICAgICAgICAgICAgYnJlYWsgYTtcclxuICAgICAgICB9XHJcbiAgICAgICAgYSA9IHZvaWQgMDtcclxuICAgIH1cclxuICAgIGlmICh0aGlzLmkgPSBhKVxyXG4gICAgICAgIGEgPSB0aGlzLmksIGIgPSBudWxsICE9PSBiICYmIGEgaW4gYiA/IGJbYV0gOiB2b2lkIDA7XHJcbiAgICB0aGlzLmRhdGEgPSBiO1xyXG59XHJcbmVsc2VcclxuICAgIHRoaXMuZGF0YSA9IGE7IH1cclxudChVZCwgYWMpO1xyXG5mdW5jdGlvbiBWZCgpIHsgYmMuY2FsbCh0aGlzKTsgdGhpcy5zdGF0dXMgPSAxOyB9XHJcbnQoVmQsIGJjKTtcclxuZnVuY3Rpb24gWihhKSB7IHRoaXMuZyA9IGE7IH1cclxudChaLCBTZCk7XHJcbloucHJvdG90eXBlLnhhID0gZnVuY3Rpb24gKCkgeyBEKHRoaXMuZywgXCJhXCIpOyB9O1xyXG5aLnByb3RvdHlwZS53YSA9IGZ1bmN0aW9uIChhKSB7IEQodGhpcy5nLCBuZXcgVWQoYSkpOyB9O1xyXG5aLnByb3RvdHlwZS52YSA9IGZ1bmN0aW9uIChhKSB7IEQodGhpcy5nLCBuZXcgVmQoYSkpOyB9O1xyXG5aLnByb3RvdHlwZS51YSA9IGZ1bmN0aW9uICgpIHsgRCh0aGlzLmcsIFwiYlwiKTsgfTsgLypcclxuXG4gQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG5cbiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4geW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcblxuICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcblxuIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiovXHJcblRkLnByb3RvdHlwZS5jcmVhdGVXZWJDaGFubmVsID0gVGQucHJvdG90eXBlLmc7XHJcblkucHJvdG90eXBlLnNlbmQgPSBZLnByb3RvdHlwZS51O1xyXG5ZLnByb3RvdHlwZS5vcGVuID0gWS5wcm90b3R5cGUubTtcclxuWS5wcm90b3R5cGUuY2xvc2UgPSBZLnByb3RvdHlwZS5jbG9zZTtcclxuV2IuTk9fRVJST1IgPSAwO1xyXG5XYi5USU1FT1VUID0gODtcclxuV2IuSFRUUF9FUlJPUiA9IDY7XHJcblhiLkNPTVBMRVRFID0gXCJjb21wbGV0ZVwiO1xyXG4kYi5FdmVudFR5cGUgPSBMO1xyXG5MLk9QRU4gPSBcImFcIjtcclxuTC5DTE9TRSA9IFwiYlwiO1xyXG5MLkVSUk9SID0gXCJjXCI7XHJcbkwuTUVTU0FHRSA9IFwiZFwiO1xyXG5DLnByb3RvdHlwZS5saXN0ZW4gPSBDLnByb3RvdHlwZS5OO1xyXG5YLnByb3RvdHlwZS5saXN0ZW5PbmNlID0gWC5wcm90b3R5cGUuTztcclxuWC5wcm90b3R5cGUuZ2V0TGFzdEVycm9yID0gWC5wcm90b3R5cGUuTGE7XHJcblgucHJvdG90eXBlLmdldExhc3RFcnJvckNvZGUgPSBYLnByb3RvdHlwZS5EYTtcclxuWC5wcm90b3R5cGUuZ2V0U3RhdHVzID0gWC5wcm90b3R5cGUuYmE7XHJcblgucHJvdG90eXBlLmdldFJlc3BvbnNlSnNvbiA9IFgucHJvdG90eXBlLlFhO1xyXG5YLnByb3RvdHlwZS5nZXRSZXNwb25zZVRleHQgPSBYLnByb3RvdHlwZS5nYTtcclxuWC5wcm90b3R5cGUuc2VuZCA9IFgucHJvdG90eXBlLmVhO1xyXG52YXIgY3JlYXRlV2ViQ2hhbm5lbFRyYW5zcG9ydCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5ldyBUZDsgfTtcclxudmFyIGdldFN0YXRFdmVudFRhcmdldCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIFNiKCk7IH07XHJcbnZhciBFcnJvckNvZGUgPSBXYjtcclxudmFyIEV2ZW50VHlwZSA9IFhiO1xyXG52YXIgRXZlbnQgPSBIO1xyXG52YXIgU3RhdCA9IHsgcmI6IDAsIHViOiAxLCB2YjogMiwgT2I6IDMsIFRiOiA0LCBRYjogNSwgUmI6IDYsIFBiOiA3LCBOYjogOCwgU2I6IDksIFBST1hZOiAxMCwgTk9QUk9YWTogMTEsIExiOiAxMiwgSGI6IDEzLCBJYjogMTQsIEdiOiAxNSwgSmI6IDE2LCBLYjogMTcsIG5iOiAxOCwgbWI6IDE5LCBvYjogMjAgfTtcclxudmFyIEZldGNoWG1sSHR0cEZhY3RvcnkgPSBwZDtcclxudmFyIFdlYkNoYW5uZWwgPSAkYjtcclxudmFyIFhocklvID0gWDtcclxuXHJcbnZhciBlc20gPSB7XHJcbiAgICBjcmVhdGVXZWJDaGFubmVsVHJhbnNwb3J0OiBjcmVhdGVXZWJDaGFubmVsVHJhbnNwb3J0LFxyXG4gICAgZ2V0U3RhdEV2ZW50VGFyZ2V0OiBnZXRTdGF0RXZlbnRUYXJnZXQsXHJcbiAgICBFcnJvckNvZGU6IEVycm9yQ29kZSxcclxuICAgIEV2ZW50VHlwZTogRXZlbnRUeXBlLFxyXG4gICAgRXZlbnQ6IEV2ZW50LFxyXG4gICAgU3RhdDogU3RhdCxcclxuICAgIEZldGNoWG1sSHR0cEZhY3Rvcnk6IEZldGNoWG1sSHR0cEZhY3RvcnksXHJcbiAgICBXZWJDaGFubmVsOiBXZWJDaGFubmVsLFxyXG4gICAgWGhySW86IFhocklvXHJcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGVzbTtcbmV4cG9ydCB7IEVycm9yQ29kZSwgRXZlbnQsIEV2ZW50VHlwZSwgRmV0Y2hYbWxIdHRwRmFjdG9yeSwgU3RhdCwgV2ViQ2hhbm5lbCwgWGhySW8sIGNyZWF0ZVdlYkNoYW5uZWxUcmFuc3BvcnQsIGdldFN0YXRFdmVudFRhcmdldCB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguZXNtLmpzLm1hcFxuIiwiaW1wb3J0IHsgX192YWx1ZXMsIF9fcmVhZCwgX19hd2FpdGVyLCBfX2dlbmVyYXRvciwgX19zcHJlYWRBcnJheSB9IGZyb20gJ3RzbGliJztcbmltcG9ydCB7IERlZmVycmVkIH0gZnJvbSAnQGZpcmViYXNlL3V0aWwnO1xuXG4vKipcclxuICogQ29tcG9uZW50IGZvciBzZXJ2aWNlIG5hbWUgVCwgZS5nLiBgYXV0aGAsIGBhdXRoLWludGVybmFsYFxyXG4gKi9cclxudmFyIENvbXBvbmVudCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIC8qKlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBuYW1lIFRoZSBwdWJsaWMgc2VydmljZSBuYW1lLCBlLmcuIGFwcCwgYXV0aCwgZmlyZXN0b3JlLCBkYXRhYmFzZVxyXG4gICAgICogQHBhcmFtIGluc3RhbmNlRmFjdG9yeSBTZXJ2aWNlIGZhY3RvcnkgcmVzcG9uc2libGUgZm9yIGNyZWF0aW5nIHRoZSBwdWJsaWMgaW50ZXJmYWNlXHJcbiAgICAgKiBAcGFyYW0gdHlwZSB3aGV0aGVyIHRoZSBzZXJ2aWNlIHByb3ZpZGVkIGJ5IHRoZSBjb21wb25lbnQgaXMgcHVibGljIG9yIHByaXZhdGVcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gQ29tcG9uZW50KG5hbWUsIGluc3RhbmNlRmFjdG9yeSwgdHlwZSkge1xyXG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XHJcbiAgICAgICAgdGhpcy5pbnN0YW5jZUZhY3RvcnkgPSBpbnN0YW5jZUZhY3Rvcnk7XHJcbiAgICAgICAgdGhpcy50eXBlID0gdHlwZTtcclxuICAgICAgICB0aGlzLm11bHRpcGxlSW5zdGFuY2VzID0gZmFsc2U7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogUHJvcGVydGllcyB0byBiZSBhZGRlZCB0byB0aGUgc2VydmljZSBuYW1lc3BhY2VcclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLnNlcnZpY2VQcm9wcyA9IHt9O1xyXG4gICAgICAgIHRoaXMuaW5zdGFudGlhdGlvbk1vZGUgPSBcIkxBWllcIiAvKiBMQVpZICovO1xyXG4gICAgICAgIHRoaXMub25JbnN0YW5jZUNyZWF0ZWQgPSBudWxsO1xyXG4gICAgfVxyXG4gICAgQ29tcG9uZW50LnByb3RvdHlwZS5zZXRJbnN0YW50aWF0aW9uTW9kZSA9IGZ1bmN0aW9uIChtb2RlKSB7XHJcbiAgICAgICAgdGhpcy5pbnN0YW50aWF0aW9uTW9kZSA9IG1vZGU7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9O1xyXG4gICAgQ29tcG9uZW50LnByb3RvdHlwZS5zZXRNdWx0aXBsZUluc3RhbmNlcyA9IGZ1bmN0aW9uIChtdWx0aXBsZUluc3RhbmNlcykge1xyXG4gICAgICAgIHRoaXMubXVsdGlwbGVJbnN0YW5jZXMgPSBtdWx0aXBsZUluc3RhbmNlcztcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH07XHJcbiAgICBDb21wb25lbnQucHJvdG90eXBlLnNldFNlcnZpY2VQcm9wcyA9IGZ1bmN0aW9uIChwcm9wcykge1xyXG4gICAgICAgIHRoaXMuc2VydmljZVByb3BzID0gcHJvcHM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9O1xyXG4gICAgQ29tcG9uZW50LnByb3RvdHlwZS5zZXRJbnN0YW5jZUNyZWF0ZWRDYWxsYmFjayA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xyXG4gICAgICAgIHRoaXMub25JbnN0YW5jZUNyZWF0ZWQgPSBjYWxsYmFjaztcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH07XHJcbiAgICByZXR1cm4gQ29tcG9uZW50O1xyXG59KCkpO1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgREVGQVVMVF9FTlRSWV9OQU1FID0gJ1tERUZBVUxUXSc7XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBQcm92aWRlciBmb3IgaW5zdGFuY2UgZm9yIHNlcnZpY2UgbmFtZSBULCBlLmcuICdhdXRoJywgJ2F1dGgtaW50ZXJuYWwnXHJcbiAqIE5hbWVTZXJ2aWNlTWFwcGluZ1tUXSBpcyBhbiBhbGlhcyBmb3IgdGhlIHR5cGUgb2YgdGhlIGluc3RhbmNlXHJcbiAqL1xyXG52YXIgUHJvdmlkZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBQcm92aWRlcihuYW1lLCBjb250YWluZXIpIHtcclxuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xyXG4gICAgICAgIHRoaXMuY29tcG9uZW50ID0gbnVsbDtcclxuICAgICAgICB0aGlzLmluc3RhbmNlcyA9IG5ldyBNYXAoKTtcclxuICAgICAgICB0aGlzLmluc3RhbmNlc0RlZmVycmVkID0gbmV3IE1hcCgpO1xyXG4gICAgICAgIHRoaXMuaW5zdGFuY2VzT3B0aW9ucyA9IG5ldyBNYXAoKTtcclxuICAgICAgICB0aGlzLm9uSW5pdENhbGxiYWNrcyA9IG5ldyBNYXAoKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQHBhcmFtIGlkZW50aWZpZXIgQSBwcm92aWRlciBjYW4gcHJvdmlkZSBtdWxpdHBsZSBpbnN0YW5jZXMgb2YgYSBzZXJ2aWNlXHJcbiAgICAgKiBpZiB0aGlzLmNvbXBvbmVudC5tdWx0aXBsZUluc3RhbmNlcyBpcyB0cnVlLlxyXG4gICAgICovXHJcbiAgICBQcm92aWRlci5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKGlkZW50aWZpZXIpIHtcclxuICAgICAgICAvLyBpZiBtdWx0aXBsZUluc3RhbmNlcyBpcyBub3Qgc3VwcG9ydGVkLCB1c2UgdGhlIGRlZmF1bHQgbmFtZVxyXG4gICAgICAgIHZhciBub3JtYWxpemVkSWRlbnRpZmllciA9IHRoaXMubm9ybWFsaXplSW5zdGFuY2VJZGVudGlmaWVyKGlkZW50aWZpZXIpO1xyXG4gICAgICAgIGlmICghdGhpcy5pbnN0YW5jZXNEZWZlcnJlZC5oYXMobm9ybWFsaXplZElkZW50aWZpZXIpKSB7XHJcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9IG5ldyBEZWZlcnJlZCgpO1xyXG4gICAgICAgICAgICB0aGlzLmluc3RhbmNlc0RlZmVycmVkLnNldChub3JtYWxpemVkSWRlbnRpZmllciwgZGVmZXJyZWQpO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5pc0luaXRpYWxpemVkKG5vcm1hbGl6ZWRJZGVudGlmaWVyKSB8fFxyXG4gICAgICAgICAgICAgICAgdGhpcy5zaG91bGRBdXRvSW5pdGlhbGl6ZSgpKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBpbml0aWFsaXplIHRoZSBzZXJ2aWNlIGlmIGl0IGNhbiBiZSBhdXRvLWluaXRpYWxpemVkXHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbnN0YW5jZSA9IHRoaXMuZ2V0T3JJbml0aWFsaXplU2VydmljZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbmNlSWRlbnRpZmllcjogbm9ybWFsaXplZElkZW50aWZpZXJcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaW5zdGFuY2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShpbnN0YW5jZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyB3aGVuIHRoZSBpbnN0YW5jZSBmYWN0b3J5IHRocm93cyBhbiBleGNlcHRpb24gZHVyaW5nIGdldCgpLCBpdCBzaG91bGQgbm90IGNhdXNlXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gYSBmYXRhbCBlcnJvci4gV2UganVzdCByZXR1cm4gdGhlIHVucmVzb2x2ZWQgcHJvbWlzZSBpbiB0aGlzIGNhc2UuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5zdGFuY2VzRGVmZXJyZWQuZ2V0KG5vcm1hbGl6ZWRJZGVudGlmaWVyKS5wcm9taXNlO1xyXG4gICAgfTtcclxuICAgIFByb3ZpZGVyLnByb3RvdHlwZS5nZXRJbW1lZGlhdGUgPSBmdW5jdGlvbiAob3B0aW9ucykge1xyXG4gICAgICAgIHZhciBfYTtcclxuICAgICAgICAvLyBpZiBtdWx0aXBsZUluc3RhbmNlcyBpcyBub3Qgc3VwcG9ydGVkLCB1c2UgdGhlIGRlZmF1bHQgbmFtZVxyXG4gICAgICAgIHZhciBub3JtYWxpemVkSWRlbnRpZmllciA9IHRoaXMubm9ybWFsaXplSW5zdGFuY2VJZGVudGlmaWVyKG9wdGlvbnMgPT09IG51bGwgfHwgb3B0aW9ucyA9PT0gdm9pZCAwID8gdm9pZCAwIDogb3B0aW9ucy5pZGVudGlmaWVyKTtcclxuICAgICAgICB2YXIgb3B0aW9uYWwgPSAoX2EgPSBvcHRpb25zID09PSBudWxsIHx8IG9wdGlvbnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG9wdGlvbnMub3B0aW9uYWwpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IGZhbHNlO1xyXG4gICAgICAgIGlmICh0aGlzLmlzSW5pdGlhbGl6ZWQobm9ybWFsaXplZElkZW50aWZpZXIpIHx8XHJcbiAgICAgICAgICAgIHRoaXMuc2hvdWxkQXV0b0luaXRpYWxpemUoKSkge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0T3JJbml0aWFsaXplU2VydmljZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2VJZGVudGlmaWVyOiBub3JtYWxpemVkSWRlbnRpZmllclxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgIGlmIChvcHRpb25hbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gSW4gY2FzZSBhIGNvbXBvbmVudCBpcyBub3QgaW5pdGlhbGl6ZWQgYW5kIHNob3VsZC9jYW4gbm90IGJlIGF1dG8taW5pdGlhbGl6ZWQgYXQgdGhlIG1vbWVudCwgcmV0dXJuIG51bGwgaWYgdGhlIG9wdGlvbmFsIGZsYWcgaXMgc2V0LCBvciB0aHJvd1xyXG4gICAgICAgICAgICBpZiAob3B0aW9uYWwpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgRXJyb3IoXCJTZXJ2aWNlIFwiICsgdGhpcy5uYW1lICsgXCIgaXMgbm90IGF2YWlsYWJsZVwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBQcm92aWRlci5wcm90b3R5cGUuZ2V0Q29tcG9uZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNvbXBvbmVudDtcclxuICAgIH07XHJcbiAgICBQcm92aWRlci5wcm90b3R5cGUuc2V0Q29tcG9uZW50ID0gZnVuY3Rpb24gKGNvbXBvbmVudCkge1xyXG4gICAgICAgIHZhciBlXzEsIF9hO1xyXG4gICAgICAgIGlmIChjb21wb25lbnQubmFtZSAhPT0gdGhpcy5uYW1lKSB7XHJcbiAgICAgICAgICAgIHRocm93IEVycm9yKFwiTWlzbWF0Y2hpbmcgQ29tcG9uZW50IFwiICsgY29tcG9uZW50Lm5hbWUgKyBcIiBmb3IgUHJvdmlkZXIgXCIgKyB0aGlzLm5hbWUgKyBcIi5cIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmNvbXBvbmVudCkge1xyXG4gICAgICAgICAgICB0aHJvdyBFcnJvcihcIkNvbXBvbmVudCBmb3IgXCIgKyB0aGlzLm5hbWUgKyBcIiBoYXMgYWxyZWFkeSBiZWVuIHByb3ZpZGVkXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNvbXBvbmVudCA9IGNvbXBvbmVudDtcclxuICAgICAgICAvLyByZXR1cm4gZWFybHkgd2l0aG91dCBhdHRlbXB0aW5nIHRvIGluaXRpYWxpemUgdGhlIGNvbXBvbmVudCBpZiB0aGUgY29tcG9uZW50IHJlcXVpcmVzIGV4cGxpY2l0IGluaXRpYWxpemF0aW9uIChjYWxsaW5nIGBQcm92aWRlci5pbml0aWFsaXplKClgKVxyXG4gICAgICAgIGlmICghdGhpcy5zaG91bGRBdXRvSW5pdGlhbGl6ZSgpKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gaWYgdGhlIHNlcnZpY2UgaXMgZWFnZXIsIGluaXRpYWxpemUgdGhlIGRlZmF1bHQgaW5zdGFuY2VcclxuICAgICAgICBpZiAoaXNDb21wb25lbnRFYWdlcihjb21wb25lbnQpKSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdldE9ySW5pdGlhbGl6ZVNlcnZpY2UoeyBpbnN0YW5jZUlkZW50aWZpZXI6IERFRkFVTFRfRU5UUllfTkFNRSB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgLy8gd2hlbiB0aGUgaW5zdGFuY2UgZmFjdG9yeSBmb3IgYW4gZWFnZXIgQ29tcG9uZW50IHRocm93cyBhbiBleGNlcHRpb24gZHVyaW5nIHRoZSBlYWdlclxyXG4gICAgICAgICAgICAgICAgLy8gaW5pdGlhbGl6YXRpb24sIGl0IHNob3VsZCBub3QgY2F1c2UgYSBmYXRhbCBlcnJvci5cclxuICAgICAgICAgICAgICAgIC8vIFRPRE86IEludmVzdGlnYXRlIGlmIHdlIG5lZWQgdG8gbWFrZSBpdCBjb25maWd1cmFibGUsIGJlY2F1c2Ugc29tZSBjb21wb25lbnQgbWF5IHdhbnQgdG8gY2F1c2VcclxuICAgICAgICAgICAgICAgIC8vIGEgZmF0YWwgZXJyb3IgaW4gdGhpcyBjYXNlP1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIC8vIENyZWF0ZSBzZXJ2aWNlIGluc3RhbmNlcyBmb3IgdGhlIHBlbmRpbmcgcHJvbWlzZXMgYW5kIHJlc29sdmUgdGhlbVxyXG4gICAgICAgICAgICAvLyBOT1RFOiBpZiB0aGlzLm11bHRpcGxlSW5zdGFuY2VzIGlzIGZhbHNlLCBvbmx5IHRoZSBkZWZhdWx0IGluc3RhbmNlIHdpbGwgYmUgY3JlYXRlZFxyXG4gICAgICAgICAgICAvLyBhbmQgYWxsIHByb21pc2VzIHdpdGggcmVzb2x2ZSB3aXRoIGl0IHJlZ2FyZGxlc3Mgb2YgdGhlIGlkZW50aWZpZXIuXHJcbiAgICAgICAgICAgIGZvciAodmFyIF9iID0gX192YWx1ZXModGhpcy5pbnN0YW5jZXNEZWZlcnJlZC5lbnRyaWVzKCkpLCBfYyA9IF9iLm5leHQoKTsgIV9jLmRvbmU7IF9jID0gX2IubmV4dCgpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgX2QgPSBfX3JlYWQoX2MudmFsdWUsIDIpLCBpbnN0YW5jZUlkZW50aWZpZXIgPSBfZFswXSwgaW5zdGFuY2VEZWZlcnJlZCA9IF9kWzFdO1xyXG4gICAgICAgICAgICAgICAgdmFyIG5vcm1hbGl6ZWRJZGVudGlmaWVyID0gdGhpcy5ub3JtYWxpemVJbnN0YW5jZUlkZW50aWZpZXIoaW5zdGFuY2VJZGVudGlmaWVyKTtcclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gYGdldE9ySW5pdGlhbGl6ZVNlcnZpY2UoKWAgc2hvdWxkIGFsd2F5cyByZXR1cm4gYSB2YWxpZCBpbnN0YW5jZSBzaW5jZSBhIGNvbXBvbmVudCBpcyBndWFyYW50ZWVkLiB1c2UgISB0byBtYWtlIHR5cGVzY3JpcHQgaGFwcHkuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluc3RhbmNlID0gdGhpcy5nZXRPckluaXRpYWxpemVTZXJ2aWNlKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2VJZGVudGlmaWVyOiBub3JtYWxpemVkSWRlbnRpZmllclxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGluc3RhbmNlRGVmZXJyZWQucmVzb2x2ZShpbnN0YW5jZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHdoZW4gdGhlIGluc3RhbmNlIGZhY3RvcnkgdGhyb3dzIGFuIGV4Y2VwdGlvbiwgaXQgc2hvdWxkIG5vdCBjYXVzZVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGEgZmF0YWwgZXJyb3IuIFdlIGp1c3QgbGVhdmUgdGhlIHByb21pc2UgdW5yZXNvbHZlZC5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfVxyXG4gICAgICAgIGZpbmFsbHkge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgaWYgKF9jICYmICFfYy5kb25lICYmIChfYSA9IF9iLnJldHVybikpIF9hLmNhbGwoX2IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgUHJvdmlkZXIucHJvdG90eXBlLmNsZWFySW5zdGFuY2UgPSBmdW5jdGlvbiAoaWRlbnRpZmllcikge1xyXG4gICAgICAgIGlmIChpZGVudGlmaWVyID09PSB2b2lkIDApIHsgaWRlbnRpZmllciA9IERFRkFVTFRfRU5UUllfTkFNRTsgfVxyXG4gICAgICAgIHRoaXMuaW5zdGFuY2VzRGVmZXJyZWQuZGVsZXRlKGlkZW50aWZpZXIpO1xyXG4gICAgICAgIHRoaXMuaW5zdGFuY2VzT3B0aW9ucy5kZWxldGUoaWRlbnRpZmllcik7XHJcbiAgICAgICAgdGhpcy5pbnN0YW5jZXMuZGVsZXRlKGlkZW50aWZpZXIpO1xyXG4gICAgfTtcclxuICAgIC8vIGFwcC5kZWxldGUoKSB3aWxsIGNhbGwgdGhpcyBtZXRob2Qgb24gZXZlcnkgcHJvdmlkZXIgdG8gZGVsZXRlIHRoZSBzZXJ2aWNlc1xyXG4gICAgLy8gVE9ETzogc2hvdWxkIHdlIG1hcmsgdGhlIHByb3ZpZGVyIGFzIGRlbGV0ZWQ/XHJcbiAgICBQcm92aWRlci5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHNlcnZpY2VzO1xyXG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlcyA9IEFycmF5LmZyb20odGhpcy5pbnN0YW5jZXMudmFsdWVzKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBQcm9taXNlLmFsbChfX3NwcmVhZEFycmF5KF9fc3ByZWFkQXJyYXkoW10sIF9fcmVhZChzZXJ2aWNlc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKHNlcnZpY2UpIHsgcmV0dXJuICdJTlRFUk5BTCcgaW4gc2VydmljZTsgfSkgLy8gbGVnYWN5IHNlcnZpY2VzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChzZXJ2aWNlKSB7IHJldHVybiBzZXJ2aWNlLklOVEVSTkFMLmRlbGV0ZSgpOyB9KSkpLCBfX3JlYWQoc2VydmljZXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChzZXJ2aWNlKSB7IHJldHVybiAnX2RlbGV0ZScgaW4gc2VydmljZTsgfSkgLy8gbW9kdWxhcml6ZWQgc2VydmljZXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKHNlcnZpY2UpIHsgcmV0dXJuIHNlcnZpY2UuX2RlbGV0ZSgpOyB9KSkpKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgUHJvdmlkZXIucHJvdG90eXBlLmlzQ29tcG9uZW50U2V0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNvbXBvbmVudCAhPSBudWxsO1xyXG4gICAgfTtcclxuICAgIFByb3ZpZGVyLnByb3RvdHlwZS5pc0luaXRpYWxpemVkID0gZnVuY3Rpb24gKGlkZW50aWZpZXIpIHtcclxuICAgICAgICBpZiAoaWRlbnRpZmllciA9PT0gdm9pZCAwKSB7IGlkZW50aWZpZXIgPSBERUZBVUxUX0VOVFJZX05BTUU7IH1cclxuICAgICAgICByZXR1cm4gdGhpcy5pbnN0YW5jZXMuaGFzKGlkZW50aWZpZXIpO1xyXG4gICAgfTtcclxuICAgIFByb3ZpZGVyLnByb3RvdHlwZS5nZXRPcHRpb25zID0gZnVuY3Rpb24gKGlkZW50aWZpZXIpIHtcclxuICAgICAgICBpZiAoaWRlbnRpZmllciA9PT0gdm9pZCAwKSB7IGlkZW50aWZpZXIgPSBERUZBVUxUX0VOVFJZX05BTUU7IH1cclxuICAgICAgICByZXR1cm4gdGhpcy5pbnN0YW5jZXNPcHRpb25zLmdldChpZGVudGlmaWVyKSB8fCB7fTtcclxuICAgIH07XHJcbiAgICBQcm92aWRlci5wcm90b3R5cGUuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uIChvcHRzKSB7XHJcbiAgICAgICAgdmFyIGVfMiwgX2E7XHJcbiAgICAgICAgaWYgKG9wdHMgPT09IHZvaWQgMCkgeyBvcHRzID0ge307IH1cclxuICAgICAgICB2YXIgX2IgPSBvcHRzLm9wdGlvbnMsIG9wdGlvbnMgPSBfYiA9PT0gdm9pZCAwID8ge30gOiBfYjtcclxuICAgICAgICB2YXIgbm9ybWFsaXplZElkZW50aWZpZXIgPSB0aGlzLm5vcm1hbGl6ZUluc3RhbmNlSWRlbnRpZmllcihvcHRzLmluc3RhbmNlSWRlbnRpZmllcik7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNJbml0aWFsaXplZChub3JtYWxpemVkSWRlbnRpZmllcikpIHtcclxuICAgICAgICAgICAgdGhyb3cgRXJyb3IodGhpcy5uYW1lICsgXCIoXCIgKyBub3JtYWxpemVkSWRlbnRpZmllciArIFwiKSBoYXMgYWxyZWFkeSBiZWVuIGluaXRpYWxpemVkXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXRoaXMuaXNDb21wb25lbnRTZXQoKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBFcnJvcihcIkNvbXBvbmVudCBcIiArIHRoaXMubmFtZSArIFwiIGhhcyBub3QgYmVlbiByZWdpc3RlcmVkIHlldFwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGluc3RhbmNlID0gdGhpcy5nZXRPckluaXRpYWxpemVTZXJ2aWNlKHtcclxuICAgICAgICAgICAgaW5zdGFuY2VJZGVudGlmaWVyOiBub3JtYWxpemVkSWRlbnRpZmllcixcclxuICAgICAgICAgICAgb3B0aW9uczogb3B0aW9uc1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIC8vIHJlc29sdmUgYW55IHBlbmRpbmcgcHJvbWlzZSB3YWl0aW5nIGZvciB0aGUgc2VydmljZSBpbnN0YW5jZVxyXG4gICAgICAgICAgICBmb3IgKHZhciBfYyA9IF9fdmFsdWVzKHRoaXMuaW5zdGFuY2VzRGVmZXJyZWQuZW50cmllcygpKSwgX2QgPSBfYy5uZXh0KCk7ICFfZC5kb25lOyBfZCA9IF9jLm5leHQoKSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIF9lID0gX19yZWFkKF9kLnZhbHVlLCAyKSwgaW5zdGFuY2VJZGVudGlmaWVyID0gX2VbMF0sIGluc3RhbmNlRGVmZXJyZWQgPSBfZVsxXTtcclxuICAgICAgICAgICAgICAgIHZhciBub3JtYWxpemVkRGVmZXJyZWRJZGVudGlmaWVyID0gdGhpcy5ub3JtYWxpemVJbnN0YW5jZUlkZW50aWZpZXIoaW5zdGFuY2VJZGVudGlmaWVyKTtcclxuICAgICAgICAgICAgICAgIGlmIChub3JtYWxpemVkSWRlbnRpZmllciA9PT0gbm9ybWFsaXplZERlZmVycmVkSWRlbnRpZmllcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGluc3RhbmNlRGVmZXJyZWQucmVzb2x2ZShpbnN0YW5jZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGVfMl8xKSB7IGVfMiA9IHsgZXJyb3I6IGVfMl8xIH07IH1cclxuICAgICAgICBmaW5hbGx5IHtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIGlmIChfZCAmJiAhX2QuZG9uZSAmJiAoX2EgPSBfYy5yZXR1cm4pKSBfYS5jYWxsKF9jKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMikgdGhyb3cgZV8yLmVycm9yOyB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBpbnN0YW5jZTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gY2FsbGJhY2sgLSBhIGZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBpbnZva2VkICBhZnRlciB0aGUgcHJvdmlkZXIgaGFzIGJlZW4gaW5pdGlhbGl6ZWQgYnkgY2FsbGluZyBwcm92aWRlci5pbml0aWFsaXplKCkuXHJcbiAgICAgKiBUaGUgZnVuY3Rpb24gaXMgaW52b2tlZCBTWU5DSFJPTk9VU0xZLCBzbyBpdCBzaG91bGQgbm90IGV4ZWN1dGUgYW55IGxvbmdydW5uaW5nIHRhc2tzIGluIG9yZGVyIHRvIG5vdCBibG9jayB0aGUgcHJvZ3JhbS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gaWRlbnRpZmllciBBbiBvcHRpb25hbCBpbnN0YW5jZSBpZGVudGlmaWVyXHJcbiAgICAgKiBAcmV0dXJucyBhIGZ1bmN0aW9uIHRvIHVucmVnaXN0ZXIgdGhlIGNhbGxiYWNrXHJcbiAgICAgKi9cclxuICAgIFByb3ZpZGVyLnByb3RvdHlwZS5vbkluaXQgPSBmdW5jdGlvbiAoY2FsbGJhY2ssIGlkZW50aWZpZXIpIHtcclxuICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgdmFyIG5vcm1hbGl6ZWRJZGVudGlmaWVyID0gdGhpcy5ub3JtYWxpemVJbnN0YW5jZUlkZW50aWZpZXIoaWRlbnRpZmllcik7XHJcbiAgICAgICAgdmFyIGV4aXN0aW5nQ2FsbGJhY2tzID0gKF9hID0gdGhpcy5vbkluaXRDYWxsYmFja3MuZ2V0KG5vcm1hbGl6ZWRJZGVudGlmaWVyKSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogbmV3IFNldCgpO1xyXG4gICAgICAgIGV4aXN0aW5nQ2FsbGJhY2tzLmFkZChjYWxsYmFjayk7XHJcbiAgICAgICAgdGhpcy5vbkluaXRDYWxsYmFja3Muc2V0KG5vcm1hbGl6ZWRJZGVudGlmaWVyLCBleGlzdGluZ0NhbGxiYWNrcyk7XHJcbiAgICAgICAgdmFyIGV4aXN0aW5nSW5zdGFuY2UgPSB0aGlzLmluc3RhbmNlcy5nZXQobm9ybWFsaXplZElkZW50aWZpZXIpO1xyXG4gICAgICAgIGlmIChleGlzdGluZ0luc3RhbmNlKSB7XHJcbiAgICAgICAgICAgIGNhbGxiYWNrKGV4aXN0aW5nSW5zdGFuY2UsIG5vcm1hbGl6ZWRJZGVudGlmaWVyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgZXhpc3RpbmdDYWxsYmFja3MuZGVsZXRlKGNhbGxiYWNrKTtcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogSW52b2tlIG9uSW5pdCBjYWxsYmFja3Mgc3luY2hyb25vdXNseVxyXG4gICAgICogQHBhcmFtIGluc3RhbmNlIHRoZSBzZXJ2aWNlIGluc3RhbmNlYFxyXG4gICAgICovXHJcbiAgICBQcm92aWRlci5wcm90b3R5cGUuaW52b2tlT25Jbml0Q2FsbGJhY2tzID0gZnVuY3Rpb24gKGluc3RhbmNlLCBpZGVudGlmaWVyKSB7XHJcbiAgICAgICAgdmFyIGVfMywgX2E7XHJcbiAgICAgICAgdmFyIGNhbGxiYWNrcyA9IHRoaXMub25Jbml0Q2FsbGJhY2tzLmdldChpZGVudGlmaWVyKTtcclxuICAgICAgICBpZiAoIWNhbGxiYWNrcykge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGNhbGxiYWNrc18xID0gX192YWx1ZXMoY2FsbGJhY2tzKSwgY2FsbGJhY2tzXzFfMSA9IGNhbGxiYWNrc18xLm5leHQoKTsgIWNhbGxiYWNrc18xXzEuZG9uZTsgY2FsbGJhY2tzXzFfMSA9IGNhbGxiYWNrc18xLm5leHQoKSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGNhbGxiYWNrID0gY2FsbGJhY2tzXzFfMS52YWx1ZTtcclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soaW5zdGFuY2UsIGlkZW50aWZpZXIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY2F0Y2ggKF9iKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gaWdub3JlIGVycm9ycyBpbiB0aGUgb25Jbml0IGNhbGxiYWNrXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGVfM18xKSB7IGVfMyA9IHsgZXJyb3I6IGVfM18xIH07IH1cclxuICAgICAgICBmaW5hbGx5IHtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIGlmIChjYWxsYmFja3NfMV8xICYmICFjYWxsYmFja3NfMV8xLmRvbmUgJiYgKF9hID0gY2FsbGJhY2tzXzEucmV0dXJuKSkgX2EuY2FsbChjYWxsYmFja3NfMSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZmluYWxseSB7IGlmIChlXzMpIHRocm93IGVfMy5lcnJvcjsgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBQcm92aWRlci5wcm90b3R5cGUuZ2V0T3JJbml0aWFsaXplU2VydmljZSA9IGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgIHZhciBpbnN0YW5jZUlkZW50aWZpZXIgPSBfYS5pbnN0YW5jZUlkZW50aWZpZXIsIF9iID0gX2Eub3B0aW9ucywgb3B0aW9ucyA9IF9iID09PSB2b2lkIDAgPyB7fSA6IF9iO1xyXG4gICAgICAgIHZhciBpbnN0YW5jZSA9IHRoaXMuaW5zdGFuY2VzLmdldChpbnN0YW5jZUlkZW50aWZpZXIpO1xyXG4gICAgICAgIGlmICghaW5zdGFuY2UgJiYgdGhpcy5jb21wb25lbnQpIHtcclxuICAgICAgICAgICAgaW5zdGFuY2UgPSB0aGlzLmNvbXBvbmVudC5pbnN0YW5jZUZhY3RvcnkodGhpcy5jb250YWluZXIsIHtcclxuICAgICAgICAgICAgICAgIGluc3RhbmNlSWRlbnRpZmllcjogbm9ybWFsaXplSWRlbnRpZmllckZvckZhY3RvcnkoaW5zdGFuY2VJZGVudGlmaWVyKSxcclxuICAgICAgICAgICAgICAgIG9wdGlvbnM6IG9wdGlvbnNcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRoaXMuaW5zdGFuY2VzLnNldChpbnN0YW5jZUlkZW50aWZpZXIsIGluc3RhbmNlKTtcclxuICAgICAgICAgICAgdGhpcy5pbnN0YW5jZXNPcHRpb25zLnNldChpbnN0YW5jZUlkZW50aWZpZXIsIG9wdGlvbnMpO1xyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICogSW52b2tlIG9uSW5pdCBsaXN0ZW5lcnMuXHJcbiAgICAgICAgICAgICAqIE5vdGUgdGhpcy5jb21wb25lbnQub25JbnN0YW5jZUNyZWF0ZWQgaXMgZGlmZmVyZW50LCB3aGljaCBpcyB1c2VkIGJ5IHRoZSBjb21wb25lbnQgY3JlYXRvcixcclxuICAgICAgICAgICAgICogd2hpbGUgb25Jbml0IGxpc3RlbmVycyBhcmUgcmVnaXN0ZXJlZCBieSBjb25zdW1lcnMgb2YgdGhlIHByb3ZpZGVyLlxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgdGhpcy5pbnZva2VPbkluaXRDYWxsYmFja3MoaW5zdGFuY2UsIGluc3RhbmNlSWRlbnRpZmllcik7XHJcbiAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgKiBPcmRlciBpcyBpbXBvcnRhbnRcclxuICAgICAgICAgICAgICogb25JbnN0YW5jZUNyZWF0ZWQoKSBzaG91bGQgYmUgY2FsbGVkIGFmdGVyIHRoaXMuaW5zdGFuY2VzLnNldChpbnN0YW5jZUlkZW50aWZpZXIsIGluc3RhbmNlKTsgd2hpY2hcclxuICAgICAgICAgICAgICogbWFrZXMgYGlzSW5pdGlhbGl6ZWQoKWAgcmV0dXJuIHRydWUuXHJcbiAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICBpZiAodGhpcy5jb21wb25lbnQub25JbnN0YW5jZUNyZWF0ZWQpIHtcclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb21wb25lbnQub25JbnN0YW5jZUNyZWF0ZWQodGhpcy5jb250YWluZXIsIGluc3RhbmNlSWRlbnRpZmllciwgaW5zdGFuY2UpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY2F0Y2ggKF9jKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gaWdub3JlIGVycm9ycyBpbiB0aGUgb25JbnN0YW5jZUNyZWF0ZWRDYWxsYmFja1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBpbnN0YW5jZSB8fCBudWxsO1xyXG4gICAgfTtcclxuICAgIFByb3ZpZGVyLnByb3RvdHlwZS5ub3JtYWxpemVJbnN0YW5jZUlkZW50aWZpZXIgPSBmdW5jdGlvbiAoaWRlbnRpZmllcikge1xyXG4gICAgICAgIGlmIChpZGVudGlmaWVyID09PSB2b2lkIDApIHsgaWRlbnRpZmllciA9IERFRkFVTFRfRU5UUllfTkFNRTsgfVxyXG4gICAgICAgIGlmICh0aGlzLmNvbXBvbmVudCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb21wb25lbnQubXVsdGlwbGVJbnN0YW5jZXMgPyBpZGVudGlmaWVyIDogREVGQVVMVF9FTlRSWV9OQU1FO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGlkZW50aWZpZXI7IC8vIGFzc3VtZSBtdWx0aXBsZSBpbnN0YW5jZXMgYXJlIHN1cHBvcnRlZCBiZWZvcmUgdGhlIGNvbXBvbmVudCBpcyBwcm92aWRlZC5cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgUHJvdmlkZXIucHJvdG90eXBlLnNob3VsZEF1dG9Jbml0aWFsaXplID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiAoISF0aGlzLmNvbXBvbmVudCAmJlxyXG4gICAgICAgICAgICB0aGlzLmNvbXBvbmVudC5pbnN0YW50aWF0aW9uTW9kZSAhPT0gXCJFWFBMSUNJVFwiIC8qIEVYUExJQ0lUICovKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gUHJvdmlkZXI7XHJcbn0oKSk7XHJcbi8vIHVuZGVmaW5lZCBzaG91bGQgYmUgcGFzc2VkIHRvIHRoZSBzZXJ2aWNlIGZhY3RvcnkgZm9yIHRoZSBkZWZhdWx0IGluc3RhbmNlXHJcbmZ1bmN0aW9uIG5vcm1hbGl6ZUlkZW50aWZpZXJGb3JGYWN0b3J5KGlkZW50aWZpZXIpIHtcclxuICAgIHJldHVybiBpZGVudGlmaWVyID09PSBERUZBVUxUX0VOVFJZX05BTUUgPyB1bmRlZmluZWQgOiBpZGVudGlmaWVyO1xyXG59XHJcbmZ1bmN0aW9uIGlzQ29tcG9uZW50RWFnZXIoY29tcG9uZW50KSB7XHJcbiAgICByZXR1cm4gY29tcG9uZW50Lmluc3RhbnRpYXRpb25Nb2RlID09PSBcIkVBR0VSXCIgLyogRUFHRVIgKi87XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIENvbXBvbmVudENvbnRhaW5lciB0aGF0IHByb3ZpZGVzIFByb3ZpZGVycyBmb3Igc2VydmljZSBuYW1lIFQsIGUuZy4gYGF1dGhgLCBgYXV0aC1pbnRlcm5hbGBcclxuICovXHJcbnZhciBDb21wb25lbnRDb250YWluZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBDb21wb25lbnRDb250YWluZXIobmFtZSkge1xyXG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XHJcbiAgICAgICAgdGhpcy5wcm92aWRlcnMgPSBuZXcgTWFwKCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gY29tcG9uZW50IENvbXBvbmVudCBiZWluZyBhZGRlZFxyXG4gICAgICogQHBhcmFtIG92ZXJ3cml0ZSBXaGVuIGEgY29tcG9uZW50IHdpdGggdGhlIHNhbWUgbmFtZSBoYXMgYWxyZWFkeSBiZWVuIHJlZ2lzdGVyZWQsXHJcbiAgICAgKiBpZiBvdmVyd3JpdGUgaXMgdHJ1ZTogb3ZlcndyaXRlIHRoZSBleGlzdGluZyBjb21wb25lbnQgd2l0aCB0aGUgbmV3IGNvbXBvbmVudCBhbmQgY3JlYXRlIGEgbmV3XHJcbiAgICAgKiBwcm92aWRlciB3aXRoIHRoZSBuZXcgY29tcG9uZW50LiBJdCBjYW4gYmUgdXNlZnVsIGluIHRlc3RzIHdoZXJlIHlvdSB3YW50IHRvIHVzZSBkaWZmZXJlbnQgbW9ja3NcclxuICAgICAqIGZvciBkaWZmZXJlbnQgdGVzdHMuXHJcbiAgICAgKiBpZiBvdmVyd3JpdGUgaXMgZmFsc2U6IHRocm93IGFuIGV4Y2VwdGlvblxyXG4gICAgICovXHJcbiAgICBDb21wb25lbnRDb250YWluZXIucHJvdG90eXBlLmFkZENvbXBvbmVudCA9IGZ1bmN0aW9uIChjb21wb25lbnQpIHtcclxuICAgICAgICB2YXIgcHJvdmlkZXIgPSB0aGlzLmdldFByb3ZpZGVyKGNvbXBvbmVudC5uYW1lKTtcclxuICAgICAgICBpZiAocHJvdmlkZXIuaXNDb21wb25lbnRTZXQoKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDb21wb25lbnQgXCIgKyBjb21wb25lbnQubmFtZSArIFwiIGhhcyBhbHJlYWR5IGJlZW4gcmVnaXN0ZXJlZCB3aXRoIFwiICsgdGhpcy5uYW1lKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcHJvdmlkZXIuc2V0Q29tcG9uZW50KGNvbXBvbmVudCk7XHJcbiAgICB9O1xyXG4gICAgQ29tcG9uZW50Q29udGFpbmVyLnByb3RvdHlwZS5hZGRPck92ZXJ3cml0ZUNvbXBvbmVudCA9IGZ1bmN0aW9uIChjb21wb25lbnQpIHtcclxuICAgICAgICB2YXIgcHJvdmlkZXIgPSB0aGlzLmdldFByb3ZpZGVyKGNvbXBvbmVudC5uYW1lKTtcclxuICAgICAgICBpZiAocHJvdmlkZXIuaXNDb21wb25lbnRTZXQoKSkge1xyXG4gICAgICAgICAgICAvLyBkZWxldGUgdGhlIGV4aXN0aW5nIHByb3ZpZGVyIGZyb20gdGhlIGNvbnRhaW5lciwgc28gd2UgY2FuIHJlZ2lzdGVyIHRoZSBuZXcgY29tcG9uZW50XHJcbiAgICAgICAgICAgIHRoaXMucHJvdmlkZXJzLmRlbGV0ZShjb21wb25lbnQubmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuYWRkQ29tcG9uZW50KGNvbXBvbmVudCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBnZXRQcm92aWRlciBwcm92aWRlcyBhIHR5cGUgc2FmZSBpbnRlcmZhY2Ugd2hlcmUgaXQgY2FuIG9ubHkgYmUgY2FsbGVkIHdpdGggYSBmaWVsZCBuYW1lXHJcbiAgICAgKiBwcmVzZW50IGluIE5hbWVTZXJ2aWNlTWFwcGluZyBpbnRlcmZhY2UuXHJcbiAgICAgKlxyXG4gICAgICogRmlyZWJhc2UgU0RLcyBwcm92aWRpbmcgc2VydmljZXMgc2hvdWxkIGV4dGVuZCBOYW1lU2VydmljZU1hcHBpbmcgaW50ZXJmYWNlIHRvIHJlZ2lzdGVyXHJcbiAgICAgKiB0aGVtc2VsdmVzLlxyXG4gICAgICovXHJcbiAgICBDb21wb25lbnRDb250YWluZXIucHJvdG90eXBlLmdldFByb3ZpZGVyID0gZnVuY3Rpb24gKG5hbWUpIHtcclxuICAgICAgICBpZiAodGhpcy5wcm92aWRlcnMuaGFzKG5hbWUpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3ZpZGVycy5nZXQobmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGNyZWF0ZSBhIFByb3ZpZGVyIGZvciBhIHNlcnZpY2UgdGhhdCBoYXNuJ3QgcmVnaXN0ZXJlZCB3aXRoIEZpcmViYXNlXHJcbiAgICAgICAgdmFyIHByb3ZpZGVyID0gbmV3IFByb3ZpZGVyKG5hbWUsIHRoaXMpO1xyXG4gICAgICAgIHRoaXMucHJvdmlkZXJzLnNldChuYW1lLCBwcm92aWRlcik7XHJcbiAgICAgICAgcmV0dXJuIHByb3ZpZGVyO1xyXG4gICAgfTtcclxuICAgIENvbXBvbmVudENvbnRhaW5lci5wcm90b3R5cGUuZ2V0UHJvdmlkZXJzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMucHJvdmlkZXJzLnZhbHVlcygpKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gQ29tcG9uZW50Q29udGFpbmVyO1xyXG59KCkpO1xuXG5leHBvcnQgeyBDb21wb25lbnQsIENvbXBvbmVudENvbnRhaW5lciwgUHJvdmlkZXIgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmVzbS5qcy5tYXBcbiIsImltcG9ydCB7IEVycm9yRmFjdG9yeSwgZGVlcEVxdWFsLCBpc0Jyb3dzZXJFeHRlbnNpb24sIGlzTW9iaWxlQ29yZG92YSwgaXNSZWFjdE5hdGl2ZSwgRmlyZWJhc2VFcnJvciwgcXVlcnlzdHJpbmcsIGdldE1vZHVsYXJJbnN0YW5jZSwgYmFzZTY0RGVjb2RlLCBnZXRVQSwgaXNJRSwgY3JlYXRlU3Vic2NyaWJlLCBxdWVyeXN0cmluZ0RlY29kZSwgZXh0cmFjdFF1ZXJ5c3RyaW5nLCBpc0VtcHR5IH0gZnJvbSAnQGZpcmViYXNlL3V0aWwnO1xuaW1wb3J0IHsgU0RLX1ZFUlNJT04sIF9nZXRQcm92aWRlciwgX3JlZ2lzdGVyQ29tcG9uZW50LCByZWdpc3RlclZlcnNpb24sIGdldEFwcCB9IGZyb20gJ0BmaXJlYmFzZS9hcHAnO1xuaW1wb3J0IHsgX19yZXN0IH0gZnJvbSAndHNsaWInO1xuaW1wb3J0IHsgTG9nZ2VyLCBMb2dMZXZlbCB9IGZyb20gJ0BmaXJlYmFzZS9sb2dnZXInO1xuaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSAnQGZpcmViYXNlL2NvbXBvbmVudCc7XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBBbiBlbnVtIG9mIGZhY3RvcnMgdGhhdCBtYXkgYmUgdXNlZCBmb3IgbXVsdGlmYWN0b3IgYXV0aGVudGljYXRpb24uXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmNvbnN0IEZhY3RvcklkID0ge1xyXG4gICAgLyoqIFBob25lIGFzIHNlY29uZCBmYWN0b3IgKi9cclxuICAgIFBIT05FOiAncGhvbmUnXHJcbn07XHJcbi8qKlxyXG4gKiBFbnVtZXJhdGlvbiBvZiBzdXBwb3J0ZWQgcHJvdmlkZXJzLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5jb25zdCBQcm92aWRlcklkID0ge1xyXG4gICAgLyoqIEZhY2Vib29rIHByb3ZpZGVyIElEICovXHJcbiAgICBGQUNFQk9PSzogJ2ZhY2Vib29rLmNvbScsXHJcbiAgICAvKiogR2l0SHViIHByb3ZpZGVyIElEICovXHJcbiAgICBHSVRIVUI6ICdnaXRodWIuY29tJyxcclxuICAgIC8qKiBHb29nbGUgcHJvdmlkZXIgSUQgKi9cclxuICAgIEdPT0dMRTogJ2dvb2dsZS5jb20nLFxyXG4gICAgLyoqIFBhc3N3b3JkIHByb3ZpZGVyICovXHJcbiAgICBQQVNTV09SRDogJ3Bhc3N3b3JkJyxcclxuICAgIC8qKiBQaG9uZSBwcm92aWRlciAqL1xyXG4gICAgUEhPTkU6ICdwaG9uZScsXHJcbiAgICAvKiogVHdpdHRlciBwcm92aWRlciBJRCAqL1xyXG4gICAgVFdJVFRFUjogJ3R3aXR0ZXIuY29tJ1xyXG59O1xyXG4vKipcclxuICogRW51bWVyYXRpb24gb2Ygc3VwcG9ydGVkIHNpZ24taW4gbWV0aG9kcy5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuY29uc3QgU2lnbkluTWV0aG9kID0ge1xyXG4gICAgLyoqIEVtYWlsIGxpbmsgc2lnbiBpbiBtZXRob2QgKi9cclxuICAgIEVNQUlMX0xJTks6ICdlbWFpbExpbmsnLFxyXG4gICAgLyoqIEVtYWlsL3Bhc3N3b3JkIHNpZ24gaW4gbWV0aG9kICovXHJcbiAgICBFTUFJTF9QQVNTV09SRDogJ3Bhc3N3b3JkJyxcclxuICAgIC8qKiBGYWNlYm9vayBzaWduIGluIG1ldGhvZCAqL1xyXG4gICAgRkFDRUJPT0s6ICdmYWNlYm9vay5jb20nLFxyXG4gICAgLyoqIEdpdEh1YiBzaWduIGluIG1ldGhvZCAqL1xyXG4gICAgR0lUSFVCOiAnZ2l0aHViLmNvbScsXHJcbiAgICAvKiogR29vZ2xlIHNpZ24gaW4gbWV0aG9kICovXHJcbiAgICBHT09HTEU6ICdnb29nbGUuY29tJyxcclxuICAgIC8qKiBQaG9uZSBzaWduIGluIG1ldGhvZCAqL1xyXG4gICAgUEhPTkU6ICdwaG9uZScsXHJcbiAgICAvKiogVHdpdHRlciBzaWduIGluIG1ldGhvZCAqL1xyXG4gICAgVFdJVFRFUjogJ3R3aXR0ZXIuY29tJ1xyXG59O1xyXG4vKipcclxuICogRW51bWVyYXRpb24gb2Ygc3VwcG9ydGVkIG9wZXJhdGlvbiB0eXBlcy5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuY29uc3QgT3BlcmF0aW9uVHlwZSA9IHtcclxuICAgIC8qKiBPcGVyYXRpb24gaW52b2x2aW5nIGxpbmtpbmcgYW4gYWRkaXRpb25hbCBwcm92aWRlciB0byBhbiBhbHJlYWR5IHNpZ25lZC1pbiB1c2VyLiAqL1xyXG4gICAgTElOSzogJ2xpbmsnLFxyXG4gICAgLyoqIE9wZXJhdGlvbiBpbnZvbHZpbmcgdXNpbmcgYSBwcm92aWRlciB0byByZWF1dGhlbnRpY2F0ZSBhbiBhbHJlYWR5IHNpZ25lZC1pbiB1c2VyLiAqL1xyXG4gICAgUkVBVVRIRU5USUNBVEU6ICdyZWF1dGhlbnRpY2F0ZScsXHJcbiAgICAvKiogT3BlcmF0aW9uIGludm9sdmluZyBzaWduaW5nIGluIGEgdXNlci4gKi9cclxuICAgIFNJR05fSU46ICdzaWduSW4nXHJcbn07XHJcbi8qKlxyXG4gKiBBbiBlbnVtZXJhdGlvbiBvZiB0aGUgcG9zc2libGUgZW1haWwgYWN0aW9uIHR5cGVzLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5jb25zdCBBY3Rpb25Db2RlT3BlcmF0aW9uID0ge1xyXG4gICAgLyoqIFRoZSBlbWFpbCBsaW5rIHNpZ24taW4gYWN0aW9uLiAqL1xyXG4gICAgRU1BSUxfU0lHTklOOiAnRU1BSUxfU0lHTklOJyxcclxuICAgIC8qKiBUaGUgcGFzc3dvcmQgcmVzZXQgYWN0aW9uLiAqL1xyXG4gICAgUEFTU1dPUkRfUkVTRVQ6ICdQQVNTV09SRF9SRVNFVCcsXHJcbiAgICAvKiogVGhlIGVtYWlsIHJldm9jYXRpb24gYWN0aW9uLiAqL1xyXG4gICAgUkVDT1ZFUl9FTUFJTDogJ1JFQ09WRVJfRU1BSUwnLFxyXG4gICAgLyoqIFRoZSByZXZlcnQgc2Vjb25kIGZhY3RvciBhZGRpdGlvbiBlbWFpbCBhY3Rpb24uICovXHJcbiAgICBSRVZFUlRfU0VDT05EX0ZBQ1RPUl9BRERJVElPTjogJ1JFVkVSVF9TRUNPTkRfRkFDVE9SX0FERElUSU9OJyxcclxuICAgIC8qKiBUaGUgcmV2ZXJ0IHNlY29uZCBmYWN0b3IgYWRkaXRpb24gZW1haWwgYWN0aW9uLiAqL1xyXG4gICAgVkVSSUZZX0FORF9DSEFOR0VfRU1BSUw6ICdWRVJJRllfQU5EX0NIQU5HRV9FTUFJTCcsXHJcbiAgICAvKiogVGhlIGVtYWlsIHZlcmlmaWNhdGlvbiBhY3Rpb24uICovXHJcbiAgICBWRVJJRllfRU1BSUw6ICdWRVJJRllfRU1BSUwnXHJcbn07XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmZ1bmN0aW9uIF9kZWJ1Z0Vycm9yTWFwKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBbXCJhZG1pbi1yZXN0cmljdGVkLW9wZXJhdGlvblwiIC8qIEFETUlOX09OTFlfT1BFUkFUSU9OICovXTogJ1RoaXMgb3BlcmF0aW9uIGlzIHJlc3RyaWN0ZWQgdG8gYWRtaW5pc3RyYXRvcnMgb25seS4nLFxyXG4gICAgICAgIFtcImFyZ3VtZW50LWVycm9yXCIgLyogQVJHVU1FTlRfRVJST1IgKi9dOiAnJyxcclxuICAgICAgICBbXCJhcHAtbm90LWF1dGhvcml6ZWRcIiAvKiBBUFBfTk9UX0FVVEhPUklaRUQgKi9dOiBcIlRoaXMgYXBwLCBpZGVudGlmaWVkIGJ5IHRoZSBkb21haW4gd2hlcmUgaXQncyBob3N0ZWQsIGlzIG5vdCBcIiArXHJcbiAgICAgICAgICAgICdhdXRob3JpemVkIHRvIHVzZSBGaXJlYmFzZSBBdXRoZW50aWNhdGlvbiB3aXRoIHRoZSBwcm92aWRlZCBBUEkga2V5LiAnICtcclxuICAgICAgICAgICAgJ1JldmlldyB5b3VyIGtleSBjb25maWd1cmF0aW9uIGluIHRoZSBHb29nbGUgQVBJIGNvbnNvbGUuJyxcclxuICAgICAgICBbXCJhcHAtbm90LWluc3RhbGxlZFwiIC8qIEFQUF9OT1RfSU5TVEFMTEVEICovXTogJ1RoZSByZXF1ZXN0ZWQgbW9iaWxlIGFwcGxpY2F0aW9uIGNvcnJlc3BvbmRpbmcgdG8gdGhlIGlkZW50aWZpZXIgKCcgK1xyXG4gICAgICAgICAgICAnQW5kcm9pZCBwYWNrYWdlIG5hbWUgb3IgaU9TIGJ1bmRsZSBJRCkgcHJvdmlkZWQgaXMgbm90IGluc3RhbGxlZCBvbiAnICtcclxuICAgICAgICAgICAgJ3RoaXMgZGV2aWNlLicsXHJcbiAgICAgICAgW1wiY2FwdGNoYS1jaGVjay1mYWlsZWRcIiAvKiBDQVBUQ0hBX0NIRUNLX0ZBSUxFRCAqL106ICdUaGUgcmVDQVBUQ0hBIHJlc3BvbnNlIHRva2VuIHByb3ZpZGVkIGlzIGVpdGhlciBpbnZhbGlkLCBleHBpcmVkLCAnICtcclxuICAgICAgICAgICAgJ2FscmVhZHkgdXNlZCBvciB0aGUgZG9tYWluIGFzc29jaWF0ZWQgd2l0aCBpdCBkb2VzIG5vdCBtYXRjaCB0aGUgbGlzdCAnICtcclxuICAgICAgICAgICAgJ29mIHdoaXRlbGlzdGVkIGRvbWFpbnMuJyxcclxuICAgICAgICBbXCJjb2RlLWV4cGlyZWRcIiAvKiBDT0RFX0VYUElSRUQgKi9dOiAnVGhlIFNNUyBjb2RlIGhhcyBleHBpcmVkLiBQbGVhc2UgcmUtc2VuZCB0aGUgdmVyaWZpY2F0aW9uIGNvZGUgdG8gdHJ5ICcgK1xyXG4gICAgICAgICAgICAnYWdhaW4uJyxcclxuICAgICAgICBbXCJjb3Jkb3ZhLW5vdC1yZWFkeVwiIC8qIENPUkRPVkFfTk9UX1JFQURZICovXTogJ0NvcmRvdmEgZnJhbWV3b3JrIGlzIG5vdCByZWFkeS4nLFxyXG4gICAgICAgIFtcImNvcnMtdW5zdXBwb3J0ZWRcIiAvKiBDT1JTX1VOU1VQUE9SVEVEICovXTogJ1RoaXMgYnJvd3NlciBpcyBub3Qgc3VwcG9ydGVkLicsXHJcbiAgICAgICAgW1wiY3JlZGVudGlhbC1hbHJlYWR5LWluLXVzZVwiIC8qIENSRURFTlRJQUxfQUxSRUFEWV9JTl9VU0UgKi9dOiAnVGhpcyBjcmVkZW50aWFsIGlzIGFscmVhZHkgYXNzb2NpYXRlZCB3aXRoIGEgZGlmZmVyZW50IHVzZXIgYWNjb3VudC4nLFxyXG4gICAgICAgIFtcImN1c3RvbS10b2tlbi1taXNtYXRjaFwiIC8qIENSRURFTlRJQUxfTUlTTUFUQ0ggKi9dOiAnVGhlIGN1c3RvbSB0b2tlbiBjb3JyZXNwb25kcyB0byBhIGRpZmZlcmVudCBhdWRpZW5jZS4nLFxyXG4gICAgICAgIFtcInJlcXVpcmVzLXJlY2VudC1sb2dpblwiIC8qIENSRURFTlRJQUxfVE9PX09MRF9MT0dJTl9BR0FJTiAqL106ICdUaGlzIG9wZXJhdGlvbiBpcyBzZW5zaXRpdmUgYW5kIHJlcXVpcmVzIHJlY2VudCBhdXRoZW50aWNhdGlvbi4gTG9nIGluICcgK1xyXG4gICAgICAgICAgICAnYWdhaW4gYmVmb3JlIHJldHJ5aW5nIHRoaXMgcmVxdWVzdC4nLFxyXG4gICAgICAgIFtcImRlcGVuZGVudC1zZGstaW5pdGlhbGl6ZWQtYmVmb3JlLWF1dGhcIiAvKiBERVBFTkRFTlRfU0RLX0lOSVRfQkVGT1JFX0FVVEggKi9dOiAnQW5vdGhlciBGaXJlYmFzZSBTREsgd2FzIGluaXRpYWxpemVkIGFuZCBpcyB0cnlpbmcgdG8gdXNlIEF1dGggYmVmb3JlIEF1dGggaXMgJyArXHJcbiAgICAgICAgICAgICdpbml0aWFsaXplZC4gUGxlYXNlIGJlIHN1cmUgdG8gY2FsbCBgaW5pdGlhbGl6ZUF1dGhgIG9yIGBnZXRBdXRoYCBiZWZvcmUgJyArXHJcbiAgICAgICAgICAgICdzdGFydGluZyBhbnkgb3RoZXIgRmlyZWJhc2UgU0RLLicsXHJcbiAgICAgICAgW1wiZHluYW1pYy1saW5rLW5vdC1hY3RpdmF0ZWRcIiAvKiBEWU5BTUlDX0xJTktfTk9UX0FDVElWQVRFRCAqL106ICdQbGVhc2UgYWN0aXZhdGUgRHluYW1pYyBMaW5rcyBpbiB0aGUgRmlyZWJhc2UgQ29uc29sZSBhbmQgYWdyZWUgdG8gdGhlIHRlcm1zIGFuZCAnICtcclxuICAgICAgICAgICAgJ2NvbmRpdGlvbnMuJyxcclxuICAgICAgICBbXCJlbWFpbC1jaGFuZ2UtbmVlZHMtdmVyaWZpY2F0aW9uXCIgLyogRU1BSUxfQ0hBTkdFX05FRURTX1ZFUklGSUNBVElPTiAqL106ICdNdWx0aS1mYWN0b3IgdXNlcnMgbXVzdCBhbHdheXMgaGF2ZSBhIHZlcmlmaWVkIGVtYWlsLicsXHJcbiAgICAgICAgW1wiZW1haWwtYWxyZWFkeS1pbi11c2VcIiAvKiBFTUFJTF9FWElTVFMgKi9dOiAnVGhlIGVtYWlsIGFkZHJlc3MgaXMgYWxyZWFkeSBpbiB1c2UgYnkgYW5vdGhlciBhY2NvdW50LicsXHJcbiAgICAgICAgW1wiZW11bGF0b3ItY29uZmlnLWZhaWxlZFwiIC8qIEVNVUxBVE9SX0NPTkZJR19GQUlMRUQgKi9dOiAnQXV0aCBpbnN0YW5jZSBoYXMgYWxyZWFkeSBiZWVuIHVzZWQgdG8gbWFrZSBhIG5ldHdvcmsgY2FsbC4gQXV0aCBjYW4gJyArXHJcbiAgICAgICAgICAgICdubyBsb25nZXIgYmUgY29uZmlndXJlZCB0byB1c2UgdGhlIGVtdWxhdG9yLiBUcnkgY2FsbGluZyAnICtcclxuICAgICAgICAgICAgJ1wiY29ubmVjdEF1dGhFbXVsYXRvcigpXCIgc29vbmVyLicsXHJcbiAgICAgICAgW1wiZXhwaXJlZC1hY3Rpb24tY29kZVwiIC8qIEVYUElSRURfT09CX0NPREUgKi9dOiAnVGhlIGFjdGlvbiBjb2RlIGhhcyBleHBpcmVkLicsXHJcbiAgICAgICAgW1wiY2FuY2VsbGVkLXBvcHVwLXJlcXVlc3RcIiAvKiBFWFBJUkVEX1BPUFVQX1JFUVVFU1QgKi9dOiAnVGhpcyBvcGVyYXRpb24gaGFzIGJlZW4gY2FuY2VsbGVkIGR1ZSB0byBhbm90aGVyIGNvbmZsaWN0aW5nIHBvcHVwIGJlaW5nIG9wZW5lZC4nLFxyXG4gICAgICAgIFtcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi9dOiAnQW4gaW50ZXJuYWwgQXV0aEVycm9yIGhhcyBvY2N1cnJlZC4nLFxyXG4gICAgICAgIFtcImludmFsaWQtYXBwLWNyZWRlbnRpYWxcIiAvKiBJTlZBTElEX0FQUF9DUkVERU5USUFMICovXTogJ1RoZSBwaG9uZSB2ZXJpZmljYXRpb24gcmVxdWVzdCBjb250YWlucyBhbiBpbnZhbGlkIGFwcGxpY2F0aW9uIHZlcmlmaWVyLicgK1xyXG4gICAgICAgICAgICAnIFRoZSByZUNBUFRDSEEgdG9rZW4gcmVzcG9uc2UgaXMgZWl0aGVyIGludmFsaWQgb3IgZXhwaXJlZC4nLFxyXG4gICAgICAgIFtcImludmFsaWQtYXBwLWlkXCIgLyogSU5WQUxJRF9BUFBfSUQgKi9dOiAnVGhlIG1vYmlsZSBhcHAgaWRlbnRpZmllciBpcyBub3QgcmVnaXN0ZWQgZm9yIHRoZSBjdXJyZW50IHByb2plY3QuJyxcclxuICAgICAgICBbXCJpbnZhbGlkLXVzZXItdG9rZW5cIiAvKiBJTlZBTElEX0FVVEggKi9dOiBcIlRoaXMgdXNlcidzIGNyZWRlbnRpYWwgaXNuJ3QgdmFsaWQgZm9yIHRoaXMgcHJvamVjdC4gVGhpcyBjYW4gaGFwcGVuIFwiICtcclxuICAgICAgICAgICAgXCJpZiB0aGUgdXNlcidzIHRva2VuIGhhcyBiZWVuIHRhbXBlcmVkIHdpdGgsIG9yIGlmIHRoZSB1c2VyIGlzbid0IGZvciBcIiArXHJcbiAgICAgICAgICAgICd0aGUgcHJvamVjdCBhc3NvY2lhdGVkIHdpdGggdGhpcyBBUEkga2V5LicsXHJcbiAgICAgICAgW1wiaW52YWxpZC1hdXRoLWV2ZW50XCIgLyogSU5WQUxJRF9BVVRIX0VWRU5UICovXTogJ0FuIGludGVybmFsIEF1dGhFcnJvciBoYXMgb2NjdXJyZWQuJyxcclxuICAgICAgICBbXCJpbnZhbGlkLXZlcmlmaWNhdGlvbi1jb2RlXCIgLyogSU5WQUxJRF9DT0RFICovXTogJ1RoZSBTTVMgdmVyaWZpY2F0aW9uIGNvZGUgdXNlZCB0byBjcmVhdGUgdGhlIHBob25lIGF1dGggY3JlZGVudGlhbCBpcyAnICtcclxuICAgICAgICAgICAgJ2ludmFsaWQuIFBsZWFzZSByZXNlbmQgdGhlIHZlcmlmaWNhdGlvbiBjb2RlIHNtcyBhbmQgYmUgc3VyZSB0byB1c2UgdGhlICcgK1xyXG4gICAgICAgICAgICAndmVyaWZpY2F0aW9uIGNvZGUgcHJvdmlkZWQgYnkgdGhlIHVzZXIuJyxcclxuICAgICAgICBbXCJpbnZhbGlkLWNvbnRpbnVlLXVyaVwiIC8qIElOVkFMSURfQ09OVElOVUVfVVJJICovXTogJ1RoZSBjb250aW51ZSBVUkwgcHJvdmlkZWQgaW4gdGhlIHJlcXVlc3QgaXMgaW52YWxpZC4nLFxyXG4gICAgICAgIFtcImludmFsaWQtY29yZG92YS1jb25maWd1cmF0aW9uXCIgLyogSU5WQUxJRF9DT1JET1ZBX0NPTkZJR1VSQVRJT04gKi9dOiAnVGhlIGZvbGxvd2luZyBDb3Jkb3ZhIHBsdWdpbnMgbXVzdCBiZSBpbnN0YWxsZWQgdG8gZW5hYmxlIE9BdXRoIHNpZ24taW46ICcgK1xyXG4gICAgICAgICAgICAnY29yZG92YS1wbHVnaW4tYnVpbGRpbmZvLCBjb3Jkb3ZhLXVuaXZlcnNhbC1saW5rcy1wbHVnaW4sICcgK1xyXG4gICAgICAgICAgICAnY29yZG92YS1wbHVnaW4tYnJvd3NlcnRhYiwgY29yZG92YS1wbHVnaW4taW5hcHBicm93c2VyIGFuZCAnICtcclxuICAgICAgICAgICAgJ2NvcmRvdmEtcGx1Z2luLWN1c3RvbXVybHNjaGVtZS4nLFxyXG4gICAgICAgIFtcImludmFsaWQtY3VzdG9tLXRva2VuXCIgLyogSU5WQUxJRF9DVVNUT01fVE9LRU4gKi9dOiAnVGhlIGN1c3RvbSB0b2tlbiBmb3JtYXQgaXMgaW5jb3JyZWN0LiBQbGVhc2UgY2hlY2sgdGhlIGRvY3VtZW50YXRpb24uJyxcclxuICAgICAgICBbXCJpbnZhbGlkLWR5bmFtaWMtbGluay1kb21haW5cIiAvKiBJTlZBTElEX0RZTkFNSUNfTElOS19ET01BSU4gKi9dOiAnVGhlIHByb3ZpZGVkIGR5bmFtaWMgbGluayBkb21haW4gaXMgbm90IGNvbmZpZ3VyZWQgb3IgYXV0aG9yaXplZCBmb3IgdGhlIGN1cnJlbnQgcHJvamVjdC4nLFxyXG4gICAgICAgIFtcImludmFsaWQtZW1haWxcIiAvKiBJTlZBTElEX0VNQUlMICovXTogJ1RoZSBlbWFpbCBhZGRyZXNzIGlzIGJhZGx5IGZvcm1hdHRlZC4nLFxyXG4gICAgICAgIFtcImludmFsaWQtZW11bGF0b3Itc2NoZW1lXCIgLyogSU5WQUxJRF9FTVVMQVRPUl9TQ0hFTUUgKi9dOiAnRW11bGF0b3IgVVJMIG11c3Qgc3RhcnQgd2l0aCBhIHZhbGlkIHNjaGVtZSAoaHR0cDovLyBvciBodHRwczovLykuJyxcclxuICAgICAgICBbXCJpbnZhbGlkLWFwaS1rZXlcIiAvKiBJTlZBTElEX0FQSV9LRVkgKi9dOiAnWW91ciBBUEkga2V5IGlzIGludmFsaWQsIHBsZWFzZSBjaGVjayB5b3UgaGF2ZSBjb3BpZWQgaXQgY29ycmVjdGx5LicsXHJcbiAgICAgICAgW1wiaW52YWxpZC1jZXJ0LWhhc2hcIiAvKiBJTlZBTElEX0NFUlRfSEFTSCAqL106ICdUaGUgU0hBLTEgY2VydGlmaWNhdGUgaGFzaCBwcm92aWRlZCBpcyBpbnZhbGlkLicsXHJcbiAgICAgICAgW1wiaW52YWxpZC1jcmVkZW50aWFsXCIgLyogSU5WQUxJRF9JRFBfUkVTUE9OU0UgKi9dOiAnVGhlIHN1cHBsaWVkIGF1dGggY3JlZGVudGlhbCBpcyBtYWxmb3JtZWQgb3IgaGFzIGV4cGlyZWQuJyxcclxuICAgICAgICBbXCJpbnZhbGlkLW1lc3NhZ2UtcGF5bG9hZFwiIC8qIElOVkFMSURfTUVTU0FHRV9QQVlMT0FEICovXTogJ1RoZSBlbWFpbCB0ZW1wbGF0ZSBjb3JyZXNwb25kaW5nIHRvIHRoaXMgYWN0aW9uIGNvbnRhaW5zIGludmFsaWQgY2hhcmFjdGVycyBpbiBpdHMgbWVzc2FnZS4gJyArXHJcbiAgICAgICAgICAgICdQbGVhc2UgZml4IGJ5IGdvaW5nIHRvIHRoZSBBdXRoIGVtYWlsIHRlbXBsYXRlcyBzZWN0aW9uIGluIHRoZSBGaXJlYmFzZSBDb25zb2xlLicsXHJcbiAgICAgICAgW1wiaW52YWxpZC1tdWx0aS1mYWN0b3Itc2Vzc2lvblwiIC8qIElOVkFMSURfTUZBX1NFU1NJT04gKi9dOiAnVGhlIHJlcXVlc3QgZG9lcyBub3QgY29udGFpbiBhIHZhbGlkIHByb29mIG9mIGZpcnN0IGZhY3RvciBzdWNjZXNzZnVsIHNpZ24taW4uJyxcclxuICAgICAgICBbXCJpbnZhbGlkLW9hdXRoLXByb3ZpZGVyXCIgLyogSU5WQUxJRF9PQVVUSF9QUk9WSURFUiAqL106ICdFbWFpbEF1dGhQcm92aWRlciBpcyBub3Qgc3VwcG9ydGVkIGZvciB0aGlzIG9wZXJhdGlvbi4gVGhpcyBvcGVyYXRpb24gJyArXHJcbiAgICAgICAgICAgICdvbmx5IHN1cHBvcnRzIE9BdXRoIHByb3ZpZGVycy4nLFxyXG4gICAgICAgIFtcImludmFsaWQtb2F1dGgtY2xpZW50LWlkXCIgLyogSU5WQUxJRF9PQVVUSF9DTElFTlRfSUQgKi9dOiAnVGhlIE9BdXRoIGNsaWVudCBJRCBwcm92aWRlZCBpcyBlaXRoZXIgaW52YWxpZCBvciBkb2VzIG5vdCBtYXRjaCB0aGUgJyArXHJcbiAgICAgICAgICAgICdzcGVjaWZpZWQgQVBJIGtleS4nLFxyXG4gICAgICAgIFtcInVuYXV0aG9yaXplZC1kb21haW5cIiAvKiBJTlZBTElEX09SSUdJTiAqL106ICdUaGlzIGRvbWFpbiBpcyBub3QgYXV0aG9yaXplZCBmb3IgT0F1dGggb3BlcmF0aW9ucyBmb3IgeW91ciBGaXJlYmFzZSAnICtcclxuICAgICAgICAgICAgJ3Byb2plY3QuIEVkaXQgdGhlIGxpc3Qgb2YgYXV0aG9yaXplZCBkb21haW5zIGZyb20gdGhlIEZpcmViYXNlIGNvbnNvbGUuJyxcclxuICAgICAgICBbXCJpbnZhbGlkLWFjdGlvbi1jb2RlXCIgLyogSU5WQUxJRF9PT0JfQ09ERSAqL106ICdUaGUgYWN0aW9uIGNvZGUgaXMgaW52YWxpZC4gVGhpcyBjYW4gaGFwcGVuIGlmIHRoZSBjb2RlIGlzIG1hbGZvcm1lZCwgJyArXHJcbiAgICAgICAgICAgICdleHBpcmVkLCBvciBoYXMgYWxyZWFkeSBiZWVuIHVzZWQuJyxcclxuICAgICAgICBbXCJ3cm9uZy1wYXNzd29yZFwiIC8qIElOVkFMSURfUEFTU1dPUkQgKi9dOiAnVGhlIHBhc3N3b3JkIGlzIGludmFsaWQgb3IgdGhlIHVzZXIgZG9lcyBub3QgaGF2ZSBhIHBhc3N3b3JkLicsXHJcbiAgICAgICAgW1wiaW52YWxpZC1wZXJzaXN0ZW5jZS10eXBlXCIgLyogSU5WQUxJRF9QRVJTSVNURU5DRSAqL106ICdUaGUgc3BlY2lmaWVkIHBlcnNpc3RlbmNlIHR5cGUgaXMgaW52YWxpZC4gSXQgY2FuIG9ubHkgYmUgbG9jYWwsIHNlc3Npb24gb3Igbm9uZS4nLFxyXG4gICAgICAgIFtcImludmFsaWQtcGhvbmUtbnVtYmVyXCIgLyogSU5WQUxJRF9QSE9ORV9OVU1CRVIgKi9dOiAnVGhlIGZvcm1hdCBvZiB0aGUgcGhvbmUgbnVtYmVyIHByb3ZpZGVkIGlzIGluY29ycmVjdC4gUGxlYXNlIGVudGVyIHRoZSAnICtcclxuICAgICAgICAgICAgJ3Bob25lIG51bWJlciBpbiBhIGZvcm1hdCB0aGF0IGNhbiBiZSBwYXJzZWQgaW50byBFLjE2NCBmb3JtYXQuIEUuMTY0ICcgK1xyXG4gICAgICAgICAgICAncGhvbmUgbnVtYmVycyBhcmUgd3JpdHRlbiBpbiB0aGUgZm9ybWF0IFsrXVtjb3VudHJ5IGNvZGVdW3N1YnNjcmliZXIgJyArXHJcbiAgICAgICAgICAgICdudW1iZXIgaW5jbHVkaW5nIGFyZWEgY29kZV0uJyxcclxuICAgICAgICBbXCJpbnZhbGlkLXByb3ZpZGVyLWlkXCIgLyogSU5WQUxJRF9QUk9WSURFUl9JRCAqL106ICdUaGUgc3BlY2lmaWVkIHByb3ZpZGVyIElEIGlzIGludmFsaWQuJyxcclxuICAgICAgICBbXCJpbnZhbGlkLXJlY2lwaWVudC1lbWFpbFwiIC8qIElOVkFMSURfUkVDSVBJRU5UX0VNQUlMICovXTogJ1RoZSBlbWFpbCBjb3JyZXNwb25kaW5nIHRvIHRoaXMgYWN0aW9uIGZhaWxlZCB0byBzZW5kIGFzIHRoZSBwcm92aWRlZCAnICtcclxuICAgICAgICAgICAgJ3JlY2lwaWVudCBlbWFpbCBhZGRyZXNzIGlzIGludmFsaWQuJyxcclxuICAgICAgICBbXCJpbnZhbGlkLXNlbmRlclwiIC8qIElOVkFMSURfU0VOREVSICovXTogJ1RoZSBlbWFpbCB0ZW1wbGF0ZSBjb3JyZXNwb25kaW5nIHRvIHRoaXMgYWN0aW9uIGNvbnRhaW5zIGFuIGludmFsaWQgc2VuZGVyIGVtYWlsIG9yIG5hbWUuICcgK1xyXG4gICAgICAgICAgICAnUGxlYXNlIGZpeCBieSBnb2luZyB0byB0aGUgQXV0aCBlbWFpbCB0ZW1wbGF0ZXMgc2VjdGlvbiBpbiB0aGUgRmlyZWJhc2UgQ29uc29sZS4nLFxyXG4gICAgICAgIFtcImludmFsaWQtdmVyaWZpY2F0aW9uLWlkXCIgLyogSU5WQUxJRF9TRVNTSU9OX0lORk8gKi9dOiAnVGhlIHZlcmlmaWNhdGlvbiBJRCB1c2VkIHRvIGNyZWF0ZSB0aGUgcGhvbmUgYXV0aCBjcmVkZW50aWFsIGlzIGludmFsaWQuJyxcclxuICAgICAgICBbXCJpbnZhbGlkLXRlbmFudC1pZFwiIC8qIElOVkFMSURfVEVOQU5UX0lEICovXTogXCJUaGUgQXV0aCBpbnN0YW5jZSdzIHRlbmFudCBJRCBpcyBpbnZhbGlkLlwiLFxyXG4gICAgICAgIFtcIm1pc3NpbmctYW5kcm9pZC1wa2ctbmFtZVwiIC8qIE1JU1NJTkdfQU5EUk9JRF9QQUNLQUdFX05BTUUgKi9dOiAnQW4gQW5kcm9pZCBQYWNrYWdlIE5hbWUgbXVzdCBiZSBwcm92aWRlZCBpZiB0aGUgQW5kcm9pZCBBcHAgaXMgcmVxdWlyZWQgdG8gYmUgaW5zdGFsbGVkLicsXHJcbiAgICAgICAgW1wiYXV0aC1kb21haW4tY29uZmlnLXJlcXVpcmVkXCIgLyogTUlTU0lOR19BVVRIX0RPTUFJTiAqL106ICdCZSBzdXJlIHRvIGluY2x1ZGUgYXV0aERvbWFpbiB3aGVuIGNhbGxpbmcgZmlyZWJhc2UuaW5pdGlhbGl6ZUFwcCgpLCAnICtcclxuICAgICAgICAgICAgJ2J5IGZvbGxvd2luZyB0aGUgaW5zdHJ1Y3Rpb25zIGluIHRoZSBGaXJlYmFzZSBjb25zb2xlLicsXHJcbiAgICAgICAgW1wibWlzc2luZy1hcHAtY3JlZGVudGlhbFwiIC8qIE1JU1NJTkdfQVBQX0NSRURFTlRJQUwgKi9dOiAnVGhlIHBob25lIHZlcmlmaWNhdGlvbiByZXF1ZXN0IGlzIG1pc3NpbmcgYW4gYXBwbGljYXRpb24gdmVyaWZpZXIgJyArXHJcbiAgICAgICAgICAgICdhc3NlcnRpb24uIEEgcmVDQVBUQ0hBIHJlc3BvbnNlIHRva2VuIG5lZWRzIHRvIGJlIHByb3ZpZGVkLicsXHJcbiAgICAgICAgW1wibWlzc2luZy12ZXJpZmljYXRpb24tY29kZVwiIC8qIE1JU1NJTkdfQ09ERSAqL106ICdUaGUgcGhvbmUgYXV0aCBjcmVkZW50aWFsIHdhcyBjcmVhdGVkIHdpdGggYW4gZW1wdHkgU01TIHZlcmlmaWNhdGlvbiBjb2RlLicsXHJcbiAgICAgICAgW1wibWlzc2luZy1jb250aW51ZS11cmlcIiAvKiBNSVNTSU5HX0NPTlRJTlVFX1VSSSAqL106ICdBIGNvbnRpbnVlIFVSTCBtdXN0IGJlIHByb3ZpZGVkIGluIHRoZSByZXF1ZXN0LicsXHJcbiAgICAgICAgW1wibWlzc2luZy1pZnJhbWUtc3RhcnRcIiAvKiBNSVNTSU5HX0lGUkFNRV9TVEFSVCAqL106ICdBbiBpbnRlcm5hbCBBdXRoRXJyb3IgaGFzIG9jY3VycmVkLicsXHJcbiAgICAgICAgW1wibWlzc2luZy1pb3MtYnVuZGxlLWlkXCIgLyogTUlTU0lOR19JT1NfQlVORExFX0lEICovXTogJ0FuIGlPUyBCdW5kbGUgSUQgbXVzdCBiZSBwcm92aWRlZCBpZiBhbiBBcHAgU3RvcmUgSUQgaXMgcHJvdmlkZWQuJyxcclxuICAgICAgICBbXCJtaXNzaW5nLW9yLWludmFsaWQtbm9uY2VcIiAvKiBNSVNTSU5HX09SX0lOVkFMSURfTk9OQ0UgKi9dOiAnVGhlIHJlcXVlc3QgZG9lcyBub3QgY29udGFpbiBhIHZhbGlkIG5vbmNlLiBUaGlzIGNhbiBvY2N1ciBpZiB0aGUgJyArXHJcbiAgICAgICAgICAgICdTSEEtMjU2IGhhc2ggb2YgdGhlIHByb3ZpZGVkIHJhdyBub25jZSBkb2VzIG5vdCBtYXRjaCB0aGUgaGFzaGVkIG5vbmNlICcgK1xyXG4gICAgICAgICAgICAnaW4gdGhlIElEIHRva2VuIHBheWxvYWQuJyxcclxuICAgICAgICBbXCJtaXNzaW5nLW11bHRpLWZhY3Rvci1pbmZvXCIgLyogTUlTU0lOR19NRkFfSU5GTyAqL106ICdObyBzZWNvbmQgZmFjdG9yIGlkZW50aWZpZXIgaXMgcHJvdmlkZWQuJyxcclxuICAgICAgICBbXCJtaXNzaW5nLW11bHRpLWZhY3Rvci1zZXNzaW9uXCIgLyogTUlTU0lOR19NRkFfU0VTU0lPTiAqL106ICdUaGUgcmVxdWVzdCBpcyBtaXNzaW5nIHByb29mIG9mIGZpcnN0IGZhY3RvciBzdWNjZXNzZnVsIHNpZ24taW4uJyxcclxuICAgICAgICBbXCJtaXNzaW5nLXBob25lLW51bWJlclwiIC8qIE1JU1NJTkdfUEhPTkVfTlVNQkVSICovXTogJ1RvIHNlbmQgdmVyaWZpY2F0aW9uIGNvZGVzLCBwcm92aWRlIGEgcGhvbmUgbnVtYmVyIGZvciB0aGUgcmVjaXBpZW50LicsXHJcbiAgICAgICAgW1wibWlzc2luZy12ZXJpZmljYXRpb24taWRcIiAvKiBNSVNTSU5HX1NFU1NJT05fSU5GTyAqL106ICdUaGUgcGhvbmUgYXV0aCBjcmVkZW50aWFsIHdhcyBjcmVhdGVkIHdpdGggYW4gZW1wdHkgdmVyaWZpY2F0aW9uIElELicsXHJcbiAgICAgICAgW1wiYXBwLWRlbGV0ZWRcIiAvKiBNT0RVTEVfREVTVFJPWUVEICovXTogJ1RoaXMgaW5zdGFuY2Ugb2YgRmlyZWJhc2VBcHAgaGFzIGJlZW4gZGVsZXRlZC4nLFxyXG4gICAgICAgIFtcIm11bHRpLWZhY3Rvci1pbmZvLW5vdC1mb3VuZFwiIC8qIE1GQV9JTkZPX05PVF9GT1VORCAqL106ICdUaGUgdXNlciBkb2VzIG5vdCBoYXZlIGEgc2Vjb25kIGZhY3RvciBtYXRjaGluZyB0aGUgaWRlbnRpZmllciBwcm92aWRlZC4nLFxyXG4gICAgICAgIFtcIm11bHRpLWZhY3Rvci1hdXRoLXJlcXVpcmVkXCIgLyogTUZBX1JFUVVJUkVEICovXTogJ1Byb29mIG9mIG93bmVyc2hpcCBvZiBhIHNlY29uZCBmYWN0b3IgaXMgcmVxdWlyZWQgdG8gY29tcGxldGUgc2lnbi1pbi4nLFxyXG4gICAgICAgIFtcImFjY291bnQtZXhpc3RzLXdpdGgtZGlmZmVyZW50LWNyZWRlbnRpYWxcIiAvKiBORUVEX0NPTkZJUk1BVElPTiAqL106ICdBbiBhY2NvdW50IGFscmVhZHkgZXhpc3RzIHdpdGggdGhlIHNhbWUgZW1haWwgYWRkcmVzcyBidXQgZGlmZmVyZW50ICcgK1xyXG4gICAgICAgICAgICAnc2lnbi1pbiBjcmVkZW50aWFscy4gU2lnbiBpbiB1c2luZyBhIHByb3ZpZGVyIGFzc29jaWF0ZWQgd2l0aCB0aGlzICcgK1xyXG4gICAgICAgICAgICAnZW1haWwgYWRkcmVzcy4nLFxyXG4gICAgICAgIFtcIm5ldHdvcmstcmVxdWVzdC1mYWlsZWRcIiAvKiBORVRXT1JLX1JFUVVFU1RfRkFJTEVEICovXTogJ0EgbmV0d29yayBBdXRoRXJyb3IgKHN1Y2ggYXMgdGltZW91dCwgaW50ZXJydXB0ZWQgY29ubmVjdGlvbiBvciB1bnJlYWNoYWJsZSBob3N0KSBoYXMgb2NjdXJyZWQuJyxcclxuICAgICAgICBbXCJuby1hdXRoLWV2ZW50XCIgLyogTk9fQVVUSF9FVkVOVCAqL106ICdBbiBpbnRlcm5hbCBBdXRoRXJyb3IgaGFzIG9jY3VycmVkLicsXHJcbiAgICAgICAgW1wibm8tc3VjaC1wcm92aWRlclwiIC8qIE5PX1NVQ0hfUFJPVklERVIgKi9dOiAnVXNlciB3YXMgbm90IGxpbmtlZCB0byBhbiBhY2NvdW50IHdpdGggdGhlIGdpdmVuIHByb3ZpZGVyLicsXHJcbiAgICAgICAgW1wibnVsbC11c2VyXCIgLyogTlVMTF9VU0VSICovXTogJ0EgbnVsbCB1c2VyIG9iamVjdCB3YXMgcHJvdmlkZWQgYXMgdGhlIGFyZ3VtZW50IGZvciBhbiBvcGVyYXRpb24gd2hpY2ggJyArXHJcbiAgICAgICAgICAgICdyZXF1aXJlcyBhIG5vbi1udWxsIHVzZXIgb2JqZWN0LicsXHJcbiAgICAgICAgW1wib3BlcmF0aW9uLW5vdC1hbGxvd2VkXCIgLyogT1BFUkFUSU9OX05PVF9BTExPV0VEICovXTogJ1RoZSBnaXZlbiBzaWduLWluIHByb3ZpZGVyIGlzIGRpc2FibGVkIGZvciB0aGlzIEZpcmViYXNlIHByb2plY3QuICcgK1xyXG4gICAgICAgICAgICAnRW5hYmxlIGl0IGluIHRoZSBGaXJlYmFzZSBjb25zb2xlLCB1bmRlciB0aGUgc2lnbi1pbiBtZXRob2QgdGFiIG9mIHRoZSAnICtcclxuICAgICAgICAgICAgJ0F1dGggc2VjdGlvbi4nLFxyXG4gICAgICAgIFtcIm9wZXJhdGlvbi1ub3Qtc3VwcG9ydGVkLWluLXRoaXMtZW52aXJvbm1lbnRcIiAvKiBPUEVSQVRJT05fTk9UX1NVUFBPUlRFRCAqL106ICdUaGlzIG9wZXJhdGlvbiBpcyBub3Qgc3VwcG9ydGVkIGluIHRoZSBlbnZpcm9ubWVudCB0aGlzIGFwcGxpY2F0aW9uIGlzICcgK1xyXG4gICAgICAgICAgICAncnVubmluZyBvbi4gXCJsb2NhdGlvbi5wcm90b2NvbFwiIG11c3QgYmUgaHR0cCwgaHR0cHMgb3IgY2hyb21lLWV4dGVuc2lvbicgK1xyXG4gICAgICAgICAgICAnIGFuZCB3ZWIgc3RvcmFnZSBtdXN0IGJlIGVuYWJsZWQuJyxcclxuICAgICAgICBbXCJwb3B1cC1ibG9ja2VkXCIgLyogUE9QVVBfQkxPQ0tFRCAqL106ICdVbmFibGUgdG8gZXN0YWJsaXNoIGEgY29ubmVjdGlvbiB3aXRoIHRoZSBwb3B1cC4gSXQgbWF5IGhhdmUgYmVlbiBibG9ja2VkIGJ5IHRoZSBicm93c2VyLicsXHJcbiAgICAgICAgW1wicG9wdXAtY2xvc2VkLWJ5LXVzZXJcIiAvKiBQT1BVUF9DTE9TRURfQllfVVNFUiAqL106ICdUaGUgcG9wdXAgaGFzIGJlZW4gY2xvc2VkIGJ5IHRoZSB1c2VyIGJlZm9yZSBmaW5hbGl6aW5nIHRoZSBvcGVyYXRpb24uJyxcclxuICAgICAgICBbXCJwcm92aWRlci1hbHJlYWR5LWxpbmtlZFwiIC8qIFBST1ZJREVSX0FMUkVBRFlfTElOS0VEICovXTogJ1VzZXIgY2FuIG9ubHkgYmUgbGlua2VkIHRvIG9uZSBpZGVudGl0eSBmb3IgdGhlIGdpdmVuIHByb3ZpZGVyLicsXHJcbiAgICAgICAgW1wicXVvdGEtZXhjZWVkZWRcIiAvKiBRVU9UQV9FWENFRURFRCAqL106IFwiVGhlIHByb2plY3QncyBxdW90YSBmb3IgdGhpcyBvcGVyYXRpb24gaGFzIGJlZW4gZXhjZWVkZWQuXCIsXHJcbiAgICAgICAgW1wicmVkaXJlY3QtY2FuY2VsbGVkLWJ5LXVzZXJcIiAvKiBSRURJUkVDVF9DQU5DRUxMRURfQllfVVNFUiAqL106ICdUaGUgcmVkaXJlY3Qgb3BlcmF0aW9uIGhhcyBiZWVuIGNhbmNlbGxlZCBieSB0aGUgdXNlciBiZWZvcmUgZmluYWxpemluZy4nLFxyXG4gICAgICAgIFtcInJlZGlyZWN0LW9wZXJhdGlvbi1wZW5kaW5nXCIgLyogUkVESVJFQ1RfT1BFUkFUSU9OX1BFTkRJTkcgKi9dOiAnQSByZWRpcmVjdCBzaWduLWluIG9wZXJhdGlvbiBpcyBhbHJlYWR5IHBlbmRpbmcuJyxcclxuICAgICAgICBbXCJyZWplY3RlZC1jcmVkZW50aWFsXCIgLyogUkVKRUNURURfQ1JFREVOVElBTCAqL106ICdUaGUgcmVxdWVzdCBjb250YWlucyBtYWxmb3JtZWQgb3IgbWlzbWF0Y2hpbmcgY3JlZGVudGlhbHMuJyxcclxuICAgICAgICBbXCJzZWNvbmQtZmFjdG9yLWFscmVhZHktaW4tdXNlXCIgLyogU0VDT05EX0ZBQ1RPUl9BTFJFQURZX0VOUk9MTEVEICovXTogJ1RoZSBzZWNvbmQgZmFjdG9yIGlzIGFscmVhZHkgZW5yb2xsZWQgb24gdGhpcyBhY2NvdW50LicsXHJcbiAgICAgICAgW1wibWF4aW11bS1zZWNvbmQtZmFjdG9yLWNvdW50LWV4Y2VlZGVkXCIgLyogU0VDT05EX0ZBQ1RPUl9MSU1JVF9FWENFRURFRCAqL106ICdUaGUgbWF4aW11bSBhbGxvd2VkIG51bWJlciBvZiBzZWNvbmQgZmFjdG9ycyBvbiBhIHVzZXIgaGFzIGJlZW4gZXhjZWVkZWQuJyxcclxuICAgICAgICBbXCJ0ZW5hbnQtaWQtbWlzbWF0Y2hcIiAvKiBURU5BTlRfSURfTUlTTUFUQ0ggKi9dOiBcIlRoZSBwcm92aWRlZCB0ZW5hbnQgSUQgZG9lcyBub3QgbWF0Y2ggdGhlIEF1dGggaW5zdGFuY2UncyB0ZW5hbnQgSURcIixcclxuICAgICAgICBbXCJ0aW1lb3V0XCIgLyogVElNRU9VVCAqL106ICdUaGUgb3BlcmF0aW9uIGhhcyB0aW1lZCBvdXQuJyxcclxuICAgICAgICBbXCJ1c2VyLXRva2VuLWV4cGlyZWRcIiAvKiBUT0tFTl9FWFBJUkVEICovXTogXCJUaGUgdXNlcidzIGNyZWRlbnRpYWwgaXMgbm8gbG9uZ2VyIHZhbGlkLiBUaGUgdXNlciBtdXN0IHNpZ24gaW4gYWdhaW4uXCIsXHJcbiAgICAgICAgW1widG9vLW1hbnktcmVxdWVzdHNcIiAvKiBUT09fTUFOWV9BVFRFTVBUU19UUllfTEFURVIgKi9dOiAnV2UgaGF2ZSBibG9ja2VkIGFsbCByZXF1ZXN0cyBmcm9tIHRoaXMgZGV2aWNlIGR1ZSB0byB1bnVzdWFsIGFjdGl2aXR5LiAnICtcclxuICAgICAgICAgICAgJ1RyeSBhZ2FpbiBsYXRlci4nLFxyXG4gICAgICAgIFtcInVuYXV0aG9yaXplZC1jb250aW51ZS11cmlcIiAvKiBVTkFVVEhPUklaRURfRE9NQUlOICovXTogJ1RoZSBkb21haW4gb2YgdGhlIGNvbnRpbnVlIFVSTCBpcyBub3Qgd2hpdGVsaXN0ZWQuICBQbGVhc2Ugd2hpdGVsaXN0ICcgK1xyXG4gICAgICAgICAgICAndGhlIGRvbWFpbiBpbiB0aGUgRmlyZWJhc2UgY29uc29sZS4nLFxyXG4gICAgICAgIFtcInVuc3VwcG9ydGVkLWZpcnN0LWZhY3RvclwiIC8qIFVOU1VQUE9SVEVEX0ZJUlNUX0ZBQ1RPUiAqL106ICdFbnJvbGxpbmcgYSBzZWNvbmQgZmFjdG9yIG9yIHNpZ25pbmcgaW4gd2l0aCBhIG11bHRpLWZhY3RvciBhY2NvdW50IHJlcXVpcmVzIHNpZ24taW4gd2l0aCBhIHN1cHBvcnRlZCBmaXJzdCBmYWN0b3IuJyxcclxuICAgICAgICBbXCJ1bnN1cHBvcnRlZC1wZXJzaXN0ZW5jZS10eXBlXCIgLyogVU5TVVBQT1JURURfUEVSU0lTVEVOQ0UgKi9dOiAnVGhlIGN1cnJlbnQgZW52aXJvbm1lbnQgZG9lcyBub3Qgc3VwcG9ydCB0aGUgc3BlY2lmaWVkIHBlcnNpc3RlbmNlIHR5cGUuJyxcclxuICAgICAgICBbXCJ1bnN1cHBvcnRlZC10ZW5hbnQtb3BlcmF0aW9uXCIgLyogVU5TVVBQT1JURURfVEVOQU5UX09QRVJBVElPTiAqL106ICdUaGlzIG9wZXJhdGlvbiBpcyBub3Qgc3VwcG9ydGVkIGluIGEgbXVsdGktdGVuYW50IGNvbnRleHQuJyxcclxuICAgICAgICBbXCJ1bnZlcmlmaWVkLWVtYWlsXCIgLyogVU5WRVJJRklFRF9FTUFJTCAqL106ICdUaGUgb3BlcmF0aW9uIHJlcXVpcmVzIGEgdmVyaWZpZWQgZW1haWwuJyxcclxuICAgICAgICBbXCJ1c2VyLWNhbmNlbGxlZFwiIC8qIFVTRVJfQ0FOQ0VMTEVEICovXTogJ1RoZSB1c2VyIGRpZCBub3QgZ3JhbnQgeW91ciBhcHBsaWNhdGlvbiB0aGUgcGVybWlzc2lvbnMgaXQgcmVxdWVzdGVkLicsXHJcbiAgICAgICAgW1widXNlci1ub3QtZm91bmRcIiAvKiBVU0VSX0RFTEVURUQgKi9dOiAnVGhlcmUgaXMgbm8gdXNlciByZWNvcmQgY29ycmVzcG9uZGluZyB0byB0aGlzIGlkZW50aWZpZXIuIFRoZSB1c2VyIG1heSAnICtcclxuICAgICAgICAgICAgJ2hhdmUgYmVlbiBkZWxldGVkLicsXHJcbiAgICAgICAgW1widXNlci1kaXNhYmxlZFwiIC8qIFVTRVJfRElTQUJMRUQgKi9dOiAnVGhlIHVzZXIgYWNjb3VudCBoYXMgYmVlbiBkaXNhYmxlZCBieSBhbiBhZG1pbmlzdHJhdG9yLicsXHJcbiAgICAgICAgW1widXNlci1taXNtYXRjaFwiIC8qIFVTRVJfTUlTTUFUQ0ggKi9dOiAnVGhlIHN1cHBsaWVkIGNyZWRlbnRpYWxzIGRvIG5vdCBjb3JyZXNwb25kIHRvIHRoZSBwcmV2aW91c2x5IHNpZ25lZCBpbiB1c2VyLicsXHJcbiAgICAgICAgW1widXNlci1zaWduZWQtb3V0XCIgLyogVVNFUl9TSUdORURfT1VUICovXTogJycsXHJcbiAgICAgICAgW1wid2Vhay1wYXNzd29yZFwiIC8qIFdFQUtfUEFTU1dPUkQgKi9dOiAnVGhlIHBhc3N3b3JkIG11c3QgYmUgNiBjaGFyYWN0ZXJzIGxvbmcgb3IgbW9yZS4nLFxyXG4gICAgICAgIFtcIndlYi1zdG9yYWdlLXVuc3VwcG9ydGVkXCIgLyogV0VCX1NUT1JBR0VfVU5TVVBQT1JURUQgKi9dOiAnVGhpcyBicm93c2VyIGlzIG5vdCBzdXBwb3J0ZWQgb3IgM3JkIHBhcnR5IGNvb2tpZXMgYW5kIGRhdGEgbWF5IGJlIGRpc2FibGVkLicsXHJcbiAgICAgICAgW1wiYWxyZWFkeS1pbml0aWFsaXplZFwiIC8qIEFMUkVBRFlfSU5JVElBTElaRUQgKi9dOiAnaW5pdGlhbGl6ZUF1dGgoKSBoYXMgYWxyZWFkeSBiZWVuIGNhbGxlZCB3aXRoICcgK1xyXG4gICAgICAgICAgICAnZGlmZmVyZW50IG9wdGlvbnMuIFRvIGF2b2lkIHRoaXMgZXJyb3IsIGNhbGwgaW5pdGlhbGl6ZUF1dGgoKSB3aXRoIHRoZSAnICtcclxuICAgICAgICAgICAgJ3NhbWUgb3B0aW9ucyBhcyB3aGVuIGl0IHdhcyBvcmlnaW5hbGx5IGNhbGxlZCwgb3IgY2FsbCBnZXRBdXRoKCkgdG8gcmV0dXJuIHRoZScgK1xyXG4gICAgICAgICAgICAnIGFscmVhZHkgaW5pdGlhbGl6ZWQgaW5zdGFuY2UuJ1xyXG4gICAgfTtcclxufVxyXG5mdW5jdGlvbiBfcHJvZEVycm9yTWFwKCkge1xyXG4gICAgLy8gV2Ugd2lsbCBpbmNsdWRlIHRoaXMgb25lIG1lc3NhZ2UgaW4gdGhlIHByb2QgZXJyb3IgbWFwIHNpbmNlIGJ5IHRoZSB2ZXJ5XHJcbiAgICAvLyBuYXR1cmUgb2YgdGhpcyBlcnJvciwgZGV2ZWxvcGVycyB3aWxsIG5ldmVyIGJlIGFibGUgdG8gc2VlIHRoZSBtZXNzYWdlXHJcbiAgICAvLyB1c2luZyB0aGUgZGVidWdFcnJvck1hcCAod2hpY2ggaXMgaW5zdGFsbGVkIGR1cmluZyBhdXRoIGluaXRpYWxpemF0aW9uKS5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgW1wiZGVwZW5kZW50LXNkay1pbml0aWFsaXplZC1iZWZvcmUtYXV0aFwiIC8qIERFUEVOREVOVF9TREtfSU5JVF9CRUZPUkVfQVVUSCAqL106ICdBbm90aGVyIEZpcmViYXNlIFNESyB3YXMgaW5pdGlhbGl6ZWQgYW5kIGlzIHRyeWluZyB0byB1c2UgQXV0aCBiZWZvcmUgQXV0aCBpcyAnICtcclxuICAgICAgICAgICAgJ2luaXRpYWxpemVkLiBQbGVhc2UgYmUgc3VyZSB0byBjYWxsIGBpbml0aWFsaXplQXV0aGAgb3IgYGdldEF1dGhgIGJlZm9yZSAnICtcclxuICAgICAgICAgICAgJ3N0YXJ0aW5nIGFueSBvdGhlciBGaXJlYmFzZSBTREsuJ1xyXG4gICAgfTtcclxufVxyXG4vKipcclxuICogQSB2ZXJib3NlIGVycm9yIG1hcCB3aXRoIGRldGFpbGVkIGRlc2NyaXB0aW9ucyBmb3IgbW9zdCBlcnJvciBjb2Rlcy5cclxuICpcclxuICogU2VlIGRpc2N1c3Npb24gYXQge0BsaW5rIEF1dGhFcnJvck1hcH1cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuY29uc3QgZGVidWdFcnJvck1hcCA9IF9kZWJ1Z0Vycm9yTWFwO1xyXG4vKipcclxuICogQSBtaW5pbWFsIGVycm9yIG1hcCB3aXRoIGFsbCB2ZXJib3NlIGVycm9yIG1lc3NhZ2VzIHN0cmlwcGVkLlxyXG4gKlxyXG4gKiBTZWUgZGlzY3Vzc2lvbiBhdCB7QGxpbmsgQXV0aEVycm9yTWFwfVxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5jb25zdCBwcm9kRXJyb3JNYXAgPSBfcHJvZEVycm9yTWFwO1xyXG5jb25zdCBfREVGQVVMVF9BVVRIX0VSUk9SX0ZBQ1RPUlkgPSBuZXcgRXJyb3JGYWN0b3J5KCdhdXRoJywgJ0ZpcmViYXNlJywgX3Byb2RFcnJvck1hcCgpKTtcclxuLyoqXHJcbiAqIEEgbWFwIG9mIHBvdGVudGlhbCBgQXV0aGAgZXJyb3IgY29kZXMsIGZvciBlYXNpZXIgY29tcGFyaXNvbiB3aXRoIGVycm9yc1xyXG4gKiB0aHJvd24gYnkgdGhlIFNESy5cclxuICpcclxuICogQHJlbWFya3NcclxuICogTm90ZSB0aGF0IHlvdSBjYW4ndCB0cmVlLXNoYWtlIGluZGl2aWR1YWwga2V5c1xyXG4gKiBpbiB0aGUgbWFwLCBzbyBieSB1c2luZyB0aGUgbWFwIHlvdSBtaWdodCBzdWJzdGFudGlhbGx5IGluY3JlYXNlIHlvdXJcclxuICogYnVuZGxlIHNpemUuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmNvbnN0IEFVVEhfRVJST1JfQ09ERVNfTUFQX0RPX05PVF9VU0VfSU5URVJOQUxMWSA9IHtcclxuICAgIEFETUlOX09OTFlfT1BFUkFUSU9OOiAnYXV0aC9hZG1pbi1yZXN0cmljdGVkLW9wZXJhdGlvbicsXHJcbiAgICBBUkdVTUVOVF9FUlJPUjogJ2F1dGgvYXJndW1lbnQtZXJyb3InLFxyXG4gICAgQVBQX05PVF9BVVRIT1JJWkVEOiAnYXV0aC9hcHAtbm90LWF1dGhvcml6ZWQnLFxyXG4gICAgQVBQX05PVF9JTlNUQUxMRUQ6ICdhdXRoL2FwcC1ub3QtaW5zdGFsbGVkJyxcclxuICAgIENBUFRDSEFfQ0hFQ0tfRkFJTEVEOiAnYXV0aC9jYXB0Y2hhLWNoZWNrLWZhaWxlZCcsXHJcbiAgICBDT0RFX0VYUElSRUQ6ICdhdXRoL2NvZGUtZXhwaXJlZCcsXHJcbiAgICBDT1JET1ZBX05PVF9SRUFEWTogJ2F1dGgvY29yZG92YS1ub3QtcmVhZHknLFxyXG4gICAgQ09SU19VTlNVUFBPUlRFRDogJ2F1dGgvY29ycy11bnN1cHBvcnRlZCcsXHJcbiAgICBDUkVERU5USUFMX0FMUkVBRFlfSU5fVVNFOiAnYXV0aC9jcmVkZW50aWFsLWFscmVhZHktaW4tdXNlJyxcclxuICAgIENSRURFTlRJQUxfTUlTTUFUQ0g6ICdhdXRoL2N1c3RvbS10b2tlbi1taXNtYXRjaCcsXHJcbiAgICBDUkVERU5USUFMX1RPT19PTERfTE9HSU5fQUdBSU46ICdhdXRoL3JlcXVpcmVzLXJlY2VudC1sb2dpbicsXHJcbiAgICBERVBFTkRFTlRfU0RLX0lOSVRfQkVGT1JFX0FVVEg6ICdhdXRoL2RlcGVuZGVudC1zZGstaW5pdGlhbGl6ZWQtYmVmb3JlLWF1dGgnLFxyXG4gICAgRFlOQU1JQ19MSU5LX05PVF9BQ1RJVkFURUQ6ICdhdXRoL2R5bmFtaWMtbGluay1ub3QtYWN0aXZhdGVkJyxcclxuICAgIEVNQUlMX0NIQU5HRV9ORUVEU19WRVJJRklDQVRJT046ICdhdXRoL2VtYWlsLWNoYW5nZS1uZWVkcy12ZXJpZmljYXRpb24nLFxyXG4gICAgRU1BSUxfRVhJU1RTOiAnYXV0aC9lbWFpbC1hbHJlYWR5LWluLXVzZScsXHJcbiAgICBFTVVMQVRPUl9DT05GSUdfRkFJTEVEOiAnYXV0aC9lbXVsYXRvci1jb25maWctZmFpbGVkJyxcclxuICAgIEVYUElSRURfT09CX0NPREU6ICdhdXRoL2V4cGlyZWQtYWN0aW9uLWNvZGUnLFxyXG4gICAgRVhQSVJFRF9QT1BVUF9SRVFVRVNUOiAnYXV0aC9jYW5jZWxsZWQtcG9wdXAtcmVxdWVzdCcsXHJcbiAgICBJTlRFUk5BTF9FUlJPUjogJ2F1dGgvaW50ZXJuYWwtZXJyb3InLFxyXG4gICAgSU5WQUxJRF9BUElfS0VZOiAnYXV0aC9pbnZhbGlkLWFwaS1rZXknLFxyXG4gICAgSU5WQUxJRF9BUFBfQ1JFREVOVElBTDogJ2F1dGgvaW52YWxpZC1hcHAtY3JlZGVudGlhbCcsXHJcbiAgICBJTlZBTElEX0FQUF9JRDogJ2F1dGgvaW52YWxpZC1hcHAtaWQnLFxyXG4gICAgSU5WQUxJRF9BVVRIOiAnYXV0aC9pbnZhbGlkLXVzZXItdG9rZW4nLFxyXG4gICAgSU5WQUxJRF9BVVRIX0VWRU5UOiAnYXV0aC9pbnZhbGlkLWF1dGgtZXZlbnQnLFxyXG4gICAgSU5WQUxJRF9DRVJUX0hBU0g6ICdhdXRoL2ludmFsaWQtY2VydC1oYXNoJyxcclxuICAgIElOVkFMSURfQ09ERTogJ2F1dGgvaW52YWxpZC12ZXJpZmljYXRpb24tY29kZScsXHJcbiAgICBJTlZBTElEX0NPTlRJTlVFX1VSSTogJ2F1dGgvaW52YWxpZC1jb250aW51ZS11cmknLFxyXG4gICAgSU5WQUxJRF9DT1JET1ZBX0NPTkZJR1VSQVRJT046ICdhdXRoL2ludmFsaWQtY29yZG92YS1jb25maWd1cmF0aW9uJyxcclxuICAgIElOVkFMSURfQ1VTVE9NX1RPS0VOOiAnYXV0aC9pbnZhbGlkLWN1c3RvbS10b2tlbicsXHJcbiAgICBJTlZBTElEX0RZTkFNSUNfTElOS19ET01BSU46ICdhdXRoL2ludmFsaWQtZHluYW1pYy1saW5rLWRvbWFpbicsXHJcbiAgICBJTlZBTElEX0VNQUlMOiAnYXV0aC9pbnZhbGlkLWVtYWlsJyxcclxuICAgIElOVkFMSURfRU1VTEFUT1JfU0NIRU1FOiAnYXV0aC9pbnZhbGlkLWVtdWxhdG9yLXNjaGVtZScsXHJcbiAgICBJTlZBTElEX0lEUF9SRVNQT05TRTogJ2F1dGgvaW52YWxpZC1jcmVkZW50aWFsJyxcclxuICAgIElOVkFMSURfTUVTU0FHRV9QQVlMT0FEOiAnYXV0aC9pbnZhbGlkLW1lc3NhZ2UtcGF5bG9hZCcsXHJcbiAgICBJTlZBTElEX01GQV9TRVNTSU9OOiAnYXV0aC9pbnZhbGlkLW11bHRpLWZhY3Rvci1zZXNzaW9uJyxcclxuICAgIElOVkFMSURfT0FVVEhfQ0xJRU5UX0lEOiAnYXV0aC9pbnZhbGlkLW9hdXRoLWNsaWVudC1pZCcsXHJcbiAgICBJTlZBTElEX09BVVRIX1BST1ZJREVSOiAnYXV0aC9pbnZhbGlkLW9hdXRoLXByb3ZpZGVyJyxcclxuICAgIElOVkFMSURfT09CX0NPREU6ICdhdXRoL2ludmFsaWQtYWN0aW9uLWNvZGUnLFxyXG4gICAgSU5WQUxJRF9PUklHSU46ICdhdXRoL3VuYXV0aG9yaXplZC1kb21haW4nLFxyXG4gICAgSU5WQUxJRF9QQVNTV09SRDogJ2F1dGgvd3JvbmctcGFzc3dvcmQnLFxyXG4gICAgSU5WQUxJRF9QRVJTSVNURU5DRTogJ2F1dGgvaW52YWxpZC1wZXJzaXN0ZW5jZS10eXBlJyxcclxuICAgIElOVkFMSURfUEhPTkVfTlVNQkVSOiAnYXV0aC9pbnZhbGlkLXBob25lLW51bWJlcicsXHJcbiAgICBJTlZBTElEX1BST1ZJREVSX0lEOiAnYXV0aC9pbnZhbGlkLXByb3ZpZGVyLWlkJyxcclxuICAgIElOVkFMSURfUkVDSVBJRU5UX0VNQUlMOiAnYXV0aC9pbnZhbGlkLXJlY2lwaWVudC1lbWFpbCcsXHJcbiAgICBJTlZBTElEX1NFTkRFUjogJ2F1dGgvaW52YWxpZC1zZW5kZXInLFxyXG4gICAgSU5WQUxJRF9TRVNTSU9OX0lORk86ICdhdXRoL2ludmFsaWQtdmVyaWZpY2F0aW9uLWlkJyxcclxuICAgIElOVkFMSURfVEVOQU5UX0lEOiAnYXV0aC9pbnZhbGlkLXRlbmFudC1pZCcsXHJcbiAgICBNRkFfSU5GT19OT1RfRk9VTkQ6ICdhdXRoL211bHRpLWZhY3Rvci1pbmZvLW5vdC1mb3VuZCcsXHJcbiAgICBNRkFfUkVRVUlSRUQ6ICdhdXRoL211bHRpLWZhY3Rvci1hdXRoLXJlcXVpcmVkJyxcclxuICAgIE1JU1NJTkdfQU5EUk9JRF9QQUNLQUdFX05BTUU6ICdhdXRoL21pc3NpbmctYW5kcm9pZC1wa2ctbmFtZScsXHJcbiAgICBNSVNTSU5HX0FQUF9DUkVERU5USUFMOiAnYXV0aC9taXNzaW5nLWFwcC1jcmVkZW50aWFsJyxcclxuICAgIE1JU1NJTkdfQVVUSF9ET01BSU46ICdhdXRoL2F1dGgtZG9tYWluLWNvbmZpZy1yZXF1aXJlZCcsXHJcbiAgICBNSVNTSU5HX0NPREU6ICdhdXRoL21pc3NpbmctdmVyaWZpY2F0aW9uLWNvZGUnLFxyXG4gICAgTUlTU0lOR19DT05USU5VRV9VUkk6ICdhdXRoL21pc3NpbmctY29udGludWUtdXJpJyxcclxuICAgIE1JU1NJTkdfSUZSQU1FX1NUQVJUOiAnYXV0aC9taXNzaW5nLWlmcmFtZS1zdGFydCcsXHJcbiAgICBNSVNTSU5HX0lPU19CVU5ETEVfSUQ6ICdhdXRoL21pc3NpbmctaW9zLWJ1bmRsZS1pZCcsXHJcbiAgICBNSVNTSU5HX09SX0lOVkFMSURfTk9OQ0U6ICdhdXRoL21pc3Npbmctb3ItaW52YWxpZC1ub25jZScsXHJcbiAgICBNSVNTSU5HX01GQV9JTkZPOiAnYXV0aC9taXNzaW5nLW11bHRpLWZhY3Rvci1pbmZvJyxcclxuICAgIE1JU1NJTkdfTUZBX1NFU1NJT046ICdhdXRoL21pc3NpbmctbXVsdGktZmFjdG9yLXNlc3Npb24nLFxyXG4gICAgTUlTU0lOR19QSE9ORV9OVU1CRVI6ICdhdXRoL21pc3NpbmctcGhvbmUtbnVtYmVyJyxcclxuICAgIE1JU1NJTkdfU0VTU0lPTl9JTkZPOiAnYXV0aC9taXNzaW5nLXZlcmlmaWNhdGlvbi1pZCcsXHJcbiAgICBNT0RVTEVfREVTVFJPWUVEOiAnYXV0aC9hcHAtZGVsZXRlZCcsXHJcbiAgICBORUVEX0NPTkZJUk1BVElPTjogJ2F1dGgvYWNjb3VudC1leGlzdHMtd2l0aC1kaWZmZXJlbnQtY3JlZGVudGlhbCcsXHJcbiAgICBORVRXT1JLX1JFUVVFU1RfRkFJTEVEOiAnYXV0aC9uZXR3b3JrLXJlcXVlc3QtZmFpbGVkJyxcclxuICAgIE5VTExfVVNFUjogJ2F1dGgvbnVsbC11c2VyJyxcclxuICAgIE5PX0FVVEhfRVZFTlQ6ICdhdXRoL25vLWF1dGgtZXZlbnQnLFxyXG4gICAgTk9fU1VDSF9QUk9WSURFUjogJ2F1dGgvbm8tc3VjaC1wcm92aWRlcicsXHJcbiAgICBPUEVSQVRJT05fTk9UX0FMTE9XRUQ6ICdhdXRoL29wZXJhdGlvbi1ub3QtYWxsb3dlZCcsXHJcbiAgICBPUEVSQVRJT05fTk9UX1NVUFBPUlRFRDogJ2F1dGgvb3BlcmF0aW9uLW5vdC1zdXBwb3J0ZWQtaW4tdGhpcy1lbnZpcm9ubWVudCcsXHJcbiAgICBQT1BVUF9CTE9DS0VEOiAnYXV0aC9wb3B1cC1ibG9ja2VkJyxcclxuICAgIFBPUFVQX0NMT1NFRF9CWV9VU0VSOiAnYXV0aC9wb3B1cC1jbG9zZWQtYnktdXNlcicsXHJcbiAgICBQUk9WSURFUl9BTFJFQURZX0xJTktFRDogJ2F1dGgvcHJvdmlkZXItYWxyZWFkeS1saW5rZWQnLFxyXG4gICAgUVVPVEFfRVhDRUVERUQ6ICdhdXRoL3F1b3RhLWV4Y2VlZGVkJyxcclxuICAgIFJFRElSRUNUX0NBTkNFTExFRF9CWV9VU0VSOiAnYXV0aC9yZWRpcmVjdC1jYW5jZWxsZWQtYnktdXNlcicsXHJcbiAgICBSRURJUkVDVF9PUEVSQVRJT05fUEVORElORzogJ2F1dGgvcmVkaXJlY3Qtb3BlcmF0aW9uLXBlbmRpbmcnLFxyXG4gICAgUkVKRUNURURfQ1JFREVOVElBTDogJ2F1dGgvcmVqZWN0ZWQtY3JlZGVudGlhbCcsXHJcbiAgICBTRUNPTkRfRkFDVE9SX0FMUkVBRFlfRU5ST0xMRUQ6ICdhdXRoL3NlY29uZC1mYWN0b3ItYWxyZWFkeS1pbi11c2UnLFxyXG4gICAgU0VDT05EX0ZBQ1RPUl9MSU1JVF9FWENFRURFRDogJ2F1dGgvbWF4aW11bS1zZWNvbmQtZmFjdG9yLWNvdW50LWV4Y2VlZGVkJyxcclxuICAgIFRFTkFOVF9JRF9NSVNNQVRDSDogJ2F1dGgvdGVuYW50LWlkLW1pc21hdGNoJyxcclxuICAgIFRJTUVPVVQ6ICdhdXRoL3RpbWVvdXQnLFxyXG4gICAgVE9LRU5fRVhQSVJFRDogJ2F1dGgvdXNlci10b2tlbi1leHBpcmVkJyxcclxuICAgIFRPT19NQU5ZX0FUVEVNUFRTX1RSWV9MQVRFUjogJ2F1dGgvdG9vLW1hbnktcmVxdWVzdHMnLFxyXG4gICAgVU5BVVRIT1JJWkVEX0RPTUFJTjogJ2F1dGgvdW5hdXRob3JpemVkLWNvbnRpbnVlLXVyaScsXHJcbiAgICBVTlNVUFBPUlRFRF9GSVJTVF9GQUNUT1I6ICdhdXRoL3Vuc3VwcG9ydGVkLWZpcnN0LWZhY3RvcicsXHJcbiAgICBVTlNVUFBPUlRFRF9QRVJTSVNURU5DRTogJ2F1dGgvdW5zdXBwb3J0ZWQtcGVyc2lzdGVuY2UtdHlwZScsXHJcbiAgICBVTlNVUFBPUlRFRF9URU5BTlRfT1BFUkFUSU9OOiAnYXV0aC91bnN1cHBvcnRlZC10ZW5hbnQtb3BlcmF0aW9uJyxcclxuICAgIFVOVkVSSUZJRURfRU1BSUw6ICdhdXRoL3VudmVyaWZpZWQtZW1haWwnLFxyXG4gICAgVVNFUl9DQU5DRUxMRUQ6ICdhdXRoL3VzZXItY2FuY2VsbGVkJyxcclxuICAgIFVTRVJfREVMRVRFRDogJ2F1dGgvdXNlci1ub3QtZm91bmQnLFxyXG4gICAgVVNFUl9ESVNBQkxFRDogJ2F1dGgvdXNlci1kaXNhYmxlZCcsXHJcbiAgICBVU0VSX01JU01BVENIOiAnYXV0aC91c2VyLW1pc21hdGNoJyxcclxuICAgIFVTRVJfU0lHTkVEX09VVDogJ2F1dGgvdXNlci1zaWduZWQtb3V0JyxcclxuICAgIFdFQUtfUEFTU1dPUkQ6ICdhdXRoL3dlYWstcGFzc3dvcmQnLFxyXG4gICAgV0VCX1NUT1JBR0VfVU5TVVBQT1JURUQ6ICdhdXRoL3dlYi1zdG9yYWdlLXVuc3VwcG9ydGVkJyxcclxuICAgIEFMUkVBRFlfSU5JVElBTElaRUQ6ICdhdXRoL2FscmVhZHktaW5pdGlhbGl6ZWQnXHJcbn07XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmNvbnN0IGxvZ0NsaWVudCA9IG5ldyBMb2dnZXIoJ0BmaXJlYmFzZS9hdXRoJyk7XHJcbmZ1bmN0aW9uIF9sb2dFcnJvcihtc2csIC4uLmFyZ3MpIHtcclxuICAgIGlmIChsb2dDbGllbnQubG9nTGV2ZWwgPD0gTG9nTGV2ZWwuRVJST1IpIHtcclxuICAgICAgICBsb2dDbGllbnQuZXJyb3IoYEF1dGggKCR7U0RLX1ZFUlNJT059KTogJHttc2d9YCwgLi4uYXJncyk7XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuZnVuY3Rpb24gX2ZhaWwoYXV0aE9yQ29kZSwgLi4ucmVzdCkge1xyXG4gICAgdGhyb3cgY3JlYXRlRXJyb3JJbnRlcm5hbChhdXRoT3JDb2RlLCAuLi5yZXN0KTtcclxufVxyXG5mdW5jdGlvbiBfY3JlYXRlRXJyb3IoYXV0aE9yQ29kZSwgLi4ucmVzdCkge1xyXG4gICAgcmV0dXJuIGNyZWF0ZUVycm9ySW50ZXJuYWwoYXV0aE9yQ29kZSwgLi4ucmVzdCk7XHJcbn1cclxuZnVuY3Rpb24gY3JlYXRlRXJyb3JJbnRlcm5hbChhdXRoT3JDb2RlLCAuLi5yZXN0KSB7XHJcbiAgICBpZiAodHlwZW9mIGF1dGhPckNvZGUgIT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgY29uc3QgY29kZSA9IHJlc3RbMF07XHJcbiAgICAgICAgY29uc3QgZnVsbFBhcmFtcyA9IFsuLi5yZXN0LnNsaWNlKDEpXTtcclxuICAgICAgICBpZiAoZnVsbFBhcmFtc1swXSkge1xyXG4gICAgICAgICAgICBmdWxsUGFyYW1zWzBdLmFwcE5hbWUgPSBhdXRoT3JDb2RlLm5hbWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBhdXRoT3JDb2RlLl9lcnJvckZhY3RvcnkuY3JlYXRlKGNvZGUsIC4uLmZ1bGxQYXJhbXMpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIF9ERUZBVUxUX0FVVEhfRVJST1JfRkFDVE9SWS5jcmVhdGUoYXV0aE9yQ29kZSwgLi4ucmVzdCk7XHJcbn1cclxuZnVuY3Rpb24gX2Fzc2VydChhc3NlcnRpb24sIGF1dGhPckNvZGUsIC4uLnJlc3QpIHtcclxuICAgIGlmICghYXNzZXJ0aW9uKSB7XHJcbiAgICAgICAgdGhyb3cgY3JlYXRlRXJyb3JJbnRlcm5hbChhdXRoT3JDb2RlLCAuLi5yZXN0KTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogVW5jb25kaXRpb25hbGx5IGZhaWxzLCB0aHJvd2luZyBhbiBpbnRlcm5hbCBlcnJvciB3aXRoIHRoZSBnaXZlbiBtZXNzYWdlLlxyXG4gKlxyXG4gKiBAcGFyYW0gZmFpbHVyZSB0eXBlIG9mIGZhaWx1cmUgZW5jb3VudGVyZWRcclxuICogQHRocm93cyBFcnJvclxyXG4gKi9cclxuZnVuY3Rpb24gZGVidWdGYWlsKGZhaWx1cmUpIHtcclxuICAgIC8vIExvZyB0aGUgZmFpbHVyZSBpbiBhZGRpdGlvbiB0byB0aHJvdyBhbiBleGNlcHRpb24sIGp1c3QgaW4gY2FzZSB0aGVcclxuICAgIC8vIGV4Y2VwdGlvbiBpcyBzd2FsbG93ZWQuXHJcbiAgICBjb25zdCBtZXNzYWdlID0gYElOVEVSTkFMIEFTU0VSVElPTiBGQUlMRUQ6IGAgKyBmYWlsdXJlO1xyXG4gICAgX2xvZ0Vycm9yKG1lc3NhZ2UpO1xyXG4gICAgLy8gTk9URTogV2UgZG9uJ3QgdXNlIEZpcmViYXNlRXJyb3IgaGVyZSBiZWNhdXNlIHRoZXNlIGFyZSBpbnRlcm5hbCBmYWlsdXJlc1xyXG4gICAgLy8gdGhhdCBjYW5ub3QgYmUgaGFuZGxlZCBieSB0aGUgdXNlci4gKEFsc28gaXQgd291bGQgY3JlYXRlIGEgY2lyY3VsYXJcclxuICAgIC8vIGRlcGVuZGVuY3kgYmV0d2VlbiB0aGUgZXJyb3IgYW5kIGFzc2VydCBtb2R1bGVzIHdoaWNoIGRvZXNuJ3Qgd29yay4pXHJcbiAgICB0aHJvdyBuZXcgRXJyb3IobWVzc2FnZSk7XHJcbn1cclxuLyoqXHJcbiAqIEZhaWxzIGlmIHRoZSBnaXZlbiBhc3NlcnRpb24gY29uZGl0aW9uIGlzIGZhbHNlLCB0aHJvd2luZyBhbiBFcnJvciB3aXRoIHRoZVxyXG4gKiBnaXZlbiBtZXNzYWdlIGlmIGl0IGRpZC5cclxuICpcclxuICogQHBhcmFtIGFzc2VydGlvblxyXG4gKiBAcGFyYW0gbWVzc2FnZVxyXG4gKi9cclxuZnVuY3Rpb24gZGVidWdBc3NlcnQoYXNzZXJ0aW9uLCBtZXNzYWdlKSB7XHJcbiAgICBpZiAoIWFzc2VydGlvbikge1xyXG4gICAgICAgIGRlYnVnRmFpbChtZXNzYWdlKTtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jb25zdCBpbnN0YW5jZUNhY2hlID0gbmV3IE1hcCgpO1xyXG5mdW5jdGlvbiBfZ2V0SW5zdGFuY2UoY2xzKSB7XHJcbiAgICBkZWJ1Z0Fzc2VydChjbHMgaW5zdGFuY2VvZiBGdW5jdGlvbiwgJ0V4cGVjdGVkIGEgY2xhc3MgZGVmaW5pdGlvbicpO1xyXG4gICAgbGV0IGluc3RhbmNlID0gaW5zdGFuY2VDYWNoZS5nZXQoY2xzKTtcclxuICAgIGlmIChpbnN0YW5jZSkge1xyXG4gICAgICAgIGRlYnVnQXNzZXJ0KGluc3RhbmNlIGluc3RhbmNlb2YgY2xzLCAnSW5zdGFuY2Ugc3RvcmVkIGluIGNhY2hlIG1pc21hdGNoZWQgd2l0aCBjbGFzcycpO1xyXG4gICAgICAgIHJldHVybiBpbnN0YW5jZTtcclxuICAgIH1cclxuICAgIGluc3RhbmNlID0gbmV3IGNscygpO1xyXG4gICAgaW5zdGFuY2VDYWNoZS5zZXQoY2xzLCBpbnN0YW5jZSk7XHJcbiAgICByZXR1cm4gaW5zdGFuY2U7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEluaXRpYWxpemVzIGFuIHtAbGluayBBdXRofSBpbnN0YW5jZSB3aXRoIGZpbmUtZ3JhaW5lZCBjb250cm9sIG92ZXJcclxuICoge0BsaW5rIERlcGVuZGVuY2llc30uXHJcbiAqXHJcbiAqIEByZW1hcmtzXHJcbiAqXHJcbiAqIFRoaXMgZnVuY3Rpb24gYWxsb3dzIG1vcmUgY29udHJvbCBvdmVyIHRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UgdGhhblxyXG4gKiB7QGxpbmsgZ2V0QXV0aH0uIGBnZXRBdXRoYCB1c2VzIHBsYXRmb3JtLXNwZWNpZmljIGRlZmF1bHRzIHRvIHN1cHBseVxyXG4gKiB0aGUge0BsaW5rIERlcGVuZGVuY2llc30uIEluIGdlbmVyYWwsIGBnZXRBdXRoYCBpcyB0aGUgZWFzaWVzdCB3YXkgdG9cclxuICogaW5pdGlhbGl6ZSBBdXRoIGFuZCB3b3JrcyBmb3IgbW9zdCB1c2UgY2FzZXMuIFVzZSBgaW5pdGlhbGl6ZUF1dGhgIGlmIHlvdVxyXG4gKiBuZWVkIGNvbnRyb2wgb3ZlciB3aGljaCBwZXJzaXN0ZW5jZSBsYXllciBpcyB1c2VkLCBvciB0byBtaW5pbWl6ZSBidW5kbGVcclxuICogc2l6ZSBpZiB5b3UncmUgbm90IHVzaW5nIGVpdGhlciBgc2lnbkluV2l0aFBvcHVwYCBvciBgc2lnbkluV2l0aFJlZGlyZWN0YC5cclxuICpcclxuICogRm9yIGV4YW1wbGUsIGlmIHlvdXIgYXBwIG9ubHkgdXNlcyBhbm9ueW1vdXMgYWNjb3VudHMgYW5kIHlvdSBvbmx5IHdhbnRcclxuICogYWNjb3VudHMgc2F2ZWQgZm9yIHRoZSBjdXJyZW50IHNlc3Npb24sIGluaXRpYWxpemUgYEF1dGhgIHdpdGg6XHJcbiAqXHJcbiAqIGBgYGpzXHJcbiAqIGNvbnN0IGF1dGggPSBpbml0aWFsaXplQXV0aChhcHAsIHtcclxuICogICBwZXJzaXN0ZW5jZTogYnJvd3NlclNlc3Npb25QZXJzaXN0ZW5jZSxcclxuICogICBwb3B1cFJlZGlyZWN0UmVzb2x2ZXI6IHVuZGVmaW5lZCxcclxuICogfSk7XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5mdW5jdGlvbiBpbml0aWFsaXplQXV0aChhcHAsIGRlcHMpIHtcclxuICAgIGNvbnN0IHByb3ZpZGVyID0gX2dldFByb3ZpZGVyKGFwcCwgJ2F1dGgnKTtcclxuICAgIGlmIChwcm92aWRlci5pc0luaXRpYWxpemVkKCkpIHtcclxuICAgICAgICBjb25zdCBhdXRoID0gcHJvdmlkZXIuZ2V0SW1tZWRpYXRlKCk7XHJcbiAgICAgICAgY29uc3QgaW5pdGlhbE9wdGlvbnMgPSBwcm92aWRlci5nZXRPcHRpb25zKCk7XHJcbiAgICAgICAgaWYgKGRlZXBFcXVhbChpbml0aWFsT3B0aW9ucywgZGVwcyAhPT0gbnVsbCAmJiBkZXBzICE9PSB2b2lkIDAgPyBkZXBzIDoge30pKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBhdXRoO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgX2ZhaWwoYXV0aCwgXCJhbHJlYWR5LWluaXRpYWxpemVkXCIgLyogQUxSRUFEWV9JTklUSUFMSVpFRCAqLyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgY29uc3QgYXV0aCA9IHByb3ZpZGVyLmluaXRpYWxpemUoeyBvcHRpb25zOiBkZXBzIH0pO1xyXG4gICAgcmV0dXJuIGF1dGg7XHJcbn1cclxuZnVuY3Rpb24gX2luaXRpYWxpemVBdXRoSW5zdGFuY2UoYXV0aCwgZGVwcykge1xyXG4gICAgY29uc3QgcGVyc2lzdGVuY2UgPSAoZGVwcyA9PT0gbnVsbCB8fCBkZXBzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBkZXBzLnBlcnNpc3RlbmNlKSB8fCBbXTtcclxuICAgIGNvbnN0IGhpZXJhcmNoeSA9IChBcnJheS5pc0FycmF5KHBlcnNpc3RlbmNlKSA/IHBlcnNpc3RlbmNlIDogW3BlcnNpc3RlbmNlXSkubWFwKF9nZXRJbnN0YW5jZSk7XHJcbiAgICBpZiAoZGVwcyA9PT0gbnVsbCB8fCBkZXBzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBkZXBzLmVycm9yTWFwKSB7XHJcbiAgICAgICAgYXV0aC5fdXBkYXRlRXJyb3JNYXAoZGVwcy5lcnJvck1hcCk7XHJcbiAgICB9XHJcbiAgICAvLyBUaGlzIHByb21pc2UgaXMgaW50ZW5kZWQgdG8gZmxvYXQ7IGF1dGggaW5pdGlhbGl6YXRpb24gaGFwcGVucyBpbiB0aGVcclxuICAgIC8vIGJhY2tncm91bmQsIG1lYW53aGlsZSB0aGUgYXV0aCBvYmplY3QgbWF5IGJlIHVzZWQgYnkgdGhlIGFwcC5cclxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZmxvYXRpbmctcHJvbWlzZXNcclxuICAgIGF1dGguX2luaXRpYWxpemVXaXRoUGVyc2lzdGVuY2UoaGllcmFyY2h5LCBkZXBzID09PSBudWxsIHx8IGRlcHMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGRlcHMucG9wdXBSZWRpcmVjdFJlc29sdmVyKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5mdW5jdGlvbiBfZ2V0Q3VycmVudFVybCgpIHtcclxuICAgIHZhciBfYTtcclxuICAgIHJldHVybiAodHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnICYmICgoX2EgPSBzZWxmLmxvY2F0aW9uKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuaHJlZikpIHx8ICcnO1xyXG59XHJcbmZ1bmN0aW9uIF9pc0h0dHBPckh0dHBzKCkge1xyXG4gICAgcmV0dXJuIF9nZXRDdXJyZW50U2NoZW1lKCkgPT09ICdodHRwOicgfHwgX2dldEN1cnJlbnRTY2hlbWUoKSA9PT0gJ2h0dHBzOic7XHJcbn1cclxuZnVuY3Rpb24gX2dldEN1cnJlbnRTY2hlbWUoKSB7XHJcbiAgICB2YXIgX2E7XHJcbiAgICByZXR1cm4gKHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJyAmJiAoKF9hID0gc2VsZi5sb2NhdGlvbikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnByb3RvY29sKSkgfHwgbnVsbDtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogRGV0ZXJtaW5lIHdoZXRoZXIgdGhlIGJyb3dzZXIgaXMgd29ya2luZyBvbmxpbmVcclxuICovXHJcbmZ1bmN0aW9uIF9pc09ubGluZSgpIHtcclxuICAgIGlmICh0eXBlb2YgbmF2aWdhdG9yICE9PSAndW5kZWZpbmVkJyAmJlxyXG4gICAgICAgIG5hdmlnYXRvciAmJlxyXG4gICAgICAgICdvbkxpbmUnIGluIG5hdmlnYXRvciAmJlxyXG4gICAgICAgIHR5cGVvZiBuYXZpZ2F0b3Iub25MaW5lID09PSAnYm9vbGVhbicgJiZcclxuICAgICAgICAvLyBBcHBseSBvbmx5IGZvciB0cmFkaXRpb25hbCB3ZWIgYXBwcyBhbmQgQ2hyb21lIGV4dGVuc2lvbnMuXHJcbiAgICAgICAgLy8gVGhpcyBpcyBlc3BlY2lhbGx5IHRydWUgZm9yIENvcmRvdmEgYXBwcyB3aGljaCBoYXZlIHVucmVsaWFibGVcclxuICAgICAgICAvLyBuYXZpZ2F0b3Iub25MaW5lIGJlaGF2aW9yIHVubGVzcyBjb3Jkb3ZhLXBsdWdpbi1uZXR3b3JrLWluZm9ybWF0aW9uIGlzXHJcbiAgICAgICAgLy8gaW5zdGFsbGVkIHdoaWNoIG92ZXJ3cml0ZXMgdGhlIG5hdGl2ZSBuYXZpZ2F0b3Iub25MaW5lIHZhbHVlIGFuZFxyXG4gICAgICAgIC8vIGRlZmluZXMgbmF2aWdhdG9yLmNvbm5lY3Rpb24uXHJcbiAgICAgICAgKF9pc0h0dHBPckh0dHBzKCkgfHwgaXNCcm93c2VyRXh0ZW5zaW9uKCkgfHwgJ2Nvbm5lY3Rpb24nIGluIG5hdmlnYXRvcikpIHtcclxuICAgICAgICByZXR1cm4gbmF2aWdhdG9yLm9uTGluZTtcclxuICAgIH1cclxuICAgIC8vIElmIHdlIGNhbid0IGRldGVybWluZSB0aGUgc3RhdGUsIGFzc3VtZSBpdCBpcyBvbmxpbmUuXHJcbiAgICByZXR1cm4gdHJ1ZTtcclxufVxyXG5mdW5jdGlvbiBfZ2V0VXNlckxhbmd1YWdlKCkge1xyXG4gICAgaWYgKHR5cGVvZiBuYXZpZ2F0b3IgPT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgICBjb25zdCBuYXZpZ2F0b3JMYW5ndWFnZSA9IG5hdmlnYXRvcjtcclxuICAgIHJldHVybiAoXHJcbiAgICAvLyBNb3N0IHJlbGlhYmxlLCBidXQgb25seSBzdXBwb3J0ZWQgaW4gQ2hyb21lL0ZpcmVmb3guXHJcbiAgICAobmF2aWdhdG9yTGFuZ3VhZ2UubGFuZ3VhZ2VzICYmIG5hdmlnYXRvckxhbmd1YWdlLmxhbmd1YWdlc1swXSkgfHxcclxuICAgICAgICAvLyBTdXBwb3J0ZWQgaW4gbW9zdCBicm93c2VycywgYnV0IHJldHVybnMgdGhlIGxhbmd1YWdlIG9mIHRoZSBicm93c2VyXHJcbiAgICAgICAgLy8gVUksIG5vdCB0aGUgbGFuZ3VhZ2Ugc2V0IGluIGJyb3dzZXIgc2V0dGluZ3MuXHJcbiAgICAgICAgbmF2aWdhdG9yTGFuZ3VhZ2UubGFuZ3VhZ2UgfHxcclxuICAgICAgICAvLyBDb3VsZG4ndCBkZXRlcm1pbmUgbGFuZ3VhZ2UuXHJcbiAgICAgICAgbnVsbCk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEEgc3RydWN0dXJlIHRvIGhlbHAgcGljayBiZXR3ZWVuIGEgcmFuZ2Ugb2YgbG9uZyBhbmQgc2hvcnQgZGVsYXkgZHVyYXRpb25zXHJcbiAqIGRlcGVuZGluZyBvbiB0aGUgY3VycmVudCBlbnZpcm9ubWVudC4gSW4gZ2VuZXJhbCwgdGhlIGxvbmcgZGVsYXkgaXMgdXNlZCBmb3JcclxuICogbW9iaWxlIGVudmlyb25tZW50cyB3aGVyZWFzIHNob3J0IGRlbGF5cyBhcmUgdXNlZCBmb3IgZGVza3RvcCBlbnZpcm9ubWVudHMuXHJcbiAqL1xyXG5jbGFzcyBEZWxheSB7XHJcbiAgICBjb25zdHJ1Y3RvcihzaG9ydERlbGF5LCBsb25nRGVsYXkpIHtcclxuICAgICAgICB0aGlzLnNob3J0RGVsYXkgPSBzaG9ydERlbGF5O1xyXG4gICAgICAgIHRoaXMubG9uZ0RlbGF5ID0gbG9uZ0RlbGF5O1xyXG4gICAgICAgIC8vIEludGVybmFsIGVycm9yIHdoZW4gaW1wcm9wZXJseSBpbml0aWFsaXplZC5cclxuICAgICAgICBkZWJ1Z0Fzc2VydChsb25nRGVsYXkgPiBzaG9ydERlbGF5LCAnU2hvcnQgZGVsYXkgc2hvdWxkIGJlIGxlc3MgdGhhbiBsb25nIGRlbGF5IScpO1xyXG4gICAgICAgIHRoaXMuaXNNb2JpbGUgPSBpc01vYmlsZUNvcmRvdmEoKSB8fCBpc1JlYWN0TmF0aXZlKCk7XHJcbiAgICB9XHJcbiAgICBnZXQoKSB7XHJcbiAgICAgICAgaWYgKCFfaXNPbmxpbmUoKSkge1xyXG4gICAgICAgICAgICAvLyBQaWNrIHRoZSBzaG9ydGVyIHRpbWVvdXQuXHJcbiAgICAgICAgICAgIHJldHVybiBNYXRoLm1pbig1MDAwIC8qIE9GRkxJTkUgKi8sIHRoaXMuc2hvcnREZWxheSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIElmIHJ1bm5pbmcgaW4gYSBtb2JpbGUgZW52aXJvbm1lbnQsIHJldHVybiB0aGUgbG9uZyBkZWxheSwgb3RoZXJ3aXNlXHJcbiAgICAgICAgLy8gcmV0dXJuIHRoZSBzaG9ydCBkZWxheS5cclxuICAgICAgICAvLyBUaGlzIGNvdWxkIGJlIGltcHJvdmVkIGluIHRoZSBmdXR1cmUgdG8gZHluYW1pY2FsbHkgY2hhbmdlIGJhc2VkIG9uIG90aGVyXHJcbiAgICAgICAgLy8gdmFyaWFibGVzIGluc3RlYWQgb2YganVzdCByZWFkaW5nIHRoZSBjdXJyZW50IGVudmlyb25tZW50LlxyXG4gICAgICAgIHJldHVybiB0aGlzLmlzTW9iaWxlID8gdGhpcy5sb25nRGVsYXkgOiB0aGlzLnNob3J0RGVsYXk7XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuZnVuY3Rpb24gX2VtdWxhdG9yVXJsKGNvbmZpZywgcGF0aCkge1xyXG4gICAgZGVidWdBc3NlcnQoY29uZmlnLmVtdWxhdG9yLCAnRW11bGF0b3Igc2hvdWxkIGFsd2F5cyBiZSBzZXQgaGVyZScpO1xyXG4gICAgY29uc3QgeyB1cmwgfSA9IGNvbmZpZy5lbXVsYXRvcjtcclxuICAgIGlmICghcGF0aCkge1xyXG4gICAgICAgIHJldHVybiB1cmw7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYCR7dXJsfSR7cGF0aC5zdGFydHNXaXRoKCcvJykgPyBwYXRoLnNsaWNlKDEpIDogcGF0aH1gO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmNsYXNzIEZldGNoUHJvdmlkZXIge1xyXG4gICAgc3RhdGljIGluaXRpYWxpemUoZmV0Y2hJbXBsLCBoZWFkZXJzSW1wbCwgcmVzcG9uc2VJbXBsKSB7XHJcbiAgICAgICAgdGhpcy5mZXRjaEltcGwgPSBmZXRjaEltcGw7XHJcbiAgICAgICAgaWYgKGhlYWRlcnNJbXBsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaGVhZGVyc0ltcGwgPSBoZWFkZXJzSW1wbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHJlc3BvbnNlSW1wbCkge1xyXG4gICAgICAgICAgICB0aGlzLnJlc3BvbnNlSW1wbCA9IHJlc3BvbnNlSW1wbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgZmV0Y2goKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZmV0Y2hJbXBsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZldGNoSW1wbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJyAmJiAnZmV0Y2gnIGluIHNlbGYpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHNlbGYuZmV0Y2g7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGRlYnVnRmFpbCgnQ291bGQgbm90IGZpbmQgZmV0Y2ggaW1wbGVtZW50YXRpb24sIG1ha2Ugc3VyZSB5b3UgY2FsbCBGZXRjaFByb3ZpZGVyLmluaXRpYWxpemUoKSB3aXRoIGFuIGFwcHJvcHJpYXRlIHBvbHlmaWxsJyk7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgaGVhZGVycygpIHtcclxuICAgICAgICBpZiAodGhpcy5oZWFkZXJzSW1wbCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5oZWFkZXJzSW1wbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJyAmJiAnSGVhZGVycycgaW4gc2VsZikge1xyXG4gICAgICAgICAgICByZXR1cm4gc2VsZi5IZWFkZXJzO1xyXG4gICAgICAgIH1cclxuICAgICAgICBkZWJ1Z0ZhaWwoJ0NvdWxkIG5vdCBmaW5kIEhlYWRlcnMgaW1wbGVtZW50YXRpb24sIG1ha2Ugc3VyZSB5b3UgY2FsbCBGZXRjaFByb3ZpZGVyLmluaXRpYWxpemUoKSB3aXRoIGFuIGFwcHJvcHJpYXRlIHBvbHlmaWxsJyk7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgcmVzcG9uc2UoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMucmVzcG9uc2VJbXBsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJlc3BvbnNlSW1wbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJyAmJiAnUmVzcG9uc2UnIGluIHNlbGYpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHNlbGYuUmVzcG9uc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGRlYnVnRmFpbCgnQ291bGQgbm90IGZpbmQgUmVzcG9uc2UgaW1wbGVtZW50YXRpb24sIG1ha2Ugc3VyZSB5b3UgY2FsbCBGZXRjaFByb3ZpZGVyLmluaXRpYWxpemUoKSB3aXRoIGFuIGFwcHJvcHJpYXRlIHBvbHlmaWxsJyk7XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIE1hcCBmcm9tIGVycm9ycyByZXR1cm5lZCBieSB0aGUgc2VydmVyIHRvIGVycm9ycyB0byBkZXZlbG9wZXIgdmlzaWJsZSBlcnJvcnNcclxuICovXHJcbmNvbnN0IFNFUlZFUl9FUlJPUl9NQVAgPSB7XHJcbiAgICAvLyBDdXN0b20gdG9rZW4gZXJyb3JzLlxyXG4gICAgW1wiQ1JFREVOVElBTF9NSVNNQVRDSFwiIC8qIENSRURFTlRJQUxfTUlTTUFUQ0ggKi9dOiBcImN1c3RvbS10b2tlbi1taXNtYXRjaFwiIC8qIENSRURFTlRJQUxfTUlTTUFUQ0ggKi8sXHJcbiAgICAvLyBUaGlzIGNhbiBvbmx5IGhhcHBlbiBpZiB0aGUgU0RLIHNlbmRzIGEgYmFkIHJlcXVlc3QuXHJcbiAgICBbXCJNSVNTSU5HX0NVU1RPTV9UT0tFTlwiIC8qIE1JU1NJTkdfQ1VTVE9NX1RPS0VOICovXTogXCJpbnRlcm5hbC1lcnJvclwiIC8qIElOVEVSTkFMX0VSUk9SICovLFxyXG4gICAgLy8gQ3JlYXRlIEF1dGggVVJJIGVycm9ycy5cclxuICAgIFtcIklOVkFMSURfSURFTlRJRklFUlwiIC8qIElOVkFMSURfSURFTlRJRklFUiAqL106IFwiaW52YWxpZC1lbWFpbFwiIC8qIElOVkFMSURfRU1BSUwgKi8sXHJcbiAgICAvLyBUaGlzIGNhbiBvbmx5IGhhcHBlbiBpZiB0aGUgU0RLIHNlbmRzIGEgYmFkIHJlcXVlc3QuXHJcbiAgICBbXCJNSVNTSU5HX0NPTlRJTlVFX1VSSVwiIC8qIE1JU1NJTkdfQ09OVElOVUVfVVJJICovXTogXCJpbnRlcm5hbC1lcnJvclwiIC8qIElOVEVSTkFMX0VSUk9SICovLFxyXG4gICAgLy8gU2lnbiBpbiB3aXRoIGVtYWlsIGFuZCBwYXNzd29yZCBlcnJvcnMgKHNvbWUgYXBwbHkgdG8gc2lnbiB1cCB0b28pLlxyXG4gICAgW1wiSU5WQUxJRF9QQVNTV09SRFwiIC8qIElOVkFMSURfUEFTU1dPUkQgKi9dOiBcIndyb25nLXBhc3N3b3JkXCIgLyogSU5WQUxJRF9QQVNTV09SRCAqLyxcclxuICAgIC8vIFRoaXMgY2FuIG9ubHkgaGFwcGVuIGlmIHRoZSBTREsgc2VuZHMgYSBiYWQgcmVxdWVzdC5cclxuICAgIFtcIk1JU1NJTkdfUEFTU1dPUkRcIiAvKiBNSVNTSU5HX1BBU1NXT1JEICovXTogXCJpbnRlcm5hbC1lcnJvclwiIC8qIElOVEVSTkFMX0VSUk9SICovLFxyXG4gICAgLy8gU2lnbiB1cCB3aXRoIGVtYWlsIGFuZCBwYXNzd29yZCBlcnJvcnMuXHJcbiAgICBbXCJFTUFJTF9FWElTVFNcIiAvKiBFTUFJTF9FWElTVFMgKi9dOiBcImVtYWlsLWFscmVhZHktaW4tdXNlXCIgLyogRU1BSUxfRVhJU1RTICovLFxyXG4gICAgW1wiUEFTU1dPUkRfTE9HSU5fRElTQUJMRURcIiAvKiBQQVNTV09SRF9MT0dJTl9ESVNBQkxFRCAqL106IFwib3BlcmF0aW9uLW5vdC1hbGxvd2VkXCIgLyogT1BFUkFUSU9OX05PVF9BTExPV0VEICovLFxyXG4gICAgLy8gVmVyaWZ5IGFzc2VydGlvbiBmb3Igc2lnbiBpbiB3aXRoIGNyZWRlbnRpYWwgZXJyb3JzOlxyXG4gICAgW1wiSU5WQUxJRF9JRFBfUkVTUE9OU0VcIiAvKiBJTlZBTElEX0lEUF9SRVNQT05TRSAqL106IFwiaW52YWxpZC1jcmVkZW50aWFsXCIgLyogSU5WQUxJRF9JRFBfUkVTUE9OU0UgKi8sXHJcbiAgICBbXCJJTlZBTElEX1BFTkRJTkdfVE9LRU5cIiAvKiBJTlZBTElEX1BFTkRJTkdfVE9LRU4gKi9dOiBcImludmFsaWQtY3JlZGVudGlhbFwiIC8qIElOVkFMSURfSURQX1JFU1BPTlNFICovLFxyXG4gICAgW1wiRkVERVJBVEVEX1VTRVJfSURfQUxSRUFEWV9MSU5LRURcIiAvKiBGRURFUkFURURfVVNFUl9JRF9BTFJFQURZX0xJTktFRCAqL106IFwiY3JlZGVudGlhbC1hbHJlYWR5LWluLXVzZVwiIC8qIENSRURFTlRJQUxfQUxSRUFEWV9JTl9VU0UgKi8sXHJcbiAgICAvLyBUaGlzIGNhbiBvbmx5IGhhcHBlbiBpZiB0aGUgU0RLIHNlbmRzIGEgYmFkIHJlcXVlc3QuXHJcbiAgICBbXCJNSVNTSU5HX1JFUV9UWVBFXCIgLyogTUlTU0lOR19SRVFfVFlQRSAqL106IFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyxcclxuICAgIC8vIFNlbmQgUGFzc3dvcmQgcmVzZXQgZW1haWwgZXJyb3JzOlxyXG4gICAgW1wiRU1BSUxfTk9UX0ZPVU5EXCIgLyogRU1BSUxfTk9UX0ZPVU5EICovXTogXCJ1c2VyLW5vdC1mb3VuZFwiIC8qIFVTRVJfREVMRVRFRCAqLyxcclxuICAgIFtcIlJFU0VUX1BBU1NXT1JEX0VYQ0VFRF9MSU1JVFwiIC8qIFJFU0VUX1BBU1NXT1JEX0VYQ0VFRF9MSU1JVCAqL106IFwidG9vLW1hbnktcmVxdWVzdHNcIiAvKiBUT09fTUFOWV9BVFRFTVBUU19UUllfTEFURVIgKi8sXHJcbiAgICBbXCJFWFBJUkVEX09PQl9DT0RFXCIgLyogRVhQSVJFRF9PT0JfQ09ERSAqL106IFwiZXhwaXJlZC1hY3Rpb24tY29kZVwiIC8qIEVYUElSRURfT09CX0NPREUgKi8sXHJcbiAgICBbXCJJTlZBTElEX09PQl9DT0RFXCIgLyogSU5WQUxJRF9PT0JfQ09ERSAqL106IFwiaW52YWxpZC1hY3Rpb24tY29kZVwiIC8qIElOVkFMSURfT09CX0NPREUgKi8sXHJcbiAgICAvLyBUaGlzIGNhbiBvbmx5IGhhcHBlbiBpZiB0aGUgU0RLIHNlbmRzIGEgYmFkIHJlcXVlc3QuXHJcbiAgICBbXCJNSVNTSU5HX09PQl9DT0RFXCIgLyogTUlTU0lOR19PT0JfQ09ERSAqL106IFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyxcclxuICAgIC8vIE9wZXJhdGlvbnMgdGhhdCByZXF1aXJlIElEIHRva2VuIGluIHJlcXVlc3Q6XHJcbiAgICBbXCJDUkVERU5USUFMX1RPT19PTERfTE9HSU5fQUdBSU5cIiAvKiBDUkVERU5USUFMX1RPT19PTERfTE9HSU5fQUdBSU4gKi9dOiBcInJlcXVpcmVzLXJlY2VudC1sb2dpblwiIC8qIENSRURFTlRJQUxfVE9PX09MRF9MT0dJTl9BR0FJTiAqLyxcclxuICAgIFtcIklOVkFMSURfSURfVE9LRU5cIiAvKiBJTlZBTElEX0lEX1RPS0VOICovXTogXCJpbnZhbGlkLXVzZXItdG9rZW5cIiAvKiBJTlZBTElEX0FVVEggKi8sXHJcbiAgICBbXCJUT0tFTl9FWFBJUkVEXCIgLyogVE9LRU5fRVhQSVJFRCAqL106IFwidXNlci10b2tlbi1leHBpcmVkXCIgLyogVE9LRU5fRVhQSVJFRCAqLyxcclxuICAgIFtcIlVTRVJfTk9UX0ZPVU5EXCIgLyogVVNFUl9OT1RfRk9VTkQgKi9dOiBcInVzZXItdG9rZW4tZXhwaXJlZFwiIC8qIFRPS0VOX0VYUElSRUQgKi8sXHJcbiAgICAvLyBPdGhlciBlcnJvcnMuXHJcbiAgICBbXCJUT09fTUFOWV9BVFRFTVBUU19UUllfTEFURVJcIiAvKiBUT09fTUFOWV9BVFRFTVBUU19UUllfTEFURVIgKi9dOiBcInRvby1tYW55LXJlcXVlc3RzXCIgLyogVE9PX01BTllfQVRURU1QVFNfVFJZX0xBVEVSICovLFxyXG4gICAgLy8gUGhvbmUgQXV0aCByZWxhdGVkIGVycm9ycy5cclxuICAgIFtcIklOVkFMSURfQ09ERVwiIC8qIElOVkFMSURfQ09ERSAqL106IFwiaW52YWxpZC12ZXJpZmljYXRpb24tY29kZVwiIC8qIElOVkFMSURfQ09ERSAqLyxcclxuICAgIFtcIklOVkFMSURfU0VTU0lPTl9JTkZPXCIgLyogSU5WQUxJRF9TRVNTSU9OX0lORk8gKi9dOiBcImludmFsaWQtdmVyaWZpY2F0aW9uLWlkXCIgLyogSU5WQUxJRF9TRVNTSU9OX0lORk8gKi8sXHJcbiAgICBbXCJJTlZBTElEX1RFTVBPUkFSWV9QUk9PRlwiIC8qIElOVkFMSURfVEVNUE9SQVJZX1BST09GICovXTogXCJpbnZhbGlkLWNyZWRlbnRpYWxcIiAvKiBJTlZBTElEX0lEUF9SRVNQT05TRSAqLyxcclxuICAgIFtcIk1JU1NJTkdfU0VTU0lPTl9JTkZPXCIgLyogTUlTU0lOR19TRVNTSU9OX0lORk8gKi9dOiBcIm1pc3NpbmctdmVyaWZpY2F0aW9uLWlkXCIgLyogTUlTU0lOR19TRVNTSU9OX0lORk8gKi8sXHJcbiAgICBbXCJTRVNTSU9OX0VYUElSRURcIiAvKiBTRVNTSU9OX0VYUElSRUQgKi9dOiBcImNvZGUtZXhwaXJlZFwiIC8qIENPREVfRVhQSVJFRCAqLyxcclxuICAgIC8vIE90aGVyIGFjdGlvbiBjb2RlIGVycm9ycyB3aGVuIGFkZGl0aW9uYWwgc2V0dGluZ3MgcGFzc2VkLlxyXG4gICAgLy8gTUlTU0lOR19DT05USU5VRV9VUkkgaXMgZ2V0dGluZyBtYXBwZWQgdG8gSU5URVJOQUxfRVJST1IgYWJvdmUuXHJcbiAgICAvLyBUaGlzIGlzIE9LIGFzIHRoaXMgZXJyb3Igd2lsbCBiZSBjYXVnaHQgYnkgY2xpZW50IHNpZGUgdmFsaWRhdGlvbi5cclxuICAgIFtcIk1JU1NJTkdfQU5EUk9JRF9QQUNLQUdFX05BTUVcIiAvKiBNSVNTSU5HX0FORFJPSURfUEFDS0FHRV9OQU1FICovXTogXCJtaXNzaW5nLWFuZHJvaWQtcGtnLW5hbWVcIiAvKiBNSVNTSU5HX0FORFJPSURfUEFDS0FHRV9OQU1FICovLFxyXG4gICAgW1wiVU5BVVRIT1JJWkVEX0RPTUFJTlwiIC8qIFVOQVVUSE9SSVpFRF9ET01BSU4gKi9dOiBcInVuYXV0aG9yaXplZC1jb250aW51ZS11cmlcIiAvKiBVTkFVVEhPUklaRURfRE9NQUlOICovLFxyXG4gICAgLy8gZ2V0UHJvamVjdENvbmZpZyBlcnJvcnMgd2hlbiBjbGllbnRJZCBpcyBwYXNzZWQuXHJcbiAgICBbXCJJTlZBTElEX09BVVRIX0NMSUVOVF9JRFwiIC8qIElOVkFMSURfT0FVVEhfQ0xJRU5UX0lEICovXTogXCJpbnZhbGlkLW9hdXRoLWNsaWVudC1pZFwiIC8qIElOVkFMSURfT0FVVEhfQ0xJRU5UX0lEICovLFxyXG4gICAgLy8gVXNlciBhY3Rpb25zIChzaWduLXVwIG9yIGRlbGV0aW9uKSBkaXNhYmxlZCBlcnJvcnMuXHJcbiAgICBbXCJBRE1JTl9PTkxZX09QRVJBVElPTlwiIC8qIEFETUlOX09OTFlfT1BFUkFUSU9OICovXTogXCJhZG1pbi1yZXN0cmljdGVkLW9wZXJhdGlvblwiIC8qIEFETUlOX09OTFlfT1BFUkFUSU9OICovLFxyXG4gICAgLy8gTXVsdGkgZmFjdG9yIHJlbGF0ZWQgZXJyb3JzLlxyXG4gICAgW1wiSU5WQUxJRF9NRkFfUEVORElOR19DUkVERU5USUFMXCIgLyogSU5WQUxJRF9NRkFfUEVORElOR19DUkVERU5USUFMICovXTogXCJpbnZhbGlkLW11bHRpLWZhY3Rvci1zZXNzaW9uXCIgLyogSU5WQUxJRF9NRkFfU0VTU0lPTiAqLyxcclxuICAgIFtcIk1GQV9FTlJPTExNRU5UX05PVF9GT1VORFwiIC8qIE1GQV9FTlJPTExNRU5UX05PVF9GT1VORCAqL106IFwibXVsdGktZmFjdG9yLWluZm8tbm90LWZvdW5kXCIgLyogTUZBX0lORk9fTk9UX0ZPVU5EICovLFxyXG4gICAgW1wiTUlTU0lOR19NRkFfRU5ST0xMTUVOVF9JRFwiIC8qIE1JU1NJTkdfTUZBX0VOUk9MTE1FTlRfSUQgKi9dOiBcIm1pc3NpbmctbXVsdGktZmFjdG9yLWluZm9cIiAvKiBNSVNTSU5HX01GQV9JTkZPICovLFxyXG4gICAgW1wiTUlTU0lOR19NRkFfUEVORElOR19DUkVERU5USUFMXCIgLyogTUlTU0lOR19NRkFfUEVORElOR19DUkVERU5USUFMICovXTogXCJtaXNzaW5nLW11bHRpLWZhY3Rvci1zZXNzaW9uXCIgLyogTUlTU0lOR19NRkFfU0VTU0lPTiAqLyxcclxuICAgIFtcIlNFQ09ORF9GQUNUT1JfRVhJU1RTXCIgLyogU0VDT05EX0ZBQ1RPUl9FWElTVFMgKi9dOiBcInNlY29uZC1mYWN0b3ItYWxyZWFkeS1pbi11c2VcIiAvKiBTRUNPTkRfRkFDVE9SX0FMUkVBRFlfRU5ST0xMRUQgKi8sXHJcbiAgICBbXCJTRUNPTkRfRkFDVE9SX0xJTUlUX0VYQ0VFREVEXCIgLyogU0VDT05EX0ZBQ1RPUl9MSU1JVF9FWENFRURFRCAqL106IFwibWF4aW11bS1zZWNvbmQtZmFjdG9yLWNvdW50LWV4Y2VlZGVkXCIgLyogU0VDT05EX0ZBQ1RPUl9MSU1JVF9FWENFRURFRCAqL1xyXG59O1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jb25zdCBERUZBVUxUX0FQSV9USU1FT1VUX01TID0gbmV3IERlbGF5KDMwMDAwLCA2MDAwMCk7XHJcbmZ1bmN0aW9uIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCByZXF1ZXN0KSB7XHJcbiAgICBpZiAoYXV0aC50ZW5hbnRJZCAmJiAhcmVxdWVzdC50ZW5hbnRJZCkge1xyXG4gICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIHJlcXVlc3QpLCB7IHRlbmFudElkOiBhdXRoLnRlbmFudElkIH0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlcXVlc3Q7XHJcbn1cclxuYXN5bmMgZnVuY3Rpb24gX3BlcmZvcm1BcGlSZXF1ZXN0KGF1dGgsIG1ldGhvZCwgcGF0aCwgcmVxdWVzdCwgY3VzdG9tRXJyb3JNYXAgPSB7fSkge1xyXG4gICAgcmV0dXJuIF9wZXJmb3JtRmV0Y2hXaXRoRXJyb3JIYW5kbGluZyhhdXRoLCBjdXN0b21FcnJvck1hcCwgKCkgPT4ge1xyXG4gICAgICAgIGxldCBib2R5ID0ge307XHJcbiAgICAgICAgbGV0IHBhcmFtcyA9IHt9O1xyXG4gICAgICAgIGlmIChyZXF1ZXN0KSB7XHJcbiAgICAgICAgICAgIGlmIChtZXRob2QgPT09IFwiR0VUXCIgLyogR0VUICovKSB7XHJcbiAgICAgICAgICAgICAgICBwYXJhbXMgPSByZXF1ZXN0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgYm9keSA9IHtcclxuICAgICAgICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShyZXF1ZXN0KVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBxdWVyeSA9IHF1ZXJ5c3RyaW5nKE9iamVjdC5hc3NpZ24oeyBrZXk6IGF1dGguY29uZmlnLmFwaUtleSB9LCBwYXJhbXMpKS5zbGljZSgxKTtcclxuICAgICAgICBjb25zdCBoZWFkZXJzID0gbmV3IChGZXRjaFByb3ZpZGVyLmhlYWRlcnMoKSkoKTtcclxuICAgICAgICBoZWFkZXJzLnNldChcIkNvbnRlbnQtVHlwZVwiIC8qIENPTlRFTlRfVFlQRSAqLywgJ2FwcGxpY2F0aW9uL2pzb24nKTtcclxuICAgICAgICBoZWFkZXJzLnNldChcIlgtQ2xpZW50LVZlcnNpb25cIiAvKiBYX0NMSUVOVF9WRVJTSU9OICovLCBhdXRoLl9nZXRTZGtDbGllbnRWZXJzaW9uKCkpO1xyXG4gICAgICAgIGlmIChhdXRoLmxhbmd1YWdlQ29kZSkge1xyXG4gICAgICAgICAgICBoZWFkZXJzLnNldChcIlgtRmlyZWJhc2UtTG9jYWxlXCIgLyogWF9GSVJFQkFTRV9MT0NBTEUgKi8sIGF1dGgubGFuZ3VhZ2VDb2RlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIEZldGNoUHJvdmlkZXIuZmV0Y2goKShfZ2V0RmluYWxUYXJnZXQoYXV0aCwgYXV0aC5jb25maWcuYXBpSG9zdCwgcGF0aCwgcXVlcnkpLCBPYmplY3QuYXNzaWduKHsgbWV0aG9kLFxyXG4gICAgICAgICAgICBoZWFkZXJzLCByZWZlcnJlclBvbGljeTogJ25vLXJlZmVycmVyJyB9LCBib2R5KSk7XHJcbiAgICB9KTtcclxufVxyXG5hc3luYyBmdW5jdGlvbiBfcGVyZm9ybUZldGNoV2l0aEVycm9ySGFuZGxpbmcoYXV0aCwgY3VzdG9tRXJyb3JNYXAsIGZldGNoRm4pIHtcclxuICAgIGF1dGguX2NhbkluaXRFbXVsYXRvciA9IGZhbHNlO1xyXG4gICAgY29uc3QgZXJyb3JNYXAgPSBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIFNFUlZFUl9FUlJPUl9NQVApLCBjdXN0b21FcnJvck1hcCk7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IG5ldHdvcmtUaW1lb3V0ID0gbmV3IE5ldHdvcmtUaW1lb3V0KGF1dGgpO1xyXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgUHJvbWlzZS5yYWNlKFtcclxuICAgICAgICAgICAgZmV0Y2hGbigpLFxyXG4gICAgICAgICAgICBuZXR3b3JrVGltZW91dC5wcm9taXNlXHJcbiAgICAgICAgXSk7XHJcbiAgICAgICAgLy8gSWYgd2UndmUgcmVhY2hlZCB0aGlzIHBvaW50LCB0aGUgZmV0Y2ggc3VjY2VlZGVkIGFuZCB0aGUgbmV0d29ya1RpbWVvdXRcclxuICAgICAgICAvLyBkaWRuJ3QgdGhyb3c7IGNsZWFyIHRoZSBuZXR3b3JrIHRpbWVvdXQgZGVsYXkgc28gdGhhdCBOb2RlIHdvbid0IGhhbmdcclxuICAgICAgICBuZXR3b3JrVGltZW91dC5jbGVhck5ldHdvcmtUaW1lb3V0KCk7XHJcbiAgICAgICAgY29uc3QganNvbiA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcclxuICAgICAgICBpZiAoJ25lZWRDb25maXJtYXRpb24nIGluIGpzb24pIHtcclxuICAgICAgICAgICAgdGhyb3cgX21ha2VUYWdnZWRFcnJvcihhdXRoLCBcImFjY291bnQtZXhpc3RzLXdpdGgtZGlmZmVyZW50LWNyZWRlbnRpYWxcIiAvKiBORUVEX0NPTkZJUk1BVElPTiAqLywganNvbik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChyZXNwb25zZS5vayAmJiAhKCdlcnJvck1lc3NhZ2UnIGluIGpzb24pKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBqc29uO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gcmVzcG9uc2Uub2sgPyBqc29uLmVycm9yTWVzc2FnZSA6IGpzb24uZXJyb3IubWVzc2FnZTtcclxuICAgICAgICAgICAgY29uc3Qgc2VydmVyRXJyb3JDb2RlID0gZXJyb3JNZXNzYWdlLnNwbGl0KCcgOiAnKVswXTtcclxuICAgICAgICAgICAgaWYgKHNlcnZlckVycm9yQ29kZSA9PT0gXCJGRURFUkFURURfVVNFUl9JRF9BTFJFQURZX0xJTktFRFwiIC8qIEZFREVSQVRFRF9VU0VSX0lEX0FMUkVBRFlfTElOS0VEICovKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBfbWFrZVRhZ2dlZEVycm9yKGF1dGgsIFwiY3JlZGVudGlhbC1hbHJlYWR5LWluLXVzZVwiIC8qIENSRURFTlRJQUxfQUxSRUFEWV9JTl9VU0UgKi8sIGpzb24pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHNlcnZlckVycm9yQ29kZSA9PT0gXCJFTUFJTF9FWElTVFNcIiAvKiBFTUFJTF9FWElTVFMgKi8pIHtcclxuICAgICAgICAgICAgICAgIHRocm93IF9tYWtlVGFnZ2VkRXJyb3IoYXV0aCwgXCJlbWFpbC1hbHJlYWR5LWluLXVzZVwiIC8qIEVNQUlMX0VYSVNUUyAqLywganNvbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgYXV0aEVycm9yID0gZXJyb3JNYXBbc2VydmVyRXJyb3JDb2RlXSB8fFxyXG4gICAgICAgICAgICAgICAgc2VydmVyRXJyb3JDb2RlXHJcbiAgICAgICAgICAgICAgICAgICAgLnRvTG93ZXJDYXNlKClcclxuICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvW19cXHNdKy9nLCAnLScpO1xyXG4gICAgICAgICAgICBfZmFpbChhdXRoLCBhdXRoRXJyb3IpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBGaXJlYmFzZUVycm9yKSB7XHJcbiAgICAgICAgICAgIHRocm93IGU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIF9mYWlsKGF1dGgsIFwibmV0d29yay1yZXF1ZXN0LWZhaWxlZFwiIC8qIE5FVFdPUktfUkVRVUVTVF9GQUlMRUQgKi8pO1xyXG4gICAgfVxyXG59XHJcbmFzeW5jIGZ1bmN0aW9uIF9wZXJmb3JtU2lnbkluUmVxdWVzdChhdXRoLCBtZXRob2QsIHBhdGgsIHJlcXVlc3QsIGN1c3RvbUVycm9yTWFwID0ge30pIHtcclxuICAgIGNvbnN0IHNlcnZlclJlc3BvbnNlID0gKGF3YWl0IF9wZXJmb3JtQXBpUmVxdWVzdChhdXRoLCBtZXRob2QsIHBhdGgsIHJlcXVlc3QsIGN1c3RvbUVycm9yTWFwKSk7XHJcbiAgICBpZiAoJ21mYVBlbmRpbmdDcmVkZW50aWFsJyBpbiBzZXJ2ZXJSZXNwb25zZSkge1xyXG4gICAgICAgIF9mYWlsKGF1dGgsIFwibXVsdGktZmFjdG9yLWF1dGgtcmVxdWlyZWRcIiAvKiBNRkFfUkVRVUlSRUQgKi8sIHtcclxuICAgICAgICAgICAgc2VydmVyUmVzcG9uc2VcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIHJldHVybiBzZXJ2ZXJSZXNwb25zZTtcclxufVxyXG5mdW5jdGlvbiBfZ2V0RmluYWxUYXJnZXQoYXV0aCwgaG9zdCwgcGF0aCwgcXVlcnkpIHtcclxuICAgIGNvbnN0IGJhc2UgPSBgJHtob3N0fSR7cGF0aH0/JHtxdWVyeX1gO1xyXG4gICAgaWYgKCFhdXRoLmNvbmZpZy5lbXVsYXRvcikge1xyXG4gICAgICAgIHJldHVybiBgJHthdXRoLmNvbmZpZy5hcGlTY2hlbWV9Oi8vJHtiYXNlfWA7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gX2VtdWxhdG9yVXJsKGF1dGguY29uZmlnLCBiYXNlKTtcclxufVxyXG5jbGFzcyBOZXR3b3JrVGltZW91dCB7XHJcbiAgICBjb25zdHJ1Y3RvcihhdXRoKSB7XHJcbiAgICAgICAgdGhpcy5hdXRoID0gYXV0aDtcclxuICAgICAgICAvLyBOb2RlIHRpbWVycyBhbmQgYnJvd3NlciB0aW1lcnMgYXJlIGZ1bmRhbWVudGFsbHkgaW5jb21wYXRpYmxlLCBidXQgd2VcclxuICAgICAgICAvLyBkb24ndCBjYXJlIGFib3V0IHRoZSB2YWx1ZSBoZXJlXHJcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcclxuICAgICAgICB0aGlzLnRpbWVyID0gbnVsbDtcclxuICAgICAgICB0aGlzLnByb21pc2UgPSBuZXcgUHJvbWlzZSgoXywgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMudGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZWplY3QoX2NyZWF0ZUVycm9yKHRoaXMuYXV0aCwgXCJ0aW1lb3V0XCIgLyogVElNRU9VVCAqLykpO1xyXG4gICAgICAgICAgICB9LCBERUZBVUxUX0FQSV9USU1FT1VUX01TLmdldCgpKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGNsZWFyTmV0d29ya1RpbWVvdXQoKSB7XHJcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZXIpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIF9tYWtlVGFnZ2VkRXJyb3IoYXV0aCwgY29kZSwgcmVzcG9uc2UpIHtcclxuICAgIGNvbnN0IGVycm9yUGFyYW1zID0ge1xyXG4gICAgICAgIGFwcE5hbWU6IGF1dGgubmFtZVxyXG4gICAgfTtcclxuICAgIGlmIChyZXNwb25zZS5lbWFpbCkge1xyXG4gICAgICAgIGVycm9yUGFyYW1zLmVtYWlsID0gcmVzcG9uc2UuZW1haWw7XHJcbiAgICB9XHJcbiAgICBpZiAocmVzcG9uc2UucGhvbmVOdW1iZXIpIHtcclxuICAgICAgICBlcnJvclBhcmFtcy5waG9uZU51bWJlciA9IHJlc3BvbnNlLnBob25lTnVtYmVyO1xyXG4gICAgfVxyXG4gICAgY29uc3QgZXJyb3IgPSBfY3JlYXRlRXJyb3IoYXV0aCwgY29kZSwgZXJyb3JQYXJhbXMpO1xyXG4gICAgLy8gV2Uga25vdyBjdXN0b21EYXRhIGlzIGRlZmluZWQgb24gZXJyb3IgYmVjYXVzZSBlcnJvclBhcmFtcyBpcyBkZWZpbmVkXHJcbiAgICBlcnJvci5jdXN0b21EYXRhLl90b2tlblJlc3BvbnNlID0gcmVzcG9uc2U7XHJcbiAgICByZXR1cm4gZXJyb3I7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gZGVsZXRlQWNjb3VudChhdXRoLCByZXF1ZXN0KSB7XHJcbiAgICByZXR1cm4gX3BlcmZvcm1BcGlSZXF1ZXN0KGF1dGgsIFwiUE9TVFwiIC8qIFBPU1QgKi8sIFwiL3YxL2FjY291bnRzOmRlbGV0ZVwiIC8qIERFTEVURV9BQ0NPVU5UICovLCByZXF1ZXN0KTtcclxufVxyXG5hc3luYyBmdW5jdGlvbiBkZWxldGVMaW5rZWRBY2NvdW50cyhhdXRoLCByZXF1ZXN0KSB7XHJcbiAgICByZXR1cm4gX3BlcmZvcm1BcGlSZXF1ZXN0KGF1dGgsIFwiUE9TVFwiIC8qIFBPU1QgKi8sIFwiL3YxL2FjY291bnRzOnVwZGF0ZVwiIC8qIFNFVF9BQ0NPVU5UX0lORk8gKi8sIHJlcXVlc3QpO1xyXG59XHJcbmFzeW5jIGZ1bmN0aW9uIGdldEFjY291bnRJbmZvKGF1dGgsIHJlcXVlc3QpIHtcclxuICAgIHJldHVybiBfcGVyZm9ybUFwaVJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogUE9TVCAqLywgXCIvdjEvYWNjb3VudHM6bG9va3VwXCIgLyogR0VUX0FDQ09VTlRfSU5GTyAqLywgcmVxdWVzdCk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuZnVuY3Rpb24gdXRjVGltZXN0YW1wVG9EYXRlU3RyaW5nKHV0Y1RpbWVzdGFtcCkge1xyXG4gICAgaWYgKCF1dGNUaW1lc3RhbXApIHtcclxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgfVxyXG4gICAgdHJ5IHtcclxuICAgICAgICAvLyBDb252ZXJ0IHRvIGRhdGUgb2JqZWN0LlxyXG4gICAgICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZShOdW1iZXIodXRjVGltZXN0YW1wKSk7XHJcbiAgICAgICAgLy8gVGVzdCBkYXRlIGlzIHZhbGlkLlxyXG4gICAgICAgIGlmICghaXNOYU4oZGF0ZS5nZXRUaW1lKCkpKSB7XHJcbiAgICAgICAgICAgIC8vIENvbnZlcnQgdG8gVVRDIGRhdGUgc3RyaW5nLlxyXG4gICAgICAgICAgICByZXR1cm4gZGF0ZS50b1VUQ1N0cmluZygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgLy8gRG8gbm90aGluZy4gdW5kZWZpbmVkIHdpbGwgYmUgcmV0dXJuZWQuXHJcbiAgICB9XHJcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBSZXR1cm5zIGEgSlNPTiBXZWIgVG9rZW4gKEpXVCkgdXNlZCB0byBpZGVudGlmeSB0aGUgdXNlciB0byBhIEZpcmViYXNlIHNlcnZpY2UuXHJcbiAqXHJcbiAqIEByZW1hcmtzXHJcbiAqIFJldHVybnMgdGhlIGN1cnJlbnQgdG9rZW4gaWYgaXQgaGFzIG5vdCBleHBpcmVkIG9yIGlmIGl0IHdpbGwgbm90IGV4cGlyZSBpbiB0aGUgbmV4dCBmaXZlXHJcbiAqIG1pbnV0ZXMuIE90aGVyd2lzZSwgdGhpcyB3aWxsIHJlZnJlc2ggdGhlIHRva2VuIGFuZCByZXR1cm4gYSBuZXcgb25lLlxyXG4gKlxyXG4gKiBAcGFyYW0gdXNlciAtIFRoZSB1c2VyLlxyXG4gKiBAcGFyYW0gZm9yY2VSZWZyZXNoIC0gRm9yY2UgcmVmcmVzaCByZWdhcmRsZXNzIG9mIHRva2VuIGV4cGlyYXRpb24uXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmZ1bmN0aW9uIGdldElkVG9rZW4odXNlciwgZm9yY2VSZWZyZXNoID0gZmFsc2UpIHtcclxuICAgIHJldHVybiBnZXRNb2R1bGFySW5zdGFuY2UodXNlcikuZ2V0SWRUb2tlbihmb3JjZVJlZnJlc2gpO1xyXG59XHJcbi8qKlxyXG4gKiBSZXR1cm5zIGEgZGVzZXJpYWxpemVkIEpTT04gV2ViIFRva2VuIChKV1QpIHVzZWQgdG8gaWRlbnRpdGZ5IHRoZSB1c2VyIHRvIGEgRmlyZWJhc2Ugc2VydmljZS5cclxuICpcclxuICogQHJlbWFya3NcclxuICogUmV0dXJucyB0aGUgY3VycmVudCB0b2tlbiBpZiBpdCBoYXMgbm90IGV4cGlyZWQgb3IgaWYgaXQgd2lsbCBub3QgZXhwaXJlIGluIHRoZSBuZXh0IGZpdmVcclxuICogbWludXRlcy4gT3RoZXJ3aXNlLCB0aGlzIHdpbGwgcmVmcmVzaCB0aGUgdG9rZW4gYW5kIHJldHVybiBhIG5ldyBvbmUuXHJcbiAqXHJcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXHJcbiAqIEBwYXJhbSBmb3JjZVJlZnJlc2ggLSBGb3JjZSByZWZyZXNoIHJlZ2FyZGxlc3Mgb2YgdG9rZW4gZXhwaXJhdGlvbi5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gZ2V0SWRUb2tlblJlc3VsdCh1c2VyLCBmb3JjZVJlZnJlc2ggPSBmYWxzZSkge1xyXG4gICAgY29uc3QgdXNlckludGVybmFsID0gZ2V0TW9kdWxhckluc3RhbmNlKHVzZXIpO1xyXG4gICAgY29uc3QgdG9rZW4gPSBhd2FpdCB1c2VySW50ZXJuYWwuZ2V0SWRUb2tlbihmb3JjZVJlZnJlc2gpO1xyXG4gICAgY29uc3QgY2xhaW1zID0gX3BhcnNlVG9rZW4odG9rZW4pO1xyXG4gICAgX2Fzc2VydChjbGFpbXMgJiYgY2xhaW1zLmV4cCAmJiBjbGFpbXMuYXV0aF90aW1lICYmIGNsYWltcy5pYXQsIHVzZXJJbnRlcm5hbC5hdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8pO1xyXG4gICAgY29uc3QgZmlyZWJhc2UgPSB0eXBlb2YgY2xhaW1zLmZpcmViYXNlID09PSAnb2JqZWN0JyA/IGNsYWltcy5maXJlYmFzZSA6IHVuZGVmaW5lZDtcclxuICAgIGNvbnN0IHNpZ25JblByb3ZpZGVyID0gZmlyZWJhc2UgPT09IG51bGwgfHwgZmlyZWJhc2UgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGZpcmViYXNlWydzaWduX2luX3Byb3ZpZGVyJ107XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGNsYWltcyxcclxuICAgICAgICB0b2tlbixcclxuICAgICAgICBhdXRoVGltZTogdXRjVGltZXN0YW1wVG9EYXRlU3RyaW5nKHNlY29uZHNTdHJpbmdUb01pbGxpc2Vjb25kcyhjbGFpbXMuYXV0aF90aW1lKSksXHJcbiAgICAgICAgaXNzdWVkQXRUaW1lOiB1dGNUaW1lc3RhbXBUb0RhdGVTdHJpbmcoc2Vjb25kc1N0cmluZ1RvTWlsbGlzZWNvbmRzKGNsYWltcy5pYXQpKSxcclxuICAgICAgICBleHBpcmF0aW9uVGltZTogdXRjVGltZXN0YW1wVG9EYXRlU3RyaW5nKHNlY29uZHNTdHJpbmdUb01pbGxpc2Vjb25kcyhjbGFpbXMuZXhwKSksXHJcbiAgICAgICAgc2lnbkluUHJvdmlkZXI6IHNpZ25JblByb3ZpZGVyIHx8IG51bGwsXHJcbiAgICAgICAgc2lnbkluU2Vjb25kRmFjdG9yOiAoZmlyZWJhc2UgPT09IG51bGwgfHwgZmlyZWJhc2UgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGZpcmViYXNlWydzaWduX2luX3NlY29uZF9mYWN0b3InXSkgfHwgbnVsbFxyXG4gICAgfTtcclxufVxyXG5mdW5jdGlvbiBzZWNvbmRzU3RyaW5nVG9NaWxsaXNlY29uZHMoc2Vjb25kcykge1xyXG4gICAgcmV0dXJuIE51bWJlcihzZWNvbmRzKSAqIDEwMDA7XHJcbn1cclxuZnVuY3Rpb24gX3BhcnNlVG9rZW4odG9rZW4pIHtcclxuICAgIGNvbnN0IFthbGdvcml0aG0sIHBheWxvYWQsIHNpZ25hdHVyZV0gPSB0b2tlbi5zcGxpdCgnLicpO1xyXG4gICAgaWYgKGFsZ29yaXRobSA9PT0gdW5kZWZpbmVkIHx8XHJcbiAgICAgICAgcGF5bG9hZCA9PT0gdW5kZWZpbmVkIHx8XHJcbiAgICAgICAgc2lnbmF0dXJlID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICBfbG9nRXJyb3IoJ0pXVCBtYWxmb3JtZWQsIGNvbnRhaW5lZCBmZXdlciB0aGFuIDMgc2VjdGlvbnMnKTtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgZGVjb2RlZCA9IGJhc2U2NERlY29kZShwYXlsb2FkKTtcclxuICAgICAgICBpZiAoIWRlY29kZWQpIHtcclxuICAgICAgICAgICAgX2xvZ0Vycm9yKCdGYWlsZWQgdG8gZGVjb2RlIGJhc2U2NCBKV1QgcGF5bG9hZCcpO1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoZGVjb2RlZCk7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgIF9sb2dFcnJvcignQ2F1Z2h0IGVycm9yIHBhcnNpbmcgSldUIHBheWxvYWQgYXMgSlNPTicsIGUpO1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBFeHRyYWN0IGV4cGlyZXNJbiBUVEwgZnJvbSBhIHRva2VuIGJ5IHN1YnRyYWN0aW5nIHRoZSBleHBpcmF0aW9uIGZyb20gdGhlIGlzc3VhbmNlLlxyXG4gKi9cclxuZnVuY3Rpb24gX3Rva2VuRXhwaXJlc0luKHRva2VuKSB7XHJcbiAgICBjb25zdCBwYXJzZWRUb2tlbiA9IF9wYXJzZVRva2VuKHRva2VuKTtcclxuICAgIF9hc3NlcnQocGFyc2VkVG9rZW4sIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyk7XHJcbiAgICBfYXNzZXJ0KHR5cGVvZiBwYXJzZWRUb2tlbi5leHAgIT09ICd1bmRlZmluZWQnLCBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8pO1xyXG4gICAgX2Fzc2VydCh0eXBlb2YgcGFyc2VkVG9rZW4uaWF0ICE9PSAndW5kZWZpbmVkJywgXCJpbnRlcm5hbC1lcnJvclwiIC8qIElOVEVSTkFMX0VSUk9SICovKTtcclxuICAgIHJldHVybiBOdW1iZXIocGFyc2VkVG9rZW4uZXhwKSAtIE51bWJlcihwYXJzZWRUb2tlbi5pYXQpO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIF9sb2dvdXRJZkludmFsaWRhdGVkKHVzZXIsIHByb21pc2UsIGJ5cGFzc0F1dGhTdGF0ZSA9IGZhbHNlKSB7XHJcbiAgICBpZiAoYnlwYXNzQXV0aFN0YXRlKSB7XHJcbiAgICAgICAgcmV0dXJuIHByb21pc2U7XHJcbiAgICB9XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHJldHVybiBhd2FpdCBwcm9taXNlO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIEZpcmViYXNlRXJyb3IgJiYgaXNVc2VySW52YWxpZGF0ZWQoZSkpIHtcclxuICAgICAgICAgICAgaWYgKHVzZXIuYXV0aC5jdXJyZW50VXNlciA9PT0gdXNlcikge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdXNlci5hdXRoLnNpZ25PdXQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aHJvdyBlO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGlzVXNlckludmFsaWRhdGVkKHsgY29kZSB9KSB7XHJcbiAgICByZXR1cm4gKGNvZGUgPT09IGBhdXRoLyR7XCJ1c2VyLWRpc2FibGVkXCIgLyogVVNFUl9ESVNBQkxFRCAqL31gIHx8XHJcbiAgICAgICAgY29kZSA9PT0gYGF1dGgvJHtcInVzZXItdG9rZW4tZXhwaXJlZFwiIC8qIFRPS0VOX0VYUElSRUQgKi99YCk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuY2xhc3MgUHJvYWN0aXZlUmVmcmVzaCB7XHJcbiAgICBjb25zdHJ1Y3Rvcih1c2VyKSB7XHJcbiAgICAgICAgdGhpcy51c2VyID0gdXNlcjtcclxuICAgICAgICB0aGlzLmlzUnVubmluZyA9IGZhbHNlO1xyXG4gICAgICAgIC8vIE5vZGUgdGltZXJzIGFuZCBicm93c2VyIHRpbWVycyByZXR1cm4gZnVuZGFtZW50YWxseSBkaWZmZXJlbnQgdHlwZXMuXHJcbiAgICAgICAgLy8gV2UgZG9uJ3QgYWN0dWFsbHkgY2FyZSB3aGF0IHRoZSB2YWx1ZSBpcyBidXQgVFMgd29uJ3QgYWNjZXB0IHVua25vd24gYW5kXHJcbiAgICAgICAgLy8gd2UgY2FuJ3QgY2FzdCBwcm9wZXJseSBpbiBib3RoIGVudmlyb25tZW50cy5cclxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxyXG4gICAgICAgIHRoaXMudGltZXJJZCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5lcnJvckJhY2tvZmYgPSAzMDAwMCAvKiBSRVRSWV9CQUNLT0ZGX01JTiAqLztcclxuICAgIH1cclxuICAgIF9zdGFydCgpIHtcclxuICAgICAgICBpZiAodGhpcy5pc1J1bm5pbmcpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmlzUnVubmluZyA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZSgpO1xyXG4gICAgfVxyXG4gICAgX3N0b3AoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzUnVubmluZykge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaXNSdW5uaW5nID0gZmFsc2U7XHJcbiAgICAgICAgaWYgKHRoaXMudGltZXJJZCAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lcklkKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBnZXRJbnRlcnZhbCh3YXNFcnJvcikge1xyXG4gICAgICAgIHZhciBfYTtcclxuICAgICAgICBpZiAod2FzRXJyb3IpIHtcclxuICAgICAgICAgICAgY29uc3QgaW50ZXJ2YWwgPSB0aGlzLmVycm9yQmFja29mZjtcclxuICAgICAgICAgICAgdGhpcy5lcnJvckJhY2tvZmYgPSBNYXRoLm1pbih0aGlzLmVycm9yQmFja29mZiAqIDIsIDk2MDAwMCAvKiBSRVRSWV9CQUNLT0ZGX01BWCAqLyk7XHJcbiAgICAgICAgICAgIHJldHVybiBpbnRlcnZhbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIFJlc2V0IHRoZSBlcnJvciBiYWNrb2ZmXHJcbiAgICAgICAgICAgIHRoaXMuZXJyb3JCYWNrb2ZmID0gMzAwMDAgLyogUkVUUllfQkFDS09GRl9NSU4gKi87XHJcbiAgICAgICAgICAgIGNvbnN0IGV4cFRpbWUgPSAoX2EgPSB0aGlzLnVzZXIuc3RzVG9rZW5NYW5hZ2VyLmV4cGlyYXRpb25UaW1lKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiAwO1xyXG4gICAgICAgICAgICBjb25zdCBpbnRlcnZhbCA9IGV4cFRpbWUgLSBEYXRlLm5vdygpIC0gMzAwMDAwIC8qIE9GRlNFVCAqLztcclxuICAgICAgICAgICAgcmV0dXJuIE1hdGgubWF4KDAsIGludGVydmFsKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBzY2hlZHVsZSh3YXNFcnJvciA9IGZhbHNlKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzUnVubmluZykge1xyXG4gICAgICAgICAgICAvLyBKdXN0IGluIGNhc2UuLi5cclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBpbnRlcnZhbCA9IHRoaXMuZ2V0SW50ZXJ2YWwod2FzRXJyb3IpO1xyXG4gICAgICAgIHRoaXMudGltZXJJZCA9IHNldFRpbWVvdXQoYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLml0ZXJhdGlvbigpO1xyXG4gICAgICAgIH0sIGludGVydmFsKTtcclxuICAgIH1cclxuICAgIGFzeW5jIGl0ZXJhdGlvbigpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnVzZXIuZ2V0SWRUb2tlbih0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgLy8gT25seSByZXRyeSBvbiBuZXR3b3JrIGVycm9yc1xyXG4gICAgICAgICAgICBpZiAoZS5jb2RlID09PSBgYXV0aC8ke1wibmV0d29yay1yZXF1ZXN0LWZhaWxlZFwiIC8qIE5FVFdPUktfUkVRVUVTVF9GQUlMRUQgKi99YCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zY2hlZHVsZSgvKiB3YXNFcnJvciAqLyB0cnVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2NoZWR1bGUoKTtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jbGFzcyBVc2VyTWV0YWRhdGEge1xyXG4gICAgY29uc3RydWN0b3IoY3JlYXRlZEF0LCBsYXN0TG9naW5BdCkge1xyXG4gICAgICAgIHRoaXMuY3JlYXRlZEF0ID0gY3JlYXRlZEF0O1xyXG4gICAgICAgIHRoaXMubGFzdExvZ2luQXQgPSBsYXN0TG9naW5BdDtcclxuICAgICAgICB0aGlzLl9pbml0aWFsaXplVGltZSgpO1xyXG4gICAgfVxyXG4gICAgX2luaXRpYWxpemVUaW1lKCkge1xyXG4gICAgICAgIHRoaXMubGFzdFNpZ25JblRpbWUgPSB1dGNUaW1lc3RhbXBUb0RhdGVTdHJpbmcodGhpcy5sYXN0TG9naW5BdCk7XHJcbiAgICAgICAgdGhpcy5jcmVhdGlvblRpbWUgPSB1dGNUaW1lc3RhbXBUb0RhdGVTdHJpbmcodGhpcy5jcmVhdGVkQXQpO1xyXG4gICAgfVxyXG4gICAgX2NvcHkobWV0YWRhdGEpIHtcclxuICAgICAgICB0aGlzLmNyZWF0ZWRBdCA9IG1ldGFkYXRhLmNyZWF0ZWRBdDtcclxuICAgICAgICB0aGlzLmxhc3RMb2dpbkF0ID0gbWV0YWRhdGEubGFzdExvZ2luQXQ7XHJcbiAgICAgICAgdGhpcy5faW5pdGlhbGl6ZVRpbWUoKTtcclxuICAgIH1cclxuICAgIHRvSlNPTigpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBjcmVhdGVkQXQ6IHRoaXMuY3JlYXRlZEF0LFxyXG4gICAgICAgICAgICBsYXN0TG9naW5BdDogdGhpcy5sYXN0TG9naW5BdFxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gX3JlbG9hZFdpdGhvdXRTYXZpbmcodXNlcikge1xyXG4gICAgdmFyIF9hO1xyXG4gICAgY29uc3QgYXV0aCA9IHVzZXIuYXV0aDtcclxuICAgIGNvbnN0IGlkVG9rZW4gPSBhd2FpdCB1c2VyLmdldElkVG9rZW4oKTtcclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgX2xvZ291dElmSW52YWxpZGF0ZWQodXNlciwgZ2V0QWNjb3VudEluZm8oYXV0aCwgeyBpZFRva2VuIH0pKTtcclxuICAgIF9hc3NlcnQocmVzcG9uc2UgPT09IG51bGwgfHwgcmVzcG9uc2UgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHJlc3BvbnNlLnVzZXJzLmxlbmd0aCwgYXV0aCwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIElOVEVSTkFMX0VSUk9SICovKTtcclxuICAgIGNvbnN0IGNvcmVBY2NvdW50ID0gcmVzcG9uc2UudXNlcnNbMF07XHJcbiAgICB1c2VyLl9ub3RpZnlSZWxvYWRMaXN0ZW5lcihjb3JlQWNjb3VudCk7XHJcbiAgICBjb25zdCBuZXdQcm92aWRlckRhdGEgPSAoKF9hID0gY29yZUFjY291bnQucHJvdmlkZXJVc2VySW5mbykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmxlbmd0aClcclxuICAgICAgICA/IGV4dHJhY3RQcm92aWRlckRhdGEoY29yZUFjY291bnQucHJvdmlkZXJVc2VySW5mbylcclxuICAgICAgICA6IFtdO1xyXG4gICAgY29uc3QgcHJvdmlkZXJEYXRhID0gbWVyZ2VQcm92aWRlckRhdGEodXNlci5wcm92aWRlckRhdGEsIG5ld1Byb3ZpZGVyRGF0YSk7XHJcbiAgICAvLyBQcmVzZXJ2ZXMgdGhlIG5vbi1ub255bW91cyBzdGF0dXMgb2YgdGhlIHN0b3JlZCB1c2VyLCBldmVuIGlmIG5vIG1vcmVcclxuICAgIC8vIGNyZWRlbnRpYWxzIChmZWRlcmF0ZWQgb3IgZW1haWwvcGFzc3dvcmQpIGFyZSBsaW5rZWQgdG8gdGhlIHVzZXIuIElmXHJcbiAgICAvLyB0aGUgdXNlciB3YXMgcHJldmlvdXNseSBhbm9ueW1vdXMsIHRoZW4gdXNlIHByb3ZpZGVyIGRhdGEgdG8gdXBkYXRlLlxyXG4gICAgLy8gT24gdGhlIG90aGVyIGhhbmQsIGlmIGl0IHdhcyBub3QgYW5vbnltb3VzIGJlZm9yZSwgaXQgc2hvdWxkIG5ldmVyIGJlXHJcbiAgICAvLyBjb25zaWRlcmVkIGFub255bW91cyBub3cuXHJcbiAgICBjb25zdCBvbGRJc0Fub255bW91cyA9IHVzZXIuaXNBbm9ueW1vdXM7XHJcbiAgICBjb25zdCBuZXdJc0Fub255bW91cyA9ICEodXNlci5lbWFpbCAmJiBjb3JlQWNjb3VudC5wYXNzd29yZEhhc2gpICYmICEocHJvdmlkZXJEYXRhID09PSBudWxsIHx8IHByb3ZpZGVyRGF0YSA9PT0gdm9pZCAwID8gdm9pZCAwIDogcHJvdmlkZXJEYXRhLmxlbmd0aCk7XHJcbiAgICBjb25zdCBpc0Fub255bW91cyA9ICFvbGRJc0Fub255bW91cyA/IGZhbHNlIDogbmV3SXNBbm9ueW1vdXM7XHJcbiAgICBjb25zdCB1cGRhdGVzID0ge1xyXG4gICAgICAgIHVpZDogY29yZUFjY291bnQubG9jYWxJZCxcclxuICAgICAgICBkaXNwbGF5TmFtZTogY29yZUFjY291bnQuZGlzcGxheU5hbWUgfHwgbnVsbCxcclxuICAgICAgICBwaG90b1VSTDogY29yZUFjY291bnQucGhvdG9VcmwgfHwgbnVsbCxcclxuICAgICAgICBlbWFpbDogY29yZUFjY291bnQuZW1haWwgfHwgbnVsbCxcclxuICAgICAgICBlbWFpbFZlcmlmaWVkOiBjb3JlQWNjb3VudC5lbWFpbFZlcmlmaWVkIHx8IGZhbHNlLFxyXG4gICAgICAgIHBob25lTnVtYmVyOiBjb3JlQWNjb3VudC5waG9uZU51bWJlciB8fCBudWxsLFxyXG4gICAgICAgIHRlbmFudElkOiBjb3JlQWNjb3VudC50ZW5hbnRJZCB8fCBudWxsLFxyXG4gICAgICAgIHByb3ZpZGVyRGF0YSxcclxuICAgICAgICBtZXRhZGF0YTogbmV3IFVzZXJNZXRhZGF0YShjb3JlQWNjb3VudC5jcmVhdGVkQXQsIGNvcmVBY2NvdW50Lmxhc3RMb2dpbkF0KSxcclxuICAgICAgICBpc0Fub255bW91c1xyXG4gICAgfTtcclxuICAgIE9iamVjdC5hc3NpZ24odXNlciwgdXBkYXRlcyk7XHJcbn1cclxuLyoqXHJcbiAqIFJlbG9hZHMgdXNlciBhY2NvdW50IGRhdGEsIGlmIHNpZ25lZCBpbi5cclxuICpcclxuICogQHBhcmFtIHVzZXIgLSBUaGUgdXNlci5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gcmVsb2FkKHVzZXIpIHtcclxuICAgIGNvbnN0IHVzZXJJbnRlcm5hbCA9IGdldE1vZHVsYXJJbnN0YW5jZSh1c2VyKTtcclxuICAgIGF3YWl0IF9yZWxvYWRXaXRob3V0U2F2aW5nKHVzZXJJbnRlcm5hbCk7XHJcbiAgICAvLyBFdmVuIHRob3VnaCB0aGUgY3VycmVudCB1c2VyIGhhc24ndCBjaGFuZ2VkLCB1cGRhdGVcclxuICAgIC8vIGN1cnJlbnQgdXNlciB3aWxsIHRyaWdnZXIgYSBwZXJzaXN0ZW5jZSB1cGRhdGUgdy8gdGhlXHJcbiAgICAvLyBuZXcgaW5mby5cclxuICAgIGF3YWl0IHVzZXJJbnRlcm5hbC5hdXRoLl9wZXJzaXN0VXNlcklmQ3VycmVudCh1c2VySW50ZXJuYWwpO1xyXG4gICAgdXNlckludGVybmFsLmF1dGguX25vdGlmeUxpc3RlbmVyc0lmQ3VycmVudCh1c2VySW50ZXJuYWwpO1xyXG59XHJcbmZ1bmN0aW9uIG1lcmdlUHJvdmlkZXJEYXRhKG9yaWdpbmFsLCBuZXdEYXRhKSB7XHJcbiAgICBjb25zdCBkZWR1cGVkID0gb3JpZ2luYWwuZmlsdGVyKG8gPT4gIW5ld0RhdGEuc29tZShuID0+IG4ucHJvdmlkZXJJZCA9PT0gby5wcm92aWRlcklkKSk7XHJcbiAgICByZXR1cm4gWy4uLmRlZHVwZWQsIC4uLm5ld0RhdGFdO1xyXG59XHJcbmZ1bmN0aW9uIGV4dHJhY3RQcm92aWRlckRhdGEocHJvdmlkZXJzKSB7XHJcbiAgICByZXR1cm4gcHJvdmlkZXJzLm1hcCgoX2EpID0+IHtcclxuICAgICAgICB2YXIgeyBwcm92aWRlcklkIH0gPSBfYSwgcHJvdmlkZXIgPSBfX3Jlc3QoX2EsIFtcInByb3ZpZGVySWRcIl0pO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHByb3ZpZGVySWQsXHJcbiAgICAgICAgICAgIHVpZDogcHJvdmlkZXIucmF3SWQgfHwgJycsXHJcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiBwcm92aWRlci5kaXNwbGF5TmFtZSB8fCBudWxsLFxyXG4gICAgICAgICAgICBlbWFpbDogcHJvdmlkZXIuZW1haWwgfHwgbnVsbCxcclxuICAgICAgICAgICAgcGhvbmVOdW1iZXI6IHByb3ZpZGVyLnBob25lTnVtYmVyIHx8IG51bGwsXHJcbiAgICAgICAgICAgIHBob3RvVVJMOiBwcm92aWRlci5waG90b1VybCB8fCBudWxsXHJcbiAgICAgICAgfTtcclxuICAgIH0pO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIHJlcXVlc3RTdHNUb2tlbihhdXRoLCByZWZyZXNoVG9rZW4pIHtcclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgX3BlcmZvcm1GZXRjaFdpdGhFcnJvckhhbmRsaW5nKGF1dGgsIHt9LCAoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgYm9keSA9IHF1ZXJ5c3RyaW5nKHtcclxuICAgICAgICAgICAgJ2dyYW50X3R5cGUnOiAncmVmcmVzaF90b2tlbicsXHJcbiAgICAgICAgICAgICdyZWZyZXNoX3Rva2VuJzogcmVmcmVzaFRva2VuXHJcbiAgICAgICAgfSkuc2xpY2UoMSk7XHJcbiAgICAgICAgY29uc3QgeyB0b2tlbkFwaUhvc3QsIGFwaUtleSB9ID0gYXV0aC5jb25maWc7XHJcbiAgICAgICAgY29uc3QgdXJsID0gX2dldEZpbmFsVGFyZ2V0KGF1dGgsIHRva2VuQXBpSG9zdCwgXCIvdjEvdG9rZW5cIiAvKiBUT0tFTiAqLywgYGtleT0ke2FwaUtleX1gKTtcclxuICAgICAgICByZXR1cm4gRmV0Y2hQcm92aWRlci5mZXRjaCgpKHVybCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiIC8qIFBPU1QgKi8sXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgICAgICdYLUNsaWVudC1WZXJzaW9uJzogYXV0aC5fZ2V0U2RrQ2xpZW50VmVyc2lvbigpLFxyXG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGJvZHlcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG4gICAgLy8gVGhlIHJlc3BvbnNlIGNvbWVzIGJhY2sgaW4gc25ha2VfY2FzZS4gQ29udmVydCB0byBjYW1lbDpcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgYWNjZXNzVG9rZW46IHJlc3BvbnNlLmFjY2Vzc190b2tlbixcclxuICAgICAgICBleHBpcmVzSW46IHJlc3BvbnNlLmV4cGlyZXNfaW4sXHJcbiAgICAgICAgcmVmcmVzaFRva2VuOiByZXNwb25zZS5yZWZyZXNoX3Rva2VuXHJcbiAgICB9O1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBXZSBuZWVkIHRvIG1hcmsgdGhpcyBjbGFzcyBhcyBpbnRlcm5hbCBleHBsaWNpdGx5IHRvIGV4Y2x1ZGUgaXQgaW4gdGhlIHB1YmxpYyB0eXBpbmdzLCBiZWNhdXNlXHJcbiAqIGl0IHJlZmVyZW5jZXMgQXV0aEludGVybmFsIHdoaWNoIGhhcyBhIGNpcmN1bGFyIGRlcGVuZGVuY3kgd2l0aCBVc2VySW50ZXJuYWwuXHJcbiAqXHJcbiAqIEBpbnRlcm5hbFxyXG4gKi9cclxuY2xhc3MgU3RzVG9rZW5NYW5hZ2VyIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHRoaXMucmVmcmVzaFRva2VuID0gbnVsbDtcclxuICAgICAgICB0aGlzLmFjY2Vzc1Rva2VuID0gbnVsbDtcclxuICAgICAgICB0aGlzLmV4cGlyYXRpb25UaW1lID0gbnVsbDtcclxuICAgIH1cclxuICAgIGdldCBpc0V4cGlyZWQoKSB7XHJcbiAgICAgICAgcmV0dXJuICghdGhpcy5leHBpcmF0aW9uVGltZSB8fFxyXG4gICAgICAgICAgICBEYXRlLm5vdygpID4gdGhpcy5leHBpcmF0aW9uVGltZSAtIDMwMDAwIC8qIFRPS0VOX1JFRlJFU0ggKi8pO1xyXG4gICAgfVxyXG4gICAgdXBkYXRlRnJvbVNlcnZlclJlc3BvbnNlKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgX2Fzc2VydChyZXNwb25zZS5pZFRva2VuLCBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8pO1xyXG4gICAgICAgIF9hc3NlcnQodHlwZW9mIHJlc3BvbnNlLmlkVG9rZW4gIT09ICd1bmRlZmluZWQnLCBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8pO1xyXG4gICAgICAgIF9hc3NlcnQodHlwZW9mIHJlc3BvbnNlLnJlZnJlc2hUb2tlbiAhPT0gJ3VuZGVmaW5lZCcsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyk7XHJcbiAgICAgICAgY29uc3QgZXhwaXJlc0luID0gJ2V4cGlyZXNJbicgaW4gcmVzcG9uc2UgJiYgdHlwZW9mIHJlc3BvbnNlLmV4cGlyZXNJbiAhPT0gJ3VuZGVmaW5lZCdcclxuICAgICAgICAgICAgPyBOdW1iZXIocmVzcG9uc2UuZXhwaXJlc0luKVxyXG4gICAgICAgICAgICA6IF90b2tlbkV4cGlyZXNJbihyZXNwb25zZS5pZFRva2VuKTtcclxuICAgICAgICB0aGlzLnVwZGF0ZVRva2Vuc0FuZEV4cGlyYXRpb24ocmVzcG9uc2UuaWRUb2tlbiwgcmVzcG9uc2UucmVmcmVzaFRva2VuLCBleHBpcmVzSW4pO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgZ2V0VG9rZW4oYXV0aCwgZm9yY2VSZWZyZXNoID0gZmFsc2UpIHtcclxuICAgICAgICBfYXNzZXJ0KCF0aGlzLmFjY2Vzc1Rva2VuIHx8IHRoaXMucmVmcmVzaFRva2VuLCBhdXRoLCBcInVzZXItdG9rZW4tZXhwaXJlZFwiIC8qIFRPS0VOX0VYUElSRUQgKi8pO1xyXG4gICAgICAgIGlmICghZm9yY2VSZWZyZXNoICYmIHRoaXMuYWNjZXNzVG9rZW4gJiYgIXRoaXMuaXNFeHBpcmVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmFjY2Vzc1Rva2VuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5yZWZyZXNoVG9rZW4pIHtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5yZWZyZXNoKGF1dGgsIHRoaXMucmVmcmVzaFRva2VuKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYWNjZXNzVG9rZW47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgY2xlYXJSZWZyZXNoVG9rZW4oKSB7XHJcbiAgICAgICAgdGhpcy5yZWZyZXNoVG9rZW4gPSBudWxsO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgcmVmcmVzaChhdXRoLCBvbGRUb2tlbikge1xyXG4gICAgICAgIGNvbnN0IHsgYWNjZXNzVG9rZW4sIHJlZnJlc2hUb2tlbiwgZXhwaXJlc0luIH0gPSBhd2FpdCByZXF1ZXN0U3RzVG9rZW4oYXV0aCwgb2xkVG9rZW4pO1xyXG4gICAgICAgIHRoaXMudXBkYXRlVG9rZW5zQW5kRXhwaXJhdGlvbihhY2Nlc3NUb2tlbiwgcmVmcmVzaFRva2VuLCBOdW1iZXIoZXhwaXJlc0luKSk7XHJcbiAgICB9XHJcbiAgICB1cGRhdGVUb2tlbnNBbmRFeHBpcmF0aW9uKGFjY2Vzc1Rva2VuLCByZWZyZXNoVG9rZW4sIGV4cGlyZXNJblNlYykge1xyXG4gICAgICAgIHRoaXMucmVmcmVzaFRva2VuID0gcmVmcmVzaFRva2VuIHx8IG51bGw7XHJcbiAgICAgICAgdGhpcy5hY2Nlc3NUb2tlbiA9IGFjY2Vzc1Rva2VuIHx8IG51bGw7XHJcbiAgICAgICAgdGhpcy5leHBpcmF0aW9uVGltZSA9IERhdGUubm93KCkgKyBleHBpcmVzSW5TZWMgKiAxMDAwO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIGZyb21KU09OKGFwcE5hbWUsIG9iamVjdCkge1xyXG4gICAgICAgIGNvbnN0IHsgcmVmcmVzaFRva2VuLCBhY2Nlc3NUb2tlbiwgZXhwaXJhdGlvblRpbWUgfSA9IG9iamVjdDtcclxuICAgICAgICBjb25zdCBtYW5hZ2VyID0gbmV3IFN0c1Rva2VuTWFuYWdlcigpO1xyXG4gICAgICAgIGlmIChyZWZyZXNoVG9rZW4pIHtcclxuICAgICAgICAgICAgX2Fzc2VydCh0eXBlb2YgcmVmcmVzaFRva2VuID09PSAnc3RyaW5nJywgXCJpbnRlcm5hbC1lcnJvclwiIC8qIElOVEVSTkFMX0VSUk9SICovLCB7XHJcbiAgICAgICAgICAgICAgICBhcHBOYW1lXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBtYW5hZ2VyLnJlZnJlc2hUb2tlbiA9IHJlZnJlc2hUb2tlbjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGFjY2Vzc1Rva2VuKSB7XHJcbiAgICAgICAgICAgIF9hc3NlcnQodHlwZW9mIGFjY2Vzc1Rva2VuID09PSAnc3RyaW5nJywgXCJpbnRlcm5hbC1lcnJvclwiIC8qIElOVEVSTkFMX0VSUk9SICovLCB7XHJcbiAgICAgICAgICAgICAgICBhcHBOYW1lXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBtYW5hZ2VyLmFjY2Vzc1Rva2VuID0gYWNjZXNzVG9rZW47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChleHBpcmF0aW9uVGltZSkge1xyXG4gICAgICAgICAgICBfYXNzZXJ0KHR5cGVvZiBleHBpcmF0aW9uVGltZSA9PT0gJ251bWJlcicsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLywge1xyXG4gICAgICAgICAgICAgICAgYXBwTmFtZVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgbWFuYWdlci5leHBpcmF0aW9uVGltZSA9IGV4cGlyYXRpb25UaW1lO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbWFuYWdlcjtcclxuICAgIH1cclxuICAgIHRvSlNPTigpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICByZWZyZXNoVG9rZW46IHRoaXMucmVmcmVzaFRva2VuLFxyXG4gICAgICAgICAgICBhY2Nlc3NUb2tlbjogdGhpcy5hY2Nlc3NUb2tlbixcclxuICAgICAgICAgICAgZXhwaXJhdGlvblRpbWU6IHRoaXMuZXhwaXJhdGlvblRpbWVcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG4gICAgX2Fzc2lnbihzdHNUb2tlbk1hbmFnZXIpIHtcclxuICAgICAgICB0aGlzLmFjY2Vzc1Rva2VuID0gc3RzVG9rZW5NYW5hZ2VyLmFjY2Vzc1Rva2VuO1xyXG4gICAgICAgIHRoaXMucmVmcmVzaFRva2VuID0gc3RzVG9rZW5NYW5hZ2VyLnJlZnJlc2hUb2tlbjtcclxuICAgICAgICB0aGlzLmV4cGlyYXRpb25UaW1lID0gc3RzVG9rZW5NYW5hZ2VyLmV4cGlyYXRpb25UaW1lO1xyXG4gICAgfVxyXG4gICAgX2Nsb25lKCkge1xyXG4gICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKG5ldyBTdHNUb2tlbk1hbmFnZXIoKSwgdGhpcy50b0pTT04oKSk7XHJcbiAgICB9XHJcbiAgICBfcGVyZm9ybVJlZnJlc2goKSB7XHJcbiAgICAgICAgcmV0dXJuIGRlYnVnRmFpbCgnbm90IGltcGxlbWVudGVkJyk7XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuZnVuY3Rpb24gYXNzZXJ0U3RyaW5nT3JVbmRlZmluZWQoYXNzZXJ0aW9uLCBhcHBOYW1lKSB7XHJcbiAgICBfYXNzZXJ0KHR5cGVvZiBhc3NlcnRpb24gPT09ICdzdHJpbmcnIHx8IHR5cGVvZiBhc3NlcnRpb24gPT09ICd1bmRlZmluZWQnLCBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8sIHsgYXBwTmFtZSB9KTtcclxufVxyXG5jbGFzcyBVc2VySW1wbCB7XHJcbiAgICBjb25zdHJ1Y3RvcihfYSkge1xyXG4gICAgICAgIHZhciB7IHVpZCwgYXV0aCwgc3RzVG9rZW5NYW5hZ2VyIH0gPSBfYSwgb3B0ID0gX19yZXN0KF9hLCBbXCJ1aWRcIiwgXCJhdXRoXCIsIFwic3RzVG9rZW5NYW5hZ2VyXCJdKTtcclxuICAgICAgICAvLyBGb3IgdGhlIHVzZXIgb2JqZWN0LCBwcm92aWRlciBpcyBhbHdheXMgRmlyZWJhc2UuXHJcbiAgICAgICAgdGhpcy5wcm92aWRlcklkID0gXCJmaXJlYmFzZVwiIC8qIEZJUkVCQVNFICovO1xyXG4gICAgICAgIHRoaXMuZW1haWxWZXJpZmllZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuaXNBbm9ueW1vdXMgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnRlbmFudElkID0gbnVsbDtcclxuICAgICAgICB0aGlzLnByb3ZpZGVyRGF0YSA9IFtdO1xyXG4gICAgICAgIHRoaXMucHJvYWN0aXZlUmVmcmVzaCA9IG5ldyBQcm9hY3RpdmVSZWZyZXNoKHRoaXMpO1xyXG4gICAgICAgIHRoaXMucmVsb2FkVXNlckluZm8gPSBudWxsO1xyXG4gICAgICAgIHRoaXMucmVsb2FkTGlzdGVuZXIgPSBudWxsO1xyXG4gICAgICAgIHRoaXMudWlkID0gdWlkO1xyXG4gICAgICAgIHRoaXMuYXV0aCA9IGF1dGg7XHJcbiAgICAgICAgdGhpcy5zdHNUb2tlbk1hbmFnZXIgPSBzdHNUb2tlbk1hbmFnZXI7XHJcbiAgICAgICAgdGhpcy5hY2Nlc3NUb2tlbiA9IHN0c1Rva2VuTWFuYWdlci5hY2Nlc3NUb2tlbjtcclxuICAgICAgICB0aGlzLmRpc3BsYXlOYW1lID0gb3B0LmRpc3BsYXlOYW1lIHx8IG51bGw7XHJcbiAgICAgICAgdGhpcy5lbWFpbCA9IG9wdC5lbWFpbCB8fCBudWxsO1xyXG4gICAgICAgIHRoaXMucGhvbmVOdW1iZXIgPSBvcHQucGhvbmVOdW1iZXIgfHwgbnVsbDtcclxuICAgICAgICB0aGlzLnBob3RvVVJMID0gb3B0LnBob3RvVVJMIHx8IG51bGw7XHJcbiAgICAgICAgdGhpcy5pc0Fub255bW91cyA9IG9wdC5pc0Fub255bW91cyB8fCBmYWxzZTtcclxuICAgICAgICB0aGlzLm1ldGFkYXRhID0gbmV3IFVzZXJNZXRhZGF0YShvcHQuY3JlYXRlZEF0IHx8IHVuZGVmaW5lZCwgb3B0Lmxhc3RMb2dpbkF0IHx8IHVuZGVmaW5lZCk7XHJcbiAgICB9XHJcbiAgICBhc3luYyBnZXRJZFRva2VuKGZvcmNlUmVmcmVzaCkge1xyXG4gICAgICAgIGNvbnN0IGFjY2Vzc1Rva2VuID0gYXdhaXQgX2xvZ291dElmSW52YWxpZGF0ZWQodGhpcywgdGhpcy5zdHNUb2tlbk1hbmFnZXIuZ2V0VG9rZW4odGhpcy5hdXRoLCBmb3JjZVJlZnJlc2gpKTtcclxuICAgICAgICBfYXNzZXJ0KGFjY2Vzc1Rva2VuLCB0aGlzLmF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyk7XHJcbiAgICAgICAgaWYgKHRoaXMuYWNjZXNzVG9rZW4gIT09IGFjY2Vzc1Rva2VuKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYWNjZXNzVG9rZW4gPSBhY2Nlc3NUb2tlbjtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5hdXRoLl9wZXJzaXN0VXNlcklmQ3VycmVudCh0aGlzKTtcclxuICAgICAgICAgICAgdGhpcy5hdXRoLl9ub3RpZnlMaXN0ZW5lcnNJZkN1cnJlbnQodGhpcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBhY2Nlc3NUb2tlbjtcclxuICAgIH1cclxuICAgIGdldElkVG9rZW5SZXN1bHQoZm9yY2VSZWZyZXNoKSB7XHJcbiAgICAgICAgcmV0dXJuIGdldElkVG9rZW5SZXN1bHQodGhpcywgZm9yY2VSZWZyZXNoKTtcclxuICAgIH1cclxuICAgIHJlbG9hZCgpIHtcclxuICAgICAgICByZXR1cm4gcmVsb2FkKHRoaXMpO1xyXG4gICAgfVxyXG4gICAgX2Fzc2lnbih1c2VyKSB7XHJcbiAgICAgICAgaWYgKHRoaXMgPT09IHVzZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBfYXNzZXJ0KHRoaXMudWlkID09PSB1c2VyLnVpZCwgdGhpcy5hdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8pO1xyXG4gICAgICAgIHRoaXMuZGlzcGxheU5hbWUgPSB1c2VyLmRpc3BsYXlOYW1lO1xyXG4gICAgICAgIHRoaXMucGhvdG9VUkwgPSB1c2VyLnBob3RvVVJMO1xyXG4gICAgICAgIHRoaXMuZW1haWwgPSB1c2VyLmVtYWlsO1xyXG4gICAgICAgIHRoaXMuZW1haWxWZXJpZmllZCA9IHVzZXIuZW1haWxWZXJpZmllZDtcclxuICAgICAgICB0aGlzLnBob25lTnVtYmVyID0gdXNlci5waG9uZU51bWJlcjtcclxuICAgICAgICB0aGlzLmlzQW5vbnltb3VzID0gdXNlci5pc0Fub255bW91cztcclxuICAgICAgICB0aGlzLnRlbmFudElkID0gdXNlci50ZW5hbnRJZDtcclxuICAgICAgICB0aGlzLnByb3ZpZGVyRGF0YSA9IHVzZXIucHJvdmlkZXJEYXRhLm1hcCh1c2VySW5mbyA9PiAoT2JqZWN0LmFzc2lnbih7fSwgdXNlckluZm8pKSk7XHJcbiAgICAgICAgdGhpcy5tZXRhZGF0YS5fY29weSh1c2VyLm1ldGFkYXRhKTtcclxuICAgICAgICB0aGlzLnN0c1Rva2VuTWFuYWdlci5fYXNzaWduKHVzZXIuc3RzVG9rZW5NYW5hZ2VyKTtcclxuICAgIH1cclxuICAgIF9jbG9uZShhdXRoKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBVc2VySW1wbChPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIHRoaXMpLCB7IGF1dGgsIHN0c1Rva2VuTWFuYWdlcjogdGhpcy5zdHNUb2tlbk1hbmFnZXIuX2Nsb25lKCkgfSkpO1xyXG4gICAgfVxyXG4gICAgX29uUmVsb2FkKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgLy8gVGhlcmUgc2hvdWxkIG9ubHkgZXZlciBiZSBvbmUgbGlzdGVuZXIsIGFuZCB0aGF0IGlzIGEgc2luZ2xlIGluc3RhbmNlIG9mIE11bHRpRmFjdG9yVXNlclxyXG4gICAgICAgIF9hc3NlcnQoIXRoaXMucmVsb2FkTGlzdGVuZXIsIHRoaXMuYXV0aCwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIElOVEVSTkFMX0VSUk9SICovKTtcclxuICAgICAgICB0aGlzLnJlbG9hZExpc3RlbmVyID0gY2FsbGJhY2s7XHJcbiAgICAgICAgaWYgKHRoaXMucmVsb2FkVXNlckluZm8pIHtcclxuICAgICAgICAgICAgdGhpcy5fbm90aWZ5UmVsb2FkTGlzdGVuZXIodGhpcy5yZWxvYWRVc2VySW5mbyk7XHJcbiAgICAgICAgICAgIHRoaXMucmVsb2FkVXNlckluZm8gPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIF9ub3RpZnlSZWxvYWRMaXN0ZW5lcih1c2VySW5mbykge1xyXG4gICAgICAgIGlmICh0aGlzLnJlbG9hZExpc3RlbmVyKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVsb2FkTGlzdGVuZXIodXNlckluZm8pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gSWYgbm8gbGlzdGVuZXIgaXMgc3Vic2NyaWJlZCB5ZXQsIHNhdmUgdGhlIHJlc3VsdCBzbyBpdCdzIGF2YWlsYWJsZSB3aGVuIHRoZXkgZG8gc3Vic2NyaWJlXHJcbiAgICAgICAgICAgIHRoaXMucmVsb2FkVXNlckluZm8gPSB1c2VySW5mbztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBfc3RhcnRQcm9hY3RpdmVSZWZyZXNoKCkge1xyXG4gICAgICAgIHRoaXMucHJvYWN0aXZlUmVmcmVzaC5fc3RhcnQoKTtcclxuICAgIH1cclxuICAgIF9zdG9wUHJvYWN0aXZlUmVmcmVzaCgpIHtcclxuICAgICAgICB0aGlzLnByb2FjdGl2ZVJlZnJlc2guX3N0b3AoKTtcclxuICAgIH1cclxuICAgIGFzeW5jIF91cGRhdGVUb2tlbnNJZk5lY2Vzc2FyeShyZXNwb25zZSwgcmVsb2FkID0gZmFsc2UpIHtcclxuICAgICAgICBsZXQgdG9rZW5zUmVmcmVzaGVkID0gZmFsc2U7XHJcbiAgICAgICAgaWYgKHJlc3BvbnNlLmlkVG9rZW4gJiZcclxuICAgICAgICAgICAgcmVzcG9uc2UuaWRUb2tlbiAhPT0gdGhpcy5zdHNUb2tlbk1hbmFnZXIuYWNjZXNzVG9rZW4pIHtcclxuICAgICAgICAgICAgdGhpcy5zdHNUb2tlbk1hbmFnZXIudXBkYXRlRnJvbVNlcnZlclJlc3BvbnNlKHJlc3BvbnNlKTtcclxuICAgICAgICAgICAgdG9rZW5zUmVmcmVzaGVkID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHJlbG9hZCkge1xyXG4gICAgICAgICAgICBhd2FpdCBfcmVsb2FkV2l0aG91dFNhdmluZyh0aGlzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgYXdhaXQgdGhpcy5hdXRoLl9wZXJzaXN0VXNlcklmQ3VycmVudCh0aGlzKTtcclxuICAgICAgICBpZiAodG9rZW5zUmVmcmVzaGVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYXV0aC5fbm90aWZ5TGlzdGVuZXJzSWZDdXJyZW50KHRoaXMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGFzeW5jIGRlbGV0ZSgpIHtcclxuICAgICAgICBjb25zdCBpZFRva2VuID0gYXdhaXQgdGhpcy5nZXRJZFRva2VuKCk7XHJcbiAgICAgICAgYXdhaXQgX2xvZ291dElmSW52YWxpZGF0ZWQodGhpcywgZGVsZXRlQWNjb3VudCh0aGlzLmF1dGgsIHsgaWRUb2tlbiB9KSk7XHJcbiAgICAgICAgdGhpcy5zdHNUb2tlbk1hbmFnZXIuY2xlYXJSZWZyZXNoVG9rZW4oKTtcclxuICAgICAgICAvLyBUT0RPOiBEZXRlcm1pbmUgaWYgY2FuY2VsbGFibGUtcHJvbWlzZXMgYXJlIG5lY2Vzc2FyeSB0byB1c2UgaW4gdGhpcyBjbGFzcyBzbyB0aGF0IGRlbGV0ZSgpXHJcbiAgICAgICAgLy8gICAgICAgY2FuY2VscyBwZW5kaW5nIGFjdGlvbnMuLi5cclxuICAgICAgICByZXR1cm4gdGhpcy5hdXRoLnNpZ25PdXQoKTtcclxuICAgIH1cclxuICAgIHRvSlNPTigpIHtcclxuICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHsgdWlkOiB0aGlzLnVpZCwgZW1haWw6IHRoaXMuZW1haWwgfHwgdW5kZWZpbmVkLCBlbWFpbFZlcmlmaWVkOiB0aGlzLmVtYWlsVmVyaWZpZWQsIGRpc3BsYXlOYW1lOiB0aGlzLmRpc3BsYXlOYW1lIHx8IHVuZGVmaW5lZCwgaXNBbm9ueW1vdXM6IHRoaXMuaXNBbm9ueW1vdXMsIHBob3RvVVJMOiB0aGlzLnBob3RvVVJMIHx8IHVuZGVmaW5lZCwgcGhvbmVOdW1iZXI6IHRoaXMucGhvbmVOdW1iZXIgfHwgdW5kZWZpbmVkLCB0ZW5hbnRJZDogdGhpcy50ZW5hbnRJZCB8fCB1bmRlZmluZWQsIHByb3ZpZGVyRGF0YTogdGhpcy5wcm92aWRlckRhdGEubWFwKHVzZXJJbmZvID0+IChPYmplY3QuYXNzaWduKHt9LCB1c2VySW5mbykpKSwgc3RzVG9rZW5NYW5hZ2VyOiB0aGlzLnN0c1Rva2VuTWFuYWdlci50b0pTT04oKSwgXHJcbiAgICAgICAgICAgIC8vIFJlZGlyZWN0IGV2ZW50IElEIG11c3QgYmUgbWFpbnRhaW5lZCBpbiBjYXNlIHRoZXJlIGlzIGEgcGVuZGluZ1xyXG4gICAgICAgICAgICAvLyByZWRpcmVjdCBldmVudC5cclxuICAgICAgICAgICAgX3JlZGlyZWN0RXZlbnRJZDogdGhpcy5fcmVkaXJlY3RFdmVudElkIH0sIHRoaXMubWV0YWRhdGEudG9KU09OKCkpLCB7IFxyXG4gICAgICAgICAgICAvLyBSZXF1aXJlZCBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIHRoZSBsZWdhY3kgU0RLIChnby9maXJlYmFzZS1hdXRoLXNkay1wZXJzaXN0ZW5jZS1wYXJzaW5nKTpcclxuICAgICAgICAgICAgYXBpS2V5OiB0aGlzLmF1dGguY29uZmlnLmFwaUtleSwgYXBwTmFtZTogdGhpcy5hdXRoLm5hbWUgfSk7XHJcbiAgICB9XHJcbiAgICBnZXQgcmVmcmVzaFRva2VuKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnN0c1Rva2VuTWFuYWdlci5yZWZyZXNoVG9rZW4gfHwgJyc7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgX2Zyb21KU09OKGF1dGgsIG9iamVjdCkge1xyXG4gICAgICAgIHZhciBfYSwgX2IsIF9jLCBfZCwgX2UsIF9mLCBfZywgX2g7XHJcbiAgICAgICAgY29uc3QgZGlzcGxheU5hbWUgPSAoX2EgPSBvYmplY3QuZGlzcGxheU5hbWUpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IHVuZGVmaW5lZDtcclxuICAgICAgICBjb25zdCBlbWFpbCA9IChfYiA9IG9iamVjdC5lbWFpbCkgIT09IG51bGwgJiYgX2IgIT09IHZvaWQgMCA/IF9iIDogdW5kZWZpbmVkO1xyXG4gICAgICAgIGNvbnN0IHBob25lTnVtYmVyID0gKF9jID0gb2JqZWN0LnBob25lTnVtYmVyKSAhPT0gbnVsbCAmJiBfYyAhPT0gdm9pZCAwID8gX2MgOiB1bmRlZmluZWQ7XHJcbiAgICAgICAgY29uc3QgcGhvdG9VUkwgPSAoX2QgPSBvYmplY3QucGhvdG9VUkwpICE9PSBudWxsICYmIF9kICE9PSB2b2lkIDAgPyBfZCA6IHVuZGVmaW5lZDtcclxuICAgICAgICBjb25zdCB0ZW5hbnRJZCA9IChfZSA9IG9iamVjdC50ZW5hbnRJZCkgIT09IG51bGwgJiYgX2UgIT09IHZvaWQgMCA/IF9lIDogdW5kZWZpbmVkO1xyXG4gICAgICAgIGNvbnN0IF9yZWRpcmVjdEV2ZW50SWQgPSAoX2YgPSBvYmplY3QuX3JlZGlyZWN0RXZlbnRJZCkgIT09IG51bGwgJiYgX2YgIT09IHZvaWQgMCA/IF9mIDogdW5kZWZpbmVkO1xyXG4gICAgICAgIGNvbnN0IGNyZWF0ZWRBdCA9IChfZyA9IG9iamVjdC5jcmVhdGVkQXQpICE9PSBudWxsICYmIF9nICE9PSB2b2lkIDAgPyBfZyA6IHVuZGVmaW5lZDtcclxuICAgICAgICBjb25zdCBsYXN0TG9naW5BdCA9IChfaCA9IG9iamVjdC5sYXN0TG9naW5BdCkgIT09IG51bGwgJiYgX2ggIT09IHZvaWQgMCA/IF9oIDogdW5kZWZpbmVkO1xyXG4gICAgICAgIGNvbnN0IHsgdWlkLCBlbWFpbFZlcmlmaWVkLCBpc0Fub255bW91cywgcHJvdmlkZXJEYXRhLCBzdHNUb2tlbk1hbmFnZXI6IHBsYWluT2JqZWN0VG9rZW5NYW5hZ2VyIH0gPSBvYmplY3Q7XHJcbiAgICAgICAgX2Fzc2VydCh1aWQgJiYgcGxhaW5PYmplY3RUb2tlbk1hbmFnZXIsIGF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyk7XHJcbiAgICAgICAgY29uc3Qgc3RzVG9rZW5NYW5hZ2VyID0gU3RzVG9rZW5NYW5hZ2VyLmZyb21KU09OKHRoaXMubmFtZSwgcGxhaW5PYmplY3RUb2tlbk1hbmFnZXIpO1xyXG4gICAgICAgIF9hc3NlcnQodHlwZW9mIHVpZCA9PT0gJ3N0cmluZycsIGF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyk7XHJcbiAgICAgICAgYXNzZXJ0U3RyaW5nT3JVbmRlZmluZWQoZGlzcGxheU5hbWUsIGF1dGgubmFtZSk7XHJcbiAgICAgICAgYXNzZXJ0U3RyaW5nT3JVbmRlZmluZWQoZW1haWwsIGF1dGgubmFtZSk7XHJcbiAgICAgICAgX2Fzc2VydCh0eXBlb2YgZW1haWxWZXJpZmllZCA9PT0gJ2Jvb2xlYW4nLCBhdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8pO1xyXG4gICAgICAgIF9hc3NlcnQodHlwZW9mIGlzQW5vbnltb3VzID09PSAnYm9vbGVhbicsIGF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyk7XHJcbiAgICAgICAgYXNzZXJ0U3RyaW5nT3JVbmRlZmluZWQocGhvbmVOdW1iZXIsIGF1dGgubmFtZSk7XHJcbiAgICAgICAgYXNzZXJ0U3RyaW5nT3JVbmRlZmluZWQocGhvdG9VUkwsIGF1dGgubmFtZSk7XHJcbiAgICAgICAgYXNzZXJ0U3RyaW5nT3JVbmRlZmluZWQodGVuYW50SWQsIGF1dGgubmFtZSk7XHJcbiAgICAgICAgYXNzZXJ0U3RyaW5nT3JVbmRlZmluZWQoX3JlZGlyZWN0RXZlbnRJZCwgYXV0aC5uYW1lKTtcclxuICAgICAgICBhc3NlcnRTdHJpbmdPclVuZGVmaW5lZChjcmVhdGVkQXQsIGF1dGgubmFtZSk7XHJcbiAgICAgICAgYXNzZXJ0U3RyaW5nT3JVbmRlZmluZWQobGFzdExvZ2luQXQsIGF1dGgubmFtZSk7XHJcbiAgICAgICAgY29uc3QgdXNlciA9IG5ldyBVc2VySW1wbCh7XHJcbiAgICAgICAgICAgIHVpZCxcclxuICAgICAgICAgICAgYXV0aCxcclxuICAgICAgICAgICAgZW1haWwsXHJcbiAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQsXHJcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lLFxyXG4gICAgICAgICAgICBpc0Fub255bW91cyxcclxuICAgICAgICAgICAgcGhvdG9VUkwsXHJcbiAgICAgICAgICAgIHBob25lTnVtYmVyLFxyXG4gICAgICAgICAgICB0ZW5hbnRJZCxcclxuICAgICAgICAgICAgc3RzVG9rZW5NYW5hZ2VyLFxyXG4gICAgICAgICAgICBjcmVhdGVkQXQsXHJcbiAgICAgICAgICAgIGxhc3RMb2dpbkF0XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKHByb3ZpZGVyRGF0YSAmJiBBcnJheS5pc0FycmF5KHByb3ZpZGVyRGF0YSkpIHtcclxuICAgICAgICAgICAgdXNlci5wcm92aWRlckRhdGEgPSBwcm92aWRlckRhdGEubWFwKHVzZXJJbmZvID0+IChPYmplY3QuYXNzaWduKHt9LCB1c2VySW5mbykpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKF9yZWRpcmVjdEV2ZW50SWQpIHtcclxuICAgICAgICAgICAgdXNlci5fcmVkaXJlY3RFdmVudElkID0gX3JlZGlyZWN0RXZlbnRJZDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHVzZXI7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEluaXRpYWxpemUgYSBVc2VyIGZyb20gYW4gaWRUb2tlbiBzZXJ2ZXIgcmVzcG9uc2VcclxuICAgICAqIEBwYXJhbSBhdXRoXHJcbiAgICAgKiBAcGFyYW0gaWRUb2tlblJlc3BvbnNlXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBhc3luYyBfZnJvbUlkVG9rZW5SZXNwb25zZShhdXRoLCBpZFRva2VuUmVzcG9uc2UsIGlzQW5vbnltb3VzID0gZmFsc2UpIHtcclxuICAgICAgICBjb25zdCBzdHNUb2tlbk1hbmFnZXIgPSBuZXcgU3RzVG9rZW5NYW5hZ2VyKCk7XHJcbiAgICAgICAgc3RzVG9rZW5NYW5hZ2VyLnVwZGF0ZUZyb21TZXJ2ZXJSZXNwb25zZShpZFRva2VuUmVzcG9uc2UpO1xyXG4gICAgICAgIC8vIEluaXRpYWxpemUgdGhlIEZpcmViYXNlIEF1dGggdXNlci5cclxuICAgICAgICBjb25zdCB1c2VyID0gbmV3IFVzZXJJbXBsKHtcclxuICAgICAgICAgICAgdWlkOiBpZFRva2VuUmVzcG9uc2UubG9jYWxJZCxcclxuICAgICAgICAgICAgYXV0aCxcclxuICAgICAgICAgICAgc3RzVG9rZW5NYW5hZ2VyLFxyXG4gICAgICAgICAgICBpc0Fub255bW91c1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vIFVwZGF0ZXMgdGhlIHVzZXIgaW5mbyBhbmQgZGF0YSBhbmQgcmVzb2x2ZXMgd2l0aCBhIHVzZXIgaW5zdGFuY2UuXHJcbiAgICAgICAgYXdhaXQgX3JlbG9hZFdpdGhvdXRTYXZpbmcodXNlcik7XHJcbiAgICAgICAgcmV0dXJuIHVzZXI7XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuY2xhc3MgSW5NZW1vcnlQZXJzaXN0ZW5jZSB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLnR5cGUgPSBcIk5PTkVcIiAvKiBOT05FICovO1xyXG4gICAgICAgIHRoaXMuc3RvcmFnZSA9IHt9O1xyXG4gICAgfVxyXG4gICAgYXN5bmMgX2lzQXZhaWxhYmxlKCkge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgX3NldChrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5zdG9yYWdlW2tleV0gPSB2YWx1ZTtcclxuICAgIH1cclxuICAgIGFzeW5jIF9nZXQoa2V5KSB7XHJcbiAgICAgICAgY29uc3QgdmFsdWUgPSB0aGlzLnN0b3JhZ2Vba2V5XTtcclxuICAgICAgICByZXR1cm4gdmFsdWUgPT09IHVuZGVmaW5lZCA/IG51bGwgOiB2YWx1ZTtcclxuICAgIH1cclxuICAgIGFzeW5jIF9yZW1vdmUoa2V5KSB7XHJcbiAgICAgICAgZGVsZXRlIHRoaXMuc3RvcmFnZVtrZXldO1xyXG4gICAgfVxyXG4gICAgX2FkZExpc3RlbmVyKF9rZXksIF9saXN0ZW5lcikge1xyXG4gICAgICAgIC8vIExpc3RlbmVycyBhcmUgbm90IHN1cHBvcnRlZCBmb3IgaW4tbWVtb3J5IHN0b3JhZ2Ugc2luY2UgaXQgY2Fubm90IGJlIHNoYXJlZCBhY3Jvc3Mgd2luZG93cy93b3JrZXJzXHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgX3JlbW92ZUxpc3RlbmVyKF9rZXksIF9saXN0ZW5lcikge1xyXG4gICAgICAgIC8vIExpc3RlbmVycyBhcmUgbm90IHN1cHBvcnRlZCBmb3IgaW4tbWVtb3J5IHN0b3JhZ2Ugc2luY2UgaXQgY2Fubm90IGJlIHNoYXJlZCBhY3Jvc3Mgd2luZG93cy93b3JrZXJzXHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG59XHJcbkluTWVtb3J5UGVyc2lzdGVuY2UudHlwZSA9ICdOT05FJztcclxuLyoqXHJcbiAqIEFuIGltcGxlbWVudGF0aW9uIG9mIHtAbGluayBQZXJzaXN0ZW5jZX0gb2YgdHlwZSAnTk9ORScuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmNvbnN0IGluTWVtb3J5UGVyc2lzdGVuY2UgPSBJbk1lbW9yeVBlcnNpc3RlbmNlO1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5mdW5jdGlvbiBfcGVyc2lzdGVuY2VLZXlOYW1lKGtleSwgYXBpS2V5LCBhcHBOYW1lKSB7XHJcbiAgICByZXR1cm4gYCR7XCJmaXJlYmFzZVwiIC8qIFBFUlNJU1RFTkNFICovfToke2tleX06JHthcGlLZXl9OiR7YXBwTmFtZX1gO1xyXG59XHJcbmNsYXNzIFBlcnNpc3RlbmNlVXNlck1hbmFnZXIge1xyXG4gICAgY29uc3RydWN0b3IocGVyc2lzdGVuY2UsIGF1dGgsIHVzZXJLZXkpIHtcclxuICAgICAgICB0aGlzLnBlcnNpc3RlbmNlID0gcGVyc2lzdGVuY2U7XHJcbiAgICAgICAgdGhpcy5hdXRoID0gYXV0aDtcclxuICAgICAgICB0aGlzLnVzZXJLZXkgPSB1c2VyS2V5O1xyXG4gICAgICAgIGNvbnN0IHsgY29uZmlnLCBuYW1lIH0gPSB0aGlzLmF1dGg7XHJcbiAgICAgICAgdGhpcy5mdWxsVXNlcktleSA9IF9wZXJzaXN0ZW5jZUtleU5hbWUodGhpcy51c2VyS2V5LCBjb25maWcuYXBpS2V5LCBuYW1lKTtcclxuICAgICAgICB0aGlzLmZ1bGxQZXJzaXN0ZW5jZUtleSA9IF9wZXJzaXN0ZW5jZUtleU5hbWUoXCJwZXJzaXN0ZW5jZVwiIC8qIFBFUlNJU1RFTkNFX1VTRVIgKi8sIGNvbmZpZy5hcGlLZXksIG5hbWUpO1xyXG4gICAgICAgIHRoaXMuYm91bmRFdmVudEhhbmRsZXIgPSBhdXRoLl9vblN0b3JhZ2VFdmVudC5iaW5kKGF1dGgpO1xyXG4gICAgICAgIHRoaXMucGVyc2lzdGVuY2UuX2FkZExpc3RlbmVyKHRoaXMuZnVsbFVzZXJLZXksIHRoaXMuYm91bmRFdmVudEhhbmRsZXIpO1xyXG4gICAgfVxyXG4gICAgc2V0Q3VycmVudFVzZXIodXNlcikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlLl9zZXQodGhpcy5mdWxsVXNlcktleSwgdXNlci50b0pTT04oKSk7XHJcbiAgICB9XHJcbiAgICBhc3luYyBnZXRDdXJyZW50VXNlcigpIHtcclxuICAgICAgICBjb25zdCBibG9iID0gYXdhaXQgdGhpcy5wZXJzaXN0ZW5jZS5fZ2V0KHRoaXMuZnVsbFVzZXJLZXkpO1xyXG4gICAgICAgIHJldHVybiBibG9iID8gVXNlckltcGwuX2Zyb21KU09OKHRoaXMuYXV0aCwgYmxvYikgOiBudWxsO1xyXG4gICAgfVxyXG4gICAgcmVtb3ZlQ3VycmVudFVzZXIoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2UuX3JlbW92ZSh0aGlzLmZ1bGxVc2VyS2V5KTtcclxuICAgIH1cclxuICAgIHNhdmVQZXJzaXN0ZW5jZUZvclJlZGlyZWN0KCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlLl9zZXQodGhpcy5mdWxsUGVyc2lzdGVuY2VLZXksIHRoaXMucGVyc2lzdGVuY2UudHlwZSk7XHJcbiAgICB9XHJcbiAgICBhc3luYyBzZXRQZXJzaXN0ZW5jZShuZXdQZXJzaXN0ZW5jZSkge1xyXG4gICAgICAgIGlmICh0aGlzLnBlcnNpc3RlbmNlID09PSBuZXdQZXJzaXN0ZW5jZSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGN1cnJlbnRVc2VyID0gYXdhaXQgdGhpcy5nZXRDdXJyZW50VXNlcigpO1xyXG4gICAgICAgIGF3YWl0IHRoaXMucmVtb3ZlQ3VycmVudFVzZXIoKTtcclxuICAgICAgICB0aGlzLnBlcnNpc3RlbmNlID0gbmV3UGVyc2lzdGVuY2U7XHJcbiAgICAgICAgaWYgKGN1cnJlbnRVc2VyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNldEN1cnJlbnRVc2VyKGN1cnJlbnRVc2VyKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBkZWxldGUoKSB7XHJcbiAgICAgICAgdGhpcy5wZXJzaXN0ZW5jZS5fcmVtb3ZlTGlzdGVuZXIodGhpcy5mdWxsVXNlcktleSwgdGhpcy5ib3VuZEV2ZW50SGFuZGxlcik7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgYXN5bmMgY3JlYXRlKGF1dGgsIHBlcnNpc3RlbmNlSGllcmFyY2h5LCB1c2VyS2V5ID0gXCJhdXRoVXNlclwiIC8qIEFVVEhfVVNFUiAqLykge1xyXG4gICAgICAgIGlmICghcGVyc2lzdGVuY2VIaWVyYXJjaHkubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUGVyc2lzdGVuY2VVc2VyTWFuYWdlcihfZ2V0SW5zdGFuY2UoaW5NZW1vcnlQZXJzaXN0ZW5jZSksIGF1dGgsIHVzZXJLZXkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBFbGltaW5hdGUgYW55IHBlcnNpc3RlbmNlcyB0aGF0IGFyZSBub3QgYXZhaWxhYmxlXHJcbiAgICAgICAgY29uc3QgYXZhaWxhYmxlUGVyc2lzdGVuY2VzID0gKGF3YWl0IFByb21pc2UuYWxsKHBlcnNpc3RlbmNlSGllcmFyY2h5Lm1hcChhc3luYyAocGVyc2lzdGVuY2UpID0+IHtcclxuICAgICAgICAgICAgaWYgKGF3YWl0IHBlcnNpc3RlbmNlLl9pc0F2YWlsYWJsZSgpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcGVyc2lzdGVuY2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgICB9KSkpLmZpbHRlcihwZXJzaXN0ZW5jZSA9PiBwZXJzaXN0ZW5jZSk7XHJcbiAgICAgICAgLy8gRmFsbCBiYWNrIHRvIHRoZSBmaXJzdCBwZXJzaXN0ZW5jZSBsaXN0ZWQsIG9yIGluIG1lbW9yeSBpZiBub25lIGF2YWlsYWJsZVxyXG4gICAgICAgIGxldCBzZWxlY3RlZFBlcnNpc3RlbmNlID0gYXZhaWxhYmxlUGVyc2lzdGVuY2VzWzBdIHx8XHJcbiAgICAgICAgICAgIF9nZXRJbnN0YW5jZShpbk1lbW9yeVBlcnNpc3RlbmNlKTtcclxuICAgICAgICBjb25zdCBrZXkgPSBfcGVyc2lzdGVuY2VLZXlOYW1lKHVzZXJLZXksIGF1dGguY29uZmlnLmFwaUtleSwgYXV0aC5uYW1lKTtcclxuICAgICAgICAvLyBQdWxsIG91dCB0aGUgZXhpc3RpbmcgdXNlciwgc2V0dGluZyB0aGUgY2hvc2VuIHBlcnNpc3RlbmNlIHRvIHRoYXRcclxuICAgICAgICAvLyBwZXJzaXN0ZW5jZSBpZiB0aGUgdXNlciBleGlzdHMuXHJcbiAgICAgICAgbGV0IHVzZXJUb01pZ3JhdGUgPSBudWxsO1xyXG4gICAgICAgIC8vIE5vdGUsIGhlcmUgd2UgY2hlY2sgZm9yIGEgdXNlciBpbiBfYWxsXyBwZXJzaXN0ZW5jZXMsIG5vdCBqdXN0IHRoZVxyXG4gICAgICAgIC8vIG9uZXMgZGVlbWVkIGF2YWlsYWJsZS4gSWYgd2UgY2FuIG1pZ3JhdGUgYSB1c2VyIG91dCBvZiBhIGJyb2tlblxyXG4gICAgICAgIC8vIHBlcnNpc3RlbmNlLCB3ZSB3aWxsIChidXQgb25seSBpZiB0aGF0IHBlcnNpc3RlbmNlIHN1cHBvcnRzIG1pZ3JhdGlvbikuXHJcbiAgICAgICAgZm9yIChjb25zdCBwZXJzaXN0ZW5jZSBvZiBwZXJzaXN0ZW5jZUhpZXJhcmNoeSkge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYmxvYiA9IGF3YWl0IHBlcnNpc3RlbmNlLl9nZXQoa2V5KTtcclxuICAgICAgICAgICAgICAgIGlmIChibG9iKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdXNlciA9IFVzZXJJbXBsLl9mcm9tSlNPTihhdXRoLCBibG9iKTsgLy8gdGhyb3dzIGZvciB1bnBhcnNhYmxlIGJsb2IgKHdyb25nIGZvcm1hdClcclxuICAgICAgICAgICAgICAgICAgICBpZiAocGVyc2lzdGVuY2UgIT09IHNlbGVjdGVkUGVyc2lzdGVuY2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlclRvTWlncmF0ZSA9IHVzZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkUGVyc2lzdGVuY2UgPSBwZXJzaXN0ZW5jZTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXRjaCAoX2EpIHsgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBJZiB3ZSBmaW5kIHRoZSB1c2VyIGluIGEgcGVyc2lzdGVuY2UgdGhhdCBkb2VzIHN1cHBvcnQgbWlncmF0aW9uLCB1c2VcclxuICAgICAgICAvLyB0aGF0IG1pZ3JhdGlvbiBwYXRoIChvZiBvbmx5IHBlcnNpc3RlbmNlcyB0aGF0IHN1cHBvcnQgbWlncmF0aW9uKVxyXG4gICAgICAgIGNvbnN0IG1pZ3JhdGlvbkhpZXJhcmNoeSA9IGF2YWlsYWJsZVBlcnNpc3RlbmNlcy5maWx0ZXIocCA9PiBwLl9zaG91bGRBbGxvd01pZ3JhdGlvbik7XHJcbiAgICAgICAgLy8gSWYgdGhlIHBlcnNpc3RlbmNlIGRvZXMgX25vdF8gYWxsb3cgbWlncmF0aW9uLCBqdXN0IGZpbmlzaCBvZmYgaGVyZVxyXG4gICAgICAgIGlmICghc2VsZWN0ZWRQZXJzaXN0ZW5jZS5fc2hvdWxkQWxsb3dNaWdyYXRpb24gfHxcclxuICAgICAgICAgICAgIW1pZ3JhdGlvbkhpZXJhcmNoeS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQZXJzaXN0ZW5jZVVzZXJNYW5hZ2VyKHNlbGVjdGVkUGVyc2lzdGVuY2UsIGF1dGgsIHVzZXJLZXkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzZWxlY3RlZFBlcnNpc3RlbmNlID0gbWlncmF0aW9uSGllcmFyY2h5WzBdO1xyXG4gICAgICAgIGlmICh1c2VyVG9NaWdyYXRlKSB7XHJcbiAgICAgICAgICAgIC8vIFRoaXMgbm9ybWFsbHkgc2hvdWxkbid0IHRocm93IHNpbmNlIGNob3NlblBlcnNpc3RlbmNlLmlzQXZhaWxhYmxlKCkgaXMgdHJ1ZSwgYnV0IGlmIGl0IGRvZXNcclxuICAgICAgICAgICAgLy8gd2UnbGwganVzdCBsZXQgaXQgYnViYmxlIHRvIHN1cmZhY2UgdGhlIGVycm9yLlxyXG4gICAgICAgICAgICBhd2FpdCBzZWxlY3RlZFBlcnNpc3RlbmNlLl9zZXQoa2V5LCB1c2VyVG9NaWdyYXRlLnRvSlNPTigpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gQXR0ZW1wdCB0byBjbGVhciB0aGUga2V5IGluIG90aGVyIHBlcnNpc3RlbmNlcyBidXQgaWdub3JlIGVycm9ycy4gVGhpcyBoZWxwcyBwcmV2ZW50IGlzc3Vlc1xyXG4gICAgICAgIC8vIHN1Y2ggYXMgdXNlcnMgZ2V0dGluZyBzdHVjayB3aXRoIGEgcHJldmlvdXMgYWNjb3VudCBhZnRlciBzaWduaW5nIG91dCBhbmQgcmVmcmVzaGluZyB0aGUgdGFiLlxyXG4gICAgICAgIGF3YWl0IFByb21pc2UuYWxsKHBlcnNpc3RlbmNlSGllcmFyY2h5Lm1hcChhc3luYyAocGVyc2lzdGVuY2UpID0+IHtcclxuICAgICAgICAgICAgaWYgKHBlcnNpc3RlbmNlICE9PSBzZWxlY3RlZFBlcnNpc3RlbmNlKSB7XHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHBlcnNpc3RlbmNlLl9yZW1vdmUoa2V5KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNhdGNoIChfYSkgeyB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KSk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQZXJzaXN0ZW5jZVVzZXJNYW5hZ2VyKHNlbGVjdGVkUGVyc2lzdGVuY2UsIGF1dGgsIHVzZXJLZXkpO1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBEZXRlcm1pbmUgdGhlIGJyb3dzZXIgZm9yIHRoZSBwdXJwb3NlcyBvZiByZXBvcnRpbmcgdXNhZ2UgdG8gdGhlIEFQSVxyXG4gKi9cclxuZnVuY3Rpb24gX2dldEJyb3dzZXJOYW1lKHVzZXJBZ2VudCkge1xyXG4gICAgY29uc3QgdWEgPSB1c2VyQWdlbnQudG9Mb3dlckNhc2UoKTtcclxuICAgIGlmICh1YS5pbmNsdWRlcygnb3BlcmEvJykgfHwgdWEuaW5jbHVkZXMoJ29wci8nKSB8fCB1YS5pbmNsdWRlcygnb3Bpb3MvJykpIHtcclxuICAgICAgICByZXR1cm4gXCJPcGVyYVwiIC8qIE9QRVJBICovO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoX2lzSUVNb2JpbGUodWEpKSB7XHJcbiAgICAgICAgLy8gV2luZG93cyBwaG9uZSBJRU1vYmlsZSBicm93c2VyLlxyXG4gICAgICAgIHJldHVybiBcIklFTW9iaWxlXCIgLyogSUVNT0JJTEUgKi87XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICh1YS5pbmNsdWRlcygnbXNpZScpIHx8IHVhLmluY2x1ZGVzKCd0cmlkZW50LycpKSB7XHJcbiAgICAgICAgcmV0dXJuIFwiSUVcIiAvKiBJRSAqLztcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKHVhLmluY2x1ZGVzKCdlZGdlLycpKSB7XHJcbiAgICAgICAgcmV0dXJuIFwiRWRnZVwiIC8qIEVER0UgKi87XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChfaXNGaXJlZm94KHVhKSkge1xyXG4gICAgICAgIHJldHVybiBcIkZpcmVmb3hcIiAvKiBGSVJFRk9YICovO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAodWEuaW5jbHVkZXMoJ3NpbGsvJykpIHtcclxuICAgICAgICByZXR1cm4gXCJTaWxrXCIgLyogU0lMSyAqLztcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKF9pc0JsYWNrQmVycnkodWEpKSB7XHJcbiAgICAgICAgLy8gQmxhY2tiZXJyeSBicm93c2VyLlxyXG4gICAgICAgIHJldHVybiBcIkJsYWNrYmVycnlcIiAvKiBCTEFDS0JFUlJZICovO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoX2lzV2ViT1ModWEpKSB7XHJcbiAgICAgICAgLy8gV2ViT1MgZGVmYXVsdCBicm93c2VyLlxyXG4gICAgICAgIHJldHVybiBcIldlYm9zXCIgLyogV0VCT1MgKi87XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChfaXNTYWZhcmkodWEpKSB7XHJcbiAgICAgICAgcmV0dXJuIFwiU2FmYXJpXCIgLyogU0FGQVJJICovO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoKHVhLmluY2x1ZGVzKCdjaHJvbWUvJykgfHwgX2lzQ2hyb21lSU9TKHVhKSkgJiZcclxuICAgICAgICAhdWEuaW5jbHVkZXMoJ2VkZ2UvJykpIHtcclxuICAgICAgICByZXR1cm4gXCJDaHJvbWVcIiAvKiBDSFJPTUUgKi87XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChfaXNBbmRyb2lkKHVhKSkge1xyXG4gICAgICAgIC8vIEFuZHJvaWQgc3RvY2sgYnJvd3Nlci5cclxuICAgICAgICByZXR1cm4gXCJBbmRyb2lkXCIgLyogQU5EUk9JRCAqLztcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIC8vIE1vc3QgbW9kZXJuIGJyb3dzZXJzIGhhdmUgbmFtZS92ZXJzaW9uIGF0IGVuZCBvZiB1c2VyIGFnZW50IHN0cmluZy5cclxuICAgICAgICBjb25zdCByZSA9IC8oW2EtekEtWlxcZFxcLl0rKVxcL1thLXpBLVpcXGRcXC5dKiQvO1xyXG4gICAgICAgIGNvbnN0IG1hdGNoZXMgPSB1c2VyQWdlbnQubWF0Y2gocmUpO1xyXG4gICAgICAgIGlmICgobWF0Y2hlcyA9PT0gbnVsbCB8fCBtYXRjaGVzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBtYXRjaGVzLmxlbmd0aCkgPT09IDIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG1hdGNoZXNbMV07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIFwiT3RoZXJcIiAvKiBPVEhFUiAqLztcclxufVxyXG5mdW5jdGlvbiBfaXNGaXJlZm94KHVhID0gZ2V0VUEoKSkge1xyXG4gICAgcmV0dXJuIC9maXJlZm94XFwvL2kudGVzdCh1YSk7XHJcbn1cclxuZnVuY3Rpb24gX2lzU2FmYXJpKHVzZXJBZ2VudCA9IGdldFVBKCkpIHtcclxuICAgIGNvbnN0IHVhID0gdXNlckFnZW50LnRvTG93ZXJDYXNlKCk7XHJcbiAgICByZXR1cm4gKHVhLmluY2x1ZGVzKCdzYWZhcmkvJykgJiZcclxuICAgICAgICAhdWEuaW5jbHVkZXMoJ2Nocm9tZS8nKSAmJlxyXG4gICAgICAgICF1YS5pbmNsdWRlcygnY3Jpb3MvJykgJiZcclxuICAgICAgICAhdWEuaW5jbHVkZXMoJ2FuZHJvaWQnKSk7XHJcbn1cclxuZnVuY3Rpb24gX2lzQ2hyb21lSU9TKHVhID0gZ2V0VUEoKSkge1xyXG4gICAgcmV0dXJuIC9jcmlvc1xcLy9pLnRlc3QodWEpO1xyXG59XHJcbmZ1bmN0aW9uIF9pc0lFTW9iaWxlKHVhID0gZ2V0VUEoKSkge1xyXG4gICAgcmV0dXJuIC9pZW1vYmlsZS9pLnRlc3QodWEpO1xyXG59XHJcbmZ1bmN0aW9uIF9pc0FuZHJvaWQodWEgPSBnZXRVQSgpKSB7XHJcbiAgICByZXR1cm4gL2FuZHJvaWQvaS50ZXN0KHVhKTtcclxufVxyXG5mdW5jdGlvbiBfaXNCbGFja0JlcnJ5KHVhID0gZ2V0VUEoKSkge1xyXG4gICAgcmV0dXJuIC9ibGFja2JlcnJ5L2kudGVzdCh1YSk7XHJcbn1cclxuZnVuY3Rpb24gX2lzV2ViT1ModWEgPSBnZXRVQSgpKSB7XHJcbiAgICByZXR1cm4gL3dlYm9zL2kudGVzdCh1YSk7XHJcbn1cclxuZnVuY3Rpb24gX2lzSU9TKHVhID0gZ2V0VUEoKSkge1xyXG4gICAgcmV0dXJuIC9pcGhvbmV8aXBhZHxpcG9kL2kudGVzdCh1YSk7XHJcbn1cclxuZnVuY3Rpb24gX2lzSU9TN09yOCh1YSA9IGdldFVBKCkpIHtcclxuICAgIHJldHVybiAoLyhpUGFkfGlQaG9uZXxpUG9kKS4qT1MgN19cXGQvaS50ZXN0KHVhKSB8fFxyXG4gICAgICAgIC8oaVBhZHxpUGhvbmV8aVBvZCkuKk9TIDhfXFxkL2kudGVzdCh1YSkpO1xyXG59XHJcbmZ1bmN0aW9uIF9pc0lPU1N0YW5kYWxvbmUodWEgPSBnZXRVQSgpKSB7XHJcbiAgICB2YXIgX2E7XHJcbiAgICByZXR1cm4gX2lzSU9TKHVhKSAmJiAhISgoX2EgPSB3aW5kb3cubmF2aWdhdG9yKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Euc3RhbmRhbG9uZSk7XHJcbn1cclxuZnVuY3Rpb24gX2lzSUUxMCgpIHtcclxuICAgIHJldHVybiBpc0lFKCkgJiYgZG9jdW1lbnQuZG9jdW1lbnRNb2RlID09PSAxMDtcclxufVxyXG5mdW5jdGlvbiBfaXNNb2JpbGVCcm93c2VyKHVhID0gZ2V0VUEoKSkge1xyXG4gICAgLy8gVE9ETzogaW1wbGVtZW50IGdldEJyb3dzZXJOYW1lIGVxdWl2YWxlbnQgZm9yIE9TLlxyXG4gICAgcmV0dXJuIChfaXNJT1ModWEpIHx8XHJcbiAgICAgICAgX2lzQW5kcm9pZCh1YSkgfHxcclxuICAgICAgICBfaXNXZWJPUyh1YSkgfHxcclxuICAgICAgICBfaXNCbGFja0JlcnJ5KHVhKSB8fFxyXG4gICAgICAgIC93aW5kb3dzIHBob25lL2kudGVzdCh1YSkgfHxcclxuICAgICAgICBfaXNJRU1vYmlsZSh1YSkpO1xyXG59XHJcbmZ1bmN0aW9uIF9pc0lmcmFtZSgpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgLy8gQ2hlY2sgdGhhdCB0aGUgY3VycmVudCB3aW5kb3cgaXMgbm90IHRoZSB0b3Agd2luZG93LlxyXG4gICAgICAgIC8vIElmIHNvLCByZXR1cm4gdHJ1ZS5cclxuICAgICAgICByZXR1cm4gISEod2luZG93ICYmIHdpbmRvdyAhPT0gd2luZG93LnRvcCk7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKlxyXG4gKiBEZXRlcm1pbmUgdGhlIFNESyB2ZXJzaW9uIHN0cmluZ1xyXG4gKi9cclxuZnVuY3Rpb24gX2dldENsaWVudFZlcnNpb24oY2xpZW50UGxhdGZvcm0sIGZyYW1ld29ya3MgPSBbXSkge1xyXG4gICAgbGV0IHJlcG9ydGVkUGxhdGZvcm07XHJcbiAgICBzd2l0Y2ggKGNsaWVudFBsYXRmb3JtKSB7XHJcbiAgICAgICAgY2FzZSBcIkJyb3dzZXJcIiAvKiBCUk9XU0VSICovOlxyXG4gICAgICAgICAgICAvLyBJbiBhIGJyb3dzZXIgZW52aXJvbm1lbnQsIHJlcG9ydCB0aGUgYnJvd3NlciBuYW1lLlxyXG4gICAgICAgICAgICByZXBvcnRlZFBsYXRmb3JtID0gX2dldEJyb3dzZXJOYW1lKGdldFVBKCkpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIFwiV29ya2VyXCIgLyogV09SS0VSICovOlxyXG4gICAgICAgICAgICAvLyBUZWNobmljYWxseSBhIHdvcmtlciBydW5zIGZyb20gYSBicm93c2VyIGJ1dCB3ZSBuZWVkIHRvIGRpZmZlcmVudGlhdGUgYVxyXG4gICAgICAgICAgICAvLyB3b3JrZXIgZnJvbSBhIGJyb3dzZXIuXHJcbiAgICAgICAgICAgIC8vIEZvciBleGFtcGxlOiBDaHJvbWUtV29ya2VyL0pzQ29yZS80LjkuMS9GaXJlYmFzZUNvcmUtd2ViLlxyXG4gICAgICAgICAgICByZXBvcnRlZFBsYXRmb3JtID0gYCR7X2dldEJyb3dzZXJOYW1lKGdldFVBKCkpfS0ke2NsaWVudFBsYXRmb3JtfWA7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIHJlcG9ydGVkUGxhdGZvcm0gPSBjbGllbnRQbGF0Zm9ybTtcclxuICAgIH1cclxuICAgIGNvbnN0IHJlcG9ydGVkRnJhbWV3b3JrcyA9IGZyYW1ld29ya3MubGVuZ3RoXHJcbiAgICAgICAgPyBmcmFtZXdvcmtzLmpvaW4oJywnKVxyXG4gICAgICAgIDogJ0ZpcmViYXNlQ29yZS13ZWInOyAvKiBkZWZhdWx0IHZhbHVlIGlmIG5vIG90aGVyIGZyYW1ld29yayBpcyB1c2VkICovXHJcbiAgICByZXR1cm4gYCR7cmVwb3J0ZWRQbGF0Zm9ybX0vJHtcIkpzQ29yZVwiIC8qIENPUkUgKi99LyR7U0RLX1ZFUlNJT059LyR7cmVwb3J0ZWRGcmFtZXdvcmtzfWA7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuY2xhc3MgQXV0aEltcGwge1xyXG4gICAgY29uc3RydWN0b3IoYXBwLCBjb25maWcpIHtcclxuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcclxuICAgICAgICB0aGlzLmNvbmZpZyA9IGNvbmZpZztcclxuICAgICAgICB0aGlzLmN1cnJlbnRVc2VyID0gbnVsbDtcclxuICAgICAgICB0aGlzLmVtdWxhdG9yQ29uZmlnID0gbnVsbDtcclxuICAgICAgICB0aGlzLm9wZXJhdGlvbnMgPSBQcm9taXNlLnJlc29sdmUoKTtcclxuICAgICAgICB0aGlzLmF1dGhTdGF0ZVN1YnNjcmlwdGlvbiA9IG5ldyBTdWJzY3JpcHRpb24odGhpcyk7XHJcbiAgICAgICAgdGhpcy5pZFRva2VuU3Vic2NyaXB0aW9uID0gbmV3IFN1YnNjcmlwdGlvbih0aGlzKTtcclxuICAgICAgICB0aGlzLnJlZGlyZWN0VXNlciA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5pc1Byb2FjdGl2ZVJlZnJlc2hFbmFibGVkID0gZmFsc2U7XHJcbiAgICAgICAgLy8gQW55IG5ldHdvcmsgY2FsbHMgd2lsbCBzZXQgdGhpcyB0byB0cnVlIGFuZCBwcmV2ZW50IHN1YnNlcXVlbnQgZW11bGF0b3JcclxuICAgICAgICAvLyBpbml0aWFsaXphdGlvblxyXG4gICAgICAgIHRoaXMuX2NhbkluaXRFbXVsYXRvciA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5faXNJbml0aWFsaXplZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX2RlbGV0ZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9pbml0aWFsaXphdGlvblByb21pc2UgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwUmVkaXJlY3RSZXNvbHZlciA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5fZXJyb3JGYWN0b3J5ID0gX0RFRkFVTFRfQVVUSF9FUlJPUl9GQUNUT1JZO1xyXG4gICAgICAgIC8vIFRyYWNrcyB0aGUgbGFzdCBub3RpZmllZCBVSUQgZm9yIHN0YXRlIGNoYW5nZSBsaXN0ZW5lcnMgdG8gcHJldmVudFxyXG4gICAgICAgIC8vIHJlcGVhdGVkIGNhbGxzIHRvIHRoZSBjYWxsYmFja3MuIFVuZGVmaW5lZCBtZWFucyBpdCdzIG5ldmVyIGJlZW5cclxuICAgICAgICAvLyBjYWxsZWQsIHdoZXJlYXMgbnVsbCBtZWFucyBpdCdzIGJlZW4gY2FsbGVkIHdpdGggYSBzaWduZWQgb3V0IHVzZXJcclxuICAgICAgICB0aGlzLmxhc3ROb3RpZmllZFVpZCA9IHVuZGVmaW5lZDtcclxuICAgICAgICB0aGlzLmxhbmd1YWdlQ29kZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy50ZW5hbnRJZCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHsgYXBwVmVyaWZpY2F0aW9uRGlzYWJsZWRGb3JUZXN0aW5nOiBmYWxzZSB9O1xyXG4gICAgICAgIHRoaXMuZnJhbWV3b3JrcyA9IFtdO1xyXG4gICAgICAgIHRoaXMubmFtZSA9IGFwcC5uYW1lO1xyXG4gICAgICAgIHRoaXMuY2xpZW50VmVyc2lvbiA9IGNvbmZpZy5zZGtDbGllbnRWZXJzaW9uO1xyXG4gICAgfVxyXG4gICAgX2luaXRpYWxpemVXaXRoUGVyc2lzdGVuY2UocGVyc2lzdGVuY2VIaWVyYXJjaHksIHBvcHVwUmVkaXJlY3RSZXNvbHZlcikge1xyXG4gICAgICAgIGlmIChwb3B1cFJlZGlyZWN0UmVzb2x2ZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5fcG9wdXBSZWRpcmVjdFJlc29sdmVyID0gX2dldEluc3RhbmNlKHBvcHVwUmVkaXJlY3RSZXNvbHZlcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIEhhdmUgdG8gY2hlY2sgZm9yIGFwcCBkZWxldGlvbiB0aHJvdWdob3V0IGluaXRpYWxpemF0aW9uIChhZnRlciBlYWNoXHJcbiAgICAgICAgLy8gcHJvbWlzZSByZXNvbHV0aW9uKVxyXG4gICAgICAgIHRoaXMuX2luaXRpYWxpemF0aW9uUHJvbWlzZSA9IHRoaXMucXVldWUoYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9kZWxldGVkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5wZXJzaXN0ZW5jZU1hbmFnZXIgPSBhd2FpdCBQZXJzaXN0ZW5jZVVzZXJNYW5hZ2VyLmNyZWF0ZSh0aGlzLCBwZXJzaXN0ZW5jZUhpZXJhcmNoeSk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9kZWxldGVkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZSB0aGUgcmVzb2x2ZXIgZWFybHkgaWYgbmVjZXNzYXJ5IChvbmx5IGFwcGxpY2FibGUgdG8gd2ViOlxyXG4gICAgICAgICAgICAvLyB0aGlzIHdpbGwgY2F1c2UgdGhlIGlmcmFtZSB0byBsb2FkIGltbWVkaWF0ZWx5IGluIGNlcnRhaW4gY2FzZXMpXHJcbiAgICAgICAgICAgIGlmICgoX2EgPSB0aGlzLl9wb3B1cFJlZGlyZWN0UmVzb2x2ZXIpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5fc2hvdWxkSW5pdFByb2FjdGl2ZWx5KSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLl9wb3B1cFJlZGlyZWN0UmVzb2x2ZXIuX2luaXRpYWxpemUodGhpcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5pbml0aWFsaXplQ3VycmVudFVzZXIocG9wdXBSZWRpcmVjdFJlc29sdmVyKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX2RlbGV0ZWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLl9pc0luaXRpYWxpemVkID0gdHJ1ZTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gdGhpcy5faW5pdGlhbGl6YXRpb25Qcm9taXNlO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBJZiB0aGUgcGVyc2lzdGVuY2UgaXMgY2hhbmdlZCBpbiBhbm90aGVyIHdpbmRvdywgdGhlIHVzZXIgbWFuYWdlciB3aWxsIGxldCB1cyBrbm93XHJcbiAgICAgKi9cclxuICAgIGFzeW5jIF9vblN0b3JhZ2VFdmVudCgpIHtcclxuICAgICAgICBpZiAodGhpcy5fZGVsZXRlZCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCB0aGlzLmFzc2VydGVkUGVyc2lzdGVuY2UuZ2V0Q3VycmVudFVzZXIoKTtcclxuICAgICAgICBpZiAoIXRoaXMuY3VycmVudFVzZXIgJiYgIXVzZXIpIHtcclxuICAgICAgICAgICAgLy8gTm8gY2hhbmdlLCBkbyBub3RoaW5nICh3YXMgc2lnbmVkIG91dCBhbmQgcmVtYWluZWQgc2lnbmVkIG91dCkuXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gSWYgdGhlIHNhbWUgdXNlciBpcyB0byBiZSBzeW5jaHJvbml6ZWQuXHJcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudFVzZXIgJiYgdXNlciAmJiB0aGlzLmN1cnJlbnRVc2VyLnVpZCA9PT0gdXNlci51aWQpIHtcclxuICAgICAgICAgICAgLy8gRGF0YSB1cGRhdGUsIHNpbXBseSBjb3B5IGRhdGEgY2hhbmdlcy5cclxuICAgICAgICAgICAgdGhpcy5fY3VycmVudFVzZXIuX2Fzc2lnbih1c2VyKTtcclxuICAgICAgICAgICAgLy8gSWYgdG9rZW5zIGNoYW5nZWQgZnJvbSBwcmV2aW91cyB1c2VyIHRva2VucywgdGhpcyB3aWxsIHRyaWdnZXJcclxuICAgICAgICAgICAgLy8gbm90aWZ5QXV0aExpc3RlbmVyc18uXHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuY3VycmVudFVzZXIuZ2V0SWRUb2tlbigpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFVwZGF0ZSBjdXJyZW50IEF1dGggc3RhdGUuIEVpdGhlciBhIG5ldyBsb2dpbiBvciBsb2dvdXQuXHJcbiAgICAgICAgYXdhaXQgdGhpcy5fdXBkYXRlQ3VycmVudFVzZXIodXNlcik7XHJcbiAgICB9XHJcbiAgICBhc3luYyBpbml0aWFsaXplQ3VycmVudFVzZXIocG9wdXBSZWRpcmVjdFJlc29sdmVyKSB7XHJcbiAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgIC8vIEZpcnN0IGNoZWNrIHRvIHNlZSBpZiB3ZSBoYXZlIGEgcGVuZGluZyByZWRpcmVjdCBldmVudC5cclxuICAgICAgICBsZXQgc3RvcmVkVXNlciA9IChhd2FpdCB0aGlzLmFzc2VydGVkUGVyc2lzdGVuY2UuZ2V0Q3VycmVudFVzZXIoKSk7XHJcbiAgICAgICAgaWYgKHBvcHVwUmVkaXJlY3RSZXNvbHZlciAmJiB0aGlzLmNvbmZpZy5hdXRoRG9tYWluKSB7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuZ2V0T3JJbml0UmVkaXJlY3RQZXJzaXN0ZW5jZU1hbmFnZXIoKTtcclxuICAgICAgICAgICAgY29uc3QgcmVkaXJlY3RVc2VyRXZlbnRJZCA9IChfYSA9IHRoaXMucmVkaXJlY3RVc2VyKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuX3JlZGlyZWN0RXZlbnRJZDtcclxuICAgICAgICAgICAgY29uc3Qgc3RvcmVkVXNlckV2ZW50SWQgPSBzdG9yZWRVc2VyID09PSBudWxsIHx8IHN0b3JlZFVzZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHN0b3JlZFVzZXIuX3JlZGlyZWN0RXZlbnRJZDtcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy50cnlSZWRpcmVjdFNpZ25Jbihwb3B1cFJlZGlyZWN0UmVzb2x2ZXIpO1xyXG4gICAgICAgICAgICAvLyBJZiB0aGUgc3RvcmVkIHVzZXIgKGkuZS4gdGhlIG9sZCBcImN1cnJlbnRVc2VyXCIpIGhhcyBhIHJlZGlyZWN0SWQgdGhhdFxyXG4gICAgICAgICAgICAvLyBtYXRjaGVzIHRoZSByZWRpcmVjdCB1c2VyLCB0aGVuIHdlIHdhbnQgdG8gaW5pdGlhbGx5IHNpZ24gaW4gd2l0aCB0aGVcclxuICAgICAgICAgICAgLy8gbmV3IHVzZXIgb2JqZWN0IGZyb20gcmVzdWx0LlxyXG4gICAgICAgICAgICAvLyBUT0RPKHNhbWdobyk6IE1vcmUgdGhvcm91Z2hseSB0ZXN0IGFsbCBvZiB0aGlzXHJcbiAgICAgICAgICAgIGlmICgoIXJlZGlyZWN0VXNlckV2ZW50SWQgfHwgcmVkaXJlY3RVc2VyRXZlbnRJZCA9PT0gc3RvcmVkVXNlckV2ZW50SWQpICYmXHJcbiAgICAgICAgICAgICAgICAocmVzdWx0ID09PSBudWxsIHx8IHJlc3VsdCA9PT0gdm9pZCAwID8gdm9pZCAwIDogcmVzdWx0LnVzZXIpKSB7XHJcbiAgICAgICAgICAgICAgICBzdG9yZWRVc2VyID0gcmVzdWx0LnVzZXI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gSWYgbm8gdXNlciBpbiBwZXJzaXN0ZW5jZSwgdGhlcmUgaXMgbm8gY3VycmVudCB1c2VyLiBTZXQgdG8gbnVsbC5cclxuICAgICAgICBpZiAoIXN0b3JlZFVzZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGlyZWN0bHlTZXRDdXJyZW50VXNlcihudWxsKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCFzdG9yZWRVc2VyLl9yZWRpcmVjdEV2ZW50SWQpIHtcclxuICAgICAgICAgICAgLy8gVGhpcyBpc24ndCBhIHJlZGlyZWN0IHVzZXIsIHdlIGNhbiByZWxvYWQgYW5kIGJhaWxcclxuICAgICAgICAgICAgLy8gVGhpcyB3aWxsIGFsc28gY2F0Y2ggdGhlIHJlZGlyZWN0ZWQgdXNlciwgaWYgYXZhaWxhYmxlLCBhcyB0aGF0IG1ldGhvZFxyXG4gICAgICAgICAgICAvLyBzdHJpcHMgdGhlIF9yZWRpcmVjdEV2ZW50SWRcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVsb2FkQW5kU2V0Q3VycmVudFVzZXJPckNsZWFyKHN0b3JlZFVzZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBfYXNzZXJ0KHRoaXMuX3BvcHVwUmVkaXJlY3RSZXNvbHZlciwgdGhpcywgXCJhcmd1bWVudC1lcnJvclwiIC8qIEFSR1VNRU5UX0VSUk9SICovKTtcclxuICAgICAgICBhd2FpdCB0aGlzLmdldE9ySW5pdFJlZGlyZWN0UGVyc2lzdGVuY2VNYW5hZ2VyKCk7XHJcbiAgICAgICAgLy8gSWYgdGhlIHJlZGlyZWN0IHVzZXIncyBldmVudCBJRCBtYXRjaGVzIHRoZSBjdXJyZW50IHVzZXIncyBldmVudCBJRCxcclxuICAgICAgICAvLyBETyBOT1QgcmVsb2FkIHRoZSBjdXJyZW50IHVzZXIsIG90aGVyd2lzZSB0aGV5J2xsIGJlIGNsZWFyZWQgZnJvbSBzdG9yYWdlLlxyXG4gICAgICAgIC8vIFRoaXMgaXMgaW1wb3J0YW50IGZvciB0aGUgcmVhdXRoZW50aWNhdGVXaXRoUmVkaXJlY3QoKSBmbG93LlxyXG4gICAgICAgIGlmICh0aGlzLnJlZGlyZWN0VXNlciAmJlxyXG4gICAgICAgICAgICB0aGlzLnJlZGlyZWN0VXNlci5fcmVkaXJlY3RFdmVudElkID09PSBzdG9yZWRVc2VyLl9yZWRpcmVjdEV2ZW50SWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGlyZWN0bHlTZXRDdXJyZW50VXNlcihzdG9yZWRVc2VyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmVsb2FkQW5kU2V0Q3VycmVudFVzZXJPckNsZWFyKHN0b3JlZFVzZXIpO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgdHJ5UmVkaXJlY3RTaWduSW4ocmVkaXJlY3RSZXNvbHZlcikge1xyXG4gICAgICAgIC8vIFRoZSByZWRpcmVjdCB1c2VyIG5lZWRzIHRvIGJlIGNoZWNrZWQgKGFuZCBzaWduZWQgaW4gaWYgYXZhaWxhYmxlKVxyXG4gICAgICAgIC8vIGR1cmluZyBhdXRoIGluaXRpYWxpemF0aW9uLiBBbGwgb2YgdGhlIG5vcm1hbCBzaWduIGluIGFuZCBsaW5rL3JlYXV0aFxyXG4gICAgICAgIC8vIGZsb3dzIGNhbGwgYmFjayBpbnRvIGF1dGggYW5kIHB1c2ggdGhpbmdzIG9udG8gdGhlIHByb21pc2UgcXVldWUuIFdlXHJcbiAgICAgICAgLy8gbmVlZCB0byBhd2FpdCB0aGUgcmVzdWx0IG9mIHRoZSByZWRpcmVjdCBzaWduIGluICppbnNpZGUgdGhlIHByb21pc2VcclxuICAgICAgICAvLyBxdWV1ZSouIFRoaXMgcHJlc2VudHMgYSBwcm9ibGVtOiB3ZSBydW4gaW50byBkZWFkbG9jay4gU2VlOlxyXG4gICAgICAgIC8vICAgIOKUjD4gW0luaXRpYWxpemF0aW9uXSDilIDilIDilIDilIDilIDilJBcclxuICAgICAgICAvLyAgICDilIw+IFs8b3RoZXIgcXVldWUgdGFza3M+XSDilIJcclxuICAgICAgICAvLyAgICDilJTilIAgW2dldFJlZGlyZWN0UmVzdWx0XSA84pSA4pSYXHJcbiAgICAgICAgLy8gICAgd2hlcmUgW10gYXJlIHRhc2tzIG9uIHRoZSBxdWV1ZSBhbmQgYXJyb3dzIGRlbm90ZSBhd2FpdHNcclxuICAgICAgICAvLyBJbml0aWFsaXphdGlvbiB3aWxsIG5ldmVyIGNvbXBsZXRlIGJlY2F1c2UgaXQncyB3YWl0aW5nIG9uIHNvbWV0aGluZ1xyXG4gICAgICAgIC8vIHRoYXQncyB3YWl0aW5nIGZvciBpbml0aWFsaXphdGlvbiB0byBjb21wbGV0ZSFcclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vIEluc3RlYWQsIHRoaXMgbWV0aG9kIGNhbGxzIGdldFJlZGlyZWN0UmVzdWx0KCkgKHN0b3JlZCBpblxyXG4gICAgICAgIC8vIF9jb21wbGV0ZVJlZGlyZWN0Rm4pIHdpdGggYW4gb3B0aW9uYWwgcGFyYW1ldGVyIHRoYXQgaW5zdHJ1Y3RzIGFsbCBvZlxyXG4gICAgICAgIC8vIHRoZSB1bmRlcmx5aW5nIGF1dGggb3BlcmF0aW9ucyB0byBza2lwIGFueXRoaW5nIHRoYXQgbXV0YXRlcyBhdXRoIHN0YXRlLlxyXG4gICAgICAgIGxldCByZXN1bHQgPSBudWxsO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIC8vIFdlIGtub3cgdGhpcy5fcG9wdXBSZWRpcmVjdFJlc29sdmVyIGlzIHNldCBzaW5jZSByZWRpcmVjdFJlc29sdmVyXHJcbiAgICAgICAgICAgIC8vIGlzIHBhc3NlZCBpbi4gVGhlIF9jb21wbGV0ZVJlZGlyZWN0Rm4gZXhwZWN0cyB0aGUgdW53cmFwcGVkIGV4dGVybi5cclxuICAgICAgICAgICAgcmVzdWx0ID0gYXdhaXQgdGhpcy5fcG9wdXBSZWRpcmVjdFJlc29sdmVyLl9jb21wbGV0ZVJlZGlyZWN0Rm4odGhpcywgcmVkaXJlY3RSZXNvbHZlciwgdHJ1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIC8vIFN3YWxsb3cgYW55IGVycm9ycyBoZXJlOyB0aGUgY29kZSBjYW4gcmV0cmlldmUgdGhlbSBpblxyXG4gICAgICAgICAgICAvLyBnZXRSZWRpcmVjdFJlc3VsdCgpLlxyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLl9zZXRSZWRpcmVjdFVzZXIobnVsbCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcbiAgICBhc3luYyByZWxvYWRBbmRTZXRDdXJyZW50VXNlck9yQ2xlYXIodXNlcikge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGF3YWl0IF9yZWxvYWRXaXRob3V0U2F2aW5nKHVzZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICBpZiAoZS5jb2RlICE9PSBgYXV0aC8ke1wibmV0d29yay1yZXF1ZXN0LWZhaWxlZFwiIC8qIE5FVFdPUktfUkVRVUVTVF9GQUlMRUQgKi99YCkge1xyXG4gICAgICAgICAgICAgICAgLy8gU29tZXRoaW5nJ3Mgd3Jvbmcgd2l0aCB0aGUgdXNlcidzIHRva2VuLiBMb2cgdGhlbSBvdXQgYW5kIHJlbW92ZVxyXG4gICAgICAgICAgICAgICAgLy8gdGhlbSBmcm9tIHN0b3JhZ2VcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmRpcmVjdGx5U2V0Q3VycmVudFVzZXIobnVsbCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGlyZWN0bHlTZXRDdXJyZW50VXNlcih1c2VyKTtcclxuICAgIH1cclxuICAgIHVzZURldmljZUxhbmd1YWdlKCkge1xyXG4gICAgICAgIHRoaXMubGFuZ3VhZ2VDb2RlID0gX2dldFVzZXJMYW5ndWFnZSgpO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgX2RlbGV0ZSgpIHtcclxuICAgICAgICB0aGlzLl9kZWxldGVkID0gdHJ1ZTtcclxuICAgIH1cclxuICAgIGFzeW5jIHVwZGF0ZUN1cnJlbnRVc2VyKHVzZXJFeHRlcm4pIHtcclxuICAgICAgICAvLyBUaGUgcHVibGljIHVwZGF0ZUN1cnJlbnRVc2VyIG1ldGhvZCBuZWVkcyB0byBtYWtlIGEgY29weSBvZiB0aGUgdXNlcixcclxuICAgICAgICAvLyBhbmQgYWxzbyBjaGVjayB0aGF0IHRoZSBwcm9qZWN0IG1hdGNoZXNcclxuICAgICAgICBjb25zdCB1c2VyID0gdXNlckV4dGVyblxyXG4gICAgICAgICAgICA/IGdldE1vZHVsYXJJbnN0YW5jZSh1c2VyRXh0ZXJuKVxyXG4gICAgICAgICAgICA6IG51bGw7XHJcbiAgICAgICAgaWYgKHVzZXIpIHtcclxuICAgICAgICAgICAgX2Fzc2VydCh1c2VyLmF1dGguY29uZmlnLmFwaUtleSA9PT0gdGhpcy5jb25maWcuYXBpS2V5LCB0aGlzLCBcImludmFsaWQtdXNlci10b2tlblwiIC8qIElOVkFMSURfQVVUSCAqLyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLl91cGRhdGVDdXJyZW50VXNlcih1c2VyICYmIHVzZXIuX2Nsb25lKHRoaXMpKTtcclxuICAgIH1cclxuICAgIGFzeW5jIF91cGRhdGVDdXJyZW50VXNlcih1c2VyKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2RlbGV0ZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodXNlcikge1xyXG4gICAgICAgICAgICBfYXNzZXJ0KHRoaXMudGVuYW50SWQgPT09IHVzZXIudGVuYW50SWQsIHRoaXMsIFwidGVuYW50LWlkLW1pc21hdGNoXCIgLyogVEVOQU5UX0lEX01JU01BVENIICovKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucXVldWUoYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLmRpcmVjdGx5U2V0Q3VycmVudFVzZXIodXNlcik7XHJcbiAgICAgICAgICAgIHRoaXMubm90aWZ5QXV0aExpc3RlbmVycygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgc2lnbk91dCgpIHtcclxuICAgICAgICAvLyBDbGVhciB0aGUgcmVkaXJlY3QgdXNlciB3aGVuIHNpZ25PdXQgaXMgY2FsbGVkXHJcbiAgICAgICAgaWYgKHRoaXMucmVkaXJlY3RQZXJzaXN0ZW5jZU1hbmFnZXIgfHwgdGhpcy5fcG9wdXBSZWRpcmVjdFJlc29sdmVyKSB7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuX3NldFJlZGlyZWN0VXNlcihudWxsKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3VwZGF0ZUN1cnJlbnRVc2VyKG51bGwpO1xyXG4gICAgfVxyXG4gICAgc2V0UGVyc2lzdGVuY2UocGVyc2lzdGVuY2UpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5xdWV1ZShhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYXNzZXJ0ZWRQZXJzaXN0ZW5jZS5zZXRQZXJzaXN0ZW5jZShfZ2V0SW5zdGFuY2UocGVyc2lzdGVuY2UpKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIF9nZXRQZXJzaXN0ZW5jZSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5hc3NlcnRlZFBlcnNpc3RlbmNlLnBlcnNpc3RlbmNlLnR5cGU7XHJcbiAgICB9XHJcbiAgICBfdXBkYXRlRXJyb3JNYXAoZXJyb3JNYXApIHtcclxuICAgICAgICB0aGlzLl9lcnJvckZhY3RvcnkgPSBuZXcgRXJyb3JGYWN0b3J5KCdhdXRoJywgJ0ZpcmViYXNlJywgZXJyb3JNYXAoKSk7XHJcbiAgICB9XHJcbiAgICBvbkF1dGhTdGF0ZUNoYW5nZWQobmV4dE9yT2JzZXJ2ZXIsIGVycm9yLCBjb21wbGV0ZWQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5yZWdpc3RlclN0YXRlTGlzdGVuZXIodGhpcy5hdXRoU3RhdGVTdWJzY3JpcHRpb24sIG5leHRPck9ic2VydmVyLCBlcnJvciwgY29tcGxldGVkKTtcclxuICAgIH1cclxuICAgIG9uSWRUb2tlbkNoYW5nZWQobmV4dE9yT2JzZXJ2ZXIsIGVycm9yLCBjb21wbGV0ZWQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5yZWdpc3RlclN0YXRlTGlzdGVuZXIodGhpcy5pZFRva2VuU3Vic2NyaXB0aW9uLCBuZXh0T3JPYnNlcnZlciwgZXJyb3IsIGNvbXBsZXRlZCk7XHJcbiAgICB9XHJcbiAgICB0b0pTT04oKSB7XHJcbiAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGFwaUtleTogdGhpcy5jb25maWcuYXBpS2V5LFxyXG4gICAgICAgICAgICBhdXRoRG9tYWluOiB0aGlzLmNvbmZpZy5hdXRoRG9tYWluLFxyXG4gICAgICAgICAgICBhcHBOYW1lOiB0aGlzLm5hbWUsXHJcbiAgICAgICAgICAgIGN1cnJlbnRVc2VyOiAoX2EgPSB0aGlzLl9jdXJyZW50VXNlcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnRvSlNPTigpXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuICAgIGFzeW5jIF9zZXRSZWRpcmVjdFVzZXIodXNlciwgcG9wdXBSZWRpcmVjdFJlc29sdmVyKSB7XHJcbiAgICAgICAgY29uc3QgcmVkaXJlY3RNYW5hZ2VyID0gYXdhaXQgdGhpcy5nZXRPckluaXRSZWRpcmVjdFBlcnNpc3RlbmNlTWFuYWdlcihwb3B1cFJlZGlyZWN0UmVzb2x2ZXIpO1xyXG4gICAgICAgIHJldHVybiB1c2VyID09PSBudWxsXHJcbiAgICAgICAgICAgID8gcmVkaXJlY3RNYW5hZ2VyLnJlbW92ZUN1cnJlbnRVc2VyKClcclxuICAgICAgICAgICAgOiByZWRpcmVjdE1hbmFnZXIuc2V0Q3VycmVudFVzZXIodXNlcik7XHJcbiAgICB9XHJcbiAgICBhc3luYyBnZXRPckluaXRSZWRpcmVjdFBlcnNpc3RlbmNlTWFuYWdlcihwb3B1cFJlZGlyZWN0UmVzb2x2ZXIpIHtcclxuICAgICAgICBpZiAoIXRoaXMucmVkaXJlY3RQZXJzaXN0ZW5jZU1hbmFnZXIpIHtcclxuICAgICAgICAgICAgY29uc3QgcmVzb2x2ZXIgPSAocG9wdXBSZWRpcmVjdFJlc29sdmVyICYmIF9nZXRJbnN0YW5jZShwb3B1cFJlZGlyZWN0UmVzb2x2ZXIpKSB8fFxyXG4gICAgICAgICAgICAgICAgdGhpcy5fcG9wdXBSZWRpcmVjdFJlc29sdmVyO1xyXG4gICAgICAgICAgICBfYXNzZXJ0KHJlc29sdmVyLCB0aGlzLCBcImFyZ3VtZW50LWVycm9yXCIgLyogQVJHVU1FTlRfRVJST1IgKi8pO1xyXG4gICAgICAgICAgICB0aGlzLnJlZGlyZWN0UGVyc2lzdGVuY2VNYW5hZ2VyID0gYXdhaXQgUGVyc2lzdGVuY2VVc2VyTWFuYWdlci5jcmVhdGUodGhpcywgW19nZXRJbnN0YW5jZShyZXNvbHZlci5fcmVkaXJlY3RQZXJzaXN0ZW5jZSldLCBcInJlZGlyZWN0VXNlclwiIC8qIFJFRElSRUNUX1VTRVIgKi8pO1xyXG4gICAgICAgICAgICB0aGlzLnJlZGlyZWN0VXNlciA9XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnJlZGlyZWN0UGVyc2lzdGVuY2VNYW5hZ2VyLmdldEN1cnJlbnRVc2VyKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLnJlZGlyZWN0UGVyc2lzdGVuY2VNYW5hZ2VyO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgX3JlZGlyZWN0VXNlckZvcklkKGlkKSB7XHJcbiAgICAgICAgdmFyIF9hLCBfYjtcclxuICAgICAgICAvLyBNYWtlIHN1cmUgd2UndmUgY2xlYXJlZCBhbnkgcGVuZGluZyBwZXJzaXN0ZW5jZSBhY3Rpb25zIGlmIHdlJ3JlIG5vdCBpblxyXG4gICAgICAgIC8vIHRoZSBpbml0aWFsaXplclxyXG4gICAgICAgIGlmICh0aGlzLl9pc0luaXRpYWxpemVkKSB7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucXVldWUoYXN5bmMgKCkgPT4geyB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCgoX2EgPSB0aGlzLl9jdXJyZW50VXNlcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLl9yZWRpcmVjdEV2ZW50SWQpID09PSBpZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY3VycmVudFVzZXI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICgoKF9iID0gdGhpcy5yZWRpcmVjdFVzZXIpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5fcmVkaXJlY3RFdmVudElkKSA9PT0gaWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVkaXJlY3RVc2VyO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIGFzeW5jIF9wZXJzaXN0VXNlcklmQ3VycmVudCh1c2VyKSB7XHJcbiAgICAgICAgaWYgKHVzZXIgPT09IHRoaXMuY3VycmVudFVzZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucXVldWUoYXN5bmMgKCkgPT4gdGhpcy5kaXJlY3RseVNldEN1cnJlbnRVc2VyKHVzZXIpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKiogTm90aWZpZXMgbGlzdGVuZXJzIG9ubHkgaWYgdGhlIHVzZXIgaXMgY3VycmVudCAqL1xyXG4gICAgX25vdGlmeUxpc3RlbmVyc0lmQ3VycmVudCh1c2VyKSB7XHJcbiAgICAgICAgaWYgKHVzZXIgPT09IHRoaXMuY3VycmVudFVzZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5ub3RpZnlBdXRoTGlzdGVuZXJzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgX2tleSgpIHtcclxuICAgICAgICByZXR1cm4gYCR7dGhpcy5jb25maWcuYXV0aERvbWFpbn06JHt0aGlzLmNvbmZpZy5hcGlLZXl9OiR7dGhpcy5uYW1lfWA7XHJcbiAgICB9XHJcbiAgICBfc3RhcnRQcm9hY3RpdmVSZWZyZXNoKCkge1xyXG4gICAgICAgIHRoaXMuaXNQcm9hY3RpdmVSZWZyZXNoRW5hYmxlZCA9IHRydWU7XHJcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudFVzZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5fY3VycmVudFVzZXIuX3N0YXJ0UHJvYWN0aXZlUmVmcmVzaCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIF9zdG9wUHJvYWN0aXZlUmVmcmVzaCgpIHtcclxuICAgICAgICB0aGlzLmlzUHJvYWN0aXZlUmVmcmVzaEVuYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICBpZiAodGhpcy5jdXJyZW50VXNlcikge1xyXG4gICAgICAgICAgICB0aGlzLl9jdXJyZW50VXNlci5fc3RvcFByb2FjdGl2ZVJlZnJlc2goKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKiogUmV0dXJucyB0aGUgY3VycmVudCB1c2VyIGNhc3QgYXMgdGhlIGludGVybmFsIHR5cGUgKi9cclxuICAgIGdldCBfY3VycmVudFVzZXIoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY3VycmVudFVzZXI7XHJcbiAgICB9XHJcbiAgICBub3RpZnlBdXRoTGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHZhciBfYSwgX2I7XHJcbiAgICAgICAgaWYgKCF0aGlzLl9pc0luaXRpYWxpemVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pZFRva2VuU3Vic2NyaXB0aW9uLm5leHQodGhpcy5jdXJyZW50VXNlcik7XHJcbiAgICAgICAgY29uc3QgY3VycmVudFVpZCA9IChfYiA9IChfYSA9IHRoaXMuY3VycmVudFVzZXIpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS51aWQpICE9PSBudWxsICYmIF9iICE9PSB2b2lkIDAgPyBfYiA6IG51bGw7XHJcbiAgICAgICAgaWYgKHRoaXMubGFzdE5vdGlmaWVkVWlkICE9PSBjdXJyZW50VWlkKSB7XHJcbiAgICAgICAgICAgIHRoaXMubGFzdE5vdGlmaWVkVWlkID0gY3VycmVudFVpZDtcclxuICAgICAgICAgICAgdGhpcy5hdXRoU3RhdGVTdWJzY3JpcHRpb24ubmV4dCh0aGlzLmN1cnJlbnRVc2VyKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZWdpc3RlclN0YXRlTGlzdGVuZXIoc3Vic2NyaXB0aW9uLCBuZXh0T3JPYnNlcnZlciwgZXJyb3IsIGNvbXBsZXRlZCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9kZWxldGVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAoKSA9PiB7IH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGNiID0gdHlwZW9mIG5leHRPck9ic2VydmVyID09PSAnZnVuY3Rpb24nXHJcbiAgICAgICAgICAgID8gbmV4dE9yT2JzZXJ2ZXJcclxuICAgICAgICAgICAgOiBuZXh0T3JPYnNlcnZlci5uZXh0LmJpbmQobmV4dE9yT2JzZXJ2ZXIpO1xyXG4gICAgICAgIGNvbnN0IHByb21pc2UgPSB0aGlzLl9pc0luaXRpYWxpemVkXHJcbiAgICAgICAgICAgID8gUHJvbWlzZS5yZXNvbHZlKClcclxuICAgICAgICAgICAgOiB0aGlzLl9pbml0aWFsaXphdGlvblByb21pc2U7XHJcbiAgICAgICAgX2Fzc2VydChwcm9taXNlLCB0aGlzLCBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8pO1xyXG4gICAgICAgIC8vIFRoZSBjYWxsYmFjayBuZWVkcyB0byBiZSBjYWxsZWQgYXN5bmNocm9ub3VzbHkgcGVyIHRoZSBzcGVjLlxyXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZmxvYXRpbmctcHJvbWlzZXNcclxuICAgICAgICBwcm9taXNlLnRoZW4oKCkgPT4gY2IodGhpcy5jdXJyZW50VXNlcikpO1xyXG4gICAgICAgIGlmICh0eXBlb2YgbmV4dE9yT2JzZXJ2ZXIgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHN1YnNjcmlwdGlvbi5hZGRPYnNlcnZlcihuZXh0T3JPYnNlcnZlciwgZXJyb3IsIGNvbXBsZXRlZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gc3Vic2NyaXB0aW9uLmFkZE9ic2VydmVyKG5leHRPck9ic2VydmVyKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFVucHJvdGVjdGVkIChmcm9tIHJhY2UgY29uZGl0aW9ucykgbWV0aG9kIHRvIHNldCB0aGUgY3VycmVudCB1c2VyLiBUaGlzXHJcbiAgICAgKiBzaG91bGQgb25seSBiZSBjYWxsZWQgZnJvbSB3aXRoaW4gYSBxdWV1ZWQgY2FsbGJhY2suIFRoaXMgaXMgbmVjZXNzYXJ5XHJcbiAgICAgKiBiZWNhdXNlIHRoZSBxdWV1ZSBzaG91bGRuJ3QgcmVseSBvbiBhbm90aGVyIHF1ZXVlZCBjYWxsYmFjay5cclxuICAgICAqL1xyXG4gICAgYXN5bmMgZGlyZWN0bHlTZXRDdXJyZW50VXNlcih1c2VyKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudFVzZXIgJiYgdGhpcy5jdXJyZW50VXNlciAhPT0gdXNlcikge1xyXG4gICAgICAgICAgICB0aGlzLl9jdXJyZW50VXNlci5fc3RvcFByb2FjdGl2ZVJlZnJlc2goKTtcclxuICAgICAgICAgICAgaWYgKHVzZXIgJiYgdGhpcy5pc1Byb2FjdGl2ZVJlZnJlc2hFbmFibGVkKSB7XHJcbiAgICAgICAgICAgICAgICB1c2VyLl9zdGFydFByb2FjdGl2ZVJlZnJlc2goKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmN1cnJlbnRVc2VyID0gdXNlcjtcclxuICAgICAgICBpZiAodXNlcikge1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLmFzc2VydGVkUGVyc2lzdGVuY2Uuc2V0Q3VycmVudFVzZXIodXNlcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLmFzc2VydGVkUGVyc2lzdGVuY2UucmVtb3ZlQ3VycmVudFVzZXIoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBxdWV1ZShhY3Rpb24pIHtcclxuICAgICAgICAvLyBJbiBjYXNlIHNvbWV0aGluZyBlcnJvcnMsIHRoZSBjYWxsYmFjayBzdGlsbCBzaG91bGQgYmUgY2FsbGVkIGluIG9yZGVyXHJcbiAgICAgICAgLy8gdG8ga2VlcCB0aGUgcHJvbWlzZSBjaGFpbiBhbGl2ZVxyXG4gICAgICAgIHRoaXMub3BlcmF0aW9ucyA9IHRoaXMub3BlcmF0aW9ucy50aGVuKGFjdGlvbiwgYWN0aW9uKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5vcGVyYXRpb25zO1xyXG4gICAgfVxyXG4gICAgZ2V0IGFzc2VydGVkUGVyc2lzdGVuY2UoKSB7XHJcbiAgICAgICAgX2Fzc2VydCh0aGlzLnBlcnNpc3RlbmNlTWFuYWdlciwgdGhpcywgXCJpbnRlcm5hbC1lcnJvclwiIC8qIElOVEVSTkFMX0VSUk9SICovKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW5jZU1hbmFnZXI7XHJcbiAgICB9XHJcbiAgICBfbG9nRnJhbWV3b3JrKGZyYW1ld29yaykge1xyXG4gICAgICAgIGlmICghZnJhbWV3b3JrIHx8IHRoaXMuZnJhbWV3b3Jrcy5pbmNsdWRlcyhmcmFtZXdvcmspKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5mcmFtZXdvcmtzLnB1c2goZnJhbWV3b3JrKTtcclxuICAgICAgICAvLyBTb3J0IGFscGhhYmV0aWNhbGx5IHNvIHRoYXQgXCJGaXJlYmFzZUNvcmUtd2ViLEZpcmViYXNlVUktd2ViXCIgYW5kXHJcbiAgICAgICAgLy8gXCJGaXJlYmFzZVVJLXdlYixGaXJlYmFzZUNvcmUtd2ViXCIgYXJlbid0IHZpZXdlZCBhcyBkaWZmZXJlbnQuXHJcbiAgICAgICAgdGhpcy5mcmFtZXdvcmtzLnNvcnQoKTtcclxuICAgICAgICB0aGlzLmNsaWVudFZlcnNpb24gPSBfZ2V0Q2xpZW50VmVyc2lvbih0aGlzLmNvbmZpZy5jbGllbnRQbGF0Zm9ybSwgdGhpcy5fZ2V0RnJhbWV3b3JrcygpKTtcclxuICAgIH1cclxuICAgIF9nZXRGcmFtZXdvcmtzKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmZyYW1ld29ya3M7XHJcbiAgICB9XHJcbiAgICBfZ2V0U2RrQ2xpZW50VmVyc2lvbigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jbGllbnRWZXJzaW9uO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBNZXRob2QgdG8gYmUgdXNlZCB0byBjYXN0IGRvd24gdG8gb3VyIHByaXZhdGUgaW1wbG1lbnRhdGlvbiBvZiBBdXRoLlxyXG4gKiBJdCB3aWxsIGFsc28gaGFuZGxlIHVud3JhcHBpbmcgZnJvbSB0aGUgY29tcGF0IHR5cGUgaWYgbmVjZXNzYXJ5XHJcbiAqXHJcbiAqIEBwYXJhbSBhdXRoIEF1dGggb2JqZWN0IHBhc3NlZCBpbiBmcm9tIGRldmVsb3BlclxyXG4gKi9cclxuZnVuY3Rpb24gX2Nhc3RBdXRoKGF1dGgpIHtcclxuICAgIHJldHVybiBnZXRNb2R1bGFySW5zdGFuY2UoYXV0aCk7XHJcbn1cclxuLyoqIEhlbHBlciBjbGFzcyB0byB3cmFwIHN1YnNjcmliZXIgbG9naWMgKi9cclxuY2xhc3MgU3Vic2NyaXB0aW9uIHtcclxuICAgIGNvbnN0cnVjdG9yKGF1dGgpIHtcclxuICAgICAgICB0aGlzLmF1dGggPSBhdXRoO1xyXG4gICAgICAgIHRoaXMub2JzZXJ2ZXIgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuYWRkT2JzZXJ2ZXIgPSBjcmVhdGVTdWJzY3JpYmUob2JzZXJ2ZXIgPT4gKHRoaXMub2JzZXJ2ZXIgPSBvYnNlcnZlcikpO1xyXG4gICAgfVxyXG4gICAgZ2V0IG5leHQoKSB7XHJcbiAgICAgICAgX2Fzc2VydCh0aGlzLm9ic2VydmVyLCB0aGlzLmF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMub2JzZXJ2ZXIubmV4dC5iaW5kKHRoaXMub2JzZXJ2ZXIpO1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBDaGFuZ2VzIHRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UgdG8gY29tbXVuaWNhdGUgd2l0aCB0aGUgRmlyZWJhc2UgQXV0aCBFbXVsYXRvciwgaW5zdGVhZCBvZiBwcm9kdWN0aW9uXHJcbiAqIEZpcmViYXNlIEF1dGggc2VydmljZXMuXHJcbiAqXHJcbiAqIEByZW1hcmtzXHJcbiAqIFRoaXMgbXVzdCBiZSBjYWxsZWQgc3luY2hyb25vdXNseSBpbW1lZGlhdGVseSBmb2xsb3dpbmcgdGhlIGZpcnN0IGNhbGwgdG9cclxuICoge0BsaW5rIGluaXRpYWxpemVBdXRofS4gIERvIG5vdCB1c2Ugd2l0aCBwcm9kdWN0aW9uIGNyZWRlbnRpYWxzIGFzIGVtdWxhdG9yXHJcbiAqIHRyYWZmaWMgaXMgbm90IGVuY3J5cHRlZC5cclxuICpcclxuICpcclxuICogQGV4YW1wbGVcclxuICogYGBgamF2YXNjcmlwdFxyXG4gKiBjb25uZWN0QXV0aEVtdWxhdG9yKGF1dGgsICdodHRwOi8vMTI3LjAuMC4xOjkwOTknLCB7IGRpc2FibGVXYXJuaW5nczogdHJ1ZSB9KTtcclxuICogYGBgXHJcbiAqXHJcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cclxuICogQHBhcmFtIHVybCAtIFRoZSBVUkwgYXQgd2hpY2ggdGhlIGVtdWxhdG9yIGlzIHJ1bm5pbmcgKGVnLCAnaHR0cDovL2xvY2FsaG9zdDo5MDk5JykuXHJcbiAqIEBwYXJhbSBvcHRpb25zIC0gT3B0aW9uYWwuIGBvcHRpb25zLmRpc2FibGVXYXJuaW5nc2AgZGVmYXVsdHMgdG8gYGZhbHNlYC4gU2V0IGl0IHRvXHJcbiAqIGB0cnVlYCB0byBkaXNhYmxlIHRoZSB3YXJuaW5nIGJhbm5lciBhdHRhY2hlZCB0byB0aGUgRE9NLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5mdW5jdGlvbiBjb25uZWN0QXV0aEVtdWxhdG9yKGF1dGgsIHVybCwgb3B0aW9ucykge1xyXG4gICAgY29uc3QgYXV0aEludGVybmFsID0gX2Nhc3RBdXRoKGF1dGgpO1xyXG4gICAgX2Fzc2VydChhdXRoSW50ZXJuYWwuX2NhbkluaXRFbXVsYXRvciwgYXV0aEludGVybmFsLCBcImVtdWxhdG9yLWNvbmZpZy1mYWlsZWRcIiAvKiBFTVVMQVRPUl9DT05GSUdfRkFJTEVEICovKTtcclxuICAgIF9hc3NlcnQoL15odHRwcz86XFwvXFwvLy50ZXN0KHVybCksIGF1dGhJbnRlcm5hbCwgXCJpbnZhbGlkLWVtdWxhdG9yLXNjaGVtZVwiIC8qIElOVkFMSURfRU1VTEFUT1JfU0NIRU1FICovKTtcclxuICAgIGNvbnN0IGRpc2FibGVXYXJuaW5ncyA9ICEhKG9wdGlvbnMgPT09IG51bGwgfHwgb3B0aW9ucyA9PT0gdm9pZCAwID8gdm9pZCAwIDogb3B0aW9ucy5kaXNhYmxlV2FybmluZ3MpO1xyXG4gICAgY29uc3QgcHJvdG9jb2wgPSBleHRyYWN0UHJvdG9jb2wodXJsKTtcclxuICAgIGNvbnN0IHsgaG9zdCwgcG9ydCB9ID0gZXh0cmFjdEhvc3RBbmRQb3J0KHVybCk7XHJcbiAgICBjb25zdCBwb3J0U3RyID0gcG9ydCA9PT0gbnVsbCA/ICcnIDogYDoke3BvcnR9YDtcclxuICAgIC8vIEFsd2F5cyByZXBsYWNlIHBhdGggd2l0aCBcIi9cIiAoZXZlbiBpZiBpbnB1dCB1cmwgaGFkIG5vIHBhdGggYXQgYWxsLCBvciBoYWQgYSBkaWZmZXJlbnQgb25lKS5cclxuICAgIGF1dGhJbnRlcm5hbC5jb25maWcuZW11bGF0b3IgPSB7IHVybDogYCR7cHJvdG9jb2x9Ly8ke2hvc3R9JHtwb3J0U3RyfS9gIH07XHJcbiAgICBhdXRoSW50ZXJuYWwuc2V0dGluZ3MuYXBwVmVyaWZpY2F0aW9uRGlzYWJsZWRGb3JUZXN0aW5nID0gdHJ1ZTtcclxuICAgIGF1dGhJbnRlcm5hbC5lbXVsYXRvckNvbmZpZyA9IE9iamVjdC5mcmVlemUoe1xyXG4gICAgICAgIGhvc3QsXHJcbiAgICAgICAgcG9ydCxcclxuICAgICAgICBwcm90b2NvbDogcHJvdG9jb2wucmVwbGFjZSgnOicsICcnKSxcclxuICAgICAgICBvcHRpb25zOiBPYmplY3QuZnJlZXplKHsgZGlzYWJsZVdhcm5pbmdzIH0pXHJcbiAgICB9KTtcclxuICAgIGVtaXRFbXVsYXRvcldhcm5pbmcoZGlzYWJsZVdhcm5pbmdzKTtcclxufVxyXG5mdW5jdGlvbiBleHRyYWN0UHJvdG9jb2wodXJsKSB7XHJcbiAgICBjb25zdCBwcm90b2NvbEVuZCA9IHVybC5pbmRleE9mKCc6Jyk7XHJcbiAgICByZXR1cm4gcHJvdG9jb2xFbmQgPCAwID8gJycgOiB1cmwuc3Vic3RyKDAsIHByb3RvY29sRW5kICsgMSk7XHJcbn1cclxuZnVuY3Rpb24gZXh0cmFjdEhvc3RBbmRQb3J0KHVybCkge1xyXG4gICAgY29uc3QgcHJvdG9jb2wgPSBleHRyYWN0UHJvdG9jb2wodXJsKTtcclxuICAgIGNvbnN0IGF1dGhvcml0eSA9IC8oXFwvXFwvKT8oW14/Iy9dKykvLmV4ZWModXJsLnN1YnN0cihwcm90b2NvbC5sZW5ndGgpKTsgLy8gQmV0d2VlbiAvLyBhbmQgLywgPyBvciAjLlxyXG4gICAgaWYgKCFhdXRob3JpdHkpIHtcclxuICAgICAgICByZXR1cm4geyBob3N0OiAnJywgcG9ydDogbnVsbCB9O1xyXG4gICAgfVxyXG4gICAgY29uc3QgaG9zdEFuZFBvcnQgPSBhdXRob3JpdHlbMl0uc3BsaXQoJ0AnKS5wb3AoKSB8fCAnJzsgLy8gU3RyaXAgb3V0IFwidXNlcm5hbWU6cGFzc3dvcmRAXCIuXHJcbiAgICBjb25zdCBicmFja2V0ZWRJUHY2ID0gL14oXFxbW15cXF1dK1xcXSkoOnwkKS8uZXhlYyhob3N0QW5kUG9ydCk7XHJcbiAgICBpZiAoYnJhY2tldGVkSVB2Nikge1xyXG4gICAgICAgIGNvbnN0IGhvc3QgPSBicmFja2V0ZWRJUHY2WzFdO1xyXG4gICAgICAgIHJldHVybiB7IGhvc3QsIHBvcnQ6IHBhcnNlUG9ydChob3N0QW5kUG9ydC5zdWJzdHIoaG9zdC5sZW5ndGggKyAxKSkgfTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIGNvbnN0IFtob3N0LCBwb3J0XSA9IGhvc3RBbmRQb3J0LnNwbGl0KCc6Jyk7XHJcbiAgICAgICAgcmV0dXJuIHsgaG9zdCwgcG9ydDogcGFyc2VQb3J0KHBvcnQpIH07XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gcGFyc2VQb3J0KHBvcnRTdHIpIHtcclxuICAgIGlmICghcG9ydFN0cikge1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgY29uc3QgcG9ydCA9IE51bWJlcihwb3J0U3RyKTtcclxuICAgIGlmIChpc05hTihwb3J0KSkge1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHBvcnQ7XHJcbn1cclxuZnVuY3Rpb24gZW1pdEVtdWxhdG9yV2FybmluZyhkaXNhYmxlQmFubmVyKSB7XHJcbiAgICBmdW5jdGlvbiBhdHRhY2hCYW5uZXIoKSB7XHJcbiAgICAgICAgY29uc3QgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgICAgICAgY29uc3Qgc3R5ID0gZWwuc3R5bGU7XHJcbiAgICAgICAgZWwuaW5uZXJUZXh0ID1cclxuICAgICAgICAgICAgJ1J1bm5pbmcgaW4gZW11bGF0b3IgbW9kZS4gRG8gbm90IHVzZSB3aXRoIHByb2R1Y3Rpb24gY3JlZGVudGlhbHMuJztcclxuICAgICAgICBzdHkucG9zaXRpb24gPSAnZml4ZWQnO1xyXG4gICAgICAgIHN0eS53aWR0aCA9ICcxMDAlJztcclxuICAgICAgICBzdHkuYmFja2dyb3VuZENvbG9yID0gJyNmZmZmZmYnO1xyXG4gICAgICAgIHN0eS5ib3JkZXIgPSAnLjFlbSBzb2xpZCAjMDAwMDAwJztcclxuICAgICAgICBzdHkuY29sb3IgPSAnI2I1MDAwMCc7XHJcbiAgICAgICAgc3R5LmJvdHRvbSA9ICcwcHgnO1xyXG4gICAgICAgIHN0eS5sZWZ0ID0gJzBweCc7XHJcbiAgICAgICAgc3R5Lm1hcmdpbiA9ICcwcHgnO1xyXG4gICAgICAgIHN0eS56SW5kZXggPSAnMTAwMDAnO1xyXG4gICAgICAgIHN0eS50ZXh0QWxpZ24gPSAnY2VudGVyJztcclxuICAgICAgICBlbC5jbGFzc0xpc3QuYWRkKCdmaXJlYmFzZS1lbXVsYXRvci13YXJuaW5nJyk7XHJcbiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlbCk7XHJcbiAgICB9XHJcbiAgICBpZiAodHlwZW9mIGNvbnNvbGUgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBjb25zb2xlLmluZm8gPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICBjb25zb2xlLmluZm8oJ1dBUk5JTkc6IFlvdSBhcmUgdXNpbmcgdGhlIEF1dGggRW11bGF0b3IsJyArXHJcbiAgICAgICAgICAgICcgd2hpY2ggaXMgaW50ZW5kZWQgZm9yIGxvY2FsIHRlc3Rpbmcgb25seS4gIERvIG5vdCB1c2Ugd2l0aCcgK1xyXG4gICAgICAgICAgICAnIHByb2R1Y3Rpb24gY3JlZGVudGlhbHMuJyk7XHJcbiAgICB9XHJcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiZcclxuICAgICAgICB0eXBlb2YgZG9jdW1lbnQgIT09ICd1bmRlZmluZWQnICYmXHJcbiAgICAgICAgIWRpc2FibGVCYW5uZXIpIHtcclxuICAgICAgICBpZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gJ2xvYWRpbmcnKSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgYXR0YWNoQmFubmVyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGF0dGFjaEJhbm5lcigpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogSW50ZXJmYWNlIHRoYXQgcmVwcmVzZW50cyB0aGUgY3JlZGVudGlhbHMgcmV0dXJuZWQgYnkgYW4ge0BsaW5rIEF1dGhQcm92aWRlcn0uXHJcbiAqXHJcbiAqIEByZW1hcmtzXHJcbiAqIEltcGxlbWVudGF0aW9ucyBzcGVjaWZ5IHRoZSBkZXRhaWxzIGFib3V0IGVhY2ggYXV0aCBwcm92aWRlcidzIGNyZWRlbnRpYWwgcmVxdWlyZW1lbnRzLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5jbGFzcyBBdXRoQ3JlZGVudGlhbCB7XHJcbiAgICAvKiogQGludGVybmFsICovXHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgIC8qKlxyXG4gICAgICogVGhlIGF1dGhlbnRpY2F0aW9uIHByb3ZpZGVyIElEIGZvciB0aGUgY3JlZGVudGlhbC5cclxuICAgICAqXHJcbiAgICAgKiBAcmVtYXJrc1xyXG4gICAgICogRm9yIGV4YW1wbGUsICdmYWNlYm9vay5jb20nLCBvciAnZ29vZ2xlLmNvbScuXHJcbiAgICAgKi9cclxuICAgIHByb3ZpZGVySWQsIFxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgYXV0aGVudGljYXRpb24gc2lnbiBpbiBtZXRob2QgZm9yIHRoZSBjcmVkZW50aWFsLlxyXG4gICAgICpcclxuICAgICAqIEByZW1hcmtzXHJcbiAgICAgKiBGb3IgZXhhbXBsZSwge0BsaW5rIFNpZ25Jbk1ldGhvZH0uRU1BSUxfUEFTU1dPUkQsIG9yXHJcbiAgICAgKiB7QGxpbmsgU2lnbkluTWV0aG9kfS5FTUFJTF9MSU5LLiBUaGlzIGNvcnJlc3BvbmRzIHRvIHRoZSBzaWduLWluIG1ldGhvZFxyXG4gICAgICogaWRlbnRpZmllciBhcyByZXR1cm5lZCBpbiB7QGxpbmsgZmV0Y2hTaWduSW5NZXRob2RzRm9yRW1haWx9LlxyXG4gICAgICovXHJcbiAgICBzaWduSW5NZXRob2QpIHtcclxuICAgICAgICB0aGlzLnByb3ZpZGVySWQgPSBwcm92aWRlcklkO1xyXG4gICAgICAgIHRoaXMuc2lnbkluTWV0aG9kID0gc2lnbkluTWV0aG9kO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIGEgSlNPTi1zZXJpYWxpemFibGUgcmVwcmVzZW50YXRpb24gb2YgdGhpcyBvYmplY3QuXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybnMgYSBKU09OLXNlcmlhbGl6YWJsZSByZXByZXNlbnRhdGlvbiBvZiB0aGlzIG9iamVjdC5cclxuICAgICAqL1xyXG4gICAgdG9KU09OKCkge1xyXG4gICAgICAgIHJldHVybiBkZWJ1Z0ZhaWwoJ25vdCBpbXBsZW1lbnRlZCcpO1xyXG4gICAgfVxyXG4gICAgLyoqIEBpbnRlcm5hbCAqL1xyXG4gICAgX2dldElkVG9rZW5SZXNwb25zZShfYXV0aCkge1xyXG4gICAgICAgIHJldHVybiBkZWJ1Z0ZhaWwoJ25vdCBpbXBsZW1lbnRlZCcpO1xyXG4gICAgfVxyXG4gICAgLyoqIEBpbnRlcm5hbCAqL1xyXG4gICAgX2xpbmtUb0lkVG9rZW4oX2F1dGgsIF9pZFRva2VuKSB7XHJcbiAgICAgICAgcmV0dXJuIGRlYnVnRmFpbCgnbm90IGltcGxlbWVudGVkJyk7XHJcbiAgICB9XHJcbiAgICAvKiogQGludGVybmFsICovXHJcbiAgICBfZ2V0UmVhdXRoZW50aWNhdGlvblJlc29sdmVyKF9hdXRoKSB7XHJcbiAgICAgICAgcmV0dXJuIGRlYnVnRmFpbCgnbm90IGltcGxlbWVudGVkJyk7XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gcmVzZXRQYXNzd29yZChhdXRoLCByZXF1ZXN0KSB7XHJcbiAgICByZXR1cm4gX3BlcmZvcm1BcGlSZXF1ZXN0KGF1dGgsIFwiUE9TVFwiIC8qIFBPU1QgKi8sIFwiL3YxL2FjY291bnRzOnJlc2V0UGFzc3dvcmRcIiAvKiBSRVNFVF9QQVNTV09SRCAqLywgX2FkZFRpZElmTmVjZXNzYXJ5KGF1dGgsIHJlcXVlc3QpKTtcclxufVxyXG5hc3luYyBmdW5jdGlvbiB1cGRhdGVFbWFpbFBhc3N3b3JkKGF1dGgsIHJlcXVlc3QpIHtcclxuICAgIHJldHVybiBfcGVyZm9ybUFwaVJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogUE9TVCAqLywgXCIvdjEvYWNjb3VudHM6dXBkYXRlXCIgLyogU0VUX0FDQ09VTlRfSU5GTyAqLywgcmVxdWVzdCk7XHJcbn1cclxuYXN5bmMgZnVuY3Rpb24gYXBwbHlBY3Rpb25Db2RlJDEoYXV0aCwgcmVxdWVzdCkge1xyXG4gICAgcmV0dXJuIF9wZXJmb3JtQXBpUmVxdWVzdChhdXRoLCBcIlBPU1RcIiAvKiBQT1NUICovLCBcIi92MS9hY2NvdW50czp1cGRhdGVcIiAvKiBTRVRfQUNDT1VOVF9JTkZPICovLCBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdCkpO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIHNpZ25JbldpdGhQYXNzd29yZChhdXRoLCByZXF1ZXN0KSB7XHJcbiAgICByZXR1cm4gX3BlcmZvcm1TaWduSW5SZXF1ZXN0KGF1dGgsIFwiUE9TVFwiIC8qIFBPU1QgKi8sIFwiL3YxL2FjY291bnRzOnNpZ25JbldpdGhQYXNzd29yZFwiIC8qIFNJR05fSU5fV0lUSF9QQVNTV09SRCAqLywgX2FkZFRpZElmTmVjZXNzYXJ5KGF1dGgsIHJlcXVlc3QpKTtcclxufVxyXG5hc3luYyBmdW5jdGlvbiBzZW5kT29iQ29kZShhdXRoLCByZXF1ZXN0KSB7XHJcbiAgICByZXR1cm4gX3BlcmZvcm1BcGlSZXF1ZXN0KGF1dGgsIFwiUE9TVFwiIC8qIFBPU1QgKi8sIFwiL3YxL2FjY291bnRzOnNlbmRPb2JDb2RlXCIgLyogU0VORF9PT0JfQ09ERSAqLywgX2FkZFRpZElmTmVjZXNzYXJ5KGF1dGgsIHJlcXVlc3QpKTtcclxufVxyXG5hc3luYyBmdW5jdGlvbiBzZW5kRW1haWxWZXJpZmljYXRpb24kMShhdXRoLCByZXF1ZXN0KSB7XHJcbiAgICByZXR1cm4gc2VuZE9vYkNvZGUoYXV0aCwgcmVxdWVzdCk7XHJcbn1cclxuYXN5bmMgZnVuY3Rpb24gc2VuZFBhc3N3b3JkUmVzZXRFbWFpbCQxKGF1dGgsIHJlcXVlc3QpIHtcclxuICAgIHJldHVybiBzZW5kT29iQ29kZShhdXRoLCByZXF1ZXN0KTtcclxufVxyXG5hc3luYyBmdW5jdGlvbiBzZW5kU2lnbkluTGlua1RvRW1haWwkMShhdXRoLCByZXF1ZXN0KSB7XHJcbiAgICByZXR1cm4gc2VuZE9vYkNvZGUoYXV0aCwgcmVxdWVzdCk7XHJcbn1cclxuYXN5bmMgZnVuY3Rpb24gdmVyaWZ5QW5kQ2hhbmdlRW1haWwoYXV0aCwgcmVxdWVzdCkge1xyXG4gICAgcmV0dXJuIHNlbmRPb2JDb2RlKGF1dGgsIHJlcXVlc3QpO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIHNpZ25JbldpdGhFbWFpbExpbmskMShhdXRoLCByZXF1ZXN0KSB7XHJcbiAgICByZXR1cm4gX3BlcmZvcm1TaWduSW5SZXF1ZXN0KGF1dGgsIFwiUE9TVFwiIC8qIFBPU1QgKi8sIFwiL3YxL2FjY291bnRzOnNpZ25JbldpdGhFbWFpbExpbmtcIiAvKiBTSUdOX0lOX1dJVEhfRU1BSUxfTElOSyAqLywgX2FkZFRpZElmTmVjZXNzYXJ5KGF1dGgsIHJlcXVlc3QpKTtcclxufVxyXG5hc3luYyBmdW5jdGlvbiBzaWduSW5XaXRoRW1haWxMaW5rRm9yTGlua2luZyhhdXRoLCByZXF1ZXN0KSB7XHJcbiAgICByZXR1cm4gX3BlcmZvcm1TaWduSW5SZXF1ZXN0KGF1dGgsIFwiUE9TVFwiIC8qIFBPU1QgKi8sIFwiL3YxL2FjY291bnRzOnNpZ25JbldpdGhFbWFpbExpbmtcIiAvKiBTSUdOX0lOX1dJVEhfRU1BSUxfTElOSyAqLywgX2FkZFRpZElmTmVjZXNzYXJ5KGF1dGgsIHJlcXVlc3QpKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogSW50ZXJmYWNlIHRoYXQgcmVwcmVzZW50cyB0aGUgY3JlZGVudGlhbHMgcmV0dXJuZWQgYnkge0BsaW5rIEVtYWlsQXV0aFByb3ZpZGVyfSBmb3JcclxuICoge0BsaW5rIFByb3ZpZGVySWR9LlBBU1NXT1JEXHJcbiAqXHJcbiAqIEByZW1hcmtzXHJcbiAqIENvdmVycyBib3RoIHtAbGluayBTaWduSW5NZXRob2R9LkVNQUlMX1BBU1NXT1JEIGFuZFxyXG4gKiB7QGxpbmsgU2lnbkluTWV0aG9kfS5FTUFJTF9MSU5LLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5jbGFzcyBFbWFpbEF1dGhDcmVkZW50aWFsIGV4dGVuZHMgQXV0aENyZWRlbnRpYWwge1xyXG4gICAgLyoqIEBpbnRlcm5hbCAqL1xyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAvKiogQGludGVybmFsICovXHJcbiAgICBfZW1haWwsIFxyXG4gICAgLyoqIEBpbnRlcm5hbCAqL1xyXG4gICAgX3Bhc3N3b3JkLCBzaWduSW5NZXRob2QsIFxyXG4gICAgLyoqIEBpbnRlcm5hbCAqL1xyXG4gICAgX3RlbmFudElkID0gbnVsbCkge1xyXG4gICAgICAgIHN1cGVyKFwicGFzc3dvcmRcIiAvKiBQQVNTV09SRCAqLywgc2lnbkluTWV0aG9kKTtcclxuICAgICAgICB0aGlzLl9lbWFpbCA9IF9lbWFpbDtcclxuICAgICAgICB0aGlzLl9wYXNzd29yZCA9IF9wYXNzd29yZDtcclxuICAgICAgICB0aGlzLl90ZW5hbnRJZCA9IF90ZW5hbnRJZDtcclxuICAgIH1cclxuICAgIC8qKiBAaW50ZXJuYWwgKi9cclxuICAgIHN0YXRpYyBfZnJvbUVtYWlsQW5kUGFzc3dvcmQoZW1haWwsIHBhc3N3b3JkKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBFbWFpbEF1dGhDcmVkZW50aWFsKGVtYWlsLCBwYXNzd29yZCwgXCJwYXNzd29yZFwiIC8qIEVNQUlMX1BBU1NXT1JEICovKTtcclxuICAgIH1cclxuICAgIC8qKiBAaW50ZXJuYWwgKi9cclxuICAgIHN0YXRpYyBfZnJvbUVtYWlsQW5kQ29kZShlbWFpbCwgb29iQ29kZSwgdGVuYW50SWQgPSBudWxsKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBFbWFpbEF1dGhDcmVkZW50aWFsKGVtYWlsLCBvb2JDb2RlLCBcImVtYWlsTGlua1wiIC8qIEVNQUlMX0xJTksgKi8sIHRlbmFudElkKTtcclxuICAgIH1cclxuICAgIC8qKiB7QGluaGVyaXRkb2MgQXV0aENyZWRlbnRpYWwudG9KU09OfSAqL1xyXG4gICAgdG9KU09OKCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGVtYWlsOiB0aGlzLl9lbWFpbCxcclxuICAgICAgICAgICAgcGFzc3dvcmQ6IHRoaXMuX3Bhc3N3b3JkLFxyXG4gICAgICAgICAgICBzaWduSW5NZXRob2Q6IHRoaXMuc2lnbkluTWV0aG9kLFxyXG4gICAgICAgICAgICB0ZW5hbnRJZDogdGhpcy5fdGVuYW50SWRcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBTdGF0aWMgbWV0aG9kIHRvIGRlc2VyaWFsaXplIGEgSlNPTiByZXByZXNlbnRhdGlvbiBvZiBhbiBvYmplY3QgaW50byBhbiB7QGxpbmsgIEF1dGhDcmVkZW50aWFsfS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ganNvbiAtIEVpdGhlciBgb2JqZWN0YCBvciB0aGUgc3RyaW5naWZpZWQgcmVwcmVzZW50YXRpb24gb2YgdGhlIG9iamVjdC4gV2hlbiBzdHJpbmcgaXNcclxuICAgICAqIHByb3ZpZGVkLCBgSlNPTi5wYXJzZWAgd291bGQgYmUgY2FsbGVkIGZpcnN0LlxyXG4gICAgICpcclxuICAgICAqIEByZXR1cm5zIElmIHRoZSBKU09OIGlucHV0IGRvZXMgbm90IHJlcHJlc2VudCBhbiB7QGxpbmsgQXV0aENyZWRlbnRpYWx9LCBudWxsIGlzIHJldHVybmVkLlxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgZnJvbUpTT04oanNvbikge1xyXG4gICAgICAgIGNvbnN0IG9iaiA9IHR5cGVvZiBqc29uID09PSAnc3RyaW5nJyA/IEpTT04ucGFyc2UoanNvbikgOiBqc29uO1xyXG4gICAgICAgIGlmICgob2JqID09PSBudWxsIHx8IG9iaiA9PT0gdm9pZCAwID8gdm9pZCAwIDogb2JqLmVtYWlsKSAmJiAob2JqID09PSBudWxsIHx8IG9iaiA9PT0gdm9pZCAwID8gdm9pZCAwIDogb2JqLnBhc3N3b3JkKSkge1xyXG4gICAgICAgICAgICBpZiAob2JqLnNpZ25Jbk1ldGhvZCA9PT0gXCJwYXNzd29yZFwiIC8qIEVNQUlMX1BBU1NXT1JEICovKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZnJvbUVtYWlsQW5kUGFzc3dvcmQob2JqLmVtYWlsLCBvYmoucGFzc3dvcmQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKG9iai5zaWduSW5NZXRob2QgPT09IFwiZW1haWxMaW5rXCIgLyogRU1BSUxfTElOSyAqLykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2Zyb21FbWFpbEFuZENvZGUob2JqLmVtYWlsLCBvYmoucGFzc3dvcmQsIG9iai50ZW5hbnRJZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgICAvKiogQGludGVybmFsICovXHJcbiAgICBhc3luYyBfZ2V0SWRUb2tlblJlc3BvbnNlKGF1dGgpIHtcclxuICAgICAgICBzd2l0Y2ggKHRoaXMuc2lnbkluTWV0aG9kKSB7XHJcbiAgICAgICAgICAgIGNhc2UgXCJwYXNzd29yZFwiIC8qIEVNQUlMX1BBU1NXT1JEICovOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNpZ25JbldpdGhQYXNzd29yZChhdXRoLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuU2VjdXJlVG9rZW46IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgZW1haWw6IHRoaXMuX2VtYWlsLFxyXG4gICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiB0aGlzLl9wYXNzd29yZFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGNhc2UgXCJlbWFpbExpbmtcIiAvKiBFTUFJTF9MSU5LICovOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNpZ25JbldpdGhFbWFpbExpbmskMShhdXRoLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgZW1haWw6IHRoaXMuX2VtYWlsLFxyXG4gICAgICAgICAgICAgICAgICAgIG9vYkNvZGU6IHRoaXMuX3Bhc3N3b3JkXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIF9mYWlsKGF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqIEBpbnRlcm5hbCAqL1xyXG4gICAgYXN5bmMgX2xpbmtUb0lkVG9rZW4oYXV0aCwgaWRUb2tlbikge1xyXG4gICAgICAgIHN3aXRjaCAodGhpcy5zaWduSW5NZXRob2QpIHtcclxuICAgICAgICAgICAgY2FzZSBcInBhc3N3b3JkXCIgLyogRU1BSUxfUEFTU1dPUkQgKi86XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdXBkYXRlRW1haWxQYXNzd29yZChhdXRoLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWRUb2tlbixcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5TZWN1cmVUb2tlbjogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBlbWFpbDogdGhpcy5fZW1haWwsXHJcbiAgICAgICAgICAgICAgICAgICAgcGFzc3dvcmQ6IHRoaXMuX3Bhc3N3b3JkXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgY2FzZSBcImVtYWlsTGlua1wiIC8qIEVNQUlMX0xJTksgKi86XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc2lnbkluV2l0aEVtYWlsTGlua0ZvckxpbmtpbmcoYXV0aCwge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkVG9rZW4sXHJcbiAgICAgICAgICAgICAgICAgICAgZW1haWw6IHRoaXMuX2VtYWlsLFxyXG4gICAgICAgICAgICAgICAgICAgIG9vYkNvZGU6IHRoaXMuX3Bhc3N3b3JkXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIF9mYWlsKGF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqIEBpbnRlcm5hbCAqL1xyXG4gICAgX2dldFJlYXV0aGVudGljYXRpb25SZXNvbHZlcihhdXRoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2dldElkVG9rZW5SZXNwb25zZShhdXRoKTtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBzaWduSW5XaXRoSWRwKGF1dGgsIHJlcXVlc3QpIHtcclxuICAgIHJldHVybiBfcGVyZm9ybVNpZ25JblJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogUE9TVCAqLywgXCIvdjEvYWNjb3VudHM6c2lnbkluV2l0aElkcFwiIC8qIFNJR05fSU5fV0lUSF9JRFAgKi8sIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCByZXF1ZXN0KSk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuY29uc3QgSURQX1JFUVVFU1RfVVJJJDEgPSAnaHR0cDovL2xvY2FsaG9zdCc7XHJcbi8qKlxyXG4gKiBSZXByZXNlbnRzIHRoZSBPQXV0aCBjcmVkZW50aWFscyByZXR1cm5lZCBieSBhbiB7QGxpbmsgT0F1dGhQcm92aWRlcn0uXHJcbiAqXHJcbiAqIEByZW1hcmtzXHJcbiAqIEltcGxlbWVudGF0aW9ucyBzcGVjaWZ5IHRoZSBkZXRhaWxzIGFib3V0IGVhY2ggYXV0aCBwcm92aWRlcidzIGNyZWRlbnRpYWwgcmVxdWlyZW1lbnRzLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5jbGFzcyBPQXV0aENyZWRlbnRpYWwgZXh0ZW5kcyBBdXRoQ3JlZGVudGlhbCB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlciguLi5hcmd1bWVudHMpO1xyXG4gICAgICAgIHRoaXMucGVuZGluZ1Rva2VuID0gbnVsbDtcclxuICAgIH1cclxuICAgIC8qKiBAaW50ZXJuYWwgKi9cclxuICAgIHN0YXRpYyBfZnJvbVBhcmFtcyhwYXJhbXMpIHtcclxuICAgICAgICBjb25zdCBjcmVkID0gbmV3IE9BdXRoQ3JlZGVudGlhbChwYXJhbXMucHJvdmlkZXJJZCwgcGFyYW1zLnNpZ25Jbk1ldGhvZCk7XHJcbiAgICAgICAgaWYgKHBhcmFtcy5pZFRva2VuIHx8IHBhcmFtcy5hY2Nlc3NUb2tlbikge1xyXG4gICAgICAgICAgICAvLyBPQXV0aCAyIGFuZCBlaXRoZXIgSUQgdG9rZW4gb3IgYWNjZXNzIHRva2VuLlxyXG4gICAgICAgICAgICBpZiAocGFyYW1zLmlkVG9rZW4pIHtcclxuICAgICAgICAgICAgICAgIGNyZWQuaWRUb2tlbiA9IHBhcmFtcy5pZFRva2VuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChwYXJhbXMuYWNjZXNzVG9rZW4pIHtcclxuICAgICAgICAgICAgICAgIGNyZWQuYWNjZXNzVG9rZW4gPSBwYXJhbXMuYWNjZXNzVG9rZW47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gQWRkIG5vbmNlIGlmIGF2YWlsYWJsZSBhbmQgbm8gcGVuZGluZ1Rva2VuIGlzIHByZXNlbnQuXHJcbiAgICAgICAgICAgIGlmIChwYXJhbXMubm9uY2UgJiYgIXBhcmFtcy5wZW5kaW5nVG9rZW4pIHtcclxuICAgICAgICAgICAgICAgIGNyZWQubm9uY2UgPSBwYXJhbXMubm9uY2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHBhcmFtcy5wZW5kaW5nVG9rZW4pIHtcclxuICAgICAgICAgICAgICAgIGNyZWQucGVuZGluZ1Rva2VuID0gcGFyYW1zLnBlbmRpbmdUb2tlbjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChwYXJhbXMub2F1dGhUb2tlbiAmJiBwYXJhbXMub2F1dGhUb2tlblNlY3JldCkge1xyXG4gICAgICAgICAgICAvLyBPQXV0aCAxIGFuZCBPQXV0aCB0b2tlbiB3aXRoIHRva2VuIHNlY3JldFxyXG4gICAgICAgICAgICBjcmVkLmFjY2Vzc1Rva2VuID0gcGFyYW1zLm9hdXRoVG9rZW47XHJcbiAgICAgICAgICAgIGNyZWQuc2VjcmV0ID0gcGFyYW1zLm9hdXRoVG9rZW5TZWNyZXQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBfZmFpbChcImFyZ3VtZW50LWVycm9yXCIgLyogQVJHVU1FTlRfRVJST1IgKi8pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gY3JlZDtcclxuICAgIH1cclxuICAgIC8qKiB7QGluaGVyaXRkb2MgQXV0aENyZWRlbnRpYWwudG9KU09OfSAgKi9cclxuICAgIHRvSlNPTigpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBpZFRva2VuOiB0aGlzLmlkVG9rZW4sXHJcbiAgICAgICAgICAgIGFjY2Vzc1Rva2VuOiB0aGlzLmFjY2Vzc1Rva2VuLFxyXG4gICAgICAgICAgICBzZWNyZXQ6IHRoaXMuc2VjcmV0LFxyXG4gICAgICAgICAgICBub25jZTogdGhpcy5ub25jZSxcclxuICAgICAgICAgICAgcGVuZGluZ1Rva2VuOiB0aGlzLnBlbmRpbmdUb2tlbixcclxuICAgICAgICAgICAgcHJvdmlkZXJJZDogdGhpcy5wcm92aWRlcklkLFxyXG4gICAgICAgICAgICBzaWduSW5NZXRob2Q6IHRoaXMuc2lnbkluTWV0aG9kXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogU3RhdGljIG1ldGhvZCB0byBkZXNlcmlhbGl6ZSBhIEpTT04gcmVwcmVzZW50YXRpb24gb2YgYW4gb2JqZWN0IGludG8gYW5cclxuICAgICAqIHtAbGluayAgQXV0aENyZWRlbnRpYWx9LlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBqc29uIC0gSW5wdXQgY2FuIGJlIGVpdGhlciBPYmplY3Qgb3IgdGhlIHN0cmluZ2lmaWVkIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBvYmplY3QuXHJcbiAgICAgKiBXaGVuIHN0cmluZyBpcyBwcm92aWRlZCwgSlNPTi5wYXJzZSB3b3VsZCBiZSBjYWxsZWQgZmlyc3QuXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybnMgSWYgdGhlIEpTT04gaW5wdXQgZG9lcyBub3QgcmVwcmVzZW50IGFuIHtAbGluayAgQXV0aENyZWRlbnRpYWx9LCBudWxsIGlzIHJldHVybmVkLlxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgZnJvbUpTT04oanNvbikge1xyXG4gICAgICAgIGNvbnN0IG9iaiA9IHR5cGVvZiBqc29uID09PSAnc3RyaW5nJyA/IEpTT04ucGFyc2UoanNvbikgOiBqc29uO1xyXG4gICAgICAgIGNvbnN0IHsgcHJvdmlkZXJJZCwgc2lnbkluTWV0aG9kIH0gPSBvYmosIHJlc3QgPSBfX3Jlc3Qob2JqLCBbXCJwcm92aWRlcklkXCIsIFwic2lnbkluTWV0aG9kXCJdKTtcclxuICAgICAgICBpZiAoIXByb3ZpZGVySWQgfHwgIXNpZ25Jbk1ldGhvZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgY3JlZCA9IG5ldyBPQXV0aENyZWRlbnRpYWwocHJvdmlkZXJJZCwgc2lnbkluTWV0aG9kKTtcclxuICAgICAgICBPYmplY3QuYXNzaWduKGNyZWQsIHJlc3QpO1xyXG4gICAgICAgIHJldHVybiBjcmVkO1xyXG4gICAgfVxyXG4gICAgLyoqIEBpbnRlcm5hbCAqL1xyXG4gICAgX2dldElkVG9rZW5SZXNwb25zZShhdXRoKSB7XHJcbiAgICAgICAgY29uc3QgcmVxdWVzdCA9IHRoaXMuYnVpbGRSZXF1ZXN0KCk7XHJcbiAgICAgICAgcmV0dXJuIHNpZ25JbldpdGhJZHAoYXV0aCwgcmVxdWVzdCk7XHJcbiAgICB9XHJcbiAgICAvKiogQGludGVybmFsICovXHJcbiAgICBfbGlua1RvSWRUb2tlbihhdXRoLCBpZFRva2VuKSB7XHJcbiAgICAgICAgY29uc3QgcmVxdWVzdCA9IHRoaXMuYnVpbGRSZXF1ZXN0KCk7XHJcbiAgICAgICAgcmVxdWVzdC5pZFRva2VuID0gaWRUb2tlbjtcclxuICAgICAgICByZXR1cm4gc2lnbkluV2l0aElkcChhdXRoLCByZXF1ZXN0KTtcclxuICAgIH1cclxuICAgIC8qKiBAaW50ZXJuYWwgKi9cclxuICAgIF9nZXRSZWF1dGhlbnRpY2F0aW9uUmVzb2x2ZXIoYXV0aCkge1xyXG4gICAgICAgIGNvbnN0IHJlcXVlc3QgPSB0aGlzLmJ1aWxkUmVxdWVzdCgpO1xyXG4gICAgICAgIHJlcXVlc3QuYXV0b0NyZWF0ZSA9IGZhbHNlO1xyXG4gICAgICAgIHJldHVybiBzaWduSW5XaXRoSWRwKGF1dGgsIHJlcXVlc3QpO1xyXG4gICAgfVxyXG4gICAgYnVpbGRSZXF1ZXN0KCkge1xyXG4gICAgICAgIGNvbnN0IHJlcXVlc3QgPSB7XHJcbiAgICAgICAgICAgIHJlcXVlc3RVcmk6IElEUF9SRVFVRVNUX1VSSSQxLFxyXG4gICAgICAgICAgICByZXR1cm5TZWN1cmVUb2tlbjogdHJ1ZVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgaWYgKHRoaXMucGVuZGluZ1Rva2VuKSB7XHJcbiAgICAgICAgICAgIHJlcXVlc3QucGVuZGluZ1Rva2VuID0gdGhpcy5wZW5kaW5nVG9rZW47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCBwb3N0Qm9keSA9IHt9O1xyXG4gICAgICAgICAgICBpZiAodGhpcy5pZFRva2VuKSB7XHJcbiAgICAgICAgICAgICAgICBwb3N0Qm9keVsnaWRfdG9rZW4nXSA9IHRoaXMuaWRUb2tlbjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy5hY2Nlc3NUb2tlbikge1xyXG4gICAgICAgICAgICAgICAgcG9zdEJvZHlbJ2FjY2Vzc190b2tlbiddID0gdGhpcy5hY2Nlc3NUb2tlbjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy5zZWNyZXQpIHtcclxuICAgICAgICAgICAgICAgIHBvc3RCb2R5WydvYXV0aF90b2tlbl9zZWNyZXQnXSA9IHRoaXMuc2VjcmV0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHBvc3RCb2R5Wydwcm92aWRlcklkJ10gPSB0aGlzLnByb3ZpZGVySWQ7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm5vbmNlICYmICF0aGlzLnBlbmRpbmdUb2tlbikge1xyXG4gICAgICAgICAgICAgICAgcG9zdEJvZHlbJ25vbmNlJ10gPSB0aGlzLm5vbmNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJlcXVlc3QucG9zdEJvZHkgPSBxdWVyeXN0cmluZyhwb3N0Qm9keSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXF1ZXN0O1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIHNlbmRQaG9uZVZlcmlmaWNhdGlvbkNvZGUoYXV0aCwgcmVxdWVzdCkge1xyXG4gICAgcmV0dXJuIF9wZXJmb3JtQXBpUmVxdWVzdChhdXRoLCBcIlBPU1RcIiAvKiBQT1NUICovLCBcIi92MS9hY2NvdW50czpzZW5kVmVyaWZpY2F0aW9uQ29kZVwiIC8qIFNFTkRfVkVSSUZJQ0FUSU9OX0NPREUgKi8sIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCByZXF1ZXN0KSk7XHJcbn1cclxuYXN5bmMgZnVuY3Rpb24gc2lnbkluV2l0aFBob25lTnVtYmVyJDEoYXV0aCwgcmVxdWVzdCkge1xyXG4gICAgcmV0dXJuIF9wZXJmb3JtU2lnbkluUmVxdWVzdChhdXRoLCBcIlBPU1RcIiAvKiBQT1NUICovLCBcIi92MS9hY2NvdW50czpzaWduSW5XaXRoUGhvbmVOdW1iZXJcIiAvKiBTSUdOX0lOX1dJVEhfUEhPTkVfTlVNQkVSICovLCBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdCkpO1xyXG59XHJcbmFzeW5jIGZ1bmN0aW9uIGxpbmtXaXRoUGhvbmVOdW1iZXIkMShhdXRoLCByZXF1ZXN0KSB7XHJcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IF9wZXJmb3JtU2lnbkluUmVxdWVzdChhdXRoLCBcIlBPU1RcIiAvKiBQT1NUICovLCBcIi92MS9hY2NvdW50czpzaWduSW5XaXRoUGhvbmVOdW1iZXJcIiAvKiBTSUdOX0lOX1dJVEhfUEhPTkVfTlVNQkVSICovLCBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdCkpO1xyXG4gICAgaWYgKHJlc3BvbnNlLnRlbXBvcmFyeVByb29mKSB7XHJcbiAgICAgICAgdGhyb3cgX21ha2VUYWdnZWRFcnJvcihhdXRoLCBcImFjY291bnQtZXhpc3RzLXdpdGgtZGlmZmVyZW50LWNyZWRlbnRpYWxcIiAvKiBORUVEX0NPTkZJUk1BVElPTiAqLywgcmVzcG9uc2UpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlc3BvbnNlO1xyXG59XHJcbmNvbnN0IFZFUklGWV9QSE9ORV9OVU1CRVJfRk9SX0VYSVNUSU5HX0VSUk9SX01BUF8gPSB7XHJcbiAgICBbXCJVU0VSX05PVF9GT1VORFwiIC8qIFVTRVJfTk9UX0ZPVU5EICovXTogXCJ1c2VyLW5vdC1mb3VuZFwiIC8qIFVTRVJfREVMRVRFRCAqL1xyXG59O1xyXG5hc3luYyBmdW5jdGlvbiB2ZXJpZnlQaG9uZU51bWJlckZvckV4aXN0aW5nKGF1dGgsIHJlcXVlc3QpIHtcclxuICAgIGNvbnN0IGFwaVJlcXVlc3QgPSBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIHJlcXVlc3QpLCB7IG9wZXJhdGlvbjogJ1JFQVVUSCcgfSk7XHJcbiAgICByZXR1cm4gX3BlcmZvcm1TaWduSW5SZXF1ZXN0KGF1dGgsIFwiUE9TVFwiIC8qIFBPU1QgKi8sIFwiL3YxL2FjY291bnRzOnNpZ25JbldpdGhQaG9uZU51bWJlclwiIC8qIFNJR05fSU5fV0lUSF9QSE9ORV9OVU1CRVIgKi8sIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCBhcGlSZXF1ZXN0KSwgVkVSSUZZX1BIT05FX05VTUJFUl9GT1JfRVhJU1RJTkdfRVJST1JfTUFQXyk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFJlcHJlc2VudHMgdGhlIGNyZWRlbnRpYWxzIHJldHVybmVkIGJ5IHtAbGluayBQaG9uZUF1dGhQcm92aWRlcn0uXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmNsYXNzIFBob25lQXV0aENyZWRlbnRpYWwgZXh0ZW5kcyBBdXRoQ3JlZGVudGlhbCB7XHJcbiAgICBjb25zdHJ1Y3RvcihwYXJhbXMpIHtcclxuICAgICAgICBzdXBlcihcInBob25lXCIgLyogUEhPTkUgKi8sIFwicGhvbmVcIiAvKiBQSE9ORSAqLyk7XHJcbiAgICAgICAgdGhpcy5wYXJhbXMgPSBwYXJhbXM7XHJcbiAgICB9XHJcbiAgICAvKiogQGludGVybmFsICovXHJcbiAgICBzdGF0aWMgX2Zyb21WZXJpZmljYXRpb24odmVyaWZpY2F0aW9uSWQsIHZlcmlmaWNhdGlvbkNvZGUpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFBob25lQXV0aENyZWRlbnRpYWwoeyB2ZXJpZmljYXRpb25JZCwgdmVyaWZpY2F0aW9uQ29kZSB9KTtcclxuICAgIH1cclxuICAgIC8qKiBAaW50ZXJuYWwgKi9cclxuICAgIHN0YXRpYyBfZnJvbVRva2VuUmVzcG9uc2UocGhvbmVOdW1iZXIsIHRlbXBvcmFyeVByb29mKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQaG9uZUF1dGhDcmVkZW50aWFsKHsgcGhvbmVOdW1iZXIsIHRlbXBvcmFyeVByb29mIH0pO1xyXG4gICAgfVxyXG4gICAgLyoqIEBpbnRlcm5hbCAqL1xyXG4gICAgX2dldElkVG9rZW5SZXNwb25zZShhdXRoKSB7XHJcbiAgICAgICAgcmV0dXJuIHNpZ25JbldpdGhQaG9uZU51bWJlciQxKGF1dGgsIHRoaXMuX21ha2VWZXJpZmljYXRpb25SZXF1ZXN0KCkpO1xyXG4gICAgfVxyXG4gICAgLyoqIEBpbnRlcm5hbCAqL1xyXG4gICAgX2xpbmtUb0lkVG9rZW4oYXV0aCwgaWRUb2tlbikge1xyXG4gICAgICAgIHJldHVybiBsaW5rV2l0aFBob25lTnVtYmVyJDEoYXV0aCwgT2JqZWN0LmFzc2lnbih7IGlkVG9rZW4gfSwgdGhpcy5fbWFrZVZlcmlmaWNhdGlvblJlcXVlc3QoKSkpO1xyXG4gICAgfVxyXG4gICAgLyoqIEBpbnRlcm5hbCAqL1xyXG4gICAgX2dldFJlYXV0aGVudGljYXRpb25SZXNvbHZlcihhdXRoKSB7XHJcbiAgICAgICAgcmV0dXJuIHZlcmlmeVBob25lTnVtYmVyRm9yRXhpc3RpbmcoYXV0aCwgdGhpcy5fbWFrZVZlcmlmaWNhdGlvblJlcXVlc3QoKSk7XHJcbiAgICB9XHJcbiAgICAvKiogQGludGVybmFsICovXHJcbiAgICBfbWFrZVZlcmlmaWNhdGlvblJlcXVlc3QoKSB7XHJcbiAgICAgICAgY29uc3QgeyB0ZW1wb3JhcnlQcm9vZiwgcGhvbmVOdW1iZXIsIHZlcmlmaWNhdGlvbklkLCB2ZXJpZmljYXRpb25Db2RlIH0gPSB0aGlzLnBhcmFtcztcclxuICAgICAgICBpZiAodGVtcG9yYXJ5UHJvb2YgJiYgcGhvbmVOdW1iZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHsgdGVtcG9yYXJ5UHJvb2YsIHBob25lTnVtYmVyIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHNlc3Npb25JbmZvOiB2ZXJpZmljYXRpb25JZCxcclxuICAgICAgICAgICAgY29kZTogdmVyaWZpY2F0aW9uQ29kZVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbiAgICAvKioge0Bpbmhlcml0ZG9jIEF1dGhDcmVkZW50aWFsLnRvSlNPTn0gKi9cclxuICAgIHRvSlNPTigpIHtcclxuICAgICAgICBjb25zdCBvYmogPSB7XHJcbiAgICAgICAgICAgIHByb3ZpZGVySWQ6IHRoaXMucHJvdmlkZXJJZFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgaWYgKHRoaXMucGFyYW1zLnBob25lTnVtYmVyKSB7XHJcbiAgICAgICAgICAgIG9iai5waG9uZU51bWJlciA9IHRoaXMucGFyYW1zLnBob25lTnVtYmVyO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5wYXJhbXMudGVtcG9yYXJ5UHJvb2YpIHtcclxuICAgICAgICAgICAgb2JqLnRlbXBvcmFyeVByb29mID0gdGhpcy5wYXJhbXMudGVtcG9yYXJ5UHJvb2Y7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnBhcmFtcy52ZXJpZmljYXRpb25Db2RlKSB7XHJcbiAgICAgICAgICAgIG9iai52ZXJpZmljYXRpb25Db2RlID0gdGhpcy5wYXJhbXMudmVyaWZpY2F0aW9uQ29kZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMucGFyYW1zLnZlcmlmaWNhdGlvbklkKSB7XHJcbiAgICAgICAgICAgIG9iai52ZXJpZmljYXRpb25JZCA9IHRoaXMucGFyYW1zLnZlcmlmaWNhdGlvbklkO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gb2JqO1xyXG4gICAgfVxyXG4gICAgLyoqIEdlbmVyYXRlcyBhIHBob25lIGNyZWRlbnRpYWwgYmFzZWQgb24gYSBwbGFpbiBvYmplY3Qgb3IgYSBKU09OIHN0cmluZy4gKi9cclxuICAgIHN0YXRpYyBmcm9tSlNPTihqc29uKSB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBqc29uID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICBqc29uID0gSlNPTi5wYXJzZShqc29uKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgeyB2ZXJpZmljYXRpb25JZCwgdmVyaWZpY2F0aW9uQ29kZSwgcGhvbmVOdW1iZXIsIHRlbXBvcmFyeVByb29mIH0gPSBqc29uO1xyXG4gICAgICAgIGlmICghdmVyaWZpY2F0aW9uQ29kZSAmJlxyXG4gICAgICAgICAgICAhdmVyaWZpY2F0aW9uSWQgJiZcclxuICAgICAgICAgICAgIXBob25lTnVtYmVyICYmXHJcbiAgICAgICAgICAgICF0ZW1wb3JhcnlQcm9vZikge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQaG9uZUF1dGhDcmVkZW50aWFsKHtcclxuICAgICAgICAgICAgdmVyaWZpY2F0aW9uSWQsXHJcbiAgICAgICAgICAgIHZlcmlmaWNhdGlvbkNvZGUsXHJcbiAgICAgICAgICAgIHBob25lTnVtYmVyLFxyXG4gICAgICAgICAgICB0ZW1wb3JhcnlQcm9vZlxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBNYXBzIHRoZSBtb2RlIHN0cmluZyBpbiBhY3Rpb24gY29kZSBVUkwgdG8gQWN0aW9uIENvZGUgSW5mbyBvcGVyYXRpb24uXHJcbiAqXHJcbiAqIEBwYXJhbSBtb2RlXHJcbiAqL1xyXG5mdW5jdGlvbiBwYXJzZU1vZGUobW9kZSkge1xyXG4gICAgc3dpdGNoIChtb2RlKSB7XHJcbiAgICAgICAgY2FzZSAncmVjb3ZlckVtYWlsJzpcclxuICAgICAgICAgICAgcmV0dXJuIFwiUkVDT1ZFUl9FTUFJTFwiIC8qIFJFQ09WRVJfRU1BSUwgKi87XHJcbiAgICAgICAgY2FzZSAncmVzZXRQYXNzd29yZCc6XHJcbiAgICAgICAgICAgIHJldHVybiBcIlBBU1NXT1JEX1JFU0VUXCIgLyogUEFTU1dPUkRfUkVTRVQgKi87XHJcbiAgICAgICAgY2FzZSAnc2lnbkluJzpcclxuICAgICAgICAgICAgcmV0dXJuIFwiRU1BSUxfU0lHTklOXCIgLyogRU1BSUxfU0lHTklOICovO1xyXG4gICAgICAgIGNhc2UgJ3ZlcmlmeUVtYWlsJzpcclxuICAgICAgICAgICAgcmV0dXJuIFwiVkVSSUZZX0VNQUlMXCIgLyogVkVSSUZZX0VNQUlMICovO1xyXG4gICAgICAgIGNhc2UgJ3ZlcmlmeUFuZENoYW5nZUVtYWlsJzpcclxuICAgICAgICAgICAgcmV0dXJuIFwiVkVSSUZZX0FORF9DSEFOR0VfRU1BSUxcIiAvKiBWRVJJRllfQU5EX0NIQU5HRV9FTUFJTCAqLztcclxuICAgICAgICBjYXNlICdyZXZlcnRTZWNvbmRGYWN0b3JBZGRpdGlvbic6XHJcbiAgICAgICAgICAgIHJldHVybiBcIlJFVkVSVF9TRUNPTkRfRkFDVE9SX0FERElUSU9OXCIgLyogUkVWRVJUX1NFQ09ORF9GQUNUT1JfQURESVRJT04gKi87XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIEhlbHBlciB0byBwYXJzZSBGREwgbGlua3NcclxuICpcclxuICogQHBhcmFtIHVybFxyXG4gKi9cclxuZnVuY3Rpb24gcGFyc2VEZWVwTGluayh1cmwpIHtcclxuICAgIGNvbnN0IGxpbmsgPSBxdWVyeXN0cmluZ0RlY29kZShleHRyYWN0UXVlcnlzdHJpbmcodXJsKSlbJ2xpbmsnXTtcclxuICAgIC8vIERvdWJsZSBsaW5rIGNhc2UgKGF1dG9tYXRpYyByZWRpcmVjdCkuXHJcbiAgICBjb25zdCBkb3VibGVEZWVwTGluayA9IGxpbmtcclxuICAgICAgICA/IHF1ZXJ5c3RyaW5nRGVjb2RlKGV4dHJhY3RRdWVyeXN0cmluZyhsaW5rKSlbJ2RlZXBfbGlua19pZCddXHJcbiAgICAgICAgOiBudWxsO1xyXG4gICAgLy8gaU9TIGN1c3RvbSBzY2hlbWUgbGlua3MuXHJcbiAgICBjb25zdCBpT1NEZWVwTGluayA9IHF1ZXJ5c3RyaW5nRGVjb2RlKGV4dHJhY3RRdWVyeXN0cmluZyh1cmwpKVsnZGVlcF9saW5rX2lkJ107XHJcbiAgICBjb25zdCBpT1NEb3VibGVEZWVwTGluayA9IGlPU0RlZXBMaW5rXHJcbiAgICAgICAgPyBxdWVyeXN0cmluZ0RlY29kZShleHRyYWN0UXVlcnlzdHJpbmcoaU9TRGVlcExpbmspKVsnbGluayddXHJcbiAgICAgICAgOiBudWxsO1xyXG4gICAgcmV0dXJuIGlPU0RvdWJsZURlZXBMaW5rIHx8IGlPU0RlZXBMaW5rIHx8IGRvdWJsZURlZXBMaW5rIHx8IGxpbmsgfHwgdXJsO1xyXG59XHJcbi8qKlxyXG4gKiBBIHV0aWxpdHkgY2xhc3MgdG8gcGFyc2UgZW1haWwgYWN0aW9uIFVSTHMgc3VjaCBhcyBwYXNzd29yZCByZXNldCwgZW1haWwgdmVyaWZpY2F0aW9uLFxyXG4gKiBlbWFpbCBsaW5rIHNpZ24gaW4sIGV0Yy5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuY2xhc3MgQWN0aW9uQ29kZVVSTCB7XHJcbiAgICAvKipcclxuICAgICAqIEBwYXJhbSBhY3Rpb25MaW5rIC0gVGhlIGxpbmsgZnJvbSB3aGljaCB0byBleHRyYWN0IHRoZSBVUkwuXHJcbiAgICAgKiBAcmV0dXJucyBUaGUge0BsaW5rIEFjdGlvbkNvZGVVUkx9IG9iamVjdCwgb3IgbnVsbCBpZiB0aGUgbGluayBpcyBpbnZhbGlkLlxyXG4gICAgICpcclxuICAgICAqIEBpbnRlcm5hbFxyXG4gICAgICovXHJcbiAgICBjb25zdHJ1Y3RvcihhY3Rpb25MaW5rKSB7XHJcbiAgICAgICAgdmFyIF9hLCBfYiwgX2MsIF9kLCBfZSwgX2Y7XHJcbiAgICAgICAgY29uc3Qgc2VhcmNoUGFyYW1zID0gcXVlcnlzdHJpbmdEZWNvZGUoZXh0cmFjdFF1ZXJ5c3RyaW5nKGFjdGlvbkxpbmspKTtcclxuICAgICAgICBjb25zdCBhcGlLZXkgPSAoX2EgPSBzZWFyY2hQYXJhbXNbXCJhcGlLZXlcIiAvKiBBUElfS0VZICovXSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogbnVsbDtcclxuICAgICAgICBjb25zdCBjb2RlID0gKF9iID0gc2VhcmNoUGFyYW1zW1wib29iQ29kZVwiIC8qIENPREUgKi9dKSAhPT0gbnVsbCAmJiBfYiAhPT0gdm9pZCAwID8gX2IgOiBudWxsO1xyXG4gICAgICAgIGNvbnN0IG9wZXJhdGlvbiA9IHBhcnNlTW9kZSgoX2MgPSBzZWFyY2hQYXJhbXNbXCJtb2RlXCIgLyogTU9ERSAqL10pICE9PSBudWxsICYmIF9jICE9PSB2b2lkIDAgPyBfYyA6IG51bGwpO1xyXG4gICAgICAgIC8vIFZhbGlkYXRlIEFQSSBrZXksIGNvZGUgYW5kIG1vZGUuXHJcbiAgICAgICAgX2Fzc2VydChhcGlLZXkgJiYgY29kZSAmJiBvcGVyYXRpb24sIFwiYXJndW1lbnQtZXJyb3JcIiAvKiBBUkdVTUVOVF9FUlJPUiAqLyk7XHJcbiAgICAgICAgdGhpcy5hcGlLZXkgPSBhcGlLZXk7XHJcbiAgICAgICAgdGhpcy5vcGVyYXRpb24gPSBvcGVyYXRpb247XHJcbiAgICAgICAgdGhpcy5jb2RlID0gY29kZTtcclxuICAgICAgICB0aGlzLmNvbnRpbnVlVXJsID0gKF9kID0gc2VhcmNoUGFyYW1zW1wiY29udGludWVVcmxcIiAvKiBDT05USU5VRV9VUkwgKi9dKSAhPT0gbnVsbCAmJiBfZCAhPT0gdm9pZCAwID8gX2QgOiBudWxsO1xyXG4gICAgICAgIHRoaXMubGFuZ3VhZ2VDb2RlID0gKF9lID0gc2VhcmNoUGFyYW1zW1wibGFuZ3VhZ2VDb2RlXCIgLyogTEFOR1VBR0VfQ09ERSAqL10pICE9PSBudWxsICYmIF9lICE9PSB2b2lkIDAgPyBfZSA6IG51bGw7XHJcbiAgICAgICAgdGhpcy50ZW5hbnRJZCA9IChfZiA9IHNlYXJjaFBhcmFtc1tcInRlbmFudElkXCIgLyogVEVOQU5UX0lEICovXSkgIT09IG51bGwgJiYgX2YgIT09IHZvaWQgMCA/IF9mIDogbnVsbDtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUGFyc2VzIHRoZSBlbWFpbCBhY3Rpb24gbGluayBzdHJpbmcgYW5kIHJldHVybnMgYW4ge0BsaW5rIEFjdGlvbkNvZGVVUkx9IGlmIHRoZSBsaW5rIGlzIHZhbGlkLFxyXG4gICAgICogb3RoZXJ3aXNlIHJldHVybnMgbnVsbC5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gbGluayAgLSBUaGUgZW1haWwgYWN0aW9uIGxpbmsgc3RyaW5nLlxyXG4gICAgICogQHJldHVybnMgVGhlIHtAbGluayBBY3Rpb25Db2RlVVJMfSBvYmplY3QsIG9yIG51bGwgaWYgdGhlIGxpbmsgaXMgaW52YWxpZC5cclxuICAgICAqXHJcbiAgICAgKiBAcHVibGljXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBwYXJzZUxpbmsobGluaykge1xyXG4gICAgICAgIGNvbnN0IGFjdGlvbkxpbmsgPSBwYXJzZURlZXBMaW5rKGxpbmspO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgQWN0aW9uQ29kZVVSTChhY3Rpb25MaW5rKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKF9hKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4vKipcclxuICogUGFyc2VzIHRoZSBlbWFpbCBhY3Rpb24gbGluayBzdHJpbmcgYW5kIHJldHVybnMgYW4ge0BsaW5rIEFjdGlvbkNvZGVVUkx9IGlmXHJcbiAqIHRoZSBsaW5rIGlzIHZhbGlkLCBvdGhlcndpc2UgcmV0dXJucyBudWxsLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5mdW5jdGlvbiBwYXJzZUFjdGlvbkNvZGVVUkwobGluaykge1xyXG4gICAgcmV0dXJuIEFjdGlvbkNvZGVVUkwucGFyc2VMaW5rKGxpbmspO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBQcm92aWRlciBmb3IgZ2VuZXJhdGluZyB7QGxpbmsgRW1haWxBdXRoQ3JlZGVudGlhbH0uXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmNsYXNzIEVtYWlsQXV0aFByb3ZpZGVyIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEFsd2F5cyBzZXQgdG8ge0BsaW5rIFByb3ZpZGVySWR9LlBBU1NXT1JELCBldmVuIGZvciBlbWFpbCBsaW5rLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMucHJvdmlkZXJJZCA9IEVtYWlsQXV0aFByb3ZpZGVyLlBST1ZJREVSX0lEO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBJbml0aWFsaXplIGFuIHtAbGluayBBdXRoQ3JlZGVudGlhbH0gdXNpbmcgYW4gZW1haWwgYW5kIHBhc3N3b3JkLlxyXG4gICAgICpcclxuICAgICAqIEBleGFtcGxlXHJcbiAgICAgKiBgYGBqYXZhc2NyaXB0XHJcbiAgICAgKiBjb25zdCBhdXRoQ3JlZGVudGlhbCA9IEVtYWlsQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWwoZW1haWwsIHBhc3N3b3JkKTtcclxuICAgICAqIGNvbnN0IHVzZXJDcmVkZW50aWFsID0gYXdhaXQgc2lnbkluV2l0aENyZWRlbnRpYWwoYXV0aCwgYXV0aENyZWRlbnRpYWwpO1xyXG4gICAgICogYGBgXHJcbiAgICAgKlxyXG4gICAgICogQGV4YW1wbGVcclxuICAgICAqIGBgYGphdmFzY3JpcHRcclxuICAgICAqIGNvbnN0IHVzZXJDcmVkZW50aWFsID0gYXdhaXQgc2lnbkluV2l0aEVtYWlsQW5kUGFzc3dvcmQoYXV0aCwgZW1haWwsIHBhc3N3b3JkKTtcclxuICAgICAqIGBgYFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBlbWFpbCAtIEVtYWlsIGFkZHJlc3MuXHJcbiAgICAgKiBAcGFyYW0gcGFzc3dvcmQgLSBVc2VyIGFjY291bnQgcGFzc3dvcmQuXHJcbiAgICAgKiBAcmV0dXJucyBUaGUgYXV0aCBwcm92aWRlciBjcmVkZW50aWFsLlxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgY3JlZGVudGlhbChlbWFpbCwgcGFzc3dvcmQpIHtcclxuICAgICAgICByZXR1cm4gRW1haWxBdXRoQ3JlZGVudGlhbC5fZnJvbUVtYWlsQW5kUGFzc3dvcmQoZW1haWwsIHBhc3N3b3JkKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogSW5pdGlhbGl6ZSBhbiB7QGxpbmsgQXV0aENyZWRlbnRpYWx9IHVzaW5nIGFuIGVtYWlsIGFuZCBhbiBlbWFpbCBsaW5rIGFmdGVyIGEgc2lnbiBpbiB3aXRoXHJcbiAgICAgKiBlbWFpbCBsaW5rIG9wZXJhdGlvbi5cclxuICAgICAqXHJcbiAgICAgKiBAZXhhbXBsZVxyXG4gICAgICogYGBgamF2YXNjcmlwdFxyXG4gICAgICogY29uc3QgYXV0aENyZWRlbnRpYWwgPSBFbWFpbEF1dGhQcm92aWRlci5jcmVkZW50aWFsV2l0aExpbmsoYXV0aCwgZW1haWwsIGVtYWlsTGluayk7XHJcbiAgICAgKiBjb25zdCB1c2VyQ3JlZGVudGlhbCA9IGF3YWl0IHNpZ25JbldpdGhDcmVkZW50aWFsKGF1dGgsIGF1dGhDcmVkZW50aWFsKTtcclxuICAgICAqIGBgYFxyXG4gICAgICpcclxuICAgICAqIEBleGFtcGxlXHJcbiAgICAgKiBgYGBqYXZhc2NyaXB0XHJcbiAgICAgKiBhd2FpdCBzZW5kU2lnbkluTGlua1RvRW1haWwoYXV0aCwgZW1haWwpO1xyXG4gICAgICogLy8gT2J0YWluIGVtYWlsTGluayBmcm9tIHVzZXIuXHJcbiAgICAgKiBjb25zdCB1c2VyQ3JlZGVudGlhbCA9IGF3YWl0IHNpZ25JbldpdGhFbWFpbExpbmsoYXV0aCwgZW1haWwsIGVtYWlsTGluayk7XHJcbiAgICAgKiBgYGBcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UgdXNlZCB0byB2ZXJpZnkgdGhlIGxpbmsuXHJcbiAgICAgKiBAcGFyYW0gZW1haWwgLSBFbWFpbCBhZGRyZXNzLlxyXG4gICAgICogQHBhcmFtIGVtYWlsTGluayAtIFNpZ24taW4gZW1haWwgbGluay5cclxuICAgICAqIEByZXR1cm5zIC0gVGhlIGF1dGggcHJvdmlkZXIgY3JlZGVudGlhbC5cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGNyZWRlbnRpYWxXaXRoTGluayhlbWFpbCwgZW1haWxMaW5rKSB7XHJcbiAgICAgICAgY29uc3QgYWN0aW9uQ29kZVVybCA9IEFjdGlvbkNvZGVVUkwucGFyc2VMaW5rKGVtYWlsTGluayk7XHJcbiAgICAgICAgX2Fzc2VydChhY3Rpb25Db2RlVXJsLCBcImFyZ3VtZW50LWVycm9yXCIgLyogQVJHVU1FTlRfRVJST1IgKi8pO1xyXG4gICAgICAgIHJldHVybiBFbWFpbEF1dGhDcmVkZW50aWFsLl9mcm9tRW1haWxBbmRDb2RlKGVtYWlsLCBhY3Rpb25Db2RlVXJsLmNvZGUsIGFjdGlvbkNvZGVVcmwudGVuYW50SWQpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBBbHdheXMgc2V0IHRvIHtAbGluayBQcm92aWRlcklkfS5QQVNTV09SRCwgZXZlbiBmb3IgZW1haWwgbGluay5cclxuICovXHJcbkVtYWlsQXV0aFByb3ZpZGVyLlBST1ZJREVSX0lEID0gXCJwYXNzd29yZFwiIC8qIFBBU1NXT1JEICovO1xyXG4vKipcclxuICogQWx3YXlzIHNldCB0byB7QGxpbmsgU2lnbkluTWV0aG9kfS5FTUFJTF9QQVNTV09SRC5cclxuICovXHJcbkVtYWlsQXV0aFByb3ZpZGVyLkVNQUlMX1BBU1NXT1JEX1NJR05fSU5fTUVUSE9EID0gXCJwYXNzd29yZFwiIC8qIEVNQUlMX1BBU1NXT1JEICovO1xyXG4vKipcclxuICogQWx3YXlzIHNldCB0byB7QGxpbmsgU2lnbkluTWV0aG9kfS5FTUFJTF9MSU5LLlxyXG4gKi9cclxuRW1haWxBdXRoUHJvdmlkZXIuRU1BSUxfTElOS19TSUdOX0lOX01FVEhPRCA9IFwiZW1haWxMaW5rXCIgLyogRU1BSUxfTElOSyAqLztcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFRoZSBiYXNlIGNsYXNzIGZvciBhbGwgRmVkZXJhdGVkIHByb3ZpZGVycyAoT0F1dGggKGluY2x1ZGluZyBPSURDKSwgU0FNTCkuXHJcbiAqXHJcbiAqIFRoaXMgY2xhc3MgaXMgbm90IG1lYW50IHRvIGJlIGluc3RhbnRpYXRlZCBkaXJlY3RseS5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuY2xhc3MgRmVkZXJhdGVkQXV0aFByb3ZpZGVyIHtcclxuICAgIC8qKlxyXG4gICAgICogQ29uc3RydWN0b3IgZm9yIGdlbmVyaWMgT0F1dGggcHJvdmlkZXJzLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBwcm92aWRlcklkIC0gUHJvdmlkZXIgZm9yIHdoaWNoIGNyZWRlbnRpYWxzIHNob3VsZCBiZSBnZW5lcmF0ZWQuXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKHByb3ZpZGVySWQpIHtcclxuICAgICAgICB0aGlzLnByb3ZpZGVySWQgPSBwcm92aWRlcklkO1xyXG4gICAgICAgIC8qKiBAaW50ZXJuYWwgKi9cclxuICAgICAgICB0aGlzLmRlZmF1bHRMYW5ndWFnZUNvZGUgPSBudWxsO1xyXG4gICAgICAgIC8qKiBAaW50ZXJuYWwgKi9cclxuICAgICAgICB0aGlzLmN1c3RvbVBhcmFtZXRlcnMgPSB7fTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogU2V0IHRoZSBsYW5ndWFnZSBnb2RlLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBsYW5ndWFnZUNvZGUgLSBsYW5ndWFnZSBjb2RlXHJcbiAgICAgKi9cclxuICAgIHNldERlZmF1bHRMYW5ndWFnZShsYW5ndWFnZUNvZGUpIHtcclxuICAgICAgICB0aGlzLmRlZmF1bHRMYW5ndWFnZUNvZGUgPSBsYW5ndWFnZUNvZGU7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFNldHMgdGhlIE9BdXRoIGN1c3RvbSBwYXJhbWV0ZXJzIHRvIHBhc3MgaW4gYW4gT0F1dGggcmVxdWVzdCBmb3IgcG9wdXAgYW5kIHJlZGlyZWN0IHNpZ24taW5cclxuICAgICAqIG9wZXJhdGlvbnMuXHJcbiAgICAgKlxyXG4gICAgICogQHJlbWFya3NcclxuICAgICAqIEZvciBhIGRldGFpbGVkIGxpc3QsIGNoZWNrIHRoZSByZXNlcnZlZCByZXF1aXJlZCBPQXV0aCAyLjAgcGFyYW1ldGVycyBzdWNoIGFzIGBjbGllbnRfaWRgLFxyXG4gICAgICogYHJlZGlyZWN0X3VyaWAsIGBzY29wZWAsIGByZXNwb25zZV90eXBlYCwgYW5kIGBzdGF0ZWAgYXJlIG5vdCBhbGxvd2VkIGFuZCB3aWxsIGJlIGlnbm9yZWQuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGN1c3RvbU9BdXRoUGFyYW1ldGVycyAtIFRoZSBjdXN0b20gT0F1dGggcGFyYW1ldGVycyB0byBwYXNzIGluIHRoZSBPQXV0aCByZXF1ZXN0LlxyXG4gICAgICovXHJcbiAgICBzZXRDdXN0b21QYXJhbWV0ZXJzKGN1c3RvbU9BdXRoUGFyYW1ldGVycykge1xyXG4gICAgICAgIHRoaXMuY3VzdG9tUGFyYW1ldGVycyA9IGN1c3RvbU9BdXRoUGFyYW1ldGVycztcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUmV0cmlldmUgdGhlIGN1cnJlbnQgbGlzdCBvZiB7QGxpbmsgQ3VzdG9tUGFyYW1ldGVyc30uXHJcbiAgICAgKi9cclxuICAgIGdldEN1c3RvbVBhcmFtZXRlcnMoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY3VzdG9tUGFyYW1ldGVycztcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogQ29tbW9uIGNvZGUgdG8gYWxsIE9BdXRoIHByb3ZpZGVycy4gVGhpcyBpcyBzZXBhcmF0ZSBmcm9tIHRoZVxyXG4gKiB7QGxpbmsgT0F1dGhQcm92aWRlcn0gc28gdGhhdCBjaGlsZCBwcm92aWRlcnMgKGxpa2VcclxuICoge0BsaW5rIEdvb2dsZUF1dGhQcm92aWRlcn0pIGRvbid0IGluaGVyaXQgdGhlIGBjcmVkZW50aWFsYCBpbnN0YW5jZSBtZXRob2QuXHJcbiAqIEluc3RlYWQsIHRoZXkgcmVseSBvbiBhIHN0YXRpYyBgY3JlZGVudGlhbGAgbWV0aG9kLlxyXG4gKi9cclxuY2xhc3MgQmFzZU9BdXRoUHJvdmlkZXIgZXh0ZW5kcyBGZWRlcmF0ZWRBdXRoUHJvdmlkZXIge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoLi4uYXJndW1lbnRzKTtcclxuICAgICAgICAvKiogQGludGVybmFsICovXHJcbiAgICAgICAgdGhpcy5zY29wZXMgPSBbXTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQWRkIGFuIE9BdXRoIHNjb3BlIHRvIHRoZSBjcmVkZW50aWFsLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBzY29wZSAtIFByb3ZpZGVyIE9BdXRoIHNjb3BlIHRvIGFkZC5cclxuICAgICAqL1xyXG4gICAgYWRkU2NvcGUoc2NvcGUpIHtcclxuICAgICAgICAvLyBJZiBub3QgYWxyZWFkeSBhZGRlZCwgYWRkIHNjb3BlIHRvIGxpc3QuXHJcbiAgICAgICAgaWYgKCF0aGlzLnNjb3Blcy5pbmNsdWRlcyhzY29wZSkpIHtcclxuICAgICAgICAgICAgdGhpcy5zY29wZXMucHVzaChzY29wZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXRyaWV2ZSB0aGUgY3VycmVudCBsaXN0IG9mIE9BdXRoIHNjb3Blcy5cclxuICAgICAqL1xyXG4gICAgZ2V0U2NvcGVzKCkge1xyXG4gICAgICAgIHJldHVybiBbLi4udGhpcy5zY29wZXNdO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBQcm92aWRlciBmb3IgZ2VuZXJhdGluZyBnZW5lcmljIHtAbGluayBPQXV0aENyZWRlbnRpYWx9LlxyXG4gKlxyXG4gKiBAZXhhbXBsZVxyXG4gKiBgYGBqYXZhc2NyaXB0XHJcbiAqIC8vIFNpZ24gaW4gdXNpbmcgYSByZWRpcmVjdC5cclxuICogY29uc3QgcHJvdmlkZXIgPSBuZXcgT0F1dGhQcm92aWRlcignZ29vZ2xlLmNvbScpO1xyXG4gKiAvLyBTdGFydCBhIHNpZ24gaW4gcHJvY2VzcyBmb3IgYW4gdW5hdXRoZW50aWNhdGVkIHVzZXIuXHJcbiAqIHByb3ZpZGVyLmFkZFNjb3BlKCdwcm9maWxlJyk7XHJcbiAqIHByb3ZpZGVyLmFkZFNjb3BlKCdlbWFpbCcpO1xyXG4gKiBhd2FpdCBzaWduSW5XaXRoUmVkaXJlY3QoYXV0aCwgcHJvdmlkZXIpO1xyXG4gKiAvLyBUaGlzIHdpbGwgdHJpZ2dlciBhIGZ1bGwgcGFnZSByZWRpcmVjdCBhd2F5IGZyb20geW91ciBhcHBcclxuICpcclxuICogLy8gQWZ0ZXIgcmV0dXJuaW5nIGZyb20gdGhlIHJlZGlyZWN0IHdoZW4geW91ciBhcHAgaW5pdGlhbGl6ZXMgeW91IGNhbiBvYnRhaW4gdGhlIHJlc3VsdFxyXG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRSZWRpcmVjdFJlc3VsdChhdXRoKTtcclxuICogaWYgKHJlc3VsdCkge1xyXG4gKiAgIC8vIFRoaXMgaXMgdGhlIHNpZ25lZC1pbiB1c2VyXHJcbiAqICAgY29uc3QgdXNlciA9IHJlc3VsdC51c2VyO1xyXG4gKiAgIC8vIFRoaXMgZ2l2ZXMgeW91IGEgT0F1dGggQWNjZXNzIFRva2VuIGZvciB0aGUgcHJvdmlkZXIuXHJcbiAqICAgY29uc3QgY3JlZGVudGlhbCA9IHByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tUmVzdWx0KGF1dGgsIHJlc3VsdCk7XHJcbiAqICAgY29uc3QgdG9rZW4gPSBjcmVkZW50aWFsLmFjY2Vzc1Rva2VuO1xyXG4gKiB9XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBAZXhhbXBsZVxyXG4gKiBgYGBqYXZhc2NyaXB0XHJcbiAqIC8vIFNpZ24gaW4gdXNpbmcgYSBwb3B1cC5cclxuICogY29uc3QgcHJvdmlkZXIgPSBuZXcgT0F1dGhQcm92aWRlcignZ29vZ2xlLmNvbScpO1xyXG4gKiBwcm92aWRlci5hZGRTY29wZSgncHJvZmlsZScpO1xyXG4gKiBwcm92aWRlci5hZGRTY29wZSgnZW1haWwnKTtcclxuICogY29uc3QgcmVzdWx0ID0gYXdhaXQgc2lnbkluV2l0aFBvcHVwKGF1dGgsIHByb3ZpZGVyKTtcclxuICpcclxuICogLy8gVGhlIHNpZ25lZC1pbiB1c2VyIGluZm8uXHJcbiAqIGNvbnN0IHVzZXIgPSByZXN1bHQudXNlcjtcclxuICogLy8gVGhpcyBnaXZlcyB5b3UgYSBPQXV0aCBBY2Nlc3MgVG9rZW4gZm9yIHRoZSBwcm92aWRlci5cclxuICogY29uc3QgY3JlZGVudGlhbCA9IHByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tUmVzdWx0KGF1dGgsIHJlc3VsdCk7XHJcbiAqIGNvbnN0IHRva2VuID0gY3JlZGVudGlhbC5hY2Nlc3NUb2tlbjtcclxuICogYGBgXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmNsYXNzIE9BdXRoUHJvdmlkZXIgZXh0ZW5kcyBCYXNlT0F1dGhQcm92aWRlciB7XHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYW4ge0BsaW5rIE9BdXRoQ3JlZGVudGlhbH0gZnJvbSBhIEpTT04gc3RyaW5nIG9yIGEgcGxhaW4gb2JqZWN0LlxyXG4gICAgICogQHBhcmFtIGpzb24gLSBBIHBsYWluIG9iamVjdCBvciBhIEpTT04gc3RyaW5nXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBjcmVkZW50aWFsRnJvbUpTT04oanNvbikge1xyXG4gICAgICAgIGNvbnN0IG9iaiA9IHR5cGVvZiBqc29uID09PSAnc3RyaW5nJyA/IEpTT04ucGFyc2UoanNvbikgOiBqc29uO1xyXG4gICAgICAgIF9hc3NlcnQoJ3Byb3ZpZGVySWQnIGluIG9iaiAmJiAnc2lnbkluTWV0aG9kJyBpbiBvYmosIFwiYXJndW1lbnQtZXJyb3JcIiAvKiBBUkdVTUVOVF9FUlJPUiAqLyk7XHJcbiAgICAgICAgcmV0dXJuIE9BdXRoQ3JlZGVudGlhbC5fZnJvbVBhcmFtcyhvYmopO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGEge0BsaW5rIE9BdXRoQ3JlZGVudGlhbH0gZnJvbSBhIGdlbmVyaWMgT0F1dGggcHJvdmlkZXIncyBhY2Nlc3MgdG9rZW4gb3IgSUQgdG9rZW4uXHJcbiAgICAgKlxyXG4gICAgICogQHJlbWFya3NcclxuICAgICAqIFRoZSByYXcgbm9uY2UgaXMgcmVxdWlyZWQgd2hlbiBhbiBJRCB0b2tlbiB3aXRoIGEgbm9uY2UgZmllbGQgaXMgcHJvdmlkZWQuIFRoZSBTSEEtMjU2IGhhc2ggb2ZcclxuICAgICAqIHRoZSByYXcgbm9uY2UgbXVzdCBtYXRjaCB0aGUgbm9uY2UgZmllbGQgaW4gdGhlIElEIHRva2VuLlxyXG4gICAgICpcclxuICAgICAqIEBleGFtcGxlXHJcbiAgICAgKiBgYGBqYXZhc2NyaXB0XHJcbiAgICAgKiAvLyBgZ29vZ2xlVXNlcmAgZnJvbSB0aGUgb25zdWNjZXNzIEdvb2dsZSBTaWduIEluIGNhbGxiYWNrLlxyXG4gICAgICogLy8gSW5pdGlhbGl6ZSBhIGdlbmVyYXRlIE9BdXRoIHByb3ZpZGVyIHdpdGggYSBgZ29vZ2xlLmNvbWAgcHJvdmlkZXJJZC5cclxuICAgICAqIGNvbnN0IHByb3ZpZGVyID0gbmV3IE9BdXRoUHJvdmlkZXIoJ2dvb2dsZS5jb20nKTtcclxuICAgICAqIGNvbnN0IGNyZWRlbnRpYWwgPSBwcm92aWRlci5jcmVkZW50aWFsKHtcclxuICAgICAqICAgaWRUb2tlbjogZ29vZ2xlVXNlci5nZXRBdXRoUmVzcG9uc2UoKS5pZF90b2tlbixcclxuICAgICAqIH0pO1xyXG4gICAgICogY29uc3QgcmVzdWx0ID0gYXdhaXQgc2lnbkluV2l0aENyZWRlbnRpYWwoY3JlZGVudGlhbCk7XHJcbiAgICAgKiBgYGBcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gcGFyYW1zIC0gRWl0aGVyIHRoZSBvcHRpb25zIG9iamVjdCBjb250YWluaW5nIHRoZSBJRCB0b2tlbiwgYWNjZXNzIHRva2VuIGFuZCByYXcgbm9uY2VcclxuICAgICAqIG9yIHRoZSBJRCB0b2tlbiBzdHJpbmcuXHJcbiAgICAgKi9cclxuICAgIGNyZWRlbnRpYWwocGFyYW1zKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NyZWRlbnRpYWwocGFyYW1zKTtcclxuICAgIH1cclxuICAgIC8qKiBBbiBpbnRlcm5hbCBjcmVkZW50aWFsIG1ldGhvZCB0aGF0IGFjY2VwdHMgbW9yZSBwZXJtaXNzaXZlIG9wdGlvbnMgKi9cclxuICAgIF9jcmVkZW50aWFsKHBhcmFtcykge1xyXG4gICAgICAgIF9hc3NlcnQocGFyYW1zLmlkVG9rZW4gfHwgcGFyYW1zLmFjY2Vzc1Rva2VuLCBcImFyZ3VtZW50LWVycm9yXCIgLyogQVJHVU1FTlRfRVJST1IgKi8pO1xyXG4gICAgICAgIC8vIEZvciBPQXV0aENyZWRlbnRpYWwsIHNpZ24gaW4gbWV0aG9kIGlzIHNhbWUgYXMgcHJvdmlkZXJJZC5cclxuICAgICAgICByZXR1cm4gT0F1dGhDcmVkZW50aWFsLl9mcm9tUGFyYW1zKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgcGFyYW1zKSwgeyBwcm92aWRlcklkOiB0aGlzLnByb3ZpZGVySWQsIHNpZ25Jbk1ldGhvZDogdGhpcy5wcm92aWRlcklkIH0pKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogVXNlZCB0byBleHRyYWN0IHRoZSB1bmRlcmx5aW5nIHtAbGluayBPQXV0aENyZWRlbnRpYWx9IGZyb20gYSB7QGxpbmsgVXNlckNyZWRlbnRpYWx9LlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB1c2VyQ3JlZGVudGlhbCAtIFRoZSB1c2VyIGNyZWRlbnRpYWwuXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBjcmVkZW50aWFsRnJvbVJlc3VsdCh1c2VyQ3JlZGVudGlhbCkge1xyXG4gICAgICAgIHJldHVybiBPQXV0aFByb3ZpZGVyLm9hdXRoQ3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3QodXNlckNyZWRlbnRpYWwpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBVc2VkIHRvIGV4dHJhY3QgdGhlIHVuZGVybHlpbmcge0BsaW5rIE9BdXRoQ3JlZGVudGlhbH0gZnJvbSBhIHtAbGluayBBdXRoRXJyb3J9IHdoaWNoIHdhc1xyXG4gICAgICogdGhyb3duIGR1cmluZyBhIHNpZ24taW4sIGxpbmssIG9yIHJlYXV0aGVudGljYXRlIG9wZXJhdGlvbi5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gdXNlckNyZWRlbnRpYWwgLSBUaGUgdXNlciBjcmVkZW50aWFsLlxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgY3JlZGVudGlhbEZyb21FcnJvcihlcnJvcikge1xyXG4gICAgICAgIHJldHVybiBPQXV0aFByb3ZpZGVyLm9hdXRoQ3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3QoKGVycm9yLmN1c3RvbURhdGEgfHwge30pKTtcclxuICAgIH1cclxuICAgIHN0YXRpYyBvYXV0aENyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KHsgX3Rva2VuUmVzcG9uc2U6IHRva2VuUmVzcG9uc2UgfSkge1xyXG4gICAgICAgIGlmICghdG9rZW5SZXNwb25zZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgeyBvYXV0aElkVG9rZW4sIG9hdXRoQWNjZXNzVG9rZW4sIG9hdXRoVG9rZW5TZWNyZXQsIHBlbmRpbmdUb2tlbiwgbm9uY2UsIHByb3ZpZGVySWQgfSA9IHRva2VuUmVzcG9uc2U7XHJcbiAgICAgICAgaWYgKCFvYXV0aEFjY2Vzc1Rva2VuICYmXHJcbiAgICAgICAgICAgICFvYXV0aFRva2VuU2VjcmV0ICYmXHJcbiAgICAgICAgICAgICFvYXV0aElkVG9rZW4gJiZcclxuICAgICAgICAgICAgIXBlbmRpbmdUb2tlbikge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCFwcm92aWRlcklkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IE9BdXRoUHJvdmlkZXIocHJvdmlkZXJJZCkuX2NyZWRlbnRpYWwoe1xyXG4gICAgICAgICAgICAgICAgaWRUb2tlbjogb2F1dGhJZFRva2VuLFxyXG4gICAgICAgICAgICAgICAgYWNjZXNzVG9rZW46IG9hdXRoQWNjZXNzVG9rZW4sXHJcbiAgICAgICAgICAgICAgICByYXdOb25jZTogbm9uY2UsXHJcbiAgICAgICAgICAgICAgICBwZW5kaW5nVG9rZW5cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogUHJvdmlkZXIgZm9yIGdlbmVyYXRpbmcgYW4ge0BsaW5rIE9BdXRoQ3JlZGVudGlhbH0gZm9yIHtAbGluayBQcm92aWRlcklkfS5GQUNFQk9PSy5cclxuICpcclxuICogQGV4YW1wbGVcclxuICogYGBgamF2YXNjcmlwdFxyXG4gKiAvLyBTaWduIGluIHVzaW5nIGEgcmVkaXJlY3QuXHJcbiAqIGNvbnN0IHByb3ZpZGVyID0gbmV3IEZhY2Vib29rQXV0aFByb3ZpZGVyKCk7XHJcbiAqIC8vIFN0YXJ0IGEgc2lnbiBpbiBwcm9jZXNzIGZvciBhbiB1bmF1dGhlbnRpY2F0ZWQgdXNlci5cclxuICogcHJvdmlkZXIuYWRkU2NvcGUoJ3VzZXJfYmlydGhkYXknKTtcclxuICogYXdhaXQgc2lnbkluV2l0aFJlZGlyZWN0KGF1dGgsIHByb3ZpZGVyKTtcclxuICogLy8gVGhpcyB3aWxsIHRyaWdnZXIgYSBmdWxsIHBhZ2UgcmVkaXJlY3QgYXdheSBmcm9tIHlvdXIgYXBwXHJcbiAqXHJcbiAqIC8vIEFmdGVyIHJldHVybmluZyBmcm9tIHRoZSByZWRpcmVjdCB3aGVuIHlvdXIgYXBwIGluaXRpYWxpemVzIHlvdSBjYW4gb2J0YWluIHRoZSByZXN1bHRcclxuICogY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2V0UmVkaXJlY3RSZXN1bHQoYXV0aCk7XHJcbiAqIGlmIChyZXN1bHQpIHtcclxuICogICAvLyBUaGlzIGlzIHRoZSBzaWduZWQtaW4gdXNlclxyXG4gKiAgIGNvbnN0IHVzZXIgPSByZXN1bHQudXNlcjtcclxuICogICAvLyBUaGlzIGdpdmVzIHlvdSBhIEZhY2Vib29rIEFjY2VzcyBUb2tlbi5cclxuICogICBjb25zdCBjcmVkZW50aWFsID0gcHJvdmlkZXIuY3JlZGVudGlhbEZyb21SZXN1bHQoYXV0aCwgcmVzdWx0KTtcclxuICogICBjb25zdCB0b2tlbiA9IGNyZWRlbnRpYWwuYWNjZXNzVG9rZW47XHJcbiAqIH1cclxuICogYGBgXHJcbiAqXHJcbiAqIEBleGFtcGxlXHJcbiAqIGBgYGphdmFzY3JpcHRcclxuICogLy8gU2lnbiBpbiB1c2luZyBhIHBvcHVwLlxyXG4gKiBjb25zdCBwcm92aWRlciA9IG5ldyBGYWNlYm9va0F1dGhQcm92aWRlcigpO1xyXG4gKiBwcm92aWRlci5hZGRTY29wZSgndXNlcl9iaXJ0aGRheScpO1xyXG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBzaWduSW5XaXRoUG9wdXAoYXV0aCwgcHJvdmlkZXIpO1xyXG4gKlxyXG4gKiAvLyBUaGUgc2lnbmVkLWluIHVzZXIgaW5mby5cclxuICogY29uc3QgdXNlciA9IHJlc3VsdC51c2VyO1xyXG4gKiAvLyBUaGlzIGdpdmVzIHlvdSBhIEZhY2Vib29rIEFjY2VzcyBUb2tlbi5cclxuICogY29uc3QgY3JlZGVudGlhbCA9IHByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tUmVzdWx0KGF1dGgsIHJlc3VsdCk7XHJcbiAqIGNvbnN0IHRva2VuID0gY3JlZGVudGlhbC5hY2Nlc3NUb2tlbjtcclxuICogYGBgXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmNsYXNzIEZhY2Vib29rQXV0aFByb3ZpZGVyIGV4dGVuZHMgQmFzZU9BdXRoUHJvdmlkZXIge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoXCJmYWNlYm9vay5jb21cIiAvKiBGQUNFQk9PSyAqLyk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYSBjcmVkZW50aWFsIGZvciBGYWNlYm9vay5cclxuICAgICAqXHJcbiAgICAgKiBAZXhhbXBsZVxyXG4gICAgICogYGBgamF2YXNjcmlwdFxyXG4gICAgICogLy8gYGV2ZW50YCBmcm9tIHRoZSBGYWNlYm9vayBhdXRoLmF1dGhSZXNwb25zZUNoYW5nZSBjYWxsYmFjay5cclxuICAgICAqIGNvbnN0IGNyZWRlbnRpYWwgPSBGYWNlYm9va0F1dGhQcm92aWRlci5jcmVkZW50aWFsKGV2ZW50LmF1dGhSZXNwb25zZS5hY2Nlc3NUb2tlbik7XHJcbiAgICAgKiBjb25zdCByZXN1bHQgPSBhd2FpdCBzaWduSW5XaXRoQ3JlZGVudGlhbChjcmVkZW50aWFsKTtcclxuICAgICAqIGBgYFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBhY2Nlc3NUb2tlbiAtIEZhY2Vib29rIGFjY2VzcyB0b2tlbi5cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGNyZWRlbnRpYWwoYWNjZXNzVG9rZW4pIHtcclxuICAgICAgICByZXR1cm4gT0F1dGhDcmVkZW50aWFsLl9mcm9tUGFyYW1zKHtcclxuICAgICAgICAgICAgcHJvdmlkZXJJZDogRmFjZWJvb2tBdXRoUHJvdmlkZXIuUFJPVklERVJfSUQsXHJcbiAgICAgICAgICAgIHNpZ25Jbk1ldGhvZDogRmFjZWJvb2tBdXRoUHJvdmlkZXIuRkFDRUJPT0tfU0lHTl9JTl9NRVRIT0QsXHJcbiAgICAgICAgICAgIGFjY2Vzc1Rva2VuXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFVzZWQgdG8gZXh0cmFjdCB0aGUgdW5kZXJseWluZyB7QGxpbmsgT0F1dGhDcmVkZW50aWFsfSBmcm9tIGEge0BsaW5rIFVzZXJDcmVkZW50aWFsfS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gdXNlckNyZWRlbnRpYWwgLSBUaGUgdXNlciBjcmVkZW50aWFsLlxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgY3JlZGVudGlhbEZyb21SZXN1bHQodXNlckNyZWRlbnRpYWwpIHtcclxuICAgICAgICByZXR1cm4gRmFjZWJvb2tBdXRoUHJvdmlkZXIuY3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3QodXNlckNyZWRlbnRpYWwpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBVc2VkIHRvIGV4dHJhY3QgdGhlIHVuZGVybHlpbmcge0BsaW5rIE9BdXRoQ3JlZGVudGlhbH0gZnJvbSBhIHtAbGluayBBdXRoRXJyb3J9IHdoaWNoIHdhc1xyXG4gICAgICogdGhyb3duIGR1cmluZyBhIHNpZ24taW4sIGxpbmssIG9yIHJlYXV0aGVudGljYXRlIG9wZXJhdGlvbi5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gdXNlckNyZWRlbnRpYWwgLSBUaGUgdXNlciBjcmVkZW50aWFsLlxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgY3JlZGVudGlhbEZyb21FcnJvcihlcnJvcikge1xyXG4gICAgICAgIHJldHVybiBGYWNlYm9va0F1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVRhZ2dlZE9iamVjdCgoZXJyb3IuY3VzdG9tRGF0YSB8fCB7fSkpO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIGNyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KHsgX3Rva2VuUmVzcG9uc2U6IHRva2VuUmVzcG9uc2UgfSkge1xyXG4gICAgICAgIGlmICghdG9rZW5SZXNwb25zZSB8fCAhKCdvYXV0aEFjY2Vzc1Rva2VuJyBpbiB0b2tlblJlc3BvbnNlKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0b2tlblJlc3BvbnNlLm9hdXRoQWNjZXNzVG9rZW4pIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHJldHVybiBGYWNlYm9va0F1dGhQcm92aWRlci5jcmVkZW50aWFsKHRva2VuUmVzcG9uc2Uub2F1dGhBY2Nlc3NUb2tlbik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChfYSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuLyoqIEFsd2F5cyBzZXQgdG8ge0BsaW5rIFNpZ25Jbk1ldGhvZH0uRkFDRUJPT0suICovXHJcbkZhY2Vib29rQXV0aFByb3ZpZGVyLkZBQ0VCT09LX1NJR05fSU5fTUVUSE9EID0gXCJmYWNlYm9vay5jb21cIiAvKiBGQUNFQk9PSyAqLztcclxuLyoqIEFsd2F5cyBzZXQgdG8ge0BsaW5rIFByb3ZpZGVySWR9LkZBQ0VCT09LLiAqL1xyXG5GYWNlYm9va0F1dGhQcm92aWRlci5QUk9WSURFUl9JRCA9IFwiZmFjZWJvb2suY29tXCIgLyogRkFDRUJPT0sgKi87XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBQcm92aWRlciBmb3IgZ2VuZXJhdGluZyBhbiBhbiB7QGxpbmsgT0F1dGhDcmVkZW50aWFsfSBmb3Ige0BsaW5rIFByb3ZpZGVySWR9LkdPT0dMRS5cclxuICpcclxuICogQGV4YW1wbGVcclxuICogYGBgamF2YXNjcmlwdFxyXG4gKiAvLyBTaWduIGluIHVzaW5nIGEgcmVkaXJlY3QuXHJcbiAqIGNvbnN0IHByb3ZpZGVyID0gbmV3IEdvb2dsZUF1dGhQcm92aWRlcigpO1xyXG4gKiAvLyBTdGFydCBhIHNpZ24gaW4gcHJvY2VzcyBmb3IgYW4gdW5hdXRoZW50aWNhdGVkIHVzZXIuXHJcbiAqIHByb3ZpZGVyLmFkZFNjb3BlKCdwcm9maWxlJyk7XHJcbiAqIHByb3ZpZGVyLmFkZFNjb3BlKCdlbWFpbCcpO1xyXG4gKiBhd2FpdCBzaWduSW5XaXRoUmVkaXJlY3QoYXV0aCwgcHJvdmlkZXIpO1xyXG4gKiAvLyBUaGlzIHdpbGwgdHJpZ2dlciBhIGZ1bGwgcGFnZSByZWRpcmVjdCBhd2F5IGZyb20geW91ciBhcHBcclxuICpcclxuICogLy8gQWZ0ZXIgcmV0dXJuaW5nIGZyb20gdGhlIHJlZGlyZWN0IHdoZW4geW91ciBhcHAgaW5pdGlhbGl6ZXMgeW91IGNhbiBvYnRhaW4gdGhlIHJlc3VsdFxyXG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRSZWRpcmVjdFJlc3VsdChhdXRoKTtcclxuICogaWYgKHJlc3VsdCkge1xyXG4gKiAgIC8vIFRoaXMgaXMgdGhlIHNpZ25lZC1pbiB1c2VyXHJcbiAqICAgY29uc3QgdXNlciA9IHJlc3VsdC51c2VyO1xyXG4gKiAgIC8vIFRoaXMgZ2l2ZXMgeW91IGEgR29vZ2xlIEFjY2VzcyBUb2tlbi5cclxuICogICBjb25zdCBjcmVkZW50aWFsID0gcHJvdmlkZXIuY3JlZGVudGlhbEZyb21SZXN1bHQoYXV0aCwgcmVzdWx0KTtcclxuICogICBjb25zdCB0b2tlbiA9IGNyZWRlbnRpYWwuYWNjZXNzVG9rZW47XHJcbiAqIH1cclxuICogYGBgXHJcbiAqXHJcbiAqIEBleGFtcGxlXHJcbiAqIGBgYGphdmFzY3JpcHRcclxuICogLy8gU2lnbiBpbiB1c2luZyBhIHBvcHVwLlxyXG4gKiBjb25zdCBwcm92aWRlciA9IG5ldyBHb29nbGVBdXRoUHJvdmlkZXIoKTtcclxuICogcHJvdmlkZXIuYWRkU2NvcGUoJ3Byb2ZpbGUnKTtcclxuICogcHJvdmlkZXIuYWRkU2NvcGUoJ2VtYWlsJyk7XHJcbiAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNpZ25JbldpdGhQb3B1cChhdXRoLCBwcm92aWRlcik7XHJcbiAqXHJcbiAqIC8vIFRoZSBzaWduZWQtaW4gdXNlciBpbmZvLlxyXG4gKiBjb25zdCB1c2VyID0gcmVzdWx0LnVzZXI7XHJcbiAqIC8vIFRoaXMgZ2l2ZXMgeW91IGEgR29vZ2xlIEFjY2VzcyBUb2tlbi5cclxuICogY29uc3QgY3JlZGVudGlhbCA9IHByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tUmVzdWx0KGF1dGgsIHJlc3VsdCk7XHJcbiAqIGNvbnN0IHRva2VuID0gY3JlZGVudGlhbC5hY2Nlc3NUb2tlbjtcclxuICogYGBgXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmNsYXNzIEdvb2dsZUF1dGhQcm92aWRlciBleHRlbmRzIEJhc2VPQXV0aFByb3ZpZGVyIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHN1cGVyKFwiZ29vZ2xlLmNvbVwiIC8qIEdPT0dMRSAqLyk7XHJcbiAgICAgICAgdGhpcy5hZGRTY29wZSgncHJvZmlsZScpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGEgY3JlZGVudGlhbCBmb3IgR29vZ2xlLiBBdCBsZWFzdCBvbmUgb2YgSUQgdG9rZW4gYW5kIGFjY2VzcyB0b2tlbiBpcyByZXF1aXJlZC5cclxuICAgICAqXHJcbiAgICAgKiBAZXhhbXBsZVxyXG4gICAgICogYGBgamF2YXNjcmlwdFxyXG4gICAgICogLy8gXFxgZ29vZ2xlVXNlclxcYCBmcm9tIHRoZSBvbnN1Y2Nlc3MgR29vZ2xlIFNpZ24gSW4gY2FsbGJhY2suXHJcbiAgICAgKiBjb25zdCBjcmVkZW50aWFsID0gR29vZ2xlQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWwoZ29vZ2xlVXNlci5nZXRBdXRoUmVzcG9uc2UoKS5pZF90b2tlbik7XHJcbiAgICAgKiBjb25zdCByZXN1bHQgPSBhd2FpdCBzaWduSW5XaXRoQ3JlZGVudGlhbChjcmVkZW50aWFsKTtcclxuICAgICAqIGBgYFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBpZFRva2VuIC0gR29vZ2xlIElEIHRva2VuLlxyXG4gICAgICogQHBhcmFtIGFjY2Vzc1Rva2VuIC0gR29vZ2xlIGFjY2VzcyB0b2tlbi5cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGNyZWRlbnRpYWwoaWRUb2tlbiwgYWNjZXNzVG9rZW4pIHtcclxuICAgICAgICByZXR1cm4gT0F1dGhDcmVkZW50aWFsLl9mcm9tUGFyYW1zKHtcclxuICAgICAgICAgICAgcHJvdmlkZXJJZDogR29vZ2xlQXV0aFByb3ZpZGVyLlBST1ZJREVSX0lELFxyXG4gICAgICAgICAgICBzaWduSW5NZXRob2Q6IEdvb2dsZUF1dGhQcm92aWRlci5HT09HTEVfU0lHTl9JTl9NRVRIT0QsXHJcbiAgICAgICAgICAgIGlkVG9rZW4sXHJcbiAgICAgICAgICAgIGFjY2Vzc1Rva2VuXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFVzZWQgdG8gZXh0cmFjdCB0aGUgdW5kZXJseWluZyB7QGxpbmsgT0F1dGhDcmVkZW50aWFsfSBmcm9tIGEge0BsaW5rIFVzZXJDcmVkZW50aWFsfS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gdXNlckNyZWRlbnRpYWwgLSBUaGUgdXNlciBjcmVkZW50aWFsLlxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgY3JlZGVudGlhbEZyb21SZXN1bHQodXNlckNyZWRlbnRpYWwpIHtcclxuICAgICAgICByZXR1cm4gR29vZ2xlQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KHVzZXJDcmVkZW50aWFsKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogVXNlZCB0byBleHRyYWN0IHRoZSB1bmRlcmx5aW5nIHtAbGluayBPQXV0aENyZWRlbnRpYWx9IGZyb20gYSB7QGxpbmsgQXV0aEVycm9yfSB3aGljaCB3YXNcclxuICAgICAqIHRocm93biBkdXJpbmcgYSBzaWduLWluLCBsaW5rLCBvciByZWF1dGhlbnRpY2F0ZSBvcGVyYXRpb24uXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHVzZXJDcmVkZW50aWFsIC0gVGhlIHVzZXIgY3JlZGVudGlhbC5cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGNyZWRlbnRpYWxGcm9tRXJyb3IoZXJyb3IpIHtcclxuICAgICAgICByZXR1cm4gR29vZ2xlQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KChlcnJvci5jdXN0b21EYXRhIHx8IHt9KSk7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgY3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3QoeyBfdG9rZW5SZXNwb25zZTogdG9rZW5SZXNwb25zZSB9KSB7XHJcbiAgICAgICAgaWYgKCF0b2tlblJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCB7IG9hdXRoSWRUb2tlbiwgb2F1dGhBY2Nlc3NUb2tlbiB9ID0gdG9rZW5SZXNwb25zZTtcclxuICAgICAgICBpZiAoIW9hdXRoSWRUb2tlbiAmJiAhb2F1dGhBY2Nlc3NUb2tlbikge1xyXG4gICAgICAgICAgICAvLyBUaGlzIGNvdWxkIGJlIGFuIG9hdXRoIDEgY3JlZGVudGlhbCBvciBhIHBob25lIGNyZWRlbnRpYWxcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHJldHVybiBHb29nbGVBdXRoUHJvdmlkZXIuY3JlZGVudGlhbChvYXV0aElkVG9rZW4sIG9hdXRoQWNjZXNzVG9rZW4pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoX2EpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbi8qKiBBbHdheXMgc2V0IHRvIHtAbGluayBTaWduSW5NZXRob2R9LkdPT0dMRS4gKi9cclxuR29vZ2xlQXV0aFByb3ZpZGVyLkdPT0dMRV9TSUdOX0lOX01FVEhPRCA9IFwiZ29vZ2xlLmNvbVwiIC8qIEdPT0dMRSAqLztcclxuLyoqIEFsd2F5cyBzZXQgdG8ge0BsaW5rIFByb3ZpZGVySWR9LkdPT0dMRS4gKi9cclxuR29vZ2xlQXV0aFByb3ZpZGVyLlBST1ZJREVSX0lEID0gXCJnb29nbGUuY29tXCIgLyogR09PR0xFICovO1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogUHJvdmlkZXIgZm9yIGdlbmVyYXRpbmcgYW4ge0BsaW5rIE9BdXRoQ3JlZGVudGlhbH0gZm9yIHtAbGluayBQcm92aWRlcklkfS5HSVRIVUIuXHJcbiAqXHJcbiAqIEByZW1hcmtzXHJcbiAqIEdpdEh1YiByZXF1aXJlcyBhbiBPQXV0aCAyLjAgcmVkaXJlY3QsIHNvIHlvdSBjYW4gZWl0aGVyIGhhbmRsZSB0aGUgcmVkaXJlY3QgZGlyZWN0bHksIG9yIHVzZVxyXG4gKiB0aGUge0BsaW5rIHNpZ25JbldpdGhQb3B1cH0gaGFuZGxlcjpcclxuICpcclxuICogQGV4YW1wbGVcclxuICogYGBgamF2YXNjcmlwdFxyXG4gKiAvLyBTaWduIGluIHVzaW5nIGEgcmVkaXJlY3QuXHJcbiAqIGNvbnN0IHByb3ZpZGVyID0gbmV3IEdpdGh1YkF1dGhQcm92aWRlcigpO1xyXG4gKiAvLyBTdGFydCBhIHNpZ24gaW4gcHJvY2VzcyBmb3IgYW4gdW5hdXRoZW50aWNhdGVkIHVzZXIuXHJcbiAqIHByb3ZpZGVyLmFkZFNjb3BlKCdyZXBvJyk7XHJcbiAqIGF3YWl0IHNpZ25JbldpdGhSZWRpcmVjdChhdXRoLCBwcm92aWRlcik7XHJcbiAqIC8vIFRoaXMgd2lsbCB0cmlnZ2VyIGEgZnVsbCBwYWdlIHJlZGlyZWN0IGF3YXkgZnJvbSB5b3VyIGFwcFxyXG4gKlxyXG4gKiAvLyBBZnRlciByZXR1cm5pbmcgZnJvbSB0aGUgcmVkaXJlY3Qgd2hlbiB5b3VyIGFwcCBpbml0aWFsaXplcyB5b3UgY2FuIG9idGFpbiB0aGUgcmVzdWx0XHJcbiAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdldFJlZGlyZWN0UmVzdWx0KGF1dGgpO1xyXG4gKiBpZiAocmVzdWx0KSB7XHJcbiAqICAgLy8gVGhpcyBpcyB0aGUgc2lnbmVkLWluIHVzZXJcclxuICogICBjb25zdCB1c2VyID0gcmVzdWx0LnVzZXI7XHJcbiAqICAgLy8gVGhpcyBnaXZlcyB5b3UgYSBHaXRodWIgQWNjZXNzIFRva2VuLlxyXG4gKiAgIGNvbnN0IGNyZWRlbnRpYWwgPSBwcm92aWRlci5jcmVkZW50aWFsRnJvbVJlc3VsdChhdXRoLCByZXN1bHQpO1xyXG4gKiAgIGNvbnN0IHRva2VuID0gY3JlZGVudGlhbC5hY2Nlc3NUb2tlbjtcclxuICogfVxyXG4gKiBgYGBcclxuICpcclxuICogQGV4YW1wbGVcclxuICogYGBgamF2YXNjcmlwdFxyXG4gKiAvLyBTaWduIGluIHVzaW5nIGEgcG9wdXAuXHJcbiAqIGNvbnN0IHByb3ZpZGVyID0gbmV3IEdpdGh1YkF1dGhQcm92aWRlcigpO1xyXG4gKiBwcm92aWRlci5hZGRTY29wZSgncmVwbycpO1xyXG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBzaWduSW5XaXRoUG9wdXAoYXV0aCwgcHJvdmlkZXIpO1xyXG4gKlxyXG4gKiAvLyBUaGUgc2lnbmVkLWluIHVzZXIgaW5mby5cclxuICogY29uc3QgdXNlciA9IHJlc3VsdC51c2VyO1xyXG4gKiAvLyBUaGlzIGdpdmVzIHlvdSBhIEdpdGh1YiBBY2Nlc3MgVG9rZW4uXHJcbiAqIGNvbnN0IGNyZWRlbnRpYWwgPSBwcm92aWRlci5jcmVkZW50aWFsRnJvbVJlc3VsdChhdXRoLCByZXN1bHQpO1xyXG4gKiBjb25zdCB0b2tlbiA9IGNyZWRlbnRpYWwuYWNjZXNzVG9rZW47XHJcbiAqIGBgYFxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5jbGFzcyBHaXRodWJBdXRoUHJvdmlkZXIgZXh0ZW5kcyBCYXNlT0F1dGhQcm92aWRlciB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcihcImdpdGh1Yi5jb21cIiAvKiBHSVRIVUIgKi8pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGEgY3JlZGVudGlhbCBmb3IgR2l0aHViLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBhY2Nlc3NUb2tlbiAtIEdpdGh1YiBhY2Nlc3MgdG9rZW4uXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBjcmVkZW50aWFsKGFjY2Vzc1Rva2VuKSB7XHJcbiAgICAgICAgcmV0dXJuIE9BdXRoQ3JlZGVudGlhbC5fZnJvbVBhcmFtcyh7XHJcbiAgICAgICAgICAgIHByb3ZpZGVySWQ6IEdpdGh1YkF1dGhQcm92aWRlci5QUk9WSURFUl9JRCxcclxuICAgICAgICAgICAgc2lnbkluTWV0aG9kOiBHaXRodWJBdXRoUHJvdmlkZXIuR0lUSFVCX1NJR05fSU5fTUVUSE9ELFxyXG4gICAgICAgICAgICBhY2Nlc3NUb2tlblxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBVc2VkIHRvIGV4dHJhY3QgdGhlIHVuZGVybHlpbmcge0BsaW5rIE9BdXRoQ3JlZGVudGlhbH0gZnJvbSBhIHtAbGluayBVc2VyQ3JlZGVudGlhbH0uXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHVzZXJDcmVkZW50aWFsIC0gVGhlIHVzZXIgY3JlZGVudGlhbC5cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGNyZWRlbnRpYWxGcm9tUmVzdWx0KHVzZXJDcmVkZW50aWFsKSB7XHJcbiAgICAgICAgcmV0dXJuIEdpdGh1YkF1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVRhZ2dlZE9iamVjdCh1c2VyQ3JlZGVudGlhbCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFVzZWQgdG8gZXh0cmFjdCB0aGUgdW5kZXJseWluZyB7QGxpbmsgT0F1dGhDcmVkZW50aWFsfSBmcm9tIGEge0BsaW5rIEF1dGhFcnJvcn0gd2hpY2ggd2FzXHJcbiAgICAgKiB0aHJvd24gZHVyaW5nIGEgc2lnbi1pbiwgbGluaywgb3IgcmVhdXRoZW50aWNhdGUgb3BlcmF0aW9uLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB1c2VyQ3JlZGVudGlhbCAtIFRoZSB1c2VyIGNyZWRlbnRpYWwuXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBjcmVkZW50aWFsRnJvbUVycm9yKGVycm9yKSB7XHJcbiAgICAgICAgcmV0dXJuIEdpdGh1YkF1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVRhZ2dlZE9iamVjdCgoZXJyb3IuY3VzdG9tRGF0YSB8fCB7fSkpO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIGNyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KHsgX3Rva2VuUmVzcG9uc2U6IHRva2VuUmVzcG9uc2UgfSkge1xyXG4gICAgICAgIGlmICghdG9rZW5SZXNwb25zZSB8fCAhKCdvYXV0aEFjY2Vzc1Rva2VuJyBpbiB0b2tlblJlc3BvbnNlKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0b2tlblJlc3BvbnNlLm9hdXRoQWNjZXNzVG9rZW4pIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHJldHVybiBHaXRodWJBdXRoUHJvdmlkZXIuY3JlZGVudGlhbCh0b2tlblJlc3BvbnNlLm9hdXRoQWNjZXNzVG9rZW4pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoX2EpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbi8qKiBBbHdheXMgc2V0IHRvIHtAbGluayBTaWduSW5NZXRob2R9LkdJVEhVQi4gKi9cclxuR2l0aHViQXV0aFByb3ZpZGVyLkdJVEhVQl9TSUdOX0lOX01FVEhPRCA9IFwiZ2l0aHViLmNvbVwiIC8qIEdJVEhVQiAqLztcclxuLyoqIEFsd2F5cyBzZXQgdG8ge0BsaW5rIFByb3ZpZGVySWR9LkdJVEhVQi4gKi9cclxuR2l0aHViQXV0aFByb3ZpZGVyLlBST1ZJREVSX0lEID0gXCJnaXRodWIuY29tXCIgLyogR0lUSFVCICovO1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jb25zdCBJRFBfUkVRVUVTVF9VUkkgPSAnaHR0cDovL2xvY2FsaG9zdCc7XHJcbi8qKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5jbGFzcyBTQU1MQXV0aENyZWRlbnRpYWwgZXh0ZW5kcyBBdXRoQ3JlZGVudGlhbCB7XHJcbiAgICAvKiogQGludGVybmFsICovXHJcbiAgICBjb25zdHJ1Y3Rvcihwcm92aWRlcklkLCBwZW5kaW5nVG9rZW4pIHtcclxuICAgICAgICBzdXBlcihwcm92aWRlcklkLCBwcm92aWRlcklkKTtcclxuICAgICAgICB0aGlzLnBlbmRpbmdUb2tlbiA9IHBlbmRpbmdUb2tlbjtcclxuICAgIH1cclxuICAgIC8qKiBAaW50ZXJuYWwgKi9cclxuICAgIF9nZXRJZFRva2VuUmVzcG9uc2UoYXV0aCkge1xyXG4gICAgICAgIGNvbnN0IHJlcXVlc3QgPSB0aGlzLmJ1aWxkUmVxdWVzdCgpO1xyXG4gICAgICAgIHJldHVybiBzaWduSW5XaXRoSWRwKGF1dGgsIHJlcXVlc3QpO1xyXG4gICAgfVxyXG4gICAgLyoqIEBpbnRlcm5hbCAqL1xyXG4gICAgX2xpbmtUb0lkVG9rZW4oYXV0aCwgaWRUb2tlbikge1xyXG4gICAgICAgIGNvbnN0IHJlcXVlc3QgPSB0aGlzLmJ1aWxkUmVxdWVzdCgpO1xyXG4gICAgICAgIHJlcXVlc3QuaWRUb2tlbiA9IGlkVG9rZW47XHJcbiAgICAgICAgcmV0dXJuIHNpZ25JbldpdGhJZHAoYXV0aCwgcmVxdWVzdCk7XHJcbiAgICB9XHJcbiAgICAvKiogQGludGVybmFsICovXHJcbiAgICBfZ2V0UmVhdXRoZW50aWNhdGlvblJlc29sdmVyKGF1dGgpIHtcclxuICAgICAgICBjb25zdCByZXF1ZXN0ID0gdGhpcy5idWlsZFJlcXVlc3QoKTtcclxuICAgICAgICByZXF1ZXN0LmF1dG9DcmVhdGUgPSBmYWxzZTtcclxuICAgICAgICByZXR1cm4gc2lnbkluV2l0aElkcChhdXRoLCByZXF1ZXN0KTtcclxuICAgIH1cclxuICAgIC8qKiB7QGluaGVyaXRkb2MgQXV0aENyZWRlbnRpYWwudG9KU09OfSAgKi9cclxuICAgIHRvSlNPTigpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzaWduSW5NZXRob2Q6IHRoaXMuc2lnbkluTWV0aG9kLFxyXG4gICAgICAgICAgICBwcm92aWRlcklkOiB0aGlzLnByb3ZpZGVySWQsXHJcbiAgICAgICAgICAgIHBlbmRpbmdUb2tlbjogdGhpcy5wZW5kaW5nVG9rZW5cclxuICAgICAgICB9O1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBTdGF0aWMgbWV0aG9kIHRvIGRlc2VyaWFsaXplIGEgSlNPTiByZXByZXNlbnRhdGlvbiBvZiBhbiBvYmplY3QgaW50byBhblxyXG4gICAgICoge0BsaW5rICBBdXRoQ3JlZGVudGlhbH0uXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGpzb24gLSBJbnB1dCBjYW4gYmUgZWl0aGVyIE9iamVjdCBvciB0aGUgc3RyaW5naWZpZWQgcmVwcmVzZW50YXRpb24gb2YgdGhlIG9iamVjdC5cclxuICAgICAqIFdoZW4gc3RyaW5nIGlzIHByb3ZpZGVkLCBKU09OLnBhcnNlIHdvdWxkIGJlIGNhbGxlZCBmaXJzdC5cclxuICAgICAqXHJcbiAgICAgKiBAcmV0dXJucyBJZiB0aGUgSlNPTiBpbnB1dCBkb2VzIG5vdCByZXByZXNlbnQgYW4ge0BsaW5rICBBdXRoQ3JlZGVudGlhbH0sIG51bGwgaXMgcmV0dXJuZWQuXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBmcm9tSlNPTihqc29uKSB7XHJcbiAgICAgICAgY29uc3Qgb2JqID0gdHlwZW9mIGpzb24gPT09ICdzdHJpbmcnID8gSlNPTi5wYXJzZShqc29uKSA6IGpzb247XHJcbiAgICAgICAgY29uc3QgeyBwcm92aWRlcklkLCBzaWduSW5NZXRob2QsIHBlbmRpbmdUb2tlbiB9ID0gb2JqO1xyXG4gICAgICAgIGlmICghcHJvdmlkZXJJZCB8fFxyXG4gICAgICAgICAgICAhc2lnbkluTWV0aG9kIHx8XHJcbiAgICAgICAgICAgICFwZW5kaW5nVG9rZW4gfHxcclxuICAgICAgICAgICAgcHJvdmlkZXJJZCAhPT0gc2lnbkluTWV0aG9kKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV3IFNBTUxBdXRoQ3JlZGVudGlhbChwcm92aWRlcklkLCBwZW5kaW5nVG9rZW4pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBIZWxwZXIgc3RhdGljIG1ldGhvZCB0byBhdm9pZCBleHBvc2luZyB0aGUgY29uc3RydWN0b3IgdG8gZW5kIHVzZXJzLlxyXG4gICAgICpcclxuICAgICAqIEBpbnRlcm5hbFxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgX2NyZWF0ZShwcm92aWRlcklkLCBwZW5kaW5nVG9rZW4pIHtcclxuICAgICAgICByZXR1cm4gbmV3IFNBTUxBdXRoQ3JlZGVudGlhbChwcm92aWRlcklkLCBwZW5kaW5nVG9rZW4pO1xyXG4gICAgfVxyXG4gICAgYnVpbGRSZXF1ZXN0KCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHJlcXVlc3RVcmk6IElEUF9SRVFVRVNUX1VSSSxcclxuICAgICAgICAgICAgcmV0dXJuU2VjdXJlVG9rZW46IHRydWUsXHJcbiAgICAgICAgICAgIHBlbmRpbmdUb2tlbjogdGhpcy5wZW5kaW5nVG9rZW5cclxuICAgICAgICB9O1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmNvbnN0IFNBTUxfUFJPVklERVJfUFJFRklYID0gJ3NhbWwuJztcclxuLyoqXHJcbiAqIEFuIHtAbGluayBBdXRoUHJvdmlkZXJ9IGZvciBTQU1MLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5jbGFzcyBTQU1MQXV0aFByb3ZpZGVyIGV4dGVuZHMgRmVkZXJhdGVkQXV0aFByb3ZpZGVyIHtcclxuICAgIC8qKlxyXG4gICAgICogQ29uc3RydWN0b3IuIFRoZSBwcm92aWRlcklkIG11c3Qgc3RhcnQgd2l0aCBcInNhbWwuXCJcclxuICAgICAqIEBwYXJhbSBwcm92aWRlcklkIC0gU0FNTCBwcm92aWRlciBJRC5cclxuICAgICAqL1xyXG4gICAgY29uc3RydWN0b3IocHJvdmlkZXJJZCkge1xyXG4gICAgICAgIF9hc3NlcnQocHJvdmlkZXJJZC5zdGFydHNXaXRoKFNBTUxfUFJPVklERVJfUFJFRklYKSwgXCJhcmd1bWVudC1lcnJvclwiIC8qIEFSR1VNRU5UX0VSUk9SICovKTtcclxuICAgICAgICBzdXBlcihwcm92aWRlcklkKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogR2VuZXJhdGVzIGFuIHtAbGluayBBdXRoQ3JlZGVudGlhbH0gZnJvbSBhIHtAbGluayBVc2VyQ3JlZGVudGlhbH0gYWZ0ZXIgYVxyXG4gICAgICogc3VjY2Vzc2Z1bCBTQU1MIGZsb3cgY29tcGxldGVzLlxyXG4gICAgICpcclxuICAgICAqIEByZW1hcmtzXHJcbiAgICAgKlxyXG4gICAgICogRm9yIGV4YW1wbGUsIHRvIGdldCBhbiB7QGxpbmsgQXV0aENyZWRlbnRpYWx9LCB5b3UgY291bGQgd3JpdGUgdGhlXHJcbiAgICAgKiBmb2xsb3dpbmcgY29kZTpcclxuICAgICAqXHJcbiAgICAgKiBgYGBqc1xyXG4gICAgICogY29uc3QgdXNlckNyZWRlbnRpYWwgPSBhd2FpdCBzaWduSW5XaXRoUG9wdXAoYXV0aCwgc2FtbFByb3ZpZGVyKTtcclxuICAgICAqIGNvbnN0IGNyZWRlbnRpYWwgPSBTQU1MQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tUmVzdWx0KHVzZXJDcmVkZW50aWFsKTtcclxuICAgICAqIGBgYFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB1c2VyQ3JlZGVudGlhbCAtIFRoZSB1c2VyIGNyZWRlbnRpYWwuXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBjcmVkZW50aWFsRnJvbVJlc3VsdCh1c2VyQ3JlZGVudGlhbCkge1xyXG4gICAgICAgIHJldHVybiBTQU1MQXV0aFByb3ZpZGVyLnNhbWxDcmVkZW50aWFsRnJvbVRhZ2dlZE9iamVjdCh1c2VyQ3JlZGVudGlhbCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFVzZWQgdG8gZXh0cmFjdCB0aGUgdW5kZXJseWluZyB7QGxpbmsgT0F1dGhDcmVkZW50aWFsfSBmcm9tIGEge0BsaW5rIEF1dGhFcnJvcn0gd2hpY2ggd2FzXHJcbiAgICAgKiB0aHJvd24gZHVyaW5nIGEgc2lnbi1pbiwgbGluaywgb3IgcmVhdXRoZW50aWNhdGUgb3BlcmF0aW9uLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB1c2VyQ3JlZGVudGlhbCAtIFRoZSB1c2VyIGNyZWRlbnRpYWwuXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBjcmVkZW50aWFsRnJvbUVycm9yKGVycm9yKSB7XHJcbiAgICAgICAgcmV0dXJuIFNBTUxBdXRoUHJvdmlkZXIuc2FtbENyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KChlcnJvci5jdXN0b21EYXRhIHx8IHt9KSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYW4ge0BsaW5rIEF1dGhDcmVkZW50aWFsfSBmcm9tIGEgSlNPTiBzdHJpbmcgb3IgYSBwbGFpbiBvYmplY3QuXHJcbiAgICAgKiBAcGFyYW0ganNvbiAtIEEgcGxhaW4gb2JqZWN0IG9yIGEgSlNPTiBzdHJpbmdcclxuICAgICAqL1xyXG4gICAgc3RhdGljIGNyZWRlbnRpYWxGcm9tSlNPTihqc29uKSB7XHJcbiAgICAgICAgY29uc3QgY3JlZGVudGlhbCA9IFNBTUxBdXRoQ3JlZGVudGlhbC5mcm9tSlNPTihqc29uKTtcclxuICAgICAgICBfYXNzZXJ0KGNyZWRlbnRpYWwsIFwiYXJndW1lbnQtZXJyb3JcIiAvKiBBUkdVTUVOVF9FUlJPUiAqLyk7XHJcbiAgICAgICAgcmV0dXJuIGNyZWRlbnRpYWw7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgc2FtbENyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KHsgX3Rva2VuUmVzcG9uc2U6IHRva2VuUmVzcG9uc2UgfSkge1xyXG4gICAgICAgIGlmICghdG9rZW5SZXNwb25zZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgeyBwZW5kaW5nVG9rZW4sIHByb3ZpZGVySWQgfSA9IHRva2VuUmVzcG9uc2U7XHJcbiAgICAgICAgaWYgKCFwZW5kaW5nVG9rZW4gfHwgIXByb3ZpZGVySWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHJldHVybiBTQU1MQXV0aENyZWRlbnRpYWwuX2NyZWF0ZShwcm92aWRlcklkLCBwZW5kaW5nVG9rZW4pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFByb3ZpZGVyIGZvciBnZW5lcmF0aW5nIGFuIHtAbGluayBPQXV0aENyZWRlbnRpYWx9IGZvciB7QGxpbmsgUHJvdmlkZXJJZH0uVFdJVFRFUi5cclxuICpcclxuICogQGV4YW1wbGVcclxuICogYGBgamF2YXNjcmlwdFxyXG4gKiAvLyBTaWduIGluIHVzaW5nIGEgcmVkaXJlY3QuXHJcbiAqIGNvbnN0IHByb3ZpZGVyID0gbmV3IFR3aXR0ZXJBdXRoUHJvdmlkZXIoKTtcclxuICogLy8gU3RhcnQgYSBzaWduIGluIHByb2Nlc3MgZm9yIGFuIHVuYXV0aGVudGljYXRlZCB1c2VyLlxyXG4gKiBhd2FpdCBzaWduSW5XaXRoUmVkaXJlY3QoYXV0aCwgcHJvdmlkZXIpO1xyXG4gKiAvLyBUaGlzIHdpbGwgdHJpZ2dlciBhIGZ1bGwgcGFnZSByZWRpcmVjdCBhd2F5IGZyb20geW91ciBhcHBcclxuICpcclxuICogLy8gQWZ0ZXIgcmV0dXJuaW5nIGZyb20gdGhlIHJlZGlyZWN0IHdoZW4geW91ciBhcHAgaW5pdGlhbGl6ZXMgeW91IGNhbiBvYnRhaW4gdGhlIHJlc3VsdFxyXG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRSZWRpcmVjdFJlc3VsdChhdXRoKTtcclxuICogaWYgKHJlc3VsdCkge1xyXG4gKiAgIC8vIFRoaXMgaXMgdGhlIHNpZ25lZC1pbiB1c2VyXHJcbiAqICAgY29uc3QgdXNlciA9IHJlc3VsdC51c2VyO1xyXG4gKiAgIC8vIFRoaXMgZ2l2ZXMgeW91IGEgVHdpdHRlciBBY2Nlc3MgVG9rZW4gYW5kIFNlY3JldC5cclxuICogICBjb25zdCBjcmVkZW50aWFsID0gcHJvdmlkZXIuY3JlZGVudGlhbEZyb21SZXN1bHQoYXV0aCwgcmVzdWx0KTtcclxuICogICBjb25zdCB0b2tlbiA9IGNyZWRlbnRpYWwuYWNjZXNzVG9rZW47XHJcbiAqICAgY29uc3Qgc2VjcmV0ID0gY3JlZGVudGlhbC5zZWNyZXQ7XHJcbiAqIH1cclxuICogYGBgXHJcbiAqXHJcbiAqIEBleGFtcGxlXHJcbiAqIGBgYGphdmFzY3JpcHRcclxuICogLy8gU2lnbiBpbiB1c2luZyBhIHBvcHVwLlxyXG4gKiBjb25zdCBwcm92aWRlciA9IG5ldyBUd2l0dGVyQXV0aFByb3ZpZGVyKCk7XHJcbiAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNpZ25JbldpdGhQb3B1cChhdXRoLCBwcm92aWRlcik7XHJcbiAqXHJcbiAqIC8vIFRoZSBzaWduZWQtaW4gdXNlciBpbmZvLlxyXG4gKiBjb25zdCB1c2VyID0gcmVzdWx0LnVzZXI7XHJcbiAqIC8vIFRoaXMgZ2l2ZXMgeW91IGEgVHdpdHRlciBBY2Nlc3MgVG9rZW4gYW5kIFNlY3JldC5cclxuICogY29uc3QgY3JlZGVudGlhbCA9IHByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tUmVzdWx0KGF1dGgsIHJlc3VsdCk7XHJcbiAqIGNvbnN0IHRva2VuID0gY3JlZGVudGlhbC5hY2Nlc3NUb2tlbjtcclxuICogY29uc3Qgc2VjcmV0ID0gY3JlZGVudGlhbC5zZWNyZXQ7XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5jbGFzcyBUd2l0dGVyQXV0aFByb3ZpZGVyIGV4dGVuZHMgQmFzZU9BdXRoUHJvdmlkZXIge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoXCJ0d2l0dGVyLmNvbVwiIC8qIFRXSVRURVIgKi8pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGEgY3JlZGVudGlhbCBmb3IgVHdpdHRlci5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gdG9rZW4gLSBUd2l0dGVyIGFjY2VzcyB0b2tlbi5cclxuICAgICAqIEBwYXJhbSBzZWNyZXQgLSBUd2l0dGVyIHNlY3JldC5cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGNyZWRlbnRpYWwodG9rZW4sIHNlY3JldCkge1xyXG4gICAgICAgIHJldHVybiBPQXV0aENyZWRlbnRpYWwuX2Zyb21QYXJhbXMoe1xyXG4gICAgICAgICAgICBwcm92aWRlcklkOiBUd2l0dGVyQXV0aFByb3ZpZGVyLlBST1ZJREVSX0lELFxyXG4gICAgICAgICAgICBzaWduSW5NZXRob2Q6IFR3aXR0ZXJBdXRoUHJvdmlkZXIuVFdJVFRFUl9TSUdOX0lOX01FVEhPRCxcclxuICAgICAgICAgICAgb2F1dGhUb2tlbjogdG9rZW4sXHJcbiAgICAgICAgICAgIG9hdXRoVG9rZW5TZWNyZXQ6IHNlY3JldFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBVc2VkIHRvIGV4dHJhY3QgdGhlIHVuZGVybHlpbmcge0BsaW5rIE9BdXRoQ3JlZGVudGlhbH0gZnJvbSBhIHtAbGluayBVc2VyQ3JlZGVudGlhbH0uXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHVzZXJDcmVkZW50aWFsIC0gVGhlIHVzZXIgY3JlZGVudGlhbC5cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGNyZWRlbnRpYWxGcm9tUmVzdWx0KHVzZXJDcmVkZW50aWFsKSB7XHJcbiAgICAgICAgcmV0dXJuIFR3aXR0ZXJBdXRoUHJvdmlkZXIuY3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3QodXNlckNyZWRlbnRpYWwpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBVc2VkIHRvIGV4dHJhY3QgdGhlIHVuZGVybHlpbmcge0BsaW5rIE9BdXRoQ3JlZGVudGlhbH0gZnJvbSBhIHtAbGluayBBdXRoRXJyb3J9IHdoaWNoIHdhc1xyXG4gICAgICogdGhyb3duIGR1cmluZyBhIHNpZ24taW4sIGxpbmssIG9yIHJlYXV0aGVudGljYXRlIG9wZXJhdGlvbi5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gdXNlckNyZWRlbnRpYWwgLSBUaGUgdXNlciBjcmVkZW50aWFsLlxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgY3JlZGVudGlhbEZyb21FcnJvcihlcnJvcikge1xyXG4gICAgICAgIHJldHVybiBUd2l0dGVyQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KChlcnJvci5jdXN0b21EYXRhIHx8IHt9KSk7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgY3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3QoeyBfdG9rZW5SZXNwb25zZTogdG9rZW5SZXNwb25zZSB9KSB7XHJcbiAgICAgICAgaWYgKCF0b2tlblJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCB7IG9hdXRoQWNjZXNzVG9rZW4sIG9hdXRoVG9rZW5TZWNyZXQgfSA9IHRva2VuUmVzcG9uc2U7XHJcbiAgICAgICAgaWYgKCFvYXV0aEFjY2Vzc1Rva2VuIHx8ICFvYXV0aFRva2VuU2VjcmV0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICByZXR1cm4gVHdpdHRlckF1dGhQcm92aWRlci5jcmVkZW50aWFsKG9hdXRoQWNjZXNzVG9rZW4sIG9hdXRoVG9rZW5TZWNyZXQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoX2EpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbi8qKiBBbHdheXMgc2V0IHRvIHtAbGluayBTaWduSW5NZXRob2R9LlRXSVRURVIuICovXHJcblR3aXR0ZXJBdXRoUHJvdmlkZXIuVFdJVFRFUl9TSUdOX0lOX01FVEhPRCA9IFwidHdpdHRlci5jb21cIiAvKiBUV0lUVEVSICovO1xyXG4vKiogQWx3YXlzIHNldCB0byB7QGxpbmsgUHJvdmlkZXJJZH0uVFdJVFRFUi4gKi9cclxuVHdpdHRlckF1dGhQcm92aWRlci5QUk9WSURFUl9JRCA9IFwidHdpdHRlci5jb21cIiAvKiBUV0lUVEVSICovO1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBzaWduVXAoYXV0aCwgcmVxdWVzdCkge1xyXG4gICAgcmV0dXJuIF9wZXJmb3JtU2lnbkluUmVxdWVzdChhdXRoLCBcIlBPU1RcIiAvKiBQT1NUICovLCBcIi92MS9hY2NvdW50czpzaWduVXBcIiAvKiBTSUdOX1VQICovLCBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdCkpO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmNsYXNzIFVzZXJDcmVkZW50aWFsSW1wbCB7XHJcbiAgICBjb25zdHJ1Y3RvcihwYXJhbXMpIHtcclxuICAgICAgICB0aGlzLnVzZXIgPSBwYXJhbXMudXNlcjtcclxuICAgICAgICB0aGlzLnByb3ZpZGVySWQgPSBwYXJhbXMucHJvdmlkZXJJZDtcclxuICAgICAgICB0aGlzLl90b2tlblJlc3BvbnNlID0gcGFyYW1zLl90b2tlblJlc3BvbnNlO1xyXG4gICAgICAgIHRoaXMub3BlcmF0aW9uVHlwZSA9IHBhcmFtcy5vcGVyYXRpb25UeXBlO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIGFzeW5jIF9mcm9tSWRUb2tlblJlc3BvbnNlKGF1dGgsIG9wZXJhdGlvblR5cGUsIGlkVG9rZW5SZXNwb25zZSwgaXNBbm9ueW1vdXMgPSBmYWxzZSkge1xyXG4gICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VySW1wbC5fZnJvbUlkVG9rZW5SZXNwb25zZShhdXRoLCBpZFRva2VuUmVzcG9uc2UsIGlzQW5vbnltb3VzKTtcclxuICAgICAgICBjb25zdCBwcm92aWRlcklkID0gcHJvdmlkZXJJZEZvclJlc3BvbnNlKGlkVG9rZW5SZXNwb25zZSk7XHJcbiAgICAgICAgY29uc3QgdXNlckNyZWQgPSBuZXcgVXNlckNyZWRlbnRpYWxJbXBsKHtcclxuICAgICAgICAgICAgdXNlcixcclxuICAgICAgICAgICAgcHJvdmlkZXJJZCxcclxuICAgICAgICAgICAgX3Rva2VuUmVzcG9uc2U6IGlkVG9rZW5SZXNwb25zZSxcclxuICAgICAgICAgICAgb3BlcmF0aW9uVHlwZVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB1c2VyQ3JlZDtcclxuICAgIH1cclxuICAgIHN0YXRpYyBhc3luYyBfZm9yT3BlcmF0aW9uKHVzZXIsIG9wZXJhdGlvblR5cGUsIHJlc3BvbnNlKSB7XHJcbiAgICAgICAgYXdhaXQgdXNlci5fdXBkYXRlVG9rZW5zSWZOZWNlc3NhcnkocmVzcG9uc2UsIC8qIHJlbG9hZCAqLyB0cnVlKTtcclxuICAgICAgICBjb25zdCBwcm92aWRlcklkID0gcHJvdmlkZXJJZEZvclJlc3BvbnNlKHJlc3BvbnNlKTtcclxuICAgICAgICByZXR1cm4gbmV3IFVzZXJDcmVkZW50aWFsSW1wbCh7XHJcbiAgICAgICAgICAgIHVzZXIsXHJcbiAgICAgICAgICAgIHByb3ZpZGVySWQsXHJcbiAgICAgICAgICAgIF90b2tlblJlc3BvbnNlOiByZXNwb25zZSxcclxuICAgICAgICAgICAgb3BlcmF0aW9uVHlwZVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHByb3ZpZGVySWRGb3JSZXNwb25zZShyZXNwb25zZSkge1xyXG4gICAgaWYgKHJlc3BvbnNlLnByb3ZpZGVySWQpIHtcclxuICAgICAgICByZXR1cm4gcmVzcG9uc2UucHJvdmlkZXJJZDtcclxuICAgIH1cclxuICAgIGlmICgncGhvbmVOdW1iZXInIGluIHJlc3BvbnNlKSB7XHJcbiAgICAgICAgcmV0dXJuIFwicGhvbmVcIiAvKiBQSE9ORSAqLztcclxuICAgIH1cclxuICAgIHJldHVybiBudWxsO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBBc3luY2hyb25vdXNseSBzaWducyBpbiBhcyBhbiBhbm9ueW1vdXMgdXNlci5cclxuICpcclxuICogQHJlbWFya3NcclxuICogSWYgdGhlcmUgaXMgYWxyZWFkeSBhbiBhbm9ueW1vdXMgdXNlciBzaWduZWQgaW4sIHRoYXQgdXNlciB3aWxsIGJlIHJldHVybmVkOyBvdGhlcndpc2UsIGFcclxuICogbmV3IGFub255bW91cyB1c2VyIGlkZW50aXR5IHdpbGwgYmUgY3JlYXRlZCBhbmQgcmV0dXJuZWQuXHJcbiAqXHJcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gc2lnbkluQW5vbnltb3VzbHkoYXV0aCkge1xyXG4gICAgdmFyIF9hO1xyXG4gICAgY29uc3QgYXV0aEludGVybmFsID0gX2Nhc3RBdXRoKGF1dGgpO1xyXG4gICAgYXdhaXQgYXV0aEludGVybmFsLl9pbml0aWFsaXphdGlvblByb21pc2U7XHJcbiAgICBpZiAoKF9hID0gYXV0aEludGVybmFsLmN1cnJlbnRVc2VyKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuaXNBbm9ueW1vdXMpIHtcclxuICAgICAgICAvLyBJZiBhbiBhbm9ueW1vdXMgdXNlciBpcyBhbHJlYWR5IHNpZ25lZCBpbiwgbm8gbmVlZCB0byBzaWduIHRoZW0gaW4gYWdhaW4uXHJcbiAgICAgICAgcmV0dXJuIG5ldyBVc2VyQ3JlZGVudGlhbEltcGwoe1xyXG4gICAgICAgICAgICB1c2VyOiBhdXRoSW50ZXJuYWwuY3VycmVudFVzZXIsXHJcbiAgICAgICAgICAgIHByb3ZpZGVySWQ6IG51bGwsXHJcbiAgICAgICAgICAgIG9wZXJhdGlvblR5cGU6IFwic2lnbkluXCIgLyogU0lHTl9JTiAqL1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBzaWduVXAoYXV0aEludGVybmFsLCB7XHJcbiAgICAgICAgcmV0dXJuU2VjdXJlVG9rZW46IHRydWVcclxuICAgIH0pO1xyXG4gICAgY29uc3QgdXNlckNyZWRlbnRpYWwgPSBhd2FpdCBVc2VyQ3JlZGVudGlhbEltcGwuX2Zyb21JZFRva2VuUmVzcG9uc2UoYXV0aEludGVybmFsLCBcInNpZ25JblwiIC8qIFNJR05fSU4gKi8sIHJlc3BvbnNlLCB0cnVlKTtcclxuICAgIGF3YWl0IGF1dGhJbnRlcm5hbC5fdXBkYXRlQ3VycmVudFVzZXIodXNlckNyZWRlbnRpYWwudXNlcik7XHJcbiAgICByZXR1cm4gdXNlckNyZWRlbnRpYWw7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuY2xhc3MgTXVsdGlGYWN0b3JFcnJvciBleHRlbmRzIEZpcmViYXNlRXJyb3Ige1xyXG4gICAgY29uc3RydWN0b3IoYXV0aCwgZXJyb3IsIG9wZXJhdGlvblR5cGUsIHVzZXIpIHtcclxuICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgc3VwZXIoZXJyb3IuY29kZSwgZXJyb3IubWVzc2FnZSk7XHJcbiAgICAgICAgdGhpcy5vcGVyYXRpb25UeXBlID0gb3BlcmF0aW9uVHlwZTtcclxuICAgICAgICB0aGlzLnVzZXIgPSB1c2VyO1xyXG4gICAgICAgIHRoaXMubmFtZSA9ICdGaXJlYmFzZUVycm9yJztcclxuICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vTWljcm9zb2Z0L1R5cGVTY3JpcHQtd2lraS9ibG9iL21hc3Rlci9CcmVha2luZy1DaGFuZ2VzLm1kI2V4dGVuZGluZy1idWlsdC1pbnMtbGlrZS1lcnJvci1hcnJheS1hbmQtbWFwLW1heS1uby1sb25nZXItd29ya1xyXG4gICAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZih0aGlzLCBNdWx0aUZhY3RvckVycm9yLnByb3RvdHlwZSk7XHJcbiAgICAgICAgdGhpcy5hcHBOYW1lID0gYXV0aC5uYW1lO1xyXG4gICAgICAgIHRoaXMuY29kZSA9IGVycm9yLmNvZGU7XHJcbiAgICAgICAgdGhpcy50ZW5hbnRJZCA9IChfYSA9IGF1dGgudGVuYW50SWQpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IHVuZGVmaW5lZDtcclxuICAgICAgICB0aGlzLnNlcnZlclJlc3BvbnNlID0gZXJyb3IuY3VzdG9tRGF0YVxyXG4gICAgICAgICAgICAuc2VydmVyUmVzcG9uc2U7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgX2Zyb21FcnJvckFuZE9wZXJhdGlvbihhdXRoLCBlcnJvciwgb3BlcmF0aW9uVHlwZSwgdXNlcikge1xyXG4gICAgICAgIHJldHVybiBuZXcgTXVsdGlGYWN0b3JFcnJvcihhdXRoLCBlcnJvciwgb3BlcmF0aW9uVHlwZSwgdXNlcik7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gX3Byb2Nlc3NDcmVkZW50aWFsU2F2aW5nTWZhQ29udGV4dElmTmVjZXNzYXJ5KGF1dGgsIG9wZXJhdGlvblR5cGUsIGNyZWRlbnRpYWwsIHVzZXIpIHtcclxuICAgIGNvbnN0IGlkVG9rZW5Qcm92aWRlciA9IG9wZXJhdGlvblR5cGUgPT09IFwicmVhdXRoZW50aWNhdGVcIiAvKiBSRUFVVEhFTlRJQ0FURSAqL1xyXG4gICAgICAgID8gY3JlZGVudGlhbC5fZ2V0UmVhdXRoZW50aWNhdGlvblJlc29sdmVyKGF1dGgpXHJcbiAgICAgICAgOiBjcmVkZW50aWFsLl9nZXRJZFRva2VuUmVzcG9uc2UoYXV0aCk7XHJcbiAgICByZXR1cm4gaWRUb2tlblByb3ZpZGVyLmNhdGNoKGVycm9yID0+IHtcclxuICAgICAgICBpZiAoZXJyb3IuY29kZSA9PT0gYGF1dGgvJHtcIm11bHRpLWZhY3Rvci1hdXRoLXJlcXVpcmVkXCIgLyogTUZBX1JFUVVJUkVEICovfWApIHtcclxuICAgICAgICAgICAgdGhyb3cgTXVsdGlGYWN0b3JFcnJvci5fZnJvbUVycm9yQW5kT3BlcmF0aW9uKGF1dGgsIGVycm9yLCBvcGVyYXRpb25UeXBlLCB1c2VyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9KTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogVGFrZXMgYSBzZXQgb2YgVXNlckluZm8gcHJvdmlkZXIgZGF0YSBhbmQgY29udmVydHMgaXQgdG8gYSBzZXQgb2YgbmFtZXNcclxuICovXHJcbmZ1bmN0aW9uIHByb3ZpZGVyRGF0YUFzTmFtZXMocHJvdmlkZXJEYXRhKSB7XHJcbiAgICByZXR1cm4gbmV3IFNldChwcm92aWRlckRhdGFcclxuICAgICAgICAubWFwKCh7IHByb3ZpZGVySWQgfSkgPT4gcHJvdmlkZXJJZClcclxuICAgICAgICAuZmlsdGVyKHBpZCA9PiAhIXBpZCkpO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBVbmxpbmtzIGEgcHJvdmlkZXIgZnJvbSBhIHVzZXIgYWNjb3VudC5cclxuICpcclxuICogQHBhcmFtIHVzZXIgLSBUaGUgdXNlci5cclxuICogQHBhcmFtIHByb3ZpZGVySWQgLSBUaGUgcHJvdmlkZXIgdG8gdW5saW5rLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiB1bmxpbmsodXNlciwgcHJvdmlkZXJJZCkge1xyXG4gICAgY29uc3QgdXNlckludGVybmFsID0gZ2V0TW9kdWxhckluc3RhbmNlKHVzZXIpO1xyXG4gICAgYXdhaXQgX2Fzc2VydExpbmtlZFN0YXR1cyh0cnVlLCB1c2VySW50ZXJuYWwsIHByb3ZpZGVySWQpO1xyXG4gICAgY29uc3QgeyBwcm92aWRlclVzZXJJbmZvIH0gPSBhd2FpdCBkZWxldGVMaW5rZWRBY2NvdW50cyh1c2VySW50ZXJuYWwuYXV0aCwge1xyXG4gICAgICAgIGlkVG9rZW46IGF3YWl0IHVzZXJJbnRlcm5hbC5nZXRJZFRva2VuKCksXHJcbiAgICAgICAgZGVsZXRlUHJvdmlkZXI6IFtwcm92aWRlcklkXVxyXG4gICAgfSk7XHJcbiAgICBjb25zdCBwcm92aWRlcnNMZWZ0ID0gcHJvdmlkZXJEYXRhQXNOYW1lcyhwcm92aWRlclVzZXJJbmZvIHx8IFtdKTtcclxuICAgIHVzZXJJbnRlcm5hbC5wcm92aWRlckRhdGEgPSB1c2VySW50ZXJuYWwucHJvdmlkZXJEYXRhLmZpbHRlcihwZCA9PiBwcm92aWRlcnNMZWZ0LmhhcyhwZC5wcm92aWRlcklkKSk7XHJcbiAgICBpZiAoIXByb3ZpZGVyc0xlZnQuaGFzKFwicGhvbmVcIiAvKiBQSE9ORSAqLykpIHtcclxuICAgICAgICB1c2VySW50ZXJuYWwucGhvbmVOdW1iZXIgPSBudWxsO1xyXG4gICAgfVxyXG4gICAgYXdhaXQgdXNlckludGVybmFsLmF1dGguX3BlcnNpc3RVc2VySWZDdXJyZW50KHVzZXJJbnRlcm5hbCk7XHJcbiAgICByZXR1cm4gdXNlckludGVybmFsO1xyXG59XHJcbmFzeW5jIGZ1bmN0aW9uIF9saW5rJDEodXNlciwgY3JlZGVudGlhbCwgYnlwYXNzQXV0aFN0YXRlID0gZmFsc2UpIHtcclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgX2xvZ291dElmSW52YWxpZGF0ZWQodXNlciwgY3JlZGVudGlhbC5fbGlua1RvSWRUb2tlbih1c2VyLmF1dGgsIGF3YWl0IHVzZXIuZ2V0SWRUb2tlbigpKSwgYnlwYXNzQXV0aFN0YXRlKTtcclxuICAgIHJldHVybiBVc2VyQ3JlZGVudGlhbEltcGwuX2Zvck9wZXJhdGlvbih1c2VyLCBcImxpbmtcIiAvKiBMSU5LICovLCByZXNwb25zZSk7XHJcbn1cclxuYXN5bmMgZnVuY3Rpb24gX2Fzc2VydExpbmtlZFN0YXR1cyhleHBlY3RlZCwgdXNlciwgcHJvdmlkZXIpIHtcclxuICAgIGF3YWl0IF9yZWxvYWRXaXRob3V0U2F2aW5nKHVzZXIpO1xyXG4gICAgY29uc3QgcHJvdmlkZXJJZHMgPSBwcm92aWRlckRhdGFBc05hbWVzKHVzZXIucHJvdmlkZXJEYXRhKTtcclxuICAgIGNvbnN0IGNvZGUgPSBleHBlY3RlZCA9PT0gZmFsc2VcclxuICAgICAgICA/IFwicHJvdmlkZXItYWxyZWFkeS1saW5rZWRcIiAvKiBQUk9WSURFUl9BTFJFQURZX0xJTktFRCAqL1xyXG4gICAgICAgIDogXCJuby1zdWNoLXByb3ZpZGVyXCIgLyogTk9fU1VDSF9QUk9WSURFUiAqLztcclxuICAgIF9hc3NlcnQocHJvdmlkZXJJZHMuaGFzKHByb3ZpZGVyKSA9PT0gZXhwZWN0ZWQsIHVzZXIuYXV0aCwgY29kZSk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gX3JlYXV0aGVudGljYXRlKHVzZXIsIGNyZWRlbnRpYWwsIGJ5cGFzc0F1dGhTdGF0ZSA9IGZhbHNlKSB7XHJcbiAgICBjb25zdCB7IGF1dGggfSA9IHVzZXI7XHJcbiAgICBjb25zdCBvcGVyYXRpb25UeXBlID0gXCJyZWF1dGhlbnRpY2F0ZVwiIC8qIFJFQVVUSEVOVElDQVRFICovO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IF9sb2dvdXRJZkludmFsaWRhdGVkKHVzZXIsIF9wcm9jZXNzQ3JlZGVudGlhbFNhdmluZ01mYUNvbnRleHRJZk5lY2Vzc2FyeShhdXRoLCBvcGVyYXRpb25UeXBlLCBjcmVkZW50aWFsLCB1c2VyKSwgYnlwYXNzQXV0aFN0YXRlKTtcclxuICAgICAgICBfYXNzZXJ0KHJlc3BvbnNlLmlkVG9rZW4sIGF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyk7XHJcbiAgICAgICAgY29uc3QgcGFyc2VkID0gX3BhcnNlVG9rZW4ocmVzcG9uc2UuaWRUb2tlbik7XHJcbiAgICAgICAgX2Fzc2VydChwYXJzZWQsIGF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyk7XHJcbiAgICAgICAgY29uc3QgeyBzdWI6IGxvY2FsSWQgfSA9IHBhcnNlZDtcclxuICAgICAgICBfYXNzZXJ0KHVzZXIudWlkID09PSBsb2NhbElkLCBhdXRoLCBcInVzZXItbWlzbWF0Y2hcIiAvKiBVU0VSX01JU01BVENIICovKTtcclxuICAgICAgICByZXR1cm4gVXNlckNyZWRlbnRpYWxJbXBsLl9mb3JPcGVyYXRpb24odXNlciwgb3BlcmF0aW9uVHlwZSwgcmVzcG9uc2UpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAvLyBDb252ZXJ0IHVzZXIgZGVsZXRlZCBlcnJvciBpbnRvIHVzZXIgbWlzbWF0Y2hcclxuICAgICAgICBpZiAoKGUgPT09IG51bGwgfHwgZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogZS5jb2RlKSA9PT0gYGF1dGgvJHtcInVzZXItbm90LWZvdW5kXCIgLyogVVNFUl9ERUxFVEVEICovfWApIHtcclxuICAgICAgICAgICAgX2ZhaWwoYXV0aCwgXCJ1c2VyLW1pc21hdGNoXCIgLyogVVNFUl9NSVNNQVRDSCAqLyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRocm93IGU7XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gX3NpZ25JbldpdGhDcmVkZW50aWFsKGF1dGgsIGNyZWRlbnRpYWwsIGJ5cGFzc0F1dGhTdGF0ZSA9IGZhbHNlKSB7XHJcbiAgICBjb25zdCBvcGVyYXRpb25UeXBlID0gXCJzaWduSW5cIiAvKiBTSUdOX0lOICovO1xyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBfcHJvY2Vzc0NyZWRlbnRpYWxTYXZpbmdNZmFDb250ZXh0SWZOZWNlc3NhcnkoYXV0aCwgb3BlcmF0aW9uVHlwZSwgY3JlZGVudGlhbCk7XHJcbiAgICBjb25zdCB1c2VyQ3JlZGVudGlhbCA9IGF3YWl0IFVzZXJDcmVkZW50aWFsSW1wbC5fZnJvbUlkVG9rZW5SZXNwb25zZShhdXRoLCBvcGVyYXRpb25UeXBlLCByZXNwb25zZSk7XHJcbiAgICBpZiAoIWJ5cGFzc0F1dGhTdGF0ZSkge1xyXG4gICAgICAgIGF3YWl0IGF1dGguX3VwZGF0ZUN1cnJlbnRVc2VyKHVzZXJDcmVkZW50aWFsLnVzZXIpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHVzZXJDcmVkZW50aWFsO1xyXG59XHJcbi8qKlxyXG4gKiBBc3luY2hyb25vdXNseSBzaWducyBpbiB3aXRoIHRoZSBnaXZlbiBjcmVkZW50aWFscy5cclxuICpcclxuICogQHJlbWFya3NcclxuICogQW4ge0BsaW5rIEF1dGhQcm92aWRlcn0gY2FuIGJlIHVzZWQgdG8gZ2VuZXJhdGUgdGhlIGNyZWRlbnRpYWwuXHJcbiAqXHJcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cclxuICogQHBhcmFtIGNyZWRlbnRpYWwgLSBUaGUgYXV0aCBjcmVkZW50aWFsLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBzaWduSW5XaXRoQ3JlZGVudGlhbChhdXRoLCBjcmVkZW50aWFsKSB7XHJcbiAgICByZXR1cm4gX3NpZ25JbldpdGhDcmVkZW50aWFsKF9jYXN0QXV0aChhdXRoKSwgY3JlZGVudGlhbCk7XHJcbn1cclxuLyoqXHJcbiAqIExpbmtzIHRoZSB1c2VyIGFjY291bnQgd2l0aCB0aGUgZ2l2ZW4gY3JlZGVudGlhbHMuXHJcbiAqXHJcbiAqIEByZW1hcmtzXHJcbiAqIEFuIHtAbGluayBBdXRoUHJvdmlkZXJ9IGNhbiBiZSB1c2VkIHRvIGdlbmVyYXRlIHRoZSBjcmVkZW50aWFsLlxyXG4gKlxyXG4gKiBAcGFyYW0gdXNlciAtIFRoZSB1c2VyLlxyXG4gKiBAcGFyYW0gY3JlZGVudGlhbCAtIFRoZSBhdXRoIGNyZWRlbnRpYWwuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIGxpbmtXaXRoQ3JlZGVudGlhbCh1c2VyLCBjcmVkZW50aWFsKSB7XHJcbiAgICBjb25zdCB1c2VySW50ZXJuYWwgPSBnZXRNb2R1bGFySW5zdGFuY2UodXNlcik7XHJcbiAgICBhd2FpdCBfYXNzZXJ0TGlua2VkU3RhdHVzKGZhbHNlLCB1c2VySW50ZXJuYWwsIGNyZWRlbnRpYWwucHJvdmlkZXJJZCk7XHJcbiAgICByZXR1cm4gX2xpbmskMSh1c2VySW50ZXJuYWwsIGNyZWRlbnRpYWwpO1xyXG59XHJcbi8qKlxyXG4gKiBSZS1hdXRoZW50aWNhdGVzIGEgdXNlciB1c2luZyBhIGZyZXNoIGNyZWRlbnRpYWwuXHJcbiAqXHJcbiAqIEByZW1hcmtzXHJcbiAqIFVzZSBiZWZvcmUgb3BlcmF0aW9ucyBzdWNoIGFzIHtAbGluayB1cGRhdGVQYXNzd29yZH0gdGhhdCByZXF1aXJlIHRva2VucyBmcm9tIHJlY2VudCBzaWduLWluXHJcbiAqIGF0dGVtcHRzLiBUaGlzIG1ldGhvZCBjYW4gYmUgdXNlZCB0byByZWNvdmVyIGZyb20gYSBgQ1JFREVOVElBTF9UT09fT0xEX0xPR0lOX0FHQUlOYCBlcnJvci5cclxuICpcclxuICogQHBhcmFtIHVzZXIgLSBUaGUgdXNlci5cclxuICogQHBhcmFtIGNyZWRlbnRpYWwgLSBUaGUgYXV0aCBjcmVkZW50aWFsLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiByZWF1dGhlbnRpY2F0ZVdpdGhDcmVkZW50aWFsKHVzZXIsIGNyZWRlbnRpYWwpIHtcclxuICAgIHJldHVybiBfcmVhdXRoZW50aWNhdGUoZ2V0TW9kdWxhckluc3RhbmNlKHVzZXIpLCBjcmVkZW50aWFsKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBzaWduSW5XaXRoQ3VzdG9tVG9rZW4kMShhdXRoLCByZXF1ZXN0KSB7XHJcbiAgICByZXR1cm4gX3BlcmZvcm1TaWduSW5SZXF1ZXN0KGF1dGgsIFwiUE9TVFwiIC8qIFBPU1QgKi8sIFwiL3YxL2FjY291bnRzOnNpZ25JbldpdGhDdXN0b21Ub2tlblwiIC8qIFNJR05fSU5fV0lUSF9DVVNUT01fVE9LRU4gKi8sIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCByZXF1ZXN0KSk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEFzeW5jaHJvbm91c2x5IHNpZ25zIGluIHVzaW5nIGEgY3VzdG9tIHRva2VuLlxyXG4gKlxyXG4gKiBAcmVtYXJrc1xyXG4gKiBDdXN0b20gdG9rZW5zIGFyZSB1c2VkIHRvIGludGVncmF0ZSBGaXJlYmFzZSBBdXRoIHdpdGggZXhpc3RpbmcgYXV0aCBzeXN0ZW1zLCBhbmQgbXVzdFxyXG4gKiBiZSBnZW5lcmF0ZWQgYnkgYW4gYXV0aCBiYWNrZW5kIHVzaW5nIHRoZVxyXG4gKiB7QGxpbmsgaHR0cHM6Ly9maXJlYmFzZS5nb29nbGUuY29tL2RvY3MvcmVmZXJlbmNlL2FkbWluL25vZGUvYWRtaW4uYXV0aC5BdXRoI2NyZWF0ZWN1c3RvbXRva2VuIHwgY3JlYXRlQ3VzdG9tVG9rZW59XHJcbiAqIG1ldGhvZCBpbiB0aGUge0BsaW5rIGh0dHBzOi8vZmlyZWJhc2UuZ29vZ2xlLmNvbS9kb2NzL2F1dGgvYWRtaW4gfCBBZG1pbiBTREt9IC5cclxuICpcclxuICogRmFpbHMgd2l0aCBhbiBlcnJvciBpZiB0aGUgdG9rZW4gaXMgaW52YWxpZCwgZXhwaXJlZCwgb3Igbm90IGFjY2VwdGVkIGJ5IHRoZSBGaXJlYmFzZSBBdXRoIHNlcnZpY2UuXHJcbiAqXHJcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cclxuICogQHBhcmFtIGN1c3RvbVRva2VuIC0gVGhlIGN1c3RvbSB0b2tlbiB0byBzaWduIGluIHdpdGguXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIHNpZ25JbldpdGhDdXN0b21Ub2tlbihhdXRoLCBjdXN0b21Ub2tlbikge1xyXG4gICAgY29uc3QgYXV0aEludGVybmFsID0gX2Nhc3RBdXRoKGF1dGgpO1xyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBzaWduSW5XaXRoQ3VzdG9tVG9rZW4kMShhdXRoSW50ZXJuYWwsIHtcclxuICAgICAgICB0b2tlbjogY3VzdG9tVG9rZW4sXHJcbiAgICAgICAgcmV0dXJuU2VjdXJlVG9rZW46IHRydWVcclxuICAgIH0pO1xyXG4gICAgY29uc3QgY3JlZCA9IGF3YWl0IFVzZXJDcmVkZW50aWFsSW1wbC5fZnJvbUlkVG9rZW5SZXNwb25zZShhdXRoSW50ZXJuYWwsIFwic2lnbkluXCIgLyogU0lHTl9JTiAqLywgcmVzcG9uc2UpO1xyXG4gICAgYXdhaXQgYXV0aEludGVybmFsLl91cGRhdGVDdXJyZW50VXNlcihjcmVkLnVzZXIpO1xyXG4gICAgcmV0dXJuIGNyZWQ7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuY2xhc3MgTXVsdGlGYWN0b3JJbmZvSW1wbCB7XHJcbiAgICBjb25zdHJ1Y3RvcihmYWN0b3JJZCwgcmVzcG9uc2UpIHtcclxuICAgICAgICB0aGlzLmZhY3RvcklkID0gZmFjdG9ySWQ7XHJcbiAgICAgICAgdGhpcy51aWQgPSByZXNwb25zZS5tZmFFbnJvbGxtZW50SWQ7XHJcbiAgICAgICAgdGhpcy5lbnJvbGxtZW50VGltZSA9IG5ldyBEYXRlKHJlc3BvbnNlLmVucm9sbGVkQXQpLnRvVVRDU3RyaW5nKCk7XHJcbiAgICAgICAgdGhpcy5kaXNwbGF5TmFtZSA9IHJlc3BvbnNlLmRpc3BsYXlOYW1lO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIF9mcm9tU2VydmVyUmVzcG9uc2UoYXV0aCwgZW5yb2xsbWVudCkge1xyXG4gICAgICAgIGlmICgncGhvbmVJbmZvJyBpbiBlbnJvbGxtZW50KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQaG9uZU11bHRpRmFjdG9ySW5mby5fZnJvbVNlcnZlclJlc3BvbnNlKGF1dGgsIGVucm9sbG1lbnQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gX2ZhaWwoYXV0aCwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIElOVEVSTkFMX0VSUk9SICovKTtcclxuICAgIH1cclxufVxyXG5jbGFzcyBQaG9uZU11bHRpRmFjdG9ySW5mbyBleHRlbmRzIE11bHRpRmFjdG9ySW5mb0ltcGwge1xyXG4gICAgY29uc3RydWN0b3IocmVzcG9uc2UpIHtcclxuICAgICAgICBzdXBlcihcInBob25lXCIgLyogUEhPTkUgKi8sIHJlc3BvbnNlKTtcclxuICAgICAgICB0aGlzLnBob25lTnVtYmVyID0gcmVzcG9uc2UucGhvbmVJbmZvO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIF9mcm9tU2VydmVyUmVzcG9uc2UoX2F1dGgsIGVucm9sbG1lbnQpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFBob25lTXVsdGlGYWN0b3JJbmZvKGVucm9sbG1lbnQpO1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmZ1bmN0aW9uIF9zZXRBY3Rpb25Db2RlU2V0dGluZ3NPblJlcXVlc3QoYXV0aCwgcmVxdWVzdCwgYWN0aW9uQ29kZVNldHRpbmdzKSB7XHJcbiAgICB2YXIgX2E7XHJcbiAgICBfYXNzZXJ0KCgoX2EgPSBhY3Rpb25Db2RlU2V0dGluZ3MudXJsKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EubGVuZ3RoKSA+IDAsIGF1dGgsIFwiaW52YWxpZC1jb250aW51ZS11cmlcIiAvKiBJTlZBTElEX0NPTlRJTlVFX1VSSSAqLyk7XHJcbiAgICBfYXNzZXJ0KHR5cGVvZiBhY3Rpb25Db2RlU2V0dGluZ3MuZHluYW1pY0xpbmtEb21haW4gPT09ICd1bmRlZmluZWQnIHx8XHJcbiAgICAgICAgYWN0aW9uQ29kZVNldHRpbmdzLmR5bmFtaWNMaW5rRG9tYWluLmxlbmd0aCA+IDAsIGF1dGgsIFwiaW52YWxpZC1keW5hbWljLWxpbmstZG9tYWluXCIgLyogSU5WQUxJRF9EWU5BTUlDX0xJTktfRE9NQUlOICovKTtcclxuICAgIHJlcXVlc3QuY29udGludWVVcmwgPSBhY3Rpb25Db2RlU2V0dGluZ3MudXJsO1xyXG4gICAgcmVxdWVzdC5keW5hbWljTGlua0RvbWFpbiA9IGFjdGlvbkNvZGVTZXR0aW5ncy5keW5hbWljTGlua0RvbWFpbjtcclxuICAgIHJlcXVlc3QuY2FuSGFuZGxlQ29kZUluQXBwID0gYWN0aW9uQ29kZVNldHRpbmdzLmhhbmRsZUNvZGVJbkFwcDtcclxuICAgIGlmIChhY3Rpb25Db2RlU2V0dGluZ3MuaU9TKSB7XHJcbiAgICAgICAgX2Fzc2VydChhY3Rpb25Db2RlU2V0dGluZ3MuaU9TLmJ1bmRsZUlkLmxlbmd0aCA+IDAsIGF1dGgsIFwibWlzc2luZy1pb3MtYnVuZGxlLWlkXCIgLyogTUlTU0lOR19JT1NfQlVORExFX0lEICovKTtcclxuICAgICAgICByZXF1ZXN0Lmlvc0J1bmRsZUlkID0gYWN0aW9uQ29kZVNldHRpbmdzLmlPUy5idW5kbGVJZDtcclxuICAgIH1cclxuICAgIGlmIChhY3Rpb25Db2RlU2V0dGluZ3MuYW5kcm9pZCkge1xyXG4gICAgICAgIF9hc3NlcnQoYWN0aW9uQ29kZVNldHRpbmdzLmFuZHJvaWQucGFja2FnZU5hbWUubGVuZ3RoID4gMCwgYXV0aCwgXCJtaXNzaW5nLWFuZHJvaWQtcGtnLW5hbWVcIiAvKiBNSVNTSU5HX0FORFJPSURfUEFDS0FHRV9OQU1FICovKTtcclxuICAgICAgICByZXF1ZXN0LmFuZHJvaWRJbnN0YWxsQXBwID0gYWN0aW9uQ29kZVNldHRpbmdzLmFuZHJvaWQuaW5zdGFsbEFwcDtcclxuICAgICAgICByZXF1ZXN0LmFuZHJvaWRNaW5pbXVtVmVyc2lvbkNvZGUgPVxyXG4gICAgICAgICAgICBhY3Rpb25Db2RlU2V0dGluZ3MuYW5kcm9pZC5taW5pbXVtVmVyc2lvbjtcclxuICAgICAgICByZXF1ZXN0LmFuZHJvaWRQYWNrYWdlTmFtZSA9IGFjdGlvbkNvZGVTZXR0aW5ncy5hbmRyb2lkLnBhY2thZ2VOYW1lO1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBTZW5kcyBhIHBhc3N3b3JkIHJlc2V0IGVtYWlsIHRvIHRoZSBnaXZlbiBlbWFpbCBhZGRyZXNzLlxyXG4gKlxyXG4gKiBAcmVtYXJrc1xyXG4gKiBUbyBjb21wbGV0ZSB0aGUgcGFzc3dvcmQgcmVzZXQsIGNhbGwge0BsaW5rIGNvbmZpcm1QYXNzd29yZFJlc2V0fSB3aXRoIHRoZSBjb2RlIHN1cHBsaWVkIGluXHJcbiAqIHRoZSBlbWFpbCBzZW50IHRvIHRoZSB1c2VyLCBhbG9uZyB3aXRoIHRoZSBuZXcgcGFzc3dvcmQgc3BlY2lmaWVkIGJ5IHRoZSB1c2VyLlxyXG4gKlxyXG4gKiBAZXhhbXBsZVxyXG4gKiBgYGBqYXZhc2NyaXB0XHJcbiAqIGNvbnN0IGFjdGlvbkNvZGVTZXR0aW5ncyA9IHtcclxuICogICB1cmw6ICdodHRwczovL3d3dy5leGFtcGxlLmNvbS8/ZW1haWw9dXNlckBleGFtcGxlLmNvbScsXHJcbiAqICAgaU9TOiB7XHJcbiAqICAgICAgYnVuZGxlSWQ6ICdjb20uZXhhbXBsZS5pb3MnXHJcbiAqICAgfSxcclxuICogICBhbmRyb2lkOiB7XHJcbiAqICAgICBwYWNrYWdlTmFtZTogJ2NvbS5leGFtcGxlLmFuZHJvaWQnLFxyXG4gKiAgICAgaW5zdGFsbEFwcDogdHJ1ZSxcclxuICogICAgIG1pbmltdW1WZXJzaW9uOiAnMTInXHJcbiAqICAgfSxcclxuICogICBoYW5kbGVDb2RlSW5BcHA6IHRydWVcclxuICogfTtcclxuICogYXdhaXQgc2VuZFBhc3N3b3JkUmVzZXRFbWFpbChhdXRoLCAndXNlckBleGFtcGxlLmNvbScsIGFjdGlvbkNvZGVTZXR0aW5ncyk7XHJcbiAqIC8vIE9idGFpbiBjb2RlIGZyb20gdXNlci5cclxuICogYXdhaXQgY29uZmlybVBhc3N3b3JkUmVzZXQoJ3VzZXJAZXhhbXBsZS5jb20nLCBjb2RlKTtcclxuICogYGBgXHJcbiAqXHJcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cclxuICogQHBhcmFtIGVtYWlsIC0gVGhlIHVzZXIncyBlbWFpbCBhZGRyZXNzLlxyXG4gKiBAcGFyYW0gYWN0aW9uQ29kZVNldHRpbmdzIC0gVGhlIHtAbGluayBBY3Rpb25Db2RlU2V0dGluZ3N9LlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBzZW5kUGFzc3dvcmRSZXNldEVtYWlsKGF1dGgsIGVtYWlsLCBhY3Rpb25Db2RlU2V0dGluZ3MpIHtcclxuICAgIGNvbnN0IGF1dGhNb2R1bGFyID0gZ2V0TW9kdWxhckluc3RhbmNlKGF1dGgpO1xyXG4gICAgY29uc3QgcmVxdWVzdCA9IHtcclxuICAgICAgICByZXF1ZXN0VHlwZTogXCJQQVNTV09SRF9SRVNFVFwiIC8qIFBBU1NXT1JEX1JFU0VUICovLFxyXG4gICAgICAgIGVtYWlsXHJcbiAgICB9O1xyXG4gICAgaWYgKGFjdGlvbkNvZGVTZXR0aW5ncykge1xyXG4gICAgICAgIF9zZXRBY3Rpb25Db2RlU2V0dGluZ3NPblJlcXVlc3QoYXV0aE1vZHVsYXIsIHJlcXVlc3QsIGFjdGlvbkNvZGVTZXR0aW5ncyk7XHJcbiAgICB9XHJcbiAgICBhd2FpdCBzZW5kUGFzc3dvcmRSZXNldEVtYWlsJDEoYXV0aE1vZHVsYXIsIHJlcXVlc3QpO1xyXG59XHJcbi8qKlxyXG4gKiBDb21wbGV0ZXMgdGhlIHBhc3N3b3JkIHJlc2V0IHByb2Nlc3MsIGdpdmVuIGEgY29uZmlybWF0aW9uIGNvZGUgYW5kIG5ldyBwYXNzd29yZC5cclxuICpcclxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxyXG4gKiBAcGFyYW0gb29iQ29kZSAtIEEgY29uZmlybWF0aW9uIGNvZGUgc2VudCB0byB0aGUgdXNlci5cclxuICogQHBhcmFtIG5ld1Bhc3N3b3JkIC0gVGhlIG5ldyBwYXNzd29yZC5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gY29uZmlybVBhc3N3b3JkUmVzZXQoYXV0aCwgb29iQ29kZSwgbmV3UGFzc3dvcmQpIHtcclxuICAgIGF3YWl0IHJlc2V0UGFzc3dvcmQoZ2V0TW9kdWxhckluc3RhbmNlKGF1dGgpLCB7XHJcbiAgICAgICAgb29iQ29kZSxcclxuICAgICAgICBuZXdQYXNzd29yZFxyXG4gICAgfSk7XHJcbiAgICAvLyBEbyBub3QgcmV0dXJuIHRoZSBlbWFpbC5cclxufVxyXG4vKipcclxuICogQXBwbGllcyBhIHZlcmlmaWNhdGlvbiBjb2RlIHNlbnQgdG8gdGhlIHVzZXIgYnkgZW1haWwgb3Igb3RoZXIgb3V0LW9mLWJhbmQgbWVjaGFuaXNtLlxyXG4gKlxyXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXHJcbiAqIEBwYXJhbSBvb2JDb2RlIC0gQSB2ZXJpZmljYXRpb24gY29kZSBzZW50IHRvIHRoZSB1c2VyLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBhcHBseUFjdGlvbkNvZGUoYXV0aCwgb29iQ29kZSkge1xyXG4gICAgYXdhaXQgYXBwbHlBY3Rpb25Db2RlJDEoZ2V0TW9kdWxhckluc3RhbmNlKGF1dGgpLCB7IG9vYkNvZGUgfSk7XHJcbn1cclxuLyoqXHJcbiAqIENoZWNrcyBhIHZlcmlmaWNhdGlvbiBjb2RlIHNlbnQgdG8gdGhlIHVzZXIgYnkgZW1haWwgb3Igb3RoZXIgb3V0LW9mLWJhbmQgbWVjaGFuaXNtLlxyXG4gKlxyXG4gKiBAcmV0dXJucyBtZXRhZGF0YSBhYm91dCB0aGUgY29kZS5cclxuICpcclxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxyXG4gKiBAcGFyYW0gb29iQ29kZSAtIEEgdmVyaWZpY2F0aW9uIGNvZGUgc2VudCB0byB0aGUgdXNlci5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gY2hlY2tBY3Rpb25Db2RlKGF1dGgsIG9vYkNvZGUpIHtcclxuICAgIGNvbnN0IGF1dGhNb2R1bGFyID0gZ2V0TW9kdWxhckluc3RhbmNlKGF1dGgpO1xyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXNldFBhc3N3b3JkKGF1dGhNb2R1bGFyLCB7IG9vYkNvZGUgfSk7XHJcbiAgICAvLyBFbWFpbCBjb3VsZCBiZSBlbXB0eSBvbmx5IGlmIHRoZSByZXF1ZXN0IHR5cGUgaXMgRU1BSUxfU0lHTklOIG9yXHJcbiAgICAvLyBWRVJJRllfQU5EX0NIQU5HRV9FTUFJTC5cclxuICAgIC8vIE5ldyBlbWFpbCBzaG91bGQgbm90IGJlIGVtcHR5IGlmIHRoZSByZXF1ZXN0IHR5cGUgaXNcclxuICAgIC8vIFZFUklGWV9BTkRfQ0hBTkdFX0VNQUlMLlxyXG4gICAgLy8gTXVsdGktZmFjdG9yIGluZm8gY291bGQgbm90IGJlIGVtcHR5IGlmIHRoZSByZXF1ZXN0IHR5cGUgaXNcclxuICAgIC8vIFJFVkVSVF9TRUNPTkRfRkFDVE9SX0FERElUSU9OLlxyXG4gICAgY29uc3Qgb3BlcmF0aW9uID0gcmVzcG9uc2UucmVxdWVzdFR5cGU7XHJcbiAgICBfYXNzZXJ0KG9wZXJhdGlvbiwgYXV0aE1vZHVsYXIsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyk7XHJcbiAgICBzd2l0Y2ggKG9wZXJhdGlvbikge1xyXG4gICAgICAgIGNhc2UgXCJFTUFJTF9TSUdOSU5cIiAvKiBFTUFJTF9TSUdOSU4gKi86XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgXCJWRVJJRllfQU5EX0NIQU5HRV9FTUFJTFwiIC8qIFZFUklGWV9BTkRfQ0hBTkdFX0VNQUlMICovOlxyXG4gICAgICAgICAgICBfYXNzZXJ0KHJlc3BvbnNlLm5ld0VtYWlsLCBhdXRoTW9kdWxhciwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIElOVEVSTkFMX0VSUk9SICovKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBcIlJFVkVSVF9TRUNPTkRfRkFDVE9SX0FERElUSU9OXCIgLyogUkVWRVJUX1NFQ09ORF9GQUNUT1JfQURESVRJT04gKi86XHJcbiAgICAgICAgICAgIF9hc3NlcnQocmVzcG9uc2UubWZhSW5mbywgYXV0aE1vZHVsYXIsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyk7XHJcbiAgICAgICAgLy8gZmFsbCB0aHJvdWdoXHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgX2Fzc2VydChyZXNwb25zZS5lbWFpbCwgYXV0aE1vZHVsYXIsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyk7XHJcbiAgICB9XHJcbiAgICAvLyBUaGUgbXVsdGktZmFjdG9yIGluZm8gZm9yIHJldmVydCBzZWNvbmQgZmFjdG9yIGFkZGl0aW9uXHJcbiAgICBsZXQgbXVsdGlGYWN0b3JJbmZvID0gbnVsbDtcclxuICAgIGlmIChyZXNwb25zZS5tZmFJbmZvKSB7XHJcbiAgICAgICAgbXVsdGlGYWN0b3JJbmZvID0gTXVsdGlGYWN0b3JJbmZvSW1wbC5fZnJvbVNlcnZlclJlc3BvbnNlKF9jYXN0QXV0aChhdXRoTW9kdWxhciksIHJlc3BvbnNlLm1mYUluZm8pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgIGVtYWlsOiAocmVzcG9uc2UucmVxdWVzdFR5cGUgPT09IFwiVkVSSUZZX0FORF9DSEFOR0VfRU1BSUxcIiAvKiBWRVJJRllfQU5EX0NIQU5HRV9FTUFJTCAqL1xyXG4gICAgICAgICAgICAgICAgPyByZXNwb25zZS5uZXdFbWFpbFxyXG4gICAgICAgICAgICAgICAgOiByZXNwb25zZS5lbWFpbCkgfHwgbnVsbCxcclxuICAgICAgICAgICAgcHJldmlvdXNFbWFpbDogKHJlc3BvbnNlLnJlcXVlc3RUeXBlID09PSBcIlZFUklGWV9BTkRfQ0hBTkdFX0VNQUlMXCIgLyogVkVSSUZZX0FORF9DSEFOR0VfRU1BSUwgKi9cclxuICAgICAgICAgICAgICAgID8gcmVzcG9uc2UuZW1haWxcclxuICAgICAgICAgICAgICAgIDogcmVzcG9uc2UubmV3RW1haWwpIHx8IG51bGwsXHJcbiAgICAgICAgICAgIG11bHRpRmFjdG9ySW5mb1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgb3BlcmF0aW9uXHJcbiAgICB9O1xyXG59XHJcbi8qKlxyXG4gKiBDaGVja3MgYSBwYXNzd29yZCByZXNldCBjb2RlIHNlbnQgdG8gdGhlIHVzZXIgYnkgZW1haWwgb3Igb3RoZXIgb3V0LW9mLWJhbmQgbWVjaGFuaXNtLlxyXG4gKlxyXG4gKiBAcmV0dXJucyB0aGUgdXNlcidzIGVtYWlsIGFkZHJlc3MgaWYgdmFsaWQuXHJcbiAqXHJcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cclxuICogQHBhcmFtIGNvZGUgLSBBIHZlcmlmaWNhdGlvbiBjb2RlIHNlbnQgdG8gdGhlIHVzZXIuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIHZlcmlmeVBhc3N3b3JkUmVzZXRDb2RlKGF1dGgsIGNvZGUpIHtcclxuICAgIGNvbnN0IHsgZGF0YSB9ID0gYXdhaXQgY2hlY2tBY3Rpb25Db2RlKGdldE1vZHVsYXJJbnN0YW5jZShhdXRoKSwgY29kZSk7XHJcbiAgICAvLyBFbWFpbCBzaG91bGQgYWx3YXlzIGJlIHByZXNlbnQgc2luY2UgYSBjb2RlIHdhcyBzZW50IHRvIGl0XHJcbiAgICByZXR1cm4gZGF0YS5lbWFpbDtcclxufVxyXG4vKipcclxuICogQ3JlYXRlcyBhIG5ldyB1c2VyIGFjY291bnQgYXNzb2NpYXRlZCB3aXRoIHRoZSBzcGVjaWZpZWQgZW1haWwgYWRkcmVzcyBhbmQgcGFzc3dvcmQuXHJcbiAqXHJcbiAqIEByZW1hcmtzXHJcbiAqIE9uIHN1Y2Nlc3NmdWwgY3JlYXRpb24gb2YgdGhlIHVzZXIgYWNjb3VudCwgdGhpcyB1c2VyIHdpbGwgYWxzbyBiZSBzaWduZWQgaW4gdG8geW91ciBhcHBsaWNhdGlvbi5cclxuICpcclxuICogVXNlciBhY2NvdW50IGNyZWF0aW9uIGNhbiBmYWlsIGlmIHRoZSBhY2NvdW50IGFscmVhZHkgZXhpc3RzIG9yIHRoZSBwYXNzd29yZCBpcyBpbnZhbGlkLlxyXG4gKlxyXG4gKiBOb3RlOiBUaGUgZW1haWwgYWRkcmVzcyBhY3RzIGFzIGEgdW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoZSB1c2VyIGFuZCBlbmFibGVzIGFuIGVtYWlsLWJhc2VkXHJcbiAqIHBhc3N3b3JkIHJlc2V0LiBUaGlzIGZ1bmN0aW9uIHdpbGwgY3JlYXRlIGEgbmV3IHVzZXIgYWNjb3VudCBhbmQgc2V0IHRoZSBpbml0aWFsIHVzZXIgcGFzc3dvcmQuXHJcbiAqXHJcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cclxuICogQHBhcmFtIGVtYWlsIC0gVGhlIHVzZXIncyBlbWFpbCBhZGRyZXNzLlxyXG4gKiBAcGFyYW0gcGFzc3dvcmQgLSBUaGUgdXNlcidzIGNob3NlbiBwYXNzd29yZC5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gY3JlYXRlVXNlcldpdGhFbWFpbEFuZFBhc3N3b3JkKGF1dGgsIGVtYWlsLCBwYXNzd29yZCkge1xyXG4gICAgY29uc3QgYXV0aEludGVybmFsID0gX2Nhc3RBdXRoKGF1dGgpO1xyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBzaWduVXAoYXV0aEludGVybmFsLCB7XHJcbiAgICAgICAgcmV0dXJuU2VjdXJlVG9rZW46IHRydWUsXHJcbiAgICAgICAgZW1haWwsXHJcbiAgICAgICAgcGFzc3dvcmRcclxuICAgIH0pO1xyXG4gICAgY29uc3QgdXNlckNyZWRlbnRpYWwgPSBhd2FpdCBVc2VyQ3JlZGVudGlhbEltcGwuX2Zyb21JZFRva2VuUmVzcG9uc2UoYXV0aEludGVybmFsLCBcInNpZ25JblwiIC8qIFNJR05fSU4gKi8sIHJlc3BvbnNlKTtcclxuICAgIGF3YWl0IGF1dGhJbnRlcm5hbC5fdXBkYXRlQ3VycmVudFVzZXIodXNlckNyZWRlbnRpYWwudXNlcik7XHJcbiAgICByZXR1cm4gdXNlckNyZWRlbnRpYWw7XHJcbn1cclxuLyoqXHJcbiAqIEFzeW5jaHJvbm91c2x5IHNpZ25zIGluIHVzaW5nIGFuIGVtYWlsIGFuZCBwYXNzd29yZC5cclxuICpcclxuICogQHJlbWFya3NcclxuICogRmFpbHMgd2l0aCBhbiBlcnJvciBpZiB0aGUgZW1haWwgYWRkcmVzcyBhbmQgcGFzc3dvcmQgZG8gbm90IG1hdGNoLlxyXG4gKlxyXG4gKiBOb3RlOiBUaGUgdXNlcidzIHBhc3N3b3JkIGlzIE5PVCB0aGUgcGFzc3dvcmQgdXNlZCB0byBhY2Nlc3MgdGhlIHVzZXIncyBlbWFpbCBhY2NvdW50LiBUaGVcclxuICogZW1haWwgYWRkcmVzcyBzZXJ2ZXMgYXMgYSB1bmlxdWUgaWRlbnRpZmllciBmb3IgdGhlIHVzZXIsIGFuZCB0aGUgcGFzc3dvcmQgaXMgdXNlZCB0byBhY2Nlc3NcclxuICogdGhlIHVzZXIncyBhY2NvdW50IGluIHlvdXIgRmlyZWJhc2UgcHJvamVjdC4gU2VlIGFsc286IHtAbGluayBjcmVhdGVVc2VyV2l0aEVtYWlsQW5kUGFzc3dvcmR9LlxyXG4gKlxyXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXHJcbiAqIEBwYXJhbSBlbWFpbCAtIFRoZSB1c2VycyBlbWFpbCBhZGRyZXNzLlxyXG4gKiBAcGFyYW0gcGFzc3dvcmQgLSBUaGUgdXNlcnMgcGFzc3dvcmQuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmZ1bmN0aW9uIHNpZ25JbldpdGhFbWFpbEFuZFBhc3N3b3JkKGF1dGgsIGVtYWlsLCBwYXNzd29yZCkge1xyXG4gICAgcmV0dXJuIHNpZ25JbldpdGhDcmVkZW50aWFsKGdldE1vZHVsYXJJbnN0YW5jZShhdXRoKSwgRW1haWxBdXRoUHJvdmlkZXIuY3JlZGVudGlhbChlbWFpbCwgcGFzc3dvcmQpKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogU2VuZHMgYSBzaWduLWluIGVtYWlsIGxpbmsgdG8gdGhlIHVzZXIgd2l0aCB0aGUgc3BlY2lmaWVkIGVtYWlsLlxyXG4gKlxyXG4gKiBAcmVtYXJrc1xyXG4gKiBUaGUgc2lnbi1pbiBvcGVyYXRpb24gaGFzIHRvIGFsd2F5cyBiZSBjb21wbGV0ZWQgaW4gdGhlIGFwcCB1bmxpa2Ugb3RoZXIgb3V0IG9mIGJhbmQgZW1haWxcclxuICogYWN0aW9ucyAocGFzc3dvcmQgcmVzZXQgYW5kIGVtYWlsIHZlcmlmaWNhdGlvbnMpLiBUaGlzIGlzIGJlY2F1c2UsIGF0IHRoZSBlbmQgb2YgdGhlIGZsb3csXHJcbiAqIHRoZSB1c2VyIGlzIGV4cGVjdGVkIHRvIGJlIHNpZ25lZCBpbiBhbmQgdGhlaXIgQXV0aCBzdGF0ZSBwZXJzaXN0ZWQgd2l0aGluIHRoZSBhcHAuXHJcbiAqXHJcbiAqIFRvIGNvbXBsZXRlIHNpZ24gaW4gd2l0aCB0aGUgZW1haWwgbGluaywgY2FsbCB7QGxpbmsgc2lnbkluV2l0aEVtYWlsTGlua30gd2l0aCB0aGUgZW1haWxcclxuICogYWRkcmVzcyBhbmQgdGhlIGVtYWlsIGxpbmsgc3VwcGxpZWQgaW4gdGhlIGVtYWlsIHNlbnQgdG8gdGhlIHVzZXIuXHJcbiAqXHJcbiAqIEBleGFtcGxlXHJcbiAqIGBgYGphdmFzY3JpcHRcclxuICogY29uc3QgYWN0aW9uQ29kZVNldHRpbmdzID0ge1xyXG4gKiAgIHVybDogJ2h0dHBzOi8vd3d3LmV4YW1wbGUuY29tLz9lbWFpbD11c2VyQGV4YW1wbGUuY29tJyxcclxuICogICBpT1M6IHtcclxuICogICAgICBidW5kbGVJZDogJ2NvbS5leGFtcGxlLmlvcydcclxuICogICB9LFxyXG4gKiAgIGFuZHJvaWQ6IHtcclxuICogICAgIHBhY2thZ2VOYW1lOiAnY29tLmV4YW1wbGUuYW5kcm9pZCcsXHJcbiAqICAgICBpbnN0YWxsQXBwOiB0cnVlLFxyXG4gKiAgICAgbWluaW11bVZlcnNpb246ICcxMidcclxuICogICB9LFxyXG4gKiAgIGhhbmRsZUNvZGVJbkFwcDogdHJ1ZVxyXG4gKiB9O1xyXG4gKiBhd2FpdCBzZW5kU2lnbkluTGlua1RvRW1haWwoYXV0aCwgJ3VzZXJAZXhhbXBsZS5jb20nLCBhY3Rpb25Db2RlU2V0dGluZ3MpO1xyXG4gKiAvLyBPYnRhaW4gZW1haWxMaW5rIGZyb20gdGhlIHVzZXIuXHJcbiAqIGlmKGlzU2lnbkluV2l0aEVtYWlsTGluayhhdXRoLCBlbWFpbExpbmspKSB7XHJcbiAqICAgYXdhaXQgc2lnbkluV2l0aEVtYWlsTGluaygndXNlckBleGFtcGxlLmNvbScsICd1c2VyQGV4YW1wbGUuY29tJywgZW1haWxMaW5rKTtcclxuICogfVxyXG4gKiBgYGBcclxuICpcclxuICogQHBhcmFtIGF1dGhJbnRlcm5hbCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXHJcbiAqIEBwYXJhbSBlbWFpbCAtIFRoZSB1c2VyJ3MgZW1haWwgYWRkcmVzcy5cclxuICogQHBhcmFtIGFjdGlvbkNvZGVTZXR0aW5ncyAtIFRoZSB7QGxpbmsgQWN0aW9uQ29kZVNldHRpbmdzfS5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gc2VuZFNpZ25JbkxpbmtUb0VtYWlsKGF1dGgsIGVtYWlsLCBhY3Rpb25Db2RlU2V0dGluZ3MpIHtcclxuICAgIGNvbnN0IGF1dGhNb2R1bGFyID0gZ2V0TW9kdWxhckluc3RhbmNlKGF1dGgpO1xyXG4gICAgY29uc3QgcmVxdWVzdCA9IHtcclxuICAgICAgICByZXF1ZXN0VHlwZTogXCJFTUFJTF9TSUdOSU5cIiAvKiBFTUFJTF9TSUdOSU4gKi8sXHJcbiAgICAgICAgZW1haWxcclxuICAgIH07XHJcbiAgICBfYXNzZXJ0KGFjdGlvbkNvZGVTZXR0aW5ncy5oYW5kbGVDb2RlSW5BcHAsIGF1dGhNb2R1bGFyLCBcImFyZ3VtZW50LWVycm9yXCIgLyogQVJHVU1FTlRfRVJST1IgKi8pO1xyXG4gICAgaWYgKGFjdGlvbkNvZGVTZXR0aW5ncykge1xyXG4gICAgICAgIF9zZXRBY3Rpb25Db2RlU2V0dGluZ3NPblJlcXVlc3QoYXV0aE1vZHVsYXIsIHJlcXVlc3QsIGFjdGlvbkNvZGVTZXR0aW5ncyk7XHJcbiAgICB9XHJcbiAgICBhd2FpdCBzZW5kU2lnbkluTGlua1RvRW1haWwkMShhdXRoTW9kdWxhciwgcmVxdWVzdCk7XHJcbn1cclxuLyoqXHJcbiAqIENoZWNrcyBpZiBhbiBpbmNvbWluZyBsaW5rIGlzIGEgc2lnbi1pbiB3aXRoIGVtYWlsIGxpbmsgc3VpdGFibGUgZm9yIHtAbGluayBzaWduSW5XaXRoRW1haWxMaW5rfS5cclxuICpcclxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxyXG4gKiBAcGFyYW0gZW1haWxMaW5rIC0gVGhlIGxpbmsgc2VudCB0byB0aGUgdXNlcidzIGVtYWlsIGFkZHJlc3MuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmZ1bmN0aW9uIGlzU2lnbkluV2l0aEVtYWlsTGluayhhdXRoLCBlbWFpbExpbmspIHtcclxuICAgIGNvbnN0IGFjdGlvbkNvZGVVcmwgPSBBY3Rpb25Db2RlVVJMLnBhcnNlTGluayhlbWFpbExpbmspO1xyXG4gICAgcmV0dXJuIChhY3Rpb25Db2RlVXJsID09PSBudWxsIHx8IGFjdGlvbkNvZGVVcmwgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGFjdGlvbkNvZGVVcmwub3BlcmF0aW9uKSA9PT0gXCJFTUFJTF9TSUdOSU5cIiAvKiBFTUFJTF9TSUdOSU4gKi87XHJcbn1cclxuLyoqXHJcbiAqIEFzeW5jaHJvbm91c2x5IHNpZ25zIGluIHVzaW5nIGFuIGVtYWlsIGFuZCBzaWduLWluIGVtYWlsIGxpbmsuXHJcbiAqXHJcbiAqIEByZW1hcmtzXHJcbiAqIElmIG5vIGxpbmsgaXMgcGFzc2VkLCB0aGUgbGluayBpcyBpbmZlcnJlZCBmcm9tIHRoZSBjdXJyZW50IFVSTC5cclxuICpcclxuICogRmFpbHMgd2l0aCBhbiBlcnJvciBpZiB0aGUgZW1haWwgYWRkcmVzcyBpcyBpbnZhbGlkIG9yIE9UUCBpbiBlbWFpbCBsaW5rIGV4cGlyZXMuXHJcbiAqXHJcbiAqIE5vdGU6IENvbmZpcm0gdGhlIGxpbmsgaXMgYSBzaWduLWluIGVtYWlsIGxpbmsgYmVmb3JlIGNhbGxpbmcgdGhpcyBtZXRob2QgZmlyZWJhc2UuYXV0aC5BdXRoLmlzU2lnbkluV2l0aEVtYWlsTGluay5cclxuICpcclxuICogQGV4YW1wbGVcclxuICogYGBgamF2YXNjcmlwdFxyXG4gKiBjb25zdCBhY3Rpb25Db2RlU2V0dGluZ3MgPSB7XHJcbiAqICAgdXJsOiAnaHR0cHM6Ly93d3cuZXhhbXBsZS5jb20vP2VtYWlsPXVzZXJAZXhhbXBsZS5jb20nLFxyXG4gKiAgIGlPUzoge1xyXG4gKiAgICAgIGJ1bmRsZUlkOiAnY29tLmV4YW1wbGUuaW9zJ1xyXG4gKiAgIH0sXHJcbiAqICAgYW5kcm9pZDoge1xyXG4gKiAgICAgcGFja2FnZU5hbWU6ICdjb20uZXhhbXBsZS5hbmRyb2lkJyxcclxuICogICAgIGluc3RhbGxBcHA6IHRydWUsXHJcbiAqICAgICBtaW5pbXVtVmVyc2lvbjogJzEyJ1xyXG4gKiAgIH0sXHJcbiAqICAgaGFuZGxlQ29kZUluQXBwOiB0cnVlXHJcbiAqIH07XHJcbiAqIGF3YWl0IHNlbmRTaWduSW5MaW5rVG9FbWFpbChhdXRoLCAndXNlckBleGFtcGxlLmNvbScsIGFjdGlvbkNvZGVTZXR0aW5ncyk7XHJcbiAqIC8vIE9idGFpbiBlbWFpbExpbmsgZnJvbSB0aGUgdXNlci5cclxuICogaWYoaXNTaWduSW5XaXRoRW1haWxMaW5rKGF1dGgsIGVtYWlsTGluaykpIHtcclxuICogICBhd2FpdCBzaWduSW5XaXRoRW1haWxMaW5rKCd1c2VyQGV4YW1wbGUuY29tJywgJ3VzZXJAZXhhbXBsZS5jb20nLCBlbWFpbExpbmspO1xyXG4gKiB9XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXHJcbiAqIEBwYXJhbSBlbWFpbCAtIFRoZSB1c2VyJ3MgZW1haWwgYWRkcmVzcy5cclxuICogQHBhcmFtIGVtYWlsTGluayAtIFRoZSBsaW5rIHNlbnQgdG8gdGhlIHVzZXIncyBlbWFpbCBhZGRyZXNzLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBzaWduSW5XaXRoRW1haWxMaW5rKGF1dGgsIGVtYWlsLCBlbWFpbExpbmspIHtcclxuICAgIGNvbnN0IGF1dGhNb2R1bGFyID0gZ2V0TW9kdWxhckluc3RhbmNlKGF1dGgpO1xyXG4gICAgY29uc3QgY3JlZGVudGlhbCA9IEVtYWlsQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWxXaXRoTGluayhlbWFpbCwgZW1haWxMaW5rIHx8IF9nZXRDdXJyZW50VXJsKCkpO1xyXG4gICAgLy8gQ2hlY2sgaWYgdGhlIHRlbmFudCBJRCBpbiB0aGUgZW1haWwgbGluayBtYXRjaGVzIHRoZSB0ZW5hbnQgSUQgb24gQXV0aFxyXG4gICAgLy8gaW5zdGFuY2UuXHJcbiAgICBfYXNzZXJ0KGNyZWRlbnRpYWwuX3RlbmFudElkID09PSAoYXV0aE1vZHVsYXIudGVuYW50SWQgfHwgbnVsbCksIGF1dGhNb2R1bGFyLCBcInRlbmFudC1pZC1taXNtYXRjaFwiIC8qIFRFTkFOVF9JRF9NSVNNQVRDSCAqLyk7XHJcbiAgICByZXR1cm4gc2lnbkluV2l0aENyZWRlbnRpYWwoYXV0aE1vZHVsYXIsIGNyZWRlbnRpYWwpO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUF1dGhVcmkoYXV0aCwgcmVxdWVzdCkge1xyXG4gICAgcmV0dXJuIF9wZXJmb3JtQXBpUmVxdWVzdChhdXRoLCBcIlBPU1RcIiAvKiBQT1NUICovLCBcIi92MS9hY2NvdW50czpjcmVhdGVBdXRoVXJpXCIgLyogQ1JFQVRFX0FVVEhfVVJJICovLCBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdCkpO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBHZXRzIHRoZSBsaXN0IG9mIHBvc3NpYmxlIHNpZ24gaW4gbWV0aG9kcyBmb3IgdGhlIGdpdmVuIGVtYWlsIGFkZHJlc3MuXHJcbiAqXHJcbiAqIEByZW1hcmtzXHJcbiAqIFRoaXMgaXMgdXNlZnVsIHRvIGRpZmZlcmVudGlhdGUgbWV0aG9kcyBvZiBzaWduLWluIGZvciB0aGUgc2FtZSBwcm92aWRlciwgZWcuXHJcbiAqIHtAbGluayBFbWFpbEF1dGhQcm92aWRlcn0gd2hpY2ggaGFzIDIgbWV0aG9kcyBvZiBzaWduLWluLFxyXG4gKiB7QGxpbmsgU2lnbkluTWV0aG9kfS5FTUFJTF9QQVNTV09SRCBhbmRcclxuICoge0BsaW5rIFNpZ25Jbk1ldGhvZH0uRU1BSUxfTElOSy5cclxuICpcclxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxyXG4gKiBAcGFyYW0gZW1haWwgLSBUaGUgdXNlcidzIGVtYWlsIGFkZHJlc3MuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIGZldGNoU2lnbkluTWV0aG9kc0ZvckVtYWlsKGF1dGgsIGVtYWlsKSB7XHJcbiAgICAvLyBjcmVhdGVBdXRoVXJpIHJldHVybnMgYW4gZXJyb3IgaWYgY29udGludWUgVVJJIGlzIG5vdCBodHRwIG9yIGh0dHBzLlxyXG4gICAgLy8gRm9yIGVudmlyb25tZW50cyBsaWtlIENvcmRvdmEsIENocm9tZSBleHRlbnNpb25zLCBuYXRpdmUgZnJhbWV3b3JrcywgZmlsZVxyXG4gICAgLy8gc3lzdGVtcywgZXRjLCB1c2UgaHR0cDovL2xvY2FsaG9zdCBhcyBjb250aW51ZSBVUkwuXHJcbiAgICBjb25zdCBjb250aW51ZVVyaSA9IF9pc0h0dHBPckh0dHBzKCkgPyBfZ2V0Q3VycmVudFVybCgpIDogJ2h0dHA6Ly9sb2NhbGhvc3QnO1xyXG4gICAgY29uc3QgcmVxdWVzdCA9IHtcclxuICAgICAgICBpZGVudGlmaWVyOiBlbWFpbCxcclxuICAgICAgICBjb250aW51ZVVyaVxyXG4gICAgfTtcclxuICAgIGNvbnN0IHsgc2lnbmluTWV0aG9kcyB9ID0gYXdhaXQgY3JlYXRlQXV0aFVyaShnZXRNb2R1bGFySW5zdGFuY2UoYXV0aCksIHJlcXVlc3QpO1xyXG4gICAgcmV0dXJuIHNpZ25pbk1ldGhvZHMgfHwgW107XHJcbn1cclxuLyoqXHJcbiAqIFNlbmRzIGEgdmVyaWZpY2F0aW9uIGVtYWlsIHRvIGEgdXNlci5cclxuICpcclxuICogQHJlbWFya3NcclxuICogVGhlIHZlcmlmaWNhdGlvbiBwcm9jZXNzIGlzIGNvbXBsZXRlZCBieSBjYWxsaW5nIHtAbGluayBhcHBseUFjdGlvbkNvZGV9LlxyXG4gKlxyXG4gKiBAZXhhbXBsZVxyXG4gKiBgYGBqYXZhc2NyaXB0XHJcbiAqIGNvbnN0IGFjdGlvbkNvZGVTZXR0aW5ncyA9IHtcclxuICogICB1cmw6ICdodHRwczovL3d3dy5leGFtcGxlLmNvbS8/ZW1haWw9dXNlckBleGFtcGxlLmNvbScsXHJcbiAqICAgaU9TOiB7XHJcbiAqICAgICAgYnVuZGxlSWQ6ICdjb20uZXhhbXBsZS5pb3MnXHJcbiAqICAgfSxcclxuICogICBhbmRyb2lkOiB7XHJcbiAqICAgICBwYWNrYWdlTmFtZTogJ2NvbS5leGFtcGxlLmFuZHJvaWQnLFxyXG4gKiAgICAgaW5zdGFsbEFwcDogdHJ1ZSxcclxuICogICAgIG1pbmltdW1WZXJzaW9uOiAnMTInXHJcbiAqICAgfSxcclxuICogICBoYW5kbGVDb2RlSW5BcHA6IHRydWVcclxuICogfTtcclxuICogYXdhaXQgc2VuZEVtYWlsVmVyaWZpY2F0aW9uKHVzZXIsIGFjdGlvbkNvZGVTZXR0aW5ncyk7XHJcbiAqIC8vIE9idGFpbiBjb2RlIGZyb20gdGhlIHVzZXIuXHJcbiAqIGF3YWl0IGFwcGx5QWN0aW9uQ29kZShhdXRoLCBjb2RlKTtcclxuICogYGBgXHJcbiAqXHJcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXHJcbiAqIEBwYXJhbSBhY3Rpb25Db2RlU2V0dGluZ3MgLSBUaGUge0BsaW5rIEFjdGlvbkNvZGVTZXR0aW5nc30uXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIHNlbmRFbWFpbFZlcmlmaWNhdGlvbih1c2VyLCBhY3Rpb25Db2RlU2V0dGluZ3MpIHtcclxuICAgIGNvbnN0IHVzZXJJbnRlcm5hbCA9IGdldE1vZHVsYXJJbnN0YW5jZSh1c2VyKTtcclxuICAgIGNvbnN0IGlkVG9rZW4gPSBhd2FpdCB1c2VyLmdldElkVG9rZW4oKTtcclxuICAgIGNvbnN0IHJlcXVlc3QgPSB7XHJcbiAgICAgICAgcmVxdWVzdFR5cGU6IFwiVkVSSUZZX0VNQUlMXCIgLyogVkVSSUZZX0VNQUlMICovLFxyXG4gICAgICAgIGlkVG9rZW5cclxuICAgIH07XHJcbiAgICBpZiAoYWN0aW9uQ29kZVNldHRpbmdzKSB7XHJcbiAgICAgICAgX3NldEFjdGlvbkNvZGVTZXR0aW5nc09uUmVxdWVzdCh1c2VySW50ZXJuYWwuYXV0aCwgcmVxdWVzdCwgYWN0aW9uQ29kZVNldHRpbmdzKTtcclxuICAgIH1cclxuICAgIGNvbnN0IHsgZW1haWwgfSA9IGF3YWl0IHNlbmRFbWFpbFZlcmlmaWNhdGlvbiQxKHVzZXJJbnRlcm5hbC5hdXRoLCByZXF1ZXN0KTtcclxuICAgIGlmIChlbWFpbCAhPT0gdXNlci5lbWFpbCkge1xyXG4gICAgICAgIGF3YWl0IHVzZXIucmVsb2FkKCk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIFNlbmRzIGEgdmVyaWZpY2F0aW9uIGVtYWlsIHRvIGEgbmV3IGVtYWlsIGFkZHJlc3MuXHJcbiAqXHJcbiAqIEByZW1hcmtzXHJcbiAqIFRoZSB1c2VyJ3MgZW1haWwgd2lsbCBiZSB1cGRhdGVkIHRvIHRoZSBuZXcgb25lIGFmdGVyIGJlaW5nIHZlcmlmaWVkLlxyXG4gKlxyXG4gKiBJZiB5b3UgaGF2ZSBhIGN1c3RvbSBlbWFpbCBhY3Rpb24gaGFuZGxlciwgeW91IGNhbiBjb21wbGV0ZSB0aGUgdmVyaWZpY2F0aW9uIHByb2Nlc3MgYnkgY2FsbGluZ1xyXG4gKiB7QGxpbmsgYXBwbHlBY3Rpb25Db2RlfS5cclxuICpcclxuICogQGV4YW1wbGVcclxuICogYGBgamF2YXNjcmlwdFxyXG4gKiBjb25zdCBhY3Rpb25Db2RlU2V0dGluZ3MgPSB7XHJcbiAqICAgdXJsOiAnaHR0cHM6Ly93d3cuZXhhbXBsZS5jb20vP2VtYWlsPXVzZXJAZXhhbXBsZS5jb20nLFxyXG4gKiAgIGlPUzoge1xyXG4gKiAgICAgIGJ1bmRsZUlkOiAnY29tLmV4YW1wbGUuaW9zJ1xyXG4gKiAgIH0sXHJcbiAqICAgYW5kcm9pZDoge1xyXG4gKiAgICAgcGFja2FnZU5hbWU6ICdjb20uZXhhbXBsZS5hbmRyb2lkJyxcclxuICogICAgIGluc3RhbGxBcHA6IHRydWUsXHJcbiAqICAgICBtaW5pbXVtVmVyc2lvbjogJzEyJ1xyXG4gKiAgIH0sXHJcbiAqICAgaGFuZGxlQ29kZUluQXBwOiB0cnVlXHJcbiAqIH07XHJcbiAqIGF3YWl0IHZlcmlmeUJlZm9yZVVwZGF0ZUVtYWlsKHVzZXIsICduZXdlbWFpbEBleGFtcGxlLmNvbScsIGFjdGlvbkNvZGVTZXR0aW5ncyk7XHJcbiAqIC8vIE9idGFpbiBjb2RlIGZyb20gdGhlIHVzZXIuXHJcbiAqIGF3YWl0IGFwcGx5QWN0aW9uQ29kZShhdXRoLCBjb2RlKTtcclxuICogYGBgXHJcbiAqXHJcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXHJcbiAqIEBwYXJhbSBuZXdFbWFpbCAtIFRoZSBuZXcgZW1haWwgYWRkcmVzcyB0byBiZSB2ZXJpZmllZCBiZWZvcmUgdXBkYXRlLlxyXG4gKiBAcGFyYW0gYWN0aW9uQ29kZVNldHRpbmdzIC0gVGhlIHtAbGluayBBY3Rpb25Db2RlU2V0dGluZ3N9LlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiB2ZXJpZnlCZWZvcmVVcGRhdGVFbWFpbCh1c2VyLCBuZXdFbWFpbCwgYWN0aW9uQ29kZVNldHRpbmdzKSB7XHJcbiAgICBjb25zdCB1c2VySW50ZXJuYWwgPSBnZXRNb2R1bGFySW5zdGFuY2UodXNlcik7XHJcbiAgICBjb25zdCBpZFRva2VuID0gYXdhaXQgdXNlci5nZXRJZFRva2VuKCk7XHJcbiAgICBjb25zdCByZXF1ZXN0ID0ge1xyXG4gICAgICAgIHJlcXVlc3RUeXBlOiBcIlZFUklGWV9BTkRfQ0hBTkdFX0VNQUlMXCIgLyogVkVSSUZZX0FORF9DSEFOR0VfRU1BSUwgKi8sXHJcbiAgICAgICAgaWRUb2tlbixcclxuICAgICAgICBuZXdFbWFpbFxyXG4gICAgfTtcclxuICAgIGlmIChhY3Rpb25Db2RlU2V0dGluZ3MpIHtcclxuICAgICAgICBfc2V0QWN0aW9uQ29kZVNldHRpbmdzT25SZXF1ZXN0KHVzZXJJbnRlcm5hbC5hdXRoLCByZXF1ZXN0LCBhY3Rpb25Db2RlU2V0dGluZ3MpO1xyXG4gICAgfVxyXG4gICAgY29uc3QgeyBlbWFpbCB9ID0gYXdhaXQgdmVyaWZ5QW5kQ2hhbmdlRW1haWwodXNlckludGVybmFsLmF1dGgsIHJlcXVlc3QpO1xyXG4gICAgaWYgKGVtYWlsICE9PSB1c2VyLmVtYWlsKSB7XHJcbiAgICAgICAgLy8gSWYgdGhlIGxvY2FsIGNvcHkgb2YgdGhlIGVtYWlsIG9uIHVzZXIgaXMgb3V0ZGF0ZWQsIHJlbG9hZCB0aGVcclxuICAgICAgICAvLyB1c2VyLlxyXG4gICAgICAgIGF3YWl0IHVzZXIucmVsb2FkKCk7XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gdXBkYXRlUHJvZmlsZSQxKGF1dGgsIHJlcXVlc3QpIHtcclxuICAgIHJldHVybiBfcGVyZm9ybUFwaVJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogUE9TVCAqLywgXCIvdjEvYWNjb3VudHM6dXBkYXRlXCIgLyogU0VUX0FDQ09VTlRfSU5GTyAqLywgcmVxdWVzdCk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFVwZGF0ZXMgYSB1c2VyJ3MgcHJvZmlsZSBkYXRhLlxyXG4gKlxyXG4gKiBAcGFyYW0gdXNlciAtIFRoZSB1c2VyLlxyXG4gKiBAcGFyYW0gcHJvZmlsZSAtIFRoZSBwcm9maWxlJ3MgYGRpc3BsYXlOYW1lYCBhbmQgYHBob3RvVVJMYCB0byB1cGRhdGUuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVByb2ZpbGUodXNlciwgeyBkaXNwbGF5TmFtZSwgcGhvdG9VUkw6IHBob3RvVXJsIH0pIHtcclxuICAgIGlmIChkaXNwbGF5TmFtZSA9PT0gdW5kZWZpbmVkICYmIHBob3RvVXJsID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb25zdCB1c2VySW50ZXJuYWwgPSBnZXRNb2R1bGFySW5zdGFuY2UodXNlcik7XHJcbiAgICBjb25zdCBpZFRva2VuID0gYXdhaXQgdXNlckludGVybmFsLmdldElkVG9rZW4oKTtcclxuICAgIGNvbnN0IHByb2ZpbGVSZXF1ZXN0ID0ge1xyXG4gICAgICAgIGlkVG9rZW4sXHJcbiAgICAgICAgZGlzcGxheU5hbWUsXHJcbiAgICAgICAgcGhvdG9VcmwsXHJcbiAgICAgICAgcmV0dXJuU2VjdXJlVG9rZW46IHRydWVcclxuICAgIH07XHJcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IF9sb2dvdXRJZkludmFsaWRhdGVkKHVzZXJJbnRlcm5hbCwgdXBkYXRlUHJvZmlsZSQxKHVzZXJJbnRlcm5hbC5hdXRoLCBwcm9maWxlUmVxdWVzdCkpO1xyXG4gICAgdXNlckludGVybmFsLmRpc3BsYXlOYW1lID0gcmVzcG9uc2UuZGlzcGxheU5hbWUgfHwgbnVsbDtcclxuICAgIHVzZXJJbnRlcm5hbC5waG90b1VSTCA9IHJlc3BvbnNlLnBob3RvVXJsIHx8IG51bGw7XHJcbiAgICAvLyBVcGRhdGUgdGhlIHBhc3N3b3JkIHByb3ZpZGVyIGFzIHdlbGxcclxuICAgIGNvbnN0IHBhc3N3b3JkUHJvdmlkZXIgPSB1c2VySW50ZXJuYWwucHJvdmlkZXJEYXRhLmZpbmQoKHsgcHJvdmlkZXJJZCB9KSA9PiBwcm92aWRlcklkID09PSBcInBhc3N3b3JkXCIgLyogUEFTU1dPUkQgKi8pO1xyXG4gICAgaWYgKHBhc3N3b3JkUHJvdmlkZXIpIHtcclxuICAgICAgICBwYXNzd29yZFByb3ZpZGVyLmRpc3BsYXlOYW1lID0gdXNlckludGVybmFsLmRpc3BsYXlOYW1lO1xyXG4gICAgICAgIHBhc3N3b3JkUHJvdmlkZXIucGhvdG9VUkwgPSB1c2VySW50ZXJuYWwucGhvdG9VUkw7XHJcbiAgICB9XHJcbiAgICBhd2FpdCB1c2VySW50ZXJuYWwuX3VwZGF0ZVRva2Vuc0lmTmVjZXNzYXJ5KHJlc3BvbnNlKTtcclxufVxyXG4vKipcclxuICogVXBkYXRlcyB0aGUgdXNlcidzIGVtYWlsIGFkZHJlc3MuXHJcbiAqXHJcbiAqIEByZW1hcmtzXHJcbiAqIEFuIGVtYWlsIHdpbGwgYmUgc2VudCB0byB0aGUgb3JpZ2luYWwgZW1haWwgYWRkcmVzcyAoaWYgaXQgd2FzIHNldCkgdGhhdCBhbGxvd3MgdG8gcmV2b2tlIHRoZVxyXG4gKiBlbWFpbCBhZGRyZXNzIGNoYW5nZSwgaW4gb3JkZXIgdG8gcHJvdGVjdCB0aGVtIGZyb20gYWNjb3VudCBoaWphY2tpbmcuXHJcbiAqXHJcbiAqIEltcG9ydGFudDogdGhpcyBpcyBhIHNlY3VyaXR5IHNlbnNpdGl2ZSBvcGVyYXRpb24gdGhhdCByZXF1aXJlcyB0aGUgdXNlciB0byBoYXZlIHJlY2VudGx5IHNpZ25lZFxyXG4gKiBpbi4gSWYgdGhpcyByZXF1aXJlbWVudCBpc24ndCBtZXQsIGFzayB0aGUgdXNlciB0byBhdXRoZW50aWNhdGUgYWdhaW4gYW5kIHRoZW4gY2FsbFxyXG4gKiB7QGxpbmsgcmVhdXRoZW50aWNhdGVXaXRoQ3JlZGVudGlhbH0uXHJcbiAqXHJcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXHJcbiAqIEBwYXJhbSBuZXdFbWFpbCAtIFRoZSBuZXcgZW1haWwgYWRkcmVzcy5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuZnVuY3Rpb24gdXBkYXRlRW1haWwodXNlciwgbmV3RW1haWwpIHtcclxuICAgIHJldHVybiB1cGRhdGVFbWFpbE9yUGFzc3dvcmQoZ2V0TW9kdWxhckluc3RhbmNlKHVzZXIpLCBuZXdFbWFpbCwgbnVsbCk7XHJcbn1cclxuLyoqXHJcbiAqIFVwZGF0ZXMgdGhlIHVzZXIncyBwYXNzd29yZC5cclxuICpcclxuICogQHJlbWFya3NcclxuICogSW1wb3J0YW50OiB0aGlzIGlzIGEgc2VjdXJpdHkgc2Vuc2l0aXZlIG9wZXJhdGlvbiB0aGF0IHJlcXVpcmVzIHRoZSB1c2VyIHRvIGhhdmUgcmVjZW50bHkgc2lnbmVkXHJcbiAqIGluLiBJZiB0aGlzIHJlcXVpcmVtZW50IGlzbid0IG1ldCwgYXNrIHRoZSB1c2VyIHRvIGF1dGhlbnRpY2F0ZSBhZ2FpbiBhbmQgdGhlbiBjYWxsXHJcbiAqIHtAbGluayByZWF1dGhlbnRpY2F0ZVdpdGhDcmVkZW50aWFsfS5cclxuICpcclxuICogQHBhcmFtIHVzZXIgLSBUaGUgdXNlci5cclxuICogQHBhcmFtIG5ld1Bhc3N3b3JkIC0gVGhlIG5ldyBwYXNzd29yZC5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuZnVuY3Rpb24gdXBkYXRlUGFzc3dvcmQodXNlciwgbmV3UGFzc3dvcmQpIHtcclxuICAgIHJldHVybiB1cGRhdGVFbWFpbE9yUGFzc3dvcmQoZ2V0TW9kdWxhckluc3RhbmNlKHVzZXIpLCBudWxsLCBuZXdQYXNzd29yZCk7XHJcbn1cclxuYXN5bmMgZnVuY3Rpb24gdXBkYXRlRW1haWxPclBhc3N3b3JkKHVzZXIsIGVtYWlsLCBwYXNzd29yZCkge1xyXG4gICAgY29uc3QgeyBhdXRoIH0gPSB1c2VyO1xyXG4gICAgY29uc3QgaWRUb2tlbiA9IGF3YWl0IHVzZXIuZ2V0SWRUb2tlbigpO1xyXG4gICAgY29uc3QgcmVxdWVzdCA9IHtcclxuICAgICAgICBpZFRva2VuLFxyXG4gICAgICAgIHJldHVyblNlY3VyZVRva2VuOiB0cnVlXHJcbiAgICB9O1xyXG4gICAgaWYgKGVtYWlsKSB7XHJcbiAgICAgICAgcmVxdWVzdC5lbWFpbCA9IGVtYWlsO1xyXG4gICAgfVxyXG4gICAgaWYgKHBhc3N3b3JkKSB7XHJcbiAgICAgICAgcmVxdWVzdC5wYXNzd29yZCA9IHBhc3N3b3JkO1xyXG4gICAgfVxyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBfbG9nb3V0SWZJbnZhbGlkYXRlZCh1c2VyLCB1cGRhdGVFbWFpbFBhc3N3b3JkKGF1dGgsIHJlcXVlc3QpKTtcclxuICAgIGF3YWl0IHVzZXIuX3VwZGF0ZVRva2Vuc0lmTmVjZXNzYXJ5KHJlc3BvbnNlLCAvKiByZWxvYWQgKi8gdHJ1ZSk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFBhcnNlIHRoZSBgQWRkaXRpb25hbFVzZXJJbmZvYCBmcm9tIHRoZSBJRCB0b2tlbiByZXNwb25zZS5cclxuICpcclxuICovXHJcbmZ1bmN0aW9uIF9mcm9tSWRUb2tlblJlc3BvbnNlKGlkVG9rZW5SZXNwb25zZSkge1xyXG4gICAgdmFyIF9hLCBfYjtcclxuICAgIGlmICghaWRUb2tlblJlc3BvbnNlKSB7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgICBjb25zdCB7IHByb3ZpZGVySWQgfSA9IGlkVG9rZW5SZXNwb25zZTtcclxuICAgIGNvbnN0IHByb2ZpbGUgPSBpZFRva2VuUmVzcG9uc2UucmF3VXNlckluZm9cclxuICAgICAgICA/IEpTT04ucGFyc2UoaWRUb2tlblJlc3BvbnNlLnJhd1VzZXJJbmZvKVxyXG4gICAgICAgIDoge307XHJcbiAgICBjb25zdCBpc05ld1VzZXIgPSBpZFRva2VuUmVzcG9uc2UuaXNOZXdVc2VyIHx8XHJcbiAgICAgICAgaWRUb2tlblJlc3BvbnNlLmtpbmQgPT09IFwiaWRlbnRpdHl0b29sa2l0I1NpZ251cE5ld1VzZXJSZXNwb25zZVwiIC8qIFNpZ251cE5ld1VzZXIgKi87XHJcbiAgICBpZiAoIXByb3ZpZGVySWQgJiYgKGlkVG9rZW5SZXNwb25zZSA9PT0gbnVsbCB8fCBpZFRva2VuUmVzcG9uc2UgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGlkVG9rZW5SZXNwb25zZS5pZFRva2VuKSkge1xyXG4gICAgICAgIGNvbnN0IHNpZ25JblByb3ZpZGVyID0gKF9iID0gKF9hID0gX3BhcnNlVG9rZW4oaWRUb2tlblJlc3BvbnNlLmlkVG9rZW4pKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuZmlyZWJhc2UpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYlsnc2lnbl9pbl9wcm92aWRlciddO1xyXG4gICAgICAgIGlmIChzaWduSW5Qcm92aWRlcikge1xyXG4gICAgICAgICAgICBjb25zdCBmaWx0ZXJlZFByb3ZpZGVySWQgPSBzaWduSW5Qcm92aWRlciAhPT0gXCJhbm9ueW1vdXNcIiAvKiBBTk9OWU1PVVMgKi8gJiZcclxuICAgICAgICAgICAgICAgIHNpZ25JblByb3ZpZGVyICE9PSBcImN1c3RvbVwiIC8qIENVU1RPTSAqL1xyXG4gICAgICAgICAgICAgICAgPyBzaWduSW5Qcm92aWRlclxyXG4gICAgICAgICAgICAgICAgOiBudWxsO1xyXG4gICAgICAgICAgICAvLyBVc2VzIGdlbmVyaWMgY2xhc3MgaW4gYWNjb3JkYW5jZSB3aXRoIHRoZSBsZWdhY3kgU0RLLlxyXG4gICAgICAgICAgICByZXR1cm4gbmV3IEdlbmVyaWNBZGRpdGlvbmFsVXNlckluZm8oaXNOZXdVc2VyLCBmaWx0ZXJlZFByb3ZpZGVySWQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGlmICghcHJvdmlkZXJJZCkge1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgc3dpdGNoIChwcm92aWRlcklkKSB7XHJcbiAgICAgICAgY2FzZSBcImZhY2Vib29rLmNvbVwiIC8qIEZBQ0VCT09LICovOlxyXG4gICAgICAgICAgICByZXR1cm4gbmV3IEZhY2Vib29rQWRkaXRpb25hbFVzZXJJbmZvKGlzTmV3VXNlciwgcHJvZmlsZSk7XHJcbiAgICAgICAgY2FzZSBcImdpdGh1Yi5jb21cIiAvKiBHSVRIVUIgKi86XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgR2l0aHViQWRkaXRpb25hbFVzZXJJbmZvKGlzTmV3VXNlciwgcHJvZmlsZSk7XHJcbiAgICAgICAgY2FzZSBcImdvb2dsZS5jb21cIiAvKiBHT09HTEUgKi86XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgR29vZ2xlQWRkaXRpb25hbFVzZXJJbmZvKGlzTmV3VXNlciwgcHJvZmlsZSk7XHJcbiAgICAgICAgY2FzZSBcInR3aXR0ZXIuY29tXCIgLyogVFdJVFRFUiAqLzpcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBUd2l0dGVyQWRkaXRpb25hbFVzZXJJbmZvKGlzTmV3VXNlciwgcHJvZmlsZSwgaWRUb2tlblJlc3BvbnNlLnNjcmVlbk5hbWUgfHwgbnVsbCk7XHJcbiAgICAgICAgY2FzZSBcImN1c3RvbVwiIC8qIENVU1RPTSAqLzpcclxuICAgICAgICBjYXNlIFwiYW5vbnltb3VzXCIgLyogQU5PTllNT1VTICovOlxyXG4gICAgICAgICAgICByZXR1cm4gbmV3IEdlbmVyaWNBZGRpdGlvbmFsVXNlckluZm8oaXNOZXdVc2VyLCBudWxsKTtcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICByZXR1cm4gbmV3IEdlbmVyaWNBZGRpdGlvbmFsVXNlckluZm8oaXNOZXdVc2VyLCBwcm92aWRlcklkLCBwcm9maWxlKTtcclxuICAgIH1cclxufVxyXG5jbGFzcyBHZW5lcmljQWRkaXRpb25hbFVzZXJJbmZvIHtcclxuICAgIGNvbnN0cnVjdG9yKGlzTmV3VXNlciwgcHJvdmlkZXJJZCwgcHJvZmlsZSA9IHt9KSB7XHJcbiAgICAgICAgdGhpcy5pc05ld1VzZXIgPSBpc05ld1VzZXI7XHJcbiAgICAgICAgdGhpcy5wcm92aWRlcklkID0gcHJvdmlkZXJJZDtcclxuICAgICAgICB0aGlzLnByb2ZpbGUgPSBwcm9maWxlO1xyXG4gICAgfVxyXG59XHJcbmNsYXNzIEZlZGVyYXRlZEFkZGl0aW9uYWxVc2VySW5mb1dpdGhVc2VybmFtZSBleHRlbmRzIEdlbmVyaWNBZGRpdGlvbmFsVXNlckluZm8ge1xyXG4gICAgY29uc3RydWN0b3IoaXNOZXdVc2VyLCBwcm92aWRlcklkLCBwcm9maWxlLCB1c2VybmFtZSkge1xyXG4gICAgICAgIHN1cGVyKGlzTmV3VXNlciwgcHJvdmlkZXJJZCwgcHJvZmlsZSk7XHJcbiAgICAgICAgdGhpcy51c2VybmFtZSA9IHVzZXJuYW1lO1xyXG4gICAgfVxyXG59XHJcbmNsYXNzIEZhY2Vib29rQWRkaXRpb25hbFVzZXJJbmZvIGV4dGVuZHMgR2VuZXJpY0FkZGl0aW9uYWxVc2VySW5mbyB7XHJcbiAgICBjb25zdHJ1Y3Rvcihpc05ld1VzZXIsIHByb2ZpbGUpIHtcclxuICAgICAgICBzdXBlcihpc05ld1VzZXIsIFwiZmFjZWJvb2suY29tXCIgLyogRkFDRUJPT0sgKi8sIHByb2ZpbGUpO1xyXG4gICAgfVxyXG59XHJcbmNsYXNzIEdpdGh1YkFkZGl0aW9uYWxVc2VySW5mbyBleHRlbmRzIEZlZGVyYXRlZEFkZGl0aW9uYWxVc2VySW5mb1dpdGhVc2VybmFtZSB7XHJcbiAgICBjb25zdHJ1Y3Rvcihpc05ld1VzZXIsIHByb2ZpbGUpIHtcclxuICAgICAgICBzdXBlcihpc05ld1VzZXIsIFwiZ2l0aHViLmNvbVwiIC8qIEdJVEhVQiAqLywgcHJvZmlsZSwgdHlwZW9mIChwcm9maWxlID09PSBudWxsIHx8IHByb2ZpbGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHByb2ZpbGUubG9naW4pID09PSAnc3RyaW5nJyA/IHByb2ZpbGUgPT09IG51bGwgfHwgcHJvZmlsZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogcHJvZmlsZS5sb2dpbiA6IG51bGwpO1xyXG4gICAgfVxyXG59XHJcbmNsYXNzIEdvb2dsZUFkZGl0aW9uYWxVc2VySW5mbyBleHRlbmRzIEdlbmVyaWNBZGRpdGlvbmFsVXNlckluZm8ge1xyXG4gICAgY29uc3RydWN0b3IoaXNOZXdVc2VyLCBwcm9maWxlKSB7XHJcbiAgICAgICAgc3VwZXIoaXNOZXdVc2VyLCBcImdvb2dsZS5jb21cIiAvKiBHT09HTEUgKi8sIHByb2ZpbGUpO1xyXG4gICAgfVxyXG59XHJcbmNsYXNzIFR3aXR0ZXJBZGRpdGlvbmFsVXNlckluZm8gZXh0ZW5kcyBGZWRlcmF0ZWRBZGRpdGlvbmFsVXNlckluZm9XaXRoVXNlcm5hbWUge1xyXG4gICAgY29uc3RydWN0b3IoaXNOZXdVc2VyLCBwcm9maWxlLCBzY3JlZW5OYW1lKSB7XHJcbiAgICAgICAgc3VwZXIoaXNOZXdVc2VyLCBcInR3aXR0ZXIuY29tXCIgLyogVFdJVFRFUiAqLywgcHJvZmlsZSwgc2NyZWVuTmFtZSk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIEV4dHJhY3RzIHByb3ZpZGVyIHNwZWNpZmljIHtAbGluayBBZGRpdGlvbmFsVXNlckluZm99IGZvciB0aGUgZ2l2ZW4gY3JlZGVudGlhbC5cclxuICpcclxuICogQHBhcmFtIHVzZXJDcmVkZW50aWFsIC0gVGhlIHVzZXIgY3JlZGVudGlhbC5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuZnVuY3Rpb24gZ2V0QWRkaXRpb25hbFVzZXJJbmZvKHVzZXJDcmVkZW50aWFsKSB7XHJcbiAgICBjb25zdCB7IHVzZXIsIF90b2tlblJlc3BvbnNlIH0gPSB1c2VyQ3JlZGVudGlhbDtcclxuICAgIGlmICh1c2VyLmlzQW5vbnltb3VzICYmICFfdG9rZW5SZXNwb25zZSkge1xyXG4gICAgICAgIC8vIEhhbmRsZSB0aGUgc3BlY2lhbCBjYXNlIHdoZXJlIHNpZ25JbkFub255bW91c2x5KCkgZ2V0cyBjYWxsZWQgdHdpY2UuXHJcbiAgICAgICAgLy8gTm8gbmV0d29yayBjYWxsIGlzIG1hZGUgc28gdGhlcmUncyBub3RoaW5nIHRvIGFjdHVhbGx5IGZpbGwgdGhpcyBpblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHByb3ZpZGVySWQ6IG51bGwsXHJcbiAgICAgICAgICAgIGlzTmV3VXNlcjogZmFsc2UsXHJcbiAgICAgICAgICAgIHByb2ZpbGU6IG51bGxcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIF9mcm9tSWRUb2tlblJlc3BvbnNlKF90b2tlblJlc3BvbnNlKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vLyBOb24tb3B0aW9uYWwgYXV0aCBtZXRob2RzLlxyXG4vKipcclxuICogQ2hhbmdlcyB0aGUgdHlwZSBvZiBwZXJzaXN0ZW5jZSBvbiB0aGUge0BsaW5rIEF1dGh9IGluc3RhbmNlIGZvciB0aGUgY3VycmVudGx5IHNhdmVkXHJcbiAqIGBBdXRoYCBzZXNzaW9uIGFuZCBhcHBsaWVzIHRoaXMgdHlwZSBvZiBwZXJzaXN0ZW5jZSBmb3IgZnV0dXJlIHNpZ24taW4gcmVxdWVzdHMsIGluY2x1ZGluZ1xyXG4gKiBzaWduLWluIHdpdGggcmVkaXJlY3QgcmVxdWVzdHMuXHJcbiAqXHJcbiAqIEByZW1hcmtzXHJcbiAqIFRoaXMgbWFrZXMgaXQgZWFzeSBmb3IgYSB1c2VyIHNpZ25pbmcgaW4gdG8gc3BlY2lmeSB3aGV0aGVyIHRoZWlyIHNlc3Npb24gc2hvdWxkIGJlXHJcbiAqIHJlbWVtYmVyZWQgb3Igbm90LiBJdCBhbHNvIG1ha2VzIGl0IGVhc2llciB0byBuZXZlciBwZXJzaXN0IHRoZSBgQXV0aGAgc3RhdGUgZm9yIGFwcGxpY2F0aW9uc1xyXG4gKiB0aGF0IGFyZSBzaGFyZWQgYnkgb3RoZXIgdXNlcnMgb3IgaGF2ZSBzZW5zaXRpdmUgZGF0YS5cclxuICpcclxuICogQGV4YW1wbGVcclxuICogYGBgamF2YXNjcmlwdFxyXG4gKiBzZXRQZXJzaXN0ZW5jZShhdXRoLCBicm93c2VyU2Vzc2lvblBlcnNpc3RlbmNlKTtcclxuICogYGBgXHJcbiAqXHJcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cclxuICogQHBhcmFtIHBlcnNpc3RlbmNlIC0gVGhlIHtAbGluayBQZXJzaXN0ZW5jZX0gdG8gdXNlLlxyXG4gKiBAcmV0dXJucyBBIGBQcm9taXNlYCB0aGF0IHJlc29sdmVzIG9uY2UgdGhlIHBlcnNpc3RlbmNlIGNoYW5nZSBoYXMgY29tcGxldGVkXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmZ1bmN0aW9uIHNldFBlcnNpc3RlbmNlKGF1dGgsIHBlcnNpc3RlbmNlKSB7XHJcbiAgICByZXR1cm4gZ2V0TW9kdWxhckluc3RhbmNlKGF1dGgpLnNldFBlcnNpc3RlbmNlKHBlcnNpc3RlbmNlKTtcclxufVxyXG4vKipcclxuICogQWRkcyBhbiBvYnNlcnZlciBmb3IgY2hhbmdlcyB0byB0aGUgc2lnbmVkLWluIHVzZXIncyBJRCB0b2tlbiwgd2hpY2ggaW5jbHVkZXMgc2lnbi1pbixcclxuICogc2lnbi1vdXQsIGFuZCB0b2tlbiByZWZyZXNoIGV2ZW50cy5cclxuICpcclxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxyXG4gKiBAcGFyYW0gbmV4dE9yT2JzZXJ2ZXIgLSBjYWxsYmFjayB0cmlnZ2VyZWQgb24gY2hhbmdlLlxyXG4gKiBAcGFyYW0gZXJyb3IgLSBjYWxsYmFjayB0cmlnZ2VyZWQgb24gZXJyb3IuXHJcbiAqIEBwYXJhbSBjb21wbGV0ZWQgLSBjYWxsYmFjayB0cmlnZ2VyZWQgd2hlbiBvYnNlcnZlciBpcyByZW1vdmVkLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5mdW5jdGlvbiBvbklkVG9rZW5DaGFuZ2VkKGF1dGgsIG5leHRPck9ic2VydmVyLCBlcnJvciwgY29tcGxldGVkKSB7XHJcbiAgICByZXR1cm4gZ2V0TW9kdWxhckluc3RhbmNlKGF1dGgpLm9uSWRUb2tlbkNoYW5nZWQobmV4dE9yT2JzZXJ2ZXIsIGVycm9yLCBjb21wbGV0ZWQpO1xyXG59XHJcbi8qKlxyXG4gKiBBZGRzIGFuIG9ic2VydmVyIGZvciBjaGFuZ2VzIHRvIHRoZSB1c2VyJ3Mgc2lnbi1pbiBzdGF0ZS5cclxuICpcclxuICogQHJlbWFya3NcclxuICogVG8ga2VlcCB0aGUgb2xkIGJlaGF2aW9yLCBzZWUge0BsaW5rIG9uSWRUb2tlbkNoYW5nZWR9LlxyXG4gKlxyXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXHJcbiAqIEBwYXJhbSBuZXh0T3JPYnNlcnZlciAtIGNhbGxiYWNrIHRyaWdnZXJlZCBvbiBjaGFuZ2UuXHJcbiAqIEBwYXJhbSBlcnJvciAtIGNhbGxiYWNrIHRyaWdnZXJlZCBvbiBlcnJvci5cclxuICogQHBhcmFtIGNvbXBsZXRlZCAtIGNhbGxiYWNrIHRyaWdnZXJlZCB3aGVuIG9ic2VydmVyIGlzIHJlbW92ZWQuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmZ1bmN0aW9uIG9uQXV0aFN0YXRlQ2hhbmdlZChhdXRoLCBuZXh0T3JPYnNlcnZlciwgZXJyb3IsIGNvbXBsZXRlZCkge1xyXG4gICAgcmV0dXJuIGdldE1vZHVsYXJJbnN0YW5jZShhdXRoKS5vbkF1dGhTdGF0ZUNoYW5nZWQobmV4dE9yT2JzZXJ2ZXIsIGVycm9yLCBjb21wbGV0ZWQpO1xyXG59XHJcbi8qKlxyXG4gKiBTZXRzIHRoZSBjdXJyZW50IGxhbmd1YWdlIHRvIHRoZSBkZWZhdWx0IGRldmljZS9icm93c2VyIHByZWZlcmVuY2UuXHJcbiAqXHJcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuZnVuY3Rpb24gdXNlRGV2aWNlTGFuZ3VhZ2UoYXV0aCkge1xyXG4gICAgZ2V0TW9kdWxhckluc3RhbmNlKGF1dGgpLnVzZURldmljZUxhbmd1YWdlKCk7XHJcbn1cclxuLyoqXHJcbiAqIEFzeW5jaHJvbm91c2x5IHNldHMgdGhlIHByb3ZpZGVkIHVzZXIgYXMge0BsaW5rIEF1dGguY3VycmVudFVzZXJ9IG9uIHRoZVxyXG4gKiB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXHJcbiAqXHJcbiAqIEByZW1hcmtzXHJcbiAqIEEgbmV3IGluc3RhbmNlIGNvcHkgb2YgdGhlIHVzZXIgcHJvdmlkZWQgd2lsbCBiZSBtYWRlIGFuZCBzZXQgYXMgY3VycmVudFVzZXIuXHJcbiAqXHJcbiAqIFRoaXMgd2lsbCB0cmlnZ2VyIHtAbGluayBvbkF1dGhTdGF0ZUNoYW5nZWR9IGFuZCB7QGxpbmsgb25JZFRva2VuQ2hhbmdlZH0gbGlzdGVuZXJzXHJcbiAqIGxpa2Ugb3RoZXIgc2lnbiBpbiBtZXRob2RzLlxyXG4gKlxyXG4gKiBUaGUgb3BlcmF0aW9uIGZhaWxzIHdpdGggYW4gZXJyb3IgaWYgdGhlIHVzZXIgdG8gYmUgdXBkYXRlZCBiZWxvbmdzIHRvIGEgZGlmZmVyZW50IEZpcmViYXNlXHJcbiAqIHByb2plY3QuXHJcbiAqXHJcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cclxuICogQHBhcmFtIHVzZXIgLSBUaGUgbmV3IHtAbGluayBVc2VyfS5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuZnVuY3Rpb24gdXBkYXRlQ3VycmVudFVzZXIoYXV0aCwgdXNlcikge1xyXG4gICAgcmV0dXJuIGdldE1vZHVsYXJJbnN0YW5jZShhdXRoKS51cGRhdGVDdXJyZW50VXNlcih1c2VyKTtcclxufVxyXG4vKipcclxuICogU2lnbnMgb3V0IHRoZSBjdXJyZW50IHVzZXIuXHJcbiAqXHJcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuZnVuY3Rpb24gc2lnbk91dChhdXRoKSB7XHJcbiAgICByZXR1cm4gZ2V0TW9kdWxhckluc3RhbmNlKGF1dGgpLnNpZ25PdXQoKTtcclxufVxyXG4vKipcclxuICogRGVsZXRlcyBhbmQgc2lnbnMgb3V0IHRoZSB1c2VyLlxyXG4gKlxyXG4gKiBAcmVtYXJrc1xyXG4gKiBJbXBvcnRhbnQ6IHRoaXMgaXMgYSBzZWN1cml0eS1zZW5zaXRpdmUgb3BlcmF0aW9uIHRoYXQgcmVxdWlyZXMgdGhlIHVzZXIgdG8gaGF2ZSByZWNlbnRseVxyXG4gKiBzaWduZWQgaW4uIElmIHRoaXMgcmVxdWlyZW1lbnQgaXNuJ3QgbWV0LCBhc2sgdGhlIHVzZXIgdG8gYXV0aGVudGljYXRlIGFnYWluIGFuZCB0aGVuIGNhbGxcclxuICoge0BsaW5rIHJlYXV0aGVudGljYXRlV2l0aENyZWRlbnRpYWx9LlxyXG4gKlxyXG4gKiBAcGFyYW0gdXNlciAtIFRoZSB1c2VyLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBkZWxldGVVc2VyKHVzZXIpIHtcclxuICAgIHJldHVybiBnZXRNb2R1bGFySW5zdGFuY2UodXNlcikuZGVsZXRlKCk7XHJcbn1cblxuY2xhc3MgTXVsdGlGYWN0b3JTZXNzaW9uSW1wbCB7XHJcbiAgICBjb25zdHJ1Y3Rvcih0eXBlLCBjcmVkZW50aWFsKSB7XHJcbiAgICAgICAgdGhpcy50eXBlID0gdHlwZTtcclxuICAgICAgICB0aGlzLmNyZWRlbnRpYWwgPSBjcmVkZW50aWFsO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIF9mcm9tSWR0b2tlbihpZFRva2VuKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBNdWx0aUZhY3RvclNlc3Npb25JbXBsKFwiZW5yb2xsXCIgLyogRU5ST0xMICovLCBpZFRva2VuKTtcclxuICAgIH1cclxuICAgIHN0YXRpYyBfZnJvbU1mYVBlbmRpbmdDcmVkZW50aWFsKG1mYVBlbmRpbmdDcmVkZW50aWFsKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBNdWx0aUZhY3RvclNlc3Npb25JbXBsKFwic2lnbmluXCIgLyogU0lHTl9JTiAqLywgbWZhUGVuZGluZ0NyZWRlbnRpYWwpO1xyXG4gICAgfVxyXG4gICAgdG9KU09OKCkge1xyXG4gICAgICAgIGNvbnN0IGtleSA9IHRoaXMudHlwZSA9PT0gXCJlbnJvbGxcIiAvKiBFTlJPTEwgKi9cclxuICAgICAgICAgICAgPyAnaWRUb2tlbidcclxuICAgICAgICAgICAgOiAncGVuZGluZ0NyZWRlbnRpYWwnO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIG11bHRpRmFjdG9yU2Vzc2lvbjoge1xyXG4gICAgICAgICAgICAgICAgW2tleV06IHRoaXMuY3JlZGVudGlhbFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuICAgIHN0YXRpYyBmcm9tSlNPTihvYmopIHtcclxuICAgICAgICB2YXIgX2EsIF9iO1xyXG4gICAgICAgIGlmIChvYmogPT09IG51bGwgfHwgb2JqID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvYmoubXVsdGlGYWN0b3JTZXNzaW9uKSB7XHJcbiAgICAgICAgICAgIGlmICgoX2EgPSBvYmoubXVsdGlGYWN0b3JTZXNzaW9uKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EucGVuZGluZ0NyZWRlbnRpYWwpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBNdWx0aUZhY3RvclNlc3Npb25JbXBsLl9mcm9tTWZhUGVuZGluZ0NyZWRlbnRpYWwob2JqLm11bHRpRmFjdG9yU2Vzc2lvbi5wZW5kaW5nQ3JlZGVudGlhbCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoKF9iID0gb2JqLm11bHRpRmFjdG9yU2Vzc2lvbikgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLmlkVG9rZW4pIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBNdWx0aUZhY3RvclNlc3Npb25JbXBsLl9mcm9tSWR0b2tlbihvYmoubXVsdGlGYWN0b3JTZXNzaW9uLmlkVG9rZW4pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmNsYXNzIE11bHRpRmFjdG9yUmVzb2x2ZXJJbXBsIHtcclxuICAgIGNvbnN0cnVjdG9yKHNlc3Npb24sIGhpbnRzLCBzaWduSW5SZXNvbHZlcikge1xyXG4gICAgICAgIHRoaXMuc2Vzc2lvbiA9IHNlc3Npb247XHJcbiAgICAgICAgdGhpcy5oaW50cyA9IGhpbnRzO1xyXG4gICAgICAgIHRoaXMuc2lnbkluUmVzb2x2ZXIgPSBzaWduSW5SZXNvbHZlcjtcclxuICAgIH1cclxuICAgIC8qKiBAaW50ZXJuYWwgKi9cclxuICAgIHN0YXRpYyBfZnJvbUVycm9yKGF1dGhFeHRlcm4sIGVycm9yKSB7XHJcbiAgICAgICAgY29uc3QgYXV0aCA9IF9jYXN0QXV0aChhdXRoRXh0ZXJuKTtcclxuICAgICAgICBjb25zdCBoaW50cyA9IChlcnJvci5zZXJ2ZXJSZXNwb25zZS5tZmFJbmZvIHx8IFtdKS5tYXAoZW5yb2xsbWVudCA9PiBNdWx0aUZhY3RvckluZm9JbXBsLl9mcm9tU2VydmVyUmVzcG9uc2UoYXV0aCwgZW5yb2xsbWVudCkpO1xyXG4gICAgICAgIF9hc3NlcnQoZXJyb3Iuc2VydmVyUmVzcG9uc2UubWZhUGVuZGluZ0NyZWRlbnRpYWwsIGF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyk7XHJcbiAgICAgICAgY29uc3Qgc2Vzc2lvbiA9IE11bHRpRmFjdG9yU2Vzc2lvbkltcGwuX2Zyb21NZmFQZW5kaW5nQ3JlZGVudGlhbChlcnJvci5zZXJ2ZXJSZXNwb25zZS5tZmFQZW5kaW5nQ3JlZGVudGlhbCk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBNdWx0aUZhY3RvclJlc29sdmVySW1wbChzZXNzaW9uLCBoaW50cywgYXN5bmMgKGFzc2VydGlvbikgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtZmFSZXNwb25zZSA9IGF3YWl0IGFzc2VydGlvbi5fcHJvY2VzcyhhdXRoLCBzZXNzaW9uKTtcclxuICAgICAgICAgICAgLy8gQ2xlYXIgb3V0IHRoZSB1bm5lZWRlZCBmaWVsZHMgZnJvbSB0aGUgb2xkIGxvZ2luIHJlc3BvbnNlXHJcbiAgICAgICAgICAgIGRlbGV0ZSBlcnJvci5zZXJ2ZXJSZXNwb25zZS5tZmFJbmZvO1xyXG4gICAgICAgICAgICBkZWxldGUgZXJyb3Iuc2VydmVyUmVzcG9uc2UubWZhUGVuZGluZ0NyZWRlbnRpYWw7XHJcbiAgICAgICAgICAgIC8vIFVzZSBpbiB0aGUgbmV3IHRva2VuICYgcmVmcmVzaCB0b2tlbiBpbiB0aGUgb2xkIHJlc3BvbnNlXHJcbiAgICAgICAgICAgIGNvbnN0IGlkVG9rZW5SZXNwb25zZSA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgZXJyb3Iuc2VydmVyUmVzcG9uc2UpLCB7IGlkVG9rZW46IG1mYVJlc3BvbnNlLmlkVG9rZW4sIHJlZnJlc2hUb2tlbjogbWZhUmVzcG9uc2UucmVmcmVzaFRva2VuIH0pO1xyXG4gICAgICAgICAgICAvLyBUT0RPOiB3ZSBzaG91bGQgY29sbGFwc2UgdGhpcyBzd2l0Y2ggc3RhdGVtZW50IGludG8gVXNlckNyZWRlbnRpYWxJbXBsLl9mb3JPcGVyYXRpb24gYW5kIGhhdmUgaXQgc3VwcG9ydCB0aGUgU0lHTl9JTiBjYXNlXHJcbiAgICAgICAgICAgIHN3aXRjaCAoZXJyb3Iub3BlcmF0aW9uVHlwZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSBcInNpZ25JblwiIC8qIFNJR05fSU4gKi86XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdXNlckNyZWRlbnRpYWwgPSBhd2FpdCBVc2VyQ3JlZGVudGlhbEltcGwuX2Zyb21JZFRva2VuUmVzcG9uc2UoYXV0aCwgZXJyb3Iub3BlcmF0aW9uVHlwZSwgaWRUb2tlblJlc3BvbnNlKTtcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBhdXRoLl91cGRhdGVDdXJyZW50VXNlcih1c2VyQ3JlZGVudGlhbC51c2VyKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXNlckNyZWRlbnRpYWw7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwicmVhdXRoZW50aWNhdGVcIiAvKiBSRUFVVEhFTlRJQ0FURSAqLzpcclxuICAgICAgICAgICAgICAgICAgICBfYXNzZXJ0KGVycm9yLnVzZXIsIGF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFVzZXJDcmVkZW50aWFsSW1wbC5fZm9yT3BlcmF0aW9uKGVycm9yLnVzZXIsIGVycm9yLm9wZXJhdGlvblR5cGUsIGlkVG9rZW5SZXNwb25zZSk7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIF9mYWlsKGF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGFzeW5jIHJlc29sdmVTaWduSW4oYXNzZXJ0aW9uRXh0ZXJuKSB7XHJcbiAgICAgICAgY29uc3QgYXNzZXJ0aW9uID0gYXNzZXJ0aW9uRXh0ZXJuO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNpZ25JblJlc29sdmVyKGFzc2VydGlvbik7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIFByb3ZpZGVzIGEge0BsaW5rIE11bHRpRmFjdG9yUmVzb2x2ZXJ9IHN1aXRhYmxlIGZvciBjb21wbGV0aW9uIG9mIGFcclxuICogbXVsdGktZmFjdG9yIGZsb3cuXHJcbiAqXHJcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cclxuICogQHBhcmFtIGVycm9yIC0gVGhlIHtAbGluayBNdWx0aUZhY3RvckVycm9yfSByYWlzZWQgZHVyaW5nIGEgc2lnbi1pbiwgb3JcclxuICogcmVhdXRoZW50aWNhdGlvbiBvcGVyYXRpb24uXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmZ1bmN0aW9uIGdldE11bHRpRmFjdG9yUmVzb2x2ZXIoYXV0aCwgZXJyb3IpIHtcclxuICAgIHZhciBfYTtcclxuICAgIGNvbnN0IGF1dGhNb2R1bGFyID0gZ2V0TW9kdWxhckluc3RhbmNlKGF1dGgpO1xyXG4gICAgY29uc3QgZXJyb3JJbnRlcm5hbCA9IGVycm9yO1xyXG4gICAgX2Fzc2VydChlcnJvci5vcGVyYXRpb25UeXBlLCBhdXRoTW9kdWxhciwgXCJhcmd1bWVudC1lcnJvclwiIC8qIEFSR1VNRU5UX0VSUk9SICovKTtcclxuICAgIF9hc3NlcnQoKF9hID0gZXJyb3JJbnRlcm5hbC5zZXJ2ZXJSZXNwb25zZSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLm1mYVBlbmRpbmdDcmVkZW50aWFsLCBhdXRoTW9kdWxhciwgXCJhcmd1bWVudC1lcnJvclwiIC8qIEFSR1VNRU5UX0VSUk9SICovKTtcclxuICAgIHJldHVybiBNdWx0aUZhY3RvclJlc29sdmVySW1wbC5fZnJvbUVycm9yKGF1dGhNb2R1bGFyLCBlcnJvckludGVybmFsKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5mdW5jdGlvbiBzdGFydEVucm9sbFBob25lTWZhKGF1dGgsIHJlcXVlc3QpIHtcclxuICAgIHJldHVybiBfcGVyZm9ybUFwaVJlcXVlc3QoYXV0aCwgXCJQT1NUXCIgLyogUE9TVCAqLywgXCIvdjIvYWNjb3VudHMvbWZhRW5yb2xsbWVudDpzdGFydFwiIC8qIFNUQVJUX1BIT05FX01GQV9FTlJPTExNRU5UICovLCBPYmplY3QuYXNzaWduKHsgdGVuYW50SWQ6IGF1dGgudGVuYW50SWQgfSwgcmVxdWVzdCkpO1xyXG59XHJcbmZ1bmN0aW9uIGZpbmFsaXplRW5yb2xsUGhvbmVNZmEoYXV0aCwgcmVxdWVzdCkge1xyXG4gICAgcmV0dXJuIF9wZXJmb3JtQXBpUmVxdWVzdChhdXRoLCBcIlBPU1RcIiAvKiBQT1NUICovLCBcIi92Mi9hY2NvdW50cy9tZmFFbnJvbGxtZW50OmZpbmFsaXplXCIgLyogRklOQUxJWkVfUEhPTkVfTUZBX0VOUk9MTE1FTlQgKi8sIE9iamVjdC5hc3NpZ24oeyB0ZW5hbnRJZDogYXV0aC50ZW5hbnRJZCB9LCByZXF1ZXN0KSk7XHJcbn1cclxuZnVuY3Rpb24gd2l0aGRyYXdNZmEoYXV0aCwgcmVxdWVzdCkge1xyXG4gICAgcmV0dXJuIF9wZXJmb3JtQXBpUmVxdWVzdChhdXRoLCBcIlBPU1RcIiAvKiBQT1NUICovLCBcIi92Mi9hY2NvdW50cy9tZmFFbnJvbGxtZW50OndpdGhkcmF3XCIgLyogV0lUSERSQVdfTUZBICovLCBPYmplY3QuYXNzaWduKHsgdGVuYW50SWQ6IGF1dGgudGVuYW50SWQgfSwgcmVxdWVzdCkpO1xyXG59XG5cbmNsYXNzIE11bHRpRmFjdG9yVXNlckltcGwge1xyXG4gICAgY29uc3RydWN0b3IodXNlcikge1xyXG4gICAgICAgIHRoaXMudXNlciA9IHVzZXI7XHJcbiAgICAgICAgdGhpcy5lbnJvbGxlZEZhY3RvcnMgPSBbXTtcclxuICAgICAgICB1c2VyLl9vblJlbG9hZCh1c2VySW5mbyA9PiB7XHJcbiAgICAgICAgICAgIGlmICh1c2VySW5mby5tZmFJbmZvKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVucm9sbGVkRmFjdG9ycyA9IHVzZXJJbmZvLm1mYUluZm8ubWFwKGVucm9sbG1lbnQgPT4gTXVsdGlGYWN0b3JJbmZvSW1wbC5fZnJvbVNlcnZlclJlc3BvbnNlKHVzZXIuYXV0aCwgZW5yb2xsbWVudCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgX2Zyb21Vc2VyKHVzZXIpIHtcclxuICAgICAgICByZXR1cm4gbmV3IE11bHRpRmFjdG9yVXNlckltcGwodXNlcik7XHJcbiAgICB9XHJcbiAgICBhc3luYyBnZXRTZXNzaW9uKCkge1xyXG4gICAgICAgIHJldHVybiBNdWx0aUZhY3RvclNlc3Npb25JbXBsLl9mcm9tSWR0b2tlbihhd2FpdCB0aGlzLnVzZXIuZ2V0SWRUb2tlbigpKTtcclxuICAgIH1cclxuICAgIGFzeW5jIGVucm9sbChhc3NlcnRpb25FeHRlcm4sIGRpc3BsYXlOYW1lKSB7XHJcbiAgICAgICAgY29uc3QgYXNzZXJ0aW9uID0gYXNzZXJ0aW9uRXh0ZXJuO1xyXG4gICAgICAgIGNvbnN0IHNlc3Npb24gPSAoYXdhaXQgdGhpcy5nZXRTZXNzaW9uKCkpO1xyXG4gICAgICAgIGNvbnN0IGZpbmFsaXplTWZhUmVzcG9uc2UgPSBhd2FpdCBfbG9nb3V0SWZJbnZhbGlkYXRlZCh0aGlzLnVzZXIsIGFzc2VydGlvbi5fcHJvY2Vzcyh0aGlzLnVzZXIuYXV0aCwgc2Vzc2lvbiwgZGlzcGxheU5hbWUpKTtcclxuICAgICAgICAvLyBOZXcgdG9rZW5zIHdpbGwgYmUgaXNzdWVkIGFmdGVyIGVucm9sbG1lbnQgb2YgdGhlIG5ldyBzZWNvbmQgZmFjdG9ycy5cclxuICAgICAgICAvLyBUaGV5IG5lZWQgdG8gYmUgdXBkYXRlZCBvbiB0aGUgdXNlci5cclxuICAgICAgICBhd2FpdCB0aGlzLnVzZXIuX3VwZGF0ZVRva2Vuc0lmTmVjZXNzYXJ5KGZpbmFsaXplTWZhUmVzcG9uc2UpO1xyXG4gICAgICAgIC8vIFRoZSB1c2VyIG5lZWRzIHRvIGJlIHJlbG9hZGVkIHRvIGdldCB0aGUgbmV3IG11bHRpLWZhY3RvciBpbmZvcm1hdGlvblxyXG4gICAgICAgIC8vIGZyb20gc2VydmVyLiBVU0VSX1JFTE9BREVEIGV2ZW50IHdpbGwgYmUgdHJpZ2dlcmVkIGFuZCBgZW5yb2xsZWRGYWN0b3JzYFxyXG4gICAgICAgIC8vIHdpbGwgYmUgdXBkYXRlZC5cclxuICAgICAgICByZXR1cm4gdGhpcy51c2VyLnJlbG9hZCgpO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgdW5lbnJvbGwoaW5mb09yVWlkKSB7XHJcbiAgICAgICAgY29uc3QgbWZhRW5yb2xsbWVudElkID0gdHlwZW9mIGluZm9PclVpZCA9PT0gJ3N0cmluZycgPyBpbmZvT3JVaWQgOiBpbmZvT3JVaWQudWlkO1xyXG4gICAgICAgIGNvbnN0IGlkVG9rZW4gPSBhd2FpdCB0aGlzLnVzZXIuZ2V0SWRUb2tlbigpO1xyXG4gICAgICAgIGNvbnN0IGlkVG9rZW5SZXNwb25zZSA9IGF3YWl0IF9sb2dvdXRJZkludmFsaWRhdGVkKHRoaXMudXNlciwgd2l0aGRyYXdNZmEodGhpcy51c2VyLmF1dGgsIHtcclxuICAgICAgICAgICAgaWRUb2tlbixcclxuICAgICAgICAgICAgbWZhRW5yb2xsbWVudElkXHJcbiAgICAgICAgfSkpO1xyXG4gICAgICAgIC8vIFJlbW92ZSB0aGUgc2Vjb25kIGZhY3RvciBmcm9tIHRoZSB1c2VyJ3MgbGlzdC5cclxuICAgICAgICB0aGlzLmVucm9sbGVkRmFjdG9ycyA9IHRoaXMuZW5yb2xsZWRGYWN0b3JzLmZpbHRlcigoeyB1aWQgfSkgPT4gdWlkICE9PSBtZmFFbnJvbGxtZW50SWQpO1xyXG4gICAgICAgIC8vIERlcGVuZGluZyBvbiB3aGV0aGVyIHRoZSBiYWNrZW5kIGRlY2lkZWQgdG8gcmV2b2tlIHRoZSB1c2VyJ3Mgc2Vzc2lvbixcclxuICAgICAgICAvLyB0aGUgdG9rZW5SZXNwb25zZSBtYXkgYmUgZW1wdHkuIElmIHRoZSB0b2tlbnMgd2VyZSBub3QgdXBkYXRlZCAoYW5kIHRoZXlcclxuICAgICAgICAvLyBhcmUgbm93IGludmFsaWQpLCByZWxvYWRpbmcgdGhlIHVzZXIgd2lsbCBkaXNjb3ZlciB0aGlzIGFuZCBpbnZhbGlkYXRlXHJcbiAgICAgICAgLy8gdGhlIHVzZXIncyBzdGF0ZSBhY2NvcmRpbmdseS5cclxuICAgICAgICBhd2FpdCB0aGlzLnVzZXIuX3VwZGF0ZVRva2Vuc0lmTmVjZXNzYXJ5KGlkVG9rZW5SZXNwb25zZSk7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy51c2VyLnJlbG9hZCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICBpZiAoZS5jb2RlICE9PSBgYXV0aC8ke1widXNlci10b2tlbi1leHBpcmVkXCIgLyogVE9LRU5fRVhQSVJFRCAqL31gKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmNvbnN0IG11bHRpRmFjdG9yVXNlckNhY2hlID0gbmV3IFdlYWtNYXAoKTtcclxuLyoqXHJcbiAqIFRoZSB7QGxpbmsgTXVsdGlGYWN0b3JVc2VyfSBjb3JyZXNwb25kaW5nIHRvIHRoZSB1c2VyLlxyXG4gKlxyXG4gKiBAcmVtYXJrc1xyXG4gKiBUaGlzIGlzIHVzZWQgdG8gYWNjZXNzIGFsbCBtdWx0aS1mYWN0b3IgcHJvcGVydGllcyBhbmQgb3BlcmF0aW9ucyByZWxhdGVkIHRvIHRoZSB1c2VyLlxyXG4gKlxyXG4gKiBAcGFyYW0gdXNlciAtIFRoZSB1c2VyLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5mdW5jdGlvbiBtdWx0aUZhY3Rvcih1c2VyKSB7XHJcbiAgICBjb25zdCB1c2VyTW9kdWxhciA9IGdldE1vZHVsYXJJbnN0YW5jZSh1c2VyKTtcclxuICAgIGlmICghbXVsdGlGYWN0b3JVc2VyQ2FjaGUuaGFzKHVzZXJNb2R1bGFyKSkge1xyXG4gICAgICAgIG11bHRpRmFjdG9yVXNlckNhY2hlLnNldCh1c2VyTW9kdWxhciwgTXVsdGlGYWN0b3JVc2VySW1wbC5fZnJvbVVzZXIodXNlck1vZHVsYXIpKTtcclxuICAgIH1cclxuICAgIHJldHVybiBtdWx0aUZhY3RvclVzZXJDYWNoZS5nZXQodXNlck1vZHVsYXIpO1xyXG59XG5cbmNvbnN0IFNUT1JBR0VfQVZBSUxBQkxFX0tFWSA9ICdfX3Nhayc7XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8vIFRoZXJlIGFyZSB0d28gZGlmZmVyZW50IGJyb3dzZXIgcGVyc2lzdGVuY2UgdHlwZXM6IGxvY2FsIGFuZCBzZXNzaW9uLlxyXG4vLyBCb3RoIGhhdmUgdGhlIHNhbWUgaW1wbGVtZW50YXRpb24gYnV0IHVzZSBhIGRpZmZlcmVudCB1bmRlcmx5aW5nIHN0b3JhZ2VcclxuLy8gb2JqZWN0LlxyXG5jbGFzcyBCcm93c2VyUGVyc2lzdGVuY2VDbGFzcyB7XHJcbiAgICBjb25zdHJ1Y3RvcihzdG9yYWdlLCB0eXBlKSB7XHJcbiAgICAgICAgdGhpcy5zdG9yYWdlID0gc3RvcmFnZTtcclxuICAgICAgICB0aGlzLnR5cGUgPSB0eXBlO1xyXG4gICAgfVxyXG4gICAgX2lzQXZhaWxhYmxlKCkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5zdG9yYWdlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGZhbHNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnN0b3JhZ2Uuc2V0SXRlbShTVE9SQUdFX0FWQUlMQUJMRV9LRVksICcxJyk7XHJcbiAgICAgICAgICAgIHRoaXMuc3RvcmFnZS5yZW1vdmVJdGVtKFNUT1JBR0VfQVZBSUxBQkxFX0tFWSk7XHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodHJ1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChfYSkge1xyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGZhbHNlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBfc2V0KGtleSwgdmFsdWUpIHtcclxuICAgICAgICB0aGlzLnN0b3JhZ2Uuc2V0SXRlbShrZXksIEpTT04uc3RyaW5naWZ5KHZhbHVlKSk7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgfVxyXG4gICAgX2dldChrZXkpIHtcclxuICAgICAgICBjb25zdCBqc29uID0gdGhpcy5zdG9yYWdlLmdldEl0ZW0oa2V5KTtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGpzb24gPyBKU09OLnBhcnNlKGpzb24pIDogbnVsbCk7XHJcbiAgICB9XHJcbiAgICBfcmVtb3ZlKGtleSkge1xyXG4gICAgICAgIHRoaXMuc3RvcmFnZS5yZW1vdmVJdGVtKGtleSk7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmZ1bmN0aW9uIF9pZnJhbWVDYW5ub3RTeW5jV2ViU3RvcmFnZSgpIHtcclxuICAgIGNvbnN0IHVhID0gZ2V0VUEoKTtcclxuICAgIHJldHVybiBfaXNTYWZhcmkodWEpIHx8IF9pc0lPUyh1YSk7XHJcbn1cclxuLy8gVGhlIHBvbGxpbmcgcGVyaW9kIGluIGNhc2UgZXZlbnRzIGFyZSBub3Qgc3VwcG9ydGVkXHJcbmNvbnN0IF9QT0xMSU5HX0lOVEVSVkFMX01TJDEgPSAxMDAwO1xyXG4vLyBUaGUgSUUgMTAgbG9jYWxTdG9yYWdlIGNyb3NzIHRhYiBzeW5jaHJvbml6YXRpb24gZGVsYXkgaW4gbWlsbGlzZWNvbmRzXHJcbmNvbnN0IElFMTBfTE9DQUxfU1RPUkFHRV9TWU5DX0RFTEFZID0gMTA7XHJcbmNsYXNzIEJyb3dzZXJMb2NhbFBlcnNpc3RlbmNlIGV4dGVuZHMgQnJvd3NlclBlcnNpc3RlbmNlQ2xhc3Mge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIod2luZG93LmxvY2FsU3RvcmFnZSwgXCJMT0NBTFwiIC8qIExPQ0FMICovKTtcclxuICAgICAgICB0aGlzLmxpc3RlbmVycyA9IHt9O1xyXG4gICAgICAgIHRoaXMubG9jYWxDYWNoZSA9IHt9O1xyXG4gICAgICAgIC8vIHNldFRpbWVvdXQgcmV0dXJuIHZhbHVlIGlzIHBsYXRmb3JtIHNwZWNpZmljXHJcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcclxuICAgICAgICB0aGlzLnBvbGxUaW1lciA9IG51bGw7XHJcbiAgICAgICAgLy8gU2FmYXJpIG9yIGlPUyBicm93c2VyIGFuZCBlbWJlZGRlZCBpbiBhbiBpZnJhbWUuXHJcbiAgICAgICAgdGhpcy5zYWZhcmlMb2NhbFN0b3JhZ2VOb3RTeW5jZWQgPSBfaWZyYW1lQ2Fubm90U3luY1dlYlN0b3JhZ2UoKSAmJiBfaXNJZnJhbWUoKTtcclxuICAgICAgICAvLyBXaGV0aGVyIHRvIHVzZSBwb2xsaW5nIGluc3RlYWQgb2YgZGVwZW5kaW5nIG9uIHdpbmRvdyBldmVudHNcclxuICAgICAgICB0aGlzLmZhbGxiYWNrVG9Qb2xsaW5nID0gX2lzTW9iaWxlQnJvd3NlcigpO1xyXG4gICAgICAgIHRoaXMuX3Nob3VsZEFsbG93TWlncmF0aW9uID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmJvdW5kRXZlbnRIYW5kbGVyID0gdGhpcy5vblN0b3JhZ2VFdmVudC5iaW5kKHRoaXMpO1xyXG4gICAgfVxyXG4gICAgZm9yQWxsQ2hhbmdlZEtleXMoY2IpIHtcclxuICAgICAgICAvLyBDaGVjayBhbGwga2V5cyB3aXRoIGxpc3RlbmVycyBvbiB0aGVtLlxyXG4gICAgICAgIGZvciAoY29uc3Qga2V5IG9mIE9iamVjdC5rZXlzKHRoaXMubGlzdGVuZXJzKSkge1xyXG4gICAgICAgICAgICAvLyBHZXQgdmFsdWUgZnJvbSBsb2NhbFN0b3JhZ2UuXHJcbiAgICAgICAgICAgIGNvbnN0IG5ld1ZhbHVlID0gdGhpcy5zdG9yYWdlLmdldEl0ZW0oa2V5KTtcclxuICAgICAgICAgICAgY29uc3Qgb2xkVmFsdWUgPSB0aGlzLmxvY2FsQ2FjaGVba2V5XTtcclxuICAgICAgICAgICAgLy8gSWYgbG9jYWwgbWFwIHZhbHVlIGRvZXMgbm90IG1hdGNoLCB0cmlnZ2VyIGxpc3RlbmVyIHdpdGggc3RvcmFnZSBldmVudC5cclxuICAgICAgICAgICAgLy8gRGlmZmVyZW50aWF0ZSB0aGlzIHNpbXVsYXRlZCBldmVudCBmcm9tIHRoZSByZWFsIHN0b3JhZ2UgZXZlbnQuXHJcbiAgICAgICAgICAgIGlmIChuZXdWYWx1ZSAhPT0gb2xkVmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIGNiKGtleSwgb2xkVmFsdWUsIG5ld1ZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIG9uU3RvcmFnZUV2ZW50KGV2ZW50LCBwb2xsID0gZmFsc2UpIHtcclxuICAgICAgICAvLyBLZXkgd291bGQgYmUgbnVsbCBpbiBzb21lIHNpdHVhdGlvbnMsIGxpa2Ugd2hlbiBsb2NhbFN0b3JhZ2UgaXMgY2xlYXJlZFxyXG4gICAgICAgIGlmICghZXZlbnQua2V5KSB7XHJcbiAgICAgICAgICAgIHRoaXMuZm9yQWxsQ2hhbmdlZEtleXMoKGtleSwgX29sZFZhbHVlLCBuZXdWYWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ub3RpZnlMaXN0ZW5lcnMoa2V5LCBuZXdWYWx1ZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGtleSA9IGV2ZW50LmtleTtcclxuICAgICAgICAvLyBDaGVjayB0aGUgbWVjaGFuaXNtIGhvdyB0aGlzIGV2ZW50IHdhcyBkZXRlY3RlZC5cclxuICAgICAgICAvLyBUaGUgZmlyc3QgZXZlbnQgd2lsbCBkaWN0YXRlIHRoZSBtZWNoYW5pc20gdG8gYmUgdXNlZC5cclxuICAgICAgICBpZiAocG9sbCkge1xyXG4gICAgICAgICAgICAvLyBFbnZpcm9ubWVudCBkZXRlY3RzIHN0b3JhZ2UgY2hhbmdlcyB2aWEgcG9sbGluZy5cclxuICAgICAgICAgICAgLy8gUmVtb3ZlIHN0b3JhZ2UgZXZlbnQgbGlzdGVuZXIgdG8gcHJldmVudCBwb3NzaWJsZSBldmVudCBkdXBsaWNhdGlvbi5cclxuICAgICAgICAgICAgdGhpcy5kZXRhY2hMaXN0ZW5lcigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gRW52aXJvbm1lbnQgZGV0ZWN0cyBzdG9yYWdlIGNoYW5nZXMgdmlhIHN0b3JhZ2UgZXZlbnQgbGlzdGVuZXIuXHJcbiAgICAgICAgICAgIC8vIFJlbW92ZSBwb2xsaW5nIGxpc3RlbmVyIHRvIHByZXZlbnQgcG9zc2libGUgZXZlbnQgZHVwbGljYXRpb24uXHJcbiAgICAgICAgICAgIHRoaXMuc3RvcFBvbGxpbmcoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gU2FmYXJpIGVtYmVkZGVkIGlmcmFtZS4gU3RvcmFnZSBldmVudCB3aWxsIHRyaWdnZXIgd2l0aCB0aGUgZGVsdGFcclxuICAgICAgICAvLyBjaGFuZ2VzIGJ1dCBubyBjaGFuZ2VzIHdpbGwgYmUgYXBwbGllZCB0byB0aGUgaWZyYW1lIGxvY2FsU3RvcmFnZS5cclxuICAgICAgICBpZiAodGhpcy5zYWZhcmlMb2NhbFN0b3JhZ2VOb3RTeW5jZWQpIHtcclxuICAgICAgICAgICAgLy8gR2V0IGN1cnJlbnQgaWZyYW1lIHBhZ2UgdmFsdWUuXHJcbiAgICAgICAgICAgIGNvbnN0IHN0b3JlZFZhbHVlID0gdGhpcy5zdG9yYWdlLmdldEl0ZW0oa2V5KTtcclxuICAgICAgICAgICAgLy8gVmFsdWUgbm90IHN5bmNocm9uaXplZCwgc3luY2hyb25pemUgbWFudWFsbHkuXHJcbiAgICAgICAgICAgIGlmIChldmVudC5uZXdWYWx1ZSAhPT0gc3RvcmVkVmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIGlmIChldmVudC5uZXdWYWx1ZSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFZhbHVlIGNoYW5nZWQgZnJvbSBjdXJyZW50IHZhbHVlLlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3RvcmFnZS5zZXRJdGVtKGtleSwgZXZlbnQubmV3VmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gQ3VycmVudCB2YWx1ZSBkZWxldGVkLlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3RvcmFnZS5yZW1vdmVJdGVtKGtleSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5sb2NhbENhY2hlW2tleV0gPT09IGV2ZW50Lm5ld1ZhbHVlICYmICFwb2xsKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBBbHJlYWR5IGRldGVjdGVkIGFuZCBwcm9jZXNzZWQsIGRvIG5vdCB0cmlnZ2VyIGxpc3RlbmVycyBhZ2Fpbi5cclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCB0cmlnZ2VyTGlzdGVuZXJzID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAvLyBLZWVwIGxvY2FsIG1hcCB1cCB0byBkYXRlIGluIGNhc2Ugc3RvcmFnZSBldmVudCBpcyB0cmlnZ2VyZWQgYmVmb3JlXHJcbiAgICAgICAgICAgIC8vIHBvbGwuXHJcbiAgICAgICAgICAgIGNvbnN0IHN0b3JlZFZhbHVlID0gdGhpcy5zdG9yYWdlLmdldEl0ZW0oa2V5KTtcclxuICAgICAgICAgICAgaWYgKCFwb2xsICYmIHRoaXMubG9jYWxDYWNoZVtrZXldID09PSBzdG9yZWRWYWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgLy8gUmVhbCBzdG9yYWdlIGV2ZW50IHdoaWNoIGhhcyBhbHJlYWR5IGJlZW4gZGV0ZWN0ZWQsIGRvIG5vdGhpbmcuXHJcbiAgICAgICAgICAgICAgICAvLyBUaGlzIHNlZW1zIHRvIHRyaWdnZXIgaW4gc29tZSBJRSBicm93c2VycyBmb3Igc29tZSByZWFzb24uXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5ub3RpZnlMaXN0ZW5lcnMoa2V5LCBzdG9yZWRWYWx1ZSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBjb25zdCBzdG9yZWRWYWx1ZSA9IHRoaXMuc3RvcmFnZS5nZXRJdGVtKGtleSk7XHJcbiAgICAgICAgaWYgKF9pc0lFMTAoKSAmJlxyXG4gICAgICAgICAgICBzdG9yZWRWYWx1ZSAhPT0gZXZlbnQubmV3VmFsdWUgJiZcclxuICAgICAgICAgICAgZXZlbnQubmV3VmFsdWUgIT09IGV2ZW50Lm9sZFZhbHVlKSB7XHJcbiAgICAgICAgICAgIC8vIElFIDEwIGhhcyB0aGlzIHdlaXJkIGJ1ZyB3aGVyZSBhIHN0b3JhZ2UgZXZlbnQgd291bGQgdHJpZ2dlciB3aXRoIHRoZVxyXG4gICAgICAgICAgICAvLyBjb3JyZWN0IGtleSwgb2xkVmFsdWUgYW5kIG5ld1ZhbHVlIGJ1dCBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpIGRvZXNcclxuICAgICAgICAgICAgLy8gbm90IHlpZWxkIHRoZSB1cGRhdGVkIHZhbHVlIHVudGlsIGEgZmV3IG1pbGxpc2Vjb25kcy4gVGhpcyBlbnN1cmVzXHJcbiAgICAgICAgICAgIC8vIHRoaXMgcmVjb3ZlcnMgZnJvbSB0aGF0IHNpdHVhdGlvbi5cclxuICAgICAgICAgICAgc2V0VGltZW91dCh0cmlnZ2VyTGlzdGVuZXJzLCBJRTEwX0xPQ0FMX1NUT1JBR0VfU1lOQ19ERUxBWSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0cmlnZ2VyTGlzdGVuZXJzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgbm90aWZ5TGlzdGVuZXJzKGtleSwgdmFsdWUpIHtcclxuICAgICAgICB0aGlzLmxvY2FsQ2FjaGVba2V5XSA9IHZhbHVlO1xyXG4gICAgICAgIGNvbnN0IGxpc3RlbmVycyA9IHRoaXMubGlzdGVuZXJzW2tleV07XHJcbiAgICAgICAgaWYgKGxpc3RlbmVycykge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGxpc3RlbmVyIG9mIEFycmF5LmZyb20obGlzdGVuZXJzKSkge1xyXG4gICAgICAgICAgICAgICAgbGlzdGVuZXIodmFsdWUgPyBKU09OLnBhcnNlKHZhbHVlKSA6IHZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHN0YXJ0UG9sbGluZygpIHtcclxuICAgICAgICB0aGlzLnN0b3BQb2xsaW5nKCk7XHJcbiAgICAgICAgdGhpcy5wb2xsVGltZXIgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuZm9yQWxsQ2hhbmdlZEtleXMoKGtleSwgb2xkVmFsdWUsIG5ld1ZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9uU3RvcmFnZUV2ZW50KG5ldyBTdG9yYWdlRXZlbnQoJ3N0b3JhZ2UnLCB7XHJcbiAgICAgICAgICAgICAgICAgICAga2V5LFxyXG4gICAgICAgICAgICAgICAgICAgIG9sZFZhbHVlLFxyXG4gICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlXHJcbiAgICAgICAgICAgICAgICB9KSwgXHJcbiAgICAgICAgICAgICAgICAvKiBwb2xsICovIHRydWUpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9LCBfUE9MTElOR19JTlRFUlZBTF9NUyQxKTtcclxuICAgIH1cclxuICAgIHN0b3BQb2xsaW5nKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnBvbGxUaW1lcikge1xyXG4gICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMucG9sbFRpbWVyKTtcclxuICAgICAgICAgICAgdGhpcy5wb2xsVGltZXIgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGF0dGFjaExpc3RlbmVyKCkge1xyXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzdG9yYWdlJywgdGhpcy5ib3VuZEV2ZW50SGFuZGxlcik7XHJcbiAgICB9XHJcbiAgICBkZXRhY2hMaXN0ZW5lcigpIHtcclxuICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignc3RvcmFnZScsIHRoaXMuYm91bmRFdmVudEhhbmRsZXIpO1xyXG4gICAgfVxyXG4gICAgX2FkZExpc3RlbmVyKGtleSwgbGlzdGVuZXIpIHtcclxuICAgICAgICBpZiAoT2JqZWN0LmtleXModGhpcy5saXN0ZW5lcnMpLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAvLyBXaGV0aGVyIGJyb3dzZXIgY2FuIGRldGVjdCBzdG9yYWdlIGV2ZW50IHdoZW4gaXQgaGFkIGFscmVhZHkgYmVlbiBwdXNoZWQgdG8gdGhlIGJhY2tncm91bmQuXHJcbiAgICAgICAgICAgIC8vIFRoaXMgbWF5IGhhcHBlbiBpbiBzb21lIG1vYmlsZSBicm93c2Vycy4gQSBsb2NhbFN0b3JhZ2UgY2hhbmdlIGluIHRoZSBmb3JlZ3JvdW5kIHdpbmRvd1xyXG4gICAgICAgICAgICAvLyB3aWxsIG5vdCBiZSBkZXRlY3RlZCBpbiB0aGUgYmFja2dyb3VuZCB3aW5kb3cgdmlhIHRoZSBzdG9yYWdlIGV2ZW50LlxyXG4gICAgICAgICAgICAvLyBUaGlzIHdhcyBkZXRlY3RlZCBpbiBpT1MgNy54IG1vYmlsZSBicm93c2Vyc1xyXG4gICAgICAgICAgICBpZiAodGhpcy5mYWxsYmFja1RvUG9sbGluZykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdGFydFBvbGxpbmcoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXR0YWNoTGlzdGVuZXIoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXRoaXMubGlzdGVuZXJzW2tleV0pIHtcclxuICAgICAgICAgICAgdGhpcy5saXN0ZW5lcnNba2V5XSA9IG5ldyBTZXQoKTtcclxuICAgICAgICAgICAgLy8gUG9wdWxhdGUgdGhlIGNhY2hlIHRvIGF2b2lkIHNwdXJpb3VzbHkgdHJpZ2dlcmluZyBvbiBmaXJzdCBwb2xsLlxyXG4gICAgICAgICAgICB0aGlzLmxvY2FsQ2FjaGVba2V5XSA9IHRoaXMuc3RvcmFnZS5nZXRJdGVtKGtleSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMubGlzdGVuZXJzW2tleV0uYWRkKGxpc3RlbmVyKTtcclxuICAgIH1cclxuICAgIF9yZW1vdmVMaXN0ZW5lcihrZXksIGxpc3RlbmVyKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubGlzdGVuZXJzW2tleV0pIHtcclxuICAgICAgICAgICAgdGhpcy5saXN0ZW5lcnNba2V5XS5kZWxldGUobGlzdGVuZXIpO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5saXN0ZW5lcnNba2V5XS5zaXplID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5saXN0ZW5lcnNba2V5XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoT2JqZWN0LmtleXModGhpcy5saXN0ZW5lcnMpLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICB0aGlzLmRldGFjaExpc3RlbmVyKCk7XHJcbiAgICAgICAgICAgIHRoaXMuc3RvcFBvbGxpbmcoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyBVcGRhdGUgbG9jYWwgY2FjaGUgb24gYmFzZSBvcGVyYXRpb25zOlxyXG4gICAgYXN5bmMgX3NldChrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgYXdhaXQgc3VwZXIuX3NldChrZXksIHZhbHVlKTtcclxuICAgICAgICB0aGlzLmxvY2FsQ2FjaGVba2V5XSA9IEpTT04uc3RyaW5naWZ5KHZhbHVlKTtcclxuICAgIH1cclxuICAgIGFzeW5jIF9nZXQoa2V5KSB7XHJcbiAgICAgICAgY29uc3QgdmFsdWUgPSBhd2FpdCBzdXBlci5fZ2V0KGtleSk7XHJcbiAgICAgICAgdGhpcy5sb2NhbENhY2hlW2tleV0gPSBKU09OLnN0cmluZ2lmeSh2YWx1ZSk7XHJcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgX3JlbW92ZShrZXkpIHtcclxuICAgICAgICBhd2FpdCBzdXBlci5fcmVtb3ZlKGtleSk7XHJcbiAgICAgICAgZGVsZXRlIHRoaXMubG9jYWxDYWNoZVtrZXldO1xyXG4gICAgfVxyXG59XHJcbkJyb3dzZXJMb2NhbFBlcnNpc3RlbmNlLnR5cGUgPSAnTE9DQUwnO1xyXG4vKipcclxuICogQW4gaW1wbGVtZW50YXRpb24gb2Yge0BsaW5rIFBlcnNpc3RlbmNlfSBvZiB0eXBlIGBMT0NBTGAgdXNpbmcgYGxvY2FsU3RvcmFnZWBcclxuICogZm9yIHRoZSB1bmRlcmx5aW5nIHN0b3JhZ2UuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmNvbnN0IGJyb3dzZXJMb2NhbFBlcnNpc3RlbmNlID0gQnJvd3NlckxvY2FsUGVyc2lzdGVuY2U7XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmNsYXNzIEJyb3dzZXJTZXNzaW9uUGVyc2lzdGVuY2UgZXh0ZW5kcyBCcm93c2VyUGVyc2lzdGVuY2VDbGFzcyB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcih3aW5kb3cuc2Vzc2lvblN0b3JhZ2UsIFwiU0VTU0lPTlwiIC8qIFNFU1NJT04gKi8pO1xyXG4gICAgfVxyXG4gICAgX2FkZExpc3RlbmVyKF9rZXksIF9saXN0ZW5lcikge1xyXG4gICAgICAgIC8vIExpc3RlbmVycyBhcmUgbm90IHN1cHBvcnRlZCBmb3Igc2Vzc2lvbiBzdG9yYWdlIHNpbmNlIGl0IGNhbm5vdCBiZSBzaGFyZWQgYWNyb3NzIHdpbmRvd3NcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBfcmVtb3ZlTGlzdGVuZXIoX2tleSwgX2xpc3RlbmVyKSB7XHJcbiAgICAgICAgLy8gTGlzdGVuZXJzIGFyZSBub3Qgc3VwcG9ydGVkIGZvciBzZXNzaW9uIHN0b3JhZ2Ugc2luY2UgaXQgY2Fubm90IGJlIHNoYXJlZCBhY3Jvc3Mgd2luZG93c1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxufVxyXG5Ccm93c2VyU2Vzc2lvblBlcnNpc3RlbmNlLnR5cGUgPSAnU0VTU0lPTic7XHJcbi8qKlxyXG4gKiBBbiBpbXBsZW1lbnRhdGlvbiBvZiB7QGxpbmsgUGVyc2lzdGVuY2V9IG9mIGBTRVNTSU9OYCB1c2luZyBgc2Vzc2lvblN0b3JhZ2VgXHJcbiAqIGZvciB0aGUgdW5kZXJseWluZyBzdG9yYWdlLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5jb25zdCBicm93c2VyU2Vzc2lvblBlcnNpc3RlbmNlID0gQnJvd3NlclNlc3Npb25QZXJzaXN0ZW5jZTtcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFNoaW0gZm9yIFByb21pc2UuYWxsU2V0dGxlZCwgbm90ZSB0aGUgc2xpZ2h0bHkgZGlmZmVyZW50IGZvcm1hdCBvZiBgZnVsZmlsbGVkYCB2cyBgc3RhdHVzYC5cclxuICpcclxuICogQHBhcmFtIHByb21pc2VzIC0gQXJyYXkgb2YgcHJvbWlzZXMgdG8gd2FpdCBvbi5cclxuICovXHJcbmZ1bmN0aW9uIF9hbGxTZXR0bGVkKHByb21pc2VzKSB7XHJcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwocHJvbWlzZXMubWFwKGFzeW5jIChwcm9taXNlKSA9PiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBhd2FpdCBwcm9taXNlO1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgZnVsZmlsbGVkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgdmFsdWVcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKHJlYXNvbikge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgZnVsZmlsbGVkOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIHJlYXNvblxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgIH0pKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogSW50ZXJmYWNlIGNsYXNzIGZvciByZWNlaXZpbmcgbWVzc2FnZXMuXHJcbiAqXHJcbiAqL1xyXG5jbGFzcyBSZWNlaXZlciB7XHJcbiAgICBjb25zdHJ1Y3RvcihldmVudFRhcmdldCkge1xyXG4gICAgICAgIHRoaXMuZXZlbnRUYXJnZXQgPSBldmVudFRhcmdldDtcclxuICAgICAgICB0aGlzLmhhbmRsZXJzTWFwID0ge307XHJcbiAgICAgICAgdGhpcy5ib3VuZEV2ZW50SGFuZGxlciA9IHRoaXMuaGFuZGxlRXZlbnQuYmluZCh0aGlzKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogT2J0YWluIGFuIGluc3RhbmNlIG9mIGEgUmVjZWl2ZXIgZm9yIGEgZ2l2ZW4gZXZlbnQgdGFyZ2V0LCBpZiBub25lIGV4aXN0cyBpdCB3aWxsIGJlIGNyZWF0ZWQuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGV2ZW50VGFyZ2V0IC0gQW4gZXZlbnQgdGFyZ2V0IChzdWNoIGFzIHdpbmRvdyBvciBzZWxmKSB0aHJvdWdoIHdoaWNoIHRoZSB1bmRlcmx5aW5nXHJcbiAgICAgKiBtZXNzYWdlcyB3aWxsIGJlIHJlY2VpdmVkLlxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgX2dldEluc3RhbmNlKGV2ZW50VGFyZ2V0KSB7XHJcbiAgICAgICAgLy8gVGhlIHJlc3VsdHMgYXJlIHN0b3JlZCBpbiBhbiBhcnJheSBzaW5jZSBvYmplY3RzIGNhbid0IGJlIGtleXMgZm9yIG90aGVyXHJcbiAgICAgICAgLy8gb2JqZWN0cy4gSW4gYWRkaXRpb24sIHNldHRpbmcgYSB1bmlxdWUgcHJvcGVydHkgb24gYW4gZXZlbnQgdGFyZ2V0IGFzIGFcclxuICAgICAgICAvLyBoYXNoIG1hcCBrZXkgbWF5IG5vdCBiZSBhbGxvd2VkIGR1ZSB0byBDT1JTIHJlc3RyaWN0aW9ucy5cclxuICAgICAgICBjb25zdCBleGlzdGluZ0luc3RhbmNlID0gdGhpcy5yZWNlaXZlcnMuZmluZChyZWNlaXZlciA9PiByZWNlaXZlci5pc0xpc3RlbmluZ3RvKGV2ZW50VGFyZ2V0KSk7XHJcbiAgICAgICAgaWYgKGV4aXN0aW5nSW5zdGFuY2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGV4aXN0aW5nSW5zdGFuY2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IG5ld0luc3RhbmNlID0gbmV3IFJlY2VpdmVyKGV2ZW50VGFyZ2V0KTtcclxuICAgICAgICB0aGlzLnJlY2VpdmVycy5wdXNoKG5ld0luc3RhbmNlKTtcclxuICAgICAgICByZXR1cm4gbmV3SW5zdGFuY2U7XHJcbiAgICB9XHJcbiAgICBpc0xpc3RlbmluZ3RvKGV2ZW50VGFyZ2V0KSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZXZlbnRUYXJnZXQgPT09IGV2ZW50VGFyZ2V0O1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBGYW5zIG91dCBhIE1lc3NhZ2VFdmVudCB0byB0aGUgYXBwcm9wcmlhdGUgbGlzdGVuZXJzLlxyXG4gICAgICpcclxuICAgICAqIEByZW1hcmtzXHJcbiAgICAgKiBTZW5kcyBhbiB7QGxpbmsgU3RhdHVzLkFDS30gdXBvbiByZWNlaXB0IGFuZCBhIHtAbGluayBTdGF0dXMuRE9ORX0gb25jZSBhbGwgaGFuZGxlcnMgaGF2ZVxyXG4gICAgICogZmluaXNoZWQgcHJvY2Vzc2luZy5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gZXZlbnQgLSBUaGUgTWVzc2FnZUV2ZW50LlxyXG4gICAgICpcclxuICAgICAqL1xyXG4gICAgYXN5bmMgaGFuZGxlRXZlbnQoZXZlbnQpIHtcclxuICAgICAgICBjb25zdCBtZXNzYWdlRXZlbnQgPSBldmVudDtcclxuICAgICAgICBjb25zdCB7IGV2ZW50SWQsIGV2ZW50VHlwZSwgZGF0YSB9ID0gbWVzc2FnZUV2ZW50LmRhdGE7XHJcbiAgICAgICAgY29uc3QgaGFuZGxlcnMgPSB0aGlzLmhhbmRsZXJzTWFwW2V2ZW50VHlwZV07XHJcbiAgICAgICAgaWYgKCEoaGFuZGxlcnMgPT09IG51bGwgfHwgaGFuZGxlcnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGhhbmRsZXJzLnNpemUpKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgbWVzc2FnZUV2ZW50LnBvcnRzWzBdLnBvc3RNZXNzYWdlKHtcclxuICAgICAgICAgICAgc3RhdHVzOiBcImFja1wiIC8qIEFDSyAqLyxcclxuICAgICAgICAgICAgZXZlbnRJZCxcclxuICAgICAgICAgICAgZXZlbnRUeXBlXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY29uc3QgcHJvbWlzZXMgPSBBcnJheS5mcm9tKGhhbmRsZXJzKS5tYXAoYXN5bmMgKGhhbmRsZXIpID0+IGhhbmRsZXIobWVzc2FnZUV2ZW50Lm9yaWdpbiwgZGF0YSkpO1xyXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgX2FsbFNldHRsZWQocHJvbWlzZXMpO1xyXG4gICAgICAgIG1lc3NhZ2VFdmVudC5wb3J0c1swXS5wb3N0TWVzc2FnZSh7XHJcbiAgICAgICAgICAgIHN0YXR1czogXCJkb25lXCIgLyogRE9ORSAqLyxcclxuICAgICAgICAgICAgZXZlbnRJZCxcclxuICAgICAgICAgICAgZXZlbnRUeXBlLFxyXG4gICAgICAgICAgICByZXNwb25zZVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBTdWJzY3JpYmUgYW4gZXZlbnQgaGFuZGxlciBmb3IgYSBwYXJ0aWN1bGFyIGV2ZW50LlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBldmVudFR5cGUgLSBFdmVudCBuYW1lIHRvIHN1YnNjcmliZSB0by5cclxuICAgICAqIEBwYXJhbSBldmVudEhhbmRsZXIgLSBUaGUgZXZlbnQgaGFuZGxlciB3aGljaCBzaG91bGQgcmVjZWl2ZSB0aGUgZXZlbnRzLlxyXG4gICAgICpcclxuICAgICAqL1xyXG4gICAgX3N1YnNjcmliZShldmVudFR5cGUsIGV2ZW50SGFuZGxlcikge1xyXG4gICAgICAgIGlmIChPYmplY3Qua2V5cyh0aGlzLmhhbmRsZXJzTWFwKS5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgdGhpcy5ldmVudFRhcmdldC5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgdGhpcy5ib3VuZEV2ZW50SGFuZGxlcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdGhpcy5oYW5kbGVyc01hcFtldmVudFR5cGVdKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlcnNNYXBbZXZlbnRUeXBlXSA9IG5ldyBTZXQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5oYW5kbGVyc01hcFtldmVudFR5cGVdLmFkZChldmVudEhhbmRsZXIpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBVbnN1YnNjcmliZSBhbiBldmVudCBoYW5kbGVyIGZyb20gYSBwYXJ0aWN1bGFyIGV2ZW50LlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBldmVudFR5cGUgLSBFdmVudCBuYW1lIHRvIHVuc3Vic2NyaWJlIGZyb20uXHJcbiAgICAgKiBAcGFyYW0gZXZlbnRIYW5kbGVyIC0gT3B0aW5vYWwgZXZlbnQgaGFuZGxlciwgaWYgbm9uZSBwcm92aWRlZCwgdW5zdWJzY3JpYmUgYWxsIGhhbmRsZXJzIG9uIHRoaXMgZXZlbnQuXHJcbiAgICAgKlxyXG4gICAgICovXHJcbiAgICBfdW5zdWJzY3JpYmUoZXZlbnRUeXBlLCBldmVudEhhbmRsZXIpIHtcclxuICAgICAgICBpZiAodGhpcy5oYW5kbGVyc01hcFtldmVudFR5cGVdICYmIGV2ZW50SGFuZGxlcikge1xyXG4gICAgICAgICAgICB0aGlzLmhhbmRsZXJzTWFwW2V2ZW50VHlwZV0uZGVsZXRlKGV2ZW50SGFuZGxlcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghZXZlbnRIYW5kbGVyIHx8IHRoaXMuaGFuZGxlcnNNYXBbZXZlbnRUeXBlXS5zaXplID09PSAwKSB7XHJcbiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmhhbmRsZXJzTWFwW2V2ZW50VHlwZV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChPYmplY3Qua2V5cyh0aGlzLmhhbmRsZXJzTWFwKS5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgdGhpcy5ldmVudFRhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgdGhpcy5ib3VuZEV2ZW50SGFuZGxlcik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblJlY2VpdmVyLnJlY2VpdmVycyA9IFtdO1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5mdW5jdGlvbiBfZ2VuZXJhdGVFdmVudElkKHByZWZpeCA9ICcnLCBkaWdpdHMgPSAxMCkge1xyXG4gICAgbGV0IHJhbmRvbSA9ICcnO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkaWdpdHM7IGkrKykge1xyXG4gICAgICAgIHJhbmRvbSArPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcHJlZml4ICsgcmFuZG9tO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBJbnRlcmZhY2UgZm9yIHNlbmRpbmcgbWVzc2FnZXMgYW5kIHdhaXRpbmcgZm9yIGEgY29tcGxldGlvbiByZXNwb25zZS5cclxuICpcclxuICovXHJcbmNsYXNzIFNlbmRlciB7XHJcbiAgICBjb25zdHJ1Y3Rvcih0YXJnZXQpIHtcclxuICAgICAgICB0aGlzLnRhcmdldCA9IHRhcmdldDtcclxuICAgICAgICB0aGlzLmhhbmRsZXJzID0gbmV3IFNldCgpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBVbnN1YnNjcmliZSB0aGUgaGFuZGxlciBhbmQgcmVtb3ZlIGl0IGZyb20gb3VyIHRyYWNraW5nIFNldC5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gaGFuZGxlciAtIFRoZSBoYW5kbGVyIHRvIHVuc3Vic2NyaWJlLlxyXG4gICAgICovXHJcbiAgICByZW1vdmVNZXNzYWdlSGFuZGxlcihoYW5kbGVyKSB7XHJcbiAgICAgICAgaWYgKGhhbmRsZXIubWVzc2FnZUNoYW5uZWwpIHtcclxuICAgICAgICAgICAgaGFuZGxlci5tZXNzYWdlQ2hhbm5lbC5wb3J0MS5yZW1vdmVFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgaGFuZGxlci5vbk1lc3NhZ2UpO1xyXG4gICAgICAgICAgICBoYW5kbGVyLm1lc3NhZ2VDaGFubmVsLnBvcnQxLmNsb3NlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaGFuZGxlcnMuZGVsZXRlKGhhbmRsZXIpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBTZW5kIGEgbWVzc2FnZSB0byB0aGUgUmVjZWl2ZXIgbG9jYXRlZCBhdCB7QGxpbmsgdGFyZ2V0fS5cclxuICAgICAqXHJcbiAgICAgKiBAcmVtYXJrc1xyXG4gICAgICogV2UnbGwgZmlyc3Qgd2FpdCBhIGJpdCBmb3IgYW4gQUNLICwgaWYgd2UgZ2V0IG9uZSB3ZSB3aWxsIHdhaXQgc2lnbmlmaWNhbnRseSBsb25nZXIgdW50aWwgdGhlXHJcbiAgICAgKiByZWNlaXZlciBoYXMgaGFkIGEgY2hhbmNlIHRvIGZ1bGx5IHByb2Nlc3MgdGhlIGV2ZW50LlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBldmVudFR5cGUgLSBUeXBlIG9mIGV2ZW50IHRvIHNlbmQuXHJcbiAgICAgKiBAcGFyYW0gZGF0YSAtIFRoZSBwYXlsb2FkIG9mIHRoZSBldmVudC5cclxuICAgICAqIEBwYXJhbSB0aW1lb3V0IC0gVGltZW91dCBmb3Igd2FpdGluZyBvbiBhbiBBQ0sgZnJvbSB0aGUgcmVjZWl2ZXIuXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybnMgQW4gYXJyYXkgb2Ygc2V0dGxlZCBwcm9taXNlcyBmcm9tIGFsbCB0aGUgaGFuZGxlcnMgdGhhdCB3ZXJlIGxpc3RlbmluZyBvbiB0aGUgcmVjZWl2ZXIuXHJcbiAgICAgKi9cclxuICAgIGFzeW5jIF9zZW5kKGV2ZW50VHlwZSwgZGF0YSwgdGltZW91dCA9IDUwIC8qIEFDSyAqLykge1xyXG4gICAgICAgIGNvbnN0IG1lc3NhZ2VDaGFubmVsID0gdHlwZW9mIE1lc3NhZ2VDaGFubmVsICE9PSAndW5kZWZpbmVkJyA/IG5ldyBNZXNzYWdlQ2hhbm5lbCgpIDogbnVsbDtcclxuICAgICAgICBpZiAoIW1lc3NhZ2VDaGFubmVsKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImNvbm5lY3Rpb25fdW5hdmFpbGFibGVcIiAvKiBDT05ORUNUSU9OX1VOQVZBSUxBQkxFICovKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gTm9kZSB0aW1lcnMgYW5kIGJyb3dzZXIgdGltZXJzIHJldHVybiBmdW5kYW1lbnRhbGx5IGRpZmZlcmVudCB0eXBlcy5cclxuICAgICAgICAvLyBXZSBkb24ndCBhY3R1YWxseSBjYXJlIHdoYXQgdGhlIHZhbHVlIGlzIGJ1dCBUUyB3b24ndCBhY2NlcHQgdW5rbm93biBhbmRcclxuICAgICAgICAvLyB3ZSBjYW4ndCBjYXN0IHByb3Blcmx5IGluIGJvdGggZW52aXJvbm1lbnRzLlxyXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XHJcbiAgICAgICAgbGV0IGNvbXBsZXRpb25UaW1lcjtcclxuICAgICAgICBsZXQgaGFuZGxlcjtcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBldmVudElkID0gX2dlbmVyYXRlRXZlbnRJZCgnJywgMjApO1xyXG4gICAgICAgICAgICBtZXNzYWdlQ2hhbm5lbC5wb3J0MS5zdGFydCgpO1xyXG4gICAgICAgICAgICBjb25zdCBhY2tUaW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcihcInVuc3VwcG9ydGVkX2V2ZW50XCIgLyogVU5TVVBQT1JURURfRVZFTlQgKi8pKTtcclxuICAgICAgICAgICAgfSwgdGltZW91dCk7XHJcbiAgICAgICAgICAgIGhhbmRsZXIgPSB7XHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlQ2hhbm5lbCxcclxuICAgICAgICAgICAgICAgIG9uTWVzc2FnZShldmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VFdmVudCA9IGV2ZW50O1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChtZXNzYWdlRXZlbnQuZGF0YS5ldmVudElkICE9PSBldmVudElkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChtZXNzYWdlRXZlbnQuZGF0YS5zdGF0dXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImFja1wiIC8qIEFDSyAqLzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZSByZWNlaXZlciBzaG91bGQgQUNLIGZpcnN0LlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KGFja1RpbWVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBsZXRpb25UaW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoXCJ0aW1lb3V0XCIgLyogVElNRU9VVCAqLykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgMzAwMCAvKiBDT01QTEVUSU9OICovKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZG9uZVwiIC8qIERPTkUgKi86XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBPbmNlIHRoZSByZWNlaXZlcidzIGhhbmRsZXJzIGFyZSBmaW5pc2hlZCB3ZSB3aWxsIGdldCB0aGUgcmVzdWx0cy5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dChjb21wbGV0aW9uVGltZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShtZXNzYWdlRXZlbnQuZGF0YS5yZXNwb25zZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dChhY2tUaW1lcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQoY29tcGxldGlvblRpbWVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoXCJpbnZhbGlkX3Jlc3BvbnNlXCIgLyogSU5WQUxJRF9SRVNQT05TRSAqLykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLmhhbmRsZXJzLmFkZChoYW5kbGVyKTtcclxuICAgICAgICAgICAgbWVzc2FnZUNoYW5uZWwucG9ydDEuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGhhbmRsZXIub25NZXNzYWdlKTtcclxuICAgICAgICAgICAgdGhpcy50YXJnZXQucG9zdE1lc3NhZ2Uoe1xyXG4gICAgICAgICAgICAgICAgZXZlbnRUeXBlLFxyXG4gICAgICAgICAgICAgICAgZXZlbnRJZCxcclxuICAgICAgICAgICAgICAgIGRhdGFcclxuICAgICAgICAgICAgfSwgW21lc3NhZ2VDaGFubmVsLnBvcnQyXSk7XHJcbiAgICAgICAgfSkuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChoYW5kbGVyKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZU1lc3NhZ2VIYW5kbGVyKGhhbmRsZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIExhenkgYWNjZXNzb3IgZm9yIHdpbmRvdywgc2luY2UgdGhlIGNvbXBhdCBsYXllciB3b24ndCB0cmVlIHNoYWtlIHRoaXMgb3V0LFxyXG4gKiB3ZSBuZWVkIHRvIG1ha2Ugc3VyZSBub3QgdG8gbWVzcyB3aXRoIHdpbmRvdyB1bmxlc3Mgd2UgaGF2ZSB0b1xyXG4gKi9cclxuZnVuY3Rpb24gX3dpbmRvdygpIHtcclxuICAgIHJldHVybiB3aW5kb3c7XHJcbn1cclxuZnVuY3Rpb24gX3NldFdpbmRvd0xvY2F0aW9uKHVybCkge1xyXG4gICAgX3dpbmRvdygpLmxvY2F0aW9uLmhyZWYgPSB1cmw7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTEMuXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmZ1bmN0aW9uIF9pc1dvcmtlcigpIHtcclxuICAgIHJldHVybiAodHlwZW9mIF93aW5kb3coKVsnV29ya2VyR2xvYmFsU2NvcGUnXSAhPT0gJ3VuZGVmaW5lZCcgJiZcclxuICAgICAgICB0eXBlb2YgX3dpbmRvdygpWydpbXBvcnRTY3JpcHRzJ10gPT09ICdmdW5jdGlvbicpO1xyXG59XHJcbmFzeW5jIGZ1bmN0aW9uIF9nZXRBY3RpdmVTZXJ2aWNlV29ya2VyKCkge1xyXG4gICAgaWYgKCEobmF2aWdhdG9yID09PSBudWxsIHx8IG5hdmlnYXRvciA9PT0gdm9pZCAwID8gdm9pZCAwIDogbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIpKSB7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlZ2lzdHJhdGlvbiA9IGF3YWl0IG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLnJlYWR5O1xyXG4gICAgICAgIHJldHVybiByZWdpc3RyYXRpb24uYWN0aXZlO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKF9hKSB7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gX2dldFNlcnZpY2VXb3JrZXJDb250cm9sbGVyKCkge1xyXG4gICAgdmFyIF9hO1xyXG4gICAgcmV0dXJuICgoX2EgPSBuYXZpZ2F0b3IgPT09IG51bGwgfHwgbmF2aWdhdG9yID09PSB2b2lkIDAgPyB2b2lkIDAgOiBuYXZpZ2F0b3Iuc2VydmljZVdvcmtlcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmNvbnRyb2xsZXIpIHx8IG51bGw7XHJcbn1cclxuZnVuY3Rpb24gX2dldFdvcmtlckdsb2JhbFNjb3BlKCkge1xyXG4gICAgcmV0dXJuIF9pc1dvcmtlcigpID8gc2VsZiA6IG51bGw7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuY29uc3QgREJfTkFNRSA9ICdmaXJlYmFzZUxvY2FsU3RvcmFnZURiJztcclxuY29uc3QgREJfVkVSU0lPTiA9IDE7XHJcbmNvbnN0IERCX09CSkVDVFNUT1JFX05BTUUgPSAnZmlyZWJhc2VMb2NhbFN0b3JhZ2UnO1xyXG5jb25zdCBEQl9EQVRBX0tFWVBBVEggPSAnZmJhc2Vfa2V5JztcclxuLyoqXHJcbiAqIFByb21pc2Ugd3JhcHBlciBmb3IgSURCUmVxdWVzdFxyXG4gKlxyXG4gKiBVbmZvcnR1bmF0ZWx5IHdlIGNhbid0IGNsZWFubHkgZXh0ZW5kIFByb21pc2U8VD4gc2luY2UgcHJvbWlzZXMgYXJlIG5vdCBjYWxsYWJsZSBpbiBFUzZcclxuICpcclxuICovXHJcbmNsYXNzIERCUHJvbWlzZSB7XHJcbiAgICBjb25zdHJ1Y3RvcihyZXF1ZXN0KSB7XHJcbiAgICAgICAgdGhpcy5yZXF1ZXN0ID0gcmVxdWVzdDtcclxuICAgIH1cclxuICAgIHRvUHJvbWlzZSgpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnJlcXVlc3QuYWRkRXZlbnRMaXN0ZW5lcignc3VjY2VzcycsICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUodGhpcy5yZXF1ZXN0LnJlc3VsdCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLnJlcXVlc3QuYWRkRXZlbnRMaXN0ZW5lcignZXJyb3InLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICByZWplY3QodGhpcy5yZXF1ZXN0LmVycm9yKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gZ2V0T2JqZWN0U3RvcmUoZGIsIGlzUmVhZFdyaXRlKSB7XHJcbiAgICByZXR1cm4gZGJcclxuICAgICAgICAudHJhbnNhY3Rpb24oW0RCX09CSkVDVFNUT1JFX05BTUVdLCBpc1JlYWRXcml0ZSA/ICdyZWFkd3JpdGUnIDogJ3JlYWRvbmx5JylcclxuICAgICAgICAub2JqZWN0U3RvcmUoREJfT0JKRUNUU1RPUkVfTkFNRSk7XHJcbn1cclxuZnVuY3Rpb24gX2RlbGV0ZURhdGFiYXNlKCkge1xyXG4gICAgY29uc3QgcmVxdWVzdCA9IGluZGV4ZWREQi5kZWxldGVEYXRhYmFzZShEQl9OQU1FKTtcclxuICAgIHJldHVybiBuZXcgREJQcm9taXNlKHJlcXVlc3QpLnRvUHJvbWlzZSgpO1xyXG59XHJcbmZ1bmN0aW9uIF9vcGVuRGF0YWJhc2UoKSB7XHJcbiAgICBjb25zdCByZXF1ZXN0ID0gaW5kZXhlZERCLm9wZW4oREJfTkFNRSwgREJfVkVSU0lPTik7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgIHJlcXVlc3QuYWRkRXZlbnRMaXN0ZW5lcignZXJyb3InLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHJlamVjdChyZXF1ZXN0LmVycm9yKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoJ3VwZ3JhZGVuZWVkZWQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRiID0gcmVxdWVzdC5yZXN1bHQ7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBkYi5jcmVhdGVPYmplY3RTdG9yZShEQl9PQkpFQ1RTVE9SRV9OQU1FLCB7IGtleVBhdGg6IERCX0RBVEFfS0VZUEFUSCB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdzdWNjZXNzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBkYiA9IHJlcXVlc3QucmVzdWx0O1xyXG4gICAgICAgICAgICAvLyBTdHJhbmdlIGJ1ZyB0aGF0IG9jY3VycyBpbiBGaXJlZm94IHdoZW4gbXVsdGlwbGUgdGFicyBhcmUgb3BlbmVkIGF0IHRoZVxyXG4gICAgICAgICAgICAvLyBzYW1lIHRpbWUuIFRoZSBvbmx5IHdheSB0byByZWNvdmVyIHNlZW1zIHRvIGJlIGRlbGV0aW5nIHRoZSBkYXRhYmFzZVxyXG4gICAgICAgICAgICAvLyBhbmQgcmUtaW5pdGlhbGl6aW5nIGl0LlxyXG4gICAgICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vZmlyZWJhc2UvZmlyZWJhc2UtanMtc2RrL2lzc3Vlcy82MzRcclxuICAgICAgICAgICAgaWYgKCFkYi5vYmplY3RTdG9yZU5hbWVzLmNvbnRhaW5zKERCX09CSkVDVFNUT1JFX05BTUUpKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBOZWVkIHRvIGNsb3NlIHRoZSBkYXRhYmFzZSBvciBlbHNlIHlvdSBnZXQgYSBgYmxvY2tlZGAgZXZlbnRcclxuICAgICAgICAgICAgICAgIGRiLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBfZGVsZXRlRGF0YWJhc2UoKTtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUoYXdhaXQgX29wZW5EYXRhYmFzZSgpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUoZGIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufVxyXG5hc3luYyBmdW5jdGlvbiBfcHV0T2JqZWN0KGRiLCBrZXksIHZhbHVlKSB7XHJcbiAgICBjb25zdCByZXF1ZXN0ID0gZ2V0T2JqZWN0U3RvcmUoZGIsIHRydWUpLnB1dCh7XHJcbiAgICAgICAgW0RCX0RBVEFfS0VZUEFUSF06IGtleSxcclxuICAgICAgICB2YWx1ZVxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gbmV3IERCUHJvbWlzZShyZXF1ZXN0KS50b1Byb21pc2UoKTtcclxufVxyXG5hc3luYyBmdW5jdGlvbiBnZXRPYmplY3QoZGIsIGtleSkge1xyXG4gICAgY29uc3QgcmVxdWVzdCA9IGdldE9iamVjdFN0b3JlKGRiLCBmYWxzZSkuZ2V0KGtleSk7XHJcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgbmV3IERCUHJvbWlzZShyZXF1ZXN0KS50b1Byb21pc2UoKTtcclxuICAgIHJldHVybiBkYXRhID09PSB1bmRlZmluZWQgPyBudWxsIDogZGF0YS52YWx1ZTtcclxufVxyXG5mdW5jdGlvbiBfZGVsZXRlT2JqZWN0KGRiLCBrZXkpIHtcclxuICAgIGNvbnN0IHJlcXVlc3QgPSBnZXRPYmplY3RTdG9yZShkYiwgdHJ1ZSkuZGVsZXRlKGtleSk7XHJcbiAgICByZXR1cm4gbmV3IERCUHJvbWlzZShyZXF1ZXN0KS50b1Byb21pc2UoKTtcclxufVxyXG5jb25zdCBfUE9MTElOR19JTlRFUlZBTF9NUyA9IDgwMDtcclxuY29uc3QgX1RSQU5TQUNUSU9OX1JFVFJZX0NPVU5UID0gMztcclxuY2xhc3MgSW5kZXhlZERCTG9jYWxQZXJzaXN0ZW5jZSB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLnR5cGUgPSBcIkxPQ0FMXCIgLyogTE9DQUwgKi87XHJcbiAgICAgICAgdGhpcy5fc2hvdWxkQWxsb3dNaWdyYXRpb24gPSB0cnVlO1xyXG4gICAgICAgIHRoaXMubGlzdGVuZXJzID0ge307XHJcbiAgICAgICAgdGhpcy5sb2NhbENhY2hlID0ge307XHJcbiAgICAgICAgLy8gc2V0VGltZW91dCByZXR1cm4gdmFsdWUgaXMgcGxhdGZvcm0gc3BlY2lmaWNcclxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxyXG4gICAgICAgIHRoaXMucG9sbFRpbWVyID0gbnVsbDtcclxuICAgICAgICB0aGlzLnBlbmRpbmdXcml0ZXMgPSAwO1xyXG4gICAgICAgIHRoaXMucmVjZWl2ZXIgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuc2VuZGVyID0gbnVsbDtcclxuICAgICAgICB0aGlzLnNlcnZpY2VXb3JrZXJSZWNlaXZlckF2YWlsYWJsZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuYWN0aXZlU2VydmljZVdvcmtlciA9IG51bGw7XHJcbiAgICAgICAgLy8gRmlyZSAmIGZvcmdldCB0aGUgc2VydmljZSB3b3JrZXIgcmVnaXN0cmF0aW9uIGFzIGl0IG1heSBuZXZlciByZXNvbHZlXHJcbiAgICAgICAgdGhpcy5fd29ya2VySW5pdGlhbGl6YXRpb25Qcm9taXNlID1cclxuICAgICAgICAgICAgdGhpcy5pbml0aWFsaXplU2VydmljZVdvcmtlck1lc3NhZ2luZygpLnRoZW4oKCkgPT4geyB9LCAoKSA9PiB7IH0pO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgX29wZW5EYigpIHtcclxuICAgICAgICBpZiAodGhpcy5kYikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5kYjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5kYiA9IGF3YWl0IF9vcGVuRGF0YWJhc2UoKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5kYjtcclxuICAgIH1cclxuICAgIGFzeW5jIF93aXRoUmV0cmllcyhvcCkge1xyXG4gICAgICAgIGxldCBudW1BdHRlbXB0cyA9IDA7XHJcbiAgICAgICAgd2hpbGUgKHRydWUpIHtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGRiID0gYXdhaXQgdGhpcy5fb3BlbkRiKCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgb3AoZGIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobnVtQXR0ZW1wdHMrKyA+IF9UUkFOU0FDVElPTl9SRVRSWV9DT1VOVCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IGU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5kYikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGIuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRiID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gVE9ETzogY29uc2lkZXIgYWRkaW5nIGV4cG9uZW50aWFsIGJhY2tvZmZcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogSW5kZXhlZERCIGV2ZW50cyBkbyBub3QgcHJvcGFnYXRlIGZyb20gdGhlIG1haW4gd2luZG93IHRvIHRoZSB3b3JrZXIgY29udGV4dC4gIFdlIHJlbHkgb24gYVxyXG4gICAgICogcG9zdE1lc3NhZ2UgaW50ZXJmYWNlIHRvIHNlbmQgdGhlc2UgZXZlbnRzIHRvIHRoZSB3b3JrZXIgb3Vyc2VsdmVzLlxyXG4gICAgICovXHJcbiAgICBhc3luYyBpbml0aWFsaXplU2VydmljZVdvcmtlck1lc3NhZ2luZygpIHtcclxuICAgICAgICByZXR1cm4gX2lzV29ya2VyKCkgPyB0aGlzLmluaXRpYWxpemVSZWNlaXZlcigpIDogdGhpcy5pbml0aWFsaXplU2VuZGVyKCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEFzIHRoZSB3b3JrZXIgd2Ugc2hvdWxkIGxpc3RlbiB0byBldmVudHMgZnJvbSB0aGUgbWFpbiB3aW5kb3cuXHJcbiAgICAgKi9cclxuICAgIGFzeW5jIGluaXRpYWxpemVSZWNlaXZlcigpIHtcclxuICAgICAgICB0aGlzLnJlY2VpdmVyID0gUmVjZWl2ZXIuX2dldEluc3RhbmNlKF9nZXRXb3JrZXJHbG9iYWxTY29wZSgpKTtcclxuICAgICAgICAvLyBSZWZyZXNoIGZyb20gcGVyc2lzdGVuY2UgaWYgd2UgcmVjZWl2ZSBhIEtleUNoYW5nZWQgbWVzc2FnZS5cclxuICAgICAgICB0aGlzLnJlY2VpdmVyLl9zdWJzY3JpYmUoXCJrZXlDaGFuZ2VkXCIgLyogS0VZX0NIQU5HRUQgKi8sIGFzeW5jIChfb3JpZ2luLCBkYXRhKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGtleXMgPSBhd2FpdCB0aGlzLl9wb2xsKCk7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBrZXlQcm9jZXNzZWQ6IGtleXMuaW5jbHVkZXMoZGF0YS5rZXkpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy8gTGV0IHRoZSBzZW5kZXIga25vdyB0aGF0IHdlIGFyZSBsaXN0ZW5pbmcgc28gdGhleSBnaXZlIHVzIG1vcmUgdGltZW91dC5cclxuICAgICAgICB0aGlzLnJlY2VpdmVyLl9zdWJzY3JpYmUoXCJwaW5nXCIgLyogUElORyAqLywgYXN5bmMgKF9vcmlnaW4sIF9kYXRhKSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiBbXCJrZXlDaGFuZ2VkXCIgLyogS0VZX0NIQU5HRUQgKi9dO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBBcyB0aGUgbWFpbiB3aW5kb3csIHdlIHNob3VsZCBsZXQgdGhlIHdvcmtlciBrbm93IHdoZW4ga2V5cyBjaGFuZ2UgKHNldCBhbmQgcmVtb3ZlKS5cclxuICAgICAqXHJcbiAgICAgKiBAcmVtYXJrc1xyXG4gICAgICoge0BsaW5rIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9TZXJ2aWNlV29ya2VyQ29udGFpbmVyL3JlYWR5IHwgU2VydmljZVdvcmtlckNvbnRhaW5lci5yZWFkeX1cclxuICAgICAqIG1heSBub3QgcmVzb2x2ZS5cclxuICAgICAqL1xyXG4gICAgYXN5bmMgaW5pdGlhbGl6ZVNlbmRlcigpIHtcclxuICAgICAgICB2YXIgX2EsIF9iO1xyXG4gICAgICAgIC8vIENoZWNrIHRvIHNlZSBpZiB0aGVyZSdzIGFuIGFjdGl2ZSBzZXJ2aWNlIHdvcmtlci5cclxuICAgICAgICB0aGlzLmFjdGl2ZVNlcnZpY2VXb3JrZXIgPSBhd2FpdCBfZ2V0QWN0aXZlU2VydmljZVdvcmtlcigpO1xyXG4gICAgICAgIGlmICghdGhpcy5hY3RpdmVTZXJ2aWNlV29ya2VyKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zZW5kZXIgPSBuZXcgU2VuZGVyKHRoaXMuYWN0aXZlU2VydmljZVdvcmtlcik7XHJcbiAgICAgICAgLy8gUGluZyB0aGUgc2VydmljZSB3b3JrZXIgdG8gY2hlY2sgd2hhdCBldmVudHMgdGhleSBjYW4gaGFuZGxlLlxyXG4gICAgICAgIGNvbnN0IHJlc3VsdHMgPSBhd2FpdCB0aGlzLnNlbmRlci5fc2VuZChcInBpbmdcIiAvKiBQSU5HICovLCB7fSwgODAwIC8qIExPTkdfQUNLICovKTtcclxuICAgICAgICBpZiAoIXJlc3VsdHMpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoKChfYSA9IHJlc3VsdHNbMF0pID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5mdWxmaWxsZWQpICYmXHJcbiAgICAgICAgICAgICgoX2IgPSByZXN1bHRzWzBdKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IudmFsdWUuaW5jbHVkZXMoXCJrZXlDaGFuZ2VkXCIgLyogS0VZX0NIQU5HRUQgKi8pKSkge1xyXG4gICAgICAgICAgICB0aGlzLnNlcnZpY2VXb3JrZXJSZWNlaXZlckF2YWlsYWJsZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBMZXQgdGhlIHdvcmtlciBrbm93IGFib3V0IGEgY2hhbmdlZCBrZXksIHRoZSBleGFjdCBrZXkgZG9lc24ndCB0ZWNobmljYWxseSBtYXR0ZXIgc2luY2UgdGhlXHJcbiAgICAgKiB3b3JrZXIgd2lsbCBqdXN0IHRyaWdnZXIgYSBmdWxsIHN5bmMgYW55d2F5LlxyXG4gICAgICpcclxuICAgICAqIEByZW1hcmtzXHJcbiAgICAgKiBGb3Igbm93LCB3ZSBvbmx5IHN1cHBvcnQgb25lIHNlcnZpY2Ugd29ya2VyIHBlciBwYWdlLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBrZXkgLSBTdG9yYWdlIGtleSB3aGljaCBjaGFuZ2VkLlxyXG4gICAgICovXHJcbiAgICBhc3luYyBub3RpZnlTZXJ2aWNlV29ya2VyKGtleSkge1xyXG4gICAgICAgIGlmICghdGhpcy5zZW5kZXIgfHxcclxuICAgICAgICAgICAgIXRoaXMuYWN0aXZlU2VydmljZVdvcmtlciB8fFxyXG4gICAgICAgICAgICBfZ2V0U2VydmljZVdvcmtlckNvbnRyb2xsZXIoKSAhPT0gdGhpcy5hY3RpdmVTZXJ2aWNlV29ya2VyKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5zZW5kZXIuX3NlbmQoXCJrZXlDaGFuZ2VkXCIgLyogS0VZX0NIQU5HRUQgKi8sIHsga2V5IH0sIFxyXG4gICAgICAgICAgICAvLyBVc2UgbG9uZyB0aW1lb3V0IGlmIHJlY2VpdmVyIGhhcyBwcmV2aW91c2x5IHJlc3BvbmRlZCB0byBhIHBpbmcgZnJvbSB1cy5cclxuICAgICAgICAgICAgdGhpcy5zZXJ2aWNlV29ya2VyUmVjZWl2ZXJBdmFpbGFibGVcclxuICAgICAgICAgICAgICAgID8gODAwIC8qIExPTkdfQUNLICovXHJcbiAgICAgICAgICAgICAgICA6IDUwIC8qIEFDSyAqLyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChfYSkge1xyXG4gICAgICAgICAgICAvLyBUaGlzIGlzIGEgYmVzdCBlZmZvcnQgYXBwcm9hY2guIElnbm9yZSBlcnJvcnMuXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgYXN5bmMgX2lzQXZhaWxhYmxlKCkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGlmICghaW5kZXhlZERCKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgZGIgPSBhd2FpdCBfb3BlbkRhdGFiYXNlKCk7XHJcbiAgICAgICAgICAgIGF3YWl0IF9wdXRPYmplY3QoZGIsIFNUT1JBR0VfQVZBSUxBQkxFX0tFWSwgJzEnKTtcclxuICAgICAgICAgICAgYXdhaXQgX2RlbGV0ZU9iamVjdChkYiwgU1RPUkFHRV9BVkFJTEFCTEVfS0VZKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChfYSkgeyB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgX3dpdGhQZW5kaW5nV3JpdGUod3JpdGUpIHtcclxuICAgICAgICB0aGlzLnBlbmRpbmdXcml0ZXMrKztcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBhd2FpdCB3cml0ZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmaW5hbGx5IHtcclxuICAgICAgICAgICAgdGhpcy5wZW5kaW5nV3JpdGVzLS07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgYXN5bmMgX3NldChrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3dpdGhQZW5kaW5nV3JpdGUoYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLl93aXRoUmV0cmllcygoZGIpID0+IF9wdXRPYmplY3QoZGIsIGtleSwgdmFsdWUpKTtcclxuICAgICAgICAgICAgdGhpcy5sb2NhbENhY2hlW2tleV0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMubm90aWZ5U2VydmljZVdvcmtlcihrZXkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgX2dldChrZXkpIHtcclxuICAgICAgICBjb25zdCBvYmogPSAoYXdhaXQgdGhpcy5fd2l0aFJldHJpZXMoKGRiKSA9PiBnZXRPYmplY3QoZGIsIGtleSkpKTtcclxuICAgICAgICB0aGlzLmxvY2FsQ2FjaGVba2V5XSA9IG9iajtcclxuICAgICAgICByZXR1cm4gb2JqO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgX3JlbW92ZShrZXkpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fd2l0aFBlbmRpbmdXcml0ZShhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuX3dpdGhSZXRyaWVzKChkYikgPT4gX2RlbGV0ZU9iamVjdChkYiwga2V5KSk7XHJcbiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmxvY2FsQ2FjaGVba2V5XTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMubm90aWZ5U2VydmljZVdvcmtlcihrZXkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgX3BvbGwoKSB7XHJcbiAgICAgICAgLy8gVE9ETzogY2hlY2sgaWYgd2UgbmVlZCB0byBmYWxsYmFjayBpZiBnZXRBbGwgaXMgbm90IHN1cHBvcnRlZFxyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuX3dpdGhSZXRyaWVzKChkYikgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBnZXRBbGxSZXF1ZXN0ID0gZ2V0T2JqZWN0U3RvcmUoZGIsIGZhbHNlKS5nZXRBbGwoKTtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBEQlByb21pc2UoZ2V0QWxsUmVxdWVzdCkudG9Qcm9taXNlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKCFyZXN1bHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBJZiB3ZSBoYXZlIHBlbmRpbmcgd3JpdGVzIGluIHByb2dyZXNzIGFib3J0LCB3ZSdsbCBnZXQgcGlja2VkIHVwIG9uIHRoZSBuZXh0IHBvbGxcclxuICAgICAgICBpZiAodGhpcy5wZW5kaW5nV3JpdGVzICE9PSAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3Qga2V5cyA9IFtdO1xyXG4gICAgICAgIGNvbnN0IGtleXNJblJlc3VsdCA9IG5ldyBTZXQoKTtcclxuICAgICAgICBmb3IgKGNvbnN0IHsgZmJhc2Vfa2V5OiBrZXksIHZhbHVlIH0gb2YgcmVzdWx0KSB7XHJcbiAgICAgICAgICAgIGtleXNJblJlc3VsdC5hZGQoa2V5KTtcclxuICAgICAgICAgICAgaWYgKEpTT04uc3RyaW5naWZ5KHRoaXMubG9jYWxDYWNoZVtrZXldKSAhPT0gSlNPTi5zdHJpbmdpZnkodmFsdWUpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeUxpc3RlbmVycyhrZXksIHZhbHVlKTtcclxuICAgICAgICAgICAgICAgIGtleXMucHVzaChrZXkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAoY29uc3QgbG9jYWxLZXkgb2YgT2JqZWN0LmtleXModGhpcy5sb2NhbENhY2hlKSkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5sb2NhbENhY2hlW2xvY2FsS2V5XSAmJiAha2V5c0luUmVzdWx0Lmhhcyhsb2NhbEtleSkpIHtcclxuICAgICAgICAgICAgICAgIC8vIERlbGV0ZWRcclxuICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5TGlzdGVuZXJzKGxvY2FsS2V5LCBudWxsKTtcclxuICAgICAgICAgICAgICAgIGtleXMucHVzaChsb2NhbEtleSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGtleXM7XHJcbiAgICB9XHJcbiAgICBub3RpZnlMaXN0ZW5lcnMoa2V5LCBuZXdWYWx1ZSkge1xyXG4gICAgICAgIHRoaXMubG9jYWxDYWNoZVtrZXldID0gbmV3VmFsdWU7XHJcbiAgICAgICAgY29uc3QgbGlzdGVuZXJzID0gdGhpcy5saXN0ZW5lcnNba2V5XTtcclxuICAgICAgICBpZiAobGlzdGVuZXJzKSB7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgbGlzdGVuZXIgb2YgQXJyYXkuZnJvbShsaXN0ZW5lcnMpKSB7XHJcbiAgICAgICAgICAgICAgICBsaXN0ZW5lcihuZXdWYWx1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBzdGFydFBvbGxpbmcoKSB7XHJcbiAgICAgICAgdGhpcy5zdG9wUG9sbGluZygpO1xyXG4gICAgICAgIHRoaXMucG9sbFRpbWVyID0gc2V0SW50ZXJ2YWwoYXN5bmMgKCkgPT4gdGhpcy5fcG9sbCgpLCBfUE9MTElOR19JTlRFUlZBTF9NUyk7XHJcbiAgICB9XHJcbiAgICBzdG9wUG9sbGluZygpIHtcclxuICAgICAgICBpZiAodGhpcy5wb2xsVGltZXIpIHtcclxuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnBvbGxUaW1lcik7XHJcbiAgICAgICAgICAgIHRoaXMucG9sbFRpbWVyID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBfYWRkTGlzdGVuZXIoa2V5LCBsaXN0ZW5lcikge1xyXG4gICAgICAgIGlmIChPYmplY3Qua2V5cyh0aGlzLmxpc3RlbmVycykubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3RhcnRQb2xsaW5nKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdGhpcy5saXN0ZW5lcnNba2V5XSkge1xyXG4gICAgICAgICAgICB0aGlzLmxpc3RlbmVyc1trZXldID0gbmV3IFNldCgpO1xyXG4gICAgICAgICAgICAvLyBQb3B1bGF0ZSB0aGUgY2FjaGUgdG8gYXZvaWQgc3B1cmlvdXNseSB0cmlnZ2VyaW5nIG9uIGZpcnN0IHBvbGwuXHJcbiAgICAgICAgICAgIHZvaWQgdGhpcy5fZ2V0KGtleSk7IC8vIFRoaXMgY2FuIGhhcHBlbiBpbiB0aGUgYmFja2dyb3VuZCBhc3luYyBhbmQgd2UgY2FuIHJldHVybiBpbW1lZGlhdGVseS5cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5saXN0ZW5lcnNba2V5XS5hZGQobGlzdGVuZXIpO1xyXG4gICAgfVxyXG4gICAgX3JlbW92ZUxpc3RlbmVyKGtleSwgbGlzdGVuZXIpIHtcclxuICAgICAgICBpZiAodGhpcy5saXN0ZW5lcnNba2V5XSkge1xyXG4gICAgICAgICAgICB0aGlzLmxpc3RlbmVyc1trZXldLmRlbGV0ZShsaXN0ZW5lcik7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmxpc3RlbmVyc1trZXldLnNpemUgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmxpc3RlbmVyc1trZXldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChPYmplY3Qua2V5cyh0aGlzLmxpc3RlbmVycykubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3RvcFBvbGxpbmcoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuSW5kZXhlZERCTG9jYWxQZXJzaXN0ZW5jZS50eXBlID0gJ0xPQ0FMJztcclxuLyoqXHJcbiAqIEFuIGltcGxlbWVudGF0aW9uIG9mIHtAbGluayBQZXJzaXN0ZW5jZX0gb2YgdHlwZSBgTE9DQUxgIHVzaW5nIGBpbmRleGVkREJgXHJcbiAqIGZvciB0aGUgdW5kZXJseWluZyBzdG9yYWdlLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5jb25zdCBpbmRleGVkREJMb2NhbFBlcnNpc3RlbmNlID0gSW5kZXhlZERCTG9jYWxQZXJzaXN0ZW5jZTtcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuZnVuY3Rpb24gc3RhcnRTaWduSW5QaG9uZU1mYShhdXRoLCByZXF1ZXN0KSB7XHJcbiAgICByZXR1cm4gX3BlcmZvcm1BcGlSZXF1ZXN0KGF1dGgsIFwiUE9TVFwiIC8qIFBPU1QgKi8sIFwiL3YyL2FjY291bnRzL21mYVNpZ25JbjpzdGFydFwiIC8qIFNUQVJUX1BIT05FX01GQV9TSUdOX0lOICovLCBPYmplY3QuYXNzaWduKHsgdGVuYW50SWQ6IGF1dGgudGVuYW50SWQgfSwgcmVxdWVzdCkpO1xyXG59XHJcbmZ1bmN0aW9uIGZpbmFsaXplU2lnbkluUGhvbmVNZmEoYXV0aCwgcmVxdWVzdCkge1xyXG4gICAgcmV0dXJuIF9wZXJmb3JtQXBpUmVxdWVzdChhdXRoLCBcIlBPU1RcIiAvKiBQT1NUICovLCBcIi92Mi9hY2NvdW50cy9tZmFTaWduSW46ZmluYWxpemVcIiAvKiBGSU5BTElaRV9QSE9ORV9NRkFfU0lHTl9JTiAqLywgT2JqZWN0LmFzc2lnbih7IHRlbmFudElkOiBhdXRoLnRlbmFudElkIH0sIHJlcXVlc3QpKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBnZXRSZWNhcHRjaGFQYXJhbXMoYXV0aCkge1xyXG4gICAgcmV0dXJuICgoYXdhaXQgX3BlcmZvcm1BcGlSZXF1ZXN0KGF1dGgsIFwiR0VUXCIgLyogR0VUICovLCBcIi92MS9yZWNhcHRjaGFQYXJhbXNcIiAvKiBHRVRfUkVDQVBUQ0hBX1BBUkFNICovKSkucmVjYXB0Y2hhU2l0ZUtleSB8fCAnJyk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuZnVuY3Rpb24gZ2V0U2NyaXB0UGFyZW50RWxlbWVudCgpIHtcclxuICAgIHZhciBfYSwgX2I7XHJcbiAgICByZXR1cm4gKF9iID0gKF9hID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2hlYWQnKSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hWzBdKSAhPT0gbnVsbCAmJiBfYiAhPT0gdm9pZCAwID8gX2IgOiBkb2N1bWVudDtcclxufVxyXG5mdW5jdGlvbiBfbG9hZEpTKHVybCkge1xyXG4gICAgLy8gVE9ETzogY29uc2lkZXIgYWRkaW5nIHRpbWVvdXQgc3VwcG9ydCAmIGNhbmNlbGxhdGlvblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICBjb25zdCBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpO1xyXG4gICAgICAgIGVsLnNldEF0dHJpYnV0ZSgnc3JjJywgdXJsKTtcclxuICAgICAgICBlbC5vbmxvYWQgPSByZXNvbHZlO1xyXG4gICAgICAgIGVsLm9uZXJyb3IgPSBlID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZXJyb3IgPSBfY3JlYXRlRXJyb3IoXCJpbnRlcm5hbC1lcnJvclwiIC8qIElOVEVSTkFMX0VSUk9SICovKTtcclxuICAgICAgICAgICAgZXJyb3IuY3VzdG9tRGF0YSA9IGU7XHJcbiAgICAgICAgICAgIHJlamVjdChlcnJvcik7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBlbC50eXBlID0gJ3RleHQvamF2YXNjcmlwdCc7XHJcbiAgICAgICAgZWwuY2hhcnNldCA9ICdVVEYtOCc7XHJcbiAgICAgICAgZ2V0U2NyaXB0UGFyZW50RWxlbWVudCgpLmFwcGVuZENoaWxkKGVsKTtcclxuICAgIH0pO1xyXG59XHJcbmZ1bmN0aW9uIF9nZW5lcmF0ZUNhbGxiYWNrTmFtZShwcmVmaXgpIHtcclxuICAgIHJldHVybiBgX18ke3ByZWZpeH0ke01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDAwMDApfWA7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuY29uc3QgX1NPTFZFX1RJTUVfTVMgPSA1MDA7XHJcbmNvbnN0IF9FWFBJUkFUSU9OX1RJTUVfTVMgPSA2MDAwMDtcclxuY29uc3QgX1dJREdFVF9JRF9TVEFSVCA9IDEwMDAwMDAwMDAwMDA7XHJcbmNsYXNzIE1vY2tSZUNhcHRjaGEge1xyXG4gICAgY29uc3RydWN0b3IoYXV0aCkge1xyXG4gICAgICAgIHRoaXMuYXV0aCA9IGF1dGg7XHJcbiAgICAgICAgdGhpcy5jb3VudGVyID0gX1dJREdFVF9JRF9TVEFSVDtcclxuICAgICAgICB0aGlzLl93aWRnZXRzID0gbmV3IE1hcCgpO1xyXG4gICAgfVxyXG4gICAgcmVuZGVyKGNvbnRhaW5lciwgcGFyYW1ldGVycykge1xyXG4gICAgICAgIGNvbnN0IGlkID0gdGhpcy5jb3VudGVyO1xyXG4gICAgICAgIHRoaXMuX3dpZGdldHMuc2V0KGlkLCBuZXcgTW9ja1dpZGdldChjb250YWluZXIsIHRoaXMuYXV0aC5uYW1lLCBwYXJhbWV0ZXJzIHx8IHt9KSk7XHJcbiAgICAgICAgdGhpcy5jb3VudGVyKys7XHJcbiAgICAgICAgcmV0dXJuIGlkO1xyXG4gICAgfVxyXG4gICAgcmVzZXQob3B0V2lkZ2V0SWQpIHtcclxuICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgY29uc3QgaWQgPSBvcHRXaWRnZXRJZCB8fCBfV0lER0VUX0lEX1NUQVJUO1xyXG4gICAgICAgIHZvaWQgKChfYSA9IHRoaXMuX3dpZGdldHMuZ2V0KGlkKSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmRlbGV0ZSgpKTtcclxuICAgICAgICB0aGlzLl93aWRnZXRzLmRlbGV0ZShpZCk7XHJcbiAgICB9XHJcbiAgICBnZXRSZXNwb25zZShvcHRXaWRnZXRJZCkge1xyXG4gICAgICAgIHZhciBfYTtcclxuICAgICAgICBjb25zdCBpZCA9IG9wdFdpZGdldElkIHx8IF9XSURHRVRfSURfU1RBUlQ7XHJcbiAgICAgICAgcmV0dXJuICgoX2EgPSB0aGlzLl93aWRnZXRzLmdldChpZCkpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5nZXRSZXNwb25zZSgpKSB8fCAnJztcclxuICAgIH1cclxuICAgIGFzeW5jIGV4ZWN1dGUob3B0V2lkZ2V0SWQpIHtcclxuICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgY29uc3QgaWQgPSBvcHRXaWRnZXRJZCB8fCBfV0lER0VUX0lEX1NUQVJUO1xyXG4gICAgICAgIHZvaWQgKChfYSA9IHRoaXMuX3dpZGdldHMuZ2V0KGlkKSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmV4ZWN1dGUoKSk7XHJcbiAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgfVxyXG59XHJcbmNsYXNzIE1vY2tXaWRnZXQge1xyXG4gICAgY29uc3RydWN0b3IoY29udGFpbmVyT3JJZCwgYXBwTmFtZSwgcGFyYW1zKSB7XHJcbiAgICAgICAgdGhpcy5wYXJhbXMgPSBwYXJhbXM7XHJcbiAgICAgICAgdGhpcy50aW1lcklkID0gbnVsbDtcclxuICAgICAgICB0aGlzLmRlbGV0ZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnJlc3BvbnNlVG9rZW4gPSBudWxsO1xyXG4gICAgICAgIHRoaXMuY2xpY2tIYW5kbGVyID0gKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmV4ZWN1dGUoKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IHR5cGVvZiBjb250YWluZXJPcklkID09PSAnc3RyaW5nJ1xyXG4gICAgICAgICAgICA/IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNvbnRhaW5lck9ySWQpXHJcbiAgICAgICAgICAgIDogY29udGFpbmVyT3JJZDtcclxuICAgICAgICBfYXNzZXJ0KGNvbnRhaW5lciwgXCJhcmd1bWVudC1lcnJvclwiIC8qIEFSR1VNRU5UX0VSUk9SICovLCB7IGFwcE5hbWUgfSk7XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIgPSBjb250YWluZXI7XHJcbiAgICAgICAgdGhpcy5pc1Zpc2libGUgPSB0aGlzLnBhcmFtcy5zaXplICE9PSAnaW52aXNpYmxlJztcclxuICAgICAgICBpZiAodGhpcy5pc1Zpc2libGUpIHtcclxuICAgICAgICAgICAgdGhpcy5leGVjdXRlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuY2xpY2tIYW5kbGVyKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBnZXRSZXNwb25zZSgpIHtcclxuICAgICAgICB0aGlzLmNoZWNrSWZEZWxldGVkKCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmVzcG9uc2VUb2tlbjtcclxuICAgIH1cclxuICAgIGRlbGV0ZSgpIHtcclxuICAgICAgICB0aGlzLmNoZWNrSWZEZWxldGVkKCk7XHJcbiAgICAgICAgdGhpcy5kZWxldGVkID0gdHJ1ZTtcclxuICAgICAgICBpZiAodGhpcy50aW1lcklkKSB7XHJcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVySWQpO1xyXG4gICAgICAgICAgICB0aGlzLnRpbWVySWQgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNvbnRhaW5lci5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuY2xpY2tIYW5kbGVyKTtcclxuICAgIH1cclxuICAgIGV4ZWN1dGUoKSB7XHJcbiAgICAgICAgdGhpcy5jaGVja0lmRGVsZXRlZCgpO1xyXG4gICAgICAgIGlmICh0aGlzLnRpbWVySWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnRpbWVySWQgPSB3aW5kb3cuc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucmVzcG9uc2VUb2tlbiA9IGdlbmVyYXRlUmFuZG9tQWxwaGFOdW1lcmljU3RyaW5nKDUwKTtcclxuICAgICAgICAgICAgY29uc3QgeyBjYWxsYmFjaywgJ2V4cGlyZWQtY2FsbGJhY2snOiBleHBpcmVkQ2FsbGJhY2sgfSA9IHRoaXMucGFyYW1zO1xyXG4gICAgICAgICAgICBpZiAoY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sodGhpcy5yZXNwb25zZVRva2VuKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7IH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnRpbWVySWQgPSB3aW5kb3cuc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRpbWVySWQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZXNwb25zZVRva2VuID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGlmIChleHBpcmVkQ2FsbGJhY2spIHtcclxuICAgICAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBleHBpcmVkQ2FsbGJhY2soKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHsgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNWaXNpYmxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5leGVjdXRlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIF9FWFBJUkFUSU9OX1RJTUVfTVMpO1xyXG4gICAgICAgIH0sIF9TT0xWRV9USU1FX01TKTtcclxuICAgIH1cclxuICAgIGNoZWNrSWZEZWxldGVkKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmRlbGV0ZWQpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdyZUNBUFRDSEEgbW9jayB3YXMgYWxyZWFkeSBkZWxldGVkIScpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBnZW5lcmF0ZVJhbmRvbUFscGhhTnVtZXJpY1N0cmluZyhsZW4pIHtcclxuICAgIGNvbnN0IGNoYXJzID0gW107XHJcbiAgICBjb25zdCBhbGxvd2VkQ2hhcnMgPSAnMTIzNDU2Nzg5MGFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVonO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgIGNoYXJzLnB1c2goYWxsb3dlZENoYXJzLmNoYXJBdChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBhbGxvd2VkQ2hhcnMubGVuZ3RoKSkpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGNoYXJzLmpvaW4oJycpO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8vIFJlQ2FwdGNoYSB3aWxsIGxvYWQgdXNpbmcgdGhlIHNhbWUgY2FsbGJhY2ssIHNvIHRoZSBjYWxsYmFjayBmdW5jdGlvbiBuZWVkc1xyXG4vLyB0byBiZSBrZXB0IGFyb3VuZFxyXG5jb25zdCBfSlNMT0FEX0NBTExCQUNLID0gX2dlbmVyYXRlQ2FsbGJhY2tOYW1lKCdyY2InKTtcclxuY29uc3QgTkVUV09SS19USU1FT1VUX0RFTEFZID0gbmV3IERlbGF5KDMwMDAwLCA2MDAwMCk7XHJcbmNvbnN0IFJFQ0FQVENIQV9CQVNFID0gJ2h0dHBzOi8vd3d3Lmdvb2dsZS5jb20vcmVjYXB0Y2hhL2FwaS5qcz8nO1xyXG4vKipcclxuICogTG9hZGVyIGZvciB0aGUgR1JlQ2FwdGNoYSBsaWJyYXJ5LiBUaGVyZSBzaG91bGQgb25seSBldmVyIGJlIG9uZSBvZiB0aGlzLlxyXG4gKi9cclxuY2xhc3MgUmVDYXB0Y2hhTG9hZGVySW1wbCB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLmhvc3RMYW5ndWFnZSA9ICcnO1xyXG4gICAgICAgIHRoaXMuY291bnRlciA9IDA7XHJcbiAgICAgICAgdGhpcy5saWJyYXJ5U2VwYXJhdGVseUxvYWRlZCA9ICEhX3dpbmRvdygpLmdyZWNhcHRjaGE7XHJcbiAgICB9XHJcbiAgICBsb2FkKGF1dGgsIGhsID0gJycpIHtcclxuICAgICAgICBfYXNzZXJ0KGlzSG9zdExhbmd1YWdlVmFsaWQoaGwpLCBhdXRoLCBcImFyZ3VtZW50LWVycm9yXCIgLyogQVJHVU1FTlRfRVJST1IgKi8pO1xyXG4gICAgICAgIGlmICh0aGlzLnNob3VsZFJlc29sdmVJbW1lZGlhdGVseShobCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShfd2luZG93KCkuZ3JlY2FwdGNoYSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5ldHdvcmtUaW1lb3V0ID0gX3dpbmRvdygpLnNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmVqZWN0KF9jcmVhdGVFcnJvcihhdXRoLCBcIm5ldHdvcmstcmVxdWVzdC1mYWlsZWRcIiAvKiBORVRXT1JLX1JFUVVFU1RfRkFJTEVEICovKSk7XHJcbiAgICAgICAgICAgIH0sIE5FVFdPUktfVElNRU9VVF9ERUxBWS5nZXQoKSk7XHJcbiAgICAgICAgICAgIF93aW5kb3coKVtfSlNMT0FEX0NBTExCQUNLXSA9ICgpID0+IHtcclxuICAgICAgICAgICAgICAgIF93aW5kb3coKS5jbGVhclRpbWVvdXQobmV0d29ya1RpbWVvdXQpO1xyXG4gICAgICAgICAgICAgICAgZGVsZXRlIF93aW5kb3coKVtfSlNMT0FEX0NBTExCQUNLXTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHJlY2FwdGNoYSA9IF93aW5kb3coKS5ncmVjYXB0Y2hhO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFyZWNhcHRjaGEpIHtcclxuICAgICAgICAgICAgICAgICAgICByZWplY3QoX2NyZWF0ZUVycm9yKGF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLykpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIFdyYXAgdGhlIGdyZXB0Y2hhIHJlbmRlciBmdW5jdGlvbiBzbyB0aGF0IHdlIGtub3cgaWYgdGhlIGRldmVsb3BlciBoYXNcclxuICAgICAgICAgICAgICAgIC8vIGNhbGxlZCBpdCBzZXBhcmF0ZWx5XHJcbiAgICAgICAgICAgICAgICBjb25zdCByZW5kZXIgPSByZWNhcHRjaGEucmVuZGVyO1xyXG4gICAgICAgICAgICAgICAgcmVjYXB0Y2hhLnJlbmRlciA9IChjb250YWluZXIsIHBhcmFtcykgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHdpZGdldElkID0gcmVuZGVyKGNvbnRhaW5lciwgcGFyYW1zKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvdW50ZXIrKztcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gd2lkZ2V0SWQ7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ob3N0TGFuZ3VhZ2UgPSBobDtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUocmVjYXB0Y2hhKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgY29uc3QgdXJsID0gYCR7UkVDQVBUQ0hBX0JBU0V9PyR7cXVlcnlzdHJpbmcoe1xyXG4gICAgICAgICAgICAgICAgb25sb2FkOiBfSlNMT0FEX0NBTExCQUNLLFxyXG4gICAgICAgICAgICAgICAgcmVuZGVyOiAnZXhwbGljaXQnLFxyXG4gICAgICAgICAgICAgICAgaGxcclxuICAgICAgICAgICAgfSl9YDtcclxuICAgICAgICAgICAgX2xvYWRKUyh1cmwpLmNhdGNoKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dChuZXR3b3JrVGltZW91dCk7XHJcbiAgICAgICAgICAgICAgICByZWplY3QoX2NyZWF0ZUVycm9yKGF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLykpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGNsZWFyZWRPbmVJbnN0YW5jZSgpIHtcclxuICAgICAgICB0aGlzLmNvdW50ZXItLTtcclxuICAgIH1cclxuICAgIHNob3VsZFJlc29sdmVJbW1lZGlhdGVseShobCkge1xyXG4gICAgICAgIC8vIFdlIGNhbiByZXNvbHZlIGltbWVkaWF0ZWx5IGlmOlxyXG4gICAgICAgIC8vICAg4oCiIGdyZWNhcHRjaGEgaXMgYWxyZWFkeSBkZWZpbmVkIEFORCAoXHJcbiAgICAgICAgLy8gICAgIDEuIHRoZSByZXF1ZXN0ZWQgbGFuZ3VhZ2UgY29kZXMgYXJlIHRoZSBzYW1lIE9SXHJcbiAgICAgICAgLy8gICAgIDIuIHRoZXJlIGV4aXN0cyBhbHJlYWR5IGEgUmVDYXB0Y2hhIG9uIHRoZSBwYWdlXHJcbiAgICAgICAgLy8gICAgIDMuIHRoZSBsaWJyYXJ5IHdhcyBhbHJlYWR5IGxvYWRlZCBieSB0aGUgYXBwXHJcbiAgICAgICAgLy8gSW4gY2FzZXMgKDIpIGFuZCAoMyksIHdlIF9jYW4ndF8gcmVsb2FkIGFzIGl0IHdvdWxkIGJyZWFrIHRoZSByZWNhcHRjaGFzXHJcbiAgICAgICAgLy8gdGhhdCBhcmUgYWxyZWFkeSBpbiB0aGUgcGFnZVxyXG4gICAgICAgIHJldHVybiAoISFfd2luZG93KCkuZ3JlY2FwdGNoYSAmJlxyXG4gICAgICAgICAgICAoaGwgPT09IHRoaXMuaG9zdExhbmd1YWdlIHx8XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvdW50ZXIgPiAwIHx8XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpYnJhcnlTZXBhcmF0ZWx5TG9hZGVkKSk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gaXNIb3N0TGFuZ3VhZ2VWYWxpZChobCkge1xyXG4gICAgcmV0dXJuIGhsLmxlbmd0aCA8PSA2ICYmIC9eXFxzKlthLXpBLVowLTlcXC1dKlxccyokLy50ZXN0KGhsKTtcclxufVxyXG5jbGFzcyBNb2NrUmVDYXB0Y2hhTG9hZGVySW1wbCB7XHJcbiAgICBhc3luYyBsb2FkKGF1dGgpIHtcclxuICAgICAgICByZXR1cm4gbmV3IE1vY2tSZUNhcHRjaGEoYXV0aCk7XHJcbiAgICB9XHJcbiAgICBjbGVhcmVkT25lSW5zdGFuY2UoKSB7IH1cclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jb25zdCBSRUNBUFRDSEFfVkVSSUZJRVJfVFlQRSA9ICdyZWNhcHRjaGEnO1xyXG5jb25zdCBERUZBVUxUX1BBUkFNUyA9IHtcclxuICAgIHRoZW1lOiAnbGlnaHQnLFxyXG4gICAgdHlwZTogJ2ltYWdlJ1xyXG59O1xyXG4vKipcclxuICogQW4ge0BsaW5rIGh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vcmVjYXB0Y2hhLyB8IHJlQ0FQVENIQX0tYmFzZWQgYXBwbGljYXRpb24gdmVyaWZpZXIuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmNsYXNzIFJlY2FwdGNoYVZlcmlmaWVyIHtcclxuICAgIC8qKlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBjb250YWluZXJPcklkIC0gVGhlIHJlQ0FQVENIQSBjb250YWluZXIgcGFyYW1ldGVyLlxyXG4gICAgICpcclxuICAgICAqIEByZW1hcmtzXHJcbiAgICAgKiBUaGlzIGhhcyBkaWZmZXJlbnQgbWVhbmluZyBkZXBlbmRpbmcgb24gd2hldGhlciB0aGUgcmVDQVBUQ0hBIGlzIGhpZGRlbiBvciB2aXNpYmxlLiBGb3IgYVxyXG4gICAgICogdmlzaWJsZSByZUNBUFRDSEEgdGhlIGNvbnRhaW5lciBtdXN0IGJlIGVtcHR5LiBJZiBhIHN0cmluZyBpcyB1c2VkLCBpdCBoYXMgdG8gY29ycmVzcG9uZCB0b1xyXG4gICAgICogYW4gZWxlbWVudCBJRC4gVGhlIGNvcnJlc3BvbmRpbmcgZWxlbWVudCBtdXN0IGFsc28gbXVzdCBiZSBpbiB0aGUgRE9NIGF0IHRoZSB0aW1lIG9mXHJcbiAgICAgKiBpbml0aWFsaXphdGlvbi5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gcGFyYW1ldGVycyAtIFRoZSBvcHRpb25hbCByZUNBUFRDSEEgcGFyYW1ldGVycy5cclxuICAgICAqXHJcbiAgICAgKiBAcmVtYXJrc1xyXG4gICAgICogQ2hlY2sgdGhlIHJlQ0FQVENIQSBkb2NzIGZvciBhIGNvbXByZWhlbnNpdmUgbGlzdC4gQWxsIHBhcmFtZXRlcnMgYXJlIGFjY2VwdGVkIGV4Y2VwdCBmb3JcclxuICAgICAqIHRoZSBzaXRla2V5LiBGaXJlYmFzZSBBdXRoIGJhY2tlbmQgcHJvdmlzaW9ucyBhIHJlQ0FQVENIQSBmb3IgZWFjaCBwcm9qZWN0IGFuZCB3aWxsXHJcbiAgICAgKiBjb25maWd1cmUgdGhpcyB1cG9uIHJlbmRlcmluZy4gRm9yIGFuIGludmlzaWJsZSByZUNBUFRDSEEsIGEgc2l6ZSBrZXkgbXVzdCBoYXZlIHRoZSB2YWx1ZVxyXG4gICAgICogJ2ludmlzaWJsZScuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGF1dGhFeHRlcm4gLSBUaGUgY29ycmVzcG9uZGluZyBGaXJlYmFzZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXHJcbiAgICAgKlxyXG4gICAgICogQHJlbWFya3NcclxuICAgICAqIElmIG5vbmUgaXMgcHJvdmlkZWQsIHRoZSBkZWZhdWx0IEZpcmViYXNlIHtAbGluayBBdXRofSBpbnN0YW5jZSBpcyB1c2VkLiBBIEZpcmViYXNlIHtAbGluayBBdXRofSBpbnN0YW5jZVxyXG4gICAgICogbXVzdCBiZSBpbml0aWFsaXplZCB3aXRoIGFuIEFQSSBrZXksIG90aGVyd2lzZSBhbiBlcnJvciB3aWxsIGJlIHRocm93bi5cclxuICAgICAqL1xyXG4gICAgY29uc3RydWN0b3IoY29udGFpbmVyT3JJZCwgcGFyYW1ldGVycyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfUEFSQU1TKSwgYXV0aEV4dGVybikge1xyXG4gICAgICAgIHRoaXMucGFyYW1ldGVycyA9IHBhcmFtZXRlcnM7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIGFwcGxpY2F0aW9uIHZlcmlmaWVyIHR5cGUuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVtYXJrc1xyXG4gICAgICAgICAqIEZvciBhIHJlQ0FQVENIQSB2ZXJpZmllciwgdGhpcyBpcyAncmVjYXB0Y2hhJy5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLnR5cGUgPSBSRUNBUFRDSEFfVkVSSUZJRVJfVFlQRTtcclxuICAgICAgICB0aGlzLmRlc3Ryb3llZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMud2lkZ2V0SWQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMudG9rZW5DaGFuZ2VMaXN0ZW5lcnMgPSBuZXcgU2V0KCk7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJQcm9taXNlID0gbnVsbDtcclxuICAgICAgICB0aGlzLnJlY2FwdGNoYSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5hdXRoID0gX2Nhc3RBdXRoKGF1dGhFeHRlcm4pO1xyXG4gICAgICAgIHRoaXMuaXNJbnZpc2libGUgPSB0aGlzLnBhcmFtZXRlcnMuc2l6ZSA9PT0gJ2ludmlzaWJsZSc7XHJcbiAgICAgICAgX2Fzc2VydCh0eXBlb2YgZG9jdW1lbnQgIT09ICd1bmRlZmluZWQnLCB0aGlzLmF1dGgsIFwib3BlcmF0aW9uLW5vdC1zdXBwb3J0ZWQtaW4tdGhpcy1lbnZpcm9ubWVudFwiIC8qIE9QRVJBVElPTl9OT1RfU1VQUE9SVEVEICovKTtcclxuICAgICAgICBjb25zdCBjb250YWluZXIgPSB0eXBlb2YgY29udGFpbmVyT3JJZCA9PT0gJ3N0cmluZydcclxuICAgICAgICAgICAgPyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb250YWluZXJPcklkKVxyXG4gICAgICAgICAgICA6IGNvbnRhaW5lck9ySWQ7XHJcbiAgICAgICAgX2Fzc2VydChjb250YWluZXIsIHRoaXMuYXV0aCwgXCJhcmd1bWVudC1lcnJvclwiIC8qIEFSR1VNRU5UX0VSUk9SICovKTtcclxuICAgICAgICB0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcclxuICAgICAgICB0aGlzLnBhcmFtZXRlcnMuY2FsbGJhY2sgPSB0aGlzLm1ha2VUb2tlbkNhbGxiYWNrKHRoaXMucGFyYW1ldGVycy5jYWxsYmFjayk7XHJcbiAgICAgICAgdGhpcy5fcmVjYXB0Y2hhTG9hZGVyID0gdGhpcy5hdXRoLnNldHRpbmdzLmFwcFZlcmlmaWNhdGlvbkRpc2FibGVkRm9yVGVzdGluZ1xyXG4gICAgICAgICAgICA/IG5ldyBNb2NrUmVDYXB0Y2hhTG9hZGVySW1wbCgpXHJcbiAgICAgICAgICAgIDogbmV3IFJlQ2FwdGNoYUxvYWRlckltcGwoKTtcclxuICAgICAgICB0aGlzLnZhbGlkYXRlU3RhcnRpbmdTdGF0ZSgpO1xyXG4gICAgICAgIC8vIFRPRE86IEZpZ3VyZSBvdXQgaWYgc2RrIHZlcnNpb24gaXMgbmVlZGVkXHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFdhaXRzIGZvciB0aGUgdXNlciB0byBzb2x2ZSB0aGUgcmVDQVBUQ0hBIGFuZCByZXNvbHZlcyB3aXRoIHRoZSByZUNBUFRDSEEgdG9rZW4uXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybnMgQSBQcm9taXNlIGZvciB0aGUgcmVDQVBUQ0hBIHRva2VuLlxyXG4gICAgICovXHJcbiAgICBhc3luYyB2ZXJpZnkoKSB7XHJcbiAgICAgICAgdGhpcy5hc3NlcnROb3REZXN0cm95ZWQoKTtcclxuICAgICAgICBjb25zdCBpZCA9IGF3YWl0IHRoaXMucmVuZGVyKCk7XHJcbiAgICAgICAgY29uc3QgcmVjYXB0Y2hhID0gdGhpcy5nZXRBc3NlcnRlZFJlY2FwdGNoYSgpO1xyXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gcmVjYXB0Y2hhLmdldFJlc3BvbnNlKGlkKTtcclxuICAgICAgICBpZiAocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRva2VuQ2hhbmdlID0gKHRva2VuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRva2VuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOyAvLyBJZ25vcmUgdG9rZW4gZXhwaXJhdGlvbnMuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRva2VuQ2hhbmdlTGlzdGVuZXJzLmRlbGV0ZSh0b2tlbkNoYW5nZSk7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKHRva2VuKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdGhpcy50b2tlbkNoYW5nZUxpc3RlbmVycy5hZGQodG9rZW5DaGFuZ2UpO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5pc0ludmlzaWJsZSkge1xyXG4gICAgICAgICAgICAgICAgcmVjYXB0Y2hhLmV4ZWN1dGUoaWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFJlbmRlcnMgdGhlIHJlQ0FQVENIQSB3aWRnZXQgb24gdGhlIHBhZ2UuXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybnMgQSBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgd2l0aCB0aGUgcmVDQVBUQ0hBIHdpZGdldCBJRC5cclxuICAgICAqL1xyXG4gICAgcmVuZGVyKCkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHRoaXMuYXNzZXJ0Tm90RGVzdHJveWVkKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIC8vIFRoaXMgbWV0aG9kIHJldHVybnMgYSBwcm9taXNlLiBTaW5jZSBpdCdzIG5vdCBhc3luYyAod2Ugd2FudCB0byByZXR1cm4gdGhlXHJcbiAgICAgICAgICAgIC8vIF9zYW1lXyBwcm9taXNlIGlmIHJlbmRlcmluZyBpcyBzdGlsbCBvY2N1cnJpbmcpLCB0aGUgQVBJIHN1cmZhY2Ugc2hvdWxkXHJcbiAgICAgICAgICAgIC8vIHJlamVjdCB3aXRoIHRoZSBlcnJvciByYXRoZXIgdGhhbiBqdXN0IHRocm93XHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMucmVuZGVyUHJvbWlzZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZW5kZXJQcm9taXNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnJlbmRlclByb21pc2UgPSB0aGlzLm1ha2VSZW5kZXJQcm9taXNlKCkuY2F0Y2goZSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyUHJvbWlzZSA9IG51bGw7XHJcbiAgICAgICAgICAgIHRocm93IGU7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmVuZGVyUHJvbWlzZTtcclxuICAgIH1cclxuICAgIC8qKiBAaW50ZXJuYWwgKi9cclxuICAgIF9yZXNldCgpIHtcclxuICAgICAgICB0aGlzLmFzc2VydE5vdERlc3Ryb3llZCgpO1xyXG4gICAgICAgIGlmICh0aGlzLndpZGdldElkICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0QXNzZXJ0ZWRSZWNhcHRjaGEoKS5yZXNldCh0aGlzLndpZGdldElkKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIENsZWFycyB0aGUgcmVDQVBUQ0hBIHdpZGdldCBmcm9tIHRoZSBwYWdlIGFuZCBkZXN0cm95cyB0aGUgaW5zdGFuY2UuXHJcbiAgICAgKi9cclxuICAgIGNsZWFyKCkge1xyXG4gICAgICAgIHRoaXMuYXNzZXJ0Tm90RGVzdHJveWVkKCk7XHJcbiAgICAgICAgdGhpcy5kZXN0cm95ZWQgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuX3JlY2FwdGNoYUxvYWRlci5jbGVhcmVkT25lSW5zdGFuY2UoKTtcclxuICAgICAgICBpZiAoIXRoaXMuaXNJbnZpc2libGUpIHtcclxuICAgICAgICAgICAgdGhpcy5jb250YWluZXIuY2hpbGROb2Rlcy5mb3JFYWNoKG5vZGUgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb250YWluZXIucmVtb3ZlQ2hpbGQobm9kZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHZhbGlkYXRlU3RhcnRpbmdTdGF0ZSgpIHtcclxuICAgICAgICBfYXNzZXJ0KCF0aGlzLnBhcmFtZXRlcnMuc2l0ZWtleSwgdGhpcy5hdXRoLCBcImFyZ3VtZW50LWVycm9yXCIgLyogQVJHVU1FTlRfRVJST1IgKi8pO1xyXG4gICAgICAgIF9hc3NlcnQodGhpcy5pc0ludmlzaWJsZSB8fCAhdGhpcy5jb250YWluZXIuaGFzQ2hpbGROb2RlcygpLCB0aGlzLmF1dGgsIFwiYXJndW1lbnQtZXJyb3JcIiAvKiBBUkdVTUVOVF9FUlJPUiAqLyk7XHJcbiAgICAgICAgX2Fzc2VydCh0eXBlb2YgZG9jdW1lbnQgIT09ICd1bmRlZmluZWQnLCB0aGlzLmF1dGgsIFwib3BlcmF0aW9uLW5vdC1zdXBwb3J0ZWQtaW4tdGhpcy1lbnZpcm9ubWVudFwiIC8qIE9QRVJBVElPTl9OT1RfU1VQUE9SVEVEICovKTtcclxuICAgIH1cclxuICAgIG1ha2VUb2tlbkNhbGxiYWNrKGV4aXN0aW5nKSB7XHJcbiAgICAgICAgcmV0dXJuIHRva2VuID0+IHtcclxuICAgICAgICAgICAgdGhpcy50b2tlbkNoYW5nZUxpc3RlbmVycy5mb3JFYWNoKGxpc3RlbmVyID0+IGxpc3RlbmVyKHRva2VuKSk7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZXhpc3RpbmcgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgICAgIGV4aXN0aW5nKHRva2VuKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgZXhpc3RpbmcgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBnbG9iYWxGdW5jID0gX3dpbmRvdygpW2V4aXN0aW5nXTtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZ2xvYmFsRnVuYyA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGdsb2JhbEZ1bmModG9rZW4pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuICAgIGFzc2VydE5vdERlc3Ryb3llZCgpIHtcclxuICAgICAgICBfYXNzZXJ0KCF0aGlzLmRlc3Ryb3llZCwgdGhpcy5hdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8pO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgbWFrZVJlbmRlclByb21pc2UoKSB7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5pbml0KCk7XHJcbiAgICAgICAgaWYgKCF0aGlzLndpZGdldElkKSB7XHJcbiAgICAgICAgICAgIGxldCBjb250YWluZXIgPSB0aGlzLmNvbnRhaW5lcjtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLmlzSW52aXNpYmxlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBndWFyYW50ZWVkRW1wdHkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChndWFyYW50ZWVkRW1wdHkpO1xyXG4gICAgICAgICAgICAgICAgY29udGFpbmVyID0gZ3VhcmFudGVlZEVtcHR5O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMud2lkZ2V0SWQgPSB0aGlzLmdldEFzc2VydGVkUmVjYXB0Y2hhKCkucmVuZGVyKGNvbnRhaW5lciwgdGhpcy5wYXJhbWV0ZXJzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMud2lkZ2V0SWQ7XHJcbiAgICB9XHJcbiAgICBhc3luYyBpbml0KCkge1xyXG4gICAgICAgIF9hc3NlcnQoX2lzSHR0cE9ySHR0cHMoKSAmJiAhX2lzV29ya2VyKCksIHRoaXMuYXV0aCwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIElOVEVSTkFMX0VSUk9SICovKTtcclxuICAgICAgICBhd2FpdCBkb21SZWFkeSgpO1xyXG4gICAgICAgIHRoaXMucmVjYXB0Y2hhID0gYXdhaXQgdGhpcy5fcmVjYXB0Y2hhTG9hZGVyLmxvYWQodGhpcy5hdXRoLCB0aGlzLmF1dGgubGFuZ3VhZ2VDb2RlIHx8IHVuZGVmaW5lZCk7XHJcbiAgICAgICAgY29uc3Qgc2l0ZUtleSA9IGF3YWl0IGdldFJlY2FwdGNoYVBhcmFtcyh0aGlzLmF1dGgpO1xyXG4gICAgICAgIF9hc3NlcnQoc2l0ZUtleSwgdGhpcy5hdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8pO1xyXG4gICAgICAgIHRoaXMucGFyYW1ldGVycy5zaXRla2V5ID0gc2l0ZUtleTtcclxuICAgIH1cclxuICAgIGdldEFzc2VydGVkUmVjYXB0Y2hhKCkge1xyXG4gICAgICAgIF9hc3NlcnQodGhpcy5yZWNhcHRjaGEsIHRoaXMuYXV0aCwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIElOVEVSTkFMX0VSUk9SICovKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5yZWNhcHRjaGE7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gZG9tUmVhZHkoKSB7XHJcbiAgICBsZXQgcmVzb2x2ZXIgPSBudWxsO1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xyXG4gICAgICAgIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlID09PSAnY29tcGxldGUnKSB7XHJcbiAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBEb2N1bWVudCBub3QgcmVhZHksIHdhaXQgZm9yIGxvYWQgYmVmb3JlIHJlc29sdmluZy5cclxuICAgICAgICAvLyBTYXZlIHJlc29sdmVyLCBzbyB3ZSBjYW4gcmVtb3ZlIGxpc3RlbmVyIGluIGNhc2UgaXQgd2FzIGV4dGVybmFsbHlcclxuICAgICAgICAvLyBjYW5jZWxsZWQuXHJcbiAgICAgICAgcmVzb2x2ZXIgPSAoKSA9PiByZXNvbHZlKCk7XHJcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCByZXNvbHZlcik7XHJcbiAgICB9KS5jYXRjaChlID0+IHtcclxuICAgICAgICBpZiAocmVzb2x2ZXIpIHtcclxuICAgICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2xvYWQnLCByZXNvbHZlcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRocm93IGU7XHJcbiAgICB9KTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jbGFzcyBDb25maXJtYXRpb25SZXN1bHRJbXBsIHtcclxuICAgIGNvbnN0cnVjdG9yKHZlcmlmaWNhdGlvbklkLCBvbkNvbmZpcm1hdGlvbikge1xyXG4gICAgICAgIHRoaXMudmVyaWZpY2F0aW9uSWQgPSB2ZXJpZmljYXRpb25JZDtcclxuICAgICAgICB0aGlzLm9uQ29uZmlybWF0aW9uID0gb25Db25maXJtYXRpb247XHJcbiAgICB9XHJcbiAgICBjb25maXJtKHZlcmlmaWNhdGlvbkNvZGUpIHtcclxuICAgICAgICBjb25zdCBhdXRoQ3JlZGVudGlhbCA9IFBob25lQXV0aENyZWRlbnRpYWwuX2Zyb21WZXJpZmljYXRpb24odGhpcy52ZXJpZmljYXRpb25JZCwgdmVyaWZpY2F0aW9uQ29kZSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMub25Db25maXJtYXRpb24oYXV0aENyZWRlbnRpYWwpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBBc3luY2hyb25vdXNseSBzaWducyBpbiB1c2luZyBhIHBob25lIG51bWJlci5cclxuICpcclxuICogQHJlbWFya3NcclxuICogVGhpcyBtZXRob2Qgc2VuZHMgYSBjb2RlIHZpYSBTTVMgdG8gdGhlIGdpdmVuXHJcbiAqIHBob25lIG51bWJlciwgYW5kIHJldHVybnMgYSB7QGxpbmsgQ29uZmlybWF0aW9uUmVzdWx0fS4gQWZ0ZXIgdGhlIHVzZXJcclxuICogcHJvdmlkZXMgdGhlIGNvZGUgc2VudCB0byB0aGVpciBwaG9uZSwgY2FsbCB7QGxpbmsgQ29uZmlybWF0aW9uUmVzdWx0LmNvbmZpcm19XHJcbiAqIHdpdGggdGhlIGNvZGUgdG8gc2lnbiB0aGUgdXNlciBpbi5cclxuICpcclxuICogRm9yIGFidXNlIHByZXZlbnRpb24sIHRoaXMgbWV0aG9kIGFsc28gcmVxdWlyZXMgYSB7QGxpbmsgQXBwbGljYXRpb25WZXJpZmllcn0uXHJcbiAqIFRoaXMgU0RLIGluY2x1ZGVzIGEgcmVDQVBUQ0hBLWJhc2VkIGltcGxlbWVudGF0aW9uLCB7QGxpbmsgUmVjYXB0Y2hhVmVyaWZpZXJ9LlxyXG4gKlxyXG4gKiBAZXhhbXBsZVxyXG4gKiBgYGBqYXZhc2NyaXB0XHJcbiAqIC8vICdyZWNhcHRjaGEtY29udGFpbmVyJyBpcyB0aGUgSUQgb2YgYW4gZWxlbWVudCBpbiB0aGUgRE9NLlxyXG4gKiBjb25zdCBhcHBsaWNhdGlvblZlcmlmaWVyID0gbmV3IGZpcmViYXNlLmF1dGguUmVjYXB0Y2hhVmVyaWZpZXIoJ3JlY2FwdGNoYS1jb250YWluZXInKTtcclxuICogY29uc3QgY29uZmlybWF0aW9uUmVzdWx0ID0gYXdhaXQgc2lnbkluV2l0aFBob25lTnVtYmVyKGF1dGgsIHBob25lTnVtYmVyLCBhcHBsaWNhdGlvblZlcmlmaWVyKTtcclxuICogLy8gT2J0YWluIGEgdmVyaWZpY2F0aW9uQ29kZSBmcm9tIHRoZSB1c2VyLlxyXG4gKiBjb25zdCBjcmVkZW50aWFsID0gYXdhaXQgY29uZmlybWF0aW9uUmVzdWx0LmNvbmZpcm0odmVyaWZpY2F0aW9uQ29kZSk7XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXHJcbiAqIEBwYXJhbSBwaG9uZU51bWJlciAtIFRoZSB1c2VyJ3MgcGhvbmUgbnVtYmVyIGluIEUuMTY0IGZvcm1hdCAoZS5nLiArMTY1MDU1NTAxMDEpLlxyXG4gKiBAcGFyYW0gYXBwVmVyaWZpZXIgLSBUaGUge0BsaW5rIEFwcGxpY2F0aW9uVmVyaWZpZXJ9LlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBzaWduSW5XaXRoUGhvbmVOdW1iZXIoYXV0aCwgcGhvbmVOdW1iZXIsIGFwcFZlcmlmaWVyKSB7XHJcbiAgICBjb25zdCBhdXRoSW50ZXJuYWwgPSBfY2FzdEF1dGgoYXV0aCk7XHJcbiAgICBjb25zdCB2ZXJpZmljYXRpb25JZCA9IGF3YWl0IF92ZXJpZnlQaG9uZU51bWJlcihhdXRoSW50ZXJuYWwsIHBob25lTnVtYmVyLCBnZXRNb2R1bGFySW5zdGFuY2UoYXBwVmVyaWZpZXIpKTtcclxuICAgIHJldHVybiBuZXcgQ29uZmlybWF0aW9uUmVzdWx0SW1wbCh2ZXJpZmljYXRpb25JZCwgY3JlZCA9PiBzaWduSW5XaXRoQ3JlZGVudGlhbChhdXRoSW50ZXJuYWwsIGNyZWQpKTtcclxufVxyXG4vKipcclxuICogTGlua3MgdGhlIHVzZXIgYWNjb3VudCB3aXRoIHRoZSBnaXZlbiBwaG9uZSBudW1iZXIuXHJcbiAqXHJcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXHJcbiAqIEBwYXJhbSBwaG9uZU51bWJlciAtIFRoZSB1c2VyJ3MgcGhvbmUgbnVtYmVyIGluIEUuMTY0IGZvcm1hdCAoZS5nLiArMTY1MDU1NTAxMDEpLlxyXG4gKiBAcGFyYW0gYXBwVmVyaWZpZXIgLSBUaGUge0BsaW5rIEFwcGxpY2F0aW9uVmVyaWZpZXJ9LlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBsaW5rV2l0aFBob25lTnVtYmVyKHVzZXIsIHBob25lTnVtYmVyLCBhcHBWZXJpZmllcikge1xyXG4gICAgY29uc3QgdXNlckludGVybmFsID0gZ2V0TW9kdWxhckluc3RhbmNlKHVzZXIpO1xyXG4gICAgYXdhaXQgX2Fzc2VydExpbmtlZFN0YXR1cyhmYWxzZSwgdXNlckludGVybmFsLCBcInBob25lXCIgLyogUEhPTkUgKi8pO1xyXG4gICAgY29uc3QgdmVyaWZpY2F0aW9uSWQgPSBhd2FpdCBfdmVyaWZ5UGhvbmVOdW1iZXIodXNlckludGVybmFsLmF1dGgsIHBob25lTnVtYmVyLCBnZXRNb2R1bGFySW5zdGFuY2UoYXBwVmVyaWZpZXIpKTtcclxuICAgIHJldHVybiBuZXcgQ29uZmlybWF0aW9uUmVzdWx0SW1wbCh2ZXJpZmljYXRpb25JZCwgY3JlZCA9PiBsaW5rV2l0aENyZWRlbnRpYWwodXNlckludGVybmFsLCBjcmVkKSk7XHJcbn1cclxuLyoqXHJcbiAqIFJlLWF1dGhlbnRpY2F0ZXMgYSB1c2VyIHVzaW5nIGEgZnJlc2ggcGhvbmUgY3JlZGVudGlhbC5cclxuICpcclxuICogQHJlbWFya3MgVXNlIGJlZm9yZSBvcGVyYXRpb25zIHN1Y2ggYXMge0BsaW5rIHVwZGF0ZVBhc3N3b3JkfSB0aGF0IHJlcXVpcmUgdG9rZW5zIGZyb20gcmVjZW50IHNpZ24taW4gYXR0ZW1wdHMuXHJcbiAqXHJcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXHJcbiAqIEBwYXJhbSBwaG9uZU51bWJlciAtIFRoZSB1c2VyJ3MgcGhvbmUgbnVtYmVyIGluIEUuMTY0IGZvcm1hdCAoZS5nLiArMTY1MDU1NTAxMDEpLlxyXG4gKiBAcGFyYW0gYXBwVmVyaWZpZXIgLSBUaGUge0BsaW5rIEFwcGxpY2F0aW9uVmVyaWZpZXJ9LlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiByZWF1dGhlbnRpY2F0ZVdpdGhQaG9uZU51bWJlcih1c2VyLCBwaG9uZU51bWJlciwgYXBwVmVyaWZpZXIpIHtcclxuICAgIGNvbnN0IHVzZXJJbnRlcm5hbCA9IGdldE1vZHVsYXJJbnN0YW5jZSh1c2VyKTtcclxuICAgIGNvbnN0IHZlcmlmaWNhdGlvbklkID0gYXdhaXQgX3ZlcmlmeVBob25lTnVtYmVyKHVzZXJJbnRlcm5hbC5hdXRoLCBwaG9uZU51bWJlciwgZ2V0TW9kdWxhckluc3RhbmNlKGFwcFZlcmlmaWVyKSk7XHJcbiAgICByZXR1cm4gbmV3IENvbmZpcm1hdGlvblJlc3VsdEltcGwodmVyaWZpY2F0aW9uSWQsIGNyZWQgPT4gcmVhdXRoZW50aWNhdGVXaXRoQ3JlZGVudGlhbCh1c2VySW50ZXJuYWwsIGNyZWQpKTtcclxufVxyXG4vKipcclxuICogUmV0dXJucyBhIHZlcmlmaWNhdGlvbiBJRCB0byBiZSB1c2VkIGluIGNvbmp1bmN0aW9uIHdpdGggdGhlIFNNUyBjb2RlIHRoYXQgaXMgc2VudC5cclxuICpcclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIF92ZXJpZnlQaG9uZU51bWJlcihhdXRoLCBvcHRpb25zLCB2ZXJpZmllcikge1xyXG4gICAgdmFyIF9hO1xyXG4gICAgY29uc3QgcmVjYXB0Y2hhVG9rZW4gPSBhd2FpdCB2ZXJpZmllci52ZXJpZnkoKTtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgX2Fzc2VydCh0eXBlb2YgcmVjYXB0Y2hhVG9rZW4gPT09ICdzdHJpbmcnLCBhdXRoLCBcImFyZ3VtZW50LWVycm9yXCIgLyogQVJHVU1FTlRfRVJST1IgKi8pO1xyXG4gICAgICAgIF9hc3NlcnQodmVyaWZpZXIudHlwZSA9PT0gUkVDQVBUQ0hBX1ZFUklGSUVSX1RZUEUsIGF1dGgsIFwiYXJndW1lbnQtZXJyb3JcIiAvKiBBUkdVTUVOVF9FUlJPUiAqLyk7XHJcbiAgICAgICAgbGV0IHBob25lSW5mb09wdGlvbnM7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBvcHRpb25zID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICBwaG9uZUluZm9PcHRpb25zID0ge1xyXG4gICAgICAgICAgICAgICAgcGhvbmVOdW1iZXI6IG9wdGlvbnNcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHBob25lSW5mb09wdGlvbnMgPSBvcHRpb25zO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoJ3Nlc3Npb24nIGluIHBob25lSW5mb09wdGlvbnMpIHtcclxuICAgICAgICAgICAgY29uc3Qgc2Vzc2lvbiA9IHBob25lSW5mb09wdGlvbnMuc2Vzc2lvbjtcclxuICAgICAgICAgICAgaWYgKCdwaG9uZU51bWJlcicgaW4gcGhvbmVJbmZvT3B0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgX2Fzc2VydChzZXNzaW9uLnR5cGUgPT09IFwiZW5yb2xsXCIgLyogRU5ST0xMICovLCBhdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBzdGFydEVucm9sbFBob25lTWZhKGF1dGgsIHtcclxuICAgICAgICAgICAgICAgICAgICBpZFRva2VuOiBzZXNzaW9uLmNyZWRlbnRpYWwsXHJcbiAgICAgICAgICAgICAgICAgICAgcGhvbmVFbnJvbGxtZW50SW5mbzoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwaG9uZU51bWJlcjogcGhvbmVJbmZvT3B0aW9ucy5waG9uZU51bWJlcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjYXB0Y2hhVG9rZW5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5waG9uZVNlc3Npb25JbmZvLnNlc3Npb25JbmZvO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgX2Fzc2VydChzZXNzaW9uLnR5cGUgPT09IFwic2lnbmluXCIgLyogU0lHTl9JTiAqLywgYXV0aCwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIElOVEVSTkFMX0VSUk9SICovKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG1mYUVucm9sbG1lbnRJZCA9ICgoX2EgPSBwaG9uZUluZm9PcHRpb25zLm11bHRpRmFjdG9ySGludCkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnVpZCkgfHxcclxuICAgICAgICAgICAgICAgICAgICBwaG9uZUluZm9PcHRpb25zLm11bHRpRmFjdG9yVWlkO1xyXG4gICAgICAgICAgICAgICAgX2Fzc2VydChtZmFFbnJvbGxtZW50SWQsIGF1dGgsIFwibWlzc2luZy1tdWx0aS1mYWN0b3ItaW5mb1wiIC8qIE1JU1NJTkdfTUZBX0lORk8gKi8pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBzdGFydFNpZ25JblBob25lTWZhKGF1dGgsIHtcclxuICAgICAgICAgICAgICAgICAgICBtZmFQZW5kaW5nQ3JlZGVudGlhbDogc2Vzc2lvbi5jcmVkZW50aWFsLFxyXG4gICAgICAgICAgICAgICAgICAgIG1mYUVucm9sbG1lbnRJZCxcclxuICAgICAgICAgICAgICAgICAgICBwaG9uZVNpZ25JbkluZm86IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVjYXB0Y2hhVG9rZW5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5waG9uZVJlc3BvbnNlSW5mby5zZXNzaW9uSW5mbztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY29uc3QgeyBzZXNzaW9uSW5mbyB9ID0gYXdhaXQgc2VuZFBob25lVmVyaWZpY2F0aW9uQ29kZShhdXRoLCB7XHJcbiAgICAgICAgICAgICAgICBwaG9uZU51bWJlcjogcGhvbmVJbmZvT3B0aW9ucy5waG9uZU51bWJlcixcclxuICAgICAgICAgICAgICAgIHJlY2FwdGNoYVRva2VuXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gc2Vzc2lvbkluZm87XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZmluYWxseSB7XHJcbiAgICAgICAgdmVyaWZpZXIuX3Jlc2V0KCk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIFVwZGF0ZXMgdGhlIHVzZXIncyBwaG9uZSBudW1iZXIuXHJcbiAqXHJcbiAqIEBleGFtcGxlXHJcbiAqIGBgYFxyXG4gKiAvLyAncmVjYXB0Y2hhLWNvbnRhaW5lcicgaXMgdGhlIElEIG9mIGFuIGVsZW1lbnQgaW4gdGhlIERPTS5cclxuICogY29uc3QgYXBwbGljYXRpb25WZXJpZmllciA9IG5ldyBSZWNhcHRjaGFWZXJpZmllcigncmVjYXB0Y2hhLWNvbnRhaW5lcicpO1xyXG4gKiBjb25zdCBwcm92aWRlciA9IG5ldyBQaG9uZUF1dGhQcm92aWRlcihhdXRoKTtcclxuICogY29uc3QgdmVyaWZpY2F0aW9uSWQgPSBhd2FpdCBwcm92aWRlci52ZXJpZnlQaG9uZU51bWJlcignKzE2NTA1NTUwMTAxJywgYXBwbGljYXRpb25WZXJpZmllcik7XHJcbiAqIC8vIE9idGFpbiB0aGUgdmVyaWZpY2F0aW9uQ29kZSBmcm9tIHRoZSB1c2VyLlxyXG4gKiBjb25zdCBwaG9uZUNyZWRlbnRpYWwgPSBQaG9uZUF1dGhQcm92aWRlci5jcmVkZW50aWFsKHZlcmlmaWNhdGlvbklkLCB2ZXJpZmljYXRpb25Db2RlKTtcclxuICogYXdhaXQgdXBkYXRlUGhvbmVOdW1iZXIodXNlciwgcGhvbmVDcmVkZW50aWFsKTtcclxuICogYGBgXHJcbiAqXHJcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXHJcbiAqIEBwYXJhbSBjcmVkZW50aWFsIC0gQSBjcmVkZW50aWFsIGF1dGhlbnRpY2F0aW5nIHRoZSBuZXcgcGhvbmUgbnVtYmVyLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiB1cGRhdGVQaG9uZU51bWJlcih1c2VyLCBjcmVkZW50aWFsKSB7XHJcbiAgICBhd2FpdCBfbGluayQxKGdldE1vZHVsYXJJbnN0YW5jZSh1c2VyKSwgY3JlZGVudGlhbCk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFByb3ZpZGVyIGZvciBnZW5lcmF0aW5nIGFuIHtAbGluayBQaG9uZUF1dGhDcmVkZW50aWFsfS5cclxuICpcclxuICogQGV4YW1wbGVcclxuICogYGBgamF2YXNjcmlwdFxyXG4gKiAvLyAncmVjYXB0Y2hhLWNvbnRhaW5lcicgaXMgdGhlIElEIG9mIGFuIGVsZW1lbnQgaW4gdGhlIERPTS5cclxuICogY29uc3QgYXBwbGljYXRpb25WZXJpZmllciA9IG5ldyBSZWNhcHRjaGFWZXJpZmllcigncmVjYXB0Y2hhLWNvbnRhaW5lcicpO1xyXG4gKiBjb25zdCBwcm92aWRlciA9IG5ldyBQaG9uZUF1dGhQcm92aWRlcihhdXRoKTtcclxuICogY29uc3QgdmVyaWZpY2F0aW9uSWQgPSBhd2FpdCBwcm92aWRlci52ZXJpZnlQaG9uZU51bWJlcignKzE2NTA1NTUwMTAxJywgYXBwbGljYXRpb25WZXJpZmllcik7XHJcbiAqIC8vIE9idGFpbiB0aGUgdmVyaWZpY2F0aW9uQ29kZSBmcm9tIHRoZSB1c2VyLlxyXG4gKiBjb25zdCBwaG9uZUNyZWRlbnRpYWwgPSBQaG9uZUF1dGhQcm92aWRlci5jcmVkZW50aWFsKHZlcmlmaWNhdGlvbklkLCB2ZXJpZmljYXRpb25Db2RlKTtcclxuICogY29uc3QgdXNlckNyZWRlbnRpYWwgPSBhd2FpdCBzaWduSW5XaXRoQ3JlZGVudGlhbChhdXRoLCBwaG9uZUNyZWRlbnRpYWwpO1xyXG4gKiBgYGBcclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuY2xhc3MgUGhvbmVBdXRoUHJvdmlkZXIge1xyXG4gICAgLyoqXHJcbiAgICAgKiBAcGFyYW0gYXV0aCAtIFRoZSBGaXJlYmFzZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UgaW4gd2hpY2ggc2lnbi1pbnMgc2hvdWxkIG9jY3VyLlxyXG4gICAgICpcclxuICAgICAqL1xyXG4gICAgY29uc3RydWN0b3IoYXV0aCkge1xyXG4gICAgICAgIC8qKiBBbHdheXMgc2V0IHRvIHtAbGluayBQcm92aWRlcklkfS5QSE9ORS4gKi9cclxuICAgICAgICB0aGlzLnByb3ZpZGVySWQgPSBQaG9uZUF1dGhQcm92aWRlci5QUk9WSURFUl9JRDtcclxuICAgICAgICB0aGlzLmF1dGggPSBfY2FzdEF1dGgoYXV0aCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqXHJcbiAgICAgKiBTdGFydHMgYSBwaG9uZSBudW1iZXIgYXV0aGVudGljYXRpb24gZmxvdyBieSBzZW5kaW5nIGEgdmVyaWZpY2F0aW9uIGNvZGUgdG8gdGhlIGdpdmVuIHBob25lXHJcbiAgICAgKiBudW1iZXIuXHJcbiAgICAgKlxyXG4gICAgICogQGV4YW1wbGVcclxuICAgICAqIGBgYGphdmFzY3JpcHRcclxuICAgICAqIGNvbnN0IHByb3ZpZGVyID0gbmV3IFBob25lQXV0aFByb3ZpZGVyKGF1dGgpO1xyXG4gICAgICogY29uc3QgdmVyaWZpY2F0aW9uSWQgPSBhd2FpdCBwcm92aWRlci52ZXJpZnlQaG9uZU51bWJlcihwaG9uZU51bWJlciwgYXBwbGljYXRpb25WZXJpZmllcik7XHJcbiAgICAgKiAvLyBPYnRhaW4gdmVyaWZpY2F0aW9uQ29kZSBmcm9tIHRoZSB1c2VyLlxyXG4gICAgICogY29uc3QgYXV0aENyZWRlbnRpYWwgPSBQaG9uZUF1dGhQcm92aWRlci5jcmVkZW50aWFsKHZlcmlmaWNhdGlvbklkLCB2ZXJpZmljYXRpb25Db2RlKTtcclxuICAgICAqIGNvbnN0IHVzZXJDcmVkZW50aWFsID0gYXdhaXQgc2lnbkluV2l0aENyZWRlbnRpYWwoYXV0aCwgYXV0aENyZWRlbnRpYWwpO1xyXG4gICAgICogYGBgXHJcbiAgICAgKlxyXG4gICAgICogQGV4YW1wbGVcclxuICAgICAqIEFuIGFsdGVybmF0aXZlIGZsb3cgaXMgcHJvdmlkZWQgdXNpbmcgdGhlIGBzaWduSW5XaXRoUGhvbmVOdW1iZXJgIG1ldGhvZC5cclxuICAgICAqIGBgYGphdmFzY3JpcHRcclxuICAgICAqIGNvbnN0IGNvbmZpcm1hdGlvblJlc3VsdCA9IHNpZ25JbldpdGhQaG9uZU51bWJlcihhdXRoLCBwaG9uZU51bWJlciwgYXBwbGljYXRpb25WZXJpZmllcik7XHJcbiAgICAgKiAvLyBPYnRhaW4gdmVyaWZpY2F0aW9uQ29kZSBmcm9tIHRoZSB1c2VyLlxyXG4gICAgICogY29uc3QgdXNlckNyZWRlbnRpYWwgPSBjb25maXJtYXRpb25SZXN1bHQuY29uZmlybSh2ZXJpZmljYXRpb25Db2RlKTtcclxuICAgICAqIGBgYFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBwaG9uZUluZm9PcHRpb25zIC0gVGhlIHVzZXIncyB7QGxpbmsgUGhvbmVJbmZvT3B0aW9uc30uIFRoZSBwaG9uZSBudW1iZXIgc2hvdWxkIGJlIGluXHJcbiAgICAgKiBFLjE2NCBmb3JtYXQgKGUuZy4gKzE2NTA1NTUwMTAxKS5cclxuICAgICAqIEBwYXJhbSBhcHBsaWNhdGlvblZlcmlmaWVyIC0gRm9yIGFidXNlIHByZXZlbnRpb24sIHRoaXMgbWV0aG9kIGFsc28gcmVxdWlyZXMgYVxyXG4gICAgICoge0BsaW5rIEFwcGxpY2F0aW9uVmVyaWZpZXJ9LiBUaGlzIFNESyBpbmNsdWRlcyBhIHJlQ0FQVENIQS1iYXNlZCBpbXBsZW1lbnRhdGlvbixcclxuICAgICAqIHtAbGluayBSZWNhcHRjaGFWZXJpZmllcn0uXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybnMgQSBQcm9taXNlIGZvciBhIHZlcmlmaWNhdGlvbiBJRCB0aGF0IGNhbiBiZSBwYXNzZWQgdG9cclxuICAgICAqIHtAbGluayBQaG9uZUF1dGhQcm92aWRlci5jcmVkZW50aWFsfSB0byBpZGVudGlmeSB0aGlzIGZsb3cuLlxyXG4gICAgICovXHJcbiAgICB2ZXJpZnlQaG9uZU51bWJlcihwaG9uZU9wdGlvbnMsIGFwcGxpY2F0aW9uVmVyaWZpZXIpIHtcclxuICAgICAgICByZXR1cm4gX3ZlcmlmeVBob25lTnVtYmVyKHRoaXMuYXV0aCwgcGhvbmVPcHRpb25zLCBnZXRNb2R1bGFySW5zdGFuY2UoYXBwbGljYXRpb25WZXJpZmllcikpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGEgcGhvbmUgYXV0aCBjcmVkZW50aWFsLCBnaXZlbiB0aGUgdmVyaWZpY2F0aW9uIElEIGZyb21cclxuICAgICAqIHtAbGluayBQaG9uZUF1dGhQcm92aWRlci52ZXJpZnlQaG9uZU51bWJlcn0gYW5kIHRoZSBjb2RlIHRoYXQgd2FzIHNlbnQgdG8gdGhlIHVzZXInc1xyXG4gICAgICogbW9iaWxlIGRldmljZS5cclxuICAgICAqXHJcbiAgICAgKiBAZXhhbXBsZVxyXG4gICAgICogYGBgamF2YXNjcmlwdFxyXG4gICAgICogY29uc3QgcHJvdmlkZXIgPSBuZXcgUGhvbmVBdXRoUHJvdmlkZXIoYXV0aCk7XHJcbiAgICAgKiBjb25zdCB2ZXJpZmljYXRpb25JZCA9IHByb3ZpZGVyLnZlcmlmeVBob25lTnVtYmVyKHBob25lTnVtYmVyLCBhcHBsaWNhdGlvblZlcmlmaWVyKTtcclxuICAgICAqIC8vIE9idGFpbiB2ZXJpZmljYXRpb25Db2RlIGZyb20gdGhlIHVzZXIuXHJcbiAgICAgKiBjb25zdCBhdXRoQ3JlZGVudGlhbCA9IFBob25lQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWwodmVyaWZpY2F0aW9uSWQsIHZlcmlmaWNhdGlvbkNvZGUpO1xyXG4gICAgICogY29uc3QgdXNlckNyZWRlbnRpYWwgPSBzaWduSW5XaXRoQ3JlZGVudGlhbChhdXRoLCBhdXRoQ3JlZGVudGlhbCk7XHJcbiAgICAgKiBgYGBcclxuICAgICAqXHJcbiAgICAgKiBAZXhhbXBsZVxyXG4gICAgICogQW4gYWx0ZXJuYXRpdmUgZmxvdyBpcyBwcm92aWRlZCB1c2luZyB0aGUgYHNpZ25JbldpdGhQaG9uZU51bWJlcmAgbWV0aG9kLlxyXG4gICAgICogYGBgamF2YXNjcmlwdFxyXG4gICAgICogY29uc3QgY29uZmlybWF0aW9uUmVzdWx0ID0gYXdhaXQgc2lnbkluV2l0aFBob25lTnVtYmVyKGF1dGgsIHBob25lTnVtYmVyLCBhcHBsaWNhdGlvblZlcmlmaWVyKTtcclxuICAgICAqIC8vIE9idGFpbiB2ZXJpZmljYXRpb25Db2RlIGZyb20gdGhlIHVzZXIuXHJcbiAgICAgKiBjb25zdCB1c2VyQ3JlZGVudGlhbCA9IGF3YWl0IGNvbmZpcm1hdGlvblJlc3VsdC5jb25maXJtKHZlcmlmaWNhdGlvbkNvZGUpO1xyXG4gICAgICogYGBgXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHZlcmlmaWNhdGlvbklkIC0gVGhlIHZlcmlmaWNhdGlvbiBJRCByZXR1cm5lZCBmcm9tIHtAbGluayBQaG9uZUF1dGhQcm92aWRlci52ZXJpZnlQaG9uZU51bWJlcn0uXHJcbiAgICAgKiBAcGFyYW0gdmVyaWZpY2F0aW9uQ29kZSAtIFRoZSB2ZXJpZmljYXRpb24gY29kZSBzZW50IHRvIHRoZSB1c2VyJ3MgbW9iaWxlIGRldmljZS5cclxuICAgICAqXHJcbiAgICAgKiBAcmV0dXJucyBUaGUgYXV0aCBwcm92aWRlciBjcmVkZW50aWFsLlxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgY3JlZGVudGlhbCh2ZXJpZmljYXRpb25JZCwgdmVyaWZpY2F0aW9uQ29kZSkge1xyXG4gICAgICAgIHJldHVybiBQaG9uZUF1dGhDcmVkZW50aWFsLl9mcm9tVmVyaWZpY2F0aW9uKHZlcmlmaWNhdGlvbklkLCB2ZXJpZmljYXRpb25Db2RlKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogR2VuZXJhdGVzIGFuIHtAbGluayBBdXRoQ3JlZGVudGlhbH0gZnJvbSBhIHtAbGluayBVc2VyQ3JlZGVudGlhbH0uXHJcbiAgICAgKiBAcGFyYW0gdXNlckNyZWRlbnRpYWwgLSBUaGUgdXNlciBjcmVkZW50aWFsLlxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgY3JlZGVudGlhbEZyb21SZXN1bHQodXNlckNyZWRlbnRpYWwpIHtcclxuICAgICAgICBjb25zdCBjcmVkZW50aWFsID0gdXNlckNyZWRlbnRpYWw7XHJcbiAgICAgICAgcmV0dXJuIFBob25lQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KGNyZWRlbnRpYWwpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIGFuIHtAbGluayBBdXRoQ3JlZGVudGlhbH0gd2hlbiBwYXNzZWQgYW4gZXJyb3IuXHJcbiAgICAgKlxyXG4gICAgICogQHJlbWFya3NcclxuICAgICAqXHJcbiAgICAgKiBUaGlzIG1ldGhvZCB3b3JrcyBmb3IgZXJyb3JzIGxpa2VcclxuICAgICAqIGBhdXRoL2FjY291bnQtZXhpc3RzLXdpdGgtZGlmZmVyZW50LWNyZWRlbnRpYWxzYC4gVGhpcyBpcyB1c2VmdWwgZm9yXHJcbiAgICAgKiByZWNvdmVyaW5nIHdoZW4gYXR0ZW1wdGluZyB0byBzZXQgYSB1c2VyJ3MgcGhvbmUgbnVtYmVyIGJ1dCB0aGUgbnVtYmVyXHJcbiAgICAgKiBpbiBxdWVzdGlvbiBpcyBhbHJlYWR5IHRpZWQgdG8gYW5vdGhlciBhY2NvdW50LiBGb3IgZXhhbXBsZSwgdGhlIGZvbGxvd2luZ1xyXG4gICAgICogY29kZSB0cmllcyB0byB1cGRhdGUgdGhlIGN1cnJlbnQgdXNlcidzIHBob25lIG51bWJlciwgYW5kIGlmIHRoYXRcclxuICAgICAqIGZhaWxzLCBsaW5rcyB0aGUgdXNlciB3aXRoIHRoZSBhY2NvdW50IGFzc29jaWF0ZWQgd2l0aCB0aGF0IG51bWJlcjpcclxuICAgICAqXHJcbiAgICAgKiBgYGBqc1xyXG4gICAgICogY29uc3QgcHJvdmlkZXIgPSBuZXcgUGhvbmVBdXRoUHJvdmlkZXIoYXV0aCk7XHJcbiAgICAgKiBjb25zdCB2ZXJpZmljYXRpb25JZCA9IGF3YWl0IHByb3ZpZGVyLnZlcmlmeVBob25lTnVtYmVyKG51bWJlciwgdmVyaWZpZXIpO1xyXG4gICAgICogdHJ5IHtcclxuICAgICAqICAgY29uc3QgY29kZSA9ICcnOyAvLyBQcm9tcHQgdGhlIHVzZXIgZm9yIHRoZSB2ZXJpZmljYXRpb24gY29kZVxyXG4gICAgICogICBhd2FpdCB1cGRhdGVQaG9uZU51bWJlcihcclxuICAgICAqICAgICAgIGF1dGguY3VycmVudFVzZXIsXHJcbiAgICAgKiAgICAgICBQaG9uZUF1dGhQcm92aWRlci5jcmVkZW50aWFsKHZlcmlmaWNhdGlvbklkLCBjb2RlKSk7XHJcbiAgICAgKiB9IGNhdGNoIChlKSB7XHJcbiAgICAgKiAgIGlmIChlLmNvZGUgPT09ICdhdXRoL2FjY291bnQtZXhpc3RzLXdpdGgtZGlmZmVyZW50LWNyZWRlbnRpYWwnKSB7XHJcbiAgICAgKiAgICAgY29uc3QgY3JlZCA9IFBob25lQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tRXJyb3IoZSk7XHJcbiAgICAgKiAgICAgYXdhaXQgbGlua1dpdGhDcmVkZW50aWFsKGF1dGguY3VycmVudFVzZXIsIGNyZWQpO1xyXG4gICAgICogICB9XHJcbiAgICAgKiB9XHJcbiAgICAgKlxyXG4gICAgICogLy8gQXQgdGhpcyBwb2ludCwgYXV0aC5jdXJyZW50VXNlci5waG9uZU51bWJlciA9PT0gbnVtYmVyLlxyXG4gICAgICogYGBgXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGVycm9yIC0gVGhlIGVycm9yIHRvIGdlbmVyYXRlIGEgY3JlZGVudGlhbCBmcm9tLlxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgY3JlZGVudGlhbEZyb21FcnJvcihlcnJvcikge1xyXG4gICAgICAgIHJldHVybiBQaG9uZUF1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVRhZ2dlZE9iamVjdCgoZXJyb3IuY3VzdG9tRGF0YSB8fCB7fSkpO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIGNyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KHsgX3Rva2VuUmVzcG9uc2U6IHRva2VuUmVzcG9uc2UgfSkge1xyXG4gICAgICAgIGlmICghdG9rZW5SZXNwb25zZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgeyBwaG9uZU51bWJlciwgdGVtcG9yYXJ5UHJvb2YgfSA9IHRva2VuUmVzcG9uc2U7XHJcbiAgICAgICAgaWYgKHBob25lTnVtYmVyICYmIHRlbXBvcmFyeVByb29mKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQaG9uZUF1dGhDcmVkZW50aWFsLl9mcm9tVG9rZW5SZXNwb25zZShwaG9uZU51bWJlciwgdGVtcG9yYXJ5UHJvb2YpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxufVxyXG4vKiogQWx3YXlzIHNldCB0byB7QGxpbmsgUHJvdmlkZXJJZH0uUEhPTkUuICovXHJcblBob25lQXV0aFByb3ZpZGVyLlBST1ZJREVSX0lEID0gXCJwaG9uZVwiIC8qIFBIT05FICovO1xyXG4vKiogQWx3YXlzIHNldCB0byB7QGxpbmsgU2lnbkluTWV0aG9kfS5QSE9ORS4gKi9cclxuUGhvbmVBdXRoUHJvdmlkZXIuUEhPTkVfU0lHTl9JTl9NRVRIT0QgPSBcInBob25lXCIgLyogUEhPTkUgKi87XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBDaG9vc2VzIGEgcG9wdXAvcmVkaXJlY3QgcmVzb2x2ZXIgdG8gdXNlLiBUaGlzIHByZWZlcnMgdGhlIG92ZXJyaWRlICh3aGljaFxyXG4gKiBpcyBkaXJlY3RseSBwYXNzZWQgaW4pLCBhbmQgZmFsbHMgYmFjayB0byB0aGUgcHJvcGVydHkgc2V0IG9uIHRoZSBhdXRoXHJcbiAqIG9iamVjdC4gSWYgbmVpdGhlciBhcmUgYXZhaWxhYmxlLCB0aGlzIGZ1bmN0aW9uIGVycm9ycyB3LyBhbiBhcmd1bWVudCBlcnJvci5cclxuICovXHJcbmZ1bmN0aW9uIF93aXRoRGVmYXVsdFJlc29sdmVyKGF1dGgsIHJlc29sdmVyT3ZlcnJpZGUpIHtcclxuICAgIGlmIChyZXNvbHZlck92ZXJyaWRlKSB7XHJcbiAgICAgICAgcmV0dXJuIF9nZXRJbnN0YW5jZShyZXNvbHZlck92ZXJyaWRlKTtcclxuICAgIH1cclxuICAgIF9hc3NlcnQoYXV0aC5fcG9wdXBSZWRpcmVjdFJlc29sdmVyLCBhdXRoLCBcImFyZ3VtZW50LWVycm9yXCIgLyogQVJHVU1FTlRfRVJST1IgKi8pO1xyXG4gICAgcmV0dXJuIGF1dGguX3BvcHVwUmVkaXJlY3RSZXNvbHZlcjtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jbGFzcyBJZHBDcmVkZW50aWFsIGV4dGVuZHMgQXV0aENyZWRlbnRpYWwge1xyXG4gICAgY29uc3RydWN0b3IocGFyYW1zKSB7XHJcbiAgICAgICAgc3VwZXIoXCJjdXN0b21cIiAvKiBDVVNUT00gKi8sIFwiY3VzdG9tXCIgLyogQ1VTVE9NICovKTtcclxuICAgICAgICB0aGlzLnBhcmFtcyA9IHBhcmFtcztcclxuICAgIH1cclxuICAgIF9nZXRJZFRva2VuUmVzcG9uc2UoYXV0aCkge1xyXG4gICAgICAgIHJldHVybiBzaWduSW5XaXRoSWRwKGF1dGgsIHRoaXMuX2J1aWxkSWRwUmVxdWVzdCgpKTtcclxuICAgIH1cclxuICAgIF9saW5rVG9JZFRva2VuKGF1dGgsIGlkVG9rZW4pIHtcclxuICAgICAgICByZXR1cm4gc2lnbkluV2l0aElkcChhdXRoLCB0aGlzLl9idWlsZElkcFJlcXVlc3QoaWRUb2tlbikpO1xyXG4gICAgfVxyXG4gICAgX2dldFJlYXV0aGVudGljYXRpb25SZXNvbHZlcihhdXRoKSB7XHJcbiAgICAgICAgcmV0dXJuIHNpZ25JbldpdGhJZHAoYXV0aCwgdGhpcy5fYnVpbGRJZHBSZXF1ZXN0KCkpO1xyXG4gICAgfVxyXG4gICAgX2J1aWxkSWRwUmVxdWVzdChpZFRva2VuKSB7XHJcbiAgICAgICAgY29uc3QgcmVxdWVzdCA9IHtcclxuICAgICAgICAgICAgcmVxdWVzdFVyaTogdGhpcy5wYXJhbXMucmVxdWVzdFVyaSxcclxuICAgICAgICAgICAgc2Vzc2lvbklkOiB0aGlzLnBhcmFtcy5zZXNzaW9uSWQsXHJcbiAgICAgICAgICAgIHBvc3RCb2R5OiB0aGlzLnBhcmFtcy5wb3N0Qm9keSxcclxuICAgICAgICAgICAgdGVuYW50SWQ6IHRoaXMucGFyYW1zLnRlbmFudElkLFxyXG4gICAgICAgICAgICBwZW5kaW5nVG9rZW46IHRoaXMucGFyYW1zLnBlbmRpbmdUb2tlbixcclxuICAgICAgICAgICAgcmV0dXJuU2VjdXJlVG9rZW46IHRydWUsXHJcbiAgICAgICAgICAgIHJldHVybklkcENyZWRlbnRpYWw6IHRydWVcclxuICAgICAgICB9O1xyXG4gICAgICAgIGlmIChpZFRva2VuKSB7XHJcbiAgICAgICAgICAgIHJlcXVlc3QuaWRUb2tlbiA9IGlkVG9rZW47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXF1ZXN0O1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIF9zaWduSW4ocGFyYW1zKSB7XHJcbiAgICByZXR1cm4gX3NpZ25JbldpdGhDcmVkZW50aWFsKHBhcmFtcy5hdXRoLCBuZXcgSWRwQ3JlZGVudGlhbChwYXJhbXMpLCBwYXJhbXMuYnlwYXNzQXV0aFN0YXRlKTtcclxufVxyXG5mdW5jdGlvbiBfcmVhdXRoKHBhcmFtcykge1xyXG4gICAgY29uc3QgeyBhdXRoLCB1c2VyIH0gPSBwYXJhbXM7XHJcbiAgICBfYXNzZXJ0KHVzZXIsIGF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyk7XHJcbiAgICByZXR1cm4gX3JlYXV0aGVudGljYXRlKHVzZXIsIG5ldyBJZHBDcmVkZW50aWFsKHBhcmFtcyksIHBhcmFtcy5ieXBhc3NBdXRoU3RhdGUpO1xyXG59XHJcbmFzeW5jIGZ1bmN0aW9uIF9saW5rKHBhcmFtcykge1xyXG4gICAgY29uc3QgeyBhdXRoLCB1c2VyIH0gPSBwYXJhbXM7XHJcbiAgICBfYXNzZXJ0KHVzZXIsIGF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyk7XHJcbiAgICByZXR1cm4gX2xpbmskMSh1c2VyLCBuZXcgSWRwQ3JlZGVudGlhbChwYXJhbXMpLCBwYXJhbXMuYnlwYXNzQXV0aFN0YXRlKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogUG9wdXAgZXZlbnQgbWFuYWdlci4gSGFuZGxlcyB0aGUgcG9wdXAncyBlbnRpcmUgbGlmZWN5Y2xlOyBsaXN0ZW5zIHRvIGF1dGhcclxuICogZXZlbnRzXHJcbiAqL1xyXG5jbGFzcyBBYnN0cmFjdFBvcHVwUmVkaXJlY3RPcGVyYXRpb24ge1xyXG4gICAgY29uc3RydWN0b3IoYXV0aCwgZmlsdGVyLCByZXNvbHZlciwgdXNlciwgYnlwYXNzQXV0aFN0YXRlID0gZmFsc2UpIHtcclxuICAgICAgICB0aGlzLmF1dGggPSBhdXRoO1xyXG4gICAgICAgIHRoaXMucmVzb2x2ZXIgPSByZXNvbHZlcjtcclxuICAgICAgICB0aGlzLnVzZXIgPSB1c2VyO1xyXG4gICAgICAgIHRoaXMuYnlwYXNzQXV0aFN0YXRlID0gYnlwYXNzQXV0aFN0YXRlO1xyXG4gICAgICAgIHRoaXMucGVuZGluZ1Byb21pc2UgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuZXZlbnRNYW5hZ2VyID0gbnVsbDtcclxuICAgICAgICB0aGlzLmZpbHRlciA9IEFycmF5LmlzQXJyYXkoZmlsdGVyKSA/IGZpbHRlciA6IFtmaWx0ZXJdO1xyXG4gICAgfVxyXG4gICAgZXhlY3V0ZSgpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoYXN5bmMgKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnBlbmRpbmdQcm9taXNlID0geyByZXNvbHZlLCByZWplY3QgfTtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZXZlbnRNYW5hZ2VyID0gYXdhaXQgdGhpcy5yZXNvbHZlci5faW5pdGlhbGl6ZSh0aGlzLmF1dGgpO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5vbkV4ZWN1dGlvbigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ldmVudE1hbmFnZXIucmVnaXN0ZXJDb25zdW1lcih0aGlzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZWplY3QoZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGFzeW5jIG9uQXV0aEV2ZW50KGV2ZW50KSB7XHJcbiAgICAgICAgY29uc3QgeyB1cmxSZXNwb25zZSwgc2Vzc2lvbklkLCBwb3N0Qm9keSwgdGVuYW50SWQsIGVycm9yLCB0eXBlIH0gPSBldmVudDtcclxuICAgICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgdGhpcy5yZWplY3QoZXJyb3IpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHBhcmFtcyA9IHtcclxuICAgICAgICAgICAgYXV0aDogdGhpcy5hdXRoLFxyXG4gICAgICAgICAgICByZXF1ZXN0VXJpOiB1cmxSZXNwb25zZSxcclxuICAgICAgICAgICAgc2Vzc2lvbklkOiBzZXNzaW9uSWQsXHJcbiAgICAgICAgICAgIHRlbmFudElkOiB0ZW5hbnRJZCB8fCB1bmRlZmluZWQsXHJcbiAgICAgICAgICAgIHBvc3RCb2R5OiBwb3N0Qm9keSB8fCB1bmRlZmluZWQsXHJcbiAgICAgICAgICAgIHVzZXI6IHRoaXMudXNlcixcclxuICAgICAgICAgICAgYnlwYXNzQXV0aFN0YXRlOiB0aGlzLmJ5cGFzc0F1dGhTdGF0ZVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgdGhpcy5yZXNvbHZlKGF3YWl0IHRoaXMuZ2V0SWRwVGFzayh0eXBlKShwYXJhbXMpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgdGhpcy5yZWplY3QoZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgb25FcnJvcihlcnJvcikge1xyXG4gICAgICAgIHRoaXMucmVqZWN0KGVycm9yKTtcclxuICAgIH1cclxuICAgIGdldElkcFRhc2sodHlwZSkge1xyXG4gICAgICAgIHN3aXRjaCAodHlwZSkge1xyXG4gICAgICAgICAgICBjYXNlIFwic2lnbkluVmlhUG9wdXBcIiAvKiBTSUdOX0lOX1ZJQV9QT1BVUCAqLzpcclxuICAgICAgICAgICAgY2FzZSBcInNpZ25JblZpYVJlZGlyZWN0XCIgLyogU0lHTl9JTl9WSUFfUkVESVJFQ1QgKi86XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX3NpZ25JbjtcclxuICAgICAgICAgICAgY2FzZSBcImxpbmtWaWFQb3B1cFwiIC8qIExJTktfVklBX1BPUFVQICovOlxyXG4gICAgICAgICAgICBjYXNlIFwibGlua1ZpYVJlZGlyZWN0XCIgLyogTElOS19WSUFfUkVESVJFQ1QgKi86XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX2xpbms7XHJcbiAgICAgICAgICAgIGNhc2UgXCJyZWF1dGhWaWFQb3B1cFwiIC8qIFJFQVVUSF9WSUFfUE9QVVAgKi86XHJcbiAgICAgICAgICAgIGNhc2UgXCJyZWF1dGhWaWFSZWRpcmVjdFwiIC8qIFJFQVVUSF9WSUFfUkVESVJFQ1QgKi86XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX3JlYXV0aDtcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIF9mYWlsKHRoaXMuYXV0aCwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIElOVEVSTkFMX0VSUk9SICovKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXNvbHZlKGNyZWQpIHtcclxuICAgICAgICBkZWJ1Z0Fzc2VydCh0aGlzLnBlbmRpbmdQcm9taXNlLCAnUGVuZGluZyBwcm9taXNlIHdhcyBuZXZlciBzZXQnKTtcclxuICAgICAgICB0aGlzLnBlbmRpbmdQcm9taXNlLnJlc29sdmUoY3JlZCk7XHJcbiAgICAgICAgdGhpcy51bnJlZ2lzdGVyQW5kQ2xlYW5VcCgpO1xyXG4gICAgfVxyXG4gICAgcmVqZWN0KGVycm9yKSB7XHJcbiAgICAgICAgZGVidWdBc3NlcnQodGhpcy5wZW5kaW5nUHJvbWlzZSwgJ1BlbmRpbmcgcHJvbWlzZSB3YXMgbmV2ZXIgc2V0Jyk7XHJcbiAgICAgICAgdGhpcy5wZW5kaW5nUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xyXG4gICAgICAgIHRoaXMudW5yZWdpc3RlckFuZENsZWFuVXAoKTtcclxuICAgIH1cclxuICAgIHVucmVnaXN0ZXJBbmRDbGVhblVwKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmV2ZW50TWFuYWdlcikge1xyXG4gICAgICAgICAgICB0aGlzLmV2ZW50TWFuYWdlci51bnJlZ2lzdGVyQ29uc3VtZXIodGhpcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucGVuZGluZ1Byb21pc2UgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuY2xlYW5VcCgpO1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmNvbnN0IF9QT0xMX1dJTkRPV19DTE9TRV9USU1FT1VUID0gbmV3IERlbGF5KDIwMDAsIDEwMDAwKTtcclxuLyoqXHJcbiAqIEF1dGhlbnRpY2F0ZXMgYSBGaXJlYmFzZSBjbGllbnQgdXNpbmcgYSBwb3B1cC1iYXNlZCBPQXV0aCBhdXRoZW50aWNhdGlvbiBmbG93LlxyXG4gKlxyXG4gKiBAcmVtYXJrc1xyXG4gKiBJZiBzdWNjZWVkcywgcmV0dXJucyB0aGUgc2lnbmVkIGluIHVzZXIgYWxvbmcgd2l0aCB0aGUgcHJvdmlkZXIncyBjcmVkZW50aWFsLiBJZiBzaWduIGluIHdhc1xyXG4gKiB1bnN1Y2Nlc3NmdWwsIHJldHVybnMgYW4gZXJyb3Igb2JqZWN0IGNvbnRhaW5pbmcgYWRkaXRpb25hbCBpbmZvcm1hdGlvbiBhYm91dCB0aGUgZXJyb3IuXHJcbiAqXHJcbiAqIEBleGFtcGxlXHJcbiAqIGBgYGphdmFzY3JpcHRcclxuICogLy8gU2lnbiBpbiB1c2luZyBhIHBvcHVwLlxyXG4gKiBjb25zdCBwcm92aWRlciA9IG5ldyBGYWNlYm9va0F1dGhQcm92aWRlcigpO1xyXG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBzaWduSW5XaXRoUG9wdXAoYXV0aCwgcHJvdmlkZXIpO1xyXG4gKlxyXG4gKiAvLyBUaGUgc2lnbmVkLWluIHVzZXIgaW5mby5cclxuICogY29uc3QgdXNlciA9IHJlc3VsdC51c2VyO1xyXG4gKiAvLyBUaGlzIGdpdmVzIHlvdSBhIEZhY2Vib29rIEFjY2VzcyBUb2tlbi5cclxuICogY29uc3QgY3JlZGVudGlhbCA9IHByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tUmVzdWx0KGF1dGgsIHJlc3VsdCk7XHJcbiAqIGNvbnN0IHRva2VuID0gY3JlZGVudGlhbC5hY2Nlc3NUb2tlbjtcclxuICogYGBgXHJcbiAqXHJcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cclxuICogQHBhcmFtIHByb3ZpZGVyIC0gVGhlIHByb3ZpZGVyIHRvIGF1dGhlbnRpY2F0ZS4gVGhlIHByb3ZpZGVyIGhhcyB0byBiZSBhbiB7QGxpbmsgT0F1dGhQcm92aWRlcn0uXHJcbiAqIE5vbi1PQXV0aCBwcm92aWRlcnMgbGlrZSB7QGxpbmsgRW1haWxBdXRoUHJvdmlkZXJ9IHdpbGwgdGhyb3cgYW4gZXJyb3IuXHJcbiAqIEBwYXJhbSByZXNvbHZlciAtIEFuIGluc3RhbmNlIG9mIHtAbGluayBQb3B1cFJlZGlyZWN0UmVzb2x2ZXJ9LCBvcHRpb25hbFxyXG4gKiBpZiBhbHJlYWR5IHN1cHBsaWVkIHRvIHtAbGluayBpbml0aWFsaXplQXV0aH0gb3IgcHJvdmlkZWQgYnkge0BsaW5rIGdldEF1dGh9LlxyXG4gKlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBzaWduSW5XaXRoUG9wdXAoYXV0aCwgcHJvdmlkZXIsIHJlc29sdmVyKSB7XHJcbiAgICBjb25zdCBhdXRoSW50ZXJuYWwgPSBfY2FzdEF1dGgoYXV0aCk7XHJcbiAgICBfYXNzZXJ0KHByb3ZpZGVyIGluc3RhbmNlb2YgRmVkZXJhdGVkQXV0aFByb3ZpZGVyLCBhdXRoLCBcImFyZ3VtZW50LWVycm9yXCIgLyogQVJHVU1FTlRfRVJST1IgKi8pO1xyXG4gICAgY29uc3QgcmVzb2x2ZXJJbnRlcm5hbCA9IF93aXRoRGVmYXVsdFJlc29sdmVyKGF1dGhJbnRlcm5hbCwgcmVzb2x2ZXIpO1xyXG4gICAgY29uc3QgYWN0aW9uID0gbmV3IFBvcHVwT3BlcmF0aW9uKGF1dGhJbnRlcm5hbCwgXCJzaWduSW5WaWFQb3B1cFwiIC8qIFNJR05fSU5fVklBX1BPUFVQICovLCBwcm92aWRlciwgcmVzb2x2ZXJJbnRlcm5hbCk7XHJcbiAgICByZXR1cm4gYWN0aW9uLmV4ZWN1dGVOb3ROdWxsKCk7XHJcbn1cclxuLyoqXHJcbiAqIFJlYXV0aGVudGljYXRlcyB0aGUgY3VycmVudCB1c2VyIHdpdGggdGhlIHNwZWNpZmllZCB7QGxpbmsgT0F1dGhQcm92aWRlcn0gdXNpbmcgYSBwb3AtdXAgYmFzZWRcclxuICogT0F1dGggZmxvdy5cclxuICpcclxuICogQHJlbWFya3NcclxuICogSWYgdGhlIHJlYXV0aGVudGljYXRpb24gaXMgc3VjY2Vzc2Z1bCwgdGhlIHJldHVybmVkIHJlc3VsdCB3aWxsIGNvbnRhaW4gdGhlIHVzZXIgYW5kIHRoZVxyXG4gKiBwcm92aWRlcidzIGNyZWRlbnRpYWwuXHJcbiAqXHJcbiAqIEBleGFtcGxlXHJcbiAqIGBgYGphdmFzY3JpcHRcclxuICogLy8gU2lnbiBpbiB1c2luZyBhIHBvcHVwLlxyXG4gKiBjb25zdCBwcm92aWRlciA9IG5ldyBGYWNlYm9va0F1dGhQcm92aWRlcigpO1xyXG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBzaWduSW5XaXRoUG9wdXAoYXV0aCwgcHJvdmlkZXIpO1xyXG4gKiAvLyBSZWF1dGhlbnRpY2F0ZSB1c2luZyBhIHBvcHVwLlxyXG4gKiBhd2FpdCByZWF1dGhlbnRpY2F0ZVdpdGhQb3B1cChyZXN1bHQudXNlciwgcHJvdmlkZXIpO1xyXG4gKiBgYGBcclxuICpcclxuICogQHBhcmFtIHVzZXIgLSBUaGUgdXNlci5cclxuICogQHBhcmFtIHByb3ZpZGVyIC0gVGhlIHByb3ZpZGVyIHRvIGF1dGhlbnRpY2F0ZS4gVGhlIHByb3ZpZGVyIGhhcyB0byBiZSBhbiB7QGxpbmsgT0F1dGhQcm92aWRlcn0uXHJcbiAqIE5vbi1PQXV0aCBwcm92aWRlcnMgbGlrZSB7QGxpbmsgRW1haWxBdXRoUHJvdmlkZXJ9IHdpbGwgdGhyb3cgYW4gZXJyb3IuXHJcbiAqIEBwYXJhbSByZXNvbHZlciAtIEFuIGluc3RhbmNlIG9mIHtAbGluayBQb3B1cFJlZGlyZWN0UmVzb2x2ZXJ9LCBvcHRpb25hbFxyXG4gKiBpZiBhbHJlYWR5IHN1cHBsaWVkIHRvIHtAbGluayBpbml0aWFsaXplQXV0aH0gb3IgcHJvdmlkZWQgYnkge0BsaW5rIGdldEF1dGh9LlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiByZWF1dGhlbnRpY2F0ZVdpdGhQb3B1cCh1c2VyLCBwcm92aWRlciwgcmVzb2x2ZXIpIHtcclxuICAgIGNvbnN0IHVzZXJJbnRlcm5hbCA9IGdldE1vZHVsYXJJbnN0YW5jZSh1c2VyKTtcclxuICAgIF9hc3NlcnQocHJvdmlkZXIgaW5zdGFuY2VvZiBGZWRlcmF0ZWRBdXRoUHJvdmlkZXIsIHVzZXJJbnRlcm5hbC5hdXRoLCBcImFyZ3VtZW50LWVycm9yXCIgLyogQVJHVU1FTlRfRVJST1IgKi8pO1xyXG4gICAgY29uc3QgcmVzb2x2ZXJJbnRlcm5hbCA9IF93aXRoRGVmYXVsdFJlc29sdmVyKHVzZXJJbnRlcm5hbC5hdXRoLCByZXNvbHZlcik7XHJcbiAgICBjb25zdCBhY3Rpb24gPSBuZXcgUG9wdXBPcGVyYXRpb24odXNlckludGVybmFsLmF1dGgsIFwicmVhdXRoVmlhUG9wdXBcIiAvKiBSRUFVVEhfVklBX1BPUFVQICovLCBwcm92aWRlciwgcmVzb2x2ZXJJbnRlcm5hbCwgdXNlckludGVybmFsKTtcclxuICAgIHJldHVybiBhY3Rpb24uZXhlY3V0ZU5vdE51bGwoKTtcclxufVxyXG4vKipcclxuICogTGlua3MgdGhlIGF1dGhlbnRpY2F0ZWQgcHJvdmlkZXIgdG8gdGhlIHVzZXIgYWNjb3VudCB1c2luZyBhIHBvcC11cCBiYXNlZCBPQXV0aCBmbG93LlxyXG4gKlxyXG4gKiBAcmVtYXJrc1xyXG4gKiBJZiB0aGUgbGlua2luZyBpcyBzdWNjZXNzZnVsLCB0aGUgcmV0dXJuZWQgcmVzdWx0IHdpbGwgY29udGFpbiB0aGUgdXNlciBhbmQgdGhlIHByb3ZpZGVyJ3MgY3JlZGVudGlhbC5cclxuICpcclxuICpcclxuICogQGV4YW1wbGVcclxuICogYGBgamF2YXNjcmlwdFxyXG4gKiAvLyBTaWduIGluIHVzaW5nIHNvbWUgb3RoZXIgcHJvdmlkZXIuXHJcbiAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNpZ25JbldpdGhFbWFpbEFuZFBhc3N3b3JkKGF1dGgsIGVtYWlsLCBwYXNzd29yZCk7XHJcbiAqIC8vIExpbmsgdXNpbmcgYSBwb3B1cC5cclxuICogY29uc3QgcHJvdmlkZXIgPSBuZXcgRmFjZWJvb2tBdXRoUHJvdmlkZXIoKTtcclxuICogYXdhaXQgbGlua1dpdGhQb3B1cChyZXN1bHQudXNlciwgcHJvdmlkZXIpO1xyXG4gKiBgYGBcclxuICpcclxuICogQHBhcmFtIHVzZXIgLSBUaGUgdXNlci5cclxuICogQHBhcmFtIHByb3ZpZGVyIC0gVGhlIHByb3ZpZGVyIHRvIGF1dGhlbnRpY2F0ZS4gVGhlIHByb3ZpZGVyIGhhcyB0byBiZSBhbiB7QGxpbmsgT0F1dGhQcm92aWRlcn0uXHJcbiAqIE5vbi1PQXV0aCBwcm92aWRlcnMgbGlrZSB7QGxpbmsgRW1haWxBdXRoUHJvdmlkZXJ9IHdpbGwgdGhyb3cgYW4gZXJyb3IuXHJcbiAqIEBwYXJhbSByZXNvbHZlciAtIEFuIGluc3RhbmNlIG9mIHtAbGluayBQb3B1cFJlZGlyZWN0UmVzb2x2ZXJ9LCBvcHRpb25hbFxyXG4gKiBpZiBhbHJlYWR5IHN1cHBsaWVkIHRvIHtAbGluayBpbml0aWFsaXplQXV0aH0gb3IgcHJvdmlkZWQgYnkge0BsaW5rIGdldEF1dGh9LlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBsaW5rV2l0aFBvcHVwKHVzZXIsIHByb3ZpZGVyLCByZXNvbHZlcikge1xyXG4gICAgY29uc3QgdXNlckludGVybmFsID0gZ2V0TW9kdWxhckluc3RhbmNlKHVzZXIpO1xyXG4gICAgX2Fzc2VydChwcm92aWRlciBpbnN0YW5jZW9mIEZlZGVyYXRlZEF1dGhQcm92aWRlciwgdXNlckludGVybmFsLmF1dGgsIFwiYXJndW1lbnQtZXJyb3JcIiAvKiBBUkdVTUVOVF9FUlJPUiAqLyk7XHJcbiAgICBjb25zdCByZXNvbHZlckludGVybmFsID0gX3dpdGhEZWZhdWx0UmVzb2x2ZXIodXNlckludGVybmFsLmF1dGgsIHJlc29sdmVyKTtcclxuICAgIGNvbnN0IGFjdGlvbiA9IG5ldyBQb3B1cE9wZXJhdGlvbih1c2VySW50ZXJuYWwuYXV0aCwgXCJsaW5rVmlhUG9wdXBcIiAvKiBMSU5LX1ZJQV9QT1BVUCAqLywgcHJvdmlkZXIsIHJlc29sdmVySW50ZXJuYWwsIHVzZXJJbnRlcm5hbCk7XHJcbiAgICByZXR1cm4gYWN0aW9uLmV4ZWN1dGVOb3ROdWxsKCk7XHJcbn1cclxuLyoqXHJcbiAqIFBvcHVwIGV2ZW50IG1hbmFnZXIuIEhhbmRsZXMgdGhlIHBvcHVwJ3MgZW50aXJlIGxpZmVjeWNsZTsgbGlzdGVucyB0byBhdXRoXHJcbiAqIGV2ZW50c1xyXG4gKlxyXG4gKi9cclxuY2xhc3MgUG9wdXBPcGVyYXRpb24gZXh0ZW5kcyBBYnN0cmFjdFBvcHVwUmVkaXJlY3RPcGVyYXRpb24ge1xyXG4gICAgY29uc3RydWN0b3IoYXV0aCwgZmlsdGVyLCBwcm92aWRlciwgcmVzb2x2ZXIsIHVzZXIpIHtcclxuICAgICAgICBzdXBlcihhdXRoLCBmaWx0ZXIsIHJlc29sdmVyLCB1c2VyKTtcclxuICAgICAgICB0aGlzLnByb3ZpZGVyID0gcHJvdmlkZXI7XHJcbiAgICAgICAgdGhpcy5hdXRoV2luZG93ID0gbnVsbDtcclxuICAgICAgICB0aGlzLnBvbGxJZCA9IG51bGw7XHJcbiAgICAgICAgaWYgKFBvcHVwT3BlcmF0aW9uLmN1cnJlbnRQb3B1cEFjdGlvbikge1xyXG4gICAgICAgICAgICBQb3B1cE9wZXJhdGlvbi5jdXJyZW50UG9wdXBBY3Rpb24uY2FuY2VsKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFBvcHVwT3BlcmF0aW9uLmN1cnJlbnRQb3B1cEFjdGlvbiA9IHRoaXM7XHJcbiAgICB9XHJcbiAgICBhc3luYyBleGVjdXRlTm90TnVsbCgpIHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmV4ZWN1dGUoKTtcclxuICAgICAgICBfYXNzZXJ0KHJlc3VsdCwgdGhpcy5hdXRoLCBcImludGVybmFsLWVycm9yXCIgLyogSU5URVJOQUxfRVJST1IgKi8pO1xyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcbiAgICBhc3luYyBvbkV4ZWN1dGlvbigpIHtcclxuICAgICAgICBkZWJ1Z0Fzc2VydCh0aGlzLmZpbHRlci5sZW5ndGggPT09IDEsICdQb3B1cCBvcGVyYXRpb25zIG9ubHkgaGFuZGxlIG9uZSBldmVudCcpO1xyXG4gICAgICAgIGNvbnN0IGV2ZW50SWQgPSBfZ2VuZXJhdGVFdmVudElkKCk7XHJcbiAgICAgICAgdGhpcy5hdXRoV2luZG93ID0gYXdhaXQgdGhpcy5yZXNvbHZlci5fb3BlblBvcHVwKHRoaXMuYXV0aCwgdGhpcy5wcm92aWRlciwgdGhpcy5maWx0ZXJbMF0sIC8vIFRoZXJlJ3MgYWx3YXlzIG9uZSwgc2VlIGNvbnN0cnVjdG9yXHJcbiAgICAgICAgZXZlbnRJZCk7XHJcbiAgICAgICAgdGhpcy5hdXRoV2luZG93LmFzc29jaWF0ZWRFdmVudCA9IGV2ZW50SWQ7XHJcbiAgICAgICAgLy8gQ2hlY2sgZm9yIHdlYiBzdG9yYWdlIHN1cHBvcnQgYW5kIG9yaWdpbiB2YWxpZGF0aW9uIF9hZnRlcl8gdGhlIHBvcHVwIGlzXHJcbiAgICAgICAgLy8gbG9hZGVkLiBUaGVzZSBvcGVyYXRpb25zIGFyZSBzbG93ICh+MSBzZWNvbmQgb3Igc28pIFJhdGhlciB0aGFuXHJcbiAgICAgICAgLy8gd2FpdGluZyBvbiB0aGVtIGJlZm9yZSBvcGVuaW5nIHRoZSB3aW5kb3csIG9wdGltaXN0aWNhbGx5IG9wZW4gdGhlIHBvcHVwXHJcbiAgICAgICAgLy8gYW5kIGNoZWNrIGZvciBzdG9yYWdlIHN1cHBvcnQgYXQgdGhlIHNhbWUgdGltZS4gSWYgc3RvcmFnZSBzdXBwb3J0IGlzXHJcbiAgICAgICAgLy8gbm90IGF2YWlsYWJsZSwgdGhpcyB3aWxsIGNhdXNlIHRoZSB3aG9sZSB0aGluZyB0byByZWplY3QgcHJvcGVybHkuIEl0XHJcbiAgICAgICAgLy8gd2lsbCBhbHNvIGNsb3NlIHRoZSBwb3B1cCwgYnV0IHNpbmNlIHRoZSBwcm9taXNlIGhhcyBhbHJlYWR5IHJlamVjdGVkLFxyXG4gICAgICAgIC8vIHRoZSBwb3B1cCBjbG9zZWQgYnkgdXNlciBwb2xsIHdpbGwgcmVqZWN0IGludG8gdGhlIHZvaWQuXHJcbiAgICAgICAgdGhpcy5yZXNvbHZlci5fb3JpZ2luVmFsaWRhdGlvbih0aGlzLmF1dGgpLmNhdGNoKGUgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnJlamVjdChlKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnJlc29sdmVyLl9pc0lmcmFtZVdlYlN0b3JhZ2VTdXBwb3J0ZWQodGhpcy5hdXRoLCBpc1N1cHBvcnRlZCA9PiB7XHJcbiAgICAgICAgICAgIGlmICghaXNTdXBwb3J0ZWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVqZWN0KF9jcmVhdGVFcnJvcih0aGlzLmF1dGgsIFwid2ViLXN0b3JhZ2UtdW5zdXBwb3J0ZWRcIiAvKiBXRUJfU1RPUkFHRV9VTlNVUFBPUlRFRCAqLykpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy8gSGFuZGxlIHVzZXIgY2xvc3VyZS4gTm90aWNlIHRoaXMgZG9lcyAqbm90KiB1c2UgYXdhaXRcclxuICAgICAgICB0aGlzLnBvbGxVc2VyQ2FuY2VsbGF0aW9uKCk7XHJcbiAgICB9XHJcbiAgICBnZXQgZXZlbnRJZCgpIHtcclxuICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgcmV0dXJuICgoX2EgPSB0aGlzLmF1dGhXaW5kb3cpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5hc3NvY2lhdGVkRXZlbnQpIHx8IG51bGw7XHJcbiAgICB9XHJcbiAgICBjYW5jZWwoKSB7XHJcbiAgICAgICAgdGhpcy5yZWplY3QoX2NyZWF0ZUVycm9yKHRoaXMuYXV0aCwgXCJjYW5jZWxsZWQtcG9wdXAtcmVxdWVzdFwiIC8qIEVYUElSRURfUE9QVVBfUkVRVUVTVCAqLykpO1xyXG4gICAgfVxyXG4gICAgY2xlYW5VcCgpIHtcclxuICAgICAgICBpZiAodGhpcy5hdXRoV2luZG93KSB7XHJcbiAgICAgICAgICAgIHRoaXMuYXV0aFdpbmRvdy5jbG9zZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5wb2xsSWQpIHtcclxuICAgICAgICAgICAgd2luZG93LmNsZWFyVGltZW91dCh0aGlzLnBvbGxJZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuYXV0aFdpbmRvdyA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5wb2xsSWQgPSBudWxsO1xyXG4gICAgICAgIFBvcHVwT3BlcmF0aW9uLmN1cnJlbnRQb3B1cEFjdGlvbiA9IG51bGw7XHJcbiAgICB9XHJcbiAgICBwb2xsVXNlckNhbmNlbGxhdGlvbigpIHtcclxuICAgICAgICBjb25zdCBwb2xsID0gKCkgPT4ge1xyXG4gICAgICAgICAgICB2YXIgX2EsIF9iO1xyXG4gICAgICAgICAgICBpZiAoKF9iID0gKF9hID0gdGhpcy5hdXRoV2luZG93KSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Eud2luZG93KSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuY2xvc2VkKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBNYWtlIHN1cmUgdGhhdCB0aGVyZSBpcyBzdWZmaWNpZW50IHRpbWUgZm9yIHdoYXRldmVyIGFjdGlvbiB0b1xyXG4gICAgICAgICAgICAgICAgLy8gY29tcGxldGUuIFRoZSB3aW5kb3cgY291bGQgaGF2ZSBjbG9zZWQgYnV0IHRoZSBzaWduIGluIG5ldHdvcmtcclxuICAgICAgICAgICAgICAgIC8vIGNhbGwgY291bGQgc3RpbGwgYmUgaW4gZmxpZ2h0LlxyXG4gICAgICAgICAgICAgICAgdGhpcy5wb2xsSWQgPSB3aW5kb3cuc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wb2xsSWQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVqZWN0KF9jcmVhdGVFcnJvcih0aGlzLmF1dGgsIFwicG9wdXAtY2xvc2VkLWJ5LXVzZXJcIiAvKiBQT1BVUF9DTE9TRURfQllfVVNFUiAqLykpO1xyXG4gICAgICAgICAgICAgICAgfSwgMjAwMCAvKiBBVVRIX0VWRU5UICovKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnBvbGxJZCA9IHdpbmRvdy5zZXRUaW1lb3V0KHBvbGwsIF9QT0xMX1dJTkRPV19DTE9TRV9USU1FT1VULmdldCgpKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHBvbGwoKTtcclxuICAgIH1cclxufVxyXG4vLyBPbmx5IG9uZSBwb3B1cCBpcyBldmVyIHNob3duIGF0IG9uY2UuIFRoZSBsaWZlY3ljbGUgb2YgdGhlIGN1cnJlbnQgcG9wdXBcclxuLy8gY2FuIGJlIG1hbmFnZWQgLyBjYW5jZWxsZWQgYnkgdGhlIGNvbnN0cnVjdG9yLlxyXG5Qb3B1cE9wZXJhdGlvbi5jdXJyZW50UG9wdXBBY3Rpb24gPSBudWxsO1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jb25zdCBQRU5ESU5HX1JFRElSRUNUX0tFWSA9ICdwZW5kaW5nUmVkaXJlY3QnO1xyXG4vLyBXZSBvbmx5IGdldCBvbmUgcmVkaXJlY3Qgb3V0Y29tZSBmb3IgYW55IG9uZSBhdXRoLCBzbyBqdXN0IHN0b3JlIGl0XHJcbi8vIGluIGhlcmUuXHJcbmNvbnN0IHJlZGlyZWN0T3V0Y29tZU1hcCA9IG5ldyBNYXAoKTtcclxuY2xhc3MgUmVkaXJlY3RBY3Rpb24gZXh0ZW5kcyBBYnN0cmFjdFBvcHVwUmVkaXJlY3RPcGVyYXRpb24ge1xyXG4gICAgY29uc3RydWN0b3IoYXV0aCwgcmVzb2x2ZXIsIGJ5cGFzc0F1dGhTdGF0ZSA9IGZhbHNlKSB7XHJcbiAgICAgICAgc3VwZXIoYXV0aCwgW1xyXG4gICAgICAgICAgICBcInNpZ25JblZpYVJlZGlyZWN0XCIgLyogU0lHTl9JTl9WSUFfUkVESVJFQ1QgKi8sXHJcbiAgICAgICAgICAgIFwibGlua1ZpYVJlZGlyZWN0XCIgLyogTElOS19WSUFfUkVESVJFQ1QgKi8sXHJcbiAgICAgICAgICAgIFwicmVhdXRoVmlhUmVkaXJlY3RcIiAvKiBSRUFVVEhfVklBX1JFRElSRUNUICovLFxyXG4gICAgICAgICAgICBcInVua25vd25cIiAvKiBVTktOT1dOICovXHJcbiAgICAgICAgXSwgcmVzb2x2ZXIsIHVuZGVmaW5lZCwgYnlwYXNzQXV0aFN0YXRlKTtcclxuICAgICAgICB0aGlzLmV2ZW50SWQgPSBudWxsO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBPdmVycmlkZSB0aGUgZXhlY3V0ZSBmdW5jdGlvbjsgaWYgd2UgYWxyZWFkeSBoYXZlIGEgcmVkaXJlY3QgcmVzdWx0LCB0aGVuXHJcbiAgICAgKiBqdXN0IHJldHVybiBpdC5cclxuICAgICAqL1xyXG4gICAgYXN5bmMgZXhlY3V0ZSgpIHtcclxuICAgICAgICBsZXQgcmVhZHlPdXRjb21lID0gcmVkaXJlY3RPdXRjb21lTWFwLmdldCh0aGlzLmF1dGguX2tleSgpKTtcclxuICAgICAgICBpZiAoIXJlYWR5T3V0Y29tZSkge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaGFzUGVuZGluZ1JlZGlyZWN0ID0gYXdhaXQgX2dldEFuZENsZWFyUGVuZGluZ1JlZGlyZWN0U3RhdHVzKHRoaXMucmVzb2x2ZXIsIHRoaXMuYXV0aCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBoYXNQZW5kaW5nUmVkaXJlY3QgPyBhd2FpdCBzdXBlci5leGVjdXRlKCkgOiBudWxsO1xyXG4gICAgICAgICAgICAgICAgcmVhZHlPdXRjb21lID0gKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHJlc3VsdCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgIHJlYWR5T3V0Y29tZSA9ICgpID0+IFByb21pc2UucmVqZWN0KGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJlZGlyZWN0T3V0Y29tZU1hcC5zZXQodGhpcy5hdXRoLl9rZXkoKSwgcmVhZHlPdXRjb21lKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlYWR5T3V0Y29tZSgpO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgb25BdXRoRXZlbnQoZXZlbnQpIHtcclxuICAgICAgICBpZiAoZXZlbnQudHlwZSA9PT0gXCJzaWduSW5WaWFSZWRpcmVjdFwiIC8qIFNJR05fSU5fVklBX1JFRElSRUNUICovKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBzdXBlci5vbkF1dGhFdmVudChldmVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGV2ZW50LnR5cGUgPT09IFwidW5rbm93blwiIC8qIFVOS05PV04gKi8pIHtcclxuICAgICAgICAgICAgLy8gVGhpcyBpcyBhIHNlbnRpbmVsIHZhbHVlIGluZGljYXRpbmcgdGhlcmUncyBubyBwZW5kaW5nIHJlZGlyZWN0XHJcbiAgICAgICAgICAgIHRoaXMucmVzb2x2ZShudWxsKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZXZlbnQuZXZlbnRJZCkge1xyXG4gICAgICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgdGhpcy5hdXRoLl9yZWRpcmVjdFVzZXJGb3JJZChldmVudC5ldmVudElkKTtcclxuICAgICAgICAgICAgaWYgKHVzZXIpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudXNlciA9IHVzZXI7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIub25BdXRoRXZlbnQoZXZlbnQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZXNvbHZlKG51bGwpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgYXN5bmMgb25FeGVjdXRpb24oKSB7IH1cclxuICAgIGNsZWFuVXAoKSB7IH1cclxufVxyXG5hc3luYyBmdW5jdGlvbiBfZ2V0QW5kQ2xlYXJQZW5kaW5nUmVkaXJlY3RTdGF0dXMocmVzb2x2ZXIsIGF1dGgpIHtcclxuICAgIGNvbnN0IGtleSA9IHBlbmRpbmdSZWRpcmVjdEtleShhdXRoKTtcclxuICAgIGNvbnN0IGhhc1BlbmRpbmdSZWRpcmVjdCA9IChhd2FpdCByZXNvbHZlclBlcnNpc3RlbmNlKHJlc29sdmVyKS5fZ2V0KGtleSkpID09PSAndHJ1ZSc7XHJcbiAgICBhd2FpdCByZXNvbHZlclBlcnNpc3RlbmNlKHJlc29sdmVyKS5fcmVtb3ZlKGtleSk7XHJcbiAgICByZXR1cm4gaGFzUGVuZGluZ1JlZGlyZWN0O1xyXG59XHJcbmFzeW5jIGZ1bmN0aW9uIF9zZXRQZW5kaW5nUmVkaXJlY3RTdGF0dXMocmVzb2x2ZXIsIGF1dGgpIHtcclxuICAgIHJldHVybiByZXNvbHZlclBlcnNpc3RlbmNlKHJlc29sdmVyKS5fc2V0KHBlbmRpbmdSZWRpcmVjdEtleShhdXRoKSwgJ3RydWUnKTtcclxufVxyXG5mdW5jdGlvbiBfY2xlYXJSZWRpcmVjdE91dGNvbWVzKCkge1xyXG4gICAgcmVkaXJlY3RPdXRjb21lTWFwLmNsZWFyKCk7XHJcbn1cclxuZnVuY3Rpb24gcmVzb2x2ZXJQZXJzaXN0ZW5jZShyZXNvbHZlcikge1xyXG4gICAgcmV0dXJuIF9nZXRJbnN0YW5jZShyZXNvbHZlci5fcmVkaXJlY3RQZXJzaXN0ZW5jZSk7XHJcbn1cclxuZnVuY3Rpb24gcGVuZGluZ1JlZGlyZWN0S2V5KGF1dGgpIHtcclxuICAgIHJldHVybiBfcGVyc2lzdGVuY2VLZXlOYW1lKFBFTkRJTkdfUkVESVJFQ1RfS0VZLCBhdXRoLmNvbmZpZy5hcGlLZXksIGF1dGgubmFtZSk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEF1dGhlbnRpY2F0ZXMgYSBGaXJlYmFzZSBjbGllbnQgdXNpbmcgYSBmdWxsLXBhZ2UgcmVkaXJlY3QgZmxvdy5cclxuICpcclxuICogQHJlbWFya3NcclxuICogVG8gaGFuZGxlIHRoZSByZXN1bHRzIGFuZCBlcnJvcnMgZm9yIHRoaXMgb3BlcmF0aW9uLCByZWZlciB0byB7QGxpbmsgZ2V0UmVkaXJlY3RSZXN1bHR9LlxyXG4gKlxyXG4gKiBAZXhhbXBsZVxyXG4gKiBgYGBqYXZhc2NyaXB0XHJcbiAqIC8vIFNpZ24gaW4gdXNpbmcgYSByZWRpcmVjdC5cclxuICogY29uc3QgcHJvdmlkZXIgPSBuZXcgRmFjZWJvb2tBdXRoUHJvdmlkZXIoKTtcclxuICogLy8gWW91IGNhbiBhZGQgYWRkaXRpb25hbCBzY29wZXMgdG8gdGhlIHByb3ZpZGVyOlxyXG4gKiBwcm92aWRlci5hZGRTY29wZSgndXNlcl9iaXJ0aGRheScpO1xyXG4gKiAvLyBTdGFydCBhIHNpZ24gaW4gcHJvY2VzcyBmb3IgYW4gdW5hdXRoZW50aWNhdGVkIHVzZXIuXHJcbiAqIGF3YWl0IHNpZ25JbldpdGhSZWRpcmVjdChhdXRoLCBwcm92aWRlcik7XHJcbiAqIC8vIFRoaXMgd2lsbCB0cmlnZ2VyIGEgZnVsbCBwYWdlIHJlZGlyZWN0IGF3YXkgZnJvbSB5b3VyIGFwcFxyXG4gKlxyXG4gKiAvLyBBZnRlciByZXR1cm5pbmcgZnJvbSB0aGUgcmVkaXJlY3Qgd2hlbiB5b3VyIGFwcCBpbml0aWFsaXplcyB5b3UgY2FuIG9idGFpbiB0aGUgcmVzdWx0XHJcbiAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdldFJlZGlyZWN0UmVzdWx0KGF1dGgpO1xyXG4gKiBpZiAocmVzdWx0KSB7XHJcbiAqICAgLy8gVGhpcyBpcyB0aGUgc2lnbmVkLWluIHVzZXJcclxuICogICBjb25zdCB1c2VyID0gcmVzdWx0LnVzZXI7XHJcbiAqICAgLy8gVGhpcyBnaXZlcyB5b3UgYSBGYWNlYm9vayBBY2Nlc3MgVG9rZW4uXHJcbiAqICAgY29uc3QgY3JlZGVudGlhbCA9IHByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tUmVzdWx0KGF1dGgsIHJlc3VsdCk7XHJcbiAqICAgY29uc3QgdG9rZW4gPSBjcmVkZW50aWFsLmFjY2Vzc1Rva2VuO1xyXG4gKiB9XHJcbiAqIC8vIEFzIHRoaXMgQVBJIGNhbiBiZSB1c2VkIGZvciBzaWduLWluLCBsaW5raW5nIGFuZCByZWF1dGhlbnRpY2F0aW9uLFxyXG4gKiAvLyBjaGVjayB0aGUgb3BlcmF0aW9uVHlwZSB0byBkZXRlcm1pbmUgd2hhdCB0cmlnZ2VyZWQgdGhpcyByZWRpcmVjdFxyXG4gKiAvLyBvcGVyYXRpb24uXHJcbiAqIGNvbnN0IG9wZXJhdGlvblR5cGUgPSByZXN1bHQub3BlcmF0aW9uVHlwZTtcclxuICogYGBgXHJcbiAqXHJcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cclxuICogQHBhcmFtIHByb3ZpZGVyIC0gVGhlIHByb3ZpZGVyIHRvIGF1dGhlbnRpY2F0ZS4gVGhlIHByb3ZpZGVyIGhhcyB0byBiZSBhbiB7QGxpbmsgT0F1dGhQcm92aWRlcn0uXHJcbiAqIE5vbi1PQXV0aCBwcm92aWRlcnMgbGlrZSB7QGxpbmsgRW1haWxBdXRoUHJvdmlkZXJ9IHdpbGwgdGhyb3cgYW4gZXJyb3IuXHJcbiAqIEBwYXJhbSByZXNvbHZlciAtIEFuIGluc3RhbmNlIG9mIHtAbGluayBQb3B1cFJlZGlyZWN0UmVzb2x2ZXJ9LCBvcHRpb25hbFxyXG4gKiBpZiBhbHJlYWR5IHN1cHBsaWVkIHRvIHtAbGluayBpbml0aWFsaXplQXV0aH0gb3IgcHJvdmlkZWQgYnkge0BsaW5rIGdldEF1dGh9LlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5mdW5jdGlvbiBzaWduSW5XaXRoUmVkaXJlY3QoYXV0aCwgcHJvdmlkZXIsIHJlc29sdmVyKSB7XHJcbiAgICByZXR1cm4gX3NpZ25JbldpdGhSZWRpcmVjdChhdXRoLCBwcm92aWRlciwgcmVzb2x2ZXIpO1xyXG59XHJcbmFzeW5jIGZ1bmN0aW9uIF9zaWduSW5XaXRoUmVkaXJlY3QoYXV0aCwgcHJvdmlkZXIsIHJlc29sdmVyKSB7XHJcbiAgICBjb25zdCBhdXRoSW50ZXJuYWwgPSBfY2FzdEF1dGgoYXV0aCk7XHJcbiAgICBfYXNzZXJ0KHByb3ZpZGVyIGluc3RhbmNlb2YgRmVkZXJhdGVkQXV0aFByb3ZpZGVyLCBhdXRoLCBcImFyZ3VtZW50LWVycm9yXCIgLyogQVJHVU1FTlRfRVJST1IgKi8pO1xyXG4gICAgY29uc3QgcmVzb2x2ZXJJbnRlcm5hbCA9IF93aXRoRGVmYXVsdFJlc29sdmVyKGF1dGhJbnRlcm5hbCwgcmVzb2x2ZXIpO1xyXG4gICAgYXdhaXQgX3NldFBlbmRpbmdSZWRpcmVjdFN0YXR1cyhyZXNvbHZlckludGVybmFsLCBhdXRoSW50ZXJuYWwpO1xyXG4gICAgcmV0dXJuIHJlc29sdmVySW50ZXJuYWwuX29wZW5SZWRpcmVjdChhdXRoSW50ZXJuYWwsIHByb3ZpZGVyLCBcInNpZ25JblZpYVJlZGlyZWN0XCIgLyogU0lHTl9JTl9WSUFfUkVESVJFQ1QgKi8pO1xyXG59XHJcbi8qKlxyXG4gKiBSZWF1dGhlbnRpY2F0ZXMgdGhlIGN1cnJlbnQgdXNlciB3aXRoIHRoZSBzcGVjaWZpZWQge0BsaW5rIE9BdXRoUHJvdmlkZXJ9IHVzaW5nIGEgZnVsbC1wYWdlIHJlZGlyZWN0IGZsb3cuXHJcbiAqXHJcbiAqIEBleGFtcGxlXHJcbiAqIGBgYGphdmFzY3JpcHRcclxuICogLy8gU2lnbiBpbiB1c2luZyBhIHJlZGlyZWN0LlxyXG4gKiBjb25zdCBwcm92aWRlciA9IG5ldyBGYWNlYm9va0F1dGhQcm92aWRlcigpO1xyXG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBzaWduSW5XaXRoUmVkaXJlY3QoYXV0aCwgcHJvdmlkZXIpO1xyXG4gKiAvLyBUaGlzIHdpbGwgdHJpZ2dlciBhIGZ1bGwgcGFnZSByZWRpcmVjdCBhd2F5IGZyb20geW91ciBhcHBcclxuICpcclxuICogLy8gQWZ0ZXIgcmV0dXJuaW5nIGZyb20gdGhlIHJlZGlyZWN0IHdoZW4geW91ciBhcHAgaW5pdGlhbGl6ZXMgeW91IGNhbiBvYnRhaW4gdGhlIHJlc3VsdFxyXG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRSZWRpcmVjdFJlc3VsdChhdXRoKTtcclxuICogLy8gTGluayB1c2luZyBhIHJlZGlyZWN0LlxyXG4gKiBhd2FpdCBsaW5rV2l0aFJlZGlyZWN0KHJlc3VsdC51c2VyLCBwcm92aWRlcik7XHJcbiAqIC8vIFRoaXMgd2lsbCBhZ2FpbiB0cmlnZ2VyIGEgZnVsbCBwYWdlIHJlZGlyZWN0IGF3YXkgZnJvbSB5b3VyIGFwcFxyXG4gKlxyXG4gKiAvLyBBZnRlciByZXR1cm5pbmcgZnJvbSB0aGUgcmVkaXJlY3Qgd2hlbiB5b3VyIGFwcCBpbml0aWFsaXplcyB5b3UgY2FuIG9idGFpbiB0aGUgcmVzdWx0XHJcbiAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdldFJlZGlyZWN0UmVzdWx0KGF1dGgpO1xyXG4gKiBgYGBcclxuICpcclxuICogQHBhcmFtIHVzZXIgLSBUaGUgdXNlci5cclxuICogQHBhcmFtIHByb3ZpZGVyIC0gVGhlIHByb3ZpZGVyIHRvIGF1dGhlbnRpY2F0ZS4gVGhlIHByb3ZpZGVyIGhhcyB0byBiZSBhbiB7QGxpbmsgT0F1dGhQcm92aWRlcn0uXHJcbiAqIE5vbi1PQXV0aCBwcm92aWRlcnMgbGlrZSB7QGxpbmsgRW1haWxBdXRoUHJvdmlkZXJ9IHdpbGwgdGhyb3cgYW4gZXJyb3IuXHJcbiAqIEBwYXJhbSByZXNvbHZlciAtIEFuIGluc3RhbmNlIG9mIHtAbGluayBQb3B1cFJlZGlyZWN0UmVzb2x2ZXJ9LCBvcHRpb25hbFxyXG4gKiBpZiBhbHJlYWR5IHN1cHBsaWVkIHRvIHtAbGluayBpbml0aWFsaXplQXV0aH0gb3IgcHJvdmlkZWQgYnkge0BsaW5rIGdldEF1dGh9LlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5mdW5jdGlvbiByZWF1dGhlbnRpY2F0ZVdpdGhSZWRpcmVjdCh1c2VyLCBwcm92aWRlciwgcmVzb2x2ZXIpIHtcclxuICAgIHJldHVybiBfcmVhdXRoZW50aWNhdGVXaXRoUmVkaXJlY3QodXNlciwgcHJvdmlkZXIsIHJlc29sdmVyKTtcclxufVxyXG5hc3luYyBmdW5jdGlvbiBfcmVhdXRoZW50aWNhdGVXaXRoUmVkaXJlY3QodXNlciwgcHJvdmlkZXIsIHJlc29sdmVyKSB7XHJcbiAgICBjb25zdCB1c2VySW50ZXJuYWwgPSBnZXRNb2R1bGFySW5zdGFuY2UodXNlcik7XHJcbiAgICBfYXNzZXJ0KHByb3ZpZGVyIGluc3RhbmNlb2YgRmVkZXJhdGVkQXV0aFByb3ZpZGVyLCB1c2VySW50ZXJuYWwuYXV0aCwgXCJhcmd1bWVudC1lcnJvclwiIC8qIEFSR1VNRU5UX0VSUk9SICovKTtcclxuICAgIC8vIEFsbG93IHRoZSByZXNvbHZlciB0byBlcnJvciBiZWZvcmUgcGVyc2lzdGluZyB0aGUgcmVkaXJlY3QgdXNlclxyXG4gICAgY29uc3QgcmVzb2x2ZXJJbnRlcm5hbCA9IF93aXRoRGVmYXVsdFJlc29sdmVyKHVzZXJJbnRlcm5hbC5hdXRoLCByZXNvbHZlcik7XHJcbiAgICBhd2FpdCBfc2V0UGVuZGluZ1JlZGlyZWN0U3RhdHVzKHJlc29sdmVySW50ZXJuYWwsIHVzZXJJbnRlcm5hbC5hdXRoKTtcclxuICAgIGNvbnN0IGV2ZW50SWQgPSBhd2FpdCBwcmVwYXJlVXNlckZvclJlZGlyZWN0KHVzZXJJbnRlcm5hbCk7XHJcbiAgICByZXR1cm4gcmVzb2x2ZXJJbnRlcm5hbC5fb3BlblJlZGlyZWN0KHVzZXJJbnRlcm5hbC5hdXRoLCBwcm92aWRlciwgXCJyZWF1dGhWaWFSZWRpcmVjdFwiIC8qIFJFQVVUSF9WSUFfUkVESVJFQ1QgKi8sIGV2ZW50SWQpO1xyXG59XHJcbi8qKlxyXG4gKiBMaW5rcyB0aGUge0BsaW5rIE9BdXRoUHJvdmlkZXJ9IHRvIHRoZSB1c2VyIGFjY291bnQgdXNpbmcgYSBmdWxsLXBhZ2UgcmVkaXJlY3QgZmxvdy5cclxuICpcclxuICogQGV4YW1wbGVcclxuICogYGBgamF2YXNjcmlwdFxyXG4gKiAvLyBTaWduIGluIHVzaW5nIHNvbWUgb3RoZXIgcHJvdmlkZXIuXHJcbiAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNpZ25JbldpdGhFbWFpbEFuZFBhc3N3b3JkKGF1dGgsIGVtYWlsLCBwYXNzd29yZCk7XHJcbiAqIC8vIExpbmsgdXNpbmcgYSByZWRpcmVjdC5cclxuICogY29uc3QgcHJvdmlkZXIgPSBuZXcgRmFjZWJvb2tBdXRoUHJvdmlkZXIoKTtcclxuICogYXdhaXQgbGlua1dpdGhSZWRpcmVjdChyZXN1bHQudXNlciwgcHJvdmlkZXIpO1xyXG4gKiAvLyBUaGlzIHdpbGwgdHJpZ2dlciBhIGZ1bGwgcGFnZSByZWRpcmVjdCBhd2F5IGZyb20geW91ciBhcHBcclxuICpcclxuICogLy8gQWZ0ZXIgcmV0dXJuaW5nIGZyb20gdGhlIHJlZGlyZWN0IHdoZW4geW91ciBhcHAgaW5pdGlhbGl6ZXMgeW91IGNhbiBvYnRhaW4gdGhlIHJlc3VsdFxyXG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRSZWRpcmVjdFJlc3VsdChhdXRoKTtcclxuICogYGBgXHJcbiAqXHJcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXHJcbiAqIEBwYXJhbSBwcm92aWRlciAtIFRoZSBwcm92aWRlciB0byBhdXRoZW50aWNhdGUuIFRoZSBwcm92aWRlciBoYXMgdG8gYmUgYW4ge0BsaW5rIE9BdXRoUHJvdmlkZXJ9LlxyXG4gKiBOb24tT0F1dGggcHJvdmlkZXJzIGxpa2Uge0BsaW5rIEVtYWlsQXV0aFByb3ZpZGVyfSB3aWxsIHRocm93IGFuIGVycm9yLlxyXG4gKiBAcGFyYW0gcmVzb2x2ZXIgLSBBbiBpbnN0YW5jZSBvZiB7QGxpbmsgUG9wdXBSZWRpcmVjdFJlc29sdmVyfSwgb3B0aW9uYWxcclxuICogaWYgYWxyZWFkeSBzdXBwbGllZCB0byB7QGxpbmsgaW5pdGlhbGl6ZUF1dGh9IG9yIHByb3ZpZGVkIGJ5IHtAbGluayBnZXRBdXRofS5cclxuICpcclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuZnVuY3Rpb24gbGlua1dpdGhSZWRpcmVjdCh1c2VyLCBwcm92aWRlciwgcmVzb2x2ZXIpIHtcclxuICAgIHJldHVybiBfbGlua1dpdGhSZWRpcmVjdCh1c2VyLCBwcm92aWRlciwgcmVzb2x2ZXIpO1xyXG59XHJcbmFzeW5jIGZ1bmN0aW9uIF9saW5rV2l0aFJlZGlyZWN0KHVzZXIsIHByb3ZpZGVyLCByZXNvbHZlcikge1xyXG4gICAgY29uc3QgdXNlckludGVybmFsID0gZ2V0TW9kdWxhckluc3RhbmNlKHVzZXIpO1xyXG4gICAgX2Fzc2VydChwcm92aWRlciBpbnN0YW5jZW9mIEZlZGVyYXRlZEF1dGhQcm92aWRlciwgdXNlckludGVybmFsLmF1dGgsIFwiYXJndW1lbnQtZXJyb3JcIiAvKiBBUkdVTUVOVF9FUlJPUiAqLyk7XHJcbiAgICAvLyBBbGxvdyB0aGUgcmVzb2x2ZXIgdG8gZXJyb3IgYmVmb3JlIHBlcnNpc3RpbmcgdGhlIHJlZGlyZWN0IHVzZXJcclxuICAgIGNvbnN0IHJlc29sdmVySW50ZXJuYWwgPSBfd2l0aERlZmF1bHRSZXNvbHZlcih1c2VySW50ZXJuYWwuYXV0aCwgcmVzb2x2ZXIpO1xyXG4gICAgYXdhaXQgX2Fzc2VydExpbmtlZFN0YXR1cyhmYWxzZSwgdXNlckludGVybmFsLCBwcm92aWRlci5wcm92aWRlcklkKTtcclxuICAgIGF3YWl0IF9zZXRQZW5kaW5nUmVkaXJlY3RTdGF0dXMocmVzb2x2ZXJJbnRlcm5hbCwgdXNlckludGVybmFsLmF1dGgpO1xyXG4gICAgY29uc3QgZXZlbnRJZCA9IGF3YWl0IHByZXBhcmVVc2VyRm9yUmVkaXJlY3QodXNlckludGVybmFsKTtcclxuICAgIHJldHVybiByZXNvbHZlckludGVybmFsLl9vcGVuUmVkaXJlY3QodXNlckludGVybmFsLmF1dGgsIHByb3ZpZGVyLCBcImxpbmtWaWFSZWRpcmVjdFwiIC8qIExJTktfVklBX1JFRElSRUNUICovLCBldmVudElkKTtcclxufVxyXG4vKipcclxuICogUmV0dXJucyBhIHtAbGluayBVc2VyQ3JlZGVudGlhbH0gZnJvbSB0aGUgcmVkaXJlY3QtYmFzZWQgc2lnbi1pbiBmbG93LlxyXG4gKlxyXG4gKiBAcmVtYXJrc1xyXG4gKiBJZiBzaWduLWluIHN1Y2NlZWRlZCwgcmV0dXJucyB0aGUgc2lnbmVkIGluIHVzZXIuIElmIHNpZ24taW4gd2FzIHVuc3VjY2Vzc2Z1bCwgZmFpbHMgd2l0aCBhblxyXG4gKiBlcnJvci4gSWYgbm8gcmVkaXJlY3Qgb3BlcmF0aW9uIHdhcyBjYWxsZWQsIHJldHVybnMgYSB7QGxpbmsgVXNlckNyZWRlbnRpYWx9XHJcbiAqIHdpdGggYSBudWxsIGB1c2VyYC5cclxuICpcclxuICogQGV4YW1wbGVcclxuICogYGBgamF2YXNjcmlwdFxyXG4gKiAvLyBTaWduIGluIHVzaW5nIGEgcmVkaXJlY3QuXHJcbiAqIGNvbnN0IHByb3ZpZGVyID0gbmV3IEZhY2Vib29rQXV0aFByb3ZpZGVyKCk7XHJcbiAqIC8vIFlvdSBjYW4gYWRkIGFkZGl0aW9uYWwgc2NvcGVzIHRvIHRoZSBwcm92aWRlcjpcclxuICogcHJvdmlkZXIuYWRkU2NvcGUoJ3VzZXJfYmlydGhkYXknKTtcclxuICogLy8gU3RhcnQgYSBzaWduIGluIHByb2Nlc3MgZm9yIGFuIHVuYXV0aGVudGljYXRlZCB1c2VyLlxyXG4gKiBhd2FpdCBzaWduSW5XaXRoUmVkaXJlY3QoYXV0aCwgcHJvdmlkZXIpO1xyXG4gKiAvLyBUaGlzIHdpbGwgdHJpZ2dlciBhIGZ1bGwgcGFnZSByZWRpcmVjdCBhd2F5IGZyb20geW91ciBhcHBcclxuICpcclxuICogLy8gQWZ0ZXIgcmV0dXJuaW5nIGZyb20gdGhlIHJlZGlyZWN0IHdoZW4geW91ciBhcHAgaW5pdGlhbGl6ZXMgeW91IGNhbiBvYnRhaW4gdGhlIHJlc3VsdFxyXG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRSZWRpcmVjdFJlc3VsdChhdXRoKTtcclxuICogaWYgKHJlc3VsdCkge1xyXG4gKiAgIC8vIFRoaXMgaXMgdGhlIHNpZ25lZC1pbiB1c2VyXHJcbiAqICAgY29uc3QgdXNlciA9IHJlc3VsdC51c2VyO1xyXG4gKiAgIC8vIFRoaXMgZ2l2ZXMgeW91IGEgRmFjZWJvb2sgQWNjZXNzIFRva2VuLlxyXG4gKiAgIGNvbnN0IGNyZWRlbnRpYWwgPSBwcm92aWRlci5jcmVkZW50aWFsRnJvbVJlc3VsdChhdXRoLCByZXN1bHQpO1xyXG4gKiAgIGNvbnN0IHRva2VuID0gY3JlZGVudGlhbC5hY2Nlc3NUb2tlbjtcclxuICogfVxyXG4gKiAvLyBBcyB0aGlzIEFQSSBjYW4gYmUgdXNlZCBmb3Igc2lnbi1pbiwgbGlua2luZyBhbmQgcmVhdXRoZW50aWNhdGlvbixcclxuICogLy8gY2hlY2sgdGhlIG9wZXJhdGlvblR5cGUgdG8gZGV0ZXJtaW5lIHdoYXQgdHJpZ2dlcmVkIHRoaXMgcmVkaXJlY3RcclxuICogLy8gb3BlcmF0aW9uLlxyXG4gKiBjb25zdCBvcGVyYXRpb25UeXBlID0gcmVzdWx0Lm9wZXJhdGlvblR5cGU7XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXHJcbiAqIEBwYXJhbSByZXNvbHZlciAtIEFuIGluc3RhbmNlIG9mIHtAbGluayBQb3B1cFJlZGlyZWN0UmVzb2x2ZXJ9LCBvcHRpb25hbFxyXG4gKiBpZiBhbHJlYWR5IHN1cHBsaWVkIHRvIHtAbGluayBpbml0aWFsaXplQXV0aH0gb3IgcHJvdmlkZWQgYnkge0BsaW5rIGdldEF1dGh9LlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBnZXRSZWRpcmVjdFJlc3VsdChhdXRoLCByZXNvbHZlcikge1xyXG4gICAgYXdhaXQgX2Nhc3RBdXRoKGF1dGgpLl9pbml0aWFsaXphdGlvblByb21pc2U7XHJcbiAgICByZXR1cm4gX2dldFJlZGlyZWN0UmVzdWx0KGF1dGgsIHJlc29sdmVyLCBmYWxzZSk7XHJcbn1cclxuYXN5bmMgZnVuY3Rpb24gX2dldFJlZGlyZWN0UmVzdWx0KGF1dGgsIHJlc29sdmVyRXh0ZXJuLCBieXBhc3NBdXRoU3RhdGUgPSBmYWxzZSkge1xyXG4gICAgY29uc3QgYXV0aEludGVybmFsID0gX2Nhc3RBdXRoKGF1dGgpO1xyXG4gICAgY29uc3QgcmVzb2x2ZXIgPSBfd2l0aERlZmF1bHRSZXNvbHZlcihhdXRoSW50ZXJuYWwsIHJlc29sdmVyRXh0ZXJuKTtcclxuICAgIGNvbnN0IGFjdGlvbiA9IG5ldyBSZWRpcmVjdEFjdGlvbihhdXRoSW50ZXJuYWwsIHJlc29sdmVyLCBieXBhc3NBdXRoU3RhdGUpO1xyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgYWN0aW9uLmV4ZWN1dGUoKTtcclxuICAgIGlmIChyZXN1bHQgJiYgIWJ5cGFzc0F1dGhTdGF0ZSkge1xyXG4gICAgICAgIGRlbGV0ZSByZXN1bHQudXNlci5fcmVkaXJlY3RFdmVudElkO1xyXG4gICAgICAgIGF3YWl0IGF1dGhJbnRlcm5hbC5fcGVyc2lzdFVzZXJJZkN1cnJlbnQocmVzdWx0LnVzZXIpO1xyXG4gICAgICAgIGF3YWl0IGF1dGhJbnRlcm5hbC5fc2V0UmVkaXJlY3RVc2VyKG51bGwsIHJlc29sdmVyRXh0ZXJuKTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuYXN5bmMgZnVuY3Rpb24gcHJlcGFyZVVzZXJGb3JSZWRpcmVjdCh1c2VyKSB7XHJcbiAgICBjb25zdCBldmVudElkID0gX2dlbmVyYXRlRXZlbnRJZChgJHt1c2VyLnVpZH06OjpgKTtcclxuICAgIHVzZXIuX3JlZGlyZWN0RXZlbnRJZCA9IGV2ZW50SWQ7XHJcbiAgICBhd2FpdCB1c2VyLmF1dGguX3NldFJlZGlyZWN0VXNlcih1c2VyKTtcclxuICAgIGF3YWl0IHVzZXIuYXV0aC5fcGVyc2lzdFVzZXJJZkN1cnJlbnQodXNlcik7XHJcbiAgICByZXR1cm4gZXZlbnRJZDtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vLyBUaGUgYW1vdW50IG9mIHRpbWUgdG8gc3RvcmUgdGhlIFVJRHMgb2Ygc2VlbiBldmVudHM7IHRoaXMgaXNcclxuLy8gc2V0IHRvIDEwIG1pbiBieSBkZWZhdWx0XHJcbmNvbnN0IEVWRU5UX0RVUExJQ0FUSU9OX0NBQ0hFX0RVUkFUSU9OX01TID0gMTAgKiA2MCAqIDEwMDA7XHJcbmNsYXNzIEF1dGhFdmVudE1hbmFnZXIge1xyXG4gICAgY29uc3RydWN0b3IoYXV0aCkge1xyXG4gICAgICAgIHRoaXMuYXV0aCA9IGF1dGg7XHJcbiAgICAgICAgdGhpcy5jYWNoZWRFdmVudFVpZHMgPSBuZXcgU2V0KCk7XHJcbiAgICAgICAgdGhpcy5jb25zdW1lcnMgPSBuZXcgU2V0KCk7XHJcbiAgICAgICAgdGhpcy5xdWV1ZWRSZWRpcmVjdEV2ZW50ID0gbnVsbDtcclxuICAgICAgICB0aGlzLmhhc0hhbmRsZWRQb3RlbnRpYWxSZWRpcmVjdCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMubGFzdFByb2Nlc3NlZEV2ZW50VGltZSA9IERhdGUubm93KCk7XHJcbiAgICB9XHJcbiAgICByZWdpc3RlckNvbnN1bWVyKGF1dGhFdmVudENvbnN1bWVyKSB7XHJcbiAgICAgICAgdGhpcy5jb25zdW1lcnMuYWRkKGF1dGhFdmVudENvbnN1bWVyKTtcclxuICAgICAgICBpZiAodGhpcy5xdWV1ZWRSZWRpcmVjdEV2ZW50ICYmXHJcbiAgICAgICAgICAgIHRoaXMuaXNFdmVudEZvckNvbnN1bWVyKHRoaXMucXVldWVkUmVkaXJlY3RFdmVudCwgYXV0aEV2ZW50Q29uc3VtZXIpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VuZFRvQ29uc3VtZXIodGhpcy5xdWV1ZWRSZWRpcmVjdEV2ZW50LCBhdXRoRXZlbnRDb25zdW1lcik7XHJcbiAgICAgICAgICAgIHRoaXMuc2F2ZUV2ZW50VG9DYWNoZSh0aGlzLnF1ZXVlZFJlZGlyZWN0RXZlbnQpO1xyXG4gICAgICAgICAgICB0aGlzLnF1ZXVlZFJlZGlyZWN0RXZlbnQgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHVucmVnaXN0ZXJDb25zdW1lcihhdXRoRXZlbnRDb25zdW1lcikge1xyXG4gICAgICAgIHRoaXMuY29uc3VtZXJzLmRlbGV0ZShhdXRoRXZlbnRDb25zdW1lcik7XHJcbiAgICB9XHJcbiAgICBvbkV2ZW50KGV2ZW50KSB7XHJcbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIGV2ZW50IGhhcyBhbHJlYWR5IGJlZW4gaGFuZGxlZFxyXG4gICAgICAgIGlmICh0aGlzLmhhc0V2ZW50QmVlbkhhbmRsZWQoZXZlbnQpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGhhbmRsZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmNvbnN1bWVycy5mb3JFYWNoKGNvbnN1bWVyID0+IHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuaXNFdmVudEZvckNvbnN1bWVyKGV2ZW50LCBjb25zdW1lcikpIHtcclxuICAgICAgICAgICAgICAgIGhhbmRsZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZW5kVG9Db25zdW1lcihldmVudCwgY29uc3VtZXIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zYXZlRXZlbnRUb0NhY2hlKGV2ZW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmICh0aGlzLmhhc0hhbmRsZWRQb3RlbnRpYWxSZWRpcmVjdCB8fCAhaXNSZWRpcmVjdEV2ZW50KGV2ZW50KSkge1xyXG4gICAgICAgICAgICAvLyBJZiB3ZSd2ZSBhbHJlYWR5IHNlZW4gYSByZWRpcmVjdCBiZWZvcmUsIG9yIHRoaXMgaXMgYSBwb3B1cCBldmVudCxcclxuICAgICAgICAgICAgLy8gYmFpbCBub3dcclxuICAgICAgICAgICAgcmV0dXJuIGhhbmRsZWQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaGFzSGFuZGxlZFBvdGVudGlhbFJlZGlyZWN0ID0gdHJ1ZTtcclxuICAgICAgICAvLyBJZiB0aGUgcmVkaXJlY3Qgd2Fzbid0IGhhbmRsZWQsIGhhbmcgb24gdG8gaXRcclxuICAgICAgICBpZiAoIWhhbmRsZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5xdWV1ZWRSZWRpcmVjdEV2ZW50ID0gZXZlbnQ7XHJcbiAgICAgICAgICAgIGhhbmRsZWQgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gaGFuZGxlZDtcclxuICAgIH1cclxuICAgIHNlbmRUb0NvbnN1bWVyKGV2ZW50LCBjb25zdW1lcikge1xyXG4gICAgICAgIHZhciBfYTtcclxuICAgICAgICBpZiAoZXZlbnQuZXJyb3IgJiYgIWlzTnVsbFJlZGlyZWN0RXZlbnQoZXZlbnQpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvZGUgPSAoKF9hID0gZXZlbnQuZXJyb3IuY29kZSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnNwbGl0KCdhdXRoLycpWzFdKSB8fFxyXG4gICAgICAgICAgICAgICAgXCJpbnRlcm5hbC1lcnJvclwiIC8qIElOVEVSTkFMX0VSUk9SICovO1xyXG4gICAgICAgICAgICBjb25zdW1lci5vbkVycm9yKF9jcmVhdGVFcnJvcih0aGlzLmF1dGgsIGNvZGUpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnN1bWVyLm9uQXV0aEV2ZW50KGV2ZW50KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBpc0V2ZW50Rm9yQ29uc3VtZXIoZXZlbnQsIGNvbnN1bWVyKSB7XHJcbiAgICAgICAgY29uc3QgZXZlbnRJZE1hdGNoZXMgPSBjb25zdW1lci5ldmVudElkID09PSBudWxsIHx8XHJcbiAgICAgICAgICAgICghIWV2ZW50LmV2ZW50SWQgJiYgZXZlbnQuZXZlbnRJZCA9PT0gY29uc3VtZXIuZXZlbnRJZCk7XHJcbiAgICAgICAgcmV0dXJuIGNvbnN1bWVyLmZpbHRlci5pbmNsdWRlcyhldmVudC50eXBlKSAmJiBldmVudElkTWF0Y2hlcztcclxuICAgIH1cclxuICAgIGhhc0V2ZW50QmVlbkhhbmRsZWQoZXZlbnQpIHtcclxuICAgICAgICBpZiAoRGF0ZS5ub3coKSAtIHRoaXMubGFzdFByb2Nlc3NlZEV2ZW50VGltZSA+PVxyXG4gICAgICAgICAgICBFVkVOVF9EVVBMSUNBVElPTl9DQUNIRV9EVVJBVElPTl9NUykge1xyXG4gICAgICAgICAgICB0aGlzLmNhY2hlZEV2ZW50VWlkcy5jbGVhcigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5jYWNoZWRFdmVudFVpZHMuaGFzKGV2ZW50VWlkKGV2ZW50KSk7XHJcbiAgICB9XHJcbiAgICBzYXZlRXZlbnRUb0NhY2hlKGV2ZW50KSB7XHJcbiAgICAgICAgdGhpcy5jYWNoZWRFdmVudFVpZHMuYWRkKGV2ZW50VWlkKGV2ZW50KSk7XHJcbiAgICAgICAgdGhpcy5sYXN0UHJvY2Vzc2VkRXZlbnRUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBldmVudFVpZChlKSB7XHJcbiAgICByZXR1cm4gW2UudHlwZSwgZS5ldmVudElkLCBlLnNlc3Npb25JZCwgZS50ZW5hbnRJZF0uZmlsdGVyKHYgPT4gdikuam9pbignLScpO1xyXG59XHJcbmZ1bmN0aW9uIGlzTnVsbFJlZGlyZWN0RXZlbnQoeyB0eXBlLCBlcnJvciB9KSB7XHJcbiAgICByZXR1cm4gKHR5cGUgPT09IFwidW5rbm93blwiIC8qIFVOS05PV04gKi8gJiZcclxuICAgICAgICAoZXJyb3IgPT09IG51bGwgfHwgZXJyb3IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGVycm9yLmNvZGUpID09PSBgYXV0aC8ke1wibm8tYXV0aC1ldmVudFwiIC8qIE5PX0FVVEhfRVZFTlQgKi99YCk7XHJcbn1cclxuZnVuY3Rpb24gaXNSZWRpcmVjdEV2ZW50KGV2ZW50KSB7XHJcbiAgICBzd2l0Y2ggKGV2ZW50LnR5cGUpIHtcclxuICAgICAgICBjYXNlIFwic2lnbkluVmlhUmVkaXJlY3RcIiAvKiBTSUdOX0lOX1ZJQV9SRURJUkVDVCAqLzpcclxuICAgICAgICBjYXNlIFwibGlua1ZpYVJlZGlyZWN0XCIgLyogTElOS19WSUFfUkVESVJFQ1QgKi86XHJcbiAgICAgICAgY2FzZSBcInJlYXV0aFZpYVJlZGlyZWN0XCIgLyogUkVBVVRIX1ZJQV9SRURJUkVDVCAqLzpcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgY2FzZSBcInVua25vd25cIiAvKiBVTktOT1dOICovOlxyXG4gICAgICAgICAgICByZXR1cm4gaXNOdWxsUmVkaXJlY3RFdmVudChldmVudCk7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIF9nZXRQcm9qZWN0Q29uZmlnKGF1dGgsIHJlcXVlc3QgPSB7fSkge1xyXG4gICAgcmV0dXJuIF9wZXJmb3JtQXBpUmVxdWVzdChhdXRoLCBcIkdFVFwiIC8qIEdFVCAqLywgXCIvdjEvcHJvamVjdHNcIiAvKiBHRVRfUFJPSkVDVF9DT05GSUcgKi8sIHJlcXVlc3QpO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmNvbnN0IElQX0FERFJFU1NfUkVHRVggPSAvXlxcZHsxLDN9XFwuXFxkezEsM31cXC5cXGR7MSwzfVxcLlxcZHsxLDN9JC87XHJcbmNvbnN0IEhUVFBfUkVHRVggPSAvXmh0dHBzPy87XHJcbmFzeW5jIGZ1bmN0aW9uIF92YWxpZGF0ZU9yaWdpbihhdXRoKSB7XHJcbiAgICAvLyBTa2lwIG9yaWdpbiB2YWxpZGF0aW9uIGlmIHdlIGFyZSBpbiBhbiBlbXVsYXRlZCBlbnZpcm9ubWVudFxyXG4gICAgaWYgKGF1dGguY29uZmlnLmVtdWxhdG9yKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29uc3QgeyBhdXRob3JpemVkRG9tYWlucyB9ID0gYXdhaXQgX2dldFByb2plY3RDb25maWcoYXV0aCk7XHJcbiAgICBmb3IgKGNvbnN0IGRvbWFpbiBvZiBhdXRob3JpemVkRG9tYWlucykge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChtYXRjaERvbWFpbihkb21haW4pKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKF9hKSB7XHJcbiAgICAgICAgICAgIC8vIERvIG5vdGhpbmcgaWYgdGhlcmUncyBhIFVSTCBlcnJvcjsganVzdCBjb250aW51ZSBzZWFyY2hpbmdcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyBJbiB0aGUgb2xkIFNESywgdGhpcyBlcnJvciBhbHNvIHByb3ZpZGVzIGhlbHBmdWwgbWVzc2FnZXMuXHJcbiAgICBfZmFpbChhdXRoLCBcInVuYXV0aG9yaXplZC1kb21haW5cIiAvKiBJTlZBTElEX09SSUdJTiAqLyk7XHJcbn1cclxuZnVuY3Rpb24gbWF0Y2hEb21haW4oZXhwZWN0ZWQpIHtcclxuICAgIGNvbnN0IGN1cnJlbnRVcmwgPSBfZ2V0Q3VycmVudFVybCgpO1xyXG4gICAgY29uc3QgeyBwcm90b2NvbCwgaG9zdG5hbWUgfSA9IG5ldyBVUkwoY3VycmVudFVybCk7XHJcbiAgICBpZiAoZXhwZWN0ZWQuc3RhcnRzV2l0aCgnY2hyb21lLWV4dGVuc2lvbjovLycpKSB7XHJcbiAgICAgICAgY29uc3QgY2VVcmwgPSBuZXcgVVJMKGV4cGVjdGVkKTtcclxuICAgICAgICBpZiAoY2VVcmwuaG9zdG5hbWUgPT09ICcnICYmIGhvc3RuYW1lID09PSAnJykge1xyXG4gICAgICAgICAgICAvLyBGb3Igc29tZSByZWFzb24gd2UncmUgbm90IHBhcnNpbmcgY2hyb21lIFVSTHMgcHJvcGVybHlcclxuICAgICAgICAgICAgcmV0dXJuIChwcm90b2NvbCA9PT0gJ2Nocm9tZS1leHRlbnNpb246JyAmJlxyXG4gICAgICAgICAgICAgICAgZXhwZWN0ZWQucmVwbGFjZSgnY2hyb21lLWV4dGVuc2lvbjovLycsICcnKSA9PT1cclxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50VXJsLnJlcGxhY2UoJ2Nocm9tZS1leHRlbnNpb246Ly8nLCAnJykpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcHJvdG9jb2wgPT09ICdjaHJvbWUtZXh0ZW5zaW9uOicgJiYgY2VVcmwuaG9zdG5hbWUgPT09IGhvc3RuYW1lO1xyXG4gICAgfVxyXG4gICAgaWYgKCFIVFRQX1JFR0VYLnRlc3QocHJvdG9jb2wpKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgaWYgKElQX0FERFJFU1NfUkVHRVgudGVzdChleHBlY3RlZCkpIHtcclxuICAgICAgICAvLyBUaGUgZG9tYWluIGhhcyB0byBiZSBleGFjdGx5IGVxdWFsIHRvIHRoZSBwYXR0ZXJuLCBhcyBhbiBJUCBkb21haW4gd2lsbFxyXG4gICAgICAgIC8vIG9ubHkgY29udGFpbiB0aGUgSVAsIG5vIGV4dHJhIGNoYXJhY3Rlci5cclxuICAgICAgICByZXR1cm4gaG9zdG5hbWUgPT09IGV4cGVjdGVkO1xyXG4gICAgfVxyXG4gICAgLy8gRG90cyBpbiBwYXR0ZXJuIHNob3VsZCBiZSBlc2NhcGVkLlxyXG4gICAgY29uc3QgZXNjYXBlZERvbWFpblBhdHRlcm4gPSBleHBlY3RlZC5yZXBsYWNlKC9cXC4vZywgJ1xcXFwuJyk7XHJcbiAgICAvLyBOb24gaXAgYWRkcmVzcyBkb21haW5zLlxyXG4gICAgLy8gZG9tYWluLmNvbSA9ICouZG9tYWluLmNvbSBPUiBkb21haW4uY29tXHJcbiAgICBjb25zdCByZSA9IG5ldyBSZWdFeHAoJ14oLitcXFxcLicgKyBlc2NhcGVkRG9tYWluUGF0dGVybiArICd8JyArIGVzY2FwZWREb21haW5QYXR0ZXJuICsgJykkJywgJ2knKTtcclxuICAgIHJldHVybiByZS50ZXN0KGhvc3RuYW1lKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuY29uc3QgTkVUV09SS19USU1FT1VUID0gbmV3IERlbGF5KDMwMDAwLCA2MDAwMCk7XHJcbi8qKlxyXG4gKiBSZXNldCB1bmxhb2RlZCBHQXBpIG1vZHVsZXMuIElmIGdhcGkubG9hZCBmYWlscyBkdWUgdG8gYSBuZXR3b3JrIGVycm9yLFxyXG4gKiBpdCB3aWxsIHN0b3Agd29ya2luZyBhZnRlciBhIHJldHJpYWwuIFRoaXMgaXMgYSBoYWNrIHRvIGZpeCB0aGlzIGlzc3VlLlxyXG4gKi9cclxuZnVuY3Rpb24gcmVzZXRVbmxvYWRlZEdhcGlNb2R1bGVzKCkge1xyXG4gICAgLy8gQ2xlYXIgbGFzdCBmYWlsZWQgZ2FwaS5sb2FkIHN0YXRlIHRvIGZvcmNlIG5leHQgZ2FwaS5sb2FkIHRvIGZpcnN0XHJcbiAgICAvLyBsb2FkIHRoZSBmYWlsZWQgZ2FwaS5pZnJhbWVzIG1vZHVsZS5cclxuICAgIC8vIEdldCBnYXBpeC5iZWFjb24gY29udGV4dC5cclxuICAgIGNvbnN0IGJlYWNvbiA9IF93aW5kb3coKS5fX19qc2w7XHJcbiAgICAvLyBHZXQgY3VycmVudCBoaW50LlxyXG4gICAgaWYgKGJlYWNvbiA9PT0gbnVsbCB8fCBiZWFjb24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IGJlYWNvbi5IKSB7XHJcbiAgICAgICAgLy8gR2V0IGdhcGkgaGludC5cclxuICAgICAgICBmb3IgKGNvbnN0IGhpbnQgb2YgT2JqZWN0LmtleXMoYmVhY29uLkgpKSB7XHJcbiAgICAgICAgICAgIC8vIFJlcXVlc3RlZCBtb2R1bGVzLlxyXG4gICAgICAgICAgICBiZWFjb24uSFtoaW50XS5yID0gYmVhY29uLkhbaGludF0uciB8fCBbXTtcclxuICAgICAgICAgICAgLy8gTG9hZGVkIG1vZHVsZXMuXHJcbiAgICAgICAgICAgIGJlYWNvbi5IW2hpbnRdLkwgPSBiZWFjb24uSFtoaW50XS5MIHx8IFtdO1xyXG4gICAgICAgICAgICAvLyBTZXQgcmVxdWVzdGVkIG1vZHVsZXMgdG8gYSBjb3B5IG9mIHRoZSBsb2FkZWQgbW9kdWxlcy5cclxuICAgICAgICAgICAgYmVhY29uLkhbaGludF0uciA9IFsuLi5iZWFjb24uSFtoaW50XS5MXTtcclxuICAgICAgICAgICAgLy8gQ2xlYXIgcGVuZGluZyBjYWxsYmFja3MuXHJcbiAgICAgICAgICAgIGlmIChiZWFjb24uQ1ApIHtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYmVhY29uLkNQLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIGFsbCBmYWlsZWQgcGVuZGluZyBjYWxsYmFja3MuXHJcbiAgICAgICAgICAgICAgICAgICAgYmVhY29uLkNQW2ldID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBsb2FkR2FwaShhdXRoKSB7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgIHZhciBfYSwgX2IsIF9jO1xyXG4gICAgICAgIC8vIEZ1bmN0aW9uIHRvIHJ1biB3aGVuIGdhcGkubG9hZCBpcyByZWFkeS5cclxuICAgICAgICBmdW5jdGlvbiBsb2FkR2FwaUlmcmFtZSgpIHtcclxuICAgICAgICAgICAgLy8gVGhlIGRldmVsb3BlciBtYXkgaGF2ZSB0cmllZCB0byBwcmV2aW91c2x5IHJ1biBnYXBpLmxvYWQgYW5kIGZhaWxlZC5cclxuICAgICAgICAgICAgLy8gUnVuIHRoaXMgdG8gZml4IHRoYXQuXHJcbiAgICAgICAgICAgIHJlc2V0VW5sb2FkZWRHYXBpTW9kdWxlcygpO1xyXG4gICAgICAgICAgICBnYXBpLmxvYWQoJ2dhcGkuaWZyYW1lcycsIHtcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShnYXBpLmlmcmFtZXMuZ2V0Q29udGV4dCgpKTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBvbnRpbWVvdXQ6ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBUaGUgYWJvdmUgcmVzZXQgbWF5IGJlIHN1ZmZpY2llbnQsIGJ1dCBoYXZpbmcgdGhpcyByZXNldCBhZnRlclxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGZhaWx1cmUgZW5zdXJlcyB0aGF0IGlmIHRoZSBkZXZlbG9wZXIgY2FsbHMgZ2FwaS5sb2FkIGFmdGVyIHRoZVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbm5lY3Rpb24gaXMgcmUtZXN0YWJsaXNoZWQgYW5kIGJlZm9yZSBhbm90aGVyIGF0dGVtcHQgdG8gZW1iZWRcclxuICAgICAgICAgICAgICAgICAgICAvLyB0aGUgaWZyYW1lLCBpdCB3b3VsZCB3b3JrIGFuZCB3b3VsZCBub3QgYmUgYnJva2VuIGJlY2F1c2Ugb2Ygb3VyXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gZmFpbGVkIGF0dGVtcHQuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gVGltZW91dCB3aGVuIGdhcGkuaWZyYW1lcy5JZnJhbWUgbm90IGxvYWRlZC5cclxuICAgICAgICAgICAgICAgICAgICByZXNldFVubG9hZGVkR2FwaU1vZHVsZXMoKTtcclxuICAgICAgICAgICAgICAgICAgICByZWplY3QoX2NyZWF0ZUVycm9yKGF1dGgsIFwibmV0d29yay1yZXF1ZXN0LWZhaWxlZFwiIC8qIE5FVFdPUktfUkVRVUVTVF9GQUlMRUQgKi8pKTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB0aW1lb3V0OiBORVRXT1JLX1RJTUVPVVQuZ2V0KClcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICgoX2IgPSAoX2EgPSBfd2luZG93KCkuZ2FwaSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmlmcmFtZXMpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5JZnJhbWUpIHtcclxuICAgICAgICAgICAgLy8gSWYgZ2FwaS5pZnJhbWVzLklmcmFtZSBhdmFpbGFibGUsIHJlc29sdmUuXHJcbiAgICAgICAgICAgIHJlc29sdmUoZ2FwaS5pZnJhbWVzLmdldENvbnRleHQoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKCEhKChfYyA9IF93aW5kb3coKS5nYXBpKSA9PT0gbnVsbCB8fCBfYyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2MubG9hZCkpIHtcclxuICAgICAgICAgICAgLy8gR2FwaSBsb2FkZXIgcmVhZHksIGxvYWQgZ2FwaS5pZnJhbWVzLlxyXG4gICAgICAgICAgICBsb2FkR2FwaUlmcmFtZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gQ3JlYXRlIGEgbmV3IGlmcmFtZSBjYWxsYmFjayB3aGVuIHRoaXMgaXMgY2FsbGVkIHNvIGFzIG5vdCB0byBvdmVyd3JpdGVcclxuICAgICAgICAgICAgLy8gYW55IHByZXZpb3VzIGRlZmluZWQgY2FsbGJhY2suIFRoaXMgaGFwcGVucyBpZiB0aGlzIG1ldGhvZCBpcyBjYWxsZWRcclxuICAgICAgICAgICAgLy8gbXVsdGlwbGUgdGltZXMgaW4gcGFyYWxsZWwgYW5kIGNvdWxkIHJlc3VsdCBpbiB0aGUgbGF0ZXIgY2FsbGJhY2tcclxuICAgICAgICAgICAgLy8gb3ZlcndyaXRpbmcgdGhlIHByZXZpb3VzIG9uZS4gVGhpcyB3b3VsZCBlbmQgdXAgd2l0aCBhIGlmcmFtZVxyXG4gICAgICAgICAgICAvLyB0aW1lb3V0LlxyXG4gICAgICAgICAgICBjb25zdCBjYk5hbWUgPSBfZ2VuZXJhdGVDYWxsYmFja05hbWUoJ2lmcmFtZWZjYicpO1xyXG4gICAgICAgICAgICAvLyBHQXBpIGxvYWRlciBub3QgYXZhaWxhYmxlLCBkeW5hbWljYWxseSBsb2FkIHBsYXRmb3JtLmpzLlxyXG4gICAgICAgICAgICBfd2luZG93KClbY2JOYW1lXSA9ICgpID0+IHtcclxuICAgICAgICAgICAgICAgIC8vIEdBcGkgbG9hZGVyIHNob3VsZCBiZSByZWFkeS5cclxuICAgICAgICAgICAgICAgIGlmICghIWdhcGkubG9hZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxvYWRHYXBpSWZyYW1lKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBHYXBpIGxvYWRlciBmYWlsZWQsIHRocm93IGVycm9yLlxyXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChfY3JlYXRlRXJyb3IoYXV0aCwgXCJuZXR3b3JrLXJlcXVlc3QtZmFpbGVkXCIgLyogTkVUV09SS19SRVFVRVNUX0ZBSUxFRCAqLykpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAvLyBMb2FkIEdBcGkgbG9hZGVyLlxyXG4gICAgICAgICAgICByZXR1cm4gX2xvYWRKUyhgaHR0cHM6Ly9hcGlzLmdvb2dsZS5jb20vanMvYXBpLmpzP29ubG9hZD0ke2NiTmFtZX1gKTtcclxuICAgICAgICB9XHJcbiAgICB9KS5jYXRjaChlcnJvciA9PiB7XHJcbiAgICAgICAgLy8gUmVzZXQgY2FjaGVkIHByb21pc2UgdG8gYWxsb3cgZm9yIHJldHJpYWwuXHJcbiAgICAgICAgY2FjaGVkR0FwaUxvYWRlciA9IG51bGw7XHJcbiAgICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9KTtcclxufVxyXG5sZXQgY2FjaGVkR0FwaUxvYWRlciA9IG51bGw7XHJcbmZ1bmN0aW9uIF9sb2FkR2FwaShhdXRoKSB7XHJcbiAgICBjYWNoZWRHQXBpTG9hZGVyID0gY2FjaGVkR0FwaUxvYWRlciB8fCBsb2FkR2FwaShhdXRoKTtcclxuICAgIHJldHVybiBjYWNoZWRHQXBpTG9hZGVyO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jb25zdCBQSU5HX1RJTUVPVVQgPSBuZXcgRGVsYXkoNTAwMCwgMTUwMDApO1xyXG5jb25zdCBJRlJBTUVfUEFUSCA9ICdfXy9hdXRoL2lmcmFtZSc7XHJcbmNvbnN0IEVNVUxBVEVEX0lGUkFNRV9QQVRIID0gJ2VtdWxhdG9yL2F1dGgvaWZyYW1lJztcclxuY29uc3QgSUZSQU1FX0FUVFJJQlVURVMgPSB7XHJcbiAgICBzdHlsZToge1xyXG4gICAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxyXG4gICAgICAgIHRvcDogJy0xMDBweCcsXHJcbiAgICAgICAgd2lkdGg6ICcxcHgnLFxyXG4gICAgICAgIGhlaWdodDogJzFweCdcclxuICAgIH1cclxufTtcclxuLy8gTWFwIGZyb20gYXBpSG9zdCB0byBlbmRwb2ludCBJRCBmb3IgcGFzc2luZyBpbnRvIGlmcmFtZS4gSW4gY3VycmVudCBTREssIGFwaUhvc3QgY2FuIGJlIHNldCB0b1xyXG4vLyBhbnl0aGluZyAobm90IGZyb20gYSBsaXN0IG9mIGVuZHBvaW50cyB3aXRoIElEcyBhcyBpbiBsZWdhY3kpLCBzbyB0aGlzIGlzIHRoZSBjbG9zZXN0IHdlIGNhbiBnZXQuXHJcbmNvbnN0IEVJRF9GUk9NX0FQSUhPU1QgPSBuZXcgTWFwKFtcclxuICAgIFtcImlkZW50aXR5dG9vbGtpdC5nb29nbGVhcGlzLmNvbVwiIC8qIEFQSV9IT1NUICovLCAncCddLFxyXG4gICAgWydzdGFnaW5nLWlkZW50aXR5dG9vbGtpdC5zYW5kYm94Lmdvb2dsZWFwaXMuY29tJywgJ3MnXSxcclxuICAgIFsndGVzdC1pZGVudGl0eXRvb2xraXQuc2FuZGJveC5nb29nbGVhcGlzLmNvbScsICd0J10gLy8gdGVzdFxyXG5dKTtcclxuZnVuY3Rpb24gZ2V0SWZyYW1lVXJsKGF1dGgpIHtcclxuICAgIGNvbnN0IGNvbmZpZyA9IGF1dGguY29uZmlnO1xyXG4gICAgX2Fzc2VydChjb25maWcuYXV0aERvbWFpbiwgYXV0aCwgXCJhdXRoLWRvbWFpbi1jb25maWctcmVxdWlyZWRcIiAvKiBNSVNTSU5HX0FVVEhfRE9NQUlOICovKTtcclxuICAgIGNvbnN0IHVybCA9IGNvbmZpZy5lbXVsYXRvclxyXG4gICAgICAgID8gX2VtdWxhdG9yVXJsKGNvbmZpZywgRU1VTEFURURfSUZSQU1FX1BBVEgpXHJcbiAgICAgICAgOiBgaHR0cHM6Ly8ke2F1dGguY29uZmlnLmF1dGhEb21haW59LyR7SUZSQU1FX1BBVEh9YDtcclxuICAgIGNvbnN0IHBhcmFtcyA9IHtcclxuICAgICAgICBhcGlLZXk6IGNvbmZpZy5hcGlLZXksXHJcbiAgICAgICAgYXBwTmFtZTogYXV0aC5uYW1lLFxyXG4gICAgICAgIHY6IFNES19WRVJTSU9OXHJcbiAgICB9O1xyXG4gICAgY29uc3QgZWlkID0gRUlEX0ZST01fQVBJSE9TVC5nZXQoYXV0aC5jb25maWcuYXBpSG9zdCk7XHJcbiAgICBpZiAoZWlkKSB7XHJcbiAgICAgICAgcGFyYW1zLmVpZCA9IGVpZDtcclxuICAgIH1cclxuICAgIGNvbnN0IGZyYW1ld29ya3MgPSBhdXRoLl9nZXRGcmFtZXdvcmtzKCk7XHJcbiAgICBpZiAoZnJhbWV3b3Jrcy5sZW5ndGgpIHtcclxuICAgICAgICBwYXJhbXMuZncgPSBmcmFtZXdvcmtzLmpvaW4oJywnKTtcclxuICAgIH1cclxuICAgIHJldHVybiBgJHt1cmx9PyR7cXVlcnlzdHJpbmcocGFyYW1zKS5zbGljZSgxKX1gO1xyXG59XHJcbmFzeW5jIGZ1bmN0aW9uIF9vcGVuSWZyYW1lKGF1dGgpIHtcclxuICAgIGNvbnN0IGNvbnRleHQgPSBhd2FpdCBfbG9hZEdhcGkoYXV0aCk7XHJcbiAgICBjb25zdCBnYXBpID0gX3dpbmRvdygpLmdhcGk7XHJcbiAgICBfYXNzZXJ0KGdhcGksIGF1dGgsIFwiaW50ZXJuYWwtZXJyb3JcIiAvKiBJTlRFUk5BTF9FUlJPUiAqLyk7XHJcbiAgICByZXR1cm4gY29udGV4dC5vcGVuKHtcclxuICAgICAgICB3aGVyZTogZG9jdW1lbnQuYm9keSxcclxuICAgICAgICB1cmw6IGdldElmcmFtZVVybChhdXRoKSxcclxuICAgICAgICBtZXNzYWdlSGFuZGxlcnNGaWx0ZXI6IGdhcGkuaWZyYW1lcy5DUk9TU19PUklHSU5fSUZSQU1FU19GSUxURVIsXHJcbiAgICAgICAgYXR0cmlidXRlczogSUZSQU1FX0FUVFJJQlVURVMsXHJcbiAgICAgICAgZG9udGNsZWFyOiB0cnVlXHJcbiAgICB9LCAoaWZyYW1lKSA9PiBuZXcgUHJvbWlzZShhc3luYyAocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgYXdhaXQgaWZyYW1lLnJlc3R5bGUoe1xyXG4gICAgICAgICAgICAvLyBQcmV2ZW50IGlmcmFtZSBmcm9tIGNsb3Npbmcgb24gbW91c2Ugb3V0LlxyXG4gICAgICAgICAgICBzZXRIaWRlT25MZWF2ZTogZmFsc2VcclxuICAgICAgICB9KTtcclxuICAgICAgICBjb25zdCBuZXR3b3JrRXJyb3IgPSBfY3JlYXRlRXJyb3IoYXV0aCwgXCJuZXR3b3JrLXJlcXVlc3QtZmFpbGVkXCIgLyogTkVUV09SS19SRVFVRVNUX0ZBSUxFRCAqLyk7XHJcbiAgICAgICAgLy8gQ29uZmlybSBpZnJhbWUgaXMgY29ycmVjdGx5IGxvYWRlZC5cclxuICAgICAgICAvLyBUbyBmYWxsYmFjayBvbiBmYWlsdXJlLCBzZXQgYSB0aW1lb3V0LlxyXG4gICAgICAgIGNvbnN0IG5ldHdvcmtFcnJvclRpbWVyID0gX3dpbmRvdygpLnNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICByZWplY3QobmV0d29ya0Vycm9yKTtcclxuICAgICAgICB9LCBQSU5HX1RJTUVPVVQuZ2V0KCkpO1xyXG4gICAgICAgIC8vIENsZWFyIHRpbWVyIGFuZCByZXNvbHZlIHBlbmRpbmcgaWZyYW1lIHJlYWR5IHByb21pc2UuXHJcbiAgICAgICAgZnVuY3Rpb24gY2xlYXJUaW1lckFuZFJlc29sdmUoKSB7XHJcbiAgICAgICAgICAgIF93aW5kb3coKS5jbGVhclRpbWVvdXQobmV0d29ya0Vycm9yVGltZXIpO1xyXG4gICAgICAgICAgICByZXNvbHZlKGlmcmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFRoaXMgcmV0dXJucyBhbiBJVGhlbmFibGUuIEhvd2V2ZXIgdGhlIHJlamVjdCBwYXJ0IGRvZXMgbm90IGNhbGxcclxuICAgICAgICAvLyB3aGVuIHRoZSBpZnJhbWUgaXMgbm90IGxvYWRlZC5cclxuICAgICAgICBpZnJhbWUucGluZyhjbGVhclRpbWVyQW5kUmVzb2x2ZSkudGhlbihjbGVhclRpbWVyQW5kUmVzb2x2ZSwgKCkgPT4ge1xyXG4gICAgICAgICAgICByZWplY3QobmV0d29ya0Vycm9yKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQy5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuY29uc3QgQkFTRV9QT1BVUF9PUFRJT05TID0ge1xyXG4gICAgbG9jYXRpb246ICd5ZXMnLFxyXG4gICAgcmVzaXphYmxlOiAneWVzJyxcclxuICAgIHN0YXR1c2JhcjogJ3llcycsXHJcbiAgICB0b29sYmFyOiAnbm8nXHJcbn07XHJcbmNvbnN0IERFRkFVTFRfV0lEVEggPSA1MDA7XHJcbmNvbnN0IERFRkFVTFRfSEVJR0hUID0gNjAwO1xyXG5jb25zdCBUQVJHRVRfQkxBTksgPSAnX2JsYW5rJztcclxuY29uc3QgRklSRUZPWF9FTVBUWV9VUkwgPSAnaHR0cDovL2xvY2FsaG9zdCc7XHJcbmNsYXNzIEF1dGhQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3Rvcih3aW5kb3cpIHtcclxuICAgICAgICB0aGlzLndpbmRvdyA9IHdpbmRvdztcclxuICAgICAgICB0aGlzLmFzc29jaWF0ZWRFdmVudCA9IG51bGw7XHJcbiAgICB9XHJcbiAgICBjbG9zZSgpIHtcclxuICAgICAgICBpZiAodGhpcy53aW5kb3cpIHtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIHRoaXMud2luZG93LmNsb3NlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0Y2ggKGUpIHsgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBfb3BlbihhdXRoLCB1cmwsIG5hbWUsIHdpZHRoID0gREVGQVVMVF9XSURUSCwgaGVpZ2h0ID0gREVGQVVMVF9IRUlHSFQpIHtcclxuICAgIGNvbnN0IHRvcCA9IE1hdGgubWF4KCh3aW5kb3cuc2NyZWVuLmF2YWlsSGVpZ2h0IC0gaGVpZ2h0KSAvIDIsIDApLnRvU3RyaW5nKCk7XHJcbiAgICBjb25zdCBsZWZ0ID0gTWF0aC5tYXgoKHdpbmRvdy5zY3JlZW4uYXZhaWxXaWR0aCAtIHdpZHRoKSAvIDIsIDApLnRvU3RyaW5nKCk7XHJcbiAgICBsZXQgdGFyZ2V0ID0gJyc7XHJcbiAgICBjb25zdCBvcHRpb25zID0gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCBCQVNFX1BPUFVQX09QVElPTlMpLCB7IHdpZHRoOiB3aWR0aC50b1N0cmluZygpLCBoZWlnaHQ6IGhlaWdodC50b1N0cmluZygpLCB0b3AsXHJcbiAgICAgICAgbGVmdCB9KTtcclxuICAgIC8vIENocm9tZSBpT1MgNyBhbmQgOCBpcyByZXR1cm5pbmcgYW4gdW5kZWZpbmVkIHBvcHVwIHdpbiB3aGVuIHRhcmdldCBpc1xyXG4gICAgLy8gc3BlY2lmaWVkLCBldmVuIHRob3VnaCB0aGUgcG9wdXAgaXMgbm90IG5lY2Vzc2FyaWx5IGJsb2NrZWQuXHJcbiAgICBjb25zdCB1YSA9IGdldFVBKCkudG9Mb3dlckNhc2UoKTtcclxuICAgIGlmIChuYW1lKSB7XHJcbiAgICAgICAgdGFyZ2V0ID0gX2lzQ2hyb21lSU9TKHVhKSA/IFRBUkdFVF9CTEFOSyA6IG5hbWU7XHJcbiAgICB9XHJcbiAgICBpZiAoX2lzRmlyZWZveCh1YSkpIHtcclxuICAgICAgICAvLyBGaXJlZm94IGNvbXBsYWlucyB3aGVuIGludmFsaWQgVVJMcyBhcmUgcG9wcGVkIG91dC4gSGFja3kgd2F5IHRvIGJ5cGFzcy5cclxuICAgICAgICB1cmwgPSB1cmwgfHwgRklSRUZPWF9FTVBUWV9VUkw7XHJcbiAgICAgICAgLy8gRmlyZWZveCBkaXNhYmxlcyBieSBkZWZhdWx0IHNjcm9sbGluZyBvbiBwb3B1cCB3aW5kb3dzLCB3aGljaCBjYW4gY3JlYXRlXHJcbiAgICAgICAgLy8gaXNzdWVzIHdoZW4gdGhlIHVzZXIgaGFzIG1hbnkgR29vZ2xlIGFjY291bnRzLCBmb3IgaW5zdGFuY2UuXHJcbiAgICAgICAgb3B0aW9ucy5zY3JvbGxiYXJzID0gJ3llcyc7XHJcbiAgICB9XHJcbiAgICBjb25zdCBvcHRpb25zU3RyaW5nID0gT2JqZWN0LmVudHJpZXMob3B0aW9ucykucmVkdWNlKChhY2N1bSwgW2tleSwgdmFsdWVdKSA9PiBgJHthY2N1bX0ke2tleX09JHt2YWx1ZX0sYCwgJycpO1xyXG4gICAgaWYgKF9pc0lPU1N0YW5kYWxvbmUodWEpICYmIHRhcmdldCAhPT0gJ19zZWxmJykge1xyXG4gICAgICAgIG9wZW5Bc05ld1dpbmRvd0lPUyh1cmwgfHwgJycsIHRhcmdldCk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBBdXRoUG9wdXAobnVsbCk7XHJcbiAgICB9XHJcbiAgICAvLyBhYm91dDpibGFuayBnZXR0aW5nIHNhbml0aXplZCBjYXVzaW5nIGJyb3dzZXJzIGxpa2UgSUUvRWRnZSB0byBkaXNwbGF5XHJcbiAgICAvLyBicmllZiBlcnJvciBtZXNzYWdlIGJlZm9yZSByZWRpcmVjdGluZyB0byBoYW5kbGVyLlxyXG4gICAgY29uc3QgbmV3V2luID0gd2luZG93Lm9wZW4odXJsIHx8ICcnLCB0YXJnZXQsIG9wdGlvbnNTdHJpbmcpO1xyXG4gICAgX2Fzc2VydChuZXdXaW4sIGF1dGgsIFwicG9wdXAtYmxvY2tlZFwiIC8qIFBPUFVQX0JMT0NLRUQgKi8pO1xyXG4gICAgLy8gRmxha3kgb24gSUUgZWRnZSwgZW5jYXBzdWxhdGUgd2l0aCBhIHRyeSBhbmQgY2F0Y2guXHJcbiAgICB0cnkge1xyXG4gICAgICAgIG5ld1dpbi5mb2N1cygpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGUpIHsgfVxyXG4gICAgcmV0dXJuIG5ldyBBdXRoUG9wdXAobmV3V2luKTtcclxufVxyXG5mdW5jdGlvbiBvcGVuQXNOZXdXaW5kb3dJT1ModXJsLCB0YXJnZXQpIHtcclxuICAgIGNvbnN0IGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xyXG4gICAgZWwuaHJlZiA9IHVybDtcclxuICAgIGVsLnRhcmdldCA9IHRhcmdldDtcclxuICAgIGNvbnN0IGNsaWNrID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ01vdXNlRXZlbnQnKTtcclxuICAgIGNsaWNrLmluaXRNb3VzZUV2ZW50KCdjbGljaycsIHRydWUsIHRydWUsIHdpbmRvdywgMSwgMCwgMCwgMCwgMCwgZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIDEsIG51bGwpO1xyXG4gICAgZWwuZGlzcGF0Y2hFdmVudChjbGljayk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIxIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFVSTCBmb3IgQXV0aGVudGljYXRpb24gd2lkZ2V0IHdoaWNoIHdpbGwgaW5pdGlhdGUgdGhlIE9BdXRoIGhhbmRzaGFrZVxyXG4gKlxyXG4gKiBAaW50ZXJuYWxcclxuICovXHJcbmNvbnN0IFdJREdFVF9QQVRIID0gJ19fL2F1dGgvaGFuZGxlcic7XHJcbi8qKlxyXG4gKiBVUkwgZm9yIGVtdWxhdGVkIGVudmlyb25tZW50XHJcbiAqXHJcbiAqIEBpbnRlcm5hbFxyXG4gKi9cclxuY29uc3QgRU1VTEFUT1JfV0lER0VUX1BBVEggPSAnZW11bGF0b3IvYXV0aC9oYW5kbGVyJztcclxuZnVuY3Rpb24gX2dldFJlZGlyZWN0VXJsKGF1dGgsIHByb3ZpZGVyLCBhdXRoVHlwZSwgcmVkaXJlY3RVcmwsIGV2ZW50SWQsIGFkZGl0aW9uYWxQYXJhbXMpIHtcclxuICAgIF9hc3NlcnQoYXV0aC5jb25maWcuYXV0aERvbWFpbiwgYXV0aCwgXCJhdXRoLWRvbWFpbi1jb25maWctcmVxdWlyZWRcIiAvKiBNSVNTSU5HX0FVVEhfRE9NQUlOICovKTtcclxuICAgIF9hc3NlcnQoYXV0aC5jb25maWcuYXBpS2V5LCBhdXRoLCBcImludmFsaWQtYXBpLWtleVwiIC8qIElOVkFMSURfQVBJX0tFWSAqLyk7XHJcbiAgICBjb25zdCBwYXJhbXMgPSB7XHJcbiAgICAgICAgYXBpS2V5OiBhdXRoLmNvbmZpZy5hcGlLZXksXHJcbiAgICAgICAgYXBwTmFtZTogYXV0aC5uYW1lLFxyXG4gICAgICAgIGF1dGhUeXBlLFxyXG4gICAgICAgIHJlZGlyZWN0VXJsLFxyXG4gICAgICAgIHY6IFNES19WRVJTSU9OLFxyXG4gICAgICAgIGV2ZW50SWRcclxuICAgIH07XHJcbiAgICBpZiAocHJvdmlkZXIgaW5zdGFuY2VvZiBGZWRlcmF0ZWRBdXRoUHJvdmlkZXIpIHtcclxuICAgICAgICBwcm92aWRlci5zZXREZWZhdWx0TGFuZ3VhZ2UoYXV0aC5sYW5ndWFnZUNvZGUpO1xyXG4gICAgICAgIHBhcmFtcy5wcm92aWRlcklkID0gcHJvdmlkZXIucHJvdmlkZXJJZCB8fCAnJztcclxuICAgICAgICBpZiAoIWlzRW1wdHkocHJvdmlkZXIuZ2V0Q3VzdG9tUGFyYW1ldGVycygpKSkge1xyXG4gICAgICAgICAgICBwYXJhbXMuY3VzdG9tUGFyYW1ldGVycyA9IEpTT04uc3RyaW5naWZ5KHByb3ZpZGVyLmdldEN1c3RvbVBhcmFtZXRlcnMoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFRPRE8gc2V0IGFkZGl0aW9uYWxQYXJhbXMgZnJvbSB0aGUgcHJvdmlkZXIgYXMgd2VsbD9cclxuICAgICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhhZGRpdGlvbmFsUGFyYW1zIHx8IHt9KSkge1xyXG4gICAgICAgICAgICBwYXJhbXNba2V5XSA9IHZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGlmIChwcm92aWRlciBpbnN0YW5jZW9mIEJhc2VPQXV0aFByb3ZpZGVyKSB7XHJcbiAgICAgICAgY29uc3Qgc2NvcGVzID0gcHJvdmlkZXIuZ2V0U2NvcGVzKCkuZmlsdGVyKHNjb3BlID0+IHNjb3BlICE9PSAnJyk7XHJcbiAgICAgICAgaWYgKHNjb3Blcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHBhcmFtcy5zY29wZXMgPSBzY29wZXMuam9pbignLCcpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGlmIChhdXRoLnRlbmFudElkKSB7XHJcbiAgICAgICAgcGFyYW1zLnRpZCA9IGF1dGgudGVuYW50SWQ7XHJcbiAgICB9XHJcbiAgICAvLyBUT0RPOiBtYXliZSBzZXQgZWlkIGFzIGVuZGlwb2ludElkXHJcbiAgICAvLyBUT0RPOiBtYXliZSBzZXQgZncgYXMgRnJhbWV3b3Jrcy5qb2luKFwiLFwiKVxyXG4gICAgY29uc3QgcGFyYW1zRGljdCA9IHBhcmFtcztcclxuICAgIGZvciAoY29uc3Qga2V5IG9mIE9iamVjdC5rZXlzKHBhcmFtc0RpY3QpKSB7XHJcbiAgICAgICAgaWYgKHBhcmFtc0RpY3Rba2V5XSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIGRlbGV0ZSBwYXJhbXNEaWN0W2tleV07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGAke2dldEhhbmRsZXJCYXNlKGF1dGgpfT8ke3F1ZXJ5c3RyaW5nKHBhcmFtc0RpY3QpLnNsaWNlKDEpfWA7XHJcbn1cclxuZnVuY3Rpb24gZ2V0SGFuZGxlckJhc2UoeyBjb25maWcgfSkge1xyXG4gICAgaWYgKCFjb25maWcuZW11bGF0b3IpIHtcclxuICAgICAgICByZXR1cm4gYGh0dHBzOi8vJHtjb25maWcuYXV0aERvbWFpbn0vJHtXSURHRVRfUEFUSH1gO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIF9lbXVsYXRvclVybChjb25maWcsIEVNVUxBVE9SX1dJREdFVF9QQVRIKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogVGhlIHNwZWNpYWwgd2ViIHN0b3JhZ2UgZXZlbnRcclxuICpcclxuICovXHJcbmNvbnN0IFdFQl9TVE9SQUdFX1NVUFBPUlRfS0VZID0gJ3dlYlN0b3JhZ2VTdXBwb3J0JztcclxuY2xhc3MgQnJvd3NlclBvcHVwUmVkaXJlY3RSZXNvbHZlciB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLmV2ZW50TWFuYWdlcnMgPSB7fTtcclxuICAgICAgICB0aGlzLmlmcmFtZXMgPSB7fTtcclxuICAgICAgICB0aGlzLm9yaWdpblZhbGlkYXRpb25Qcm9taXNlcyA9IHt9O1xyXG4gICAgICAgIHRoaXMuX3JlZGlyZWN0UGVyc2lzdGVuY2UgPSBicm93c2VyU2Vzc2lvblBlcnNpc3RlbmNlO1xyXG4gICAgICAgIHRoaXMuX2NvbXBsZXRlUmVkaXJlY3RGbiA9IF9nZXRSZWRpcmVjdFJlc3VsdDtcclxuICAgIH1cclxuICAgIC8vIFdyYXBwaW5nIGluIGFzeW5jIGV2ZW4gdGhvdWdoIHdlIGRvbid0IGF3YWl0IGFueXdoZXJlIGluIG9yZGVyXHJcbiAgICAvLyB0byBtYWtlIHN1cmUgZXJyb3JzIGFyZSByYWlzZWQgYXMgcHJvbWlzZSByZWplY3Rpb25zXHJcbiAgICBhc3luYyBfb3BlblBvcHVwKGF1dGgsIHByb3ZpZGVyLCBhdXRoVHlwZSwgZXZlbnRJZCkge1xyXG4gICAgICAgIHZhciBfYTtcclxuICAgICAgICBkZWJ1Z0Fzc2VydCgoX2EgPSB0aGlzLmV2ZW50TWFuYWdlcnNbYXV0aC5fa2V5KCldKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EubWFuYWdlciwgJ19pbml0aWFsaXplKCkgbm90IGNhbGxlZCBiZWZvcmUgX29wZW5Qb3B1cCgpJyk7XHJcbiAgICAgICAgY29uc3QgdXJsID0gX2dldFJlZGlyZWN0VXJsKGF1dGgsIHByb3ZpZGVyLCBhdXRoVHlwZSwgX2dldEN1cnJlbnRVcmwoKSwgZXZlbnRJZCk7XHJcbiAgICAgICAgcmV0dXJuIF9vcGVuKGF1dGgsIHVybCwgX2dlbmVyYXRlRXZlbnRJZCgpKTtcclxuICAgIH1cclxuICAgIGFzeW5jIF9vcGVuUmVkaXJlY3QoYXV0aCwgcHJvdmlkZXIsIGF1dGhUeXBlLCBldmVudElkKSB7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5fb3JpZ2luVmFsaWRhdGlvbihhdXRoKTtcclxuICAgICAgICBfc2V0V2luZG93TG9jYXRpb24oX2dldFJlZGlyZWN0VXJsKGF1dGgsIHByb3ZpZGVyLCBhdXRoVHlwZSwgX2dldEN1cnJlbnRVcmwoKSwgZXZlbnRJZCkpO1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgoKSA9PiB7IH0pO1xyXG4gICAgfVxyXG4gICAgX2luaXRpYWxpemUoYXV0aCkge1xyXG4gICAgICAgIGNvbnN0IGtleSA9IGF1dGguX2tleSgpO1xyXG4gICAgICAgIGlmICh0aGlzLmV2ZW50TWFuYWdlcnNba2V5XSkge1xyXG4gICAgICAgICAgICBjb25zdCB7IG1hbmFnZXIsIHByb21pc2UgfSA9IHRoaXMuZXZlbnRNYW5hZ2Vyc1trZXldO1xyXG4gICAgICAgICAgICBpZiAobWFuYWdlcikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShtYW5hZ2VyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGRlYnVnQXNzZXJ0KHByb21pc2UsICdJZiBtYW5hZ2VyIGlzIG5vdCBzZXQsIHByb21pc2Ugc2hvdWxkIGJlJyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJvbWlzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBwcm9taXNlID0gdGhpcy5pbml0QW5kR2V0TWFuYWdlcihhdXRoKTtcclxuICAgICAgICB0aGlzLmV2ZW50TWFuYWdlcnNba2V5XSA9IHsgcHJvbWlzZSB9O1xyXG4gICAgICAgIHJldHVybiBwcm9taXNlO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgaW5pdEFuZEdldE1hbmFnZXIoYXV0aCkge1xyXG4gICAgICAgIGNvbnN0IGlmcmFtZSA9IGF3YWl0IF9vcGVuSWZyYW1lKGF1dGgpO1xyXG4gICAgICAgIGNvbnN0IG1hbmFnZXIgPSBuZXcgQXV0aEV2ZW50TWFuYWdlcihhdXRoKTtcclxuICAgICAgICBpZnJhbWUucmVnaXN0ZXIoJ2F1dGhFdmVudCcsIChpZnJhbWVFdmVudCkgPT4ge1xyXG4gICAgICAgICAgICBfYXNzZXJ0KGlmcmFtZUV2ZW50ID09PSBudWxsIHx8IGlmcmFtZUV2ZW50ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBpZnJhbWVFdmVudC5hdXRoRXZlbnQsIGF1dGgsIFwiaW52YWxpZC1hdXRoLWV2ZW50XCIgLyogSU5WQUxJRF9BVVRIX0VWRU5UICovKTtcclxuICAgICAgICAgICAgLy8gVE9ETzogQ29uc2lkZXIgc3BsaXR0aW5nIHJlZGlyZWN0IGFuZCBwb3B1cCBldmVudHMgZWFybGllciBvblxyXG4gICAgICAgICAgICBjb25zdCBoYW5kbGVkID0gbWFuYWdlci5vbkV2ZW50KGlmcmFtZUV2ZW50LmF1dGhFdmVudCk7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHN0YXR1czogaGFuZGxlZCA/IFwiQUNLXCIgLyogQUNLICovIDogXCJFUlJPUlwiIC8qIEVSUk9SICovIH07XHJcbiAgICAgICAgfSwgZ2FwaS5pZnJhbWVzLkNST1NTX09SSUdJTl9JRlJBTUVTX0ZJTFRFUik7XHJcbiAgICAgICAgdGhpcy5ldmVudE1hbmFnZXJzW2F1dGguX2tleSgpXSA9IHsgbWFuYWdlciB9O1xyXG4gICAgICAgIHRoaXMuaWZyYW1lc1thdXRoLl9rZXkoKV0gPSBpZnJhbWU7XHJcbiAgICAgICAgcmV0dXJuIG1hbmFnZXI7XHJcbiAgICB9XHJcbiAgICBfaXNJZnJhbWVXZWJTdG9yYWdlU3VwcG9ydGVkKGF1dGgsIGNiKSB7XHJcbiAgICAgICAgY29uc3QgaWZyYW1lID0gdGhpcy5pZnJhbWVzW2F1dGguX2tleSgpXTtcclxuICAgICAgICBpZnJhbWUuc2VuZChXRUJfU1RPUkFHRV9TVVBQT1JUX0tFWSwgeyB0eXBlOiBXRUJfU1RPUkFHRV9TVVBQT1JUX0tFWSB9LCByZXN1bHQgPT4ge1xyXG4gICAgICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgICAgIGNvbnN0IGlzU3VwcG9ydGVkID0gKF9hID0gcmVzdWx0ID09PSBudWxsIHx8IHJlc3VsdCA9PT0gdm9pZCAwID8gdm9pZCAwIDogcmVzdWx0WzBdKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2FbV0VCX1NUT1JBR0VfU1VQUE9SVF9LRVldO1xyXG4gICAgICAgICAgICBpZiAoaXNTdXBwb3J0ZWQgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgY2IoISFpc1N1cHBvcnRlZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgX2ZhaWwoYXV0aCwgXCJpbnRlcm5hbC1lcnJvclwiIC8qIElOVEVSTkFMX0VSUk9SICovKTtcclxuICAgICAgICB9LCBnYXBpLmlmcmFtZXMuQ1JPU1NfT1JJR0lOX0lGUkFNRVNfRklMVEVSKTtcclxuICAgIH1cclxuICAgIF9vcmlnaW5WYWxpZGF0aW9uKGF1dGgpIHtcclxuICAgICAgICBjb25zdCBrZXkgPSBhdXRoLl9rZXkoKTtcclxuICAgICAgICBpZiAoIXRoaXMub3JpZ2luVmFsaWRhdGlvblByb21pc2VzW2tleV0pIHtcclxuICAgICAgICAgICAgdGhpcy5vcmlnaW5WYWxpZGF0aW9uUHJvbWlzZXNba2V5XSA9IF92YWxpZGF0ZU9yaWdpbihhdXRoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMub3JpZ2luVmFsaWRhdGlvblByb21pc2VzW2tleV07XHJcbiAgICB9XHJcbiAgICBnZXQgX3Nob3VsZEluaXRQcm9hY3RpdmVseSgpIHtcclxuICAgICAgICAvLyBNb2JpbGUgYnJvd3NlcnMgYW5kIFNhZmFyaSBuZWVkIHRvIG9wdGltaXN0aWNhbGx5IGluaXRpYWxpemVcclxuICAgICAgICByZXR1cm4gX2lzTW9iaWxlQnJvd3NlcigpIHx8IF9pc1NhZmFyaSgpIHx8IF9pc0lPUygpO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBBbiBpbXBsZW1lbnRhdGlvbiBvZiB7QGxpbmsgUG9wdXBSZWRpcmVjdFJlc29sdmVyfSBzdWl0YWJsZSBmb3IgYnJvd3NlclxyXG4gKiBiYXNlZCBhcHBsaWNhdGlvbnMuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmNvbnN0IGJyb3dzZXJQb3B1cFJlZGlyZWN0UmVzb2x2ZXIgPSBCcm93c2VyUG9wdXBSZWRpcmVjdFJlc29sdmVyO1xuXG5jbGFzcyBNdWx0aUZhY3RvckFzc2VydGlvbkltcGwge1xyXG4gICAgY29uc3RydWN0b3IoZmFjdG9ySWQpIHtcclxuICAgICAgICB0aGlzLmZhY3RvcklkID0gZmFjdG9ySWQ7XHJcbiAgICB9XHJcbiAgICBfcHJvY2VzcyhhdXRoLCBzZXNzaW9uLCBkaXNwbGF5TmFtZSkge1xyXG4gICAgICAgIHN3aXRjaCAoc2Vzc2lvbi50eXBlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgXCJlbnJvbGxcIiAvKiBFTlJPTEwgKi86XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZmluYWxpemVFbnJvbGwoYXV0aCwgc2Vzc2lvbi5jcmVkZW50aWFsLCBkaXNwbGF5TmFtZSk7XHJcbiAgICAgICAgICAgIGNhc2UgXCJzaWduaW5cIiAvKiBTSUdOX0lOICovOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2ZpbmFsaXplU2lnbkluKGF1dGgsIHNlc3Npb24uY3JlZGVudGlhbCk7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVidWdGYWlsKCd1bmV4cGVjdGVkIE11bHRpRmFjdG9yU2Vzc2lvblR5cGUnKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIHtAaW5oZXJpdGRvYyBQaG9uZU11bHRpRmFjdG9yQXNzZXJ0aW9ufVxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5jbGFzcyBQaG9uZU11bHRpRmFjdG9yQXNzZXJ0aW9uSW1wbCBleHRlbmRzIE11bHRpRmFjdG9yQXNzZXJ0aW9uSW1wbCB7XHJcbiAgICBjb25zdHJ1Y3RvcihjcmVkZW50aWFsKSB7XHJcbiAgICAgICAgc3VwZXIoXCJwaG9uZVwiIC8qIFBIT05FICovKTtcclxuICAgICAgICB0aGlzLmNyZWRlbnRpYWwgPSBjcmVkZW50aWFsO1xyXG4gICAgfVxyXG4gICAgLyoqIEBpbnRlcm5hbCAqL1xyXG4gICAgc3RhdGljIF9mcm9tQ3JlZGVudGlhbChjcmVkZW50aWFsKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQaG9uZU11bHRpRmFjdG9yQXNzZXJ0aW9uSW1wbChjcmVkZW50aWFsKTtcclxuICAgIH1cclxuICAgIC8qKiBAaW50ZXJuYWwgKi9cclxuICAgIF9maW5hbGl6ZUVucm9sbChhdXRoLCBpZFRva2VuLCBkaXNwbGF5TmFtZSkge1xyXG4gICAgICAgIHJldHVybiBmaW5hbGl6ZUVucm9sbFBob25lTWZhKGF1dGgsIHtcclxuICAgICAgICAgICAgaWRUb2tlbixcclxuICAgICAgICAgICAgZGlzcGxheU5hbWUsXHJcbiAgICAgICAgICAgIHBob25lVmVyaWZpY2F0aW9uSW5mbzogdGhpcy5jcmVkZW50aWFsLl9tYWtlVmVyaWZpY2F0aW9uUmVxdWVzdCgpXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICAvKiogQGludGVybmFsICovXHJcbiAgICBfZmluYWxpemVTaWduSW4oYXV0aCwgbWZhUGVuZGluZ0NyZWRlbnRpYWwpIHtcclxuICAgICAgICByZXR1cm4gZmluYWxpemVTaWduSW5QaG9uZU1mYShhdXRoLCB7XHJcbiAgICAgICAgICAgIG1mYVBlbmRpbmdDcmVkZW50aWFsLFxyXG4gICAgICAgICAgICBwaG9uZVZlcmlmaWNhdGlvbkluZm86IHRoaXMuY3JlZGVudGlhbC5fbWFrZVZlcmlmaWNhdGlvblJlcXVlc3QoKVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBQcm92aWRlciBmb3IgZ2VuZXJhdGluZyBhIHtAbGluayBQaG9uZU11bHRpRmFjdG9yQXNzZXJ0aW9ufS5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuY2xhc3MgUGhvbmVNdWx0aUZhY3RvckdlbmVyYXRvciB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHsgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBQcm92aWRlcyBhIHtAbGluayBQaG9uZU11bHRpRmFjdG9yQXNzZXJ0aW9ufSB0byBjb25maXJtIG93bmVyc2hpcCBvZiB0aGUgcGhvbmUgc2Vjb25kIGZhY3Rvci5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gcGhvbmVBdXRoQ3JlZGVudGlhbCAtIEEgY3JlZGVudGlhbCBwcm92aWRlZCBieSB7QGxpbmsgUGhvbmVBdXRoUHJvdmlkZXIuY3JlZGVudGlhbH0uXHJcbiAgICAgKiBAcmV0dXJucyBBIHtAbGluayBQaG9uZU11bHRpRmFjdG9yQXNzZXJ0aW9ufSB3aGljaCBjYW4gYmUgdXNlZCB3aXRoXHJcbiAgICAgKiB7QGxpbmsgTXVsdGlGYWN0b3JSZXNvbHZlci5yZXNvbHZlU2lnbklufVxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgYXNzZXJ0aW9uKGNyZWRlbnRpYWwpIHtcclxuICAgICAgICByZXR1cm4gUGhvbmVNdWx0aUZhY3RvckFzc2VydGlvbkltcGwuX2Zyb21DcmVkZW50aWFsKGNyZWRlbnRpYWwpO1xyXG4gICAgfVxyXG59XG5cbnZhciBuYW1lID0gXCJAZmlyZWJhc2UvYXV0aFwiO1xudmFyIHZlcnNpb24gPSBcIjAuMTcuMVwiO1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jbGFzcyBBdXRoSW50ZXJvcCB7XHJcbiAgICBjb25zdHJ1Y3RvcihhdXRoKSB7XHJcbiAgICAgICAgdGhpcy5hdXRoID0gYXV0aDtcclxuICAgICAgICB0aGlzLmludGVybmFsTGlzdGVuZXJzID0gbmV3IE1hcCgpO1xyXG4gICAgfVxyXG4gICAgZ2V0VWlkKCkge1xyXG4gICAgICAgIHZhciBfYTtcclxuICAgICAgICB0aGlzLmFzc2VydEF1dGhDb25maWd1cmVkKCk7XHJcbiAgICAgICAgcmV0dXJuICgoX2EgPSB0aGlzLmF1dGguY3VycmVudFVzZXIpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS51aWQpIHx8IG51bGw7XHJcbiAgICB9XHJcbiAgICBhc3luYyBnZXRUb2tlbihmb3JjZVJlZnJlc2gpIHtcclxuICAgICAgICB0aGlzLmFzc2VydEF1dGhDb25maWd1cmVkKCk7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5hdXRoLl9pbml0aWFsaXphdGlvblByb21pc2U7XHJcbiAgICAgICAgaWYgKCF0aGlzLmF1dGguY3VycmVudFVzZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGFjY2Vzc1Rva2VuID0gYXdhaXQgdGhpcy5hdXRoLmN1cnJlbnRVc2VyLmdldElkVG9rZW4oZm9yY2VSZWZyZXNoKTtcclxuICAgICAgICByZXR1cm4geyBhY2Nlc3NUb2tlbiB9O1xyXG4gICAgfVxyXG4gICAgYWRkQXV0aFRva2VuTGlzdGVuZXIobGlzdGVuZXIpIHtcclxuICAgICAgICB0aGlzLmFzc2VydEF1dGhDb25maWd1cmVkKCk7XHJcbiAgICAgICAgaWYgKHRoaXMuaW50ZXJuYWxMaXN0ZW5lcnMuaGFzKGxpc3RlbmVyKSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHVuc3Vic2NyaWJlID0gdGhpcy5hdXRoLm9uSWRUb2tlbkNoYW5nZWQodXNlciA9PiB7XHJcbiAgICAgICAgICAgIHZhciBfYTtcclxuICAgICAgICAgICAgbGlzdGVuZXIoKChfYSA9IHVzZXIpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5zdHNUb2tlbk1hbmFnZXIuYWNjZXNzVG9rZW4pIHx8IG51bGwpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuaW50ZXJuYWxMaXN0ZW5lcnMuc2V0KGxpc3RlbmVyLCB1bnN1YnNjcmliZSk7XHJcbiAgICAgICAgdGhpcy51cGRhdGVQcm9hY3RpdmVSZWZyZXNoKCk7XHJcbiAgICB9XHJcbiAgICByZW1vdmVBdXRoVG9rZW5MaXN0ZW5lcihsaXN0ZW5lcikge1xyXG4gICAgICAgIHRoaXMuYXNzZXJ0QXV0aENvbmZpZ3VyZWQoKTtcclxuICAgICAgICBjb25zdCB1bnN1YnNjcmliZSA9IHRoaXMuaW50ZXJuYWxMaXN0ZW5lcnMuZ2V0KGxpc3RlbmVyKTtcclxuICAgICAgICBpZiAoIXVuc3Vic2NyaWJlKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pbnRlcm5hbExpc3RlbmVycy5kZWxldGUobGlzdGVuZXIpO1xyXG4gICAgICAgIHVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgdGhpcy51cGRhdGVQcm9hY3RpdmVSZWZyZXNoKCk7XHJcbiAgICB9XHJcbiAgICBhc3NlcnRBdXRoQ29uZmlndXJlZCgpIHtcclxuICAgICAgICBfYXNzZXJ0KHRoaXMuYXV0aC5faW5pdGlhbGl6YXRpb25Qcm9taXNlLCBcImRlcGVuZGVudC1zZGstaW5pdGlhbGl6ZWQtYmVmb3JlLWF1dGhcIiAvKiBERVBFTkRFTlRfU0RLX0lOSVRfQkVGT1JFX0FVVEggKi8pO1xyXG4gICAgfVxyXG4gICAgdXBkYXRlUHJvYWN0aXZlUmVmcmVzaCgpIHtcclxuICAgICAgICBpZiAodGhpcy5pbnRlcm5hbExpc3RlbmVycy5zaXplID4gMCkge1xyXG4gICAgICAgICAgICB0aGlzLmF1dGguX3N0YXJ0UHJvYWN0aXZlUmVmcmVzaCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5hdXRoLl9zdG9wUHJvYWN0aXZlUmVmcmVzaCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5mdW5jdGlvbiBnZXRWZXJzaW9uRm9yUGxhdGZvcm0oY2xpZW50UGxhdGZvcm0pIHtcclxuICAgIHN3aXRjaCAoY2xpZW50UGxhdGZvcm0pIHtcclxuICAgICAgICBjYXNlIFwiTm9kZVwiIC8qIE5PREUgKi86XHJcbiAgICAgICAgICAgIHJldHVybiAnbm9kZSc7XHJcbiAgICAgICAgY2FzZSBcIlJlYWN0TmF0aXZlXCIgLyogUkVBQ1RfTkFUSVZFICovOlxyXG4gICAgICAgICAgICByZXR1cm4gJ3JuJztcclxuICAgICAgICBjYXNlIFwiV29ya2VyXCIgLyogV09SS0VSICovOlxyXG4gICAgICAgICAgICByZXR1cm4gJ3dlYndvcmtlcic7XHJcbiAgICAgICAgY2FzZSBcIkNvcmRvdmFcIiAvKiBDT1JET1ZBICovOlxyXG4gICAgICAgICAgICByZXR1cm4gJ2NvcmRvdmEnO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICB9XHJcbn1cclxuLyoqIEBpbnRlcm5hbCAqL1xyXG5mdW5jdGlvbiByZWdpc3RlckF1dGgoY2xpZW50UGxhdGZvcm0pIHtcclxuICAgIF9yZWdpc3RlckNvbXBvbmVudChuZXcgQ29tcG9uZW50KFwiYXV0aFwiIC8qIEFVVEggKi8sIChjb250YWluZXIsIHsgb3B0aW9uczogZGVwcyB9KSA9PiB7XHJcbiAgICAgICAgY29uc3QgYXBwID0gY29udGFpbmVyLmdldFByb3ZpZGVyKCdhcHAnKS5nZXRJbW1lZGlhdGUoKTtcclxuICAgICAgICBjb25zdCB7IGFwaUtleSwgYXV0aERvbWFpbiB9ID0gYXBwLm9wdGlvbnM7XHJcbiAgICAgICAgcmV0dXJuIChhcHAgPT4ge1xyXG4gICAgICAgICAgICBfYXNzZXJ0KGFwaUtleSAmJiAhYXBpS2V5LmluY2x1ZGVzKCc6JyksIFwiaW52YWxpZC1hcGkta2V5XCIgLyogSU5WQUxJRF9BUElfS0VZICovLCB7IGFwcE5hbWU6IGFwcC5uYW1lIH0pO1xyXG4gICAgICAgICAgICAvLyBBdXRoIGRvbWFpbiBpcyBvcHRpb25hbCBpZiBJZFAgc2lnbiBpbiBpc24ndCBiZWluZyB1c2VkXHJcbiAgICAgICAgICAgIF9hc3NlcnQoIShhdXRoRG9tYWluID09PSBudWxsIHx8IGF1dGhEb21haW4gPT09IHZvaWQgMCA/IHZvaWQgMCA6IGF1dGhEb21haW4uaW5jbHVkZXMoJzonKSksIFwiYXJndW1lbnQtZXJyb3JcIiAvKiBBUkdVTUVOVF9FUlJPUiAqLywge1xyXG4gICAgICAgICAgICAgICAgYXBwTmFtZTogYXBwLm5hbWVcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbmZpZyA9IHtcclxuICAgICAgICAgICAgICAgIGFwaUtleSxcclxuICAgICAgICAgICAgICAgIGF1dGhEb21haW4sXHJcbiAgICAgICAgICAgICAgICBjbGllbnRQbGF0Zm9ybSxcclxuICAgICAgICAgICAgICAgIGFwaUhvc3Q6IFwiaWRlbnRpdHl0b29sa2l0Lmdvb2dsZWFwaXMuY29tXCIgLyogQVBJX0hPU1QgKi8sXHJcbiAgICAgICAgICAgICAgICB0b2tlbkFwaUhvc3Q6IFwic2VjdXJldG9rZW4uZ29vZ2xlYXBpcy5jb21cIiAvKiBUT0tFTl9BUElfSE9TVCAqLyxcclxuICAgICAgICAgICAgICAgIGFwaVNjaGVtZTogXCJodHRwc1wiIC8qIEFQSV9TQ0hFTUUgKi8sXHJcbiAgICAgICAgICAgICAgICBzZGtDbGllbnRWZXJzaW9uOiBfZ2V0Q2xpZW50VmVyc2lvbihjbGllbnRQbGF0Zm9ybSlcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgY29uc3QgYXV0aEluc3RhbmNlID0gbmV3IEF1dGhJbXBsKGFwcCwgY29uZmlnKTtcclxuICAgICAgICAgICAgX2luaXRpYWxpemVBdXRoSW5zdGFuY2UoYXV0aEluc3RhbmNlLCBkZXBzKTtcclxuICAgICAgICAgICAgcmV0dXJuIGF1dGhJbnN0YW5jZTtcclxuICAgICAgICB9KShhcHApO1xyXG4gICAgfSwgXCJQVUJMSUNcIiAvKiBQVUJMSUMgKi8pXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQXV0aCBjYW4gb25seSBiZSBpbml0aWFsaXplZCBieSBleHBsaWNpdGx5IGNhbGxpbmcgZ2V0QXV0aCgpIG9yIGluaXRpYWxpemVBdXRoKClcclxuICAgICAgICAgKiBGb3Igd2h5IHdlIGRvIHRoaXMsIFNlZSBnby9maXJlYmFzZS1uZXh0LWF1dGgtaW5pdFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIC5zZXRJbnN0YW50aWF0aW9uTW9kZShcIkVYUExJQ0lUXCIgLyogRVhQTElDSVQgKi8pXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQmVjYXVzZSBhbGwgZmlyZWJhc2UgcHJvZHVjdHMgdGhhdCBkZXBlbmQgb24gYXV0aCBkZXBlbmQgb24gYXV0aC1pbnRlcm5hbCBkaXJlY3RseSxcclxuICAgICAgICAgKiB3ZSBuZWVkIHRvIGluaXRpYWxpemUgYXV0aC1pbnRlcm5hbCBhZnRlciBhdXRoIGlzIGluaXRpYWxpemVkIHRvIG1ha2UgaXQgYXZhaWxhYmxlIHRvIG90aGVyIGZpcmViYXNlIHByb2R1Y3RzLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIC5zZXRJbnN0YW5jZUNyZWF0ZWRDYWxsYmFjaygoY29udGFpbmVyLCBfaW5zdGFuY2VJZGVudGlmaWVyLCBfaW5zdGFuY2UpID0+IHtcclxuICAgICAgICBjb25zdCBhdXRoSW50ZXJuYWxQcm92aWRlciA9IGNvbnRhaW5lci5nZXRQcm92aWRlcihcImF1dGgtaW50ZXJuYWxcIiAvKiBBVVRIX0lOVEVSTkFMICovKTtcclxuICAgICAgICBhdXRoSW50ZXJuYWxQcm92aWRlci5pbml0aWFsaXplKCk7XHJcbiAgICB9KSk7XHJcbiAgICBfcmVnaXN0ZXJDb21wb25lbnQobmV3IENvbXBvbmVudChcImF1dGgtaW50ZXJuYWxcIiAvKiBBVVRIX0lOVEVSTkFMICovLCBjb250YWluZXIgPT4ge1xyXG4gICAgICAgIGNvbnN0IGF1dGggPSBfY2FzdEF1dGgoY29udGFpbmVyLmdldFByb3ZpZGVyKFwiYXV0aFwiIC8qIEFVVEggKi8pLmdldEltbWVkaWF0ZSgpKTtcclxuICAgICAgICByZXR1cm4gKGF1dGggPT4gbmV3IEF1dGhJbnRlcm9wKGF1dGgpKShhdXRoKTtcclxuICAgIH0sIFwiUFJJVkFURVwiIC8qIFBSSVZBVEUgKi8pLnNldEluc3RhbnRpYXRpb25Nb2RlKFwiRVhQTElDSVRcIiAvKiBFWFBMSUNJVCAqLykpO1xyXG4gICAgcmVnaXN0ZXJWZXJzaW9uKG5hbWUsIHZlcnNpb24sIGdldFZlcnNpb25Gb3JQbGF0Zm9ybShjbGllbnRQbGF0Zm9ybSkpO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBSZXR1cm5zIHRoZSBBdXRoIGluc3RhbmNlIGFzc29jaWF0ZWQgd2l0aCB0aGUgcHJvdmlkZWQge0BsaW5rIEBmaXJlYmFzZS9hcHAjRmlyZWJhc2VBcHB9LlxyXG4gKiBJZiBubyBpbnN0YW5jZSBleGlzdHMsIGluaXRpYWxpemVzIGFuIEF1dGggaW5zdGFuY2Ugd2l0aCBwbGF0Zm9ybS1zcGVjaWZpYyBkZWZhdWx0IGRlcGVuZGVuY2llcy5cclxuICpcclxuICogQHBhcmFtIGFwcCAtIFRoZSBGaXJlYmFzZSBBcHAuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmZ1bmN0aW9uIGdldEF1dGgoYXBwID0gZ2V0QXBwKCkpIHtcclxuICAgIGNvbnN0IHByb3ZpZGVyID0gX2dldFByb3ZpZGVyKGFwcCwgJ2F1dGgnKTtcclxuICAgIGlmIChwcm92aWRlci5pc0luaXRpYWxpemVkKCkpIHtcclxuICAgICAgICByZXR1cm4gcHJvdmlkZXIuZ2V0SW1tZWRpYXRlKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gaW5pdGlhbGl6ZUF1dGgoYXBwLCB7XHJcbiAgICAgICAgcG9wdXBSZWRpcmVjdFJlc29sdmVyOiBicm93c2VyUG9wdXBSZWRpcmVjdFJlc29sdmVyLFxyXG4gICAgICAgIHBlcnNpc3RlbmNlOiBbXHJcbiAgICAgICAgICAgIGluZGV4ZWREQkxvY2FsUGVyc2lzdGVuY2UsXHJcbiAgICAgICAgICAgIGJyb3dzZXJMb2NhbFBlcnNpc3RlbmNlLFxyXG4gICAgICAgICAgICBicm93c2VyU2Vzc2lvblBlcnNpc3RlbmNlXHJcbiAgICAgICAgXVxyXG4gICAgfSk7XHJcbn1cclxucmVnaXN0ZXJBdXRoKFwiQnJvd3NlclwiIC8qIEJST1dTRVIgKi8pO1xuXG5leHBvcnQgeyBzZW5kUGFzc3dvcmRSZXNldEVtYWlsIGFzICQsIEFjdGlvbkNvZGVPcGVyYXRpb24gYXMgQSwgcHJvZEVycm9yTWFwIGFzIEIsIEFVVEhfRVJST1JfQ09ERVNfTUFQX0RPX05PVF9VU0VfSU5URVJOQUxMWSBhcyBDLCBpbml0aWFsaXplQXV0aCBhcyBELCBjb25uZWN0QXV0aEVtdWxhdG9yIGFzIEUsIEZhY3RvcklkIGFzIEYsIEF1dGhDcmVkZW50aWFsIGFzIEcsIEVtYWlsQXV0aENyZWRlbnRpYWwgYXMgSCwgT0F1dGhDcmVkZW50aWFsIGFzIEksIFBob25lQXV0aENyZWRlbnRpYWwgYXMgSiwgaW5NZW1vcnlQZXJzaXN0ZW5jZSBhcyBLLCBFbWFpbEF1dGhQcm92aWRlciBhcyBMLCBGYWNlYm9va0F1dGhQcm92aWRlciBhcyBNLCBHb29nbGVBdXRoUHJvdmlkZXIgYXMgTiwgT3BlcmF0aW9uVHlwZSBhcyBPLCBQaG9uZUF1dGhQcm92aWRlciBhcyBQLCBHaXRodWJBdXRoUHJvdmlkZXIgYXMgUSwgUmVjYXB0Y2hhVmVyaWZpZXIgYXMgUiwgU2lnbkluTWV0aG9kIGFzIFMsIE9BdXRoUHJvdmlkZXIgYXMgVCwgU0FNTEF1dGhQcm92aWRlciBhcyBVLCBUd2l0dGVyQXV0aFByb3ZpZGVyIGFzIFYsIHNpZ25JbkFub255bW91c2x5IGFzIFcsIHNpZ25JbldpdGhDcmVkZW50aWFsIGFzIFgsIGxpbmtXaXRoQ3JlZGVudGlhbCBhcyBZLCByZWF1dGhlbnRpY2F0ZVdpdGhDcmVkZW50aWFsIGFzIFosIHNpZ25JbldpdGhDdXN0b21Ub2tlbiBhcyBfLCBicm93c2VyU2Vzc2lvblBlcnNpc3RlbmNlIGFzIGEsIGNvbmZpcm1QYXNzd29yZFJlc2V0IGFzIGEwLCBhcHBseUFjdGlvbkNvZGUgYXMgYTEsIGNoZWNrQWN0aW9uQ29kZSBhcyBhMiwgdmVyaWZ5UGFzc3dvcmRSZXNldENvZGUgYXMgYTMsIGNyZWF0ZVVzZXJXaXRoRW1haWxBbmRQYXNzd29yZCBhcyBhNCwgc2lnbkluV2l0aEVtYWlsQW5kUGFzc3dvcmQgYXMgYTUsIHNlbmRTaWduSW5MaW5rVG9FbWFpbCBhcyBhNiwgaXNTaWduSW5XaXRoRW1haWxMaW5rIGFzIGE3LCBzaWduSW5XaXRoRW1haWxMaW5rIGFzIGE4LCBmZXRjaFNpZ25Jbk1ldGhvZHNGb3JFbWFpbCBhcyBhOSwgX2dldFJlZGlyZWN0UmVzdWx0IGFzIGFBLCBfY2xlYXJSZWRpcmVjdE91dGNvbWVzIGFzIGFCLCBfY2FzdEF1dGggYXMgYUMsIFVzZXJJbXBsIGFzIGFELCBBdXRoSW1wbCBhcyBhRSwgX2dldENsaWVudFZlcnNpb24gYXMgYUYsIF9nZW5lcmF0ZUV2ZW50SWQgYXMgYUcsIEF1dGhQb3B1cCBhcyBhSCwgRmV0Y2hQcm92aWRlciBhcyBhSSwgU0FNTEF1dGhDcmVkZW50aWFsIGFzIGFKLCBzZW5kRW1haWxWZXJpZmljYXRpb24gYXMgYWEsIHZlcmlmeUJlZm9yZVVwZGF0ZUVtYWlsIGFzIGFiLCBBY3Rpb25Db2RlVVJMIGFzIGFjLCBwYXJzZUFjdGlvbkNvZGVVUkwgYXMgYWQsIHVwZGF0ZVByb2ZpbGUgYXMgYWUsIHVwZGF0ZUVtYWlsIGFzIGFmLCB1cGRhdGVQYXNzd29yZCBhcyBhZywgZ2V0SWRUb2tlbiBhcyBhaCwgZ2V0SWRUb2tlblJlc3VsdCBhcyBhaSwgdW5saW5rIGFzIGFqLCBnZXRBZGRpdGlvbmFsVXNlckluZm8gYXMgYWssIHJlbG9hZCBhcyBhbCwgZ2V0TXVsdGlGYWN0b3JSZXNvbHZlciBhcyBhbSwgbXVsdGlGYWN0b3IgYXMgYW4sIF9pc0lPUzdPcjggYXMgYW8sIGRlYnVnQXNzZXJ0IGFzIGFwLCBfaXNJT1MgYXMgYXEsIF9pc0FuZHJvaWQgYXMgYXIsIF9mYWlsIGFzIGFzLCBfZ2V0UmVkaXJlY3RVcmwgYXMgYXQsIF9nZXRQcm9qZWN0Q29uZmlnIGFzIGF1LCBfY3JlYXRlRXJyb3IgYXMgYXYsIF9hc3NlcnQgYXMgYXcsIF9nZXRJbnN0YW5jZSBhcyBheCwgX3BlcnNpc3RlbmNlS2V5TmFtZSBhcyBheSwgQXV0aEV2ZW50TWFuYWdlciBhcyBheiwgYnJvd3NlckxvY2FsUGVyc2lzdGVuY2UgYXMgYiwgc2lnbkluV2l0aFBvcHVwIGFzIGMsIGxpbmtXaXRoUG9wdXAgYXMgZCwgcmVhdXRoZW50aWNhdGVXaXRoUG9wdXAgYXMgZSwgc2lnbkluV2l0aFJlZGlyZWN0IGFzIGYsIGxpbmtXaXRoUmVkaXJlY3QgYXMgZywgcmVhdXRoZW50aWNhdGVXaXRoUmVkaXJlY3QgYXMgaCwgaW5kZXhlZERCTG9jYWxQZXJzaXN0ZW5jZSBhcyBpLCBnZXRSZWRpcmVjdFJlc3VsdCBhcyBqLCBicm93c2VyUG9wdXBSZWRpcmVjdFJlc29sdmVyIGFzIGssIGxpbmtXaXRoUGhvbmVOdW1iZXIgYXMgbCwgUGhvbmVNdWx0aUZhY3RvckdlbmVyYXRvciBhcyBtLCBnZXRBdXRoIGFzIG4sIFByb3ZpZGVySWQgYXMgbywgc2V0UGVyc2lzdGVuY2UgYXMgcCwgb25JZFRva2VuQ2hhbmdlZCBhcyBxLCByZWF1dGhlbnRpY2F0ZVdpdGhQaG9uZU51bWJlciBhcyByLCBzaWduSW5XaXRoUGhvbmVOdW1iZXIgYXMgcywgb25BdXRoU3RhdGVDaGFuZ2VkIGFzIHQsIHVwZGF0ZVBob25lTnVtYmVyIGFzIHUsIHVzZURldmljZUxhbmd1YWdlIGFzIHYsIHVwZGF0ZUN1cnJlbnRVc2VyIGFzIHcsIHNpZ25PdXQgYXMgeCwgZGVsZXRlVXNlciBhcyB5LCBkZWJ1Z0Vycm9yTWFwIGFzIHogfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LTlmZjBmYTljLmpzLm1hcFxuIiwiaW1wb3J0IHtpbml0aWFsaXplQXBwfSBmcm9tICdmaXJlYmFzZS9hcHAnO1xuaW1wb3J0IHtnZXRBdXRoLCBSZWNhcHRjaGFWZXJpZmllcn0gZnJvbSAnZmlyZWJhc2UvYXV0aCc7XG4vLyBGaXJlc3RvcmUgKGZvciBzdG9yaW5nIG1ldGFkYXRhKVxuaW1wb3J0IHsgZ2V0RmlyZXN0b3JlLCBjb2xsZWN0aW9uLCBhZGREb2MgfSBmcm9tIFwiZmlyZWJhc2UvZmlyZXN0b3JlXCI7XG5cbi8vIEZpcmViYXNlIFN0b3JhZ2UgKGZvciB1cGxvYWRpbmcgZmlsZXMpXG5pbXBvcnQgeyBnZXRTdG9yYWdlLCByZWYsIHVwbG9hZEJ5dGVzLCBnZXREb3dubG9hZFVSTCB9IGZyb20gXCJmaXJlYmFzZS9zdG9yYWdlXCI7XG5cbmNvbnN0IGZpcmViYXNlQ29uZmlnID0ge1xuXHRhcGlLZXk6IFwiQUl6YVN5REViWC1nUTZGd0pENW9aR25hb2lKdTlxSWFBRzJMWjBNXCIsXG5cdGF1dGhEb21haW46IFwidXBsb2FkLTI1ZjAxLmZpcmViYXNlYXBwLmNvbVwiLFxuXHRwcm9qZWN0SWQ6IFwidXBsb2FkLTI1ZjAxXCIsXG5cdHN0b3JhZ2VCdWNrZXQ6IFwidXBsb2FkLTI1ZjAxLmZpcmViYXNlc3RvcmFnZS5hcHBcIixcblx0bWVzc2FnaW5nU2VuZGVySWQ6IFwiOTcxNjc0ODc2OTBcIixcblx0YXBwSWQ6IFwiMTo5NzE2NzQ4NzY5MDp3ZWI6ODg0MDlhZGVkMGExZGQxM2Y4N2EzM1wiLFxuXHRtZWFzdXJlbWVudElkOiBcIkctM1k5NEsxWENCS1wiXG4gIH07XG4gIFxuICAvLyBJbml0aWFsaXplIEZpcmViYXNlXG5jb25zdCBhcHAgPSBpbml0aWFsaXplQXBwKGZpcmViYXNlQ29uZmlnKTtcbmNvbnN0IGF1dGggPSBnZXRBdXRoKGFwcCk7IC8vIFVzZSBjb21wYXQgdmVyc2lvbiBvZiBhdXRoXG5cbi8vIEluaXRpYWxpemUgRmlyZXN0b3JlIGFuZCBTdG9yYWdlXG5jb25zdCBkYiA9IGdldEZpcmVzdG9yZShhcHApO1xuY29uc3Qgc3RvcmFnZSA9IGdldFN0b3JhZ2UoYXBwKTtcblxuZXhwb3J0e2FwcCwgYXV0aCwgUmVjYXB0Y2hhVmVyaWZpZXIsIGRiLCBzdG9yYWdlfSIsImltcG9ydCB7IGdldEFwcCwgX2dldFByb3ZpZGVyLCBfcmVnaXN0ZXJDb21wb25lbnQsIHJlZ2lzdGVyVmVyc2lvbiwgU0RLX1ZFUlNJT04gfSBmcm9tICdAZmlyZWJhc2UvYXBwJztcbmltcG9ydCB7IEZpcmViYXNlRXJyb3IsIGNyZWF0ZU1vY2tVc2VyVG9rZW4sIGdldE1vZHVsYXJJbnN0YW5jZSB9IGZyb20gJ0BmaXJlYmFzZS91dGlsJztcbmltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gJ0BmaXJlYmFzZS9jb21wb25lbnQnO1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogRXJyb3IgY29kZXMgZm9yIHJlcXVlc3RzIG1hZGUgYnkgdGhlIHRoZSBYaHJJbyB3cmFwcGVyLlxyXG4gKi9cclxudmFyIEVycm9yQ29kZTtcclxuKGZ1bmN0aW9uIChFcnJvckNvZGUpIHtcclxuICAgIEVycm9yQ29kZVtFcnJvckNvZGVbXCJOT19FUlJPUlwiXSA9IDBdID0gXCJOT19FUlJPUlwiO1xyXG4gICAgRXJyb3JDb2RlW0Vycm9yQ29kZVtcIk5FVFdPUktfRVJST1JcIl0gPSAxXSA9IFwiTkVUV09SS19FUlJPUlwiO1xyXG4gICAgRXJyb3JDb2RlW0Vycm9yQ29kZVtcIkFCT1JUXCJdID0gMl0gPSBcIkFCT1JUXCI7XHJcbn0pKEVycm9yQ29kZSB8fCAoRXJyb3JDb2RlID0ge30pKTtcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEBmaWxlb3ZlcnZpZXcgQ29uc3RhbnRzIHVzZWQgaW4gdGhlIEZpcmViYXNlIFN0b3JhZ2UgbGlicmFyeS5cclxuICovXHJcbi8qKlxyXG4gKiBEb21haW4gbmFtZSBmb3IgZmlyZWJhc2Ugc3RvcmFnZS5cclxuICovXHJcbmNvbnN0IERFRkFVTFRfSE9TVCA9ICdmaXJlYmFzZXN0b3JhZ2UuZ29vZ2xlYXBpcy5jb20nO1xyXG4vKipcclxuICogVGhlIGtleSBpbiBGaXJlYmFzZSBjb25maWcganNvbiBmb3IgdGhlIHN0b3JhZ2UgYnVja2V0LlxyXG4gKi9cclxuY29uc3QgQ09ORklHX1NUT1JBR0VfQlVDS0VUX0tFWSA9ICdzdG9yYWdlQnVja2V0JztcclxuLyoqXHJcbiAqIDIgbWludXRlc1xyXG4gKlxyXG4gKiBUaGUgdGltZW91dCBmb3IgYWxsIG9wZXJhdGlvbnMgZXhjZXB0IHVwbG9hZC5cclxuICovXHJcbmNvbnN0IERFRkFVTFRfTUFYX09QRVJBVElPTl9SRVRSWV9USU1FID0gMiAqIDYwICogMTAwMDtcclxuLyoqXHJcbiAqIDEwIG1pbnV0ZXNcclxuICpcclxuICogVGhlIHRpbWVvdXQgZm9yIHVwbG9hZC5cclxuICovXHJcbmNvbnN0IERFRkFVTFRfTUFYX1VQTE9BRF9SRVRSWV9USU1FID0gMTAgKiA2MCAqIDEwMDA7XG5cbi8qKlxyXG4gKiBBbiBlcnJvciByZXR1cm5lZCBieSB0aGUgRmlyZWJhc2UgU3RvcmFnZSBTREsuXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmNsYXNzIFN0b3JhZ2VFcnJvciBleHRlbmRzIEZpcmViYXNlRXJyb3Ige1xyXG4gICAgLyoqXHJcbiAgICAgKiBAcGFyYW0gY29kZSAtIEEgU3RvcmFnZUVycm9yQ29kZSBzdHJpbmcgdG8gYmUgcHJlZml4ZWQgd2l0aCAnc3RvcmFnZS8nIGFuZFxyXG4gICAgICogIGFkZGVkIHRvIHRoZSBlbmQgb2YgdGhlIG1lc3NhZ2UuXHJcbiAgICAgKiBAcGFyYW0gbWVzc2FnZSAgLSBFcnJvciBtZXNzYWdlLlxyXG4gICAgICovXHJcbiAgICBjb25zdHJ1Y3Rvcihjb2RlLCBtZXNzYWdlKSB7XHJcbiAgICAgICAgc3VwZXIocHJlcGVuZENvZGUoY29kZSksIGBGaXJlYmFzZSBTdG9yYWdlOiAke21lc3NhZ2V9ICgke3ByZXBlbmRDb2RlKGNvZGUpfSlgKTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBTdG9yZXMgY3VzdG9tIGVycm9yIGRhdGEgdW5xdWUgdG8gU3RvcmFnZUVycm9yLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuY3VzdG9tRGF0YSA9IHsgc2VydmVyUmVzcG9uc2U6IG51bGwgfTtcclxuICAgICAgICB0aGlzLl9iYXNlTWVzc2FnZSA9IHRoaXMubWVzc2FnZTtcclxuICAgICAgICAvLyBXaXRob3V0IHRoaXMsIGBpbnN0YW5jZW9mIFN0b3JhZ2VFcnJvcmAsIGluIHRlc3RzIGZvciBleGFtcGxlLFxyXG4gICAgICAgIC8vIHJldHVybnMgZmFsc2UuXHJcbiAgICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKHRoaXMsIFN0b3JhZ2VFcnJvci5wcm90b3R5cGUpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBDb21wYXJlcyBhIFN0b3JhZ2VFcnJvckNvZGUgYWdhaW5zdCB0aGlzIGVycm9yJ3MgY29kZSwgZmlsdGVyaW5nIG91dCB0aGUgcHJlZml4LlxyXG4gICAgICovXHJcbiAgICBfY29kZUVxdWFscyhjb2RlKSB7XHJcbiAgICAgICAgcmV0dXJuIHByZXBlbmRDb2RlKGNvZGUpID09PSB0aGlzLmNvZGU7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIE9wdGlvbmFsIHJlc3BvbnNlIG1lc3NhZ2UgdGhhdCB3YXMgYWRkZWQgYnkgdGhlIHNlcnZlci5cclxuICAgICAqL1xyXG4gICAgZ2V0IHNlcnZlclJlc3BvbnNlKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmN1c3RvbURhdGEuc2VydmVyUmVzcG9uc2U7XHJcbiAgICB9XHJcbiAgICBzZXQgc2VydmVyUmVzcG9uc2Uoc2VydmVyUmVzcG9uc2UpIHtcclxuICAgICAgICB0aGlzLmN1c3RvbURhdGEuc2VydmVyUmVzcG9uc2UgPSBzZXJ2ZXJSZXNwb25zZTtcclxuICAgICAgICBpZiAodGhpcy5jdXN0b21EYXRhLnNlcnZlclJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZSA9IGAke3RoaXMuX2Jhc2VNZXNzYWdlfVxcbiR7dGhpcy5jdXN0b21EYXRhLnNlcnZlclJlc3BvbnNlfWA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2UgPSB0aGlzLl9iYXNlTWVzc2FnZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gcHJlcGVuZENvZGUoY29kZSkge1xyXG4gICAgcmV0dXJuICdzdG9yYWdlLycgKyBjb2RlO1xyXG59XHJcbmZ1bmN0aW9uIHVua25vd24oKSB7XHJcbiAgICBjb25zdCBtZXNzYWdlID0gJ0FuIHVua25vd24gZXJyb3Igb2NjdXJyZWQsIHBsZWFzZSBjaGVjayB0aGUgZXJyb3IgcGF5bG9hZCBmb3IgJyArXHJcbiAgICAgICAgJ3NlcnZlciByZXNwb25zZS4nO1xyXG4gICAgcmV0dXJuIG5ldyBTdG9yYWdlRXJyb3IoXCJ1bmtub3duXCIgLyogVU5LTk9XTiAqLywgbWVzc2FnZSk7XHJcbn1cclxuZnVuY3Rpb24gb2JqZWN0Tm90Rm91bmQocGF0aCkge1xyXG4gICAgcmV0dXJuIG5ldyBTdG9yYWdlRXJyb3IoXCJvYmplY3Qtbm90LWZvdW5kXCIgLyogT0JKRUNUX05PVF9GT1VORCAqLywgXCJPYmplY3QgJ1wiICsgcGF0aCArIFwiJyBkb2VzIG5vdCBleGlzdC5cIik7XHJcbn1cclxuZnVuY3Rpb24gcXVvdGFFeGNlZWRlZChidWNrZXQpIHtcclxuICAgIHJldHVybiBuZXcgU3RvcmFnZUVycm9yKFwicXVvdGEtZXhjZWVkZWRcIiAvKiBRVU9UQV9FWENFRURFRCAqLywgXCJRdW90YSBmb3IgYnVja2V0ICdcIiArXHJcbiAgICAgICAgYnVja2V0ICtcclxuICAgICAgICBcIicgZXhjZWVkZWQsIHBsZWFzZSB2aWV3IHF1b3RhIG9uIFwiICtcclxuICAgICAgICAnaHR0cHM6Ly9maXJlYmFzZS5nb29nbGUuY29tL3ByaWNpbmcvLicpO1xyXG59XHJcbmZ1bmN0aW9uIHVuYXV0aGVudGljYXRlZCgpIHtcclxuICAgIGNvbnN0IG1lc3NhZ2UgPSAnVXNlciBpcyBub3QgYXV0aGVudGljYXRlZCwgcGxlYXNlIGF1dGhlbnRpY2F0ZSB1c2luZyBGaXJlYmFzZSAnICtcclxuICAgICAgICAnQXV0aGVudGljYXRpb24gYW5kIHRyeSBhZ2Fpbi4nO1xyXG4gICAgcmV0dXJuIG5ldyBTdG9yYWdlRXJyb3IoXCJ1bmF1dGhlbnRpY2F0ZWRcIiAvKiBVTkFVVEhFTlRJQ0FURUQgKi8sIG1lc3NhZ2UpO1xyXG59XHJcbmZ1bmN0aW9uIHVuYXV0aG9yaXplZEFwcCgpIHtcclxuICAgIHJldHVybiBuZXcgU3RvcmFnZUVycm9yKFwidW5hdXRob3JpemVkLWFwcFwiIC8qIFVOQVVUSE9SSVpFRF9BUFAgKi8sICdUaGlzIGFwcCBkb2VzIG5vdCBoYXZlIHBlcm1pc3Npb24gdG8gYWNjZXNzIEZpcmViYXNlIFN0b3JhZ2Ugb24gdGhpcyBwcm9qZWN0LicpO1xyXG59XHJcbmZ1bmN0aW9uIHVuYXV0aG9yaXplZChwYXRoKSB7XHJcbiAgICByZXR1cm4gbmV3IFN0b3JhZ2VFcnJvcihcInVuYXV0aG9yaXplZFwiIC8qIFVOQVVUSE9SSVpFRCAqLywgXCJVc2VyIGRvZXMgbm90IGhhdmUgcGVybWlzc2lvbiB0byBhY2Nlc3MgJ1wiICsgcGF0aCArIFwiJy5cIik7XHJcbn1cclxuZnVuY3Rpb24gcmV0cnlMaW1pdEV4Y2VlZGVkKCkge1xyXG4gICAgcmV0dXJuIG5ldyBTdG9yYWdlRXJyb3IoXCJyZXRyeS1saW1pdC1leGNlZWRlZFwiIC8qIFJFVFJZX0xJTUlUX0VYQ0VFREVEICovLCAnTWF4IHJldHJ5IHRpbWUgZm9yIG9wZXJhdGlvbiBleGNlZWRlZCwgcGxlYXNlIHRyeSBhZ2Fpbi4nKTtcclxufVxyXG5mdW5jdGlvbiBjYW5jZWxlZCgpIHtcclxuICAgIHJldHVybiBuZXcgU3RvcmFnZUVycm9yKFwiY2FuY2VsZWRcIiAvKiBDQU5DRUxFRCAqLywgJ1VzZXIgY2FuY2VsZWQgdGhlIHVwbG9hZC9kb3dubG9hZC4nKTtcclxufVxyXG5mdW5jdGlvbiBpbnZhbGlkVXJsKHVybCkge1xyXG4gICAgcmV0dXJuIG5ldyBTdG9yYWdlRXJyb3IoXCJpbnZhbGlkLXVybFwiIC8qIElOVkFMSURfVVJMICovLCBcIkludmFsaWQgVVJMICdcIiArIHVybCArIFwiJy5cIik7XHJcbn1cclxuZnVuY3Rpb24gaW52YWxpZERlZmF1bHRCdWNrZXQoYnVja2V0KSB7XHJcbiAgICByZXR1cm4gbmV3IFN0b3JhZ2VFcnJvcihcImludmFsaWQtZGVmYXVsdC1idWNrZXRcIiAvKiBJTlZBTElEX0RFRkFVTFRfQlVDS0VUICovLCBcIkludmFsaWQgZGVmYXVsdCBidWNrZXQgJ1wiICsgYnVja2V0ICsgXCInLlwiKTtcclxufVxyXG5mdW5jdGlvbiBub0RlZmF1bHRCdWNrZXQoKSB7XHJcbiAgICByZXR1cm4gbmV3IFN0b3JhZ2VFcnJvcihcIm5vLWRlZmF1bHQtYnVja2V0XCIgLyogTk9fREVGQVVMVF9CVUNLRVQgKi8sICdObyBkZWZhdWx0IGJ1Y2tldCAnICtcclxuICAgICAgICBcImZvdW5kLiBEaWQgeW91IHNldCB0aGUgJ1wiICtcclxuICAgICAgICBDT05GSUdfU1RPUkFHRV9CVUNLRVRfS0VZICtcclxuICAgICAgICBcIicgcHJvcGVydHkgd2hlbiBpbml0aWFsaXppbmcgdGhlIGFwcD9cIik7XHJcbn1cclxuZnVuY3Rpb24gY2Fubm90U2xpY2VCbG9iKCkge1xyXG4gICAgcmV0dXJuIG5ldyBTdG9yYWdlRXJyb3IoXCJjYW5ub3Qtc2xpY2UtYmxvYlwiIC8qIENBTk5PVF9TTElDRV9CTE9CICovLCAnQ2Fubm90IHNsaWNlIGJsb2IgZm9yIHVwbG9hZC4gUGxlYXNlIHJldHJ5IHRoZSB1cGxvYWQuJyk7XHJcbn1cclxuZnVuY3Rpb24gc2VydmVyRmlsZVdyb25nU2l6ZSgpIHtcclxuICAgIHJldHVybiBuZXcgU3RvcmFnZUVycm9yKFwic2VydmVyLWZpbGUtd3Jvbmctc2l6ZVwiIC8qIFNFUlZFUl9GSUxFX1dST05HX1NJWkUgKi8sICdTZXJ2ZXIgcmVjb3JkZWQgaW5jb3JyZWN0IHVwbG9hZCBmaWxlIHNpemUsIHBsZWFzZSByZXRyeSB0aGUgdXBsb2FkLicpO1xyXG59XHJcbmZ1bmN0aW9uIG5vRG93bmxvYWRVUkwoKSB7XHJcbiAgICByZXR1cm4gbmV3IFN0b3JhZ2VFcnJvcihcIm5vLWRvd25sb2FkLXVybFwiIC8qIE5PX0RPV05MT0FEX1VSTCAqLywgJ1RoZSBnaXZlbiBmaWxlIGRvZXMgbm90IGhhdmUgYW55IGRvd25sb2FkIFVSTHMuJyk7XHJcbn1cclxuLyoqXHJcbiAqIEBpbnRlcm5hbFxyXG4gKi9cclxuZnVuY3Rpb24gaW52YWxpZEFyZ3VtZW50KG1lc3NhZ2UpIHtcclxuICAgIHJldHVybiBuZXcgU3RvcmFnZUVycm9yKFwiaW52YWxpZC1hcmd1bWVudFwiIC8qIElOVkFMSURfQVJHVU1FTlQgKi8sIG1lc3NhZ2UpO1xyXG59XHJcbmZ1bmN0aW9uIGFwcERlbGV0ZWQoKSB7XHJcbiAgICByZXR1cm4gbmV3IFN0b3JhZ2VFcnJvcihcImFwcC1kZWxldGVkXCIgLyogQVBQX0RFTEVURUQgKi8sICdUaGUgRmlyZWJhc2UgYXBwIHdhcyBkZWxldGVkLicpO1xyXG59XHJcbi8qKlxyXG4gKiBAcGFyYW0gbmFtZSAtIFRoZSBuYW1lIG9mIHRoZSBvcGVyYXRpb24gdGhhdCB3YXMgaW52YWxpZC5cclxuICpcclxuICogQGludGVybmFsXHJcbiAqL1xyXG5mdW5jdGlvbiBpbnZhbGlkUm9vdE9wZXJhdGlvbihuYW1lKSB7XHJcbiAgICByZXR1cm4gbmV3IFN0b3JhZ2VFcnJvcihcImludmFsaWQtcm9vdC1vcGVyYXRpb25cIiAvKiBJTlZBTElEX1JPT1RfT1BFUkFUSU9OICovLCBcIlRoZSBvcGVyYXRpb24gJ1wiICtcclxuICAgICAgICBuYW1lICtcclxuICAgICAgICBcIicgY2Fubm90IGJlIHBlcmZvcm1lZCBvbiBhIHJvb3QgcmVmZXJlbmNlLCBjcmVhdGUgYSBub24tcm9vdCBcIiArXHJcbiAgICAgICAgXCJyZWZlcmVuY2UgdXNpbmcgY2hpbGQsIHN1Y2ggYXMgLmNoaWxkKCdmaWxlLnBuZycpLlwiKTtcclxufVxyXG4vKipcclxuICogQHBhcmFtIGZvcm1hdCAtIFRoZSBmb3JtYXQgdGhhdCB3YXMgbm90IHZhbGlkLlxyXG4gKiBAcGFyYW0gbWVzc2FnZSAtIEEgbWVzc2FnZSBkZXNjcmliaW5nIHRoZSBmb3JtYXQgdmlvbGF0aW9uLlxyXG4gKi9cclxuZnVuY3Rpb24gaW52YWxpZEZvcm1hdChmb3JtYXQsIG1lc3NhZ2UpIHtcclxuICAgIHJldHVybiBuZXcgU3RvcmFnZUVycm9yKFwiaW52YWxpZC1mb3JtYXRcIiAvKiBJTlZBTElEX0ZPUk1BVCAqLywgXCJTdHJpbmcgZG9lcyBub3QgbWF0Y2ggZm9ybWF0ICdcIiArIGZvcm1hdCArIFwiJzogXCIgKyBtZXNzYWdlKTtcclxufVxyXG4vKipcclxuICogQHBhcmFtIG1lc3NhZ2UgLSBBIG1lc3NhZ2UgZGVzY3JpYmluZyB0aGUgaW50ZXJuYWwgZXJyb3IuXHJcbiAqL1xyXG5mdW5jdGlvbiBpbnRlcm5hbEVycm9yKG1lc3NhZ2UpIHtcclxuICAgIHRocm93IG5ldyBTdG9yYWdlRXJyb3IoXCJpbnRlcm5hbC1lcnJvclwiIC8qIElOVEVSTkFMX0VSUk9SICovLCAnSW50ZXJuYWwgZXJyb3I6ICcgKyBtZXNzYWdlKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogTmV0d29yayBsYXllciBmb3IgYnJvd3NlcnMuIFdlIHVzZSB0aGlzIGluc3RlYWQgb2YgZ29vZy5uZXQuWGhySW8gYmVjYXVzZVxyXG4gKiBnb29nLm5ldC5YaHJJbyBpcyBoeXV1dXVnZSBhbmQgZG9lc24ndCB3b3JrIGluIFJlYWN0IE5hdGl2ZSBvbiBBbmRyb2lkLlxyXG4gKi9cclxuY2xhc3MgWGhyQ29ubmVjdGlvbiB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLnNlbnRfID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy54aHJfID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XHJcbiAgICAgICAgdGhpcy5lcnJvckNvZGVfID0gRXJyb3JDb2RlLk5PX0VSUk9SO1xyXG4gICAgICAgIHRoaXMuc2VuZFByb21pc2VfID0gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMueGhyXy5hZGRFdmVudExpc3RlbmVyKCdhYm9ydCcsICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZXJyb3JDb2RlXyA9IEVycm9yQ29kZS5BQk9SVDtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRoaXMueGhyXy5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZXJyb3JDb2RlXyA9IEVycm9yQ29kZS5ORVRXT1JLX0VSUk9SO1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy54aHJfLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBAb3ZlcnJpZGVcclxuICAgICAqL1xyXG4gICAgc2VuZCh1cmwsIG1ldGhvZCwgYm9keSwgaGVhZGVycykge1xyXG4gICAgICAgIGlmICh0aGlzLnNlbnRfKSB7XHJcbiAgICAgICAgICAgIHRocm93IGludGVybmFsRXJyb3IoJ2Nhbm5vdCAuc2VuZCgpIG1vcmUgdGhhbiBvbmNlJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2VudF8gPSB0cnVlO1xyXG4gICAgICAgIHRoaXMueGhyXy5vcGVuKG1ldGhvZCwgdXJsLCB0cnVlKTtcclxuICAgICAgICBpZiAoaGVhZGVycyAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIGhlYWRlcnMpIHtcclxuICAgICAgICAgICAgICAgIGlmIChoZWFkZXJzLmhhc093blByb3BlcnR5KGtleSkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnhocl8uc2V0UmVxdWVzdEhlYWRlcihrZXksIGhlYWRlcnNba2V5XS50b1N0cmluZygpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoYm9keSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMueGhyXy5zZW5kKGJvZHkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy54aHJfLnNlbmQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VuZFByb21pc2VfO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBAb3ZlcnJpZGVcclxuICAgICAqL1xyXG4gICAgZ2V0RXJyb3JDb2RlKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5zZW50Xykge1xyXG4gICAgICAgICAgICB0aHJvdyBpbnRlcm5hbEVycm9yKCdjYW5ub3QgLmdldEVycm9yQ29kZSgpIGJlZm9yZSBzZW5kaW5nJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmVycm9yQ29kZV87XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEBvdmVycmlkZVxyXG4gICAgICovXHJcbiAgICBnZXRTdGF0dXMoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLnNlbnRfKSB7XHJcbiAgICAgICAgICAgIHRocm93IGludGVybmFsRXJyb3IoJ2Nhbm5vdCAuZ2V0U3RhdHVzKCkgYmVmb3JlIHNlbmRpbmcnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMueGhyXy5zdGF0dXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAtMTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEBvdmVycmlkZVxyXG4gICAgICovXHJcbiAgICBnZXRSZXNwb25zZVRleHQoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLnNlbnRfKSB7XHJcbiAgICAgICAgICAgIHRocm93IGludGVybmFsRXJyb3IoJ2Nhbm5vdCAuZ2V0UmVzcG9uc2VUZXh0KCkgYmVmb3JlIHNlbmRpbmcnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMueGhyXy5yZXNwb25zZVRleHQ7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEFib3J0cyB0aGUgcmVxdWVzdC5cclxuICAgICAqIEBvdmVycmlkZVxyXG4gICAgICovXHJcbiAgICBhYm9ydCgpIHtcclxuICAgICAgICB0aGlzLnhocl8uYWJvcnQoKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQG92ZXJyaWRlXHJcbiAgICAgKi9cclxuICAgIGdldFJlc3BvbnNlSGVhZGVyKGhlYWRlcikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnhocl8uZ2V0UmVzcG9uc2VIZWFkZXIoaGVhZGVyKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQG92ZXJyaWRlXHJcbiAgICAgKi9cclxuICAgIGFkZFVwbG9hZFByb2dyZXNzTGlzdGVuZXIobGlzdGVuZXIpIHtcclxuICAgICAgICBpZiAodGhpcy54aHJfLnVwbG9hZCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMueGhyXy51cGxvYWQuYWRkRXZlbnRMaXN0ZW5lcigncHJvZ3Jlc3MnLCBsaXN0ZW5lcik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBAb3ZlcnJpZGVcclxuICAgICAqL1xyXG4gICAgcmVtb3ZlVXBsb2FkUHJvZ3Jlc3NMaXN0ZW5lcihsaXN0ZW5lcikge1xyXG4gICAgICAgIGlmICh0aGlzLnhocl8udXBsb2FkICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy54aHJfLnVwbG9hZC5yZW1vdmVFdmVudExpc3RlbmVyKCdwcm9ncmVzcycsIGxpc3RlbmVyKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gbmV3Q29ubmVjdGlvbigpIHtcclxuICAgIHJldHVybiBuZXcgWGhyQ29ubmVjdGlvbigpO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBGYWN0b3J5LWxpa2UgY2xhc3MgZm9yIGNyZWF0aW5nIFhocklvIGluc3RhbmNlcy5cclxuICovXHJcbmNsYXNzIENvbm5lY3Rpb25Qb29sIHtcclxuICAgIGNyZWF0ZUNvbm5lY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ld0Nvbm5lY3Rpb24oKTtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogRmlyZWJhc2UgU3RvcmFnZSBsb2NhdGlvbiBkYXRhLlxyXG4gKlxyXG4gKiBAaW50ZXJuYWxcclxuICovXHJcbmNsYXNzIExvY2F0aW9uIHtcclxuICAgIGNvbnN0cnVjdG9yKGJ1Y2tldCwgcGF0aCkge1xyXG4gICAgICAgIHRoaXMuYnVja2V0ID0gYnVja2V0O1xyXG4gICAgICAgIHRoaXMucGF0aF8gPSBwYXRoO1xyXG4gICAgfVxyXG4gICAgZ2V0IHBhdGgoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGF0aF87XHJcbiAgICB9XHJcbiAgICBnZXQgaXNSb290KCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBhdGgubGVuZ3RoID09PSAwO1xyXG4gICAgfVxyXG4gICAgZnVsbFNlcnZlclVybCgpIHtcclxuICAgICAgICBjb25zdCBlbmNvZGUgPSBlbmNvZGVVUklDb21wb25lbnQ7XHJcbiAgICAgICAgcmV0dXJuICcvYi8nICsgZW5jb2RlKHRoaXMuYnVja2V0KSArICcvby8nICsgZW5jb2RlKHRoaXMucGF0aCk7XHJcbiAgICB9XHJcbiAgICBidWNrZXRPbmx5U2VydmVyVXJsKCkge1xyXG4gICAgICAgIGNvbnN0IGVuY29kZSA9IGVuY29kZVVSSUNvbXBvbmVudDtcclxuICAgICAgICByZXR1cm4gJy9iLycgKyBlbmNvZGUodGhpcy5idWNrZXQpICsgJy9vJztcclxuICAgIH1cclxuICAgIHN0YXRpYyBtYWtlRnJvbUJ1Y2tldFNwZWMoYnVja2V0U3RyaW5nLCBob3N0KSB7XHJcbiAgICAgICAgbGV0IGJ1Y2tldExvY2F0aW9uO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGJ1Y2tldExvY2F0aW9uID0gTG9jYXRpb24ubWFrZUZyb21VcmwoYnVja2V0U3RyaW5nLCBob3N0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgLy8gTm90IHZhbGlkIFVSTCwgdXNlIGFzLWlzLiBUaGlzIGxldHMgeW91IHB1dCBiYXJlIGJ1Y2tldCBuYW1lcyBpblxyXG4gICAgICAgICAgICAvLyBjb25maWcuXHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgTG9jYXRpb24oYnVja2V0U3RyaW5nLCAnJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChidWNrZXRMb2NhdGlvbi5wYXRoID09PSAnJykge1xyXG4gICAgICAgICAgICByZXR1cm4gYnVja2V0TG9jYXRpb247XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aHJvdyBpbnZhbGlkRGVmYXVsdEJ1Y2tldChidWNrZXRTdHJpbmcpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHN0YXRpYyBtYWtlRnJvbVVybCh1cmwsIGhvc3QpIHtcclxuICAgICAgICBsZXQgbG9jYXRpb24gPSBudWxsO1xyXG4gICAgICAgIGNvbnN0IGJ1Y2tldERvbWFpbiA9ICcoW0EtWmEtejAtOS5cXFxcLV9dKyknO1xyXG4gICAgICAgIGZ1bmN0aW9uIGdzTW9kaWZ5KGxvYykge1xyXG4gICAgICAgICAgICBpZiAobG9jLnBhdGguY2hhckF0KGxvYy5wYXRoLmxlbmd0aCAtIDEpID09PSAnLycpIHtcclxuICAgICAgICAgICAgICAgIGxvYy5wYXRoXyA9IGxvYy5wYXRoXy5zbGljZSgwLCAtMSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgZ3NQYXRoID0gJygvKC4qKSk/JCc7XHJcbiAgICAgICAgY29uc3QgZ3NSZWdleCA9IG5ldyBSZWdFeHAoJ15nczovLycgKyBidWNrZXREb21haW4gKyBnc1BhdGgsICdpJyk7XHJcbiAgICAgICAgY29uc3QgZ3NJbmRpY2VzID0geyBidWNrZXQ6IDEsIHBhdGg6IDMgfTtcclxuICAgICAgICBmdW5jdGlvbiBodHRwTW9kaWZ5KGxvYykge1xyXG4gICAgICAgICAgICBsb2MucGF0aF8gPSBkZWNvZGVVUklDb21wb25lbnQobG9jLnBhdGgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCB2ZXJzaW9uID0gJ3ZbQS1aYS16MC05X10rJztcclxuICAgICAgICBjb25zdCBmaXJlYmFzZVN0b3JhZ2VIb3N0ID0gaG9zdC5yZXBsYWNlKC9bLl0vZywgJ1xcXFwuJyk7XHJcbiAgICAgICAgY29uc3QgZmlyZWJhc2VTdG9yYWdlUGF0aCA9ICcoLyhbXj8jXSopLiopPyQnO1xyXG4gICAgICAgIGNvbnN0IGZpcmViYXNlU3RvcmFnZVJlZ0V4cCA9IG5ldyBSZWdFeHAoYF5odHRwcz86Ly8ke2ZpcmViYXNlU3RvcmFnZUhvc3R9LyR7dmVyc2lvbn0vYi8ke2J1Y2tldERvbWFpbn0vbyR7ZmlyZWJhc2VTdG9yYWdlUGF0aH1gLCAnaScpO1xyXG4gICAgICAgIGNvbnN0IGZpcmViYXNlU3RvcmFnZUluZGljZXMgPSB7IGJ1Y2tldDogMSwgcGF0aDogMyB9O1xyXG4gICAgICAgIGNvbnN0IGNsb3VkU3RvcmFnZUhvc3QgPSBob3N0ID09PSBERUZBVUxUX0hPU1RcclxuICAgICAgICAgICAgPyAnKD86c3RvcmFnZS5nb29nbGVhcGlzLmNvbXxzdG9yYWdlLmNsb3VkLmdvb2dsZS5jb20pJ1xyXG4gICAgICAgICAgICA6IGhvc3Q7XHJcbiAgICAgICAgY29uc3QgY2xvdWRTdG9yYWdlUGF0aCA9ICcoW14/I10qKSc7XHJcbiAgICAgICAgY29uc3QgY2xvdWRTdG9yYWdlUmVnRXhwID0gbmV3IFJlZ0V4cChgXmh0dHBzPzovLyR7Y2xvdWRTdG9yYWdlSG9zdH0vJHtidWNrZXREb21haW59LyR7Y2xvdWRTdG9yYWdlUGF0aH1gLCAnaScpO1xyXG4gICAgICAgIGNvbnN0IGNsb3VkU3RvcmFnZUluZGljZXMgPSB7IGJ1Y2tldDogMSwgcGF0aDogMiB9O1xyXG4gICAgICAgIGNvbnN0IGdyb3VwcyA9IFtcclxuICAgICAgICAgICAgeyByZWdleDogZ3NSZWdleCwgaW5kaWNlczogZ3NJbmRpY2VzLCBwb3N0TW9kaWZ5OiBnc01vZGlmeSB9LFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZWdleDogZmlyZWJhc2VTdG9yYWdlUmVnRXhwLFxyXG4gICAgICAgICAgICAgICAgaW5kaWNlczogZmlyZWJhc2VTdG9yYWdlSW5kaWNlcyxcclxuICAgICAgICAgICAgICAgIHBvc3RNb2RpZnk6IGh0dHBNb2RpZnlcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmVnZXg6IGNsb3VkU3RvcmFnZVJlZ0V4cCxcclxuICAgICAgICAgICAgICAgIGluZGljZXM6IGNsb3VkU3RvcmFnZUluZGljZXMsXHJcbiAgICAgICAgICAgICAgICBwb3N0TW9kaWZ5OiBodHRwTW9kaWZ5XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICBdO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZ3JvdXBzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGdyb3VwID0gZ3JvdXBzW2ldO1xyXG4gICAgICAgICAgICBjb25zdCBjYXB0dXJlcyA9IGdyb3VwLnJlZ2V4LmV4ZWModXJsKTtcclxuICAgICAgICAgICAgaWYgKGNhcHR1cmVzKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBidWNrZXRWYWx1ZSA9IGNhcHR1cmVzW2dyb3VwLmluZGljZXMuYnVja2V0XTtcclxuICAgICAgICAgICAgICAgIGxldCBwYXRoVmFsdWUgPSBjYXB0dXJlc1tncm91cC5pbmRpY2VzLnBhdGhdO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFwYXRoVmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBwYXRoVmFsdWUgPSAnJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGxvY2F0aW9uID0gbmV3IExvY2F0aW9uKGJ1Y2tldFZhbHVlLCBwYXRoVmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgZ3JvdXAucG9zdE1vZGlmeShsb2NhdGlvbik7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobG9jYXRpb24gPT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aHJvdyBpbnZhbGlkVXJsKHVybCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBsb2NhdGlvbjtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQSByZXF1ZXN0IHdob3NlIHByb21pc2UgYWx3YXlzIGZhaWxzLlxyXG4gKi9cclxuY2xhc3MgRmFpbFJlcXVlc3Qge1xyXG4gICAgY29uc3RydWN0b3IoZXJyb3IpIHtcclxuICAgICAgICB0aGlzLnByb21pc2VfID0gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xyXG4gICAgfVxyXG4gICAgLyoqIEBpbmhlcml0RG9jICovXHJcbiAgICBnZXRQcm9taXNlKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnByb21pc2VfO1xyXG4gICAgfVxyXG4gICAgLyoqIEBpbmhlcml0RG9jICovXHJcbiAgICBjYW5jZWwoX2FwcERlbGV0ZSA9IGZhbHNlKSB7IH1cclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogQHBhcmFtIGYgTWF5IGJlIGludm9rZWRcclxuICogICAgIGJlZm9yZSB0aGUgZnVuY3Rpb24gcmV0dXJucy5cclxuICogQHBhcmFtIGNhbGxiYWNrIEdldCBhbGwgdGhlIGFyZ3VtZW50cyBwYXNzZWQgdG8gdGhlIGZ1bmN0aW9uXHJcbiAqICAgICBwYXNzZWQgdG8gZiwgaW5jbHVkaW5nIHRoZSBpbml0aWFsIGJvb2xlYW4uXHJcbiAqL1xyXG5mdW5jdGlvbiBzdGFydChmLCBcclxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcclxuY2FsbGJhY2ssIHRpbWVvdXQpIHtcclxuICAgIC8vIFRPRE8oYW5keXNvdG8pOiBtYWtlIHRoaXMgY29kZSBjbGVhbmVyIChwcm9iYWJseSByZWZhY3RvciBpbnRvIGFuIGFjdHVhbFxyXG4gICAgLy8gdHlwZSBpbnN0ZWFkIG9mIGEgYnVuY2ggb2YgZnVuY3Rpb25zIHdpdGggc3RhdGUgc2hhcmVkIGluIHRoZSBjbG9zdXJlKVxyXG4gICAgbGV0IHdhaXRTZWNvbmRzID0gMTtcclxuICAgIC8vIFdvdWxkIHR5cGUgdGhpcyBhcyBcIm51bWJlclwiIGJ1dCB0aGF0IGRvZXNuJ3Qgd29yayBmb3IgTm9kZSBzbyDCr1xcXyjjg4QpXy/Cr1xyXG4gICAgLy8gVE9ETzogZmluZCBhIHdheSB0byBleGNsdWRlIE5vZGUgdHlwZSBkZWZpbml0aW9uIGZvciBzdG9yYWdlIGJlY2F1c2Ugc3RvcmFnZSBvbmx5IHdvcmtzIGluIGJyb3dzZXJcclxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XHJcbiAgICBsZXQgdGltZW91dElkID0gbnVsbDtcclxuICAgIGxldCBoaXRUaW1lb3V0ID0gZmFsc2U7XHJcbiAgICBsZXQgY2FuY2VsU3RhdGUgPSAwO1xyXG4gICAgZnVuY3Rpb24gY2FuY2VsZWQoKSB7XHJcbiAgICAgICAgcmV0dXJuIGNhbmNlbFN0YXRlID09PSAyO1xyXG4gICAgfVxyXG4gICAgbGV0IHRyaWdnZXJlZENhbGxiYWNrID0gZmFsc2U7XHJcbiAgICBmdW5jdGlvbiB0cmlnZ2VyQ2FsbGJhY2soLi4uYXJncykge1xyXG4gICAgICAgIGlmICghdHJpZ2dlcmVkQ2FsbGJhY2spIHtcclxuICAgICAgICAgICAgdHJpZ2dlcmVkQ2FsbGJhY2sgPSB0cnVlO1xyXG4gICAgICAgICAgICBjYWxsYmFjay5hcHBseShudWxsLCBhcmdzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBjYWxsV2l0aERlbGF5KG1pbGxpcykge1xyXG4gICAgICAgIHRpbWVvdXRJZCA9IHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICB0aW1lb3V0SWQgPSBudWxsO1xyXG4gICAgICAgICAgICBmKGhhbmRsZXIsIGNhbmNlbGVkKCkpO1xyXG4gICAgICAgIH0sIG1pbGxpcyk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBoYW5kbGVyKHN1Y2Nlc3MsIC4uLmFyZ3MpIHtcclxuICAgICAgICBpZiAodHJpZ2dlcmVkQ2FsbGJhY2spIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoc3VjY2Vzcykge1xyXG4gICAgICAgICAgICB0cmlnZ2VyQ2FsbGJhY2suY2FsbChudWxsLCBzdWNjZXNzLCAuLi5hcmdzKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBtdXN0U3RvcCA9IGNhbmNlbGVkKCkgfHwgaGl0VGltZW91dDtcclxuICAgICAgICBpZiAobXVzdFN0b3ApIHtcclxuICAgICAgICAgICAgdHJpZ2dlckNhbGxiYWNrLmNhbGwobnVsbCwgc3VjY2VzcywgLi4uYXJncyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHdhaXRTZWNvbmRzIDwgNjQpIHtcclxuICAgICAgICAgICAgLyogVE9ETyhhbmR5c290byk6IGRvbid0IGJhY2sgb2ZmIHNvIHF1aWNrbHkgaWYgd2Uga25vdyB3ZSdyZSBvZmZsaW5lLiAqL1xyXG4gICAgICAgICAgICB3YWl0U2Vjb25kcyAqPSAyO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgd2FpdE1pbGxpcztcclxuICAgICAgICBpZiAoY2FuY2VsU3RhdGUgPT09IDEpIHtcclxuICAgICAgICAgICAgY2FuY2VsU3RhdGUgPSAyO1xyXG4gICAgICAgICAgICB3YWl0TWlsbGlzID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHdhaXRNaWxsaXMgPSAod2FpdFNlY29uZHMgKyBNYXRoLnJhbmRvbSgpKSAqIDEwMDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhbGxXaXRoRGVsYXkod2FpdE1pbGxpcyk7XHJcbiAgICB9XHJcbiAgICBsZXQgc3RvcHBlZCA9IGZhbHNlO1xyXG4gICAgZnVuY3Rpb24gc3RvcCh3YXNUaW1lb3V0KSB7XHJcbiAgICAgICAgaWYgKHN0b3BwZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzdG9wcGVkID0gdHJ1ZTtcclxuICAgICAgICBpZiAodHJpZ2dlcmVkQ2FsbGJhY2spIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGltZW91dElkICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGlmICghd2FzVGltZW91dCkge1xyXG4gICAgICAgICAgICAgICAgY2FuY2VsU3RhdGUgPSAyO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xyXG4gICAgICAgICAgICBjYWxsV2l0aERlbGF5KDApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKCF3YXNUaW1lb3V0KSB7XHJcbiAgICAgICAgICAgICAgICBjYW5jZWxTdGF0ZSA9IDE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBjYWxsV2l0aERlbGF5KDApO1xyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgaGl0VGltZW91dCA9IHRydWU7XHJcbiAgICAgICAgc3RvcCh0cnVlKTtcclxuICAgIH0sIHRpbWVvdXQpO1xyXG4gICAgcmV0dXJuIHN0b3A7XHJcbn1cclxuLyoqXHJcbiAqIFN0b3BzIHRoZSByZXRyeSBsb29wIGZyb20gcmVwZWF0aW5nLlxyXG4gKiBJZiB0aGUgZnVuY3Rpb24gaXMgY3VycmVudGx5IFwiaW4gYmV0d2VlblwiIHJldHJpZXMsIGl0IGlzIGludm9rZWQgaW1tZWRpYXRlbHlcclxuICogd2l0aCB0aGUgc2Vjb25kIHBhcmFtZXRlciBhcyBcInRydWVcIi4gT3RoZXJ3aXNlLCBpdCB3aWxsIGJlIGludm9rZWQgb25jZSBtb3JlXHJcbiAqIGFmdGVyIHRoZSBjdXJyZW50IGludm9jYXRpb24gZmluaXNoZXMgaWZmIHRoZSBjdXJyZW50IGludm9jYXRpb24gd291bGQgaGF2ZVxyXG4gKiB0cmlnZ2VyZWQgYW5vdGhlciByZXRyeS5cclxuICovXHJcbmZ1bmN0aW9uIHN0b3AoaWQpIHtcclxuICAgIGlkKGZhbHNlKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5mdW5jdGlvbiBpc0p1c3REZWYocCkge1xyXG4gICAgcmV0dXJuIHAgIT09IHZvaWQgMDtcclxufVxyXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L2Jhbi10eXBlc1xyXG5mdW5jdGlvbiBpc0Z1bmN0aW9uKHApIHtcclxuICAgIHJldHVybiB0eXBlb2YgcCA9PT0gJ2Z1bmN0aW9uJztcclxufVxyXG5mdW5jdGlvbiBpc05vbkFycmF5T2JqZWN0KHApIHtcclxuICAgIHJldHVybiB0eXBlb2YgcCA9PT0gJ29iamVjdCcgJiYgIUFycmF5LmlzQXJyYXkocCk7XHJcbn1cclxuZnVuY3Rpb24gaXNTdHJpbmcocCkge1xyXG4gICAgcmV0dXJuIHR5cGVvZiBwID09PSAnc3RyaW5nJyB8fCBwIGluc3RhbmNlb2YgU3RyaW5nO1xyXG59XHJcbmZ1bmN0aW9uIGlzTmF0aXZlQmxvYihwKSB7XHJcbiAgICByZXR1cm4gaXNOYXRpdmVCbG9iRGVmaW5lZCgpICYmIHAgaW5zdGFuY2VvZiBCbG9iO1xyXG59XHJcbmZ1bmN0aW9uIGlzTmF0aXZlQmxvYkRlZmluZWQoKSB7XHJcbiAgICByZXR1cm4gdHlwZW9mIEJsb2IgIT09ICd1bmRlZmluZWQnO1xyXG59XHJcbmZ1bmN0aW9uIHZhbGlkYXRlTnVtYmVyKGFyZ3VtZW50LCBtaW5WYWx1ZSwgbWF4VmFsdWUsIHZhbHVlKSB7XHJcbiAgICBpZiAodmFsdWUgPCBtaW5WYWx1ZSkge1xyXG4gICAgICAgIHRocm93IGludmFsaWRBcmd1bWVudChgSW52YWxpZCB2YWx1ZSBmb3IgJyR7YXJndW1lbnR9Jy4gRXhwZWN0ZWQgJHttaW5WYWx1ZX0gb3IgZ3JlYXRlci5gKTtcclxuICAgIH1cclxuICAgIGlmICh2YWx1ZSA+IG1heFZhbHVlKSB7XHJcbiAgICAgICAgdGhyb3cgaW52YWxpZEFyZ3VtZW50KGBJbnZhbGlkIHZhbHVlIGZvciAnJHthcmd1bWVudH0nLiBFeHBlY3RlZCAke21heFZhbHVlfSBvciBsZXNzLmApO1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmZ1bmN0aW9uIG1ha2VVcmwodXJsUGFydCwgaG9zdCkge1xyXG4gICAgY29uc3QgcHJvdG9jb2xNYXRjaCA9IGhvc3QubWF0Y2goL14oXFx3Kyk6XFwvXFwvLisvKTtcclxuICAgIGNvbnN0IHByb3RvY29sID0gcHJvdG9jb2xNYXRjaCA9PT0gbnVsbCB8fCBwcm90b2NvbE1hdGNoID09PSB2b2lkIDAgPyB2b2lkIDAgOiBwcm90b2NvbE1hdGNoWzFdO1xyXG4gICAgbGV0IG9yaWdpbiA9IGhvc3Q7XHJcbiAgICBpZiAocHJvdG9jb2wgPT0gbnVsbCkge1xyXG4gICAgICAgIG9yaWdpbiA9IGBodHRwczovLyR7aG9zdH1gO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGAke29yaWdpbn0vdjAke3VybFBhcnR9YDtcclxufVxyXG5mdW5jdGlvbiBtYWtlUXVlcnlTdHJpbmcocGFyYW1zKSB7XHJcbiAgICBjb25zdCBlbmNvZGUgPSBlbmNvZGVVUklDb21wb25lbnQ7XHJcbiAgICBsZXQgcXVlcnlQYXJ0ID0gJz8nO1xyXG4gICAgZm9yIChjb25zdCBrZXkgaW4gcGFyYW1zKSB7XHJcbiAgICAgICAgaWYgKHBhcmFtcy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5leHRQYXJ0ID0gZW5jb2RlKGtleSkgKyAnPScgKyBlbmNvZGUocGFyYW1zW2tleV0pO1xyXG4gICAgICAgICAgICBxdWVyeVBhcnQgPSBxdWVyeVBhcnQgKyBuZXh0UGFydCArICcmJztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyBDaG9wIG9mZiB0aGUgZXh0cmEgJyYnIG9yICc/JyBvbiB0aGUgZW5kXHJcbiAgICBxdWVyeVBhcnQgPSBxdWVyeVBhcnQuc2xpY2UoMCwgLTEpO1xyXG4gICAgcmV0dXJuIHF1ZXJ5UGFydDtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jbGFzcyBOZXR3b3JrUmVxdWVzdCB7XHJcbiAgICBjb25zdHJ1Y3Rvcih1cmwsIG1ldGhvZCwgaGVhZGVycywgYm9keSwgc3VjY2Vzc0NvZGVzLCBhZGRpdGlvbmFsUmV0cnlDb2RlcywgY2FsbGJhY2ssIGVycm9yQ2FsbGJhY2ssIHRpbWVvdXQsIHByb2dyZXNzQ2FsbGJhY2ssIHBvb2wpIHtcclxuICAgICAgICB0aGlzLnBlbmRpbmdDb25uZWN0aW9uXyA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5iYWNrb2ZmSWRfID0gbnVsbDtcclxuICAgICAgICB0aGlzLmNhbmNlbGVkXyA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuYXBwRGVsZXRlXyA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMudXJsXyA9IHVybDtcclxuICAgICAgICB0aGlzLm1ldGhvZF8gPSBtZXRob2Q7XHJcbiAgICAgICAgdGhpcy5oZWFkZXJzXyA9IGhlYWRlcnM7XHJcbiAgICAgICAgdGhpcy5ib2R5XyA9IGJvZHk7XHJcbiAgICAgICAgdGhpcy5zdWNjZXNzQ29kZXNfID0gc3VjY2Vzc0NvZGVzLnNsaWNlKCk7XHJcbiAgICAgICAgdGhpcy5hZGRpdGlvbmFsUmV0cnlDb2Rlc18gPSBhZGRpdGlvbmFsUmV0cnlDb2Rlcy5zbGljZSgpO1xyXG4gICAgICAgIHRoaXMuY2FsbGJhY2tfID0gY2FsbGJhY2s7XHJcbiAgICAgICAgdGhpcy5lcnJvckNhbGxiYWNrXyA9IGVycm9yQ2FsbGJhY2s7XHJcbiAgICAgICAgdGhpcy5wcm9ncmVzc0NhbGxiYWNrXyA9IHByb2dyZXNzQ2FsbGJhY2s7XHJcbiAgICAgICAgdGhpcy50aW1lb3V0XyA9IHRpbWVvdXQ7XHJcbiAgICAgICAgdGhpcy5wb29sXyA9IHBvb2w7XHJcbiAgICAgICAgdGhpcy5wcm9taXNlXyA9IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5yZXNvbHZlXyA9IHJlc29sdmU7XHJcbiAgICAgICAgICAgIHRoaXMucmVqZWN0XyA9IHJlamVjdDtcclxuICAgICAgICAgICAgdGhpcy5zdGFydF8oKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQWN0dWFsbHkgc3RhcnRzIHRoZSByZXRyeSBsb29wLlxyXG4gICAgICovXHJcbiAgICBzdGFydF8oKSB7XHJcbiAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgZnVuY3Rpb24gZG9UaGVSZXF1ZXN0KGJhY2tvZmZDYWxsYmFjaywgY2FuY2VsZWQpIHtcclxuICAgICAgICAgICAgaWYgKGNhbmNlbGVkKSB7XHJcbiAgICAgICAgICAgICAgICBiYWNrb2ZmQ2FsbGJhY2soZmFsc2UsIG5ldyBSZXF1ZXN0RW5kU3RhdHVzKGZhbHNlLCBudWxsLCB0cnVlKSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgY29ubmVjdGlvbiA9IHNlbGYucG9vbF8uY3JlYXRlQ29ubmVjdGlvbigpO1xyXG4gICAgICAgICAgICBzZWxmLnBlbmRpbmdDb25uZWN0aW9uXyA9IGNvbm5lY3Rpb247XHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIHByb2dyZXNzTGlzdGVuZXIocHJvZ3Jlc3NFdmVudCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbG9hZGVkID0gcHJvZ3Jlc3NFdmVudC5sb2FkZWQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0b3RhbCA9IHByb2dyZXNzRXZlbnQubGVuZ3RoQ29tcHV0YWJsZSA/IHByb2dyZXNzRXZlbnQudG90YWwgOiAtMTtcclxuICAgICAgICAgICAgICAgIGlmIChzZWxmLnByb2dyZXNzQ2FsbGJhY2tfICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5wcm9ncmVzc0NhbGxiYWNrXyhsb2FkZWQsIHRvdGFsKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoc2VsZi5wcm9ncmVzc0NhbGxiYWNrXyAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgY29ubmVjdGlvbi5hZGRVcGxvYWRQcm9ncmVzc0xpc3RlbmVyKHByb2dyZXNzTGlzdGVuZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZmxvYXRpbmctcHJvbWlzZXNcclxuICAgICAgICAgICAgY29ubmVjdGlvblxyXG4gICAgICAgICAgICAgICAgLnNlbmQoc2VsZi51cmxfLCBzZWxmLm1ldGhvZF8sIHNlbGYuYm9keV8sIHNlbGYuaGVhZGVyc18pXHJcbiAgICAgICAgICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5wcm9ncmVzc0NhbGxiYWNrXyAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbm5lY3Rpb24ucmVtb3ZlVXBsb2FkUHJvZ3Jlc3NMaXN0ZW5lcihwcm9ncmVzc0xpc3RlbmVyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHNlbGYucGVuZGluZ0Nvbm5lY3Rpb25fID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGhpdFNlcnZlciA9IGNvbm5lY3Rpb24uZ2V0RXJyb3JDb2RlKCkgPT09IEVycm9yQ29kZS5OT19FUlJPUjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHN0YXR1cyA9IGNvbm5lY3Rpb24uZ2V0U3RhdHVzKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWhpdFNlcnZlciB8fCBzZWxmLmlzUmV0cnlTdGF0dXNDb2RlXyhzdGF0dXMpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgd2FzQ2FuY2VsZWQgPSBjb25uZWN0aW9uLmdldEVycm9yQ29kZSgpID09PSBFcnJvckNvZGUuQUJPUlQ7XHJcbiAgICAgICAgICAgICAgICAgICAgYmFja29mZkNhbGxiYWNrKGZhbHNlLCBuZXcgUmVxdWVzdEVuZFN0YXR1cyhmYWxzZSwgbnVsbCwgd2FzQ2FuY2VsZWQpKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzdWNjZXNzQ29kZSA9IHNlbGYuc3VjY2Vzc0NvZGVzXy5pbmRleE9mKHN0YXR1cykgIT09IC0xO1xyXG4gICAgICAgICAgICAgICAgYmFja29mZkNhbGxiYWNrKHRydWUsIG5ldyBSZXF1ZXN0RW5kU3RhdHVzKHN1Y2Nlc3NDb2RlLCBjb25uZWN0aW9uKSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAcGFyYW0gcmVxdWVzdFdlbnRUaHJvdWdoIC0gVHJ1ZSBpZiB0aGUgcmVxdWVzdCBldmVudHVhbGx5IHdlbnRcclxuICAgICAgICAgKiAgICAgdGhyb3VnaCwgZmFsc2UgaWYgaXQgaGl0IHRoZSByZXRyeSBsaW1pdCBvciB3YXMgY2FuY2VsZWQuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZnVuY3Rpb24gYmFja29mZkRvbmUocmVxdWVzdFdlbnRUaHJvdWdoLCBzdGF0dXMpIHtcclxuICAgICAgICAgICAgY29uc3QgcmVzb2x2ZSA9IHNlbGYucmVzb2x2ZV87XHJcbiAgICAgICAgICAgIGNvbnN0IHJlamVjdCA9IHNlbGYucmVqZWN0XztcclxuICAgICAgICAgICAgY29uc3QgY29ubmVjdGlvbiA9IHN0YXR1cy5jb25uZWN0aW9uO1xyXG4gICAgICAgICAgICBpZiAoc3RhdHVzLndhc1N1Y2Nlc3NDb2RlKSB7XHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHNlbGYuY2FsbGJhY2tfKGNvbm5lY3Rpb24sIGNvbm5lY3Rpb24uZ2V0UmVzcG9uc2VUZXh0KCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc0p1c3REZWYocmVzdWx0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZWplY3QoZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY29ubmVjdGlvbiAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGVyciA9IHVua25vd24oKTtcclxuICAgICAgICAgICAgICAgICAgICBlcnIuc2VydmVyUmVzcG9uc2UgPSBjb25uZWN0aW9uLmdldFJlc3BvbnNlVGV4dCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLmVycm9yQ2FsbGJhY2tfKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChzZWxmLmVycm9yQ2FsbGJhY2tfKGNvbm5lY3Rpb24sIGVycikpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXR1cy5jYW5jZWxlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlcnIgPSBzZWxmLmFwcERlbGV0ZV8gPyBhcHBEZWxldGVkKCkgOiBjYW5jZWxlZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVyciA9IHJldHJ5TGltaXRFeGNlZWRlZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuY2FuY2VsZWRfKSB7XHJcbiAgICAgICAgICAgIGJhY2tvZmZEb25lKGZhbHNlLCBuZXcgUmVxdWVzdEVuZFN0YXR1cyhmYWxzZSwgbnVsbCwgdHJ1ZSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5iYWNrb2ZmSWRfID0gc3RhcnQoZG9UaGVSZXF1ZXN0LCBiYWNrb2ZmRG9uZSwgdGhpcy50aW1lb3V0Xyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqIEBpbmhlcml0RG9jICovXHJcbiAgICBnZXRQcm9taXNlKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnByb21pc2VfO1xyXG4gICAgfVxyXG4gICAgLyoqIEBpbmhlcml0RG9jICovXHJcbiAgICBjYW5jZWwoYXBwRGVsZXRlKSB7XHJcbiAgICAgICAgdGhpcy5jYW5jZWxlZF8gPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuYXBwRGVsZXRlXyA9IGFwcERlbGV0ZSB8fCBmYWxzZTtcclxuICAgICAgICBpZiAodGhpcy5iYWNrb2ZmSWRfICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHN0b3AodGhpcy5iYWNrb2ZmSWRfKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMucGVuZGluZ0Nvbm5lY3Rpb25fICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGVuZGluZ0Nvbm5lY3Rpb25fLmFib3J0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgaXNSZXRyeVN0YXR1c0NvZGVfKHN0YXR1cykge1xyXG4gICAgICAgIC8vIFRoZSBjb2RlcyBmb3Igd2hpY2ggdG8gcmV0cnkgY2FtZSBmcm9tIHRoaXMgcGFnZTpcclxuICAgICAgICAvLyBodHRwczovL2Nsb3VkLmdvb2dsZS5jb20vc3RvcmFnZS9kb2NzL2V4cG9uZW50aWFsLWJhY2tvZmZcclxuICAgICAgICBjb25zdCBpc0ZpdmVIdW5kcmVkQ29kZSA9IHN0YXR1cyA+PSA1MDAgJiYgc3RhdHVzIDwgNjAwO1xyXG4gICAgICAgIGNvbnN0IGV4dHJhUmV0cnlDb2RlcyA9IFtcclxuICAgICAgICAgICAgLy8gUmVxdWVzdCBUaW1lb3V0OiB3ZWIgc2VydmVyIGRpZG4ndCByZWNlaXZlIGZ1bGwgcmVxdWVzdCBpbiB0aW1lLlxyXG4gICAgICAgICAgICA0MDgsXHJcbiAgICAgICAgICAgIC8vIFRvbyBNYW55IFJlcXVlc3RzOiB5b3UncmUgZ2V0dGluZyByYXRlLWxpbWl0ZWQsIGJhc2ljYWxseS5cclxuICAgICAgICAgICAgNDI5XHJcbiAgICAgICAgXTtcclxuICAgICAgICBjb25zdCBpc0V4dHJhUmV0cnlDb2RlID0gZXh0cmFSZXRyeUNvZGVzLmluZGV4T2Yoc3RhdHVzKSAhPT0gLTE7XHJcbiAgICAgICAgY29uc3QgaXNSZXF1ZXN0U3BlY2lmaWNSZXRyeUNvZGUgPSB0aGlzLmFkZGl0aW9uYWxSZXRyeUNvZGVzXy5pbmRleE9mKHN0YXR1cykgIT09IC0xO1xyXG4gICAgICAgIHJldHVybiBpc0ZpdmVIdW5kcmVkQ29kZSB8fCBpc0V4dHJhUmV0cnlDb2RlIHx8IGlzUmVxdWVzdFNwZWNpZmljUmV0cnlDb2RlO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBBIGNvbGxlY3Rpb24gb2YgaW5mb3JtYXRpb24gYWJvdXQgdGhlIHJlc3VsdCBvZiBhIG5ldHdvcmsgcmVxdWVzdC5cclxuICogQHBhcmFtIG9wdF9jYW5jZWxlZCAtIERlZmF1bHRzIHRvIGZhbHNlLlxyXG4gKi9cclxuY2xhc3MgUmVxdWVzdEVuZFN0YXR1cyB7XHJcbiAgICBjb25zdHJ1Y3Rvcih3YXNTdWNjZXNzQ29kZSwgY29ubmVjdGlvbiwgY2FuY2VsZWQpIHtcclxuICAgICAgICB0aGlzLndhc1N1Y2Nlc3NDb2RlID0gd2FzU3VjY2Vzc0NvZGU7XHJcbiAgICAgICAgdGhpcy5jb25uZWN0aW9uID0gY29ubmVjdGlvbjtcclxuICAgICAgICB0aGlzLmNhbmNlbGVkID0gISFjYW5jZWxlZDtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBhZGRBdXRoSGVhZGVyXyhoZWFkZXJzLCBhdXRoVG9rZW4pIHtcclxuICAgIGlmIChhdXRoVG9rZW4gIT09IG51bGwgJiYgYXV0aFRva2VuLmxlbmd0aCA+IDApIHtcclxuICAgICAgICBoZWFkZXJzWydBdXRob3JpemF0aW9uJ10gPSAnRmlyZWJhc2UgJyArIGF1dGhUb2tlbjtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBhZGRWZXJzaW9uSGVhZGVyXyhoZWFkZXJzLCBmaXJlYmFzZVZlcnNpb24pIHtcclxuICAgIGhlYWRlcnNbJ1gtRmlyZWJhc2UtU3RvcmFnZS1WZXJzaW9uJ10gPVxyXG4gICAgICAgICd3ZWJqcy8nICsgKGZpcmViYXNlVmVyc2lvbiAhPT0gbnVsbCAmJiBmaXJlYmFzZVZlcnNpb24gIT09IHZvaWQgMCA/IGZpcmViYXNlVmVyc2lvbiA6ICdBcHBNYW5hZ2VyJyk7XHJcbn1cclxuZnVuY3Rpb24gYWRkR21waWRIZWFkZXJfKGhlYWRlcnMsIGFwcElkKSB7XHJcbiAgICBpZiAoYXBwSWQpIHtcclxuICAgICAgICBoZWFkZXJzWydYLUZpcmViYXNlLUdNUElEJ10gPSBhcHBJZDtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBhZGRBcHBDaGVja0hlYWRlcl8oaGVhZGVycywgYXBwQ2hlY2tUb2tlbikge1xyXG4gICAgaWYgKGFwcENoZWNrVG9rZW4gIT09IG51bGwpIHtcclxuICAgICAgICBoZWFkZXJzWydYLUZpcmViYXNlLUFwcENoZWNrJ10gPSBhcHBDaGVja1Rva2VuO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIG1ha2VSZXF1ZXN0KHJlcXVlc3RJbmZvLCBhcHBJZCwgYXV0aFRva2VuLCBhcHBDaGVja1Rva2VuLCBwb29sLCBmaXJlYmFzZVZlcnNpb24pIHtcclxuICAgIGNvbnN0IHF1ZXJ5UGFydCA9IG1ha2VRdWVyeVN0cmluZyhyZXF1ZXN0SW5mby51cmxQYXJhbXMpO1xyXG4gICAgY29uc3QgdXJsID0gcmVxdWVzdEluZm8udXJsICsgcXVlcnlQYXJ0O1xyXG4gICAgY29uc3QgaGVhZGVycyA9IE9iamVjdC5hc3NpZ24oe30sIHJlcXVlc3RJbmZvLmhlYWRlcnMpO1xyXG4gICAgYWRkR21waWRIZWFkZXJfKGhlYWRlcnMsIGFwcElkKTtcclxuICAgIGFkZEF1dGhIZWFkZXJfKGhlYWRlcnMsIGF1dGhUb2tlbik7XHJcbiAgICBhZGRWZXJzaW9uSGVhZGVyXyhoZWFkZXJzLCBmaXJlYmFzZVZlcnNpb24pO1xyXG4gICAgYWRkQXBwQ2hlY2tIZWFkZXJfKGhlYWRlcnMsIGFwcENoZWNrVG9rZW4pO1xyXG4gICAgcmV0dXJuIG5ldyBOZXR3b3JrUmVxdWVzdCh1cmwsIHJlcXVlc3RJbmZvLm1ldGhvZCwgaGVhZGVycywgcmVxdWVzdEluZm8uYm9keSwgcmVxdWVzdEluZm8uc3VjY2Vzc0NvZGVzLCByZXF1ZXN0SW5mby5hZGRpdGlvbmFsUmV0cnlDb2RlcywgcmVxdWVzdEluZm8uaGFuZGxlciwgcmVxdWVzdEluZm8uZXJyb3JIYW5kbGVyLCByZXF1ZXN0SW5mby50aW1lb3V0LCByZXF1ZXN0SW5mby5wcm9ncmVzc0NhbGxiYWNrLCBwb29sKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5mdW5jdGlvbiBnZXRCbG9iQnVpbGRlcigpIHtcclxuICAgIGlmICh0eXBlb2YgQmxvYkJ1aWxkZXIgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgcmV0dXJuIEJsb2JCdWlsZGVyO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAodHlwZW9mIFdlYktpdEJsb2JCdWlsZGVyICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgIHJldHVybiBXZWJLaXRCbG9iQnVpbGRlcjtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIENvbmNhdGVuYXRlcyBvbmUgb3IgbW9yZSB2YWx1ZXMgdG9nZXRoZXIgYW5kIGNvbnZlcnRzIHRoZW0gdG8gYSBCbG9iLlxyXG4gKlxyXG4gKiBAcGFyYW0gYXJncyBUaGUgdmFsdWVzIHRoYXQgd2lsbCBtYWtlIHVwIHRoZSByZXN1bHRpbmcgYmxvYi5cclxuICogQHJldHVybiBUaGUgYmxvYi5cclxuICovXHJcbmZ1bmN0aW9uIGdldEJsb2IoLi4uYXJncykge1xyXG4gICAgY29uc3QgQmxvYkJ1aWxkZXIgPSBnZXRCbG9iQnVpbGRlcigpO1xyXG4gICAgaWYgKEJsb2JCdWlsZGVyICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICBjb25zdCBiYiA9IG5ldyBCbG9iQnVpbGRlcigpO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJncy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBiYi5hcHBlbmQoYXJnc1tpXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBiYi5nZXRCbG9iKCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBpZiAoaXNOYXRpdmVCbG9iRGVmaW5lZCgpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgQmxvYihhcmdzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBTdG9yYWdlRXJyb3IoXCJ1bnN1cHBvcnRlZC1lbnZpcm9ubWVudFwiIC8qIFVOU1VQUE9SVEVEX0VOVklST05NRU5UICovLCBcIlRoaXMgYnJvd3NlciBkb2Vzbid0IHNlZW0gdG8gc3VwcG9ydCBjcmVhdGluZyBCbG9ic1wiKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIFNsaWNlcyB0aGUgYmxvYi4gVGhlIHJldHVybmVkIGJsb2IgY29udGFpbnMgZGF0YSBmcm9tIHRoZSBzdGFydCBieXRlXHJcbiAqIChpbmNsdXNpdmUpIHRpbGwgdGhlIGVuZCBieXRlIChleGNsdXNpdmUpLiBOZWdhdGl2ZSBpbmRpY2VzIGNhbm5vdCBiZSB1c2VkLlxyXG4gKlxyXG4gKiBAcGFyYW0gYmxvYiBUaGUgYmxvYiB0byBiZSBzbGljZWQuXHJcbiAqIEBwYXJhbSBzdGFydCBJbmRleCBvZiB0aGUgc3RhcnRpbmcgYnl0ZS5cclxuICogQHBhcmFtIGVuZCBJbmRleCBvZiB0aGUgZW5kaW5nIGJ5dGUuXHJcbiAqIEByZXR1cm4gVGhlIGJsb2Igc2xpY2Ugb3IgbnVsbCBpZiBub3Qgc3VwcG9ydGVkLlxyXG4gKi9cclxuZnVuY3Rpb24gc2xpY2VCbG9iKGJsb2IsIHN0YXJ0LCBlbmQpIHtcclxuICAgIGlmIChibG9iLndlYmtpdFNsaWNlKSB7XHJcbiAgICAgICAgcmV0dXJuIGJsb2Iud2Via2l0U2xpY2Uoc3RhcnQsIGVuZCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChibG9iLm1velNsaWNlKSB7XHJcbiAgICAgICAgcmV0dXJuIGJsb2IubW96U2xpY2Uoc3RhcnQsIGVuZCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChibG9iLnNsaWNlKSB7XHJcbiAgICAgICAgcmV0dXJuIGJsb2Iuc2xpY2Uoc3RhcnQsIGVuZCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbnVsbDtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjEgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKiogQ29udmVydHMgYSBCYXNlNjQgZW5jb2RlZCBzdHJpbmcgdG8gYSBiaW5hcnkgc3RyaW5nLiAqL1xyXG5mdW5jdGlvbiBkZWNvZGVCYXNlNjQoZW5jb2RlZCkge1xyXG4gICAgcmV0dXJuIGF0b2IoZW5jb2RlZCk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEFuIGVudW1lcmF0aW9uIG9mIHRoZSBwb3NzaWJsZSBzdHJpbmcgZm9ybWF0cyBmb3IgdXBsb2FkLlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5jb25zdCBTdHJpbmdGb3JtYXQgPSB7XHJcbiAgICAvKipcclxuICAgICAqIEluZGljYXRlcyB0aGUgc3RyaW5nIHNob3VsZCBiZSBpbnRlcnByZXRlZCBcInJhd1wiLCB0aGF0IGlzLCBhcyBub3JtYWwgdGV4dC5cclxuICAgICAqIFRoZSBzdHJpbmcgd2lsbCBiZSBpbnRlcnByZXRlZCBhcyBVVEYtMTYsIHRoZW4gdXBsb2FkZWQgYXMgYSBVVEYtOCBieXRlXHJcbiAgICAgKiBzZXF1ZW5jZS5cclxuICAgICAqIEV4YW1wbGU6IFRoZSBzdHJpbmcgJ0hlbGxvISBcXFxcdWQ4M2RcXFxcdWRlMGEnIGJlY29tZXMgdGhlIGJ5dGUgc2VxdWVuY2VcclxuICAgICAqIDQ4IDY1IDZjIDZjIDZmIDIxIDIwIGYwIDlmIDk4IDhhXHJcbiAgICAgKi9cclxuICAgIFJBVzogJ3JhdycsXHJcbiAgICAvKipcclxuICAgICAqIEluZGljYXRlcyB0aGUgc3RyaW5nIHNob3VsZCBiZSBpbnRlcnByZXRlZCBhcyBiYXNlNjQtZW5jb2RlZCBkYXRhLlxyXG4gICAgICogUGFkZGluZyBjaGFyYWN0ZXJzICh0cmFpbGluZyAnPSdzKSBhcmUgb3B0aW9uYWwuXHJcbiAgICAgKiBFeGFtcGxlOiBUaGUgc3RyaW5nICdyV21PKytFNnQ3L3Jsdz09JyBiZWNvbWVzIHRoZSBieXRlIHNlcXVlbmNlXHJcbiAgICAgKiBhZCA2OSA4ZSBmYiBlMSAzYSBiNyBiZiBlYiA5N1xyXG4gICAgICovXHJcbiAgICBCQVNFNjQ6ICdiYXNlNjQnLFxyXG4gICAgLyoqXHJcbiAgICAgKiBJbmRpY2F0ZXMgdGhlIHN0cmluZyBzaG91bGQgYmUgaW50ZXJwcmV0ZWQgYXMgYmFzZTY0dXJsLWVuY29kZWQgZGF0YS5cclxuICAgICAqIFBhZGRpbmcgY2hhcmFjdGVycyAodHJhaWxpbmcgJz0ncykgYXJlIG9wdGlvbmFsLlxyXG4gICAgICogRXhhbXBsZTogVGhlIHN0cmluZyAncldtTy0tRTZ0N19ybHc9PScgYmVjb21lcyB0aGUgYnl0ZSBzZXF1ZW5jZVxyXG4gICAgICogYWQgNjkgOGUgZmIgZTEgM2EgYjcgYmYgZWIgOTdcclxuICAgICAqL1xyXG4gICAgQkFTRTY0VVJMOiAnYmFzZTY0dXJsJyxcclxuICAgIC8qKlxyXG4gICAgICogSW5kaWNhdGVzIHRoZSBzdHJpbmcgaXMgYSBkYXRhIFVSTCwgc3VjaCBhcyBvbmUgb2J0YWluZWQgZnJvbVxyXG4gICAgICogY2FudmFzLnRvRGF0YVVSTCgpLlxyXG4gICAgICogRXhhbXBsZTogdGhlIHN0cmluZyAnZGF0YTphcHBsaWNhdGlvbi9vY3RldC1zdHJlYW07YmFzZTY0LGFhYWEnXHJcbiAgICAgKiBiZWNvbWVzIHRoZSBieXRlIHNlcXVlbmNlXHJcbiAgICAgKiA2OSBhNiA5YVxyXG4gICAgICogKHRoZSBjb250ZW50LXR5cGUgXCJhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW1cIiBpcyBhbHNvIGFwcGxpZWQsIGJ1dCBjYW5cclxuICAgICAqIGJlIG92ZXJyaWRkZW4gaW4gdGhlIG1ldGFkYXRhIG9iamVjdCkuXHJcbiAgICAgKi9cclxuICAgIERBVEFfVVJMOiAnZGF0YV91cmwnXHJcbn07XHJcbmNsYXNzIFN0cmluZ0RhdGEge1xyXG4gICAgY29uc3RydWN0b3IoZGF0YSwgY29udGVudFR5cGUpIHtcclxuICAgICAgICB0aGlzLmRhdGEgPSBkYXRhO1xyXG4gICAgICAgIHRoaXMuY29udGVudFR5cGUgPSBjb250ZW50VHlwZSB8fCBudWxsO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBAaW50ZXJuYWxcclxuICovXHJcbmZ1bmN0aW9uIGRhdGFGcm9tU3RyaW5nKGZvcm1hdCwgc3RyaW5nRGF0YSkge1xyXG4gICAgc3dpdGNoIChmb3JtYXQpIHtcclxuICAgICAgICBjYXNlIFN0cmluZ0Zvcm1hdC5SQVc6XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgU3RyaW5nRGF0YSh1dGY4Qnl0ZXNfKHN0cmluZ0RhdGEpKTtcclxuICAgICAgICBjYXNlIFN0cmluZ0Zvcm1hdC5CQVNFNjQ6XHJcbiAgICAgICAgY2FzZSBTdHJpbmdGb3JtYXQuQkFTRTY0VVJMOlxyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFN0cmluZ0RhdGEoYmFzZTY0Qnl0ZXNfKGZvcm1hdCwgc3RyaW5nRGF0YSkpO1xyXG4gICAgICAgIGNhc2UgU3RyaW5nRm9ybWF0LkRBVEFfVVJMOlxyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFN0cmluZ0RhdGEoZGF0YVVSTEJ5dGVzXyhzdHJpbmdEYXRhKSwgZGF0YVVSTENvbnRlbnRUeXBlXyhzdHJpbmdEYXRhKSk7XHJcbiAgICAgICAgLy8gZG8gbm90aGluZ1xyXG4gICAgfVxyXG4gICAgLy8gYXNzZXJ0KGZhbHNlKTtcclxuICAgIHRocm93IHVua25vd24oKTtcclxufVxyXG5mdW5jdGlvbiB1dGY4Qnl0ZXNfKHZhbHVlKSB7XHJcbiAgICBjb25zdCBiID0gW107XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHZhbHVlLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgbGV0IGMgPSB2YWx1ZS5jaGFyQ29kZUF0KGkpO1xyXG4gICAgICAgIGlmIChjIDw9IDEyNykge1xyXG4gICAgICAgICAgICBiLnB1c2goYyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAoYyA8PSAyMDQ3KSB7XHJcbiAgICAgICAgICAgICAgICBiLnB1c2goMTkyIHwgKGMgPj4gNiksIDEyOCB8IChjICYgNjMpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmICgoYyAmIDY0NTEyKSA9PT0gNTUyOTYpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBUaGUgc3RhcnQgb2YgYSBzdXJyb2dhdGUgcGFpci5cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWxpZCA9IGkgPCB2YWx1ZS5sZW5ndGggLSAxICYmICh2YWx1ZS5jaGFyQ29kZUF0KGkgKyAxKSAmIDY0NTEyKSA9PT0gNTYzMjA7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF2YWxpZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGUgc2Vjb25kIHN1cnJvZ2F0ZSB3YXNuJ3QgdGhlcmUuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGIucHVzaCgyMzksIDE5MSwgMTg5KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGhpID0gYztcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbG8gPSB2YWx1ZS5jaGFyQ29kZUF0KCsraSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSA2NTUzNiB8ICgoaGkgJiAxMDIzKSA8PCAxMCkgfCAobG8gJiAxMDIzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYi5wdXNoKDI0MCB8IChjID4+IDE4KSwgMTI4IHwgKChjID4+IDEyKSAmIDYzKSwgMTI4IHwgKChjID4+IDYpICYgNjMpLCAxMjggfCAoYyAmIDYzKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKChjICYgNjQ1MTIpID09PSA1NjMyMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJbnZhbGlkIGxvdyBzdXJyb2dhdGUuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGIucHVzaCgyMzksIDE5MSwgMTg5KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGIucHVzaCgyMjQgfCAoYyA+PiAxMiksIDEyOCB8ICgoYyA+PiA2KSAmIDYzKSwgMTI4IHwgKGMgJiA2MykpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBuZXcgVWludDhBcnJheShiKTtcclxufVxyXG5mdW5jdGlvbiBwZXJjZW50RW5jb2RlZEJ5dGVzXyh2YWx1ZSkge1xyXG4gICAgbGV0IGRlY29kZWQ7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGRlY29kZWQgPSBkZWNvZGVVUklDb21wb25lbnQodmFsdWUpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICB0aHJvdyBpbnZhbGlkRm9ybWF0KFN0cmluZ0Zvcm1hdC5EQVRBX1VSTCwgJ01hbGZvcm1lZCBkYXRhIFVSTC4nKTtcclxuICAgIH1cclxuICAgIHJldHVybiB1dGY4Qnl0ZXNfKGRlY29kZWQpO1xyXG59XHJcbmZ1bmN0aW9uIGJhc2U2NEJ5dGVzXyhmb3JtYXQsIHZhbHVlKSB7XHJcbiAgICBzd2l0Y2ggKGZvcm1hdCkge1xyXG4gICAgICAgIGNhc2UgU3RyaW5nRm9ybWF0LkJBU0U2NDoge1xyXG4gICAgICAgICAgICBjb25zdCBoYXNNaW51cyA9IHZhbHVlLmluZGV4T2YoJy0nKSAhPT0gLTE7XHJcbiAgICAgICAgICAgIGNvbnN0IGhhc1VuZGVyID0gdmFsdWUuaW5kZXhPZignXycpICE9PSAtMTtcclxuICAgICAgICAgICAgaWYgKGhhc01pbnVzIHx8IGhhc1VuZGVyKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpbnZhbGlkQ2hhciA9IGhhc01pbnVzID8gJy0nIDogJ18nO1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgaW52YWxpZEZvcm1hdChmb3JtYXQsIFwiSW52YWxpZCBjaGFyYWN0ZXIgJ1wiICtcclxuICAgICAgICAgICAgICAgICAgICBpbnZhbGlkQ2hhciArXHJcbiAgICAgICAgICAgICAgICAgICAgXCInIGZvdW5kOiBpcyBpdCBiYXNlNjR1cmwgZW5jb2RlZD9cIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhc2UgU3RyaW5nRm9ybWF0LkJBU0U2NFVSTDoge1xyXG4gICAgICAgICAgICBjb25zdCBoYXNQbHVzID0gdmFsdWUuaW5kZXhPZignKycpICE9PSAtMTtcclxuICAgICAgICAgICAgY29uc3QgaGFzU2xhc2ggPSB2YWx1ZS5pbmRleE9mKCcvJykgIT09IC0xO1xyXG4gICAgICAgICAgICBpZiAoaGFzUGx1cyB8fCBoYXNTbGFzaCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaW52YWxpZENoYXIgPSBoYXNQbHVzID8gJysnIDogJy8nO1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgaW52YWxpZEZvcm1hdChmb3JtYXQsIFwiSW52YWxpZCBjaGFyYWN0ZXIgJ1wiICsgaW52YWxpZENoYXIgKyBcIicgZm91bmQ6IGlzIGl0IGJhc2U2NCBlbmNvZGVkP1wiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UoLy0vZywgJysnKS5yZXBsYWNlKC9fL2csICcvJyk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBkbyBub3RoaW5nXHJcbiAgICB9XHJcbiAgICBsZXQgYnl0ZXM7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGJ5dGVzID0gZGVjb2RlQmFzZTY0KHZhbHVlKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgdGhyb3cgaW52YWxpZEZvcm1hdChmb3JtYXQsICdJbnZhbGlkIGNoYXJhY3RlciBmb3VuZCcpO1xyXG4gICAgfVxyXG4gICAgY29uc3QgYXJyYXkgPSBuZXcgVWludDhBcnJheShieXRlcy5sZW5ndGgpO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBieXRlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGFycmF5W2ldID0gYnl0ZXMuY2hhckNvZGVBdChpKTtcclxuICAgIH1cclxuICAgIHJldHVybiBhcnJheTtcclxufVxyXG5jbGFzcyBEYXRhVVJMUGFydHMge1xyXG4gICAgY29uc3RydWN0b3IoZGF0YVVSTCkge1xyXG4gICAgICAgIHRoaXMuYmFzZTY0ID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5jb250ZW50VHlwZSA9IG51bGw7XHJcbiAgICAgICAgY29uc3QgbWF0Y2hlcyA9IGRhdGFVUkwubWF0Y2goL15kYXRhOihbXixdKyk/LC8pO1xyXG4gICAgICAgIGlmIChtYXRjaGVzID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRocm93IGludmFsaWRGb3JtYXQoU3RyaW5nRm9ybWF0LkRBVEFfVVJMLCBcIk11c3QgYmUgZm9ybWF0dGVkICdkYXRhOls8bWVkaWF0eXBlPl1bO2Jhc2U2NF0sPGRhdGE+XCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBtaWRkbGUgPSBtYXRjaGVzWzFdIHx8IG51bGw7XHJcbiAgICAgICAgaWYgKG1pZGRsZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYmFzZTY0ID0gZW5kc1dpdGgobWlkZGxlLCAnO2Jhc2U2NCcpO1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRlbnRUeXBlID0gdGhpcy5iYXNlNjRcclxuICAgICAgICAgICAgICAgID8gbWlkZGxlLnN1YnN0cmluZygwLCBtaWRkbGUubGVuZ3RoIC0gJztiYXNlNjQnLmxlbmd0aClcclxuICAgICAgICAgICAgICAgIDogbWlkZGxlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnJlc3QgPSBkYXRhVVJMLnN1YnN0cmluZyhkYXRhVVJMLmluZGV4T2YoJywnKSArIDEpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGRhdGFVUkxCeXRlc18oZGF0YVVybCkge1xyXG4gICAgY29uc3QgcGFydHMgPSBuZXcgRGF0YVVSTFBhcnRzKGRhdGFVcmwpO1xyXG4gICAgaWYgKHBhcnRzLmJhc2U2NCkge1xyXG4gICAgICAgIHJldHVybiBiYXNlNjRCeXRlc18oU3RyaW5nRm9ybWF0LkJBU0U2NCwgcGFydHMucmVzdCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gcGVyY2VudEVuY29kZWRCeXRlc18ocGFydHMucmVzdCk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gZGF0YVVSTENvbnRlbnRUeXBlXyhkYXRhVXJsKSB7XHJcbiAgICBjb25zdCBwYXJ0cyA9IG5ldyBEYXRhVVJMUGFydHMoZGF0YVVybCk7XHJcbiAgICByZXR1cm4gcGFydHMuY29udGVudFR5cGU7XHJcbn1cclxuZnVuY3Rpb24gZW5kc1dpdGgocywgZW5kKSB7XHJcbiAgICBjb25zdCBsb25nRW5vdWdoID0gcy5sZW5ndGggPj0gZW5kLmxlbmd0aDtcclxuICAgIGlmICghbG9uZ0Vub3VnaCkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIHJldHVybiBzLnN1YnN0cmluZyhzLmxlbmd0aCAtIGVuZC5sZW5ndGgpID09PSBlbmQ7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEBwYXJhbSBvcHRfZWxpZGVDb3B5IC0gSWYgdHJ1ZSwgZG9lc24ndCBjb3B5IG11dGFibGUgaW5wdXQgZGF0YVxyXG4gKiAgICAgKGUuZy4gVWludDhBcnJheXMpLiBQYXNzIHRydWUgb25seSBpZiB5b3Uga25vdyB0aGUgb2JqZWN0cyB3aWxsIG5vdCBiZVxyXG4gKiAgICAgbW9kaWZpZWQgYWZ0ZXIgdGhpcyBibG9iJ3MgY29uc3RydWN0aW9uLlxyXG4gKlxyXG4gKiBAaW50ZXJuYWxcclxuICovXHJcbmNsYXNzIEZic0Jsb2Ige1xyXG4gICAgY29uc3RydWN0b3IoZGF0YSwgZWxpZGVDb3B5KSB7XHJcbiAgICAgICAgbGV0IHNpemUgPSAwO1xyXG4gICAgICAgIGxldCBibG9iVHlwZSA9ICcnO1xyXG4gICAgICAgIGlmIChpc05hdGl2ZUJsb2IoZGF0YSkpIHtcclxuICAgICAgICAgICAgdGhpcy5kYXRhXyA9IGRhdGE7XHJcbiAgICAgICAgICAgIHNpemUgPSBkYXRhLnNpemU7XHJcbiAgICAgICAgICAgIGJsb2JUeXBlID0gZGF0YS50eXBlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChkYXRhIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHtcclxuICAgICAgICAgICAgaWYgKGVsaWRlQ29weSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhXyA9IG5ldyBVaW50OEFycmF5KGRhdGEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhXyA9IG5ldyBVaW50OEFycmF5KGRhdGEuYnl0ZUxlbmd0aCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGFfLnNldChuZXcgVWludDhBcnJheShkYXRhKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2l6ZSA9IHRoaXMuZGF0YV8ubGVuZ3RoO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChkYXRhIGluc3RhbmNlb2YgVWludDhBcnJheSkge1xyXG4gICAgICAgICAgICBpZiAoZWxpZGVDb3B5KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGFfID0gZGF0YTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGF0YV8gPSBuZXcgVWludDhBcnJheShkYXRhLmxlbmd0aCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGFfLnNldChkYXRhKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzaXplID0gZGF0YS5sZW5ndGg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2l6ZV8gPSBzaXplO1xyXG4gICAgICAgIHRoaXMudHlwZV8gPSBibG9iVHlwZTtcclxuICAgIH1cclxuICAgIHNpemUoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2l6ZV87XHJcbiAgICB9XHJcbiAgICB0eXBlKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnR5cGVfO1xyXG4gICAgfVxyXG4gICAgc2xpY2Uoc3RhcnRCeXRlLCBlbmRCeXRlKSB7XHJcbiAgICAgICAgaWYgKGlzTmF0aXZlQmxvYih0aGlzLmRhdGFfKSkge1xyXG4gICAgICAgICAgICBjb25zdCByZWFsQmxvYiA9IHRoaXMuZGF0YV87XHJcbiAgICAgICAgICAgIGNvbnN0IHNsaWNlZCA9IHNsaWNlQmxvYihyZWFsQmxvYiwgc3RhcnRCeXRlLCBlbmRCeXRlKTtcclxuICAgICAgICAgICAgaWYgKHNsaWNlZCA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBGYnNCbG9iKHNsaWNlZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCBzbGljZSA9IG5ldyBVaW50OEFycmF5KHRoaXMuZGF0YV8uYnVmZmVyLCBzdGFydEJ5dGUsIGVuZEJ5dGUgLSBzdGFydEJ5dGUpO1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IEZic0Jsb2Ioc2xpY2UsIHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHN0YXRpYyBnZXRCbG9iKC4uLmFyZ3MpIHtcclxuICAgICAgICBpZiAoaXNOYXRpdmVCbG9iRGVmaW5lZCgpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGJsb2JieSA9IGFyZ3MubWFwKCh2YWwpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICh2YWwgaW5zdGFuY2VvZiBGYnNCbG9iKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhbC5kYXRhXztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB2YWw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IEZic0Jsb2IoZ2V0QmxvYi5hcHBseShudWxsLCBibG9iYnkpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVpbnQ4QXJyYXlzID0gYXJncy5tYXAoKHZhbCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGlzU3RyaW5nKHZhbCkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YUZyb21TdHJpbmcoU3RyaW5nRm9ybWF0LlJBVywgdmFsKS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gQmxvYnMgZG9uJ3QgZXhpc3QsIHNvIHRoaXMgaGFzIHRvIGJlIGEgVWludDhBcnJheS5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmFsLmRhdGFfO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgbGV0IGZpbmFsTGVuZ3RoID0gMDtcclxuICAgICAgICAgICAgdWludDhBcnJheXMuZm9yRWFjaCgoYXJyYXkpID0+IHtcclxuICAgICAgICAgICAgICAgIGZpbmFsTGVuZ3RoICs9IGFycmF5LmJ5dGVMZW5ndGg7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBtZXJnZWQgPSBuZXcgVWludDhBcnJheShmaW5hbExlbmd0aCk7XHJcbiAgICAgICAgICAgIGxldCBpbmRleCA9IDA7XHJcbiAgICAgICAgICAgIHVpbnQ4QXJyYXlzLmZvckVhY2goKGFycmF5KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWVyZ2VkW2luZGV4KytdID0gYXJyYXlbaV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IEZic0Jsb2IobWVyZ2VkLCB0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICB1cGxvYWREYXRhKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRhdGFfO1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBSZXR1cm5zIHRoZSBPYmplY3QgcmVzdWx0aW5nIGZyb20gcGFyc2luZyB0aGUgZ2l2ZW4gSlNPTiwgb3IgbnVsbCBpZiB0aGVcclxuICogZ2l2ZW4gc3RyaW5nIGRvZXMgbm90IHJlcHJlc2VudCBhIEpTT04gb2JqZWN0LlxyXG4gKi9cclxuZnVuY3Rpb24ganNvbk9iamVjdE9yTnVsbChzKSB7XHJcbiAgICBsZXQgb2JqO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBvYmogPSBKU09OLnBhcnNlKHMpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIGlmIChpc05vbkFycmF5T2JqZWN0KG9iaikpIHtcclxuICAgICAgICByZXR1cm4gb2JqO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEBmaWxlb3ZlcnZpZXcgQ29udGFpbnMgaGVscGVyIG1ldGhvZHMgZm9yIG1hbmlwdWxhdGluZyBwYXRocy5cclxuICovXHJcbi8qKlxyXG4gKiBAcmV0dXJuIE51bGwgaWYgdGhlIHBhdGggaXMgYWxyZWFkeSBhdCB0aGUgcm9vdC5cclxuICovXHJcbmZ1bmN0aW9uIHBhcmVudChwYXRoKSB7XHJcbiAgICBpZiAocGF0aC5sZW5ndGggPT09IDApIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIGNvbnN0IGluZGV4ID0gcGF0aC5sYXN0SW5kZXhPZignLycpO1xyXG4gICAgaWYgKGluZGV4ID09PSAtMSkge1xyXG4gICAgICAgIHJldHVybiAnJztcclxuICAgIH1cclxuICAgIGNvbnN0IG5ld1BhdGggPSBwYXRoLnNsaWNlKDAsIGluZGV4KTtcclxuICAgIHJldHVybiBuZXdQYXRoO1xyXG59XHJcbmZ1bmN0aW9uIGNoaWxkKHBhdGgsIGNoaWxkUGF0aCkge1xyXG4gICAgY29uc3QgY2Fub25pY2FsQ2hpbGRQYXRoID0gY2hpbGRQYXRoXHJcbiAgICAgICAgLnNwbGl0KCcvJylcclxuICAgICAgICAuZmlsdGVyKGNvbXBvbmVudCA9PiBjb21wb25lbnQubGVuZ3RoID4gMClcclxuICAgICAgICAuam9pbignLycpO1xyXG4gICAgaWYgKHBhdGgubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgcmV0dXJuIGNhbm9uaWNhbENoaWxkUGF0aDtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBwYXRoICsgJy8nICsgY2Fub25pY2FsQ2hpbGRQYXRoO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBSZXR1cm5zIHRoZSBsYXN0IGNvbXBvbmVudCBvZiBhIHBhdGguXHJcbiAqICcvZm9vL2JhcicgLT4gJ2JhcidcclxuICogJy9mb28vYmFyL2Jhei8nIC0+ICdiYXovJ1xyXG4gKiAnL2EnIC0+ICdhJ1xyXG4gKi9cclxuZnVuY3Rpb24gbGFzdENvbXBvbmVudChwYXRoKSB7XHJcbiAgICBjb25zdCBpbmRleCA9IHBhdGgubGFzdEluZGV4T2YoJy8nLCBwYXRoLmxlbmd0aCAtIDIpO1xyXG4gICAgaWYgKGluZGV4ID09PSAtMSkge1xyXG4gICAgICAgIHJldHVybiBwYXRoO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIHBhdGguc2xpY2UoaW5kZXggKyAxKTtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5mdW5jdGlvbiBub1hmb3JtXyhtZXRhZGF0YSwgdmFsdWUpIHtcclxuICAgIHJldHVybiB2YWx1ZTtcclxufVxyXG5jbGFzcyBNYXBwaW5nIHtcclxuICAgIGNvbnN0cnVjdG9yKHNlcnZlciwgbG9jYWwsIHdyaXRhYmxlLCB4Zm9ybSkge1xyXG4gICAgICAgIHRoaXMuc2VydmVyID0gc2VydmVyO1xyXG4gICAgICAgIHRoaXMubG9jYWwgPSBsb2NhbCB8fCBzZXJ2ZXI7XHJcbiAgICAgICAgdGhpcy53cml0YWJsZSA9ICEhd3JpdGFibGU7XHJcbiAgICAgICAgdGhpcy54Zm9ybSA9IHhmb3JtIHx8IG5vWGZvcm1fO1xyXG4gICAgfVxyXG59XHJcbmxldCBtYXBwaW5nc18gPSBudWxsO1xyXG5mdW5jdGlvbiB4Zm9ybVBhdGgoZnVsbFBhdGgpIHtcclxuICAgIGlmICghaXNTdHJpbmcoZnVsbFBhdGgpIHx8IGZ1bGxQYXRoLmxlbmd0aCA8IDIpIHtcclxuICAgICAgICByZXR1cm4gZnVsbFBhdGg7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gbGFzdENvbXBvbmVudChmdWxsUGF0aCk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gZ2V0TWFwcGluZ3MoKSB7XHJcbiAgICBpZiAobWFwcGluZ3NfKSB7XHJcbiAgICAgICAgcmV0dXJuIG1hcHBpbmdzXztcclxuICAgIH1cclxuICAgIGNvbnN0IG1hcHBpbmdzID0gW107XHJcbiAgICBtYXBwaW5ncy5wdXNoKG5ldyBNYXBwaW5nKCdidWNrZXQnKSk7XHJcbiAgICBtYXBwaW5ncy5wdXNoKG5ldyBNYXBwaW5nKCdnZW5lcmF0aW9uJykpO1xyXG4gICAgbWFwcGluZ3MucHVzaChuZXcgTWFwcGluZygnbWV0YWdlbmVyYXRpb24nKSk7XHJcbiAgICBtYXBwaW5ncy5wdXNoKG5ldyBNYXBwaW5nKCduYW1lJywgJ2Z1bGxQYXRoJywgdHJ1ZSkpO1xyXG4gICAgZnVuY3Rpb24gbWFwcGluZ3NYZm9ybVBhdGgoX21ldGFkYXRhLCBmdWxsUGF0aCkge1xyXG4gICAgICAgIHJldHVybiB4Zm9ybVBhdGgoZnVsbFBhdGgpO1xyXG4gICAgfVxyXG4gICAgY29uc3QgbmFtZU1hcHBpbmcgPSBuZXcgTWFwcGluZygnbmFtZScpO1xyXG4gICAgbmFtZU1hcHBpbmcueGZvcm0gPSBtYXBwaW5nc1hmb3JtUGF0aDtcclxuICAgIG1hcHBpbmdzLnB1c2gobmFtZU1hcHBpbmcpO1xyXG4gICAgLyoqXHJcbiAgICAgKiBDb2VyY2VzIHRoZSBzZWNvbmQgcGFyYW0gdG8gYSBudW1iZXIsIGlmIGl0IGlzIGRlZmluZWQuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIHhmb3JtU2l6ZShfbWV0YWRhdGEsIHNpemUpIHtcclxuICAgICAgICBpZiAoc2l6ZSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBOdW1iZXIoc2l6ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gc2l6ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBjb25zdCBzaXplTWFwcGluZyA9IG5ldyBNYXBwaW5nKCdzaXplJyk7XHJcbiAgICBzaXplTWFwcGluZy54Zm9ybSA9IHhmb3JtU2l6ZTtcclxuICAgIG1hcHBpbmdzLnB1c2goc2l6ZU1hcHBpbmcpO1xyXG4gICAgbWFwcGluZ3MucHVzaChuZXcgTWFwcGluZygndGltZUNyZWF0ZWQnKSk7XHJcbiAgICBtYXBwaW5ncy5wdXNoKG5ldyBNYXBwaW5nKCd1cGRhdGVkJykpO1xyXG4gICAgbWFwcGluZ3MucHVzaChuZXcgTWFwcGluZygnbWQ1SGFzaCcsIG51bGwsIHRydWUpKTtcclxuICAgIG1hcHBpbmdzLnB1c2gobmV3IE1hcHBpbmcoJ2NhY2hlQ29udHJvbCcsIG51bGwsIHRydWUpKTtcclxuICAgIG1hcHBpbmdzLnB1c2gobmV3IE1hcHBpbmcoJ2NvbnRlbnREaXNwb3NpdGlvbicsIG51bGwsIHRydWUpKTtcclxuICAgIG1hcHBpbmdzLnB1c2gobmV3IE1hcHBpbmcoJ2NvbnRlbnRFbmNvZGluZycsIG51bGwsIHRydWUpKTtcclxuICAgIG1hcHBpbmdzLnB1c2gobmV3IE1hcHBpbmcoJ2NvbnRlbnRMYW5ndWFnZScsIG51bGwsIHRydWUpKTtcclxuICAgIG1hcHBpbmdzLnB1c2gobmV3IE1hcHBpbmcoJ2NvbnRlbnRUeXBlJywgbnVsbCwgdHJ1ZSkpO1xyXG4gICAgbWFwcGluZ3MucHVzaChuZXcgTWFwcGluZygnbWV0YWRhdGEnLCAnY3VzdG9tTWV0YWRhdGEnLCB0cnVlKSk7XHJcbiAgICBtYXBwaW5nc18gPSBtYXBwaW5ncztcclxuICAgIHJldHVybiBtYXBwaW5nc187XHJcbn1cclxuZnVuY3Rpb24gYWRkUmVmKG1ldGFkYXRhLCBzZXJ2aWNlKSB7XHJcbiAgICBmdW5jdGlvbiBnZW5lcmF0ZVJlZigpIHtcclxuICAgICAgICBjb25zdCBidWNrZXQgPSBtZXRhZGF0YVsnYnVja2V0J107XHJcbiAgICAgICAgY29uc3QgcGF0aCA9IG1ldGFkYXRhWydmdWxsUGF0aCddO1xyXG4gICAgICAgIGNvbnN0IGxvYyA9IG5ldyBMb2NhdGlvbihidWNrZXQsIHBhdGgpO1xyXG4gICAgICAgIHJldHVybiBzZXJ2aWNlLl9tYWtlU3RvcmFnZVJlZmVyZW5jZShsb2MpO1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG1ldGFkYXRhLCAncmVmJywgeyBnZXQ6IGdlbmVyYXRlUmVmIH0pO1xyXG59XHJcbmZ1bmN0aW9uIGZyb21SZXNvdXJjZShzZXJ2aWNlLCByZXNvdXJjZSwgbWFwcGluZ3MpIHtcclxuICAgIGNvbnN0IG1ldGFkYXRhID0ge307XHJcbiAgICBtZXRhZGF0YVsndHlwZSddID0gJ2ZpbGUnO1xyXG4gICAgY29uc3QgbGVuID0gbWFwcGluZ3MubGVuZ3RoO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgIGNvbnN0IG1hcHBpbmcgPSBtYXBwaW5nc1tpXTtcclxuICAgICAgICBtZXRhZGF0YVttYXBwaW5nLmxvY2FsXSA9IG1hcHBpbmcueGZvcm0obWV0YWRhdGEsIHJlc291cmNlW21hcHBpbmcuc2VydmVyXSk7XHJcbiAgICB9XHJcbiAgICBhZGRSZWYobWV0YWRhdGEsIHNlcnZpY2UpO1xyXG4gICAgcmV0dXJuIG1ldGFkYXRhO1xyXG59XHJcbmZ1bmN0aW9uIGZyb21SZXNvdXJjZVN0cmluZyhzZXJ2aWNlLCByZXNvdXJjZVN0cmluZywgbWFwcGluZ3MpIHtcclxuICAgIGNvbnN0IG9iaiA9IGpzb25PYmplY3RPck51bGwocmVzb3VyY2VTdHJpbmcpO1xyXG4gICAgaWYgKG9iaiA9PT0gbnVsbCkge1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgY29uc3QgcmVzb3VyY2UgPSBvYmo7XHJcbiAgICByZXR1cm4gZnJvbVJlc291cmNlKHNlcnZpY2UsIHJlc291cmNlLCBtYXBwaW5ncyk7XHJcbn1cclxuZnVuY3Rpb24gZG93bmxvYWRVcmxGcm9tUmVzb3VyY2VTdHJpbmcobWV0YWRhdGEsIHJlc291cmNlU3RyaW5nLCBob3N0KSB7XHJcbiAgICBjb25zdCBvYmogPSBqc29uT2JqZWN0T3JOdWxsKHJlc291cmNlU3RyaW5nKTtcclxuICAgIGlmIChvYmogPT09IG51bGwpIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIGlmICghaXNTdHJpbmcob2JqWydkb3dubG9hZFRva2VucyddKSkge1xyXG4gICAgICAgIC8vIFRoaXMgY2FuIGhhcHBlbiBpZiBvYmplY3RzIGFyZSB1cGxvYWRlZCB0aHJvdWdoIEdDUyBhbmQgcmV0cmlldmVkXHJcbiAgICAgICAgLy8gdGhyb3VnaCBsaXN0LCBzbyB3ZSBkb24ndCB3YW50IHRvIHRocm93IGFuIEVycm9yLlxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgY29uc3QgdG9rZW5zID0gb2JqWydkb3dubG9hZFRva2VucyddO1xyXG4gICAgaWYgKHRva2Vucy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIGNvbnN0IGVuY29kZSA9IGVuY29kZVVSSUNvbXBvbmVudDtcclxuICAgIGNvbnN0IHRva2Vuc0xpc3QgPSB0b2tlbnMuc3BsaXQoJywnKTtcclxuICAgIGNvbnN0IHVybHMgPSB0b2tlbnNMaXN0Lm1hcCgodG9rZW4pID0+IHtcclxuICAgICAgICBjb25zdCBidWNrZXQgPSBtZXRhZGF0YVsnYnVja2V0J107XHJcbiAgICAgICAgY29uc3QgcGF0aCA9IG1ldGFkYXRhWydmdWxsUGF0aCddO1xyXG4gICAgICAgIGNvbnN0IHVybFBhcnQgPSAnL2IvJyArIGVuY29kZShidWNrZXQpICsgJy9vLycgKyBlbmNvZGUocGF0aCk7XHJcbiAgICAgICAgY29uc3QgYmFzZSA9IG1ha2VVcmwodXJsUGFydCwgaG9zdCk7XHJcbiAgICAgICAgY29uc3QgcXVlcnlTdHJpbmcgPSBtYWtlUXVlcnlTdHJpbmcoe1xyXG4gICAgICAgICAgICBhbHQ6ICdtZWRpYScsXHJcbiAgICAgICAgICAgIHRva2VuXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGJhc2UgKyBxdWVyeVN0cmluZztcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHVybHNbMF07XHJcbn1cclxuZnVuY3Rpb24gdG9SZXNvdXJjZVN0cmluZyhtZXRhZGF0YSwgbWFwcGluZ3MpIHtcclxuICAgIGNvbnN0IHJlc291cmNlID0ge307XHJcbiAgICBjb25zdCBsZW4gPSBtYXBwaW5ncy5sZW5ndGg7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgY29uc3QgbWFwcGluZyA9IG1hcHBpbmdzW2ldO1xyXG4gICAgICAgIGlmIChtYXBwaW5nLndyaXRhYmxlKSB7XHJcbiAgICAgICAgICAgIHJlc291cmNlW21hcHBpbmcuc2VydmVyXSA9IG1ldGFkYXRhW21hcHBpbmcubG9jYWxdO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShyZXNvdXJjZSk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuY29uc3QgUFJFRklYRVNfS0VZID0gJ3ByZWZpeGVzJztcclxuY29uc3QgSVRFTVNfS0VZID0gJ2l0ZW1zJztcclxuZnVuY3Rpb24gZnJvbUJhY2tlbmRSZXNwb25zZShzZXJ2aWNlLCBidWNrZXQsIHJlc291cmNlKSB7XHJcbiAgICBjb25zdCBsaXN0UmVzdWx0ID0ge1xyXG4gICAgICAgIHByZWZpeGVzOiBbXSxcclxuICAgICAgICBpdGVtczogW10sXHJcbiAgICAgICAgbmV4dFBhZ2VUb2tlbjogcmVzb3VyY2VbJ25leHRQYWdlVG9rZW4nXVxyXG4gICAgfTtcclxuICAgIGlmIChyZXNvdXJjZVtQUkVGSVhFU19LRVldKSB7XHJcbiAgICAgICAgZm9yIChjb25zdCBwYXRoIG9mIHJlc291cmNlW1BSRUZJWEVTX0tFWV0pIHtcclxuICAgICAgICAgICAgY29uc3QgcGF0aFdpdGhvdXRUcmFpbGluZ1NsYXNoID0gcGF0aC5yZXBsYWNlKC9cXC8kLywgJycpO1xyXG4gICAgICAgICAgICBjb25zdCByZWZlcmVuY2UgPSBzZXJ2aWNlLl9tYWtlU3RvcmFnZVJlZmVyZW5jZShuZXcgTG9jYXRpb24oYnVja2V0LCBwYXRoV2l0aG91dFRyYWlsaW5nU2xhc2gpKTtcclxuICAgICAgICAgICAgbGlzdFJlc3VsdC5wcmVmaXhlcy5wdXNoKHJlZmVyZW5jZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKHJlc291cmNlW0lURU1TX0tFWV0pIHtcclxuICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgcmVzb3VyY2VbSVRFTVNfS0VZXSkge1xyXG4gICAgICAgICAgICBjb25zdCByZWZlcmVuY2UgPSBzZXJ2aWNlLl9tYWtlU3RvcmFnZVJlZmVyZW5jZShuZXcgTG9jYXRpb24oYnVja2V0LCBpdGVtWyduYW1lJ10pKTtcclxuICAgICAgICAgICAgbGlzdFJlc3VsdC5pdGVtcy5wdXNoKHJlZmVyZW5jZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGxpc3RSZXN1bHQ7XHJcbn1cclxuZnVuY3Rpb24gZnJvbVJlc3BvbnNlU3RyaW5nKHNlcnZpY2UsIGJ1Y2tldCwgcmVzb3VyY2VTdHJpbmcpIHtcclxuICAgIGNvbnN0IG9iaiA9IGpzb25PYmplY3RPck51bGwocmVzb3VyY2VTdHJpbmcpO1xyXG4gICAgaWYgKG9iaiA9PT0gbnVsbCkge1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgY29uc3QgcmVzb3VyY2UgPSBvYmo7XHJcbiAgICByZXR1cm4gZnJvbUJhY2tlbmRSZXNwb25zZShzZXJ2aWNlLCBidWNrZXQsIHJlc291cmNlKTtcclxufVxuXG5jbGFzcyBSZXF1ZXN0SW5mbyB7XHJcbiAgICBjb25zdHJ1Y3Rvcih1cmwsIG1ldGhvZCwgXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdGhlIHZhbHVlIHdpdGggd2hpY2ggdG8gcmVzb2x2ZSB0aGUgcmVxdWVzdCdzIHByb21pc2UuIE9ubHkgY2FsbGVkXHJcbiAgICAgKiBpZiB0aGUgcmVxdWVzdCBpcyBzdWNjZXNzZnVsLiBUaHJvdyBmcm9tIHRoaXMgZnVuY3Rpb24gdG8gcmVqZWN0IHRoZVxyXG4gICAgICogcmV0dXJuZWQgUmVxdWVzdCdzIHByb21pc2Ugd2l0aCB0aGUgdGhyb3duIGVycm9yLlxyXG4gICAgICogTm90ZTogVGhlIFhocklvIHBhc3NlZCB0byB0aGlzIGZ1bmN0aW9uIG1heSBiZSByZXVzZWQgYWZ0ZXIgdGhpcyBjYWxsYmFja1xyXG4gICAgICogcmV0dXJucy4gRG8gbm90IGtlZXAgYSByZWZlcmVuY2UgdG8gaXQgaW4gYW55IHdheS5cclxuICAgICAqL1xyXG4gICAgaGFuZGxlciwgdGltZW91dCkge1xyXG4gICAgICAgIHRoaXMudXJsID0gdXJsO1xyXG4gICAgICAgIHRoaXMubWV0aG9kID0gbWV0aG9kO1xyXG4gICAgICAgIHRoaXMuaGFuZGxlciA9IGhhbmRsZXI7XHJcbiAgICAgICAgdGhpcy50aW1lb3V0ID0gdGltZW91dDtcclxuICAgICAgICB0aGlzLnVybFBhcmFtcyA9IHt9O1xyXG4gICAgICAgIHRoaXMuaGVhZGVycyA9IHt9O1xyXG4gICAgICAgIHRoaXMuYm9keSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5lcnJvckhhbmRsZXIgPSBudWxsO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIENhbGxlZCB3aXRoIHRoZSBjdXJyZW50IG51bWJlciBvZiBieXRlcyB1cGxvYWRlZCBhbmQgdG90YWwgc2l6ZSAoLTEgaWYgbm90XHJcbiAgICAgICAgICogY29tcHV0YWJsZSkgb2YgdGhlIHJlcXVlc3QgYm9keSAoaS5lLiB1c2VkIHRvIHJlcG9ydCB1cGxvYWQgcHJvZ3Jlc3MpLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMucHJvZ3Jlc3NDYWxsYmFjayA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5zdWNjZXNzQ29kZXMgPSBbMjAwXTtcclxuICAgICAgICB0aGlzLmFkZGl0aW9uYWxSZXRyeUNvZGVzID0gW107XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFRocm93cyB0aGUgVU5LTk9XTiBTdG9yYWdlRXJyb3IgaWYgY25kbiBpcyBmYWxzZS5cclxuICovXHJcbmZ1bmN0aW9uIGhhbmRsZXJDaGVjayhjbmRuKSB7XHJcbiAgICBpZiAoIWNuZG4pIHtcclxuICAgICAgICB0aHJvdyB1bmtub3duKCk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gbWV0YWRhdGFIYW5kbGVyKHNlcnZpY2UsIG1hcHBpbmdzKSB7XHJcbiAgICBmdW5jdGlvbiBoYW5kbGVyKHhociwgdGV4dCkge1xyXG4gICAgICAgIGNvbnN0IG1ldGFkYXRhID0gZnJvbVJlc291cmNlU3RyaW5nKHNlcnZpY2UsIHRleHQsIG1hcHBpbmdzKTtcclxuICAgICAgICBoYW5kbGVyQ2hlY2sobWV0YWRhdGEgIT09IG51bGwpO1xyXG4gICAgICAgIHJldHVybiBtZXRhZGF0YTtcclxuICAgIH1cclxuICAgIHJldHVybiBoYW5kbGVyO1xyXG59XHJcbmZ1bmN0aW9uIGxpc3RIYW5kbGVyKHNlcnZpY2UsIGJ1Y2tldCkge1xyXG4gICAgZnVuY3Rpb24gaGFuZGxlcih4aHIsIHRleHQpIHtcclxuICAgICAgICBjb25zdCBsaXN0UmVzdWx0ID0gZnJvbVJlc3BvbnNlU3RyaW5nKHNlcnZpY2UsIGJ1Y2tldCwgdGV4dCk7XHJcbiAgICAgICAgaGFuZGxlckNoZWNrKGxpc3RSZXN1bHQgIT09IG51bGwpO1xyXG4gICAgICAgIHJldHVybiBsaXN0UmVzdWx0O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGhhbmRsZXI7XHJcbn1cclxuZnVuY3Rpb24gZG93bmxvYWRVcmxIYW5kbGVyKHNlcnZpY2UsIG1hcHBpbmdzKSB7XHJcbiAgICBmdW5jdGlvbiBoYW5kbGVyKHhociwgdGV4dCkge1xyXG4gICAgICAgIGNvbnN0IG1ldGFkYXRhID0gZnJvbVJlc291cmNlU3RyaW5nKHNlcnZpY2UsIHRleHQsIG1hcHBpbmdzKTtcclxuICAgICAgICBoYW5kbGVyQ2hlY2sobWV0YWRhdGEgIT09IG51bGwpO1xyXG4gICAgICAgIHJldHVybiBkb3dubG9hZFVybEZyb21SZXNvdXJjZVN0cmluZyhtZXRhZGF0YSwgdGV4dCwgc2VydmljZS5ob3N0KTtcclxuICAgIH1cclxuICAgIHJldHVybiBoYW5kbGVyO1xyXG59XHJcbmZ1bmN0aW9uIHNoYXJlZEVycm9ySGFuZGxlcihsb2NhdGlvbikge1xyXG4gICAgZnVuY3Rpb24gZXJyb3JIYW5kbGVyKHhociwgZXJyKSB7XHJcbiAgICAgICAgbGV0IG5ld0VycjtcclxuICAgICAgICBpZiAoeGhyLmdldFN0YXR1cygpID09PSA0MDEpIHtcclxuICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAvLyBUaGlzIGV4YWN0IG1lc3NhZ2Ugc3RyaW5nIGlzIHRoZSBvbmx5IGNvbnNpc3RlbnQgcGFydCBvZiB0aGVcclxuICAgICAgICAgICAgLy8gc2VydmVyJ3MgZXJyb3IgcmVzcG9uc2UgdGhhdCBpZGVudGlmaWVzIGl0IGFzIGFuIEFwcCBDaGVjayBlcnJvci5cclxuICAgICAgICAgICAgeGhyLmdldFJlc3BvbnNlVGV4dCgpLmluY2x1ZGVzKCdGaXJlYmFzZSBBcHAgQ2hlY2sgdG9rZW4gaXMgaW52YWxpZCcpKSB7XHJcbiAgICAgICAgICAgICAgICBuZXdFcnIgPSB1bmF1dGhvcml6ZWRBcHAoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIG5ld0VyciA9IHVuYXV0aGVudGljYXRlZCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAoeGhyLmdldFN0YXR1cygpID09PSA0MDIpIHtcclxuICAgICAgICAgICAgICAgIG5ld0VyciA9IHF1b3RhRXhjZWVkZWQobG9jYXRpb24uYnVja2V0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmICh4aHIuZ2V0U3RhdHVzKCkgPT09IDQwMykge1xyXG4gICAgICAgICAgICAgICAgICAgIG5ld0VyciA9IHVuYXV0aG9yaXplZChsb2NhdGlvbi5wYXRoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIG5ld0VyciA9IGVycjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBuZXdFcnIuc2VydmVyUmVzcG9uc2UgPSBlcnIuc2VydmVyUmVzcG9uc2U7XHJcbiAgICAgICAgcmV0dXJuIG5ld0VycjtcclxuICAgIH1cclxuICAgIHJldHVybiBlcnJvckhhbmRsZXI7XHJcbn1cclxuZnVuY3Rpb24gb2JqZWN0RXJyb3JIYW5kbGVyKGxvY2F0aW9uKSB7XHJcbiAgICBjb25zdCBzaGFyZWQgPSBzaGFyZWRFcnJvckhhbmRsZXIobG9jYXRpb24pO1xyXG4gICAgZnVuY3Rpb24gZXJyb3JIYW5kbGVyKHhociwgZXJyKSB7XHJcbiAgICAgICAgbGV0IG5ld0VyciA9IHNoYXJlZCh4aHIsIGVycik7XHJcbiAgICAgICAgaWYgKHhoci5nZXRTdGF0dXMoKSA9PT0gNDA0KSB7XHJcbiAgICAgICAgICAgIG5ld0VyciA9IG9iamVjdE5vdEZvdW5kKGxvY2F0aW9uLnBhdGgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBuZXdFcnIuc2VydmVyUmVzcG9uc2UgPSBlcnIuc2VydmVyUmVzcG9uc2U7XHJcbiAgICAgICAgcmV0dXJuIG5ld0VycjtcclxuICAgIH1cclxuICAgIHJldHVybiBlcnJvckhhbmRsZXI7XHJcbn1cclxuZnVuY3Rpb24gZ2V0TWV0YWRhdGEkMihzZXJ2aWNlLCBsb2NhdGlvbiwgbWFwcGluZ3MpIHtcclxuICAgIGNvbnN0IHVybFBhcnQgPSBsb2NhdGlvbi5mdWxsU2VydmVyVXJsKCk7XHJcbiAgICBjb25zdCB1cmwgPSBtYWtlVXJsKHVybFBhcnQsIHNlcnZpY2UuaG9zdCk7XHJcbiAgICBjb25zdCBtZXRob2QgPSAnR0VUJztcclxuICAgIGNvbnN0IHRpbWVvdXQgPSBzZXJ2aWNlLm1heE9wZXJhdGlvblJldHJ5VGltZTtcclxuICAgIGNvbnN0IHJlcXVlc3RJbmZvID0gbmV3IFJlcXVlc3RJbmZvKHVybCwgbWV0aG9kLCBtZXRhZGF0YUhhbmRsZXIoc2VydmljZSwgbWFwcGluZ3MpLCB0aW1lb3V0KTtcclxuICAgIHJlcXVlc3RJbmZvLmVycm9ySGFuZGxlciA9IG9iamVjdEVycm9ySGFuZGxlcihsb2NhdGlvbik7XHJcbiAgICByZXR1cm4gcmVxdWVzdEluZm87XHJcbn1cclxuZnVuY3Rpb24gbGlzdCQyKHNlcnZpY2UsIGxvY2F0aW9uLCBkZWxpbWl0ZXIsIHBhZ2VUb2tlbiwgbWF4UmVzdWx0cykge1xyXG4gICAgY29uc3QgdXJsUGFyYW1zID0ge307XHJcbiAgICBpZiAobG9jYXRpb24uaXNSb290KSB7XHJcbiAgICAgICAgdXJsUGFyYW1zWydwcmVmaXgnXSA9ICcnO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgdXJsUGFyYW1zWydwcmVmaXgnXSA9IGxvY2F0aW9uLnBhdGggKyAnLyc7XHJcbiAgICB9XHJcbiAgICBpZiAoZGVsaW1pdGVyICYmIGRlbGltaXRlci5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgdXJsUGFyYW1zWydkZWxpbWl0ZXInXSA9IGRlbGltaXRlcjtcclxuICAgIH1cclxuICAgIGlmIChwYWdlVG9rZW4pIHtcclxuICAgICAgICB1cmxQYXJhbXNbJ3BhZ2VUb2tlbiddID0gcGFnZVRva2VuO1xyXG4gICAgfVxyXG4gICAgaWYgKG1heFJlc3VsdHMpIHtcclxuICAgICAgICB1cmxQYXJhbXNbJ21heFJlc3VsdHMnXSA9IG1heFJlc3VsdHM7XHJcbiAgICB9XHJcbiAgICBjb25zdCB1cmxQYXJ0ID0gbG9jYXRpb24uYnVja2V0T25seVNlcnZlclVybCgpO1xyXG4gICAgY29uc3QgdXJsID0gbWFrZVVybCh1cmxQYXJ0LCBzZXJ2aWNlLmhvc3QpO1xyXG4gICAgY29uc3QgbWV0aG9kID0gJ0dFVCc7XHJcbiAgICBjb25zdCB0aW1lb3V0ID0gc2VydmljZS5tYXhPcGVyYXRpb25SZXRyeVRpbWU7XHJcbiAgICBjb25zdCByZXF1ZXN0SW5mbyA9IG5ldyBSZXF1ZXN0SW5mbyh1cmwsIG1ldGhvZCwgbGlzdEhhbmRsZXIoc2VydmljZSwgbG9jYXRpb24uYnVja2V0KSwgdGltZW91dCk7XHJcbiAgICByZXF1ZXN0SW5mby51cmxQYXJhbXMgPSB1cmxQYXJhbXM7XHJcbiAgICByZXF1ZXN0SW5mby5lcnJvckhhbmRsZXIgPSBzaGFyZWRFcnJvckhhbmRsZXIobG9jYXRpb24pO1xyXG4gICAgcmV0dXJuIHJlcXVlc3RJbmZvO1xyXG59XHJcbmZ1bmN0aW9uIGdldERvd25sb2FkVXJsKHNlcnZpY2UsIGxvY2F0aW9uLCBtYXBwaW5ncykge1xyXG4gICAgY29uc3QgdXJsUGFydCA9IGxvY2F0aW9uLmZ1bGxTZXJ2ZXJVcmwoKTtcclxuICAgIGNvbnN0IHVybCA9IG1ha2VVcmwodXJsUGFydCwgc2VydmljZS5ob3N0KTtcclxuICAgIGNvbnN0IG1ldGhvZCA9ICdHRVQnO1xyXG4gICAgY29uc3QgdGltZW91dCA9IHNlcnZpY2UubWF4T3BlcmF0aW9uUmV0cnlUaW1lO1xyXG4gICAgY29uc3QgcmVxdWVzdEluZm8gPSBuZXcgUmVxdWVzdEluZm8odXJsLCBtZXRob2QsIGRvd25sb2FkVXJsSGFuZGxlcihzZXJ2aWNlLCBtYXBwaW5ncyksIHRpbWVvdXQpO1xyXG4gICAgcmVxdWVzdEluZm8uZXJyb3JIYW5kbGVyID0gb2JqZWN0RXJyb3JIYW5kbGVyKGxvY2F0aW9uKTtcclxuICAgIHJldHVybiByZXF1ZXN0SW5mbztcclxufVxyXG5mdW5jdGlvbiB1cGRhdGVNZXRhZGF0YSQyKHNlcnZpY2UsIGxvY2F0aW9uLCBtZXRhZGF0YSwgbWFwcGluZ3MpIHtcclxuICAgIGNvbnN0IHVybFBhcnQgPSBsb2NhdGlvbi5mdWxsU2VydmVyVXJsKCk7XHJcbiAgICBjb25zdCB1cmwgPSBtYWtlVXJsKHVybFBhcnQsIHNlcnZpY2UuaG9zdCk7XHJcbiAgICBjb25zdCBtZXRob2QgPSAnUEFUQ0gnO1xyXG4gICAgY29uc3QgYm9keSA9IHRvUmVzb3VyY2VTdHJpbmcobWV0YWRhdGEsIG1hcHBpbmdzKTtcclxuICAgIGNvbnN0IGhlYWRlcnMgPSB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD11dGYtOCcgfTtcclxuICAgIGNvbnN0IHRpbWVvdXQgPSBzZXJ2aWNlLm1heE9wZXJhdGlvblJldHJ5VGltZTtcclxuICAgIGNvbnN0IHJlcXVlc3RJbmZvID0gbmV3IFJlcXVlc3RJbmZvKHVybCwgbWV0aG9kLCBtZXRhZGF0YUhhbmRsZXIoc2VydmljZSwgbWFwcGluZ3MpLCB0aW1lb3V0KTtcclxuICAgIHJlcXVlc3RJbmZvLmhlYWRlcnMgPSBoZWFkZXJzO1xyXG4gICAgcmVxdWVzdEluZm8uYm9keSA9IGJvZHk7XHJcbiAgICByZXF1ZXN0SW5mby5lcnJvckhhbmRsZXIgPSBvYmplY3RFcnJvckhhbmRsZXIobG9jYXRpb24pO1xyXG4gICAgcmV0dXJuIHJlcXVlc3RJbmZvO1xyXG59XHJcbmZ1bmN0aW9uIGRlbGV0ZU9iamVjdCQyKHNlcnZpY2UsIGxvY2F0aW9uKSB7XHJcbiAgICBjb25zdCB1cmxQYXJ0ID0gbG9jYXRpb24uZnVsbFNlcnZlclVybCgpO1xyXG4gICAgY29uc3QgdXJsID0gbWFrZVVybCh1cmxQYXJ0LCBzZXJ2aWNlLmhvc3QpO1xyXG4gICAgY29uc3QgbWV0aG9kID0gJ0RFTEVURSc7XHJcbiAgICBjb25zdCB0aW1lb3V0ID0gc2VydmljZS5tYXhPcGVyYXRpb25SZXRyeVRpbWU7XHJcbiAgICBmdW5jdGlvbiBoYW5kbGVyKF94aHIsIF90ZXh0KSB7IH1cclxuICAgIGNvbnN0IHJlcXVlc3RJbmZvID0gbmV3IFJlcXVlc3RJbmZvKHVybCwgbWV0aG9kLCBoYW5kbGVyLCB0aW1lb3V0KTtcclxuICAgIHJlcXVlc3RJbmZvLnN1Y2Nlc3NDb2RlcyA9IFsyMDAsIDIwNF07XHJcbiAgICByZXF1ZXN0SW5mby5lcnJvckhhbmRsZXIgPSBvYmplY3RFcnJvckhhbmRsZXIobG9jYXRpb24pO1xyXG4gICAgcmV0dXJuIHJlcXVlc3RJbmZvO1xyXG59XHJcbmZ1bmN0aW9uIGRldGVybWluZUNvbnRlbnRUeXBlXyhtZXRhZGF0YSwgYmxvYikge1xyXG4gICAgcmV0dXJuICgobWV0YWRhdGEgJiYgbWV0YWRhdGFbJ2NvbnRlbnRUeXBlJ10pIHx8XHJcbiAgICAgICAgKGJsb2IgJiYgYmxvYi50eXBlKCkpIHx8XHJcbiAgICAgICAgJ2FwcGxpY2F0aW9uL29jdGV0LXN0cmVhbScpO1xyXG59XHJcbmZ1bmN0aW9uIG1ldGFkYXRhRm9yVXBsb2FkXyhsb2NhdGlvbiwgYmxvYiwgbWV0YWRhdGEpIHtcclxuICAgIGNvbnN0IG1ldGFkYXRhQ2xvbmUgPSBPYmplY3QuYXNzaWduKHt9LCBtZXRhZGF0YSk7XHJcbiAgICBtZXRhZGF0YUNsb25lWydmdWxsUGF0aCddID0gbG9jYXRpb24ucGF0aDtcclxuICAgIG1ldGFkYXRhQ2xvbmVbJ3NpemUnXSA9IGJsb2Iuc2l6ZSgpO1xyXG4gICAgaWYgKCFtZXRhZGF0YUNsb25lWydjb250ZW50VHlwZSddKSB7XHJcbiAgICAgICAgbWV0YWRhdGFDbG9uZVsnY29udGVudFR5cGUnXSA9IGRldGVybWluZUNvbnRlbnRUeXBlXyhudWxsLCBibG9iKTtcclxuICAgIH1cclxuICAgIHJldHVybiBtZXRhZGF0YUNsb25lO1xyXG59XHJcbi8qKlxyXG4gKiBQcmVwYXJlIFJlcXVlc3RJbmZvIGZvciB1cGxvYWRzIGFzIENvbnRlbnQtVHlwZTogbXVsdGlwYXJ0LlxyXG4gKi9cclxuZnVuY3Rpb24gbXVsdGlwYXJ0VXBsb2FkKHNlcnZpY2UsIGxvY2F0aW9uLCBtYXBwaW5ncywgYmxvYiwgbWV0YWRhdGEpIHtcclxuICAgIGNvbnN0IHVybFBhcnQgPSBsb2NhdGlvbi5idWNrZXRPbmx5U2VydmVyVXJsKCk7XHJcbiAgICBjb25zdCBoZWFkZXJzID0ge1xyXG4gICAgICAgICdYLUdvb2ctVXBsb2FkLVByb3RvY29sJzogJ211bHRpcGFydCdcclxuICAgIH07XHJcbiAgICBmdW5jdGlvbiBnZW5Cb3VuZGFyeSgpIHtcclxuICAgICAgICBsZXQgc3RyID0gJyc7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAyOyBpKyspIHtcclxuICAgICAgICAgICAgc3RyID0gc3RyICsgTWF0aC5yYW5kb20oKS50b1N0cmluZygpLnNsaWNlKDIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gc3RyO1xyXG4gICAgfVxyXG4gICAgY29uc3QgYm91bmRhcnkgPSBnZW5Cb3VuZGFyeSgpO1xyXG4gICAgaGVhZGVyc1snQ29udGVudC1UeXBlJ10gPSAnbXVsdGlwYXJ0L3JlbGF0ZWQ7IGJvdW5kYXJ5PScgKyBib3VuZGFyeTtcclxuICAgIGNvbnN0IG1ldGFkYXRhXyA9IG1ldGFkYXRhRm9yVXBsb2FkXyhsb2NhdGlvbiwgYmxvYiwgbWV0YWRhdGEpO1xyXG4gICAgY29uc3QgbWV0YWRhdGFTdHJpbmcgPSB0b1Jlc291cmNlU3RyaW5nKG1ldGFkYXRhXywgbWFwcGluZ3MpO1xyXG4gICAgY29uc3QgcHJlQmxvYlBhcnQgPSAnLS0nICtcclxuICAgICAgICBib3VuZGFyeSArXHJcbiAgICAgICAgJ1xcclxcbicgK1xyXG4gICAgICAgICdDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLThcXHJcXG5cXHJcXG4nICtcclxuICAgICAgICBtZXRhZGF0YVN0cmluZyArXHJcbiAgICAgICAgJ1xcclxcbi0tJyArXHJcbiAgICAgICAgYm91bmRhcnkgK1xyXG4gICAgICAgICdcXHJcXG4nICtcclxuICAgICAgICAnQ29udGVudC1UeXBlOiAnICtcclxuICAgICAgICBtZXRhZGF0YV9bJ2NvbnRlbnRUeXBlJ10gK1xyXG4gICAgICAgICdcXHJcXG5cXHJcXG4nO1xyXG4gICAgY29uc3QgcG9zdEJsb2JQYXJ0ID0gJ1xcclxcbi0tJyArIGJvdW5kYXJ5ICsgJy0tJztcclxuICAgIGNvbnN0IGJvZHkgPSBGYnNCbG9iLmdldEJsb2IocHJlQmxvYlBhcnQsIGJsb2IsIHBvc3RCbG9iUGFydCk7XHJcbiAgICBpZiAoYm9keSA9PT0gbnVsbCkge1xyXG4gICAgICAgIHRocm93IGNhbm5vdFNsaWNlQmxvYigpO1xyXG4gICAgfVxyXG4gICAgY29uc3QgdXJsUGFyYW1zID0geyBuYW1lOiBtZXRhZGF0YV9bJ2Z1bGxQYXRoJ10gfTtcclxuICAgIGNvbnN0IHVybCA9IG1ha2VVcmwodXJsUGFydCwgc2VydmljZS5ob3N0KTtcclxuICAgIGNvbnN0IG1ldGhvZCA9ICdQT1NUJztcclxuICAgIGNvbnN0IHRpbWVvdXQgPSBzZXJ2aWNlLm1heFVwbG9hZFJldHJ5VGltZTtcclxuICAgIGNvbnN0IHJlcXVlc3RJbmZvID0gbmV3IFJlcXVlc3RJbmZvKHVybCwgbWV0aG9kLCBtZXRhZGF0YUhhbmRsZXIoc2VydmljZSwgbWFwcGluZ3MpLCB0aW1lb3V0KTtcclxuICAgIHJlcXVlc3RJbmZvLnVybFBhcmFtcyA9IHVybFBhcmFtcztcclxuICAgIHJlcXVlc3RJbmZvLmhlYWRlcnMgPSBoZWFkZXJzO1xyXG4gICAgcmVxdWVzdEluZm8uYm9keSA9IGJvZHkudXBsb2FkRGF0YSgpO1xyXG4gICAgcmVxdWVzdEluZm8uZXJyb3JIYW5kbGVyID0gc2hhcmVkRXJyb3JIYW5kbGVyKGxvY2F0aW9uKTtcclxuICAgIHJldHVybiByZXF1ZXN0SW5mbztcclxufVxyXG4vKipcclxuICogQHBhcmFtIGN1cnJlbnQgVGhlIG51bWJlciBvZiBieXRlcyB0aGF0IGhhdmUgYmVlbiB1cGxvYWRlZCBzbyBmYXIuXHJcbiAqIEBwYXJhbSB0b3RhbCBUaGUgdG90YWwgbnVtYmVyIG9mIGJ5dGVzIGluIHRoZSB1cGxvYWQuXHJcbiAqIEBwYXJhbSBvcHRfZmluYWxpemVkIFRydWUgaWYgdGhlIHNlcnZlciBoYXMgZmluaXNoZWQgdGhlIHVwbG9hZC5cclxuICogQHBhcmFtIG9wdF9tZXRhZGF0YSBUaGUgdXBsb2FkIG1ldGFkYXRhLCBzaG91bGRcclxuICogICAgIG9ubHkgYmUgcGFzc2VkIGlmIG9wdF9maW5hbGl6ZWQgaXMgdHJ1ZS5cclxuICovXHJcbmNsYXNzIFJlc3VtYWJsZVVwbG9hZFN0YXR1cyB7XHJcbiAgICBjb25zdHJ1Y3RvcihjdXJyZW50LCB0b3RhbCwgZmluYWxpemVkLCBtZXRhZGF0YSkge1xyXG4gICAgICAgIHRoaXMuY3VycmVudCA9IGN1cnJlbnQ7XHJcbiAgICAgICAgdGhpcy50b3RhbCA9IHRvdGFsO1xyXG4gICAgICAgIHRoaXMuZmluYWxpemVkID0gISFmaW5hbGl6ZWQ7XHJcbiAgICAgICAgdGhpcy5tZXRhZGF0YSA9IG1ldGFkYXRhIHx8IG51bGw7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gY2hlY2tSZXN1bWVIZWFkZXJfKHhociwgYWxsb3dlZCkge1xyXG4gICAgbGV0IHN0YXR1cyA9IG51bGw7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHN0YXR1cyA9IHhoci5nZXRSZXNwb25zZUhlYWRlcignWC1Hb29nLVVwbG9hZC1TdGF0dXMnKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgaGFuZGxlckNoZWNrKGZhbHNlKTtcclxuICAgIH1cclxuICAgIGNvbnN0IGFsbG93ZWRTdGF0dXMgPSBhbGxvd2VkIHx8IFsnYWN0aXZlJ107XHJcbiAgICBoYW5kbGVyQ2hlY2soISFzdGF0dXMgJiYgYWxsb3dlZFN0YXR1cy5pbmRleE9mKHN0YXR1cykgIT09IC0xKTtcclxuICAgIHJldHVybiBzdGF0dXM7XHJcbn1cclxuZnVuY3Rpb24gY3JlYXRlUmVzdW1hYmxlVXBsb2FkKHNlcnZpY2UsIGxvY2F0aW9uLCBtYXBwaW5ncywgYmxvYiwgbWV0YWRhdGEpIHtcclxuICAgIGNvbnN0IHVybFBhcnQgPSBsb2NhdGlvbi5idWNrZXRPbmx5U2VydmVyVXJsKCk7XHJcbiAgICBjb25zdCBtZXRhZGF0YUZvclVwbG9hZCA9IG1ldGFkYXRhRm9yVXBsb2FkXyhsb2NhdGlvbiwgYmxvYiwgbWV0YWRhdGEpO1xyXG4gICAgY29uc3QgdXJsUGFyYW1zID0geyBuYW1lOiBtZXRhZGF0YUZvclVwbG9hZFsnZnVsbFBhdGgnXSB9O1xyXG4gICAgY29uc3QgdXJsID0gbWFrZVVybCh1cmxQYXJ0LCBzZXJ2aWNlLmhvc3QpO1xyXG4gICAgY29uc3QgbWV0aG9kID0gJ1BPU1QnO1xyXG4gICAgY29uc3QgaGVhZGVycyA9IHtcclxuICAgICAgICAnWC1Hb29nLVVwbG9hZC1Qcm90b2NvbCc6ICdyZXN1bWFibGUnLFxyXG4gICAgICAgICdYLUdvb2ctVXBsb2FkLUNvbW1hbmQnOiAnc3RhcnQnLFxyXG4gICAgICAgICdYLUdvb2ctVXBsb2FkLUhlYWRlci1Db250ZW50LUxlbmd0aCc6IGAke2Jsb2Iuc2l6ZSgpfWAsXHJcbiAgICAgICAgJ1gtR29vZy1VcGxvYWQtSGVhZGVyLUNvbnRlbnQtVHlwZSc6IG1ldGFkYXRhRm9yVXBsb2FkWydjb250ZW50VHlwZSddLFxyXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD11dGYtOCdcclxuICAgIH07XHJcbiAgICBjb25zdCBib2R5ID0gdG9SZXNvdXJjZVN0cmluZyhtZXRhZGF0YUZvclVwbG9hZCwgbWFwcGluZ3MpO1xyXG4gICAgY29uc3QgdGltZW91dCA9IHNlcnZpY2UubWF4VXBsb2FkUmV0cnlUaW1lO1xyXG4gICAgZnVuY3Rpb24gaGFuZGxlcih4aHIpIHtcclxuICAgICAgICBjaGVja1Jlc3VtZUhlYWRlcl8oeGhyKTtcclxuICAgICAgICBsZXQgdXJsO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHVybCA9IHhoci5nZXRSZXNwb25zZUhlYWRlcignWC1Hb29nLVVwbG9hZC1VUkwnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgaGFuZGxlckNoZWNrKGZhbHNlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaGFuZGxlckNoZWNrKGlzU3RyaW5nKHVybCkpO1xyXG4gICAgICAgIHJldHVybiB1cmw7XHJcbiAgICB9XHJcbiAgICBjb25zdCByZXF1ZXN0SW5mbyA9IG5ldyBSZXF1ZXN0SW5mbyh1cmwsIG1ldGhvZCwgaGFuZGxlciwgdGltZW91dCk7XHJcbiAgICByZXF1ZXN0SW5mby51cmxQYXJhbXMgPSB1cmxQYXJhbXM7XHJcbiAgICByZXF1ZXN0SW5mby5oZWFkZXJzID0gaGVhZGVycztcclxuICAgIHJlcXVlc3RJbmZvLmJvZHkgPSBib2R5O1xyXG4gICAgcmVxdWVzdEluZm8uZXJyb3JIYW5kbGVyID0gc2hhcmVkRXJyb3JIYW5kbGVyKGxvY2F0aW9uKTtcclxuICAgIHJldHVybiByZXF1ZXN0SW5mbztcclxufVxyXG4vKipcclxuICogQHBhcmFtIHVybCBGcm9tIGEgY2FsbCB0byBmYnMucmVxdWVzdHMuY3JlYXRlUmVzdW1hYmxlVXBsb2FkLlxyXG4gKi9cclxuZnVuY3Rpb24gZ2V0UmVzdW1hYmxlVXBsb2FkU3RhdHVzKHNlcnZpY2UsIGxvY2F0aW9uLCB1cmwsIGJsb2IpIHtcclxuICAgIGNvbnN0IGhlYWRlcnMgPSB7ICdYLUdvb2ctVXBsb2FkLUNvbW1hbmQnOiAncXVlcnknIH07XHJcbiAgICBmdW5jdGlvbiBoYW5kbGVyKHhocikge1xyXG4gICAgICAgIGNvbnN0IHN0YXR1cyA9IGNoZWNrUmVzdW1lSGVhZGVyXyh4aHIsIFsnYWN0aXZlJywgJ2ZpbmFsJ10pO1xyXG4gICAgICAgIGxldCBzaXplU3RyaW5nID0gbnVsbDtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBzaXplU3RyaW5nID0geGhyLmdldFJlc3BvbnNlSGVhZGVyKCdYLUdvb2ctVXBsb2FkLVNpemUtUmVjZWl2ZWQnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgaGFuZGxlckNoZWNrKGZhbHNlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCFzaXplU3RyaW5nKSB7XHJcbiAgICAgICAgICAgIC8vIG51bGwgb3IgZW1wdHkgc3RyaW5nXHJcbiAgICAgICAgICAgIGhhbmRsZXJDaGVjayhmYWxzZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHNpemUgPSBOdW1iZXIoc2l6ZVN0cmluZyk7XHJcbiAgICAgICAgaGFuZGxlckNoZWNrKCFpc05hTihzaXplKSk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBSZXN1bWFibGVVcGxvYWRTdGF0dXMoc2l6ZSwgYmxvYi5zaXplKCksIHN0YXR1cyA9PT0gJ2ZpbmFsJyk7XHJcbiAgICB9XHJcbiAgICBjb25zdCBtZXRob2QgPSAnUE9TVCc7XHJcbiAgICBjb25zdCB0aW1lb3V0ID0gc2VydmljZS5tYXhVcGxvYWRSZXRyeVRpbWU7XHJcbiAgICBjb25zdCByZXF1ZXN0SW5mbyA9IG5ldyBSZXF1ZXN0SW5mbyh1cmwsIG1ldGhvZCwgaGFuZGxlciwgdGltZW91dCk7XHJcbiAgICByZXF1ZXN0SW5mby5oZWFkZXJzID0gaGVhZGVycztcclxuICAgIHJlcXVlc3RJbmZvLmVycm9ySGFuZGxlciA9IHNoYXJlZEVycm9ySGFuZGxlcihsb2NhdGlvbik7XHJcbiAgICByZXR1cm4gcmVxdWVzdEluZm87XHJcbn1cclxuLyoqXHJcbiAqIEFueSB1cGxvYWRzIHZpYSB0aGUgcmVzdW1hYmxlIHVwbG9hZCBBUEkgbXVzdCB0cmFuc2ZlciBhIG51bWJlciBvZiBieXRlc1xyXG4gKiB0aGF0IGlzIGEgbXVsdGlwbGUgb2YgdGhpcyBudW1iZXIuXHJcbiAqL1xyXG5jb25zdCBSRVNVTUFCTEVfVVBMT0FEX0NIVU5LX1NJWkUgPSAyNTYgKiAxMDI0O1xyXG4vKipcclxuICogQHBhcmFtIHVybCBGcm9tIGEgY2FsbCB0byBmYnMucmVxdWVzdHMuY3JlYXRlUmVzdW1hYmxlVXBsb2FkLlxyXG4gKiBAcGFyYW0gY2h1bmtTaXplIE51bWJlciBvZiBieXRlcyB0byB1cGxvYWQuXHJcbiAqIEBwYXJhbSBzdGF0dXMgVGhlIHByZXZpb3VzIHN0YXR1cy5cclxuICogICAgIElmIG5vdCBwYXNzZWQgb3IgbnVsbCwgd2Ugc3RhcnQgZnJvbSB0aGUgYmVnaW5uaW5nLlxyXG4gKiBAdGhyb3dzIGZicy5FcnJvciBJZiB0aGUgdXBsb2FkIGlzIGFscmVhZHkgY29tcGxldGUsIHRoZSBwYXNzZWQgaW4gc3RhdHVzXHJcbiAqICAgICBoYXMgYSBmaW5hbCBzaXplIGluY29uc2lzdGVudCB3aXRoIHRoZSBibG9iLCBvciB0aGUgYmxvYiBjYW5ub3QgYmUgc2xpY2VkXHJcbiAqICAgICBmb3IgdXBsb2FkLlxyXG4gKi9cclxuZnVuY3Rpb24gY29udGludWVSZXN1bWFibGVVcGxvYWQobG9jYXRpb24sIHNlcnZpY2UsIHVybCwgYmxvYiwgY2h1bmtTaXplLCBtYXBwaW5ncywgc3RhdHVzLCBwcm9ncmVzc0NhbGxiYWNrKSB7XHJcbiAgICAvLyBUT0RPKGFuZHlzb3RvKTogc3RhbmRhcmRpemUgb24gaW50ZXJuYWwgYXNzZXJ0c1xyXG4gICAgLy8gYXNzZXJ0KCEob3B0X3N0YXR1cyAmJiBvcHRfc3RhdHVzLmZpbmFsaXplZCkpO1xyXG4gICAgY29uc3Qgc3RhdHVzXyA9IG5ldyBSZXN1bWFibGVVcGxvYWRTdGF0dXMoMCwgMCk7XHJcbiAgICBpZiAoc3RhdHVzKSB7XHJcbiAgICAgICAgc3RhdHVzXy5jdXJyZW50ID0gc3RhdHVzLmN1cnJlbnQ7XHJcbiAgICAgICAgc3RhdHVzXy50b3RhbCA9IHN0YXR1cy50b3RhbDtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHN0YXR1c18uY3VycmVudCA9IDA7XHJcbiAgICAgICAgc3RhdHVzXy50b3RhbCA9IGJsb2Iuc2l6ZSgpO1xyXG4gICAgfVxyXG4gICAgaWYgKGJsb2Iuc2l6ZSgpICE9PSBzdGF0dXNfLnRvdGFsKSB7XHJcbiAgICAgICAgdGhyb3cgc2VydmVyRmlsZVdyb25nU2l6ZSgpO1xyXG4gICAgfVxyXG4gICAgY29uc3QgYnl0ZXNMZWZ0ID0gc3RhdHVzXy50b3RhbCAtIHN0YXR1c18uY3VycmVudDtcclxuICAgIGxldCBieXRlc1RvVXBsb2FkID0gYnl0ZXNMZWZ0O1xyXG4gICAgaWYgKGNodW5rU2l6ZSA+IDApIHtcclxuICAgICAgICBieXRlc1RvVXBsb2FkID0gTWF0aC5taW4oYnl0ZXNUb1VwbG9hZCwgY2h1bmtTaXplKTtcclxuICAgIH1cclxuICAgIGNvbnN0IHN0YXJ0Qnl0ZSA9IHN0YXR1c18uY3VycmVudDtcclxuICAgIGNvbnN0IGVuZEJ5dGUgPSBzdGFydEJ5dGUgKyBieXRlc1RvVXBsb2FkO1xyXG4gICAgY29uc3QgdXBsb2FkQ29tbWFuZCA9IGJ5dGVzVG9VcGxvYWQgPT09IGJ5dGVzTGVmdCA/ICd1cGxvYWQsIGZpbmFsaXplJyA6ICd1cGxvYWQnO1xyXG4gICAgY29uc3QgaGVhZGVycyA9IHtcclxuICAgICAgICAnWC1Hb29nLVVwbG9hZC1Db21tYW5kJzogdXBsb2FkQ29tbWFuZCxcclxuICAgICAgICAnWC1Hb29nLVVwbG9hZC1PZmZzZXQnOiBgJHtzdGF0dXNfLmN1cnJlbnR9YFxyXG4gICAgfTtcclxuICAgIGNvbnN0IGJvZHkgPSBibG9iLnNsaWNlKHN0YXJ0Qnl0ZSwgZW5kQnl0ZSk7XHJcbiAgICBpZiAoYm9keSA9PT0gbnVsbCkge1xyXG4gICAgICAgIHRocm93IGNhbm5vdFNsaWNlQmxvYigpO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gaGFuZGxlcih4aHIsIHRleHQpIHtcclxuICAgICAgICAvLyBUT0RPKGFuZHlzb3RvKTogVmVyaWZ5IHRoZSBNRDUgb2YgZWFjaCB1cGxvYWRlZCByYW5nZTpcclxuICAgICAgICAvLyB0aGUgJ3gtcmFuZ2UtbWQ1JyBoZWFkZXIgY29tZXMgYmFjayB3aXRoIHN0YXR1cyBjb2RlIDMwOCByZXNwb25zZXMuXHJcbiAgICAgICAgLy8gV2UnbGwgb25seSBiZSBhYmxlIHRvIGJhaWwgb3V0IHRob3VnaCwgYmVjYXVzZSB5b3UgY2FuJ3QgcmUtdXBsb2FkIGFcclxuICAgICAgICAvLyByYW5nZSB0aGF0IHlvdSBwcmV2aW91c2x5IHVwbG9hZGVkLlxyXG4gICAgICAgIGNvbnN0IHVwbG9hZFN0YXR1cyA9IGNoZWNrUmVzdW1lSGVhZGVyXyh4aHIsIFsnYWN0aXZlJywgJ2ZpbmFsJ10pO1xyXG4gICAgICAgIGNvbnN0IG5ld0N1cnJlbnQgPSBzdGF0dXNfLmN1cnJlbnQgKyBieXRlc1RvVXBsb2FkO1xyXG4gICAgICAgIGNvbnN0IHNpemUgPSBibG9iLnNpemUoKTtcclxuICAgICAgICBsZXQgbWV0YWRhdGE7XHJcbiAgICAgICAgaWYgKHVwbG9hZFN0YXR1cyA9PT0gJ2ZpbmFsJykge1xyXG4gICAgICAgICAgICBtZXRhZGF0YSA9IG1ldGFkYXRhSGFuZGxlcihzZXJ2aWNlLCBtYXBwaW5ncykoeGhyLCB0ZXh0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIG1ldGFkYXRhID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5ldyBSZXN1bWFibGVVcGxvYWRTdGF0dXMobmV3Q3VycmVudCwgc2l6ZSwgdXBsb2FkU3RhdHVzID09PSAnZmluYWwnLCBtZXRhZGF0YSk7XHJcbiAgICB9XHJcbiAgICBjb25zdCBtZXRob2QgPSAnUE9TVCc7XHJcbiAgICBjb25zdCB0aW1lb3V0ID0gc2VydmljZS5tYXhVcGxvYWRSZXRyeVRpbWU7XHJcbiAgICBjb25zdCByZXF1ZXN0SW5mbyA9IG5ldyBSZXF1ZXN0SW5mbyh1cmwsIG1ldGhvZCwgaGFuZGxlciwgdGltZW91dCk7XHJcbiAgICByZXF1ZXN0SW5mby5oZWFkZXJzID0gaGVhZGVycztcclxuICAgIHJlcXVlc3RJbmZvLmJvZHkgPSBib2R5LnVwbG9hZERhdGEoKTtcclxuICAgIHJlcXVlc3RJbmZvLnByb2dyZXNzQ2FsbGJhY2sgPSBwcm9ncmVzc0NhbGxiYWNrIHx8IG51bGw7XHJcbiAgICByZXF1ZXN0SW5mby5lcnJvckhhbmRsZXIgPSBzaGFyZWRFcnJvckhhbmRsZXIobG9jYXRpb24pO1xyXG4gICAgcmV0dXJuIHJlcXVlc3RJbmZvO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBBbiBldmVudCB0aGF0IGlzIHRyaWdnZXJlZCBvbiBhIHRhc2suXHJcbiAqIEBpbnRlcm5hbFxyXG4gKi9cclxuY29uc3QgVGFza0V2ZW50ID0ge1xyXG4gICAgLyoqXHJcbiAgICAgKiBGb3IgdGhpcyBldmVudCxcclxuICAgICAqIDx1bD5cclxuICAgICAqICAgPGxpPlRoZSBgbmV4dGAgZnVuY3Rpb24gaXMgdHJpZ2dlcmVkIG9uIHByb2dyZXNzIHVwZGF0ZXMgYW5kIHdoZW4gdGhlXHJcbiAgICAgKiAgICAgICB0YXNrIGlzIHBhdXNlZC9yZXN1bWVkIHdpdGggYW4gYFVwbG9hZFRhc2tTbmFwc2hvdGAgYXMgdGhlIGZpcnN0XHJcbiAgICAgKiAgICAgICBhcmd1bWVudC48L2xpPlxyXG4gICAgICogICA8bGk+VGhlIGBlcnJvcmAgZnVuY3Rpb24gaXMgdHJpZ2dlcmVkIGlmIHRoZSB1cGxvYWQgaXMgY2FuY2VsZWQgb3IgZmFpbHNcclxuICAgICAqICAgICAgIGZvciBhbm90aGVyIHJlYXNvbi48L2xpPlxyXG4gICAgICogICA8bGk+VGhlIGBjb21wbGV0ZWAgZnVuY3Rpb24gaXMgdHJpZ2dlcmVkIGlmIHRoZSB1cGxvYWQgY29tcGxldGVzXHJcbiAgICAgKiAgICAgICBzdWNjZXNzZnVsbHkuPC9saT5cclxuICAgICAqIDwvdWw+XHJcbiAgICAgKi9cclxuICAgIFNUQVRFX0NIQU5HRUQ6ICdzdGF0ZV9jaGFuZ2VkJ1xyXG59O1xyXG4vLyB0eXBlIGtleXMgPSBrZXlvZiBUYXNrU3RhdGVcclxuLyoqXHJcbiAqIFJlcHJlc2VudHMgdGhlIGN1cnJlbnQgc3RhdGUgb2YgYSBydW5uaW5nIHVwbG9hZC5cclxuICogQGludGVybmFsXHJcbiAqL1xyXG5jb25zdCBUYXNrU3RhdGUgPSB7XHJcbiAgICAvKiogVGhlIHRhc2sgaXMgY3VycmVudGx5IHRyYW5zZmVycmluZyBkYXRhLiAqL1xyXG4gICAgUlVOTklORzogJ3J1bm5pbmcnLFxyXG4gICAgLyoqIFRoZSB0YXNrIHdhcyBwYXVzZWQgYnkgdGhlIHVzZXIuICovXHJcbiAgICBQQVVTRUQ6ICdwYXVzZWQnLFxyXG4gICAgLyoqIFRoZSB0YXNrIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuICovXHJcbiAgICBTVUNDRVNTOiAnc3VjY2VzcycsXHJcbiAgICAvKiogVGhlIHRhc2sgd2FzIGNhbmNlbGVkLiAqL1xyXG4gICAgQ0FOQ0VMRUQ6ICdjYW5jZWxlZCcsXHJcbiAgICAvKiogVGhlIHRhc2sgZmFpbGVkIHdpdGggYW4gZXJyb3IuICovXHJcbiAgICBFUlJPUjogJ2Vycm9yJ1xyXG59O1xyXG5mdW5jdGlvbiB0YXNrU3RhdGVGcm9tSW50ZXJuYWxUYXNrU3RhdGUoc3RhdGUpIHtcclxuICAgIHN3aXRjaCAoc3RhdGUpIHtcclxuICAgICAgICBjYXNlIFwicnVubmluZ1wiIC8qIFJVTk5JTkcgKi86XHJcbiAgICAgICAgY2FzZSBcInBhdXNpbmdcIiAvKiBQQVVTSU5HICovOlxyXG4gICAgICAgIGNhc2UgXCJjYW5jZWxpbmdcIiAvKiBDQU5DRUxJTkcgKi86XHJcbiAgICAgICAgICAgIHJldHVybiBUYXNrU3RhdGUuUlVOTklORztcclxuICAgICAgICBjYXNlIFwicGF1c2VkXCIgLyogUEFVU0VEICovOlxyXG4gICAgICAgICAgICByZXR1cm4gVGFza1N0YXRlLlBBVVNFRDtcclxuICAgICAgICBjYXNlIFwic3VjY2Vzc1wiIC8qIFNVQ0NFU1MgKi86XHJcbiAgICAgICAgICAgIHJldHVybiBUYXNrU3RhdGUuU1VDQ0VTUztcclxuICAgICAgICBjYXNlIFwiY2FuY2VsZWRcIiAvKiBDQU5DRUxFRCAqLzpcclxuICAgICAgICAgICAgcmV0dXJuIFRhc2tTdGF0ZS5DQU5DRUxFRDtcclxuICAgICAgICBjYXNlIFwiZXJyb3JcIiAvKiBFUlJPUiAqLzpcclxuICAgICAgICAgICAgcmV0dXJuIFRhc2tTdGF0ZS5FUlJPUjtcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAvLyBUT0RPKGFuZHlzb3RvKTogYXNzZXJ0KGZhbHNlKTtcclxuICAgICAgICAgICAgcmV0dXJuIFRhc2tTdGF0ZS5FUlJPUjtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jbGFzcyBPYnNlcnZlciB7XHJcbiAgICBjb25zdHJ1Y3RvcihuZXh0T3JPYnNlcnZlciwgZXJyb3IsIGNvbXBsZXRlKSB7XHJcbiAgICAgICAgY29uc3QgYXNGdW5jdGlvbnMgPSBpc0Z1bmN0aW9uKG5leHRPck9ic2VydmVyKSB8fCBlcnJvciAhPSBudWxsIHx8IGNvbXBsZXRlICE9IG51bGw7XHJcbiAgICAgICAgaWYgKGFzRnVuY3Rpb25zKSB7XHJcbiAgICAgICAgICAgIHRoaXMubmV4dCA9IG5leHRPck9ic2VydmVyO1xyXG4gICAgICAgICAgICB0aGlzLmVycm9yID0gZXJyb3IgIT09IG51bGwgJiYgZXJyb3IgIT09IHZvaWQgMCA/IGVycm9yIDogdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICB0aGlzLmNvbXBsZXRlID0gY29tcGxldGUgIT09IG51bGwgJiYgY29tcGxldGUgIT09IHZvaWQgMCA/IGNvbXBsZXRlIDogdW5kZWZpbmVkO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY29uc3Qgb2JzZXJ2ZXIgPSBuZXh0T3JPYnNlcnZlcjtcclxuICAgICAgICAgICAgdGhpcy5uZXh0ID0gb2JzZXJ2ZXIubmV4dDtcclxuICAgICAgICAgICAgdGhpcy5lcnJvciA9IG9ic2VydmVyLmVycm9yO1xyXG4gICAgICAgICAgICB0aGlzLmNvbXBsZXRlID0gb2JzZXJ2ZXIuY29tcGxldGU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBSZXR1cm5zIGEgZnVuY3Rpb24gdGhhdCBpbnZva2VzIGYgd2l0aCBpdHMgYXJndW1lbnRzIGFzeW5jaHJvbm91c2x5IGFzIGFcclxuICogbWljcm90YXNrLCBpLmUuIGFzIHNvb24gYXMgcG9zc2libGUgYWZ0ZXIgdGhlIGN1cnJlbnQgc2NyaXB0IHJldHVybnMgYmFja1xyXG4gKiBpbnRvIGJyb3dzZXIgY29kZS5cclxuICovXHJcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvYmFuLXR5cGVzXHJcbmZ1bmN0aW9uIGFzeW5jKGYpIHtcclxuICAgIHJldHVybiAoLi4uYXJnc1RvRm9yd2FyZCkgPT4ge1xyXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZmxvYXRpbmctcHJvbWlzZXNcclxuICAgICAgICBQcm9taXNlLnJlc29sdmUoKS50aGVuKCgpID0+IGYoLi4uYXJnc1RvRm9yd2FyZCkpO1xyXG4gICAgfTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogUmVwcmVzZW50cyBhIGJsb2IgYmVpbmcgdXBsb2FkZWQuIENhbiBiZSB1c2VkIHRvIHBhdXNlL3Jlc3VtZS9jYW5jZWwgdGhlXHJcbiAqIHVwbG9hZCBhbmQgbWFuYWdlIGNhbGxiYWNrcyBmb3IgdmFyaW91cyBldmVudHMuXHJcbiAqIEBpbnRlcm5hbFxyXG4gKi9cclxuY2xhc3MgVXBsb2FkVGFzayB7XHJcbiAgICAvKipcclxuICAgICAqIEBwYXJhbSByZWYgLSBUaGUgZmlyZWJhc2VTdG9yYWdlLlJlZmVyZW5jZSBvYmplY3QgdGhpcyB0YXNrIGNhbWVcclxuICAgICAqICAgICBmcm9tLCB1bnR5cGVkIHRvIGF2b2lkIGN5Y2xpYyBkZXBlbmRlbmNpZXMuXHJcbiAgICAgKiBAcGFyYW0gYmxvYiAtIFRoZSBibG9iIHRvIHVwbG9hZC5cclxuICAgICAqL1xyXG4gICAgY29uc3RydWN0b3IocmVmLCBibG9iLCBtZXRhZGF0YSA9IG51bGwpIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBOdW1iZXIgb2YgYnl0ZXMgdHJhbnNmZXJyZWQgc28gZmFyLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuX3RyYW5zZmVycmVkID0gMDtcclxuICAgICAgICB0aGlzLl9uZWVkVG9GZXRjaFN0YXR1cyA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX25lZWRUb0ZldGNoTWV0YWRhdGEgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9vYnNlcnZlcnMgPSBbXTtcclxuICAgICAgICB0aGlzLl9lcnJvciA9IHVuZGVmaW5lZDtcclxuICAgICAgICB0aGlzLl91cGxvYWRVcmwgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgdGhpcy5fcmVxdWVzdCA9IHVuZGVmaW5lZDtcclxuICAgICAgICB0aGlzLl9jaHVua011bHRpcGxpZXIgPSAxO1xyXG4gICAgICAgIHRoaXMuX3Jlc29sdmUgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgdGhpcy5fcmVqZWN0ID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIHRoaXMuX3JlZiA9IHJlZjtcclxuICAgICAgICB0aGlzLl9ibG9iID0gYmxvYjtcclxuICAgICAgICB0aGlzLl9tZXRhZGF0YSA9IG1ldGFkYXRhO1xyXG4gICAgICAgIHRoaXMuX21hcHBpbmdzID0gZ2V0TWFwcGluZ3MoKTtcclxuICAgICAgICB0aGlzLl9yZXN1bWFibGUgPSB0aGlzLl9zaG91bGREb1Jlc3VtYWJsZSh0aGlzLl9ibG9iKTtcclxuICAgICAgICB0aGlzLl9zdGF0ZSA9IFwicnVubmluZ1wiIC8qIFJVTk5JTkcgKi87XHJcbiAgICAgICAgdGhpcy5fZXJyb3JIYW5kbGVyID0gZXJyb3IgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9yZXF1ZXN0ID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICB0aGlzLl9jaHVua011bHRpcGxpZXIgPSAxO1xyXG4gICAgICAgICAgICBpZiAoZXJyb3IuX2NvZGVFcXVhbHMoXCJjYW5jZWxlZFwiIC8qIENBTkNFTEVEICovKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbmVlZFRvRmV0Y2hTdGF0dXMgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb21wbGV0ZVRyYW5zaXRpb25zXygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZXJyb3IgPSBlcnJvcjtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3RyYW5zaXRpb24oXCJlcnJvclwiIC8qIEVSUk9SICovKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5fbWV0YWRhdGFFcnJvckhhbmRsZXIgPSBlcnJvciA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX3JlcXVlc3QgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIGlmIChlcnJvci5fY29kZUVxdWFscyhcImNhbmNlbGVkXCIgLyogQ0FOQ0VMRUQgKi8pKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbXBsZXRlVHJhbnNpdGlvbnNfKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9lcnJvciA9IGVycm9yO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdHJhbnNpdGlvbihcImVycm9yXCIgLyogRVJST1IgKi8pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLl9wcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9yZXNvbHZlID0gcmVzb2x2ZTtcclxuICAgICAgICAgICAgdGhpcy5fcmVqZWN0ID0gcmVqZWN0O1xyXG4gICAgICAgICAgICB0aGlzLl9zdGFydCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vIFByZXZlbnQgdW5jYXVnaHQgcmVqZWN0aW9ucyBvbiB0aGUgaW50ZXJuYWwgcHJvbWlzZSBmcm9tIGJ1YmJsaW5nIG91dFxyXG4gICAgICAgIC8vIHRvIHRoZSB0b3AgbGV2ZWwgd2l0aCBhIGR1bW15IGhhbmRsZXIuXHJcbiAgICAgICAgdGhpcy5fcHJvbWlzZS50aGVuKG51bGwsICgpID0+IHsgfSk7XHJcbiAgICB9XHJcbiAgICBfbWFrZVByb2dyZXNzQ2FsbGJhY2soKSB7XHJcbiAgICAgICAgY29uc3Qgc2l6ZUJlZm9yZSA9IHRoaXMuX3RyYW5zZmVycmVkO1xyXG4gICAgICAgIHJldHVybiBsb2FkZWQgPT4gdGhpcy5fdXBkYXRlUHJvZ3Jlc3Moc2l6ZUJlZm9yZSArIGxvYWRlZCk7XHJcbiAgICB9XHJcbiAgICBfc2hvdWxkRG9SZXN1bWFibGUoYmxvYikge1xyXG4gICAgICAgIHJldHVybiBibG9iLnNpemUoKSA+IDI1NiAqIDEwMjQ7XHJcbiAgICB9XHJcbiAgICBfc3RhcnQoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX3N0YXRlICE9PSBcInJ1bm5pbmdcIiAvKiBSVU5OSU5HICovKSB7XHJcbiAgICAgICAgICAgIC8vIFRoaXMgY2FuIGhhcHBlbiBpZiBzb21lb25lIHBhdXNlcyB1cyBpbiBhIHJlc3VtZSBjYWxsYmFjaywgZm9yIGV4YW1wbGUuXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuX3JlcXVlc3QgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLl9yZXN1bWFibGUpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX3VwbG9hZFVybCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jcmVhdGVSZXN1bWFibGUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9uZWVkVG9GZXRjaFN0YXR1cykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2ZldGNoU3RhdHVzKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fbmVlZFRvRmV0Y2hNZXRhZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBIYXBwZW5zIGlmIHdlIG1pc3MgdGhlIG1ldGFkYXRhIG9uIHVwbG9hZCBjb21wbGV0aW9uLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9mZXRjaE1ldGFkYXRhKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb250aW51ZVVwbG9hZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fb25lU2hvdFVwbG9hZCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIF9yZXNvbHZlVG9rZW4oY2FsbGJhY2spIHtcclxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWZsb2F0aW5nLXByb21pc2VzXHJcbiAgICAgICAgUHJvbWlzZS5hbGwoW1xyXG4gICAgICAgICAgICB0aGlzLl9yZWYuc3RvcmFnZS5fZ2V0QXV0aFRva2VuKCksXHJcbiAgICAgICAgICAgIHRoaXMuX3JlZi5zdG9yYWdlLl9nZXRBcHBDaGVja1Rva2VuKClcclxuICAgICAgICBdKS50aGVuKChbYXV0aFRva2VuLCBhcHBDaGVja1Rva2VuXSkgPT4ge1xyXG4gICAgICAgICAgICBzd2l0Y2ggKHRoaXMuX3N0YXRlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwicnVubmluZ1wiIC8qIFJVTk5JTkcgKi86XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soYXV0aFRva2VuLCBhcHBDaGVja1Rva2VuKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJjYW5jZWxpbmdcIiAvKiBDQU5DRUxJTkcgKi86XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdHJhbnNpdGlvbihcImNhbmNlbGVkXCIgLyogQ0FOQ0VMRUQgKi8pO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBcInBhdXNpbmdcIiAvKiBQQVVTSU5HICovOlxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3RyYW5zaXRpb24oXCJwYXVzZWRcIiAvKiBQQVVTRUQgKi8pO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICAvLyBUT0RPKGFuZHlzb3RvKTogYXNzZXJ0IGZhbHNlXHJcbiAgICBfY3JlYXRlUmVzdW1hYmxlKCkge1xyXG4gICAgICAgIHRoaXMuX3Jlc29sdmVUb2tlbigoYXV0aFRva2VuLCBhcHBDaGVja1Rva2VuKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3RJbmZvID0gY3JlYXRlUmVzdW1hYmxlVXBsb2FkKHRoaXMuX3JlZi5zdG9yYWdlLCB0aGlzLl9yZWYuX2xvY2F0aW9uLCB0aGlzLl9tYXBwaW5ncywgdGhpcy5fYmxvYiwgdGhpcy5fbWV0YWRhdGEpO1xyXG4gICAgICAgICAgICBjb25zdCBjcmVhdGVSZXF1ZXN0ID0gdGhpcy5fcmVmLnN0b3JhZ2UuX21ha2VSZXF1ZXN0KHJlcXVlc3RJbmZvLCBhdXRoVG9rZW4sIGFwcENoZWNrVG9rZW4pO1xyXG4gICAgICAgICAgICB0aGlzLl9yZXF1ZXN0ID0gY3JlYXRlUmVxdWVzdDtcclxuICAgICAgICAgICAgY3JlYXRlUmVxdWVzdC5nZXRQcm9taXNlKCkudGhlbigodXJsKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yZXF1ZXN0ID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdXBsb2FkVXJsID0gdXJsO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbmVlZFRvRmV0Y2hTdGF0dXMgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29tcGxldGVUcmFuc2l0aW9uc18oKTtcclxuICAgICAgICAgICAgfSwgdGhpcy5fZXJyb3JIYW5kbGVyKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIF9mZXRjaFN0YXR1cygpIHtcclxuICAgICAgICAvLyBUT0RPKGFuZHlzb3RvKTogYXNzZXJ0KHRoaXMudXBsb2FkVXJsXyAhPT0gbnVsbCk7XHJcbiAgICAgICAgY29uc3QgdXJsID0gdGhpcy5fdXBsb2FkVXJsO1xyXG4gICAgICAgIHRoaXMuX3Jlc29sdmVUb2tlbigoYXV0aFRva2VuLCBhcHBDaGVja1Rva2VuKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3RJbmZvID0gZ2V0UmVzdW1hYmxlVXBsb2FkU3RhdHVzKHRoaXMuX3JlZi5zdG9yYWdlLCB0aGlzLl9yZWYuX2xvY2F0aW9uLCB1cmwsIHRoaXMuX2Jsb2IpO1xyXG4gICAgICAgICAgICBjb25zdCBzdGF0dXNSZXF1ZXN0ID0gdGhpcy5fcmVmLnN0b3JhZ2UuX21ha2VSZXF1ZXN0KHJlcXVlc3RJbmZvLCBhdXRoVG9rZW4sIGFwcENoZWNrVG9rZW4pO1xyXG4gICAgICAgICAgICB0aGlzLl9yZXF1ZXN0ID0gc3RhdHVzUmVxdWVzdDtcclxuICAgICAgICAgICAgc3RhdHVzUmVxdWVzdC5nZXRQcm9taXNlKCkudGhlbihzdGF0dXMgPT4ge1xyXG4gICAgICAgICAgICAgICAgc3RhdHVzID0gc3RhdHVzO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVxdWVzdCA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3VwZGF0ZVByb2dyZXNzKHN0YXR1cy5jdXJyZW50KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX25lZWRUb0ZldGNoU3RhdHVzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBpZiAoc3RhdHVzLmZpbmFsaXplZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX25lZWRUb0ZldGNoTWV0YWRhdGEgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5jb21wbGV0ZVRyYW5zaXRpb25zXygpO1xyXG4gICAgICAgICAgICB9LCB0aGlzLl9lcnJvckhhbmRsZXIpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgX2NvbnRpbnVlVXBsb2FkKCkge1xyXG4gICAgICAgIGNvbnN0IGNodW5rU2l6ZSA9IFJFU1VNQUJMRV9VUExPQURfQ0hVTktfU0laRSAqIHRoaXMuX2NodW5rTXVsdGlwbGllcjtcclxuICAgICAgICBjb25zdCBzdGF0dXMgPSBuZXcgUmVzdW1hYmxlVXBsb2FkU3RhdHVzKHRoaXMuX3RyYW5zZmVycmVkLCB0aGlzLl9ibG9iLnNpemUoKSk7XHJcbiAgICAgICAgLy8gVE9ETyhhbmR5c290byk6IGFzc2VydCh0aGlzLnVwbG9hZFVybF8gIT09IG51bGwpO1xyXG4gICAgICAgIGNvbnN0IHVybCA9IHRoaXMuX3VwbG9hZFVybDtcclxuICAgICAgICB0aGlzLl9yZXNvbHZlVG9rZW4oKGF1dGhUb2tlbiwgYXBwQ2hlY2tUb2tlbikgPT4ge1xyXG4gICAgICAgICAgICBsZXQgcmVxdWVzdEluZm87XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICByZXF1ZXN0SW5mbyA9IGNvbnRpbnVlUmVzdW1hYmxlVXBsb2FkKHRoaXMuX3JlZi5fbG9jYXRpb24sIHRoaXMuX3JlZi5zdG9yYWdlLCB1cmwsIHRoaXMuX2Jsb2IsIGNodW5rU2l6ZSwgdGhpcy5fbWFwcGluZ3MsIHN0YXR1cywgdGhpcy5fbWFrZVByb2dyZXNzQ2FsbGJhY2soKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2Vycm9yID0gZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3RyYW5zaXRpb24oXCJlcnJvclwiIC8qIEVSUk9SICovKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCB1cGxvYWRSZXF1ZXN0ID0gdGhpcy5fcmVmLnN0b3JhZ2UuX21ha2VSZXF1ZXN0KHJlcXVlc3RJbmZvLCBhdXRoVG9rZW4sIGFwcENoZWNrVG9rZW4pO1xyXG4gICAgICAgICAgICB0aGlzLl9yZXF1ZXN0ID0gdXBsb2FkUmVxdWVzdDtcclxuICAgICAgICAgICAgdXBsb2FkUmVxdWVzdC5nZXRQcm9taXNlKCkudGhlbigobmV3U3RhdHVzKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9pbmNyZWFzZU11bHRpcGxpZXIoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3JlcXVlc3QgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGVQcm9ncmVzcyhuZXdTdGF0dXMuY3VycmVudCk7XHJcbiAgICAgICAgICAgICAgICBpZiAobmV3U3RhdHVzLmZpbmFsaXplZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX21ldGFkYXRhID0gbmV3U3RhdHVzLm1ldGFkYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3RyYW5zaXRpb24oXCJzdWNjZXNzXCIgLyogU1VDQ0VTUyAqLyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbXBsZXRlVHJhbnNpdGlvbnNfKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIHRoaXMuX2Vycm9ySGFuZGxlcik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBfaW5jcmVhc2VNdWx0aXBsaWVyKCkge1xyXG4gICAgICAgIGNvbnN0IGN1cnJlbnRTaXplID0gUkVTVU1BQkxFX1VQTE9BRF9DSFVOS19TSVpFICogdGhpcy5fY2h1bmtNdWx0aXBsaWVyO1xyXG4gICAgICAgIC8vIE1heCBjaHVuayBzaXplIGlzIDMyTS5cclxuICAgICAgICBpZiAoY3VycmVudFNpemUgPCAzMiAqIDEwMjQgKiAxMDI0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2NodW5rTXVsdGlwbGllciAqPSAyO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIF9mZXRjaE1ldGFkYXRhKCkge1xyXG4gICAgICAgIHRoaXMuX3Jlc29sdmVUb2tlbigoYXV0aFRva2VuLCBhcHBDaGVja1Rva2VuKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3RJbmZvID0gZ2V0TWV0YWRhdGEkMih0aGlzLl9yZWYuc3RvcmFnZSwgdGhpcy5fcmVmLl9sb2NhdGlvbiwgdGhpcy5fbWFwcGluZ3MpO1xyXG4gICAgICAgICAgICBjb25zdCBtZXRhZGF0YVJlcXVlc3QgPSB0aGlzLl9yZWYuc3RvcmFnZS5fbWFrZVJlcXVlc3QocmVxdWVzdEluZm8sIGF1dGhUb2tlbiwgYXBwQ2hlY2tUb2tlbik7XHJcbiAgICAgICAgICAgIHRoaXMuX3JlcXVlc3QgPSBtZXRhZGF0YVJlcXVlc3Q7XHJcbiAgICAgICAgICAgIG1ldGFkYXRhUmVxdWVzdC5nZXRQcm9taXNlKCkudGhlbihtZXRhZGF0YSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yZXF1ZXN0ID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbWV0YWRhdGEgPSBtZXRhZGF0YTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3RyYW5zaXRpb24oXCJzdWNjZXNzXCIgLyogU1VDQ0VTUyAqLyk7XHJcbiAgICAgICAgICAgIH0sIHRoaXMuX21ldGFkYXRhRXJyb3JIYW5kbGVyKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIF9vbmVTaG90VXBsb2FkKCkge1xyXG4gICAgICAgIHRoaXMuX3Jlc29sdmVUb2tlbigoYXV0aFRva2VuLCBhcHBDaGVja1Rva2VuKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3RJbmZvID0gbXVsdGlwYXJ0VXBsb2FkKHRoaXMuX3JlZi5zdG9yYWdlLCB0aGlzLl9yZWYuX2xvY2F0aW9uLCB0aGlzLl9tYXBwaW5ncywgdGhpcy5fYmxvYiwgdGhpcy5fbWV0YWRhdGEpO1xyXG4gICAgICAgICAgICBjb25zdCBtdWx0aXBhcnRSZXF1ZXN0ID0gdGhpcy5fcmVmLnN0b3JhZ2UuX21ha2VSZXF1ZXN0KHJlcXVlc3RJbmZvLCBhdXRoVG9rZW4sIGFwcENoZWNrVG9rZW4pO1xyXG4gICAgICAgICAgICB0aGlzLl9yZXF1ZXN0ID0gbXVsdGlwYXJ0UmVxdWVzdDtcclxuICAgICAgICAgICAgbXVsdGlwYXJ0UmVxdWVzdC5nZXRQcm9taXNlKCkudGhlbihtZXRhZGF0YSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yZXF1ZXN0ID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbWV0YWRhdGEgPSBtZXRhZGF0YTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3VwZGF0ZVByb2dyZXNzKHRoaXMuX2Jsb2Iuc2l6ZSgpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3RyYW5zaXRpb24oXCJzdWNjZXNzXCIgLyogU1VDQ0VTUyAqLyk7XHJcbiAgICAgICAgICAgIH0sIHRoaXMuX2Vycm9ySGFuZGxlcik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBfdXBkYXRlUHJvZ3Jlc3ModHJhbnNmZXJyZWQpIHtcclxuICAgICAgICBjb25zdCBvbGQgPSB0aGlzLl90cmFuc2ZlcnJlZDtcclxuICAgICAgICB0aGlzLl90cmFuc2ZlcnJlZCA9IHRyYW5zZmVycmVkO1xyXG4gICAgICAgIC8vIEEgcHJvZ3Jlc3MgdXBkYXRlIGNhbiBtYWtlIHRoZSBcInRyYW5zZmVycmVkXCIgdmFsdWUgc21hbGxlciAoZS5nLiBhXHJcbiAgICAgICAgLy8gcGFydGlhbCB1cGxvYWQgbm90IGNvbXBsZXRlZCBieSBzZXJ2ZXIsIGFmdGVyIHdoaWNoIHRoZSBcInRyYW5zZmVycmVkXCJcclxuICAgICAgICAvLyB2YWx1ZSBtYXkgcmVzZXQgdG8gdGhlIHZhbHVlIGF0IHRoZSBiZWdpbm5pbmcgb2YgdGhlIHJlcXVlc3QpLlxyXG4gICAgICAgIGlmICh0aGlzLl90cmFuc2ZlcnJlZCAhPT0gb2xkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX25vdGlmeU9ic2VydmVycygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIF90cmFuc2l0aW9uKHN0YXRlKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX3N0YXRlID09PSBzdGF0ZSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHN3aXRjaCAoc3RhdGUpIHtcclxuICAgICAgICAgICAgY2FzZSBcImNhbmNlbGluZ1wiIC8qIENBTkNFTElORyAqLzpcclxuICAgICAgICAgICAgICAgIC8vIFRPRE8oYW5keXNvdG8pOlxyXG4gICAgICAgICAgICAgICAgLy8gYXNzZXJ0KHRoaXMuc3RhdGVfID09PSBJbnRlcm5hbFRhc2tTdGF0ZS5SVU5OSU5HIHx8XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgdGhpcy5zdGF0ZV8gPT09IEludGVybmFsVGFza1N0YXRlLlBBVVNJTkcpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc3RhdGUgPSBzdGF0ZTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9yZXF1ZXN0ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZXF1ZXN0LmNhbmNlbCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgXCJwYXVzaW5nXCIgLyogUEFVU0lORyAqLzpcclxuICAgICAgICAgICAgICAgIC8vIFRPRE8oYW5keXNvdG8pOlxyXG4gICAgICAgICAgICAgICAgLy8gYXNzZXJ0KHRoaXMuc3RhdGVfID09PSBJbnRlcm5hbFRhc2tTdGF0ZS5SVU5OSU5HKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3N0YXRlID0gc3RhdGU7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fcmVxdWVzdCAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVxdWVzdC5jYW5jZWwoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwicnVubmluZ1wiIC8qIFJVTk5JTkcgKi86XHJcbiAgICAgICAgICAgICAgICAvLyBUT0RPKGFuZHlzb3RvKTpcclxuICAgICAgICAgICAgICAgIC8vIGFzc2VydCh0aGlzLnN0YXRlXyA9PT0gSW50ZXJuYWxUYXNrU3RhdGUuUEFVU0VEIHx8XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgdGhpcy5zdGF0ZV8gPT09IEludGVybmFsVGFza1N0YXRlLlBBVVNJTkcpO1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgd2FzUGF1c2VkID0gdGhpcy5fc3RhdGUgPT09IFwicGF1c2VkXCIgLyogUEFVU0VEICovO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc3RhdGUgPSBzdGF0ZTtcclxuICAgICAgICAgICAgICAgIGlmICh3YXNQYXVzZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9ub3RpZnlPYnNlcnZlcnMoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGFydCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgXCJwYXVzZWRcIiAvKiBQQVVTRUQgKi86XHJcbiAgICAgICAgICAgICAgICAvLyBUT0RPKGFuZHlzb3RvKTpcclxuICAgICAgICAgICAgICAgIC8vIGFzc2VydCh0aGlzLnN0YXRlXyA9PT0gSW50ZXJuYWxUYXNrU3RhdGUuUEFVU0lORyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zdGF0ZSA9IHN0YXRlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbm90aWZ5T2JzZXJ2ZXJzKCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBcImNhbmNlbGVkXCIgLyogQ0FOQ0VMRUQgKi86XHJcbiAgICAgICAgICAgICAgICAvLyBUT0RPKGFuZHlzb3RvKTpcclxuICAgICAgICAgICAgICAgIC8vIGFzc2VydCh0aGlzLnN0YXRlXyA9PT0gSW50ZXJuYWxUYXNrU3RhdGUuUEFVU0VEIHx8XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgdGhpcy5zdGF0ZV8gPT09IEludGVybmFsVGFza1N0YXRlLkNBTkNFTElORyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9lcnJvciA9IGNhbmNlbGVkKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zdGF0ZSA9IHN0YXRlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbm90aWZ5T2JzZXJ2ZXJzKCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBcImVycm9yXCIgLyogRVJST1IgKi86XHJcbiAgICAgICAgICAgICAgICAvLyBUT0RPKGFuZHlzb3RvKTpcclxuICAgICAgICAgICAgICAgIC8vIGFzc2VydCh0aGlzLnN0YXRlXyA9PT0gSW50ZXJuYWxUYXNrU3RhdGUuUlVOTklORyB8fFxyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgIHRoaXMuc3RhdGVfID09PSBJbnRlcm5hbFRhc2tTdGF0ZS5QQVVTSU5HIHx8XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgdGhpcy5zdGF0ZV8gPT09IEludGVybmFsVGFza1N0YXRlLkNBTkNFTElORyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zdGF0ZSA9IHN0YXRlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbm90aWZ5T2JzZXJ2ZXJzKCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBcInN1Y2Nlc3NcIiAvKiBTVUNDRVNTICovOlxyXG4gICAgICAgICAgICAgICAgLy8gVE9ETyhhbmR5c290byk6XHJcbiAgICAgICAgICAgICAgICAvLyBhc3NlcnQodGhpcy5zdGF0ZV8gPT09IEludGVybmFsVGFza1N0YXRlLlJVTk5JTkcgfHxcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICB0aGlzLnN0YXRlXyA9PT0gSW50ZXJuYWxUYXNrU3RhdGUuUEFVU0lORyB8fFxyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgIHRoaXMuc3RhdGVfID09PSBJbnRlcm5hbFRhc2tTdGF0ZS5DQU5DRUxJTkcpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc3RhdGUgPSBzdGF0ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX25vdGlmeU9ic2VydmVycygpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgY29tcGxldGVUcmFuc2l0aW9uc18oKSB7XHJcbiAgICAgICAgc3dpdGNoICh0aGlzLl9zdGF0ZSkge1xyXG4gICAgICAgICAgICBjYXNlIFwicGF1c2luZ1wiIC8qIFBBVVNJTkcgKi86XHJcbiAgICAgICAgICAgICAgICB0aGlzLl90cmFuc2l0aW9uKFwicGF1c2VkXCIgLyogUEFVU0VEICovKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwiY2FuY2VsaW5nXCIgLyogQ0FOQ0VMSU5HICovOlxyXG4gICAgICAgICAgICAgICAgdGhpcy5fdHJhbnNpdGlvbihcImNhbmNlbGVkXCIgLyogQ0FOQ0VMRUQgKi8pO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgXCJydW5uaW5nXCIgLyogUlVOTklORyAqLzpcclxuICAgICAgICAgICAgICAgIHRoaXMuX3N0YXJ0KCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEEgc25hcHNob3Qgb2YgdGhlIGN1cnJlbnQgdGFzayBzdGF0ZS5cclxuICAgICAqL1xyXG4gICAgZ2V0IHNuYXBzaG90KCkge1xyXG4gICAgICAgIGNvbnN0IGV4dGVybmFsU3RhdGUgPSB0YXNrU3RhdGVGcm9tSW50ZXJuYWxUYXNrU3RhdGUodGhpcy5fc3RhdGUpO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGJ5dGVzVHJhbnNmZXJyZWQ6IHRoaXMuX3RyYW5zZmVycmVkLFxyXG4gICAgICAgICAgICB0b3RhbEJ5dGVzOiB0aGlzLl9ibG9iLnNpemUoKSxcclxuICAgICAgICAgICAgc3RhdGU6IGV4dGVybmFsU3RhdGUsXHJcbiAgICAgICAgICAgIG1ldGFkYXRhOiB0aGlzLl9tZXRhZGF0YSxcclxuICAgICAgICAgICAgdGFzazogdGhpcyxcclxuICAgICAgICAgICAgcmVmOiB0aGlzLl9yZWZcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBBZGRzIGEgY2FsbGJhY2sgZm9yIGFuIGV2ZW50LlxyXG4gICAgICogQHBhcmFtIHR5cGUgLSBUaGUgdHlwZSBvZiBldmVudCB0byBsaXN0ZW4gZm9yLlxyXG4gICAgICogQHBhcmFtIG5leHRPck9ic2VydmVyIC1cclxuICAgICAqICAgICBUaGUgYG5leHRgIGZ1bmN0aW9uLCB3aGljaCBnZXRzIGNhbGxlZCBmb3IgZWFjaCBpdGVtIGluXHJcbiAgICAgKiAgICAgdGhlIGV2ZW50IHN0cmVhbSwgb3IgYW4gb2JzZXJ2ZXIgb2JqZWN0IHdpdGggc29tZSBvciBhbGwgb2YgdGhlc2UgdGhyZWVcclxuICAgICAqICAgICBwcm9wZXJ0aWVzIChgbmV4dGAsIGBlcnJvcmAsIGBjb21wbGV0ZWApLlxyXG4gICAgICogQHBhcmFtIGVycm9yIC0gQSBmdW5jdGlvbiB0aGF0IGdldHMgY2FsbGVkIHdpdGggYSBgU3RvcmFnZUVycm9yYFxyXG4gICAgICogICAgIGlmIHRoZSBldmVudCBzdHJlYW0gZW5kcyBkdWUgdG8gYW4gZXJyb3IuXHJcbiAgICAgKiBAcGFyYW0gY29tcGxldGVkIC0gQSBmdW5jdGlvbiB0aGF0IGdldHMgY2FsbGVkIGlmIHRoZVxyXG4gICAgICogICAgIGV2ZW50IHN0cmVhbSBlbmRzIG5vcm1hbGx5LlxyXG4gICAgICogQHJldHVybnNcclxuICAgICAqICAgICBJZiBvbmx5IHRoZSBldmVudCBhcmd1bWVudCBpcyBwYXNzZWQsIHJldHVybnMgYSBmdW5jdGlvbiB5b3UgY2FuIHVzZSB0b1xyXG4gICAgICogICAgIGFkZCBjYWxsYmFja3MgKHNlZSB0aGUgZXhhbXBsZXMgYWJvdmUpLiBJZiBtb3JlIHRoYW4ganVzdCB0aGUgZXZlbnRcclxuICAgICAqICAgICBhcmd1bWVudCBpcyBwYXNzZWQsIHJldHVybnMgYSBmdW5jdGlvbiB5b3UgY2FuIGNhbGwgdG8gdW5yZWdpc3RlciB0aGVcclxuICAgICAqICAgICBjYWxsYmFja3MuXHJcbiAgICAgKi9cclxuICAgIG9uKHR5cGUsIG5leHRPck9ic2VydmVyLCBlcnJvciwgY29tcGxldGVkKSB7XHJcbiAgICAgICAgY29uc3Qgb2JzZXJ2ZXIgPSBuZXcgT2JzZXJ2ZXIobmV4dE9yT2JzZXJ2ZXIgfHwgdW5kZWZpbmVkLCBlcnJvciB8fCB1bmRlZmluZWQsIGNvbXBsZXRlZCB8fCB1bmRlZmluZWQpO1xyXG4gICAgICAgIHRoaXMuX2FkZE9ic2VydmVyKG9ic2VydmVyKTtcclxuICAgICAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9yZW1vdmVPYnNlcnZlcihvYnNlcnZlcik7XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogVGhpcyBvYmplY3QgYmVoYXZlcyBsaWtlIGEgUHJvbWlzZSwgYW5kIHJlc29sdmVzIHdpdGggaXRzIHNuYXBzaG90IGRhdGFcclxuICAgICAqIHdoZW4gdGhlIHVwbG9hZCBjb21wbGV0ZXMuXHJcbiAgICAgKiBAcGFyYW0gb25GdWxmaWxsZWQgLSBUaGUgZnVsZmlsbG1lbnQgY2FsbGJhY2suIFByb21pc2UgY2hhaW5pbmcgd29ya3MgYXMgbm9ybWFsLlxyXG4gICAgICogQHBhcmFtIG9uUmVqZWN0ZWQgLSBUaGUgcmVqZWN0aW9uIGNhbGxiYWNrLlxyXG4gICAgICovXHJcbiAgICB0aGVuKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkKSB7XHJcbiAgICAgICAgLy8gVGhlc2UgY2FzdHMgYXJlIG5lZWRlZCBzbyB0aGF0IFR5cGVTY3JpcHQgY2FuIGluZmVyIHRoZSB0eXBlcyBvZiB0aGVcclxuICAgICAgICAvLyByZXN1bHRpbmcgUHJvbWlzZS5cclxuICAgICAgICByZXR1cm4gdGhpcy5fcHJvbWlzZS50aGVuKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogRXF1aXZhbGVudCB0byBjYWxsaW5nIGB0aGVuKG51bGwsIG9uUmVqZWN0ZWQpYC5cclxuICAgICAqL1xyXG4gICAgY2F0Y2gob25SZWplY3RlZCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnRoZW4obnVsbCwgb25SZWplY3RlZCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEFkZHMgdGhlIGdpdmVuIG9ic2VydmVyLlxyXG4gICAgICovXHJcbiAgICBfYWRkT2JzZXJ2ZXIob2JzZXJ2ZXIpIHtcclxuICAgICAgICB0aGlzLl9vYnNlcnZlcnMucHVzaChvYnNlcnZlcik7XHJcbiAgICAgICAgdGhpcy5fbm90aWZ5T2JzZXJ2ZXIob2JzZXJ2ZXIpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBSZW1vdmVzIHRoZSBnaXZlbiBvYnNlcnZlci5cclxuICAgICAqL1xyXG4gICAgX3JlbW92ZU9ic2VydmVyKG9ic2VydmVyKSB7XHJcbiAgICAgICAgY29uc3QgaSA9IHRoaXMuX29ic2VydmVycy5pbmRleE9mKG9ic2VydmVyKTtcclxuICAgICAgICBpZiAoaSAhPT0gLTEpIHtcclxuICAgICAgICAgICAgdGhpcy5fb2JzZXJ2ZXJzLnNwbGljZShpLCAxKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBfbm90aWZ5T2JzZXJ2ZXJzKCkge1xyXG4gICAgICAgIHRoaXMuX2ZpbmlzaFByb21pc2UoKTtcclxuICAgICAgICBjb25zdCBvYnNlcnZlcnMgPSB0aGlzLl9vYnNlcnZlcnMuc2xpY2UoKTtcclxuICAgICAgICBvYnNlcnZlcnMuZm9yRWFjaChvYnNlcnZlciA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX25vdGlmeU9ic2VydmVyKG9ic2VydmVyKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIF9maW5pc2hQcm9taXNlKCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9yZXNvbHZlICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgbGV0IHRyaWdnZXJlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIHN3aXRjaCAodGFza1N0YXRlRnJvbUludGVybmFsVGFza1N0YXRlKHRoaXMuX3N0YXRlKSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSBUYXNrU3RhdGUuU1VDQ0VTUzpcclxuICAgICAgICAgICAgICAgICAgICBhc3luYyh0aGlzLl9yZXNvbHZlLmJpbmQobnVsbCwgdGhpcy5zbmFwc2hvdCkpKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFRhc2tTdGF0ZS5DQU5DRUxFRDpcclxuICAgICAgICAgICAgICAgIGNhc2UgVGFza1N0YXRlLkVSUk9SOlxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRvQ2FsbCA9IHRoaXMuX3JlamVjdDtcclxuICAgICAgICAgICAgICAgICAgICBhc3luYyh0b0NhbGwuYmluZChudWxsLCB0aGlzLl9lcnJvcikpKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIHRyaWdnZXJlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0cmlnZ2VyZWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3Jlc29sdmUgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yZWplY3QgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBfbm90aWZ5T2JzZXJ2ZXIob2JzZXJ2ZXIpIHtcclxuICAgICAgICBjb25zdCBleHRlcm5hbFN0YXRlID0gdGFza1N0YXRlRnJvbUludGVybmFsVGFza1N0YXRlKHRoaXMuX3N0YXRlKTtcclxuICAgICAgICBzd2l0Y2ggKGV4dGVybmFsU3RhdGUpIHtcclxuICAgICAgICAgICAgY2FzZSBUYXNrU3RhdGUuUlVOTklORzpcclxuICAgICAgICAgICAgY2FzZSBUYXNrU3RhdGUuUEFVU0VEOlxyXG4gICAgICAgICAgICAgICAgaWYgKG9ic2VydmVyLm5leHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBhc3luYyhvYnNlcnZlci5uZXh0LmJpbmQob2JzZXJ2ZXIsIHRoaXMuc25hcHNob3QpKSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgVGFza1N0YXRlLlNVQ0NFU1M6XHJcbiAgICAgICAgICAgICAgICBpZiAob2JzZXJ2ZXIuY29tcGxldGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBhc3luYyhvYnNlcnZlci5jb21wbGV0ZS5iaW5kKG9ic2VydmVyKSkoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFRhc2tTdGF0ZS5DQU5DRUxFRDpcclxuICAgICAgICAgICAgY2FzZSBUYXNrU3RhdGUuRVJST1I6XHJcbiAgICAgICAgICAgICAgICBpZiAob2JzZXJ2ZXIuZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICBhc3luYyhvYnNlcnZlci5lcnJvci5iaW5kKG9ic2VydmVyLCB0aGlzLl9lcnJvcikpKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIC8vIFRPRE8oYW5keXNvdG8pOiBhc3NlcnQoZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgaWYgKG9ic2VydmVyLmVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXN5bmMob2JzZXJ2ZXIuZXJyb3IuYmluZChvYnNlcnZlciwgdGhpcy5fZXJyb3IpKSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUmVzdW1lcyBhIHBhdXNlZCB0YXNrLiBIYXMgbm8gZWZmZWN0IG9uIGEgY3VycmVudGx5IHJ1bm5pbmcgb3IgZmFpbGVkIHRhc2suXHJcbiAgICAgKiBAcmV0dXJucyBUcnVlIGlmIHRoZSBvcGVyYXRpb24gdG9vayBlZmZlY3QsIGZhbHNlIGlmIGlnbm9yZWQuXHJcbiAgICAgKi9cclxuICAgIHJlc3VtZSgpIHtcclxuICAgICAgICBjb25zdCB2YWxpZCA9IHRoaXMuX3N0YXRlID09PSBcInBhdXNlZFwiIC8qIFBBVVNFRCAqLyB8fFxyXG4gICAgICAgICAgICB0aGlzLl9zdGF0ZSA9PT0gXCJwYXVzaW5nXCIgLyogUEFVU0lORyAqLztcclxuICAgICAgICBpZiAodmFsaWQpIHtcclxuICAgICAgICAgICAgdGhpcy5fdHJhbnNpdGlvbihcInJ1bm5pbmdcIiAvKiBSVU5OSU5HICovKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHZhbGlkO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBQYXVzZXMgYSBjdXJyZW50bHkgcnVubmluZyB0YXNrLiBIYXMgbm8gZWZmZWN0IG9uIGEgcGF1c2VkIG9yIGZhaWxlZCB0YXNrLlxyXG4gICAgICogQHJldHVybnMgVHJ1ZSBpZiB0aGUgb3BlcmF0aW9uIHRvb2sgZWZmZWN0LCBmYWxzZSBpZiBpZ25vcmVkLlxyXG4gICAgICovXHJcbiAgICBwYXVzZSgpIHtcclxuICAgICAgICBjb25zdCB2YWxpZCA9IHRoaXMuX3N0YXRlID09PSBcInJ1bm5pbmdcIiAvKiBSVU5OSU5HICovO1xyXG4gICAgICAgIGlmICh2YWxpZCkge1xyXG4gICAgICAgICAgICB0aGlzLl90cmFuc2l0aW9uKFwicGF1c2luZ1wiIC8qIFBBVVNJTkcgKi8pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdmFsaWQ7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIENhbmNlbHMgYSBjdXJyZW50bHkgcnVubmluZyBvciBwYXVzZWQgdGFzay4gSGFzIG5vIGVmZmVjdCBvbiBhIGNvbXBsZXRlIG9yXHJcbiAgICAgKiBmYWlsZWQgdGFzay5cclxuICAgICAqIEByZXR1cm5zIFRydWUgaWYgdGhlIG9wZXJhdGlvbiB0b29rIGVmZmVjdCwgZmFsc2UgaWYgaWdub3JlZC5cclxuICAgICAqL1xyXG4gICAgY2FuY2VsKCkge1xyXG4gICAgICAgIGNvbnN0IHZhbGlkID0gdGhpcy5fc3RhdGUgPT09IFwicnVubmluZ1wiIC8qIFJVTk5JTkcgKi8gfHxcclxuICAgICAgICAgICAgdGhpcy5fc3RhdGUgPT09IFwicGF1c2luZ1wiIC8qIFBBVVNJTkcgKi87XHJcbiAgICAgICAgaWYgKHZhbGlkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3RyYW5zaXRpb24oXCJjYW5jZWxpbmdcIiAvKiBDQU5DRUxJTkcgKi8pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdmFsaWQ7XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFByb3ZpZGVzIG1ldGhvZHMgdG8gaW50ZXJhY3Qgd2l0aCBhIGJ1Y2tldCBpbiB0aGUgRmlyZWJhc2UgU3RvcmFnZSBzZXJ2aWNlLlxyXG4gKiBAaW50ZXJuYWxcclxuICogQHBhcmFtIF9sb2NhdGlvbiAtIEFuIGZicy5sb2NhdGlvbiwgb3IgdGhlIFVSTCBhdFxyXG4gKiAgICAgd2hpY2ggdG8gYmFzZSB0aGlzIG9iamVjdCwgaW4gb25lIG9mIHRoZSBmb2xsb3dpbmcgZm9ybXM6XHJcbiAqICAgICAgICAgZ3M6Ly88YnVja2V0Pi88b2JqZWN0LXBhdGg+XHJcbiAqICAgICAgICAgaHR0cFtzXTovL2ZpcmViYXNlc3RvcmFnZS5nb29nbGVhcGlzLmNvbS9cclxuICogICAgICAgICAgICAgICAgICAgICA8YXBpLXZlcnNpb24+L2IvPGJ1Y2tldD4vby88b2JqZWN0LXBhdGg+XHJcbiAqICAgICBBbnkgcXVlcnkgb3IgZnJhZ21lbnQgc3RyaW5ncyB3aWxsIGJlIGlnbm9yZWQgaW4gdGhlIGh0dHBbc11cclxuICogICAgIGZvcm1hdC4gSWYgbm8gdmFsdWUgaXMgcGFzc2VkLCB0aGUgc3RvcmFnZSBvYmplY3Qgd2lsbCB1c2UgYSBVUkwgYmFzZWQgb25cclxuICogICAgIHRoZSBwcm9qZWN0IElEIG9mIHRoZSBiYXNlIGZpcmViYXNlLkFwcCBpbnN0YW5jZS5cclxuICovXHJcbmNsYXNzIFJlZmVyZW5jZSB7XHJcbiAgICBjb25zdHJ1Y3Rvcihfc2VydmljZSwgbG9jYXRpb24pIHtcclxuICAgICAgICB0aGlzLl9zZXJ2aWNlID0gX3NlcnZpY2U7XHJcbiAgICAgICAgaWYgKGxvY2F0aW9uIGluc3RhbmNlb2YgTG9jYXRpb24pIHtcclxuICAgICAgICAgICAgdGhpcy5fbG9jYXRpb24gPSBsb2NhdGlvbjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2xvY2F0aW9uID0gTG9jYXRpb24ubWFrZUZyb21VcmwobG9jYXRpb24sIF9zZXJ2aWNlLmhvc3QpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0aGUgVVJMIGZvciB0aGUgYnVja2V0IGFuZCBwYXRoIHRoaXMgb2JqZWN0IHJlZmVyZW5jZXMsXHJcbiAgICAgKiAgICAgaW4gdGhlIGZvcm0gZ3M6Ly88YnVja2V0Pi88b2JqZWN0LXBhdGg+XHJcbiAgICAgKiBAb3ZlcnJpZGVcclxuICAgICAqL1xyXG4gICAgdG9TdHJpbmcoKSB7XHJcbiAgICAgICAgcmV0dXJuICdnczovLycgKyB0aGlzLl9sb2NhdGlvbi5idWNrZXQgKyAnLycgKyB0aGlzLl9sb2NhdGlvbi5wYXRoO1xyXG4gICAgfVxyXG4gICAgX25ld1JlZihzZXJ2aWNlLCBsb2NhdGlvbikge1xyXG4gICAgICAgIHJldHVybiBuZXcgUmVmZXJlbmNlKHNlcnZpY2UsIGxvY2F0aW9uKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQSByZWZlcmVuY2UgdG8gdGhlIHJvb3Qgb2YgdGhpcyBvYmplY3QncyBidWNrZXQuXHJcbiAgICAgKi9cclxuICAgIGdldCByb290KCkge1xyXG4gICAgICAgIGNvbnN0IGxvY2F0aW9uID0gbmV3IExvY2F0aW9uKHRoaXMuX2xvY2F0aW9uLmJ1Y2tldCwgJycpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9uZXdSZWYodGhpcy5fc2VydmljZSwgbG9jYXRpb24pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgbmFtZSBvZiB0aGUgYnVja2V0IGNvbnRhaW5pbmcgdGhpcyByZWZlcmVuY2UncyBvYmplY3QuXHJcbiAgICAgKi9cclxuICAgIGdldCBidWNrZXQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xvY2F0aW9uLmJ1Y2tldDtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogVGhlIGZ1bGwgcGF0aCBvZiB0aGlzIG9iamVjdC5cclxuICAgICAqL1xyXG4gICAgZ2V0IGZ1bGxQYXRoKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9sb2NhdGlvbi5wYXRoO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgc2hvcnQgbmFtZSBvZiB0aGlzIG9iamVjdCwgd2hpY2ggaXMgdGhlIGxhc3QgY29tcG9uZW50IG9mIHRoZSBmdWxsIHBhdGguXHJcbiAgICAgKiBGb3IgZXhhbXBsZSwgaWYgZnVsbFBhdGggaXMgJ2Z1bGwvcGF0aC9pbWFnZS5wbmcnLCBuYW1lIGlzICdpbWFnZS5wbmcnLlxyXG4gICAgICovXHJcbiAgICBnZXQgbmFtZSgpIHtcclxuICAgICAgICByZXR1cm4gbGFzdENvbXBvbmVudCh0aGlzLl9sb2NhdGlvbi5wYXRoKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogVGhlIGBTdG9yYWdlU2VydmljZWAgaW5zdGFuY2UgdGhpcyBgU3RvcmFnZVJlZmVyZW5jZWAgaXMgYXNzb2NpYXRlZCB3aXRoLlxyXG4gICAgICovXHJcbiAgICBnZXQgc3RvcmFnZSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fc2VydmljZTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQSBgU3RvcmFnZVJlZmVyZW5jZWAgcG9pbnRpbmcgdG8gdGhlIHBhcmVudCBsb2NhdGlvbiBvZiB0aGlzIGBTdG9yYWdlUmVmZXJlbmNlYCwgb3IgbnVsbCBpZlxyXG4gICAgICogdGhpcyByZWZlcmVuY2UgaXMgdGhlIHJvb3QuXHJcbiAgICAgKi9cclxuICAgIGdldCBwYXJlbnQoKSB7XHJcbiAgICAgICAgY29uc3QgbmV3UGF0aCA9IHBhcmVudCh0aGlzLl9sb2NhdGlvbi5wYXRoKTtcclxuICAgICAgICBpZiAobmV3UGF0aCA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgbG9jYXRpb24gPSBuZXcgTG9jYXRpb24odGhpcy5fbG9jYXRpb24uYnVja2V0LCBuZXdQYXRoKTtcclxuICAgICAgICByZXR1cm4gbmV3IFJlZmVyZW5jZSh0aGlzLl9zZXJ2aWNlLCBsb2NhdGlvbik7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFV0aWxpdHkgZnVuY3Rpb24gdG8gdGhyb3cgYW4gZXJyb3IgaW4gbWV0aG9kcyB0aGF0IGRvIG5vdCBhY2NlcHQgYSByb290IHJlZmVyZW5jZS5cclxuICAgICAqL1xyXG4gICAgX3Rocm93SWZSb290KG5hbWUpIHtcclxuICAgICAgICBpZiAodGhpcy5fbG9jYXRpb24ucGF0aCA9PT0gJycpIHtcclxuICAgICAgICAgICAgdGhyb3cgaW52YWxpZFJvb3RPcGVyYXRpb24obmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBVcGxvYWRzIGRhdGEgdG8gdGhpcyBvYmplY3QncyBsb2NhdGlvbi5cclxuICogVGhlIHVwbG9hZCBpcyBub3QgcmVzdW1hYmxlLlxyXG4gKlxyXG4gKiBAcGFyYW0gcmVmIC0gU3RvcmFnZVJlZmVyZW5jZSB3aGVyZSBkYXRhIHNob3VsZCBiZSB1cGxvYWRlZC5cclxuICogQHBhcmFtIGRhdGEgLSBUaGUgZGF0YSB0byB1cGxvYWQuXHJcbiAqIEBwYXJhbSBtZXRhZGF0YSAtIE1ldGFkYXRhIGZvciB0aGUgbmV3bHkgdXBsb2FkZWQgZGF0YS5cclxuICogQHJldHVybnMgQSBQcm9taXNlIGNvbnRhaW5pbmcgYW4gVXBsb2FkUmVzdWx0XHJcbiAqL1xyXG5mdW5jdGlvbiB1cGxvYWRCeXRlcyQxKHJlZiwgZGF0YSwgbWV0YWRhdGEpIHtcclxuICAgIHJlZi5fdGhyb3dJZlJvb3QoJ3VwbG9hZEJ5dGVzJyk7XHJcbiAgICBjb25zdCByZXF1ZXN0SW5mbyA9IG11bHRpcGFydFVwbG9hZChyZWYuc3RvcmFnZSwgcmVmLl9sb2NhdGlvbiwgZ2V0TWFwcGluZ3MoKSwgbmV3IEZic0Jsb2IoZGF0YSwgdHJ1ZSksIG1ldGFkYXRhKTtcclxuICAgIHJldHVybiByZWYuc3RvcmFnZVxyXG4gICAgICAgIC5tYWtlUmVxdWVzdFdpdGhUb2tlbnMocmVxdWVzdEluZm8pXHJcbiAgICAgICAgLnRoZW4ocmVxdWVzdCA9PiByZXF1ZXN0LmdldFByb21pc2UoKSlcclxuICAgICAgICAudGhlbihmaW5hbE1ldGFkYXRhID0+IHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBtZXRhZGF0YTogZmluYWxNZXRhZGF0YSxcclxuICAgICAgICAgICAgcmVmXHJcbiAgICAgICAgfTtcclxuICAgIH0pO1xyXG59XHJcbi8qKlxyXG4gKiBVcGxvYWRzIGRhdGEgdG8gdGhpcyBvYmplY3QncyBsb2NhdGlvbi5cclxuICogVGhlIHVwbG9hZCBjYW4gYmUgcGF1c2VkIGFuZCByZXN1bWVkLCBhbmQgZXhwb3NlcyBwcm9ncmVzcyB1cGRhdGVzLlxyXG4gKiBAcHVibGljXHJcbiAqIEBwYXJhbSByZWYgLSBTdG9yYWdlUmVmZXJlbmNlIHdoZXJlIGRhdGEgc2hvdWxkIGJlIHVwbG9hZGVkLlxyXG4gKiBAcGFyYW0gZGF0YSAtIFRoZSBkYXRhIHRvIHVwbG9hZC5cclxuICogQHBhcmFtIG1ldGFkYXRhIC0gTWV0YWRhdGEgZm9yIHRoZSBuZXdseSB1cGxvYWRlZCBkYXRhLlxyXG4gKiBAcmV0dXJucyBBbiBVcGxvYWRUYXNrXHJcbiAqL1xyXG5mdW5jdGlvbiB1cGxvYWRCeXRlc1Jlc3VtYWJsZSQxKHJlZiwgZGF0YSwgbWV0YWRhdGEpIHtcclxuICAgIHJlZi5fdGhyb3dJZlJvb3QoJ3VwbG9hZEJ5dGVzUmVzdW1hYmxlJyk7XHJcbiAgICByZXR1cm4gbmV3IFVwbG9hZFRhc2socmVmLCBuZXcgRmJzQmxvYihkYXRhKSwgbWV0YWRhdGEpO1xyXG59XHJcbi8qKlxyXG4gKiBVcGxvYWRzIGEgc3RyaW5nIHRvIHRoaXMgb2JqZWN0J3MgbG9jYXRpb24uXHJcbiAqIFRoZSB1cGxvYWQgaXMgbm90IHJlc3VtYWJsZS5cclxuICogQHB1YmxpY1xyXG4gKiBAcGFyYW0gcmVmIC0gU3RvcmFnZVJlZmVyZW5jZSB3aGVyZSBzdHJpbmcgc2hvdWxkIGJlIHVwbG9hZGVkLlxyXG4gKiBAcGFyYW0gdmFsdWUgLSBUaGUgc3RyaW5nIHRvIHVwbG9hZC5cclxuICogQHBhcmFtIGZvcm1hdCAtIFRoZSBmb3JtYXQgb2YgdGhlIHN0cmluZyB0byB1cGxvYWQuXHJcbiAqIEBwYXJhbSBtZXRhZGF0YSAtIE1ldGFkYXRhIGZvciB0aGUgbmV3bHkgdXBsb2FkZWQgc3RyaW5nLlxyXG4gKiBAcmV0dXJucyBBIFByb21pc2UgY29udGFpbmluZyBhbiBVcGxvYWRSZXN1bHRcclxuICovXHJcbmZ1bmN0aW9uIHVwbG9hZFN0cmluZyQxKHJlZiwgdmFsdWUsIGZvcm1hdCA9IFN0cmluZ0Zvcm1hdC5SQVcsIG1ldGFkYXRhKSB7XHJcbiAgICByZWYuX3Rocm93SWZSb290KCd1cGxvYWRTdHJpbmcnKTtcclxuICAgIGNvbnN0IGRhdGEgPSBkYXRhRnJvbVN0cmluZyhmb3JtYXQsIHZhbHVlKTtcclxuICAgIGNvbnN0IG1ldGFkYXRhQ2xvbmUgPSBPYmplY3QuYXNzaWduKHt9LCBtZXRhZGF0YSk7XHJcbiAgICBpZiAobWV0YWRhdGFDbG9uZVsnY29udGVudFR5cGUnXSA9PSBudWxsICYmIGRhdGEuY29udGVudFR5cGUgIT0gbnVsbCkge1xyXG4gICAgICAgIG1ldGFkYXRhQ2xvbmVbJ2NvbnRlbnRUeXBlJ10gPSBkYXRhLmNvbnRlbnRUeXBlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHVwbG9hZEJ5dGVzJDEocmVmLCBkYXRhLmRhdGEsIG1ldGFkYXRhQ2xvbmUpO1xyXG59XHJcbi8qKlxyXG4gKiBMaXN0IGFsbCBpdGVtcyAoZmlsZXMpIGFuZCBwcmVmaXhlcyAoZm9sZGVycykgdW5kZXIgdGhpcyBzdG9yYWdlIHJlZmVyZW5jZS5cclxuICpcclxuICogVGhpcyBpcyBhIGhlbHBlciBtZXRob2QgZm9yIGNhbGxpbmcgbGlzdCgpIHJlcGVhdGVkbHkgdW50aWwgdGhlcmUgYXJlXHJcbiAqIG5vIG1vcmUgcmVzdWx0cy4gVGhlIGRlZmF1bHQgcGFnaW5hdGlvbiBzaXplIGlzIDEwMDAuXHJcbiAqXHJcbiAqIE5vdGU6IFRoZSByZXN1bHRzIG1heSBub3QgYmUgY29uc2lzdGVudCBpZiBvYmplY3RzIGFyZSBjaGFuZ2VkIHdoaWxlIHRoaXNcclxuICogb3BlcmF0aW9uIGlzIHJ1bm5pbmcuXHJcbiAqXHJcbiAqIFdhcm5pbmc6IGxpc3RBbGwgbWF5IHBvdGVudGlhbGx5IGNvbnN1bWUgdG9vIG1hbnkgcmVzb3VyY2VzIGlmIHRoZXJlIGFyZVxyXG4gKiB0b28gbWFueSByZXN1bHRzLlxyXG4gKiBAcHVibGljXHJcbiAqIEBwYXJhbSByZWYgLSBTdG9yYWdlUmVmZXJlbmNlIHRvIGdldCBsaXN0IGZyb20uXHJcbiAqXHJcbiAqIEByZXR1cm5zIEEgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHdpdGggYWxsIHRoZSBpdGVtcyBhbmQgcHJlZml4ZXMgdW5kZXJcclxuICogICAgICB0aGUgY3VycmVudCBzdG9yYWdlIHJlZmVyZW5jZS4gYHByZWZpeGVzYCBjb250YWlucyByZWZlcmVuY2VzIHRvXHJcbiAqICAgICAgc3ViLWRpcmVjdG9yaWVzIGFuZCBgaXRlbXNgIGNvbnRhaW5zIHJlZmVyZW5jZXMgdG8gb2JqZWN0cyBpbiB0aGlzXHJcbiAqICAgICAgZm9sZGVyLiBgbmV4dFBhZ2VUb2tlbmAgaXMgbmV2ZXIgcmV0dXJuZWQuXHJcbiAqL1xyXG5mdW5jdGlvbiBsaXN0QWxsJDEocmVmKSB7XHJcbiAgICBjb25zdCBhY2N1bXVsYXRvciA9IHtcclxuICAgICAgICBwcmVmaXhlczogW10sXHJcbiAgICAgICAgaXRlbXM6IFtdXHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIGxpc3RBbGxIZWxwZXIocmVmLCBhY2N1bXVsYXRvcikudGhlbigoKSA9PiBhY2N1bXVsYXRvcik7XHJcbn1cclxuLyoqXHJcbiAqIFNlcGFyYXRlZCBmcm9tIGxpc3RBbGwgYmVjYXVzZSBhc3luYyBmdW5jdGlvbnMgY2FuJ3QgdXNlIFwiYXJndW1lbnRzXCIuXHJcbiAqIEBwYXJhbSByZWZcclxuICogQHBhcmFtIGFjY3VtdWxhdG9yXHJcbiAqIEBwYXJhbSBwYWdlVG9rZW5cclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIGxpc3RBbGxIZWxwZXIocmVmLCBhY2N1bXVsYXRvciwgcGFnZVRva2VuKSB7XHJcbiAgICBjb25zdCBvcHQgPSB7XHJcbiAgICAgICAgLy8gbWF4UmVzdWx0cyBpcyAxMDAwIGJ5IGRlZmF1bHQuXHJcbiAgICAgICAgcGFnZVRva2VuXHJcbiAgICB9O1xyXG4gICAgY29uc3QgbmV4dFBhZ2UgPSBhd2FpdCBsaXN0JDEocmVmLCBvcHQpO1xyXG4gICAgYWNjdW11bGF0b3IucHJlZml4ZXMucHVzaCguLi5uZXh0UGFnZS5wcmVmaXhlcyk7XHJcbiAgICBhY2N1bXVsYXRvci5pdGVtcy5wdXNoKC4uLm5leHRQYWdlLml0ZW1zKTtcclxuICAgIGlmIChuZXh0UGFnZS5uZXh0UGFnZVRva2VuICE9IG51bGwpIHtcclxuICAgICAgICBhd2FpdCBsaXN0QWxsSGVscGVyKHJlZiwgYWNjdW11bGF0b3IsIG5leHRQYWdlLm5leHRQYWdlVG9rZW4pO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBMaXN0IGl0ZW1zIChmaWxlcykgYW5kIHByZWZpeGVzIChmb2xkZXJzKSB1bmRlciB0aGlzIHN0b3JhZ2UgcmVmZXJlbmNlLlxyXG4gKlxyXG4gKiBMaXN0IEFQSSBpcyBvbmx5IGF2YWlsYWJsZSBmb3IgRmlyZWJhc2UgUnVsZXMgVmVyc2lvbiAyLlxyXG4gKlxyXG4gKiBHQ1MgaXMgYSBrZXktYmxvYiBzdG9yZS4gRmlyZWJhc2UgU3RvcmFnZSBpbXBvc2VzIHRoZSBzZW1hbnRpYyBvZiAnLydcclxuICogZGVsaW1pdGVkIGZvbGRlciBzdHJ1Y3R1cmUuXHJcbiAqIFJlZmVyIHRvIEdDUydzIExpc3QgQVBJIGlmIHlvdSB3YW50IHRvIGxlYXJuIG1vcmUuXHJcbiAqXHJcbiAqIFRvIGFkaGVyZSB0byBGaXJlYmFzZSBSdWxlcydzIFNlbWFudGljcywgRmlyZWJhc2UgU3RvcmFnZSBkb2VzIG5vdFxyXG4gKiBzdXBwb3J0IG9iamVjdHMgd2hvc2UgcGF0aHMgZW5kIHdpdGggXCIvXCIgb3IgY29udGFpbiB0d28gY29uc2VjdXRpdmVcclxuICogXCIvXCJzLiBGaXJlYmFzZSBTdG9yYWdlIExpc3QgQVBJIHdpbGwgZmlsdGVyIHRoZXNlIHVuc3VwcG9ydGVkIG9iamVjdHMuXHJcbiAqIGxpc3QoKSBtYXkgZmFpbCBpZiB0aGVyZSBhcmUgdG9vIG1hbnkgdW5zdXBwb3J0ZWQgb2JqZWN0cyBpbiB0aGUgYnVja2V0LlxyXG4gKiBAcHVibGljXHJcbiAqXHJcbiAqIEBwYXJhbSByZWYgLSBTdG9yYWdlUmVmZXJlbmNlIHRvIGdldCBsaXN0IGZyb20uXHJcbiAqIEBwYXJhbSBvcHRpb25zIC0gU2VlIExpc3RPcHRpb25zIGZvciBkZXRhaWxzLlxyXG4gKiBAcmV0dXJucyBBIFByb21pc2UgdGhhdCByZXNvbHZlcyB3aXRoIHRoZSBpdGVtcyBhbmQgcHJlZml4ZXMuXHJcbiAqICAgICAgYHByZWZpeGVzYCBjb250YWlucyByZWZlcmVuY2VzIHRvIHN1Yi1mb2xkZXJzIGFuZCBgaXRlbXNgXHJcbiAqICAgICAgY29udGFpbnMgcmVmZXJlbmNlcyB0byBvYmplY3RzIGluIHRoaXMgZm9sZGVyLiBgbmV4dFBhZ2VUb2tlbmBcclxuICogICAgICBjYW4gYmUgdXNlZCB0byBnZXQgdGhlIHJlc3Qgb2YgdGhlIHJlc3VsdHMuXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBsaXN0JDEocmVmLCBvcHRpb25zKSB7XHJcbiAgICBpZiAob3B0aW9ucyAhPSBudWxsKSB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBvcHRpb25zLm1heFJlc3VsdHMgPT09ICdudW1iZXInKSB7XHJcbiAgICAgICAgICAgIHZhbGlkYXRlTnVtYmVyKCdvcHRpb25zLm1heFJlc3VsdHMnLCBcclxuICAgICAgICAgICAgLyogbWluVmFsdWU9ICovIDEsIFxyXG4gICAgICAgICAgICAvKiBtYXhWYWx1ZT0gKi8gMTAwMCwgb3B0aW9ucy5tYXhSZXN1bHRzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBjb25zdCBvcCA9IG9wdGlvbnMgfHwge307XHJcbiAgICBjb25zdCByZXF1ZXN0SW5mbyA9IGxpc3QkMihyZWYuc3RvcmFnZSwgcmVmLl9sb2NhdGlvbiwgXHJcbiAgICAvKmRlbGltaXRlcj0gKi8gJy8nLCBvcC5wYWdlVG9rZW4sIG9wLm1heFJlc3VsdHMpO1xyXG4gICAgcmV0dXJuIChhd2FpdCByZWYuc3RvcmFnZS5tYWtlUmVxdWVzdFdpdGhUb2tlbnMocmVxdWVzdEluZm8pKS5nZXRQcm9taXNlKCk7XHJcbn1cclxuLyoqXHJcbiAqIEEgYFByb21pc2VgIHRoYXQgcmVzb2x2ZXMgd2l0aCB0aGUgbWV0YWRhdGEgZm9yIHRoaXMgb2JqZWN0LiBJZiB0aGlzXHJcbiAqIG9iamVjdCBkb2Vzbid0IGV4aXN0IG9yIG1ldGFkYXRhIGNhbm5vdCBiZSByZXRyZWl2ZWQsIHRoZSBwcm9taXNlIGlzXHJcbiAqIHJlamVjdGVkLlxyXG4gKiBAcHVibGljXHJcbiAqIEBwYXJhbSByZWYgLSBTdG9yYWdlUmVmZXJlbmNlIHRvIGdldCBtZXRhZGF0YSBmcm9tLlxyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gZ2V0TWV0YWRhdGEkMShyZWYpIHtcclxuICAgIHJlZi5fdGhyb3dJZlJvb3QoJ2dldE1ldGFkYXRhJyk7XHJcbiAgICBjb25zdCByZXF1ZXN0SW5mbyA9IGdldE1ldGFkYXRhJDIocmVmLnN0b3JhZ2UsIHJlZi5fbG9jYXRpb24sIGdldE1hcHBpbmdzKCkpO1xyXG4gICAgcmV0dXJuIChhd2FpdCByZWYuc3RvcmFnZS5tYWtlUmVxdWVzdFdpdGhUb2tlbnMocmVxdWVzdEluZm8pKS5nZXRQcm9taXNlKCk7XHJcbn1cclxuLyoqXHJcbiAqIFVwZGF0ZXMgdGhlIG1ldGFkYXRhIGZvciB0aGlzIG9iamVjdC5cclxuICogQHB1YmxpY1xyXG4gKiBAcGFyYW0gcmVmIC0gU3RvcmFnZVJlZmVyZW5jZSB0byB1cGRhdGUgbWV0YWRhdGEgZm9yLlxyXG4gKiBAcGFyYW0gbWV0YWRhdGEgLSBUaGUgbmV3IG1ldGFkYXRhIGZvciB0aGUgb2JqZWN0LlxyXG4gKiAgICAgT25seSB2YWx1ZXMgdGhhdCBoYXZlIGJlZW4gZXhwbGljaXRseSBzZXQgd2lsbCBiZSBjaGFuZ2VkLiBFeHBsaWNpdGx5XHJcbiAqICAgICBzZXR0aW5nIGEgdmFsdWUgdG8gbnVsbCB3aWxsIHJlbW92ZSB0aGUgbWV0YWRhdGEuXHJcbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHRoYXQgcmVzb2x2ZXNcclxuICogICAgIHdpdGggdGhlIG5ldyBtZXRhZGF0YSBmb3IgdGhpcyBvYmplY3QuXHJcbiAqICAgICBTZWUgYGZpcmViYXNlU3RvcmFnZS5SZWZlcmVuY2UucHJvdG90eXBlLmdldE1ldGFkYXRhYFxyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gdXBkYXRlTWV0YWRhdGEkMShyZWYsIG1ldGFkYXRhKSB7XHJcbiAgICByZWYuX3Rocm93SWZSb290KCd1cGRhdGVNZXRhZGF0YScpO1xyXG4gICAgY29uc3QgcmVxdWVzdEluZm8gPSB1cGRhdGVNZXRhZGF0YSQyKHJlZi5zdG9yYWdlLCByZWYuX2xvY2F0aW9uLCBtZXRhZGF0YSwgZ2V0TWFwcGluZ3MoKSk7XHJcbiAgICByZXR1cm4gKGF3YWl0IHJlZi5zdG9yYWdlLm1ha2VSZXF1ZXN0V2l0aFRva2VucyhyZXF1ZXN0SW5mbykpLmdldFByb21pc2UoKTtcclxufVxyXG4vKipcclxuICogUmV0dXJucyB0aGUgZG93bmxvYWQgVVJMIGZvciB0aGUgZ2l2ZW4gUmVmZXJlbmNlLlxyXG4gKiBAcHVibGljXHJcbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHRoYXQgcmVzb2x2ZXMgd2l0aCB0aGUgZG93bmxvYWRcclxuICogICAgIFVSTCBmb3IgdGhpcyBvYmplY3QuXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBnZXREb3dubG9hZFVSTCQxKHJlZikge1xyXG4gICAgcmVmLl90aHJvd0lmUm9vdCgnZ2V0RG93bmxvYWRVUkwnKTtcclxuICAgIGNvbnN0IHJlcXVlc3RJbmZvID0gZ2V0RG93bmxvYWRVcmwocmVmLnN0b3JhZ2UsIHJlZi5fbG9jYXRpb24sIGdldE1hcHBpbmdzKCkpO1xyXG4gICAgcmV0dXJuIChhd2FpdCByZWYuc3RvcmFnZS5tYWtlUmVxdWVzdFdpdGhUb2tlbnMocmVxdWVzdEluZm8pKVxyXG4gICAgICAgIC5nZXRQcm9taXNlKClcclxuICAgICAgICAudGhlbih1cmwgPT4ge1xyXG4gICAgICAgIGlmICh1cmwgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgdGhyb3cgbm9Eb3dubG9hZFVSTCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdXJsO1xyXG4gICAgfSk7XHJcbn1cclxuLyoqXHJcbiAqIERlbGV0ZXMgdGhlIG9iamVjdCBhdCB0aGlzIGxvY2F0aW9uLlxyXG4gKiBAcHVibGljXHJcbiAqIEBwYXJhbSByZWYgLSBTdG9yYWdlUmVmZXJlbmNlIGZvciBvYmplY3QgdG8gZGVsZXRlLlxyXG4gKiBAcmV0dXJucyBBIGBQcm9taXNlYCB0aGF0IHJlc29sdmVzIGlmIHRoZSBkZWxldGlvbiBzdWNjZWVkcy5cclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIGRlbGV0ZU9iamVjdCQxKHJlZikge1xyXG4gICAgcmVmLl90aHJvd0lmUm9vdCgnZGVsZXRlT2JqZWN0Jyk7XHJcbiAgICBjb25zdCByZXF1ZXN0SW5mbyA9IGRlbGV0ZU9iamVjdCQyKHJlZi5zdG9yYWdlLCByZWYuX2xvY2F0aW9uKTtcclxuICAgIHJldHVybiAoYXdhaXQgcmVmLnN0b3JhZ2UubWFrZVJlcXVlc3RXaXRoVG9rZW5zKHJlcXVlc3RJbmZvKSkuZ2V0UHJvbWlzZSgpO1xyXG59XHJcbi8qKlxyXG4gKiBSZXR1cm5zIHJlZmVyZW5jZSBmb3Igb2JqZWN0IG9idGFpbmVkIGJ5IGFwcGVuZGluZyBgY2hpbGRQYXRoYCB0byBgcmVmYC5cclxuICpcclxuICogQHBhcmFtIHJlZiAtIFN0b3JhZ2VSZWZlcmVuY2UgdG8gZ2V0IGNoaWxkIG9mLlxyXG4gKiBAcGFyYW0gY2hpbGRQYXRoIC0gQ2hpbGQgcGF0aCBmcm9tIHByb3ZpZGVkIHJlZi5cclxuICogQHJldHVybnMgQSByZWZlcmVuY2UgdG8gdGhlIG9iamVjdCBvYnRhaW5lZCBieVxyXG4gKiBhcHBlbmRpbmcgY2hpbGRQYXRoLCByZW1vdmluZyBhbnkgZHVwbGljYXRlLCBiZWdpbm5pbmcsIG9yIHRyYWlsaW5nXHJcbiAqIHNsYXNoZXMuXHJcbiAqXHJcbiAqL1xyXG5mdW5jdGlvbiBfZ2V0Q2hpbGQkMShyZWYsIGNoaWxkUGF0aCkge1xyXG4gICAgY29uc3QgbmV3UGF0aCA9IGNoaWxkKHJlZi5fbG9jYXRpb24ucGF0aCwgY2hpbGRQYXRoKTtcclxuICAgIGNvbnN0IGxvY2F0aW9uID0gbmV3IExvY2F0aW9uKHJlZi5fbG9jYXRpb24uYnVja2V0LCBuZXdQYXRoKTtcclxuICAgIHJldHVybiBuZXcgUmVmZXJlbmNlKHJlZi5zdG9yYWdlLCBsb2NhdGlvbik7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuZnVuY3Rpb24gaXNVcmwocGF0aCkge1xyXG4gICAgcmV0dXJuIC9eW0EtWmEtel0rOlxcL1xcLy8udGVzdChwYXRoKTtcclxufVxyXG4vKipcclxuICogUmV0dXJucyBhIGZpcmViYXNlU3RvcmFnZS5SZWZlcmVuY2UgZm9yIHRoZSBnaXZlbiB1cmwuXHJcbiAqL1xyXG5mdW5jdGlvbiByZWZGcm9tVVJMKHNlcnZpY2UsIHVybCkge1xyXG4gICAgcmV0dXJuIG5ldyBSZWZlcmVuY2Uoc2VydmljZSwgdXJsKTtcclxufVxyXG4vKipcclxuICogUmV0dXJucyBhIGZpcmViYXNlU3RvcmFnZS5SZWZlcmVuY2UgZm9yIHRoZSBnaXZlbiBwYXRoIGluIHRoZSBkZWZhdWx0XHJcbiAqIGJ1Y2tldC5cclxuICovXHJcbmZ1bmN0aW9uIHJlZkZyb21QYXRoKHJlZiwgcGF0aCkge1xyXG4gICAgaWYgKHJlZiBpbnN0YW5jZW9mIEZpcmViYXNlU3RvcmFnZUltcGwpIHtcclxuICAgICAgICBjb25zdCBzZXJ2aWNlID0gcmVmO1xyXG4gICAgICAgIGlmIChzZXJ2aWNlLl9idWNrZXQgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aHJvdyBub0RlZmF1bHRCdWNrZXQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgcmVmZXJlbmNlID0gbmV3IFJlZmVyZW5jZShzZXJ2aWNlLCBzZXJ2aWNlLl9idWNrZXQpO1xyXG4gICAgICAgIGlmIChwYXRoICE9IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlZkZyb21QYXRoKHJlZmVyZW5jZSwgcGF0aCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVmZXJlbmNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIC8vIHJlZiBpcyBhIFJlZmVyZW5jZVxyXG4gICAgICAgIGlmIChwYXRoICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF9nZXRDaGlsZCQxKHJlZiwgcGF0aCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVmO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiByZWYkMShzZXJ2aWNlT3JSZWYsIHBhdGhPclVybCkge1xyXG4gICAgaWYgKHBhdGhPclVybCAmJiBpc1VybChwYXRoT3JVcmwpKSB7XHJcbiAgICAgICAgaWYgKHNlcnZpY2VPclJlZiBpbnN0YW5jZW9mIEZpcmViYXNlU3RvcmFnZUltcGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlZkZyb21VUkwoc2VydmljZU9yUmVmLCBwYXRoT3JVcmwpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhyb3cgaW52YWxpZEFyZ3VtZW50KCdUbyB1c2UgcmVmKHNlcnZpY2UsIHVybCksIHRoZSBmaXJzdCBhcmd1bWVudCBtdXN0IGJlIGEgU3RvcmFnZSBpbnN0YW5jZS4nKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gcmVmRnJvbVBhdGgoc2VydmljZU9yUmVmLCBwYXRoT3JVcmwpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGV4dHJhY3RCdWNrZXQoaG9zdCwgY29uZmlnKSB7XHJcbiAgICBjb25zdCBidWNrZXRTdHJpbmcgPSBjb25maWcgPT09IG51bGwgfHwgY29uZmlnID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjb25maWdbQ09ORklHX1NUT1JBR0VfQlVDS0VUX0tFWV07XHJcbiAgICBpZiAoYnVja2V0U3RyaW5nID09IG51bGwpIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIHJldHVybiBMb2NhdGlvbi5tYWtlRnJvbUJ1Y2tldFNwZWMoYnVja2V0U3RyaW5nLCBob3N0KTtcclxufVxyXG5mdW5jdGlvbiBjb25uZWN0U3RvcmFnZUVtdWxhdG9yJDEoc3RvcmFnZSwgaG9zdCwgcG9ydCwgb3B0aW9ucyA9IHt9KSB7XHJcbiAgICBzdG9yYWdlLmhvc3QgPSBgaHR0cDovLyR7aG9zdH06JHtwb3J0fWA7XHJcbiAgICBjb25zdCB7IG1vY2tVc2VyVG9rZW4gfSA9IG9wdGlvbnM7XHJcbiAgICBpZiAobW9ja1VzZXJUb2tlbikge1xyXG4gICAgICAgIHN0b3JhZ2UuX292ZXJyaWRlQXV0aFRva2VuID1cclxuICAgICAgICAgICAgdHlwZW9mIG1vY2tVc2VyVG9rZW4gPT09ICdzdHJpbmcnXHJcbiAgICAgICAgICAgICAgICA/IG1vY2tVc2VyVG9rZW5cclxuICAgICAgICAgICAgICAgIDogY3JlYXRlTW9ja1VzZXJUb2tlbihtb2NrVXNlclRva2VuLCBzdG9yYWdlLmFwcC5vcHRpb25zLnByb2plY3RJZCk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIEEgc2VydmljZSB0aGF0IHByb3ZpZGVzIEZpcmViYXNlIFN0b3JhZ2UgUmVmZXJlbmNlIGluc3RhbmNlcy5cclxuICogQHBhcmFtIG9wdF91cmwgLSBnczovLyB1cmwgdG8gYSBjdXN0b20gU3RvcmFnZSBCdWNrZXRcclxuICpcclxuICogQGludGVybmFsXHJcbiAqL1xyXG5jbGFzcyBGaXJlYmFzZVN0b3JhZ2VJbXBsIHtcclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgLyoqXHJcbiAgICAgKiBGaXJlYmFzZUFwcCBhc3NvY2lhdGVkIHdpdGggdGhpcyBTdG9yYWdlU2VydmljZSBpbnN0YW5jZS5cclxuICAgICAqL1xyXG4gICAgYXBwLCBfYXV0aFByb3ZpZGVyLCBcclxuICAgIC8qKlxyXG4gICAgICogQGludGVybmFsXHJcbiAgICAgKi9cclxuICAgIF9hcHBDaGVja1Byb3ZpZGVyLCBcclxuICAgIC8qKlxyXG4gICAgICogQGludGVybmFsXHJcbiAgICAgKi9cclxuICAgIF9wb29sLCBfdXJsLCBfZmlyZWJhc2VWZXJzaW9uKSB7XHJcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XHJcbiAgICAgICAgdGhpcy5fYXV0aFByb3ZpZGVyID0gX2F1dGhQcm92aWRlcjtcclxuICAgICAgICB0aGlzLl9hcHBDaGVja1Byb3ZpZGVyID0gX2FwcENoZWNrUHJvdmlkZXI7XHJcbiAgICAgICAgdGhpcy5fcG9vbCA9IF9wb29sO1xyXG4gICAgICAgIHRoaXMuX3VybCA9IF91cmw7XHJcbiAgICAgICAgdGhpcy5fZmlyZWJhc2VWZXJzaW9uID0gX2ZpcmViYXNlVmVyc2lvbjtcclxuICAgICAgICB0aGlzLl9idWNrZXQgPSBudWxsO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRoaXMgc3RyaW5nIGNhbiBiZSBpbiB0aGUgZm9ybWF0czpcclxuICAgICAgICAgKiAtIGhvc3RcclxuICAgICAgICAgKiAtIGhvc3Q6cG9ydFxyXG4gICAgICAgICAqIC0gcHJvdG9jb2w6Ly9ob3N0OnBvcnRcclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLl9ob3N0ID0gREVGQVVMVF9IT1NUO1xyXG4gICAgICAgIHRoaXMuX2FwcElkID0gbnVsbDtcclxuICAgICAgICB0aGlzLl9kZWxldGVkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fbWF4T3BlcmF0aW9uUmV0cnlUaW1lID0gREVGQVVMVF9NQVhfT1BFUkFUSU9OX1JFVFJZX1RJTUU7XHJcbiAgICAgICAgdGhpcy5fbWF4VXBsb2FkUmV0cnlUaW1lID0gREVGQVVMVF9NQVhfVVBMT0FEX1JFVFJZX1RJTUU7XHJcbiAgICAgICAgdGhpcy5fcmVxdWVzdHMgPSBuZXcgU2V0KCk7XHJcbiAgICAgICAgaWYgKF91cmwgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLl9idWNrZXQgPSBMb2NhdGlvbi5tYWtlRnJvbUJ1Y2tldFNwZWMoX3VybCwgdGhpcy5faG9zdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9idWNrZXQgPSBleHRyYWN0QnVja2V0KHRoaXMuX2hvc3QsIHRoaXMuYXBwLm9wdGlvbnMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGdldCBob3N0KCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9ob3N0O1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBTZXQgaG9zdCBzdHJpbmcgZm9yIHRoaXMgc2VydmljZS5cclxuICAgICAqIEBwYXJhbSBob3N0IC0gaG9zdCBzdHJpbmcgaW4gdGhlIGZvcm0gb2YgaG9zdCwgaG9zdDpwb3J0LFxyXG4gICAgICogb3IgcHJvdG9jb2w6Ly9ob3N0OnBvcnRcclxuICAgICAqL1xyXG4gICAgc2V0IGhvc3QoaG9zdCkge1xyXG4gICAgICAgIHRoaXMuX2hvc3QgPSBob3N0O1xyXG4gICAgICAgIGlmICh0aGlzLl91cmwgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLl9idWNrZXQgPSBMb2NhdGlvbi5tYWtlRnJvbUJ1Y2tldFNwZWModGhpcy5fdXJsLCBob3N0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2J1Y2tldCA9IGV4dHJhY3RCdWNrZXQoaG9zdCwgdGhpcy5hcHAub3B0aW9ucyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgbWF4aW11bSB0aW1lIHRvIHJldHJ5IHVwbG9hZHMgaW4gbWlsbGlzZWNvbmRzLlxyXG4gICAgICovXHJcbiAgICBnZXQgbWF4VXBsb2FkUmV0cnlUaW1lKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9tYXhVcGxvYWRSZXRyeVRpbWU7XHJcbiAgICB9XHJcbiAgICBzZXQgbWF4VXBsb2FkUmV0cnlUaW1lKHRpbWUpIHtcclxuICAgICAgICB2YWxpZGF0ZU51bWJlcigndGltZScsIFxyXG4gICAgICAgIC8qIG1pblZhbHVlPSovIDAsIFxyXG4gICAgICAgIC8qIG1heFZhbHVlPSAqLyBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksIHRpbWUpO1xyXG4gICAgICAgIHRoaXMuX21heFVwbG9hZFJldHJ5VGltZSA9IHRpbWU7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFRoZSBtYXhpbXVtIHRpbWUgdG8gcmV0cnkgb3BlcmF0aW9ucyBvdGhlciB0aGFuIHVwbG9hZHMgb3IgZG93bmxvYWRzIGluXHJcbiAgICAgKiBtaWxsaXNlY29uZHMuXHJcbiAgICAgKi9cclxuICAgIGdldCBtYXhPcGVyYXRpb25SZXRyeVRpbWUoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX21heE9wZXJhdGlvblJldHJ5VGltZTtcclxuICAgIH1cclxuICAgIHNldCBtYXhPcGVyYXRpb25SZXRyeVRpbWUodGltZSkge1xyXG4gICAgICAgIHZhbGlkYXRlTnVtYmVyKCd0aW1lJywgXHJcbiAgICAgICAgLyogbWluVmFsdWU9Ki8gMCwgXHJcbiAgICAgICAgLyogbWF4VmFsdWU9ICovIE51bWJlci5QT1NJVElWRV9JTkZJTklUWSwgdGltZSk7XHJcbiAgICAgICAgdGhpcy5fbWF4T3BlcmF0aW9uUmV0cnlUaW1lID0gdGltZTtcclxuICAgIH1cclxuICAgIGFzeW5jIF9nZXRBdXRoVG9rZW4oKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX292ZXJyaWRlQXV0aFRva2VuKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vdmVycmlkZUF1dGhUb2tlbjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgYXV0aCA9IHRoaXMuX2F1dGhQcm92aWRlci5nZXRJbW1lZGlhdGUoeyBvcHRpb25hbDogdHJ1ZSB9KTtcclxuICAgICAgICBpZiAoYXV0aCkge1xyXG4gICAgICAgICAgICBjb25zdCB0b2tlbkRhdGEgPSBhd2FpdCBhdXRoLmdldFRva2VuKCk7XHJcbiAgICAgICAgICAgIGlmICh0b2tlbkRhdGEgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0b2tlbkRhdGEuYWNjZXNzVG9rZW47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgICBhc3luYyBfZ2V0QXBwQ2hlY2tUb2tlbigpIHtcclxuICAgICAgICBjb25zdCBhcHBDaGVjayA9IHRoaXMuX2FwcENoZWNrUHJvdmlkZXIuZ2V0SW1tZWRpYXRlKHsgb3B0aW9uYWw6IHRydWUgfSk7XHJcbiAgICAgICAgaWYgKGFwcENoZWNrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGFwcENoZWNrLmdldFRva2VuKCk7XHJcbiAgICAgICAgICAgIC8vIFRPRE86IFdoYXQgZG8gd2Ugd2FudCB0byBkbyBpZiB0aGVyZSBpcyBhbiBlcnJvciBnZXR0aW5nIHRoZSB0b2tlbj9cclxuICAgICAgICAgICAgLy8gQ29udGV4dDogYXBwQ2hlY2suZ2V0VG9rZW4oKSB3aWxsIG5ldmVyIHRocm93IGV2ZW4gaWYgYW4gZXJyb3IgaGFwcGVuZWQuIEluIHRoZSBlcnJvciBjYXNlLCBhIGR1bW15IHRva2VuIHdpbGwgYmVcclxuICAgICAgICAgICAgLy8gcmV0dXJuZWQgYWxvbmcgd2l0aCBhbiBlcnJvciBmaWVsZCBkZXNjcmliaW5nIHRoZSBlcnJvci4gSW4gZ2VuZXJhbCwgd2Ugc2hvdWxkbid0IGNhcmUgYWJvdXQgdGhlIGVycm9yIGNvbmRpdGlvbiBhbmQganVzdCB1c2VcclxuICAgICAgICAgICAgLy8gdGhlIHRva2VuIChhY3R1YWwgb3IgZHVtbXkpIHRvIHNlbmQgcmVxdWVzdHMuXHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQudG9rZW47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBTdG9wIHJ1bm5pbmcgcmVxdWVzdHMgYW5kIHByZXZlbnQgbW9yZSBmcm9tIGJlaW5nIGNyZWF0ZWQuXHJcbiAgICAgKi9cclxuICAgIF9kZWxldGUoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLl9kZWxldGVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2RlbGV0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLl9yZXF1ZXN0cy5mb3JFYWNoKHJlcXVlc3QgPT4gcmVxdWVzdC5jYW5jZWwoKSk7XHJcbiAgICAgICAgICAgIHRoaXMuX3JlcXVlc3RzLmNsZWFyKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyBhIG5ldyBmaXJlYmFzZVN0b3JhZ2UuUmVmZXJlbmNlIG9iamVjdCByZWZlcmVuY2luZyB0aGlzIFN0b3JhZ2VTZXJ2aWNlXHJcbiAgICAgKiBhdCB0aGUgZ2l2ZW4gTG9jYXRpb24uXHJcbiAgICAgKi9cclxuICAgIF9tYWtlU3RvcmFnZVJlZmVyZW5jZShsb2MpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFJlZmVyZW5jZSh0aGlzLCBsb2MpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBAcGFyYW0gcmVxdWVzdEluZm8gLSBIVFRQIFJlcXVlc3RJbmZvIG9iamVjdFxyXG4gICAgICogQHBhcmFtIGF1dGhUb2tlbiAtIEZpcmViYXNlIGF1dGggdG9rZW5cclxuICAgICAqL1xyXG4gICAgX21ha2VSZXF1ZXN0KHJlcXVlc3RJbmZvLCBhdXRoVG9rZW4sIGFwcENoZWNrVG9rZW4pIHtcclxuICAgICAgICBpZiAoIXRoaXMuX2RlbGV0ZWQpIHtcclxuICAgICAgICAgICAgY29uc3QgcmVxdWVzdCA9IG1ha2VSZXF1ZXN0KHJlcXVlc3RJbmZvLCB0aGlzLl9hcHBJZCwgYXV0aFRva2VuLCBhcHBDaGVja1Rva2VuLCB0aGlzLl9wb29sLCB0aGlzLl9maXJlYmFzZVZlcnNpb24pO1xyXG4gICAgICAgICAgICB0aGlzLl9yZXF1ZXN0cy5hZGQocmVxdWVzdCk7XHJcbiAgICAgICAgICAgIC8vIFJlcXVlc3QgcmVtb3ZlcyBpdHNlbGYgZnJvbSBzZXQgd2hlbiBjb21wbGV0ZS5cclxuICAgICAgICAgICAgcmVxdWVzdC5nZXRQcm9taXNlKCkudGhlbigoKSA9PiB0aGlzLl9yZXF1ZXN0cy5kZWxldGUocmVxdWVzdCksICgpID0+IHRoaXMuX3JlcXVlc3RzLmRlbGV0ZShyZXF1ZXN0KSk7XHJcbiAgICAgICAgICAgIHJldHVybiByZXF1ZXN0O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBGYWlsUmVxdWVzdChhcHBEZWxldGVkKCkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGFzeW5jIG1ha2VSZXF1ZXN0V2l0aFRva2VucyhyZXF1ZXN0SW5mbykge1xyXG4gICAgICAgIGNvbnN0IFthdXRoVG9rZW4sIGFwcENoZWNrVG9rZW5dID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xyXG4gICAgICAgICAgICB0aGlzLl9nZXRBdXRoVG9rZW4oKSxcclxuICAgICAgICAgICAgdGhpcy5fZ2V0QXBwQ2hlY2tUb2tlbigpXHJcbiAgICAgICAgXSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX21ha2VSZXF1ZXN0KHJlcXVlc3RJbmZvLCBhdXRoVG9rZW4sIGFwcENoZWNrVG9rZW4pO1xyXG4gICAgfVxyXG59XG5cbmNvbnN0IG5hbWUgPSBcIkBmaXJlYmFzZS9zdG9yYWdlXCI7XG5jb25zdCB2ZXJzaW9uID0gXCIwLjguMVwiO1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogVHlwZSBjb25zdGFudCBmb3IgRmlyZWJhc2UgU3RvcmFnZS5cclxuICovXHJcbmNvbnN0IFNUT1JBR0VfVFlQRSA9ICdzdG9yYWdlJztcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFVwbG9hZHMgZGF0YSB0byB0aGlzIG9iamVjdCdzIGxvY2F0aW9uLlxyXG4gKiBUaGUgdXBsb2FkIGlzIG5vdCByZXN1bWFibGUuXHJcbiAqIEBwdWJsaWNcclxuICogQHBhcmFtIHJlZiAtIFN0b3JhZ2VSZWZlcmVuY2Ugd2hlcmUgZGF0YSBzaG91bGQgYmUgdXBsb2FkZWQuXHJcbiAqIEBwYXJhbSBkYXRhIC0gVGhlIGRhdGEgdG8gdXBsb2FkLlxyXG4gKiBAcGFyYW0gbWV0YWRhdGEgLSBNZXRhZGF0YSBmb3IgdGhlIGRhdGEgdG8gdXBsb2FkLlxyXG4gKiBAcmV0dXJucyBBIFByb21pc2UgY29udGFpbmluZyBhbiBVcGxvYWRSZXN1bHRcclxuICovXHJcbmZ1bmN0aW9uIHVwbG9hZEJ5dGVzKHJlZiwgZGF0YSwgbWV0YWRhdGEpIHtcclxuICAgIHJlZiA9IGdldE1vZHVsYXJJbnN0YW5jZShyZWYpO1xyXG4gICAgcmV0dXJuIHVwbG9hZEJ5dGVzJDEocmVmLCBkYXRhLCBtZXRhZGF0YSk7XHJcbn1cclxuLyoqXHJcbiAqIFVwbG9hZHMgYSBzdHJpbmcgdG8gdGhpcyBvYmplY3QncyBsb2NhdGlvbi5cclxuICogVGhlIHVwbG9hZCBpcyBub3QgcmVzdW1hYmxlLlxyXG4gKiBAcHVibGljXHJcbiAqIEBwYXJhbSByZWYgLSBTdG9yYWdlUmVmZXJlbmNlIHdoZXJlIHN0cmluZyBzaG91bGQgYmUgdXBsb2FkZWQuXHJcbiAqIEBwYXJhbSB2YWx1ZSAtIFRoZSBzdHJpbmcgdG8gdXBsb2FkLlxyXG4gKiBAcGFyYW0gZm9ybWF0IC0gVGhlIGZvcm1hdCBvZiB0aGUgc3RyaW5nIHRvIHVwbG9hZC5cclxuICogQHBhcmFtIG1ldGFkYXRhIC0gTWV0YWRhdGEgZm9yIHRoZSBzdHJpbmcgdG8gdXBsb2FkLlxyXG4gKiBAcmV0dXJucyBBIFByb21pc2UgY29udGFpbmluZyBhbiBVcGxvYWRSZXN1bHRcclxuICovXHJcbmZ1bmN0aW9uIHVwbG9hZFN0cmluZyhyZWYsIHZhbHVlLCBmb3JtYXQsIG1ldGFkYXRhKSB7XHJcbiAgICByZWYgPSBnZXRNb2R1bGFySW5zdGFuY2UocmVmKTtcclxuICAgIHJldHVybiB1cGxvYWRTdHJpbmckMShyZWYsIHZhbHVlLCBmb3JtYXQsIG1ldGFkYXRhKTtcclxufVxyXG4vKipcclxuICogVXBsb2FkcyBkYXRhIHRvIHRoaXMgb2JqZWN0J3MgbG9jYXRpb24uXHJcbiAqIFRoZSB1cGxvYWQgY2FuIGJlIHBhdXNlZCBhbmQgcmVzdW1lZCwgYW5kIGV4cG9zZXMgcHJvZ3Jlc3MgdXBkYXRlcy5cclxuICogQHB1YmxpY1xyXG4gKiBAcGFyYW0gcmVmIC0gU3RvcmFnZVJlZmVyZW5jZSB3aGVyZSBkYXRhIHNob3VsZCBiZSB1cGxvYWRlZC5cclxuICogQHBhcmFtIGRhdGEgLSBUaGUgZGF0YSB0byB1cGxvYWQuXHJcbiAqIEBwYXJhbSBtZXRhZGF0YSAtIE1ldGFkYXRhIGZvciB0aGUgZGF0YSB0byB1cGxvYWQuXHJcbiAqIEByZXR1cm5zIEFuIFVwbG9hZFRhc2tcclxuICovXHJcbmZ1bmN0aW9uIHVwbG9hZEJ5dGVzUmVzdW1hYmxlKHJlZiwgZGF0YSwgbWV0YWRhdGEpIHtcclxuICAgIHJlZiA9IGdldE1vZHVsYXJJbnN0YW5jZShyZWYpO1xyXG4gICAgcmV0dXJuIHVwbG9hZEJ5dGVzUmVzdW1hYmxlJDEocmVmLCBkYXRhLCBtZXRhZGF0YSk7XHJcbn1cclxuLyoqXHJcbiAqIEEgYFByb21pc2VgIHRoYXQgcmVzb2x2ZXMgd2l0aCB0aGUgbWV0YWRhdGEgZm9yIHRoaXMgb2JqZWN0LiBJZiB0aGlzXHJcbiAqIG9iamVjdCBkb2Vzbid0IGV4aXN0IG9yIG1ldGFkYXRhIGNhbm5vdCBiZSByZXRyZWl2ZWQsIHRoZSBwcm9taXNlIGlzXHJcbiAqIHJlamVjdGVkLlxyXG4gKiBAcHVibGljXHJcbiAqIEBwYXJhbSByZWYgLSB7QGxpbmsgU3RvcmFnZVJlZmVyZW5jZX0gdG8gZ2V0IG1ldGFkYXRhIGZyb20uXHJcbiAqL1xyXG5mdW5jdGlvbiBnZXRNZXRhZGF0YShyZWYpIHtcclxuICAgIHJlZiA9IGdldE1vZHVsYXJJbnN0YW5jZShyZWYpO1xyXG4gICAgcmV0dXJuIGdldE1ldGFkYXRhJDEocmVmKTtcclxufVxyXG4vKipcclxuICogVXBkYXRlcyB0aGUgbWV0YWRhdGEgZm9yIHRoaXMgb2JqZWN0LlxyXG4gKiBAcHVibGljXHJcbiAqIEBwYXJhbSByZWYgLSB7QGxpbmsgU3RvcmFnZVJlZmVyZW5jZX0gdG8gdXBkYXRlIG1ldGFkYXRhIGZvci5cclxuICogQHBhcmFtIG1ldGFkYXRhIC0gVGhlIG5ldyBtZXRhZGF0YSBmb3IgdGhlIG9iamVjdC5cclxuICogICAgIE9ubHkgdmFsdWVzIHRoYXQgaGF2ZSBiZWVuIGV4cGxpY2l0bHkgc2V0IHdpbGwgYmUgY2hhbmdlZC4gRXhwbGljaXRseVxyXG4gKiAgICAgc2V0dGluZyBhIHZhbHVlIHRvIG51bGwgd2lsbCByZW1vdmUgdGhlIG1ldGFkYXRhLlxyXG4gKiBAcmV0dXJucyBBIGBQcm9taXNlYCB0aGF0IHJlc29sdmVzIHdpdGggdGhlIG5ldyBtZXRhZGF0YSBmb3IgdGhpcyBvYmplY3QuXHJcbiAqL1xyXG5mdW5jdGlvbiB1cGRhdGVNZXRhZGF0YShyZWYsIG1ldGFkYXRhKSB7XHJcbiAgICByZWYgPSBnZXRNb2R1bGFySW5zdGFuY2UocmVmKTtcclxuICAgIHJldHVybiB1cGRhdGVNZXRhZGF0YSQxKHJlZiwgbWV0YWRhdGEpO1xyXG59XHJcbi8qKlxyXG4gKiBMaXN0IGl0ZW1zIChmaWxlcykgYW5kIHByZWZpeGVzIChmb2xkZXJzKSB1bmRlciB0aGlzIHN0b3JhZ2UgcmVmZXJlbmNlLlxyXG4gKlxyXG4gKiBMaXN0IEFQSSBpcyBvbmx5IGF2YWlsYWJsZSBmb3IgRmlyZWJhc2UgUnVsZXMgVmVyc2lvbiAyLlxyXG4gKlxyXG4gKiBHQ1MgaXMgYSBrZXktYmxvYiBzdG9yZS4gRmlyZWJhc2UgU3RvcmFnZSBpbXBvc2VzIHRoZSBzZW1hbnRpYyBvZiAnLydcclxuICogZGVsaW1pdGVkIGZvbGRlciBzdHJ1Y3R1cmUuXHJcbiAqIFJlZmVyIHRvIEdDUydzIExpc3QgQVBJIGlmIHlvdSB3YW50IHRvIGxlYXJuIG1vcmUuXHJcbiAqXHJcbiAqIFRvIGFkaGVyZSB0byBGaXJlYmFzZSBSdWxlcydzIFNlbWFudGljcywgRmlyZWJhc2UgU3RvcmFnZSBkb2VzIG5vdFxyXG4gKiBzdXBwb3J0IG9iamVjdHMgd2hvc2UgcGF0aHMgZW5kIHdpdGggXCIvXCIgb3IgY29udGFpbiB0d28gY29uc2VjdXRpdmVcclxuICogXCIvXCJzLiBGaXJlYmFzZSBTdG9yYWdlIExpc3QgQVBJIHdpbGwgZmlsdGVyIHRoZXNlIHVuc3VwcG9ydGVkIG9iamVjdHMuXHJcbiAqIGxpc3QoKSBtYXkgZmFpbCBpZiB0aGVyZSBhcmUgdG9vIG1hbnkgdW5zdXBwb3J0ZWQgb2JqZWN0cyBpbiB0aGUgYnVja2V0LlxyXG4gKiBAcHVibGljXHJcbiAqXHJcbiAqIEBwYXJhbSByZWYgLSB7QGxpbmsgU3RvcmFnZVJlZmVyZW5jZX0gdG8gZ2V0IGxpc3QgZnJvbS5cclxuICogQHBhcmFtIG9wdGlvbnMgLSBTZWUge0BsaW5rIExpc3RPcHRpb25zfSBmb3IgZGV0YWlscy5cclxuICogQHJldHVybnMgQSBgUHJvbWlzZWAgdGhhdCByZXNvbHZlcyB3aXRoIHRoZSBpdGVtcyBhbmQgcHJlZml4ZXMuXHJcbiAqICAgICAgYHByZWZpeGVzYCBjb250YWlucyByZWZlcmVuY2VzIHRvIHN1Yi1mb2xkZXJzIGFuZCBgaXRlbXNgXHJcbiAqICAgICAgY29udGFpbnMgcmVmZXJlbmNlcyB0byBvYmplY3RzIGluIHRoaXMgZm9sZGVyLiBgbmV4dFBhZ2VUb2tlbmBcclxuICogICAgICBjYW4gYmUgdXNlZCB0byBnZXQgdGhlIHJlc3Qgb2YgdGhlIHJlc3VsdHMuXHJcbiAqL1xyXG5mdW5jdGlvbiBsaXN0KHJlZiwgb3B0aW9ucykge1xyXG4gICAgcmVmID0gZ2V0TW9kdWxhckluc3RhbmNlKHJlZik7XHJcbiAgICByZXR1cm4gbGlzdCQxKHJlZiwgb3B0aW9ucyk7XHJcbn1cclxuLyoqXHJcbiAqIExpc3QgYWxsIGl0ZW1zIChmaWxlcykgYW5kIHByZWZpeGVzIChmb2xkZXJzKSB1bmRlciB0aGlzIHN0b3JhZ2UgcmVmZXJlbmNlLlxyXG4gKlxyXG4gKiBUaGlzIGlzIGEgaGVscGVyIG1ldGhvZCBmb3IgY2FsbGluZyBsaXN0KCkgcmVwZWF0ZWRseSB1bnRpbCB0aGVyZSBhcmVcclxuICogbm8gbW9yZSByZXN1bHRzLiBUaGUgZGVmYXVsdCBwYWdpbmF0aW9uIHNpemUgaXMgMTAwMC5cclxuICpcclxuICogTm90ZTogVGhlIHJlc3VsdHMgbWF5IG5vdCBiZSBjb25zaXN0ZW50IGlmIG9iamVjdHMgYXJlIGNoYW5nZWQgd2hpbGUgdGhpc1xyXG4gKiBvcGVyYXRpb24gaXMgcnVubmluZy5cclxuICpcclxuICogV2FybmluZzogYGxpc3RBbGxgIG1heSBwb3RlbnRpYWxseSBjb25zdW1lIHRvbyBtYW55IHJlc291cmNlcyBpZiB0aGVyZSBhcmVcclxuICogdG9vIG1hbnkgcmVzdWx0cy5cclxuICogQHB1YmxpY1xyXG4gKiBAcGFyYW0gcmVmIC0ge0BsaW5rIFN0b3JhZ2VSZWZlcmVuY2V9IHRvIGdldCBsaXN0IGZyb20uXHJcbiAqXHJcbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHRoYXQgcmVzb2x2ZXMgd2l0aCBhbGwgdGhlIGl0ZW1zIGFuZCBwcmVmaXhlcyB1bmRlclxyXG4gKiAgICAgIHRoZSBjdXJyZW50IHN0b3JhZ2UgcmVmZXJlbmNlLiBgcHJlZml4ZXNgIGNvbnRhaW5zIHJlZmVyZW5jZXMgdG9cclxuICogICAgICBzdWItZGlyZWN0b3JpZXMgYW5kIGBpdGVtc2AgY29udGFpbnMgcmVmZXJlbmNlcyB0byBvYmplY3RzIGluIHRoaXNcclxuICogICAgICBmb2xkZXIuIGBuZXh0UGFnZVRva2VuYCBpcyBuZXZlciByZXR1cm5lZC5cclxuICovXHJcbmZ1bmN0aW9uIGxpc3RBbGwocmVmKSB7XHJcbiAgICByZWYgPSBnZXRNb2R1bGFySW5zdGFuY2UocmVmKTtcclxuICAgIHJldHVybiBsaXN0QWxsJDEocmVmKTtcclxufVxyXG4vKipcclxuICogUmV0dXJucyB0aGUgZG93bmxvYWQgVVJMIGZvciB0aGUgZ2l2ZW4ge0BsaW5rIFN0b3JhZ2VSZWZlcmVuY2V9LlxyXG4gKiBAcHVibGljXHJcbiAqIEBwYXJhbSByZWYgLSB7QGxpbmsgU3RvcmFnZVJlZmVyZW5jZX0gdG8gZ2V0IHRoZSBkb3dubG9hZCBVUkwgZm9yLlxyXG4gKiBAcmV0dXJucyBBIGBQcm9taXNlYCB0aGF0IHJlc29sdmVzIHdpdGggdGhlIGRvd25sb2FkXHJcbiAqICAgICBVUkwgZm9yIHRoaXMgb2JqZWN0LlxyXG4gKi9cclxuZnVuY3Rpb24gZ2V0RG93bmxvYWRVUkwocmVmKSB7XHJcbiAgICByZWYgPSBnZXRNb2R1bGFySW5zdGFuY2UocmVmKTtcclxuICAgIHJldHVybiBnZXREb3dubG9hZFVSTCQxKHJlZik7XHJcbn1cclxuLyoqXHJcbiAqIERlbGV0ZXMgdGhlIG9iamVjdCBhdCB0aGlzIGxvY2F0aW9uLlxyXG4gKiBAcHVibGljXHJcbiAqIEBwYXJhbSByZWYgLSB7QGxpbmsgU3RvcmFnZVJlZmVyZW5jZX0gZm9yIG9iamVjdCB0byBkZWxldGUuXHJcbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHRoYXQgcmVzb2x2ZXMgaWYgdGhlIGRlbGV0aW9uIHN1Y2NlZWRzLlxyXG4gKi9cclxuZnVuY3Rpb24gZGVsZXRlT2JqZWN0KHJlZikge1xyXG4gICAgcmVmID0gZ2V0TW9kdWxhckluc3RhbmNlKHJlZik7XHJcbiAgICByZXR1cm4gZGVsZXRlT2JqZWN0JDEocmVmKTtcclxufVxyXG5mdW5jdGlvbiByZWYoc2VydmljZU9yUmVmLCBwYXRoT3JVcmwpIHtcclxuICAgIHNlcnZpY2VPclJlZiA9IGdldE1vZHVsYXJJbnN0YW5jZShzZXJ2aWNlT3JSZWYpO1xyXG4gICAgcmV0dXJuIHJlZiQxKHNlcnZpY2VPclJlZiwgcGF0aE9yVXJsKTtcclxufVxyXG4vKipcclxuICogQGludGVybmFsXHJcbiAqL1xyXG5mdW5jdGlvbiBfZ2V0Q2hpbGQocmVmLCBjaGlsZFBhdGgpIHtcclxuICAgIHJldHVybiBfZ2V0Q2hpbGQkMShyZWYsIGNoaWxkUGF0aCk7XHJcbn1cclxuLyoqXHJcbiAqIEdldHMgYSB7QGxpbmsgRmlyZWJhc2VTdG9yYWdlfSBpbnN0YW5jZSBmb3IgdGhlIGdpdmVuIEZpcmViYXNlIGFwcC5cclxuICogQHB1YmxpY1xyXG4gKiBAcGFyYW0gYXBwIC0gRmlyZWJhc2UgYXBwIHRvIGdldCB7QGxpbmsgRmlyZWJhc2VTdG9yYWdlfSBpbnN0YW5jZSBmb3IuXHJcbiAqIEBwYXJhbSBidWNrZXRVcmwgLSBUaGUgZ3M6Ly8gdXJsIHRvIHlvdXIgRmlyZWJhc2UgU3RvcmFnZSBCdWNrZXQuXHJcbiAqIElmIG5vdCBwYXNzZWQsIHVzZXMgdGhlIGFwcCdzIGRlZmF1bHQgU3RvcmFnZSBCdWNrZXQuXHJcbiAqIEByZXR1cm5zIEEge0BsaW5rIEZpcmViYXNlU3RvcmFnZX0gaW5zdGFuY2UuXHJcbiAqL1xyXG5mdW5jdGlvbiBnZXRTdG9yYWdlKGFwcCA9IGdldEFwcCgpLCBidWNrZXRVcmwpIHtcclxuICAgIGFwcCA9IGdldE1vZHVsYXJJbnN0YW5jZShhcHApO1xyXG4gICAgY29uc3Qgc3RvcmFnZVByb3ZpZGVyID0gX2dldFByb3ZpZGVyKGFwcCwgU1RPUkFHRV9UWVBFKTtcclxuICAgIGNvbnN0IHN0b3JhZ2VJbnN0YW5jZSA9IHN0b3JhZ2VQcm92aWRlci5nZXRJbW1lZGlhdGUoe1xyXG4gICAgICAgIGlkZW50aWZpZXI6IGJ1Y2tldFVybFxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gc3RvcmFnZUluc3RhbmNlO1xyXG59XHJcbi8qKlxyXG4gKiBNb2RpZnkgdGhpcyB7QGxpbmsgRmlyZWJhc2VTdG9yYWdlfSBpbnN0YW5jZSB0byBjb21tdW5pY2F0ZSB3aXRoIHRoZSBDbG91ZCBTdG9yYWdlIGVtdWxhdG9yLlxyXG4gKlxyXG4gKiBAcGFyYW0gc3RvcmFnZSAtIFRoZSB7QGxpbmsgRmlyZWJhc2VTdG9yYWdlfSBpbnN0YW5jZVxyXG4gKiBAcGFyYW0gaG9zdCAtIFRoZSBlbXVsYXRvciBob3N0IChleDogbG9jYWxob3N0KVxyXG4gKiBAcGFyYW0gcG9ydCAtIFRoZSBlbXVsYXRvciBwb3J0IChleDogNTAwMSlcclxuICogQHBhcmFtIG9wdGlvbnMubW9ja1VzZXJUb2tlbiAtIHRoZSBtb2NrIGF1dGggdG9rZW4gdG8gdXNlIGZvciB1bml0IHRlc3RpbmcgU2VjdXJpdHkgUnVsZXMuXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmZ1bmN0aW9uIGNvbm5lY3RTdG9yYWdlRW11bGF0b3Ioc3RvcmFnZSwgaG9zdCwgcG9ydCwgb3B0aW9ucyA9IHt9KSB7XHJcbiAgICBjb25uZWN0U3RvcmFnZUVtdWxhdG9yJDEoc3RvcmFnZSwgaG9zdCwgcG9ydCwgb3B0aW9ucyk7XHJcbn1cblxuLyoqXHJcbiAqIENsb3VkIFN0b3JhZ2UgZm9yIEZpcmViYXNlXHJcbiAqXHJcbiAqIEBwYWNrYWdlRG9jdW1lbnRhdGlvblxyXG4gKi9cclxuZnVuY3Rpb24gZmFjdG9yeShjb250YWluZXIsIHsgaW5zdGFuY2VJZGVudGlmaWVyOiB1cmwgfSkge1xyXG4gICAgY29uc3QgYXBwID0gY29udGFpbmVyLmdldFByb3ZpZGVyKCdhcHAnKS5nZXRJbW1lZGlhdGUoKTtcclxuICAgIGNvbnN0IGF1dGhQcm92aWRlciA9IGNvbnRhaW5lci5nZXRQcm92aWRlcignYXV0aC1pbnRlcm5hbCcpO1xyXG4gICAgY29uc3QgYXBwQ2hlY2tQcm92aWRlciA9IGNvbnRhaW5lci5nZXRQcm92aWRlcignYXBwLWNoZWNrLWludGVybmFsJyk7XHJcbiAgICByZXR1cm4gbmV3IEZpcmViYXNlU3RvcmFnZUltcGwoYXBwLCBhdXRoUHJvdmlkZXIsIGFwcENoZWNrUHJvdmlkZXIsIG5ldyBDb25uZWN0aW9uUG9vbCgpLCB1cmwsIFNES19WRVJTSU9OKTtcclxufVxyXG5mdW5jdGlvbiByZWdpc3RlclN0b3JhZ2UoKSB7XHJcbiAgICBfcmVnaXN0ZXJDb21wb25lbnQobmV3IENvbXBvbmVudChTVE9SQUdFX1RZUEUsIGZhY3RvcnksIFwiUFVCTElDXCIgLyogUFVCTElDICovKS5zZXRNdWx0aXBsZUluc3RhbmNlcyh0cnVlKSk7XHJcbiAgICByZWdpc3RlclZlcnNpb24obmFtZSwgdmVyc2lvbik7XHJcbn1cclxucmVnaXN0ZXJTdG9yYWdlKCk7XG5cbmV4cG9ydCB7IFN0cmluZ0Zvcm1hdCwgRmJzQmxvYiBhcyBfRmJzQmxvYiwgTG9jYXRpb24gYXMgX0xvY2F0aW9uLCBUYXNrRXZlbnQgYXMgX1Rhc2tFdmVudCwgVGFza1N0YXRlIGFzIF9UYXNrU3RhdGUsIFVwbG9hZFRhc2sgYXMgX1VwbG9hZFRhc2ssIGRhdGFGcm9tU3RyaW5nIGFzIF9kYXRhRnJvbVN0cmluZywgX2dldENoaWxkLCBpbnZhbGlkQXJndW1lbnQgYXMgX2ludmFsaWRBcmd1bWVudCwgaW52YWxpZFJvb3RPcGVyYXRpb24gYXMgX2ludmFsaWRSb290T3BlcmF0aW9uLCBjb25uZWN0U3RvcmFnZUVtdWxhdG9yLCBkZWxldGVPYmplY3QsIGdldERvd25sb2FkVVJMLCBnZXRNZXRhZGF0YSwgZ2V0U3RvcmFnZSwgbGlzdCwgbGlzdEFsbCwgcmVmLCB1cGRhdGVNZXRhZGF0YSwgdXBsb2FkQnl0ZXMsIHVwbG9hZEJ5dGVzUmVzdW1hYmxlLCB1cGxvYWRTdHJpbmcgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmVzbTIwMTcuanMubWFwXG4iLCJpbXBvcnQgeyBDb21wb25lbnQsIENvbXBvbmVudENvbnRhaW5lciB9IGZyb20gJ0BmaXJlYmFzZS9jb21wb25lbnQnO1xuaW1wb3J0IHsgTG9nZ2VyLCBzZXRVc2VyTG9nSGFuZGxlciwgc2V0TG9nTGV2ZWwgYXMgc2V0TG9nTGV2ZWwkMSB9IGZyb20gJ0BmaXJlYmFzZS9sb2dnZXInO1xuaW1wb3J0IHsgRXJyb3JGYWN0b3J5LCBkZWVwRXF1YWwgfSBmcm9tICdAZmlyZWJhc2UvdXRpbCc7XG5leHBvcnQgeyBGaXJlYmFzZUVycm9yIH0gZnJvbSAnQGZpcmViYXNlL3V0aWwnO1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jbGFzcyBQbGF0Zm9ybUxvZ2dlclNlcnZpY2VJbXBsIHtcclxuICAgIGNvbnN0cnVjdG9yKGNvbnRhaW5lcikge1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xyXG4gICAgfVxyXG4gICAgLy8gSW4gaW5pdGlhbCBpbXBsZW1lbnRhdGlvbiwgdGhpcyB3aWxsIGJlIGNhbGxlZCBieSBpbnN0YWxsYXRpb25zIG9uXHJcbiAgICAvLyBhdXRoIHRva2VuIHJlZnJlc2gsIGFuZCBpbnN0YWxsYXRpb25zIHdpbGwgc2VuZCB0aGlzIHN0cmluZy5cclxuICAgIGdldFBsYXRmb3JtSW5mb1N0cmluZygpIHtcclxuICAgICAgICBjb25zdCBwcm92aWRlcnMgPSB0aGlzLmNvbnRhaW5lci5nZXRQcm92aWRlcnMoKTtcclxuICAgICAgICAvLyBMb29wIHRocm91Z2ggcHJvdmlkZXJzIGFuZCBnZXQgbGlicmFyeS92ZXJzaW9uIHBhaXJzIGZyb20gYW55IHRoYXQgYXJlXHJcbiAgICAgICAgLy8gdmVyc2lvbiBjb21wb25lbnRzLlxyXG4gICAgICAgIHJldHVybiBwcm92aWRlcnNcclxuICAgICAgICAgICAgLm1hcChwcm92aWRlciA9PiB7XHJcbiAgICAgICAgICAgIGlmIChpc1ZlcnNpb25TZXJ2aWNlUHJvdmlkZXIocHJvdmlkZXIpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzZXJ2aWNlID0gcHJvdmlkZXIuZ2V0SW1tZWRpYXRlKCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYCR7c2VydmljZS5saWJyYXJ5fS8ke3NlcnZpY2UudmVyc2lvbn1gO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAuZmlsdGVyKGxvZ1N0cmluZyA9PiBsb2dTdHJpbmcpXHJcbiAgICAgICAgICAgIC5qb2luKCcgJyk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqXHJcbiAqIEBwYXJhbSBwcm92aWRlciBjaGVjayBpZiB0aGlzIHByb3ZpZGVyIHByb3ZpZGVzIGEgVmVyc2lvblNlcnZpY2VcclxuICpcclxuICogTk9URTogVXNpbmcgUHJvdmlkZXI8J2FwcC12ZXJzaW9uJz4gaXMgYSBoYWNrIHRvIGluZGljYXRlIHRoYXQgdGhlIHByb3ZpZGVyXHJcbiAqIHByb3ZpZGVzIFZlcnNpb25TZXJ2aWNlLiBUaGUgcHJvdmlkZXIgaXMgbm90IG5lY2Vzc2FyaWx5IGEgJ2FwcC12ZXJzaW9uJ1xyXG4gKiBwcm92aWRlci5cclxuICovXHJcbmZ1bmN0aW9uIGlzVmVyc2lvblNlcnZpY2VQcm92aWRlcihwcm92aWRlcikge1xyXG4gICAgY29uc3QgY29tcG9uZW50ID0gcHJvdmlkZXIuZ2V0Q29tcG9uZW50KCk7XHJcbiAgICByZXR1cm4gKGNvbXBvbmVudCA9PT0gbnVsbCB8fCBjb21wb25lbnQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGNvbXBvbmVudC50eXBlKSA9PT0gXCJWRVJTSU9OXCIgLyogVkVSU0lPTiAqLztcclxufVxuXG5jb25zdCBuYW1lJG8gPSBcIkBmaXJlYmFzZS9hcHBcIjtcbmNvbnN0IHZlcnNpb24kMSA9IFwiMC43LjBcIjtcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuY29uc3QgbG9nZ2VyID0gbmV3IExvZ2dlcignQGZpcmViYXNlL2FwcCcpO1xuXG5jb25zdCBuYW1lJG4gPSBcIkBmaXJlYmFzZS9hcHAtY29tcGF0XCI7XG5cbmNvbnN0IG5hbWUkbSA9IFwiQGZpcmViYXNlL2FuYWx5dGljcy1jb21wYXRcIjtcblxuY29uc3QgbmFtZSRsID0gXCJAZmlyZWJhc2UvYW5hbHl0aWNzXCI7XG5cbmNvbnN0IG5hbWUkayA9IFwiQGZpcmViYXNlL2FwcC1jaGVjay1jb21wYXRcIjtcblxuY29uc3QgbmFtZSRqID0gXCJAZmlyZWJhc2UvYXBwLWNoZWNrXCI7XG5cbmNvbnN0IG5hbWUkaSA9IFwiQGZpcmViYXNlL2F1dGhcIjtcblxuY29uc3QgbmFtZSRoID0gXCJAZmlyZWJhc2UvYXV0aC1jb21wYXRcIjtcblxuY29uc3QgbmFtZSRnID0gXCJAZmlyZWJhc2UvZGF0YWJhc2VcIjtcblxuY29uc3QgbmFtZSRmID0gXCJAZmlyZWJhc2UvZGF0YWJhc2UtY29tcGF0XCI7XG5cbmNvbnN0IG5hbWUkZSA9IFwiQGZpcmViYXNlL2Z1bmN0aW9uc1wiO1xuXG5jb25zdCBuYW1lJGQgPSBcIkBmaXJlYmFzZS9mdW5jdGlvbnMtY29tcGF0XCI7XG5cbmNvbnN0IG5hbWUkYyA9IFwiQGZpcmViYXNlL2luc3RhbGxhdGlvbnNcIjtcblxuY29uc3QgbmFtZSRiID0gXCJAZmlyZWJhc2UvaW5zdGFsbGF0aW9ucy1jb21wYXRcIjtcblxuY29uc3QgbmFtZSRhID0gXCJAZmlyZWJhc2UvbWVzc2FnaW5nXCI7XG5cbmNvbnN0IG5hbWUkOSA9IFwiQGZpcmViYXNlL21lc3NhZ2luZy1jb21wYXRcIjtcblxuY29uc3QgbmFtZSQ4ID0gXCJAZmlyZWJhc2UvcGVyZm9ybWFuY2VcIjtcblxuY29uc3QgbmFtZSQ3ID0gXCJAZmlyZWJhc2UvcGVyZm9ybWFuY2UtY29tcGF0XCI7XG5cbmNvbnN0IG5hbWUkNiA9IFwiQGZpcmViYXNlL3JlbW90ZS1jb25maWdcIjtcblxuY29uc3QgbmFtZSQ1ID0gXCJAZmlyZWJhc2UvcmVtb3RlLWNvbmZpZy1jb21wYXRcIjtcblxuY29uc3QgbmFtZSQ0ID0gXCJAZmlyZWJhc2Uvc3RvcmFnZVwiO1xuXG5jb25zdCBuYW1lJDMgPSBcIkBmaXJlYmFzZS9zdG9yYWdlLWNvbXBhdFwiO1xuXG5jb25zdCBuYW1lJDIgPSBcIkBmaXJlYmFzZS9maXJlc3RvcmVcIjtcblxuY29uc3QgbmFtZSQxID0gXCJAZmlyZWJhc2UvZmlyZXN0b3JlLWNvbXBhdFwiO1xuXG5jb25zdCBuYW1lID0gXCJmaXJlYmFzZVwiO1xuY29uc3QgdmVyc2lvbiA9IFwiOS4wLjBcIjtcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFRoZSBkZWZhdWx0IGFwcCBuYW1lXHJcbiAqXHJcbiAqIEBpbnRlcm5hbFxyXG4gKi9cclxuY29uc3QgREVGQVVMVF9FTlRSWV9OQU1FID0gJ1tERUZBVUxUXSc7XHJcbmNvbnN0IFBMQVRGT1JNX0xPR19TVFJJTkcgPSB7XHJcbiAgICBbbmFtZSRvXTogJ2ZpcmUtY29yZScsXHJcbiAgICBbbmFtZSRuXTogJ2ZpcmUtY29yZS1jb21wYXQnLFxyXG4gICAgW25hbWUkbF06ICdmaXJlLWFuYWx5dGljcycsXHJcbiAgICBbbmFtZSRtXTogJ2ZpcmUtYW5hbHl0aWNzLWNvbXBhdCcsXHJcbiAgICBbbmFtZSRqXTogJ2ZpcmUtYXBwLWNoZWNrJyxcclxuICAgIFtuYW1lJGtdOiAnZmlyZS1hcHAtY2hlY2stY29tcGF0JyxcclxuICAgIFtuYW1lJGldOiAnZmlyZS1hdXRoJyxcclxuICAgIFtuYW1lJGhdOiAnZmlyZS1hdXRoLWNvbXBhdCcsXHJcbiAgICBbbmFtZSRnXTogJ2ZpcmUtcnRkYicsXHJcbiAgICBbbmFtZSRmXTogJ2ZpcmUtcnRkYi1jb21wYXQnLFxyXG4gICAgW25hbWUkZV06ICdmaXJlLWZuJyxcclxuICAgIFtuYW1lJGRdOiAnZmlyZS1mbi1jb21wYXQnLFxyXG4gICAgW25hbWUkY106ICdmaXJlLWlpZCcsXHJcbiAgICBbbmFtZSRiXTogJ2ZpcmUtaWlkLWNvbXBhdCcsXHJcbiAgICBbbmFtZSRhXTogJ2ZpcmUtZmNtJyxcclxuICAgIFtuYW1lJDldOiAnZmlyZS1mY20tY29tcGF0JyxcclxuICAgIFtuYW1lJDhdOiAnZmlyZS1wZXJmJyxcclxuICAgIFtuYW1lJDddOiAnZmlyZS1wZXJmLWNvbXBhdCcsXHJcbiAgICBbbmFtZSQ2XTogJ2ZpcmUtcmMnLFxyXG4gICAgW25hbWUkNV06ICdmaXJlLXJjLWNvbXBhdCcsXHJcbiAgICBbbmFtZSQ0XTogJ2ZpcmUtZ2NzJyxcclxuICAgIFtuYW1lJDNdOiAnZmlyZS1nY3MtY29tcGF0JyxcclxuICAgIFtuYW1lJDJdOiAnZmlyZS1mc3QnLFxyXG4gICAgW25hbWUkMV06ICdmaXJlLWZzdC1jb21wYXQnLFxyXG4gICAgJ2ZpcmUtanMnOiAnZmlyZS1qcycsXHJcbiAgICBbbmFtZV06ICdmaXJlLWpzLWFsbCdcclxufTtcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEBpbnRlcm5hbFxyXG4gKi9cclxuY29uc3QgX2FwcHMgPSBuZXcgTWFwKCk7XHJcbi8qKlxyXG4gKiBSZWdpc3RlcmVkIGNvbXBvbmVudHMuXHJcbiAqXHJcbiAqIEBpbnRlcm5hbFxyXG4gKi9cclxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcclxuY29uc3QgX2NvbXBvbmVudHMgPSBuZXcgTWFwKCk7XHJcbi8qKlxyXG4gKiBAcGFyYW0gY29tcG9uZW50IC0gdGhlIGNvbXBvbmVudCBiZWluZyBhZGRlZCB0byB0aGlzIGFwcCdzIGNvbnRhaW5lclxyXG4gKlxyXG4gKiBAaW50ZXJuYWxcclxuICovXHJcbmZ1bmN0aW9uIF9hZGRDb21wb25lbnQoYXBwLCBjb21wb25lbnQpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXBwLmNvbnRhaW5lci5hZGRDb21wb25lbnQoY29tcG9uZW50KTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgbG9nZ2VyLmRlYnVnKGBDb21wb25lbnQgJHtjb21wb25lbnQubmFtZX0gZmFpbGVkIHRvIHJlZ2lzdGVyIHdpdGggRmlyZWJhc2VBcHAgJHthcHAubmFtZX1gLCBlKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICpcclxuICogQGludGVybmFsXHJcbiAqL1xyXG5mdW5jdGlvbiBfYWRkT3JPdmVyd3JpdGVDb21wb25lbnQoYXBwLCBjb21wb25lbnQpIHtcclxuICAgIGFwcC5jb250YWluZXIuYWRkT3JPdmVyd3JpdGVDb21wb25lbnQoY29tcG9uZW50KTtcclxufVxyXG4vKipcclxuICpcclxuICogQHBhcmFtIGNvbXBvbmVudCAtIHRoZSBjb21wb25lbnQgdG8gcmVnaXN0ZXJcclxuICogQHJldHVybnMgd2hldGhlciBvciBub3QgdGhlIGNvbXBvbmVudCBpcyByZWdpc3RlcmVkIHN1Y2Nlc3NmdWxseVxyXG4gKlxyXG4gKiBAaW50ZXJuYWxcclxuICovXHJcbmZ1bmN0aW9uIF9yZWdpc3RlckNvbXBvbmVudChjb21wb25lbnQpIHtcclxuICAgIGNvbnN0IGNvbXBvbmVudE5hbWUgPSBjb21wb25lbnQubmFtZTtcclxuICAgIGlmIChfY29tcG9uZW50cy5oYXMoY29tcG9uZW50TmFtZSkpIHtcclxuICAgICAgICBsb2dnZXIuZGVidWcoYFRoZXJlIHdlcmUgbXVsdGlwbGUgYXR0ZW1wdHMgdG8gcmVnaXN0ZXIgY29tcG9uZW50ICR7Y29tcG9uZW50TmFtZX0uYCk7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgX2NvbXBvbmVudHMuc2V0KGNvbXBvbmVudE5hbWUsIGNvbXBvbmVudCk7XHJcbiAgICAvLyBhZGQgdGhlIGNvbXBvbmVudCB0byBleGlzdGluZyBhcHAgaW5zdGFuY2VzXHJcbiAgICBmb3IgKGNvbnN0IGFwcCBvZiBfYXBwcy52YWx1ZXMoKSkge1xyXG4gICAgICAgIF9hZGRDb21wb25lbnQoYXBwLCBjb21wb25lbnQpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbn1cclxuLyoqXHJcbiAqXHJcbiAqIEBwYXJhbSBhcHAgLSBGaXJlYmFzZUFwcCBpbnN0YW5jZVxyXG4gKiBAcGFyYW0gbmFtZSAtIHNlcnZpY2UgbmFtZVxyXG4gKlxyXG4gKiBAcmV0dXJucyB0aGUgcHJvdmlkZXIgZm9yIHRoZSBzZXJ2aWNlIHdpdGggdGhlIG1hdGNoaW5nIG5hbWVcclxuICpcclxuICogQGludGVybmFsXHJcbiAqL1xyXG5mdW5jdGlvbiBfZ2V0UHJvdmlkZXIoYXBwLCBuYW1lKSB7XHJcbiAgICByZXR1cm4gYXBwLmNvbnRhaW5lci5nZXRQcm92aWRlcihuYW1lKTtcclxufVxyXG4vKipcclxuICpcclxuICogQHBhcmFtIGFwcCAtIEZpcmViYXNlQXBwIGluc3RhbmNlXHJcbiAqIEBwYXJhbSBuYW1lIC0gc2VydmljZSBuYW1lXHJcbiAqIEBwYXJhbSBpbnN0YW5jZUlkZW50aWZpZXIgLSBzZXJ2aWNlIGluc3RhbmNlIGlkZW50aWZpZXIgaW4gY2FzZSB0aGUgc2VydmljZSBzdXBwb3J0cyBtdWx0aXBsZSBpbnN0YW5jZXNcclxuICpcclxuICogQGludGVybmFsXHJcbiAqL1xyXG5mdW5jdGlvbiBfcmVtb3ZlU2VydmljZUluc3RhbmNlKGFwcCwgbmFtZSwgaW5zdGFuY2VJZGVudGlmaWVyID0gREVGQVVMVF9FTlRSWV9OQU1FKSB7XHJcbiAgICBfZ2V0UHJvdmlkZXIoYXBwLCBuYW1lKS5jbGVhckluc3RhbmNlKGluc3RhbmNlSWRlbnRpZmllcik7XHJcbn1cclxuLyoqXHJcbiAqIFRlc3Qgb25seVxyXG4gKlxyXG4gKiBAaW50ZXJuYWxcclxuICovXHJcbmZ1bmN0aW9uIF9jbGVhckNvbXBvbmVudHMoKSB7XHJcbiAgICBfY29tcG9uZW50cy5jbGVhcigpO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmNvbnN0IEVSUk9SUyA9IHtcclxuICAgIFtcIm5vLWFwcFwiIC8qIE5PX0FQUCAqL106IFwiTm8gRmlyZWJhc2UgQXBwICd7JGFwcE5hbWV9JyBoYXMgYmVlbiBjcmVhdGVkIC0gXCIgK1xyXG4gICAgICAgICdjYWxsIEZpcmViYXNlIEFwcC5pbml0aWFsaXplQXBwKCknLFxyXG4gICAgW1wiYmFkLWFwcC1uYW1lXCIgLyogQkFEX0FQUF9OQU1FICovXTogXCJJbGxlZ2FsIEFwcCBuYW1lOiAneyRhcHBOYW1lfVwiLFxyXG4gICAgW1wiZHVwbGljYXRlLWFwcFwiIC8qIERVUExJQ0FURV9BUFAgKi9dOiBcIkZpcmViYXNlIEFwcCBuYW1lZCAneyRhcHBOYW1lfScgYWxyZWFkeSBleGlzdHMgd2l0aCBkaWZmZXJlbnQgb3B0aW9ucyBvciBjb25maWdcIixcclxuICAgIFtcImFwcC1kZWxldGVkXCIgLyogQVBQX0RFTEVURUQgKi9dOiBcIkZpcmViYXNlIEFwcCBuYW1lZCAneyRhcHBOYW1lfScgYWxyZWFkeSBkZWxldGVkXCIsXHJcbiAgICBbXCJpbnZhbGlkLWFwcC1hcmd1bWVudFwiIC8qIElOVkFMSURfQVBQX0FSR1VNRU5UICovXTogJ2ZpcmViYXNlLnskYXBwTmFtZX0oKSB0YWtlcyBlaXRoZXIgbm8gYXJndW1lbnQgb3IgYSAnICtcclxuICAgICAgICAnRmlyZWJhc2UgQXBwIGluc3RhbmNlLicsXHJcbiAgICBbXCJpbnZhbGlkLWxvZy1hcmd1bWVudFwiIC8qIElOVkFMSURfTE9HX0FSR1VNRU5UICovXTogJ0ZpcnN0IGFyZ3VtZW50IHRvIGBvbkxvZ2AgbXVzdCBiZSBudWxsIG9yIGEgZnVuY3Rpb24uJ1xyXG59O1xyXG5jb25zdCBFUlJPUl9GQUNUT1JZID0gbmV3IEVycm9yRmFjdG9yeSgnYXBwJywgJ0ZpcmViYXNlJywgRVJST1JTKTtcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuY2xhc3MgRmlyZWJhc2VBcHBJbXBsIHtcclxuICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMsIGNvbmZpZywgY29udGFpbmVyKSB7XHJcbiAgICAgICAgdGhpcy5faXNEZWxldGVkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe30sIG9wdGlvbnMpO1xyXG4gICAgICAgIHRoaXMuX2NvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIGNvbmZpZyk7XHJcbiAgICAgICAgdGhpcy5fbmFtZSA9IGNvbmZpZy5uYW1lO1xyXG4gICAgICAgIHRoaXMuX2F1dG9tYXRpY0RhdGFDb2xsZWN0aW9uRW5hYmxlZCA9XHJcbiAgICAgICAgICAgIGNvbmZpZy5hdXRvbWF0aWNEYXRhQ29sbGVjdGlvbkVuYWJsZWQ7XHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyID0gY29udGFpbmVyO1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyLmFkZENvbXBvbmVudChuZXcgQ29tcG9uZW50KCdhcHAnLCAoKSA9PiB0aGlzLCBcIlBVQkxJQ1wiIC8qIFBVQkxJQyAqLykpO1xyXG4gICAgfVxyXG4gICAgZ2V0IGF1dG9tYXRpY0RhdGFDb2xsZWN0aW9uRW5hYmxlZCgpIHtcclxuICAgICAgICB0aGlzLmNoZWNrRGVzdHJveWVkKCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2F1dG9tYXRpY0RhdGFDb2xsZWN0aW9uRW5hYmxlZDtcclxuICAgIH1cclxuICAgIHNldCBhdXRvbWF0aWNEYXRhQ29sbGVjdGlvbkVuYWJsZWQodmFsKSB7XHJcbiAgICAgICAgdGhpcy5jaGVja0Rlc3Ryb3llZCgpO1xyXG4gICAgICAgIHRoaXMuX2F1dG9tYXRpY0RhdGFDb2xsZWN0aW9uRW5hYmxlZCA9IHZhbDtcclxuICAgIH1cclxuICAgIGdldCBuYW1lKCkge1xyXG4gICAgICAgIHRoaXMuY2hlY2tEZXN0cm95ZWQoKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5fbmFtZTtcclxuICAgIH1cclxuICAgIGdldCBvcHRpb25zKCkge1xyXG4gICAgICAgIHRoaXMuY2hlY2tEZXN0cm95ZWQoKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5fb3B0aW9ucztcclxuICAgIH1cclxuICAgIGdldCBjb25maWcoKSB7XHJcbiAgICAgICAgdGhpcy5jaGVja0Rlc3Ryb3llZCgpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9jb25maWc7XHJcbiAgICB9XHJcbiAgICBnZXQgY29udGFpbmVyKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9jb250YWluZXI7XHJcbiAgICB9XHJcbiAgICBnZXQgaXNEZWxldGVkKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9pc0RlbGV0ZWQ7XHJcbiAgICB9XHJcbiAgICBzZXQgaXNEZWxldGVkKHZhbCkge1xyXG4gICAgICAgIHRoaXMuX2lzRGVsZXRlZCA9IHZhbDtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogVGhpcyBmdW5jdGlvbiB3aWxsIHRocm93IGFuIEVycm9yIGlmIHRoZSBBcHAgaGFzIGFscmVhZHkgYmVlbiBkZWxldGVkIC1cclxuICAgICAqIHVzZSBiZWZvcmUgcGVyZm9ybWluZyBBUEkgYWN0aW9ucyBvbiB0aGUgQXBwLlxyXG4gICAgICovXHJcbiAgICBjaGVja0Rlc3Ryb3llZCgpIHtcclxuICAgICAgICBpZiAodGhpcy5pc0RlbGV0ZWQpIHtcclxuICAgICAgICAgICAgdGhyb3cgRVJST1JfRkFDVE9SWS5jcmVhdGUoXCJhcHAtZGVsZXRlZFwiIC8qIEFQUF9ERUxFVEVEICovLCB7IGFwcE5hbWU6IHRoaXMuX25hbWUgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBUaGUgY3VycmVudCBTREsgdmVyc2lvbi5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuY29uc3QgU0RLX1ZFUlNJT04gPSB2ZXJzaW9uO1xyXG5mdW5jdGlvbiBpbml0aWFsaXplQXBwKG9wdGlvbnMsIHJhd0NvbmZpZyA9IHt9KSB7XHJcbiAgICBpZiAodHlwZW9mIHJhd0NvbmZpZyAhPT0gJ29iamVjdCcpIHtcclxuICAgICAgICBjb25zdCBuYW1lID0gcmF3Q29uZmlnO1xyXG4gICAgICAgIHJhd0NvbmZpZyA9IHsgbmFtZSB9O1xyXG4gICAgfVxyXG4gICAgY29uc3QgY29uZmlnID0gT2JqZWN0LmFzc2lnbih7IG5hbWU6IERFRkFVTFRfRU5UUllfTkFNRSwgYXV0b21hdGljRGF0YUNvbGxlY3Rpb25FbmFibGVkOiBmYWxzZSB9LCByYXdDb25maWcpO1xyXG4gICAgY29uc3QgbmFtZSA9IGNvbmZpZy5uYW1lO1xyXG4gICAgaWYgKHR5cGVvZiBuYW1lICE9PSAnc3RyaW5nJyB8fCAhbmFtZSkge1xyXG4gICAgICAgIHRocm93IEVSUk9SX0ZBQ1RPUlkuY3JlYXRlKFwiYmFkLWFwcC1uYW1lXCIgLyogQkFEX0FQUF9OQU1FICovLCB7XHJcbiAgICAgICAgICAgIGFwcE5hbWU6IFN0cmluZyhuYW1lKVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgY29uc3QgZXhpc3RpbmdBcHAgPSBfYXBwcy5nZXQobmFtZSk7XHJcbiAgICBpZiAoZXhpc3RpbmdBcHApIHtcclxuICAgICAgICAvLyByZXR1cm4gdGhlIGV4aXN0aW5nIGFwcCBpZiBvcHRpb25zIGFuZCBjb25maWcgZGVlcCBlcXVhbCB0aGUgb25lcyBpbiB0aGUgZXhpc3RpbmcgYXBwLlxyXG4gICAgICAgIGlmIChkZWVwRXF1YWwob3B0aW9ucywgZXhpc3RpbmdBcHAub3B0aW9ucykgJiZcclxuICAgICAgICAgICAgZGVlcEVxdWFsKGNvbmZpZywgZXhpc3RpbmdBcHAuY29uZmlnKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZXhpc3RpbmdBcHA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aHJvdyBFUlJPUl9GQUNUT1JZLmNyZWF0ZShcImR1cGxpY2F0ZS1hcHBcIiAvKiBEVVBMSUNBVEVfQVBQICovLCB7IGFwcE5hbWU6IG5hbWUgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgY29uc3QgY29udGFpbmVyID0gbmV3IENvbXBvbmVudENvbnRhaW5lcihuYW1lKTtcclxuICAgIGZvciAoY29uc3QgY29tcG9uZW50IG9mIF9jb21wb25lbnRzLnZhbHVlcygpKSB7XHJcbiAgICAgICAgY29udGFpbmVyLmFkZENvbXBvbmVudChjb21wb25lbnQpO1xyXG4gICAgfVxyXG4gICAgY29uc3QgbmV3QXBwID0gbmV3IEZpcmViYXNlQXBwSW1wbChvcHRpb25zLCBjb25maWcsIGNvbnRhaW5lcik7XHJcbiAgICBfYXBwcy5zZXQobmFtZSwgbmV3QXBwKTtcclxuICAgIHJldHVybiBuZXdBcHA7XHJcbn1cclxuLyoqXHJcbiAqIFJldHJpZXZlcyBhIHtAbGluayBAZmlyZWJhc2UvYXBwI0ZpcmViYXNlQXBwfSBpbnN0YW5jZS5cclxuICpcclxuICogV2hlbiBjYWxsZWQgd2l0aCBubyBhcmd1bWVudHMsIHRoZSBkZWZhdWx0IGFwcCBpcyByZXR1cm5lZC4gV2hlbiBhbiBhcHAgbmFtZVxyXG4gKiBpcyBwcm92aWRlZCwgdGhlIGFwcCBjb3JyZXNwb25kaW5nIHRvIHRoYXQgbmFtZSBpcyByZXR1cm5lZC5cclxuICpcclxuICogQW4gZXhjZXB0aW9uIGlzIHRocm93biBpZiB0aGUgYXBwIGJlaW5nIHJldHJpZXZlZCBoYXMgbm90IHlldCBiZWVuXHJcbiAqIGluaXRpYWxpemVkLlxyXG4gKlxyXG4gKiBAZXhhbXBsZVxyXG4gKiBgYGBqYXZhc2NyaXB0XHJcbiAqIC8vIFJldHVybiB0aGUgZGVmYXVsdCBhcHBcclxuICogY29uc3QgYXBwID0gZ2V0QXBwKCk7XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBAZXhhbXBsZVxyXG4gKiBgYGBqYXZhc2NyaXB0XHJcbiAqIC8vIFJldHVybiBhIG5hbWVkIGFwcFxyXG4gKiBjb25zdCBvdGhlckFwcCA9IGdldEFwcChcIm90aGVyQXBwXCIpO1xyXG4gKiBgYGBcclxuICpcclxuICogQHBhcmFtIG5hbWUgLSBPcHRpb25hbCBuYW1lIG9mIHRoZSBhcHAgdG8gcmV0dXJuLiBJZiBubyBuYW1lIGlzXHJcbiAqICAgcHJvdmlkZWQsIHRoZSBkZWZhdWx0IGlzIGBcIltERUZBVUxUXVwiYC5cclxuICpcclxuICogQHJldHVybnMgVGhlIGFwcCBjb3JyZXNwb25kaW5nIHRvIHRoZSBwcm92aWRlZCBhcHAgbmFtZS5cclxuICogICBJZiBubyBhcHAgbmFtZSBpcyBwcm92aWRlZCwgdGhlIGRlZmF1bHQgYXBwIGlzIHJldHVybmVkLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5mdW5jdGlvbiBnZXRBcHAobmFtZSA9IERFRkFVTFRfRU5UUllfTkFNRSkge1xyXG4gICAgY29uc3QgYXBwID0gX2FwcHMuZ2V0KG5hbWUpO1xyXG4gICAgaWYgKCFhcHApIHtcclxuICAgICAgICB0aHJvdyBFUlJPUl9GQUNUT1JZLmNyZWF0ZShcIm5vLWFwcFwiIC8qIE5PX0FQUCAqLywgeyBhcHBOYW1lOiBuYW1lIH0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFwcDtcclxufVxyXG4vKipcclxuICogQSAocmVhZC1vbmx5KSBhcnJheSBvZiBhbGwgaW5pdGlhbGl6ZWQgYXBwcy5cclxuICogQHB1YmxpY1xyXG4gKi9cclxuZnVuY3Rpb24gZ2V0QXBwcygpIHtcclxuICAgIHJldHVybiBBcnJheS5mcm9tKF9hcHBzLnZhbHVlcygpKTtcclxufVxyXG4vKipcclxuICogUmVuZGVycyB0aGlzIGFwcCB1bnVzYWJsZSBhbmQgZnJlZXMgdGhlIHJlc291cmNlcyBvZiBhbGwgYXNzb2NpYXRlZFxyXG4gKiBzZXJ2aWNlcy5cclxuICpcclxuICogQGV4YW1wbGVcclxuICogYGBgamF2YXNjcmlwdFxyXG4gKiBkZWxldGVBcHAoYXBwKVxyXG4gKiAgIC50aGVuKGZ1bmN0aW9uKCkge1xyXG4gKiAgICAgY29uc29sZS5sb2coXCJBcHAgZGVsZXRlZCBzdWNjZXNzZnVsbHlcIik7XHJcbiAqICAgfSlcclxuICogICAuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHtcclxuICogICAgIGNvbnNvbGUubG9nKFwiRXJyb3IgZGVsZXRpbmcgYXBwOlwiLCBlcnJvcik7XHJcbiAqICAgfSk7XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBkZWxldGVBcHAoYXBwKSB7XHJcbiAgICBjb25zdCBuYW1lID0gYXBwLm5hbWU7XHJcbiAgICBpZiAoX2FwcHMuaGFzKG5hbWUpKSB7XHJcbiAgICAgICAgX2FwcHMuZGVsZXRlKG5hbWUpO1xyXG4gICAgICAgIGF3YWl0IFByb21pc2UuYWxsKGFwcC5jb250YWluZXJcclxuICAgICAgICAgICAgLmdldFByb3ZpZGVycygpXHJcbiAgICAgICAgICAgIC5tYXAocHJvdmlkZXIgPT4gcHJvdmlkZXIuZGVsZXRlKCkpKTtcclxuICAgICAgICBhcHAuaXNEZWxldGVkID0gdHJ1ZTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogUmVnaXN0ZXJzIGEgbGlicmFyeSdzIG5hbWUgYW5kIHZlcnNpb24gZm9yIHBsYXRmb3JtIGxvZ2dpbmcgcHVycG9zZXMuXHJcbiAqIEBwYXJhbSBsaWJyYXJ5IC0gTmFtZSBvZiAxcCBvciAzcCBsaWJyYXJ5IChlLmcuIGZpcmVzdG9yZSwgYW5ndWxhcmZpcmUpXHJcbiAqIEBwYXJhbSB2ZXJzaW9uIC0gQ3VycmVudCB2ZXJzaW9uIG9mIHRoYXQgbGlicmFyeS5cclxuICogQHBhcmFtIHZhcmlhbnQgLSBCdW5kbGUgdmFyaWFudCwgZS5nLiwgbm9kZSwgcm4sIGV0Yy5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuZnVuY3Rpb24gcmVnaXN0ZXJWZXJzaW9uKGxpYnJhcnlLZXlPck5hbWUsIHZlcnNpb24sIHZhcmlhbnQpIHtcclxuICAgIHZhciBfYTtcclxuICAgIC8vIFRPRE86IFdlIGNhbiB1c2UgdGhpcyBjaGVjayB0byB3aGl0ZWxpc3Qgc3RyaW5ncyB3aGVuL2lmIHdlIHNldCB1cFxyXG4gICAgLy8gYSBnb29kIHdoaXRlbGlzdCBzeXN0ZW0uXHJcbiAgICBsZXQgbGlicmFyeSA9IChfYSA9IFBMQVRGT1JNX0xPR19TVFJJTkdbbGlicmFyeUtleU9yTmFtZV0pICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IGxpYnJhcnlLZXlPck5hbWU7XHJcbiAgICBpZiAodmFyaWFudCkge1xyXG4gICAgICAgIGxpYnJhcnkgKz0gYC0ke3ZhcmlhbnR9YDtcclxuICAgIH1cclxuICAgIGNvbnN0IGxpYnJhcnlNaXNtYXRjaCA9IGxpYnJhcnkubWF0Y2goL1xcc3xcXC8vKTtcclxuICAgIGNvbnN0IHZlcnNpb25NaXNtYXRjaCA9IHZlcnNpb24ubWF0Y2goL1xcc3xcXC8vKTtcclxuICAgIGlmIChsaWJyYXJ5TWlzbWF0Y2ggfHwgdmVyc2lvbk1pc21hdGNoKSB7XHJcbiAgICAgICAgY29uc3Qgd2FybmluZyA9IFtcclxuICAgICAgICAgICAgYFVuYWJsZSB0byByZWdpc3RlciBsaWJyYXJ5IFwiJHtsaWJyYXJ5fVwiIHdpdGggdmVyc2lvbiBcIiR7dmVyc2lvbn1cIjpgXHJcbiAgICAgICAgXTtcclxuICAgICAgICBpZiAobGlicmFyeU1pc21hdGNoKSB7XHJcbiAgICAgICAgICAgIHdhcm5pbmcucHVzaChgbGlicmFyeSBuYW1lIFwiJHtsaWJyYXJ5fVwiIGNvbnRhaW5zIGlsbGVnYWwgY2hhcmFjdGVycyAod2hpdGVzcGFjZSBvciBcIi9cIilgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGxpYnJhcnlNaXNtYXRjaCAmJiB2ZXJzaW9uTWlzbWF0Y2gpIHtcclxuICAgICAgICAgICAgd2FybmluZy5wdXNoKCdhbmQnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHZlcnNpb25NaXNtYXRjaCkge1xyXG4gICAgICAgICAgICB3YXJuaW5nLnB1c2goYHZlcnNpb24gbmFtZSBcIiR7dmVyc2lvbn1cIiBjb250YWlucyBpbGxlZ2FsIGNoYXJhY3RlcnMgKHdoaXRlc3BhY2Ugb3IgXCIvXCIpYCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxvZ2dlci53YXJuKHdhcm5pbmcuam9pbignICcpKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBfcmVnaXN0ZXJDb21wb25lbnQobmV3IENvbXBvbmVudChgJHtsaWJyYXJ5fS12ZXJzaW9uYCwgKCkgPT4gKHsgbGlicmFyeSwgdmVyc2lvbiB9KSwgXCJWRVJTSU9OXCIgLyogVkVSU0lPTiAqLykpO1xyXG59XHJcbi8qKlxyXG4gKiBTZXRzIGxvZyBoYW5kbGVyIGZvciBhbGwgRmlyZWJhc2UgU0RLcy5cclxuICogQHBhcmFtIGxvZ0NhbGxiYWNrIC0gQW4gb3B0aW9uYWwgY3VzdG9tIGxvZyBoYW5kbGVyIHRoYXQgZXhlY3V0ZXMgdXNlciBjb2RlIHdoZW5ldmVyXHJcbiAqIHRoZSBGaXJlYmFzZSBTREsgbWFrZXMgYSBsb2dnaW5nIGNhbGwuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmZ1bmN0aW9uIG9uTG9nKGxvZ0NhbGxiYWNrLCBvcHRpb25zKSB7XHJcbiAgICBpZiAobG9nQ2FsbGJhY2sgIT09IG51bGwgJiYgdHlwZW9mIGxvZ0NhbGxiYWNrICE9PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgdGhyb3cgRVJST1JfRkFDVE9SWS5jcmVhdGUoXCJpbnZhbGlkLWxvZy1hcmd1bWVudFwiIC8qIElOVkFMSURfTE9HX0FSR1VNRU5UICovKTtcclxuICAgIH1cclxuICAgIHNldFVzZXJMb2dIYW5kbGVyKGxvZ0NhbGxiYWNrLCBvcHRpb25zKTtcclxufVxyXG4vKipcclxuICogU2V0cyBsb2cgbGV2ZWwgZm9yIGFsbCBGaXJlYmFzZSBTREtzLlxyXG4gKlxyXG4gKiBBbGwgb2YgdGhlIGxvZyB0eXBlcyBhYm92ZSB0aGUgY3VycmVudCBsb2cgbGV2ZWwgYXJlIGNhcHR1cmVkIChpLmUuIGlmXHJcbiAqIHlvdSBzZXQgdGhlIGxvZyBsZXZlbCB0byBgaW5mb2AsIGVycm9ycyBhcmUgbG9nZ2VkLCBidXQgYGRlYnVnYCBhbmRcclxuICogYHZlcmJvc2VgIGxvZ3MgYXJlIG5vdCkuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmZ1bmN0aW9uIHNldExvZ0xldmVsKGxvZ0xldmVsKSB7XHJcbiAgICBzZXRMb2dMZXZlbCQxKGxvZ0xldmVsKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5mdW5jdGlvbiByZWdpc3RlckNvcmVDb21wb25lbnRzKHZhcmlhbnQpIHtcclxuICAgIF9yZWdpc3RlckNvbXBvbmVudChuZXcgQ29tcG9uZW50KCdwbGF0Zm9ybS1sb2dnZXInLCBjb250YWluZXIgPT4gbmV3IFBsYXRmb3JtTG9nZ2VyU2VydmljZUltcGwoY29udGFpbmVyKSwgXCJQUklWQVRFXCIgLyogUFJJVkFURSAqLykpO1xyXG4gICAgLy8gUmVnaXN0ZXIgYGFwcGAgcGFja2FnZS5cclxuICAgIHJlZ2lzdGVyVmVyc2lvbihuYW1lJG8sIHZlcnNpb24kMSwgdmFyaWFudCk7XHJcbiAgICAvLyBSZWdpc3RlciBwbGF0Zm9ybSBTREsgaWRlbnRpZmllciAobm8gdmVyc2lvbikuXHJcbiAgICByZWdpc3RlclZlcnNpb24oJ2ZpcmUtanMnLCAnJyk7XHJcbn1cblxuLyoqXHJcbiAqIEZpcmViYXNlIEFwcFxyXG4gKlxyXG4gKiBAcmVtYXJrcyBUaGlzIHBhY2thZ2UgY29vcmRpbmF0ZXMgdGhlIGNvbW11bmljYXRpb24gYmV0d2VlbiB0aGUgZGlmZmVyZW50IEZpcmViYXNlIGNvbXBvbmVudHNcclxuICogQHBhY2thZ2VEb2N1bWVudGF0aW9uXHJcbiAqL1xyXG5yZWdpc3RlckNvcmVDb21wb25lbnRzKCk7XG5cbmV4cG9ydCB7IFNES19WRVJTSU9OLCBERUZBVUxUX0VOVFJZX05BTUUgYXMgX0RFRkFVTFRfRU5UUllfTkFNRSwgX2FkZENvbXBvbmVudCwgX2FkZE9yT3ZlcndyaXRlQ29tcG9uZW50LCBfYXBwcywgX2NsZWFyQ29tcG9uZW50cywgX2NvbXBvbmVudHMsIF9nZXRQcm92aWRlciwgX3JlZ2lzdGVyQ29tcG9uZW50LCBfcmVtb3ZlU2VydmljZUluc3RhbmNlLCBkZWxldGVBcHAsIGdldEFwcCwgZ2V0QXBwcywgaW5pdGlhbGl6ZUFwcCwgb25Mb2csIHJlZ2lzdGVyVmVyc2lvbiwgc2V0TG9nTGV2ZWwgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmVzbTIwMTcuanMubWFwXG4iLCIvKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZVxyXG50aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZVxyXG5MaWNlbnNlIGF0IGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG5cclxuVEhJUyBDT0RFIElTIFBST1ZJREVEIE9OIEFOICpBUyBJUyogQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxyXG5LSU5ELCBFSVRIRVIgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgV0lUSE9VVCBMSU1JVEFUSU9OIEFOWSBJTVBMSUVEXHJcbldBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBUSVRMRSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UsXHJcbk1FUkNIQU5UQUJMSVRZIE9SIE5PTi1JTkZSSU5HRU1FTlQuXHJcblxyXG5TZWUgdGhlIEFwYWNoZSBWZXJzaW9uIDIuMCBMaWNlbnNlIGZvciBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnNcclxuYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG5cclxuZnVuY3Rpb24gX19zcHJlYWRBcnJheXMoKSB7XHJcbiAgICBmb3IgKHZhciBzID0gMCwgaSA9IDAsIGlsID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IGlsOyBpKyspIHMgKz0gYXJndW1lbnRzW2ldLmxlbmd0aDtcclxuICAgIGZvciAodmFyIHIgPSBBcnJheShzKSwgayA9IDAsIGkgPSAwOyBpIDwgaWw7IGkrKylcclxuICAgICAgICBmb3IgKHZhciBhID0gYXJndW1lbnRzW2ldLCBqID0gMCwgamwgPSBhLmxlbmd0aDsgaiA8IGpsOyBqKyssIGsrKylcclxuICAgICAgICAgICAgcltrXSA9IGFbal07XHJcbiAgICByZXR1cm4gcjtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgX2E7XHJcbi8qKlxyXG4gKiBBIGNvbnRhaW5lciBmb3IgYWxsIG9mIHRoZSBMb2dnZXIgaW5zdGFuY2VzXHJcbiAqL1xyXG52YXIgaW5zdGFuY2VzID0gW107XHJcbi8qKlxyXG4gKiBUaGUgSlMgU0RLIHN1cHBvcnRzIDUgbG9nIGxldmVscyBhbmQgYWxzbyBhbGxvd3MgYSB1c2VyIHRoZSBhYmlsaXR5IHRvXHJcbiAqIHNpbGVuY2UgdGhlIGxvZ3MgYWx0b2dldGhlci5cclxuICpcclxuICogVGhlIG9yZGVyIGlzIGEgZm9sbG93czpcclxuICogREVCVUcgPCBWRVJCT1NFIDwgSU5GTyA8IFdBUk4gPCBFUlJPUlxyXG4gKlxyXG4gKiBBbGwgb2YgdGhlIGxvZyB0eXBlcyBhYm92ZSB0aGUgY3VycmVudCBsb2cgbGV2ZWwgd2lsbCBiZSBjYXB0dXJlZCAoaS5lLiBpZlxyXG4gKiB5b3Ugc2V0IHRoZSBsb2cgbGV2ZWwgdG8gYElORk9gLCBlcnJvcnMgd2lsbCBzdGlsbCBiZSBsb2dnZWQsIGJ1dCBgREVCVUdgIGFuZFxyXG4gKiBgVkVSQk9TRWAgbG9ncyB3aWxsIG5vdClcclxuICovXHJcbnZhciBMb2dMZXZlbDtcclxuKGZ1bmN0aW9uIChMb2dMZXZlbCkge1xyXG4gICAgTG9nTGV2ZWxbTG9nTGV2ZWxbXCJERUJVR1wiXSA9IDBdID0gXCJERUJVR1wiO1xyXG4gICAgTG9nTGV2ZWxbTG9nTGV2ZWxbXCJWRVJCT1NFXCJdID0gMV0gPSBcIlZFUkJPU0VcIjtcclxuICAgIExvZ0xldmVsW0xvZ0xldmVsW1wiSU5GT1wiXSA9IDJdID0gXCJJTkZPXCI7XHJcbiAgICBMb2dMZXZlbFtMb2dMZXZlbFtcIldBUk5cIl0gPSAzXSA9IFwiV0FSTlwiO1xyXG4gICAgTG9nTGV2ZWxbTG9nTGV2ZWxbXCJFUlJPUlwiXSA9IDRdID0gXCJFUlJPUlwiO1xyXG4gICAgTG9nTGV2ZWxbTG9nTGV2ZWxbXCJTSUxFTlRcIl0gPSA1XSA9IFwiU0lMRU5UXCI7XHJcbn0pKExvZ0xldmVsIHx8IChMb2dMZXZlbCA9IHt9KSk7XHJcbnZhciBsZXZlbFN0cmluZ1RvRW51bSA9IHtcclxuICAgICdkZWJ1Zyc6IExvZ0xldmVsLkRFQlVHLFxyXG4gICAgJ3ZlcmJvc2UnOiBMb2dMZXZlbC5WRVJCT1NFLFxyXG4gICAgJ2luZm8nOiBMb2dMZXZlbC5JTkZPLFxyXG4gICAgJ3dhcm4nOiBMb2dMZXZlbC5XQVJOLFxyXG4gICAgJ2Vycm9yJzogTG9nTGV2ZWwuRVJST1IsXHJcbiAgICAnc2lsZW50JzogTG9nTGV2ZWwuU0lMRU5UXHJcbn07XHJcbi8qKlxyXG4gKiBUaGUgZGVmYXVsdCBsb2cgbGV2ZWxcclxuICovXHJcbnZhciBkZWZhdWx0TG9nTGV2ZWwgPSBMb2dMZXZlbC5JTkZPO1xyXG4vKipcclxuICogQnkgZGVmYXVsdCwgYGNvbnNvbGUuZGVidWdgIGlzIG5vdCBkaXNwbGF5ZWQgaW4gdGhlIGRldmVsb3BlciBjb25zb2xlIChpblxyXG4gKiBjaHJvbWUpLiBUbyBhdm9pZCBmb3JjaW5nIHVzZXJzIHRvIGhhdmUgdG8gb3B0LWluIHRvIHRoZXNlIGxvZ3MgdHdpY2VcclxuICogKGkuZS4gb25jZSBmb3IgZmlyZWJhc2UsIGFuZCBvbmNlIGluIHRoZSBjb25zb2xlKSwgd2UgYXJlIHNlbmRpbmcgYERFQlVHYFxyXG4gKiBsb2dzIHRvIHRoZSBgY29uc29sZS5sb2dgIGZ1bmN0aW9uLlxyXG4gKi9cclxudmFyIENvbnNvbGVNZXRob2QgPSAoX2EgPSB7fSxcclxuICAgIF9hW0xvZ0xldmVsLkRFQlVHXSA9ICdsb2cnLFxyXG4gICAgX2FbTG9nTGV2ZWwuVkVSQk9TRV0gPSAnbG9nJyxcclxuICAgIF9hW0xvZ0xldmVsLklORk9dID0gJ2luZm8nLFxyXG4gICAgX2FbTG9nTGV2ZWwuV0FSTl0gPSAnd2FybicsXHJcbiAgICBfYVtMb2dMZXZlbC5FUlJPUl0gPSAnZXJyb3InLFxyXG4gICAgX2EpO1xyXG4vKipcclxuICogVGhlIGRlZmF1bHQgbG9nIGhhbmRsZXIgd2lsbCBmb3J3YXJkIERFQlVHLCBWRVJCT1NFLCBJTkZPLCBXQVJOLCBhbmQgRVJST1JcclxuICogbWVzc2FnZXMgb24gdG8gdGhlaXIgY29ycmVzcG9uZGluZyBjb25zb2xlIGNvdW50ZXJwYXJ0cyAoaWYgdGhlIGxvZyBtZXRob2RcclxuICogaXMgc3VwcG9ydGVkIGJ5IHRoZSBjdXJyZW50IGxvZyBsZXZlbClcclxuICovXHJcbnZhciBkZWZhdWx0TG9nSGFuZGxlciA9IGZ1bmN0aW9uIChpbnN0YW5jZSwgbG9nVHlwZSkge1xyXG4gICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgIGZvciAodmFyIF9pID0gMjsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgYXJnc1tfaSAtIDJdID0gYXJndW1lbnRzW19pXTtcclxuICAgIH1cclxuICAgIGlmIChsb2dUeXBlIDwgaW5zdGFuY2UubG9nTGV2ZWwpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB2YXIgbm93ID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xyXG4gICAgdmFyIG1ldGhvZCA9IENvbnNvbGVNZXRob2RbbG9nVHlwZV07XHJcbiAgICBpZiAobWV0aG9kKSB7XHJcbiAgICAgICAgY29uc29sZVttZXRob2RdLmFwcGx5KGNvbnNvbGUsIF9fc3ByZWFkQXJyYXlzKFtcIltcIiArIG5vdyArIFwiXSAgXCIgKyBpbnN0YW5jZS5uYW1lICsgXCI6XCJdLCBhcmdzKSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBdHRlbXB0ZWQgdG8gbG9nIGEgbWVzc2FnZSB3aXRoIGFuIGludmFsaWQgbG9nVHlwZSAodmFsdWU6IFwiICsgbG9nVHlwZSArIFwiKVwiKTtcclxuICAgIH1cclxufTtcclxudmFyIExvZ2dlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIC8qKlxyXG4gICAgICogR2l2ZXMgeW91IGFuIGluc3RhbmNlIG9mIGEgTG9nZ2VyIHRvIGNhcHR1cmUgbWVzc2FnZXMgYWNjb3JkaW5nIHRvXHJcbiAgICAgKiBGaXJlYmFzZSdzIGxvZ2dpbmcgc2NoZW1lLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBuYW1lIFRoZSBuYW1lIHRoYXQgdGhlIGxvZ3Mgd2lsbCBiZSBhc3NvY2lhdGVkIHdpdGhcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gTG9nZ2VyKG5hbWUpIHtcclxuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRoZSBsb2cgbGV2ZWwgb2YgdGhlIGdpdmVuIExvZ2dlciBpbnN0YW5jZS5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLl9sb2dMZXZlbCA9IGRlZmF1bHRMb2dMZXZlbDtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBUaGUgbWFpbiAoaW50ZXJuYWwpIGxvZyBoYW5kbGVyIGZvciB0aGUgTG9nZ2VyIGluc3RhbmNlLlxyXG4gICAgICAgICAqIENhbiBiZSBzZXQgdG8gYSBuZXcgZnVuY3Rpb24gaW4gaW50ZXJuYWwgcGFja2FnZSBjb2RlIGJ1dCBub3QgYnkgdXNlci5cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLl9sb2dIYW5kbGVyID0gZGVmYXVsdExvZ0hhbmRsZXI7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIG9wdGlvbmFsLCBhZGRpdGlvbmFsLCB1c2VyLWRlZmluZWQgbG9nIGhhbmRsZXIgZm9yIHRoZSBMb2dnZXIgaW5zdGFuY2UuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5fdXNlckxvZ0hhbmRsZXIgPSBudWxsO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIENhcHR1cmUgdGhlIGN1cnJlbnQgaW5zdGFuY2UgZm9yIGxhdGVyIHVzZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGluc3RhbmNlcy5wdXNoKHRoaXMpO1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KExvZ2dlci5wcm90b3R5cGUsIFwibG9nTGV2ZWxcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbG9nTGV2ZWw7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWwpIHtcclxuICAgICAgICAgICAgaWYgKCEodmFsIGluIExvZ0xldmVsKSkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkludmFsaWQgdmFsdWUgXFxcIlwiICsgdmFsICsgXCJcXFwiIGFzc2lnbmVkIHRvIGBsb2dMZXZlbGBcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5fbG9nTGV2ZWwgPSB2YWw7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgLy8gV29ya2Fyb3VuZCBmb3Igc2V0dGVyL2dldHRlciBoYXZpbmcgdG8gYmUgdGhlIHNhbWUgdHlwZS5cclxuICAgIExvZ2dlci5wcm90b3R5cGUuc2V0TG9nTGV2ZWwgPSBmdW5jdGlvbiAodmFsKSB7XHJcbiAgICAgICAgdGhpcy5fbG9nTGV2ZWwgPSB0eXBlb2YgdmFsID09PSAnc3RyaW5nJyA/IGxldmVsU3RyaW5nVG9FbnVtW3ZhbF0gOiB2YWw7XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KExvZ2dlci5wcm90b3R5cGUsIFwibG9nSGFuZGxlclwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9sb2dIYW5kbGVyO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsKSB7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsICE9PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdWYWx1ZSBhc3NpZ25lZCB0byBgbG9nSGFuZGxlcmAgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5fbG9nSGFuZGxlciA9IHZhbDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTG9nZ2VyLnByb3RvdHlwZSwgXCJ1c2VyTG9nSGFuZGxlclwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl91c2VyTG9nSGFuZGxlcjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbCkge1xyXG4gICAgICAgICAgICB0aGlzLl91c2VyTG9nSGFuZGxlciA9IHZhbDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICAvKipcclxuICAgICAqIFRoZSBmdW5jdGlvbnMgYmVsb3cgYXJlIGFsbCBiYXNlZCBvbiB0aGUgYGNvbnNvbGVgIGludGVyZmFjZVxyXG4gICAgICovXHJcbiAgICBMb2dnZXIucHJvdG90eXBlLmRlYnVnID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBhcmdzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl91c2VyTG9nSGFuZGxlciAmJiB0aGlzLl91c2VyTG9nSGFuZGxlci5hcHBseSh0aGlzLCBfX3NwcmVhZEFycmF5cyhbdGhpcywgTG9nTGV2ZWwuREVCVUddLCBhcmdzKSk7XHJcbiAgICAgICAgdGhpcy5fbG9nSGFuZGxlci5hcHBseSh0aGlzLCBfX3NwcmVhZEFycmF5cyhbdGhpcywgTG9nTGV2ZWwuREVCVUddLCBhcmdzKSk7XHJcbiAgICB9O1xyXG4gICAgTG9nZ2VyLnByb3RvdHlwZS5sb2cgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX3VzZXJMb2dIYW5kbGVyICYmIHRoaXMuX3VzZXJMb2dIYW5kbGVyLmFwcGx5KHRoaXMsIF9fc3ByZWFkQXJyYXlzKFt0aGlzLCBMb2dMZXZlbC5WRVJCT1NFXSwgYXJncykpO1xyXG4gICAgICAgIHRoaXMuX2xvZ0hhbmRsZXIuYXBwbHkodGhpcywgX19zcHJlYWRBcnJheXMoW3RoaXMsIExvZ0xldmVsLlZFUkJPU0VdLCBhcmdzKSk7XHJcbiAgICB9O1xyXG4gICAgTG9nZ2VyLnByb3RvdHlwZS5pbmZvID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBhcmdzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl91c2VyTG9nSGFuZGxlciAmJiB0aGlzLl91c2VyTG9nSGFuZGxlci5hcHBseSh0aGlzLCBfX3NwcmVhZEFycmF5cyhbdGhpcywgTG9nTGV2ZWwuSU5GT10sIGFyZ3MpKTtcclxuICAgICAgICB0aGlzLl9sb2dIYW5kbGVyLmFwcGx5KHRoaXMsIF9fc3ByZWFkQXJyYXlzKFt0aGlzLCBMb2dMZXZlbC5JTkZPXSwgYXJncykpO1xyXG4gICAgfTtcclxuICAgIExvZ2dlci5wcm90b3R5cGUud2FybiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgYXJncyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fdXNlckxvZ0hhbmRsZXIgJiYgdGhpcy5fdXNlckxvZ0hhbmRsZXIuYXBwbHkodGhpcywgX19zcHJlYWRBcnJheXMoW3RoaXMsIExvZ0xldmVsLldBUk5dLCBhcmdzKSk7XHJcbiAgICAgICAgdGhpcy5fbG9nSGFuZGxlci5hcHBseSh0aGlzLCBfX3NwcmVhZEFycmF5cyhbdGhpcywgTG9nTGV2ZWwuV0FSTl0sIGFyZ3MpKTtcclxuICAgIH07XHJcbiAgICBMb2dnZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBhcmdzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl91c2VyTG9nSGFuZGxlciAmJiB0aGlzLl91c2VyTG9nSGFuZGxlci5hcHBseSh0aGlzLCBfX3NwcmVhZEFycmF5cyhbdGhpcywgTG9nTGV2ZWwuRVJST1JdLCBhcmdzKSk7XHJcbiAgICAgICAgdGhpcy5fbG9nSGFuZGxlci5hcHBseSh0aGlzLCBfX3NwcmVhZEFycmF5cyhbdGhpcywgTG9nTGV2ZWwuRVJST1JdLCBhcmdzKSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIExvZ2dlcjtcclxufSgpKTtcclxuZnVuY3Rpb24gc2V0TG9nTGV2ZWwobGV2ZWwpIHtcclxuICAgIGluc3RhbmNlcy5mb3JFYWNoKGZ1bmN0aW9uIChpbnN0KSB7XHJcbiAgICAgICAgaW5zdC5zZXRMb2dMZXZlbChsZXZlbCk7XHJcbiAgICB9KTtcclxufVxyXG5mdW5jdGlvbiBzZXRVc2VyTG9nSGFuZGxlcihsb2dDYWxsYmFjaywgb3B0aW9ucykge1xyXG4gICAgdmFyIF9sb29wXzEgPSBmdW5jdGlvbiAoaW5zdGFuY2UpIHtcclxuICAgICAgICB2YXIgY3VzdG9tTG9nTGV2ZWwgPSBudWxsO1xyXG4gICAgICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnMubGV2ZWwpIHtcclxuICAgICAgICAgICAgY3VzdG9tTG9nTGV2ZWwgPSBsZXZlbFN0cmluZ1RvRW51bVtvcHRpb25zLmxldmVsXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGxvZ0NhbGxiYWNrID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGluc3RhbmNlLnVzZXJMb2dIYW5kbGVyID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGluc3RhbmNlLnVzZXJMb2dIYW5kbGVyID0gZnVuY3Rpb24gKGluc3RhbmNlLCBsZXZlbCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMjsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXJnc1tfaSAtIDJdID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gYXJnc1xyXG4gICAgICAgICAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKGFyZykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChhcmcgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mIGFyZyA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFyZztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mIGFyZyA9PT0gJ251bWJlcicgfHwgdHlwZW9mIGFyZyA9PT0gJ2Jvb2xlYW4nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhcmcudG9TdHJpbmcoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoYXJnIGluc3RhbmNlb2YgRXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFyZy5tZXNzYWdlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShhcmcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChpZ25vcmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoYXJnKSB7IHJldHVybiBhcmc7IH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmpvaW4oJyAnKTtcclxuICAgICAgICAgICAgICAgIGlmIChsZXZlbCA+PSAoY3VzdG9tTG9nTGV2ZWwgIT09IG51bGwgJiYgY3VzdG9tTG9nTGV2ZWwgIT09IHZvaWQgMCA/IGN1c3RvbUxvZ0xldmVsIDogaW5zdGFuY2UubG9nTGV2ZWwpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9nQ2FsbGJhY2soe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXZlbDogTG9nTGV2ZWxbbGV2ZWxdLnRvTG93ZXJDYXNlKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3M6IGFyZ3MsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IGluc3RhbmNlLm5hbWVcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgZm9yICh2YXIgX2kgPSAwLCBpbnN0YW5jZXNfMSA9IGluc3RhbmNlczsgX2kgPCBpbnN0YW5jZXNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICB2YXIgaW5zdGFuY2UgPSBpbnN0YW5jZXNfMVtfaV07XHJcbiAgICAgICAgX2xvb3BfMShpbnN0YW5jZSk7XHJcbiAgICB9XHJcbn1cblxuZXhwb3J0IHsgTG9nTGV2ZWwsIExvZ2dlciwgc2V0TG9nTGV2ZWwsIHNldFVzZXJMb2dIYW5kbGVyIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5lc20uanMubWFwXG4iLCJpbXBvcnQgeyBfX2Fzc2lnbiwgX19leHRlbmRzIH0gZnJvbSAndHNsaWInO1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogQGZpbGVvdmVydmlldyBGaXJlYmFzZSBjb25zdGFudHMuICBTb21lIG9mIHRoZXNlIChAZGVmaW5lcykgY2FuIGJlIG92ZXJyaWRkZW4gYXQgY29tcGlsZS10aW1lLlxyXG4gKi9cclxudmFyIENPTlNUQU5UUyA9IHtcclxuICAgIC8qKlxyXG4gICAgICogQGRlZmluZSB7Ym9vbGVhbn0gV2hldGhlciB0aGlzIGlzIHRoZSBjbGllbnQgTm9kZS5qcyBTREsuXHJcbiAgICAgKi9cclxuICAgIE5PREVfQ0xJRU5UOiBmYWxzZSxcclxuICAgIC8qKlxyXG4gICAgICogQGRlZmluZSB7Ym9vbGVhbn0gV2hldGhlciB0aGlzIGlzIHRoZSBBZG1pbiBOb2RlLmpzIFNESy5cclxuICAgICAqL1xyXG4gICAgTk9ERV9BRE1JTjogZmFsc2UsXHJcbiAgICAvKipcclxuICAgICAqIEZpcmViYXNlIFNESyBWZXJzaW9uXHJcbiAgICAgKi9cclxuICAgIFNES19WRVJTSU9OOiAnJHtKU0NPUkVfVkVSU0lPTn0nXHJcbn07XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBUaHJvd3MgYW4gZXJyb3IgaWYgdGhlIHByb3ZpZGVkIGFzc2VydGlvbiBpcyBmYWxzeVxyXG4gKi9cclxudmFyIGFzc2VydCA9IGZ1bmN0aW9uIChhc3NlcnRpb24sIG1lc3NhZ2UpIHtcclxuICAgIGlmICghYXNzZXJ0aW9uKSB7XHJcbiAgICAgICAgdGhyb3cgYXNzZXJ0aW9uRXJyb3IobWVzc2FnZSk7XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiBSZXR1cm5zIGFuIEVycm9yIG9iamVjdCBzdWl0YWJsZSBmb3IgdGhyb3dpbmcuXHJcbiAqL1xyXG52YXIgYXNzZXJ0aW9uRXJyb3IgPSBmdW5jdGlvbiAobWVzc2FnZSkge1xyXG4gICAgcmV0dXJuIG5ldyBFcnJvcignRmlyZWJhc2UgRGF0YWJhc2UgKCcgK1xyXG4gICAgICAgIENPTlNUQU5UUy5TREtfVkVSU0lPTiArXHJcbiAgICAgICAgJykgSU5URVJOQUwgQVNTRVJUIEZBSUxFRDogJyArXHJcbiAgICAgICAgbWVzc2FnZSk7XHJcbn07XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnZhciBzdHJpbmdUb0J5dGVBcnJheSQxID0gZnVuY3Rpb24gKHN0cikge1xyXG4gICAgLy8gVE9ETyh1c2VyKTogVXNlIG5hdGl2ZSBpbXBsZW1lbnRhdGlvbnMgaWYvd2hlbiBhdmFpbGFibGVcclxuICAgIHZhciBvdXQgPSBbXTtcclxuICAgIHZhciBwID0gMDtcclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgdmFyIGMgPSBzdHIuY2hhckNvZGVBdChpKTtcclxuICAgICAgICBpZiAoYyA8IDEyOCkge1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IGM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGMgPCAyMDQ4KSB7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgPj4gNikgfCAxOTI7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgJiA2MykgfCAxMjg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKChjICYgMHhmYzAwKSA9PT0gMHhkODAwICYmXHJcbiAgICAgICAgICAgIGkgKyAxIDwgc3RyLmxlbmd0aCAmJlxyXG4gICAgICAgICAgICAoc3RyLmNoYXJDb2RlQXQoaSArIDEpICYgMHhmYzAwKSA9PT0gMHhkYzAwKSB7XHJcbiAgICAgICAgICAgIC8vIFN1cnJvZ2F0ZSBQYWlyXHJcbiAgICAgICAgICAgIGMgPSAweDEwMDAwICsgKChjICYgMHgwM2ZmKSA8PCAxMCkgKyAoc3RyLmNoYXJDb2RlQXQoKytpKSAmIDB4MDNmZik7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgPj4gMTgpIHwgMjQwO1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9ICgoYyA+PiAxMikgJiA2MykgfCAxMjg7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKChjID4+IDYpICYgNjMpIHwgMTI4O1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjICYgNjMpIHwgMTI4O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoYyA+PiAxMikgfCAyMjQ7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKChjID4+IDYpICYgNjMpIHwgMTI4O1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjICYgNjMpIHwgMTI4O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBvdXQ7XHJcbn07XHJcbi8qKlxyXG4gKiBUdXJucyBhbiBhcnJheSBvZiBudW1iZXJzIGludG8gdGhlIHN0cmluZyBnaXZlbiBieSB0aGUgY29uY2F0ZW5hdGlvbiBvZiB0aGVcclxuICogY2hhcmFjdGVycyB0byB3aGljaCB0aGUgbnVtYmVycyBjb3JyZXNwb25kLlxyXG4gKiBAcGFyYW0gYnl0ZXMgQXJyYXkgb2YgbnVtYmVycyByZXByZXNlbnRpbmcgY2hhcmFjdGVycy5cclxuICogQHJldHVybiBTdHJpbmdpZmljYXRpb24gb2YgdGhlIGFycmF5LlxyXG4gKi9cclxudmFyIGJ5dGVBcnJheVRvU3RyaW5nID0gZnVuY3Rpb24gKGJ5dGVzKSB7XHJcbiAgICAvLyBUT0RPKHVzZXIpOiBVc2UgbmF0aXZlIGltcGxlbWVudGF0aW9ucyBpZi93aGVuIGF2YWlsYWJsZVxyXG4gICAgdmFyIG91dCA9IFtdO1xyXG4gICAgdmFyIHBvcyA9IDAsIGMgPSAwO1xyXG4gICAgd2hpbGUgKHBvcyA8IGJ5dGVzLmxlbmd0aCkge1xyXG4gICAgICAgIHZhciBjMSA9IGJ5dGVzW3BvcysrXTtcclxuICAgICAgICBpZiAoYzEgPCAxMjgpIHtcclxuICAgICAgICAgICAgb3V0W2MrK10gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGMxKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoYzEgPiAxOTEgJiYgYzEgPCAyMjQpIHtcclxuICAgICAgICAgICAgdmFyIGMyID0gYnl0ZXNbcG9zKytdO1xyXG4gICAgICAgICAgICBvdXRbYysrXSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoKChjMSAmIDMxKSA8PCA2KSB8IChjMiAmIDYzKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGMxID4gMjM5ICYmIGMxIDwgMzY1KSB7XHJcbiAgICAgICAgICAgIC8vIFN1cnJvZ2F0ZSBQYWlyXHJcbiAgICAgICAgICAgIHZhciBjMiA9IGJ5dGVzW3BvcysrXTtcclxuICAgICAgICAgICAgdmFyIGMzID0gYnl0ZXNbcG9zKytdO1xyXG4gICAgICAgICAgICB2YXIgYzQgPSBieXRlc1twb3MrK107XHJcbiAgICAgICAgICAgIHZhciB1ID0gKCgoYzEgJiA3KSA8PCAxOCkgfCAoKGMyICYgNjMpIDw8IDEyKSB8ICgoYzMgJiA2MykgPDwgNikgfCAoYzQgJiA2MykpIC1cclxuICAgICAgICAgICAgICAgIDB4MTAwMDA7XHJcbiAgICAgICAgICAgIG91dFtjKytdID0gU3RyaW5nLmZyb21DaGFyQ29kZSgweGQ4MDAgKyAodSA+PiAxMCkpO1xyXG4gICAgICAgICAgICBvdXRbYysrXSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoMHhkYzAwICsgKHUgJiAxMDIzKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgYzIgPSBieXRlc1twb3MrK107XHJcbiAgICAgICAgICAgIHZhciBjMyA9IGJ5dGVzW3BvcysrXTtcclxuICAgICAgICAgICAgb3V0W2MrK10gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKCgoYzEgJiAxNSkgPDwgMTIpIHwgKChjMiAmIDYzKSA8PCA2KSB8IChjMyAmIDYzKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG91dC5qb2luKCcnKTtcclxufTtcclxuLy8gV2UgZGVmaW5lIGl0IGFzIGFuIG9iamVjdCBsaXRlcmFsIGluc3RlYWQgb2YgYSBjbGFzcyBiZWNhdXNlIGEgY2xhc3MgY29tcGlsZWQgZG93biB0byBlczUgY2FuJ3RcclxuLy8gYmUgdHJlZXNoYWtlZC4gaHR0cHM6Ly9naXRodWIuY29tL3JvbGx1cC9yb2xsdXAvaXNzdWVzLzE2OTFcclxuLy8gU3RhdGljIGxvb2t1cCBtYXBzLCBsYXppbHkgcG9wdWxhdGVkIGJ5IGluaXRfKClcclxudmFyIGJhc2U2NCA9IHtcclxuICAgIC8qKlxyXG4gICAgICogTWFwcyBieXRlcyB0byBjaGFyYWN0ZXJzLlxyXG4gICAgICovXHJcbiAgICBieXRlVG9DaGFyTWFwXzogbnVsbCxcclxuICAgIC8qKlxyXG4gICAgICogTWFwcyBjaGFyYWN0ZXJzIHRvIGJ5dGVzLlxyXG4gICAgICovXHJcbiAgICBjaGFyVG9CeXRlTWFwXzogbnVsbCxcclxuICAgIC8qKlxyXG4gICAgICogTWFwcyBieXRlcyB0byB3ZWJzYWZlIGNoYXJhY3RlcnMuXHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICovXHJcbiAgICBieXRlVG9DaGFyTWFwV2ViU2FmZV86IG51bGwsXHJcbiAgICAvKipcclxuICAgICAqIE1hcHMgd2Vic2FmZSBjaGFyYWN0ZXJzIHRvIGJ5dGVzLlxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqL1xyXG4gICAgY2hhclRvQnl0ZU1hcFdlYlNhZmVfOiBudWxsLFxyXG4gICAgLyoqXHJcbiAgICAgKiBPdXIgZGVmYXVsdCBhbHBoYWJldCwgc2hhcmVkIGJldHdlZW5cclxuICAgICAqIEVOQ09ERURfVkFMUyBhbmQgRU5DT0RFRF9WQUxTX1dFQlNBRkVcclxuICAgICAqL1xyXG4gICAgRU5DT0RFRF9WQUxTX0JBU0U6ICdBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWicgKyAnYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXonICsgJzAxMjM0NTY3ODknLFxyXG4gICAgLyoqXHJcbiAgICAgKiBPdXIgZGVmYXVsdCBhbHBoYWJldC4gVmFsdWUgNjQgKD0pIGlzIHNwZWNpYWw7IGl0IG1lYW5zIFwibm90aGluZy5cIlxyXG4gICAgICovXHJcbiAgICBnZXQgRU5DT0RFRF9WQUxTKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLkVOQ09ERURfVkFMU19CQVNFICsgJysvPSc7XHJcbiAgICB9LFxyXG4gICAgLyoqXHJcbiAgICAgKiBPdXIgd2Vic2FmZSBhbHBoYWJldC5cclxuICAgICAqL1xyXG4gICAgZ2V0IEVOQ09ERURfVkFMU19XRUJTQUZFKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLkVOQ09ERURfVkFMU19CQVNFICsgJy1fLic7XHJcbiAgICB9LFxyXG4gICAgLyoqXHJcbiAgICAgKiBXaGV0aGVyIHRoaXMgYnJvd3NlciBzdXBwb3J0cyB0aGUgYXRvYiBhbmQgYnRvYSBmdW5jdGlvbnMuIFRoaXMgZXh0ZW5zaW9uXHJcbiAgICAgKiBzdGFydGVkIGF0IE1vemlsbGEgYnV0IGlzIG5vdyBpbXBsZW1lbnRlZCBieSBtYW55IGJyb3dzZXJzLiBXZSB1c2UgdGhlXHJcbiAgICAgKiBBU1NVTUVfKiB2YXJpYWJsZXMgdG8gYXZvaWQgcHVsbGluZyBpbiB0aGUgZnVsbCB1c2VyYWdlbnQgZGV0ZWN0aW9uIGxpYnJhcnlcclxuICAgICAqIGJ1dCBzdGlsbCBhbGxvd2luZyB0aGUgc3RhbmRhcmQgcGVyLWJyb3dzZXIgY29tcGlsYXRpb25zLlxyXG4gICAgICpcclxuICAgICAqL1xyXG4gICAgSEFTX05BVElWRV9TVVBQT1JUOiB0eXBlb2YgYXRvYiA9PT0gJ2Z1bmN0aW9uJyxcclxuICAgIC8qKlxyXG4gICAgICogQmFzZTY0LWVuY29kZSBhbiBhcnJheSBvZiBieXRlcy5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gaW5wdXQgQW4gYXJyYXkgb2YgYnl0ZXMgKG51bWJlcnMgd2l0aFxyXG4gICAgICogICAgIHZhbHVlIGluIFswLCAyNTVdKSB0byBlbmNvZGUuXHJcbiAgICAgKiBAcGFyYW0gd2ViU2FmZSBCb29sZWFuIGluZGljYXRpbmcgd2Ugc2hvdWxkIHVzZSB0aGVcclxuICAgICAqICAgICBhbHRlcm5hdGl2ZSBhbHBoYWJldC5cclxuICAgICAqIEByZXR1cm4gVGhlIGJhc2U2NCBlbmNvZGVkIHN0cmluZy5cclxuICAgICAqL1xyXG4gICAgZW5jb2RlQnl0ZUFycmF5OiBmdW5jdGlvbiAoaW5wdXQsIHdlYlNhZmUpIHtcclxuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoaW5wdXQpKSB7XHJcbiAgICAgICAgICAgIHRocm93IEVycm9yKCdlbmNvZGVCeXRlQXJyYXkgdGFrZXMgYW4gYXJyYXkgYXMgYSBwYXJhbWV0ZXInKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pbml0XygpO1xyXG4gICAgICAgIHZhciBieXRlVG9DaGFyTWFwID0gd2ViU2FmZVxyXG4gICAgICAgICAgICA/IHRoaXMuYnl0ZVRvQ2hhck1hcFdlYlNhZmVfXHJcbiAgICAgICAgICAgIDogdGhpcy5ieXRlVG9DaGFyTWFwXztcclxuICAgICAgICB2YXIgb3V0cHV0ID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpbnB1dC5sZW5ndGg7IGkgKz0gMykge1xyXG4gICAgICAgICAgICB2YXIgYnl0ZTEgPSBpbnB1dFtpXTtcclxuICAgICAgICAgICAgdmFyIGhhdmVCeXRlMiA9IGkgKyAxIDwgaW5wdXQubGVuZ3RoO1xyXG4gICAgICAgICAgICB2YXIgYnl0ZTIgPSBoYXZlQnl0ZTIgPyBpbnB1dFtpICsgMV0gOiAwO1xyXG4gICAgICAgICAgICB2YXIgaGF2ZUJ5dGUzID0gaSArIDIgPCBpbnB1dC5sZW5ndGg7XHJcbiAgICAgICAgICAgIHZhciBieXRlMyA9IGhhdmVCeXRlMyA/IGlucHV0W2kgKyAyXSA6IDA7XHJcbiAgICAgICAgICAgIHZhciBvdXRCeXRlMSA9IGJ5dGUxID4+IDI7XHJcbiAgICAgICAgICAgIHZhciBvdXRCeXRlMiA9ICgoYnl0ZTEgJiAweDAzKSA8PCA0KSB8IChieXRlMiA+PiA0KTtcclxuICAgICAgICAgICAgdmFyIG91dEJ5dGUzID0gKChieXRlMiAmIDB4MGYpIDw8IDIpIHwgKGJ5dGUzID4+IDYpO1xyXG4gICAgICAgICAgICB2YXIgb3V0Qnl0ZTQgPSBieXRlMyAmIDB4M2Y7XHJcbiAgICAgICAgICAgIGlmICghaGF2ZUJ5dGUzKSB7XHJcbiAgICAgICAgICAgICAgICBvdXRCeXRlNCA9IDY0O1xyXG4gICAgICAgICAgICAgICAgaWYgKCFoYXZlQnl0ZTIpIHtcclxuICAgICAgICAgICAgICAgICAgICBvdXRCeXRlMyA9IDY0O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG91dHB1dC5wdXNoKGJ5dGVUb0NoYXJNYXBbb3V0Qnl0ZTFdLCBieXRlVG9DaGFyTWFwW291dEJ5dGUyXSwgYnl0ZVRvQ2hhck1hcFtvdXRCeXRlM10sIGJ5dGVUb0NoYXJNYXBbb3V0Qnl0ZTRdKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG91dHB1dC5qb2luKCcnKTtcclxuICAgIH0sXHJcbiAgICAvKipcclxuICAgICAqIEJhc2U2NC1lbmNvZGUgYSBzdHJpbmcuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGlucHV0IEEgc3RyaW5nIHRvIGVuY29kZS5cclxuICAgICAqIEBwYXJhbSB3ZWJTYWZlIElmIHRydWUsIHdlIHNob3VsZCB1c2UgdGhlXHJcbiAgICAgKiAgICAgYWx0ZXJuYXRpdmUgYWxwaGFiZXQuXHJcbiAgICAgKiBAcmV0dXJuIFRoZSBiYXNlNjQgZW5jb2RlZCBzdHJpbmcuXHJcbiAgICAgKi9cclxuICAgIGVuY29kZVN0cmluZzogZnVuY3Rpb24gKGlucHV0LCB3ZWJTYWZlKSB7XHJcbiAgICAgICAgLy8gU2hvcnRjdXQgZm9yIE1vemlsbGEgYnJvd3NlcnMgdGhhdCBpbXBsZW1lbnRcclxuICAgICAgICAvLyBhIG5hdGl2ZSBiYXNlNjQgZW5jb2RlciBpbiB0aGUgZm9ybSBvZiBcImJ0b2EvYXRvYlwiXHJcbiAgICAgICAgaWYgKHRoaXMuSEFTX05BVElWRV9TVVBQT1JUICYmICF3ZWJTYWZlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBidG9hKGlucHV0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZW5jb2RlQnl0ZUFycmF5KHN0cmluZ1RvQnl0ZUFycmF5JDEoaW5wdXQpLCB3ZWJTYWZlKTtcclxuICAgIH0sXHJcbiAgICAvKipcclxuICAgICAqIEJhc2U2NC1kZWNvZGUgYSBzdHJpbmcuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGlucHV0IHRvIGRlY29kZS5cclxuICAgICAqIEBwYXJhbSB3ZWJTYWZlIFRydWUgaWYgd2Ugc2hvdWxkIHVzZSB0aGVcclxuICAgICAqICAgICBhbHRlcm5hdGl2ZSBhbHBoYWJldC5cclxuICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGluZyB0aGUgZGVjb2RlZCB2YWx1ZS5cclxuICAgICAqL1xyXG4gICAgZGVjb2RlU3RyaW5nOiBmdW5jdGlvbiAoaW5wdXQsIHdlYlNhZmUpIHtcclxuICAgICAgICAvLyBTaG9ydGN1dCBmb3IgTW96aWxsYSBicm93c2VycyB0aGF0IGltcGxlbWVudFxyXG4gICAgICAgIC8vIGEgbmF0aXZlIGJhc2U2NCBlbmNvZGVyIGluIHRoZSBmb3JtIG9mIFwiYnRvYS9hdG9iXCJcclxuICAgICAgICBpZiAodGhpcy5IQVNfTkFUSVZFX1NVUFBPUlQgJiYgIXdlYlNhZmUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGF0b2IoaW5wdXQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYnl0ZUFycmF5VG9TdHJpbmcodGhpcy5kZWNvZGVTdHJpbmdUb0J5dGVBcnJheShpbnB1dCwgd2ViU2FmZSkpO1xyXG4gICAgfSxcclxuICAgIC8qKlxyXG4gICAgICogQmFzZTY0LWRlY29kZSBhIHN0cmluZy5cclxuICAgICAqXHJcbiAgICAgKiBJbiBiYXNlLTY0IGRlY29kaW5nLCBncm91cHMgb2YgZm91ciBjaGFyYWN0ZXJzIGFyZSBjb252ZXJ0ZWQgaW50byB0aHJlZVxyXG4gICAgICogYnl0ZXMuICBJZiB0aGUgZW5jb2RlciBkaWQgbm90IGFwcGx5IHBhZGRpbmcsIHRoZSBpbnB1dCBsZW5ndGggbWF5IG5vdFxyXG4gICAgICogYmUgYSBtdWx0aXBsZSBvZiA0LlxyXG4gICAgICpcclxuICAgICAqIEluIHRoaXMgY2FzZSwgdGhlIGxhc3QgZ3JvdXAgd2lsbCBoYXZlIGZld2VyIHRoYW4gNCBjaGFyYWN0ZXJzLCBhbmRcclxuICAgICAqIHBhZGRpbmcgd2lsbCBiZSBpbmZlcnJlZC4gIElmIHRoZSBncm91cCBoYXMgb25lIG9yIHR3byBjaGFyYWN0ZXJzLCBpdCBkZWNvZGVzXHJcbiAgICAgKiB0byBvbmUgYnl0ZS4gIElmIHRoZSBncm91cCBoYXMgdGhyZWUgY2hhcmFjdGVycywgaXQgZGVjb2RlcyB0byB0d28gYnl0ZXMuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGlucHV0IElucHV0IHRvIGRlY29kZS5cclxuICAgICAqIEBwYXJhbSB3ZWJTYWZlIFRydWUgaWYgd2Ugc2hvdWxkIHVzZSB0aGUgd2ViLXNhZmUgYWxwaGFiZXQuXHJcbiAgICAgKiBAcmV0dXJuIGJ5dGVzIHJlcHJlc2VudGluZyB0aGUgZGVjb2RlZCB2YWx1ZS5cclxuICAgICAqL1xyXG4gICAgZGVjb2RlU3RyaW5nVG9CeXRlQXJyYXk6IGZ1bmN0aW9uIChpbnB1dCwgd2ViU2FmZSkge1xyXG4gICAgICAgIHRoaXMuaW5pdF8oKTtcclxuICAgICAgICB2YXIgY2hhclRvQnl0ZU1hcCA9IHdlYlNhZmVcclxuICAgICAgICAgICAgPyB0aGlzLmNoYXJUb0J5dGVNYXBXZWJTYWZlX1xyXG4gICAgICAgICAgICA6IHRoaXMuY2hhclRvQnl0ZU1hcF87XHJcbiAgICAgICAgdmFyIG91dHB1dCA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaW5wdXQubGVuZ3RoOykge1xyXG4gICAgICAgICAgICB2YXIgYnl0ZTEgPSBjaGFyVG9CeXRlTWFwW2lucHV0LmNoYXJBdChpKyspXTtcclxuICAgICAgICAgICAgdmFyIGhhdmVCeXRlMiA9IGkgPCBpbnB1dC5sZW5ndGg7XHJcbiAgICAgICAgICAgIHZhciBieXRlMiA9IGhhdmVCeXRlMiA/IGNoYXJUb0J5dGVNYXBbaW5wdXQuY2hhckF0KGkpXSA6IDA7XHJcbiAgICAgICAgICAgICsraTtcclxuICAgICAgICAgICAgdmFyIGhhdmVCeXRlMyA9IGkgPCBpbnB1dC5sZW5ndGg7XHJcbiAgICAgICAgICAgIHZhciBieXRlMyA9IGhhdmVCeXRlMyA/IGNoYXJUb0J5dGVNYXBbaW5wdXQuY2hhckF0KGkpXSA6IDY0O1xyXG4gICAgICAgICAgICArK2k7XHJcbiAgICAgICAgICAgIHZhciBoYXZlQnl0ZTQgPSBpIDwgaW5wdXQubGVuZ3RoO1xyXG4gICAgICAgICAgICB2YXIgYnl0ZTQgPSBoYXZlQnl0ZTQgPyBjaGFyVG9CeXRlTWFwW2lucHV0LmNoYXJBdChpKV0gOiA2NDtcclxuICAgICAgICAgICAgKytpO1xyXG4gICAgICAgICAgICBpZiAoYnl0ZTEgPT0gbnVsbCB8fCBieXRlMiA9PSBudWxsIHx8IGJ5dGUzID09IG51bGwgfHwgYnl0ZTQgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgRXJyb3IoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgb3V0Qnl0ZTEgPSAoYnl0ZTEgPDwgMikgfCAoYnl0ZTIgPj4gNCk7XHJcbiAgICAgICAgICAgIG91dHB1dC5wdXNoKG91dEJ5dGUxKTtcclxuICAgICAgICAgICAgaWYgKGJ5dGUzICE9PSA2NCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG91dEJ5dGUyID0gKChieXRlMiA8PCA0KSAmIDB4ZjApIHwgKGJ5dGUzID4+IDIpO1xyXG4gICAgICAgICAgICAgICAgb3V0cHV0LnB1c2gob3V0Qnl0ZTIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGJ5dGU0ICE9PSA2NCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBvdXRCeXRlMyA9ICgoYnl0ZTMgPDwgNikgJiAweGMwKSB8IGJ5dGU0O1xyXG4gICAgICAgICAgICAgICAgICAgIG91dHB1dC5wdXNoKG91dEJ5dGUzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gb3V0cHV0O1xyXG4gICAgfSxcclxuICAgIC8qKlxyXG4gICAgICogTGF6eSBzdGF0aWMgaW5pdGlhbGl6YXRpb24gZnVuY3Rpb24uIENhbGxlZCBiZWZvcmVcclxuICAgICAqIGFjY2Vzc2luZyBhbnkgb2YgdGhlIHN0YXRpYyBtYXAgdmFyaWFibGVzLlxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqL1xyXG4gICAgaW5pdF86IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAoIXRoaXMuYnl0ZVRvQ2hhck1hcF8pIHtcclxuICAgICAgICAgICAgdGhpcy5ieXRlVG9DaGFyTWFwXyA9IHt9O1xyXG4gICAgICAgICAgICB0aGlzLmNoYXJUb0J5dGVNYXBfID0ge307XHJcbiAgICAgICAgICAgIHRoaXMuYnl0ZVRvQ2hhck1hcFdlYlNhZmVfID0ge307XHJcbiAgICAgICAgICAgIHRoaXMuY2hhclRvQnl0ZU1hcFdlYlNhZmVfID0ge307XHJcbiAgICAgICAgICAgIC8vIFdlIHdhbnQgcXVpY2sgbWFwcGluZ3MgYmFjayBhbmQgZm9ydGgsIHNvIHdlIHByZWNvbXB1dGUgdHdvIG1hcHMuXHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5FTkNPREVEX1ZBTFMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYnl0ZVRvQ2hhck1hcF9baV0gPSB0aGlzLkVOQ09ERURfVkFMUy5jaGFyQXQoaSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoYXJUb0J5dGVNYXBfW3RoaXMuYnl0ZVRvQ2hhck1hcF9baV1dID0gaTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYnl0ZVRvQ2hhck1hcFdlYlNhZmVfW2ldID0gdGhpcy5FTkNPREVEX1ZBTFNfV0VCU0FGRS5jaGFyQXQoaSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoYXJUb0J5dGVNYXBXZWJTYWZlX1t0aGlzLmJ5dGVUb0NoYXJNYXBXZWJTYWZlX1tpXV0gPSBpO1xyXG4gICAgICAgICAgICAgICAgLy8gQmUgZm9yZ2l2aW5nIHdoZW4gZGVjb2RpbmcgYW5kIGNvcnJlY3RseSBkZWNvZGUgYm90aCBlbmNvZGluZ3MuXHJcbiAgICAgICAgICAgICAgICBpZiAoaSA+PSB0aGlzLkVOQ09ERURfVkFMU19CQVNFLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2hhclRvQnl0ZU1hcF9bdGhpcy5FTkNPREVEX1ZBTFNfV0VCU0FGRS5jaGFyQXQoaSldID0gaTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNoYXJUb0J5dGVNYXBXZWJTYWZlX1t0aGlzLkVOQ09ERURfVkFMUy5jaGFyQXQoaSldID0gaTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqIFVSTC1zYWZlIGJhc2U2NCBlbmNvZGluZ1xyXG4gKi9cclxudmFyIGJhc2U2NEVuY29kZSA9IGZ1bmN0aW9uIChzdHIpIHtcclxuICAgIHZhciB1dGY4Qnl0ZXMgPSBzdHJpbmdUb0J5dGVBcnJheSQxKHN0cik7XHJcbiAgICByZXR1cm4gYmFzZTY0LmVuY29kZUJ5dGVBcnJheSh1dGY4Qnl0ZXMsIHRydWUpO1xyXG59O1xyXG4vKipcclxuICogVVJMLXNhZmUgYmFzZTY0IGVuY29kaW5nICh3aXRob3V0IFwiLlwiIHBhZGRpbmcgaW4gdGhlIGVuZCkuXHJcbiAqIGUuZy4gVXNlZCBpbiBKU09OIFdlYiBUb2tlbiAoSldUKSBwYXJ0cy5cclxuICovXHJcbnZhciBiYXNlNjR1cmxFbmNvZGVXaXRob3V0UGFkZGluZyA9IGZ1bmN0aW9uIChzdHIpIHtcclxuICAgIC8vIFVzZSBiYXNlNjR1cmwgZW5jb2RpbmcgYW5kIHJlbW92ZSBwYWRkaW5nIGluIHRoZSBlbmQgKGRvdCBjaGFyYWN0ZXJzKS5cclxuICAgIHJldHVybiBiYXNlNjRFbmNvZGUoc3RyKS5yZXBsYWNlKC9cXC4vZywgJycpO1xyXG59O1xyXG4vKipcclxuICogVVJMLXNhZmUgYmFzZTY0IGRlY29kaW5nXHJcbiAqXHJcbiAqIE5PVEU6IERPIE5PVCB1c2UgdGhlIGdsb2JhbCBhdG9iKCkgZnVuY3Rpb24gLSBpdCBkb2VzIE5PVCBzdXBwb3J0IHRoZVxyXG4gKiBiYXNlNjRVcmwgdmFyaWFudCBlbmNvZGluZy5cclxuICpcclxuICogQHBhcmFtIHN0ciBUbyBiZSBkZWNvZGVkXHJcbiAqIEByZXR1cm4gRGVjb2RlZCByZXN1bHQsIGlmIHBvc3NpYmxlXHJcbiAqL1xyXG52YXIgYmFzZTY0RGVjb2RlID0gZnVuY3Rpb24gKHN0cikge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICByZXR1cm4gYmFzZTY0LmRlY29kZVN0cmluZyhzdHIsIHRydWUpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdiYXNlNjREZWNvZGUgZmFpbGVkOiAnLCBlKTtcclxuICAgIH1cclxuICAgIHJldHVybiBudWxsO1xyXG59O1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogRG8gYSBkZWVwLWNvcHkgb2YgYmFzaWMgSmF2YVNjcmlwdCBPYmplY3RzIG9yIEFycmF5cy5cclxuICovXHJcbmZ1bmN0aW9uIGRlZXBDb3B5KHZhbHVlKSB7XHJcbiAgICByZXR1cm4gZGVlcEV4dGVuZCh1bmRlZmluZWQsIHZhbHVlKTtcclxufVxyXG4vKipcclxuICogQ29weSBwcm9wZXJ0aWVzIGZyb20gc291cmNlIHRvIHRhcmdldCAocmVjdXJzaXZlbHkgYWxsb3dzIGV4dGVuc2lvblxyXG4gKiBvZiBPYmplY3RzIGFuZCBBcnJheXMpLiAgU2NhbGFyIHZhbHVlcyBpbiB0aGUgdGFyZ2V0IGFyZSBvdmVyLXdyaXR0ZW4uXHJcbiAqIElmIHRhcmdldCBpcyB1bmRlZmluZWQsIGFuIG9iamVjdCBvZiB0aGUgYXBwcm9wcmlhdGUgdHlwZSB3aWxsIGJlIGNyZWF0ZWRcclxuICogKGFuZCByZXR1cm5lZCkuXHJcbiAqXHJcbiAqIFdlIHJlY3Vyc2l2ZWx5IGNvcHkgYWxsIGNoaWxkIHByb3BlcnRpZXMgb2YgcGxhaW4gT2JqZWN0cyBpbiB0aGUgc291cmNlLSBzb1xyXG4gKiB0aGF0IG5hbWVzcGFjZS0gbGlrZSBkaWN0aW9uYXJpZXMgYXJlIG1lcmdlZC5cclxuICpcclxuICogTm90ZSB0aGF0IHRoZSB0YXJnZXQgY2FuIGJlIGEgZnVuY3Rpb24sIGluIHdoaWNoIGNhc2UgdGhlIHByb3BlcnRpZXMgaW5cclxuICogdGhlIHNvdXJjZSBPYmplY3QgYXJlIGNvcGllZCBvbnRvIGl0IGFzIHN0YXRpYyBwcm9wZXJ0aWVzIG9mIHRoZSBGdW5jdGlvbi5cclxuICpcclxuICogTm90ZTogd2UgZG9uJ3QgbWVyZ2UgX19wcm90b19fIHRvIHByZXZlbnQgcHJvdG90eXBlIHBvbGx1dGlvblxyXG4gKi9cclxuZnVuY3Rpb24gZGVlcEV4dGVuZCh0YXJnZXQsIHNvdXJjZSkge1xyXG4gICAgaWYgKCEoc291cmNlIGluc3RhbmNlb2YgT2JqZWN0KSkge1xyXG4gICAgICAgIHJldHVybiBzb3VyY2U7XHJcbiAgICB9XHJcbiAgICBzd2l0Y2ggKHNvdXJjZS5jb25zdHJ1Y3Rvcikge1xyXG4gICAgICAgIGNhc2UgRGF0ZTpcclxuICAgICAgICAgICAgLy8gVHJlYXQgRGF0ZXMgbGlrZSBzY2FsYXJzOyBpZiB0aGUgdGFyZ2V0IGRhdGUgb2JqZWN0IGhhZCBhbnkgY2hpbGRcclxuICAgICAgICAgICAgLy8gcHJvcGVydGllcyAtIHRoZXkgd2lsbCBiZSBsb3N0IVxyXG4gICAgICAgICAgICB2YXIgZGF0ZVZhbHVlID0gc291cmNlO1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IERhdGUoZGF0ZVZhbHVlLmdldFRpbWUoKSk7XHJcbiAgICAgICAgY2FzZSBPYmplY3Q6XHJcbiAgICAgICAgICAgIGlmICh0YXJnZXQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0ge307XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBBcnJheTpcclxuICAgICAgICAgICAgLy8gQWx3YXlzIGNvcHkgdGhlIGFycmF5IHNvdXJjZSBhbmQgb3ZlcndyaXRlIHRoZSB0YXJnZXQuXHJcbiAgICAgICAgICAgIHRhcmdldCA9IFtdO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAvLyBOb3QgYSBwbGFpbiBPYmplY3QgLSB0cmVhdCBpdCBhcyBhIHNjYWxhci5cclxuICAgICAgICAgICAgcmV0dXJuIHNvdXJjZTtcclxuICAgIH1cclxuICAgIGZvciAodmFyIHByb3AgaW4gc291cmNlKSB7XHJcbiAgICAgICAgLy8gdXNlIGlzVmFsaWRLZXkgdG8gZ3VhcmQgYWdhaW5zdCBwcm90b3R5cGUgcG9sbHV0aW9uLiBTZWUgaHR0cHM6Ly9zbnlrLmlvL3Z1bG4vU05ZSy1KUy1MT0RBU0gtNDUwMjAyXHJcbiAgICAgICAgaWYgKCFzb3VyY2UuaGFzT3duUHJvcGVydHkocHJvcCkgfHwgIWlzVmFsaWRLZXkocHJvcCkpIHtcclxuICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRhcmdldFtwcm9wXSA9IGRlZXBFeHRlbmQodGFyZ2V0W3Byb3BdLCBzb3VyY2VbcHJvcF0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRhcmdldDtcclxufVxyXG5mdW5jdGlvbiBpc1ZhbGlkS2V5KGtleSkge1xyXG4gICAgcmV0dXJuIGtleSAhPT0gJ19fcHJvdG9fXyc7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxudmFyIERlZmVycmVkID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRGVmZXJyZWQoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLnJlamVjdCA9IGZ1bmN0aW9uICgpIHsgfTtcclxuICAgICAgICB0aGlzLnJlc29sdmUgPSBmdW5jdGlvbiAoKSB7IH07XHJcbiAgICAgICAgdGhpcy5wcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICBfdGhpcy5yZXNvbHZlID0gcmVzb2x2ZTtcclxuICAgICAgICAgICAgX3RoaXMucmVqZWN0ID0gcmVqZWN0O1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBPdXIgQVBJIGludGVybmFscyBhcmUgbm90IHByb21pc2VpZmllZCBhbmQgY2Fubm90IGJlY2F1c2Ugb3VyIGNhbGxiYWNrIEFQSXMgaGF2ZSBzdWJ0bGUgZXhwZWN0YXRpb25zIGFyb3VuZFxyXG4gICAgICogaW52b2tpbmcgcHJvbWlzZXMgaW5saW5lLCB3aGljaCBQcm9taXNlcyBhcmUgZm9yYmlkZGVuIHRvIGRvLiBUaGlzIG1ldGhvZCBhY2NlcHRzIGFuIG9wdGlvbmFsIG5vZGUtc3R5bGUgY2FsbGJhY2tcclxuICAgICAqIGFuZCByZXR1cm5zIGEgbm9kZS1zdHlsZSBjYWxsYmFjayB3aGljaCB3aWxsIHJlc29sdmUgb3IgcmVqZWN0IHRoZSBEZWZlcnJlZCdzIHByb21pc2UuXHJcbiAgICAgKi9cclxuICAgIERlZmVycmVkLnByb3RvdHlwZS53cmFwQ2FsbGJhY2sgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoZXJyb3IsIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMucmVqZWN0KGVycm9yKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLnJlc29sdmUodmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgICAgIC8vIEF0dGFjaGluZyBub29wIGhhbmRsZXIganVzdCBpbiBjYXNlIGRldmVsb3BlciB3YXNuJ3QgZXhwZWN0aW5nXHJcbiAgICAgICAgICAgICAgICAvLyBwcm9taXNlc1xyXG4gICAgICAgICAgICAgICAgX3RoaXMucHJvbWlzZS5jYXRjaChmdW5jdGlvbiAoKSB7IH0pO1xyXG4gICAgICAgICAgICAgICAgLy8gU29tZSBvZiBvdXIgY2FsbGJhY2tzIGRvbid0IGV4cGVjdCBhIHZhbHVlIGFuZCBvdXIgb3duIHRlc3RzXHJcbiAgICAgICAgICAgICAgICAvLyBhc3NlcnQgdGhhdCB0aGUgcGFyYW1ldGVyIGxlbmd0aCBpcyAxXHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2subGVuZ3RoID09PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soZXJyb3IsIHZhbHVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIERlZmVycmVkO1xyXG59KCkpO1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjEgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5mdW5jdGlvbiBjcmVhdGVNb2NrVXNlclRva2VuKHRva2VuLCBwcm9qZWN0SWQpIHtcclxuICAgIGlmICh0b2tlbi51aWQpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBcInVpZFwiIGZpZWxkIGlzIG5vIGxvbmdlciBzdXBwb3J0ZWQgYnkgbW9ja1VzZXJUb2tlbi4gUGxlYXNlIHVzZSBcInN1YlwiIGluc3RlYWQgZm9yIEZpcmViYXNlIEF1dGggVXNlciBJRC4nKTtcclxuICAgIH1cclxuICAgIC8vIFVuc2VjdXJlZCBKV1RzIHVzZSBcIm5vbmVcIiBhcyB0aGUgYWxnb3JpdGhtLlxyXG4gICAgdmFyIGhlYWRlciA9IHtcclxuICAgICAgICBhbGc6ICdub25lJyxcclxuICAgICAgICB0eXBlOiAnSldUJ1xyXG4gICAgfTtcclxuICAgIHZhciBwcm9qZWN0ID0gcHJvamVjdElkIHx8ICdkZW1vLXByb2plY3QnO1xyXG4gICAgdmFyIGlhdCA9IHRva2VuLmlhdCB8fCAwO1xyXG4gICAgdmFyIHN1YiA9IHRva2VuLnN1YiB8fCB0b2tlbi51c2VyX2lkO1xyXG4gICAgaWYgKCFzdWIpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJtb2NrVXNlclRva2VuIG11c3QgY29udGFpbiAnc3ViJyBvciAndXNlcl9pZCcgZmllbGQhXCIpO1xyXG4gICAgfVxyXG4gICAgdmFyIHBheWxvYWQgPSBfX2Fzc2lnbih7IFxyXG4gICAgICAgIC8vIFNldCBhbGwgcmVxdWlyZWQgZmllbGRzIHRvIGRlY2VudCBkZWZhdWx0c1xyXG4gICAgICAgIGlzczogXCJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vXCIgKyBwcm9qZWN0LCBhdWQ6IHByb2plY3QsIGlhdDogaWF0LCBleHA6IGlhdCArIDM2MDAsIGF1dGhfdGltZTogaWF0LCBzdWI6IHN1YiwgdXNlcl9pZDogc3ViLCBmaXJlYmFzZToge1xyXG4gICAgICAgICAgICBzaWduX2luX3Byb3ZpZGVyOiAnY3VzdG9tJyxcclxuICAgICAgICAgICAgaWRlbnRpdGllczoge31cclxuICAgICAgICB9IH0sIHRva2VuKTtcclxuICAgIC8vIFVuc2VjdXJlZCBKV1RzIHVzZSB0aGUgZW1wdHkgc3RyaW5nIGFzIGEgc2lnbmF0dXJlLlxyXG4gICAgdmFyIHNpZ25hdHVyZSA9ICcnO1xyXG4gICAgcmV0dXJuIFtcclxuICAgICAgICBiYXNlNjR1cmxFbmNvZGVXaXRob3V0UGFkZGluZyhKU09OLnN0cmluZ2lmeShoZWFkZXIpKSxcclxuICAgICAgICBiYXNlNjR1cmxFbmNvZGVXaXRob3V0UGFkZGluZyhKU09OLnN0cmluZ2lmeShwYXlsb2FkKSksXHJcbiAgICAgICAgc2lnbmF0dXJlXHJcbiAgICBdLmpvaW4oJy4nKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogUmV0dXJucyBuYXZpZ2F0b3IudXNlckFnZW50IHN0cmluZyBvciAnJyBpZiBpdCdzIG5vdCBkZWZpbmVkLlxyXG4gKiBAcmV0dXJuIHVzZXIgYWdlbnQgc3RyaW5nXHJcbiAqL1xyXG5mdW5jdGlvbiBnZXRVQSgpIHtcclxuICAgIGlmICh0eXBlb2YgbmF2aWdhdG9yICE9PSAndW5kZWZpbmVkJyAmJlxyXG4gICAgICAgIHR5cGVvZiBuYXZpZ2F0b3JbJ3VzZXJBZ2VudCddID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgIHJldHVybiBuYXZpZ2F0b3JbJ3VzZXJBZ2VudCddO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBEZXRlY3QgQ29yZG92YSAvIFBob25lR2FwIC8gSW9uaWMgZnJhbWV3b3JrcyBvbiBhIG1vYmlsZSBkZXZpY2UuXHJcbiAqXHJcbiAqIERlbGliZXJhdGVseSBkb2VzIG5vdCByZWx5IG9uIGNoZWNraW5nIGBmaWxlOi8vYCBVUkxzIChhcyB0aGlzIGZhaWxzIFBob25lR2FwXHJcbiAqIGluIHRoZSBSaXBwbGUgZW11bGF0b3IpIG5vciBDb3Jkb3ZhIGBvbkRldmljZVJlYWR5YCwgd2hpY2ggd291bGQgbm9ybWFsbHlcclxuICogd2FpdCBmb3IgYSBjYWxsYmFjay5cclxuICovXHJcbmZ1bmN0aW9uIGlzTW9iaWxlQ29yZG92YSgpIHtcclxuICAgIHJldHVybiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiZcclxuICAgICAgICAvLyBAdHMtaWdub3JlIFNldHRpbmcgdXAgYW4gYnJvYWRseSBhcHBsaWNhYmxlIGluZGV4IHNpZ25hdHVyZSBmb3IgV2luZG93XHJcbiAgICAgICAgLy8ganVzdCB0byBkZWFsIHdpdGggdGhpcyBjYXNlIHdvdWxkIHByb2JhYmx5IGJlIGEgYmFkIGlkZWEuXHJcbiAgICAgICAgISEod2luZG93Wydjb3Jkb3ZhJ10gfHwgd2luZG93WydwaG9uZWdhcCddIHx8IHdpbmRvd1snUGhvbmVHYXAnXSkgJiZcclxuICAgICAgICAvaW9zfGlwaG9uZXxpcG9kfGlwYWR8YW5kcm9pZHxibGFja2JlcnJ5fGllbW9iaWxlL2kudGVzdChnZXRVQSgpKSk7XHJcbn1cclxuLyoqXHJcbiAqIERldGVjdCBOb2RlLmpzLlxyXG4gKlxyXG4gKiBAcmV0dXJuIHRydWUgaWYgTm9kZS5qcyBlbnZpcm9ubWVudCBpcyBkZXRlY3RlZC5cclxuICovXHJcbi8vIE5vZGUgZGV0ZWN0aW9uIGxvZ2ljIGZyb206IGh0dHBzOi8vZ2l0aHViLmNvbS9pbGlha2FuL2RldGVjdC1ub2RlL1xyXG5mdW5jdGlvbiBpc05vZGUoKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHJldHVybiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGdsb2JhbC5wcm9jZXNzKSA9PT0gJ1tvYmplY3QgcHJvY2Vzc10nKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBEZXRlY3QgQnJvd3NlciBFbnZpcm9ubWVudFxyXG4gKi9cclxuZnVuY3Rpb24gaXNCcm93c2VyKCkge1xyXG4gICAgcmV0dXJuIHR5cGVvZiBzZWxmID09PSAnb2JqZWN0JyAmJiBzZWxmLnNlbGYgPT09IHNlbGY7XHJcbn1cclxuZnVuY3Rpb24gaXNCcm93c2VyRXh0ZW5zaW9uKCkge1xyXG4gICAgdmFyIHJ1bnRpbWUgPSB0eXBlb2YgY2hyb21lID09PSAnb2JqZWN0J1xyXG4gICAgICAgID8gY2hyb21lLnJ1bnRpbWVcclxuICAgICAgICA6IHR5cGVvZiBicm93c2VyID09PSAnb2JqZWN0J1xyXG4gICAgICAgICAgICA/IGJyb3dzZXIucnVudGltZVxyXG4gICAgICAgICAgICA6IHVuZGVmaW5lZDtcclxuICAgIHJldHVybiB0eXBlb2YgcnVudGltZSA9PT0gJ29iamVjdCcgJiYgcnVudGltZS5pZCAhPT0gdW5kZWZpbmVkO1xyXG59XHJcbi8qKlxyXG4gKiBEZXRlY3QgUmVhY3QgTmF0aXZlLlxyXG4gKlxyXG4gKiBAcmV0dXJuIHRydWUgaWYgUmVhY3ROYXRpdmUgZW52aXJvbm1lbnQgaXMgZGV0ZWN0ZWQuXHJcbiAqL1xyXG5mdW5jdGlvbiBpc1JlYWN0TmF0aXZlKCkge1xyXG4gICAgcmV0dXJuICh0eXBlb2YgbmF2aWdhdG9yID09PSAnb2JqZWN0JyAmJiBuYXZpZ2F0b3JbJ3Byb2R1Y3QnXSA9PT0gJ1JlYWN0TmF0aXZlJyk7XHJcbn1cclxuLyoqIERldGVjdHMgRWxlY3Ryb24gYXBwcy4gKi9cclxuZnVuY3Rpb24gaXNFbGVjdHJvbigpIHtcclxuICAgIHJldHVybiBnZXRVQSgpLmluZGV4T2YoJ0VsZWN0cm9uLycpID49IDA7XHJcbn1cclxuLyoqIERldGVjdHMgSW50ZXJuZXQgRXhwbG9yZXIuICovXHJcbmZ1bmN0aW9uIGlzSUUoKSB7XHJcbiAgICB2YXIgdWEgPSBnZXRVQSgpO1xyXG4gICAgcmV0dXJuIHVhLmluZGV4T2YoJ01TSUUgJykgPj0gMCB8fCB1YS5pbmRleE9mKCdUcmlkZW50LycpID49IDA7XHJcbn1cclxuLyoqIERldGVjdHMgVW5pdmVyc2FsIFdpbmRvd3MgUGxhdGZvcm0gYXBwcy4gKi9cclxuZnVuY3Rpb24gaXNVV1AoKSB7XHJcbiAgICByZXR1cm4gZ2V0VUEoKS5pbmRleE9mKCdNU0FwcEhvc3QvJykgPj0gMDtcclxufVxyXG4vKipcclxuICogRGV0ZWN0IHdoZXRoZXIgdGhlIGN1cnJlbnQgU0RLIGJ1aWxkIGlzIHRoZSBOb2RlIHZlcnNpb24uXHJcbiAqXHJcbiAqIEByZXR1cm4gdHJ1ZSBpZiBpdCdzIHRoZSBOb2RlIFNESyBidWlsZC5cclxuICovXHJcbmZ1bmN0aW9uIGlzTm9kZVNkaygpIHtcclxuICAgIHJldHVybiBDT05TVEFOVFMuTk9ERV9DTElFTlQgPT09IHRydWUgfHwgQ09OU1RBTlRTLk5PREVfQURNSU4gPT09IHRydWU7XHJcbn1cclxuLyoqIFJldHVybnMgdHJ1ZSBpZiB3ZSBhcmUgcnVubmluZyBpbiBTYWZhcmkuICovXHJcbmZ1bmN0aW9uIGlzU2FmYXJpKCkge1xyXG4gICAgcmV0dXJuICghaXNOb2RlKCkgJiZcclxuICAgICAgICBuYXZpZ2F0b3IudXNlckFnZW50LmluY2x1ZGVzKCdTYWZhcmknKSAmJlxyXG4gICAgICAgICFuYXZpZ2F0b3IudXNlckFnZW50LmluY2x1ZGVzKCdDaHJvbWUnKSk7XHJcbn1cclxuLyoqXHJcbiAqIFRoaXMgbWV0aG9kIGNoZWNrcyBpZiBpbmRleGVkREIgaXMgc3VwcG9ydGVkIGJ5IGN1cnJlbnQgYnJvd3Nlci9zZXJ2aWNlIHdvcmtlciBjb250ZXh0XHJcbiAqIEByZXR1cm4gdHJ1ZSBpZiBpbmRleGVkREIgaXMgc3VwcG9ydGVkIGJ5IGN1cnJlbnQgYnJvd3Nlci9zZXJ2aWNlIHdvcmtlciBjb250ZXh0XHJcbiAqL1xyXG5mdW5jdGlvbiBpc0luZGV4ZWREQkF2YWlsYWJsZSgpIHtcclxuICAgIHJldHVybiAnaW5kZXhlZERCJyBpbiBzZWxmICYmIGluZGV4ZWREQiAhPSBudWxsO1xyXG59XHJcbi8qKlxyXG4gKiBUaGlzIG1ldGhvZCB2YWxpZGF0ZXMgYnJvd3Nlci9zdyBjb250ZXh0IGZvciBpbmRleGVkREIgYnkgb3BlbmluZyBhIGR1bW15IGluZGV4ZWREQiBkYXRhYmFzZSBhbmQgcmVqZWN0XHJcbiAqIGlmIGVycm9ycyBvY2N1ciBkdXJpbmcgdGhlIGRhdGFiYXNlIG9wZW4gb3BlcmF0aW9uLlxyXG4gKlxyXG4gKiBAdGhyb3dzIGV4Y2VwdGlvbiBpZiBjdXJyZW50IGJyb3dzZXIvc3cgY29udGV4dCBjYW4ndCBydW4gaWRiLm9wZW4gKGV4OiBTYWZhcmkgaWZyYW1lLCBGaXJlZm94XHJcbiAqIHByaXZhdGUgYnJvd3NpbmcpXHJcbiAqL1xyXG5mdW5jdGlvbiB2YWxpZGF0ZUluZGV4ZWREQk9wZW5hYmxlKCkge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICB2YXIgcHJlRXhpc3RfMSA9IHRydWU7XHJcbiAgICAgICAgICAgIHZhciBEQl9DSEVDS19OQU1FXzEgPSAndmFsaWRhdGUtYnJvd3Nlci1jb250ZXh0LWZvci1pbmRleGVkZGItYW5hbHl0aWNzLW1vZHVsZSc7XHJcbiAgICAgICAgICAgIHZhciByZXF1ZXN0XzEgPSBzZWxmLmluZGV4ZWREQi5vcGVuKERCX0NIRUNLX05BTUVfMSk7XHJcbiAgICAgICAgICAgIHJlcXVlc3RfMS5vbnN1Y2Nlc3MgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXF1ZXN0XzEucmVzdWx0LmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAvLyBkZWxldGUgZGF0YWJhc2Ugb25seSB3aGVuIGl0IGRvZXNuJ3QgcHJlLWV4aXN0XHJcbiAgICAgICAgICAgICAgICBpZiAoIXByZUV4aXN0XzEpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmluZGV4ZWREQi5kZWxldGVEYXRhYmFzZShEQl9DSEVDS19OQU1FXzEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgcmVxdWVzdF8xLm9udXBncmFkZW5lZWRlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHByZUV4aXN0XzEgPSBmYWxzZTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgcmVxdWVzdF8xLm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgICAgICAgICByZWplY3QoKChfYSA9IHJlcXVlc3RfMS5lcnJvcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLm1lc3NhZ2UpIHx8ICcnKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIHJlamVjdChlcnJvcik7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn1cclxuLyoqXHJcbiAqXHJcbiAqIFRoaXMgbWV0aG9kIGNoZWNrcyB3aGV0aGVyIGNvb2tpZSBpcyBlbmFibGVkIHdpdGhpbiBjdXJyZW50IGJyb3dzZXJcclxuICogQHJldHVybiB0cnVlIGlmIGNvb2tpZSBpcyBlbmFibGVkIHdpdGhpbiBjdXJyZW50IGJyb3dzZXJcclxuICovXHJcbmZ1bmN0aW9uIGFyZUNvb2tpZXNFbmFibGVkKCkge1xyXG4gICAgaWYgKCFuYXZpZ2F0b3IgfHwgIW5hdmlnYXRvci5jb29raWVFbmFibGVkKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbn1cclxuLyoqXHJcbiAqIFBvbHlmaWxsIGZvciBgZ2xvYmFsVGhpc2Agb2JqZWN0LlxyXG4gKiBAcmV0dXJucyB0aGUgYGdsb2JhbFRoaXNgIG9iamVjdCBmb3IgdGhlIGdpdmVuIGVudmlyb25tZW50LlxyXG4gKi9cclxuZnVuY3Rpb24gZ2V0R2xvYmFsKCkge1xyXG4gICAgaWYgKHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgIHJldHVybiBzZWxmO1xyXG4gICAgfVxyXG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgcmV0dXJuIHdpbmRvdztcclxuICAgIH1cclxuICAgIGlmICh0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgIHJldHVybiBnbG9iYWw7XHJcbiAgICB9XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuYWJsZSB0byBsb2NhdGUgZ2xvYmFsIG9iamVjdC4nKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG52YXIgRVJST1JfTkFNRSA9ICdGaXJlYmFzZUVycm9yJztcclxuLy8gQmFzZWQgb24gY29kZSBmcm9tOlxyXG4vLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9FcnJvciNDdXN0b21fRXJyb3JfVHlwZXNcclxudmFyIEZpcmViYXNlRXJyb3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICBfX2V4dGVuZHMoRmlyZWJhc2VFcnJvciwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIEZpcmViYXNlRXJyb3IoY29kZSwgbWVzc2FnZSwgY3VzdG9tRGF0YSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIG1lc3NhZ2UpIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMuY29kZSA9IGNvZGU7XHJcbiAgICAgICAgX3RoaXMuY3VzdG9tRGF0YSA9IGN1c3RvbURhdGE7XHJcbiAgICAgICAgX3RoaXMubmFtZSA9IEVSUk9SX05BTUU7XHJcbiAgICAgICAgLy8gRml4IEZvciBFUzVcclxuICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vTWljcm9zb2Z0L1R5cGVTY3JpcHQtd2lraS9ibG9iL21hc3Rlci9CcmVha2luZy1DaGFuZ2VzLm1kI2V4dGVuZGluZy1idWlsdC1pbnMtbGlrZS1lcnJvci1hcnJheS1hbmQtbWFwLW1heS1uby1sb25nZXItd29ya1xyXG4gICAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZihfdGhpcywgRmlyZWJhc2VFcnJvci5wcm90b3R5cGUpO1xyXG4gICAgICAgIC8vIE1haW50YWlucyBwcm9wZXIgc3RhY2sgdHJhY2UgZm9yIHdoZXJlIG91ciBlcnJvciB3YXMgdGhyb3duLlxyXG4gICAgICAgIC8vIE9ubHkgYXZhaWxhYmxlIG9uIFY4LlxyXG4gICAgICAgIGlmIChFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSkge1xyXG4gICAgICAgICAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZShfdGhpcywgRXJyb3JGYWN0b3J5LnByb3RvdHlwZS5jcmVhdGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gRmlyZWJhc2VFcnJvcjtcclxufShFcnJvcikpO1xyXG52YXIgRXJyb3JGYWN0b3J5ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRXJyb3JGYWN0b3J5KHNlcnZpY2UsIHNlcnZpY2VOYW1lLCBlcnJvcnMpIHtcclxuICAgICAgICB0aGlzLnNlcnZpY2UgPSBzZXJ2aWNlO1xyXG4gICAgICAgIHRoaXMuc2VydmljZU5hbWUgPSBzZXJ2aWNlTmFtZTtcclxuICAgICAgICB0aGlzLmVycm9ycyA9IGVycm9ycztcclxuICAgIH1cclxuICAgIEVycm9yRmFjdG9yeS5wcm90b3R5cGUuY3JlYXRlID0gZnVuY3Rpb24gKGNvZGUpIHtcclxuICAgICAgICB2YXIgZGF0YSA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIGRhdGFbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBjdXN0b21EYXRhID0gZGF0YVswXSB8fCB7fTtcclxuICAgICAgICB2YXIgZnVsbENvZGUgPSB0aGlzLnNlcnZpY2UgKyBcIi9cIiArIGNvZGU7XHJcbiAgICAgICAgdmFyIHRlbXBsYXRlID0gdGhpcy5lcnJvcnNbY29kZV07XHJcbiAgICAgICAgdmFyIG1lc3NhZ2UgPSB0ZW1wbGF0ZSA/IHJlcGxhY2VUZW1wbGF0ZSh0ZW1wbGF0ZSwgY3VzdG9tRGF0YSkgOiAnRXJyb3InO1xyXG4gICAgICAgIC8vIFNlcnZpY2UgTmFtZTogRXJyb3IgbWVzc2FnZSAoc2VydmljZS9jb2RlKS5cclxuICAgICAgICB2YXIgZnVsbE1lc3NhZ2UgPSB0aGlzLnNlcnZpY2VOYW1lICsgXCI6IFwiICsgbWVzc2FnZSArIFwiIChcIiArIGZ1bGxDb2RlICsgXCIpLlwiO1xyXG4gICAgICAgIHZhciBlcnJvciA9IG5ldyBGaXJlYmFzZUVycm9yKGZ1bGxDb2RlLCBmdWxsTWVzc2FnZSwgY3VzdG9tRGF0YSk7XHJcbiAgICAgICAgcmV0dXJuIGVycm9yO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBFcnJvckZhY3Rvcnk7XHJcbn0oKSk7XHJcbmZ1bmN0aW9uIHJlcGxhY2VUZW1wbGF0ZSh0ZW1wbGF0ZSwgZGF0YSkge1xyXG4gICAgcmV0dXJuIHRlbXBsYXRlLnJlcGxhY2UoUEFUVEVSTiwgZnVuY3Rpb24gKF8sIGtleSkge1xyXG4gICAgICAgIHZhciB2YWx1ZSA9IGRhdGFba2V5XTtcclxuICAgICAgICByZXR1cm4gdmFsdWUgIT0gbnVsbCA/IFN0cmluZyh2YWx1ZSkgOiBcIjxcIiArIGtleSArIFwiPz5cIjtcclxuICAgIH0pO1xyXG59XHJcbnZhciBQQVRURVJOID0gL1xce1xcJChbXn1dKyl9L2c7XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBFdmFsdWF0ZXMgYSBKU09OIHN0cmluZyBpbnRvIGEgamF2YXNjcmlwdCBvYmplY3QuXHJcbiAqXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdHIgQSBzdHJpbmcgY29udGFpbmluZyBKU09OLlxyXG4gKiBAcmV0dXJuIHsqfSBUaGUgamF2YXNjcmlwdCBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSBzcGVjaWZpZWQgSlNPTi5cclxuICovXHJcbmZ1bmN0aW9uIGpzb25FdmFsKHN0cikge1xyXG4gICAgcmV0dXJuIEpTT04ucGFyc2Uoc3RyKTtcclxufVxyXG4vKipcclxuICogUmV0dXJucyBKU09OIHJlcHJlc2VudGluZyBhIGphdmFzY3JpcHQgb2JqZWN0LlxyXG4gKiBAcGFyYW0geyp9IGRhdGEgSmF2YXNjcmlwdCBvYmplY3QgdG8gYmUgc3RyaW5naWZpZWQuXHJcbiAqIEByZXR1cm4ge3N0cmluZ30gVGhlIEpTT04gY29udGVudHMgb2YgdGhlIG9iamVjdC5cclxuICovXHJcbmZ1bmN0aW9uIHN0cmluZ2lmeShkYXRhKSB7XHJcbiAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoZGF0YSk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIERlY29kZXMgYSBGaXJlYmFzZSBhdXRoLiB0b2tlbiBpbnRvIGNvbnN0aXR1ZW50IHBhcnRzLlxyXG4gKlxyXG4gKiBOb3RlczpcclxuICogLSBNYXkgcmV0dXJuIHdpdGggaW52YWxpZCAvIGluY29tcGxldGUgY2xhaW1zIGlmIHRoZXJlJ3Mgbm8gbmF0aXZlIGJhc2U2NCBkZWNvZGluZyBzdXBwb3J0LlxyXG4gKiAtIERvZXNuJ3QgY2hlY2sgaWYgdGhlIHRva2VuIGlzIGFjdHVhbGx5IHZhbGlkLlxyXG4gKi9cclxudmFyIGRlY29kZSA9IGZ1bmN0aW9uICh0b2tlbikge1xyXG4gICAgdmFyIGhlYWRlciA9IHt9LCBjbGFpbXMgPSB7fSwgZGF0YSA9IHt9LCBzaWduYXR1cmUgPSAnJztcclxuICAgIHRyeSB7XHJcbiAgICAgICAgdmFyIHBhcnRzID0gdG9rZW4uc3BsaXQoJy4nKTtcclxuICAgICAgICBoZWFkZXIgPSBqc29uRXZhbChiYXNlNjREZWNvZGUocGFydHNbMF0pIHx8ICcnKTtcclxuICAgICAgICBjbGFpbXMgPSBqc29uRXZhbChiYXNlNjREZWNvZGUocGFydHNbMV0pIHx8ICcnKTtcclxuICAgICAgICBzaWduYXR1cmUgPSBwYXJ0c1syXTtcclxuICAgICAgICBkYXRhID0gY2xhaW1zWydkJ10gfHwge307XHJcbiAgICAgICAgZGVsZXRlIGNsYWltc1snZCddO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGUpIHsgfVxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBoZWFkZXI6IGhlYWRlcixcclxuICAgICAgICBjbGFpbXM6IGNsYWltcyxcclxuICAgICAgICBkYXRhOiBkYXRhLFxyXG4gICAgICAgIHNpZ25hdHVyZTogc2lnbmF0dXJlXHJcbiAgICB9O1xyXG59O1xyXG4vKipcclxuICogRGVjb2RlcyBhIEZpcmViYXNlIGF1dGguIHRva2VuIGFuZCBjaGVja3MgdGhlIHZhbGlkaXR5IG9mIGl0cyB0aW1lLWJhc2VkIGNsYWltcy4gV2lsbCByZXR1cm4gdHJ1ZSBpZiB0aGVcclxuICogdG9rZW4gaXMgd2l0aGluIHRoZSB0aW1lIHdpbmRvdyBhdXRob3JpemVkIGJ5IHRoZSAnbmJmJyAobm90LWJlZm9yZSkgYW5kICdpYXQnIChpc3N1ZWQtYXQpIGNsYWltcy5cclxuICpcclxuICogTm90ZXM6XHJcbiAqIC0gTWF5IHJldHVybiBhIGZhbHNlIG5lZ2F0aXZlIGlmIHRoZXJlJ3Mgbm8gbmF0aXZlIGJhc2U2NCBkZWNvZGluZyBzdXBwb3J0LlxyXG4gKiAtIERvZXNuJ3QgY2hlY2sgaWYgdGhlIHRva2VuIGlzIGFjdHVhbGx5IHZhbGlkLlxyXG4gKi9cclxudmFyIGlzVmFsaWRUaW1lc3RhbXAgPSBmdW5jdGlvbiAodG9rZW4pIHtcclxuICAgIHZhciBjbGFpbXMgPSBkZWNvZGUodG9rZW4pLmNsYWltcztcclxuICAgIHZhciBub3cgPSBNYXRoLmZsb29yKG5ldyBEYXRlKCkuZ2V0VGltZSgpIC8gMTAwMCk7XHJcbiAgICB2YXIgdmFsaWRTaW5jZSA9IDAsIHZhbGlkVW50aWwgPSAwO1xyXG4gICAgaWYgKHR5cGVvZiBjbGFpbXMgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgaWYgKGNsYWltcy5oYXNPd25Qcm9wZXJ0eSgnbmJmJykpIHtcclxuICAgICAgICAgICAgdmFsaWRTaW5jZSA9IGNsYWltc1snbmJmJ107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGNsYWltcy5oYXNPd25Qcm9wZXJ0eSgnaWF0JykpIHtcclxuICAgICAgICAgICAgdmFsaWRTaW5jZSA9IGNsYWltc1snaWF0J107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChjbGFpbXMuaGFzT3duUHJvcGVydHkoJ2V4cCcpKSB7XHJcbiAgICAgICAgICAgIHZhbGlkVW50aWwgPSBjbGFpbXNbJ2V4cCddO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gdG9rZW4gd2lsbCBleHBpcmUgYWZ0ZXIgMjRoIGJ5IGRlZmF1bHRcclxuICAgICAgICAgICAgdmFsaWRVbnRpbCA9IHZhbGlkU2luY2UgKyA4NjQwMDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gKCEhbm93ICYmXHJcbiAgICAgICAgISF2YWxpZFNpbmNlICYmXHJcbiAgICAgICAgISF2YWxpZFVudGlsICYmXHJcbiAgICAgICAgbm93ID49IHZhbGlkU2luY2UgJiZcclxuICAgICAgICBub3cgPD0gdmFsaWRVbnRpbCk7XHJcbn07XHJcbi8qKlxyXG4gKiBEZWNvZGVzIGEgRmlyZWJhc2UgYXV0aC4gdG9rZW4gYW5kIHJldHVybnMgaXRzIGlzc3VlZCBhdCB0aW1lIGlmIHZhbGlkLCBudWxsIG90aGVyd2lzZS5cclxuICpcclxuICogTm90ZXM6XHJcbiAqIC0gTWF5IHJldHVybiBudWxsIGlmIHRoZXJlJ3Mgbm8gbmF0aXZlIGJhc2U2NCBkZWNvZGluZyBzdXBwb3J0LlxyXG4gKiAtIERvZXNuJ3QgY2hlY2sgaWYgdGhlIHRva2VuIGlzIGFjdHVhbGx5IHZhbGlkLlxyXG4gKi9cclxudmFyIGlzc3VlZEF0VGltZSA9IGZ1bmN0aW9uICh0b2tlbikge1xyXG4gICAgdmFyIGNsYWltcyA9IGRlY29kZSh0b2tlbikuY2xhaW1zO1xyXG4gICAgaWYgKHR5cGVvZiBjbGFpbXMgPT09ICdvYmplY3QnICYmIGNsYWltcy5oYXNPd25Qcm9wZXJ0eSgnaWF0JykpIHtcclxuICAgICAgICByZXR1cm4gY2xhaW1zWydpYXQnXTtcclxuICAgIH1cclxuICAgIHJldHVybiBudWxsO1xyXG59O1xyXG4vKipcclxuICogRGVjb2RlcyBhIEZpcmViYXNlIGF1dGguIHRva2VuIGFuZCBjaGVja3MgdGhlIHZhbGlkaXR5IG9mIGl0cyBmb3JtYXQuIEV4cGVjdHMgYSB2YWxpZCBpc3N1ZWQtYXQgdGltZS5cclxuICpcclxuICogTm90ZXM6XHJcbiAqIC0gTWF5IHJldHVybiBhIGZhbHNlIG5lZ2F0aXZlIGlmIHRoZXJlJ3Mgbm8gbmF0aXZlIGJhc2U2NCBkZWNvZGluZyBzdXBwb3J0LlxyXG4gKiAtIERvZXNuJ3QgY2hlY2sgaWYgdGhlIHRva2VuIGlzIGFjdHVhbGx5IHZhbGlkLlxyXG4gKi9cclxudmFyIGlzVmFsaWRGb3JtYXQgPSBmdW5jdGlvbiAodG9rZW4pIHtcclxuICAgIHZhciBkZWNvZGVkID0gZGVjb2RlKHRva2VuKSwgY2xhaW1zID0gZGVjb2RlZC5jbGFpbXM7XHJcbiAgICByZXR1cm4gISFjbGFpbXMgJiYgdHlwZW9mIGNsYWltcyA9PT0gJ29iamVjdCcgJiYgY2xhaW1zLmhhc093blByb3BlcnR5KCdpYXQnKTtcclxufTtcclxuLyoqXHJcbiAqIEF0dGVtcHRzIHRvIHBlZXIgaW50byBhbiBhdXRoIHRva2VuIGFuZCBkZXRlcm1pbmUgaWYgaXQncyBhbiBhZG1pbiBhdXRoIHRva2VuIGJ5IGxvb2tpbmcgYXQgdGhlIGNsYWltcyBwb3J0aW9uLlxyXG4gKlxyXG4gKiBOb3RlczpcclxuICogLSBNYXkgcmV0dXJuIGEgZmFsc2UgbmVnYXRpdmUgaWYgdGhlcmUncyBubyBuYXRpdmUgYmFzZTY0IGRlY29kaW5nIHN1cHBvcnQuXHJcbiAqIC0gRG9lc24ndCBjaGVjayBpZiB0aGUgdG9rZW4gaXMgYWN0dWFsbHkgdmFsaWQuXHJcbiAqL1xyXG52YXIgaXNBZG1pbiA9IGZ1bmN0aW9uICh0b2tlbikge1xyXG4gICAgdmFyIGNsYWltcyA9IGRlY29kZSh0b2tlbikuY2xhaW1zO1xyXG4gICAgcmV0dXJuIHR5cGVvZiBjbGFpbXMgPT09ICdvYmplY3QnICYmIGNsYWltc1snYWRtaW4nXSA9PT0gdHJ1ZTtcclxufTtcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuZnVuY3Rpb24gY29udGFpbnMob2JqLCBrZXkpIHtcclxuICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpO1xyXG59XHJcbmZ1bmN0aW9uIHNhZmVHZXQob2JqLCBrZXkpIHtcclxuICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7XHJcbiAgICAgICAgcmV0dXJuIG9ialtrZXldO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBpc0VtcHR5KG9iaikge1xyXG4gICAgZm9yICh2YXIga2V5IGluIG9iaikge1xyXG4gICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxufVxyXG5mdW5jdGlvbiBtYXAob2JqLCBmbiwgY29udGV4dE9iaikge1xyXG4gICAgdmFyIHJlcyA9IHt9O1xyXG4gICAgZm9yICh2YXIga2V5IGluIG9iaikge1xyXG4gICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7XHJcbiAgICAgICAgICAgIHJlc1trZXldID0gZm4uY2FsbChjb250ZXh0T2JqLCBvYmpba2V5XSwga2V5LCBvYmopO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiByZXM7XHJcbn1cclxuLyoqXHJcbiAqIERlZXAgZXF1YWwgdHdvIG9iamVjdHMuIFN1cHBvcnQgQXJyYXlzIGFuZCBPYmplY3RzLlxyXG4gKi9cclxuZnVuY3Rpb24gZGVlcEVxdWFsKGEsIGIpIHtcclxuICAgIGlmIChhID09PSBiKSB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgICB2YXIgYUtleXMgPSBPYmplY3Qua2V5cyhhKTtcclxuICAgIHZhciBiS2V5cyA9IE9iamVjdC5rZXlzKGIpO1xyXG4gICAgZm9yICh2YXIgX2kgPSAwLCBhS2V5c18xID0gYUtleXM7IF9pIDwgYUtleXNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICB2YXIgayA9IGFLZXlzXzFbX2ldO1xyXG4gICAgICAgIGlmICghYktleXMuaW5jbHVkZXMoaykpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgYVByb3AgPSBhW2tdO1xyXG4gICAgICAgIHZhciBiUHJvcCA9IGJba107XHJcbiAgICAgICAgaWYgKGlzT2JqZWN0KGFQcm9wKSAmJiBpc09iamVjdChiUHJvcCkpIHtcclxuICAgICAgICAgICAgaWYgKCFkZWVwRXF1YWwoYVByb3AsIGJQcm9wKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGFQcm9wICE9PSBiUHJvcCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZm9yICh2YXIgX2EgPSAwLCBiS2V5c18xID0gYktleXM7IF9hIDwgYktleXNfMS5sZW5ndGg7IF9hKyspIHtcclxuICAgICAgICB2YXIgayA9IGJLZXlzXzFbX2FdO1xyXG4gICAgICAgIGlmICghYUtleXMuaW5jbHVkZXMoaykpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiB0cnVlO1xyXG59XHJcbmZ1bmN0aW9uIGlzT2JqZWN0KHRoaW5nKSB7XHJcbiAgICByZXR1cm4gdGhpbmcgIT09IG51bGwgJiYgdHlwZW9mIHRoaW5nID09PSAnb2JqZWN0JztcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogUmV0dXJucyBhIHF1ZXJ5c3RyaW5nLWZvcm1hdHRlZCBzdHJpbmcgKGUuZy4gJmFyZz12YWwmYXJnMj12YWwyKSBmcm9tIGFcclxuICogcGFyYW1zIG9iamVjdCAoZS5nLiB7YXJnOiAndmFsJywgYXJnMjogJ3ZhbDInfSlcclxuICogTm90ZTogWW91IG11c3QgcHJlcGVuZCBpdCB3aXRoID8gd2hlbiBhZGRpbmcgaXQgdG8gYSBVUkwuXHJcbiAqL1xyXG5mdW5jdGlvbiBxdWVyeXN0cmluZyhxdWVyeXN0cmluZ1BhcmFtcykge1xyXG4gICAgdmFyIHBhcmFtcyA9IFtdO1xyXG4gICAgdmFyIF9sb29wXzEgPSBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xyXG4gICAgICAgICAgICB2YWx1ZS5mb3JFYWNoKGZ1bmN0aW9uIChhcnJheVZhbCkge1xyXG4gICAgICAgICAgICAgICAgcGFyYW1zLnB1c2goZW5jb2RlVVJJQ29tcG9uZW50KGtleSkgKyAnPScgKyBlbmNvZGVVUklDb21wb25lbnQoYXJyYXlWYWwpKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBwYXJhbXMucHVzaChlbmNvZGVVUklDb21wb25lbnQoa2V5KSArICc9JyArIGVuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gT2JqZWN0LmVudHJpZXMocXVlcnlzdHJpbmdQYXJhbXMpOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgIHZhciBfYiA9IF9hW19pXSwga2V5ID0gX2JbMF0sIHZhbHVlID0gX2JbMV07XHJcbiAgICAgICAgX2xvb3BfMShrZXksIHZhbHVlKTtcclxuICAgIH1cclxuICAgIHJldHVybiBwYXJhbXMubGVuZ3RoID8gJyYnICsgcGFyYW1zLmpvaW4oJyYnKSA6ICcnO1xyXG59XHJcbi8qKlxyXG4gKiBEZWNvZGVzIGEgcXVlcnlzdHJpbmcgKGUuZy4gP2FyZz12YWwmYXJnMj12YWwyKSBpbnRvIGEgcGFyYW1zIG9iamVjdFxyXG4gKiAoZS5nLiB7YXJnOiAndmFsJywgYXJnMjogJ3ZhbDInfSlcclxuICovXHJcbmZ1bmN0aW9uIHF1ZXJ5c3RyaW5nRGVjb2RlKHF1ZXJ5c3RyaW5nKSB7XHJcbiAgICB2YXIgb2JqID0ge307XHJcbiAgICB2YXIgdG9rZW5zID0gcXVlcnlzdHJpbmcucmVwbGFjZSgvXlxcPy8sICcnKS5zcGxpdCgnJicpO1xyXG4gICAgdG9rZW5zLmZvckVhY2goZnVuY3Rpb24gKHRva2VuKSB7XHJcbiAgICAgICAgaWYgKHRva2VuKSB7XHJcbiAgICAgICAgICAgIHZhciBfYSA9IHRva2VuLnNwbGl0KCc9JyksIGtleSA9IF9hWzBdLCB2YWx1ZSA9IF9hWzFdO1xyXG4gICAgICAgICAgICBvYmpbZGVjb2RlVVJJQ29tcG9uZW50KGtleSldID0gZGVjb2RlVVJJQ29tcG9uZW50KHZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBvYmo7XHJcbn1cclxuLyoqXHJcbiAqIEV4dHJhY3QgdGhlIHF1ZXJ5IHN0cmluZyBwYXJ0IG9mIGEgVVJMLCBpbmNsdWRpbmcgdGhlIGxlYWRpbmcgcXVlc3Rpb24gbWFyayAoaWYgcHJlc2VudCkuXHJcbiAqL1xyXG5mdW5jdGlvbiBleHRyYWN0UXVlcnlzdHJpbmcodXJsKSB7XHJcbiAgICB2YXIgcXVlcnlTdGFydCA9IHVybC5pbmRleE9mKCc/Jyk7XHJcbiAgICBpZiAoIXF1ZXJ5U3RhcnQpIHtcclxuICAgICAgICByZXR1cm4gJyc7XHJcbiAgICB9XHJcbiAgICB2YXIgZnJhZ21lbnRTdGFydCA9IHVybC5pbmRleE9mKCcjJywgcXVlcnlTdGFydCk7XHJcbiAgICByZXR1cm4gdXJsLnN1YnN0cmluZyhxdWVyeVN0YXJ0LCBmcmFnbWVudFN0YXJ0ID4gMCA/IGZyYWdtZW50U3RhcnQgOiB1bmRlZmluZWQpO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBAZmlsZW92ZXJ2aWV3IFNIQS0xIGNyeXB0b2dyYXBoaWMgaGFzaC5cclxuICogVmFyaWFibGUgbmFtZXMgZm9sbG93IHRoZSBub3RhdGlvbiBpbiBGSVBTIFBVQiAxODAtMzpcclxuICogaHR0cDovL2NzcmMubmlzdC5nb3YvcHVibGljYXRpb25zL2ZpcHMvZmlwczE4MC0zL2ZpcHMxODAtM19maW5hbC5wZGYuXHJcbiAqXHJcbiAqIFVzYWdlOlxyXG4gKiAgIHZhciBzaGExID0gbmV3IHNoYTEoKTtcclxuICogICBzaGExLnVwZGF0ZShieXRlcyk7XHJcbiAqICAgdmFyIGhhc2ggPSBzaGExLmRpZ2VzdCgpO1xyXG4gKlxyXG4gKiBQZXJmb3JtYW5jZTpcclxuICogICBDaHJvbWUgMjM6ICAgfjQwMCBNYml0L3NcclxuICogICBGaXJlZm94IDE2OiAgfjI1MCBNYml0L3NcclxuICpcclxuICovXHJcbi8qKlxyXG4gKiBTSEEtMSBjcnlwdG9ncmFwaGljIGhhc2ggY29uc3RydWN0b3IuXHJcbiAqXHJcbiAqIFRoZSBwcm9wZXJ0aWVzIGRlY2xhcmVkIGhlcmUgYXJlIGRpc2N1c3NlZCBpbiB0aGUgYWJvdmUgYWxnb3JpdGhtIGRvY3VtZW50LlxyXG4gKiBAY29uc3RydWN0b3JcclxuICogQGZpbmFsXHJcbiAqIEBzdHJ1Y3RcclxuICovXHJcbnZhciBTaGExID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gU2hhMSgpIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBIb2xkcyB0aGUgcHJldmlvdXMgdmFsdWVzIG9mIGFjY3VtdWxhdGVkIHZhcmlhYmxlcyBhLWUgaW4gdGhlIGNvbXByZXNzX1xyXG4gICAgICAgICAqIGZ1bmN0aW9uLlxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5jaGFpbl8gPSBbXTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBBIGJ1ZmZlciBob2xkaW5nIHRoZSBwYXJ0aWFsbHkgY29tcHV0ZWQgaGFzaCByZXN1bHQuXHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLmJ1Zl8gPSBbXTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBBbiBhcnJheSBvZiA4MCBieXRlcywgZWFjaCBhIHBhcnQgb2YgdGhlIG1lc3NhZ2UgdG8gYmUgaGFzaGVkLiAgUmVmZXJyZWQgdG9cclxuICAgICAgICAgKiBhcyB0aGUgbWVzc2FnZSBzY2hlZHVsZSBpbiB0aGUgZG9jcy5cclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuV18gPSBbXTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBDb250YWlucyBkYXRhIG5lZWRlZCB0byBwYWQgbWVzc2FnZXMgbGVzcyB0aGFuIDY0IGJ5dGVzLlxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5wYWRfID0gW107XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQHByaXZhdGUge251bWJlcn1cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLmluYnVmXyA9IDA7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQHByaXZhdGUge251bWJlcn1cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLnRvdGFsXyA9IDA7XHJcbiAgICAgICAgdGhpcy5ibG9ja1NpemUgPSA1MTIgLyA4O1xyXG4gICAgICAgIHRoaXMucGFkX1swXSA9IDEyODtcclxuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IHRoaXMuYmxvY2tTaXplOyArK2kpIHtcclxuICAgICAgICAgICAgdGhpcy5wYWRfW2ldID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5yZXNldCgpO1xyXG4gICAgfVxyXG4gICAgU2hhMS5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bMF0gPSAweDY3NDUyMzAxO1xyXG4gICAgICAgIHRoaXMuY2hhaW5fWzFdID0gMHhlZmNkYWI4OTtcclxuICAgICAgICB0aGlzLmNoYWluX1syXSA9IDB4OThiYWRjZmU7XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bM10gPSAweDEwMzI1NDc2O1xyXG4gICAgICAgIHRoaXMuY2hhaW5fWzRdID0gMHhjM2QyZTFmMDtcclxuICAgICAgICB0aGlzLmluYnVmXyA9IDA7XHJcbiAgICAgICAgdGhpcy50b3RhbF8gPSAwO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogSW50ZXJuYWwgY29tcHJlc3MgaGVscGVyIGZ1bmN0aW9uLlxyXG4gICAgICogQHBhcmFtIGJ1ZiBCbG9jayB0byBjb21wcmVzcy5cclxuICAgICAqIEBwYXJhbSBvZmZzZXQgT2Zmc2V0IG9mIHRoZSBibG9jayBpbiB0aGUgYnVmZmVyLlxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqL1xyXG4gICAgU2hhMS5wcm90b3R5cGUuY29tcHJlc3NfID0gZnVuY3Rpb24gKGJ1Ziwgb2Zmc2V0KSB7XHJcbiAgICAgICAgaWYgKCFvZmZzZXQpIHtcclxuICAgICAgICAgICAgb2Zmc2V0ID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIFcgPSB0aGlzLldfO1xyXG4gICAgICAgIC8vIGdldCAxNiBiaWcgZW5kaWFuIHdvcmRzXHJcbiAgICAgICAgaWYgKHR5cGVvZiBidWYgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMTY7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgLy8gVE9ETyh1c2VyKTogW2J1ZyA4MTQwMTIyXSBSZWNlbnQgdmVyc2lvbnMgb2YgU2FmYXJpIGZvciBNYWMgT1MgYW5kIGlPU1xyXG4gICAgICAgICAgICAgICAgLy8gaGF2ZSBhIGJ1ZyB0aGF0IHR1cm5zIHRoZSBwb3N0LWluY3JlbWVudCArKyBvcGVyYXRvciBpbnRvIHByZS1pbmNyZW1lbnRcclxuICAgICAgICAgICAgICAgIC8vIGR1cmluZyBKSVQgY29tcGlsYXRpb24uICBXZSBoYXZlIGNvZGUgdGhhdCBkZXBlbmRzIGhlYXZpbHkgb24gU0hBLTEgZm9yXHJcbiAgICAgICAgICAgICAgICAvLyBjb3JyZWN0bmVzcyBhbmQgd2hpY2ggaXMgYWZmZWN0ZWQgYnkgdGhpcyBidWcsIHNvIEkndmUgcmVtb3ZlZCBhbGwgdXNlc1xyXG4gICAgICAgICAgICAgICAgLy8gb2YgcG9zdC1pbmNyZW1lbnQgKysgaW4gd2hpY2ggdGhlIHJlc3VsdCB2YWx1ZSBpcyB1c2VkLiAgV2UgY2FuIHJldmVydFxyXG4gICAgICAgICAgICAgICAgLy8gdGhpcyBjaGFuZ2Ugb25jZSB0aGUgU2FmYXJpIGJ1Z1xyXG4gICAgICAgICAgICAgICAgLy8gKGh0dHBzOi8vYnVncy53ZWJraXQub3JnL3Nob3dfYnVnLmNnaT9pZD0xMDkwMzYpIGhhcyBiZWVuIGZpeGVkIGFuZFxyXG4gICAgICAgICAgICAgICAgLy8gbW9zdCBjbGllbnRzIGhhdmUgYmVlbiB1cGRhdGVkLlxyXG4gICAgICAgICAgICAgICAgV1tpXSA9XHJcbiAgICAgICAgICAgICAgICAgICAgKGJ1Zi5jaGFyQ29kZUF0KG9mZnNldCkgPDwgMjQpIHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgKGJ1Zi5jaGFyQ29kZUF0KG9mZnNldCArIDEpIDw8IDE2KSB8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChidWYuY2hhckNvZGVBdChvZmZzZXQgKyAyKSA8PCA4KSB8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1Zi5jaGFyQ29kZUF0KG9mZnNldCArIDMpO1xyXG4gICAgICAgICAgICAgICAgb2Zmc2V0ICs9IDQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMTY7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgV1tpXSA9XHJcbiAgICAgICAgICAgICAgICAgICAgKGJ1ZltvZmZzZXRdIDw8IDI0KSB8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChidWZbb2Zmc2V0ICsgMV0gPDwgMTYpIHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgKGJ1ZltvZmZzZXQgKyAyXSA8PCA4KSB8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1ZltvZmZzZXQgKyAzXTtcclxuICAgICAgICAgICAgICAgIG9mZnNldCArPSA0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGV4cGFuZCB0byA4MCB3b3Jkc1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAxNjsgaSA8IDgwOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIHQgPSBXW2kgLSAzXSBeIFdbaSAtIDhdIF4gV1tpIC0gMTRdIF4gV1tpIC0gMTZdO1xyXG4gICAgICAgICAgICBXW2ldID0gKCh0IDw8IDEpIHwgKHQgPj4+IDMxKSkgJiAweGZmZmZmZmZmO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgYSA9IHRoaXMuY2hhaW5fWzBdO1xyXG4gICAgICAgIHZhciBiID0gdGhpcy5jaGFpbl9bMV07XHJcbiAgICAgICAgdmFyIGMgPSB0aGlzLmNoYWluX1syXTtcclxuICAgICAgICB2YXIgZCA9IHRoaXMuY2hhaW5fWzNdO1xyXG4gICAgICAgIHZhciBlID0gdGhpcy5jaGFpbl9bNF07XHJcbiAgICAgICAgdmFyIGYsIGs7XHJcbiAgICAgICAgLy8gVE9ETyh1c2VyKTogVHJ5IHRvIHVucm9sbCB0aGlzIGxvb3AgdG8gc3BlZWQgdXAgdGhlIGNvbXB1dGF0aW9uLlxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgODA7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAoaSA8IDQwKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaSA8IDIwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZiA9IGQgXiAoYiAmIChjIF4gZCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGsgPSAweDVhODI3OTk5O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZiA9IGIgXiBjIF4gZDtcclxuICAgICAgICAgICAgICAgICAgICBrID0gMHg2ZWQ5ZWJhMTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmIChpIDwgNjApIHtcclxuICAgICAgICAgICAgICAgICAgICBmID0gKGIgJiBjKSB8IChkICYgKGIgfCBjKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgayA9IDB4OGYxYmJjZGM7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBmID0gYiBeIGMgXiBkO1xyXG4gICAgICAgICAgICAgICAgICAgIGsgPSAweGNhNjJjMWQ2O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciB0ID0gKCgoYSA8PCA1KSB8IChhID4+PiAyNykpICsgZiArIGUgKyBrICsgV1tpXSkgJiAweGZmZmZmZmZmO1xyXG4gICAgICAgICAgICBlID0gZDtcclxuICAgICAgICAgICAgZCA9IGM7XHJcbiAgICAgICAgICAgIGMgPSAoKGIgPDwgMzApIHwgKGIgPj4+IDIpKSAmIDB4ZmZmZmZmZmY7XHJcbiAgICAgICAgICAgIGIgPSBhO1xyXG4gICAgICAgICAgICBhID0gdDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bMF0gPSAodGhpcy5jaGFpbl9bMF0gKyBhKSAmIDB4ZmZmZmZmZmY7XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bMV0gPSAodGhpcy5jaGFpbl9bMV0gKyBiKSAmIDB4ZmZmZmZmZmY7XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bMl0gPSAodGhpcy5jaGFpbl9bMl0gKyBjKSAmIDB4ZmZmZmZmZmY7XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bM10gPSAodGhpcy5jaGFpbl9bM10gKyBkKSAmIDB4ZmZmZmZmZmY7XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bNF0gPSAodGhpcy5jaGFpbl9bNF0gKyBlKSAmIDB4ZmZmZmZmZmY7XHJcbiAgICB9O1xyXG4gICAgU2hhMS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKGJ5dGVzLCBsZW5ndGgpIHtcclxuICAgICAgICAvLyBUT0RPKGpvaG5sZW56KTogdGlnaHRlbiB0aGUgZnVuY3Rpb24gc2lnbmF0dXJlIGFuZCByZW1vdmUgdGhpcyBjaGVja1xyXG4gICAgICAgIGlmIChieXRlcyA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGxlbmd0aCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIGxlbmd0aCA9IGJ5dGVzLmxlbmd0aDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGxlbmd0aE1pbnVzQmxvY2sgPSBsZW5ndGggLSB0aGlzLmJsb2NrU2l6ZTtcclxuICAgICAgICB2YXIgbiA9IDA7XHJcbiAgICAgICAgLy8gVXNpbmcgbG9jYWwgaW5zdGVhZCBvZiBtZW1iZXIgdmFyaWFibGVzIGdpdmVzIH41JSBzcGVlZHVwIG9uIEZpcmVmb3ggMTYuXHJcbiAgICAgICAgdmFyIGJ1ZiA9IHRoaXMuYnVmXztcclxuICAgICAgICB2YXIgaW5idWYgPSB0aGlzLmluYnVmXztcclxuICAgICAgICAvLyBUaGUgb3V0ZXIgd2hpbGUgbG9vcCBzaG91bGQgZXhlY3V0ZSBhdCBtb3N0IHR3aWNlLlxyXG4gICAgICAgIHdoaWxlIChuIDwgbGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIC8vIFdoZW4gd2UgaGF2ZSBubyBkYXRhIGluIHRoZSBibG9jayB0byB0b3AgdXAsIHdlIGNhbiBkaXJlY3RseSBwcm9jZXNzIHRoZVxyXG4gICAgICAgICAgICAvLyBpbnB1dCBidWZmZXIgKGFzc3VtaW5nIGl0IGNvbnRhaW5zIHN1ZmZpY2llbnQgZGF0YSkuIFRoaXMgZ2l2ZXMgfjI1JVxyXG4gICAgICAgICAgICAvLyBzcGVlZHVwIG9uIENocm9tZSAyMyBhbmQgfjE1JSBzcGVlZHVwIG9uIEZpcmVmb3ggMTYsIGJ1dCByZXF1aXJlcyB0aGF0XHJcbiAgICAgICAgICAgIC8vIHRoZSBkYXRhIGlzIHByb3ZpZGVkIGluIGxhcmdlIGNodW5rcyAob3IgaW4gbXVsdGlwbGVzIG9mIDY0IGJ5dGVzKS5cclxuICAgICAgICAgICAgaWYgKGluYnVmID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAobiA8PSBsZW5ndGhNaW51c0Jsb2NrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb21wcmVzc18oYnl0ZXMsIG4pO1xyXG4gICAgICAgICAgICAgICAgICAgIG4gKz0gdGhpcy5ibG9ja1NpemU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBieXRlcyA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgICAgIHdoaWxlIChuIDwgbGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnVmW2luYnVmXSA9IGJ5dGVzLmNoYXJDb2RlQXQobik7XHJcbiAgICAgICAgICAgICAgICAgICAgKytpbmJ1ZjtcclxuICAgICAgICAgICAgICAgICAgICArK247XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluYnVmID09PSB0aGlzLmJsb2NrU2l6ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbXByZXNzXyhidWYpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbmJ1ZiA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEp1bXAgdG8gdGhlIG91dGVyIGxvb3Agc28gd2UgdXNlIHRoZSBmdWxsLWJsb2NrIG9wdGltaXphdGlvbi5cclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKG4gPCBsZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBidWZbaW5idWZdID0gYnl0ZXNbbl07XHJcbiAgICAgICAgICAgICAgICAgICAgKytpbmJ1ZjtcclxuICAgICAgICAgICAgICAgICAgICArK247XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluYnVmID09PSB0aGlzLmJsb2NrU2l6ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbXByZXNzXyhidWYpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbmJ1ZiA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEp1bXAgdG8gdGhlIG91dGVyIGxvb3Agc28gd2UgdXNlIHRoZSBmdWxsLWJsb2NrIG9wdGltaXphdGlvbi5cclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaW5idWZfID0gaW5idWY7XHJcbiAgICAgICAgdGhpcy50b3RhbF8gKz0gbGVuZ3RoO1xyXG4gICAgfTtcclxuICAgIC8qKiBAb3ZlcnJpZGUgKi9cclxuICAgIFNoYTEucHJvdG90eXBlLmRpZ2VzdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgZGlnZXN0ID0gW107XHJcbiAgICAgICAgdmFyIHRvdGFsQml0cyA9IHRoaXMudG90YWxfICogODtcclxuICAgICAgICAvLyBBZGQgcGFkIDB4ODAgMHgwMCouXHJcbiAgICAgICAgaWYgKHRoaXMuaW5idWZfIDwgNTYpIHtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGUodGhpcy5wYWRfLCA1NiAtIHRoaXMuaW5idWZfKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlKHRoaXMucGFkXywgdGhpcy5ibG9ja1NpemUgLSAodGhpcy5pbmJ1Zl8gLSA1NikpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBBZGQgIyBiaXRzLlxyXG4gICAgICAgIGZvciAodmFyIGkgPSB0aGlzLmJsb2NrU2l6ZSAtIDE7IGkgPj0gNTY7IGktLSkge1xyXG4gICAgICAgICAgICB0aGlzLmJ1Zl9baV0gPSB0b3RhbEJpdHMgJiAyNTU7XHJcbiAgICAgICAgICAgIHRvdGFsQml0cyAvPSAyNTY7IC8vIERvbid0IHVzZSBiaXQtc2hpZnRpbmcgaGVyZSFcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jb21wcmVzc18odGhpcy5idWZfKTtcclxuICAgICAgICB2YXIgbiA9IDA7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA1OyBpKyspIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDI0OyBqID49IDA7IGogLT0gOCkge1xyXG4gICAgICAgICAgICAgICAgZGlnZXN0W25dID0gKHRoaXMuY2hhaW5fW2ldID4+IGopICYgMjU1O1xyXG4gICAgICAgICAgICAgICAgKytuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBkaWdlc3Q7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFNoYTE7XHJcbn0oKSk7XG5cbi8qKlxyXG4gKiBIZWxwZXIgdG8gbWFrZSBhIFN1YnNjcmliZSBmdW5jdGlvbiAoanVzdCBsaWtlIFByb21pc2UgaGVscHMgbWFrZSBhXHJcbiAqIFRoZW5hYmxlKS5cclxuICpcclxuICogQHBhcmFtIGV4ZWN1dG9yIEZ1bmN0aW9uIHdoaWNoIGNhbiBtYWtlIGNhbGxzIHRvIGEgc2luZ2xlIE9ic2VydmVyXHJcbiAqICAgICBhcyBhIHByb3h5LlxyXG4gKiBAcGFyYW0gb25Ob09ic2VydmVycyBDYWxsYmFjayB3aGVuIGNvdW50IG9mIE9ic2VydmVycyBnb2VzIHRvIHplcm8uXHJcbiAqL1xyXG5mdW5jdGlvbiBjcmVhdGVTdWJzY3JpYmUoZXhlY3V0b3IsIG9uTm9PYnNlcnZlcnMpIHtcclxuICAgIHZhciBwcm94eSA9IG5ldyBPYnNlcnZlclByb3h5KGV4ZWN1dG9yLCBvbk5vT2JzZXJ2ZXJzKTtcclxuICAgIHJldHVybiBwcm94eS5zdWJzY3JpYmUuYmluZChwcm94eSk7XHJcbn1cclxuLyoqXHJcbiAqIEltcGxlbWVudCBmYW4tb3V0IGZvciBhbnkgbnVtYmVyIG9mIE9ic2VydmVycyBhdHRhY2hlZCB2aWEgYSBzdWJzY3JpYmVcclxuICogZnVuY3Rpb24uXHJcbiAqL1xyXG52YXIgT2JzZXJ2ZXJQcm94eSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIC8qKlxyXG4gICAgICogQHBhcmFtIGV4ZWN1dG9yIEZ1bmN0aW9uIHdoaWNoIGNhbiBtYWtlIGNhbGxzIHRvIGEgc2luZ2xlIE9ic2VydmVyXHJcbiAgICAgKiAgICAgYXMgYSBwcm94eS5cclxuICAgICAqIEBwYXJhbSBvbk5vT2JzZXJ2ZXJzIENhbGxiYWNrIHdoZW4gY291bnQgb2YgT2JzZXJ2ZXJzIGdvZXMgdG8gemVyby5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gT2JzZXJ2ZXJQcm94eShleGVjdXRvciwgb25Ob09ic2VydmVycykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5vYnNlcnZlcnMgPSBbXTtcclxuICAgICAgICB0aGlzLnVuc3Vic2NyaWJlcyA9IFtdO1xyXG4gICAgICAgIHRoaXMub2JzZXJ2ZXJDb3VudCA9IDA7XHJcbiAgICAgICAgLy8gTWljcm8tdGFzayBzY2hlZHVsaW5nIGJ5IGNhbGxpbmcgdGFzay50aGVuKCkuXHJcbiAgICAgICAgdGhpcy50YXNrID0gUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgdGhpcy5maW5hbGl6ZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLm9uTm9PYnNlcnZlcnMgPSBvbk5vT2JzZXJ2ZXJzO1xyXG4gICAgICAgIC8vIENhbGwgdGhlIGV4ZWN1dG9yIGFzeW5jaHJvbm91c2x5IHNvIHN1YnNjcmliZXJzIHRoYXQgYXJlIGNhbGxlZFxyXG4gICAgICAgIC8vIHN5bmNocm9ub3VzbHkgYWZ0ZXIgdGhlIGNyZWF0aW9uIG9mIHRoZSBzdWJzY3JpYmUgZnVuY3Rpb25cclxuICAgICAgICAvLyBjYW4gc3RpbGwgcmVjZWl2ZSB0aGUgdmVyeSBmaXJzdCB2YWx1ZSBnZW5lcmF0ZWQgaW4gdGhlIGV4ZWN1dG9yLlxyXG4gICAgICAgIHRoaXMudGFza1xyXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGV4ZWN1dG9yKF90aGlzKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgX3RoaXMuZXJyb3IoZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBPYnNlcnZlclByb3h5LnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5mb3JFYWNoT2JzZXJ2ZXIoZnVuY3Rpb24gKG9ic2VydmVyKSB7XHJcbiAgICAgICAgICAgIG9ic2VydmVyLm5leHQodmFsdWUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIE9ic2VydmVyUHJveHkucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgdGhpcy5mb3JFYWNoT2JzZXJ2ZXIoZnVuY3Rpb24gKG9ic2VydmVyKSB7XHJcbiAgICAgICAgICAgIG9ic2VydmVyLmVycm9yKGVycm9yKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmNsb3NlKGVycm9yKTtcclxuICAgIH07XHJcbiAgICBPYnNlcnZlclByb3h5LnByb3RvdHlwZS5jb21wbGV0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmZvckVhY2hPYnNlcnZlcihmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcclxuICAgICAgICAgICAgb2JzZXJ2ZXIuY29tcGxldGUoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBTdWJzY3JpYmUgZnVuY3Rpb24gdGhhdCBjYW4gYmUgdXNlZCB0byBhZGQgYW4gT2JzZXJ2ZXIgdG8gdGhlIGZhbi1vdXQgbGlzdC5cclxuICAgICAqXHJcbiAgICAgKiAtIFdlIHJlcXVpcmUgdGhhdCBubyBldmVudCBpcyBzZW50IHRvIGEgc3Vic2NyaWJlciBzeWNocm9ub3VzbHkgdG8gdGhlaXJcclxuICAgICAqICAgY2FsbCB0byBzdWJzY3JpYmUoKS5cclxuICAgICAqL1xyXG4gICAgT2JzZXJ2ZXJQcm94eS5wcm90b3R5cGUuc3Vic2NyaWJlID0gZnVuY3Rpb24gKG5leHRPck9ic2VydmVyLCBlcnJvciwgY29tcGxldGUpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBvYnNlcnZlcjtcclxuICAgICAgICBpZiAobmV4dE9yT2JzZXJ2ZXIgPT09IHVuZGVmaW5lZCAmJlxyXG4gICAgICAgICAgICBlcnJvciA9PT0gdW5kZWZpbmVkICYmXHJcbiAgICAgICAgICAgIGNvbXBsZXRlID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIE9ic2VydmVyLicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBBc3NlbWJsZSBhbiBPYnNlcnZlciBvYmplY3Qgd2hlbiBwYXNzZWQgYXMgY2FsbGJhY2sgZnVuY3Rpb25zLlxyXG4gICAgICAgIGlmIChpbXBsZW1lbnRzQW55TWV0aG9kcyhuZXh0T3JPYnNlcnZlciwgW1xyXG4gICAgICAgICAgICAnbmV4dCcsXHJcbiAgICAgICAgICAgICdlcnJvcicsXHJcbiAgICAgICAgICAgICdjb21wbGV0ZSdcclxuICAgICAgICBdKSkge1xyXG4gICAgICAgICAgICBvYnNlcnZlciA9IG5leHRPck9ic2VydmVyO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgb2JzZXJ2ZXIgPSB7XHJcbiAgICAgICAgICAgICAgICBuZXh0OiBuZXh0T3JPYnNlcnZlcixcclxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvcixcclxuICAgICAgICAgICAgICAgIGNvbXBsZXRlOiBjb21wbGV0ZVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAob2JzZXJ2ZXIubmV4dCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIG9ic2VydmVyLm5leHQgPSBub29wO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAob2JzZXJ2ZXIuZXJyb3IgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBvYnNlcnZlci5lcnJvciA9IG5vb3A7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChvYnNlcnZlci5jb21wbGV0ZSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIG9ic2VydmVyLmNvbXBsZXRlID0gbm9vcDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHVuc3ViID0gdGhpcy51bnN1YnNjcmliZU9uZS5iaW5kKHRoaXMsIHRoaXMub2JzZXJ2ZXJzLmxlbmd0aCk7XHJcbiAgICAgICAgLy8gQXR0ZW1wdCB0byBzdWJzY3JpYmUgdG8gYSB0ZXJtaW5hdGVkIE9ic2VydmFibGUgLSB3ZVxyXG4gICAgICAgIC8vIGp1c3QgcmVzcG9uZCB0byB0aGUgT2JzZXJ2ZXIgd2l0aCB0aGUgZmluYWwgZXJyb3Igb3IgY29tcGxldGVcclxuICAgICAgICAvLyBldmVudC5cclxuICAgICAgICBpZiAodGhpcy5maW5hbGl6ZWQpIHtcclxuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1mbG9hdGluZy1wcm9taXNlc1xyXG4gICAgICAgICAgICB0aGlzLnRhc2sudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5maW5hbEVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLmVycm9yKF90aGlzLmZpbmFsRXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIuY29tcGxldGUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIG5vdGhpbmdcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMub2JzZXJ2ZXJzLnB1c2gob2JzZXJ2ZXIpO1xyXG4gICAgICAgIHJldHVybiB1bnN1YjtcclxuICAgIH07XHJcbiAgICAvLyBVbnN1YnNjcmliZSBpcyBzeW5jaHJvbm91cyAtIHdlIGd1YXJhbnRlZSB0aGF0IG5vIGV2ZW50cyBhcmUgc2VudCB0b1xyXG4gICAgLy8gYW55IHVuc3Vic2NyaWJlZCBPYnNlcnZlci5cclxuICAgIE9ic2VydmVyUHJveHkucHJvdG90eXBlLnVuc3Vic2NyaWJlT25lID0gZnVuY3Rpb24gKGkpIHtcclxuICAgICAgICBpZiAodGhpcy5vYnNlcnZlcnMgPT09IHVuZGVmaW5lZCB8fCB0aGlzLm9ic2VydmVyc1tpXSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZGVsZXRlIHRoaXMub2JzZXJ2ZXJzW2ldO1xyXG4gICAgICAgIHRoaXMub2JzZXJ2ZXJDb3VudCAtPSAxO1xyXG4gICAgICAgIGlmICh0aGlzLm9ic2VydmVyQ291bnQgPT09IDAgJiYgdGhpcy5vbk5vT2JzZXJ2ZXJzICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5vbk5vT2JzZXJ2ZXJzKHRoaXMpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBPYnNlcnZlclByb3h5LnByb3RvdHlwZS5mb3JFYWNoT2JzZXJ2ZXIgPSBmdW5jdGlvbiAoZm4pIHtcclxuICAgICAgICBpZiAodGhpcy5maW5hbGl6ZWQpIHtcclxuICAgICAgICAgICAgLy8gQWxyZWFkeSBjbG9zZWQgYnkgcHJldmlvdXMgZXZlbnQuLi4uanVzdCBlYXQgdGhlIGFkZGl0aW9uYWwgdmFsdWVzLlxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFNpbmNlIHNlbmRPbmUgY2FsbHMgYXN5bmNocm9ub3VzbHkgLSB0aGVyZSBpcyBubyBjaGFuY2UgdGhhdFxyXG4gICAgICAgIC8vIHRoaXMub2JzZXJ2ZXJzIHdpbGwgYmVjb21lIHVuZGVmaW5lZC5cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMub2JzZXJ2ZXJzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2VuZE9uZShpLCBmbik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8vIENhbGwgdGhlIE9ic2VydmVyIHZpYSBvbmUgb2YgaXQncyBjYWxsYmFjayBmdW5jdGlvbi4gV2UgYXJlIGNhcmVmdWwgdG9cclxuICAgIC8vIGNvbmZpcm0gdGhhdCB0aGUgb2JzZXJ2ZSBoYXMgbm90IGJlZW4gdW5zdWJzY3JpYmVkIHNpbmNlIHRoaXMgYXN5bmNocm9ub3VzXHJcbiAgICAvLyBmdW5jdGlvbiBoYWQgYmVlbiBxdWV1ZWQuXHJcbiAgICBPYnNlcnZlclByb3h5LnByb3RvdHlwZS5zZW5kT25lID0gZnVuY3Rpb24gKGksIGZuKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAvLyBFeGVjdXRlIHRoZSBjYWxsYmFjayBhc3luY2hyb25vdXNseVxyXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZmxvYXRpbmctcHJvbWlzZXNcclxuICAgICAgICB0aGlzLnRhc2sudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChfdGhpcy5vYnNlcnZlcnMgIT09IHVuZGVmaW5lZCAmJiBfdGhpcy5vYnNlcnZlcnNbaV0gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICBmbihfdGhpcy5vYnNlcnZlcnNbaV0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBJZ25vcmUgZXhjZXB0aW9ucyByYWlzZWQgaW4gT2JzZXJ2ZXJzIG9yIG1pc3NpbmcgbWV0aG9kcyBvZiBhblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIE9ic2VydmVyLlxyXG4gICAgICAgICAgICAgICAgICAgIC8vIExvZyBlcnJvciB0byBjb25zb2xlLiBiLzMxNDA0ODA2XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBjb25zb2xlICE9PSAndW5kZWZpbmVkJyAmJiBjb25zb2xlLmVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgT2JzZXJ2ZXJQcm94eS5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBpZiAodGhpcy5maW5hbGl6ZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmZpbmFsaXplZCA9IHRydWU7XHJcbiAgICAgICAgaWYgKGVyciAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZmluYWxFcnJvciA9IGVycjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gUHJveHkgaXMgbm8gbG9uZ2VyIG5lZWRlZCAtIGdhcmJhZ2UgY29sbGVjdCByZWZlcmVuY2VzXHJcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1mbG9hdGluZy1wcm9taXNlc1xyXG4gICAgICAgIHRoaXMudGFzay50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgX3RoaXMub2JzZXJ2ZXJzID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICBfdGhpcy5vbk5vT2JzZXJ2ZXJzID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBPYnNlcnZlclByb3h5O1xyXG59KCkpO1xyXG4vKiogVHVybiBzeW5jaHJvbm91cyBmdW5jdGlvbiBpbnRvIG9uZSBjYWxsZWQgYXN5bmNocm9ub3VzbHkuICovXHJcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvYmFuLXR5cGVzXHJcbmZ1bmN0aW9uIGFzeW5jKGZuLCBvbkVycm9yKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBhcmdzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICBQcm9taXNlLnJlc29sdmUodHJ1ZSlcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBmbi5hcHBseSh2b2lkIDAsIGFyZ3MpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIG9uRXJyb3IoZXJyb3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG59XHJcbi8qKlxyXG4gKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgb2JqZWN0IHBhc3NlZCBpbiBpbXBsZW1lbnRzIGFueSBvZiB0aGUgbmFtZWQgbWV0aG9kcy5cclxuICovXHJcbmZ1bmN0aW9uIGltcGxlbWVudHNBbnlNZXRob2RzKG9iaiwgbWV0aG9kcykge1xyXG4gICAgaWYgKHR5cGVvZiBvYmogIT09ICdvYmplY3QnIHx8IG9iaiA9PT0gbnVsbCkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIGZvciAodmFyIF9pID0gMCwgbWV0aG9kc18xID0gbWV0aG9kczsgX2kgPCBtZXRob2RzXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgdmFyIG1ldGhvZCA9IG1ldGhvZHNfMVtfaV07XHJcbiAgICAgICAgaWYgKG1ldGhvZCBpbiBvYmogJiYgdHlwZW9mIG9ialttZXRob2RdID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBmYWxzZTtcclxufVxyXG5mdW5jdGlvbiBub29wKCkge1xyXG4gICAgLy8gZG8gbm90aGluZ1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBDaGVjayB0byBtYWtlIHN1cmUgdGhlIGFwcHJvcHJpYXRlIG51bWJlciBvZiBhcmd1bWVudHMgYXJlIHByb3ZpZGVkIGZvciBhIHB1YmxpYyBmdW5jdGlvbi5cclxuICogVGhyb3dzIGFuIGVycm9yIGlmIGl0IGZhaWxzLlxyXG4gKlxyXG4gKiBAcGFyYW0gZm5OYW1lIFRoZSBmdW5jdGlvbiBuYW1lXHJcbiAqIEBwYXJhbSBtaW5Db3VudCBUaGUgbWluaW11bSBudW1iZXIgb2YgYXJndW1lbnRzIHRvIGFsbG93IGZvciB0aGUgZnVuY3Rpb24gY2FsbFxyXG4gKiBAcGFyYW0gbWF4Q291bnQgVGhlIG1heGltdW0gbnVtYmVyIG9mIGFyZ3VtZW50IHRvIGFsbG93IGZvciB0aGUgZnVuY3Rpb24gY2FsbFxyXG4gKiBAcGFyYW0gYXJnQ291bnQgVGhlIGFjdHVhbCBudW1iZXIgb2YgYXJndW1lbnRzIHByb3ZpZGVkLlxyXG4gKi9cclxudmFyIHZhbGlkYXRlQXJnQ291bnQgPSBmdW5jdGlvbiAoZm5OYW1lLCBtaW5Db3VudCwgbWF4Q291bnQsIGFyZ0NvdW50KSB7XHJcbiAgICB2YXIgYXJnRXJyb3I7XHJcbiAgICBpZiAoYXJnQ291bnQgPCBtaW5Db3VudCkge1xyXG4gICAgICAgIGFyZ0Vycm9yID0gJ2F0IGxlYXN0ICcgKyBtaW5Db3VudDtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGFyZ0NvdW50ID4gbWF4Q291bnQpIHtcclxuICAgICAgICBhcmdFcnJvciA9IG1heENvdW50ID09PSAwID8gJ25vbmUnIDogJ25vIG1vcmUgdGhhbiAnICsgbWF4Q291bnQ7XHJcbiAgICB9XHJcbiAgICBpZiAoYXJnRXJyb3IpIHtcclxuICAgICAgICB2YXIgZXJyb3IgPSBmbk5hbWUgK1xyXG4gICAgICAgICAgICAnIGZhaWxlZDogV2FzIGNhbGxlZCB3aXRoICcgK1xyXG4gICAgICAgICAgICBhcmdDb3VudCArXHJcbiAgICAgICAgICAgIChhcmdDb3VudCA9PT0gMSA/ICcgYXJndW1lbnQuJyA6ICcgYXJndW1lbnRzLicpICtcclxuICAgICAgICAgICAgJyBFeHBlY3RzICcgK1xyXG4gICAgICAgICAgICBhcmdFcnJvciArXHJcbiAgICAgICAgICAgICcuJztcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3IpO1xyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICogR2VuZXJhdGVzIGEgc3RyaW5nIHRvIHByZWZpeCBhbiBlcnJvciBtZXNzYWdlIGFib3V0IGZhaWxlZCBhcmd1bWVudCB2YWxpZGF0aW9uXHJcbiAqXHJcbiAqIEBwYXJhbSBmbk5hbWUgVGhlIGZ1bmN0aW9uIG5hbWVcclxuICogQHBhcmFtIGFyZ05hbWUgVGhlIG5hbWUgb2YgdGhlIGFyZ3VtZW50XHJcbiAqIEByZXR1cm4gVGhlIHByZWZpeCB0byBhZGQgdG8gdGhlIGVycm9yIHRocm93biBmb3IgdmFsaWRhdGlvbi5cclxuICovXHJcbmZ1bmN0aW9uIGVycm9yUHJlZml4KGZuTmFtZSwgYXJnTmFtZSkge1xyXG4gICAgcmV0dXJuIGZuTmFtZSArIFwiIGZhaWxlZDogXCIgKyBhcmdOYW1lICsgXCIgYXJndW1lbnQgXCI7XHJcbn1cclxuLyoqXHJcbiAqIEBwYXJhbSBmbk5hbWVcclxuICogQHBhcmFtIGFyZ3VtZW50TnVtYmVyXHJcbiAqIEBwYXJhbSBuYW1lc3BhY2VcclxuICogQHBhcmFtIG9wdGlvbmFsXHJcbiAqL1xyXG5mdW5jdGlvbiB2YWxpZGF0ZU5hbWVzcGFjZShmbk5hbWUsIG5hbWVzcGFjZSwgb3B0aW9uYWwpIHtcclxuICAgIGlmIChvcHRpb25hbCAmJiAhbmFtZXNwYWNlKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgaWYgKHR5cGVvZiBuYW1lc3BhY2UgIT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgLy9UT0RPOiBJIHNob3VsZCBkbyBtb3JlIHZhbGlkYXRpb24gaGVyZS4gV2Ugb25seSBhbGxvdyBjZXJ0YWluIGNoYXJzIGluIG5hbWVzcGFjZXMuXHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yUHJlZml4KGZuTmFtZSwgJ25hbWVzcGFjZScpICsgJ211c3QgYmUgYSB2YWxpZCBmaXJlYmFzZSBuYW1lc3BhY2UuJyk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gdmFsaWRhdGVDYWxsYmFjayhmbk5hbWUsIGFyZ3VtZW50TmFtZSwgXHJcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvYmFuLXR5cGVzXHJcbmNhbGxiYWNrLCBvcHRpb25hbCkge1xyXG4gICAgaWYgKG9wdGlvbmFsICYmICFjYWxsYmFjaykge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgIT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JQcmVmaXgoZm5OYW1lLCBhcmd1bWVudE5hbWUpICsgJ211c3QgYmUgYSB2YWxpZCBmdW5jdGlvbi4nKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiB2YWxpZGF0ZUNvbnRleHRPYmplY3QoZm5OYW1lLCBhcmd1bWVudE5hbWUsIGNvbnRleHQsIG9wdGlvbmFsKSB7XHJcbiAgICBpZiAob3B0aW9uYWwgJiYgIWNvbnRleHQpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBpZiAodHlwZW9mIGNvbnRleHQgIT09ICdvYmplY3QnIHx8IGNvbnRleHQgPT09IG51bGwpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JQcmVmaXgoZm5OYW1lLCBhcmd1bWVudE5hbWUpICsgJ211c3QgYmUgYSB2YWxpZCBjb250ZXh0IG9iamVjdC4nKTtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vLyBDb2RlIG9yaWdpbmFsbHkgY2FtZSBmcm9tIGdvb2cuY3J5cHQuc3RyaW5nVG9VdGY4Qnl0ZUFycmF5LCBidXQgZm9yIHNvbWUgcmVhc29uIHRoZXlcclxuLy8gYXV0b21hdGljYWxseSByZXBsYWNlZCAnXFxyXFxuJyB3aXRoICdcXG4nLCBhbmQgdGhleSBkaWRuJ3QgaGFuZGxlIHN1cnJvZ2F0ZSBwYWlycyxcclxuLy8gc28gaXQncyBiZWVuIG1vZGlmaWVkLlxyXG4vLyBOb3RlIHRoYXQgbm90IGFsbCBVbmljb2RlIGNoYXJhY3RlcnMgYXBwZWFyIGFzIHNpbmdsZSBjaGFyYWN0ZXJzIGluIEphdmFTY3JpcHQgc3RyaW5ncy5cclxuLy8gZnJvbUNoYXJDb2RlIHJldHVybnMgdGhlIFVURi0xNiBlbmNvZGluZyBvZiBhIGNoYXJhY3RlciAtIHNvIHNvbWUgVW5pY29kZSBjaGFyYWN0ZXJzXHJcbi8vIHVzZSAyIGNoYXJhY3RlcnMgaW4gSmF2YXNjcmlwdC4gIEFsbCA0LWJ5dGUgVVRGLTggY2hhcmFjdGVycyBiZWdpbiB3aXRoIGEgZmlyc3RcclxuLy8gY2hhcmFjdGVyIGluIHRoZSByYW5nZSAweEQ4MDAgLSAweERCRkYgKHRoZSBmaXJzdCBjaGFyYWN0ZXIgb2YgYSBzby1jYWxsZWQgc3Vycm9nYXRlXHJcbi8vIHBhaXIpLlxyXG4vLyBTZWUgaHR0cDovL3d3dy5lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzUuMS8jc2VjLTE1LjEuM1xyXG4vKipcclxuICogQHBhcmFtIHtzdHJpbmd9IHN0clxyXG4gKiBAcmV0dXJuIHtBcnJheX1cclxuICovXHJcbnZhciBzdHJpbmdUb0J5dGVBcnJheSA9IGZ1bmN0aW9uIChzdHIpIHtcclxuICAgIHZhciBvdXQgPSBbXTtcclxuICAgIHZhciBwID0gMDtcclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgdmFyIGMgPSBzdHIuY2hhckNvZGVBdChpKTtcclxuICAgICAgICAvLyBJcyB0aGlzIHRoZSBsZWFkIHN1cnJvZ2F0ZSBpbiBhIHN1cnJvZ2F0ZSBwYWlyP1xyXG4gICAgICAgIGlmIChjID49IDB4ZDgwMCAmJiBjIDw9IDB4ZGJmZikge1xyXG4gICAgICAgICAgICB2YXIgaGlnaCA9IGMgLSAweGQ4MDA7IC8vIHRoZSBoaWdoIDEwIGJpdHMuXHJcbiAgICAgICAgICAgIGkrKztcclxuICAgICAgICAgICAgYXNzZXJ0KGkgPCBzdHIubGVuZ3RoLCAnU3Vycm9nYXRlIHBhaXIgbWlzc2luZyB0cmFpbCBzdXJyb2dhdGUuJyk7XHJcbiAgICAgICAgICAgIHZhciBsb3cgPSBzdHIuY2hhckNvZGVBdChpKSAtIDB4ZGMwMDsgLy8gdGhlIGxvdyAxMCBiaXRzLlxyXG4gICAgICAgICAgICBjID0gMHgxMDAwMCArIChoaWdoIDw8IDEwKSArIGxvdztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGMgPCAxMjgpIHtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSBjO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjIDwgMjA0OCkge1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjID4+IDYpIHwgMTkyO1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjICYgNjMpIHwgMTI4O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjIDwgNjU1MzYpIHtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoYyA+PiAxMikgfCAyMjQ7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKChjID4+IDYpICYgNjMpIHwgMTI4O1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjICYgNjMpIHwgMTI4O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoYyA+PiAxOCkgfCAyNDA7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKChjID4+IDEyKSAmIDYzKSB8IDEyODtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoKGMgPj4gNikgJiA2MykgfCAxMjg7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgJiA2MykgfCAxMjg7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG91dDtcclxufTtcclxuLyoqXHJcbiAqIENhbGN1bGF0ZSBsZW5ndGggd2l0aG91dCBhY3R1YWxseSBjb252ZXJ0aW5nOyB1c2VmdWwgZm9yIGRvaW5nIGNoZWFwZXIgdmFsaWRhdGlvbi5cclxuICogQHBhcmFtIHtzdHJpbmd9IHN0clxyXG4gKiBAcmV0dXJuIHtudW1iZXJ9XHJcbiAqL1xyXG52YXIgc3RyaW5nTGVuZ3RoID0gZnVuY3Rpb24gKHN0cikge1xyXG4gICAgdmFyIHAgPSAwO1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICB2YXIgYyA9IHN0ci5jaGFyQ29kZUF0KGkpO1xyXG4gICAgICAgIGlmIChjIDwgMTI4KSB7XHJcbiAgICAgICAgICAgIHArKztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoYyA8IDIwNDgpIHtcclxuICAgICAgICAgICAgcCArPSAyO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjID49IDB4ZDgwMCAmJiBjIDw9IDB4ZGJmZikge1xyXG4gICAgICAgICAgICAvLyBMZWFkIHN1cnJvZ2F0ZSBvZiBhIHN1cnJvZ2F0ZSBwYWlyLiAgVGhlIHBhaXIgdG9nZXRoZXIgd2lsbCB0YWtlIDQgYnl0ZXMgdG8gcmVwcmVzZW50LlxyXG4gICAgICAgICAgICBwICs9IDQ7XHJcbiAgICAgICAgICAgIGkrKzsgLy8gc2tpcCB0cmFpbCBzdXJyb2dhdGUuXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBwICs9IDM7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHA7XHJcbn07XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBUaGUgYW1vdW50IG9mIG1pbGxpc2Vjb25kcyB0byBleHBvbmVudGlhbGx5IGluY3JlYXNlLlxyXG4gKi9cclxudmFyIERFRkFVTFRfSU5URVJWQUxfTUlMTElTID0gMTAwMDtcclxuLyoqXHJcbiAqIFRoZSBmYWN0b3IgdG8gYmFja29mZiBieS5cclxuICogU2hvdWxkIGJlIGEgbnVtYmVyIGdyZWF0ZXIgdGhhbiAxLlxyXG4gKi9cclxudmFyIERFRkFVTFRfQkFDS09GRl9GQUNUT1IgPSAyO1xyXG4vKipcclxuICogVGhlIG1heGltdW0gbWlsbGlzZWNvbmRzIHRvIGluY3JlYXNlIHRvLlxyXG4gKlxyXG4gKiA8cD5WaXNpYmxlIGZvciB0ZXN0aW5nXHJcbiAqL1xyXG52YXIgTUFYX1ZBTFVFX01JTExJUyA9IDQgKiA2MCAqIDYwICogMTAwMDsgLy8gRm91ciBob3VycywgbGlrZSBpT1MgYW5kIEFuZHJvaWQuXHJcbi8qKlxyXG4gKiBUaGUgcGVyY2VudGFnZSBvZiBiYWNrb2ZmIHRpbWUgdG8gcmFuZG9taXplIGJ5LlxyXG4gKiBTZWVcclxuICogaHR0cDovL2dvL3NhZmUtY2xpZW50LWJlaGF2aW9yI3N0ZXAtMS1kZXRlcm1pbmUtdGhlLWFwcHJvcHJpYXRlLXJldHJ5LWludGVydmFsLXRvLWhhbmRsZS1zcGlrZS10cmFmZmljXHJcbiAqIGZvciBjb250ZXh0LlxyXG4gKlxyXG4gKiA8cD5WaXNpYmxlIGZvciB0ZXN0aW5nXHJcbiAqL1xyXG52YXIgUkFORE9NX0ZBQ1RPUiA9IDAuNTtcclxuLyoqXHJcbiAqIEJhc2VkIG9uIHRoZSBiYWNrb2ZmIG1ldGhvZCBmcm9tXHJcbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9nb29nbGUvY2xvc3VyZS1saWJyYXJ5L2Jsb2IvbWFzdGVyL2Nsb3N1cmUvZ29vZy9tYXRoL2V4cG9uZW50aWFsYmFja29mZi5qcy5cclxuICogRXh0cmFjdGVkIGhlcmUgc28gd2UgZG9uJ3QgbmVlZCB0byBwYXNzIG1ldGFkYXRhIGFuZCBhIHN0YXRlZnVsIEV4cG9uZW50aWFsQmFja29mZiBvYmplY3QgYXJvdW5kLlxyXG4gKi9cclxuZnVuY3Rpb24gY2FsY3VsYXRlQmFja29mZk1pbGxpcyhiYWNrb2ZmQ291bnQsIGludGVydmFsTWlsbGlzLCBiYWNrb2ZmRmFjdG9yKSB7XHJcbiAgICBpZiAoaW50ZXJ2YWxNaWxsaXMgPT09IHZvaWQgMCkgeyBpbnRlcnZhbE1pbGxpcyA9IERFRkFVTFRfSU5URVJWQUxfTUlMTElTOyB9XHJcbiAgICBpZiAoYmFja29mZkZhY3RvciA9PT0gdm9pZCAwKSB7IGJhY2tvZmZGYWN0b3IgPSBERUZBVUxUX0JBQ0tPRkZfRkFDVE9SOyB9XHJcbiAgICAvLyBDYWxjdWxhdGVzIGFuIGV4cG9uZW50aWFsbHkgaW5jcmVhc2luZyB2YWx1ZS5cclxuICAgIC8vIERldmlhdGlvbjogY2FsY3VsYXRlcyB2YWx1ZSBmcm9tIGNvdW50IGFuZCBhIGNvbnN0YW50IGludGVydmFsLCBzbyB3ZSBvbmx5IG5lZWQgdG8gc2F2ZSB2YWx1ZVxyXG4gICAgLy8gYW5kIGNvdW50IHRvIHJlc3RvcmUgc3RhdGUuXHJcbiAgICB2YXIgY3VyckJhc2VWYWx1ZSA9IGludGVydmFsTWlsbGlzICogTWF0aC5wb3coYmFja29mZkZhY3RvciwgYmFja29mZkNvdW50KTtcclxuICAgIC8vIEEgcmFuZG9tIFwiZnV6elwiIHRvIGF2b2lkIHdhdmVzIG9mIHJldHJpZXMuXHJcbiAgICAvLyBEZXZpYXRpb246IHJhbmRvbUZhY3RvciBpcyByZXF1aXJlZC5cclxuICAgIHZhciByYW5kb21XYWl0ID0gTWF0aC5yb3VuZChcclxuICAgIC8vIEEgZnJhY3Rpb24gb2YgdGhlIGJhY2tvZmYgdmFsdWUgdG8gYWRkL3N1YnRyYWN0LlxyXG4gICAgLy8gRGV2aWF0aW9uOiBjaGFuZ2VzIG11bHRpcGxpY2F0aW9uIG9yZGVyIHRvIGltcHJvdmUgcmVhZGFiaWxpdHkuXHJcbiAgICBSQU5ET01fRkFDVE9SICpcclxuICAgICAgICBjdXJyQmFzZVZhbHVlICpcclxuICAgICAgICAvLyBBIHJhbmRvbSBmbG9hdCAocm91bmRlZCB0byBpbnQgYnkgTWF0aC5yb3VuZCBhYm92ZSkgaW4gdGhlIHJhbmdlIFstMSwgMV0uIERldGVybWluZXNcclxuICAgICAgICAvLyBpZiB3ZSBhZGQgb3Igc3VidHJhY3QuXHJcbiAgICAgICAgKE1hdGgucmFuZG9tKCkgLSAwLjUpICpcclxuICAgICAgICAyKTtcclxuICAgIC8vIExpbWl0cyBiYWNrb2ZmIHRvIG1heCB0byBhdm9pZCBlZmZlY3RpdmVseSBwZXJtYW5lbnQgYmFja29mZi5cclxuICAgIHJldHVybiBNYXRoLm1pbihNQVhfVkFMVUVfTUlMTElTLCBjdXJyQmFzZVZhbHVlICsgcmFuZG9tV2FpdCk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFByb3ZpZGUgRW5nbGlzaCBvcmRpbmFsIGxldHRlcnMgYWZ0ZXIgYSBudW1iZXJcclxuICovXHJcbmZ1bmN0aW9uIG9yZGluYWwoaSkge1xyXG4gICAgaWYgKCFOdW1iZXIuaXNGaW5pdGUoaSkpIHtcclxuICAgICAgICByZXR1cm4gXCJcIiArIGk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gaSArIGluZGljYXRvcihpKTtcclxufVxyXG5mdW5jdGlvbiBpbmRpY2F0b3IoaSkge1xyXG4gICAgaSA9IE1hdGguYWJzKGkpO1xyXG4gICAgdmFyIGNlbnQgPSBpICUgMTAwO1xyXG4gICAgaWYgKGNlbnQgPj0gMTAgJiYgY2VudCA8PSAyMCkge1xyXG4gICAgICAgIHJldHVybiAndGgnO1xyXG4gICAgfVxyXG4gICAgdmFyIGRlYyA9IGkgJSAxMDtcclxuICAgIGlmIChkZWMgPT09IDEpIHtcclxuICAgICAgICByZXR1cm4gJ3N0JztcclxuICAgIH1cclxuICAgIGlmIChkZWMgPT09IDIpIHtcclxuICAgICAgICByZXR1cm4gJ25kJztcclxuICAgIH1cclxuICAgIGlmIChkZWMgPT09IDMpIHtcclxuICAgICAgICByZXR1cm4gJ3JkJztcclxuICAgIH1cclxuICAgIHJldHVybiAndGgnO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmZ1bmN0aW9uIGdldE1vZHVsYXJJbnN0YW5jZShzZXJ2aWNlKSB7XHJcbiAgICBpZiAoc2VydmljZSAmJiBzZXJ2aWNlLl9kZWxlZ2F0ZSkge1xyXG4gICAgICAgIHJldHVybiBzZXJ2aWNlLl9kZWxlZ2F0ZTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xyXG4gICAgfVxyXG59XG5cbmV4cG9ydCB7IENPTlNUQU5UUywgRGVmZXJyZWQsIEVycm9yRmFjdG9yeSwgRmlyZWJhc2VFcnJvciwgTUFYX1ZBTFVFX01JTExJUywgUkFORE9NX0ZBQ1RPUiwgU2hhMSwgYXJlQ29va2llc0VuYWJsZWQsIGFzc2VydCwgYXNzZXJ0aW9uRXJyb3IsIGFzeW5jLCBiYXNlNjQsIGJhc2U2NERlY29kZSwgYmFzZTY0RW5jb2RlLCBiYXNlNjR1cmxFbmNvZGVXaXRob3V0UGFkZGluZywgY2FsY3VsYXRlQmFja29mZk1pbGxpcywgY29udGFpbnMsIGNyZWF0ZU1vY2tVc2VyVG9rZW4sIGNyZWF0ZVN1YnNjcmliZSwgZGVjb2RlLCBkZWVwQ29weSwgZGVlcEVxdWFsLCBkZWVwRXh0ZW5kLCBlcnJvclByZWZpeCwgZXh0cmFjdFF1ZXJ5c3RyaW5nLCBnZXRHbG9iYWwsIGdldE1vZHVsYXJJbnN0YW5jZSwgZ2V0VUEsIGlzQWRtaW4sIGlzQnJvd3NlciwgaXNCcm93c2VyRXh0ZW5zaW9uLCBpc0VsZWN0cm9uLCBpc0VtcHR5LCBpc0lFLCBpc0luZGV4ZWREQkF2YWlsYWJsZSwgaXNNb2JpbGVDb3Jkb3ZhLCBpc05vZGUsIGlzTm9kZVNkaywgaXNSZWFjdE5hdGl2ZSwgaXNTYWZhcmksIGlzVVdQLCBpc1ZhbGlkRm9ybWF0LCBpc1ZhbGlkVGltZXN0YW1wLCBpc3N1ZWRBdFRpbWUsIGpzb25FdmFsLCBtYXAsIG9yZGluYWwsIHF1ZXJ5c3RyaW5nLCBxdWVyeXN0cmluZ0RlY29kZSwgc2FmZUdldCwgc3RyaW5nTGVuZ3RoLCBzdHJpbmdUb0J5dGVBcnJheSwgc3RyaW5naWZ5LCB2YWxpZGF0ZUFyZ0NvdW50LCB2YWxpZGF0ZUNhbGxiYWNrLCB2YWxpZGF0ZUNvbnRleHRPYmplY3QsIHZhbGlkYXRlSW5kZXhlZERCT3BlbmFibGUsIHZhbGlkYXRlTmFtZXNwYWNlIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5lc20uanMubWFwXG4iLCIvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG5Db3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi5cblxuUGVybWlzc2lvbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgYW5kL29yIGRpc3RyaWJ1dGUgdGhpcyBzb2Z0d2FyZSBmb3IgYW55XG5wdXJwb3NlIHdpdGggb3Igd2l0aG91dCBmZWUgaXMgaGVyZWJ5IGdyYW50ZWQuXG5cblRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIgQU5EIFRIRSBBVVRIT1IgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEhcblJFR0FSRCBUTyBUSElTIFNPRlRXQVJFIElOQ0xVRElORyBBTEwgSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWVxuQU5EIEZJVE5FU1MuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1IgQkUgTElBQkxFIEZPUiBBTlkgU1BFQ0lBTCwgRElSRUNULFxuSU5ESVJFQ1QsIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUyBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NXG5MT1NTIE9GIFVTRSwgREFUQSBPUiBQUk9GSVRTLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgTkVHTElHRU5DRSBPUlxuT1RIRVIgVE9SVElPVVMgQUNUSU9OLCBBUklTSU5HIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUlxuUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS5cbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovXG4vKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSwgU3VwcHJlc3NlZEVycm9yLCBTeW1ib2wsIEl0ZXJhdG9yICovXG5cbnZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24oZCwgYikge1xuICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBfX2V4dGVuZHMoZCwgYikge1xuICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xufVxuXG5leHBvcnQgdmFyIF9fYXNzaWduID0gZnVuY3Rpb24oKSB7XG4gIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiBfX2Fzc2lnbih0KSB7XG4gICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcbiAgICAgICAgICBzID0gYXJndW1lbnRzW2ldO1xuICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSkgdFtwXSA9IHNbcF07XG4gICAgICB9XG4gICAgICByZXR1cm4gdDtcbiAgfVxuICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVzdChzLCBlKSB7XG4gIHZhciB0ID0ge307XG4gIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSAmJiBlLmluZGV4T2YocCkgPCAwKVxuICAgICAgdFtwXSA9IHNbcF07XG4gIGlmIChzICE9IG51bGwgJiYgdHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMgPT09IFwiZnVuY3Rpb25cIilcbiAgICAgIGZvciAodmFyIGkgPSAwLCBwID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzKTsgaSA8IHAubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBpZiAoZS5pbmRleE9mKHBbaV0pIDwgMCAmJiBPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwocywgcFtpXSkpXG4gICAgICAgICAgICAgIHRbcFtpXV0gPSBzW3BbaV1dO1xuICAgICAgfVxuICByZXR1cm4gdDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcbiAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcbiAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcbiAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcbiAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fcGFyYW0ocGFyYW1JbmRleCwgZGVjb3JhdG9yKSB7XG4gIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXkpIHsgZGVjb3JhdG9yKHRhcmdldCwga2V5LCBwYXJhbUluZGV4KTsgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gX19lc0RlY29yYXRlKGN0b3IsIGRlc2NyaXB0b3JJbiwgZGVjb3JhdG9ycywgY29udGV4dEluLCBpbml0aWFsaXplcnMsIGV4dHJhSW5pdGlhbGl6ZXJzKSB7XG4gIGZ1bmN0aW9uIGFjY2VwdChmKSB7IGlmIChmICE9PSB2b2lkIDAgJiYgdHlwZW9mIGYgIT09IFwiZnVuY3Rpb25cIikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkZ1bmN0aW9uIGV4cGVjdGVkXCIpOyByZXR1cm4gZjsgfVxuICB2YXIga2luZCA9IGNvbnRleHRJbi5raW5kLCBrZXkgPSBraW5kID09PSBcImdldHRlclwiID8gXCJnZXRcIiA6IGtpbmQgPT09IFwic2V0dGVyXCIgPyBcInNldFwiIDogXCJ2YWx1ZVwiO1xuICB2YXIgdGFyZ2V0ID0gIWRlc2NyaXB0b3JJbiAmJiBjdG9yID8gY29udGV4dEluW1wic3RhdGljXCJdID8gY3RvciA6IGN0b3IucHJvdG90eXBlIDogbnVsbDtcbiAgdmFyIGRlc2NyaXB0b3IgPSBkZXNjcmlwdG9ySW4gfHwgKHRhcmdldCA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBjb250ZXh0SW4ubmFtZSkgOiB7fSk7XG4gIHZhciBfLCBkb25lID0gZmFsc2U7XG4gIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICB2YXIgY29udGV4dCA9IHt9O1xuICAgICAgZm9yICh2YXIgcCBpbiBjb250ZXh0SW4pIGNvbnRleHRbcF0gPSBwID09PSBcImFjY2Vzc1wiID8ge30gOiBjb250ZXh0SW5bcF07XG4gICAgICBmb3IgKHZhciBwIGluIGNvbnRleHRJbi5hY2Nlc3MpIGNvbnRleHQuYWNjZXNzW3BdID0gY29udGV4dEluLmFjY2Vzc1twXTtcbiAgICAgIGNvbnRleHQuYWRkSW5pdGlhbGl6ZXIgPSBmdW5jdGlvbiAoZikgeyBpZiAoZG9uZSkgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBhZGQgaW5pdGlhbGl6ZXJzIGFmdGVyIGRlY29yYXRpb24gaGFzIGNvbXBsZXRlZFwiKTsgZXh0cmFJbml0aWFsaXplcnMucHVzaChhY2NlcHQoZiB8fCBudWxsKSk7IH07XG4gICAgICB2YXIgcmVzdWx0ID0gKDAsIGRlY29yYXRvcnNbaV0pKGtpbmQgPT09IFwiYWNjZXNzb3JcIiA/IHsgZ2V0OiBkZXNjcmlwdG9yLmdldCwgc2V0OiBkZXNjcmlwdG9yLnNldCB9IDogZGVzY3JpcHRvcltrZXldLCBjb250ZXh0KTtcbiAgICAgIGlmIChraW5kID09PSBcImFjY2Vzc29yXCIpIHtcbiAgICAgICAgICBpZiAocmVzdWx0ID09PSB2b2lkIDApIGNvbnRpbnVlO1xuICAgICAgICAgIGlmIChyZXN1bHQgPT09IG51bGwgfHwgdHlwZW9mIHJlc3VsdCAhPT0gXCJvYmplY3RcIikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIk9iamVjdCBleHBlY3RlZFwiKTtcbiAgICAgICAgICBpZiAoXyA9IGFjY2VwdChyZXN1bHQuZ2V0KSkgZGVzY3JpcHRvci5nZXQgPSBfO1xuICAgICAgICAgIGlmIChfID0gYWNjZXB0KHJlc3VsdC5zZXQpKSBkZXNjcmlwdG9yLnNldCA9IF87XG4gICAgICAgICAgaWYgKF8gPSBhY2NlcHQocmVzdWx0LmluaXQpKSBpbml0aWFsaXplcnMudW5zaGlmdChfKTtcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKF8gPSBhY2NlcHQocmVzdWx0KSkge1xuICAgICAgICAgIGlmIChraW5kID09PSBcImZpZWxkXCIpIGluaXRpYWxpemVycy51bnNoaWZ0KF8pO1xuICAgICAgICAgIGVsc2UgZGVzY3JpcHRvcltrZXldID0gXztcbiAgICAgIH1cbiAgfVxuICBpZiAodGFyZ2V0KSBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBjb250ZXh0SW4ubmFtZSwgZGVzY3JpcHRvcik7XG4gIGRvbmUgPSB0cnVlO1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIF9fcnVuSW5pdGlhbGl6ZXJzKHRoaXNBcmcsIGluaXRpYWxpemVycywgdmFsdWUpIHtcbiAgdmFyIHVzZVZhbHVlID0gYXJndW1lbnRzLmxlbmd0aCA+IDI7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgaW5pdGlhbGl6ZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YWx1ZSA9IHVzZVZhbHVlID8gaW5pdGlhbGl6ZXJzW2ldLmNhbGwodGhpc0FyZywgdmFsdWUpIDogaW5pdGlhbGl6ZXJzW2ldLmNhbGwodGhpc0FyZyk7XG4gIH1cbiAgcmV0dXJuIHVzZVZhbHVlID8gdmFsdWUgOiB2b2lkIDA7XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gX19wcm9wS2V5KHgpIHtcbiAgcmV0dXJuIHR5cGVvZiB4ID09PSBcInN5bWJvbFwiID8geCA6IFwiXCIuY29uY2F0KHgpO1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIF9fc2V0RnVuY3Rpb25OYW1lKGYsIG5hbWUsIHByZWZpeCkge1xuICBpZiAodHlwZW9mIG5hbWUgPT09IFwic3ltYm9sXCIpIG5hbWUgPSBuYW1lLmRlc2NyaXB0aW9uID8gXCJbXCIuY29uY2F0KG5hbWUuZGVzY3JpcHRpb24sIFwiXVwiKSA6IFwiXCI7XG4gIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkoZiwgXCJuYW1lXCIsIHsgY29uZmlndXJhYmxlOiB0cnVlLCB2YWx1ZTogcHJlZml4ID8gXCJcIi5jb25jYXQocHJlZml4LCBcIiBcIiwgbmFtZSkgOiBuYW1lIH0pO1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIF9fbWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpIHtcbiAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0Lm1ldGFkYXRhID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiBSZWZsZWN0Lm1ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXRlcih0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fZ2VuZXJhdG9yKHRoaXNBcmcsIGJvZHkpIHtcbiAgdmFyIF8gPSB7IGxhYmVsOiAwLCBzZW50OiBmdW5jdGlvbigpIHsgaWYgKHRbMF0gJiAxKSB0aHJvdyB0WzFdOyByZXR1cm4gdFsxXTsgfSwgdHJ5czogW10sIG9wczogW10gfSwgZiwgeSwgdCwgZyA9IE9iamVjdC5jcmVhdGUoKHR5cGVvZiBJdGVyYXRvciA9PT0gXCJmdW5jdGlvblwiID8gSXRlcmF0b3IgOiBPYmplY3QpLnByb3RvdHlwZSk7XG4gIHJldHVybiBnLm5leHQgPSB2ZXJiKDApLCBnW1widGhyb3dcIl0gPSB2ZXJiKDEpLCBnW1wicmV0dXJuXCJdID0gdmVyYigyKSwgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnO1xuICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cbiAgZnVuY3Rpb24gc3RlcChvcCkge1xuICAgICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO1xuICAgICAgd2hpbGUgKGcgJiYgKGcgPSAwLCBvcFswXSAmJiAoXyA9IDApKSwgXykgdHJ5IHtcbiAgICAgICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSBvcFswXSAmIDIgPyB5W1wicmV0dXJuXCJdIDogb3BbMF0gPyB5W1widGhyb3dcIl0gfHwgKCh0ID0geVtcInJldHVyblwiXSkgJiYgdC5jYWxsKHkpLCAwKSA6IHkubmV4dCkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgcmV0dXJuIHQ7XG4gICAgICAgICAgaWYgKHkgPSAwLCB0KSBvcCA9IFtvcFswXSAmIDIsIHQudmFsdWVdO1xuICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcbiAgICAgICAgICAgICAgY2FzZSAwOiBjYXNlIDE6IHQgPSBvcDsgYnJlYWs7XG4gICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XG4gICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcbiAgICAgICAgICAgICAgY2FzZSA3OiBvcCA9IF8ub3BzLnBvcCgpOyBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xuICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XG4gICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDMgJiYgKCF0IHx8IChvcFsxXSA+IHRbMF0gJiYgb3BbMV0gPCB0WzNdKSkpIHsgXy5sYWJlbCA9IG9wWzFdOyBicmVhazsgfVxuICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XG4gICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XG4gICAgICAgICAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7XG4gICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cbiAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xuICB9XG59XG5cbmV4cG9ydCB2YXIgX19jcmVhdGVCaW5kaW5nID0gT2JqZWN0LmNyZWF0ZSA/IChmdW5jdGlvbihvLCBtLCBrLCBrMikge1xuICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IobSwgayk7XG4gIGlmICghZGVzYyB8fCAoXCJnZXRcIiBpbiBkZXNjID8gIW0uX19lc01vZHVsZSA6IGRlc2Mud3JpdGFibGUgfHwgZGVzYy5jb25maWd1cmFibGUpKSB7XG4gICAgICBkZXNjID0geyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gbVtrXTsgfSB9O1xuICB9XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBrMiwgZGVzYyk7XG59KSA6IChmdW5jdGlvbihvLCBtLCBrLCBrMikge1xuICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICBvW2syXSA9IG1ba107XG59KTtcblxuZXhwb3J0IGZ1bmN0aW9uIF9fZXhwb3J0U3RhcihtLCBvKSB7XG4gIGZvciAodmFyIHAgaW4gbSkgaWYgKHAgIT09IFwiZGVmYXVsdFwiICYmICFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobywgcCkpIF9fY3JlYXRlQmluZGluZyhvLCBtLCBwKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fdmFsdWVzKG8pIHtcbiAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDtcbiAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7XG4gIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gXCJudW1iZXJcIikgcmV0dXJuIHtcbiAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwO1xuICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTtcbiAgICAgIH1cbiAgfTtcbiAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gXCJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLlwiIDogXCJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX19yZWFkKG8sIG4pIHtcbiAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdO1xuICBpZiAoIW0pIHJldHVybiBvO1xuICB2YXIgaSA9IG0uY2FsbChvKSwgciwgYXIgPSBbXSwgZTtcbiAgdHJ5IHtcbiAgICAgIHdoaWxlICgobiA9PT0gdm9pZCAwIHx8IG4tLSA+IDApICYmICEociA9IGkubmV4dCgpKS5kb25lKSBhci5wdXNoKHIudmFsdWUpO1xuICB9XG4gIGNhdGNoIChlcnJvcikgeyBlID0geyBlcnJvcjogZXJyb3IgfTsgfVxuICBmaW5hbGx5IHtcbiAgICAgIHRyeSB7XG4gICAgICAgICAgaWYgKHIgJiYgIXIuZG9uZSAmJiAobSA9IGlbXCJyZXR1cm5cIl0pKSBtLmNhbGwoaSk7XG4gICAgICB9XG4gICAgICBmaW5hbGx5IHsgaWYgKGUpIHRocm93IGUuZXJyb3I7IH1cbiAgfVxuICByZXR1cm4gYXI7XG59XG5cbi8qKiBAZGVwcmVjYXRlZCAqL1xuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkKCkge1xuICBmb3IgKHZhciBhciA9IFtdLCBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKylcbiAgICAgIGFyID0gYXIuY29uY2F0KF9fcmVhZChhcmd1bWVudHNbaV0pKTtcbiAgcmV0dXJuIGFyO1xufVxuXG4vKiogQGRlcHJlY2F0ZWQgKi9cbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZEFycmF5cygpIHtcbiAgZm9yICh2YXIgcyA9IDAsIGkgPSAwLCBpbCA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBpbDsgaSsrKSBzICs9IGFyZ3VtZW50c1tpXS5sZW5ndGg7XG4gIGZvciAodmFyIHIgPSBBcnJheShzKSwgayA9IDAsIGkgPSAwOyBpIDwgaWw7IGkrKylcbiAgICAgIGZvciAodmFyIGEgPSBhcmd1bWVudHNbaV0sIGogPSAwLCBqbCA9IGEubGVuZ3RoOyBqIDwgamw7IGorKywgaysrKVxuICAgICAgICAgIHJba10gPSBhW2pdO1xuICByZXR1cm4gcjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkQXJyYXkodG8sIGZyb20sIHBhY2spIHtcbiAgaWYgKHBhY2sgfHwgYXJndW1lbnRzLmxlbmd0aCA9PT0gMikgZm9yICh2YXIgaSA9IDAsIGwgPSBmcm9tLmxlbmd0aCwgYXI7IGkgPCBsOyBpKyspIHtcbiAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcbiAgICAgICAgICBpZiAoIWFyKSBhciA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20sIDAsIGkpO1xuICAgICAgICAgIGFyW2ldID0gZnJvbVtpXTtcbiAgICAgIH1cbiAgfVxuICByZXR1cm4gdG8uY29uY2F0KGFyIHx8IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20pKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXQodikge1xuICByZXR1cm4gdGhpcyBpbnN0YW5jZW9mIF9fYXdhaXQgPyAodGhpcy52ID0gdiwgdGhpcykgOiBuZXcgX19hd2FpdCh2KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNHZW5lcmF0b3IodGhpc0FyZywgX2FyZ3VtZW50cywgZ2VuZXJhdG9yKSB7XG4gIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XG4gIHZhciBnID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pLCBpLCBxID0gW107XG4gIHJldHVybiBpID0gT2JqZWN0LmNyZWF0ZSgodHlwZW9mIEFzeW5jSXRlcmF0b3IgPT09IFwiZnVuY3Rpb25cIiA/IEFzeW5jSXRlcmF0b3IgOiBPYmplY3QpLnByb3RvdHlwZSksIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiwgYXdhaXRSZXR1cm4pLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XG4gIGZ1bmN0aW9uIGF3YWl0UmV0dXJuKGYpIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBQcm9taXNlLnJlc29sdmUodikudGhlbihmLCByZWplY3QpOyB9OyB9XG4gIGZ1bmN0aW9uIHZlcmIobiwgZikgeyBpZiAoZ1tuXSkgeyBpW25dID0gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChhLCBiKSB7IHEucHVzaChbbiwgdiwgYSwgYl0pID4gMSB8fCByZXN1bWUobiwgdik7IH0pOyB9OyBpZiAoZikgaVtuXSA9IGYoaVtuXSk7IH0gfVxuICBmdW5jdGlvbiByZXN1bWUobiwgdikgeyB0cnkgeyBzdGVwKGdbbl0odikpOyB9IGNhdGNoIChlKSB7IHNldHRsZShxWzBdWzNdLCBlKTsgfSB9XG4gIGZ1bmN0aW9uIHN0ZXAocikgeyByLnZhbHVlIGluc3RhbmNlb2YgX19hd2FpdCA/IFByb21pc2UucmVzb2x2ZShyLnZhbHVlLnYpLnRoZW4oZnVsZmlsbCwgcmVqZWN0KSA6IHNldHRsZShxWzBdWzJdLCByKTsgfVxuICBmdW5jdGlvbiBmdWxmaWxsKHZhbHVlKSB7IHJlc3VtZShcIm5leHRcIiwgdmFsdWUpOyB9XG4gIGZ1bmN0aW9uIHJlamVjdCh2YWx1ZSkgeyByZXN1bWUoXCJ0aHJvd1wiLCB2YWx1ZSk7IH1cbiAgZnVuY3Rpb24gc2V0dGxlKGYsIHYpIHsgaWYgKGYodiksIHEuc2hpZnQoKSwgcS5sZW5ndGgpIHJlc3VtZShxWzBdWzBdLCBxWzBdWzFdKTsgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0RlbGVnYXRvcihvKSB7XG4gIHZhciBpLCBwO1xuICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIsIGZ1bmN0aW9uIChlKSB7IHRocm93IGU7IH0pLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xuICBmdW5jdGlvbiB2ZXJiKG4sIGYpIHsgaVtuXSA9IG9bbl0gPyBmdW5jdGlvbiAodikgeyByZXR1cm4gKHAgPSAhcCkgPyB7IHZhbHVlOiBfX2F3YWl0KG9bbl0odikpLCBkb25lOiBmYWxzZSB9IDogZiA/IGYodikgOiB2OyB9IDogZjsgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY1ZhbHVlcyhvKSB7XG4gIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XG4gIHZhciBtID0gb1tTeW1ib2wuYXN5bmNJdGVyYXRvcl0sIGk7XG4gIHJldHVybiBtID8gbS5jYWxsKG8pIDogKG8gPSB0eXBlb2YgX192YWx1ZXMgPT09IFwiZnVuY3Rpb25cIiA/IF9fdmFsdWVzKG8pIDogb1tTeW1ib2wuaXRlcmF0b3JdKCksIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpKTtcbiAgZnVuY3Rpb24gdmVyYihuKSB7IGlbbl0gPSBvW25dICYmIGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHYgPSBvW25dKHYpLCBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCB2LmRvbmUsIHYudmFsdWUpOyB9KTsgfTsgfVxuICBmdW5jdGlvbiBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCBkLCB2KSB7IFByb21pc2UucmVzb2x2ZSh2KS50aGVuKGZ1bmN0aW9uKHYpIHsgcmVzb2x2ZSh7IHZhbHVlOiB2LCBkb25lOiBkIH0pOyB9LCByZWplY3QpOyB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfX21ha2VUZW1wbGF0ZU9iamVjdChjb29rZWQsIHJhdykge1xuICBpZiAoT2JqZWN0LmRlZmluZVByb3BlcnR5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjb29rZWQsIFwicmF3XCIsIHsgdmFsdWU6IHJhdyB9KTsgfSBlbHNlIHsgY29va2VkLnJhdyA9IHJhdzsgfVxuICByZXR1cm4gY29va2VkO1xufTtcblxudmFyIF9fc2V0TW9kdWxlRGVmYXVsdCA9IE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgdikge1xuICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgXCJkZWZhdWx0XCIsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHYgfSk7XG59KSA6IGZ1bmN0aW9uKG8sIHYpIHtcbiAgb1tcImRlZmF1bHRcIl0gPSB2O1xufTtcblxudmFyIG93bktleXMgPSBmdW5jdGlvbihvKSB7XG4gIG93bktleXMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyB8fCBmdW5jdGlvbiAobykge1xuICAgIHZhciBhciA9IFtdO1xuICAgIGZvciAodmFyIGsgaW4gbykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvLCBrKSkgYXJbYXIubGVuZ3RoXSA9IGs7XG4gICAgcmV0dXJuIGFyO1xuICB9O1xuICByZXR1cm4gb3duS2V5cyhvKTtcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydFN0YXIobW9kKSB7XG4gIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XG4gIHZhciByZXN1bHQgPSB7fTtcbiAgaWYgKG1vZCAhPSBudWxsKSBmb3IgKHZhciBrID0gb3duS2V5cyhtb2QpLCBpID0gMDsgaSA8IGsubGVuZ3RoOyBpKyspIGlmIChrW2ldICE9PSBcImRlZmF1bHRcIikgX19jcmVhdGVCaW5kaW5nKHJlc3VsdCwgbW9kLCBrW2ldKTtcbiAgX19zZXRNb2R1bGVEZWZhdWx0KHJlc3VsdCwgbW9kKTtcbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0RGVmYXVsdChtb2QpIHtcbiAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBkZWZhdWx0OiBtb2QgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fY2xhc3NQcml2YXRlRmllbGRHZXQocmVjZWl2ZXIsIHN0YXRlLCBraW5kLCBmKSB7XG4gIGlmIChraW5kID09PSBcImFcIiAmJiAhZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlByaXZhdGUgYWNjZXNzb3Igd2FzIGRlZmluZWQgd2l0aG91dCBhIGdldHRlclwiKTtcbiAgaWYgKHR5cGVvZiBzdGF0ZSA9PT0gXCJmdW5jdGlvblwiID8gcmVjZWl2ZXIgIT09IHN0YXRlIHx8ICFmIDogIXN0YXRlLmhhcyhyZWNlaXZlcikpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgcmVhZCBwcml2YXRlIG1lbWJlciBmcm9tIGFuIG9iamVjdCB3aG9zZSBjbGFzcyBkaWQgbm90IGRlY2xhcmUgaXRcIik7XG4gIHJldHVybiBraW5kID09PSBcIm1cIiA/IGYgOiBraW5kID09PSBcImFcIiA/IGYuY2FsbChyZWNlaXZlcikgOiBmID8gZi52YWx1ZSA6IHN0YXRlLmdldChyZWNlaXZlcik7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfX2NsYXNzUHJpdmF0ZUZpZWxkU2V0KHJlY2VpdmVyLCBzdGF0ZSwgdmFsdWUsIGtpbmQsIGYpIHtcbiAgaWYgKGtpbmQgPT09IFwibVwiKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiUHJpdmF0ZSBtZXRob2QgaXMgbm90IHdyaXRhYmxlXCIpO1xuICBpZiAoa2luZCA9PT0gXCJhXCIgJiYgIWYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJQcml2YXRlIGFjY2Vzc29yIHdhcyBkZWZpbmVkIHdpdGhvdXQgYSBzZXR0ZXJcIik7XG4gIGlmICh0eXBlb2Ygc3RhdGUgPT09IFwiZnVuY3Rpb25cIiA/IHJlY2VpdmVyICE9PSBzdGF0ZSB8fCAhZiA6ICFzdGF0ZS5oYXMocmVjZWl2ZXIpKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IHdyaXRlIHByaXZhdGUgbWVtYmVyIHRvIGFuIG9iamVjdCB3aG9zZSBjbGFzcyBkaWQgbm90IGRlY2xhcmUgaXRcIik7XG4gIHJldHVybiAoa2luZCA9PT0gXCJhXCIgPyBmLmNhbGwocmVjZWl2ZXIsIHZhbHVlKSA6IGYgPyBmLnZhbHVlID0gdmFsdWUgOiBzdGF0ZS5zZXQocmVjZWl2ZXIsIHZhbHVlKSksIHZhbHVlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX19jbGFzc1ByaXZhdGVGaWVsZEluKHN0YXRlLCByZWNlaXZlcikge1xuICBpZiAocmVjZWl2ZXIgPT09IG51bGwgfHwgKHR5cGVvZiByZWNlaXZlciAhPT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgcmVjZWl2ZXIgIT09IFwiZnVuY3Rpb25cIikpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgdXNlICdpbicgb3BlcmF0b3Igb24gbm9uLW9iamVjdFwiKTtcbiAgcmV0dXJuIHR5cGVvZiBzdGF0ZSA9PT0gXCJmdW5jdGlvblwiID8gcmVjZWl2ZXIgPT09IHN0YXRlIDogc3RhdGUuaGFzKHJlY2VpdmVyKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fYWRkRGlzcG9zYWJsZVJlc291cmNlKGVudiwgdmFsdWUsIGFzeW5jKSB7XG4gIGlmICh2YWx1ZSAhPT0gbnVsbCAmJiB2YWx1ZSAhPT0gdm9pZCAwKSB7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgdmFsdWUgIT09IFwiZnVuY3Rpb25cIikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIk9iamVjdCBleHBlY3RlZC5cIik7XG4gICAgdmFyIGRpc3Bvc2UsIGlubmVyO1xuICAgIGlmIChhc3luYykge1xuICAgICAgaWYgKCFTeW1ib2wuYXN5bmNEaXNwb3NlKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jRGlzcG9zZSBpcyBub3QgZGVmaW5lZC5cIik7XG4gICAgICBkaXNwb3NlID0gdmFsdWVbU3ltYm9sLmFzeW5jRGlzcG9zZV07XG4gICAgfVxuICAgIGlmIChkaXNwb3NlID09PSB2b2lkIDApIHtcbiAgICAgIGlmICghU3ltYm9sLmRpc3Bvc2UpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuZGlzcG9zZSBpcyBub3QgZGVmaW5lZC5cIik7XG4gICAgICBkaXNwb3NlID0gdmFsdWVbU3ltYm9sLmRpc3Bvc2VdO1xuICAgICAgaWYgKGFzeW5jKSBpbm5lciA9IGRpc3Bvc2U7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgZGlzcG9zZSAhPT0gXCJmdW5jdGlvblwiKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiT2JqZWN0IG5vdCBkaXNwb3NhYmxlLlwiKTtcbiAgICBpZiAoaW5uZXIpIGRpc3Bvc2UgPSBmdW5jdGlvbigpIHsgdHJ5IHsgaW5uZXIuY2FsbCh0aGlzKTsgfSBjYXRjaCAoZSkgeyByZXR1cm4gUHJvbWlzZS5yZWplY3QoZSk7IH0gfTtcbiAgICBlbnYuc3RhY2sucHVzaCh7IHZhbHVlOiB2YWx1ZSwgZGlzcG9zZTogZGlzcG9zZSwgYXN5bmM6IGFzeW5jIH0pO1xuICB9XG4gIGVsc2UgaWYgKGFzeW5jKSB7XG4gICAgZW52LnN0YWNrLnB1c2goeyBhc3luYzogdHJ1ZSB9KTtcbiAgfVxuICByZXR1cm4gdmFsdWU7XG59XG5cbnZhciBfU3VwcHJlc3NlZEVycm9yID0gdHlwZW9mIFN1cHByZXNzZWRFcnJvciA9PT0gXCJmdW5jdGlvblwiID8gU3VwcHJlc3NlZEVycm9yIDogZnVuY3Rpb24gKGVycm9yLCBzdXBwcmVzc2VkLCBtZXNzYWdlKSB7XG4gIHZhciBlID0gbmV3IEVycm9yKG1lc3NhZ2UpO1xuICByZXR1cm4gZS5uYW1lID0gXCJTdXBwcmVzc2VkRXJyb3JcIiwgZS5lcnJvciA9IGVycm9yLCBlLnN1cHByZXNzZWQgPSBzdXBwcmVzc2VkLCBlO1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIF9fZGlzcG9zZVJlc291cmNlcyhlbnYpIHtcbiAgZnVuY3Rpb24gZmFpbChlKSB7XG4gICAgZW52LmVycm9yID0gZW52Lmhhc0Vycm9yID8gbmV3IF9TdXBwcmVzc2VkRXJyb3IoZSwgZW52LmVycm9yLCBcIkFuIGVycm9yIHdhcyBzdXBwcmVzc2VkIGR1cmluZyBkaXNwb3NhbC5cIikgOiBlO1xuICAgIGVudi5oYXNFcnJvciA9IHRydWU7XG4gIH1cbiAgdmFyIHIsIHMgPSAwO1xuICBmdW5jdGlvbiBuZXh0KCkge1xuICAgIHdoaWxlIChyID0gZW52LnN0YWNrLnBvcCgpKSB7XG4gICAgICB0cnkge1xuICAgICAgICBpZiAoIXIuYXN5bmMgJiYgcyA9PT0gMSkgcmV0dXJuIHMgPSAwLCBlbnYuc3RhY2sucHVzaChyKSwgUHJvbWlzZS5yZXNvbHZlKCkudGhlbihuZXh0KTtcbiAgICAgICAgaWYgKHIuZGlzcG9zZSkge1xuICAgICAgICAgIHZhciByZXN1bHQgPSByLmRpc3Bvc2UuY2FsbChyLnZhbHVlKTtcbiAgICAgICAgICBpZiAoci5hc3luYykgcmV0dXJuIHMgfD0gMiwgUHJvbWlzZS5yZXNvbHZlKHJlc3VsdCkudGhlbihuZXh0LCBmdW5jdGlvbihlKSB7IGZhaWwoZSk7IHJldHVybiBuZXh0KCk7IH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgcyB8PSAxO1xuICAgICAgfVxuICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgZmFpbChlKTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHMgPT09IDEpIHJldHVybiBlbnYuaGFzRXJyb3IgPyBQcm9taXNlLnJlamVjdChlbnYuZXJyb3IpIDogUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgaWYgKGVudi5oYXNFcnJvcikgdGhyb3cgZW52LmVycm9yO1xuICB9XG4gIHJldHVybiBuZXh0KCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfX3Jld3JpdGVSZWxhdGl2ZUltcG9ydEV4dGVuc2lvbihwYXRoLCBwcmVzZXJ2ZUpzeCkge1xuICBpZiAodHlwZW9mIHBhdGggPT09IFwic3RyaW5nXCIgJiYgL15cXC5cXC4/XFwvLy50ZXN0KHBhdGgpKSB7XG4gICAgICByZXR1cm4gcGF0aC5yZXBsYWNlKC9cXC4odHN4KSR8KCg/OlxcLmQpPykoKD86XFwuW14uL10rPyk/KVxcLihbY21dPyl0cyQvaSwgZnVuY3Rpb24gKG0sIHRzeCwgZCwgZXh0LCBjbSkge1xuICAgICAgICAgIHJldHVybiB0c3ggPyBwcmVzZXJ2ZUpzeCA/IFwiLmpzeFwiIDogXCIuanNcIiA6IGQgJiYgKCFleHQgfHwgIWNtKSA/IG0gOiAoZCArIGV4dCArIFwiLlwiICsgY20udG9Mb3dlckNhc2UoKSArIFwianNcIik7XG4gICAgICB9KTtcbiAgfVxuICByZXR1cm4gcGF0aDtcbn1cblxuZXhwb3J0IGRlZmF1bHQge1xuICBfX2V4dGVuZHMsXG4gIF9fYXNzaWduLFxuICBfX3Jlc3QsXG4gIF9fZGVjb3JhdGUsXG4gIF9fcGFyYW0sXG4gIF9fZXNEZWNvcmF0ZSxcbiAgX19ydW5Jbml0aWFsaXplcnMsXG4gIF9fcHJvcEtleSxcbiAgX19zZXRGdW5jdGlvbk5hbWUsXG4gIF9fbWV0YWRhdGEsXG4gIF9fYXdhaXRlcixcbiAgX19nZW5lcmF0b3IsXG4gIF9fY3JlYXRlQmluZGluZyxcbiAgX19leHBvcnRTdGFyLFxuICBfX3ZhbHVlcyxcbiAgX19yZWFkLFxuICBfX3NwcmVhZCxcbiAgX19zcHJlYWRBcnJheXMsXG4gIF9fc3ByZWFkQXJyYXksXG4gIF9fYXdhaXQsXG4gIF9fYXN5bmNHZW5lcmF0b3IsXG4gIF9fYXN5bmNEZWxlZ2F0b3IsXG4gIF9fYXN5bmNWYWx1ZXMsXG4gIF9fbWFrZVRlbXBsYXRlT2JqZWN0LFxuICBfX2ltcG9ydFN0YXIsXG4gIF9faW1wb3J0RGVmYXVsdCxcbiAgX19jbGFzc1ByaXZhdGVGaWVsZEdldCxcbiAgX19jbGFzc1ByaXZhdGVGaWVsZFNldCxcbiAgX19jbGFzc1ByaXZhdGVGaWVsZEluLFxuICBfX2FkZERpc3Bvc2FibGVSZXNvdXJjZSxcbiAgX19kaXNwb3NlUmVzb3VyY2VzLFxuICBfX3Jld3JpdGVSZWxhdGl2ZUltcG9ydEV4dGVuc2lvbixcbn07XG4iLCJleHBvcnQgZnVuY3Rpb24gaGlnaGxpZ2h0QWN0aXZlTmF2KCkge1xuICAgIGNvbnN0IG5hdkxpbmtzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5jdXN0b20tbmF2YmFyIC5uYXYtbGlua1wiKTtcbiAgICBjb25zdCBjdXJyZW50UGF0aCA9IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZS5zcGxpdChcIi9cIikucG9wKCk7XG4gIFxuICAgIG5hdkxpbmtzLmZvckVhY2goKGxpbmspID0+IHtcbiAgICAgIGNvbnN0IGxpbmtQYXRoID0gbGluay5nZXRBdHRyaWJ1dGUoXCJocmVmXCIpO1xuICAgICAgaWYgKGxpbmtQYXRoID09PSBjdXJyZW50UGF0aCB8fCAobGlua1BhdGggPT09IFwiI1wiICYmIGN1cnJlbnRQYXRoLmluY2x1ZGVzKFwiZmFxXCIpKSkge1xuICAgICAgICBsaW5rLmNsYXNzTGlzdC5hZGQoXCJhY3RpdmVcIik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBsaW5rLmNsYXNzTGlzdC5yZW1vdmUoXCJhY3RpdmVcIik7XG4gICAgICB9XG4gICAgfSk7XG4gIH0iLCJpbXBvcnQgeyBfZ2V0UHJvdmlkZXIgYXMgdCwgZ2V0QXBwIGFzIGUsIF9yZW1vdmVTZXJ2aWNlSW5zdGFuY2UgYXMgbiwgX3JlZ2lzdGVyQ29tcG9uZW50IGFzIHMsIHJlZ2lzdGVyVmVyc2lvbiBhcyBpLCBTREtfVkVSU0lPTiBhcyByIH0gZnJvbSBcIkBmaXJlYmFzZS9hcHBcIjtcblxuaW1wb3J0IHsgQ29tcG9uZW50IGFzIG8gfSBmcm9tIFwiQGZpcmViYXNlL2NvbXBvbmVudFwiO1xuXG5pbXBvcnQgeyBMb2dnZXIgYXMgYSwgTG9nTGV2ZWwgYXMgYyB9IGZyb20gXCJAZmlyZWJhc2UvbG9nZ2VyXCI7XG5cbmltcG9ydCB7IGdldFVBIGFzIHUsIGlzU2FmYXJpIGFzIGgsIGlzTW9iaWxlQ29yZG92YSBhcyBsLCBpc1JlYWN0TmF0aXZlIGFzIGYsIGlzRWxlY3Ryb24gYXMgZCwgaXNJRSBhcyB3LCBpc1VXUCBhcyBfLCBpc0Jyb3dzZXJFeHRlbnNpb24gYXMgbSwgY3JlYXRlTW9ja1VzZXJUb2tlbiBhcyBnLCBnZXRNb2R1bGFySW5zdGFuY2UgYXMgeSwgZGVlcEVxdWFsIGFzIHAgfSBmcm9tIFwiQGZpcmViYXNlL3V0aWxcIjtcblxuaW1wb3J0IHsgWGhySW8gYXMgRSwgRXZlbnRUeXBlIGFzIFQsIEVycm9yQ29kZSBhcyBJLCBjcmVhdGVXZWJDaGFubmVsVHJhbnNwb3J0IGFzIEEsIGdldFN0YXRFdmVudFRhcmdldCBhcyBSLCBGZXRjaFhtbEh0dHBGYWN0b3J5IGFzIFAsIFdlYkNoYW5uZWwgYXMgYiwgRXZlbnQgYXMgdiwgU3RhdCBhcyBWIH0gZnJvbSBcIkBmaXJlYmFzZS93ZWJjaGFubmVsLXdyYXBwZXJcIjtcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogU2ltcGxlIHdyYXBwZXIgYXJvdW5kIGEgbnVsbGFibGUgVUlELiBNb3N0bHkgZXhpc3RzIHRvIG1ha2UgY29kZSBtb3JlXG4gKiByZWFkYWJsZS5cbiAqL1xuY2xhc3MgUyB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLnVpZCA9IHQ7XG4gICAgfVxuICAgIGlzQXV0aGVudGljYXRlZCgpIHtcbiAgICAgICAgcmV0dXJuIG51bGwgIT0gdGhpcy51aWQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBrZXkgcmVwcmVzZW50aW5nIHRoaXMgdXNlciwgc3VpdGFibGUgZm9yIGluY2x1c2lvbiBpbiBhXG4gICAgICogZGljdGlvbmFyeS5cbiAgICAgKi8gICAgdG9LZXkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmlzQXV0aGVudGljYXRlZCgpID8gXCJ1aWQ6XCIgKyB0aGlzLnVpZCA6IFwiYW5vbnltb3VzLXVzZXJcIjtcbiAgICB9XG4gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIHJldHVybiB0LnVpZCA9PT0gdGhpcy51aWQ7XG4gICAgfVxufVxuXG4vKiogQSB1c2VyIHdpdGggYSBudWxsIFVJRC4gKi8gUy5VTkFVVEhFTlRJQ0FURUQgPSBuZXcgUyhudWxsKSwgXG4vLyBUT0RPKG1pa2VsZWhlbik6IExvb2sgaW50byBnZXR0aW5nIGEgcHJvcGVyIHVpZC1lcXVpdmFsZW50IGZvclxuLy8gbm9uLUZpcmViYXNlQXV0aCBwcm92aWRlcnMuXG5TLkdPT0dMRV9DUkVERU5USUFMUyA9IG5ldyBTKFwiZ29vZ2xlLWNyZWRlbnRpYWxzLXVpZFwiKSwgUy5GSVJTVF9QQVJUWSA9IG5ldyBTKFwiZmlyc3QtcGFydHktdWlkXCIpLCBcblMuTU9DS19VU0VSID0gbmV3IFMoXCJtb2NrLXVzZXJcIik7XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5sZXQgRCA9IFwiOS4wLjFcIjtcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmNvbnN0IEMgPSBuZXcgYShcIkBmaXJlYmFzZS9maXJlc3RvcmVcIik7XG5cbi8vIEhlbHBlciBtZXRob2RzIGFyZSBuZWVkZWQgYmVjYXVzZSB2YXJpYWJsZXMgY2FuJ3QgYmUgZXhwb3J0ZWQgYXMgcmVhZC93cml0ZVxuZnVuY3Rpb24gTigpIHtcbiAgICByZXR1cm4gQy5sb2dMZXZlbDtcbn1cblxuLyoqXG4gKiBTZXRzIHRoZSB2ZXJib3NpdHkgb2YgQ2xvdWQgRmlyZXN0b3JlIGxvZ3MgKGRlYnVnLCBlcnJvciwgb3Igc2lsZW50KS5cbiAqXG4gKiBAcGFyYW0gbG9nTGV2ZWwgLSBUaGUgdmVyYm9zaXR5IHlvdSBzZXQgZm9yIGFjdGl2aXR5IGFuZCBlcnJvciBsb2dnaW5nLiBDYW5cbiAqICAgYmUgYW55IG9mIHRoZSBmb2xsb3dpbmcgdmFsdWVzOlxuICpcbiAqICAgPHVsPlxuICogICAgIDxsaT5gZGVidWdgIGZvciB0aGUgbW9zdCB2ZXJib3NlIGxvZ2dpbmcgbGV2ZWwsIHByaW1hcmlseSBmb3JcbiAqICAgICBkZWJ1Z2dpbmcuPC9saT5cbiAqICAgICA8bGk+YGVycm9yYCB0byBsb2cgZXJyb3JzIG9ubHkuPC9saT5cbiAqICAgICA8bGk+PGNvZGU+YHNpbGVudGAgdG8gdHVybiBvZmYgbG9nZ2luZy48L2xpPlxuICogICA8L3VsPlxuICovIGZ1bmN0aW9uIHgodCkge1xuICAgIEMuc2V0TG9nTGV2ZWwodCk7XG59XG5cbmZ1bmN0aW9uIGsodCwgLi4uZSkge1xuICAgIGlmIChDLmxvZ0xldmVsIDw9IGMuREVCVUcpIHtcbiAgICAgICAgY29uc3QgbiA9IGUubWFwKEYpO1xuICAgICAgICBDLmRlYnVnKGBGaXJlc3RvcmUgKCR7RH0pOiAke3R9YCwgLi4ubik7XG4gICAgfVxufVxuXG5mdW5jdGlvbiAkKHQsIC4uLmUpIHtcbiAgICBpZiAoQy5sb2dMZXZlbCA8PSBjLkVSUk9SKSB7XG4gICAgICAgIGNvbnN0IG4gPSBlLm1hcChGKTtcbiAgICAgICAgQy5lcnJvcihgRmlyZXN0b3JlICgke0R9KTogJHt0fWAsIC4uLm4pO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAaW50ZXJuYWxcbiAqLyBmdW5jdGlvbiBPKHQsIC4uLmUpIHtcbiAgICBpZiAoQy5sb2dMZXZlbCA8PSBjLldBUk4pIHtcbiAgICAgICAgY29uc3QgbiA9IGUubWFwKEYpO1xuICAgICAgICBDLndhcm4oYEZpcmVzdG9yZSAoJHtEfSk6ICR7dH1gLCAuLi5uKTtcbiAgICB9XG59XG5cbi8qKlxuICogQ29udmVydHMgYW4gYWRkaXRpb25hbCBsb2cgcGFyYW1ldGVyIHRvIGEgc3RyaW5nIHJlcHJlc2VudGF0aW9uLlxuICovIGZ1bmN0aW9uIEYodCkge1xuICAgIGlmIChcInN0cmluZ1wiID09IHR5cGVvZiB0KSByZXR1cm4gdDtcbiAgICB0cnkge1xuICAgICAgICByZXR1cm4gZSA9IHQsIEpTT04uc3RyaW5naWZ5KGUpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgLy8gQ29udmVydGluZyB0byBKU09OIGZhaWxlZCwganVzdCBsb2cgdGhlIG9iamVjdCBkaXJlY3RseVxuICAgICAgICByZXR1cm4gdDtcbiAgICB9XG4gICAgLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbiAgICAvKiogRm9ybWF0cyBhbiBvYmplY3QgYXMgYSBKU09OIHN0cmluZywgc3VpdGFibGUgZm9yIGxvZ2dpbmcuICovXG4gICAgdmFyIGU7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFVuY29uZGl0aW9uYWxseSBmYWlscywgdGhyb3dpbmcgYW4gRXJyb3Igd2l0aCB0aGUgZ2l2ZW4gbWVzc2FnZS5cbiAqIE1lc3NhZ2VzIGFyZSBzdHJpcHBlZCBpbiBwcm9kdWN0aW9uIGJ1aWxkcy5cbiAqXG4gKiBSZXR1cm5zIGBuZXZlcmAgYW5kIGNhbiBiZSB1c2VkIGluIGV4cHJlc3Npb25zOlxuICogQGV4YW1wbGVcbiAqIGxldCBmdXR1cmVWYXIgPSBmYWlsKCdub3QgaW1wbGVtZW50ZWQgeWV0Jyk7XG4gKi8gZnVuY3Rpb24gTSh0ID0gXCJVbmV4cGVjdGVkIHN0YXRlXCIpIHtcbiAgICAvLyBMb2cgdGhlIGZhaWx1cmUgaW4gYWRkaXRpb24gdG8gdGhyb3cgYW4gZXhjZXB0aW9uLCBqdXN0IGluIGNhc2UgdGhlXG4gICAgLy8gZXhjZXB0aW9uIGlzIHN3YWxsb3dlZC5cbiAgICBjb25zdCBlID0gYEZJUkVTVE9SRSAoJHtEfSkgSU5URVJOQUwgQVNTRVJUSU9OIEZBSUxFRDogYCArIHQ7XG4gICAgLy8gTk9URTogV2UgZG9uJ3QgdXNlIEZpcmVzdG9yZUVycm9yIGhlcmUgYmVjYXVzZSB0aGVzZSBhcmUgaW50ZXJuYWwgZmFpbHVyZXNcbiAgICAvLyB0aGF0IGNhbm5vdCBiZSBoYW5kbGVkIGJ5IHRoZSB1c2VyLiAoQWxzbyBpdCB3b3VsZCBjcmVhdGUgYSBjaXJjdWxhclxuICAgIC8vIGRlcGVuZGVuY3kgYmV0d2VlbiB0aGUgZXJyb3IgYW5kIGFzc2VydCBtb2R1bGVzIHdoaWNoIGRvZXNuJ3Qgd29yay4pXG4gICAgdGhyb3cgJChlKSwgbmV3IEVycm9yKGUpO1xufVxuXG4vKipcbiAqIEZhaWxzIGlmIHRoZSBnaXZlbiBhc3NlcnRpb24gY29uZGl0aW9uIGlzIGZhbHNlLCB0aHJvd2luZyBhbiBFcnJvciB3aXRoIHRoZVxuICogZ2l2ZW4gbWVzc2FnZSBpZiBpdCBkaWQuXG4gKlxuICogTWVzc2FnZXMgYXJlIHN0cmlwcGVkIGluIHByb2R1Y3Rpb24gYnVpbGRzLlxuICovIGZ1bmN0aW9uIEwodCwgZSkge1xuICAgIHQgfHwgTSgpO1xufVxuXG4vKipcbiAqIEZhaWxzIGlmIHRoZSBnaXZlbiBhc3NlcnRpb24gY29uZGl0aW9uIGlzIGZhbHNlLCB0aHJvd2luZyBhbiBFcnJvciB3aXRoIHRoZVxuICogZ2l2ZW4gbWVzc2FnZSBpZiBpdCBkaWQuXG4gKlxuICogVGhlIGNvZGUgb2YgY2FsbHNpdGVzIGludm9raW5nIHRoaXMgZnVuY3Rpb24gYXJlIHN0cmlwcGVkIG91dCBpbiBwcm9kdWN0aW9uXG4gKiBidWlsZHMuIEFueSBzaWRlLWVmZmVjdHMgb2YgY29kZSB3aXRoaW4gdGhlIGRlYnVnQXNzZXJ0KCkgaW52b2NhdGlvbiB3aWxsIG5vdFxuICogaGFwcGVuIGluIHRoaXMgY2FzZS5cbiAqXG4gKiBAaW50ZXJuYWxcbiAqLyBmdW5jdGlvbiBCKHQsIGUpIHtcbiAgICB0IHx8IE0oKTtcbn1cblxuLyoqXG4gKiBDYXN0cyBgb2JqYCB0byBgVGAuIEluIG5vbi1wcm9kdWN0aW9uIGJ1aWxkcywgdmVyaWZpZXMgdGhhdCBgb2JqYCBpcyBhblxuICogaW5zdGFuY2Ugb2YgYFRgIGJlZm9yZSBjYXN0aW5nLlxuICovIGZ1bmN0aW9uIFUodCwgXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuZSkge1xuICAgIHJldHVybiB0O1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjb25zdCBxID0ge1xuICAgIC8vIENhdXNlcyBhcmUgY29waWVkIGZyb206XG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2dycGMvZ3JwYy9ibG9iL2JjZWVjOTRlYTRmYzVmMDA4NWQ4MTIzNWQ4ZTFjMDY3OThkYzM0MWEvaW5jbHVkZS9ncnBjJTJCJTJCL2ltcGwvY29kZWdlbi9zdGF0dXNfY29kZV9lbnVtLmhcbiAgICAvKiogTm90IGFuIGVycm9yOyByZXR1cm5lZCBvbiBzdWNjZXNzLiAqL1xuICAgIE9LOiBcIm9rXCIsXG4gICAgLyoqIFRoZSBvcGVyYXRpb24gd2FzIGNhbmNlbGxlZCAodHlwaWNhbGx5IGJ5IHRoZSBjYWxsZXIpLiAqL1xuICAgIENBTkNFTExFRDogXCJjYW5jZWxsZWRcIixcbiAgICAvKiogVW5rbm93biBlcnJvciBvciBhbiBlcnJvciBmcm9tIGEgZGlmZmVyZW50IGVycm9yIGRvbWFpbi4gKi9cbiAgICBVTktOT1dOOiBcInVua25vd25cIixcbiAgICAvKipcbiAgICAgKiBDbGllbnQgc3BlY2lmaWVkIGFuIGludmFsaWQgYXJndW1lbnQuIE5vdGUgdGhhdCB0aGlzIGRpZmZlcnMgZnJvbVxuICAgICAqIEZBSUxFRF9QUkVDT05ESVRJT04uIElOVkFMSURfQVJHVU1FTlQgaW5kaWNhdGVzIGFyZ3VtZW50cyB0aGF0IGFyZVxuICAgICAqIHByb2JsZW1hdGljIHJlZ2FyZGxlc3Mgb2YgdGhlIHN0YXRlIG9mIHRoZSBzeXN0ZW0gKGUuZy4sIGEgbWFsZm9ybWVkIGZpbGVcbiAgICAgKiBuYW1lKS5cbiAgICAgKi9cbiAgICBJTlZBTElEX0FSR1VNRU5UOiBcImludmFsaWQtYXJndW1lbnRcIixcbiAgICAvKipcbiAgICAgKiBEZWFkbGluZSBleHBpcmVkIGJlZm9yZSBvcGVyYXRpb24gY291bGQgY29tcGxldGUuIEZvciBvcGVyYXRpb25zIHRoYXRcbiAgICAgKiBjaGFuZ2UgdGhlIHN0YXRlIG9mIHRoZSBzeXN0ZW0sIHRoaXMgZXJyb3IgbWF5IGJlIHJldHVybmVkIGV2ZW4gaWYgdGhlXG4gICAgICogb3BlcmF0aW9uIGhhcyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LiBGb3IgZXhhbXBsZSwgYSBzdWNjZXNzZnVsIHJlc3BvbnNlXG4gICAgICogZnJvbSBhIHNlcnZlciBjb3VsZCBoYXZlIGJlZW4gZGVsYXllZCBsb25nIGVub3VnaCBmb3IgdGhlIGRlYWRsaW5lIHRvXG4gICAgICogZXhwaXJlLlxuICAgICAqL1xuICAgIERFQURMSU5FX0VYQ0VFREVEOiBcImRlYWRsaW5lLWV4Y2VlZGVkXCIsXG4gICAgLyoqIFNvbWUgcmVxdWVzdGVkIGVudGl0eSAoZS5nLiwgZmlsZSBvciBkaXJlY3RvcnkpIHdhcyBub3QgZm91bmQuICovXG4gICAgTk9UX0ZPVU5EOiBcIm5vdC1mb3VuZFwiLFxuICAgIC8qKlxuICAgICAqIFNvbWUgZW50aXR5IHRoYXQgd2UgYXR0ZW1wdGVkIHRvIGNyZWF0ZSAoZS5nLiwgZmlsZSBvciBkaXJlY3RvcnkpIGFscmVhZHlcbiAgICAgKiBleGlzdHMuXG4gICAgICovXG4gICAgQUxSRUFEWV9FWElTVFM6IFwiYWxyZWFkeS1leGlzdHNcIixcbiAgICAvKipcbiAgICAgKiBUaGUgY2FsbGVyIGRvZXMgbm90IGhhdmUgcGVybWlzc2lvbiB0byBleGVjdXRlIHRoZSBzcGVjaWZpZWQgb3BlcmF0aW9uLlxuICAgICAqIFBFUk1JU1NJT05fREVOSUVEIG11c3Qgbm90IGJlIHVzZWQgZm9yIHJlamVjdGlvbnMgY2F1c2VkIGJ5IGV4aGF1c3RpbmdcbiAgICAgKiBzb21lIHJlc291cmNlICh1c2UgUkVTT1VSQ0VfRVhIQVVTVEVEIGluc3RlYWQgZm9yIHRob3NlIGVycm9ycykuXG4gICAgICogUEVSTUlTU0lPTl9ERU5JRUQgbXVzdCBub3QgYmUgdXNlZCBpZiB0aGUgY2FsbGVyIGNhbiBub3QgYmUgaWRlbnRpZmllZFxuICAgICAqICh1c2UgVU5BVVRIRU5USUNBVEVEIGluc3RlYWQgZm9yIHRob3NlIGVycm9ycykuXG4gICAgICovXG4gICAgUEVSTUlTU0lPTl9ERU5JRUQ6IFwicGVybWlzc2lvbi1kZW5pZWRcIixcbiAgICAvKipcbiAgICAgKiBUaGUgcmVxdWVzdCBkb2VzIG5vdCBoYXZlIHZhbGlkIGF1dGhlbnRpY2F0aW9uIGNyZWRlbnRpYWxzIGZvciB0aGVcbiAgICAgKiBvcGVyYXRpb24uXG4gICAgICovXG4gICAgVU5BVVRIRU5USUNBVEVEOiBcInVuYXV0aGVudGljYXRlZFwiLFxuICAgIC8qKlxuICAgICAqIFNvbWUgcmVzb3VyY2UgaGFzIGJlZW4gZXhoYXVzdGVkLCBwZXJoYXBzIGEgcGVyLXVzZXIgcXVvdGEsIG9yIHBlcmhhcHMgdGhlXG4gICAgICogZW50aXJlIGZpbGUgc3lzdGVtIGlzIG91dCBvZiBzcGFjZS5cbiAgICAgKi9cbiAgICBSRVNPVVJDRV9FWEhBVVNURUQ6IFwicmVzb3VyY2UtZXhoYXVzdGVkXCIsXG4gICAgLyoqXG4gICAgICogT3BlcmF0aW9uIHdhcyByZWplY3RlZCBiZWNhdXNlIHRoZSBzeXN0ZW0gaXMgbm90IGluIGEgc3RhdGUgcmVxdWlyZWQgZm9yXG4gICAgICogdGhlIG9wZXJhdGlvbidzIGV4ZWN1dGlvbi4gRm9yIGV4YW1wbGUsIGRpcmVjdG9yeSB0byBiZSBkZWxldGVkIG1heSBiZVxuICAgICAqIG5vbi1lbXB0eSwgYW4gcm1kaXIgb3BlcmF0aW9uIGlzIGFwcGxpZWQgdG8gYSBub24tZGlyZWN0b3J5LCBldGMuXG4gICAgICpcbiAgICAgKiBBIGxpdG11cyB0ZXN0IHRoYXQgbWF5IGhlbHAgYSBzZXJ2aWNlIGltcGxlbWVudG9yIGluIGRlY2lkaW5nXG4gICAgICogYmV0d2VlbiBGQUlMRURfUFJFQ09ORElUSU9OLCBBQk9SVEVELCBhbmQgVU5BVkFJTEFCTEU6XG4gICAgICogIChhKSBVc2UgVU5BVkFJTEFCTEUgaWYgdGhlIGNsaWVudCBjYW4gcmV0cnkganVzdCB0aGUgZmFpbGluZyBjYWxsLlxuICAgICAqICAoYikgVXNlIEFCT1JURUQgaWYgdGhlIGNsaWVudCBzaG91bGQgcmV0cnkgYXQgYSBoaWdoZXItbGV2ZWxcbiAgICAgKiAgICAgIChlLmcuLCByZXN0YXJ0aW5nIGEgcmVhZC1tb2RpZnktd3JpdGUgc2VxdWVuY2UpLlxuICAgICAqICAoYykgVXNlIEZBSUxFRF9QUkVDT05ESVRJT04gaWYgdGhlIGNsaWVudCBzaG91bGQgbm90IHJldHJ5IHVudGlsXG4gICAgICogICAgICB0aGUgc3lzdGVtIHN0YXRlIGhhcyBiZWVuIGV4cGxpY2l0bHkgZml4ZWQuIEUuZy4sIGlmIGFuIFwicm1kaXJcIlxuICAgICAqICAgICAgZmFpbHMgYmVjYXVzZSB0aGUgZGlyZWN0b3J5IGlzIG5vbi1lbXB0eSwgRkFJTEVEX1BSRUNPTkRJVElPTlxuICAgICAqICAgICAgc2hvdWxkIGJlIHJldHVybmVkIHNpbmNlIHRoZSBjbGllbnQgc2hvdWxkIG5vdCByZXRyeSB1bmxlc3NcbiAgICAgKiAgICAgIHRoZXkgaGF2ZSBmaXJzdCBmaXhlZCB1cCB0aGUgZGlyZWN0b3J5IGJ5IGRlbGV0aW5nIGZpbGVzIGZyb20gaXQuXG4gICAgICogIChkKSBVc2UgRkFJTEVEX1BSRUNPTkRJVElPTiBpZiB0aGUgY2xpZW50IHBlcmZvcm1zIGNvbmRpdGlvbmFsXG4gICAgICogICAgICBSRVNUIEdldC9VcGRhdGUvRGVsZXRlIG9uIGEgcmVzb3VyY2UgYW5kIHRoZSByZXNvdXJjZSBvbiB0aGVcbiAgICAgKiAgICAgIHNlcnZlciBkb2VzIG5vdCBtYXRjaCB0aGUgY29uZGl0aW9uLiBFLmcuLCBjb25mbGljdGluZ1xuICAgICAqICAgICAgcmVhZC1tb2RpZnktd3JpdGUgb24gdGhlIHNhbWUgcmVzb3VyY2UuXG4gICAgICovXG4gICAgRkFJTEVEX1BSRUNPTkRJVElPTjogXCJmYWlsZWQtcHJlY29uZGl0aW9uXCIsXG4gICAgLyoqXG4gICAgICogVGhlIG9wZXJhdGlvbiB3YXMgYWJvcnRlZCwgdHlwaWNhbGx5IGR1ZSB0byBhIGNvbmN1cnJlbmN5IGlzc3VlIGxpa2VcbiAgICAgKiBzZXF1ZW5jZXIgY2hlY2sgZmFpbHVyZXMsIHRyYW5zYWN0aW9uIGFib3J0cywgZXRjLlxuICAgICAqXG4gICAgICogU2VlIGxpdG11cyB0ZXN0IGFib3ZlIGZvciBkZWNpZGluZyBiZXR3ZWVuIEZBSUxFRF9QUkVDT05ESVRJT04sIEFCT1JURUQsXG4gICAgICogYW5kIFVOQVZBSUxBQkxFLlxuICAgICAqL1xuICAgIEFCT1JURUQ6IFwiYWJvcnRlZFwiLFxuICAgIC8qKlxuICAgICAqIE9wZXJhdGlvbiB3YXMgYXR0ZW1wdGVkIHBhc3QgdGhlIHZhbGlkIHJhbmdlLiBFLmcuLCBzZWVraW5nIG9yIHJlYWRpbmdcbiAgICAgKiBwYXN0IGVuZCBvZiBmaWxlLlxuICAgICAqXG4gICAgICogVW5saWtlIElOVkFMSURfQVJHVU1FTlQsIHRoaXMgZXJyb3IgaW5kaWNhdGVzIGEgcHJvYmxlbSB0aGF0IG1heSBiZSBmaXhlZFxuICAgICAqIGlmIHRoZSBzeXN0ZW0gc3RhdGUgY2hhbmdlcy4gRm9yIGV4YW1wbGUsIGEgMzItYml0IGZpbGUgc3lzdGVtIHdpbGxcbiAgICAgKiBnZW5lcmF0ZSBJTlZBTElEX0FSR1VNRU5UIGlmIGFza2VkIHRvIHJlYWQgYXQgYW4gb2Zmc2V0IHRoYXQgaXMgbm90IGluIHRoZVxuICAgICAqIHJhbmdlIFswLDJeMzItMV0sIGJ1dCBpdCB3aWxsIGdlbmVyYXRlIE9VVF9PRl9SQU5HRSBpZiBhc2tlZCB0byByZWFkIGZyb21cbiAgICAgKiBhbiBvZmZzZXQgcGFzdCB0aGUgY3VycmVudCBmaWxlIHNpemUuXG4gICAgICpcbiAgICAgKiBUaGVyZSBpcyBhIGZhaXIgYml0IG9mIG92ZXJsYXAgYmV0d2VlbiBGQUlMRURfUFJFQ09ORElUSU9OIGFuZFxuICAgICAqIE9VVF9PRl9SQU5HRS4gV2UgcmVjb21tZW5kIHVzaW5nIE9VVF9PRl9SQU5HRSAodGhlIG1vcmUgc3BlY2lmaWMgZXJyb3IpXG4gICAgICogd2hlbiBpdCBhcHBsaWVzIHNvIHRoYXQgY2FsbGVycyB3aG8gYXJlIGl0ZXJhdGluZyB0aHJvdWdoIGEgc3BhY2UgY2FuXG4gICAgICogZWFzaWx5IGxvb2sgZm9yIGFuIE9VVF9PRl9SQU5HRSBlcnJvciB0byBkZXRlY3Qgd2hlbiB0aGV5IGFyZSBkb25lLlxuICAgICAqL1xuICAgIE9VVF9PRl9SQU5HRTogXCJvdXQtb2YtcmFuZ2VcIixcbiAgICAvKiogT3BlcmF0aW9uIGlzIG5vdCBpbXBsZW1lbnRlZCBvciBub3Qgc3VwcG9ydGVkL2VuYWJsZWQgaW4gdGhpcyBzZXJ2aWNlLiAqL1xuICAgIFVOSU1QTEVNRU5URUQ6IFwidW5pbXBsZW1lbnRlZFwiLFxuICAgIC8qKlxuICAgICAqIEludGVybmFsIGVycm9ycy4gTWVhbnMgc29tZSBpbnZhcmlhbnRzIGV4cGVjdGVkIGJ5IHVuZGVybHlpbmcgU3lzdGVtIGhhc1xuICAgICAqIGJlZW4gYnJva2VuLiBJZiB5b3Ugc2VlIG9uZSBvZiB0aGVzZSBlcnJvcnMsIFNvbWV0aGluZyBpcyB2ZXJ5IGJyb2tlbi5cbiAgICAgKi9cbiAgICBJTlRFUk5BTDogXCJpbnRlcm5hbFwiLFxuICAgIC8qKlxuICAgICAqIFRoZSBzZXJ2aWNlIGlzIGN1cnJlbnRseSB1bmF2YWlsYWJsZS4gVGhpcyBpcyBhIG1vc3QgbGlrZWx5IGEgdHJhbnNpZW50XG4gICAgICogY29uZGl0aW9uIGFuZCBtYXkgYmUgY29ycmVjdGVkIGJ5IHJldHJ5aW5nIHdpdGggYSBiYWNrb2ZmLlxuICAgICAqXG4gICAgICogU2VlIGxpdG11cyB0ZXN0IGFib3ZlIGZvciBkZWNpZGluZyBiZXR3ZWVuIEZBSUxFRF9QUkVDT05ESVRJT04sIEFCT1JURUQsXG4gICAgICogYW5kIFVOQVZBSUxBQkxFLlxuICAgICAqL1xuICAgIFVOQVZBSUxBQkxFOiBcInVuYXZhaWxhYmxlXCIsXG4gICAgLyoqIFVucmVjb3ZlcmFibGUgZGF0YSBsb3NzIG9yIGNvcnJ1cHRpb24uICovXG4gICAgREFUQV9MT1NTOiBcImRhdGEtbG9zc1wiXG59O1xuXG4vKiogQW4gZXJyb3IgcmV0dXJuZWQgYnkgYSBGaXJlc3RvcmUgb3BlcmF0aW9uLiAqLyBjbGFzcyBLIGV4dGVuZHMgRXJyb3Ige1xuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yICovXG4gICAgY29uc3RydWN0b3IoXG4gICAgLyoqXG4gICAgICogVGhlIGJhY2tlbmQgZXJyb3IgY29kZSBhc3NvY2lhdGVkIHdpdGggdGhpcyBlcnJvci5cbiAgICAgKi9cbiAgICB0LCBcbiAgICAvKipcbiAgICAgKiBBIGN1c3RvbSBlcnJvciBkZXNjcmlwdGlvbi5cbiAgICAgKi9cbiAgICBlKSB7XG4gICAgICAgIHN1cGVyKGUpLCB0aGlzLmNvZGUgPSB0LCB0aGlzLm1lc3NhZ2UgPSBlLCBcbiAgICAgICAgLyoqIFRoZSBjdXN0b20gbmFtZSBmb3IgYWxsIEZpcmVzdG9yZUVycm9ycy4gKi9cbiAgICAgICAgdGhpcy5uYW1lID0gXCJGaXJlYmFzZUVycm9yXCIsIFxuICAgICAgICAvLyBIQUNLOiBXZSB3cml0ZSBhIHRvU3RyaW5nIHByb3BlcnR5IGRpcmVjdGx5IGJlY2F1c2UgRXJyb3IgaXMgbm90IGEgcmVhbFxuICAgICAgICAvLyBjbGFzcyBhbmQgc28gaW5oZXJpdGFuY2UgZG9lcyBub3Qgd29yayBjb3JyZWN0bHkuIFdlIGNvdWxkIGFsdGVybmF0aXZlbHlcbiAgICAgICAgLy8gZG8gdGhlIHNhbWUgXCJiYWNrLWRvb3IgaW5oZXJpdGFuY2VcIiB0cmljayB0aGF0IEZpcmViYXNlRXJyb3IgZG9lcy5cbiAgICAgICAgdGhpcy50b1N0cmluZyA9ICgpID0+IGAke3RoaXMubmFtZX06IFtjb2RlPSR7dGhpcy5jb2RlfV06ICR7dGhpcy5tZXNzYWdlfWA7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjbGFzcyBqIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5wcm9taXNlID0gbmV3IFByb21pc2UoKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnJlc29sdmUgPSB0LCB0aGlzLnJlamVjdCA9IGU7XG4gICAgICAgIH0pKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNsYXNzIFEge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy51c2VyID0gZSwgdGhpcy50eXBlID0gXCJPQXV0aFwiLCB0aGlzLmF1dGhIZWFkZXJzID0ge30sIFxuICAgICAgICAvLyBTZXQgdGhlIGhlYWRlcnMgdXNpbmcgT2JqZWN0IExpdGVyYWwgbm90YXRpb24gdG8gYXZvaWQgbWluaWZpY2F0aW9uXG4gICAgICAgIHRoaXMuYXV0aEhlYWRlcnMuQXV0aG9yaXphdGlvbiA9IGBCZWFyZXIgJHt0fWA7XG4gICAgfVxufVxuXG4vKiogQSBDcmVkZW50aWFsc1Byb3ZpZGVyIHRoYXQgYWx3YXlzIHlpZWxkcyBhbiBlbXB0eSB0b2tlbi4gKi8gY2xhc3MgVyB7XG4gICAgZ2V0VG9rZW4oKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobnVsbCk7XG4gICAgfVxuICAgIGludmFsaWRhdGVUb2tlbigpIHt9XG4gICAgc3RhcnQodCwgZSkge1xuICAgICAgICAvLyBGaXJlIHdpdGggaW5pdGlhbCB1c2VyLlxuICAgICAgICB0LmVucXVldWVSZXRyeWFibGUoKCgpID0+IGUoUy5VTkFVVEhFTlRJQ0FURUQpKSk7XG4gICAgfVxuICAgIHNodXRkb3duKCkge31cbn1cblxuLyoqXG4gKiBBIENyZWRlbnRpYWxzUHJvdmlkZXIgdGhhdCBhbHdheXMgcmV0dXJucyBhIGNvbnN0YW50IHRva2VuLiBVc2VkIGZvclxuICogZW11bGF0b3IgdG9rZW4gbW9ja2luZy5cbiAqLyBjbGFzcyBHIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMudG9rZW4gPSB0LCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFN0b3JlcyB0aGUgbGlzdGVuZXIgcmVnaXN0ZXJlZCB3aXRoIHNldENoYW5nZUxpc3RlbmVyKClcbiAgICAgICAgICogVGhpcyBpc24ndCBhY3R1YWxseSBuZWNlc3Nhcnkgc2luY2UgdGhlIFVJRCBuZXZlciBjaGFuZ2VzLCBidXQgd2UgdXNlIHRoaXNcbiAgICAgICAgICogdG8gdmVyaWZ5IHRoZSBsaXN0ZW4gY29udHJhY3QgaXMgYWRoZXJlZCB0byBpbiB0ZXN0cy5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuY2hhbmdlTGlzdGVuZXIgPSBudWxsO1xuICAgIH1cbiAgICBnZXRUb2tlbigpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0aGlzLnRva2VuKTtcbiAgICB9XG4gICAgaW52YWxpZGF0ZVRva2VuKCkge31cbiAgICBzdGFydCh0LCBlKSB7XG4gICAgICAgIHRoaXMuY2hhbmdlTGlzdGVuZXIgPSBlLCBcbiAgICAgICAgLy8gRmlyZSB3aXRoIGluaXRpYWwgdXNlci5cbiAgICAgICAgdC5lbnF1ZXVlUmV0cnlhYmxlKCgoKSA9PiBlKHRoaXMudG9rZW4udXNlcikpKTtcbiAgICB9XG4gICAgc2h1dGRvd24oKSB7XG4gICAgICAgIHRoaXMuY2hhbmdlTGlzdGVuZXIgPSBudWxsO1xuICAgIH1cbn1cblxuY2xhc3MgeiB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLnQgPSB0LCBcbiAgICAgICAgLyoqIFRyYWNrcyB0aGUgY3VycmVudCBVc2VyLiAqL1xuICAgICAgICB0aGlzLmN1cnJlbnRVc2VyID0gUy5VTkFVVEhFTlRJQ0FURUQsIFxuICAgICAgICAvKipcbiAgICAgICAgICogQ291bnRlciB1c2VkIHRvIGRldGVjdCBpZiB0aGUgdG9rZW4gY2hhbmdlZCB3aGlsZSBhIGdldFRva2VuIHJlcXVlc3Qgd2FzXG4gICAgICAgICAqIG91dHN0YW5kaW5nLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5pID0gMCwgdGhpcy5mb3JjZVJlZnJlc2ggPSAhMSwgdGhpcy5hdXRoID0gbnVsbDtcbiAgICB9XG4gICAgc3RhcnQodCwgZSkge1xuICAgICAgICBsZXQgbiA9IHRoaXMuaTtcbiAgICAgICAgLy8gQSBjaGFuZ2UgbGlzdGVuZXIgdGhhdCBwcmV2ZW50cyBkb3VibGUtZmlyaW5nIGZvciB0aGUgc2FtZSB0b2tlbiBjaGFuZ2UuXG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IHQgPT4gdGhpcy5pICE9PSBuID8gKG4gPSB0aGlzLmksIGUodCkpIDogUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgIC8vIEEgcHJvbWlzZSB0aGF0IGNhbiBiZSB3YWl0ZWQgb24gdG8gYmxvY2sgb24gdGhlIG5leHQgdG9rZW4gY2hhbmdlLlxuICAgICAgICAvLyBUaGlzIHByb21pc2UgaXMgcmUtY3JlYXRlZCBhZnRlciBlYWNoIGNoYW5nZS5cbiAgICAgICAgICAgICAgICBsZXQgaSA9IG5ldyBqO1xuICAgICAgICB0aGlzLm8gPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmkrKywgdGhpcy5jdXJyZW50VXNlciA9IHRoaXMudSgpLCBpLnJlc29sdmUoKSwgaSA9IG5ldyBqLCB0LmVucXVldWVSZXRyeWFibGUoKCgpID0+IHModGhpcy5jdXJyZW50VXNlcikpKTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgciA9IGUgPT4ge1xuICAgICAgICAgICAgdC5lbnF1ZXVlUmV0cnlhYmxlKChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgayhcIkZpcmViYXNlQ3JlZGVudGlhbHNQcm92aWRlclwiLCBcIkF1dGggZGV0ZWN0ZWRcIiksIHRoaXMuYXV0aCA9IGUsIHRoaXMuYXV0aC5hZGRBdXRoVG9rZW5MaXN0ZW5lcih0aGlzLm8pLCBcbiAgICAgICAgICAgICAgICAvLyBDYWxsIHRoZSBjaGFuZ2UgbGlzdGVuZXIgaW5saW5lIHRvIGJsb2NrIG9uIHRoZSB1c2VyIGNoYW5nZS5cbiAgICAgICAgICAgICAgICBhd2FpdCBpLnByb21pc2UsIGF3YWl0IHModGhpcy5jdXJyZW50VXNlcik7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMudC5vbkluaXQoKHQgPT4gcih0KSkpLCBcbiAgICAgICAgLy8gT3VyIHVzZXJzIGNhbiBpbml0aWFsaXplIEF1dGggcmlnaHQgYWZ0ZXIgRmlyZXN0b3JlLCBzbyB3ZSBnaXZlIGl0XG4gICAgICAgIC8vIGEgY2hhbmNlIHRvIHJlZ2lzdGVyIGl0c2VsZiB3aXRoIHRoZSBjb21wb25lbnQgZnJhbWV3b3JrIGJlZm9yZSB3ZVxuICAgICAgICAvLyBkZXRlcm1pbmUgd2hldGhlciB0byBzdGFydCB1cCBpbiB1bmF1dGhlbnRpY2F0ZWQgbW9kZS5cbiAgICAgICAgc2V0VGltZW91dCgoKCkgPT4ge1xuICAgICAgICAgICAgaWYgKCF0aGlzLmF1dGgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy50LmdldEltbWVkaWF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiAhMFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHQgPyByKHQpIDogKFxuICAgICAgICAgICAgICAgIC8vIElmIGF1dGggaXMgc3RpbGwgbm90IGF2YWlsYWJsZSwgcHJvY2VlZCB3aXRoIGBudWxsYCB1c2VyXG4gICAgICAgICAgICAgICAgayhcIkZpcmViYXNlQ3JlZGVudGlhbHNQcm92aWRlclwiLCBcIkF1dGggbm90IHlldCBkZXRlY3RlZFwiKSwgaS5yZXNvbHZlKCksIGkgPSBuZXcgaik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pLCAwKSwgdC5lbnF1ZXVlUmV0cnlhYmxlKChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAvLyBJZiB3ZSBoYXZlIG5vdCByZWNlaXZlZCBhIHRva2VuLCB3YWl0IGZvciB0aGUgZmlyc3Qgb25lLlxuICAgICAgICAgICAgMCA9PT0gdGhpcy5pICYmIChhd2FpdCBpLnByb21pc2UsIGF3YWl0IHModGhpcy5jdXJyZW50VXNlcikpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGdldFRva2VuKCkge1xuICAgICAgICAvLyBUYWtlIG5vdGUgb2YgdGhlIGN1cnJlbnQgdmFsdWUgb2YgdGhlIHRva2VuQ291bnRlciBzbyB0aGF0IHRoaXMgbWV0aG9kXG4gICAgICAgIC8vIGNhbiBmYWlsICh3aXRoIGFuIEFCT1JURUQgZXJyb3IpIGlmIHRoZXJlIGlzIGEgdG9rZW4gY2hhbmdlIHdoaWxlIHRoZVxuICAgICAgICAvLyByZXF1ZXN0IGlzIG91dHN0YW5kaW5nLlxuICAgICAgICBjb25zdCB0ID0gdGhpcy5pLCBlID0gdGhpcy5mb3JjZVJlZnJlc2g7XG4gICAgICAgIHJldHVybiB0aGlzLmZvcmNlUmVmcmVzaCA9ICExLCB0aGlzLmF1dGggPyB0aGlzLmF1dGguZ2V0VG9rZW4oZSkudGhlbigoZSA9PiBcbiAgICAgICAgLy8gQ2FuY2VsIHRoZSByZXF1ZXN0IHNpbmNlIHRoZSB0b2tlbiBjaGFuZ2VkIHdoaWxlIHRoZSByZXF1ZXN0IHdhc1xuICAgICAgICAvLyBvdXRzdGFuZGluZyBzbyB0aGUgcmVzcG9uc2UgaXMgcG90ZW50aWFsbHkgZm9yIGEgcHJldmlvdXMgdXNlciAod2hpY2hcbiAgICAgICAgLy8gdXNlciwgd2UgY2FuJ3QgYmUgc3VyZSkuXG4gICAgICAgIHRoaXMuaSAhPT0gdCA/IChrKFwiRmlyZWJhc2VDcmVkZW50aWFsc1Byb3ZpZGVyXCIsIFwiZ2V0VG9rZW4gYWJvcnRlZCBkdWUgdG8gdG9rZW4gY2hhbmdlLlwiKSwgXG4gICAgICAgIHRoaXMuZ2V0VG9rZW4oKSkgOiBlID8gKEwoXCJzdHJpbmdcIiA9PSB0eXBlb2YgZS5hY2Nlc3NUb2tlbiksIG5ldyBRKGUuYWNjZXNzVG9rZW4sIHRoaXMuY3VycmVudFVzZXIpKSA6IG51bGwpKSA6IFByb21pc2UucmVzb2x2ZShudWxsKTtcbiAgICB9XG4gICAgaW52YWxpZGF0ZVRva2VuKCkge1xuICAgICAgICB0aGlzLmZvcmNlUmVmcmVzaCA9ICEwO1xuICAgIH1cbiAgICBzaHV0ZG93bigpIHtcbiAgICAgICAgdGhpcy5hdXRoICYmIHRoaXMuYXV0aC5yZW1vdmVBdXRoVG9rZW5MaXN0ZW5lcih0aGlzLm8pO1xuICAgIH1cbiAgICAvLyBBdXRoLmdldFVpZCgpIGNhbiByZXR1cm4gbnVsbCBldmVuIHdpdGggYSB1c2VyIGxvZ2dlZCBpbi4gSXQgaXMgYmVjYXVzZVxuICAgIC8vIGdldFVpZCgpIGlzIHN5bmNocm9ub3VzLCBidXQgdGhlIGF1dGggY29kZSBwb3B1bGF0aW5nIFVpZCBpcyBhc3luY2hyb25vdXMuXG4gICAgLy8gVGhpcyBtZXRob2Qgc2hvdWxkIG9ubHkgYmUgY2FsbGVkIGluIHRoZSBBdXRoVG9rZW5MaXN0ZW5lciBjYWxsYmFja1xuICAgIC8vIHRvIGd1YXJhbnRlZSB0byBnZXQgdGhlIGFjdHVhbCB1c2VyLlxuICAgIHUoKSB7XG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLmF1dGggJiYgdGhpcy5hdXRoLmdldFVpZCgpO1xuICAgICAgICByZXR1cm4gTChudWxsID09PSB0IHx8IFwic3RyaW5nXCIgPT0gdHlwZW9mIHQpLCBuZXcgUyh0KTtcbiAgICB9XG59XG5cbi8qXG4gKiBGaXJzdFBhcnR5VG9rZW4gcHJvdmlkZXMgYSBmcmVzaCB0b2tlbiBlYWNoIHRpbWUgaXRzIHZhbHVlXG4gKiBpcyByZXF1ZXN0ZWQsIGJlY2F1c2UgaWYgdGhlIHRva2VuIGlzIHRvbyBvbGQsIHJlcXVlc3RzIHdpbGwgYmUgcmVqZWN0ZWQuXG4gKiBUZWNobmljYWxseSB0aGlzIG1heSBubyBsb25nZXIgYmUgbmVjZXNzYXJ5IHNpbmNlIHRoZSBTREsgc2hvdWxkIGdyYWNlZnVsbHlcbiAqIHJlY292ZXIgZnJvbSB1bmF1dGhlbnRpY2F0ZWQgZXJyb3JzIChzZWUgYi8zMzE0NzgxOCBmb3IgY29udGV4dCksIGJ1dCBpdCdzXG4gKiBzYWZlciB0byBrZWVwIHRoZSBpbXBsZW1lbnRhdGlvbiBhcy1pcy5cbiAqLyBjbGFzcyBIIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHRoaXMuaCA9IHQsIHRoaXMubCA9IGUsIHRoaXMubSA9IG4sIHRoaXMudHlwZSA9IFwiRmlyc3RQYXJ0eVwiLCB0aGlzLnVzZXIgPSBTLkZJUlNUX1BBUlRZO1xuICAgIH1cbiAgICBnZXQgYXV0aEhlYWRlcnMoKSB7XG4gICAgICAgIGNvbnN0IHQgPSB7XG4gICAgICAgICAgICBcIlgtR29vZy1BdXRoVXNlclwiOiB0aGlzLmxcbiAgICAgICAgfSwgZSA9IHRoaXMuaC5hdXRoLmdldEF1dGhIZWFkZXJWYWx1ZUZvckZpcnN0UGFydHkoW10pO1xuICAgICAgICAvLyBVc2UgYXJyYXkgbm90YXRpb24gdG8gcHJldmVudCBtaW5pZmljYXRpb25cbiAgICAgICAgICAgICAgICByZXR1cm4gZSAmJiAodC5BdXRob3JpemF0aW9uID0gZSksIHRoaXMubSAmJiAodFtcIlgtR29vZy1JYW0tQXV0aG9yaXphdGlvbi1Ub2tlblwiXSA9IHRoaXMubSksIFxuICAgICAgICB0O1xuICAgIH1cbn1cblxuLypcbiAqIFByb3ZpZGVzIHVzZXIgY3JlZGVudGlhbHMgcmVxdWlyZWQgZm9yIHRoZSBGaXJlc3RvcmUgSmF2YVNjcmlwdCBTREtcbiAqIHRvIGF1dGhlbnRpY2F0ZSB0aGUgdXNlciwgdXNpbmcgdGVjaG5pcXVlIHRoYXQgaXMgb25seSBhdmFpbGFibGVcbiAqIHRvIGFwcGxpY2F0aW9ucyBob3N0ZWQgYnkgR29vZ2xlLlxuICovIGNsYXNzIEoge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4pIHtcbiAgICAgICAgdGhpcy5oID0gdCwgdGhpcy5sID0gZSwgdGhpcy5tID0gbjtcbiAgICB9XG4gICAgZ2V0VG9rZW4oKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobmV3IEgodGhpcy5oLCB0aGlzLmwsIHRoaXMubSkpO1xuICAgIH1cbiAgICBzdGFydCh0LCBlKSB7XG4gICAgICAgIC8vIEZpcmUgd2l0aCBpbml0aWFsIHVpZC5cbiAgICAgICAgdC5lbnF1ZXVlUmV0cnlhYmxlKCgoKSA9PiBlKFMuRklSU1RfUEFSVFkpKSk7XG4gICAgfVxuICAgIHNodXRkb3duKCkge31cbiAgICBpbnZhbGlkYXRlVG9rZW4oKSB7fVxufVxuXG4vKipcbiAqIEJ1aWxkcyBhIENyZWRlbnRpYWxzUHJvdmlkZXIgZGVwZW5kaW5nIG9uIHRoZSB0eXBlIG9mXG4gKiB0aGUgY3JlZGVudGlhbHMgcGFzc2VkIGluLlxuICovXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBgTGlzdGVuU2VxdWVuY2VgIGlzIGEgbW9ub3RvbmljIHNlcXVlbmNlLiBJdCBpcyBpbml0aWFsaXplZCB3aXRoIGEgbWluaW11bSB2YWx1ZSB0b1xuICogZXhjZWVkLiBBbGwgc3Vic2VxdWVudCBjYWxscyB0byBuZXh0IHdpbGwgcmV0dXJuIGluY3JlYXNpbmcgdmFsdWVzLiBJZiBwcm92aWRlZCB3aXRoIGFcbiAqIGBTZXF1ZW5jZU51bWJlclN5bmNlcmAsIGl0IHdpbGwgYWRkaXRpb25hbGx5IGJ1bXAgaXRzIG5leHQgdmFsdWUgd2hlbiB0b2xkIG9mIGEgbmV3IHZhbHVlLCBhc1xuICogd2VsbCBhcyB3cml0ZSBvdXQgc2VxdWVuY2UgbnVtYmVycyB0aGF0IGl0IHByb2R1Y2VzIHZpYSBgbmV4dCgpYC5cbiAqL1xuY2xhc3MgWSB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLnByZXZpb3VzVmFsdWUgPSB0LCBlICYmIChlLnNlcXVlbmNlTnVtYmVySGFuZGxlciA9IHQgPT4gdGhpcy5nKHQpLCB0aGlzLnAgPSB0ID0+IGUud3JpdGVTZXF1ZW5jZU51bWJlcih0KSk7XG4gICAgfVxuICAgIGcodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcmV2aW91c1ZhbHVlID0gTWF0aC5tYXgodCwgdGhpcy5wcmV2aW91c1ZhbHVlKSwgdGhpcy5wcmV2aW91c1ZhbHVlO1xuICAgIH1cbiAgICBuZXh0KCkge1xuICAgICAgICBjb25zdCB0ID0gKyt0aGlzLnByZXZpb3VzVmFsdWU7XG4gICAgICAgIHJldHVybiB0aGlzLnAgJiYgdGhpcy5wKHQpLCB0O1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogR2VuZXJhdGVzIGBuQnl0ZXNgIG9mIHJhbmRvbSBieXRlcy5cbiAqXG4gKiBJZiBgbkJ5dGVzIDwgMGAgLCBhbiBlcnJvciB3aWxsIGJlIHRocm93bi5cbiAqL1xuZnVuY3Rpb24gWCh0KSB7XG4gICAgLy8gUG9seWZpbGxzIGZvciBJRSBhbmQgV2ViV29ya2VyIGJ5IHVzaW5nIGBzZWxmYCBhbmQgYG1zQ3J5cHRvYCB3aGVuIGBjcnlwdG9gIGlzIG5vdCBhdmFpbGFibGUuXG4gICAgY29uc3QgZSA9IFxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2Ygc2VsZiAmJiAoc2VsZi5jcnlwdG8gfHwgc2VsZi5tc0NyeXB0byksIG4gPSBuZXcgVWludDhBcnJheSh0KTtcbiAgICBpZiAoZSAmJiBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIGUuZ2V0UmFuZG9tVmFsdWVzKSBlLmdldFJhbmRvbVZhbHVlcyhuKTsgZWxzZSBcbiAgICAvLyBGYWxscyBiYWNrIHRvIE1hdGgucmFuZG9tXG4gICAgZm9yIChsZXQgZSA9IDA7IGUgPCB0OyBlKyspIG5bZV0gPSBNYXRoLmZsb29yKDI1NiAqIE1hdGgucmFuZG9tKCkpO1xuICAgIHJldHVybiBuO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBZLlQgPSAtMTtcblxuY2xhc3MgWiB7XG4gICAgc3RhdGljIEkoKSB7XG4gICAgICAgIC8vIEFscGhhbnVtZXJpYyBjaGFyYWN0ZXJzXG4gICAgICAgIGNvbnN0IHQgPSBcIkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5XCIsIGUgPSBNYXRoLmZsb29yKDI1NiAvIHQubGVuZ3RoKSAqIHQubGVuZ3RoO1xuICAgICAgICAvLyBUaGUgbGFyZ2VzdCBieXRlIHZhbHVlIHRoYXQgaXMgYSBtdWx0aXBsZSBvZiBgY2hhci5sZW5ndGhgLlxuICAgICAgICAgICAgICAgIGxldCBuID0gXCJcIjtcbiAgICAgICAgZm9yICg7bi5sZW5ndGggPCAyMDsgKSB7XG4gICAgICAgICAgICBjb25zdCBzID0gWCg0MCk7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHMubGVuZ3RoOyArK2kpIFxuICAgICAgICAgICAgLy8gT25seSBhY2NlcHQgdmFsdWVzIHRoYXQgYXJlIFswLCBtYXhNdWx0aXBsZSksIHRoaXMgZW5zdXJlcyB0aGV5IGNhblxuICAgICAgICAgICAgLy8gYmUgZXZlbmx5IG1hcHBlZCB0byBpbmRpY2VzIG9mIGBjaGFyc2AgdmlhIGEgbW9kdWxvIG9wZXJhdGlvbi5cbiAgICAgICAgICAgIG4ubGVuZ3RoIDwgMjAgJiYgc1tpXSA8IGUgJiYgKG4gKz0gdC5jaGFyQXQoc1tpXSAlIHQubGVuZ3RoKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG47XG4gICAgfVxufVxuXG5mdW5jdGlvbiB0dCh0LCBlKSB7XG4gICAgcmV0dXJuIHQgPCBlID8gLTEgOiB0ID4gZSA/IDEgOiAwO1xufVxuXG4vKiogSGVscGVyIHRvIGNvbXBhcmUgYXJyYXlzIHVzaW5nIGlzRXF1YWwoKS4gKi8gZnVuY3Rpb24gZXQodCwgZSwgbikge1xuICAgIHJldHVybiB0Lmxlbmd0aCA9PT0gZS5sZW5ndGggJiYgdC5ldmVyeSgoKHQsIHMpID0+IG4odCwgZVtzXSkpKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBpbW1lZGlhdGUgbGV4aWNvZ3JhcGhpY2FsbHktZm9sbG93aW5nIHN0cmluZy4gVGhpcyBpcyB1c2VmdWwgdG9cbiAqIGNvbnN0cnVjdCBhbiBpbmNsdXNpdmUgcmFuZ2UgZm9yIGluZGV4ZWRkYiBpdGVyYXRvcnMuXG4gKi8gZnVuY3Rpb24gbnQodCkge1xuICAgIC8vIFJldHVybiB0aGUgaW5wdXQgc3RyaW5nLCB3aXRoIGFuIGFkZGl0aW9uYWwgTlVMIGJ5dGUgYXBwZW5kZWQuXG4gICAgcmV0dXJuIHQgKyBcIlxcMFwiO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLy8gVGhlIGVhcmxpZXN0IGRhdGUgc3VwcG9ydGVkIGJ5IEZpcmVzdG9yZSB0aW1lc3RhbXBzICgwMDAxLTAxLTAxVDAwOjAwOjAwWikuXG4vKipcbiAqIEEgYFRpbWVzdGFtcGAgcmVwcmVzZW50cyBhIHBvaW50IGluIHRpbWUgaW5kZXBlbmRlbnQgb2YgYW55IHRpbWUgem9uZSBvclxuICogY2FsZW5kYXIsIHJlcHJlc2VudGVkIGFzIHNlY29uZHMgYW5kIGZyYWN0aW9ucyBvZiBzZWNvbmRzIGF0IG5hbm9zZWNvbmRcbiAqIHJlc29sdXRpb24gaW4gVVRDIEVwb2NoIHRpbWUuXG4gKlxuICogSXQgaXMgZW5jb2RlZCB1c2luZyB0aGUgUHJvbGVwdGljIEdyZWdvcmlhbiBDYWxlbmRhciB3aGljaCBleHRlbmRzIHRoZVxuICogR3JlZ29yaWFuIGNhbGVuZGFyIGJhY2t3YXJkcyB0byB5ZWFyIG9uZS4gSXQgaXMgZW5jb2RlZCBhc3N1bWluZyBhbGwgbWludXRlc1xuICogYXJlIDYwIHNlY29uZHMgbG9uZywgaS5lLiBsZWFwIHNlY29uZHMgYXJlIFwic21lYXJlZFwiIHNvIHRoYXQgbm8gbGVhcCBzZWNvbmRcbiAqIHRhYmxlIGlzIG5lZWRlZCBmb3IgaW50ZXJwcmV0YXRpb24uIFJhbmdlIGlzIGZyb20gMDAwMS0wMS0wMVQwMDowMDowMFogdG9cbiAqIDk5OTktMTItMzFUMjM6NTk6NTkuOTk5OTk5OTk5Wi5cbiAqXG4gKiBGb3IgZXhhbXBsZXMgYW5kIGZ1cnRoZXIgc3BlY2lmaWNhdGlvbnMsIHJlZmVyIHRvIHRoZVxuICoge0BsaW5rIGh0dHBzOi8vZ2l0aHViLmNvbS9nb29nbGUvcHJvdG9idWYvYmxvYi9tYXN0ZXIvc3JjL2dvb2dsZS9wcm90b2J1Zi90aW1lc3RhbXAucHJvdG8gfCBUaW1lc3RhbXAgZGVmaW5pdGlvbn0uXG4gKi9cbmNsYXNzIHN0IHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IHRpbWVzdGFtcC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBzZWNvbmRzIC0gVGhlIG51bWJlciBvZiBzZWNvbmRzIG9mIFVUQyB0aW1lIHNpbmNlIFVuaXggZXBvY2hcbiAgICAgKiAgICAgMTk3MC0wMS0wMVQwMDowMDowMFouIE11c3QgYmUgZnJvbSAwMDAxLTAxLTAxVDAwOjAwOjAwWiB0b1xuICAgICAqICAgICA5OTk5LTEyLTMxVDIzOjU5OjU5WiBpbmNsdXNpdmUuXG4gICAgICogQHBhcmFtIG5hbm9zZWNvbmRzIC0gVGhlIG5vbi1uZWdhdGl2ZSBmcmFjdGlvbnMgb2YgYSBzZWNvbmQgYXQgbmFub3NlY29uZFxuICAgICAqICAgICByZXNvbHV0aW9uLiBOZWdhdGl2ZSBzZWNvbmQgdmFsdWVzIHdpdGggZnJhY3Rpb25zIG11c3Qgc3RpbGwgaGF2ZVxuICAgICAqICAgICBub24tbmVnYXRpdmUgbmFub3NlY29uZHMgdmFsdWVzIHRoYXQgY291bnQgZm9yd2FyZCBpbiB0aW1lLiBNdXN0IGJlXG4gICAgICogICAgIGZyb20gMCB0byA5OTksOTk5LDk5OSBpbmNsdXNpdmUuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoXG4gICAgLyoqXG4gICAgICogVGhlIG51bWJlciBvZiBzZWNvbmRzIG9mIFVUQyB0aW1lIHNpbmNlIFVuaXggZXBvY2ggMTk3MC0wMS0wMVQwMDowMDowMFouXG4gICAgICovXG4gICAgdCwgXG4gICAgLyoqXG4gICAgICogVGhlIGZyYWN0aW9ucyBvZiBhIHNlY29uZCBhdCBuYW5vc2Vjb25kIHJlc29sdXRpb24uKlxuICAgICAqL1xuICAgIGUpIHtcbiAgICAgICAgaWYgKHRoaXMuc2Vjb25kcyA9IHQsIHRoaXMubmFub3NlY29uZHMgPSBlLCBlIDwgMCkgdGhyb3cgbmV3IEsocS5JTlZBTElEX0FSR1VNRU5ULCBcIlRpbWVzdGFtcCBuYW5vc2Vjb25kcyBvdXQgb2YgcmFuZ2U6IFwiICsgZSk7XG4gICAgICAgIGlmIChlID49IDFlOSkgdGhyb3cgbmV3IEsocS5JTlZBTElEX0FSR1VNRU5ULCBcIlRpbWVzdGFtcCBuYW5vc2Vjb25kcyBvdXQgb2YgcmFuZ2U6IFwiICsgZSk7XG4gICAgICAgIGlmICh0IDwgLTYyMTM1NTk2ODAwKSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIFwiVGltZXN0YW1wIHNlY29uZHMgb3V0IG9mIHJhbmdlOiBcIiArIHQpO1xuICAgICAgICAvLyBUaGlzIHdpbGwgYnJlYWsgaW4gdGhlIHllYXIgMTAsMDAwLlxuICAgICAgICAgICAgICAgIGlmICh0ID49IDI1MzQwMjMwMDgwMCkgdGhyb3cgbmV3IEsocS5JTlZBTElEX0FSR1VNRU5ULCBcIlRpbWVzdGFtcCBzZWNvbmRzIG91dCBvZiByYW5nZTogXCIgKyB0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyB0aW1lc3RhbXAgd2l0aCB0aGUgY3VycmVudCBkYXRlLCB3aXRoIG1pbGxpc2Vjb25kIHByZWNpc2lvbi5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIGEgbmV3IHRpbWVzdGFtcCByZXByZXNlbnRpbmcgdGhlIGN1cnJlbnQgZGF0ZS5cbiAgICAgKi8gICAgc3RhdGljIG5vdygpIHtcbiAgICAgICAgcmV0dXJuIHN0LmZyb21NaWxsaXMoRGF0ZS5ub3coKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgdGltZXN0YW1wIGZyb20gdGhlIGdpdmVuIGRhdGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZGF0ZSAtIFRoZSBkYXRlIHRvIGluaXRpYWxpemUgdGhlIGBUaW1lc3RhbXBgIGZyb20uXG4gICAgICogQHJldHVybnMgQSBuZXcgYFRpbWVzdGFtcGAgcmVwcmVzZW50aW5nIHRoZSBzYW1lIHBvaW50IGluIHRpbWUgYXMgdGhlIGdpdmVuXG4gICAgICogICAgIGRhdGUuXG4gICAgICovICAgIHN0YXRpYyBmcm9tRGF0ZSh0KSB7XG4gICAgICAgIHJldHVybiBzdC5mcm9tTWlsbGlzKHQuZ2V0VGltZSgpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyB0aW1lc3RhbXAgZnJvbSB0aGUgZ2l2ZW4gbnVtYmVyIG9mIG1pbGxpc2Vjb25kcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBtaWxsaXNlY29uZHMgLSBOdW1iZXIgb2YgbWlsbGlzZWNvbmRzIHNpbmNlIFVuaXggZXBvY2hcbiAgICAgKiAgICAgMTk3MC0wMS0wMVQwMDowMDowMFouXG4gICAgICogQHJldHVybnMgQSBuZXcgYFRpbWVzdGFtcGAgcmVwcmVzZW50aW5nIHRoZSBzYW1lIHBvaW50IGluIHRpbWUgYXMgdGhlIGdpdmVuXG4gICAgICogICAgIG51bWJlciBvZiBtaWxsaXNlY29uZHMuXG4gICAgICovICAgIHN0YXRpYyBmcm9tTWlsbGlzKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IE1hdGguZmxvb3IodCAvIDFlMyksIG4gPSBNYXRoLmZsb29yKDFlNiAqICh0IC0gMWUzICogZSkpO1xuICAgICAgICByZXR1cm4gbmV3IHN0KGUsIG4pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0cyBhIGBUaW1lc3RhbXBgIHRvIGEgSmF2YVNjcmlwdCBgRGF0ZWAgb2JqZWN0LiBUaGlzIGNvbnZlcnNpb25cbiAgICAgKiBjYXVzZXMgYSBsb3NzIG9mIHByZWNpc2lvbiBzaW5jZSBgRGF0ZWAgb2JqZWN0cyBvbmx5IHN1cHBvcnQgbWlsbGlzZWNvbmRcbiAgICAgKiBwcmVjaXNpb24uXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBKYXZhU2NyaXB0IGBEYXRlYCBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSBzYW1lIHBvaW50IGluIHRpbWUgYXNcbiAgICAgKiAgICAgdGhpcyBgVGltZXN0YW1wYCwgd2l0aCBtaWxsaXNlY29uZCBwcmVjaXNpb24uXG4gICAgICovICAgIHRvRGF0ZSgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBEYXRlKHRoaXMudG9NaWxsaXMoKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENvbnZlcnRzIGEgYFRpbWVzdGFtcGAgdG8gYSBudW1lcmljIHRpbWVzdGFtcCAoaW4gbWlsbGlzZWNvbmRzIHNpbmNlXG4gICAgICogZXBvY2gpLiBUaGlzIG9wZXJhdGlvbiBjYXVzZXMgYSBsb3NzIG9mIHByZWNpc2lvbi5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIFRoZSBwb2ludCBpbiB0aW1lIGNvcnJlc3BvbmRpbmcgdG8gdGhpcyB0aW1lc3RhbXAsIHJlcHJlc2VudGVkIGFzXG4gICAgICogICAgIHRoZSBudW1iZXIgb2YgbWlsbGlzZWNvbmRzIHNpbmNlIFVuaXggZXBvY2ggMTk3MC0wMS0wMVQwMDowMDowMFouXG4gICAgICovICAgIHRvTWlsbGlzKCkge1xuICAgICAgICByZXR1cm4gMWUzICogdGhpcy5zZWNvbmRzICsgdGhpcy5uYW5vc2Vjb25kcyAvIDFlNjtcbiAgICB9XG4gICAgX2NvbXBhcmVUbyh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNlY29uZHMgPT09IHQuc2Vjb25kcyA/IHR0KHRoaXMubmFub3NlY29uZHMsIHQubmFub3NlY29uZHMpIDogdHQodGhpcy5zZWNvbmRzLCB0LnNlY29uZHMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhpcyBgVGltZXN0YW1wYCBpcyBlcXVhbCB0byB0aGUgcHJvdmlkZWQgb25lLlxuICAgICAqXG4gICAgICogQHBhcmFtIG90aGVyIC0gVGhlIGBUaW1lc3RhbXBgIHRvIGNvbXBhcmUgYWdhaW5zdC5cbiAgICAgKiBAcmV0dXJucyB0cnVlIGlmIHRoaXMgYFRpbWVzdGFtcGAgaXMgZXF1YWwgdG8gdGhlIHByb3ZpZGVkIG9uZS5cbiAgICAgKi8gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIHJldHVybiB0LnNlY29uZHMgPT09IHRoaXMuc2Vjb25kcyAmJiB0Lm5hbm9zZWNvbmRzID09PSB0aGlzLm5hbm9zZWNvbmRzO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyBhIHRleHR1YWwgcmVwcmVzZW50YXRpb24gb2YgdGhpcyBgVGltZXN0YW1wYC4gKi8gICAgdG9TdHJpbmcoKSB7XG4gICAgICAgIHJldHVybiBcIlRpbWVzdGFtcChzZWNvbmRzPVwiICsgdGhpcy5zZWNvbmRzICsgXCIsIG5hbm9zZWNvbmRzPVwiICsgdGhpcy5uYW5vc2Vjb25kcyArIFwiKVwiO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyBhIEpTT04tc2VyaWFsaXphYmxlIHJlcHJlc2VudGF0aW9uIG9mIHRoaXMgYFRpbWVzdGFtcGAuICovICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHNlY29uZHM6IHRoaXMuc2Vjb25kcyxcbiAgICAgICAgICAgIG5hbm9zZWNvbmRzOiB0aGlzLm5hbm9zZWNvbmRzXG4gICAgICAgIH07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENvbnZlcnRzIHRoaXMgb2JqZWN0IHRvIGEgcHJpbWl0aXZlIHN0cmluZywgd2hpY2ggYWxsb3dzIGBUaW1lc3RhbXBgIG9iamVjdHNcbiAgICAgKiB0byBiZSBjb21wYXJlZCB1c2luZyB0aGUgYD5gLCBgPD1gLCBgPj1gIGFuZCBgPmAgb3BlcmF0b3JzLlxuICAgICAqLyAgICB2YWx1ZU9mKCkge1xuICAgICAgICAvLyBUaGlzIG1ldGhvZCByZXR1cm5zIGEgc3RyaW5nIG9mIHRoZSBmb3JtIDxzZWNvbmRzPi48bmFub3NlY29uZHM+IHdoZXJlXG4gICAgICAgIC8vIDxzZWNvbmRzPiBpcyB0cmFuc2xhdGVkIHRvIGhhdmUgYSBub24tbmVnYXRpdmUgdmFsdWUgYW5kIGJvdGggPHNlY29uZHM+XG4gICAgICAgIC8vIGFuZCA8bmFub3NlY29uZHM+IGFyZSBsZWZ0LXBhZGRlZCB3aXRoIHplcm9lcyB0byBiZSBhIGNvbnNpc3RlbnQgbGVuZ3RoLlxuICAgICAgICAvLyBTdHJpbmdzIHdpdGggdGhpcyBmb3JtYXQgdGhlbiBoYXZlIGEgbGV4aW9ncmFwaGljYWwgb3JkZXJpbmcgdGhhdCBtYXRjaGVzXG4gICAgICAgIC8vIHRoZSBleHBlY3RlZCBvcmRlcmluZy4gVGhlIDxzZWNvbmRzPiB0cmFuc2xhdGlvbiBpcyBkb25lIHRvIGF2b2lkIGhhdmluZ1xuICAgICAgICAvLyBhIGxlYWRpbmcgbmVnYXRpdmUgc2lnbiAoaS5lLiBhIGxlYWRpbmcgJy0nIGNoYXJhY3RlcikgaW4gaXRzIHN0cmluZ1xuICAgICAgICAvLyByZXByZXNlbnRhdGlvbiwgd2hpY2ggd291bGQgYWZmZWN0IGl0cyBsZXhpb2dyYXBoaWNhbCBvcmRlcmluZy5cbiAgICAgICAgY29uc3QgdCA9IHRoaXMuc2Vjb25kcyAtIC02MjEzNTU5NjgwMDtcbiAgICAgICAgLy8gTm90ZTogVXAgdG8gMTIgZGVjaW1hbCBkaWdpdHMgYXJlIHJlcXVpcmVkIHRvIHJlcHJlc2VudCBhbGwgdmFsaWRcbiAgICAgICAgLy8gJ3NlY29uZHMnIHZhbHVlcy5cbiAgICAgICAgICAgICAgICByZXR1cm4gU3RyaW5nKHQpLnBhZFN0YXJ0KDEyLCBcIjBcIikgKyBcIi5cIiArIFN0cmluZyh0aGlzLm5hbm9zZWNvbmRzKS5wYWRTdGFydCg5LCBcIjBcIik7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBIHZlcnNpb24gb2YgYSBkb2N1bWVudCBpbiBGaXJlc3RvcmUuIFRoaXMgY29ycmVzcG9uZHMgdG8gdGhlIHZlcnNpb25cbiAqIHRpbWVzdGFtcCwgc3VjaCBhcyB1cGRhdGVfdGltZSBvciByZWFkX3RpbWUuXG4gKi8gY2xhc3MgaXQge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy50aW1lc3RhbXAgPSB0O1xuICAgIH1cbiAgICBzdGF0aWMgZnJvbVRpbWVzdGFtcCh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgaXQodCk7XG4gICAgfVxuICAgIHN0YXRpYyBtaW4oKSB7XG4gICAgICAgIHJldHVybiBuZXcgaXQobmV3IHN0KDAsIDApKTtcbiAgICB9XG4gICAgY29tcGFyZVRvKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudGltZXN0YW1wLl9jb21wYXJlVG8odC50aW1lc3RhbXApO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudGltZXN0YW1wLmlzRXF1YWwodC50aW1lc3RhbXApO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyBhIG51bWJlciByZXByZXNlbnRhdGlvbiBvZiB0aGUgdmVyc2lvbiBmb3IgdXNlIGluIHNwZWMgdGVzdHMuICovICAgIHRvTWljcm9zZWNvbmRzKCkge1xuICAgICAgICAvLyBDb252ZXJ0IHRvIG1pY3Jvc2Vjb25kcy5cbiAgICAgICAgcmV0dXJuIDFlNiAqIHRoaXMudGltZXN0YW1wLnNlY29uZHMgKyB0aGlzLnRpbWVzdGFtcC5uYW5vc2Vjb25kcyAvIDFlMztcbiAgICB9XG4gICAgdG9TdHJpbmcoKSB7XG4gICAgICAgIHJldHVybiBcIlNuYXBzaG90VmVyc2lvbihcIiArIHRoaXMudGltZXN0YW1wLnRvU3RyaW5nKCkgKyBcIilcIjtcbiAgICB9XG4gICAgdG9UaW1lc3RhbXAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRpbWVzdGFtcDtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGZ1bmN0aW9uIHJ0KHQpIHtcbiAgICBsZXQgZSA9IDA7XG4gICAgZm9yIChjb25zdCBuIGluIHQpIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0LCBuKSAmJiBlKys7XG4gICAgcmV0dXJuIGU7XG59XG5cbmZ1bmN0aW9uIG90KHQsIGUpIHtcbiAgICBmb3IgKGNvbnN0IG4gaW4gdCkgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHQsIG4pICYmIGUobiwgdFtuXSk7XG59XG5cbmZ1bmN0aW9uIGF0KHQpIHtcbiAgICBmb3IgKGNvbnN0IGUgaW4gdCkgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0LCBlKSkgcmV0dXJuICExO1xuICAgIHJldHVybiAhMDtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUGF0aCByZXByZXNlbnRzIGFuIG9yZGVyZWQgc2VxdWVuY2Ugb2Ygc3RyaW5nIHNlZ21lbnRzLlxuICovXG5jbGFzcyBjdCB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbikge1xuICAgICAgICB2b2lkIDAgPT09IGUgPyBlID0gMCA6IGUgPiB0Lmxlbmd0aCAmJiBNKCksIHZvaWQgMCA9PT0gbiA/IG4gPSB0Lmxlbmd0aCAtIGUgOiBuID4gdC5sZW5ndGggLSBlICYmIE0oKSwgXG4gICAgICAgIHRoaXMuc2VnbWVudHMgPSB0LCB0aGlzLm9mZnNldCA9IGUsIHRoaXMubGVuID0gbjtcbiAgICB9XG4gICAgZ2V0IGxlbmd0aCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubGVuO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgcmV0dXJuIDAgPT09IGN0LmNvbXBhcmF0b3IodGhpcywgdCk7XG4gICAgfVxuICAgIGNoaWxkKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuc2VnbWVudHMuc2xpY2UodGhpcy5vZmZzZXQsIHRoaXMubGltaXQoKSk7XG4gICAgICAgIHJldHVybiB0IGluc3RhbmNlb2YgY3QgPyB0LmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgZS5wdXNoKHQpO1xuICAgICAgICB9KSkgOiBlLnB1c2godCksIHRoaXMuY29uc3RydWN0KGUpO1xuICAgIH1cbiAgICAvKiogVGhlIGluZGV4IG9mIG9uZSBwYXN0IHRoZSBsYXN0IHNlZ21lbnQgb2YgdGhlIHBhdGguICovICAgIGxpbWl0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5vZmZzZXQgKyB0aGlzLmxlbmd0aDtcbiAgICB9XG4gICAgcG9wRmlyc3QodCkge1xuICAgICAgICByZXR1cm4gdCA9IHZvaWQgMCA9PT0gdCA/IDEgOiB0LCB0aGlzLmNvbnN0cnVjdCh0aGlzLnNlZ21lbnRzLCB0aGlzLm9mZnNldCArIHQsIHRoaXMubGVuZ3RoIC0gdCk7XG4gICAgfVxuICAgIHBvcExhc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnN0cnVjdCh0aGlzLnNlZ21lbnRzLCB0aGlzLm9mZnNldCwgdGhpcy5sZW5ndGggLSAxKTtcbiAgICB9XG4gICAgZmlyc3RTZWdtZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zZWdtZW50c1t0aGlzLm9mZnNldF07XG4gICAgfVxuICAgIGxhc3RTZWdtZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXQodGhpcy5sZW5ndGggLSAxKTtcbiAgICB9XG4gICAgZ2V0KHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VnbWVudHNbdGhpcy5vZmZzZXQgKyB0XTtcbiAgICB9XG4gICAgaXNFbXB0eSgpIHtcbiAgICAgICAgcmV0dXJuIDAgPT09IHRoaXMubGVuZ3RoO1xuICAgIH1cbiAgICBpc1ByZWZpeE9mKHQpIHtcbiAgICAgICAgaWYgKHQubGVuZ3RoIDwgdGhpcy5sZW5ndGgpIHJldHVybiAhMTtcbiAgICAgICAgZm9yIChsZXQgZSA9IDA7IGUgPCB0aGlzLmxlbmd0aDsgZSsrKSBpZiAodGhpcy5nZXQoZSkgIT09IHQuZ2V0KGUpKSByZXR1cm4gITE7XG4gICAgICAgIHJldHVybiAhMDtcbiAgICB9XG4gICAgaXNJbW1lZGlhdGVQYXJlbnRPZih0KSB7XG4gICAgICAgIGlmICh0aGlzLmxlbmd0aCArIDEgIT09IHQubGVuZ3RoKSByZXR1cm4gITE7XG4gICAgICAgIGZvciAobGV0IGUgPSAwOyBlIDwgdGhpcy5sZW5ndGg7IGUrKykgaWYgKHRoaXMuZ2V0KGUpICE9PSB0LmdldChlKSkgcmV0dXJuICExO1xuICAgICAgICByZXR1cm4gITA7XG4gICAgfVxuICAgIGZvckVhY2godCkge1xuICAgICAgICBmb3IgKGxldCBlID0gdGhpcy5vZmZzZXQsIG4gPSB0aGlzLmxpbWl0KCk7IGUgPCBuOyBlKyspIHQodGhpcy5zZWdtZW50c1tlXSk7XG4gICAgfVxuICAgIHRvQXJyYXkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNlZ21lbnRzLnNsaWNlKHRoaXMub2Zmc2V0LCB0aGlzLmxpbWl0KCkpO1xuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyYXRvcih0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBNYXRoLm1pbih0Lmxlbmd0aCwgZS5sZW5ndGgpO1xuICAgICAgICBmb3IgKGxldCBzID0gMDsgcyA8IG47IHMrKykge1xuICAgICAgICAgICAgY29uc3QgbiA9IHQuZ2V0KHMpLCBpID0gZS5nZXQocyk7XG4gICAgICAgICAgICBpZiAobiA8IGkpIHJldHVybiAtMTtcbiAgICAgICAgICAgIGlmIChuID4gaSkgcmV0dXJuIDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHQubGVuZ3RoIDwgZS5sZW5ndGggPyAtMSA6IHQubGVuZ3RoID4gZS5sZW5ndGggPyAxIDogMDtcbiAgICB9XG59XG5cbi8qKlxuICogQSBzbGFzaC1zZXBhcmF0ZWQgcGF0aCBmb3IgbmF2aWdhdGluZyByZXNvdXJjZXMgKGRvY3VtZW50cyBhbmQgY29sbGVjdGlvbnMpXG4gKiB3aXRoaW4gRmlyZXN0b3JlLlxuICpcbiAqIEBpbnRlcm5hbFxuICovIGNsYXNzIHV0IGV4dGVuZHMgY3Qge1xuICAgIGNvbnN0cnVjdCh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiBuZXcgdXQodCwgZSwgbik7XG4gICAgfVxuICAgIGNhbm9uaWNhbFN0cmluZygpIHtcbiAgICAgICAgLy8gTk9URTogVGhlIGNsaWVudCBpcyBpZ25vcmFudCBvZiBhbnkgcGF0aCBzZWdtZW50cyBjb250YWluaW5nIGVzY2FwZVxuICAgICAgICAvLyBzZXF1ZW5jZXMgKGUuZy4gX19pZDEyM19fKSBhbmQganVzdCBwYXNzZXMgdGhlbSB0aHJvdWdoIHJhdyAodGhleSBleGlzdFxuICAgICAgICAvLyBmb3IgbGVnYWN5IHJlYXNvbnMgYW5kIHNob3VsZCBub3QgYmUgdXNlZCBmcmVxdWVudGx5KS5cbiAgICAgICAgcmV0dXJuIHRoaXMudG9BcnJheSgpLmpvaW4oXCIvXCIpO1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2Fub25pY2FsU3RyaW5nKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSByZXNvdXJjZSBwYXRoIGZyb20gdGhlIGdpdmVuIHNsYXNoLWRlbGltaXRlZCBzdHJpbmcuIElmIG11bHRpcGxlXG4gICAgICogYXJndW1lbnRzIGFyZSBwcm92aWRlZCwgYWxsIGNvbXBvbmVudHMgYXJlIGNvbWJpbmVkLiBMZWFkaW5nIGFuZCB0cmFpbGluZ1xuICAgICAqIHNsYXNoZXMgZnJvbSBhbGwgY29tcG9uZW50cyBhcmUgaWdub3JlZC5cbiAgICAgKi8gICAgc3RhdGljIGZyb21TdHJpbmcoLi4udCkge1xuICAgICAgICAvLyBOT1RFOiBUaGUgY2xpZW50IGlzIGlnbm9yYW50IG9mIGFueSBwYXRoIHNlZ21lbnRzIGNvbnRhaW5pbmcgZXNjYXBlXG4gICAgICAgIC8vIHNlcXVlbmNlcyAoZS5nLiBfX2lkMTIzX18pIGFuZCBqdXN0IHBhc3NlcyB0aGVtIHRocm91Z2ggcmF3ICh0aGV5IGV4aXN0XG4gICAgICAgIC8vIGZvciBsZWdhY3kgcmVhc29ucyBhbmQgc2hvdWxkIG5vdCBiZSB1c2VkIGZyZXF1ZW50bHkpLlxuICAgICAgICBjb25zdCBlID0gW107XG4gICAgICAgIGZvciAoY29uc3QgbiBvZiB0KSB7XG4gICAgICAgICAgICBpZiAobi5pbmRleE9mKFwiLy9cIikgPj0gMCkgdGhyb3cgbmV3IEsocS5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBzZWdtZW50ICgke259KS4gUGF0aHMgbXVzdCBub3QgY29udGFpbiAvLyBpbiB0aGVtLmApO1xuICAgICAgICAgICAgLy8gU3RyaXAgbGVhZGluZyBhbmQgdHJhbGluZyBzbGFzaGVkLlxuICAgICAgICAgICAgICAgICAgICAgICAgZS5wdXNoKC4uLm4uc3BsaXQoXCIvXCIpLmZpbHRlcigodCA9PiB0Lmxlbmd0aCA+IDApKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyB1dChlKTtcbiAgICB9XG4gICAgc3RhdGljIGVtcHR5UGF0aCgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyB1dChbXSk7XG4gICAgfVxufVxuXG5jb25zdCBodCA9IC9eW19hLXpBLVpdW19hLXpBLVowLTldKiQvO1xuXG4vKipcbiAqIEEgZG90LXNlcGFyYXRlZCBwYXRoIGZvciBuYXZpZ2F0aW5nIHN1Yi1vYmplY3RzIHdpdGhpbiBhIGRvY3VtZW50LlxuICogQGludGVybmFsXG4gKi8gY2xhc3MgbHQgZXh0ZW5kcyBjdCB7XG4gICAgY29uc3RydWN0KHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIG5ldyBsdCh0LCBlLCBuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHRoZSBzdHJpbmcgY291bGQgYmUgdXNlZCBhcyBhIHNlZ21lbnQgaW4gYSBmaWVsZCBwYXRoXG4gICAgICogd2l0aG91dCBlc2NhcGluZy5cbiAgICAgKi8gICAgc3RhdGljIGlzVmFsaWRJZGVudGlmaWVyKHQpIHtcbiAgICAgICAgcmV0dXJuIGh0LnRlc3QodCk7XG4gICAgfVxuICAgIGNhbm9uaWNhbFN0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudG9BcnJheSgpLm1hcCgodCA9PiAodCA9IHQucmVwbGFjZSgvXFxcXC9nLCBcIlxcXFxcXFxcXCIpLnJlcGxhY2UoL2AvZywgXCJcXFxcYFwiKSwgXG4gICAgICAgIGx0LmlzVmFsaWRJZGVudGlmaWVyKHQpIHx8ICh0ID0gXCJgXCIgKyB0ICsgXCJgXCIpLCB0KSkpLmpvaW4oXCIuXCIpO1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2Fub25pY2FsU3RyaW5nKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGlzIGZpZWxkIHJlZmVyZW5jZXMgdGhlIGtleSBvZiBhIGRvY3VtZW50LlxuICAgICAqLyAgICBpc0tleUZpZWxkKCkge1xuICAgICAgICByZXR1cm4gMSA9PT0gdGhpcy5sZW5ndGggJiYgXCJfX25hbWVfX1wiID09PSB0aGlzLmdldCgwKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIGZpZWxkIGRlc2lnbmF0aW5nIHRoZSBrZXkgb2YgYSBkb2N1bWVudC5cbiAgICAgKi8gICAgc3RhdGljIGtleUZpZWxkKCkge1xuICAgICAgICByZXR1cm4gbmV3IGx0KFsgXCJfX25hbWVfX1wiIF0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQYXJzZXMgYSBmaWVsZCBzdHJpbmcgZnJvbSB0aGUgZ2l2ZW4gc2VydmVyLWZvcm1hdHRlZCBzdHJpbmcuXG4gICAgICpcbiAgICAgKiAtIFNwbGl0dGluZyB0aGUgZW1wdHkgc3RyaW5nIGlzIG5vdCBhbGxvd2VkIChmb3Igbm93IGF0IGxlYXN0KS5cbiAgICAgKiAtIEVtcHR5IHNlZ21lbnRzIHdpdGhpbiB0aGUgc3RyaW5nIChlLmcuIGlmIHRoZXJlIGFyZSB0d28gY29uc2VjdXRpdmVcbiAgICAgKiAgIHNlcGFyYXRvcnMpIGFyZSBub3QgYWxsb3dlZC5cbiAgICAgKlxuICAgICAqIFRPRE8oYi8zNzI0NDE1Nyk6IHdlIHNob3VsZCBtYWtlIHRoaXMgbW9yZSBzdHJpY3QuIFJpZ2h0IG5vdywgaXQgYWxsb3dzXG4gICAgICogbm9uLWlkZW50aWZpZXIgcGF0aCBjb21wb25lbnRzLCBldmVuIGlmIHRoZXkgYXJlbid0IGVzY2FwZWQuXG4gICAgICovICAgIHN0YXRpYyBmcm9tU2VydmVyRm9ybWF0KHQpIHtcbiAgICAgICAgY29uc3QgZSA9IFtdO1xuICAgICAgICBsZXQgbiA9IFwiXCIsIHMgPSAwO1xuICAgICAgICBjb25zdCBpID0gKCkgPT4ge1xuICAgICAgICAgICAgaWYgKDAgPT09IG4ubGVuZ3RoKSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIGZpZWxkIHBhdGggKCR7dH0pLiBQYXRocyBtdXN0IG5vdCBiZSBlbXB0eSwgYmVnaW4gd2l0aCAnLicsIGVuZCB3aXRoICcuJywgb3IgY29udGFpbiAnLi4nYCk7XG4gICAgICAgICAgICBlLnB1c2gobiksIG4gPSBcIlwiO1xuICAgICAgICB9O1xuICAgICAgICBsZXQgciA9ICExO1xuICAgICAgICBmb3IgKDtzIDwgdC5sZW5ndGg7ICkge1xuICAgICAgICAgICAgY29uc3QgZSA9IHRbc107XG4gICAgICAgICAgICBpZiAoXCJcXFxcXCIgPT09IGUpIHtcbiAgICAgICAgICAgICAgICBpZiAocyArIDEgPT09IHQubGVuZ3RoKSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIFwiUGF0aCBoYXMgdHJhaWxpbmcgZXNjYXBlIGNoYXJhY3RlcjogXCIgKyB0KTtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdFtzICsgMV07XG4gICAgICAgICAgICAgICAgaWYgKFwiXFxcXFwiICE9PSBlICYmIFwiLlwiICE9PSBlICYmIFwiYFwiICE9PSBlKSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIFwiUGF0aCBoYXMgaW52YWxpZCBlc2NhcGUgc2VxdWVuY2U6IFwiICsgdCk7XG4gICAgICAgICAgICAgICAgbiArPSBlLCBzICs9IDI7XG4gICAgICAgICAgICB9IGVsc2UgXCJgXCIgPT09IGUgPyAociA9ICFyLCBzKyspIDogXCIuXCIgIT09IGUgfHwgciA/IChuICs9IGUsIHMrKykgOiAoaSgpLCBzKyspO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpKCksIHIpIHRocm93IG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgXCJVbnRlcm1pbmF0ZWQgYCBpbiBwYXRoOiBcIiArIHQpO1xuICAgICAgICByZXR1cm4gbmV3IGx0KGUpO1xuICAgIH1cbiAgICBzdGF0aWMgZW1wdHlQYXRoKCkge1xuICAgICAgICByZXR1cm4gbmV3IGx0KFtdKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFByb3ZpZGVzIGEgc2V0IG9mIGZpZWxkcyB0aGF0IGNhbiBiZSB1c2VkIHRvIHBhcnRpYWxseSBwYXRjaCBhIGRvY3VtZW50LlxuICogRmllbGRNYXNrIGlzIHVzZWQgaW4gY29uanVuY3Rpb24gd2l0aCBPYmplY3RWYWx1ZS5cbiAqIEV4YW1wbGVzOlxuICogICBmb28gLSBPdmVyd3JpdGVzIGZvbyBlbnRpcmVseSB3aXRoIHRoZSBwcm92aWRlZCB2YWx1ZS4gSWYgZm9vIGlzIG5vdFxuICogICAgICAgICBwcmVzZW50IGluIHRoZSBjb21wYW5pb24gT2JqZWN0VmFsdWUsIHRoZSBmaWVsZCBpcyBkZWxldGVkLlxuICogICBmb28uYmFyIC0gT3ZlcndyaXRlcyBvbmx5IHRoZSBmaWVsZCBiYXIgb2YgdGhlIG9iamVjdCBmb28uXG4gKiAgICAgICAgICAgICBJZiBmb28gaXMgbm90IGFuIG9iamVjdCwgZm9vIGlzIHJlcGxhY2VkIHdpdGggYW4gb2JqZWN0XG4gKiAgICAgICAgICAgICBjb250YWluaW5nIGZvb1xuICovIGNsYXNzIGZ0IHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMuZmllbGRzID0gdCwgXG4gICAgICAgIC8vIFRPRE8oZGltb25kKTogdmFsaWRhdGlvbiBvZiBGaWVsZE1hc2tcbiAgICAgICAgLy8gU29ydCB0aGUgZmllbGQgbWFzayB0byBzdXBwb3J0IGBGaWVsZE1hc2suaXNFcXVhbCgpYCBhbmQgYXNzZXJ0IGJlbG93LlxuICAgICAgICB0LnNvcnQobHQuY29tcGFyYXRvcik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFZlcmlmaWVzIHRoYXQgYGZpZWxkUGF0aGAgaXMgaW5jbHVkZWQgYnkgYXQgbGVhc3Qgb25lIGZpZWxkIGluIHRoaXMgZmllbGRcbiAgICAgKiBtYXNrLlxuICAgICAqXG4gICAgICogVGhpcyBpcyBhbiBPKG4pIG9wZXJhdGlvbiwgd2hlcmUgYG5gIGlzIHRoZSBzaXplIG9mIHRoZSBmaWVsZCBtYXNrLlxuICAgICAqLyAgICBjb3ZlcnModCkge1xuICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdGhpcy5maWVsZHMpIGlmIChlLmlzUHJlZml4T2YodCkpIHJldHVybiAhMDtcbiAgICAgICAgcmV0dXJuICExO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgcmV0dXJuIGV0KHRoaXMuZmllbGRzLCB0LmZpZWxkcywgKCh0LCBlKSA9PiB0LmlzRXF1YWwoZSkpKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKiogQ29udmVydHMgYSBCYXNlNjQgZW5jb2RlZCBzdHJpbmcgdG8gYSBiaW5hcnkgc3RyaW5nLiAqL1xuLyoqIFRydWUgaWYgYW5kIG9ubHkgaWYgdGhlIEJhc2U2NCBjb252ZXJzaW9uIGZ1bmN0aW9ucyBhcmUgYXZhaWxhYmxlLiAqL1xuZnVuY3Rpb24gZHQoKSB7XG4gICAgcmV0dXJuIFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIGF0b2I7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEltbXV0YWJsZSBjbGFzcyB0aGF0IHJlcHJlc2VudHMgYSBcInByb3RvXCIgYnl0ZSBzdHJpbmcuXG4gKlxuICogUHJvdG8gYnl0ZSBzdHJpbmdzIGNhbiBlaXRoZXIgYmUgQmFzZTY0LWVuY29kZWQgc3RyaW5ncyBvciBVaW50OEFycmF5cyB3aGVuXG4gKiBzZW50IG9uIHRoZSB3aXJlLiBUaGlzIGNsYXNzIGFic3RyYWN0cyBhd2F5IHRoaXMgZGlmZmVyZW50aWF0aW9uIGJ5IGhvbGRpbmdcbiAqIHRoZSBwcm90byBieXRlIHN0cmluZyBpbiBhIGNvbW1vbiBjbGFzcyB0aGF0IG11c3QgYmUgY29udmVydGVkIGludG8gYSBzdHJpbmdcbiAqIGJlZm9yZSBiZWluZyBzZW50IGFzIGEgcHJvdG8uXG4gKiBAaW50ZXJuYWxcbiAqLyBjbGFzcyB3dCB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLmJpbmFyeVN0cmluZyA9IHQ7XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tQmFzZTY0U3RyaW5nKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IGF0b2IodCk7XG4gICAgICAgIHJldHVybiBuZXcgd3QoZSk7XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tVWludDhBcnJheSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBcbiAgICAgICAgLyoqXG4gKiBIZWxwZXIgZnVuY3Rpb24gdG8gY29udmVydCBhbiBVaW50OGFycmF5IHRvIGEgYmluYXJ5IHN0cmluZy5cbiAqL1xuICAgICAgICBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICBsZXQgZSA9IFwiXCI7XG4gICAgICAgICAgICBmb3IgKGxldCBuID0gMDsgbiA8IHQubGVuZ3RoOyArK24pIGUgKz0gU3RyaW5nLmZyb21DaGFyQ29kZSh0W25dKTtcbiAgICAgICAgICAgIHJldHVybiBlO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICogSGVscGVyIGZ1bmN0aW9uIHRvIGNvbnZlcnQgYSBiaW5hcnkgc3RyaW5nIHRvIGFuIFVpbnQ4QXJyYXkuXG4gKi8gKHQpO1xuICAgICAgICByZXR1cm4gbmV3IHd0KGUpO1xuICAgIH1cbiAgICB0b0Jhc2U2NCgpIHtcbiAgICAgICAgcmV0dXJuIHQgPSB0aGlzLmJpbmFyeVN0cmluZywgYnRvYSh0KTtcbiAgICAgICAgLyoqIENvbnZlcnRzIGEgYmluYXJ5IHN0cmluZyB0byBhIEJhc2U2NCBlbmNvZGVkIHN0cmluZy4gKi9cbiAgICAgICAgdmFyIHQ7XG4gICAgfVxuICAgIHRvVWludDhBcnJheSgpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSBuZXcgVWludDhBcnJheSh0Lmxlbmd0aCk7XG4gICAgICAgICAgICBmb3IgKGxldCBuID0gMDsgbiA8IHQubGVuZ3RoOyBuKyspIGVbbl0gPSB0LmNoYXJDb2RlQXQobik7XG4gICAgICAgICAgICByZXR1cm4gZTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuICAgICAgICAvLyBBIFJlZ0V4cCBtYXRjaGluZyBJU08gODYwMSBVVEMgdGltZXN0YW1wcyB3aXRoIG9wdGlvbmFsIGZyYWN0aW9uLlxuICAgICAgICAodGhpcy5iaW5hcnlTdHJpbmcpO1xuICAgIH1cbiAgICBhcHByb3hpbWF0ZUJ5dGVTaXplKCkge1xuICAgICAgICByZXR1cm4gMiAqIHRoaXMuYmluYXJ5U3RyaW5nLmxlbmd0aDtcbiAgICB9XG4gICAgY29tcGFyZVRvKHQpIHtcbiAgICAgICAgcmV0dXJuIHR0KHRoaXMuYmluYXJ5U3RyaW5nLCB0LmJpbmFyeVN0cmluZyk7XG4gICAgfVxuICAgIGlzRXF1YWwodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5iaW5hcnlTdHJpbmcgPT09IHQuYmluYXJ5U3RyaW5nO1xuICAgIH1cbn1cblxud3QuRU1QVFlfQllURV9TVFJJTkcgPSBuZXcgd3QoXCJcIik7XG5cbmNvbnN0IF90ID0gbmV3IFJlZ0V4cCgvXlxcZHs0fS1cXGRcXGQtXFxkXFxkVFxcZFxcZDpcXGRcXGQ6XFxkXFxkKD86XFwuKFxcZCspKT9aJC8pO1xuXG4vKipcbiAqIENvbnZlcnRzIHRoZSBwb3NzaWJsZSBQcm90byB2YWx1ZXMgZm9yIGEgdGltZXN0YW1wIHZhbHVlIGludG8gYSBcInNlY29uZHMgYW5kXG4gKiBuYW5vc1wiIHJlcHJlc2VudGF0aW9uLlxuICovIGZ1bmN0aW9uIG10KHQpIHtcbiAgICAvLyBUaGUganNvbiBpbnRlcmZhY2UgKGZvciB0aGUgYnJvd3Nlcikgd2lsbCByZXR1cm4gYW4gaXNvIHRpbWVzdGFtcCBzdHJpbmcsXG4gICAgLy8gd2hpbGUgdGhlIHByb3RvIGpzIGxpYnJhcnkgKGZvciBub2RlKSB3aWxsIHJldHVybiBhXG4gICAgLy8gZ29vZ2xlLnByb3RvYnVmLlRpbWVzdGFtcCBpbnN0YW5jZS5cbiAgICBpZiAoTCghIXQpLCBcInN0cmluZ1wiID09IHR5cGVvZiB0KSB7XG4gICAgICAgIC8vIFRoZSBkYXRlIHN0cmluZyBjYW4gaGF2ZSBoaWdoZXIgcHJlY2lzaW9uIChuYW5vcykgdGhhbiB0aGUgRGF0ZSBjbGFzc1xuICAgICAgICAvLyAobWlsbGlzKSwgc28gd2UgZG8gc29tZSBjdXN0b20gcGFyc2luZyBoZXJlLlxuICAgICAgICAvLyBQYXJzZSB0aGUgbmFub3MgcmlnaHQgb3V0IG9mIHRoZSBzdHJpbmcuXG4gICAgICAgIGxldCBlID0gMDtcbiAgICAgICAgY29uc3QgbiA9IF90LmV4ZWModCk7XG4gICAgICAgIGlmIChMKCEhbiksIG5bMV0pIHtcbiAgICAgICAgICAgIC8vIFBhZCB0aGUgZnJhY3Rpb24gb3V0IHRvIDkgZGlnaXRzIChuYW5vcykuXG4gICAgICAgICAgICBsZXQgdCA9IG5bMV07XG4gICAgICAgICAgICB0ID0gKHQgKyBcIjAwMDAwMDAwMFwiKS5zdWJzdHIoMCwgOSksIGUgPSBOdW1iZXIodCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gUGFyc2UgdGhlIGRhdGUgdG8gZ2V0IHRoZSBzZWNvbmRzLlxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBuZXcgRGF0ZSh0KTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHNlY29uZHM6IE1hdGguZmxvb3Iocy5nZXRUaW1lKCkgLyAxZTMpLFxuICAgICAgICAgICAgbmFub3M6IGVcbiAgICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgc2Vjb25kczogZ3QodC5zZWNvbmRzKSxcbiAgICAgICAgbmFub3M6IGd0KHQubmFub3MpXG4gICAgfTtcbn1cblxuLyoqXG4gKiBDb252ZXJ0cyB0aGUgcG9zc2libGUgUHJvdG8gdHlwZXMgZm9yIG51bWJlcnMgaW50byBhIEphdmFTY3JpcHQgbnVtYmVyLlxuICogUmV0dXJucyAwIGlmIHRoZSB2YWx1ZSBpcyBub3QgbnVtZXJpYy5cbiAqLyBmdW5jdGlvbiBndCh0KSB7XG4gICAgLy8gVE9ETyhiam9ybmljayk6IEhhbmRsZSBpbnQ2NCBncmVhdGVyIHRoYW4gNTMgYml0cy5cbiAgICByZXR1cm4gXCJudW1iZXJcIiA9PSB0eXBlb2YgdCA/IHQgOiBcInN0cmluZ1wiID09IHR5cGVvZiB0ID8gTnVtYmVyKHQpIDogMDtcbn1cblxuLyoqIENvbnZlcnRzIHRoZSBwb3NzaWJsZSBQcm90byB0eXBlcyBmb3IgQmxvYnMgaW50byBhIEJ5dGVTdHJpbmcuICovIGZ1bmN0aW9uIHl0KHQpIHtcbiAgICByZXR1cm4gXCJzdHJpbmdcIiA9PSB0eXBlb2YgdCA/IHd0LmZyb21CYXNlNjRTdHJpbmcodCkgOiB3dC5mcm9tVWludDhBcnJheSh0KTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUmVwcmVzZW50cyBhIGxvY2FsbHktYXBwbGllZCBTZXJ2ZXJUaW1lc3RhbXAuXG4gKlxuICogU2VydmVyIFRpbWVzdGFtcHMgYXJlIGJhY2tlZCBieSBNYXBWYWx1ZXMgdGhhdCBjb250YWluIGFuIGludGVybmFsIGZpZWxkXG4gKiBgX190eXBlX19gIHdpdGggYSB2YWx1ZSBvZiBgc2VydmVyX3RpbWVzdGFtcGAuIFRoZSBwcmV2aW91cyB2YWx1ZSBhbmQgbG9jYWxcbiAqIHdyaXRlIHRpbWUgYXJlIHN0b3JlZCBpbiBpdHMgYF9fcHJldmlvdXNfdmFsdWVfX2AgYW5kIGBfX2xvY2FsX3dyaXRlX3RpbWVfX2BcbiAqIGZpZWxkcyByZXNwZWN0aXZlbHkuXG4gKlxuICogTm90ZXM6XG4gKiAtIFNlcnZlclRpbWVzdGFtcFZhbHVlIGluc3RhbmNlcyBhcmUgY3JlYXRlZCBhcyB0aGUgcmVzdWx0IG9mIGFwcGx5aW5nIGFcbiAqICAgdHJhbnNmb3JtLiBUaGV5IGNhbiBvbmx5IGV4aXN0IGluIHRoZSBsb2NhbCB2aWV3IG9mIGEgZG9jdW1lbnQuIFRoZXJlZm9yZVxuICogICB0aGV5IGRvIG5vdCBuZWVkIHRvIGJlIHBhcnNlZCBvciBzZXJpYWxpemVkLlxuICogLSBXaGVuIGV2YWx1YXRlZCBsb2NhbGx5IChlLmcuIGZvciBzbmFwc2hvdC5kYXRhKCkpLCB0aGV5IGJ5IGRlZmF1bHRcbiAqICAgZXZhbHVhdGUgdG8gYG51bGxgLiBUaGlzIGJlaGF2aW9yIGNhbiBiZSBjb25maWd1cmVkIGJ5IHBhc3NpbmcgY3VzdG9tXG4gKiAgIEZpZWxkVmFsdWVPcHRpb25zIHRvIHZhbHVlKCkuXG4gKiAtIFdpdGggcmVzcGVjdCB0byBvdGhlciBTZXJ2ZXJUaW1lc3RhbXBWYWx1ZXMsIHRoZXkgc29ydCBieSB0aGVpclxuICogICBsb2NhbFdyaXRlVGltZS5cbiAqLyBmdW5jdGlvbiBwdCh0KSB7XG4gICAgdmFyIGUsIG47XG4gICAgcmV0dXJuIFwic2VydmVyX3RpbWVzdGFtcFwiID09PSAobnVsbCA9PT0gKG4gPSAoKG51bGwgPT09IChlID0gbnVsbCA9PSB0ID8gdm9pZCAwIDogdC5tYXBWYWx1ZSkgfHwgdm9pZCAwID09PSBlID8gdm9pZCAwIDogZS5maWVsZHMpIHx8IHt9KS5fX3R5cGVfXykgfHwgdm9pZCAwID09PSBuID8gdm9pZCAwIDogbi5zdHJpbmdWYWx1ZSk7XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyBTZXJ2ZXJUaW1lc3RhbXAgcHJvdG8gdmFsdWUgKHVzaW5nIHRoZSBpbnRlcm5hbCBmb3JtYXQpLlxuICovXG4vKipcbiAqIFJldHVybnMgdGhlIHZhbHVlIG9mIHRoZSBmaWVsZCBiZWZvcmUgdGhpcyBTZXJ2ZXJUaW1lc3RhbXAgd2FzIHNldC5cbiAqXG4gKiBQcmVzZXJ2aW5nIHRoZSBwcmV2aW91cyB2YWx1ZXMgYWxsb3dzIHRoZSB1c2VyIHRvIGRpc3BsYXkgdGhlIGxhc3QgcmVzb2xlZFxuICogdmFsdWUgdW50aWwgdGhlIGJhY2tlbmQgcmVzcG9uZHMgd2l0aCB0aGUgdGltZXN0YW1wLlxuICovXG5mdW5jdGlvbiBFdCh0KSB7XG4gICAgY29uc3QgZSA9IHQubWFwVmFsdWUuZmllbGRzLl9fcHJldmlvdXNfdmFsdWVfXztcbiAgICByZXR1cm4gcHQoZSkgPyBFdChlKSA6IGU7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgbG9jYWwgdGltZSBhdCB3aGljaCB0aGlzIHRpbWVzdGFtcCB3YXMgZmlyc3Qgc2V0LlxuICovIGZ1bmN0aW9uIFR0KHQpIHtcbiAgICBjb25zdCBlID0gbXQodC5tYXBWYWx1ZS5maWVsZHMuX19sb2NhbF93cml0ZV90aW1lX18udGltZXN0YW1wVmFsdWUpO1xuICAgIHJldHVybiBuZXcgc3QoZS5zZWNvbmRzLCBlLm5hbm9zKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKiBTZW50aW5lbCB2YWx1ZSB0aGF0IHNvcnRzIGJlZm9yZSBhbnkgTXV0YXRpb24gQmF0Y2ggSUQuICovXG4vKipcbiAqIFJldHVybnMgd2hldGhlciBhIHZhcmlhYmxlIGlzIGVpdGhlciB1bmRlZmluZWQgb3IgbnVsbC5cbiAqL1xuZnVuY3Rpb24gSXQodCkge1xuICAgIHJldHVybiBudWxsID09IHQ7XG59XG5cbi8qKiBSZXR1cm5zIHdoZXRoZXIgdGhlIHZhbHVlIHJlcHJlc2VudHMgLTAuICovIGZ1bmN0aW9uIEF0KHQpIHtcbiAgICAvLyBEZXRlY3QgaWYgdGhlIHZhbHVlIGlzIC0wLjAuIEJhc2VkIG9uIHBvbHlmaWxsIGZyb21cbiAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9PYmplY3QvaXNcbiAgICByZXR1cm4gMCA9PT0gdCAmJiAxIC8gdCA9PSAtMSAvIDA7XG59XG5cbi8qKlxuICogUmV0dXJucyB3aGV0aGVyIGEgdmFsdWUgaXMgYW4gaW50ZWdlciBhbmQgaW4gdGhlIHNhZmUgaW50ZWdlciByYW5nZVxuICogQHBhcmFtIHZhbHVlIC0gVGhlIHZhbHVlIHRvIHRlc3QgZm9yIGJlaW5nIGFuIGludGVnZXIgYW5kIGluIHRoZSBzYWZlIHJhbmdlXG4gKi8gZnVuY3Rpb24gUnQodCkge1xuICAgIHJldHVybiBcIm51bWJlclwiID09IHR5cGVvZiB0ICYmIE51bWJlci5pc0ludGVnZXIodCkgJiYgIUF0KHQpICYmIHQgPD0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIgJiYgdCA+PSBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUjtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQGludGVybmFsXG4gKi8gY2xhc3MgUHQge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5wYXRoID0gdDtcbiAgICB9XG4gICAgc3RhdGljIGZyb21QYXRoKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQdCh1dC5mcm9tU3RyaW5nKHQpKTtcbiAgICB9XG4gICAgc3RhdGljIGZyb21OYW1lKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQdCh1dC5mcm9tU3RyaW5nKHQpLnBvcEZpcnN0KDUpKTtcbiAgICB9XG4gICAgLyoqIFJldHVybnMgdHJ1ZSBpZiB0aGUgZG9jdW1lbnQgaXMgaW4gdGhlIHNwZWNpZmllZCBjb2xsZWN0aW9uSWQuICovICAgIGhhc0NvbGxlY3Rpb25JZCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBhdGgubGVuZ3RoID49IDIgJiYgdGhpcy5wYXRoLmdldCh0aGlzLnBhdGgubGVuZ3RoIC0gMikgPT09IHQ7XG4gICAgfVxuICAgIGlzRXF1YWwodCkge1xuICAgICAgICByZXR1cm4gbnVsbCAhPT0gdCAmJiAwID09PSB1dC5jb21wYXJhdG9yKHRoaXMucGF0aCwgdC5wYXRoKTtcbiAgICB9XG4gICAgdG9TdHJpbmcoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBhdGgudG9TdHJpbmcoKTtcbiAgICB9XG4gICAgc3RhdGljIGNvbXBhcmF0b3IodCwgZSkge1xuICAgICAgICByZXR1cm4gdXQuY29tcGFyYXRvcih0LnBhdGgsIGUucGF0aCk7XG4gICAgfVxuICAgIHN0YXRpYyBpc0RvY3VtZW50S2V5KHQpIHtcbiAgICAgICAgcmV0dXJuIHQubGVuZ3RoICUgMiA9PSAwO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCByZXR1cm5zIGEgbmV3IGRvY3VtZW50IGtleSB3aXRoIHRoZSBnaXZlbiBzZWdtZW50cy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBzZWdtZW50cyAtIFRoZSBzZWdtZW50cyBvZiB0aGUgcGF0aCB0byB0aGUgZG9jdW1lbnRcbiAgICAgKiBAcmV0dXJucyBBIG5ldyBpbnN0YW5jZSBvZiBEb2N1bWVudEtleVxuICAgICAqLyAgICBzdGF0aWMgZnJvbVNlZ21lbnRzKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQdChuZXcgdXQodC5zbGljZSgpKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqIEV4dHJhY3RzIHRoZSBiYWNrZW5kJ3MgdHlwZSBvcmRlciBmb3IgdGhlIHByb3ZpZGVkIHZhbHVlLiAqLyBmdW5jdGlvbiBidCh0KSB7XG4gICAgcmV0dXJuIFwibnVsbFZhbHVlXCIgaW4gdCA/IDAgLyogTnVsbFZhbHVlICovIDogXCJib29sZWFuVmFsdWVcIiBpbiB0ID8gMSAvKiBCb29sZWFuVmFsdWUgKi8gOiBcImludGVnZXJWYWx1ZVwiIGluIHQgfHwgXCJkb3VibGVWYWx1ZVwiIGluIHQgPyAyIC8qIE51bWJlclZhbHVlICovIDogXCJ0aW1lc3RhbXBWYWx1ZVwiIGluIHQgPyAzIC8qIFRpbWVzdGFtcFZhbHVlICovIDogXCJzdHJpbmdWYWx1ZVwiIGluIHQgPyA1IC8qIFN0cmluZ1ZhbHVlICovIDogXCJieXRlc1ZhbHVlXCIgaW4gdCA/IDYgLyogQmxvYlZhbHVlICovIDogXCJyZWZlcmVuY2VWYWx1ZVwiIGluIHQgPyA3IC8qIFJlZlZhbHVlICovIDogXCJnZW9Qb2ludFZhbHVlXCIgaW4gdCA/IDggLyogR2VvUG9pbnRWYWx1ZSAqLyA6IFwiYXJyYXlWYWx1ZVwiIGluIHQgPyA5IC8qIEFycmF5VmFsdWUgKi8gOiBcIm1hcFZhbHVlXCIgaW4gdCA/IHB0KHQpID8gNCAvKiBTZXJ2ZXJUaW1lc3RhbXBWYWx1ZSAqLyA6IDEwIC8qIE9iamVjdFZhbHVlICovIDogTSgpO1xufVxuXG4vKiogVGVzdHMgYGxlZnRgIGFuZCBgcmlnaHRgIGZvciBlcXVhbGl0eSBiYXNlZCBvbiB0aGUgYmFja2VuZCBzZW1hbnRpY3MuICovIGZ1bmN0aW9uIHZ0KHQsIGUpIHtcbiAgICBjb25zdCBuID0gYnQodCk7XG4gICAgaWYgKG4gIT09IGJ0KGUpKSByZXR1cm4gITE7XG4gICAgc3dpdGNoIChuKSB7XG4gICAgICBjYXNlIDAgLyogTnVsbFZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuICEwO1xuXG4gICAgICBjYXNlIDEgLyogQm9vbGVhblZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIHQuYm9vbGVhblZhbHVlID09PSBlLmJvb2xlYW5WYWx1ZTtcblxuICAgICAgY2FzZSA0IC8qIFNlcnZlclRpbWVzdGFtcFZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIFR0KHQpLmlzRXF1YWwoVHQoZSkpO1xuXG4gICAgICBjYXNlIDMgLyogVGltZXN0YW1wVmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgaWYgKFwic3RyaW5nXCIgPT0gdHlwZW9mIHQudGltZXN0YW1wVmFsdWUgJiYgXCJzdHJpbmdcIiA9PSB0eXBlb2YgZS50aW1lc3RhbXBWYWx1ZSAmJiB0LnRpbWVzdGFtcFZhbHVlLmxlbmd0aCA9PT0gZS50aW1lc3RhbXBWYWx1ZS5sZW5ndGgpIFxuICAgICAgICAgICAgLy8gVXNlIHN0cmluZyBlcXVhbGl0eSBmb3IgSVNPIDg2MDEgdGltZXN0YW1wc1xuICAgICAgICAgICAgcmV0dXJuIHQudGltZXN0YW1wVmFsdWUgPT09IGUudGltZXN0YW1wVmFsdWU7XG4gICAgICAgICAgICBjb25zdCBuID0gbXQodC50aW1lc3RhbXBWYWx1ZSksIHMgPSBtdChlLnRpbWVzdGFtcFZhbHVlKTtcbiAgICAgICAgICAgIHJldHVybiBuLnNlY29uZHMgPT09IHMuc2Vjb25kcyAmJiBuLm5hbm9zID09PSBzLm5hbm9zO1xuICAgICAgICB9KHQsIGUpO1xuXG4gICAgICBjYXNlIDUgLyogU3RyaW5nVmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gdC5zdHJpbmdWYWx1ZSA9PT0gZS5zdHJpbmdWYWx1ZTtcblxuICAgICAgY2FzZSA2IC8qIEJsb2JWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICByZXR1cm4geXQodC5ieXRlc1ZhbHVlKS5pc0VxdWFsKHl0KGUuYnl0ZXNWYWx1ZSkpO1xuICAgICAgICB9KHQsIGUpO1xuXG4gICAgICBjYXNlIDcgLyogUmVmVmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gdC5yZWZlcmVuY2VWYWx1ZSA9PT0gZS5yZWZlcmVuY2VWYWx1ZTtcblxuICAgICAgY2FzZSA4IC8qIEdlb1BvaW50VmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgcmV0dXJuIGd0KHQuZ2VvUG9pbnRWYWx1ZS5sYXRpdHVkZSkgPT09IGd0KGUuZ2VvUG9pbnRWYWx1ZS5sYXRpdHVkZSkgJiYgZ3QodC5nZW9Qb2ludFZhbHVlLmxvbmdpdHVkZSkgPT09IGd0KGUuZ2VvUG9pbnRWYWx1ZS5sb25naXR1ZGUpO1xuICAgICAgICB9KHQsIGUpO1xuXG4gICAgICBjYXNlIDIgLyogTnVtYmVyVmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgaWYgKFwiaW50ZWdlclZhbHVlXCIgaW4gdCAmJiBcImludGVnZXJWYWx1ZVwiIGluIGUpIHJldHVybiBndCh0LmludGVnZXJWYWx1ZSkgPT09IGd0KGUuaW50ZWdlclZhbHVlKTtcbiAgICAgICAgICAgIGlmIChcImRvdWJsZVZhbHVlXCIgaW4gdCAmJiBcImRvdWJsZVZhbHVlXCIgaW4gZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBndCh0LmRvdWJsZVZhbHVlKSwgcyA9IGd0KGUuZG91YmxlVmFsdWUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBuID09PSBzID8gQXQobikgPT09IEF0KHMpIDogaXNOYU4obikgJiYgaXNOYU4ocyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gITE7XG4gICAgICAgIH0odCwgZSk7XG5cbiAgICAgIGNhc2UgOSAvKiBBcnJheVZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIGV0KHQuYXJyYXlWYWx1ZS52YWx1ZXMgfHwgW10sIGUuYXJyYXlWYWx1ZS52YWx1ZXMgfHwgW10sIHZ0KTtcblxuICAgICAgY2FzZSAxMCAvKiBPYmplY3RWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gdC5tYXBWYWx1ZS5maWVsZHMgfHwge30sIHMgPSBlLm1hcFZhbHVlLmZpZWxkcyB8fCB7fTtcbiAgICAgICAgICAgIGlmIChydChuKSAhPT0gcnQocykpIHJldHVybiAhMTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgdCBpbiBuKSBpZiAobi5oYXNPd25Qcm9wZXJ0eSh0KSAmJiAodm9pZCAwID09PSBzW3RdIHx8ICF2dChuW3RdLCBzW3RdKSkpIHJldHVybiAhMTtcbiAgICAgICAgICAgIHJldHVybiAhMDtcbiAgICAgICAgfVxuICAgICAgICAvKiogUmV0dXJucyB0cnVlIGlmIHRoZSBBcnJheVZhbHVlIGNvbnRhaW5zIHRoZSBzcGVjaWZpZWQgZWxlbWVudC4gKi8gKHQsIGUpO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gTSgpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gVnQodCwgZSkge1xuICAgIHJldHVybiB2b2lkIDAgIT09ICh0LnZhbHVlcyB8fCBbXSkuZmluZCgodCA9PiB2dCh0LCBlKSkpO1xufVxuXG5mdW5jdGlvbiBTdCh0LCBlKSB7XG4gICAgY29uc3QgbiA9IGJ0KHQpLCBzID0gYnQoZSk7XG4gICAgaWYgKG4gIT09IHMpIHJldHVybiB0dChuLCBzKTtcbiAgICBzd2l0Y2ggKG4pIHtcbiAgICAgIGNhc2UgMCAvKiBOdWxsVmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gMDtcblxuICAgICAgY2FzZSAxIC8qIEJvb2xlYW5WYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiB0dCh0LmJvb2xlYW5WYWx1ZSwgZS5ib29sZWFuVmFsdWUpO1xuXG4gICAgICBjYXNlIDIgLyogTnVtYmVyVmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgY29uc3QgbiA9IGd0KHQuaW50ZWdlclZhbHVlIHx8IHQuZG91YmxlVmFsdWUpLCBzID0gZ3QoZS5pbnRlZ2VyVmFsdWUgfHwgZS5kb3VibGVWYWx1ZSk7XG4gICAgICAgICAgICByZXR1cm4gbiA8IHMgPyAtMSA6IG4gPiBzID8gMSA6IG4gPT09IHMgPyAwIDogXG4gICAgICAgICAgICAvLyBvbmUgb3IgYm90aCBhcmUgTmFOLlxuICAgICAgICAgICAgaXNOYU4obikgPyBpc05hTihzKSA/IDAgOiAtMSA6IDE7XG4gICAgICAgIH0odCwgZSk7XG5cbiAgICAgIGNhc2UgMyAvKiBUaW1lc3RhbXBWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiBEdCh0LnRpbWVzdGFtcFZhbHVlLCBlLnRpbWVzdGFtcFZhbHVlKTtcblxuICAgICAgY2FzZSA0IC8qIFNlcnZlclRpbWVzdGFtcFZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIER0KFR0KHQpLCBUdChlKSk7XG5cbiAgICAgIGNhc2UgNSAvKiBTdHJpbmdWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiB0dCh0LnN0cmluZ1ZhbHVlLCBlLnN0cmluZ1ZhbHVlKTtcblxuICAgICAgY2FzZSA2IC8qIEJsb2JWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBjb25zdCBuID0geXQodCksIHMgPSB5dChlKTtcbiAgICAgICAgICAgIHJldHVybiBuLmNvbXBhcmVUbyhzKTtcbiAgICAgICAgfSh0LmJ5dGVzVmFsdWUsIGUuYnl0ZXNWYWx1ZSk7XG5cbiAgICAgIGNhc2UgNyAvKiBSZWZWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gdC5zcGxpdChcIi9cIiksIHMgPSBlLnNwbGl0KFwiL1wiKTtcbiAgICAgICAgICAgIGZvciAobGV0IHQgPSAwOyB0IDwgbi5sZW5ndGggJiYgdCA8IHMubGVuZ3RoOyB0KyspIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdHQoblt0XSwgc1t0XSk7XG4gICAgICAgICAgICAgICAgaWYgKDAgIT09IGUpIHJldHVybiBlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHR0KG4ubGVuZ3RoLCBzLmxlbmd0aCk7XG4gICAgICAgIH0odC5yZWZlcmVuY2VWYWx1ZSwgZS5yZWZlcmVuY2VWYWx1ZSk7XG5cbiAgICAgIGNhc2UgOCAvKiBHZW9Qb2ludFZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0dChndCh0LmxhdGl0dWRlKSwgZ3QoZS5sYXRpdHVkZSkpO1xuICAgICAgICAgICAgaWYgKDAgIT09IG4pIHJldHVybiBuO1xuICAgICAgICAgICAgcmV0dXJuIHR0KGd0KHQubG9uZ2l0dWRlKSwgZ3QoZS5sb25naXR1ZGUpKTtcbiAgICAgICAgfSh0Lmdlb1BvaW50VmFsdWUsIGUuZ2VvUG9pbnRWYWx1ZSk7XG5cbiAgICAgIGNhc2UgOSAvKiBBcnJheVZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0LnZhbHVlcyB8fCBbXSwgcyA9IGUudmFsdWVzIHx8IFtdO1xuICAgICAgICAgICAgZm9yIChsZXQgdCA9IDA7IHQgPCBuLmxlbmd0aCAmJiB0IDwgcy5sZW5ndGg7ICsrdCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBTdChuW3RdLCBzW3RdKTtcbiAgICAgICAgICAgICAgICBpZiAoZSkgcmV0dXJuIGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdHQobi5sZW5ndGgsIHMubGVuZ3RoKTtcbiAgICAgICAgfSh0LmFycmF5VmFsdWUsIGUuYXJyYXlWYWx1ZSk7XG5cbiAgICAgIGNhc2UgMTAgLyogT2JqZWN0VmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgY29uc3QgbiA9IHQuZmllbGRzIHx8IHt9LCBzID0gT2JqZWN0LmtleXMobiksIGkgPSBlLmZpZWxkcyB8fCB7fSwgciA9IE9iamVjdC5rZXlzKGkpO1xuICAgICAgICAgICAgLy8gRXZlbiB0aG91Z2ggTWFwVmFsdWVzIGFyZSBsaWtlbHkgc29ydGVkIGNvcnJlY3RseSBiYXNlZCBvbiB0aGVpciBpbnNlcnRpb25cbiAgICAgICAgICAgIC8vIG9yZGVyIChlLmcuIHdoZW4gcmVjZWl2ZWQgZnJvbSB0aGUgYmFja2VuZCksIGxvY2FsIG1vZGlmaWNhdGlvbnMgY2FuIGJyaW5nXG4gICAgICAgICAgICAvLyBlbGVtZW50cyBvdXQgb2Ygb3JkZXIuIFdlIG5lZWQgdG8gcmUtc29ydCB0aGUgZWxlbWVudHMgdG8gZW5zdXJlIHRoYXRcbiAgICAgICAgICAgIC8vIGNhbm9uaWNhbCBJRHMgYXJlIGluZGVwZW5kZW50IG9mIGluc2VydGlvbiBvcmRlci5cbiAgICAgICAgICAgIHMuc29ydCgpLCByLnNvcnQoKTtcbiAgICAgICAgICAgIGZvciAobGV0IHQgPSAwOyB0IDwgcy5sZW5ndGggJiYgdCA8IHIubGVuZ3RoOyArK3QpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdHQoc1t0XSwgclt0XSk7XG4gICAgICAgICAgICAgICAgaWYgKDAgIT09IGUpIHJldHVybiBlO1xuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBTdChuW3NbdF1dLCBpW3JbdF1dKTtcbiAgICAgICAgICAgICAgICBpZiAoMCAhPT0gbykgcmV0dXJuIG87XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdHQocy5sZW5ndGgsIHIubGVuZ3RoKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAqIEdlbmVyYXRlcyB0aGUgY2Fub25pY2FsIElEIGZvciB0aGUgcHJvdmlkZWQgZmllbGQgdmFsdWUgKGFzIHVzZWQgaW4gVGFyZ2V0XG4gKiBzZXJpYWxpemF0aW9uKS5cbiAqLyAodC5tYXBWYWx1ZSwgZS5tYXBWYWx1ZSk7XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHRocm93IE0oKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIER0KHQsIGUpIHtcbiAgICBpZiAoXCJzdHJpbmdcIiA9PSB0eXBlb2YgdCAmJiBcInN0cmluZ1wiID09IHR5cGVvZiBlICYmIHQubGVuZ3RoID09PSBlLmxlbmd0aCkgcmV0dXJuIHR0KHQsIGUpO1xuICAgIGNvbnN0IG4gPSBtdCh0KSwgcyA9IG10KGUpLCBpID0gdHQobi5zZWNvbmRzLCBzLnNlY29uZHMpO1xuICAgIHJldHVybiAwICE9PSBpID8gaSA6IHR0KG4ubmFub3MsIHMubmFub3MpO1xufVxuXG5mdW5jdGlvbiBDdCh0KSB7XG4gICAgcmV0dXJuIE50KHQpO1xufVxuXG5mdW5jdGlvbiBOdCh0KSB7XG4gICAgcmV0dXJuIFwibnVsbFZhbHVlXCIgaW4gdCA/IFwibnVsbFwiIDogXCJib29sZWFuVmFsdWVcIiBpbiB0ID8gXCJcIiArIHQuYm9vbGVhblZhbHVlIDogXCJpbnRlZ2VyVmFsdWVcIiBpbiB0ID8gXCJcIiArIHQuaW50ZWdlclZhbHVlIDogXCJkb3VibGVWYWx1ZVwiIGluIHQgPyBcIlwiICsgdC5kb3VibGVWYWx1ZSA6IFwidGltZXN0YW1wVmFsdWVcIiBpbiB0ID8gZnVuY3Rpb24odCkge1xuICAgICAgICBjb25zdCBlID0gbXQodCk7XG4gICAgICAgIHJldHVybiBgdGltZSgke2Uuc2Vjb25kc30sJHtlLm5hbm9zfSlgO1xuICAgIH0odC50aW1lc3RhbXBWYWx1ZSkgOiBcInN0cmluZ1ZhbHVlXCIgaW4gdCA/IHQuc3RyaW5nVmFsdWUgOiBcImJ5dGVzVmFsdWVcIiBpbiB0ID8geXQodC5ieXRlc1ZhbHVlKS50b0Jhc2U2NCgpIDogXCJyZWZlcmVuY2VWYWx1ZVwiIGluIHQgPyAobiA9IHQucmVmZXJlbmNlVmFsdWUsIFxuICAgIFB0LmZyb21OYW1lKG4pLnRvU3RyaW5nKCkpIDogXCJnZW9Qb2ludFZhbHVlXCIgaW4gdCA/IGBnZW8oJHsoZSA9IHQuZ2VvUG9pbnRWYWx1ZSkubGF0aXR1ZGV9LCR7ZS5sb25naXR1ZGV9KWAgOiBcImFycmF5VmFsdWVcIiBpbiB0ID8gZnVuY3Rpb24odCkge1xuICAgICAgICBsZXQgZSA9IFwiW1wiLCBuID0gITA7XG4gICAgICAgIGZvciAoY29uc3QgcyBvZiB0LnZhbHVlcyB8fCBbXSkgbiA/IG4gPSAhMSA6IGUgKz0gXCIsXCIsIGUgKz0gTnQocyk7XG4gICAgICAgIHJldHVybiBlICsgXCJdXCI7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIGEgcmVmZXJlbmNlIHZhbHVlIGZvciB0aGUgcHJvdmlkZWQgZGF0YWJhc2UgYW5kIGtleS4gKi8gKHQuYXJyYXlWYWx1ZSkgOiBcIm1hcFZhbHVlXCIgaW4gdCA/IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgLy8gSXRlcmF0aW9uIG9yZGVyIGluIEphdmFTY3JpcHQgaXMgbm90IGd1YXJhbnRlZWQuIFRvIGVuc3VyZSB0aGF0IHdlIGdlbmVyYXRlXG4gICAgICAgIC8vIG1hdGNoaW5nIGNhbm9uaWNhbCBJRHMgZm9yIGlkZW50aWNhbCBtYXBzLCB3ZSBuZWVkIHRvIHNvcnQgdGhlIGtleXMuXG4gICAgICAgIGNvbnN0IGUgPSBPYmplY3Qua2V5cyh0LmZpZWxkcyB8fCB7fSkuc29ydCgpO1xuICAgICAgICBsZXQgbiA9IFwie1wiLCBzID0gITA7XG4gICAgICAgIGZvciAoY29uc3QgaSBvZiBlKSBzID8gcyA9ICExIDogbiArPSBcIixcIiwgbiArPSBgJHtpfToke050KHQuZmllbGRzW2ldKX1gO1xuICAgICAgICByZXR1cm4gbiArIFwifVwiO1xuICAgIH0odC5tYXBWYWx1ZSkgOiBNKCk7XG4gICAgdmFyIGUsIG47XG59XG5cbmZ1bmN0aW9uIHh0KHQsIGUpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZWZlcmVuY2VWYWx1ZTogYHByb2plY3RzLyR7dC5wcm9qZWN0SWR9L2RhdGFiYXNlcy8ke3QuZGF0YWJhc2V9L2RvY3VtZW50cy8ke2UucGF0aC5jYW5vbmljYWxTdHJpbmcoKX1gXG4gICAgfTtcbn1cblxuLyoqIFJldHVybnMgdHJ1ZSBpZiBgdmFsdWVgIGlzIGFuIEludGVnZXJWYWx1ZSAuICovIGZ1bmN0aW9uIGt0KHQpIHtcbiAgICByZXR1cm4gISF0ICYmIFwiaW50ZWdlclZhbHVlXCIgaW4gdDtcbn1cblxuLyoqIFJldHVybnMgdHJ1ZSBpZiBgdmFsdWVgIGlzIGEgRG91YmxlVmFsdWUuICovXG4vKiogUmV0dXJucyB0cnVlIGlmIGB2YWx1ZWAgaXMgYW4gQXJyYXlWYWx1ZS4gKi9cbmZ1bmN0aW9uICR0KHQpIHtcbiAgICByZXR1cm4gISF0ICYmIFwiYXJyYXlWYWx1ZVwiIGluIHQ7XG59XG5cbi8qKiBSZXR1cm5zIHRydWUgaWYgYHZhbHVlYCBpcyBhIE51bGxWYWx1ZS4gKi8gZnVuY3Rpb24gT3QodCkge1xuICAgIHJldHVybiAhIXQgJiYgXCJudWxsVmFsdWVcIiBpbiB0O1xufVxuXG4vKiogUmV0dXJucyB0cnVlIGlmIGB2YWx1ZWAgaXMgTmFOLiAqLyBmdW5jdGlvbiBGdCh0KSB7XG4gICAgcmV0dXJuICEhdCAmJiBcImRvdWJsZVZhbHVlXCIgaW4gdCAmJiBpc05hTihOdW1iZXIodC5kb3VibGVWYWx1ZSkpO1xufVxuXG4vKiogUmV0dXJucyB0cnVlIGlmIGB2YWx1ZWAgaXMgYSBNYXBWYWx1ZS4gKi8gZnVuY3Rpb24gTXQodCkge1xuICAgIHJldHVybiAhIXQgJiYgXCJtYXBWYWx1ZVwiIGluIHQ7XG59XG5cbi8qKiBDcmVhdGVzIGEgZGVlcCBjb3B5IG9mIGBzb3VyY2VgLiAqLyBmdW5jdGlvbiBMdCh0KSB7XG4gICAgaWYgKHQuZ2VvUG9pbnRWYWx1ZSkgcmV0dXJuIHtcbiAgICAgICAgZ2VvUG9pbnRWYWx1ZTogT2JqZWN0LmFzc2lnbih7fSwgdC5nZW9Qb2ludFZhbHVlKVxuICAgIH07XG4gICAgaWYgKHQudGltZXN0YW1wVmFsdWUgJiYgXCJvYmplY3RcIiA9PSB0eXBlb2YgdC50aW1lc3RhbXBWYWx1ZSkgcmV0dXJuIHtcbiAgICAgICAgdGltZXN0YW1wVmFsdWU6IE9iamVjdC5hc3NpZ24oe30sIHQudGltZXN0YW1wVmFsdWUpXG4gICAgfTtcbiAgICBpZiAodC5tYXBWYWx1ZSkge1xuICAgICAgICBjb25zdCBlID0ge1xuICAgICAgICAgICAgbWFwVmFsdWU6IHtcbiAgICAgICAgICAgICAgICBmaWVsZHM6IHt9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBvdCh0Lm1hcFZhbHVlLmZpZWxkcywgKCh0LCBuKSA9PiBlLm1hcFZhbHVlLmZpZWxkc1t0XSA9IEx0KG4pKSksIGU7XG4gICAgfVxuICAgIGlmICh0LmFycmF5VmFsdWUpIHtcbiAgICAgICAgY29uc3QgZSA9IHtcbiAgICAgICAgICAgIGFycmF5VmFsdWU6IHtcbiAgICAgICAgICAgICAgICB2YWx1ZXM6IFtdXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgKHQuYXJyYXlWYWx1ZS52YWx1ZXMgfHwgW10pLmxlbmd0aDsgKytuKSBlLmFycmF5VmFsdWUudmFsdWVzW25dID0gTHQodC5hcnJheVZhbHVlLnZhbHVlc1tuXSk7XG4gICAgICAgIHJldHVybiBlO1xuICAgIH1cbiAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgdCk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEFuIE9iamVjdFZhbHVlIHJlcHJlc2VudHMgYSBNYXBWYWx1ZSBpbiB0aGUgRmlyZXN0b3JlIFByb3RvIGFuZCBvZmZlcnMgdGhlXG4gKiBhYmlsaXR5IHRvIGFkZCBhbmQgcmVtb3ZlIGZpZWxkcyAodmlhIHRoZSBPYmplY3RWYWx1ZUJ1aWxkZXIpLlxuICovIGNsYXNzIEJ0IHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMudmFsdWUgPSB0O1xuICAgIH1cbiAgICBzdGF0aWMgZW1wdHkoKSB7XG4gICAgICAgIHJldHVybiBuZXcgQnQoe1xuICAgICAgICAgICAgbWFwVmFsdWU6IHt9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSB2YWx1ZSBhdCB0aGUgZ2l2ZW4gcGF0aCBvciBudWxsLlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhdGggLSB0aGUgcGF0aCB0byBzZWFyY2hcbiAgICAgKiBAcmV0dXJucyBUaGUgdmFsdWUgYXQgdGhlIHBhdGggb3IgbnVsbCBpZiB0aGUgcGF0aCBpcyBub3Qgc2V0LlxuICAgICAqLyAgICBmaWVsZCh0KSB7XG4gICAgICAgIGlmICh0LmlzRW1wdHkoKSkgcmV0dXJuIHRoaXMudmFsdWU7XG4gICAgICAgIHtcbiAgICAgICAgICAgIGxldCBlID0gdGhpcy52YWx1ZTtcbiAgICAgICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgdC5sZW5ndGggLSAxOyArK24pIGlmIChlID0gKGUubWFwVmFsdWUuZmllbGRzIHx8IHt9KVt0LmdldChuKV0sIFxuICAgICAgICAgICAgIU10KGUpKSByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIHJldHVybiBlID0gKGUubWFwVmFsdWUuZmllbGRzIHx8IHt9KVt0Lmxhc3RTZWdtZW50KCldLCBlIHx8IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgZmllbGQgdG8gdGhlIHByb3ZpZGVkIHZhbHVlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhdGggLSBUaGUgZmllbGQgcGF0aCB0byBzZXQuXG4gICAgICogQHBhcmFtIHZhbHVlIC0gVGhlIHZhbHVlIHRvIHNldC5cbiAgICAgKi8gICAgc2V0KHQsIGUpIHtcbiAgICAgICAgdGhpcy5nZXRGaWVsZHNNYXAodC5wb3BMYXN0KCkpW3QubGFzdFNlZ21lbnQoKV0gPSBMdChlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgcHJvdmlkZWQgZmllbGRzIHRvIHRoZSBwcm92aWRlZCB2YWx1ZXMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZGF0YSAtIEEgbWFwIG9mIGZpZWxkcyB0byB2YWx1ZXMgKG9yIG51bGwgZm9yIGRlbGV0ZXMpLlxuICAgICAqLyAgICBzZXRBbGwodCkge1xuICAgICAgICBsZXQgZSA9IGx0LmVtcHR5UGF0aCgpLCBuID0ge30sIHMgPSBbXTtcbiAgICAgICAgdC5mb3JFYWNoKCgodCwgaSkgPT4ge1xuICAgICAgICAgICAgaWYgKCFlLmlzSW1tZWRpYXRlUGFyZW50T2YoaSkpIHtcbiAgICAgICAgICAgICAgICAvLyBJbnNlcnQgdGhlIGFjY3VtdWxhdGVkIGNoYW5nZXMgYXQgdGhpcyBwYXJlbnQgbG9jYXRpb25cbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5nZXRGaWVsZHNNYXAoZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHBseUNoYW5nZXModCwgbiwgcyksIG4gPSB7fSwgcyA9IFtdLCBlID0gaS5wb3BMYXN0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0ID8gbltpLmxhc3RTZWdtZW50KCldID0gTHQodCkgOiBzLnB1c2goaS5sYXN0U2VnbWVudCgpKTtcbiAgICAgICAgfSkpO1xuICAgICAgICBjb25zdCBpID0gdGhpcy5nZXRGaWVsZHNNYXAoZSk7XG4gICAgICAgIHRoaXMuYXBwbHlDaGFuZ2VzKGksIG4sIHMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIHRoZSBmaWVsZCBhdCB0aGUgc3BlY2lmaWVkIHBhdGguIElmIHRoZXJlIGlzIG5vIGZpZWxkIGF0IHRoZVxuICAgICAqIHNwZWNpZmllZCBwYXRoLCBub3RoaW5nIGlzIGNoYW5nZWQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGF0aCAtIFRoZSBmaWVsZCBwYXRoIHRvIHJlbW92ZS5cbiAgICAgKi8gICAgZGVsZXRlKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuZmllbGQodC5wb3BMYXN0KCkpO1xuICAgICAgICBNdChlKSAmJiBlLm1hcFZhbHVlLmZpZWxkcyAmJiBkZWxldGUgZS5tYXBWYWx1ZS5maWVsZHNbdC5sYXN0U2VnbWVudCgpXTtcbiAgICB9XG4gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIHJldHVybiB2dCh0aGlzLnZhbHVlLCB0LnZhbHVlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgbWFwIHRoYXQgY29udGFpbnMgdGhlIGxlYWYgZWxlbWVudCBvZiBgcGF0aGAuIElmIHRoZSBwYXJlbnRcbiAgICAgKiBlbnRyeSBkb2VzIG5vdCB5ZXQgZXhpc3QsIG9yIGlmIGl0IGlzIG5vdCBhIG1hcCwgYSBuZXcgbWFwIHdpbGwgYmUgY3JlYXRlZC5cbiAgICAgKi8gICAgZ2V0RmllbGRzTWFwKHQpIHtcbiAgICAgICAgbGV0IGUgPSB0aGlzLnZhbHVlO1xuICAgICAgICBlLm1hcFZhbHVlLmZpZWxkcyB8fCAoZS5tYXBWYWx1ZSA9IHtcbiAgICAgICAgICAgIGZpZWxkczoge31cbiAgICAgICAgfSk7XG4gICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgdC5sZW5ndGg7ICsrbikge1xuICAgICAgICAgICAgbGV0IHMgPSBlLm1hcFZhbHVlLmZpZWxkc1t0LmdldChuKV07XG4gICAgICAgICAgICBNdChzKSAmJiBzLm1hcFZhbHVlLmZpZWxkcyB8fCAocyA9IHtcbiAgICAgICAgICAgICAgICBtYXBWYWx1ZToge1xuICAgICAgICAgICAgICAgICAgICBmaWVsZHM6IHt9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgZS5tYXBWYWx1ZS5maWVsZHNbdC5nZXQobildID0gcyksIGUgPSBzO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBlLm1hcFZhbHVlLmZpZWxkcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogTW9kaWZpZXMgYGZpZWxkc01hcGAgYnkgYWRkaW5nLCByZXBsYWNpbmcgb3IgZGVsZXRpbmcgdGhlIHNwZWNpZmllZFxuICAgICAqIGVudHJpZXMuXG4gICAgICovICAgIGFwcGx5Q2hhbmdlcyh0LCBlLCBuKSB7XG4gICAgICAgIG90KGUsICgoZSwgbikgPT4gdFtlXSA9IG4pKTtcbiAgICAgICAgZm9yIChjb25zdCBlIG9mIG4pIGRlbGV0ZSB0W2VdO1xuICAgIH1cbiAgICBjbG9uZSgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBCdChMdCh0aGlzLnZhbHVlKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIFJldHVybnMgYSBGaWVsZE1hc2sgYnVpbHQgZnJvbSBhbGwgZmllbGRzIGluIGEgTWFwVmFsdWUuXG4gKi8gZnVuY3Rpb24gVXQodCkge1xuICAgIGNvbnN0IGUgPSBbXTtcbiAgICByZXR1cm4gb3QodC5maWVsZHMsICgodCwgbikgPT4ge1xuICAgICAgICBjb25zdCBzID0gbmV3IGx0KFsgdCBdKTtcbiAgICAgICAgaWYgKE10KG4pKSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gVXQobi5tYXBWYWx1ZSkuZmllbGRzO1xuICAgICAgICAgICAgaWYgKDAgPT09IHQubGVuZ3RoKSBcbiAgICAgICAgICAgIC8vIFByZXNlcnZlIHRoZSBlbXB0eSBtYXAgYnkgYWRkaW5nIGl0IHRvIHRoZSBGaWVsZE1hc2suXG4gICAgICAgICAgICBlLnB1c2gocyk7IGVsc2UgXG4gICAgICAgICAgICAvLyBGb3IgbmVzdGVkIGFuZCBub24tZW1wdHkgT2JqZWN0VmFsdWVzLCBhZGQgdGhlIEZpZWxkUGF0aCBvZiB0aGVcbiAgICAgICAgICAgIC8vIGxlYWYgbm9kZXMuXG4gICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgdCkgZS5wdXNoKHMuY2hpbGQobikpO1xuICAgICAgICB9IGVsc2UgXG4gICAgICAgIC8vIEZvciBuZXN0ZWQgYW5kIG5vbi1lbXB0eSBPYmplY3RWYWx1ZXMsIGFkZCB0aGUgRmllbGRQYXRoIG9mIHRoZSBsZWFmXG4gICAgICAgIC8vIG5vZGVzLlxuICAgICAgICBlLnB1c2gocyk7XG4gICAgfSkpLCBuZXcgZnQoZSk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFJlcHJlc2VudHMgYSBkb2N1bWVudCBpbiBGaXJlc3RvcmUgd2l0aCBhIGtleSwgdmVyc2lvbiwgZGF0YSBhbmQgd2hldGhlciBpdFxuICogaGFzIGxvY2FsIG11dGF0aW9ucyBhcHBsaWVkIHRvIGl0LlxuICpcbiAqIERvY3VtZW50cyBjYW4gdHJhbnNpdGlvbiBiZXR3ZWVuIHN0YXRlcyB2aWEgYGNvbnZlcnRUb0ZvdW5kRG9jdW1lbnQoKWAsXG4gKiBgY29udmVydFRvTm9Eb2N1bWVudCgpYCBhbmQgYGNvbnZlcnRUb1Vua25vd25Eb2N1bWVudCgpYC4gSWYgYSBkb2N1bWVudCBkb2VzXG4gKiBub3QgdHJhbnNpdGlvbiB0byBvbmUgb2YgdGhlc2Ugc3RhdGVzIGV2ZW4gYWZ0ZXIgYWxsIG11dGF0aW9ucyBoYXZlIGJlZW5cbiAqIGFwcGxpZWQsIGBpc1ZhbGlkRG9jdW1lbnQoKWAgcmV0dXJucyBmYWxzZSBhbmQgdGhlIGRvY3VtZW50IHNob3VsZCBiZSByZW1vdmVkXG4gKiBmcm9tIGFsbCB2aWV3cy5cbiAqLyBjbGFzcyBxdCB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcywgaSkge1xuICAgICAgICB0aGlzLmtleSA9IHQsIHRoaXMuZG9jdW1lbnRUeXBlID0gZSwgdGhpcy52ZXJzaW9uID0gbiwgdGhpcy5kYXRhID0gcywgdGhpcy5kb2N1bWVudFN0YXRlID0gaTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGRvY3VtZW50IHdpdGggbm8ga25vd24gdmVyc2lvbiBvciBkYXRhLCBidXQgd2hpY2ggY2FuIHNlcnZlIGFzXG4gICAgICogYmFzZSBkb2N1bWVudCBmb3IgbXV0YXRpb25zLlxuICAgICAqLyAgICBzdGF0aWMgbmV3SW52YWxpZERvY3VtZW50KHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBxdCh0LCAwIC8qIElOVkFMSUQgKi8gLCBpdC5taW4oKSwgQnQuZW1wdHkoKSwgMCAvKiBTWU5DRUQgKi8pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IGRvY3VtZW50IHRoYXQgaXMga25vd24gdG8gZXhpc3Qgd2l0aCB0aGUgZ2l2ZW4gZGF0YSBhdCB0aGVcbiAgICAgKiBnaXZlbiB2ZXJzaW9uLlxuICAgICAqLyAgICBzdGF0aWMgbmV3Rm91bmREb2N1bWVudCh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiBuZXcgcXQodCwgMSAvKiBGT1VORF9ET0NVTUVOVCAqLyAsIGUsIG4sIDAgLyogU1lOQ0VEICovKTtcbiAgICB9XG4gICAgLyoqIENyZWF0ZXMgYSBuZXcgZG9jdW1lbnQgdGhhdCBpcyBrbm93biB0byBub3QgZXhpc3QgYXQgdGhlIGdpdmVuIHZlcnNpb24uICovICAgIHN0YXRpYyBuZXdOb0RvY3VtZW50KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBxdCh0LCAyIC8qIE5PX0RPQ1VNRU5UICovICwgZSwgQnQuZW1wdHkoKSwgMCAvKiBTWU5DRUQgKi8pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IGRvY3VtZW50IHRoYXQgaXMga25vd24gdG8gZXhpc3QgYXQgdGhlIGdpdmVuIHZlcnNpb24gYnV0XG4gICAgICogd2hvc2UgZGF0YSBpcyBub3Qga25vd24gKGUuZy4gYSBkb2N1bWVudCB0aGF0IHdhcyB1cGRhdGVkIHdpdGhvdXQgYSBrbm93blxuICAgICAqIGJhc2UgZG9jdW1lbnQpLlxuICAgICAqLyAgICBzdGF0aWMgbmV3VW5rbm93bkRvY3VtZW50KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBxdCh0LCAzIC8qIFVOS05PV05fRE9DVU1FTlQgKi8gLCBlLCBCdC5lbXB0eSgpLCAyIC8qIEhBU19DT01NSVRURURfTVVUQVRJT05TICovKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2hhbmdlcyB0aGUgZG9jdW1lbnQgdHlwZSB0byBpbmRpY2F0ZSB0aGF0IGl0IGV4aXN0cyBhbmQgdGhhdCBpdHMgdmVyc2lvblxuICAgICAqIGFuZCBkYXRhIGFyZSBrbm93bi5cbiAgICAgKi8gICAgY29udmVydFRvRm91bmREb2N1bWVudCh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnZlcnNpb24gPSB0LCB0aGlzLmRvY3VtZW50VHlwZSA9IDEgLyogRk9VTkRfRE9DVU1FTlQgKi8gLCB0aGlzLmRhdGEgPSBlLCBcbiAgICAgICAgdGhpcy5kb2N1bWVudFN0YXRlID0gMCAvKiBTWU5DRUQgKi8gLCB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDaGFuZ2VzIHRoZSBkb2N1bWVudCB0eXBlIHRvIGluZGljYXRlIHRoYXQgaXQgZG9lc24ndCBleGlzdCBhdCB0aGUgZ2l2ZW5cbiAgICAgKiB2ZXJzaW9uLlxuICAgICAqLyAgICBjb252ZXJ0VG9Ob0RvY3VtZW50KHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudmVyc2lvbiA9IHQsIHRoaXMuZG9jdW1lbnRUeXBlID0gMiAvKiBOT19ET0NVTUVOVCAqLyAsIHRoaXMuZGF0YSA9IEJ0LmVtcHR5KCksIFxuICAgICAgICB0aGlzLmRvY3VtZW50U3RhdGUgPSAwIC8qIFNZTkNFRCAqLyAsIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENoYW5nZXMgdGhlIGRvY3VtZW50IHR5cGUgdG8gaW5kaWNhdGUgdGhhdCBpdCBleGlzdHMgYXQgYSBnaXZlbiB2ZXJzaW9uIGJ1dFxuICAgICAqIHRoYXQgaXRzIGRhdGEgaXMgbm90IGtub3duIChlLmcuIGEgZG9jdW1lbnQgdGhhdCB3YXMgdXBkYXRlZCB3aXRob3V0IGEga25vd25cbiAgICAgKiBiYXNlIGRvY3VtZW50KS5cbiAgICAgKi8gICAgY29udmVydFRvVW5rbm93bkRvY3VtZW50KHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudmVyc2lvbiA9IHQsIHRoaXMuZG9jdW1lbnRUeXBlID0gMyAvKiBVTktOT1dOX0RPQ1VNRU5UICovICwgdGhpcy5kYXRhID0gQnQuZW1wdHkoKSwgXG4gICAgICAgIHRoaXMuZG9jdW1lbnRTdGF0ZSA9IDIgLyogSEFTX0NPTU1JVFRFRF9NVVRBVElPTlMgKi8gLCB0aGlzO1xuICAgIH1cbiAgICBzZXRIYXNDb21taXR0ZWRNdXRhdGlvbnMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRvY3VtZW50U3RhdGUgPSAyIC8qIEhBU19DT01NSVRURURfTVVUQVRJT05TICovICwgdGhpcztcbiAgICB9XG4gICAgc2V0SGFzTG9jYWxNdXRhdGlvbnMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRvY3VtZW50U3RhdGUgPSAxIC8qIEhBU19MT0NBTF9NVVRBVElPTlMgKi8gLCB0aGlzO1xuICAgIH1cbiAgICBnZXQgaGFzTG9jYWxNdXRhdGlvbnMoKSB7XG4gICAgICAgIHJldHVybiAxIC8qIEhBU19MT0NBTF9NVVRBVElPTlMgKi8gPT09IHRoaXMuZG9jdW1lbnRTdGF0ZTtcbiAgICB9XG4gICAgZ2V0IGhhc0NvbW1pdHRlZE11dGF0aW9ucygpIHtcbiAgICAgICAgcmV0dXJuIDIgLyogSEFTX0NPTU1JVFRFRF9NVVRBVElPTlMgKi8gPT09IHRoaXMuZG9jdW1lbnRTdGF0ZTtcbiAgICB9XG4gICAgZ2V0IGhhc1BlbmRpbmdXcml0ZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmhhc0xvY2FsTXV0YXRpb25zIHx8IHRoaXMuaGFzQ29tbWl0dGVkTXV0YXRpb25zO1xuICAgIH1cbiAgICBpc1ZhbGlkRG9jdW1lbnQoKSB7XG4gICAgICAgIHJldHVybiAwIC8qIElOVkFMSUQgKi8gIT09IHRoaXMuZG9jdW1lbnRUeXBlO1xuICAgIH1cbiAgICBpc0ZvdW5kRG9jdW1lbnQoKSB7XG4gICAgICAgIHJldHVybiAxIC8qIEZPVU5EX0RPQ1VNRU5UICovID09PSB0aGlzLmRvY3VtZW50VHlwZTtcbiAgICB9XG4gICAgaXNOb0RvY3VtZW50KCkge1xuICAgICAgICByZXR1cm4gMiAvKiBOT19ET0NVTUVOVCAqLyA9PT0gdGhpcy5kb2N1bWVudFR5cGU7XG4gICAgfVxuICAgIGlzVW5rbm93bkRvY3VtZW50KCkge1xuICAgICAgICByZXR1cm4gMyAvKiBVTktOT1dOX0RPQ1VNRU5UICovID09PSB0aGlzLmRvY3VtZW50VHlwZTtcbiAgICB9XG4gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIHJldHVybiB0IGluc3RhbmNlb2YgcXQgJiYgdGhpcy5rZXkuaXNFcXVhbCh0LmtleSkgJiYgdGhpcy52ZXJzaW9uLmlzRXF1YWwodC52ZXJzaW9uKSAmJiB0aGlzLmRvY3VtZW50VHlwZSA9PT0gdC5kb2N1bWVudFR5cGUgJiYgdGhpcy5kb2N1bWVudFN0YXRlID09PSB0LmRvY3VtZW50U3RhdGUgJiYgdGhpcy5kYXRhLmlzRXF1YWwodC5kYXRhKTtcbiAgICB9XG4gICAgY2xvbmUoKSB7XG4gICAgICAgIHJldHVybiBuZXcgcXQodGhpcy5rZXksIHRoaXMuZG9jdW1lbnRUeXBlLCB0aGlzLnZlcnNpb24sIHRoaXMuZGF0YS5jbG9uZSgpLCB0aGlzLmRvY3VtZW50U3RhdGUpO1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIGBEb2N1bWVudCgke3RoaXMua2V5fSwgJHt0aGlzLnZlcnNpb259LCAke0pTT04uc3RyaW5naWZ5KHRoaXMuZGF0YS52YWx1ZSl9LCB7ZG9jdW1lbnRUeXBlOiAke3RoaXMuZG9jdW1lbnRUeXBlfX0pLCB7ZG9jdW1lbnRTdGF0ZTogJHt0aGlzLmRvY3VtZW50U3RhdGV9fSlgO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDb21wYXJlcyB0aGUgdmFsdWUgZm9yIGZpZWxkIGBmaWVsZGAgaW4gdGhlIHByb3ZpZGVkIGRvY3VtZW50cy4gVGhyb3dzIGlmXG4gKiB0aGUgZmllbGQgZG9lcyBub3QgZXhpc3QgaW4gYm90aCBkb2N1bWVudHMuXG4gKi9cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vLyBWaXNpYmxlIGZvciB0ZXN0aW5nXG5jbGFzcyBLdCB7XG4gICAgY29uc3RydWN0b3IodCwgZSA9IG51bGwsIG4gPSBbXSwgcyA9IFtdLCBpID0gbnVsbCwgciA9IG51bGwsIG8gPSBudWxsKSB7XG4gICAgICAgIHRoaXMucGF0aCA9IHQsIHRoaXMuY29sbGVjdGlvbkdyb3VwID0gZSwgdGhpcy5vcmRlckJ5ID0gbiwgdGhpcy5maWx0ZXJzID0gcywgdGhpcy5saW1pdCA9IGksIFxuICAgICAgICB0aGlzLnN0YXJ0QXQgPSByLCB0aGlzLmVuZEF0ID0gbywgdGhpcy5BID0gbnVsbDtcbiAgICB9XG59XG5cbi8qKlxuICogSW5pdGlhbGl6ZXMgYSBUYXJnZXQgd2l0aCBhIHBhdGggYW5kIG9wdGlvbmFsIGFkZGl0aW9uYWwgcXVlcnkgY29uc3RyYWludHMuXG4gKiBQYXRoIG11c3QgY3VycmVudGx5IGJlIGVtcHR5IGlmIHRoaXMgaXMgYSBjb2xsZWN0aW9uIGdyb3VwIHF1ZXJ5LlxuICpcbiAqIE5PVEU6IHlvdSBzaG91bGQgYWx3YXlzIGNvbnN0cnVjdCBgVGFyZ2V0YCBmcm9tIGBRdWVyeS50b1RhcmdldGAgaW5zdGVhZCBvZlxuICogdXNpbmcgdGhpcyBmYWN0b3J5IG1ldGhvZCwgYmVjYXVzZSBgUXVlcnlgIHByb3ZpZGVzIGFuIGltcGxpY2l0IGBvcmRlckJ5YFxuICogcHJvcGVydHkuXG4gKi8gZnVuY3Rpb24ganQodCwgZSA9IG51bGwsIG4gPSBbXSwgcyA9IFtdLCBpID0gbnVsbCwgciA9IG51bGwsIG8gPSBudWxsKSB7XG4gICAgcmV0dXJuIG5ldyBLdCh0LCBlLCBuLCBzLCBpLCByLCBvKTtcbn1cblxuZnVuY3Rpb24gUXQodCkge1xuICAgIGNvbnN0IGUgPSBVKHQpO1xuICAgIGlmIChudWxsID09PSBlLkEpIHtcbiAgICAgICAgbGV0IHQgPSBlLnBhdGguY2Fub25pY2FsU3RyaW5nKCk7XG4gICAgICAgIG51bGwgIT09IGUuY29sbGVjdGlvbkdyb3VwICYmICh0ICs9IFwifGNnOlwiICsgZS5jb2xsZWN0aW9uR3JvdXApLCB0ICs9IFwifGY6XCIsIHQgKz0gZS5maWx0ZXJzLm1hcCgodCA9PiBKdCh0KSkpLmpvaW4oXCIsXCIpLCBcbiAgICAgICAgdCArPSBcInxvYjpcIiwgdCArPSBlLm9yZGVyQnkubWFwKCh0ID0+IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIC8vIFRPRE8oYi8yOTE4MzE2NSk6IE1ha2UgdGhpcyBjb2xsaXNpb24gcm9idXN0LlxuICAgICAgICAgICAgcmV0dXJuIHQuZmllbGQuY2Fub25pY2FsU3RyaW5nKCkgKyB0LmRpcjtcbiAgICAgICAgfSh0KSkpLmpvaW4oXCIsXCIpLCBJdChlLmxpbWl0KSB8fCAodCArPSBcInxsOlwiLCB0ICs9IGUubGltaXQpLCBlLnN0YXJ0QXQgJiYgKHQgKz0gXCJ8bGI6XCIsIFxuICAgICAgICB0ICs9IG9lKGUuc3RhcnRBdCkpLCBlLmVuZEF0ICYmICh0ICs9IFwifHViOlwiLCB0ICs9IG9lKGUuZW5kQXQpKSwgZS5BID0gdDtcbiAgICB9XG4gICAgcmV0dXJuIGUuQTtcbn1cblxuZnVuY3Rpb24gV3QodCkge1xuICAgIGxldCBlID0gdC5wYXRoLmNhbm9uaWNhbFN0cmluZygpO1xuICAgIHJldHVybiBudWxsICE9PSB0LmNvbGxlY3Rpb25Hcm91cCAmJiAoZSArPSBcIiBjb2xsZWN0aW9uR3JvdXA9XCIgKyB0LmNvbGxlY3Rpb25Hcm91cCksIFxuICAgIHQuZmlsdGVycy5sZW5ndGggPiAwICYmIChlICs9IGAsIGZpbHRlcnM6IFske3QuZmlsdGVycy5tYXAoKHQgPT4ge1xuICAgICAgICByZXR1cm4gYCR7KGUgPSB0KS5maWVsZC5jYW5vbmljYWxTdHJpbmcoKX0gJHtlLm9wfSAke0N0KGUudmFsdWUpfWA7XG4gICAgICAgIC8qKiBSZXR1cm5zIGEgZGVidWcgZGVzY3JpcHRpb24gZm9yIGBmaWx0ZXJgLiAqL1xuICAgICAgICB2YXIgZTtcbiAgICAgICAgLyoqIEZpbHRlciB0aGF0IG1hdGNoZXMgb24ga2V5IGZpZWxkcyAoaS5lLiAnX19uYW1lX18nKS4gKi8gICAgfSkpLmpvaW4oXCIsIFwiKX1dYCksIFxuICAgIEl0KHQubGltaXQpIHx8IChlICs9IFwiLCBsaW1pdDogXCIgKyB0LmxpbWl0KSwgdC5vcmRlckJ5Lmxlbmd0aCA+IDAgJiYgKGUgKz0gYCwgb3JkZXJCeTogWyR7dC5vcmRlckJ5Lm1hcCgodCA9PiBmdW5jdGlvbih0KSB7XG4gICAgICAgIHJldHVybiBgJHt0LmZpZWxkLmNhbm9uaWNhbFN0cmluZygpfSAoJHt0LmRpcn0pYDtcbiAgICB9KHQpKSkuam9pbihcIiwgXCIpfV1gKSwgdC5zdGFydEF0ICYmIChlICs9IFwiLCBzdGFydEF0OiBcIiArIG9lKHQuc3RhcnRBdCkpLCB0LmVuZEF0ICYmIChlICs9IFwiLCBlbmRBdDogXCIgKyBvZSh0LmVuZEF0KSksIFxuICAgIGBUYXJnZXQoJHtlfSlgO1xufVxuXG5mdW5jdGlvbiBHdCh0LCBlKSB7XG4gICAgaWYgKHQubGltaXQgIT09IGUubGltaXQpIHJldHVybiAhMTtcbiAgICBpZiAodC5vcmRlckJ5Lmxlbmd0aCAhPT0gZS5vcmRlckJ5Lmxlbmd0aCkgcmV0dXJuICExO1xuICAgIGZvciAobGV0IG4gPSAwOyBuIDwgdC5vcmRlckJ5Lmxlbmd0aDsgbisrKSBpZiAoIWNlKHQub3JkZXJCeVtuXSwgZS5vcmRlckJ5W25dKSkgcmV0dXJuICExO1xuICAgIGlmICh0LmZpbHRlcnMubGVuZ3RoICE9PSBlLmZpbHRlcnMubGVuZ3RoKSByZXR1cm4gITE7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0LmZpbHRlcnMubGVuZ3RoOyBpKyspIGlmIChuID0gdC5maWx0ZXJzW2ldLCBzID0gZS5maWx0ZXJzW2ldLCBcbiAgICBuLm9wICE9PSBzLm9wIHx8ICFuLmZpZWxkLmlzRXF1YWwocy5maWVsZCkgfHwgIXZ0KG4udmFsdWUsIHMudmFsdWUpKSByZXR1cm4gITE7XG4gICAgdmFyIG4sIHM7XG4gICAgcmV0dXJuIHQuY29sbGVjdGlvbkdyb3VwID09PSBlLmNvbGxlY3Rpb25Hcm91cCAmJiAoISF0LnBhdGguaXNFcXVhbChlLnBhdGgpICYmICghIWhlKHQuc3RhcnRBdCwgZS5zdGFydEF0KSAmJiBoZSh0LmVuZEF0LCBlLmVuZEF0KSkpO1xufVxuXG5mdW5jdGlvbiB6dCh0KSB7XG4gICAgcmV0dXJuIFB0LmlzRG9jdW1lbnRLZXkodC5wYXRoKSAmJiBudWxsID09PSB0LmNvbGxlY3Rpb25Hcm91cCAmJiAwID09PSB0LmZpbHRlcnMubGVuZ3RoO1xufVxuXG5jbGFzcyBIdCBleHRlbmRzIGNsYXNzIHt9IHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMuZmllbGQgPSB0LCB0aGlzLm9wID0gZSwgdGhpcy52YWx1ZSA9IG47XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBmaWx0ZXIgYmFzZWQgb24gdGhlIHByb3ZpZGVkIGFyZ3VtZW50cy5cbiAgICAgKi8gICAgc3RhdGljIGNyZWF0ZSh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiB0LmlzS2V5RmllbGQoKSA/IFwiaW5cIiAvKiBJTiAqLyA9PT0gZSB8fCBcIm5vdC1pblwiIC8qIE5PVF9JTiAqLyA9PT0gZSA/IHRoaXMuUih0LCBlLCBuKSA6IG5ldyBZdCh0LCBlLCBuKSA6IFwiYXJyYXktY29udGFpbnNcIiAvKiBBUlJBWV9DT05UQUlOUyAqLyA9PT0gZSA/IG5ldyBlZSh0LCBuKSA6IFwiaW5cIiAvKiBJTiAqLyA9PT0gZSA/IG5ldyBuZSh0LCBuKSA6IFwibm90LWluXCIgLyogTk9UX0lOICovID09PSBlID8gbmV3IHNlKHQsIG4pIDogXCJhcnJheS1jb250YWlucy1hbnlcIiAvKiBBUlJBWV9DT05UQUlOU19BTlkgKi8gPT09IGUgPyBuZXcgaWUodCwgbikgOiBuZXcgSHQodCwgZSwgbik7XG4gICAgfVxuICAgIHN0YXRpYyBSKHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIFwiaW5cIiAvKiBJTiAqLyA9PT0gZSA/IG5ldyBYdCh0LCBuKSA6IG5ldyBadCh0LCBuKTtcbiAgICB9XG4gICAgbWF0Y2hlcyh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0LmRhdGEuZmllbGQodGhpcy5maWVsZCk7XG4gICAgICAgIC8vIFR5cGVzIGRvIG5vdCBoYXZlIHRvIG1hdGNoIGluIE5PVF9FUVVBTCBmaWx0ZXJzLlxuICAgICAgICAgICAgICAgIHJldHVybiBcIiE9XCIgLyogTk9UX0VRVUFMICovID09PSB0aGlzLm9wID8gbnVsbCAhPT0gZSAmJiB0aGlzLlAoU3QoZSwgdGhpcy52YWx1ZSkpIDogbnVsbCAhPT0gZSAmJiBidCh0aGlzLnZhbHVlKSA9PT0gYnQoZSkgJiYgdGhpcy5QKFN0KGUsIHRoaXMudmFsdWUpKTtcbiAgICAgICAgLy8gT25seSBjb21wYXJlIHR5cGVzIHdpdGggbWF0Y2hpbmcgYmFja2VuZCBvcmRlciAoc3VjaCBhcyBkb3VibGUgYW5kIGludCkuXG4gICAgICAgIH1cbiAgICBQKHQpIHtcbiAgICAgICAgc3dpdGNoICh0aGlzLm9wKSB7XG4gICAgICAgICAgY2FzZSBcIjxcIiAvKiBMRVNTX1RIQU4gKi8gOlxuICAgICAgICAgICAgcmV0dXJuIHQgPCAwO1xuXG4gICAgICAgICAgY2FzZSBcIjw9XCIgLyogTEVTU19USEFOX09SX0VRVUFMICovIDpcbiAgICAgICAgICAgIHJldHVybiB0IDw9IDA7XG5cbiAgICAgICAgICBjYXNlIFwiPT1cIiAvKiBFUVVBTCAqLyA6XG4gICAgICAgICAgICByZXR1cm4gMCA9PT0gdDtcblxuICAgICAgICAgIGNhc2UgXCIhPVwiIC8qIE5PVF9FUVVBTCAqLyA6XG4gICAgICAgICAgICByZXR1cm4gMCAhPT0gdDtcblxuICAgICAgICAgIGNhc2UgXCI+XCIgLyogR1JFQVRFUl9USEFOICovIDpcbiAgICAgICAgICAgIHJldHVybiB0ID4gMDtcblxuICAgICAgICAgIGNhc2UgXCI+PVwiIC8qIEdSRUFURVJfVEhBTl9PUl9FUVVBTCAqLyA6XG4gICAgICAgICAgICByZXR1cm4gdCA+PSAwO1xuXG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBNKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdigpIHtcbiAgICAgICAgcmV0dXJuIFsgXCI8XCIgLyogTEVTU19USEFOICovICwgXCI8PVwiIC8qIExFU1NfVEhBTl9PUl9FUVVBTCAqLyAsIFwiPlwiIC8qIEdSRUFURVJfVEhBTiAqLyAsIFwiPj1cIiAvKiBHUkVBVEVSX1RIQU5fT1JfRVFVQUwgKi8gLCBcIiE9XCIgLyogTk9UX0VRVUFMICovICwgXCJub3QtaW5cIiAvKiBOT1RfSU4gKi8gXS5pbmRleE9mKHRoaXMub3ApID49IDA7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBKdCh0KSB7XG4gICAgLy8gVE9ETyhiLzI5MTgzMTY1KTogVGVjaG5pY2FsbHksIHRoaXMgd29uJ3QgYmUgdW5pcXVlIGlmIHR3byB2YWx1ZXMgaGF2ZVxuICAgIC8vIHRoZSBzYW1lIGRlc2NyaXB0aW9uLCBzdWNoIGFzIHRoZSBpbnQgMyBhbmQgdGhlIHN0cmluZyBcIjNcIi4gU28gd2Ugc2hvdWxkXG4gICAgLy8gYWRkIHRoZSB0eXBlcyBpbiBoZXJlIHNvbWVob3csIHRvby5cbiAgICByZXR1cm4gdC5maWVsZC5jYW5vbmljYWxTdHJpbmcoKSArIHQub3AudG9TdHJpbmcoKSArIEN0KHQudmFsdWUpO1xufVxuXG5jbGFzcyBZdCBleHRlbmRzIEh0IHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHN1cGVyKHQsIGUsIG4pLCB0aGlzLmtleSA9IFB0LmZyb21OYW1lKG4ucmVmZXJlbmNlVmFsdWUpO1xuICAgIH1cbiAgICBtYXRjaGVzKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IFB0LmNvbXBhcmF0b3IodC5rZXksIHRoaXMua2V5KTtcbiAgICAgICAgcmV0dXJuIHRoaXMuUChlKTtcbiAgICB9XG59XG5cbi8qKiBGaWx0ZXIgdGhhdCBtYXRjaGVzIG9uIGtleSBmaWVsZHMgd2l0aGluIGFuIGFycmF5LiAqLyBjbGFzcyBYdCBleHRlbmRzIEh0IHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHN1cGVyKHQsIFwiaW5cIiAvKiBJTiAqLyAsIGUpLCB0aGlzLmtleXMgPSB0ZShcImluXCIgLyogSU4gKi8gLCBlKTtcbiAgICB9XG4gICAgbWF0Y2hlcyh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmtleXMuc29tZSgoZSA9PiBlLmlzRXF1YWwodC5rZXkpKSk7XG4gICAgfVxufVxuXG4vKiogRmlsdGVyIHRoYXQgbWF0Y2hlcyBvbiBrZXkgZmllbGRzIG5vdCBwcmVzZW50IHdpdGhpbiBhbiBhcnJheS4gKi8gY2xhc3MgWnQgZXh0ZW5kcyBIdCB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICBzdXBlcih0LCBcIm5vdC1pblwiIC8qIE5PVF9JTiAqLyAsIGUpLCB0aGlzLmtleXMgPSB0ZShcIm5vdC1pblwiIC8qIE5PVF9JTiAqLyAsIGUpO1xuICAgIH1cbiAgICBtYXRjaGVzKHQpIHtcbiAgICAgICAgcmV0dXJuICF0aGlzLmtleXMuc29tZSgoZSA9PiBlLmlzRXF1YWwodC5rZXkpKSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiB0ZSh0LCBlKSB7XG4gICAgdmFyIG47XG4gICAgcmV0dXJuICgobnVsbCA9PT0gKG4gPSBlLmFycmF5VmFsdWUpIHx8IHZvaWQgMCA9PT0gbiA/IHZvaWQgMCA6IG4udmFsdWVzKSB8fCBbXSkubWFwKCh0ID0+IFB0LmZyb21OYW1lKHQucmVmZXJlbmNlVmFsdWUpKSk7XG59XG5cbi8qKiBBIEZpbHRlciB0aGF0IGltcGxlbWVudHMgdGhlIGFycmF5LWNvbnRhaW5zIG9wZXJhdG9yLiAqLyBjbGFzcyBlZSBleHRlbmRzIEh0IHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHN1cGVyKHQsIFwiYXJyYXktY29udGFpbnNcIiAvKiBBUlJBWV9DT05UQUlOUyAqLyAsIGUpO1xuICAgIH1cbiAgICBtYXRjaGVzKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHQuZGF0YS5maWVsZCh0aGlzLmZpZWxkKTtcbiAgICAgICAgcmV0dXJuICR0KGUpICYmIFZ0KGUuYXJyYXlWYWx1ZSwgdGhpcy52YWx1ZSk7XG4gICAgfVxufVxuXG4vKiogQSBGaWx0ZXIgdGhhdCBpbXBsZW1lbnRzIHRoZSBJTiBvcGVyYXRvci4gKi8gY2xhc3MgbmUgZXh0ZW5kcyBIdCB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICBzdXBlcih0LCBcImluXCIgLyogSU4gKi8gLCBlKTtcbiAgICB9XG4gICAgbWF0Y2hlcyh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0LmRhdGEuZmllbGQodGhpcy5maWVsZCk7XG4gICAgICAgIHJldHVybiBudWxsICE9PSBlICYmIFZ0KHRoaXMudmFsdWUuYXJyYXlWYWx1ZSwgZSk7XG4gICAgfVxufVxuXG4vKiogQSBGaWx0ZXIgdGhhdCBpbXBsZW1lbnRzIHRoZSBub3QtaW4gb3BlcmF0b3IuICovIGNsYXNzIHNlIGV4dGVuZHMgSHQge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgc3VwZXIodCwgXCJub3QtaW5cIiAvKiBOT1RfSU4gKi8gLCBlKTtcbiAgICB9XG4gICAgbWF0Y2hlcyh0KSB7XG4gICAgICAgIGlmIChWdCh0aGlzLnZhbHVlLmFycmF5VmFsdWUsIHtcbiAgICAgICAgICAgIG51bGxWYWx1ZTogXCJOVUxMX1ZBTFVFXCJcbiAgICAgICAgfSkpIHJldHVybiAhMTtcbiAgICAgICAgY29uc3QgZSA9IHQuZGF0YS5maWVsZCh0aGlzLmZpZWxkKTtcbiAgICAgICAgcmV0dXJuIG51bGwgIT09IGUgJiYgIVZ0KHRoaXMudmFsdWUuYXJyYXlWYWx1ZSwgZSk7XG4gICAgfVxufVxuXG4vKiogQSBGaWx0ZXIgdGhhdCBpbXBsZW1lbnRzIHRoZSBhcnJheS1jb250YWlucy1hbnkgb3BlcmF0b3IuICovIGNsYXNzIGllIGV4dGVuZHMgSHQge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgc3VwZXIodCwgXCJhcnJheS1jb250YWlucy1hbnlcIiAvKiBBUlJBWV9DT05UQUlOU19BTlkgKi8gLCBlKTtcbiAgICB9XG4gICAgbWF0Y2hlcyh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0LmRhdGEuZmllbGQodGhpcy5maWVsZCk7XG4gICAgICAgIHJldHVybiAhKCEkdChlKSB8fCAhZS5hcnJheVZhbHVlLnZhbHVlcykgJiYgZS5hcnJheVZhbHVlLnZhbHVlcy5zb21lKCh0ID0+IFZ0KHRoaXMudmFsdWUuYXJyYXlWYWx1ZSwgdCkpKTtcbiAgICB9XG59XG5cbi8qKlxuICogUmVwcmVzZW50cyBhIGJvdW5kIG9mIGEgcXVlcnkuXG4gKlxuICogVGhlIGJvdW5kIGlzIHNwZWNpZmllZCB3aXRoIHRoZSBnaXZlbiBjb21wb25lbnRzIHJlcHJlc2VudGluZyBhIHBvc2l0aW9uIGFuZFxuICogd2hldGhlciBpdCdzIGp1c3QgYmVmb3JlIG9yIGp1c3QgYWZ0ZXIgdGhlIHBvc2l0aW9uIChyZWxhdGl2ZSB0byB3aGF0ZXZlciB0aGVcbiAqIHF1ZXJ5IG9yZGVyIGlzKS5cbiAqXG4gKiBUaGUgcG9zaXRpb24gcmVwcmVzZW50cyBhIGxvZ2ljYWwgaW5kZXggcG9zaXRpb24gZm9yIGEgcXVlcnkuIEl0J3MgYSBwcmVmaXhcbiAqIG9mIHZhbHVlcyBmb3IgdGhlIChwb3RlbnRpYWxseSBpbXBsaWNpdCkgb3JkZXIgYnkgY2xhdXNlcyBvZiBhIHF1ZXJ5LlxuICpcbiAqIEJvdW5kIHByb3ZpZGVzIGEgZnVuY3Rpb24gdG8gZGV0ZXJtaW5lIHdoZXRoZXIgYSBkb2N1bWVudCBjb21lcyBiZWZvcmUgb3JcbiAqIGFmdGVyIGEgYm91bmQuIFRoaXMgaXMgaW5mbHVlbmNlZCBieSB3aGV0aGVyIHRoZSBwb3NpdGlvbiBpcyBqdXN0IGJlZm9yZSBvclxuICoganVzdCBhZnRlciB0aGUgcHJvdmlkZWQgdmFsdWVzLlxuICovIGNsYXNzIHJlIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMucG9zaXRpb24gPSB0LCB0aGlzLmJlZm9yZSA9IGU7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBvZSh0KSB7XG4gICAgLy8gVE9ETyhiLzI5MTgzMTY1KTogTWFrZSB0aGlzIGNvbGxpc2lvbiByb2J1c3QuXG4gICAgcmV0dXJuIGAke3QuYmVmb3JlID8gXCJiXCIgOiBcImFcIn06JHt0LnBvc2l0aW9uLm1hcCgodCA9PiBDdCh0KSkpLmpvaW4oXCIsXCIpfWA7XG59XG5cbi8qKlxuICogQW4gb3JkZXJpbmcgb24gYSBmaWVsZCwgaW4gc29tZSBEaXJlY3Rpb24uIERpcmVjdGlvbiBkZWZhdWx0cyB0byBBU0NFTkRJTkcuXG4gKi8gY2xhc3MgYWUge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUgPSBcImFzY1wiIC8qIEFTQ0VORElORyAqLykge1xuICAgICAgICB0aGlzLmZpZWxkID0gdCwgdGhpcy5kaXIgPSBlO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gY2UodCwgZSkge1xuICAgIHJldHVybiB0LmRpciA9PT0gZS5kaXIgJiYgdC5maWVsZC5pc0VxdWFsKGUuZmllbGQpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdHJ1ZSBpZiBhIGRvY3VtZW50IHNvcnRzIGJlZm9yZSBhIGJvdW5kIHVzaW5nIHRoZSBwcm92aWRlZCBzb3J0XG4gKiBvcmRlci5cbiAqLyBmdW5jdGlvbiB1ZSh0LCBlLCBuKSB7XG4gICAgbGV0IHMgPSAwO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdC5wb3NpdGlvbi5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCByID0gZVtpXSwgbyA9IHQucG9zaXRpb25baV07XG4gICAgICAgIGlmIChyLmZpZWxkLmlzS2V5RmllbGQoKSkgcyA9IFB0LmNvbXBhcmF0b3IoUHQuZnJvbU5hbWUoby5yZWZlcmVuY2VWYWx1ZSksIG4ua2V5KTsgZWxzZSB7XG4gICAgICAgICAgICBzID0gU3Qobywgbi5kYXRhLmZpZWxkKHIuZmllbGQpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoXCJkZXNjXCIgLyogREVTQ0VORElORyAqLyA9PT0gci5kaXIgJiYgKHMgKj0gLTEpLCAwICE9PSBzKSBicmVhaztcbiAgICB9XG4gICAgcmV0dXJuIHQuYmVmb3JlID8gcyA8PSAwIDogcyA8IDA7XG59XG5cbmZ1bmN0aW9uIGhlKHQsIGUpIHtcbiAgICBpZiAobnVsbCA9PT0gdCkgcmV0dXJuIG51bGwgPT09IGU7XG4gICAgaWYgKG51bGwgPT09IGUpIHJldHVybiAhMTtcbiAgICBpZiAodC5iZWZvcmUgIT09IGUuYmVmb3JlIHx8IHQucG9zaXRpb24ubGVuZ3RoICE9PSBlLnBvc2l0aW9uLmxlbmd0aCkgcmV0dXJuICExO1xuICAgIGZvciAobGV0IG4gPSAwOyBuIDwgdC5wb3NpdGlvbi5sZW5ndGg7IG4rKykge1xuICAgICAgICBpZiAoIXZ0KHQucG9zaXRpb25bbl0sIGUucG9zaXRpb25bbl0pKSByZXR1cm4gITE7XG4gICAgfVxuICAgIHJldHVybiAhMDtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUXVlcnkgZW5jYXBzdWxhdGVzIGFsbCB0aGUgcXVlcnkgYXR0cmlidXRlcyB3ZSBzdXBwb3J0IGluIHRoZSBTREsuIEl0IGNhblxuICogYmUgcnVuIGFnYWluc3QgdGhlIExvY2FsU3RvcmUsIGFzIHdlbGwgYXMgYmUgY29udmVydGVkIHRvIGEgYFRhcmdldGAgdG9cbiAqIHF1ZXJ5IHRoZSBSZW1vdGVTdG9yZSByZXN1bHRzLlxuICpcbiAqIFZpc2libGUgZm9yIHRlc3RpbmcuXG4gKi8gY2xhc3MgbGUge1xuICAgIC8qKlxuICAgICAqIEluaXRpYWxpemVzIGEgUXVlcnkgd2l0aCBhIHBhdGggYW5kIG9wdGlvbmFsIGFkZGl0aW9uYWwgcXVlcnkgY29uc3RyYWludHMuXG4gICAgICogUGF0aCBtdXN0IGN1cnJlbnRseSBiZSBlbXB0eSBpZiB0aGlzIGlzIGEgY29sbGVjdGlvbiBncm91cCBxdWVyeS5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih0LCBlID0gbnVsbCwgbiA9IFtdLCBzID0gW10sIGkgPSBudWxsLCByID0gXCJGXCIgLyogRmlyc3QgKi8gLCBvID0gbnVsbCwgYSA9IG51bGwpIHtcbiAgICAgICAgdGhpcy5wYXRoID0gdCwgdGhpcy5jb2xsZWN0aW9uR3JvdXAgPSBlLCB0aGlzLmV4cGxpY2l0T3JkZXJCeSA9IG4sIHRoaXMuZmlsdGVycyA9IHMsIFxuICAgICAgICB0aGlzLmxpbWl0ID0gaSwgdGhpcy5saW1pdFR5cGUgPSByLCB0aGlzLnN0YXJ0QXQgPSBvLCB0aGlzLmVuZEF0ID0gYSwgdGhpcy5WID0gbnVsbCwgXG4gICAgICAgIC8vIFRoZSBjb3JyZXNwb25kaW5nIGBUYXJnZXRgIG9mIHRoaXMgYFF1ZXJ5YCBpbnN0YW5jZS5cbiAgICAgICAgdGhpcy5TID0gbnVsbCwgdGhpcy5zdGFydEF0LCB0aGlzLmVuZEF0O1xuICAgIH1cbn1cblxuLyoqIENyZWF0ZXMgYSBuZXcgUXVlcnkgaW5zdGFuY2Ugd2l0aCB0aGUgb3B0aW9ucyBwcm92aWRlZC4gKi8gZnVuY3Rpb24gZmUodCwgZSwgbiwgcywgaSwgciwgbywgYSkge1xuICAgIHJldHVybiBuZXcgbGUodCwgZSwgbiwgcywgaSwgciwgbywgYSk7XG59XG5cbi8qKiBDcmVhdGVzIGEgbmV3IFF1ZXJ5IGZvciBhIHF1ZXJ5IHRoYXQgbWF0Y2hlcyBhbGwgZG9jdW1lbnRzIGF0IGBwYXRoYCAqLyBmdW5jdGlvbiBkZSh0KSB7XG4gICAgcmV0dXJuIG5ldyBsZSh0KTtcbn1cblxuLyoqXG4gKiBIZWxwZXIgdG8gY29udmVydCBhIGNvbGxlY3Rpb24gZ3JvdXAgcXVlcnkgaW50byBhIGNvbGxlY3Rpb24gcXVlcnkgYXQgYVxuICogc3BlY2lmaWMgcGF0aC4gVGhpcyBpcyB1c2VkIHdoZW4gZXhlY3V0aW5nIGNvbGxlY3Rpb24gZ3JvdXAgcXVlcmllcywgc2luY2VcbiAqIHdlIGhhdmUgdG8gc3BsaXQgdGhlIHF1ZXJ5IGludG8gYSBzZXQgb2YgY29sbGVjdGlvbiBxdWVyaWVzIGF0IG11bHRpcGxlXG4gKiBwYXRocy5cbiAqLyBmdW5jdGlvbiB3ZSh0KSB7XG4gICAgcmV0dXJuICFJdCh0LmxpbWl0KSAmJiBcIkZcIiAvKiBGaXJzdCAqLyA9PT0gdC5saW1pdFR5cGU7XG59XG5cbmZ1bmN0aW9uIF9lKHQpIHtcbiAgICByZXR1cm4gIUl0KHQubGltaXQpICYmIFwiTFwiIC8qIExhc3QgKi8gPT09IHQubGltaXRUeXBlO1xufVxuXG5mdW5jdGlvbiBtZSh0KSB7XG4gICAgcmV0dXJuIHQuZXhwbGljaXRPcmRlckJ5Lmxlbmd0aCA+IDAgPyB0LmV4cGxpY2l0T3JkZXJCeVswXS5maWVsZCA6IG51bGw7XG59XG5cbmZ1bmN0aW9uIGdlKHQpIHtcbiAgICBmb3IgKGNvbnN0IGUgb2YgdC5maWx0ZXJzKSBpZiAoZS52KCkpIHJldHVybiBlLmZpZWxkO1xuICAgIHJldHVybiBudWxsO1xufVxuXG4vKipcbiAqIENoZWNrcyBpZiBhbnkgb2YgdGhlIHByb3ZpZGVkIE9wZXJhdG9ycyBhcmUgaW5jbHVkZWQgaW4gdGhlIHF1ZXJ5IGFuZFxuICogcmV0dXJucyB0aGUgZmlyc3Qgb25lIHRoYXQgaXMsIG9yIG51bGwgaWYgbm9uZSBhcmUuXG4gKi9cbi8qKlxuICogUmV0dXJucyB3aGV0aGVyIHRoZSBxdWVyeSBtYXRjaGVzIGEgY29sbGVjdGlvbiBncm91cCByYXRoZXIgdGhhbiBhIHNwZWNpZmljXG4gKiBjb2xsZWN0aW9uLlxuICovXG5mdW5jdGlvbiB5ZSh0KSB7XG4gICAgcmV0dXJuIG51bGwgIT09IHQuY29sbGVjdGlvbkdyb3VwO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIGltcGxpY2l0IG9yZGVyIGJ5IGNvbnN0cmFpbnQgdGhhdCBpcyB1c2VkIHRvIGV4ZWN1dGUgdGhlIFF1ZXJ5LFxuICogd2hpY2ggY2FuIGJlIGRpZmZlcmVudCBmcm9tIHRoZSBvcmRlciBieSBjb25zdHJhaW50cyB0aGUgdXNlciBwcm92aWRlZCAoZS5nLlxuICogdGhlIFNESyBhbmQgYmFja2VuZCBhbHdheXMgb3JkZXJzIGJ5IGBfX25hbWVfX2ApLlxuICovIGZ1bmN0aW9uIHBlKHQpIHtcbiAgICBjb25zdCBlID0gVSh0KTtcbiAgICBpZiAobnVsbCA9PT0gZS5WKSB7XG4gICAgICAgIGUuViA9IFtdO1xuICAgICAgICBjb25zdCB0ID0gZ2UoZSksIG4gPSBtZShlKTtcbiAgICAgICAgaWYgKG51bGwgIT09IHQgJiYgbnVsbCA9PT0gbikgXG4gICAgICAgIC8vIEluIG9yZGVyIHRvIGltcGxpY2l0bHkgYWRkIGtleSBvcmRlcmluZywgd2UgbXVzdCBhbHNvIGFkZCB0aGVcbiAgICAgICAgLy8gaW5lcXVhbGl0eSBmaWx0ZXIgZmllbGQgZm9yIGl0IHRvIGJlIGEgdmFsaWQgcXVlcnkuXG4gICAgICAgIC8vIE5vdGUgdGhhdCB0aGUgZGVmYXVsdCBpbmVxdWFsaXR5IGZpZWxkIGFuZCBrZXkgb3JkZXJpbmcgaXMgYXNjZW5kaW5nLlxuICAgICAgICB0LmlzS2V5RmllbGQoKSB8fCBlLlYucHVzaChuZXcgYWUodCkpLCBlLlYucHVzaChuZXcgYWUobHQua2V5RmllbGQoKSwgXCJhc2NcIiAvKiBBU0NFTkRJTkcgKi8pKTsgZWxzZSB7XG4gICAgICAgICAgICBsZXQgdCA9ICExO1xuICAgICAgICAgICAgZm9yIChjb25zdCBuIG9mIGUuZXhwbGljaXRPcmRlckJ5KSBlLlYucHVzaChuKSwgbi5maWVsZC5pc0tleUZpZWxkKCkgJiYgKHQgPSAhMCk7XG4gICAgICAgICAgICBpZiAoIXQpIHtcbiAgICAgICAgICAgICAgICAvLyBUaGUgb3JkZXIgb2YgdGhlIGltcGxpY2l0IGtleSBvcmRlcmluZyBhbHdheXMgbWF0Y2hlcyB0aGUgbGFzdFxuICAgICAgICAgICAgICAgIC8vIGV4cGxpY2l0IG9yZGVyIGJ5XG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IGUuZXhwbGljaXRPcmRlckJ5Lmxlbmd0aCA+IDAgPyBlLmV4cGxpY2l0T3JkZXJCeVtlLmV4cGxpY2l0T3JkZXJCeS5sZW5ndGggLSAxXS5kaXIgOiBcImFzY1wiIC8qIEFTQ0VORElORyAqLztcbiAgICAgICAgICAgICAgICBlLlYucHVzaChuZXcgYWUobHQua2V5RmllbGQoKSwgdCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBlLlY7XG59XG5cbi8qKlxuICogQ29udmVydHMgdGhpcyBgUXVlcnlgIGluc3RhbmNlIHRvIGl0J3MgY29ycmVzcG9uZGluZyBgVGFyZ2V0YCByZXByZXNlbnRhdGlvbi5cbiAqLyBmdW5jdGlvbiBFZSh0KSB7XG4gICAgY29uc3QgZSA9IFUodCk7XG4gICAgaWYgKCFlLlMpIGlmIChcIkZcIiAvKiBGaXJzdCAqLyA9PT0gZS5saW1pdFR5cGUpIGUuUyA9IGp0KGUucGF0aCwgZS5jb2xsZWN0aW9uR3JvdXAsIHBlKGUpLCBlLmZpbHRlcnMsIGUubGltaXQsIGUuc3RhcnRBdCwgZS5lbmRBdCk7IGVsc2Uge1xuICAgICAgICAvLyBGbGlwIHRoZSBvcmRlckJ5IGRpcmVjdGlvbnMgc2luY2Ugd2Ugd2FudCB0aGUgbGFzdCByZXN1bHRzXG4gICAgICAgIGNvbnN0IHQgPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCBuIG9mIHBlKGUpKSB7XG4gICAgICAgICAgICBjb25zdCBlID0gXCJkZXNjXCIgLyogREVTQ0VORElORyAqLyA9PT0gbi5kaXIgPyBcImFzY1wiIC8qIEFTQ0VORElORyAqLyA6IFwiZGVzY1wiIC8qIERFU0NFTkRJTkcgKi87XG4gICAgICAgICAgICB0LnB1c2gobmV3IGFlKG4uZmllbGQsIGUpKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBXZSBuZWVkIHRvIHN3YXAgdGhlIGN1cnNvcnMgdG8gbWF0Y2ggdGhlIG5vdy1mbGlwcGVkIHF1ZXJ5IG9yZGVyaW5nLlxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBlLmVuZEF0ID8gbmV3IHJlKGUuZW5kQXQucG9zaXRpb24sICFlLmVuZEF0LmJlZm9yZSkgOiBudWxsLCBzID0gZS5zdGFydEF0ID8gbmV3IHJlKGUuc3RhcnRBdC5wb3NpdGlvbiwgIWUuc3RhcnRBdC5iZWZvcmUpIDogbnVsbDtcbiAgICAgICAgLy8gTm93IHJldHVybiBhcyBhIExpbWl0VHlwZS5GaXJzdCBxdWVyeS5cbiAgICAgICAgZS5TID0ganQoZS5wYXRoLCBlLmNvbGxlY3Rpb25Hcm91cCwgdCwgZS5maWx0ZXJzLCBlLmxpbWl0LCBuLCBzKTtcbiAgICB9XG4gICAgcmV0dXJuIGUuUztcbn1cblxuZnVuY3Rpb24gVGUodCwgZSwgbikge1xuICAgIHJldHVybiBuZXcgbGUodC5wYXRoLCB0LmNvbGxlY3Rpb25Hcm91cCwgdC5leHBsaWNpdE9yZGVyQnkuc2xpY2UoKSwgdC5maWx0ZXJzLnNsaWNlKCksIGUsIG4sIHQuc3RhcnRBdCwgdC5lbmRBdCk7XG59XG5cbmZ1bmN0aW9uIEllKHQsIGUpIHtcbiAgICByZXR1cm4gR3QoRWUodCksIEVlKGUpKSAmJiB0LmxpbWl0VHlwZSA9PT0gZS5saW1pdFR5cGU7XG59XG5cbi8vIFRPRE8oYi8yOTE4MzE2NSk6IFRoaXMgaXMgdXNlZCB0byBnZXQgYSB1bmlxdWUgc3RyaW5nIGZyb20gYSBxdWVyeSB0bywgZm9yXG4vLyBleGFtcGxlLCB1c2UgYXMgYSBkaWN0aW9uYXJ5IGtleSwgYnV0IHRoZSBpbXBsZW1lbnRhdGlvbiBpcyBzdWJqZWN0IHRvXG4vLyBjb2xsaXNpb25zLiBNYWtlIGl0IGNvbGxpc2lvbi1mcmVlLlxuZnVuY3Rpb24gQWUodCkge1xuICAgIHJldHVybiBgJHtRdChFZSh0KSl9fGx0OiR7dC5saW1pdFR5cGV9YDtcbn1cblxuZnVuY3Rpb24gUmUodCkge1xuICAgIHJldHVybiBgUXVlcnkodGFyZ2V0PSR7V3QoRWUodCkpfTsgbGltaXRUeXBlPSR7dC5saW1pdFR5cGV9KWA7XG59XG5cbi8qKiBSZXR1cm5zIHdoZXRoZXIgYGRvY2AgbWF0Y2hlcyB0aGUgY29uc3RyYWludHMgb2YgYHF1ZXJ5YC4gKi8gZnVuY3Rpb24gUGUodCwgZSkge1xuICAgIHJldHVybiBlLmlzRm91bmREb2N1bWVudCgpICYmIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IGUua2V5LnBhdGg7XG4gICAgICAgIHJldHVybiBudWxsICE9PSB0LmNvbGxlY3Rpb25Hcm91cCA/IGUua2V5Lmhhc0NvbGxlY3Rpb25JZCh0LmNvbGxlY3Rpb25Hcm91cCkgJiYgdC5wYXRoLmlzUHJlZml4T2YobikgOiBQdC5pc0RvY3VtZW50S2V5KHQucGF0aCkgPyB0LnBhdGguaXNFcXVhbChuKSA6IHQucGF0aC5pc0ltbWVkaWF0ZVBhcmVudE9mKG4pO1xuICAgIH1cbiAgICAvKipcbiAqIEEgZG9jdW1lbnQgbXVzdCBoYXZlIGEgdmFsdWUgZm9yIGV2ZXJ5IG9yZGVyaW5nIGNsYXVzZSBpbiBvcmRlciB0byBzaG93IHVwXG4gKiBpbiB0aGUgcmVzdWx0cy5cbiAqLyAodCwgZSkgJiYgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBmb3IgKGNvbnN0IG4gb2YgdC5leHBsaWNpdE9yZGVyQnkpIFxuICAgICAgICAvLyBvcmRlciBieSBrZXkgYWx3YXlzIG1hdGNoZXNcbiAgICAgICAgaWYgKCFuLmZpZWxkLmlzS2V5RmllbGQoKSAmJiBudWxsID09PSBlLmRhdGEuZmllbGQobi5maWVsZCkpIHJldHVybiAhMTtcbiAgICAgICAgcmV0dXJuICEwO1xuICAgIH0odCwgZSkgJiYgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBmb3IgKGNvbnN0IG4gb2YgdC5maWx0ZXJzKSBpZiAoIW4ubWF0Y2hlcyhlKSkgcmV0dXJuICExO1xuICAgICAgICByZXR1cm4gITA7XG4gICAgfVxuICAgIC8qKiBNYWtlcyBzdXJlIGEgZG9jdW1lbnQgaXMgd2l0aGluIHRoZSBib3VuZHMsIGlmIHByb3ZpZGVkLiAqLyAodCwgZSkgJiYgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBpZiAodC5zdGFydEF0ICYmICF1ZSh0LnN0YXJ0QXQsIHBlKHQpLCBlKSkgcmV0dXJuICExO1xuICAgICAgICBpZiAodC5lbmRBdCAmJiB1ZSh0LmVuZEF0LCBwZSh0KSwgZSkpIHJldHVybiAhMTtcbiAgICAgICAgcmV0dXJuICEwO1xuICAgIH1cbiAgICAvKipcbiAqIFJldHVybnMgYSBuZXcgY29tcGFyYXRvciBmdW5jdGlvbiB0aGF0IGNhbiBiZSB1c2VkIHRvIGNvbXBhcmUgdHdvIGRvY3VtZW50c1xuICogYmFzZWQgb24gdGhlIFF1ZXJ5J3Mgb3JkZXJpbmcgY29uc3RyYWludC5cbiAqLyAodCwgZSk7XG59XG5cbmZ1bmN0aW9uIGJlKHQpIHtcbiAgICByZXR1cm4gKGUsIG4pID0+IHtcbiAgICAgICAgbGV0IHMgPSAhMTtcbiAgICAgICAgZm9yIChjb25zdCBpIG9mIHBlKHQpKSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gdmUoaSwgZSwgbik7XG4gICAgICAgICAgICBpZiAoMCAhPT0gdCkgcmV0dXJuIHQ7XG4gICAgICAgICAgICBzID0gcyB8fCBpLmZpZWxkLmlzS2V5RmllbGQoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gMDtcbiAgICB9O1xufVxuXG5mdW5jdGlvbiB2ZSh0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9IHQuZmllbGQuaXNLZXlGaWVsZCgpID8gUHQuY29tcGFyYXRvcihlLmtleSwgbi5rZXkpIDogZnVuY3Rpb24odCwgZSwgbikge1xuICAgICAgICBjb25zdCBzID0gZS5kYXRhLmZpZWxkKHQpLCBpID0gbi5kYXRhLmZpZWxkKHQpO1xuICAgICAgICByZXR1cm4gbnVsbCAhPT0gcyAmJiBudWxsICE9PSBpID8gU3QocywgaSkgOiBNKCk7XG4gICAgfSh0LmZpZWxkLCBlLCBuKTtcbiAgICBzd2l0Y2ggKHQuZGlyKSB7XG4gICAgICBjYXNlIFwiYXNjXCIgLyogQVNDRU5ESU5HICovIDpcbiAgICAgICAgcmV0dXJuIHM7XG5cbiAgICAgIGNhc2UgXCJkZXNjXCIgLyogREVTQ0VORElORyAqLyA6XG4gICAgICAgIHJldHVybiAtMSAqIHM7XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBNKCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBSZXR1cm5zIGFuIERvdWJsZVZhbHVlIGZvciBgdmFsdWVgIHRoYXQgaXMgZW5jb2RlZCBiYXNlZCB0aGUgc2VyaWFsaXplcidzXG4gKiBgdXNlUHJvdG8zSnNvbmAgc2V0dGluZy5cbiAqLyBmdW5jdGlvbiBWZSh0LCBlKSB7XG4gICAgaWYgKHQuRCkge1xuICAgICAgICBpZiAoaXNOYU4oZSkpIHJldHVybiB7XG4gICAgICAgICAgICBkb3VibGVWYWx1ZTogXCJOYU5cIlxuICAgICAgICB9O1xuICAgICAgICBpZiAoZSA9PT0gMSAvIDApIHJldHVybiB7XG4gICAgICAgICAgICBkb3VibGVWYWx1ZTogXCJJbmZpbml0eVwiXG4gICAgICAgIH07XG4gICAgICAgIGlmIChlID09PSAtMSAvIDApIHJldHVybiB7XG4gICAgICAgICAgICBkb3VibGVWYWx1ZTogXCItSW5maW5pdHlcIlxuICAgICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBkb3VibGVWYWx1ZTogQXQoZSkgPyBcIi0wXCIgOiBlXG4gICAgfTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGFuIEludGVnZXJWYWx1ZSBmb3IgYHZhbHVlYC5cbiAqLyBmdW5jdGlvbiBTZSh0KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgaW50ZWdlclZhbHVlOiBcIlwiICsgdFxuICAgIH07XG59XG5cbi8qKlxuICogUmV0dXJucyBhIHZhbHVlIGZvciBhIG51bWJlciB0aGF0J3MgYXBwcm9wcmlhdGUgdG8gcHV0IGludG8gYSBwcm90by5cbiAqIFRoZSByZXR1cm4gdmFsdWUgaXMgYW4gSW50ZWdlclZhbHVlIGlmIGl0IGNhbiBzYWZlbHkgcmVwcmVzZW50IHRoZSB2YWx1ZSxcbiAqIG90aGVyd2lzZSBhIERvdWJsZVZhbHVlIGlzIHJldHVybmVkLlxuICovIGZ1bmN0aW9uIERlKHQsIGUpIHtcbiAgICByZXR1cm4gUnQoZSkgPyBTZShlKSA6IFZlKHQsIGUpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqIFVzZWQgdG8gcmVwcmVzZW50IGEgZmllbGQgdHJhbnNmb3JtIG9uIGEgbXV0YXRpb24uICovIGNsYXNzIENlIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgLy8gTWFrZSBzdXJlIHRoYXQgdGhlIHN0cnVjdHVyYWwgdHlwZSBvZiBgVHJhbnNmb3JtT3BlcmF0aW9uYCBpcyB1bmlxdWUuXG4gICAgICAgIC8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vbWljcm9zb2Z0L1R5cGVTY3JpcHQvaXNzdWVzLzU0NTFcbiAgICAgICAgdGhpcy5fID0gdm9pZCAwO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDb21wdXRlcyB0aGUgbG9jYWwgdHJhbnNmb3JtIHJlc3VsdCBhZ2FpbnN0IHRoZSBwcm92aWRlZCBgcHJldmlvdXNWYWx1ZWAsXG4gKiBvcHRpb25hbGx5IHVzaW5nIHRoZSBwcm92aWRlZCBsb2NhbFdyaXRlVGltZS5cbiAqLyBmdW5jdGlvbiBOZSh0LCBlLCBuKSB7XG4gICAgcmV0dXJuIHQgaW5zdGFuY2VvZiAkZSA/IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHtcbiAgICAgICAgICAgIGZpZWxkczoge1xuICAgICAgICAgICAgICAgIF9fdHlwZV9fOiB7XG4gICAgICAgICAgICAgICAgICAgIHN0cmluZ1ZhbHVlOiBcInNlcnZlcl90aW1lc3RhbXBcIlxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgX19sb2NhbF93cml0ZV90aW1lX186IHtcbiAgICAgICAgICAgICAgICAgICAgdGltZXN0YW1wVmFsdWU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlY29uZHM6IHQuc2Vjb25kcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbm9zOiB0Lm5hbm9zZWNvbmRzXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBlICYmIChuLmZpZWxkcy5fX3ByZXZpb3VzX3ZhbHVlX18gPSBlKSwge1xuICAgICAgICAgICAgbWFwVmFsdWU6IG5cbiAgICAgICAgfTtcbiAgICB9KG4sIGUpIDogdCBpbnN0YW5jZW9mIE9lID8gRmUodCwgZSkgOiB0IGluc3RhbmNlb2YgTWUgPyBMZSh0LCBlKSA6IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgLy8gUE9SVElORyBOT1RFOiBTaW5jZSBKYXZhU2NyaXB0J3MgaW50ZWdlciBhcml0aG1ldGljIGlzIGxpbWl0ZWQgdG8gNTMgYml0XG4gICAgICAgIC8vIHByZWNpc2lvbiBhbmQgcmVzb2x2ZXMgb3ZlcmZsb3dzIGJ5IHJlZHVjaW5nIHByZWNpc2lvbiwgd2UgZG8gbm90XG4gICAgICAgIC8vIG1hbnVhbGx5IGNhcCBvdmVyZmxvd3MgYXQgMl42My5cbiAgICAgICAgY29uc3QgbiA9IGtlKHQsIGUpLCBzID0gVWUobikgKyBVZSh0LkMpO1xuICAgICAgICByZXR1cm4ga3QobikgJiYga3QodC5DKSA/IFNlKHMpIDogVmUodC5OLCBzKTtcbiAgICB9KHQsIGUpO1xufVxuXG4vKipcbiAqIENvbXB1dGVzIGEgZmluYWwgdHJhbnNmb3JtIHJlc3VsdCBhZnRlciB0aGUgdHJhbnNmb3JtIGhhcyBiZWVuIGFja25vd2xlZGdlZFxuICogYnkgdGhlIHNlcnZlciwgcG90ZW50aWFsbHkgdXNpbmcgdGhlIHNlcnZlci1wcm92aWRlZCB0cmFuc2Zvcm1SZXN1bHQuXG4gKi8gZnVuY3Rpb24geGUodCwgZSwgbikge1xuICAgIC8vIFRoZSBzZXJ2ZXIganVzdCBzZW5kcyBudWxsIGFzIHRoZSB0cmFuc2Zvcm0gcmVzdWx0IGZvciBhcnJheSBvcGVyYXRpb25zLFxuICAgIC8vIHNvIHdlIGhhdmUgdG8gY2FsY3VsYXRlIGEgcmVzdWx0IHRoZSBzYW1lIGFzIHdlIGRvIGZvciBsb2NhbFxuICAgIC8vIGFwcGxpY2F0aW9ucy5cbiAgICByZXR1cm4gdCBpbnN0YW5jZW9mIE9lID8gRmUodCwgZSkgOiB0IGluc3RhbmNlb2YgTWUgPyBMZSh0LCBlKSA6IG47XG59XG5cbi8qKlxuICogSWYgdGhpcyB0cmFuc2Zvcm0gb3BlcmF0aW9uIGlzIG5vdCBpZGVtcG90ZW50LCByZXR1cm5zIHRoZSBiYXNlIHZhbHVlIHRvXG4gKiBwZXJzaXN0IGZvciB0aGlzIHRyYW5zZm9ybS4gSWYgYSBiYXNlIHZhbHVlIGlzIHJldHVybmVkLCB0aGUgdHJhbnNmb3JtXG4gKiBvcGVyYXRpb24gaXMgYWx3YXlzIGFwcGxpZWQgdG8gdGhpcyBiYXNlIHZhbHVlLCBldmVuIGlmIGRvY3VtZW50IGhhc1xuICogYWxyZWFkeSBiZWVuIHVwZGF0ZWQuXG4gKlxuICogQmFzZSB2YWx1ZXMgcHJvdmlkZSBjb25zaXN0ZW50IGJlaGF2aW9yIGZvciBub24taWRlbXBvdGVudCB0cmFuc2Zvcm1zIGFuZFxuICogYWxsb3cgdXMgdG8gcmV0dXJuIHRoZSBzYW1lIGxhdGVuY3ktY29tcGVuc2F0ZWQgdmFsdWUgZXZlbiBpZiB0aGUgYmFja2VuZFxuICogaGFzIGFscmVhZHkgYXBwbGllZCB0aGUgdHJhbnNmb3JtIG9wZXJhdGlvbi4gVGhlIGJhc2UgdmFsdWUgaXMgbnVsbCBmb3JcbiAqIGlkZW1wb3RlbnQgdHJhbnNmb3JtcywgYXMgdGhleSBjYW4gYmUgcmUtcGxheWVkIGV2ZW4gaWYgdGhlIGJhY2tlbmQgaGFzXG4gKiBhbHJlYWR5IGFwcGxpZWQgdGhlbS5cbiAqXG4gKiBAcmV0dXJucyBhIGJhc2UgdmFsdWUgdG8gc3RvcmUgYWxvbmcgd2l0aCB0aGUgbXV0YXRpb24sIG9yIG51bGwgZm9yXG4gKiBpZGVtcG90ZW50IHRyYW5zZm9ybXMuXG4gKi8gZnVuY3Rpb24ga2UodCwgZSkge1xuICAgIHJldHVybiB0IGluc3RhbmNlb2YgQmUgPyBrdChuID0gZSkgfHwgZnVuY3Rpb24odCkge1xuICAgICAgICByZXR1cm4gISF0ICYmIFwiZG91YmxlVmFsdWVcIiBpbiB0O1xuICAgIH1cbiAgICAvKiogUmV0dXJucyB0cnVlIGlmIGB2YWx1ZWAgaXMgZWl0aGVyIGFuIEludGVnZXJWYWx1ZSBvciBhIERvdWJsZVZhbHVlLiAqLyAobikgPyBlIDoge1xuICAgICAgICBpbnRlZ2VyVmFsdWU6IDBcbiAgICB9IDogbnVsbDtcbiAgICB2YXIgbjtcbn1cblxuLyoqIFRyYW5zZm9ybXMgYSB2YWx1ZSBpbnRvIGEgc2VydmVyLWdlbmVyYXRlZCB0aW1lc3RhbXAuICovXG5jbGFzcyAkZSBleHRlbmRzIENlIHt9XG5cbi8qKiBUcmFuc2Zvcm1zIGFuIGFycmF5IHZhbHVlIHZpYSBhIHVuaW9uIG9wZXJhdGlvbi4gKi8gY2xhc3MgT2UgZXh0ZW5kcyBDZSB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICBzdXBlcigpLCB0aGlzLmVsZW1lbnRzID0gdDtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIEZlKHQsIGUpIHtcbiAgICBjb25zdCBuID0gcWUoZSk7XG4gICAgZm9yIChjb25zdCBlIG9mIHQuZWxlbWVudHMpIG4uc29tZSgodCA9PiB2dCh0LCBlKSkpIHx8IG4ucHVzaChlKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBhcnJheVZhbHVlOiB7XG4gICAgICAgICAgICB2YWx1ZXM6IG5cbiAgICAgICAgfVxuICAgIH07XG59XG5cbi8qKiBUcmFuc2Zvcm1zIGFuIGFycmF5IHZhbHVlIHZpYSBhIHJlbW92ZSBvcGVyYXRpb24uICovIGNsYXNzIE1lIGV4dGVuZHMgQ2Uge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5lbGVtZW50cyA9IHQ7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBMZSh0LCBlKSB7XG4gICAgbGV0IG4gPSBxZShlKTtcbiAgICBmb3IgKGNvbnN0IGUgb2YgdC5lbGVtZW50cykgbiA9IG4uZmlsdGVyKCh0ID0+ICF2dCh0LCBlKSkpO1xuICAgIHJldHVybiB7XG4gICAgICAgIGFycmF5VmFsdWU6IHtcbiAgICAgICAgICAgIHZhbHVlczogblxuICAgICAgICB9XG4gICAgfTtcbn1cblxuLyoqXG4gKiBJbXBsZW1lbnRzIHRoZSBiYWNrZW5kIHNlbWFudGljcyBmb3IgbG9jYWxseSBjb21wdXRlZCBOVU1FUklDX0FERCAoaW5jcmVtZW50KVxuICogdHJhbnNmb3Jtcy4gQ29udmVydHMgYWxsIGZpZWxkIHZhbHVlcyB0byBpbnRlZ2VycyBvciBkb3VibGVzLCBidXQgdW5saWtlIHRoZVxuICogYmFja2VuZCBkb2VzIG5vdCBjYXAgaW50ZWdlciB2YWx1ZXMgYXQgMl42My4gSW5zdGVhZCwgSmF2YVNjcmlwdCBudW1iZXJcbiAqIGFyaXRobWV0aWMgaXMgdXNlZCBhbmQgcHJlY2lzaW9uIGxvc3MgY2FuIG9jY3VyIGZvciB2YWx1ZXMgZ3JlYXRlciB0aGFuIDJeNTMuXG4gKi8gY2xhc3MgQmUgZXh0ZW5kcyBDZSB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICBzdXBlcigpLCB0aGlzLk4gPSB0LCB0aGlzLkMgPSBlO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gVWUodCkge1xuICAgIHJldHVybiBndCh0LmludGVnZXJWYWx1ZSB8fCB0LmRvdWJsZVZhbHVlKTtcbn1cblxuZnVuY3Rpb24gcWUodCkge1xuICAgIHJldHVybiAkdCh0KSAmJiB0LmFycmF5VmFsdWUudmFsdWVzID8gdC5hcnJheVZhbHVlLnZhbHVlcy5zbGljZSgpIDogW107XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKiogQSBmaWVsZCBwYXRoIGFuZCB0aGUgVHJhbnNmb3JtT3BlcmF0aW9uIHRvIHBlcmZvcm0gdXBvbiBpdC4gKi8gY2xhc3MgS2Uge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5maWVsZCA9IHQsIHRoaXMudHJhbnNmb3JtID0gZTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGplKHQsIGUpIHtcbiAgICByZXR1cm4gdC5maWVsZC5pc0VxdWFsKGUuZmllbGQpICYmIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHQgaW5zdGFuY2VvZiBPZSAmJiBlIGluc3RhbmNlb2YgT2UgfHwgdCBpbnN0YW5jZW9mIE1lICYmIGUgaW5zdGFuY2VvZiBNZSA/IGV0KHQuZWxlbWVudHMsIGUuZWxlbWVudHMsIHZ0KSA6IHQgaW5zdGFuY2VvZiBCZSAmJiBlIGluc3RhbmNlb2YgQmUgPyB2dCh0LkMsIGUuQykgOiB0IGluc3RhbmNlb2YgJGUgJiYgZSBpbnN0YW5jZW9mICRlO1xuICAgIH0odC50cmFuc2Zvcm0sIGUudHJhbnNmb3JtKTtcbn1cblxuLyoqIFRoZSByZXN1bHQgb2Ygc3VjY2Vzc2Z1bGx5IGFwcGx5aW5nIGEgbXV0YXRpb24gdG8gdGhlIGJhY2tlbmQuICovXG5jbGFzcyBRZSB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgLyoqXG4gICAgICogVGhlIHZlcnNpb24gYXQgd2hpY2ggdGhlIG11dGF0aW9uIHdhcyBjb21taXR0ZWQ6XG4gICAgICpcbiAgICAgKiAtIEZvciBtb3N0IG9wZXJhdGlvbnMsIHRoaXMgaXMgdGhlIHVwZGF0ZVRpbWUgaW4gdGhlIFdyaXRlUmVzdWx0LlxuICAgICAqIC0gRm9yIGRlbGV0ZXMsIHRoZSBjb21taXRUaW1lIG9mIHRoZSBXcml0ZVJlc3BvbnNlIChiZWNhdXNlIGRlbGV0ZXMgYXJlXG4gICAgICogICBub3Qgc3RvcmVkIGFuZCBoYXZlIG5vIHVwZGF0ZVRpbWUpLlxuICAgICAqXG4gICAgICogTm90ZSB0aGF0IHRoZXNlIHZlcnNpb25zIGNhbiBiZSBkaWZmZXJlbnQ6IE5vLW9wIHdyaXRlcyB3aWxsIG5vdCBjaGFuZ2VcbiAgICAgKiB0aGUgdXBkYXRlVGltZSBldmVuIHRob3VnaCB0aGUgY29tbWl0VGltZSBhZHZhbmNlcy5cbiAgICAgKi9cbiAgICB0LCBcbiAgICAvKipcbiAgICAgKiBUaGUgcmVzdWx0aW5nIGZpZWxkcyByZXR1cm5lZCBmcm9tIHRoZSBiYWNrZW5kIGFmdGVyIGEgbXV0YXRpb25cbiAgICAgKiBjb250YWluaW5nIGZpZWxkIHRyYW5zZm9ybXMgaGFzIGJlZW4gY29tbWl0dGVkLiBDb250YWlucyBvbmUgRmllbGRWYWx1ZVxuICAgICAqIGZvciBlYWNoIEZpZWxkVHJhbnNmb3JtIHRoYXQgd2FzIGluIHRoZSBtdXRhdGlvbi5cbiAgICAgKlxuICAgICAqIFdpbGwgYmUgZW1wdHkgaWYgdGhlIG11dGF0aW9uIGRpZCBub3QgY29udGFpbiBhbnkgZmllbGQgdHJhbnNmb3Jtcy5cbiAgICAgKi9cbiAgICBlKSB7XG4gICAgICAgIHRoaXMudmVyc2lvbiA9IHQsIHRoaXMudHJhbnNmb3JtUmVzdWx0cyA9IGU7XG4gICAgfVxufVxuXG4vKipcbiAqIEVuY29kZXMgYSBwcmVjb25kaXRpb24gZm9yIGEgbXV0YXRpb24uIFRoaXMgZm9sbG93cyB0aGUgbW9kZWwgdGhhdCB0aGVcbiAqIGJhY2tlbmQgYWNjZXB0cyB3aXRoIHRoZSBzcGVjaWFsIGNhc2Ugb2YgYW4gZXhwbGljaXQgXCJlbXB0eVwiIHByZWNvbmRpdGlvblxuICogKG1lYW5pbmcgbm8gcHJlY29uZGl0aW9uKS5cbiAqLyBjbGFzcyBXZSB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLnVwZGF0ZVRpbWUgPSB0LCB0aGlzLmV4aXN0cyA9IGU7XG4gICAgfVxuICAgIC8qKiBDcmVhdGVzIGEgbmV3IGVtcHR5IFByZWNvbmRpdGlvbi4gKi8gICAgc3RhdGljIG5vbmUoKSB7XG4gICAgICAgIHJldHVybiBuZXcgV2U7XG4gICAgfVxuICAgIC8qKiBDcmVhdGVzIGEgbmV3IFByZWNvbmRpdGlvbiB3aXRoIGFuIGV4aXN0cyBmbGFnLiAqLyAgICBzdGF0aWMgZXhpc3RzKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBXZSh2b2lkIDAsIHQpO1xuICAgIH1cbiAgICAvKiogQ3JlYXRlcyBhIG5ldyBQcmVjb25kaXRpb24gYmFzZWQgb24gYSB2ZXJzaW9uIGEgZG9jdW1lbnQgZXhpc3RzIGF0LiAqLyAgICBzdGF0aWMgdXBkYXRlVGltZSh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgV2UodCk7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIHdoZXRoZXIgdGhpcyBQcmVjb25kaXRpb24gaXMgZW1wdHkuICovICAgIGdldCBpc05vbmUoKSB7XG4gICAgICAgIHJldHVybiB2b2lkIDAgPT09IHRoaXMudXBkYXRlVGltZSAmJiB2b2lkIDAgPT09IHRoaXMuZXhpc3RzO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZXhpc3RzID09PSB0LmV4aXN0cyAmJiAodGhpcy51cGRhdGVUaW1lID8gISF0LnVwZGF0ZVRpbWUgJiYgdGhpcy51cGRhdGVUaW1lLmlzRXF1YWwodC51cGRhdGVUaW1lKSA6ICF0LnVwZGF0ZVRpbWUpO1xuICAgIH1cbn1cblxuLyoqIFJldHVybnMgdHJ1ZSBpZiB0aGUgcHJlY29uZGl0aW9ucyBpcyB2YWxpZCBmb3IgdGhlIGdpdmVuIGRvY3VtZW50LiAqLyBmdW5jdGlvbiBHZSh0LCBlKSB7XG4gICAgcmV0dXJuIHZvaWQgMCAhPT0gdC51cGRhdGVUaW1lID8gZS5pc0ZvdW5kRG9jdW1lbnQoKSAmJiBlLnZlcnNpb24uaXNFcXVhbCh0LnVwZGF0ZVRpbWUpIDogdm9pZCAwID09PSB0LmV4aXN0cyB8fCB0LmV4aXN0cyA9PT0gZS5pc0ZvdW5kRG9jdW1lbnQoKTtcbn1cblxuLyoqXG4gKiBBIG11dGF0aW9uIGRlc2NyaWJlcyBhIHNlbGYtY29udGFpbmVkIGNoYW5nZSB0byBhIGRvY3VtZW50LiBNdXRhdGlvbnMgY2FuXG4gKiBjcmVhdGUsIHJlcGxhY2UsIGRlbGV0ZSwgYW5kIHVwZGF0ZSBzdWJzZXRzIG9mIGRvY3VtZW50cy5cbiAqXG4gKiBNdXRhdGlvbnMgbm90IG9ubHkgYWN0IG9uIHRoZSB2YWx1ZSBvZiB0aGUgZG9jdW1lbnQgYnV0IGFsc28gaXRzIHZlcnNpb24uXG4gKlxuICogRm9yIGxvY2FsIG11dGF0aW9ucyAobXV0YXRpb25zIHRoYXQgaGF2ZW4ndCBiZWVuIGNvbW1pdHRlZCB5ZXQpLCB3ZSBwcmVzZXJ2ZVxuICogdGhlIGV4aXN0aW5nIHZlcnNpb24gZm9yIFNldCBhbmQgUGF0Y2ggbXV0YXRpb25zLiBGb3IgRGVsZXRlIG11dGF0aW9ucywgd2VcbiAqIHJlc2V0IHRoZSB2ZXJzaW9uIHRvIDAuXG4gKlxuICogSGVyZSdzIHRoZSBleHBlY3RlZCB0cmFuc2l0aW9uIHRhYmxlLlxuICpcbiAqIE1VVEFUSU9OICAgICAgICAgICBBUFBMSUVEIFRPICAgICAgICAgICAgUkVTVUxUUyBJTlxuICpcbiAqIFNldE11dGF0aW9uICAgICAgICBEb2N1bWVudCh2MykgICAgICAgICAgRG9jdW1lbnQodjMpXG4gKiBTZXRNdXRhdGlvbiAgICAgICAgTm9Eb2N1bWVudCh2MykgICAgICAgIERvY3VtZW50KHYwKVxuICogU2V0TXV0YXRpb24gICAgICAgIEludmFsaWREb2N1bWVudCh2MCkgICBEb2N1bWVudCh2MClcbiAqIFBhdGNoTXV0YXRpb24gICAgICBEb2N1bWVudCh2MykgICAgICAgICAgRG9jdW1lbnQodjMpXG4gKiBQYXRjaE11dGF0aW9uICAgICAgTm9Eb2N1bWVudCh2MykgICAgICAgIE5vRG9jdW1lbnQodjMpXG4gKiBQYXRjaE11dGF0aW9uICAgICAgSW52YWxpZERvY3VtZW50KHYwKSAgIFVua25vd25Eb2N1bWVudCh2MylcbiAqIERlbGV0ZU11dGF0aW9uICAgICBEb2N1bWVudCh2MykgICAgICAgICAgTm9Eb2N1bWVudCh2MClcbiAqIERlbGV0ZU11dGF0aW9uICAgICBOb0RvY3VtZW50KHYzKSAgICAgICAgTm9Eb2N1bWVudCh2MClcbiAqIERlbGV0ZU11dGF0aW9uICAgICBJbnZhbGlkRG9jdW1lbnQodjApICAgTm9Eb2N1bWVudCh2MClcbiAqXG4gKiBGb3IgYWNrbm93bGVkZ2VkIG11dGF0aW9ucywgd2UgdXNlIHRoZSB1cGRhdGVUaW1lIG9mIHRoZSBXcml0ZVJlc3BvbnNlIGFzXG4gKiB0aGUgcmVzdWx0aW5nIHZlcnNpb24gZm9yIFNldCBhbmQgUGF0Y2ggbXV0YXRpb25zLiBBcyBkZWxldGVzIGhhdmUgbm9cbiAqIGV4cGxpY2l0IHVwZGF0ZSB0aW1lLCB3ZSB1c2UgdGhlIGNvbW1pdFRpbWUgb2YgdGhlIFdyaXRlUmVzcG9uc2UgZm9yXG4gKiBEZWxldGUgbXV0YXRpb25zLlxuICpcbiAqIElmIGEgbXV0YXRpb24gaXMgYWNrbm93bGVkZ2VkIGJ5IHRoZSBiYWNrZW5kIGJ1dCBmYWlscyB0aGUgcHJlY29uZGl0aW9uIGNoZWNrXG4gKiBsb2NhbGx5LCB3ZSB0cmFuc2l0aW9uIHRvIGFuIGBVbmtub3duRG9jdW1lbnRgIGFuZCByZWx5IG9uIFdhdGNoIHRvIHNlbmQgdXNcbiAqIHRoZSB1cGRhdGVkIHZlcnNpb24uXG4gKlxuICogRmllbGQgdHJhbnNmb3JtcyBhcmUgdXNlZCBvbmx5IHdpdGggUGF0Y2ggYW5kIFNldCBNdXRhdGlvbnMuIFdlIHVzZSB0aGVcbiAqIGB1cGRhdGVUcmFuc2Zvcm1zYCBtZXNzYWdlIHRvIHN0b3JlIHRyYW5zZm9ybXMsIHJhdGhlciB0aGFuIHRoZSBgdHJhbnNmb3Jtc2BzXG4gKiBtZXNzYWdlcy5cbiAqXG4gKiAjIyBTdWJjbGFzc2luZyBOb3Rlc1xuICpcbiAqIEV2ZXJ5IHR5cGUgb2YgbXV0YXRpb24gbmVlZHMgdG8gaW1wbGVtZW50IGl0cyBvd24gYXBwbHlUb1JlbW90ZURvY3VtZW50KCkgYW5kXG4gKiBhcHBseVRvTG9jYWxWaWV3KCkgdG8gaW1wbGVtZW50IHRoZSBhY3R1YWwgYmVoYXZpb3Igb2YgYXBwbHlpbmcgdGhlIG11dGF0aW9uXG4gKiB0byBzb21lIHNvdXJjZSBkb2N1bWVudCAoc2VlIGBhcHBseVNldE11dGF0aW9uVG9SZW1vdGVEb2N1bWVudCgpYCBmb3IgYW5cbiAqIGV4YW1wbGUpLlxuICovIGNsYXNzIHplIHt9XG5cbi8qKlxuICogQXBwbGllcyB0aGlzIG11dGF0aW9uIHRvIHRoZSBnaXZlbiBkb2N1bWVudCBmb3IgdGhlIHB1cnBvc2VzIG9mIGNvbXB1dGluZyBhXG4gKiBuZXcgcmVtb3RlIGRvY3VtZW50LiBJZiB0aGUgaW5wdXQgZG9jdW1lbnQgZG9lc24ndCBtYXRjaCB0aGUgZXhwZWN0ZWQgc3RhdGVcbiAqIChlLmcuIGl0IGlzIGludmFsaWQgb3Igb3V0ZGF0ZWQpLCB0aGUgZG9jdW1lbnQgdHlwZSBtYXkgdHJhbnNpdGlvbiB0b1xuICogdW5rbm93bi5cbiAqXG4gKiBAcGFyYW0gbXV0YXRpb24gLSBUaGUgbXV0YXRpb24gdG8gYXBwbHkuXG4gKiBAcGFyYW0gZG9jdW1lbnQgLSBUaGUgZG9jdW1lbnQgdG8gbXV0YXRlLiBUaGUgaW5wdXQgZG9jdW1lbnQgY2FuIGJlIGFuXG4gKiAgICAgaW52YWxpZCBkb2N1bWVudCBpZiB0aGUgY2xpZW50IGhhcyBubyBrbm93bGVkZ2Ugb2YgdGhlIHByZS1tdXRhdGlvbiBzdGF0ZVxuICogICAgIG9mIHRoZSBkb2N1bWVudC5cbiAqIEBwYXJhbSBtdXRhdGlvblJlc3VsdCAtIFRoZSByZXN1bHQgb2YgYXBwbHlpbmcgdGhlIG11dGF0aW9uIGZyb20gdGhlIGJhY2tlbmQuXG4gKi8gZnVuY3Rpb24gSGUodCwgZSwgbikge1xuICAgIHQgaW5zdGFuY2VvZiB0biA/IGZ1bmN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgLy8gVW5saWtlIGFwcGx5U2V0TXV0YXRpb25Ub0xvY2FsVmlldywgaWYgd2UncmUgYXBwbHlpbmcgYSBtdXRhdGlvbiB0byBhXG4gICAgICAgIC8vIHJlbW90ZSBkb2N1bWVudCB0aGUgc2VydmVyIGhhcyBhY2NlcHRlZCB0aGUgbXV0YXRpb24gc28gdGhlIHByZWNvbmRpdGlvblxuICAgICAgICAvLyBtdXN0IGhhdmUgaGVsZC5cbiAgICAgICAgY29uc3QgcyA9IHQudmFsdWUuY2xvbmUoKSwgaSA9IHNuKHQuZmllbGRUcmFuc2Zvcm1zLCBlLCBuLnRyYW5zZm9ybVJlc3VsdHMpO1xuICAgICAgICBzLnNldEFsbChpKSwgZS5jb252ZXJ0VG9Gb3VuZERvY3VtZW50KG4udmVyc2lvbiwgcykuc2V0SGFzQ29tbWl0dGVkTXV0YXRpb25zKCk7XG4gICAgfSh0LCBlLCBuKSA6IHQgaW5zdGFuY2VvZiBlbiA/IGZ1bmN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgaWYgKCFHZSh0LnByZWNvbmRpdGlvbiwgZSkpIFxuICAgICAgICAvLyBTaW5jZSB0aGUgbXV0YXRpb24gd2FzIG5vdCByZWplY3RlZCwgd2Uga25vdyB0aGF0IHRoZSBwcmVjb25kaXRpb25cbiAgICAgICAgLy8gbWF0Y2hlZCBvbiB0aGUgYmFja2VuZC4gV2UgdGhlcmVmb3JlIG11c3Qgbm90IGhhdmUgdGhlIGV4cGVjdGVkIHZlcnNpb25cbiAgICAgICAgLy8gb2YgdGhlIGRvY3VtZW50IGluIG91ciBjYWNoZSBhbmQgY29udmVydCB0byBhbiBVbmtub3duRG9jdW1lbnQgd2l0aCBhXG4gICAgICAgIC8vIGtub3duIHVwZGF0ZVRpbWUuXG4gICAgICAgIHJldHVybiB2b2lkIGUuY29udmVydFRvVW5rbm93bkRvY3VtZW50KG4udmVyc2lvbik7XG4gICAgICAgIGNvbnN0IHMgPSBzbih0LmZpZWxkVHJhbnNmb3JtcywgZSwgbi50cmFuc2Zvcm1SZXN1bHRzKSwgaSA9IGUuZGF0YTtcbiAgICAgICAgaS5zZXRBbGwobm4odCkpLCBpLnNldEFsbChzKSwgZS5jb252ZXJ0VG9Gb3VuZERvY3VtZW50KG4udmVyc2lvbiwgaSkuc2V0SGFzQ29tbWl0dGVkTXV0YXRpb25zKCk7XG4gICAgfSh0LCBlLCBuKSA6IGZ1bmN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgLy8gVW5saWtlIGFwcGx5VG9Mb2NhbFZpZXcsIGlmIHdlJ3JlIGFwcGx5aW5nIGEgbXV0YXRpb24gdG8gYSByZW1vdGVcbiAgICAgICAgLy8gZG9jdW1lbnQgdGhlIHNlcnZlciBoYXMgYWNjZXB0ZWQgdGhlIG11dGF0aW9uIHNvIHRoZSBwcmVjb25kaXRpb24gbXVzdFxuICAgICAgICAvLyBoYXZlIGhlbGQuXG4gICAgICAgIGUuY29udmVydFRvTm9Eb2N1bWVudChuLnZlcnNpb24pLnNldEhhc0NvbW1pdHRlZE11dGF0aW9ucygpO1xuICAgIH0oMCwgZSwgbik7XG59XG5cbi8qKlxuICogQXBwbGllcyB0aGlzIG11dGF0aW9uIHRvIHRoZSBnaXZlbiBkb2N1bWVudCBmb3IgdGhlIHB1cnBvc2VzIG9mIGNvbXB1dGluZ1xuICogdGhlIG5ldyBsb2NhbCB2aWV3IG9mIGEgZG9jdW1lbnQuIElmIHRoZSBpbnB1dCBkb2N1bWVudCBkb2Vzbid0IG1hdGNoIHRoZVxuICogZXhwZWN0ZWQgc3RhdGUsIHRoZSBkb2N1bWVudCBpcyBub3QgbW9kaWZpZWQuXG4gKlxuICogQHBhcmFtIG11dGF0aW9uIC0gVGhlIG11dGF0aW9uIHRvIGFwcGx5LlxuICogQHBhcmFtIGRvY3VtZW50IC0gVGhlIGRvY3VtZW50IHRvIG11dGF0ZS4gVGhlIGlucHV0IGRvY3VtZW50IGNhbiBiZSBhblxuICogICAgIGludmFsaWQgZG9jdW1lbnQgaWYgdGhlIGNsaWVudCBoYXMgbm8ga25vd2xlZGdlIG9mIHRoZSBwcmUtbXV0YXRpb24gc3RhdGVcbiAqICAgICBvZiB0aGUgZG9jdW1lbnQuXG4gKiBAcGFyYW0gbG9jYWxXcml0ZVRpbWUgLSBBIHRpbWVzdGFtcCBpbmRpY2F0aW5nIHRoZSBsb2NhbCB3cml0ZSB0aW1lIG9mIHRoZVxuICogICAgIGJhdGNoIHRoaXMgbXV0YXRpb24gaXMgYSBwYXJ0IG9mLlxuICovIGZ1bmN0aW9uIEplKHQsIGUsIG4pIHtcbiAgICB0IGluc3RhbmNlb2YgdG4gPyBmdW5jdGlvbih0LCBlLCBuKSB7XG4gICAgICAgIGlmICghR2UodC5wcmVjb25kaXRpb24sIGUpKSBcbiAgICAgICAgLy8gVGhlIG11dGF0aW9uIGZhaWxlZCB0byBhcHBseSAoZS5nLiBhIGRvY3VtZW50IElEIGNyZWF0ZWQgd2l0aCBhZGQoKVxuICAgICAgICAvLyBjYXVzZWQgYSBuYW1lIGNvbGxpc2lvbikuXG4gICAgICAgIHJldHVybjtcbiAgICAgICAgY29uc3QgcyA9IHQudmFsdWUuY2xvbmUoKSwgaSA9IHJuKHQuZmllbGRUcmFuc2Zvcm1zLCBuLCBlKTtcbiAgICAgICAgcy5zZXRBbGwoaSksIGUuY29udmVydFRvRm91bmREb2N1bWVudChaZShlKSwgcykuc2V0SGFzTG9jYWxNdXRhdGlvbnMoKTtcbiAgICB9XG4gICAgLyoqXG4gKiBBIG11dGF0aW9uIHRoYXQgbW9kaWZpZXMgZmllbGRzIG9mIHRoZSBkb2N1bWVudCBhdCB0aGUgZ2l2ZW4ga2V5IHdpdGggdGhlXG4gKiBnaXZlbiB2YWx1ZXMuIFRoZSB2YWx1ZXMgYXJlIGFwcGxpZWQgdGhyb3VnaCBhIGZpZWxkIG1hc2s6XG4gKlxuICogICogV2hlbiBhIGZpZWxkIGlzIGluIGJvdGggdGhlIG1hc2sgYW5kIHRoZSB2YWx1ZXMsIHRoZSBjb3JyZXNwb25kaW5nIGZpZWxkXG4gKiAgICBpcyB1cGRhdGVkLlxuICogICogV2hlbiBhIGZpZWxkIGlzIGluIG5laXRoZXIgdGhlIG1hc2sgbm9yIHRoZSB2YWx1ZXMsIHRoZSBjb3JyZXNwb25kaW5nXG4gKiAgICBmaWVsZCBpcyB1bm1vZGlmaWVkLlxuICogICogV2hlbiBhIGZpZWxkIGlzIGluIHRoZSBtYXNrIGJ1dCBub3QgaW4gdGhlIHZhbHVlcywgdGhlIGNvcnJlc3BvbmRpbmcgZmllbGRcbiAqICAgIGlzIGRlbGV0ZWQuXG4gKiAgKiBXaGVuIGEgZmllbGQgaXMgbm90IGluIHRoZSBtYXNrIGJ1dCBpcyBpbiB0aGUgdmFsdWVzLCB0aGUgdmFsdWVzIG1hcCBpc1xuICogICAgaWdub3JlZC5cbiAqLyAodCwgZSwgbikgOiB0IGluc3RhbmNlb2YgZW4gPyBmdW5jdGlvbih0LCBlLCBuKSB7XG4gICAgICAgIGlmICghR2UodC5wcmVjb25kaXRpb24sIGUpKSByZXR1cm47XG4gICAgICAgIGNvbnN0IHMgPSBybih0LmZpZWxkVHJhbnNmb3JtcywgbiwgZSksIGkgPSBlLmRhdGE7XG4gICAgICAgIGkuc2V0QWxsKG5uKHQpKSwgaS5zZXRBbGwocyksIGUuY29udmVydFRvRm91bmREb2N1bWVudChaZShlKSwgaSkuc2V0SGFzTG9jYWxNdXRhdGlvbnMoKTtcbiAgICB9XG4gICAgLyoqXG4gKiBSZXR1cm5zIGEgRmllbGRQYXRoL1ZhbHVlIG1hcCB3aXRoIHRoZSBjb250ZW50IG9mIHRoZSBQYXRjaE11dGF0aW9uLlxuICovICh0LCBlLCBuKSA6IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgR2UodC5wcmVjb25kaXRpb24sIGUpICYmIFxuICAgICAgICAvLyBXZSBkb24ndCBjYWxsIGBzZXRIYXNMb2NhbE11dGF0aW9ucygpYCBzaW5jZSB3ZSB3YW50IHRvIGJlIGJhY2t3YXJkc1xuICAgICAgICAvLyBjb21wYXRpYmxlIHdpdGggdGhlIGV4aXN0aW5nIFNESyBiZWhhdmlvci5cbiAgICAgICAgZS5jb252ZXJ0VG9Ob0RvY3VtZW50KGl0Lm1pbigpKTtcbiAgICB9XG4gICAgLyoqXG4gKiBBIG11dGF0aW9uIHRoYXQgdmVyaWZpZXMgdGhlIGV4aXN0ZW5jZSBvZiB0aGUgZG9jdW1lbnQgYXQgdGhlIGdpdmVuIGtleSB3aXRoXG4gKiB0aGUgcHJvdmlkZWQgcHJlY29uZGl0aW9uLlxuICpcbiAqIFRoZSBgdmVyaWZ5YCBvcGVyYXRpb24gaXMgb25seSB1c2VkIGluIFRyYW5zYWN0aW9ucywgYW5kIHRoaXMgY2xhc3Mgc2VydmVzXG4gKiBwcmltYXJpbHkgdG8gZmFjaWxpdGF0ZSBzZXJpYWxpemF0aW9uIGludG8gcHJvdG9zLlxuICovICh0LCBlKTtcbn1cblxuLyoqXG4gKiBJZiB0aGlzIG11dGF0aW9uIGlzIG5vdCBpZGVtcG90ZW50LCByZXR1cm5zIHRoZSBiYXNlIHZhbHVlIHRvIHBlcnNpc3Qgd2l0aFxuICogdGhpcyBtdXRhdGlvbi4gSWYgYSBiYXNlIHZhbHVlIGlzIHJldHVybmVkLCB0aGUgbXV0YXRpb24gaXMgYWx3YXlzIGFwcGxpZWRcbiAqIHRvIHRoaXMgYmFzZSB2YWx1ZSwgZXZlbiBpZiBkb2N1bWVudCBoYXMgYWxyZWFkeSBiZWVuIHVwZGF0ZWQuXG4gKlxuICogVGhlIGJhc2UgdmFsdWUgaXMgYSBzcGFyc2Ugb2JqZWN0IHRoYXQgY29uc2lzdHMgb2Ygb25seSB0aGUgZG9jdW1lbnRcbiAqIGZpZWxkcyBmb3Igd2hpY2ggdGhpcyBtdXRhdGlvbiBjb250YWlucyBhIG5vbi1pZGVtcG90ZW50IHRyYW5zZm9ybWF0aW9uXG4gKiAoZS5nLiBhIG51bWVyaWMgaW5jcmVtZW50KS4gVGhlIHByb3ZpZGVkIHZhbHVlIGd1YXJhbnRlZXMgY29uc2lzdGVudFxuICogYmVoYXZpb3IgZm9yIG5vbi1pZGVtcG90ZW50IHRyYW5zZm9ybXMgYW5kIGFsbG93IHVzIHRvIHJldHVybiB0aGUgc2FtZVxuICogbGF0ZW5jeS1jb21wZW5zYXRlZCB2YWx1ZSBldmVuIGlmIHRoZSBiYWNrZW5kIGhhcyBhbHJlYWR5IGFwcGxpZWQgdGhlXG4gKiBtdXRhdGlvbi4gVGhlIGJhc2UgdmFsdWUgaXMgbnVsbCBmb3IgaWRlbXBvdGVudCBtdXRhdGlvbnMsIGFzIHRoZXkgY2FuIGJlXG4gKiByZS1wbGF5ZWQgZXZlbiBpZiB0aGUgYmFja2VuZCBoYXMgYWxyZWFkeSBhcHBsaWVkIHRoZW0uXG4gKlxuICogQHJldHVybnMgYSBiYXNlIHZhbHVlIHRvIHN0b3JlIGFsb25nIHdpdGggdGhlIG11dGF0aW9uLCBvciBudWxsIGZvclxuICogaWRlbXBvdGVudCBtdXRhdGlvbnMuXG4gKi8gZnVuY3Rpb24gWWUodCwgZSkge1xuICAgIGxldCBuID0gbnVsbDtcbiAgICBmb3IgKGNvbnN0IHMgb2YgdC5maWVsZFRyYW5zZm9ybXMpIHtcbiAgICAgICAgY29uc3QgdCA9IGUuZGF0YS5maWVsZChzLmZpZWxkKSwgaSA9IGtlKHMudHJhbnNmb3JtLCB0IHx8IG51bGwpO1xuICAgICAgICBudWxsICE9IGkgJiYgKG51bGwgPT0gbiAmJiAobiA9IEJ0LmVtcHR5KCkpLCBuLnNldChzLmZpZWxkLCBpKSk7XG4gICAgfVxuICAgIHJldHVybiBuIHx8IG51bGw7XG59XG5cbmZ1bmN0aW9uIFhlKHQsIGUpIHtcbiAgICByZXR1cm4gdC50eXBlID09PSBlLnR5cGUgJiYgKCEhdC5rZXkuaXNFcXVhbChlLmtleSkgJiYgKCEhdC5wcmVjb25kaXRpb24uaXNFcXVhbChlLnByZWNvbmRpdGlvbikgJiYgKCEhZnVuY3Rpb24odCwgZSkge1xuICAgICAgICByZXR1cm4gdm9pZCAwID09PSB0ICYmIHZvaWQgMCA9PT0gZSB8fCAhKCF0IHx8ICFlKSAmJiBldCh0LCBlLCAoKHQsIGUpID0+IGplKHQsIGUpKSk7XG4gICAgfSh0LmZpZWxkVHJhbnNmb3JtcywgZS5maWVsZFRyYW5zZm9ybXMpICYmICgwIC8qIFNldCAqLyA9PT0gdC50eXBlID8gdC52YWx1ZS5pc0VxdWFsKGUudmFsdWUpIDogMSAvKiBQYXRjaCAqLyAhPT0gdC50eXBlIHx8IHQuZGF0YS5pc0VxdWFsKGUuZGF0YSkgJiYgdC5maWVsZE1hc2suaXNFcXVhbChlLmZpZWxkTWFzaykpKSkpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIHZlcnNpb24gZnJvbSB0aGUgZ2l2ZW4gZG9jdW1lbnQgZm9yIHVzZSBhcyB0aGUgcmVzdWx0IG9mIGFcbiAqIG11dGF0aW9uLiBNdXRhdGlvbnMgYXJlIGRlZmluZWQgdG8gcmV0dXJuIHRoZSB2ZXJzaW9uIG9mIHRoZSBiYXNlIGRvY3VtZW50XG4gKiBvbmx5IGlmIGl0IGlzIGFuIGV4aXN0aW5nIGRvY3VtZW50LiBEZWxldGVkIGFuZCB1bmtub3duIGRvY3VtZW50cyBoYXZlIGFcbiAqIHBvc3QtbXV0YXRpb24gdmVyc2lvbiBvZiBTbmFwc2hvdFZlcnNpb24ubWluKCkuXG4gKi8gZnVuY3Rpb24gWmUodCkge1xuICAgIHJldHVybiB0LmlzRm91bmREb2N1bWVudCgpID8gdC52ZXJzaW9uIDogaXQubWluKCk7XG59XG5cbi8qKlxuICogQSBtdXRhdGlvbiB0aGF0IGNyZWF0ZXMgb3IgcmVwbGFjZXMgdGhlIGRvY3VtZW50IGF0IHRoZSBnaXZlbiBrZXkgd2l0aCB0aGVcbiAqIG9iamVjdCB2YWx1ZSBjb250ZW50cy5cbiAqLyBjbGFzcyB0biBleHRlbmRzIHplIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzID0gW10pIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5rZXkgPSB0LCB0aGlzLnZhbHVlID0gZSwgdGhpcy5wcmVjb25kaXRpb24gPSBuLCB0aGlzLmZpZWxkVHJhbnNmb3JtcyA9IHMsIFxuICAgICAgICB0aGlzLnR5cGUgPSAwIC8qIFNldCAqLztcbiAgICB9XG59XG5cbmNsYXNzIGVuIGV4dGVuZHMgemUge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIHMsIGkgPSBbXSkge1xuICAgICAgICBzdXBlcigpLCB0aGlzLmtleSA9IHQsIHRoaXMuZGF0YSA9IGUsIHRoaXMuZmllbGRNYXNrID0gbiwgdGhpcy5wcmVjb25kaXRpb24gPSBzLCBcbiAgICAgICAgdGhpcy5maWVsZFRyYW5zZm9ybXMgPSBpLCB0aGlzLnR5cGUgPSAxIC8qIFBhdGNoICovO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gbm4odCkge1xuICAgIGNvbnN0IGUgPSBuZXcgTWFwO1xuICAgIHJldHVybiB0LmZpZWxkTWFzay5maWVsZHMuZm9yRWFjaCgobiA9PiB7XG4gICAgICAgIGlmICghbi5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSB0LmRhdGEuZmllbGQobik7XG4gICAgICAgICAgICBlLnNldChuLCBzKTtcbiAgICAgICAgfVxuICAgIH0pKSwgZTtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgbGlzdCBvZiBcInRyYW5zZm9ybSByZXN1bHRzXCIgKGEgdHJhbnNmb3JtIHJlc3VsdCBpcyBhIGZpZWxkIHZhbHVlXG4gKiByZXByZXNlbnRpbmcgdGhlIHJlc3VsdCBvZiBhcHBseWluZyBhIHRyYW5zZm9ybSkgZm9yIHVzZSBhZnRlciBhIG11dGF0aW9uXG4gKiBjb250YWluaW5nIHRyYW5zZm9ybXMgaGFzIGJlZW4gYWNrbm93bGVkZ2VkIGJ5IHRoZSBzZXJ2ZXIuXG4gKlxuICogQHBhcmFtIGZpZWxkVHJhbnNmb3JtcyAtIFRoZSBmaWVsZCB0cmFuc2Zvcm1zIHRvIGFwcGx5IHRoZSByZXN1bHQgdG8uXG4gKiBAcGFyYW0gbXV0YWJsZURvY3VtZW50IC0gVGhlIGN1cnJlbnQgc3RhdGUgb2YgdGhlIGRvY3VtZW50IGFmdGVyIGFwcGx5aW5nIGFsbFxuICogcHJldmlvdXMgbXV0YXRpb25zLlxuICogQHBhcmFtIHNlcnZlclRyYW5zZm9ybVJlc3VsdHMgLSBUaGUgdHJhbnNmb3JtIHJlc3VsdHMgcmVjZWl2ZWQgYnkgdGhlIHNlcnZlci5cbiAqIEByZXR1cm5zIFRoZSB0cmFuc2Zvcm0gcmVzdWx0cyBsaXN0LlxuICovIGZ1bmN0aW9uIHNuKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gbmV3IE1hcDtcbiAgICBMKHQubGVuZ3RoID09PSBuLmxlbmd0aCk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHIgPSB0W2ldLCBvID0gci50cmFuc2Zvcm0sIGEgPSBlLmRhdGEuZmllbGQoci5maWVsZCk7XG4gICAgICAgIHMuc2V0KHIuZmllbGQsIHhlKG8sIGEsIG5baV0pKTtcbiAgICB9XG4gICAgcmV0dXJuIHM7XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIGxpc3Qgb2YgXCJ0cmFuc2Zvcm0gcmVzdWx0c1wiIChhIHRyYW5zZm9ybSByZXN1bHQgaXMgYSBmaWVsZCB2YWx1ZVxuICogcmVwcmVzZW50aW5nIHRoZSByZXN1bHQgb2YgYXBwbHlpbmcgYSB0cmFuc2Zvcm0pIGZvciB1c2Ugd2hlbiBhcHBseWluZyBhXG4gKiB0cmFuc2Zvcm0gbG9jYWxseS5cbiAqXG4gKiBAcGFyYW0gZmllbGRUcmFuc2Zvcm1zIC0gVGhlIGZpZWxkIHRyYW5zZm9ybXMgdG8gYXBwbHkgdGhlIHJlc3VsdCB0by5cbiAqIEBwYXJhbSBsb2NhbFdyaXRlVGltZSAtIFRoZSBsb2NhbCB0aW1lIG9mIHRoZSBtdXRhdGlvbiAodXNlZCB0b1xuICogICAgIGdlbmVyYXRlIFNlcnZlclRpbWVzdGFtcFZhbHVlcykuXG4gKiBAcGFyYW0gbXV0YWJsZURvY3VtZW50IC0gVGhlIGN1cnJlbnQgc3RhdGUgb2YgdGhlIGRvY3VtZW50IGFmdGVyIGFwcGx5aW5nIGFsbFxuICogICAgIHByZXZpb3VzIG11dGF0aW9ucy5cbiAqIEByZXR1cm5zIFRoZSB0cmFuc2Zvcm0gcmVzdWx0cyBsaXN0LlxuICovIGZ1bmN0aW9uIHJuKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gbmV3IE1hcDtcbiAgICBmb3IgKGNvbnN0IGkgb2YgdCkge1xuICAgICAgICBjb25zdCB0ID0gaS50cmFuc2Zvcm0sIHIgPSBuLmRhdGEuZmllbGQoaS5maWVsZCk7XG4gICAgICAgIHMuc2V0KGkuZmllbGQsIE5lKHQsIHIsIGUpKTtcbiAgICB9XG4gICAgcmV0dXJuIHM7XG59XG5cbi8qKiBBIG11dGF0aW9uIHRoYXQgZGVsZXRlcyB0aGUgZG9jdW1lbnQgYXQgdGhlIGdpdmVuIGtleS4gKi8gY2xhc3Mgb24gZXh0ZW5kcyB6ZSB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICBzdXBlcigpLCB0aGlzLmtleSA9IHQsIHRoaXMucHJlY29uZGl0aW9uID0gZSwgdGhpcy50eXBlID0gMiAvKiBEZWxldGUgKi8gLCB0aGlzLmZpZWxkVHJhbnNmb3JtcyA9IFtdO1xuICAgIH1cbn1cblxuY2xhc3MgYW4gZXh0ZW5kcyB6ZSB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICBzdXBlcigpLCB0aGlzLmtleSA9IHQsIHRoaXMucHJlY29uZGl0aW9uID0gZSwgdGhpcy50eXBlID0gMyAvKiBWZXJpZnkgKi8gLCB0aGlzLmZpZWxkVHJhbnNmb3JtcyA9IFtdO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY2xhc3MgY24ge1xuICAgIC8vIFRPRE8oYi8zMzA3ODE2Myk6IGp1c3QgdXNlIHNpbXBsZXN0IGZvcm0gb2YgZXhpc3RlbmNlIGZpbHRlciBmb3Igbm93XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLmNvdW50ID0gdDtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEVycm9yIENvZGVzIGRlc2NyaWJpbmcgdGhlIGRpZmZlcmVudCB3YXlzIEdSUEMgY2FuIGZhaWwuIFRoZXNlIGFyZSBjb3BpZWRcbiAqIGRpcmVjdGx5IGZyb20gR1JQQydzIHNvdXJjZXMgaGVyZTpcbiAqXG4gKiBodHRwczovL2dpdGh1Yi5jb20vZ3JwYy9ncnBjL2Jsb2IvYmNlZWM5NGVhNGZjNWYwMDg1ZDgxMjM1ZDhlMWMwNjc5OGRjMzQxYS9pbmNsdWRlL2dycGMlMkIlMkIvaW1wbC9jb2RlZ2VuL3N0YXR1c19jb2RlX2VudW0uaFxuICpcbiAqIEltcG9ydGFudCEgVGhlIG5hbWVzIG9mIHRoZXNlIGlkZW50aWZpZXJzIG1hdHRlciBiZWNhdXNlIHRoZSBzdHJpbmcgZm9ybXNcbiAqIGFyZSB1c2VkIGZvciByZXZlcnNlIGxvb2t1cHMgZnJvbSB0aGUgd2ViY2hhbm5lbCBzdHJlYW0uIERvIE5PVCBjaGFuZ2UgdGhlXG4gKiBuYW1lcyBvZiB0aGVzZSBpZGVudGlmaWVycyBvciBjaGFuZ2UgdGhpcyBpbnRvIGEgY29uc3QgZW51bS5cbiAqLyB2YXIgdW4sIGhuO1xuXG4vKipcbiAqIERldGVybWluZXMgd2hldGhlciBhbiBlcnJvciBjb2RlIHJlcHJlc2VudHMgYSBwZXJtYW5lbnQgZXJyb3Igd2hlbiByZWNlaXZlZFxuICogaW4gcmVzcG9uc2UgdG8gYSBub24td3JpdGUgb3BlcmF0aW9uLlxuICpcbiAqIFNlZSBpc1Blcm1hbmVudFdyaXRlRXJyb3IgZm9yIGNsYXNzaWZ5aW5nIHdyaXRlIGVycm9ycy5cbiAqL1xuZnVuY3Rpb24gbG4odCkge1xuICAgIHN3aXRjaCAodCkge1xuICAgICAgY2FzZSBxLk9LOlxuICAgICAgICByZXR1cm4gTSgpO1xuXG4gICAgICBjYXNlIHEuQ0FOQ0VMTEVEOlxuICAgICAgY2FzZSBxLlVOS05PV046XG4gICAgICBjYXNlIHEuREVBRExJTkVfRVhDRUVERUQ6XG4gICAgICBjYXNlIHEuUkVTT1VSQ0VfRVhIQVVTVEVEOlxuICAgICAgY2FzZSBxLklOVEVSTkFMOlxuICAgICAgY2FzZSBxLlVOQVZBSUxBQkxFOlxuIC8vIFVuYXV0aGVudGljYXRlZCBtZWFucyBzb21ldGhpbmcgd2VudCB3cm9uZyB3aXRoIG91ciB0b2tlbiBhbmQgd2UgbmVlZFxuICAgICAgICAvLyB0byByZXRyeSB3aXRoIG5ldyBjcmVkZW50aWFscyB3aGljaCB3aWxsIGhhcHBlbiBhdXRvbWF0aWNhbGx5LlxuICAgICAgICAgICAgICBjYXNlIHEuVU5BVVRIRU5USUNBVEVEOlxuICAgICAgICByZXR1cm4gITE7XG5cbiAgICAgIGNhc2UgcS5JTlZBTElEX0FSR1VNRU5UOlxuICAgICAgY2FzZSBxLk5PVF9GT1VORDpcbiAgICAgIGNhc2UgcS5BTFJFQURZX0VYSVNUUzpcbiAgICAgIGNhc2UgcS5QRVJNSVNTSU9OX0RFTklFRDpcbiAgICAgIGNhc2UgcS5GQUlMRURfUFJFQ09ORElUSU9OOlxuIC8vIEFib3J0ZWQgbWlnaHQgYmUgcmV0cmllZCBpbiBzb21lIHNjZW5hcmlvcywgYnV0IHRoYXQgaXMgZGVwZW5kYW50IG9uXG4gICAgICAgIC8vIHRoZSBjb250ZXh0IGFuZCBzaG91bGQgaGFuZGxlZCBpbmRpdmlkdWFsbHkgYnkgdGhlIGNhbGxpbmcgY29kZS5cbiAgICAgICAgLy8gU2VlIGh0dHBzOi8vY2xvdWQuZ29vZ2xlLmNvbS9hcGlzL2Rlc2lnbi9lcnJvcnMuXG4gICAgICAgICAgICAgIGNhc2UgcS5BQk9SVEVEOlxuICAgICAgY2FzZSBxLk9VVF9PRl9SQU5HRTpcbiAgICAgIGNhc2UgcS5VTklNUExFTUVOVEVEOlxuICAgICAgY2FzZSBxLkRBVEFfTE9TUzpcbiAgICAgICAgcmV0dXJuICEwO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gTSgpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBEZXRlcm1pbmVzIHdoZXRoZXIgYW4gZXJyb3IgY29kZSByZXByZXNlbnRzIGEgcGVybWFuZW50IGVycm9yIHdoZW4gcmVjZWl2ZWRcbiAqIGluIHJlc3BvbnNlIHRvIGEgd3JpdGUgb3BlcmF0aW9uLlxuICpcbiAqIFdyaXRlIG9wZXJhdGlvbnMgbXVzdCBiZSBoYW5kbGVkIHNwZWNpYWxseSBiZWNhdXNlIGFzIG9mIGIvMTE5NDM3NzY0LCBBQk9SVEVEXG4gKiBlcnJvcnMgb24gdGhlIHdyaXRlIHN0cmVhbSBzaG91bGQgYmUgcmV0cmllZCB0b28gKGV2ZW4gdGhvdWdoIEFCT1JURUQgZXJyb3JzXG4gKiBhcmUgbm90IGdlbmVyYWxseSByZXRyeWFibGUpLlxuICpcbiAqIE5vdGUgdGhhdCBkdXJpbmcgdGhlIGluaXRpYWwgaGFuZHNoYWtlIG9uIHRoZSB3cml0ZSBzdHJlYW0gYW4gQUJPUlRFRCBlcnJvclxuICogc2lnbmFscyB0aGF0IHdlIHNob3VsZCBkaXNjYXJkIG91ciBzdHJlYW0gdG9rZW4gKGkuZS4gaXQgaXMgcGVybWFuZW50KS4gVGhpc1xuICogbWVhbnMgYSBoYW5kc2hha2UgZXJyb3Igc2hvdWxkIGJlIGNsYXNzaWZpZWQgd2l0aCBpc1Blcm1hbmVudEVycm9yLCBhYm92ZS5cbiAqL1xuLyoqXG4gKiBNYXBzIGFuIGVycm9yIENvZGUgZnJvbSBHUlBDIHN0YXR1cyBjb2RlIG51bWJlciwgbGlrZSAwLCAxLCBvciAxNC4gVGhlc2VcbiAqIGFyZSBub3QgdGhlIHNhbWUgYXMgSFRUUCBzdGF0dXMgY29kZXMuXG4gKlxuICogQHJldHVybnMgVGhlIENvZGUgZXF1aXZhbGVudCB0byB0aGUgZ2l2ZW4gR1JQQyBzdGF0dXMgY29kZS4gRmFpbHMgaWYgdGhlcmVcbiAqICAgICBpcyBubyBtYXRjaC5cbiAqL1xuZnVuY3Rpb24gZm4odCkge1xuICAgIGlmICh2b2lkIDAgPT09IHQpIFxuICAgIC8vIFRoaXMgc2hvdWxkbid0IG5vcm1hbGx5IGhhcHBlbiwgYnV0IGluIGNlcnRhaW4gZXJyb3IgY2FzZXMgKGxpa2UgdHJ5aW5nXG4gICAgLy8gdG8gc2VuZCBpbnZhbGlkIHByb3RvIG1lc3NhZ2VzKSB3ZSBtYXkgZ2V0IGFuIGVycm9yIHdpdGggbm8gR1JQQyBjb2RlLlxuICAgIHJldHVybiAkKFwiR1JQQyBlcnJvciBoYXMgbm8gLmNvZGVcIiksIHEuVU5LTk9XTjtcbiAgICBzd2l0Y2ggKHQpIHtcbiAgICAgIGNhc2UgdW4uT0s6XG4gICAgICAgIHJldHVybiBxLk9LO1xuXG4gICAgICBjYXNlIHVuLkNBTkNFTExFRDpcbiAgICAgICAgcmV0dXJuIHEuQ0FOQ0VMTEVEO1xuXG4gICAgICBjYXNlIHVuLlVOS05PV046XG4gICAgICAgIHJldHVybiBxLlVOS05PV047XG5cbiAgICAgIGNhc2UgdW4uREVBRExJTkVfRVhDRUVERUQ6XG4gICAgICAgIHJldHVybiBxLkRFQURMSU5FX0VYQ0VFREVEO1xuXG4gICAgICBjYXNlIHVuLlJFU09VUkNFX0VYSEFVU1RFRDpcbiAgICAgICAgcmV0dXJuIHEuUkVTT1VSQ0VfRVhIQVVTVEVEO1xuXG4gICAgICBjYXNlIHVuLklOVEVSTkFMOlxuICAgICAgICByZXR1cm4gcS5JTlRFUk5BTDtcblxuICAgICAgY2FzZSB1bi5VTkFWQUlMQUJMRTpcbiAgICAgICAgcmV0dXJuIHEuVU5BVkFJTEFCTEU7XG5cbiAgICAgIGNhc2UgdW4uVU5BVVRIRU5USUNBVEVEOlxuICAgICAgICByZXR1cm4gcS5VTkFVVEhFTlRJQ0FURUQ7XG5cbiAgICAgIGNhc2UgdW4uSU5WQUxJRF9BUkdVTUVOVDpcbiAgICAgICAgcmV0dXJuIHEuSU5WQUxJRF9BUkdVTUVOVDtcblxuICAgICAgY2FzZSB1bi5OT1RfRk9VTkQ6XG4gICAgICAgIHJldHVybiBxLk5PVF9GT1VORDtcblxuICAgICAgY2FzZSB1bi5BTFJFQURZX0VYSVNUUzpcbiAgICAgICAgcmV0dXJuIHEuQUxSRUFEWV9FWElTVFM7XG5cbiAgICAgIGNhc2UgdW4uUEVSTUlTU0lPTl9ERU5JRUQ6XG4gICAgICAgIHJldHVybiBxLlBFUk1JU1NJT05fREVOSUVEO1xuXG4gICAgICBjYXNlIHVuLkZBSUxFRF9QUkVDT05ESVRJT046XG4gICAgICAgIHJldHVybiBxLkZBSUxFRF9QUkVDT05ESVRJT047XG5cbiAgICAgIGNhc2UgdW4uQUJPUlRFRDpcbiAgICAgICAgcmV0dXJuIHEuQUJPUlRFRDtcblxuICAgICAgY2FzZSB1bi5PVVRfT0ZfUkFOR0U6XG4gICAgICAgIHJldHVybiBxLk9VVF9PRl9SQU5HRTtcblxuICAgICAgY2FzZSB1bi5VTklNUExFTUVOVEVEOlxuICAgICAgICByZXR1cm4gcS5VTklNUExFTUVOVEVEO1xuXG4gICAgICBjYXNlIHVuLkRBVEFfTE9TUzpcbiAgICAgICAgcmV0dXJuIHEuREFUQV9MT1NTO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gTSgpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDb252ZXJ0cyBhbiBIVFRQIHJlc3BvbnNlJ3MgZXJyb3Igc3RhdHVzIHRvIHRoZSBlcXVpdmFsZW50IGVycm9yIGNvZGUuXG4gKlxuICogQHBhcmFtIHN0YXR1cyAtIEFuIEhUVFAgZXJyb3IgcmVzcG9uc2Ugc3RhdHVzIChcIkZBSUxFRF9QUkVDT05ESVRJT05cIixcbiAqIFwiVU5LTk9XTlwiLCBldGMuKVxuICogQHJldHVybnMgVGhlIGVxdWl2YWxlbnQgQ29kZS4gTm9uLW1hdGNoaW5nIHJlc3BvbnNlcyBhcmUgbWFwcGVkIHRvXG4gKiAgICAgQ29kZS5VTktOT1dOLlxuICovIChobiA9IHVuIHx8ICh1biA9IHt9KSlbaG4uT0sgPSAwXSA9IFwiT0tcIiwgaG5baG4uQ0FOQ0VMTEVEID0gMV0gPSBcIkNBTkNFTExFRFwiLCBcbmhuW2huLlVOS05PV04gPSAyXSA9IFwiVU5LTk9XTlwiLCBobltobi5JTlZBTElEX0FSR1VNRU5UID0gM10gPSBcIklOVkFMSURfQVJHVU1FTlRcIiwgXG5obltobi5ERUFETElORV9FWENFRURFRCA9IDRdID0gXCJERUFETElORV9FWENFRURFRFwiLCBobltobi5OT1RfRk9VTkQgPSA1XSA9IFwiTk9UX0ZPVU5EXCIsIFxuaG5baG4uQUxSRUFEWV9FWElTVFMgPSA2XSA9IFwiQUxSRUFEWV9FWElTVFNcIiwgaG5baG4uUEVSTUlTU0lPTl9ERU5JRUQgPSA3XSA9IFwiUEVSTUlTU0lPTl9ERU5JRURcIiwgXG5obltobi5VTkFVVEhFTlRJQ0FURUQgPSAxNl0gPSBcIlVOQVVUSEVOVElDQVRFRFwiLCBobltobi5SRVNPVVJDRV9FWEhBVVNURUQgPSA4XSA9IFwiUkVTT1VSQ0VfRVhIQVVTVEVEXCIsIFxuaG5baG4uRkFJTEVEX1BSRUNPTkRJVElPTiA9IDldID0gXCJGQUlMRURfUFJFQ09ORElUSU9OXCIsIGhuW2huLkFCT1JURUQgPSAxMF0gPSBcIkFCT1JURURcIiwgXG5obltobi5PVVRfT0ZfUkFOR0UgPSAxMV0gPSBcIk9VVF9PRl9SQU5HRVwiLCBobltobi5VTklNUExFTUVOVEVEID0gMTJdID0gXCJVTklNUExFTUVOVEVEXCIsIFxuaG5baG4uSU5URVJOQUwgPSAxM10gPSBcIklOVEVSTkFMXCIsIGhuW2huLlVOQVZBSUxBQkxFID0gMTRdID0gXCJVTkFWQUlMQUJMRVwiLCBobltobi5EQVRBX0xPU1MgPSAxNV0gPSBcIkRBVEFfTE9TU1wiO1xuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLy8gQW4gaW1tdXRhYmxlIHNvcnRlZCBtYXAgaW1wbGVtZW50YXRpb24sIGJhc2VkIG9uIGEgTGVmdC1sZWFuaW5nIFJlZC1CbGFja1xuLy8gdHJlZS5cbmNsYXNzIGRuIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMuY29tcGFyYXRvciA9IHQsIHRoaXMucm9vdCA9IGUgfHwgX24uRU1QVFk7XG4gICAgfVxuICAgIC8vIFJldHVybnMgYSBjb3B5IG9mIHRoZSBtYXAsIHdpdGggdGhlIHNwZWNpZmllZCBrZXkvdmFsdWUgYWRkZWQgb3IgcmVwbGFjZWQuXG4gICAgaW5zZXJ0KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBkbih0aGlzLmNvbXBhcmF0b3IsIHRoaXMucm9vdC5pbnNlcnQodCwgZSwgdGhpcy5jb21wYXJhdG9yKS5jb3B5KG51bGwsIG51bGwsIF9uLkJMQUNLLCBudWxsLCBudWxsKSk7XG4gICAgfVxuICAgIC8vIFJldHVybnMgYSBjb3B5IG9mIHRoZSBtYXAsIHdpdGggdGhlIHNwZWNpZmllZCBrZXkgcmVtb3ZlZC5cbiAgICByZW1vdmUodCkge1xuICAgICAgICByZXR1cm4gbmV3IGRuKHRoaXMuY29tcGFyYXRvciwgdGhpcy5yb290LnJlbW92ZSh0LCB0aGlzLmNvbXBhcmF0b3IpLmNvcHkobnVsbCwgbnVsbCwgX24uQkxBQ0ssIG51bGwsIG51bGwpKTtcbiAgICB9XG4gICAgLy8gUmV0dXJucyB0aGUgdmFsdWUgb2YgdGhlIG5vZGUgd2l0aCB0aGUgZ2l2ZW4ga2V5LCBvciBudWxsLlxuICAgIGdldCh0KSB7XG4gICAgICAgIGxldCBlID0gdGhpcy5yb290O1xuICAgICAgICBmb3IgKDshZS5pc0VtcHR5KCk7ICkge1xuICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuY29tcGFyYXRvcih0LCBlLmtleSk7XG4gICAgICAgICAgICBpZiAoMCA9PT0gbikgcmV0dXJuIGUudmFsdWU7XG4gICAgICAgICAgICBuIDwgMCA/IGUgPSBlLmxlZnQgOiBuID4gMCAmJiAoZSA9IGUucmlnaHQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIHRoZSBpbmRleCBvZiB0aGUgZWxlbWVudCBpbiB0aGlzIHNvcnRlZCBtYXAsIG9yIC0xIGlmIGl0IGRvZXNuJ3RcbiAgICAvLyBleGlzdC5cbiAgICBpbmRleE9mKHQpIHtcbiAgICAgICAgLy8gTnVtYmVyIG9mIG5vZGVzIHRoYXQgd2VyZSBwcnVuZWQgd2hlbiBkZXNjZW5kaW5nIHJpZ2h0XG4gICAgICAgIGxldCBlID0gMCwgbiA9IHRoaXMucm9vdDtcbiAgICAgICAgZm9yICg7IW4uaXNFbXB0eSgpOyApIHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSB0aGlzLmNvbXBhcmF0b3IodCwgbi5rZXkpO1xuICAgICAgICAgICAgaWYgKDAgPT09IHMpIHJldHVybiBlICsgbi5sZWZ0LnNpemU7XG4gICAgICAgICAgICBzIDwgMCA/IG4gPSBuLmxlZnQgOiAoXG4gICAgICAgICAgICAvLyBDb3VudCBhbGwgbm9kZXMgbGVmdCBvZiB0aGUgbm9kZSBwbHVzIHRoZSBub2RlIGl0c2VsZlxuICAgICAgICAgICAgZSArPSBuLmxlZnQuc2l6ZSArIDEsIG4gPSBuLnJpZ2h0KTtcbiAgICAgICAgfVxuICAgICAgICAvLyBOb2RlIG5vdCBmb3VuZFxuICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgaXNFbXB0eSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucm9vdC5pc0VtcHR5KCk7XG4gICAgfVxuICAgIC8vIFJldHVybnMgdGhlIHRvdGFsIG51bWJlciBvZiBub2RlcyBpbiB0aGUgbWFwLlxuICAgIGdldCBzaXplKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yb290LnNpemU7XG4gICAgfVxuICAgIC8vIFJldHVybnMgdGhlIG1pbmltdW0ga2V5IGluIHRoZSBtYXAuXG4gICAgbWluS2V5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yb290Lm1pbktleSgpO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIHRoZSBtYXhpbXVtIGtleSBpbiB0aGUgbWFwLlxuICAgIG1heEtleSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucm9vdC5tYXhLZXkoKTtcbiAgICB9XG4gICAgLy8gVHJhdmVyc2VzIHRoZSBtYXAgaW4ga2V5IG9yZGVyIGFuZCBjYWxscyB0aGUgc3BlY2lmaWVkIGFjdGlvbiBmdW5jdGlvblxuICAgIC8vIGZvciBlYWNoIGtleS92YWx1ZSBwYWlyLiBJZiBhY3Rpb24gcmV0dXJucyB0cnVlLCB0cmF2ZXJzYWwgaXMgYWJvcnRlZC5cbiAgICAvLyBSZXR1cm5zIHRoZSBmaXJzdCB0cnV0aHkgdmFsdWUgcmV0dXJuZWQgYnkgYWN0aW9uLCBvciB0aGUgbGFzdCBmYWxzZXlcbiAgICAvLyB2YWx1ZSByZXR1cm5lZCBieSBhY3Rpb24uXG4gICAgaW5vcmRlclRyYXZlcnNhbCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJvb3QuaW5vcmRlclRyYXZlcnNhbCh0KTtcbiAgICB9XG4gICAgZm9yRWFjaCh0KSB7XG4gICAgICAgIHRoaXMuaW5vcmRlclRyYXZlcnNhbCgoKGUsIG4pID0+ICh0KGUsIG4pLCAhMSkpKTtcbiAgICB9XG4gICAgdG9TdHJpbmcoKSB7XG4gICAgICAgIGNvbnN0IHQgPSBbXTtcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5vcmRlclRyYXZlcnNhbCgoKGUsIG4pID0+ICh0LnB1c2goYCR7ZX06JHtufWApLCAhMSkpKSwgYHske3Quam9pbihcIiwgXCIpfX1gO1xuICAgIH1cbiAgICAvLyBUcmF2ZXJzZXMgdGhlIG1hcCBpbiByZXZlcnNlIGtleSBvcmRlciBhbmQgY2FsbHMgdGhlIHNwZWNpZmllZCBhY3Rpb25cbiAgICAvLyBmdW5jdGlvbiBmb3IgZWFjaCBrZXkvdmFsdWUgcGFpci4gSWYgYWN0aW9uIHJldHVybnMgdHJ1ZSwgdHJhdmVyc2FsIGlzXG4gICAgLy8gYWJvcnRlZC5cbiAgICAvLyBSZXR1cm5zIHRoZSBmaXJzdCB0cnV0aHkgdmFsdWUgcmV0dXJuZWQgYnkgYWN0aW9uLCBvciB0aGUgbGFzdCBmYWxzZXlcbiAgICAvLyB2YWx1ZSByZXR1cm5lZCBieSBhY3Rpb24uXG4gICAgcmV2ZXJzZVRyYXZlcnNhbCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJvb3QucmV2ZXJzZVRyYXZlcnNhbCh0KTtcbiAgICB9XG4gICAgLy8gUmV0dXJucyBhbiBpdGVyYXRvciBvdmVyIHRoZSBTb3J0ZWRNYXAuXG4gICAgZ2V0SXRlcmF0b3IoKSB7XG4gICAgICAgIHJldHVybiBuZXcgd24odGhpcy5yb290LCBudWxsLCB0aGlzLmNvbXBhcmF0b3IsICExKTtcbiAgICB9XG4gICAgZ2V0SXRlcmF0b3JGcm9tKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyB3bih0aGlzLnJvb3QsIHQsIHRoaXMuY29tcGFyYXRvciwgITEpO1xuICAgIH1cbiAgICBnZXRSZXZlcnNlSXRlcmF0b3IoKSB7XG4gICAgICAgIHJldHVybiBuZXcgd24odGhpcy5yb290LCBudWxsLCB0aGlzLmNvbXBhcmF0b3IsICEwKTtcbiAgICB9XG4gICAgZ2V0UmV2ZXJzZUl0ZXJhdG9yRnJvbSh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgd24odGhpcy5yb290LCB0LCB0aGlzLmNvbXBhcmF0b3IsICEwKTtcbiAgICB9XG59XG5cbiAvLyBlbmQgU29ydGVkTWFwXG4vLyBBbiBpdGVyYXRvciBvdmVyIGFuIExMUkJOb2RlLlxuY2xhc3Mgd24ge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgdGhpcy5pc1JldmVyc2UgPSBzLCB0aGlzLm5vZGVTdGFjayA9IFtdO1xuICAgICAgICBsZXQgaSA9IDE7XG4gICAgICAgIGZvciAoOyF0LmlzRW1wdHkoKTsgKSBpZiAoaSA9IGUgPyBuKHQua2V5LCBlKSA6IDEsIFxuICAgICAgICAvLyBmbGlwIHRoZSBjb21wYXJpc29uIGlmIHdlJ3JlIGdvaW5nIGluIHJldmVyc2VcbiAgICAgICAgcyAmJiAoaSAqPSAtMSksIGkgPCAwKSBcbiAgICAgICAgLy8gVGhpcyBub2RlIGlzIGxlc3MgdGhhbiBvdXIgc3RhcnQga2V5LiBpZ25vcmUgaXRcbiAgICAgICAgdCA9IHRoaXMuaXNSZXZlcnNlID8gdC5sZWZ0IDogdC5yaWdodDsgZWxzZSB7XG4gICAgICAgICAgICBpZiAoMCA9PT0gaSkge1xuICAgICAgICAgICAgICAgIC8vIFRoaXMgbm9kZSBpcyBleGFjdGx5IGVxdWFsIHRvIG91ciBzdGFydCBrZXkuIFB1c2ggaXQgb24gdGhlIHN0YWNrLFxuICAgICAgICAgICAgICAgIC8vIGJ1dCBzdG9wIGl0ZXJhdGluZztcbiAgICAgICAgICAgICAgICB0aGlzLm5vZGVTdGFjay5wdXNoKHQpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gVGhpcyBub2RlIGlzIGdyZWF0ZXIgdGhhbiBvdXIgc3RhcnQga2V5LCBhZGQgaXQgdG8gdGhlIHN0YWNrIGFuZCBtb3ZlXG4gICAgICAgICAgICAvLyB0byB0aGUgbmV4dCBvbmVcbiAgICAgICAgICAgIHRoaXMubm9kZVN0YWNrLnB1c2godCksIHQgPSB0aGlzLmlzUmV2ZXJzZSA/IHQucmlnaHQgOiB0LmxlZnQ7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0TmV4dCgpIHtcbiAgICAgICAgbGV0IHQgPSB0aGlzLm5vZGVTdGFjay5wb3AoKTtcbiAgICAgICAgY29uc3QgZSA9IHtcbiAgICAgICAgICAgIGtleTogdC5rZXksXG4gICAgICAgICAgICB2YWx1ZTogdC52YWx1ZVxuICAgICAgICB9O1xuICAgICAgICBpZiAodGhpcy5pc1JldmVyc2UpIGZvciAodCA9IHQubGVmdDsgIXQuaXNFbXB0eSgpOyApIHRoaXMubm9kZVN0YWNrLnB1c2godCksIHQgPSB0LnJpZ2h0OyBlbHNlIGZvciAodCA9IHQucmlnaHQ7ICF0LmlzRW1wdHkoKTsgKSB0aGlzLm5vZGVTdGFjay5wdXNoKHQpLCBcbiAgICAgICAgdCA9IHQubGVmdDtcbiAgICAgICAgcmV0dXJuIGU7XG4gICAgfVxuICAgIGhhc05leHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5vZGVTdGFjay5sZW5ndGggPiAwO1xuICAgIH1cbiAgICBwZWVrKCkge1xuICAgICAgICBpZiAoMCA9PT0gdGhpcy5ub2RlU3RhY2subGVuZ3RoKSByZXR1cm4gbnVsbDtcbiAgICAgICAgY29uc3QgdCA9IHRoaXMubm9kZVN0YWNrW3RoaXMubm9kZVN0YWNrLmxlbmd0aCAtIDFdO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAga2V5OiB0LmtleSxcbiAgICAgICAgICAgIHZhbHVlOiB0LnZhbHVlXG4gICAgICAgIH07XG4gICAgfVxufVxuXG4gLy8gZW5kIFNvcnRlZE1hcEl0ZXJhdG9yXG4vLyBSZXByZXNlbnRzIGEgbm9kZSBpbiBhIExlZnQtbGVhbmluZyBSZWQtQmxhY2sgdHJlZS5cbmNsYXNzIF9uIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzLCBpKSB7XG4gICAgICAgIHRoaXMua2V5ID0gdCwgdGhpcy52YWx1ZSA9IGUsIHRoaXMuY29sb3IgPSBudWxsICE9IG4gPyBuIDogX24uUkVELCB0aGlzLmxlZnQgPSBudWxsICE9IHMgPyBzIDogX24uRU1QVFksIFxuICAgICAgICB0aGlzLnJpZ2h0ID0gbnVsbCAhPSBpID8gaSA6IF9uLkVNUFRZLCB0aGlzLnNpemUgPSB0aGlzLmxlZnQuc2l6ZSArIDEgKyB0aGlzLnJpZ2h0LnNpemU7XG4gICAgfVxuICAgIC8vIFJldHVybnMgYSBjb3B5IG9mIHRoZSBjdXJyZW50IG5vZGUsIG9wdGlvbmFsbHkgcmVwbGFjaW5nIHBpZWNlcyBvZiBpdC5cbiAgICBjb3B5KHQsIGUsIG4sIHMsIGkpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBfbihudWxsICE9IHQgPyB0IDogdGhpcy5rZXksIG51bGwgIT0gZSA/IGUgOiB0aGlzLnZhbHVlLCBudWxsICE9IG4gPyBuIDogdGhpcy5jb2xvciwgbnVsbCAhPSBzID8gcyA6IHRoaXMubGVmdCwgbnVsbCAhPSBpID8gaSA6IHRoaXMucmlnaHQpO1xuICAgIH1cbiAgICBpc0VtcHR5KCkge1xuICAgICAgICByZXR1cm4gITE7XG4gICAgfVxuICAgIC8vIFRyYXZlcnNlcyB0aGUgdHJlZSBpbiBrZXkgb3JkZXIgYW5kIGNhbGxzIHRoZSBzcGVjaWZpZWQgYWN0aW9uIGZ1bmN0aW9uXG4gICAgLy8gZm9yIGVhY2ggbm9kZS4gSWYgYWN0aW9uIHJldHVybnMgdHJ1ZSwgdHJhdmVyc2FsIGlzIGFib3J0ZWQuXG4gICAgLy8gUmV0dXJucyB0aGUgZmlyc3QgdHJ1dGh5IHZhbHVlIHJldHVybmVkIGJ5IGFjdGlvbiwgb3IgdGhlIGxhc3QgZmFsc2V5XG4gICAgLy8gdmFsdWUgcmV0dXJuZWQgYnkgYWN0aW9uLlxuICAgIGlub3JkZXJUcmF2ZXJzYWwodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5sZWZ0Lmlub3JkZXJUcmF2ZXJzYWwodCkgfHwgdCh0aGlzLmtleSwgdGhpcy52YWx1ZSkgfHwgdGhpcy5yaWdodC5pbm9yZGVyVHJhdmVyc2FsKHQpO1xuICAgIH1cbiAgICAvLyBUcmF2ZXJzZXMgdGhlIHRyZWUgaW4gcmV2ZXJzZSBrZXkgb3JkZXIgYW5kIGNhbGxzIHRoZSBzcGVjaWZpZWQgYWN0aW9uXG4gICAgLy8gZnVuY3Rpb24gZm9yIGVhY2ggbm9kZS4gSWYgYWN0aW9uIHJldHVybnMgdHJ1ZSwgdHJhdmVyc2FsIGlzIGFib3J0ZWQuXG4gICAgLy8gUmV0dXJucyB0aGUgZmlyc3QgdHJ1dGh5IHZhbHVlIHJldHVybmVkIGJ5IGFjdGlvbiwgb3IgdGhlIGxhc3QgZmFsc2V5XG4gICAgLy8gdmFsdWUgcmV0dXJuZWQgYnkgYWN0aW9uLlxuICAgIHJldmVyc2VUcmF2ZXJzYWwodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yaWdodC5yZXZlcnNlVHJhdmVyc2FsKHQpIHx8IHQodGhpcy5rZXksIHRoaXMudmFsdWUpIHx8IHRoaXMubGVmdC5yZXZlcnNlVHJhdmVyc2FsKHQpO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIHRoZSBtaW5pbXVtIG5vZGUgaW4gdGhlIHRyZWUuXG4gICAgbWluKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5sZWZ0LmlzRW1wdHkoKSA/IHRoaXMgOiB0aGlzLmxlZnQubWluKCk7XG4gICAgfVxuICAgIC8vIFJldHVybnMgdGhlIG1heGltdW0ga2V5IGluIHRoZSB0cmVlLlxuICAgIG1pbktleSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubWluKCkua2V5O1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIHRoZSBtYXhpbXVtIGtleSBpbiB0aGUgdHJlZS5cbiAgICBtYXhLZXkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJpZ2h0LmlzRW1wdHkoKSA/IHRoaXMua2V5IDogdGhpcy5yaWdodC5tYXhLZXkoKTtcbiAgICB9XG4gICAgLy8gUmV0dXJucyBuZXcgdHJlZSwgd2l0aCB0aGUga2V5L3ZhbHVlIGFkZGVkLlxuICAgIGluc2VydCh0LCBlLCBuKSB7XG4gICAgICAgIGxldCBzID0gdGhpcztcbiAgICAgICAgY29uc3QgaSA9IG4odCwgcy5rZXkpO1xuICAgICAgICByZXR1cm4gcyA9IGkgPCAwID8gcy5jb3B5KG51bGwsIG51bGwsIG51bGwsIHMubGVmdC5pbnNlcnQodCwgZSwgbiksIG51bGwpIDogMCA9PT0gaSA/IHMuY29weShudWxsLCBlLCBudWxsLCBudWxsLCBudWxsKSA6IHMuY29weShudWxsLCBudWxsLCBudWxsLCBudWxsLCBzLnJpZ2h0Lmluc2VydCh0LCBlLCBuKSksIFxuICAgICAgICBzLmZpeFVwKCk7XG4gICAgfVxuICAgIHJlbW92ZU1pbigpIHtcbiAgICAgICAgaWYgKHRoaXMubGVmdC5pc0VtcHR5KCkpIHJldHVybiBfbi5FTVBUWTtcbiAgICAgICAgbGV0IHQgPSB0aGlzO1xuICAgICAgICByZXR1cm4gdC5sZWZ0LmlzUmVkKCkgfHwgdC5sZWZ0LmxlZnQuaXNSZWQoKSB8fCAodCA9IHQubW92ZVJlZExlZnQoKSksIHQgPSB0LmNvcHkobnVsbCwgbnVsbCwgbnVsbCwgdC5sZWZ0LnJlbW92ZU1pbigpLCBudWxsKSwgXG4gICAgICAgIHQuZml4VXAoKTtcbiAgICB9XG4gICAgLy8gUmV0dXJucyBuZXcgdHJlZSwgd2l0aCB0aGUgc3BlY2lmaWVkIGl0ZW0gcmVtb3ZlZC5cbiAgICByZW1vdmUodCwgZSkge1xuICAgICAgICBsZXQgbiwgcyA9IHRoaXM7XG4gICAgICAgIGlmIChlKHQsIHMua2V5KSA8IDApIHMubGVmdC5pc0VtcHR5KCkgfHwgcy5sZWZ0LmlzUmVkKCkgfHwgcy5sZWZ0LmxlZnQuaXNSZWQoKSB8fCAocyA9IHMubW92ZVJlZExlZnQoKSksIFxuICAgICAgICBzID0gcy5jb3B5KG51bGwsIG51bGwsIG51bGwsIHMubGVmdC5yZW1vdmUodCwgZSksIG51bGwpOyBlbHNlIHtcbiAgICAgICAgICAgIGlmIChzLmxlZnQuaXNSZWQoKSAmJiAocyA9IHMucm90YXRlUmlnaHQoKSksIHMucmlnaHQuaXNFbXB0eSgpIHx8IHMucmlnaHQuaXNSZWQoKSB8fCBzLnJpZ2h0LmxlZnQuaXNSZWQoKSB8fCAocyA9IHMubW92ZVJlZFJpZ2h0KCkpLCBcbiAgICAgICAgICAgIDAgPT09IGUodCwgcy5rZXkpKSB7XG4gICAgICAgICAgICAgICAgaWYgKHMucmlnaHQuaXNFbXB0eSgpKSByZXR1cm4gX24uRU1QVFk7XG4gICAgICAgICAgICAgICAgbiA9IHMucmlnaHQubWluKCksIHMgPSBzLmNvcHkobi5rZXksIG4udmFsdWUsIG51bGwsIG51bGwsIHMucmlnaHQucmVtb3ZlTWluKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcyA9IHMuY29weShudWxsLCBudWxsLCBudWxsLCBudWxsLCBzLnJpZ2h0LnJlbW92ZSh0LCBlKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHMuZml4VXAoKTtcbiAgICB9XG4gICAgaXNSZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbG9yO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIG5ldyB0cmVlIGFmdGVyIHBlcmZvcm1pbmcgYW55IG5lZWRlZCByb3RhdGlvbnMuXG4gICAgZml4VXAoKSB7XG4gICAgICAgIGxldCB0ID0gdGhpcztcbiAgICAgICAgcmV0dXJuIHQucmlnaHQuaXNSZWQoKSAmJiAhdC5sZWZ0LmlzUmVkKCkgJiYgKHQgPSB0LnJvdGF0ZUxlZnQoKSksIHQubGVmdC5pc1JlZCgpICYmIHQubGVmdC5sZWZ0LmlzUmVkKCkgJiYgKHQgPSB0LnJvdGF0ZVJpZ2h0KCkpLCBcbiAgICAgICAgdC5sZWZ0LmlzUmVkKCkgJiYgdC5yaWdodC5pc1JlZCgpICYmICh0ID0gdC5jb2xvckZsaXAoKSksIHQ7XG4gICAgfVxuICAgIG1vdmVSZWRMZWZ0KCkge1xuICAgICAgICBsZXQgdCA9IHRoaXMuY29sb3JGbGlwKCk7XG4gICAgICAgIHJldHVybiB0LnJpZ2h0LmxlZnQuaXNSZWQoKSAmJiAodCA9IHQuY29weShudWxsLCBudWxsLCBudWxsLCBudWxsLCB0LnJpZ2h0LnJvdGF0ZVJpZ2h0KCkpLCBcbiAgICAgICAgdCA9IHQucm90YXRlTGVmdCgpLCB0ID0gdC5jb2xvckZsaXAoKSksIHQ7XG4gICAgfVxuICAgIG1vdmVSZWRSaWdodCgpIHtcbiAgICAgICAgbGV0IHQgPSB0aGlzLmNvbG9yRmxpcCgpO1xuICAgICAgICByZXR1cm4gdC5sZWZ0LmxlZnQuaXNSZWQoKSAmJiAodCA9IHQucm90YXRlUmlnaHQoKSwgdCA9IHQuY29sb3JGbGlwKCkpLCB0O1xuICAgIH1cbiAgICByb3RhdGVMZWZ0KCkge1xuICAgICAgICBjb25zdCB0ID0gdGhpcy5jb3B5KG51bGwsIG51bGwsIF9uLlJFRCwgbnVsbCwgdGhpcy5yaWdodC5sZWZ0KTtcbiAgICAgICAgcmV0dXJuIHRoaXMucmlnaHQuY29weShudWxsLCBudWxsLCB0aGlzLmNvbG9yLCB0LCBudWxsKTtcbiAgICB9XG4gICAgcm90YXRlUmlnaHQoKSB7XG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLmNvcHkobnVsbCwgbnVsbCwgX24uUkVELCB0aGlzLmxlZnQucmlnaHQsIG51bGwpO1xuICAgICAgICByZXR1cm4gdGhpcy5sZWZ0LmNvcHkobnVsbCwgbnVsbCwgdGhpcy5jb2xvciwgbnVsbCwgdCk7XG4gICAgfVxuICAgIGNvbG9yRmxpcCgpIHtcbiAgICAgICAgY29uc3QgdCA9IHRoaXMubGVmdC5jb3B5KG51bGwsIG51bGwsICF0aGlzLmxlZnQuY29sb3IsIG51bGwsIG51bGwpLCBlID0gdGhpcy5yaWdodC5jb3B5KG51bGwsIG51bGwsICF0aGlzLnJpZ2h0LmNvbG9yLCBudWxsLCBudWxsKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29weShudWxsLCBudWxsLCAhdGhpcy5jb2xvciwgdCwgZSk7XG4gICAgfVxuICAgIC8vIEZvciB0ZXN0aW5nLlxuICAgIGNoZWNrTWF4RGVwdGgoKSB7XG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLmNoZWNrKCk7XG4gICAgICAgIHJldHVybiBNYXRoLnBvdygyLCB0KSA8PSB0aGlzLnNpemUgKyAxO1xuICAgIH1cbiAgICAvLyBJbiBhIGJhbGFuY2VkIFJCIHRyZWUsIHRoZSBibGFjay1kZXB0aCAobnVtYmVyIG9mIGJsYWNrIG5vZGVzKSBmcm9tIHJvb3QgdG9cbiAgICAvLyBsZWF2ZXMgaXMgZXF1YWwgb24gYm90aCBzaWRlcy4gIFRoaXMgZnVuY3Rpb24gdmVyaWZpZXMgdGhhdCBvciBhc3NlcnRzLlxuICAgIGNoZWNrKCkge1xuICAgICAgICBpZiAodGhpcy5pc1JlZCgpICYmIHRoaXMubGVmdC5pc1JlZCgpKSB0aHJvdyBNKCk7XG4gICAgICAgIGlmICh0aGlzLnJpZ2h0LmlzUmVkKCkpIHRocm93IE0oKTtcbiAgICAgICAgY29uc3QgdCA9IHRoaXMubGVmdC5jaGVjaygpO1xuICAgICAgICBpZiAodCAhPT0gdGhpcy5yaWdodC5jaGVjaygpKSB0aHJvdyBNKCk7XG4gICAgICAgIHJldHVybiB0ICsgKHRoaXMuaXNSZWQoKSA/IDAgOiAxKTtcbiAgICB9XG59XG5cbiAvLyBlbmQgTExSQk5vZGVcbi8vIEVtcHR5IG5vZGUgaXMgc2hhcmVkIGJldHdlZW4gYWxsIExMUkIgdHJlZXMuXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuX24uRU1QVFkgPSBudWxsLCBfbi5SRUQgPSAhMCwgX24uQkxBQ0sgPSAhMTtcblxuLy8gZW5kIExMUkJFbXB0eU5vZGVcbl9uLkVNUFRZID0gbmV3IFxuLy8gUmVwcmVzZW50cyBhbiBlbXB0eSBub2RlIChhIGxlYWYgbm9kZSBpbiB0aGUgUmVkLUJsYWNrIFRyZWUpLlxuY2xhc3Mge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnNpemUgPSAwO1xuICAgIH1cbiAgICBnZXQga2V5KCkge1xuICAgICAgICB0aHJvdyBNKCk7XG4gICAgfVxuICAgIGdldCB2YWx1ZSgpIHtcbiAgICAgICAgdGhyb3cgTSgpO1xuICAgIH1cbiAgICBnZXQgY29sb3IoKSB7XG4gICAgICAgIHRocm93IE0oKTtcbiAgICB9XG4gICAgZ2V0IGxlZnQoKSB7XG4gICAgICAgIHRocm93IE0oKTtcbiAgICB9XG4gICAgZ2V0IHJpZ2h0KCkge1xuICAgICAgICB0aHJvdyBNKCk7XG4gICAgfVxuICAgIC8vIFJldHVybnMgYSBjb3B5IG9mIHRoZSBjdXJyZW50IG5vZGUuXG4gICAgY29weSh0LCBlLCBuLCBzLCBpKSB7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIGEgY29weSBvZiB0aGUgdHJlZSwgd2l0aCB0aGUgc3BlY2lmaWVkIGtleS92YWx1ZSBhZGRlZC5cbiAgICBpbnNlcnQodCwgZSwgbikge1xuICAgICAgICByZXR1cm4gbmV3IF9uKHQsIGUpO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIGEgY29weSBvZiB0aGUgdHJlZSwgd2l0aCB0aGUgc3BlY2lmaWVkIGtleSByZW1vdmVkLlxuICAgIHJlbW92ZSh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBpc0VtcHR5KCkge1xuICAgICAgICByZXR1cm4gITA7XG4gICAgfVxuICAgIGlub3JkZXJUcmF2ZXJzYWwodCkge1xuICAgICAgICByZXR1cm4gITE7XG4gICAgfVxuICAgIHJldmVyc2VUcmF2ZXJzYWwodCkge1xuICAgICAgICByZXR1cm4gITE7XG4gICAgfVxuICAgIG1pbktleSgpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIG1heEtleSgpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGlzUmVkKCkge1xuICAgICAgICByZXR1cm4gITE7XG4gICAgfVxuICAgIC8vIEZvciB0ZXN0aW5nLlxuICAgIGNoZWNrTWF4RGVwdGgoKSB7XG4gICAgICAgIHJldHVybiAhMDtcbiAgICB9XG4gICAgY2hlY2soKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbn07XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFNvcnRlZFNldCBpcyBhbiBpbW11dGFibGUgKGNvcHktb24td3JpdGUpIGNvbGxlY3Rpb24gdGhhdCBob2xkcyBlbGVtZW50c1xuICogaW4gb3JkZXIgc3BlY2lmaWVkIGJ5IHRoZSBwcm92aWRlZCBjb21wYXJhdG9yLlxuICpcbiAqIE5PVEU6IGlmIHByb3ZpZGVkIGNvbXBhcmF0b3IgcmV0dXJucyAwIGZvciB0d28gZWxlbWVudHMsIHdlIGNvbnNpZGVyIHRoZW0gdG9cbiAqIGJlIGVxdWFsIVxuICovXG5jbGFzcyBtbiB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLmNvbXBhcmF0b3IgPSB0LCB0aGlzLmRhdGEgPSBuZXcgZG4odGhpcy5jb21wYXJhdG9yKTtcbiAgICB9XG4gICAgaGFzKHQpIHtcbiAgICAgICAgcmV0dXJuIG51bGwgIT09IHRoaXMuZGF0YS5nZXQodCk7XG4gICAgfVxuICAgIGZpcnN0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYXRhLm1pbktleSgpO1xuICAgIH1cbiAgICBsYXN0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYXRhLm1heEtleSgpO1xuICAgIH1cbiAgICBnZXQgc2l6ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5zaXplO1xuICAgIH1cbiAgICBpbmRleE9mKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5pbmRleE9mKHQpO1xuICAgIH1cbiAgICAvKiogSXRlcmF0ZXMgZWxlbWVudHMgaW4gb3JkZXIgZGVmaW5lZCBieSBcImNvbXBhcmF0b3JcIiAqLyAgICBmb3JFYWNoKHQpIHtcbiAgICAgICAgdGhpcy5kYXRhLmlub3JkZXJUcmF2ZXJzYWwoKChlLCBuKSA9PiAodChlKSwgITEpKSk7XG4gICAgfVxuICAgIC8qKiBJdGVyYXRlcyBvdmVyIGBlbGVtYHMgc3VjaCB0aGF0OiByYW5nZVswXSAmbHQ7PSBlbGVtICZsdDsgcmFuZ2VbMV0uICovICAgIGZvckVhY2hJblJhbmdlKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMuZGF0YS5nZXRJdGVyYXRvckZyb20odFswXSk7XG4gICAgICAgIGZvciAoO24uaGFzTmV4dCgpOyApIHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBuLmdldE5leHQoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmNvbXBhcmF0b3Iocy5rZXksIHRbMV0pID49IDApIHJldHVybjtcbiAgICAgICAgICAgIGUocy5rZXkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEl0ZXJhdGVzIG92ZXIgYGVsZW1gcyBzdWNoIHRoYXQ6IHN0YXJ0ICZsdDs9IGVsZW0gdW50aWwgZmFsc2UgaXMgcmV0dXJuZWQuXG4gICAgICovICAgIGZvckVhY2hXaGlsZSh0LCBlKSB7XG4gICAgICAgIGxldCBuO1xuICAgICAgICBmb3IgKG4gPSB2b2lkIDAgIT09IGUgPyB0aGlzLmRhdGEuZ2V0SXRlcmF0b3JGcm9tKGUpIDogdGhpcy5kYXRhLmdldEl0ZXJhdG9yKCk7IG4uaGFzTmV4dCgpOyApIHtcbiAgICAgICAgICAgIGlmICghdChuLmdldE5leHQoKS5rZXkpKSByZXR1cm47XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqIEZpbmRzIHRoZSBsZWFzdCBlbGVtZW50IGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byBgZWxlbWAuICovICAgIGZpcnN0QWZ0ZXJPckVxdWFsKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuZGF0YS5nZXRJdGVyYXRvckZyb20odCk7XG4gICAgICAgIHJldHVybiBlLmhhc05leHQoKSA/IGUuZ2V0TmV4dCgpLmtleSA6IG51bGw7XG4gICAgfVxuICAgIGdldEl0ZXJhdG9yKCkge1xuICAgICAgICByZXR1cm4gbmV3IGduKHRoaXMuZGF0YS5nZXRJdGVyYXRvcigpKTtcbiAgICB9XG4gICAgZ2V0SXRlcmF0b3JGcm9tKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBnbih0aGlzLmRhdGEuZ2V0SXRlcmF0b3JGcm9tKHQpKTtcbiAgICB9XG4gICAgLyoqIEluc2VydHMgb3IgdXBkYXRlcyBhbiBlbGVtZW50ICovICAgIGFkZCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvcHkodGhpcy5kYXRhLnJlbW92ZSh0KS5pbnNlcnQodCwgITApKTtcbiAgICB9XG4gICAgLyoqIERlbGV0ZXMgYW4gZWxlbWVudCAqLyAgICBkZWxldGUodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5oYXModCkgPyB0aGlzLmNvcHkodGhpcy5kYXRhLnJlbW92ZSh0KSkgOiB0aGlzO1xuICAgIH1cbiAgICBpc0VtcHR5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYXRhLmlzRW1wdHkoKTtcbiAgICB9XG4gICAgdW5pb25XaXRoKHQpIHtcbiAgICAgICAgbGV0IGUgPSB0aGlzO1xuICAgICAgICAvLyBNYWtlIHN1cmUgYHJlc3VsdGAgYWx3YXlzIHJlZmVycyB0byB0aGUgbGFyZ2VyIG9uZSBvZiB0aGUgdHdvIHNldHMuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGUuc2l6ZSA8IHQuc2l6ZSAmJiAoZSA9IHQsIHQgPSB0aGlzKSwgdC5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgIGUgPSBlLmFkZCh0KTtcbiAgICAgICAgfSkpLCBlO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgaWYgKCEodCBpbnN0YW5jZW9mIG1uKSkgcmV0dXJuICExO1xuICAgICAgICBpZiAodGhpcy5zaXplICE9PSB0LnNpemUpIHJldHVybiAhMTtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuZGF0YS5nZXRJdGVyYXRvcigpLCBuID0gdC5kYXRhLmdldEl0ZXJhdG9yKCk7XG4gICAgICAgIGZvciAoO2UuaGFzTmV4dCgpOyApIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBlLmdldE5leHQoKS5rZXksIHMgPSBuLmdldE5leHQoKS5rZXk7XG4gICAgICAgICAgICBpZiAoMCAhPT0gdGhpcy5jb21wYXJhdG9yKHQsIHMpKSByZXR1cm4gITE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICEwO1xuICAgIH1cbiAgICB0b0FycmF5KCkge1xuICAgICAgICBjb25zdCB0ID0gW107XG4gICAgICAgIHJldHVybiB0aGlzLmZvckVhY2goKGUgPT4ge1xuICAgICAgICAgICAgdC5wdXNoKGUpO1xuICAgICAgICB9KSksIHQ7XG4gICAgfVxuICAgIHRvU3RyaW5nKCkge1xuICAgICAgICBjb25zdCB0ID0gW107XG4gICAgICAgIHJldHVybiB0aGlzLmZvckVhY2goKGUgPT4gdC5wdXNoKGUpKSksIFwiU29ydGVkU2V0KFwiICsgdC50b1N0cmluZygpICsgXCIpXCI7XG4gICAgfVxuICAgIGNvcHkodCkge1xuICAgICAgICBjb25zdCBlID0gbmV3IG1uKHRoaXMuY29tcGFyYXRvcik7XG4gICAgICAgIHJldHVybiBlLmRhdGEgPSB0LCBlO1xuICAgIH1cbn1cblxuY2xhc3MgZ24ge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5pdGVyID0gdDtcbiAgICB9XG4gICAgZ2V0TmV4dCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaXRlci5nZXROZXh0KCkua2V5O1xuICAgIH1cbiAgICBoYXNOZXh0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pdGVyLmhhc05leHQoKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNvbnN0IHluID0gbmV3IGRuKFB0LmNvbXBhcmF0b3IpO1xuXG5mdW5jdGlvbiBwbigpIHtcbiAgICByZXR1cm4geW47XG59XG5cbmNvbnN0IEVuID0gbmV3IGRuKFB0LmNvbXBhcmF0b3IpO1xuXG5mdW5jdGlvbiBUbigpIHtcbiAgICByZXR1cm4gRW47XG59XG5cbmNvbnN0IEluID0gbmV3IGRuKFB0LmNvbXBhcmF0b3IpO1xuXG5mdW5jdGlvbiBBbigpIHtcbiAgICByZXR1cm4gSW47XG59XG5cbmNvbnN0IFJuID0gbmV3IG1uKFB0LmNvbXBhcmF0b3IpO1xuXG5mdW5jdGlvbiBQbiguLi50KSB7XG4gICAgbGV0IGUgPSBSbjtcbiAgICBmb3IgKGNvbnN0IG4gb2YgdCkgZSA9IGUuYWRkKG4pO1xuICAgIHJldHVybiBlO1xufVxuXG5jb25zdCBibiA9IG5ldyBtbih0dCk7XG5cbmZ1bmN0aW9uIHZuKCkge1xuICAgIHJldHVybiBibjtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQW4gZXZlbnQgZnJvbSB0aGUgUmVtb3RlU3RvcmUuIEl0IGlzIHNwbGl0IGludG8gdGFyZ2V0Q2hhbmdlcyAoY2hhbmdlcyB0byB0aGVcbiAqIHN0YXRlIG9yIHRoZSBzZXQgb2YgZG9jdW1lbnRzIGluIG91ciB3YXRjaGVkIHRhcmdldHMpIGFuZCBkb2N1bWVudFVwZGF0ZXNcbiAqIChjaGFuZ2VzIHRvIHRoZSBhY3R1YWwgZG9jdW1lbnRzKS5cbiAqLyBjbGFzcyBWbiB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgLyoqXG4gICAgICogVGhlIHNuYXBzaG90IHZlcnNpb24gdGhpcyBldmVudCBicmluZ3MgdXMgdXAgdG8sIG9yIE1JTiBpZiBub3Qgc2V0LlxuICAgICAqL1xuICAgIHQsIFxuICAgIC8qKlxuICAgICAqIEEgbWFwIGZyb20gdGFyZ2V0IHRvIGNoYW5nZXMgdG8gdGhlIHRhcmdldC4gU2VlIFRhcmdldENoYW5nZS5cbiAgICAgKi9cbiAgICBlLCBcbiAgICAvKipcbiAgICAgKiBBIHNldCBvZiB0YXJnZXRzIHRoYXQgaXMga25vd24gdG8gYmUgaW5jb25zaXN0ZW50LiBMaXN0ZW5zIGZvciB0aGVzZVxuICAgICAqIHRhcmdldHMgc2hvdWxkIGJlIHJlLWVzdGFibGlzaGVkIHdpdGhvdXQgcmVzdW1lIHRva2Vucy5cbiAgICAgKi9cbiAgICBuLCBcbiAgICAvKipcbiAgICAgKiBBIHNldCBvZiB3aGljaCBkb2N1bWVudHMgaGF2ZSBjaGFuZ2VkIG9yIGJlZW4gZGVsZXRlZCwgYWxvbmcgd2l0aCB0aGVcbiAgICAgKiBkb2MncyBuZXcgdmFsdWVzIChpZiBub3QgZGVsZXRlZCkuXG4gICAgICovXG4gICAgcywgXG4gICAgLyoqXG4gICAgICogQSBzZXQgb2Ygd2hpY2ggZG9jdW1lbnQgdXBkYXRlcyBhcmUgZHVlIG9ubHkgdG8gbGltYm8gcmVzb2x1dGlvbiB0YXJnZXRzLlxuICAgICAqL1xuICAgIGkpIHtcbiAgICAgICAgdGhpcy5zbmFwc2hvdFZlcnNpb24gPSB0LCB0aGlzLnRhcmdldENoYW5nZXMgPSBlLCB0aGlzLnRhcmdldE1pc21hdGNoZXMgPSBuLCB0aGlzLmRvY3VtZW50VXBkYXRlcyA9IHMsIFxuICAgICAgICB0aGlzLnJlc29sdmVkTGltYm9Eb2N1bWVudHMgPSBpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBIQUNLOiBWaWV3cyByZXF1aXJlIFJlbW90ZUV2ZW50cyBpbiBvcmRlciB0byBkZXRlcm1pbmUgd2hldGhlciB0aGUgdmlldyBpc1xuICAgICAqIENVUlJFTlQsIGJ1dCBzZWNvbmRhcnkgdGFicyBkb24ndCByZWNlaXZlIHJlbW90ZSBldmVudHMuIFNvIHRoaXMgbWV0aG9kIGlzXG4gICAgICogdXNlZCB0byBjcmVhdGUgYSBzeW50aGVzaXplZCBSZW1vdGVFdmVudCB0aGF0IGNhbiBiZSB1c2VkIHRvIGFwcGx5IGFcbiAgICAgKiBDVVJSRU5UIHN0YXR1cyBjaGFuZ2UgdG8gYSBWaWV3LCBmb3IgcXVlcmllcyBleGVjdXRlZCBpbiBhIGRpZmZlcmVudCB0YWIuXG4gICAgICovXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seVxuICAgIHN0YXRpYyBjcmVhdGVTeW50aGVzaXplZFJlbW90ZUV2ZW50Rm9yQ3VycmVudENoYW5nZSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBuZXcgTWFwO1xuICAgICAgICByZXR1cm4gbi5zZXQodCwgU24uY3JlYXRlU3ludGhlc2l6ZWRUYXJnZXRDaGFuZ2VGb3JDdXJyZW50Q2hhbmdlKHQsIGUpKSwgbmV3IFZuKGl0Lm1pbigpLCBuLCB2bigpLCBwbigpLCBQbigpKTtcbiAgICB9XG59XG5cbi8qKlxuICogQSBUYXJnZXRDaGFuZ2Ugc3BlY2lmaWVzIHRoZSBzZXQgb2YgY2hhbmdlcyBmb3IgYSBzcGVjaWZpYyB0YXJnZXQgYXMgcGFydCBvZlxuICogYSBSZW1vdGVFdmVudC4gVGhlc2UgY2hhbmdlcyB0cmFjayB3aGljaCBkb2N1bWVudHMgYXJlIGFkZGVkLCBtb2RpZmllZCBvclxuICogcmVtb3ZlZCwgYXMgd2VsbCBhcyB0aGUgdGFyZ2V0J3MgcmVzdW1lIHRva2VuIGFuZCB3aGV0aGVyIHRoZSB0YXJnZXQgaXNcbiAqIG1hcmtlZCBDVVJSRU5ULlxuICogVGhlIGFjdHVhbCBjaGFuZ2VzICp0byogZG9jdW1lbnRzIGFyZSBub3QgcGFydCBvZiB0aGUgVGFyZ2V0Q2hhbmdlIHNpbmNlXG4gKiBkb2N1bWVudHMgbWF5IGJlIHBhcnQgb2YgbXVsdGlwbGUgdGFyZ2V0cy5cbiAqLyBjbGFzcyBTbiB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgLyoqXG4gICAgICogQW4gb3BhcXVlLCBzZXJ2ZXItYXNzaWduZWQgdG9rZW4gdGhhdCBhbGxvd3Mgd2F0Y2hpbmcgYSBxdWVyeSB0byBiZSByZXN1bWVkXG4gICAgICogYWZ0ZXIgZGlzY29ubmVjdGluZyB3aXRob3V0IHJldHJhbnNtaXR0aW5nIGFsbCB0aGUgZGF0YSB0aGF0IG1hdGNoZXMgdGhlXG4gICAgICogcXVlcnkuIFRoZSByZXN1bWUgdG9rZW4gZXNzZW50aWFsbHkgaWRlbnRpZmllcyBhIHBvaW50IGluIHRpbWUgZnJvbSB3aGljaFxuICAgICAqIHRoZSBzZXJ2ZXIgc2hvdWxkIHJlc3VtZSBzZW5kaW5nIHJlc3VsdHMuXG4gICAgICovXG4gICAgdCwgXG4gICAgLyoqXG4gICAgICogVGhlIFwiY3VycmVudFwiIChzeW5jZWQpIHN0YXR1cyBvZiB0aGlzIHRhcmdldC4gTm90ZSB0aGF0IFwiY3VycmVudFwiXG4gICAgICogaGFzIHNwZWNpYWwgbWVhbmluZyBpbiB0aGUgUlBDIHByb3RvY29sIHRoYXQgaW1wbGllcyB0aGF0IGEgdGFyZ2V0IGlzXG4gICAgICogYm90aCB1cC10by1kYXRlIGFuZCBjb25zaXN0ZW50IHdpdGggdGhlIHJlc3Qgb2YgdGhlIHdhdGNoIHN0cmVhbS5cbiAgICAgKi9cbiAgICBlLCBcbiAgICAvKipcbiAgICAgKiBUaGUgc2V0IG9mIGRvY3VtZW50cyB0aGF0IHdlcmUgbmV3bHkgYXNzaWduZWQgdG8gdGhpcyB0YXJnZXQgYXMgcGFydCBvZlxuICAgICAqIHRoaXMgcmVtb3RlIGV2ZW50LlxuICAgICAqL1xuICAgIG4sIFxuICAgIC8qKlxuICAgICAqIFRoZSBzZXQgb2YgZG9jdW1lbnRzIHRoYXQgd2VyZSBhbHJlYWR5IGFzc2lnbmVkIHRvIHRoaXMgdGFyZ2V0IGJ1dCByZWNlaXZlZFxuICAgICAqIGFuIHVwZGF0ZSBkdXJpbmcgdGhpcyByZW1vdGUgZXZlbnQuXG4gICAgICovXG4gICAgcywgXG4gICAgLyoqXG4gICAgICogVGhlIHNldCBvZiBkb2N1bWVudHMgdGhhdCB3ZXJlIHJlbW92ZWQgZnJvbSB0aGlzIHRhcmdldCBhcyBwYXJ0IG9mIHRoaXNcbiAgICAgKiByZW1vdGUgZXZlbnQuXG4gICAgICovXG4gICAgaSkge1xuICAgICAgICB0aGlzLnJlc3VtZVRva2VuID0gdCwgdGhpcy5jdXJyZW50ID0gZSwgdGhpcy5hZGRlZERvY3VtZW50cyA9IG4sIHRoaXMubW9kaWZpZWREb2N1bWVudHMgPSBzLCBcbiAgICAgICAgdGhpcy5yZW1vdmVkRG9jdW1lbnRzID0gaTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhpcyBtZXRob2QgaXMgdXNlZCB0byBjcmVhdGUgYSBzeW50aGVzaXplZCBUYXJnZXRDaGFuZ2VzIHRoYXQgY2FuIGJlIHVzZWQgdG9cbiAgICAgKiBhcHBseSBhIENVUlJFTlQgc3RhdHVzIGNoYW5nZSB0byBhIFZpZXcgKGZvciBxdWVyaWVzIGV4ZWN1dGVkIGluIGEgZGlmZmVyZW50XG4gICAgICogdGFiKSBvciBmb3IgbmV3IHF1ZXJpZXMgKHRvIHJhaXNlIHNuYXBzaG90cyB3aXRoIGNvcnJlY3QgQ1VSUkVOVCBzdGF0dXMpLlxuICAgICAqLyAgICBzdGF0aWMgY3JlYXRlU3ludGhlc2l6ZWRUYXJnZXRDaGFuZ2VGb3JDdXJyZW50Q2hhbmdlKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBTbih3dC5FTVBUWV9CWVRFX1NUUklORywgZSwgUG4oKSwgUG4oKSwgUG4oKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBSZXByZXNlbnRzIGEgY2hhbmdlZCBkb2N1bWVudCBhbmQgYSBsaXN0IG9mIHRhcmdldCBpZHMgdG8gd2hpY2ggdGhpcyBjaGFuZ2VcbiAqIGFwcGxpZXMuXG4gKlxuICogSWYgZG9jdW1lbnQgaGFzIGJlZW4gZGVsZXRlZCBOb0RvY3VtZW50IHdpbGwgYmUgcHJvdmlkZWQuXG4gKi8gY2xhc3MgRG4ge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKiBUaGUgbmV3IGRvY3VtZW50IGFwcGxpZXMgdG8gYWxsIG9mIHRoZXNlIHRhcmdldHMuICovXG4gICAgdCwgXG4gICAgLyoqIFRoZSBuZXcgZG9jdW1lbnQgaXMgcmVtb3ZlZCBmcm9tIGFsbCBvZiB0aGVzZSB0YXJnZXRzLiAqL1xuICAgIGUsIFxuICAgIC8qKiBUaGUga2V5IG9mIHRoZSBkb2N1bWVudCBmb3IgdGhpcyBjaGFuZ2UuICovXG4gICAgbiwgXG4gICAgLyoqXG4gICAgICogVGhlIG5ldyBkb2N1bWVudCBvciBOb0RvY3VtZW50IGlmIGl0IHdhcyBkZWxldGVkLiBJcyBudWxsIGlmIHRoZVxuICAgICAqIGRvY3VtZW50IHdlbnQgb3V0IG9mIHZpZXcgd2l0aG91dCB0aGUgc2VydmVyIHNlbmRpbmcgYSBuZXcgZG9jdW1lbnQuXG4gICAgICovXG4gICAgcykge1xuICAgICAgICB0aGlzLmsgPSB0LCB0aGlzLnJlbW92ZWRUYXJnZXRJZHMgPSBlLCB0aGlzLmtleSA9IG4sIHRoaXMuJCA9IHM7XG4gICAgfVxufVxuXG5jbGFzcyBDbiB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLnRhcmdldElkID0gdCwgdGhpcy5PID0gZTtcbiAgICB9XG59XG5cbmNsYXNzIE5uIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKiogV2hhdCBraW5kIG9mIGNoYW5nZSBvY2N1cnJlZCB0byB0aGUgd2F0Y2ggdGFyZ2V0LiAqL1xuICAgIHQsIFxuICAgIC8qKiBUaGUgdGFyZ2V0IElEcyB0aGF0IHdlcmUgYWRkZWQvcmVtb3ZlZC9zZXQuICovXG4gICAgZSwgXG4gICAgLyoqXG4gICAgICogQW4gb3BhcXVlLCBzZXJ2ZXItYXNzaWduZWQgdG9rZW4gdGhhdCBhbGxvd3Mgd2F0Y2hpbmcgYSB0YXJnZXQgdG8gYmVcbiAgICAgKiByZXN1bWVkIGFmdGVyIGRpc2Nvbm5lY3Rpbmcgd2l0aG91dCByZXRyYW5zbWl0dGluZyBhbGwgdGhlIGRhdGEgdGhhdFxuICAgICAqIG1hdGNoZXMgdGhlIHRhcmdldC4gVGhlIHJlc3VtZSB0b2tlbiBlc3NlbnRpYWxseSBpZGVudGlmaWVzIGEgcG9pbnQgaW5cbiAgICAgKiB0aW1lIGZyb20gd2hpY2ggdGhlIHNlcnZlciBzaG91bGQgcmVzdW1lIHNlbmRpbmcgcmVzdWx0cy5cbiAgICAgKi9cbiAgICBuID0gd3QuRU1QVFlfQllURV9TVFJJTkdcbiAgICAvKiogQW4gUlBDIGVycm9yIGluZGljYXRpbmcgd2h5IHRoZSB3YXRjaCBmYWlsZWQuICovICwgcyA9IG51bGwpIHtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHQsIHRoaXMudGFyZ2V0SWRzID0gZSwgdGhpcy5yZXN1bWVUb2tlbiA9IG4sIHRoaXMuY2F1c2UgPSBzO1xuICAgIH1cbn1cblxuLyoqIFRyYWNrcyB0aGUgaW50ZXJuYWwgc3RhdGUgb2YgYSBXYXRjaCB0YXJnZXQuICovIGNsYXNzIHhuIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBudW1iZXIgb2YgcGVuZGluZyByZXNwb25zZXMgKGFkZHMgb3IgcmVtb3ZlcykgdGhhdCB3ZSBhcmUgd2FpdGluZyBvbi5cbiAgICAgICAgICogV2Ugb25seSBjb25zaWRlciB0YXJnZXRzIGFjdGl2ZSB0aGF0IGhhdmUgbm8gcGVuZGluZyByZXNwb25zZXMuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLkYgPSAwLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEtlZXBzIHRyYWNrIG9mIHRoZSBkb2N1bWVudCBjaGFuZ2VzIHNpbmNlIHRoZSBsYXN0IHJhaXNlZCBzbmFwc2hvdC5cbiAgICAgICAgICpcbiAgICAgICAgICogVGhlc2UgY2hhbmdlcyBhcmUgY29udGludW91c2x5IHVwZGF0ZWQgYXMgd2UgcmVjZWl2ZSBkb2N1bWVudCB1cGRhdGVzIGFuZFxuICAgICAgICAgKiBhbHdheXMgcmVmbGVjdCB0aGUgY3VycmVudCBzZXQgb2YgY2hhbmdlcyBhZ2FpbnN0IHRoZSBsYXN0IGlzc3VlZCBzbmFwc2hvdC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuTSA9IE9uKCksIFxuICAgICAgICAvKiogU2VlIHB1YmxpYyBnZXR0ZXJzIGZvciBleHBsYW5hdGlvbnMgb2YgdGhlc2UgZmllbGRzLiAqL1xuICAgICAgICB0aGlzLkwgPSB3dC5FTVBUWV9CWVRFX1NUUklORywgdGhpcy5CID0gITEsIFxuICAgICAgICAvKipcbiAgICAgICAgICogV2hldGhlciB0aGlzIHRhcmdldCBzdGF0ZSBzaG91bGQgYmUgaW5jbHVkZWQgaW4gdGhlIG5leHQgc25hcHNob3QuIFdlXG4gICAgICAgICAqIGluaXRpYWxpemUgdG8gdHJ1ZSBzbyB0aGF0IG5ld2x5LWFkZGVkIHRhcmdldHMgYXJlIGluY2x1ZGVkIGluIHRoZSBuZXh0XG4gICAgICAgICAqIFJlbW90ZUV2ZW50LlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5VID0gITA7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFdoZXRoZXIgdGhpcyB0YXJnZXQgaGFzIGJlZW4gbWFya2VkICdjdXJyZW50Jy5cbiAgICAgKlxuICAgICAqICdDdXJyZW50JyBoYXMgc3BlY2lhbCBtZWFuaW5nIGluIHRoZSBSUEMgcHJvdG9jb2w6IEl0IGltcGxpZXMgdGhhdCB0aGVcbiAgICAgKiBXYXRjaCBiYWNrZW5kIGhhcyBzZW50IHVzIGFsbCBjaGFuZ2VzIHVwIHRvIHRoZSBwb2ludCBhdCB3aGljaCB0aGUgdGFyZ2V0XG4gICAgICogd2FzIGFkZGVkIGFuZCB0aGF0IHRoZSB0YXJnZXQgaXMgY29uc2lzdGVudCB3aXRoIHRoZSByZXN0IG9mIHRoZSB3YXRjaFxuICAgICAqIHN0cmVhbS5cbiAgICAgKi8gICAgZ2V0IGN1cnJlbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLkI7XG4gICAgfVxuICAgIC8qKiBUaGUgbGFzdCByZXN1bWUgdG9rZW4gc2VudCB0byB1cyBmb3IgdGhpcyB0YXJnZXQuICovICAgIGdldCByZXN1bWVUb2tlbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuTDtcbiAgICB9XG4gICAgLyoqIFdoZXRoZXIgdGhpcyB0YXJnZXQgaGFzIHBlbmRpbmcgdGFyZ2V0IGFkZHMgb3IgdGFyZ2V0IHJlbW92ZXMuICovICAgIGdldCBxKCkge1xuICAgICAgICByZXR1cm4gMCAhPT0gdGhpcy5GO1xuICAgIH1cbiAgICAvKiogV2hldGhlciB3ZSBoYXZlIG1vZGlmaWVkIGFueSBzdGF0ZSB0aGF0IHNob3VsZCB0cmlnZ2VyIGEgc25hcHNob3QuICovICAgIGdldCBLKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5VO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBcHBsaWVzIHRoZSByZXN1bWUgdG9rZW4gdG8gdGhlIFRhcmdldENoYW5nZSwgYnV0IG9ubHkgd2hlbiBpdCBoYXMgYSBuZXdcbiAgICAgKiB2YWx1ZS4gRW1wdHkgcmVzdW1lVG9rZW5zIGFyZSBkaXNjYXJkZWQuXG4gICAgICovICAgIGoodCkge1xuICAgICAgICB0LmFwcHJveGltYXRlQnl0ZVNpemUoKSA+IDAgJiYgKHRoaXMuVSA9ICEwLCB0aGlzLkwgPSB0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIHRhcmdldCBjaGFuZ2UgZnJvbSB0aGUgY3VycmVudCBzZXQgb2YgY2hhbmdlcy5cbiAgICAgKlxuICAgICAqIFRvIHJlc2V0IHRoZSBkb2N1bWVudCBjaGFuZ2VzIGFmdGVyIHJhaXNpbmcgdGhpcyBzbmFwc2hvdCwgY2FsbFxuICAgICAqIGBjbGVhclBlbmRpbmdDaGFuZ2VzKClgLlxuICAgICAqLyAgICBXKCkge1xuICAgICAgICBsZXQgdCA9IFBuKCksIGUgPSBQbigpLCBuID0gUG4oKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuTS5mb3JFYWNoKCgocywgaSkgPT4ge1xuICAgICAgICAgICAgc3dpdGNoIChpKSB7XG4gICAgICAgICAgICAgIGNhc2UgMCAvKiBBZGRlZCAqLyA6XG4gICAgICAgICAgICAgICAgdCA9IHQuYWRkKHMpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgIGNhc2UgMiAvKiBNb2RpZmllZCAqLyA6XG4gICAgICAgICAgICAgICAgZSA9IGUuYWRkKHMpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgIGNhc2UgMSAvKiBSZW1vdmVkICovIDpcbiAgICAgICAgICAgICAgICBuID0gbi5hZGQocyk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBNKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKSwgbmV3IFNuKHRoaXMuTCwgdGhpcy5CLCB0LCBlLCBuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVzZXRzIHRoZSBkb2N1bWVudCBjaGFuZ2VzIGFuZCBzZXRzIGBoYXNQZW5kaW5nQ2hhbmdlc2AgdG8gZmFsc2UuXG4gICAgICovICAgIEcoKSB7XG4gICAgICAgIHRoaXMuVSA9ICExLCB0aGlzLk0gPSBPbigpO1xuICAgIH1cbiAgICBIKHQsIGUpIHtcbiAgICAgICAgdGhpcy5VID0gITAsIHRoaXMuTSA9IHRoaXMuTS5pbnNlcnQodCwgZSk7XG4gICAgfVxuICAgIEoodCkge1xuICAgICAgICB0aGlzLlUgPSAhMCwgdGhpcy5NID0gdGhpcy5NLnJlbW92ZSh0KTtcbiAgICB9XG4gICAgWSgpIHtcbiAgICAgICAgdGhpcy5GICs9IDE7XG4gICAgfVxuICAgIFgoKSB7XG4gICAgICAgIHRoaXMuRiAtPSAxO1xuICAgIH1cbiAgICBaKCkge1xuICAgICAgICB0aGlzLlUgPSAhMCwgdGhpcy5CID0gITA7XG4gICAgfVxufVxuXG4vKipcbiAqIEEgaGVscGVyIGNsYXNzIHRvIGFjY3VtdWxhdGUgd2F0Y2ggY2hhbmdlcyBpbnRvIGEgUmVtb3RlRXZlbnQuXG4gKi9cbmNsYXNzIGtuIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMudHQgPSB0LCBcbiAgICAgICAgLyoqIFRoZSBpbnRlcm5hbCBzdGF0ZSBvZiBhbGwgdHJhY2tlZCB0YXJnZXRzLiAqL1xuICAgICAgICB0aGlzLmV0ID0gbmV3IE1hcCwgXG4gICAgICAgIC8qKiBLZWVwcyB0cmFjayBvZiB0aGUgZG9jdW1lbnRzIHRvIHVwZGF0ZSBzaW5jZSB0aGUgbGFzdCByYWlzZWQgc25hcHNob3QuICovXG4gICAgICAgIHRoaXMubnQgPSBwbigpLCBcbiAgICAgICAgLyoqIEEgbWFwcGluZyBvZiBkb2N1bWVudCBrZXlzIHRvIHRoZWlyIHNldCBvZiB0YXJnZXQgSURzLiAqL1xuICAgICAgICB0aGlzLnN0ID0gJG4oKSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIGxpc3Qgb2YgdGFyZ2V0cyB3aXRoIGV4aXN0ZW5jZSBmaWx0ZXIgbWlzbWF0Y2hlcy4gVGhlc2UgdGFyZ2V0cyBhcmVcbiAgICAgICAgICoga25vd24gdG8gYmUgaW5jb25zaXN0ZW50IGFuZCB0aGVpciBsaXN0ZW5zIG5lZWRzIHRvIGJlIHJlLWVzdGFibGlzaGVkIGJ5XG4gICAgICAgICAqIFJlbW90ZVN0b3JlLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5pdCA9IG5ldyBtbih0dCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFByb2Nlc3NlcyBhbmQgYWRkcyB0aGUgRG9jdW1lbnRXYXRjaENoYW5nZSB0byB0aGUgY3VycmVudCBzZXQgb2YgY2hhbmdlcy5cbiAgICAgKi8gICAgcnQodCkge1xuICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdC5rKSB0LiQgJiYgdC4kLmlzRm91bmREb2N1bWVudCgpID8gdGhpcy5vdChlLCB0LiQpIDogdGhpcy5hdChlLCB0LmtleSwgdC4kKTtcbiAgICAgICAgZm9yIChjb25zdCBlIG9mIHQucmVtb3ZlZFRhcmdldElkcykgdGhpcy5hdChlLCB0LmtleSwgdC4kKTtcbiAgICB9XG4gICAgLyoqIFByb2Nlc3NlcyBhbmQgYWRkcyB0aGUgV2F0Y2hUYXJnZXRDaGFuZ2UgdG8gdGhlIGN1cnJlbnQgc2V0IG9mIGNoYW5nZXMuICovICAgIGN0KHQpIHtcbiAgICAgICAgdGhpcy5mb3JFYWNoVGFyZ2V0KHQsIChlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLnV0KGUpO1xuICAgICAgICAgICAgc3dpdGNoICh0LnN0YXRlKSB7XG4gICAgICAgICAgICAgIGNhc2UgMCAvKiBOb0NoYW5nZSAqLyA6XG4gICAgICAgICAgICAgICAgdGhpcy5odChlKSAmJiBuLmoodC5yZXN1bWVUb2tlbik7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgY2FzZSAxIC8qIEFkZGVkICovIDpcbiAgICAgICAgICAgICAgICAvLyBXZSBuZWVkIHRvIGRlY3JlbWVudCB0aGUgbnVtYmVyIG9mIHBlbmRpbmcgYWNrcyBuZWVkZWQgZnJvbSB3YXRjaFxuICAgICAgICAgICAgICAgIC8vIGZvciB0aGlzIHRhcmdldElkLlxuICAgICAgICAgICAgICAgIG4uWCgpLCBuLnEgfHwgXG4gICAgICAgICAgICAgICAgLy8gV2UgaGF2ZSBhIGZyZXNobHkgYWRkZWQgdGFyZ2V0LCBzbyB3ZSBuZWVkIHRvIHJlc2V0IGFueSBzdGF0ZVxuICAgICAgICAgICAgICAgIC8vIHRoYXQgd2UgaGFkIHByZXZpb3VzbHkuIFRoaXMgY2FuIGhhcHBlbiBlLmcuIHdoZW4gcmVtb3ZlIGFuZCBhZGRcbiAgICAgICAgICAgICAgICAvLyBiYWNrIGEgdGFyZ2V0IGZvciBleGlzdGVuY2UgZmlsdGVyIG1pc21hdGNoZXMuXG4gICAgICAgICAgICAgICAgbi5HKCksIG4uaih0LnJlc3VtZVRva2VuKTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICBjYXNlIDIgLyogUmVtb3ZlZCAqLyA6XG4gICAgICAgICAgICAgICAgLy8gV2UgbmVlZCB0byBrZWVwIHRyYWNrIG9mIHJlbW92ZWQgdGFyZ2V0cyB0byB3ZSBjYW4gcG9zdC1maWx0ZXIgYW5kXG4gICAgICAgICAgICAgICAgLy8gcmVtb3ZlIGFueSB0YXJnZXQgY2hhbmdlcy5cbiAgICAgICAgICAgICAgICAvLyBXZSBuZWVkIHRvIGRlY3JlbWVudCB0aGUgbnVtYmVyIG9mIHBlbmRpbmcgYWNrcyBuZWVkZWQgZnJvbSB3YXRjaFxuICAgICAgICAgICAgICAgIC8vIGZvciB0aGlzIHRhcmdldElkLlxuICAgICAgICAgICAgICAgIG4uWCgpLCBuLnEgfHwgdGhpcy5yZW1vdmVUYXJnZXQoZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgY2FzZSAzIC8qIEN1cnJlbnQgKi8gOlxuICAgICAgICAgICAgICAgIHRoaXMuaHQoZSkgJiYgKG4uWigpLCBuLmoodC5yZXN1bWVUb2tlbikpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgIGNhc2UgNCAvKiBSZXNldCAqLyA6XG4gICAgICAgICAgICAgICAgdGhpcy5odChlKSAmJiAoXG4gICAgICAgICAgICAgICAgLy8gUmVzZXQgdGhlIHRhcmdldCBhbmQgc3ludGhlc2l6ZXMgcmVtb3ZlcyBmb3IgYWxsIGV4aXN0aW5nXG4gICAgICAgICAgICAgICAgLy8gZG9jdW1lbnRzLiBUaGUgYmFja2VuZCB3aWxsIHJlLWFkZCBhbnkgZG9jdW1lbnRzIHRoYXQgc3RpbGxcbiAgICAgICAgICAgICAgICAvLyBtYXRjaCB0aGUgdGFyZ2V0IGJlZm9yZSBpdCBzZW5kcyB0aGUgbmV4dCBnbG9iYWwgc25hcHNob3QuXG4gICAgICAgICAgICAgICAgdGhpcy5sdChlKSwgbi5qKHQucmVzdW1lVG9rZW4pKTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIE0oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJdGVyYXRlcyBvdmVyIGFsbCB0YXJnZXRJZHMgdGhhdCB0aGUgd2F0Y2ggY2hhbmdlIGFwcGxpZXMgdG86IGVpdGhlciB0aGVcbiAgICAgKiB0YXJnZXRJZHMgZXhwbGljaXRseSBsaXN0ZWQgaW4gdGhlIGNoYW5nZSBvciB0aGUgdGFyZ2V0SWRzIG9mIGFsbCBjdXJyZW50bHlcbiAgICAgKiBhY3RpdmUgdGFyZ2V0cy5cbiAgICAgKi8gICAgZm9yRWFjaFRhcmdldCh0LCBlKSB7XG4gICAgICAgIHQudGFyZ2V0SWRzLmxlbmd0aCA+IDAgPyB0LnRhcmdldElkcy5mb3JFYWNoKGUpIDogdGhpcy5ldC5mb3JFYWNoKCgodCwgbikgPT4ge1xuICAgICAgICAgICAgdGhpcy5odChuKSAmJiBlKG4pO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEhhbmRsZXMgZXhpc3RlbmNlIGZpbHRlcnMgYW5kIHN5bnRoZXNpemVzIGRlbGV0ZXMgZm9yIGZpbHRlciBtaXNtYXRjaGVzLlxuICAgICAqIFRhcmdldHMgdGhhdCBhcmUgaW52YWxpZGF0ZWQgYnkgZmlsdGVyIG1pc21hdGNoZXMgYXJlIGFkZGVkIHRvXG4gICAgICogYHBlbmRpbmdUYXJnZXRSZXNldHNgLlxuICAgICAqLyAgICBmdCh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0LnRhcmdldElkLCBuID0gdC5PLmNvdW50LCBzID0gdGhpcy5kdChlKTtcbiAgICAgICAgaWYgKHMpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBzLnRhcmdldDtcbiAgICAgICAgICAgIGlmICh6dCh0KSkgaWYgKDAgPT09IG4pIHtcbiAgICAgICAgICAgICAgICAvLyBUaGUgZXhpc3RlbmNlIGZpbHRlciB0b2xkIHVzIHRoZSBkb2N1bWVudCBkb2VzIG5vdCBleGlzdC4gV2UgZGVkdWNlXG4gICAgICAgICAgICAgICAgLy8gdGhhdCB0aGlzIGRvY3VtZW50IGRvZXMgbm90IGV4aXN0IGFuZCBhcHBseSBhIGRlbGV0ZWQgZG9jdW1lbnQgdG9cbiAgICAgICAgICAgICAgICAvLyBvdXIgdXBkYXRlcy4gV2l0aG91dCBhcHBseWluZyB0aGlzIGRlbGV0ZWQgZG9jdW1lbnQgdGhlcmUgbWlnaHQgYmVcbiAgICAgICAgICAgICAgICAvLyBhbm90aGVyIHF1ZXJ5IHRoYXQgd2lsbCByYWlzZSB0aGlzIGRvY3VtZW50IGFzIHBhcnQgb2YgYSBzbmFwc2hvdFxuICAgICAgICAgICAgICAgIC8vIHVudGlsIGl0IGlzIHJlc29sdmVkLCBlc3NlbnRpYWxseSBleHBvc2luZyBpbmNvbnNpc3RlbmN5IGJldHdlZW5cbiAgICAgICAgICAgICAgICAvLyBxdWVyaWVzLlxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBuZXcgUHQodC5wYXRoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmF0KGUsIG4sIHF0Lm5ld05vRG9jdW1lbnQobiwgaXQubWluKCkpKTtcbiAgICAgICAgICAgIH0gZWxzZSBMKDEgPT09IG4pOyBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnd0KGUpICE9PSBuICYmIChcbiAgICAgICAgICAgICAgICAvLyBFeGlzdGVuY2UgZmlsdGVyIG1pc21hdGNoOiBXZSByZXNldCB0aGUgbWFwcGluZyBhbmQgcmFpc2UgYSBuZXdcbiAgICAgICAgICAgICAgICAvLyBzbmFwc2hvdCB3aXRoIGBpc0Zyb21DYWNoZTp0cnVlYC5cbiAgICAgICAgICAgICAgICB0aGlzLmx0KGUpLCB0aGlzLml0ID0gdGhpcy5pdC5hZGQoZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENvbnZlcnRzIHRoZSBjdXJyZW50bHkgYWNjdW11bGF0ZWQgc3RhdGUgaW50byBhIHJlbW90ZSBldmVudCBhdCB0aGVcbiAgICAgKiBwcm92aWRlZCBzbmFwc2hvdCB2ZXJzaW9uLiBSZXNldHMgdGhlIGFjY3VtdWxhdGVkIGNoYW5nZXMgYmVmb3JlIHJldHVybmluZy5cbiAgICAgKi8gICAgX3QodCkge1xuICAgICAgICBjb25zdCBlID0gbmV3IE1hcDtcbiAgICAgICAgdGhpcy5ldC5mb3JFYWNoKCgobiwgcykgPT4ge1xuICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuZHQocyk7XG4gICAgICAgICAgICBpZiAoaSkge1xuICAgICAgICAgICAgICAgIGlmIChuLmN1cnJlbnQgJiYgenQoaS50YXJnZXQpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIERvY3VtZW50IHF1ZXJpZXMgZm9yIGRvY3VtZW50IHRoYXQgZG9uJ3QgZXhpc3QgY2FuIHByb2R1Y2UgYW4gZW1wdHlcbiAgICAgICAgICAgICAgICAgICAgLy8gcmVzdWx0IHNldC4gVG8gdXBkYXRlIG91ciBsb2NhbCBjYWNoZSwgd2Ugc3ludGhlc2l6ZSBhIGRvY3VtZW50XG4gICAgICAgICAgICAgICAgICAgIC8vIGRlbGV0ZSBpZiB3ZSBoYXZlIG5vdCBwcmV2aW91c2x5IHJlY2VpdmVkIHRoZSBkb2N1bWVudC4gVGhpc1xuICAgICAgICAgICAgICAgICAgICAvLyByZXNvbHZlcyB0aGUgbGltYm8gc3RhdGUgb2YgdGhlIGRvY3VtZW50LCByZW1vdmluZyBpdCBmcm9tXG4gICAgICAgICAgICAgICAgICAgIC8vIGxpbWJvRG9jdW1lbnRSZWZzLlxuICAgICAgICAgICAgICAgICAgICAvLyBUT0RPKGRpbW9uZCk6IElkZWFsbHkgd2Ugd291bGQgaGF2ZSBhbiBleHBsaWNpdCBsb29rdXAgdGFyZ2V0XG4gICAgICAgICAgICAgICAgICAgIC8vIGluc3RlYWQgcmVzdWx0aW5nIGluIGFuIGV4cGxpY2l0IGRlbGV0ZSBtZXNzYWdlIGFuZCB3ZSBjb3VsZFxuICAgICAgICAgICAgICAgICAgICAvLyByZW1vdmUgdGhpcyBzcGVjaWFsIGxvZ2ljLlxuICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gbmV3IFB0KGkudGFyZ2V0LnBhdGgpO1xuICAgICAgICAgICAgICAgICAgICBudWxsICE9PSB0aGlzLm50LmdldChlKSB8fCB0aGlzLmd0KHMsIGUpIHx8IHRoaXMuYXQocywgZSwgcXQubmV3Tm9Eb2N1bWVudChlLCB0KSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG4uSyAmJiAoZS5zZXQocywgbi5XKCkpLCBuLkcoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgbGV0IG4gPSBQbigpO1xuICAgICAgICAvLyBXZSBleHRyYWN0IHRoZSBzZXQgb2YgbGltYm8tb25seSBkb2N1bWVudCB1cGRhdGVzIGFzIHRoZSBHQyBsb2dpY1xuICAgICAgICAvLyBzcGVjaWFsLWNhc2VzIGRvY3VtZW50cyB0aGF0IGRvIG5vdCBhcHBlYXIgaW4gdGhlIHRhcmdldCBjYWNoZS5cbiAgICAgICAgXG4gICAgICAgIC8vIFRPRE8oZ3NvbHRpcyk6IEV4cGFuZCBvbiB0aGlzIGNvbW1lbnQgb25jZSBHQyBpcyBhdmFpbGFibGUgaW4gdGhlIEpTXG4gICAgICAgIC8vIGNsaWVudC5cbiAgICAgICAgICAgICAgICB0aGlzLnN0LmZvckVhY2goKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICBsZXQgcyA9ICEwO1xuICAgICAgICAgICAgZS5mb3JFYWNoV2hpbGUoKHQgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLmR0KHQpO1xuICAgICAgICAgICAgICAgIHJldHVybiAhZSB8fCAyIC8qIExpbWJvUmVzb2x1dGlvbiAqLyA9PT0gZS5wdXJwb3NlIHx8IChzID0gITEsICExKTtcbiAgICAgICAgICAgIH0pKSwgcyAmJiAobiA9IG4uYWRkKHQpKTtcbiAgICAgICAgfSkpO1xuICAgICAgICBjb25zdCBzID0gbmV3IFZuKHQsIGUsIHRoaXMuaXQsIHRoaXMubnQsIG4pO1xuICAgICAgICByZXR1cm4gdGhpcy5udCA9IHBuKCksIHRoaXMuc3QgPSAkbigpLCB0aGlzLml0ID0gbmV3IG1uKHR0KSwgcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkcyB0aGUgcHJvdmlkZWQgZG9jdW1lbnQgdG8gdGhlIGludGVybmFsIGxpc3Qgb2YgZG9jdW1lbnQgdXBkYXRlcyBhbmRcbiAgICAgKiBpdHMgZG9jdW1lbnQga2V5IHRvIHRoZSBnaXZlbiB0YXJnZXQncyBtYXBwaW5nLlxuICAgICAqL1xuICAgIC8vIFZpc2libGUgZm9yIHRlc3RpbmcuXG4gICAgb3QodCwgZSkge1xuICAgICAgICBpZiAoIXRoaXMuaHQodCkpIHJldHVybjtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMuZ3QodCwgZS5rZXkpID8gMiAvKiBNb2RpZmllZCAqLyA6IDAgLyogQWRkZWQgKi87XG4gICAgICAgIHRoaXMudXQodCkuSChlLmtleSwgbiksIHRoaXMubnQgPSB0aGlzLm50Lmluc2VydChlLmtleSwgZSksIHRoaXMuc3QgPSB0aGlzLnN0Lmluc2VydChlLmtleSwgdGhpcy55dChlLmtleSkuYWRkKHQpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyB0aGUgcHJvdmlkZWQgZG9jdW1lbnQgZnJvbSB0aGUgdGFyZ2V0IG1hcHBpbmcuIElmIHRoZVxuICAgICAqIGRvY3VtZW50IG5vIGxvbmdlciBtYXRjaGVzIHRoZSB0YXJnZXQsIGJ1dCB0aGUgZG9jdW1lbnQncyBzdGF0ZSBpcyBzdGlsbFxuICAgICAqIGtub3duIChlLmcuIHdlIGtub3cgdGhhdCB0aGUgZG9jdW1lbnQgd2FzIGRlbGV0ZWQgb3Igd2UgcmVjZWl2ZWQgdGhlIGNoYW5nZVxuICAgICAqIHRoYXQgY2F1c2VkIHRoZSBmaWx0ZXIgbWlzbWF0Y2gpLCB0aGUgbmV3IGRvY3VtZW50IGNhbiBiZSBwcm92aWRlZFxuICAgICAqIHRvIHVwZGF0ZSB0aGUgcmVtb3RlIGRvY3VtZW50IGNhY2hlLlxuICAgICAqL1xuICAgIC8vIFZpc2libGUgZm9yIHRlc3RpbmcuXG4gICAgYXQodCwgZSwgbikge1xuICAgICAgICBpZiAoIXRoaXMuaHQodCkpIHJldHVybjtcbiAgICAgICAgY29uc3QgcyA9IHRoaXMudXQodCk7XG4gICAgICAgIHRoaXMuZ3QodCwgZSkgPyBzLkgoZSwgMSAvKiBSZW1vdmVkICovKSA6IFxuICAgICAgICAvLyBUaGUgZG9jdW1lbnQgbWF5IGhhdmUgZW50ZXJlZCBhbmQgbGVmdCB0aGUgdGFyZ2V0IGJlZm9yZSB3ZSByYWlzZWQgYVxuICAgICAgICAvLyBzbmFwc2hvdCwgc28gd2UgY2FuIGp1c3QgaWdub3JlIHRoZSBjaGFuZ2UuXG4gICAgICAgIHMuSihlKSwgdGhpcy5zdCA9IHRoaXMuc3QuaW5zZXJ0KGUsIHRoaXMueXQoZSkuZGVsZXRlKHQpKSwgbiAmJiAodGhpcy5udCA9IHRoaXMubnQuaW5zZXJ0KGUsIG4pKTtcbiAgICB9XG4gICAgcmVtb3ZlVGFyZ2V0KHQpIHtcbiAgICAgICAgdGhpcy5ldC5kZWxldGUodCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIGN1cnJlbnQgY291bnQgb2YgZG9jdW1lbnRzIGluIHRoZSB0YXJnZXQuIFRoaXMgaW5jbHVkZXMgYm90aFxuICAgICAqIHRoZSBudW1iZXIgb2YgZG9jdW1lbnRzIHRoYXQgdGhlIExvY2FsU3RvcmUgY29uc2lkZXJzIHRvIGJlIHBhcnQgb2YgdGhlXG4gICAgICogdGFyZ2V0IGFzIHdlbGwgYXMgYW55IGFjY3VtdWxhdGVkIGNoYW5nZXMuXG4gICAgICovICAgIHd0KHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMudXQodCkuVygpO1xuICAgICAgICByZXR1cm4gdGhpcy50dC5nZXRSZW1vdGVLZXlzRm9yVGFyZ2V0KHQpLnNpemUgKyBlLmFkZGVkRG9jdW1lbnRzLnNpemUgLSBlLnJlbW92ZWREb2N1bWVudHMuc2l6ZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSW5jcmVtZW50IHRoZSBudW1iZXIgb2YgYWNrcyBuZWVkZWQgZnJvbSB3YXRjaCBiZWZvcmUgd2UgY2FuIGNvbnNpZGVyIHRoZVxuICAgICAqIHNlcnZlciB0byBiZSAnaW4tc3luYycgd2l0aCB0aGUgY2xpZW50J3MgYWN0aXZlIHRhcmdldHMuXG4gICAgICovICAgIFkodCkge1xuICAgICAgICB0aGlzLnV0KHQpLlkoKTtcbiAgICB9XG4gICAgdXQodCkge1xuICAgICAgICBsZXQgZSA9IHRoaXMuZXQuZ2V0KHQpO1xuICAgICAgICByZXR1cm4gZSB8fCAoZSA9IG5ldyB4biwgdGhpcy5ldC5zZXQodCwgZSkpLCBlO1xuICAgIH1cbiAgICB5dCh0KSB7XG4gICAgICAgIGxldCBlID0gdGhpcy5zdC5nZXQodCk7XG4gICAgICAgIHJldHVybiBlIHx8IChlID0gbmV3IG1uKHR0KSwgdGhpcy5zdCA9IHRoaXMuc3QuaW5zZXJ0KHQsIGUpKSwgZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVmVyaWZpZXMgdGhhdCB0aGUgdXNlciBpcyBzdGlsbCBpbnRlcmVzdGVkIGluIHRoaXMgdGFyZ2V0IChieSBjYWxsaW5nXG4gICAgICogYGdldFRhcmdldERhdGFGb3JUYXJnZXQoKWApIGFuZCB0aGF0IHdlIGFyZSBub3Qgd2FpdGluZyBmb3IgcGVuZGluZyBBRERzXG4gICAgICogZnJvbSB3YXRjaC5cbiAgICAgKi8gICAgaHQodCkge1xuICAgICAgICBjb25zdCBlID0gbnVsbCAhPT0gdGhpcy5kdCh0KTtcbiAgICAgICAgcmV0dXJuIGUgfHwgayhcIldhdGNoQ2hhbmdlQWdncmVnYXRvclwiLCBcIkRldGVjdGVkIGluYWN0aXZlIHRhcmdldFwiLCB0KSwgZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgVGFyZ2V0RGF0YSBmb3IgYW4gYWN0aXZlIHRhcmdldCAoaS5lLiBhIHRhcmdldCB0aGF0IHRoZSB1c2VyXG4gICAgICogaXMgc3RpbGwgaW50ZXJlc3RlZCBpbiB0aGF0IGhhcyBubyBvdXRzdGFuZGluZyB0YXJnZXQgY2hhbmdlIHJlcXVlc3RzKS5cbiAgICAgKi8gICAgZHQodCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5ldC5nZXQodCk7XG4gICAgICAgIHJldHVybiBlICYmIGUucSA/IG51bGwgOiB0aGlzLnR0LkV0KHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXNldHMgdGhlIHN0YXRlIG9mIGEgV2F0Y2ggdGFyZ2V0IHRvIGl0cyBpbml0aWFsIHN0YXRlIChlLmcuIHNldHNcbiAgICAgKiAnY3VycmVudCcgdG8gZmFsc2UsIGNsZWFycyB0aGUgcmVzdW1lIHRva2VuIGFuZCByZW1vdmVzIGl0cyB0YXJnZXQgbWFwcGluZ1xuICAgICAqIGZyb20gYWxsIGRvY3VtZW50cykuXG4gICAgICovICAgIGx0KHQpIHtcbiAgICAgICAgdGhpcy5ldC5zZXQodCwgbmV3IHhuKTtcbiAgICAgICAgdGhpcy50dC5nZXRSZW1vdGVLZXlzRm9yVGFyZ2V0KHQpLmZvckVhY2goKGUgPT4ge1xuICAgICAgICAgICAgdGhpcy5hdCh0LCBlLCAvKnVwZGF0ZWREb2N1bWVudD0qLyBudWxsKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHdoZXRoZXIgdGhlIExvY2FsU3RvcmUgY29uc2lkZXJzIHRoZSBkb2N1bWVudCB0byBiZSBwYXJ0IG9mIHRoZVxuICAgICAqIHNwZWNpZmllZCB0YXJnZXQuXG4gICAgICovICAgIGd0KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudHQuZ2V0UmVtb3RlS2V5c0ZvclRhcmdldCh0KS5oYXMoZSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiAkbigpIHtcbiAgICByZXR1cm4gbmV3IGRuKFB0LmNvbXBhcmF0b3IpO1xufVxuXG5mdW5jdGlvbiBPbigpIHtcbiAgICByZXR1cm4gbmV3IGRuKFB0LmNvbXBhcmF0b3IpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjb25zdCBGbiA9ICgoKSA9PiB7XG4gICAgY29uc3QgdCA9IHtcbiAgICAgICAgYXNjOiBcIkFTQ0VORElOR1wiLFxuICAgICAgICBkZXNjOiBcIkRFU0NFTkRJTkdcIlxuICAgIH07XG4gICAgcmV0dXJuIHQ7XG59KSgpLCBNbiA9ICgoKSA9PiB7XG4gICAgY29uc3QgdCA9IHtcbiAgICAgICAgXCI8XCI6IFwiTEVTU19USEFOXCIsXG4gICAgICAgIFwiPD1cIjogXCJMRVNTX1RIQU5fT1JfRVFVQUxcIixcbiAgICAgICAgXCI+XCI6IFwiR1JFQVRFUl9USEFOXCIsXG4gICAgICAgIFwiPj1cIjogXCJHUkVBVEVSX1RIQU5fT1JfRVFVQUxcIixcbiAgICAgICAgXCI9PVwiOiBcIkVRVUFMXCIsXG4gICAgICAgIFwiIT1cIjogXCJOT1RfRVFVQUxcIixcbiAgICAgICAgXCJhcnJheS1jb250YWluc1wiOiBcIkFSUkFZX0NPTlRBSU5TXCIsXG4gICAgICAgIGluOiBcIklOXCIsXG4gICAgICAgIFwibm90LWluXCI6IFwiTk9UX0lOXCIsXG4gICAgICAgIFwiYXJyYXktY29udGFpbnMtYW55XCI6IFwiQVJSQVlfQ09OVEFJTlNfQU5ZXCJcbiAgICB9O1xuICAgIHJldHVybiB0O1xufSkoKTtcblxuLyoqXG4gKiBUaGlzIGNsYXNzIGdlbmVyYXRlcyBKc29uT2JqZWN0IHZhbHVlcyBmb3IgdGhlIERhdGFzdG9yZSBBUEkgc3VpdGFibGUgZm9yXG4gKiBzZW5kaW5nIHRvIGVpdGhlciBHUlBDIHN0dWIgbWV0aG9kcyBvciB2aWEgdGhlIEpTT04vSFRUUCBSRVNUIEFQSS5cbiAqXG4gKiBUaGUgc2VyaWFsaXplciBzdXBwb3J0cyBib3RoIFByb3RvYnVmLmpzIGFuZCBQcm90bzMgSlNPTiBmb3JtYXRzLiBCeVxuICogc2V0dGluZyBgdXNlUHJvdG8zSnNvbmAgdG8gdHJ1ZSwgdGhlIHNlcmlhbGl6ZXIgd2lsbCB1c2UgdGhlIFByb3RvMyBKU09OXG4gKiBmb3JtYXQuXG4gKlxuICogRm9yIGEgZGVzY3JpcHRpb24gb2YgdGhlIFByb3RvMyBKU09OIGZvcm1hdCBjaGVja1xuICogaHR0cHM6Ly9kZXZlbG9wZXJzLmdvb2dsZS5jb20vcHJvdG9jb2wtYnVmZmVycy9kb2NzL3Byb3RvMyNqc29uXG4gKlxuICogVE9ETyhrbGltdCk6IFdlIGNhbiByZW1vdmUgdGhlIGRhdGFiYXNlSWQgYXJndW1lbnQgaWYgd2Uga2VlcCB0aGUgZnVsbFxuICogcmVzb3VyY2UgbmFtZSBpbiBkb2N1bWVudHMuXG4gKi9cbmNsYXNzIExuIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMuZGF0YWJhc2VJZCA9IHQsIHRoaXMuRCA9IGU7XG4gICAgfVxufVxuXG4vKipcbiAqIFJldHVybnMgYSB2YWx1ZSBmb3IgYSBEYXRlIHRoYXQncyBhcHByb3ByaWF0ZSB0byBwdXQgaW50byBhIHByb3RvLlxuICovXG5mdW5jdGlvbiBCbih0LCBlKSB7XG4gICAgaWYgKHQuRCkge1xuICAgICAgICByZXR1cm4gYCR7bmV3IERhdGUoMWUzICogZS5zZWNvbmRzKS50b0lTT1N0cmluZygpLnJlcGxhY2UoL1xcLlxcZCovLCBcIlwiKS5yZXBsYWNlKFwiWlwiLCBcIlwiKX0uJHsoXCIwMDAwMDAwMDBcIiArIGUubmFub3NlY29uZHMpLnNsaWNlKC05KX1aYDtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgc2Vjb25kczogXCJcIiArIGUuc2Vjb25kcyxcbiAgICAgICAgbmFub3M6IGUubmFub3NlY29uZHNcbiAgICB9O1xufVxuXG4vKipcbiAqIFJldHVybnMgYSB2YWx1ZSBmb3IgYnl0ZXMgdGhhdCdzIGFwcHJvcHJpYXRlIHRvIHB1dCBpbiBhIHByb3RvLlxuICpcbiAqIFZpc2libGUgZm9yIHRlc3RpbmcuXG4gKi9cbmZ1bmN0aW9uIFVuKHQsIGUpIHtcbiAgICByZXR1cm4gdC5EID8gZS50b0Jhc2U2NCgpIDogZS50b1VpbnQ4QXJyYXkoKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgQnl0ZVN0cmluZyBiYXNlZCBvbiB0aGUgcHJvdG8gc3RyaW5nIHZhbHVlLlxuICovIGZ1bmN0aW9uIHFuKHQsIGUpIHtcbiAgICByZXR1cm4gQm4odCwgZS50b1RpbWVzdGFtcCgpKTtcbn1cblxuZnVuY3Rpb24gS24odCkge1xuICAgIHJldHVybiBMKCEhdCksIGl0LmZyb21UaW1lc3RhbXAoZnVuY3Rpb24odCkge1xuICAgICAgICBjb25zdCBlID0gbXQodCk7XG4gICAgICAgIHJldHVybiBuZXcgc3QoZS5zZWNvbmRzLCBlLm5hbm9zKTtcbiAgICB9KHQpKTtcbn1cblxuZnVuY3Rpb24gam4odCwgZSkge1xuICAgIHJldHVybiBmdW5jdGlvbih0KSB7XG4gICAgICAgIHJldHVybiBuZXcgdXQoWyBcInByb2plY3RzXCIsIHQucHJvamVjdElkLCBcImRhdGFiYXNlc1wiLCB0LmRhdGFiYXNlIF0pO1xuICAgIH0odCkuY2hpbGQoXCJkb2N1bWVudHNcIikuY2hpbGQoZSkuY2Fub25pY2FsU3RyaW5nKCk7XG59XG5cbmZ1bmN0aW9uIFFuKHQpIHtcbiAgICBjb25zdCBlID0gdXQuZnJvbVN0cmluZyh0KTtcbiAgICByZXR1cm4gTChwcyhlKSksIGU7XG59XG5cbmZ1bmN0aW9uIFduKHQsIGUpIHtcbiAgICByZXR1cm4gam4odC5kYXRhYmFzZUlkLCBlLnBhdGgpO1xufVxuXG5mdW5jdGlvbiBHbih0LCBlKSB7XG4gICAgY29uc3QgbiA9IFFuKGUpO1xuICAgIGlmIChuLmdldCgxKSAhPT0gdC5kYXRhYmFzZUlkLnByb2plY3RJZCkgdGhyb3cgbmV3IEsocS5JTlZBTElEX0FSR1VNRU5ULCBcIlRyaWVkIHRvIGRlc2VyaWFsaXplIGtleSBmcm9tIGRpZmZlcmVudCBwcm9qZWN0OiBcIiArIG4uZ2V0KDEpICsgXCIgdnMgXCIgKyB0LmRhdGFiYXNlSWQucHJvamVjdElkKTtcbiAgICBpZiAobi5nZXQoMykgIT09IHQuZGF0YWJhc2VJZC5kYXRhYmFzZSkgdGhyb3cgbmV3IEsocS5JTlZBTElEX0FSR1VNRU5ULCBcIlRyaWVkIHRvIGRlc2VyaWFsaXplIGtleSBmcm9tIGRpZmZlcmVudCBkYXRhYmFzZTogXCIgKyBuLmdldCgzKSArIFwiIHZzIFwiICsgdC5kYXRhYmFzZUlkLmRhdGFiYXNlKTtcbiAgICByZXR1cm4gbmV3IFB0KFluKG4pKTtcbn1cblxuZnVuY3Rpb24gem4odCwgZSkge1xuICAgIHJldHVybiBqbih0LmRhdGFiYXNlSWQsIGUpO1xufVxuXG5mdW5jdGlvbiBIbih0KSB7XG4gICAgY29uc3QgZSA9IFFuKHQpO1xuICAgIC8vIEluIHYxYmV0YTEgcXVlcmllcyBmb3IgY29sbGVjdGlvbnMgYXQgdGhlIHJvb3QgZGlkIG5vdCBoYXZlIGEgdHJhaWxpbmdcbiAgICAvLyBcIi9kb2N1bWVudHNcIi4gSW4gdjEgYWxsIHJlc291cmNlIHBhdGhzIGNvbnRhaW4gXCIvZG9jdW1lbnRzXCIuIFByZXNlcnZlIHRoZVxuICAgIC8vIGFiaWxpdHkgdG8gcmVhZCB0aGUgdjFiZXRhMSBmb3JtIGZvciBjb21wYXRpYmlsaXR5IHdpdGggcXVlcmllcyBwZXJzaXN0ZWRcbiAgICAvLyBpbiB0aGUgbG9jYWwgdGFyZ2V0IGNhY2hlLlxuICAgICAgICByZXR1cm4gNCA9PT0gZS5sZW5ndGggPyB1dC5lbXB0eVBhdGgoKSA6IFluKGUpO1xufVxuXG5mdW5jdGlvbiBKbih0KSB7XG4gICAgcmV0dXJuIG5ldyB1dChbIFwicHJvamVjdHNcIiwgdC5kYXRhYmFzZUlkLnByb2plY3RJZCwgXCJkYXRhYmFzZXNcIiwgdC5kYXRhYmFzZUlkLmRhdGFiYXNlIF0pLmNhbm9uaWNhbFN0cmluZygpO1xufVxuXG5mdW5jdGlvbiBZbih0KSB7XG4gICAgcmV0dXJuIEwodC5sZW5ndGggPiA0ICYmIFwiZG9jdW1lbnRzXCIgPT09IHQuZ2V0KDQpKSwgdC5wb3BGaXJzdCg1KTtcbn1cblxuLyoqIENyZWF0ZXMgYSBEb2N1bWVudCBwcm90byBmcm9tIGtleSBhbmQgZmllbGRzIChidXQgbm8gY3JlYXRlL3VwZGF0ZSB0aW1lKSAqLyBmdW5jdGlvbiBYbih0LCBlLCBuKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgbmFtZTogV24odCwgZSksXG4gICAgICAgIGZpZWxkczogbi52YWx1ZS5tYXBWYWx1ZS5maWVsZHNcbiAgICB9O1xufVxuXG5mdW5jdGlvbiBabih0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9IEduKHQsIGUubmFtZSksIGkgPSBLbihlLnVwZGF0ZVRpbWUpLCByID0gbmV3IEJ0KHtcbiAgICAgICAgbWFwVmFsdWU6IHtcbiAgICAgICAgICAgIGZpZWxkczogZS5maWVsZHNcbiAgICAgICAgfVxuICAgIH0pLCBvID0gcXQubmV3Rm91bmREb2N1bWVudChzLCBpLCByKTtcbiAgICByZXR1cm4gbiAmJiBvLnNldEhhc0NvbW1pdHRlZE11dGF0aW9ucygpLCBuID8gby5zZXRIYXNDb21taXR0ZWRNdXRhdGlvbnMoKSA6IG87XG59XG5cbmZ1bmN0aW9uIHRzKHQsIGUpIHtcbiAgICByZXR1cm4gXCJmb3VuZFwiIGluIGUgPyBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIEwoISFlLmZvdW5kKSwgZS5mb3VuZC5uYW1lLCBlLmZvdW5kLnVwZGF0ZVRpbWU7XG4gICAgICAgIGNvbnN0IG4gPSBHbih0LCBlLmZvdW5kLm5hbWUpLCBzID0gS24oZS5mb3VuZC51cGRhdGVUaW1lKSwgaSA9IG5ldyBCdCh7XG4gICAgICAgICAgICBtYXBWYWx1ZToge1xuICAgICAgICAgICAgICAgIGZpZWxkczogZS5mb3VuZC5maWVsZHNcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBxdC5uZXdGb3VuZERvY3VtZW50KG4sIHMsIGkpO1xuICAgIH0odCwgZSkgOiBcIm1pc3NpbmdcIiBpbiBlID8gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBMKCEhZS5taXNzaW5nKSwgTCghIWUucmVhZFRpbWUpO1xuICAgICAgICBjb25zdCBuID0gR24odCwgZS5taXNzaW5nKSwgcyA9IEtuKGUucmVhZFRpbWUpO1xuICAgICAgICByZXR1cm4gcXQubmV3Tm9Eb2N1bWVudChuLCBzKTtcbiAgICB9KHQsIGUpIDogTSgpO1xufVxuXG5mdW5jdGlvbiBlcyh0LCBlKSB7XG4gICAgbGV0IG47XG4gICAgaWYgKFwidGFyZ2V0Q2hhbmdlXCIgaW4gZSkge1xuICAgICAgICBlLnRhcmdldENoYW5nZTtcbiAgICAgICAgLy8gcHJvdG8zIGRlZmF1bHQgdmFsdWUgaXMgdW5zZXQgaW4gSlNPTiAodW5kZWZpbmVkKSwgc28gdXNlICdOT19DSEFOR0UnXG4gICAgICAgIC8vIGlmIHVuc2V0XG4gICAgICAgIGNvbnN0IHMgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICByZXR1cm4gXCJOT19DSEFOR0VcIiA9PT0gdCA/IDAgLyogTm9DaGFuZ2UgKi8gOiBcIkFERFwiID09PSB0ID8gMSAvKiBBZGRlZCAqLyA6IFwiUkVNT1ZFXCIgPT09IHQgPyAyIC8qIFJlbW92ZWQgKi8gOiBcIkNVUlJFTlRcIiA9PT0gdCA/IDMgLyogQ3VycmVudCAqLyA6IFwiUkVTRVRcIiA9PT0gdCA/IDQgLyogUmVzZXQgKi8gOiBNKCk7XG4gICAgICAgIH0oZS50YXJnZXRDaGFuZ2UudGFyZ2V0Q2hhbmdlVHlwZSB8fCBcIk5PX0NIQU5HRVwiKSwgaSA9IGUudGFyZ2V0Q2hhbmdlLnRhcmdldElkcyB8fCBbXSwgciA9IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIHJldHVybiB0LkQgPyAoTCh2b2lkIDAgPT09IGUgfHwgXCJzdHJpbmdcIiA9PSB0eXBlb2YgZSksIHd0LmZyb21CYXNlNjRTdHJpbmcoZSB8fCBcIlwiKSkgOiAoTCh2b2lkIDAgPT09IGUgfHwgZSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpLCBcbiAgICAgICAgICAgIHd0LmZyb21VaW50OEFycmF5KGUgfHwgbmV3IFVpbnQ4QXJyYXkpKTtcbiAgICAgICAgfSh0LCBlLnRhcmdldENoYW5nZS5yZXN1bWVUb2tlbiksIG8gPSBlLnRhcmdldENoYW5nZS5jYXVzZSwgYSA9IG8gJiYgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgY29uc3QgZSA9IHZvaWQgMCA9PT0gdC5jb2RlID8gcS5VTktOT1dOIDogZm4odC5jb2RlKTtcbiAgICAgICAgICAgIHJldHVybiBuZXcgSyhlLCB0Lm1lc3NhZ2UgfHwgXCJcIik7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gKiBSZXR1cm5zIGEgdmFsdWUgZm9yIGEgbnVtYmVyIChvciBudWxsKSB0aGF0J3MgYXBwcm9wcmlhdGUgdG8gcHV0IGludG9cbiAqIGEgZ29vZ2xlLnByb3RvYnVmLkludDMyVmFsdWUgcHJvdG8uXG4gKiBETyBOT1QgVVNFIFRISVMgRk9SIEFOWVRISU5HIEVMU0UuXG4gKiBUaGlzIG1ldGhvZCBjaGVhdHMuIEl0J3MgdHlwZWQgYXMgcmV0dXJuaW5nIFwibnVtYmVyXCIgYmVjYXVzZSB0aGF0J3Mgd2hhdFxuICogb3VyIGdlbmVyYXRlZCBwcm90byBpbnRlcmZhY2VzIHNheSBJbnQzMlZhbHVlIG11c3QgYmUuIEJ1dCBHUlBDIGFjdHVhbGx5XG4gKiBleHBlY3RzIGEgeyB2YWx1ZTogPG51bWJlcj4gfSBzdHJ1Y3QuXG4gKi8gKG8pO1xuICAgICAgICBuID0gbmV3IE5uKHMsIGksIHIsIGEgfHwgbnVsbCk7XG4gICAgfSBlbHNlIGlmIChcImRvY3VtZW50Q2hhbmdlXCIgaW4gZSkge1xuICAgICAgICBlLmRvY3VtZW50Q2hhbmdlO1xuICAgICAgICBjb25zdCBzID0gZS5kb2N1bWVudENoYW5nZTtcbiAgICAgICAgcy5kb2N1bWVudCwgcy5kb2N1bWVudC5uYW1lLCBzLmRvY3VtZW50LnVwZGF0ZVRpbWU7XG4gICAgICAgIGNvbnN0IGkgPSBHbih0LCBzLmRvY3VtZW50Lm5hbWUpLCByID0gS24ocy5kb2N1bWVudC51cGRhdGVUaW1lKSwgbyA9IG5ldyBCdCh7XG4gICAgICAgICAgICBtYXBWYWx1ZToge1xuICAgICAgICAgICAgICAgIGZpZWxkczogcy5kb2N1bWVudC5maWVsZHNcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSksIGEgPSBxdC5uZXdGb3VuZERvY3VtZW50KGksIHIsIG8pLCBjID0gcy50YXJnZXRJZHMgfHwgW10sIHUgPSBzLnJlbW92ZWRUYXJnZXRJZHMgfHwgW107XG4gICAgICAgIG4gPSBuZXcgRG4oYywgdSwgYS5rZXksIGEpO1xuICAgIH0gZWxzZSBpZiAoXCJkb2N1bWVudERlbGV0ZVwiIGluIGUpIHtcbiAgICAgICAgZS5kb2N1bWVudERlbGV0ZTtcbiAgICAgICAgY29uc3QgcyA9IGUuZG9jdW1lbnREZWxldGU7XG4gICAgICAgIHMuZG9jdW1lbnQ7XG4gICAgICAgIGNvbnN0IGkgPSBHbih0LCBzLmRvY3VtZW50KSwgciA9IHMucmVhZFRpbWUgPyBLbihzLnJlYWRUaW1lKSA6IGl0Lm1pbigpLCBvID0gcXQubmV3Tm9Eb2N1bWVudChpLCByKSwgYSA9IHMucmVtb3ZlZFRhcmdldElkcyB8fCBbXTtcbiAgICAgICAgbiA9IG5ldyBEbihbXSwgYSwgby5rZXksIG8pO1xuICAgIH0gZWxzZSBpZiAoXCJkb2N1bWVudFJlbW92ZVwiIGluIGUpIHtcbiAgICAgICAgZS5kb2N1bWVudFJlbW92ZTtcbiAgICAgICAgY29uc3QgcyA9IGUuZG9jdW1lbnRSZW1vdmU7XG4gICAgICAgIHMuZG9jdW1lbnQ7XG4gICAgICAgIGNvbnN0IGkgPSBHbih0LCBzLmRvY3VtZW50KSwgciA9IHMucmVtb3ZlZFRhcmdldElkcyB8fCBbXTtcbiAgICAgICAgbiA9IG5ldyBEbihbXSwgciwgaSwgbnVsbCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKCEoXCJmaWx0ZXJcIiBpbiBlKSkgcmV0dXJuIE0oKTtcbiAgICAgICAge1xuICAgICAgICAgICAgZS5maWx0ZXI7XG4gICAgICAgICAgICBjb25zdCB0ID0gZS5maWx0ZXI7XG4gICAgICAgICAgICB0LnRhcmdldElkO1xuICAgICAgICAgICAgY29uc3QgcyA9IHQuY291bnQgfHwgMCwgaSA9IG5ldyBjbihzKSwgciA9IHQudGFyZ2V0SWQ7XG4gICAgICAgICAgICBuID0gbmV3IENuKHIsIGkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBuO1xufVxuXG5mdW5jdGlvbiBucyh0LCBlKSB7XG4gICAgbGV0IG47XG4gICAgaWYgKGUgaW5zdGFuY2VvZiB0bikgbiA9IHtcbiAgICAgICAgdXBkYXRlOiBYbih0LCBlLmtleSwgZS52YWx1ZSlcbiAgICB9OyBlbHNlIGlmIChlIGluc3RhbmNlb2Ygb24pIG4gPSB7XG4gICAgICAgIGRlbGV0ZTogV24odCwgZS5rZXkpXG4gICAgfTsgZWxzZSBpZiAoZSBpbnN0YW5jZW9mIGVuKSBuID0ge1xuICAgICAgICB1cGRhdGU6IFhuKHQsIGUua2V5LCBlLmRhdGEpLFxuICAgICAgICB1cGRhdGVNYXNrOiB5cyhlLmZpZWxkTWFzaylcbiAgICB9OyBlbHNlIHtcbiAgICAgICAgaWYgKCEoZSBpbnN0YW5jZW9mIGFuKSkgcmV0dXJuIE0oKTtcbiAgICAgICAgbiA9IHtcbiAgICAgICAgICAgIHZlcmlmeTogV24odCwgZS5rZXkpXG4gICAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiBlLmZpZWxkVHJhbnNmb3Jtcy5sZW5ndGggPiAwICYmIChuLnVwZGF0ZVRyYW5zZm9ybXMgPSBlLmZpZWxkVHJhbnNmb3Jtcy5tYXAoKHQgPT4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBjb25zdCBuID0gZS50cmFuc2Zvcm07XG4gICAgICAgIGlmIChuIGluc3RhbmNlb2YgJGUpIHJldHVybiB7XG4gICAgICAgICAgICBmaWVsZFBhdGg6IGUuZmllbGQuY2Fub25pY2FsU3RyaW5nKCksXG4gICAgICAgICAgICBzZXRUb1NlcnZlclZhbHVlOiBcIlJFUVVFU1RfVElNRVwiXG4gICAgICAgIH07XG4gICAgICAgIGlmIChuIGluc3RhbmNlb2YgT2UpIHJldHVybiB7XG4gICAgICAgICAgICBmaWVsZFBhdGg6IGUuZmllbGQuY2Fub25pY2FsU3RyaW5nKCksXG4gICAgICAgICAgICBhcHBlbmRNaXNzaW5nRWxlbWVudHM6IHtcbiAgICAgICAgICAgICAgICB2YWx1ZXM6IG4uZWxlbWVudHNcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgaWYgKG4gaW5zdGFuY2VvZiBNZSkgcmV0dXJuIHtcbiAgICAgICAgICAgIGZpZWxkUGF0aDogZS5maWVsZC5jYW5vbmljYWxTdHJpbmcoKSxcbiAgICAgICAgICAgIHJlbW92ZUFsbEZyb21BcnJheToge1xuICAgICAgICAgICAgICAgIHZhbHVlczogbi5lbGVtZW50c1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBpZiAobiBpbnN0YW5jZW9mIEJlKSByZXR1cm4ge1xuICAgICAgICAgICAgZmllbGRQYXRoOiBlLmZpZWxkLmNhbm9uaWNhbFN0cmluZygpLFxuICAgICAgICAgICAgaW5jcmVtZW50OiBuLkNcbiAgICAgICAgfTtcbiAgICAgICAgdGhyb3cgTSgpO1xuICAgIH0oMCwgdCkpKSksIGUucHJlY29uZGl0aW9uLmlzTm9uZSB8fCAobi5jdXJyZW50RG9jdW1lbnQgPSBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIHJldHVybiB2b2lkIDAgIT09IGUudXBkYXRlVGltZSA/IHtcbiAgICAgICAgICAgIHVwZGF0ZVRpbWU6IHFuKHQsIGUudXBkYXRlVGltZSlcbiAgICAgICAgfSA6IHZvaWQgMCAhPT0gZS5leGlzdHMgPyB7XG4gICAgICAgICAgICBleGlzdHM6IGUuZXhpc3RzXG4gICAgICAgIH0gOiBNKCk7XG4gICAgfSh0LCBlLnByZWNvbmRpdGlvbikpLCBuO1xufVxuXG5mdW5jdGlvbiBzcyh0LCBlKSB7XG4gICAgY29uc3QgbiA9IGUuY3VycmVudERvY3VtZW50ID8gZnVuY3Rpb24odCkge1xuICAgICAgICByZXR1cm4gdm9pZCAwICE9PSB0LnVwZGF0ZVRpbWUgPyBXZS51cGRhdGVUaW1lKEtuKHQudXBkYXRlVGltZSkpIDogdm9pZCAwICE9PSB0LmV4aXN0cyA/IFdlLmV4aXN0cyh0LmV4aXN0cykgOiBXZS5ub25lKCk7XG4gICAgfShlLmN1cnJlbnREb2N1bWVudCkgOiBXZS5ub25lKCksIHMgPSBlLnVwZGF0ZVRyYW5zZm9ybXMgPyBlLnVwZGF0ZVRyYW5zZm9ybXMubWFwKChlID0+IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgbGV0IG4gPSBudWxsO1xuICAgICAgICBpZiAoXCJzZXRUb1NlcnZlclZhbHVlXCIgaW4gZSkgTChcIlJFUVVFU1RfVElNRVwiID09PSBlLnNldFRvU2VydmVyVmFsdWUpLCBuID0gbmV3ICRlOyBlbHNlIGlmIChcImFwcGVuZE1pc3NpbmdFbGVtZW50c1wiIGluIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBlLmFwcGVuZE1pc3NpbmdFbGVtZW50cy52YWx1ZXMgfHwgW107XG4gICAgICAgICAgICBuID0gbmV3IE9lKHQpO1xuICAgICAgICB9IGVsc2UgaWYgKFwicmVtb3ZlQWxsRnJvbUFycmF5XCIgaW4gZSkge1xuICAgICAgICAgICAgY29uc3QgdCA9IGUucmVtb3ZlQWxsRnJvbUFycmF5LnZhbHVlcyB8fCBbXTtcbiAgICAgICAgICAgIG4gPSBuZXcgTWUodCk7XG4gICAgICAgIH0gZWxzZSBcImluY3JlbWVudFwiIGluIGUgPyBuID0gbmV3IEJlKHQsIGUuaW5jcmVtZW50KSA6IE0oKTtcbiAgICAgICAgY29uc3QgcyA9IGx0LmZyb21TZXJ2ZXJGb3JtYXQoZS5maWVsZFBhdGgpO1xuICAgICAgICByZXR1cm4gbmV3IEtlKHMsIG4pO1xuICAgIH0odCwgZSkpKSA6IFtdO1xuICAgIGlmIChlLnVwZGF0ZSkge1xuICAgICAgICBlLnVwZGF0ZS5uYW1lO1xuICAgICAgICBjb25zdCBpID0gR24odCwgZS51cGRhdGUubmFtZSksIHIgPSBuZXcgQnQoe1xuICAgICAgICAgICAgbWFwVmFsdWU6IHtcbiAgICAgICAgICAgICAgICBmaWVsZHM6IGUudXBkYXRlLmZpZWxkc1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKGUudXBkYXRlTWFzaykge1xuICAgICAgICAgICAgY29uc3QgdCA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5maWVsZFBhdGhzIHx8IFtdO1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgZnQoZS5tYXAoKHQgPT4gbHQuZnJvbVNlcnZlckZvcm1hdCh0KSkpKTtcbiAgICAgICAgICAgIH0oZS51cGRhdGVNYXNrKTtcbiAgICAgICAgICAgIHJldHVybiBuZXcgZW4oaSwgciwgdCwgbiwgcyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyB0bihpLCByLCBuLCBzKTtcbiAgICB9XG4gICAgaWYgKGUuZGVsZXRlKSB7XG4gICAgICAgIGNvbnN0IHMgPSBHbih0LCBlLmRlbGV0ZSk7XG4gICAgICAgIHJldHVybiBuZXcgb24ocywgbik7XG4gICAgfVxuICAgIGlmIChlLnZlcmlmeSkge1xuICAgICAgICBjb25zdCBzID0gR24odCwgZS52ZXJpZnkpO1xuICAgICAgICByZXR1cm4gbmV3IGFuKHMsIG4pO1xuICAgIH1cbiAgICByZXR1cm4gTSgpO1xufVxuXG5mdW5jdGlvbiBpcyh0LCBlKSB7XG4gICAgcmV0dXJuIHQgJiYgdC5sZW5ndGggPiAwID8gKEwodm9pZCAwICE9PSBlKSwgdC5tYXAoKHQgPT4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAvLyBOT1RFOiBEZWxldGVzIGRvbid0IGhhdmUgYW4gdXBkYXRlVGltZS5cbiAgICAgICAgbGV0IG4gPSB0LnVwZGF0ZVRpbWUgPyBLbih0LnVwZGF0ZVRpbWUpIDogS24oZSk7XG4gICAgICAgIHJldHVybiBuLmlzRXF1YWwoaXQubWluKCkpICYmIChcbiAgICAgICAgLy8gVGhlIEZpcmVzdG9yZSBFbXVsYXRvciBjdXJyZW50bHkgcmV0dXJucyBhbiB1cGRhdGUgdGltZSBvZiAwIGZvclxuICAgICAgICAvLyBkZWxldGVzIG9mIG5vbi1leGlzdGluZyBkb2N1bWVudHMgKHJhdGhlciB0aGFuIG51bGwpLiBUaGlzIGJyZWFrcyB0aGVcbiAgICAgICAgLy8gdGVzdCBcImdldCBkZWxldGVkIGRvYyB3aGlsZSBvZmZsaW5lIHdpdGggc291cmNlPWNhY2hlXCIgYXMgTm9Eb2N1bWVudHNcbiAgICAgICAgLy8gd2l0aCB2ZXJzaW9uIDAgYXJlIGZpbHRlcmVkIGJ5IEluZGV4ZWREYidzIFJlbW90ZURvY3VtZW50Q2FjaGUuXG4gICAgICAgIC8vIFRPRE8oIzIxNDkpOiBSZW1vdmUgdGhpcyB3aGVuIEVtdWxhdG9yIGlzIGZpeGVkXG4gICAgICAgIG4gPSBLbihlKSksIG5ldyBRZShuLCB0LnRyYW5zZm9ybVJlc3VsdHMgfHwgW10pO1xuICAgIH0odCwgZSkpKSkgOiBbXTtcbn1cblxuZnVuY3Rpb24gcnModCwgZSkge1xuICAgIHJldHVybiB7XG4gICAgICAgIGRvY3VtZW50czogWyB6bih0LCBlLnBhdGgpIF1cbiAgICB9O1xufVxuXG5mdW5jdGlvbiBvcyh0LCBlKSB7XG4gICAgLy8gRGlzc2VjdCB0aGUgcGF0aCBpbnRvIHBhcmVudCwgY29sbGVjdGlvbklkLCBhbmQgb3B0aW9uYWwga2V5IGZpbHRlci5cbiAgICBjb25zdCBuID0ge1xuICAgICAgICBzdHJ1Y3R1cmVkUXVlcnk6IHt9XG4gICAgfSwgcyA9IGUucGF0aDtcbiAgICBudWxsICE9PSBlLmNvbGxlY3Rpb25Hcm91cCA/IChuLnBhcmVudCA9IHpuKHQsIHMpLCBuLnN0cnVjdHVyZWRRdWVyeS5mcm9tID0gWyB7XG4gICAgICAgIGNvbGxlY3Rpb25JZDogZS5jb2xsZWN0aW9uR3JvdXAsXG4gICAgICAgIGFsbERlc2NlbmRhbnRzOiAhMFxuICAgIH0gXSkgOiAobi5wYXJlbnQgPSB6bih0LCBzLnBvcExhc3QoKSksIG4uc3RydWN0dXJlZFF1ZXJ5LmZyb20gPSBbIHtcbiAgICAgICAgY29sbGVjdGlvbklkOiBzLmxhc3RTZWdtZW50KClcbiAgICB9IF0pO1xuICAgIGNvbnN0IGkgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgIGlmICgwID09PSB0Lmxlbmd0aCkgcmV0dXJuO1xuICAgICAgICBjb25zdCBlID0gdC5tYXAoKHQgPT4gXG4gICAgICAgIC8vIHZpc2libGUgZm9yIHRlc3RpbmdcbiAgICAgICAgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgaWYgKFwiPT1cIiAvKiBFUVVBTCAqLyA9PT0gdC5vcCkge1xuICAgICAgICAgICAgICAgIGlmIChGdCh0LnZhbHVlKSkgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgdW5hcnlGaWx0ZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkOiB3cyh0LmZpZWxkKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wOiBcIklTX05BTlwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGlmIChPdCh0LnZhbHVlKSkgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgdW5hcnlGaWx0ZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkOiB3cyh0LmZpZWxkKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wOiBcIklTX05VTExcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoXCIhPVwiIC8qIE5PVF9FUVVBTCAqLyA9PT0gdC5vcCkge1xuICAgICAgICAgICAgICAgIGlmIChGdCh0LnZhbHVlKSkgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgdW5hcnlGaWx0ZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkOiB3cyh0LmZpZWxkKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wOiBcIklTX05PVF9OQU5cIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBpZiAoT3QodC52YWx1ZSkpIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHVuYXJ5RmlsdGVyOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaWVsZDogd3ModC5maWVsZCksXG4gICAgICAgICAgICAgICAgICAgICAgICBvcDogXCJJU19OT1RfTlVMTFwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBmaWVsZEZpbHRlcjoge1xuICAgICAgICAgICAgICAgICAgICBmaWVsZDogd3ModC5maWVsZCksXG4gICAgICAgICAgICAgICAgICAgIG9wOiBkcyh0Lm9wKSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHQudmFsdWVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KHQpKSk7XG4gICAgICAgIGlmICgxID09PSBlLmxlbmd0aCkgcmV0dXJuIGVbMF07XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBjb21wb3NpdGVGaWx0ZXI6IHtcbiAgICAgICAgICAgICAgICBvcDogXCJBTkRcIixcbiAgICAgICAgICAgICAgICBmaWx0ZXJzOiBlXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfShlLmZpbHRlcnMpO1xuICAgIGkgJiYgKG4uc3RydWN0dXJlZFF1ZXJ5LndoZXJlID0gaSk7XG4gICAgY29uc3QgciA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgaWYgKDAgPT09IHQubGVuZ3RoKSByZXR1cm47XG4gICAgICAgIHJldHVybiB0Lm1hcCgodCA9PiBcbiAgICAgICAgLy8gdmlzaWJsZSBmb3IgdGVzdGluZ1xuICAgICAgICBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGZpZWxkOiB3cyh0LmZpZWxkKSxcbiAgICAgICAgICAgICAgICBkaXJlY3Rpb246IGZzKHQuZGlyKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSh0KSkpO1xuICAgIH0oZS5vcmRlckJ5KTtcbiAgICByICYmIChuLnN0cnVjdHVyZWRRdWVyeS5vcmRlckJ5ID0gcik7XG4gICAgY29uc3QgbyA9IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHQuRCB8fCBJdChlKSA/IGUgOiB7XG4gICAgICAgICAgICB2YWx1ZTogZVxuICAgICAgICB9O1xuICAgIH1cbiAgICAvKipcbiAqIFJldHVybnMgYSBudW1iZXIgKG9yIG51bGwpIGZyb20gYSBnb29nbGUucHJvdG9idWYuSW50MzJWYWx1ZSBwcm90by5cbiAqLyAodCwgZS5saW1pdCk7XG4gICAgcmV0dXJuIG51bGwgIT09IG8gJiYgKG4uc3RydWN0dXJlZFF1ZXJ5LmxpbWl0ID0gbyksIGUuc3RhcnRBdCAmJiAobi5zdHJ1Y3R1cmVkUXVlcnkuc3RhcnRBdCA9IGhzKGUuc3RhcnRBdCkpLCBcbiAgICBlLmVuZEF0ICYmIChuLnN0cnVjdHVyZWRRdWVyeS5lbmRBdCA9IGhzKGUuZW5kQXQpKSwgbjtcbn1cblxuZnVuY3Rpb24gYXModCkge1xuICAgIGxldCBlID0gSG4odC5wYXJlbnQpO1xuICAgIGNvbnN0IG4gPSB0LnN0cnVjdHVyZWRRdWVyeSwgcyA9IG4uZnJvbSA/IG4uZnJvbS5sZW5ndGggOiAwO1xuICAgIGxldCBpID0gbnVsbDtcbiAgICBpZiAocyA+IDApIHtcbiAgICAgICAgTCgxID09PSBzKTtcbiAgICAgICAgY29uc3QgdCA9IG4uZnJvbVswXTtcbiAgICAgICAgdC5hbGxEZXNjZW5kYW50cyA/IGkgPSB0LmNvbGxlY3Rpb25JZCA6IGUgPSBlLmNoaWxkKHQuY29sbGVjdGlvbklkKTtcbiAgICB9XG4gICAgbGV0IHIgPSBbXTtcbiAgICBuLndoZXJlICYmIChyID0gdXMobi53aGVyZSkpO1xuICAgIGxldCBvID0gW107XG4gICAgbi5vcmRlckJ5ICYmIChvID0gbi5vcmRlckJ5Lm1hcCgodCA9PiBmdW5jdGlvbih0KSB7XG4gICAgICAgIHJldHVybiBuZXcgYWUoX3ModC5maWVsZCksIFxuICAgICAgICAvLyB2aXNpYmxlIGZvciB0ZXN0aW5nXG4gICAgICAgIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIHN3aXRjaCAodCkge1xuICAgICAgICAgICAgICBjYXNlIFwiQVNDRU5ESU5HXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiYXNjXCIgLyogQVNDRU5ESU5HICovO1xuXG4gICAgICAgICAgICAgIGNhc2UgXCJERVNDRU5ESU5HXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiZGVzY1wiIC8qIERFU0NFTkRJTkcgKi87XG5cbiAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gdmlzaWJsZSBmb3IgdGVzdGluZ1xuICAgICAgICAodC5kaXJlY3Rpb24pKTtcbiAgICB9KHQpKSkpO1xuICAgIGxldCBhID0gbnVsbDtcbiAgICBuLmxpbWl0ICYmIChhID0gZnVuY3Rpb24odCkge1xuICAgICAgICBsZXQgZTtcbiAgICAgICAgcmV0dXJuIGUgPSBcIm9iamVjdFwiID09IHR5cGVvZiB0ID8gdC52YWx1ZSA6IHQsIEl0KGUpID8gbnVsbCA6IGU7XG4gICAgfShuLmxpbWl0KSk7XG4gICAgbGV0IGMgPSBudWxsO1xuICAgIG4uc3RhcnRBdCAmJiAoYyA9IGxzKG4uc3RhcnRBdCkpO1xuICAgIGxldCB1ID0gbnVsbDtcbiAgICByZXR1cm4gbi5lbmRBdCAmJiAodSA9IGxzKG4uZW5kQXQpKSwgZmUoZSwgaSwgbywgciwgYSwgXCJGXCIgLyogRmlyc3QgKi8gLCBjLCB1KTtcbn1cblxuZnVuY3Rpb24gY3ModCwgZSkge1xuICAgIGNvbnN0IG4gPSBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIHN3aXRjaCAoZSkge1xuICAgICAgICAgIGNhc2UgMCAvKiBMaXN0ZW4gKi8gOlxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG5cbiAgICAgICAgICBjYXNlIDEgLyogRXhpc3RlbmNlRmlsdGVyTWlzbWF0Y2ggKi8gOlxuICAgICAgICAgICAgcmV0dXJuIFwiZXhpc3RlbmNlLWZpbHRlci1taXNtYXRjaFwiO1xuXG4gICAgICAgICAgY2FzZSAyIC8qIExpbWJvUmVzb2x1dGlvbiAqLyA6XG4gICAgICAgICAgICByZXR1cm4gXCJsaW1iby1kb2N1bWVudFwiO1xuXG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBNKCk7XG4gICAgICAgIH1cbiAgICB9KDAsIGUucHVycG9zZSk7XG4gICAgcmV0dXJuIG51bGwgPT0gbiA/IG51bGwgOiB7XG4gICAgICAgIFwiZ29vZy1saXN0ZW4tdGFnc1wiOiBuXG4gICAgfTtcbn1cblxuZnVuY3Rpb24gdXModCkge1xuICAgIHJldHVybiB0ID8gdm9pZCAwICE9PSB0LnVuYXJ5RmlsdGVyID8gWyBncyh0KSBdIDogdm9pZCAwICE9PSB0LmZpZWxkRmlsdGVyID8gWyBtcyh0KSBdIDogdm9pZCAwICE9PSB0LmNvbXBvc2l0ZUZpbHRlciA/IHQuY29tcG9zaXRlRmlsdGVyLmZpbHRlcnMubWFwKCh0ID0+IHVzKHQpKSkucmVkdWNlKCgodCwgZSkgPT4gdC5jb25jYXQoZSkpKSA6IE0oKSA6IFtdO1xufVxuXG5mdW5jdGlvbiBocyh0KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgYmVmb3JlOiB0LmJlZm9yZSxcbiAgICAgICAgdmFsdWVzOiB0LnBvc2l0aW9uXG4gICAgfTtcbn1cblxuZnVuY3Rpb24gbHModCkge1xuICAgIGNvbnN0IGUgPSAhIXQuYmVmb3JlLCBuID0gdC52YWx1ZXMgfHwgW107XG4gICAgcmV0dXJuIG5ldyByZShuLCBlKTtcbn1cblxuLy8gdmlzaWJsZSBmb3IgdGVzdGluZ1xuZnVuY3Rpb24gZnModCkge1xuICAgIHJldHVybiBGblt0XTtcbn1cblxuZnVuY3Rpb24gZHModCkge1xuICAgIHJldHVybiBNblt0XTtcbn1cblxuZnVuY3Rpb24gd3ModCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIGZpZWxkUGF0aDogdC5jYW5vbmljYWxTdHJpbmcoKVxuICAgIH07XG59XG5cbmZ1bmN0aW9uIF9zKHQpIHtcbiAgICByZXR1cm4gbHQuZnJvbVNlcnZlckZvcm1hdCh0LmZpZWxkUGF0aCk7XG59XG5cbmZ1bmN0aW9uIG1zKHQpIHtcbiAgICByZXR1cm4gSHQuY3JlYXRlKF9zKHQuZmllbGRGaWx0ZXIuZmllbGQpLCBmdW5jdGlvbih0KSB7XG4gICAgICAgIHN3aXRjaCAodCkge1xuICAgICAgICAgIGNhc2UgXCJFUVVBTFwiOlxuICAgICAgICAgICAgcmV0dXJuIFwiPT1cIiAvKiBFUVVBTCAqLztcblxuICAgICAgICAgIGNhc2UgXCJOT1RfRVFVQUxcIjpcbiAgICAgICAgICAgIHJldHVybiBcIiE9XCIgLyogTk9UX0VRVUFMICovO1xuXG4gICAgICAgICAgY2FzZSBcIkdSRUFURVJfVEhBTlwiOlxuICAgICAgICAgICAgcmV0dXJuIFwiPlwiIC8qIEdSRUFURVJfVEhBTiAqLztcblxuICAgICAgICAgIGNhc2UgXCJHUkVBVEVSX1RIQU5fT1JfRVFVQUxcIjpcbiAgICAgICAgICAgIHJldHVybiBcIj49XCIgLyogR1JFQVRFUl9USEFOX09SX0VRVUFMICovO1xuXG4gICAgICAgICAgY2FzZSBcIkxFU1NfVEhBTlwiOlxuICAgICAgICAgICAgcmV0dXJuIFwiPFwiIC8qIExFU1NfVEhBTiAqLztcblxuICAgICAgICAgIGNhc2UgXCJMRVNTX1RIQU5fT1JfRVFVQUxcIjpcbiAgICAgICAgICAgIHJldHVybiBcIjw9XCIgLyogTEVTU19USEFOX09SX0VRVUFMICovO1xuXG4gICAgICAgICAgY2FzZSBcIkFSUkFZX0NPTlRBSU5TXCI6XG4gICAgICAgICAgICByZXR1cm4gXCJhcnJheS1jb250YWluc1wiIC8qIEFSUkFZX0NPTlRBSU5TICovO1xuXG4gICAgICAgICAgY2FzZSBcIklOXCI6XG4gICAgICAgICAgICByZXR1cm4gXCJpblwiIC8qIElOICovO1xuXG4gICAgICAgICAgY2FzZSBcIk5PVF9JTlwiOlxuICAgICAgICAgICAgcmV0dXJuIFwibm90LWluXCIgLyogTk9UX0lOICovO1xuXG4gICAgICAgICAgY2FzZSBcIkFSUkFZX0NPTlRBSU5TX0FOWVwiOlxuICAgICAgICAgICAgcmV0dXJuIFwiYXJyYXktY29udGFpbnMtYW55XCIgLyogQVJSQVlfQ09OVEFJTlNfQU5ZICovO1xuXG4gICAgICAgICAgY2FzZSBcIk9QRVJBVE9SX1VOU1BFQ0lGSUVEXCI6XG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBNKCk7XG4gICAgICAgIH1cbiAgICB9KHQuZmllbGRGaWx0ZXIub3ApLCB0LmZpZWxkRmlsdGVyLnZhbHVlKTtcbn1cblxuZnVuY3Rpb24gZ3ModCkge1xuICAgIHN3aXRjaCAodC51bmFyeUZpbHRlci5vcCkge1xuICAgICAgY2FzZSBcIklTX05BTlwiOlxuICAgICAgICBjb25zdCBlID0gX3ModC51bmFyeUZpbHRlci5maWVsZCk7XG4gICAgICAgIHJldHVybiBIdC5jcmVhdGUoZSwgXCI9PVwiIC8qIEVRVUFMICovICwge1xuICAgICAgICAgICAgZG91YmxlVmFsdWU6IE5hTlxuICAgICAgICB9KTtcblxuICAgICAgY2FzZSBcIklTX05VTExcIjpcbiAgICAgICAgY29uc3QgbiA9IF9zKHQudW5hcnlGaWx0ZXIuZmllbGQpO1xuICAgICAgICByZXR1cm4gSHQuY3JlYXRlKG4sIFwiPT1cIiAvKiBFUVVBTCAqLyAsIHtcbiAgICAgICAgICAgIG51bGxWYWx1ZTogXCJOVUxMX1ZBTFVFXCJcbiAgICAgICAgfSk7XG5cbiAgICAgIGNhc2UgXCJJU19OT1RfTkFOXCI6XG4gICAgICAgIGNvbnN0IHMgPSBfcyh0LnVuYXJ5RmlsdGVyLmZpZWxkKTtcbiAgICAgICAgcmV0dXJuIEh0LmNyZWF0ZShzLCBcIiE9XCIgLyogTk9UX0VRVUFMICovICwge1xuICAgICAgICAgICAgZG91YmxlVmFsdWU6IE5hTlxuICAgICAgICB9KTtcblxuICAgICAgY2FzZSBcIklTX05PVF9OVUxMXCI6XG4gICAgICAgIGNvbnN0IGkgPSBfcyh0LnVuYXJ5RmlsdGVyLmZpZWxkKTtcbiAgICAgICAgcmV0dXJuIEh0LmNyZWF0ZShpLCBcIiE9XCIgLyogTk9UX0VRVUFMICovICwge1xuICAgICAgICAgICAgbnVsbFZhbHVlOiBcIk5VTExfVkFMVUVcIlxuICAgICAgICB9KTtcblxuICAgICAgY2FzZSBcIk9QRVJBVE9SX1VOU1BFQ0lGSUVEXCI6XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gTSgpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24geXModCkge1xuICAgIGNvbnN0IGUgPSBbXTtcbiAgICByZXR1cm4gdC5maWVsZHMuZm9yRWFjaCgodCA9PiBlLnB1c2godC5jYW5vbmljYWxTdHJpbmcoKSkpKSwge1xuICAgICAgICBmaWVsZFBhdGhzOiBlXG4gICAgfTtcbn1cblxuZnVuY3Rpb24gcHModCkge1xuICAgIC8vIFJlc291cmNlIG5hbWVzIGhhdmUgYXQgbGVhc3QgNCBjb21wb25lbnRzIChwcm9qZWN0IElELCBkYXRhYmFzZSBJRClcbiAgICByZXR1cm4gdC5sZW5ndGggPj0gNCAmJiBcInByb2plY3RzXCIgPT09IHQuZ2V0KDApICYmIFwiZGF0YWJhc2VzXCIgPT09IHQuZ2V0KDIpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBFbmNvZGVzIGEgcmVzb3VyY2UgcGF0aCBpbnRvIGEgSW5kZXhlZERiLWNvbXBhdGlibGUgc3RyaW5nIGZvcm0uXG4gKi9cbmZ1bmN0aW9uIEVzKHQpIHtcbiAgICBsZXQgZSA9IFwiXCI7XG4gICAgZm9yIChsZXQgbiA9IDA7IG4gPCB0Lmxlbmd0aDsgbisrKSBlLmxlbmd0aCA+IDAgJiYgKGUgPSBJcyhlKSksIGUgPSBUcyh0LmdldChuKSwgZSk7XG4gICAgcmV0dXJuIElzKGUpO1xufVxuXG4vKiogRW5jb2RlcyBhIHNpbmdsZSBzZWdtZW50IG9mIGEgcmVzb3VyY2UgcGF0aCBpbnRvIHRoZSBnaXZlbiByZXN1bHQgKi8gZnVuY3Rpb24gVHModCwgZSkge1xuICAgIGxldCBuID0gZTtcbiAgICBjb25zdCBzID0gdC5sZW5ndGg7XG4gICAgZm9yIChsZXQgZSA9IDA7IGUgPCBzOyBlKyspIHtcbiAgICAgICAgY29uc3QgcyA9IHQuY2hhckF0KGUpO1xuICAgICAgICBzd2l0Y2ggKHMpIHtcbiAgICAgICAgICBjYXNlIFwiXFwwXCI6XG4gICAgICAgICAgICBuICs9IFwiXHUwMDAxXHUwMDEwXCI7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgXCJcdTAwMDFcIjpcbiAgICAgICAgICAgIG4gKz0gXCJcdTAwMDFcdTAwMTFcIjtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIG4gKz0gcztcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbjtcbn1cblxuLyoqIEVuY29kZXMgYSBwYXRoIHNlcGFyYXRvciBpbnRvIHRoZSBnaXZlbiByZXN1bHQgKi8gZnVuY3Rpb24gSXModCkge1xuICAgIHJldHVybiB0ICsgXCJcdTAwMDFcdTAwMDFcIjtcbn1cblxuLyoqXG4gKiBEZWNvZGVzIHRoZSBnaXZlbiBJbmRleGVkRGItY29tcGF0aWJsZSBzdHJpbmcgZm9ybSBvZiBhIHJlc291cmNlIHBhdGggaW50b1xuICogYSBSZXNvdXJjZVBhdGggaW5zdGFuY2UuIE5vdGUgdGhhdCB0aGlzIG1ldGhvZCBpcyBub3Qgc3VpdGFibGUgZm9yIHVzZSB3aXRoXG4gKiBkZWNvZGluZyByZXNvdXJjZSBuYW1lcyBmcm9tIHRoZSBzZXJ2ZXI7IHRob3NlIGFyZSBPbmUgUGxhdGZvcm0gZm9ybWF0XG4gKiBzdHJpbmdzLlxuICovIGZ1bmN0aW9uIEFzKHQpIHtcbiAgICAvLyBFdmVudCB0aGUgZW1wdHkgcGF0aCBtdXN0IGVuY29kZSBhcyBhIHBhdGggb2YgYXQgbGVhc3QgbGVuZ3RoIDIuIEEgcGF0aFxuICAgIC8vIHdpdGggZXhhY3RseSAyIG11c3QgYmUgdGhlIGVtcHR5IHBhdGguXG4gICAgY29uc3QgZSA9IHQubGVuZ3RoO1xuICAgIGlmIChMKGUgPj0gMiksIDIgPT09IGUpIHJldHVybiBMKFwiXHUwMDAxXCIgPT09IHQuY2hhckF0KDApICYmIFwiXHUwMDAxXCIgPT09IHQuY2hhckF0KDEpKSwgdXQuZW1wdHlQYXRoKCk7XG4gICAgLy8gRXNjYXBlIGNoYXJhY3RlcnMgY2Fubm90IGV4aXN0IHBhc3QgdGhlIHNlY29uZC10by1sYXN0IHBvc2l0aW9uIGluIHRoZVxuICAgIC8vIHNvdXJjZSB2YWx1ZS5cbiAgICAgICAgY29uc3QgbiA9IGUgLSAyLCBzID0gW107XG4gICAgbGV0IGkgPSBcIlwiO1xuICAgIGZvciAobGV0IHIgPSAwOyByIDwgZTsgKSB7XG4gICAgICAgIC8vIFRoZSBsYXN0IHR3byBjaGFyYWN0ZXJzIG9mIGEgdmFsaWQgZW5jb2RlZCBwYXRoIG11c3QgYmUgYSBzZXBhcmF0b3IsIHNvXG4gICAgICAgIC8vIHRoZXJlIG11c3QgYmUgYW4gZW5kIHRvIHRoaXMgc2VnbWVudC5cbiAgICAgICAgY29uc3QgZSA9IHQuaW5kZXhPZihcIlx1MDAwMVwiLCByKTtcbiAgICAgICAgKGUgPCAwIHx8IGUgPiBuKSAmJiBNKCk7XG4gICAgICAgIHN3aXRjaCAodC5jaGFyQXQoZSArIDEpKSB7XG4gICAgICAgICAgY2FzZSBcIlx1MDAwMVwiOlxuICAgICAgICAgICAgY29uc3QgbiA9IHQuc3Vic3RyaW5nKHIsIGUpO1xuICAgICAgICAgICAgbGV0IG87XG4gICAgICAgICAgICAwID09PSBpLmxlbmd0aCA/IFxuICAgICAgICAgICAgLy8gQXZvaWQgY29weWluZyBmb3IgdGhlIGNvbW1vbiBjYXNlIG9mIGEgc2VnbWVudCB0aGF0IGV4Y2x1ZGVzIFxcMFxuICAgICAgICAgICAgLy8gYW5kIFxcMDAxXG4gICAgICAgICAgICBvID0gbiA6IChpICs9IG4sIG8gPSBpLCBpID0gXCJcIiksIHMucHVzaChvKTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSBcIlx1MDAxMFwiOlxuICAgICAgICAgICAgaSArPSB0LnN1YnN0cmluZyhyLCBlKSwgaSArPSBcIlxcMFwiO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBjYXNlIFwiXHUwMDExXCI6XG4gICAgICAgICAgICAvLyBUaGUgZXNjYXBlIGNoYXJhY3RlciBjYW4gYmUgdXNlZCBpbiB0aGUgb3V0cHV0IHRvIGVuY29kZSBpdHNlbGYuXG4gICAgICAgICAgICBpICs9IHQuc3Vic3RyaW5nKHIsIGUgKyAxKTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIE0oKTtcbiAgICAgICAgfVxuICAgICAgICByID0gZSArIDI7XG4gICAgfVxuICAgIHJldHVybiBuZXcgdXQocyk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFNjaGVtYSBWZXJzaW9uIGZvciB0aGUgV2ViIGNsaWVudDpcbiAqIDEuICBJbml0aWFsIHZlcnNpb24gaW5jbHVkaW5nIE11dGF0aW9uIFF1ZXVlLCBRdWVyeSBDYWNoZSwgYW5kIFJlbW90ZVxuICogICAgIERvY3VtZW50IENhY2hlXG4gKiAyLiAgVXNlZCB0byBlbnN1cmUgYSB0YXJnZXRHbG9iYWwgb2JqZWN0IGV4aXN0cyBhbmQgYWRkIHRhcmdldENvdW50IHRvIGl0LiBOb1xuICogICAgIGxvbmdlciByZXF1aXJlZCBiZWNhdXNlIG1pZ3JhdGlvbiAzIHVuY29uZGl0aW9uYWxseSBjbGVhcnMgaXQuXG4gKiAzLiAgRHJvcHBlZCBhbmQgcmUtY3JlYXRlZCBRdWVyeSBDYWNoZSB0byBkZWFsIHdpdGggY2FjaGUgY29ycnVwdGlvbiByZWxhdGVkXG4gKiAgICAgdG8gbGltYm8gcmVzb2x1dGlvbi4gQWRkcmVzc2VzXG4gKiAgICAgaHR0cHM6Ly9naXRodWIuY29tL2ZpcmViYXNlL2ZpcmViYXNlLWlvcy1zZGsvaXNzdWVzLzE1NDhcbiAqIDQuICBNdWx0aS1UYWIgU3VwcG9ydC5cbiAqIDUuICBSZW1vdmFsIG9mIGhlbGQgd3JpdGUgYWNrcy5cbiAqIDYuICBDcmVhdGUgZG9jdW1lbnQgZ2xvYmFsIGZvciB0cmFja2luZyBkb2N1bWVudCBjYWNoZSBzaXplLlxuICogNy4gIEVuc3VyZSBldmVyeSBjYWNoZWQgZG9jdW1lbnQgaGFzIGEgc2VudGluZWwgcm93IHdpdGggYSBzZXF1ZW5jZSBudW1iZXIuXG4gKiA4LiAgQWRkIGNvbGxlY3Rpb24tcGFyZW50IGluZGV4IGZvciBDb2xsZWN0aW9uIEdyb3VwIHF1ZXJpZXMuXG4gKiA5LiAgQ2hhbmdlIFJlbW90ZURvY3VtZW50Q2hhbmdlcyBzdG9yZSB0byBiZSBrZXllZCBieSByZWFkVGltZSByYXRoZXIgdGhhblxuICogICAgIGFuIGF1dG8taW5jcmVtZW50aW5nIElELiBUaGlzIGlzIHJlcXVpcmVkIGZvciBJbmRleC1GcmVlIHF1ZXJpZXMuXG4gKiAxMC4gUmV3cml0ZSB0aGUgY2Fub25pY2FsIElEcyB0byB0aGUgZXhwbGljaXQgUHJvdG9idWYtYmFzZWQgZm9ybWF0LlxuICogMTEuIEFkZCBidW5kbGVzIGFuZCBuYW1lZF9xdWVyaWVzIGZvciBidW5kbGUgc3VwcG9ydC5cbiAqL1xuLyoqXG4gKiBXcmFwcGVyIGNsYXNzIHRvIHN0b3JlIHRpbWVzdGFtcHMgKHNlY29uZHMgYW5kIG5hbm9zKSBpbiBJbmRleGVkRGIgb2JqZWN0cy5cbiAqL1xuY2xhc3MgUnMge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5zZWNvbmRzID0gdCwgdGhpcy5uYW5vc2Vjb25kcyA9IGU7XG4gICAgfVxufVxuXG4vKipcbiAqIEEgc2luZ2xldG9uIG9iamVjdCB0byBiZSBzdG9yZWQgaW4gdGhlICdvd25lcicgc3RvcmUgaW4gSW5kZXhlZERiLlxuICpcbiAqIEEgZ2l2ZW4gZGF0YWJhc2UgY2FuIGhhdmUgYSBzaW5nbGUgcHJpbWFyeSB0YWIgYXNzaWduZWQgYXQgYSBnaXZlbiB0aW1lLiBUaGF0XG4gKiB0YWIgbXVzdCB2YWxpZGF0ZSB0aGF0IGl0IGlzIHN0aWxsIGhvbGRpbmcgdGhlIHByaW1hcnkgbGVhc2UgYmVmb3JlIGV2ZXJ5XG4gKiBvcGVyYXRpb24gdGhhdCByZXF1aXJlcyBsb2NrZWQgYWNjZXNzLiBUaGUgcHJpbWFyeSB0YWIgc2hvdWxkIHJlZ3VsYXJseVxuICogd3JpdGUgYW4gdXBkYXRlZCB0aW1lc3RhbXAgdG8gdGhpcyBsZWFzZSB0byBwcmV2ZW50IG90aGVyIHRhYnMgZnJvbVxuICogXCJzdGVhbGluZ1wiIHRoZSBwcmltYXJ5IGxlYXNlXG4gKi8gY2xhc3MgUHMge1xuICAgIGNvbnN0cnVjdG9yKHQsIFxuICAgIC8qKiBXaGV0aGVyIHRvIGFsbG93IHNoYXJlZCBhY2Nlc3MgZnJvbSBtdWx0aXBsZSB0YWJzLiAqL1xuICAgIGUsIG4pIHtcbiAgICAgICAgdGhpcy5vd25lcklkID0gdCwgdGhpcy5hbGxvd1RhYlN5bmNocm9uaXphdGlvbiA9IGUsIHRoaXMubGVhc2VUaW1lc3RhbXBNcyA9IG47XG4gICAgfVxufVxuXG4vKipcbiAqIE5hbWUgb2YgdGhlIEluZGV4ZWREYiBvYmplY3Qgc3RvcmUuXG4gKlxuICogTm90ZSB0aGF0IHRoZSBuYW1lICdvd25lcicgaXMgY2hvc2VuIHRvIGVuc3VyZSBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eSB3aXRoXG4gKiBvbGRlciBjbGllbnRzIHRoYXQgb25seSBzdXBwb3J0ZWQgc2luZ2xlIGxvY2tlZCBhY2Nlc3MgdG8gdGhlIHBlcnNpc3RlbmNlXG4gKiBsYXllci5cbiAqLyBQcy5zdG9yZSA9IFwib3duZXJcIiwgXG4vKipcbiAqIFRoZSBrZXkgc3RyaW5nIHVzZWQgZm9yIHRoZSBzaW5nbGUgb2JqZWN0IHRoYXQgZXhpc3RzIGluIHRoZVxuICogRGJQcmltYXJ5Q2xpZW50IHN0b3JlLlxuICovXG5Qcy5rZXkgPSBcIm93bmVyXCI7XG5cbi8qKlxuICogQW4gb2JqZWN0IHRvIGJlIHN0b3JlZCBpbiB0aGUgJ211dGF0aW9uUXVldWVzJyBzdG9yZSBpbiBJbmRleGVkRGIuXG4gKlxuICogRWFjaCB1c2VyIGdldHMgYSBzaW5nbGUgcXVldWUgb2YgTXV0YXRpb25CYXRjaGVzIHRvIGFwcGx5IHRvIHRoZSBzZXJ2ZXIuXG4gKiBEYk11dGF0aW9uUXVldWUgdHJhY2tzIHRoZSBtZXRhZGF0YSBhYm91dCB0aGUgcXVldWUuXG4gKi9cbmNsYXNzIGJzIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKipcbiAgICAgKiBUaGUgbm9ybWFsaXplZCB1c2VyIElEIHRvIHdoaWNoIHRoaXMgcXVldWUgYmVsb25ncy5cbiAgICAgKi9cbiAgICB0LCBcbiAgICAvKipcbiAgICAgKiBBbiBpZGVudGlmaWVyIGZvciB0aGUgaGlnaGVzdCBudW1iZXJlZCBiYXRjaCB0aGF0IGhhcyBiZWVuIGFja25vd2xlZGdlZFxuICAgICAqIGJ5IHRoZSBzZXJ2ZXIuIEFsbCBNdXRhdGlvbkJhdGNoZXMgaW4gdGhpcyBxdWV1ZSB3aXRoIGJhdGNoSWRzIGxlc3NcbiAgICAgKiB0aGFuIG9yIGVxdWFsIHRvIHRoaXMgdmFsdWUgYXJlIGNvbnNpZGVyZWQgdG8gaGF2ZSBiZWVuIGFja25vd2xlZGdlZCBieVxuICAgICAqIHRoZSBzZXJ2ZXIuXG4gICAgICpcbiAgICAgKiBOT1RFOiB0aGlzIGlzIGRlcHJlY2F0ZWQgYW5kIG5vIGxvbmdlciB1c2VkIGJ5IHRoZSBjb2RlLlxuICAgICAqL1xuICAgIGUsIFxuICAgIC8qKlxuICAgICAqIEEgc3RyZWFtIHRva2VuIHRoYXQgd2FzIHByZXZpb3VzbHkgc2VudCBieSB0aGUgc2VydmVyLlxuICAgICAqXG4gICAgICogU2VlIFN0cmVhbWluZ1dyaXRlUmVxdWVzdCBpbiBkYXRhc3RvcmUucHJvdG8gZm9yIG1vcmUgZGV0YWlscyBhYm91dFxuICAgICAqIHVzYWdlLlxuICAgICAqXG4gICAgICogQWZ0ZXIgc2VuZGluZyB0aGlzIHRva2VuLCBlYXJsaWVyIHRva2VucyBtYXkgbm90IGJlIHVzZWQgYW55bW9yZSBzb1xuICAgICAqIG9ubHkgYSBzaW5nbGUgc3RyZWFtIHRva2VuIGlzIHJldGFpbmVkLlxuICAgICAqXG4gICAgICogTk9URTogdGhpcyBpcyBkZXByZWNhdGVkIGFuZCBubyBsb25nZXIgdXNlZCBieSB0aGUgY29kZS5cbiAgICAgKi9cbiAgICBuKSB7XG4gICAgICAgIHRoaXMudXNlcklkID0gdCwgdGhpcy5sYXN0QWNrbm93bGVkZ2VkQmF0Y2hJZCA9IGUsIHRoaXMubGFzdFN0cmVhbVRva2VuID0gbjtcbiAgICB9XG59XG5cbi8qKiBOYW1lIG9mIHRoZSBJbmRleGVkRGIgb2JqZWN0IHN0b3JlLiAgKi8gYnMuc3RvcmUgPSBcIm11dGF0aW9uUXVldWVzXCIsIFxuLyoqIEtleXMgYXJlIGF1dG9tYXRpY2FsbHkgYXNzaWduZWQgdmlhIHRoZSB1c2VySWQgcHJvcGVydHkuICovXG5icy5rZXlQYXRoID0gXCJ1c2VySWRcIjtcblxuLyoqXG4gKiBBbiBvYmplY3QgdG8gYmUgc3RvcmVkIGluIHRoZSAnbXV0YXRpb25zJyBzdG9yZSBpbiBJbmRleGVkRGIuXG4gKlxuICogUmVwcmVzZW50cyBhIGJhdGNoIG9mIHVzZXItbGV2ZWwgbXV0YXRpb25zIGludGVuZGVkIHRvIGJlIHNlbnQgdG8gdGhlIHNlcnZlclxuICogaW4gYSBzaW5nbGUgd3JpdGUuIEVhY2ggdXNlci1sZXZlbCBiYXRjaCBnZXRzIGEgc2VwYXJhdGUgRGJNdXRhdGlvbkJhdGNoXG4gKiB3aXRoIGEgbmV3IGJhdGNoSWQuXG4gKi9cbmNsYXNzIHZzIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKipcbiAgICAgKiBUaGUgbm9ybWFsaXplZCB1c2VyIElEIHRvIHdoaWNoIHRoaXMgYmF0Y2ggYmVsb25ncy5cbiAgICAgKi9cbiAgICB0LCBcbiAgICAvKipcbiAgICAgKiBBbiBpZGVudGlmaWVyIGZvciB0aGlzIGJhdGNoLCBhbGxvY2F0ZWQgdXNpbmcgYW4gYXV0by1nZW5lcmF0ZWQga2V5LlxuICAgICAqL1xuICAgIGUsIFxuICAgIC8qKlxuICAgICAqIFRoZSBsb2NhbCB3cml0ZSB0aW1lIG9mIHRoZSBiYXRjaCwgc3RvcmVkIGFzIG1pbGxpc2Vjb25kcyBzaW5jZSB0aGVcbiAgICAgKiBlcG9jaC5cbiAgICAgKi9cbiAgICBuLCBcbiAgICAvKipcbiAgICAgKiBBIGxpc3Qgb2YgXCJtdXRhdGlvbnNcIiB0aGF0IHJlcHJlc2VudCBhIHBhcnRpYWwgYmFzZSBzdGF0ZSBmcm9tIHdoZW4gdGhpc1xuICAgICAqIHdyaXRlIGJhdGNoIHdhcyBpbml0aWFsbHkgY3JlYXRlZC4gRHVyaW5nIGxvY2FsIGFwcGxpY2F0aW9uIG9mIHRoZSB3cml0ZVxuICAgICAqIGJhdGNoLCB0aGVzZSBiYXNlTXV0YXRpb25zIGFyZSBhcHBsaWVkIHByaW9yIHRvIHRoZSByZWFsIHdyaXRlcyBpbiBvcmRlclxuICAgICAqIHRvIG92ZXJyaWRlIGNlcnRhaW4gZG9jdW1lbnQgZmllbGRzIGZyb20gdGhlIHJlbW90ZSBkb2N1bWVudCBjYWNoZS4gVGhpc1xuICAgICAqIGlzIG5lY2Vzc2FyeSBpbiB0aGUgY2FzZSBvZiBub24taWRlbXBvdGVudCB3cml0ZXMgKGUuZy4gYGluY3JlbWVudCgpYFxuICAgICAqIHRyYW5zZm9ybXMpIHRvIG1ha2Ugc3VyZSB0aGF0IHRoZSBsb2NhbCB2aWV3IG9mIHRoZSBtb2RpZmllZCBkb2N1bWVudHNcbiAgICAgKiBkb2Vzbid0IGZsaWNrZXIgaWYgdGhlIHJlbW90ZSBkb2N1bWVudCBjYWNoZSByZWNlaXZlcyB0aGUgcmVzdWx0IG9mIHRoZVxuICAgICAqIG5vbi1pZGVtcG90ZW50IHdyaXRlIGJlZm9yZSB0aGUgd3JpdGUgaXMgcmVtb3ZlZCBmcm9tIHRoZSBxdWV1ZS5cbiAgICAgKlxuICAgICAqIFRoZXNlIG11dGF0aW9ucyBhcmUgbmV2ZXIgc2VudCB0byB0aGUgYmFja2VuZC5cbiAgICAgKi9cbiAgICBzLCBcbiAgICAvKipcbiAgICAgKiBBIGxpc3Qgb2YgbXV0YXRpb25zIHRvIGFwcGx5LiBBbGwgbXV0YXRpb25zIHdpbGwgYmUgYXBwbGllZCBhdG9taWNhbGx5LlxuICAgICAqXG4gICAgICogTXV0YXRpb25zIGFyZSBzZXJpYWxpemVkIHZpYSB0b011dGF0aW9uKCkuXG4gICAgICovXG4gICAgaSkge1xuICAgICAgICB0aGlzLnVzZXJJZCA9IHQsIHRoaXMuYmF0Y2hJZCA9IGUsIHRoaXMubG9jYWxXcml0ZVRpbWVNcyA9IG4sIHRoaXMuYmFzZU11dGF0aW9ucyA9IHMsIFxuICAgICAgICB0aGlzLm11dGF0aW9ucyA9IGk7XG4gICAgfVxufVxuXG4vKiogTmFtZSBvZiB0aGUgSW5kZXhlZERiIG9iamVjdCBzdG9yZS4gICovIHZzLnN0b3JlID0gXCJtdXRhdGlvbnNcIiwgXG4vKiogS2V5cyBhcmUgYXV0b21hdGljYWxseSBhc3NpZ25lZCB2aWEgdGhlIHVzZXJJZCwgYmF0Y2hJZCBwcm9wZXJ0aWVzLiAqL1xudnMua2V5UGF0aCA9IFwiYmF0Y2hJZFwiLCBcbi8qKiBUaGUgaW5kZXggbmFtZSBmb3IgbG9va3VwIG9mIG11dGF0aW9ucyBieSB1c2VyLiAqL1xudnMudXNlck11dGF0aW9uc0luZGV4ID0gXCJ1c2VyTXV0YXRpb25zSW5kZXhcIiwgXG4vKiogVGhlIHVzZXIgbXV0YXRpb25zIGluZGV4IGlzIGtleWVkIGJ5IFt1c2VySWQsIGJhdGNoSWRdIHBhaXJzLiAqL1xudnMudXNlck11dGF0aW9uc0tleVBhdGggPSBbIFwidXNlcklkXCIsIFwiYmF0Y2hJZFwiIF07XG5cbi8qKlxuICogQW4gb2JqZWN0IHRvIGJlIHN0b3JlZCBpbiB0aGUgJ2RvY3VtZW50TXV0YXRpb25zJyBzdG9yZSBpbiBJbmRleGVkRGIuXG4gKlxuICogQSBtYW51YWxseSBtYWludGFpbmVkIGluZGV4IG9mIGFsbCB0aGUgbXV0YXRpb24gYmF0Y2hlcyB0aGF0IGFmZmVjdCBhIGdpdmVuXG4gKiBkb2N1bWVudCBrZXkuIFRoZSByb3dzIGluIHRoaXMgdGFibGUgYXJlIHJlZmVyZW5jZXMgYmFzZWQgb24gdGhlIGNvbnRlbnRzIG9mXG4gKiBEYk11dGF0aW9uQmF0Y2gubXV0YXRpb25zLlxuICovXG5jbGFzcyBWcyB7XG4gICAgY29uc3RydWN0b3IoKSB7fVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBbdXNlcklkXSBrZXkgZm9yIHVzZSBpbiB0aGUgRGJEb2N1bWVudE11dGF0aW9ucyBpbmRleCB0byBpdGVyYXRlXG4gICAgICogb3ZlciBhbGwgb2YgYSB1c2VyJ3MgZG9jdW1lbnQgbXV0YXRpb25zLlxuICAgICAqLyAgICBzdGF0aWMgcHJlZml4Rm9yVXNlcih0KSB7XG4gICAgICAgIHJldHVybiBbIHQgXTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIFt1c2VySWQsIGVuY29kZWRQYXRoXSBrZXkgZm9yIHVzZSBpbiB0aGUgRGJEb2N1bWVudE11dGF0aW9uc1xuICAgICAqIGluZGV4IHRvIGl0ZXJhdGUgb3ZlciBhbGwgYXQgZG9jdW1lbnQgbXV0YXRpb25zIGZvciBhIGdpdmVuIHBhdGggb3IgbG93ZXIuXG4gICAgICovICAgIHN0YXRpYyBwcmVmaXhGb3JQYXRoKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIFsgdCwgRXMoZSkgXTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGZ1bGwgaW5kZXgga2V5IG9mIFt1c2VySWQsIGVuY29kZWRQYXRoLCBiYXRjaElkXSBmb3IgaW5zZXJ0aW5nXG4gICAgICogYW5kIGRlbGV0aW5nIGludG8gdGhlIERiRG9jdW1lbnRNdXRhdGlvbnMgaW5kZXguXG4gICAgICovICAgIHN0YXRpYyBrZXkodCwgZSwgbikge1xuICAgICAgICByZXR1cm4gWyB0LCBFcyhlKSwgbiBdO1xuICAgIH1cbn1cblxuVnMuc3RvcmUgPSBcImRvY3VtZW50TXV0YXRpb25zXCIsIFxuLyoqXG4gKiBCZWNhdXNlIHdlIHN0b3JlIGFsbCB0aGUgdXNlZnVsIGluZm9ybWF0aW9uIGZvciB0aGlzIHN0b3JlIGluIHRoZSBrZXksXG4gKiB0aGVyZSBpcyBubyB1c2VmdWwgaW5mb3JtYXRpb24gdG8gc3RvcmUgYXMgdGhlIHZhbHVlLiBUaGUgcmF3ICh1bmVuY29kZWQpXG4gKiBwYXRoIGNhbm5vdCBiZSBzdG9yZWQgYmVjYXVzZSBJbmRleGVkRGIgZG9lc24ndCBzdG9yZSBwcm90b3R5cGVcbiAqIGluZm9ybWF0aW9uLlxuICovXG5Wcy5QTEFDRUhPTERFUiA9IG5ldyBWcztcblxuLyoqXG4gKiBSZXByZXNlbnRzIHRoZSBrbm93biBhYnNlbmNlIG9mIGEgZG9jdW1lbnQgYXQgYSBwYXJ0aWN1bGFyIHZlcnNpb24uXG4gKiBTdG9yZWQgaW4gSW5kZXhlZERiIGFzIHBhcnQgb2YgYSBEYlJlbW90ZURvY3VtZW50IG9iamVjdC5cbiAqL1xuY2xhc3MgU3Mge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5wYXRoID0gdCwgdGhpcy5yZWFkVGltZSA9IGU7XG4gICAgfVxufVxuXG4vKipcbiAqIFJlcHJlc2VudHMgYSBkb2N1bWVudCB0aGF0IGlzIGtub3duIHRvIGV4aXN0IGJ1dCB3aG9zZSBkYXRhIGlzIHVua25vd24uXG4gKiBTdG9yZWQgaW4gSW5kZXhlZERiIGFzIHBhcnQgb2YgYSBEYlJlbW90ZURvY3VtZW50IG9iamVjdC5cbiAqLyBjbGFzcyBEcyB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLnBhdGggPSB0LCB0aGlzLnZlcnNpb24gPSBlO1xuICAgIH1cbn1cblxuLyoqXG4gKiBBbiBvYmplY3QgdG8gYmUgc3RvcmVkIGluIHRoZSAncmVtb3RlRG9jdW1lbnRzJyBzdG9yZSBpbiBJbmRleGVkRGIuXG4gKiBJdCByZXByZXNlbnRzIGVpdGhlcjpcbiAqXG4gKiAtIEEgY29tcGxldGUgZG9jdW1lbnQuXG4gKiAtIEEgXCJubyBkb2N1bWVudFwiIHJlcHJlc2VudGluZyBhIGRvY3VtZW50IHRoYXQgaXMga25vd24gbm90IHRvIGV4aXN0IChhdFxuICogc29tZSB2ZXJzaW9uKS5cbiAqIC0gQW4gXCJ1bmtub3duIGRvY3VtZW50XCIgcmVwcmVzZW50aW5nIGEgZG9jdW1lbnQgdGhhdCBpcyBrbm93biB0byBleGlzdCAoYXRcbiAqIHNvbWUgdmVyc2lvbikgYnV0IHdob3NlIGNvbnRlbnRzIGFyZSB1bmtub3duLlxuICpcbiAqIE5vdGU6IFRoaXMgaXMgdGhlIHBlcnNpc3RlZCBlcXVpdmFsZW50IG9mIGEgTWF5YmVEb2N1bWVudCBhbmQgY291bGQgcGVyaGFwc1xuICogYmUgbWFkZSBtb3JlIGdlbmVyYWwgaWYgbmVjZXNzYXJ5LlxuICovIGNsYXNzIENzIHtcbiAgICAvLyBUT0RPOiBXZSBhcmUgY3VycmVudGx5IHN0b3JpbmcgZnVsbCBkb2N1bWVudCBrZXlzIGFsbW9zdCB0aHJlZSB0aW1lc1xuICAgIC8vIChvbmNlIGFzIHBhcnQgb2YgdGhlIHByaW1hcnkga2V5LCBvbmNlIC0gcGFydGx5IC0gYXMgYHBhcmVudFBhdGhgIGFuZCBvbmNlXG4gICAgLy8gaW5zaWRlIHRoZSBlbmNvZGVkIGRvY3VtZW50cykuIER1cmluZyBvdXIgbmV4dCBtaWdyYXRpb24sIHdlIHNob3VsZFxuICAgIC8vIHJld3JpdGUgdGhlIHByaW1hcnkga2V5IGFzIHBhcmVudFBhdGggKyBkb2N1bWVudCBJRCB3aGljaCB3b3VsZCBhbGxvdyB1c1xuICAgIC8vIHRvIGRyb3Agb25lIHZhbHVlLlxuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIFNldCB0byBhbiBpbnN0YW5jZSBvZiBEYlVua25vd25Eb2N1bWVudCBpZiB0aGUgZGF0YSBmb3IgYSBkb2N1bWVudCBpc1xuICAgICAqIG5vdCBrbm93biwgYnV0IGl0IGlzIGtub3duIHRoYXQgYSBkb2N1bWVudCBleGlzdHMgYXQgdGhlIHNwZWNpZmllZFxuICAgICAqIHZlcnNpb24gKGUuZy4gaXQgaGFkIGEgc3VjY2Vzc2Z1bCB1cGRhdGUgYXBwbGllZCB0byBpdClcbiAgICAgKi9cbiAgICB0LCBcbiAgICAvKipcbiAgICAgKiBTZXQgdG8gYW4gaW5zdGFuY2Ugb2YgYSBEYk5vRG9jdW1lbnQgaWYgaXQgaXMga25vd24gdGhhdCBubyBkb2N1bWVudFxuICAgICAqIGV4aXN0cy5cbiAgICAgKi9cbiAgICBlLCBcbiAgICAvKipcbiAgICAgKiBTZXQgdG8gYW4gaW5zdGFuY2Ugb2YgYSBEb2N1bWVudCBpZiB0aGVyZSdzIGEgY2FjaGVkIHZlcnNpb24gb2YgdGhlXG4gICAgICogZG9jdW1lbnQuXG4gICAgICovXG4gICAgbiwgXG4gICAgLyoqXG4gICAgICogRG9jdW1lbnRzIHRoYXQgd2VyZSB3cml0dGVuIHRvIHRoZSByZW1vdGUgZG9jdW1lbnQgc3RvcmUgYmFzZWQgb25cbiAgICAgKiBhIHdyaXRlIGFja25vd2xlZGdtZW50IGFyZSBtYXJrZWQgd2l0aCBgaGFzQ29tbWl0dGVkTXV0YXRpb25zYC4gVGhlc2VcbiAgICAgKiBkb2N1bWVudHMgYXJlIHBvdGVudGlhbGx5IGluY29uc2lzdGVudCB3aXRoIHRoZSBiYWNrZW5kJ3MgY29weSBhbmQgdXNlXG4gICAgICogdGhlIHdyaXRlJ3MgY29tbWl0IHZlcnNpb24gYXMgdGhlaXIgZG9jdW1lbnQgdmVyc2lvbi5cbiAgICAgKi9cbiAgICBzLCBcbiAgICAvKipcbiAgICAgKiBXaGVuIHRoZSBkb2N1bWVudCB3YXMgcmVhZCBmcm9tIHRoZSBiYWNrZW5kLiBVbmRlZmluZWQgZm9yIGRhdGEgd3JpdHRlblxuICAgICAqIHByaW9yIHRvIHNjaGVtYSB2ZXJzaW9uIDkuXG4gICAgICovXG4gICAgaSwgXG4gICAgLyoqXG4gICAgICogVGhlIHBhdGggb2YgdGhlIGNvbGxlY3Rpb24gdGhpcyBkb2N1bWVudCBpcyBwYXJ0IG9mLiBVbmRlZmluZWQgZm9yIGRhdGFcbiAgICAgKiB3cml0dGVuIHByaW9yIHRvIHNjaGVtYSB2ZXJzaW9uIDkuXG4gICAgICovXG4gICAgcikge1xuICAgICAgICB0aGlzLnVua25vd25Eb2N1bWVudCA9IHQsIHRoaXMubm9Eb2N1bWVudCA9IGUsIHRoaXMuZG9jdW1lbnQgPSBuLCB0aGlzLmhhc0NvbW1pdHRlZE11dGF0aW9ucyA9IHMsIFxuICAgICAgICB0aGlzLnJlYWRUaW1lID0gaSwgdGhpcy5wYXJlbnRQYXRoID0gcjtcbiAgICB9XG59XG5cbkNzLnN0b3JlID0gXCJyZW1vdGVEb2N1bWVudHNcIiwgXG4vKipcbiAqIEFuIGluZGV4IHRoYXQgcHJvdmlkZXMgYWNjZXNzIHRvIGFsbCBlbnRyaWVzIHNvcnRlZCBieSByZWFkIHRpbWUgKHdoaWNoXG4gKiBjb3JyZXNwb25kcyB0byB0aGUgbGFzdCBtb2RpZmljYXRpb24gdGltZSBvZiBlYWNoIHJvdykuXG4gKlxuICogVGhpcyBpbmRleCBpcyB1c2VkIHRvIHByb3ZpZGUgYSBjaGFuZ2Vsb2cgZm9yIE11bHRpLVRhYi5cbiAqL1xuQ3MucmVhZFRpbWVJbmRleCA9IFwicmVhZFRpbWVJbmRleFwiLCBDcy5yZWFkVGltZUluZGV4UGF0aCA9IFwicmVhZFRpbWVcIiwgXG4vKipcbiAqIEFuIGluZGV4IHRoYXQgcHJvdmlkZXMgYWNjZXNzIHRvIGRvY3VtZW50cyBpbiBhIGNvbGxlY3Rpb24gc29ydGVkIGJ5IHJlYWRcbiAqIHRpbWUuXG4gKlxuICogVGhpcyBpbmRleCBpcyB1c2VkIHRvIGFsbG93IHRoZSBSZW1vdGVEb2N1bWVudENhY2hlIHRvIGZldGNoIG5ld2x5IGNoYW5nZWRcbiAqIGRvY3VtZW50cyBpbiBhIGNvbGxlY3Rpb24uXG4gKi9cbkNzLmNvbGxlY3Rpb25SZWFkVGltZUluZGV4ID0gXCJjb2xsZWN0aW9uUmVhZFRpbWVJbmRleFwiLCBDcy5jb2xsZWN0aW9uUmVhZFRpbWVJbmRleFBhdGggPSBbIFwicGFyZW50UGF0aFwiLCBcInJlYWRUaW1lXCIgXTtcblxuLyoqXG4gKiBDb250YWlucyBhIHNpbmdsZSBlbnRyeSB0aGF0IGhhcyBtZXRhZGF0YSBhYm91dCB0aGUgcmVtb3RlIGRvY3VtZW50IGNhY2hlLlxuICovXG5jbGFzcyBOcyB7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIGJ5dGVTaXplIC0gQXBwcm94aW1hdGVseSB0aGUgdG90YWwgc2l6ZSBpbiBieXRlcyBvZiBhbGwgdGhlXG4gICAgICogZG9jdW1lbnRzIGluIHRoZSBkb2N1bWVudCBjYWNoZS5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMuYnl0ZVNpemUgPSB0O1xuICAgIH1cbn1cblxuTnMuc3RvcmUgPSBcInJlbW90ZURvY3VtZW50R2xvYmFsXCIsIE5zLmtleSA9IFwicmVtb3RlRG9jdW1lbnRHbG9iYWxLZXlcIjtcblxuLyoqXG4gKiBBbiBvYmplY3QgdG8gYmUgc3RvcmVkIGluIHRoZSAndGFyZ2V0cycgc3RvcmUgaW4gSW5kZXhlZERiLlxuICpcbiAqIFRoaXMgaXMgYmFzZWQgb24gYW5kIHNob3VsZCBiZSBrZXB0IGluIHN5bmMgd2l0aCB0aGUgcHJvdG8gdXNlZCBpbiB0aGUgaU9TXG4gKiBjbGllbnQuXG4gKlxuICogRWFjaCBxdWVyeSB0aGUgY2xpZW50IGxpc3RlbnMgdG8gYWdhaW5zdCB0aGUgc2VydmVyIGlzIHRyYWNrZWQgb24gZGlzayBzb1xuICogdGhhdCB0aGUgcXVlcnkgY2FuIGJlIGVmZmljaWVudGx5IHJlc3VtZWQgb24gcmVzdGFydC5cbiAqL1xuY2xhc3MgeHMge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIEFuIGF1dG8tZ2VuZXJhdGVkIHNlcXVlbnRpYWwgbnVtZXJpYyBpZGVudGlmaWVyIGZvciB0aGUgcXVlcnkuXG4gICAgICpcbiAgICAgKiBRdWVyaWVzIGFyZSBzdG9yZWQgdXNpbmcgdGhlaXIgY2Fub25pY2FsSWQgYXMgdGhlIGtleSwgYnV0IHRoZXNlXG4gICAgICogY2Fub25pY2FsSWRzIGNhbiBiZSBxdWl0ZSBsb25nIHNvIHdlIGFkZGl0aW9uYWxseSBhc3NpZ24gYSB1bmlxdWVcbiAgICAgKiBxdWVyeUlkIHdoaWNoIGNhbiBiZSB1c2VkIGJ5IHJlZmVyZW5jZWQgZGF0YSBzdHJ1Y3R1cmVzIChlLmcuXG4gICAgICogaW5kZXhlcykgdG8gbWluaW1pemUgdGhlIG9uLWRpc2sgY29zdC5cbiAgICAgKi9cbiAgICB0LCBcbiAgICAvKipcbiAgICAgKiBUaGUgY2Fub25pY2FsIHN0cmluZyByZXByZXNlbnRpbmcgdGhpcyBxdWVyeS4gVGhpcyBpcyBub3QgdW5pcXVlLlxuICAgICAqL1xuICAgIGUsIFxuICAgIC8qKlxuICAgICAqIFRoZSBsYXN0IHJlYWRUaW1lIHJlY2VpdmVkIGZyb20gdGhlIFdhdGNoIFNlcnZpY2UgZm9yIHRoaXMgcXVlcnkuXG4gICAgICpcbiAgICAgKiBUaGlzIGlzIHRoZSBzYW1lIHZhbHVlIGFzIFRhcmdldENoYW5nZS5yZWFkX3RpbWUgaW4gdGhlIHByb3Rvcy5cbiAgICAgKi9cbiAgICBuLCBcbiAgICAvKipcbiAgICAgKiBBbiBvcGFxdWUsIHNlcnZlci1hc3NpZ25lZCB0b2tlbiB0aGF0IGFsbG93cyB3YXRjaGluZyBhIHF1ZXJ5IHRvIGJlXG4gICAgICogcmVzdW1lZCBhZnRlciBkaXNjb25uZWN0aW5nIHdpdGhvdXQgcmV0cmFuc21pdHRpbmcgYWxsIHRoZSBkYXRhXG4gICAgICogdGhhdCBtYXRjaGVzIHRoZSBxdWVyeS4gVGhlIHJlc3VtZSB0b2tlbiBlc3NlbnRpYWxseSBpZGVudGlmaWVzIGFcbiAgICAgKiBwb2ludCBpbiB0aW1lIGZyb20gd2hpY2ggdGhlIHNlcnZlciBzaG91bGQgcmVzdW1lIHNlbmRpbmcgcmVzdWx0cy5cbiAgICAgKlxuICAgICAqIFRoaXMgaXMgcmVsYXRlZCB0byB0aGUgc25hcHNob3RWZXJzaW9uIGluIHRoYXQgdGhlIHJlc3VtZVRva2VuXG4gICAgICogZWZmZWN0aXZlbHkgYWxzbyBlbmNvZGVzIHRoYXQgdmFsdWUsIGJ1dCB0aGUgcmVzdW1lVG9rZW4gaXMgb3BhcXVlXG4gICAgICogYW5kIHNvbWV0aW1lcyBlbmNvZGVzIGFkZGl0aW9uYWwgaW5mb3JtYXRpb24uXG4gICAgICpcbiAgICAgKiBBIGNvbnNlcXVlbmNlIG9mIHRoaXMgaXMgdGhhdCB0aGUgcmVzdW1lVG9rZW4gc2hvdWxkIGJlIHVzZWQgd2hlblxuICAgICAqIGFza2luZyB0aGUgc2VydmVyIHRvIHJlYXNvbiBhYm91dCB3aGVyZSB0aGlzIGNsaWVudCBpcyBpbiB0aGUgd2F0Y2hcbiAgICAgKiBzdHJlYW0sIGJ1dCB0aGUgY2xpZW50IHNob3VsZCB1c2UgdGhlIHNuYXBzaG90VmVyc2lvbiBmb3IgaXRzIG93blxuICAgICAqIHB1cnBvc2VzLlxuICAgICAqXG4gICAgICogVGhpcyBpcyB0aGUgc2FtZSB2YWx1ZSBhcyBUYXJnZXRDaGFuZ2UucmVzdW1lX3Rva2VuIGluIHRoZSBwcm90b3MuXG4gICAgICovXG4gICAgcywgXG4gICAgLyoqXG4gICAgICogQSBzZXF1ZW5jZSBudW1iZXIgcmVwcmVzZW50aW5nIHRoZSBsYXN0IHRpbWUgdGhpcyBxdWVyeSB3YXNcbiAgICAgKiBsaXN0ZW5lZCB0bywgdXNlZCBmb3IgZ2FyYmFnZSBjb2xsZWN0aW9uIHB1cnBvc2VzLlxuICAgICAqXG4gICAgICogQ29udmVudGlvbmFsbHkgdGhpcyB3b3VsZCBiZSBhIHRpbWVzdGFtcCB2YWx1ZSwgYnV0IGRldmljZS1sb2NhbFxuICAgICAqIGNsb2NrcyBhcmUgdW5yZWxpYWJsZSBhbmQgdGhleSBtdXN0IGJlIGFibGUgdG8gY3JlYXRlIG5ldyBsaXN0ZW5zXG4gICAgICogZXZlbiB3aGlsZSBkaXNjb25uZWN0ZWQuIEluc3RlYWQgdGhpcyBzaG91bGQgYmUgYSBtb25vdG9uaWNhbGx5XG4gICAgICogaW5jcmVhc2luZyBudW1iZXIgdGhhdCdzIGluY3JlbWVudGVkIG9uIGVhY2ggbGlzdGVuIGNhbGwuXG4gICAgICpcbiAgICAgKiBUaGlzIGlzIGRpZmZlcmVudCBmcm9tIHRoZSBxdWVyeUlkIHNpbmNlIHRoZSBxdWVyeUlkIGlzIGFuXG4gICAgICogaW1tdXRhYmxlIGlkZW50aWZpZXIgYXNzaWduZWQgdG8gdGhlIFF1ZXJ5IG9uIGZpcnN0IHVzZSB3aGlsZVxuICAgICAqIGxhc3RMaXN0ZW5TZXF1ZW5jZU51bWJlciBpcyB1cGRhdGVkIGV2ZXJ5IHRpbWUgdGhlIHF1ZXJ5IGlzXG4gICAgICogbGlzdGVuZWQgdG8uXG4gICAgICovXG4gICAgaSwgXG4gICAgLyoqXG4gICAgICogRGVub3RlcyB0aGUgbWF4aW11bSBzbmFwc2hvdCB2ZXJzaW9uIGF0IHdoaWNoIHRoZSBhc3NvY2lhdGVkIHF1ZXJ5IHZpZXdcbiAgICAgKiBjb250YWluZWQgbm8gbGltYm8gZG9jdW1lbnRzLiAgVW5kZWZpbmVkIGZvciBkYXRhIHdyaXR0ZW4gcHJpb3IgdG9cbiAgICAgKiBzY2hlbWEgdmVyc2lvbiA5LlxuICAgICAqL1xuICAgIHIsIFxuICAgIC8qKlxuICAgICAqIFRoZSBxdWVyeSBmb3IgdGhpcyB0YXJnZXQuXG4gICAgICpcbiAgICAgKiBCZWNhdXNlIGNhbm9uaWNhbCBpZHMgYXJlIG5vdCB1bmlxdWUgd2UgbXVzdCBzdG9yZSB0aGUgYWN0dWFsIHF1ZXJ5LiBXZVxuICAgICAqIHVzZSB0aGUgcHJvdG8gdG8gaGF2ZSBhbiBvYmplY3Qgd2UgY2FuIHBlcnNpc3Qgd2l0aG91dCBoYXZpbmcgdG9cbiAgICAgKiBkdXBsaWNhdGUgdHJhbnNsYXRpb24gbG9naWMgdG8gYW5kIGZyb20gYSBgUXVlcnlgIG9iamVjdC5cbiAgICAgKi9cbiAgICBvKSB7XG4gICAgICAgIHRoaXMudGFyZ2V0SWQgPSB0LCB0aGlzLmNhbm9uaWNhbElkID0gZSwgdGhpcy5yZWFkVGltZSA9IG4sIHRoaXMucmVzdW1lVG9rZW4gPSBzLCBcbiAgICAgICAgdGhpcy5sYXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIgPSBpLCB0aGlzLmxhc3RMaW1ib0ZyZWVTbmFwc2hvdFZlcnNpb24gPSByLCB0aGlzLnF1ZXJ5ID0gbztcbiAgICB9XG59XG5cbnhzLnN0b3JlID0gXCJ0YXJnZXRzXCIsIFxuLyoqIEtleXMgYXJlIGF1dG9tYXRpY2FsbHkgYXNzaWduZWQgdmlhIHRoZSB0YXJnZXRJZCBwcm9wZXJ0eS4gKi9cbnhzLmtleVBhdGggPSBcInRhcmdldElkXCIsIFxuLyoqIFRoZSBuYW1lIG9mIHRoZSBxdWVyeVRhcmdldHMgaW5kZXguICovXG54cy5xdWVyeVRhcmdldHNJbmRleE5hbWUgPSBcInF1ZXJ5VGFyZ2V0c0luZGV4XCIsIFxuLyoqXG4gKiBUaGUgaW5kZXggb2YgYWxsIGNhbm9uaWNhbElkcyB0byB0aGUgdGFyZ2V0cyB0aGF0IHRoZXkgbWF0Y2guIFRoaXMgaXMgbm90XG4gKiBhIHVuaXF1ZSBtYXBwaW5nIGJlY2F1c2UgY2Fub25pY2FsSWQgZG9lcyBub3QgcHJvbWlzZSBhIHVuaXF1ZSBuYW1lIGZvciBhbGxcbiAqIHBvc3NpYmxlIHF1ZXJpZXMsIHNvIHdlIGFwcGVuZCB0aGUgdGFyZ2V0SWQgdG8gbWFrZSB0aGUgbWFwcGluZyB1bmlxdWUuXG4gKi9cbnhzLnF1ZXJ5VGFyZ2V0c0tleVBhdGggPSBbIFwiY2Fub25pY2FsSWRcIiwgXCJ0YXJnZXRJZFwiIF07XG5cbi8qKlxuICogQW4gb2JqZWN0IHJlcHJlc2VudGluZyBhbiBhc3NvY2lhdGlvbiBiZXR3ZWVuIGEgdGFyZ2V0IGFuZCBhIGRvY3VtZW50LCBvciBhXG4gKiBzZW50aW5lbCByb3cgbWFya2luZyB0aGUgbGFzdCBzZXF1ZW5jZSBudW1iZXIgYXQgd2hpY2ggYSBkb2N1bWVudCB3YXMgdXNlZC5cbiAqIEVhY2ggZG9jdW1lbnQgY2FjaGVkIG11c3QgaGF2ZSBhIGNvcnJlc3BvbmRpbmcgc2VudGluZWwgcm93IGJlZm9yZSBscnVcbiAqIGdhcmJhZ2UgY29sbGVjdGlvbiBpcyBlbmFibGVkLlxuICpcbiAqIFRoZSB0YXJnZXQgYXNzb2NpYXRpb25zIGFuZCBzZW50aW5lbCByb3dzIGFyZSBjby1sb2NhdGVkIHNvIHRoYXQgb3JwaGFuZWRcbiAqIGRvY3VtZW50cyBhbmQgdGhlaXIgc2VxdWVuY2UgbnVtYmVycyBjYW4gYmUgaWRlbnRpZmllZCBlZmZpY2llbnRseSB2aWEgYSBzY2FuXG4gKiBvZiB0aGlzIHN0b3JlLlxuICovXG5jbGFzcyBrcyB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgLyoqXG4gICAgICogVGhlIHRhcmdldElkIGlkZW50aWZ5aW5nIGEgdGFyZ2V0IG9yIDAgZm9yIGEgc2VudGluZWwgcm93LlxuICAgICAqL1xuICAgIHQsIFxuICAgIC8qKlxuICAgICAqIFRoZSBwYXRoIHRvIHRoZSBkb2N1bWVudCwgYXMgZW5jb2RlZCBpbiB0aGUga2V5LlxuICAgICAqL1xuICAgIGUsIFxuICAgIC8qKlxuICAgICAqIElmIHRoaXMgaXMgYSBzZW50aW5lbCByb3csIHRoaXMgc2hvdWxkIGJlIHRoZSBzZXF1ZW5jZSBudW1iZXIgb2YgdGhlIGxhc3RcbiAgICAgKiB0aW1lIHRoZSBkb2N1bWVudCBzcGVjaWZpZWQgYnkgYHBhdGhgIHdhcyB1c2VkLiBPdGhlcndpc2UsIGl0IHNob3VsZCBiZVxuICAgICAqIGB1bmRlZmluZWRgLlxuICAgICAqL1xuICAgIG4pIHtcbiAgICAgICAgdGhpcy50YXJnZXRJZCA9IHQsIHRoaXMucGF0aCA9IGUsIHRoaXMuc2VxdWVuY2VOdW1iZXIgPSBuO1xuICAgIH1cbn1cblxuLyoqIE5hbWUgb2YgdGhlIEluZGV4ZWREYiBvYmplY3Qgc3RvcmUuICAqLyBrcy5zdG9yZSA9IFwidGFyZ2V0RG9jdW1lbnRzXCIsIFxuLyoqIEtleXMgYXJlIGF1dG9tYXRpY2FsbHkgYXNzaWduZWQgdmlhIHRoZSB0YXJnZXRJZCwgcGF0aCBwcm9wZXJ0aWVzLiAqL1xua3Mua2V5UGF0aCA9IFsgXCJ0YXJnZXRJZFwiLCBcInBhdGhcIiBdLCBcbi8qKiBUaGUgaW5kZXggbmFtZSBmb3IgdGhlIHJldmVyc2UgaW5kZXguICovXG5rcy5kb2N1bWVudFRhcmdldHNJbmRleCA9IFwiZG9jdW1lbnRUYXJnZXRzSW5kZXhcIiwgXG4vKiogV2UgYWxzbyBuZWVkIHRvIGNyZWF0ZSB0aGUgcmV2ZXJzZSBpbmRleCBmb3IgdGhlc2UgcHJvcGVydGllcy4gKi9cbmtzLmRvY3VtZW50VGFyZ2V0c0tleVBhdGggPSBbIFwicGF0aFwiLCBcInRhcmdldElkXCIgXTtcblxuLyoqXG4gKiBBIHJlY29yZCBvZiBnbG9iYWwgc3RhdGUgdHJhY2tlZCBhY3Jvc3MgYWxsIFRhcmdldHMsIHRyYWNrZWQgc2VwYXJhdGVseVxuICogdG8gYXZvaWQgdGhlIG5lZWQgZm9yIGV4dHJhIGluZGV4ZXMuXG4gKlxuICogVGhpcyBzaG91bGQgYmUga2VwdCBpbi1zeW5jIHdpdGggdGhlIHByb3RvIHVzZWQgaW4gdGhlIGlPUyBjbGllbnQuXG4gKi9cbmNsYXNzICRzIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKipcbiAgICAgKiBUaGUgaGlnaGVzdCBudW1iZXJlZCB0YXJnZXQgaWQgYWNyb3NzIGFsbCB0YXJnZXRzLlxuICAgICAqXG4gICAgICogU2VlIERiVGFyZ2V0LnRhcmdldElkLlxuICAgICAqL1xuICAgIHQsIFxuICAgIC8qKlxuICAgICAqIFRoZSBoaWdoZXN0IG51bWJlcmVkIGxhc3RMaXN0ZW5TZXF1ZW5jZU51bWJlciBhY3Jvc3MgYWxsIHRhcmdldHMuXG4gICAgICpcbiAgICAgKiBTZWUgRGJUYXJnZXQubGFzdExpc3RlblNlcXVlbmNlTnVtYmVyLlxuICAgICAqL1xuICAgIGUsIFxuICAgIC8qKlxuICAgICAqIEEgZ2xvYmFsIHNuYXBzaG90IHZlcnNpb24gcmVwcmVzZW50aW5nIHRoZSBsYXN0IGNvbnNpc3RlbnQgc25hcHNob3Qgd2VcbiAgICAgKiByZWNlaXZlZCBmcm9tIHRoZSBiYWNrZW5kLiBUaGlzIGlzIG1vbm90b25pY2FsbHkgaW5jcmVhc2luZyBhbmQgYW55XG4gICAgICogc25hcHNob3RzIHJlY2VpdmVkIGZyb20gdGhlIGJhY2tlbmQgcHJpb3IgdG8gdGhpcyB2ZXJzaW9uIChlLmcuIGZvclxuICAgICAqIHRhcmdldHMgcmVzdW1lZCB3aXRoIGEgcmVzdW1lVG9rZW4pIHNob3VsZCBiZSBzdXBwcmVzc2VkIChidWZmZXJlZClcbiAgICAgKiB1bnRpbCB0aGUgYmFja2VuZCBoYXMgY2F1Z2h0IHVwIHRvIHRoaXMgc25hcHNob3QgdmVyc2lvbiBhZ2Fpbi4gVGhpc1xuICAgICAqIHByZXZlbnRzIG91ciBjYWNoZSBmcm9tIGV2ZXIgZ29pbmcgYmFja3dhcmRzIGluIHRpbWUuXG4gICAgICovXG4gICAgbiwgXG4gICAgLyoqXG4gICAgICogVGhlIG51bWJlciBvZiB0YXJnZXRzIHBlcnNpc3RlZC5cbiAgICAgKi9cbiAgICBzKSB7XG4gICAgICAgIHRoaXMuaGlnaGVzdFRhcmdldElkID0gdCwgdGhpcy5oaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIgPSBlLCB0aGlzLmxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24gPSBuLCBcbiAgICAgICAgdGhpcy50YXJnZXRDb3VudCA9IHM7XG4gICAgfVxufVxuXG4vKipcbiAqIFRoZSBrZXkgc3RyaW5nIHVzZWQgZm9yIHRoZSBzaW5nbGUgb2JqZWN0IHRoYXQgZXhpc3RzIGluIHRoZVxuICogRGJUYXJnZXRHbG9iYWwgc3RvcmUuXG4gKi8gJHMua2V5ID0gXCJ0YXJnZXRHbG9iYWxLZXlcIiwgJHMuc3RvcmUgPSBcInRhcmdldEdsb2JhbFwiO1xuXG4vKipcbiAqIEFuIG9iamVjdCByZXByZXNlbnRpbmcgYW4gYXNzb2NpYXRpb24gYmV0d2VlbiBhIENvbGxlY3Rpb24gaWQgKGUuZy4gJ21lc3NhZ2VzJylcbiAqIHRvIGEgcGFyZW50IHBhdGggKGUuZy4gJy9jaGF0cy8xMjMnKSB0aGF0IGNvbnRhaW5zIGl0IGFzIGEgKHN1Yiljb2xsZWN0aW9uLlxuICogVGhpcyBpcyB1c2VkIHRvIGVmZmljaWVudGx5IGZpbmQgYWxsIGNvbGxlY3Rpb25zIHRvIHF1ZXJ5IHdoZW4gcGVyZm9ybWluZ1xuICogYSBDb2xsZWN0aW9uIEdyb3VwIHF1ZXJ5LlxuICovXG5jbGFzcyBPcyB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgLyoqXG4gICAgICogVGhlIGNvbGxlY3Rpb25JZCAoZS5nLiAnbWVzc2FnZXMnKVxuICAgICAqL1xuICAgIHQsIFxuICAgIC8qKlxuICAgICAqIFRoZSBwYXRoIHRvIHRoZSBwYXJlbnQgKGVpdGhlciBhIGRvY3VtZW50IGxvY2F0aW9uIG9yIGFuIGVtcHR5IHBhdGggZm9yXG4gICAgICogYSByb290LWxldmVsIGNvbGxlY3Rpb24pLlxuICAgICAqL1xuICAgIGUpIHtcbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uSWQgPSB0LCB0aGlzLnBhcmVudCA9IGU7XG4gICAgfVxufVxuXG4vKiogTmFtZSBvZiB0aGUgSW5kZXhlZERiIG9iamVjdCBzdG9yZS4gKi8gT3Muc3RvcmUgPSBcImNvbGxlY3Rpb25QYXJlbnRzXCIsIFxuLyoqIEtleXMgYXJlIGF1dG9tYXRpY2FsbHkgYXNzaWduZWQgdmlhIHRoZSBjb2xsZWN0aW9uSWQsIHBhcmVudCBwcm9wZXJ0aWVzLiAqL1xuT3Mua2V5UGF0aCA9IFsgXCJjb2xsZWN0aW9uSWRcIiwgXCJwYXJlbnRcIiBdO1xuXG4vKipcbiAqIEEgcmVjb3JkIG9mIHRoZSBtZXRhZGF0YSBzdGF0ZSBvZiBlYWNoIGNsaWVudC5cbiAqXG4gKiBQT1JUSU5HIE5PVEU6IFRoaXMgaXMgdXNlZCB0byBzeW5jaHJvbml6ZSBtdWx0aS10YWIgc3RhdGUgYW5kIGRvZXMgbm90IG5lZWRcbiAqIHRvIGJlIHBvcnRlZCB0byBpT1Mgb3IgQW5kcm9pZC5cbiAqL1xuY2xhc3MgRnMge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8vIE5vdGU6IFByZXZpb3VzIHNjaGVtYSB2ZXJzaW9ucyBpbmNsdWRlZCBhIGZpZWxkXG4gICAgLy8gXCJsYXN0UHJvY2Vzc2VkRG9jdW1lbnRDaGFuZ2VJZFwiLiBEb24ndCB1c2UgYW55bW9yZS5cbiAgICAvKiogVGhlIGF1dG8tZ2VuZXJhdGVkIGNsaWVudCBpZCBhc3NpZ25lZCBhdCBjbGllbnQgc3RhcnR1cC4gKi9cbiAgICB0LCBcbiAgICAvKiogVGhlIGxhc3QgdGltZSB0aGlzIHN0YXRlIHdhcyB1cGRhdGVkLiAqL1xuICAgIGUsIFxuICAgIC8qKiBXaGV0aGVyIHRoZSBjbGllbnQncyBuZXR3b3JrIGNvbm5lY3Rpb24gaXMgZW5hYmxlZC4gKi9cbiAgICBuLCBcbiAgICAvKiogV2hldGhlciB0aGlzIGNsaWVudCBpcyBydW5uaW5nIGluIGEgZm9yZWdyb3VuZCB0YWIuICovXG4gICAgcykge1xuICAgICAgICB0aGlzLmNsaWVudElkID0gdCwgdGhpcy51cGRhdGVUaW1lTXMgPSBlLCB0aGlzLm5ldHdvcmtFbmFibGVkID0gbiwgdGhpcy5pbkZvcmVncm91bmQgPSBzO1xuICAgIH1cbn1cblxuLyoqIE5hbWUgb2YgdGhlIEluZGV4ZWREYiBvYmplY3Qgc3RvcmUuICovIEZzLnN0b3JlID0gXCJjbGllbnRNZXRhZGF0YVwiLCBcbi8qKiBLZXlzIGFyZSBhdXRvbWF0aWNhbGx5IGFzc2lnbmVkIHZpYSB0aGUgY2xpZW50SWQgcHJvcGVydGllcy4gKi9cbkZzLmtleVBhdGggPSBcImNsaWVudElkXCI7XG5cbi8qKlxuICogQSBvYmplY3QgcmVwcmVzZW50aW5nIGEgYnVuZGxlIGxvYWRlZCBieSB0aGUgU0RLLlxuICovXG5jbGFzcyBNcyB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgLyoqIFRoZSBJRCBvZiB0aGUgbG9hZGVkIGJ1bmRsZS4gKi9cbiAgICB0LCBcbiAgICAvKiogVGhlIGNyZWF0ZSB0aW1lIG9mIHRoZSBsb2FkZWQgYnVuZGxlLiAqL1xuICAgIGUsIFxuICAgIC8qKiBUaGUgc2NoZW1hIHZlcnNpb24gb2YgdGhlIGxvYWRlZCBidW5kbGUuICovXG4gICAgbikge1xuICAgICAgICB0aGlzLmJ1bmRsZUlkID0gdCwgdGhpcy5jcmVhdGVUaW1lID0gZSwgdGhpcy52ZXJzaW9uID0gbjtcbiAgICB9XG59XG5cbi8qKiBOYW1lIG9mIHRoZSBJbmRleGVkRGIgb2JqZWN0IHN0b3JlLiAqLyBNcy5zdG9yZSA9IFwiYnVuZGxlc1wiLCBNcy5rZXlQYXRoID0gXCJidW5kbGVJZFwiO1xuXG4vKipcbiAqIEEgb2JqZWN0IHJlcHJlc2VudGluZyBhIG5hbWVkIHF1ZXJ5IGxvYWRlZCBieSB0aGUgU0RLIHZpYSBhIGJ1bmRsZS5cbiAqL1xuY2xhc3MgTHMge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKiBUaGUgbmFtZSBvZiB0aGUgcXVlcnkuICovXG4gICAgdCwgXG4gICAgLyoqIFRoZSByZWFkIHRpbWUgb2YgdGhlIHJlc3VsdHMgc2F2ZWQgaW4gdGhlIGJ1bmRsZSBmcm9tIHRoZSBuYW1lZCBxdWVyeS4gKi9cbiAgICBlLCBcbiAgICAvKiogVGhlIHF1ZXJ5IHNhdmVkIGluIHRoZSBidW5kbGUuICovXG4gICAgbikge1xuICAgICAgICB0aGlzLm5hbWUgPSB0LCB0aGlzLnJlYWRUaW1lID0gZSwgdGhpcy5idW5kbGVkUXVlcnkgPSBuO1xuICAgIH1cbn1cblxuLyoqIE5hbWUgb2YgdGhlIEluZGV4ZWREYiBvYmplY3Qgc3RvcmUuICovIExzLnN0b3JlID0gXCJuYW1lZFF1ZXJpZXNcIiwgTHMua2V5UGF0aCA9IFwibmFtZVwiO1xuXG4vLyBWaXNpYmxlIGZvciB0ZXN0aW5nXG5jb25zdCBCcyA9IFsgLi4uWyAuLi5bIC4uLlsgLi4uWyBicy5zdG9yZSwgdnMuc3RvcmUsIFZzLnN0b3JlLCBDcy5zdG9yZSwgeHMuc3RvcmUsIFBzLnN0b3JlLCAkcy5zdG9yZSwga3Muc3RvcmUgXSwgRnMuc3RvcmUgXSwgTnMuc3RvcmUgXSwgT3Muc3RvcmUgXSwgTXMuc3RvcmUsIExzLnN0b3JlIF0sIFVzID0gXCJUaGUgY3VycmVudCB0YWIgaXMgbm90IGluIHRoZSByZXF1aXJlZCBzdGF0ZSB0byBwZXJmb3JtIHRoaXMgb3BlcmF0aW9uLiBJdCBtaWdodCBiZSBuZWNlc3NhcnkgdG8gcmVmcmVzaCB0aGUgYnJvd3NlciB0YWIuXCI7XG5cbi8vIFYyIGlzIG5vIGxvbmdlciB1c2FibGUgKHNlZSBjb21tZW50IGF0IHRvcCBvZiBmaWxlKVxuLy8gVmlzaWJsZSBmb3IgdGVzdGluZ1xuLyoqXG4gKiBBIGJhc2UgY2xhc3MgcmVwcmVzZW50aW5nIGEgcGVyc2lzdGVuY2UgdHJhbnNhY3Rpb24sIGVuY2Fwc3VsYXRpbmcgYm90aCB0aGVcbiAqIHRyYW5zYWN0aW9uJ3Mgc2VxdWVuY2UgbnVtYmVycyBhcyB3ZWxsIGFzIGEgbGlzdCBvZiBvbkNvbW1pdHRlZCBsaXN0ZW5lcnMuXG4gKlxuICogV2hlbiB5b3UgY2FsbCBQZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbigpLCBpdCB3aWxsIGNyZWF0ZSBhIHRyYW5zYWN0aW9uIGFuZFxuICogcGFzcyBpdCB0byB5b3VyIGNhbGxiYWNrLiBZb3UgdGhlbiBwYXNzIGl0IHRvIGFueSBtZXRob2QgdGhhdCBvcGVyYXRlc1xuICogb24gcGVyc2lzdGVuY2UuXG4gKi9cbmNsYXNzIHFzIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5vbkNvbW1pdHRlZExpc3RlbmVycyA9IFtdO1xuICAgIH1cbiAgICBhZGRPbkNvbW1pdHRlZExpc3RlbmVyKHQpIHtcbiAgICAgICAgdGhpcy5vbkNvbW1pdHRlZExpc3RlbmVycy5wdXNoKHQpO1xuICAgIH1cbiAgICByYWlzZU9uQ29tbWl0dGVkRXZlbnQoKSB7XG4gICAgICAgIHRoaXMub25Db21taXR0ZWRMaXN0ZW5lcnMuZm9yRWFjaCgodCA9PiB0KCkpKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFBlcnNpc3RlbmNlUHJvbWlzZSBpcyBlc3NlbnRpYWxseSBhIHJlLWltcGxlbWVudGF0aW9uIG9mIFByb21pc2UgZXhjZXB0XG4gKiBpdCBoYXMgYSAubmV4dCgpIG1ldGhvZCBpbnN0ZWFkIG9mIC50aGVuKCkgYW5kIC5uZXh0KCkgYW5kIC5jYXRjaCgpIGNhbGxiYWNrc1xuICogYXJlIGV4ZWN1dGVkIHN5bmNocm9ub3VzbHkgd2hlbiBhIFBlcnNpc3RlbmNlUHJvbWlzZSByZXNvbHZlcyByYXRoZXIgdGhhblxuICogYXN5bmNocm9ub3VzbHkgKFByb21pc2UgaW1wbGVtZW50YXRpb25zIHVzZSBzZXRJbW1lZGlhdGUoKSBvciBzaW1pbGFyKS5cbiAqXG4gKiBUaGlzIGlzIG5lY2Vzc2FyeSB0byBpbnRlcm9wZXJhdGUgd2l0aCBJbmRleGVkREIgd2hpY2ggd2lsbCBhdXRvbWF0aWNhbGx5XG4gKiBjb21taXQgdHJhbnNhY3Rpb25zIGlmIGNvbnRyb2wgaXMgcmV0dXJuZWQgdG8gdGhlIGV2ZW50IGxvb3Agd2l0aG91dFxuICogc3luY2hyb25vdXNseSBpbml0aWF0aW5nIGFub3RoZXIgb3BlcmF0aW9uIG9uIHRoZSB0cmFuc2FjdGlvbi5cbiAqXG4gKiBOT1RFOiAudGhlbigpIGFuZCAuY2F0Y2goKSBvbmx5IGFsbG93IGEgc2luZ2xlIGNvbnN1bWVyLCB1bmxpa2Ugbm9ybWFsXG4gKiBQcm9taXNlcy5cbiAqLyBjbGFzcyBLcyB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICAvLyBOT1RFOiBuZXh0L2NhdGNoQ2FsbGJhY2sgd2lsbCBhbHdheXMgcG9pbnQgdG8gb3VyIG93biB3cmFwcGVyIGZ1bmN0aW9ucyxcbiAgICAgICAgLy8gbm90IHRoZSB1c2VyJ3MgcmF3IG5leHQoKSBvciBjYXRjaCgpIGNhbGxiYWNrcy5cbiAgICAgICAgdGhpcy5uZXh0Q2FsbGJhY2sgPSBudWxsLCB0aGlzLmNhdGNoQ2FsbGJhY2sgPSBudWxsLCBcbiAgICAgICAgLy8gV2hlbiB0aGUgb3BlcmF0aW9uIHJlc29sdmVzLCB3ZSdsbCBzZXQgcmVzdWx0IG9yIGVycm9yIGFuZCBtYXJrIGlzRG9uZS5cbiAgICAgICAgdGhpcy5yZXN1bHQgPSB2b2lkIDAsIHRoaXMuZXJyb3IgPSB2b2lkIDAsIHRoaXMuaXNEb25lID0gITEsIFxuICAgICAgICAvLyBTZXQgdG8gdHJ1ZSB3aGVuIC50aGVuKCkgb3IgLmNhdGNoKCkgYXJlIGNhbGxlZCBhbmQgcHJldmVudHMgYWRkaXRpb25hbFxuICAgICAgICAvLyBjaGFpbmluZy5cbiAgICAgICAgdGhpcy5jYWxsYmFja0F0dGFjaGVkID0gITEsIHQoKHQgPT4ge1xuICAgICAgICAgICAgdGhpcy5pc0RvbmUgPSAhMCwgdGhpcy5yZXN1bHQgPSB0LCB0aGlzLm5leHRDYWxsYmFjayAmJiBcbiAgICAgICAgICAgIC8vIHZhbHVlIHNob3VsZCBiZSBkZWZpbmVkIHVubGVzcyBUIGlzIFZvaWQsIGJ1dCB3ZSBjYW4ndCBleHByZXNzXG4gICAgICAgICAgICAvLyB0aGF0IGluIHRoZSB0eXBlIHN5c3RlbS5cbiAgICAgICAgICAgIHRoaXMubmV4dENhbGxiYWNrKHQpO1xuICAgICAgICB9KSwgKHQgPT4ge1xuICAgICAgICAgICAgdGhpcy5pc0RvbmUgPSAhMCwgdGhpcy5lcnJvciA9IHQsIHRoaXMuY2F0Y2hDYWxsYmFjayAmJiB0aGlzLmNhdGNoQ2FsbGJhY2sodCk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgY2F0Y2godCkge1xuICAgICAgICByZXR1cm4gdGhpcy5uZXh0KHZvaWQgMCwgdCk7XG4gICAgfVxuICAgIG5leHQodCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5jYWxsYmFja0F0dGFjaGVkICYmIE0oKSwgdGhpcy5jYWxsYmFja0F0dGFjaGVkID0gITAsIHRoaXMuaXNEb25lID8gdGhpcy5lcnJvciA/IHRoaXMud3JhcEZhaWx1cmUoZSwgdGhpcy5lcnJvcikgOiB0aGlzLndyYXBTdWNjZXNzKHQsIHRoaXMucmVzdWx0KSA6IG5ldyBLcygoKG4sIHMpID0+IHtcbiAgICAgICAgICAgIHRoaXMubmV4dENhbGxiYWNrID0gZSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy53cmFwU3VjY2Vzcyh0LCBlKS5uZXh0KG4sIHMpO1xuICAgICAgICAgICAgfSwgdGhpcy5jYXRjaENhbGxiYWNrID0gdCA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy53cmFwRmFpbHVyZShlLCB0KS5uZXh0KG4sIHMpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0b1Byb21pc2UoKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgoKHQsIGUpID0+IHtcbiAgICAgICAgICAgIHRoaXMubmV4dCh0LCBlKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB3cmFwVXNlckZ1bmN0aW9uKHQpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0KCk7XG4gICAgICAgICAgICByZXR1cm4gZSBpbnN0YW5jZW9mIEtzID8gZSA6IEtzLnJlc29sdmUoZSk7XG4gICAgICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgICAgIHJldHVybiBLcy5yZWplY3QodCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgd3JhcFN1Y2Nlc3ModCwgZSkge1xuICAgICAgICByZXR1cm4gdCA/IHRoaXMud3JhcFVzZXJGdW5jdGlvbigoKCkgPT4gdChlKSkpIDogS3MucmVzb2x2ZShlKTtcbiAgICB9XG4gICAgd3JhcEZhaWx1cmUodCwgZSkge1xuICAgICAgICByZXR1cm4gdCA/IHRoaXMud3JhcFVzZXJGdW5jdGlvbigoKCkgPT4gdChlKSkpIDogS3MucmVqZWN0KGUpO1xuICAgIH1cbiAgICBzdGF0aWMgcmVzb2x2ZSh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgS3MoKChlLCBuKSA9PiB7XG4gICAgICAgICAgICBlKHQpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHN0YXRpYyByZWplY3QodCkge1xuICAgICAgICByZXR1cm4gbmV3IEtzKCgoZSwgbikgPT4ge1xuICAgICAgICAgICAgbih0KTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBzdGF0aWMgd2FpdEZvcihcbiAgICAvLyBBY2NlcHQgYWxsIFByb21pc2UgdHlwZXMgaW4gd2FpdEZvcigpLlxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgdCkge1xuICAgICAgICByZXR1cm4gbmV3IEtzKCgoZSwgbikgPT4ge1xuICAgICAgICAgICAgbGV0IHMgPSAwLCBpID0gMCwgciA9ICExO1xuICAgICAgICAgICAgdC5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgICAgICArK3MsIHQubmV4dCgoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICArK2ksIHIgJiYgaSA9PT0gcyAmJiBlKCk7XG4gICAgICAgICAgICAgICAgfSksICh0ID0+IG4odCkpKTtcbiAgICAgICAgICAgIH0pKSwgciA9ICEwLCBpID09PSBzICYmIGUoKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHaXZlbiBhbiBhcnJheSBvZiBwcmVkaWNhdGUgZnVuY3Rpb25zIHRoYXQgYXN5bmNocm9ub3VzbHkgZXZhbHVhdGUgdG8gYVxuICAgICAqIGJvb2xlYW4sIGltcGxlbWVudHMgYSBzaG9ydC1jaXJjdWl0aW5nIGBvcmAgYmV0d2VlbiB0aGUgcmVzdWx0cy4gUHJlZGljYXRlc1xuICAgICAqIHdpbGwgYmUgZXZhbHVhdGVkIHVudGlsIG9uZSBvZiB0aGVtIHJldHVybnMgYHRydWVgLCB0aGVuIHN0b3AuIFRoZSBmaW5hbFxuICAgICAqIHJlc3VsdCB3aWxsIGJlIHdoZXRoZXIgYW55IG9mIHRoZW0gcmV0dXJuZWQgYHRydWVgLlxuICAgICAqLyAgICBzdGF0aWMgb3IodCkge1xuICAgICAgICBsZXQgZSA9IEtzLnJlc29sdmUoITEpO1xuICAgICAgICBmb3IgKGNvbnN0IG4gb2YgdCkgZSA9IGUubmV4dCgodCA9PiB0ID8gS3MucmVzb2x2ZSh0KSA6IG4oKSkpO1xuICAgICAgICByZXR1cm4gZTtcbiAgICB9XG4gICAgc3RhdGljIGZvckVhY2godCwgZSkge1xuICAgICAgICBjb25zdCBuID0gW107XG4gICAgICAgIHJldHVybiB0LmZvckVhY2goKCh0LCBzKSA9PiB7XG4gICAgICAgICAgICBuLnB1c2goZS5jYWxsKHRoaXMsIHQsIHMpKTtcbiAgICAgICAgfSkpLCB0aGlzLndhaXRGb3Iobik7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLy8gUmVmZXJlbmNlcyB0byBgd2luZG93YCBhcmUgZ3VhcmRlZCBieSBTaW1wbGVEYi5pc0F2YWlsYWJsZSgpXG4vKiBlc2xpbnQtZGlzYWJsZSBuby1yZXN0cmljdGVkLWdsb2JhbHMgKi9cbi8qKlxuICogV3JhcHMgYW4gSURCVHJhbnNhY3Rpb24gYW5kIGV4cG9zZXMgYSBzdG9yZSgpIG1ldGhvZCB0byBnZXQgYSBoYW5kbGUgdG8gYVxuICogc3BlY2lmaWMgb2JqZWN0IHN0b3JlLlxuICovXG5jbGFzcyBqcyB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLmFjdGlvbiA9IHQsIHRoaXMudHJhbnNhY3Rpb24gPSBlLCB0aGlzLmFib3J0ZWQgPSAhMSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIGBQcm9taXNlYCB0aGF0IHJlc29sdmVzIHdpdGggdGhlIHJlc3VsdCBvZiB0aGUgSW5kZXhlZERiIHRyYW5zYWN0aW9uLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5UdCA9IG5ldyBqLCB0aGlzLnRyYW5zYWN0aW9uLm9uY29tcGxldGUgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLlR0LnJlc29sdmUoKTtcbiAgICAgICAgfSwgdGhpcy50cmFuc2FjdGlvbi5vbmFib3J0ID0gKCkgPT4ge1xuICAgICAgICAgICAgZS5lcnJvciA/IHRoaXMuVHQucmVqZWN0KG5ldyBHcyh0LCBlLmVycm9yKSkgOiB0aGlzLlR0LnJlc29sdmUoKTtcbiAgICAgICAgfSwgdGhpcy50cmFuc2FjdGlvbi5vbmVycm9yID0gZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuID0gWHMoZS50YXJnZXQuZXJyb3IpO1xuICAgICAgICAgICAgdGhpcy5UdC5yZWplY3QobmV3IEdzKHQsIG4pKTtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgc3RhdGljIG9wZW4odCwgZSwgbiwgcykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBqcyhlLCB0LnRyYW5zYWN0aW9uKHMsIG4pKTtcbiAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEdzKGUsIHQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldCBJdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuVHQucHJvbWlzZTtcbiAgICB9XG4gICAgYWJvcnQodCkge1xuICAgICAgICB0ICYmIHRoaXMuVHQucmVqZWN0KHQpLCB0aGlzLmFib3J0ZWQgfHwgKGsoXCJTaW1wbGVEYlwiLCBcIkFib3J0aW5nIHRyYW5zYWN0aW9uOlwiLCB0ID8gdC5tZXNzYWdlIDogXCJDbGllbnQtaW5pdGlhdGVkIGFib3J0XCIpLCBcbiAgICAgICAgdGhpcy5hYm9ydGVkID0gITAsIHRoaXMudHJhbnNhY3Rpb24uYWJvcnQoKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBTaW1wbGVEYlN0b3JlPEtleVR5cGUsIFZhbHVlVHlwZT4gZm9yIHRoZSBzcGVjaWZpZWQgc3RvcmUuIEFsbFxuICAgICAqIG9wZXJhdGlvbnMgcGVyZm9ybWVkIG9uIHRoZSBTaW1wbGVEYlN0b3JlIGhhcHBlbiB3aXRoaW4gdGhlIGNvbnRleHQgb2YgdGhpc1xuICAgICAqIHRyYW5zYWN0aW9uIGFuZCBpdCBjYW5ub3QgYmUgdXNlZCBhbnltb3JlIG9uY2UgdGhlIHRyYW5zYWN0aW9uIGlzXG4gICAgICogY29tcGxldGVkLlxuICAgICAqXG4gICAgICogTm90ZSB0aGF0IHdlIGNhbid0IGFjdHVhbGx5IGVuZm9yY2UgdGhhdCB0aGUgS2V5VHlwZSBhbmQgVmFsdWVUeXBlIGFyZVxuICAgICAqIGNvcnJlY3QsIGJ1dCB0aGV5IGFsbG93IHR5cGUgc2FmZXR5IHRocm91Z2ggdGhlIHJlc3Qgb2YgdGhlIGNvbnN1bWluZyBjb2RlLlxuICAgICAqLyAgICBzdG9yZSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLnRyYW5zYWN0aW9uLm9iamVjdFN0b3JlKHQpO1xuICAgICAgICByZXR1cm4gbmV3IEhzKGUpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBQcm92aWRlcyBhIHdyYXBwZXIgYXJvdW5kIEluZGV4ZWREYiB3aXRoIGEgc2ltcGxpZmllZCBpbnRlcmZhY2UgdGhhdCB1c2VzXG4gKiBQcm9taXNlLWxpa2UgcmV0dXJuIHZhbHVlcyB0byBjaGFpbiBvcGVyYXRpb25zLiBSZWFsIHByb21pc2VzIGNhbm5vdCBiZSB1c2VkXG4gKiBzaW5jZSAudGhlbigpIGNvbnRpbnVhdGlvbnMgYXJlIGV4ZWN1dGVkIGFzeW5jaHJvbm91c2x5IChlLmcuIHZpYVxuICogLnNldEltbWVkaWF0ZSksIHdoaWNoIHdvdWxkIGNhdXNlIEluZGV4ZWREQiB0byBlbmQgdGhlIHRyYW5zYWN0aW9uLlxuICogU2VlIFBlcnNpc3RlbmNlUHJvbWlzZSBmb3IgbW9yZSBkZXRhaWxzLlxuICovIGNsYXNzIFFzIHtcbiAgICAvKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgU2ltcGxlRGIgd3JhcHBlciBmb3IgSW5kZXhlZERiIGRhdGFiYXNlIGBuYW1lYC5cbiAgICAgKlxuICAgICAqIE5vdGUgdGhhdCBgdmVyc2lvbmAgbXVzdCBub3QgYmUgYSBkb3duZ3JhZGUuIEluZGV4ZWREQiBkb2VzIG5vdCBzdXBwb3J0XG4gICAgICogZG93bmdyYWRpbmcgdGhlIHNjaGVtYSB2ZXJzaW9uLiBXZSBjdXJyZW50bHkgZG8gbm90IHN1cHBvcnQgYW55IHdheSB0byBkb1xuICAgICAqIHZlcnNpb25pbmcgb3V0c2lkZSBvZiBJbmRleGVkREIncyB2ZXJzaW9uaW5nIG1lY2hhbmlzbSwgYXMgb25seVxuICAgICAqIHZlcnNpb24tdXBncmFkZSB0cmFuc2FjdGlvbnMgYXJlIGFsbG93ZWQgdG8gZG8gdGhpbmdzIGxpa2UgY3JlYXRlXG4gICAgICogb2JqZWN0c3RvcmVzLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4pIHtcbiAgICAgICAgdGhpcy5uYW1lID0gdCwgdGhpcy52ZXJzaW9uID0gZSwgdGhpcy5BdCA9IG47XG4gICAgICAgIC8vIE5PVEU6IEFjY29yZGluZyB0byBodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MTk3MDUwLCB0aGVcbiAgICAgICAgLy8gYnVnIHdlJ3JlIGNoZWNraW5nIGZvciBzaG91bGQgZXhpc3QgaW4gaU9TID49IDEyLjIgYW5kIDwgMTMsIGJ1dCBmb3JcbiAgICAgICAgLy8gd2hhdGV2ZXIgcmVhc29uIGl0J3MgbXVjaCBoYXJkZXIgdG8gaGl0IGFmdGVyIDEyLjIgc28gd2Ugb25seSBwcm9hY3RpdmVseVxuICAgICAgICAvLyBsb2cgb24gMTIuMi5cbiAgICAgICAgMTIuMiA9PT0gUXMuUnQodSgpKSAmJiAkKFwiRmlyZXN0b3JlIHBlcnNpc3RlbmNlIHN1ZmZlcnMgZnJvbSBhIGJ1ZyBpbiBpT1MgMTIuMiBTYWZhcmkgdGhhdCBtYXkgY2F1c2UgeW91ciBhcHAgdG8gc3RvcCB3b3JraW5nLiBTZWUgaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xLzU2NDk2Mjk2LzExMDkxNSBmb3IgZGV0YWlscyBhbmQgYSBwb3RlbnRpYWwgd29ya2Fyb3VuZC5cIik7XG4gICAgfVxuICAgIC8qKiBEZWxldGVzIHRoZSBzcGVjaWZpZWQgZGF0YWJhc2UuICovICAgIHN0YXRpYyBkZWxldGUodCkge1xuICAgICAgICByZXR1cm4gayhcIlNpbXBsZURiXCIsIFwiUmVtb3ZpbmcgZGF0YWJhc2U6XCIsIHQpLCBKcyh3aW5kb3cuaW5kZXhlZERCLmRlbGV0ZURhdGFiYXNlKHQpKS50b1Byb21pc2UoKTtcbiAgICB9XG4gICAgLyoqIFJldHVybnMgdHJ1ZSBpZiBJbmRleGVkREIgaXMgYXZhaWxhYmxlIGluIHRoZSBjdXJyZW50IGVudmlyb25tZW50LiAqLyAgICBzdGF0aWMgUHQoKSB7XG4gICAgICAgIGlmIChcInVuZGVmaW5lZFwiID09IHR5cGVvZiBpbmRleGVkREIpIHJldHVybiAhMTtcbiAgICAgICAgaWYgKFFzLmJ0KCkpIHJldHVybiAhMDtcbiAgICAgICAgLy8gV2UgZXh0ZW5zaXZlbHkgdXNlIGluZGV4ZWQgYXJyYXkgdmFsdWVzIGFuZCBjb21wb3VuZCBrZXlzLFxuICAgICAgICAvLyB3aGljaCBJRSBhbmQgRWRnZSBkbyBub3Qgc3VwcG9ydC4gSG93ZXZlciwgdGhleSBzdGlsbCBoYXZlIGluZGV4ZWREQlxuICAgICAgICAvLyBkZWZpbmVkIG9uIHRoZSB3aW5kb3csIHNvIHdlIG5lZWQgdG8gY2hlY2sgZm9yIHRoZW0gaGVyZSBhbmQgbWFrZSBzdXJlXG4gICAgICAgIC8vIHRvIHJldHVybiB0aGF0IHBlcnNpc3RlbmNlIGlzIG5vdCBlbmFibGVkIGZvciB0aG9zZSBicm93c2Vycy5cbiAgICAgICAgLy8gRm9yIHRyYWNraW5nIHN1cHBvcnQgb2YgdGhpcyBmZWF0dXJlLCBzZWUgaGVyZTpcbiAgICAgICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubWljcm9zb2Z0LmNvbS9lbi11cy9taWNyb3NvZnQtZWRnZS9wbGF0Zm9ybS9zdGF0dXMvaW5kZXhlZGRiYXJyYXlzYW5kbXVsdGllbnRyeXN1cHBvcnQvXG4gICAgICAgIC8vIENoZWNrIHRoZSBVQSBzdHJpbmcgdG8gZmluZCBvdXQgdGhlIGJyb3dzZXIuXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHUoKSwgZSA9IFFzLlJ0KHQpLCBuID0gMCA8IGUgJiYgZSA8IDEwLCBzID0gUXMudnQodCksIGkgPSAwIDwgcyAmJiBzIDwgNC41O1xuICAgICAgICAvLyBJRSAxMFxuICAgICAgICAvLyB1YSA9ICdNb3ppbGxhLzUuMCAoY29tcGF0aWJsZTsgTVNJRSAxMC4wOyBXaW5kb3dzIE5UIDYuMjsgVHJpZGVudC82LjApJztcbiAgICAgICAgLy8gSUUgMTFcbiAgICAgICAgLy8gdWEgPSAnTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4zOyBUcmlkZW50LzcuMDsgcnY6MTEuMCkgbGlrZSBHZWNrbyc7XG4gICAgICAgIC8vIEVkZ2VcbiAgICAgICAgLy8gdWEgPSAnTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV09XNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsXG4gICAgICAgIC8vIGxpa2UgR2Vja28pIENocm9tZS8zOS4wLjIxNzEuNzEgU2FmYXJpLzUzNy4zNiBFZGdlLzEyLjAnO1xuICAgICAgICAvLyBpT1MgU2FmYXJpOiBEaXNhYmxlIGZvciB1c2VycyBydW5uaW5nIGlPUyB2ZXJzaW9uIDwgMTAuXG4gICAgICAgICAgICAgICAgcmV0dXJuICEodC5pbmRleE9mKFwiTVNJRSBcIikgPiAwIHx8IHQuaW5kZXhPZihcIlRyaWRlbnQvXCIpID4gMCB8fCB0LmluZGV4T2YoXCJFZGdlL1wiKSA+IDAgfHwgbiB8fCBpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHRoZSBiYWNraW5nIEluZGV4ZWREQiBzdG9yZSBpcyB0aGUgTm9kZSBJbmRleGVkREJTaGltXG4gICAgICogKHNlZSBodHRwczovL2dpdGh1Yi5jb20vYXhlbWNsaW9uL0luZGV4ZWREQlNoaW0pLlxuICAgICAqLyAgICBzdGF0aWMgYnQoKSB7XG4gICAgICAgIHZhciB0O1xuICAgICAgICByZXR1cm4gXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgcHJvY2VzcyAmJiBcIllFU1wiID09PSAobnVsbCA9PT0gKHQgPSBwcm9jZXNzLmVudikgfHwgdm9pZCAwID09PSB0ID8gdm9pZCAwIDogdC5WdCk7XG4gICAgfVxuICAgIC8qKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmcm9tIGEgdHJhbnNhY3Rpb24uICovICAgIHN0YXRpYyBTdCh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0LnN0b3JlKGUpO1xuICAgIH1cbiAgICAvLyB2aXNpYmxlIGZvciB0ZXN0aW5nXG4gICAgLyoqIFBhcnNlIFVzZXIgQWdlbnQgdG8gZGV0ZXJtaW5lIGlPUyB2ZXJzaW9uLiBSZXR1cm5zIC0xIGlmIG5vdCBmb3VuZC4gKi9cbiAgICBzdGF0aWMgUnQodCkge1xuICAgICAgICBjb25zdCBlID0gdC5tYXRjaCgvaSg/OnBob25lfHBhZHxwb2QpIG9zIChbXFxkX10rKS9pKSwgbiA9IGUgPyBlWzFdLnNwbGl0KFwiX1wiKS5zbGljZSgwLCAyKS5qb2luKFwiLlwiKSA6IFwiLTFcIjtcbiAgICAgICAgcmV0dXJuIE51bWJlcihuKTtcbiAgICB9XG4gICAgLy8gdmlzaWJsZSBmb3IgdGVzdGluZ1xuICAgIC8qKiBQYXJzZSBVc2VyIEFnZW50IHRvIGRldGVybWluZSBBbmRyb2lkIHZlcnNpb24uIFJldHVybnMgLTEgaWYgbm90IGZvdW5kLiAqL1xuICAgIHN0YXRpYyB2dCh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0Lm1hdGNoKC9BbmRyb2lkIChbXFxkLl0rKS9pKSwgbiA9IGUgPyBlWzFdLnNwbGl0KFwiLlwiKS5zbGljZSgwLCAyKS5qb2luKFwiLlwiKSA6IFwiLTFcIjtcbiAgICAgICAgcmV0dXJuIE51bWJlcihuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogT3BlbnMgdGhlIHNwZWNpZmllZCBkYXRhYmFzZSwgY3JlYXRpbmcgb3IgdXBncmFkaW5nIGl0IGlmIG5lY2Vzc2FyeS5cbiAgICAgKi8gICAgYXN5bmMgRHQodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYiB8fCAoayhcIlNpbXBsZURiXCIsIFwiT3BlbmluZyBkYXRhYmFzZTpcIiwgdGhpcy5uYW1lKSwgdGhpcy5kYiA9IGF3YWl0IG5ldyBQcm9taXNlKCgoZSwgbikgPT4ge1xuICAgICAgICAgICAgLy8gVE9ETyhtaWtlbGVoZW4pOiBJbnZlc3RpZ2F0ZSBicm93c2VyIGNvbXBhdGliaWxpdHkuXG4gICAgICAgICAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvSW5kZXhlZERCX0FQSS9Vc2luZ19JbmRleGVkREJcbiAgICAgICAgICAgIC8vIHN1Z2dlc3RzIElFOSBhbmQgb2xkZXIgV2ViS2l0IGJyb3dzZXJzIGhhbmRsZSB1cGdyYWRlXG4gICAgICAgICAgICAvLyBkaWZmZXJlbnRseS4gVGhleSBleHBlY3Qgc2V0VmVyc2lvbiwgYXMgZGVzY3JpYmVkIGhlcmU6XG4gICAgICAgICAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvSURCVmVyc2lvbkNoYW5nZVJlcXVlc3Qvc2V0VmVyc2lvblxuICAgICAgICAgICAgY29uc3QgcyA9IGluZGV4ZWREQi5vcGVuKHRoaXMubmFtZSwgdGhpcy52ZXJzaW9uKTtcbiAgICAgICAgICAgIHMub25zdWNjZXNzID0gdCA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHQudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgICAgICAgICBlKG4pO1xuICAgICAgICAgICAgfSwgcy5vbmJsb2NrZWQgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgbihuZXcgR3ModCwgXCJDYW5ub3QgdXBncmFkZSBJbmRleGVkREIgc2NoZW1hIHdoaWxlIGFub3RoZXIgdGFiIGlzIG9wZW4uIENsb3NlIGFsbCB0YWJzIHRoYXQgYWNjZXNzIEZpcmVzdG9yZSBhbmQgcmVsb2FkIHRoaXMgcGFnZSB0byBwcm9jZWVkLlwiKSk7XG4gICAgICAgICAgICB9LCBzLm9uZXJyb3IgPSBlID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gZS50YXJnZXQuZXJyb3I7XG4gICAgICAgICAgICAgICAgXCJWZXJzaW9uRXJyb3JcIiA9PT0gcy5uYW1lID8gbihuZXcgSyhxLkZBSUxFRF9QUkVDT05ESVRJT04sIFwiQSBuZXdlciB2ZXJzaW9uIG9mIHRoZSBGaXJlc3RvcmUgU0RLIHdhcyBwcmV2aW91c2x5IHVzZWQgYW5kIHNvIHRoZSBwZXJzaXN0ZWQgZGF0YSBpcyBub3QgY29tcGF0aWJsZSB3aXRoIHRoZSB2ZXJzaW9uIG9mIHRoZSBTREsgeW91IGFyZSBub3cgdXNpbmcuIFRoZSBTREsgd2lsbCBvcGVyYXRlIHdpdGggcGVyc2lzdGVuY2UgZGlzYWJsZWQuIElmIHlvdSBuZWVkIHBlcnNpc3RlbmNlLCBwbGVhc2UgcmUtdXBncmFkZSB0byBhIG5ld2VyIHZlcnNpb24gb2YgdGhlIFNESyBvciBlbHNlIGNsZWFyIHRoZSBwZXJzaXN0ZWQgSW5kZXhlZERCIGRhdGEgZm9yIHlvdXIgYXBwIHRvIHN0YXJ0IGZyZXNoLlwiKSkgOiBuKG5ldyBHcyh0LCBzKSk7XG4gICAgICAgICAgICB9LCBzLm9udXBncmFkZW5lZWRlZCA9IHQgPT4ge1xuICAgICAgICAgICAgICAgIGsoXCJTaW1wbGVEYlwiLCAnRGF0YWJhc2UgXCInICsgdGhpcy5uYW1lICsgJ1wiIHJlcXVpcmVzIHVwZ3JhZGUgZnJvbSB2ZXJzaW9uOicsIHQub2xkVmVyc2lvbik7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgICAgICAgICB0aGlzLkF0LkN0KGUsIHMudHJhbnNhY3Rpb24sIHQub2xkVmVyc2lvbiwgdGhpcy52ZXJzaW9uKS5uZXh0KCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGsoXCJTaW1wbGVEYlwiLCBcIkRhdGFiYXNlIHVwZ3JhZGUgdG8gdmVyc2lvbiBcIiArIHRoaXMudmVyc2lvbiArIFwiIGNvbXBsZXRlXCIpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pKSksIHRoaXMuTnQgJiYgKHRoaXMuZGIub252ZXJzaW9uY2hhbmdlID0gdCA9PiB0aGlzLk50KHQpKSwgdGhpcy5kYjtcbiAgICB9XG4gICAgeHQodCkge1xuICAgICAgICB0aGlzLk50ID0gdCwgdGhpcy5kYiAmJiAodGhpcy5kYi5vbnZlcnNpb25jaGFuZ2UgPSBlID0+IHQoZSkpO1xuICAgIH1cbiAgICBhc3luYyBydW5UcmFuc2FjdGlvbih0LCBlLCBuLCBzKSB7XG4gICAgICAgIGNvbnN0IGkgPSBcInJlYWRvbmx5XCIgPT09IGU7XG4gICAgICAgIGxldCByID0gMDtcbiAgICAgICAgZm9yICg7Oykge1xuICAgICAgICAgICAgKytyO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0aGlzLmRiID0gYXdhaXQgdGhpcy5EdCh0KTtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0ganMub3Blbih0aGlzLmRiLCB0LCBpID8gXCJyZWFkb25seVwiIDogXCJyZWFkd3JpdGVcIiwgbiksIHIgPSBzKGUpLmNhdGNoKCh0ID0+IChcbiAgICAgICAgICAgICAgICAvLyBBYm9ydCB0aGUgdHJhbnNhY3Rpb24gaWYgdGhlcmUgd2FzIGFuIGVycm9yLlxuICAgICAgICAgICAgICAgIGUuYWJvcnQodCksIEtzLnJlamVjdCh0KSkpKS50b1Byb21pc2UoKTtcbiAgICAgICAgICAgICAgICAvLyBBcyBub3RlZCBhYm92ZSwgZXJyb3JzIGFyZSBwcm9wYWdhdGVkIGJ5IGFib3J0aW5nIHRoZSB0cmFuc2FjdGlvbi4gU29cbiAgICAgICAgICAgICAgICAvLyB3ZSBzd2FsbG93IGFueSBlcnJvciBoZXJlIHRvIGF2b2lkIHRoZSBicm93c2VyIGxvZ2dpbmcgaXQgYXMgdW5oYW5kbGVkLlxuICAgICAgICAgICAgICAgIHJldHVybiByLmNhdGNoKCgoKSA9PiB7fSkpLCBcbiAgICAgICAgICAgICAgICAvLyBXYWl0IGZvciB0aGUgdHJhbnNhY3Rpb24gdG8gY29tcGxldGUgKGkuZS4gSW5kZXhlZERiJ3Mgb25zdWNjZXNzIGV2ZW50IHRvXG4gICAgICAgICAgICAgICAgLy8gZmlyZSksIGJ1dCBzdGlsbCByZXR1cm4gdGhlIG9yaWdpbmFsIHRyYW5zYWN0aW9uRm5SZXN1bHQgYmFjayB0byB0aGVcbiAgICAgICAgICAgICAgICAvLyBjYWxsZXIuXG4gICAgICAgICAgICAgICAgYXdhaXQgZS5JdCwgcjtcbiAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgICAgICAgICAvLyBUT0RPKHNjaG1pZHQtc2ViYXN0aWFuKTogV2UgY291bGQgcHJvYmFibHkgYmUgc21hcnRlciBhYm91dCB0aGlzIGFuZFxuICAgICAgICAgICAgICAgIC8vIG5vdCByZXRyeSBleGNlcHRpb25zIHRoYXQgYXJlIGxpa2VseSB1bnJlY292ZXJhYmxlIChzdWNoIGFzIHF1b3RhXG4gICAgICAgICAgICAgICAgLy8gZXhjZWVkZWQgZXJyb3JzKS5cbiAgICAgICAgICAgICAgICAvLyBOb3RlOiBXZSBjYW5ub3QgdXNlIGFuIGluc3RhbmNlb2YgY2hlY2sgZm9yIEZpcmVzdG9yZUV4Y2VwdGlvbiwgc2luY2UgdGhlXG4gICAgICAgICAgICAgICAgLy8gZXhjZXB0aW9uIGlzIHdyYXBwZWQgaW4gYSBnZW5lcmljIGVycm9yIGJ5IG91ciBhc3luYy9hd2FpdCBoYW5kbGluZy5cbiAgICAgICAgICAgICAgICBjb25zdCBlID0gXCJGaXJlYmFzZUVycm9yXCIgIT09IHQubmFtZSAmJiByIDwgMztcbiAgICAgICAgICAgICAgICBpZiAoayhcIlNpbXBsZURiXCIsIFwiVHJhbnNhY3Rpb24gZmFpbGVkIHdpdGggZXJyb3I6XCIsIHQubWVzc2FnZSwgXCJSZXRyeWluZzpcIiwgZSksIFxuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKSwgIWUpIHJldHVybiBQcm9taXNlLnJlamVjdCh0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgdGhpcy5kYiAmJiB0aGlzLmRiLmNsb3NlKCksIHRoaXMuZGIgPSB2b2lkIDA7XG4gICAgfVxufVxuXG4vKipcbiAqIEEgY29udHJvbGxlciBmb3IgaXRlcmF0aW5nIG92ZXIgYSBrZXkgcmFuZ2Ugb3IgaW5kZXguIEl0IGFsbG93cyBhbiBpdGVyYXRlXG4gKiBjYWxsYmFjayB0byBkZWxldGUgdGhlIGN1cnJlbnRseS1yZWZlcmVuY2VkIG9iamVjdCwgb3IganVtcCB0byBhIG5ldyBrZXlcbiAqIHdpdGhpbiB0aGUga2V5IHJhbmdlIG9yIGluZGV4LlxuICovIGNsYXNzIFdzIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMua3QgPSB0LCB0aGlzLiR0ID0gITEsIHRoaXMuT3QgPSBudWxsO1xuICAgIH1cbiAgICBnZXQgaXNEb25lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy4kdDtcbiAgICB9XG4gICAgZ2V0IEZ0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5PdDtcbiAgICB9XG4gICAgc2V0IGN1cnNvcih0KSB7XG4gICAgICAgIHRoaXMua3QgPSB0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGlzIGZ1bmN0aW9uIGNhbiBiZSBjYWxsZWQgdG8gc3RvcCBpdGVyYXRpb24gYXQgYW55IHBvaW50LlxuICAgICAqLyAgICBkb25lKCkge1xuICAgICAgICB0aGlzLiR0ID0gITA7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoaXMgZnVuY3Rpb24gY2FuIGJlIGNhbGxlZCB0byBza2lwIHRvIHRoYXQgbmV4dCBrZXksIHdoaWNoIGNvdWxkIGJlXG4gICAgICogYW4gaW5kZXggb3IgYSBwcmltYXJ5IGtleS5cbiAgICAgKi8gICAgTXQodCkge1xuICAgICAgICB0aGlzLk90ID0gdDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRGVsZXRlIHRoZSBjdXJyZW50IGN1cnNvciB2YWx1ZSBmcm9tIHRoZSBvYmplY3Qgc3RvcmUuXG4gICAgICpcbiAgICAgKiBOT1RFOiBZb3UgQ0FOTk9UIGRvIHRoaXMgd2l0aCBhIGtleXNPbmx5IHF1ZXJ5LlxuICAgICAqLyAgICBkZWxldGUoKSB7XG4gICAgICAgIHJldHVybiBKcyh0aGlzLmt0LmRlbGV0ZSgpKTtcbiAgICB9XG59XG5cbi8qKiBBbiBlcnJvciB0aGF0IHdyYXBzIGV4Y2VwdGlvbnMgdGhhdCB0aHJvd24gZHVyaW5nIEluZGV4ZWREQiBleGVjdXRpb24uICovIGNsYXNzIEdzIGV4dGVuZHMgSyB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICBzdXBlcihxLlVOQVZBSUxBQkxFLCBgSW5kZXhlZERCIHRyYW5zYWN0aW9uICcke3R9JyBmYWlsZWQ6ICR7ZX1gKSwgdGhpcy5uYW1lID0gXCJJbmRleGVkRGJUcmFuc2FjdGlvbkVycm9yXCI7XG4gICAgfVxufVxuXG4vKiogVmVyaWZpZXMgd2hldGhlciBgZWAgaXMgYW4gSW5kZXhlZERiVHJhbnNhY3Rpb25FcnJvci4gKi8gZnVuY3Rpb24genModCkge1xuICAgIC8vIFVzZSBuYW1lIGVxdWFsaXR5LCBhcyBpbnN0YW5jZW9mIGNoZWNrcyBvbiBlcnJvcnMgZG9uJ3Qgd29yayB3aXRoIGVycm9yc1xuICAgIC8vIHRoYXQgd3JhcCBvdGhlciBlcnJvcnMuXG4gICAgcmV0dXJuIFwiSW5kZXhlZERiVHJhbnNhY3Rpb25FcnJvclwiID09PSB0Lm5hbWU7XG59XG5cbi8qKlxuICogQSB3cmFwcGVyIGFyb3VuZCBhbiBJREJPYmplY3RTdG9yZSBwcm92aWRpbmcgYW4gQVBJIHRoYXQ6XG4gKlxuICogMSkgSGFzIGdlbmVyaWMgS2V5VHlwZSAvIFZhbHVlVHlwZSBwYXJhbWV0ZXJzIHRvIHByb3ZpZGUgc3Ryb25nbHktdHlwZWRcbiAqIG1ldGhvZHMgZm9yIGFjdGluZyBhZ2FpbnN0IHRoZSBvYmplY3Qgc3RvcmUuXG4gKiAyKSBEZWFscyB3aXRoIEluZGV4ZWREQidzIG9uc3VjY2VzcyAvIG9uZXJyb3IgZXZlbnQgY2FsbGJhY2tzLCBtYWtpbmcgZXZlcnlcbiAqIG1ldGhvZCByZXR1cm4gYSBQZXJzaXN0ZW5jZVByb21pc2UgaW5zdGVhZC5cbiAqIDMpIFByb3ZpZGVzIGEgaGlnaGVyLWxldmVsIEFQSSB0byBhdm9pZCBuZWVkaW5nIHRvIGRvIGV4Y2Vzc2l2ZSB3cmFwcGluZyBvZlxuICogaW50ZXJtZWRpYXRlIEluZGV4ZWREQiB0eXBlcyAoSURCQ3Vyc29yV2l0aFZhbHVlLCBldGMuKVxuICovIGNsYXNzIEhzIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMuc3RvcmUgPSB0O1xuICAgIH1cbiAgICBwdXQodCwgZSkge1xuICAgICAgICBsZXQgbjtcbiAgICAgICAgcmV0dXJuIHZvaWQgMCAhPT0gZSA/IChrKFwiU2ltcGxlRGJcIiwgXCJQVVRcIiwgdGhpcy5zdG9yZS5uYW1lLCB0LCBlKSwgbiA9IHRoaXMuc3RvcmUucHV0KGUsIHQpKSA6IChrKFwiU2ltcGxlRGJcIiwgXCJQVVRcIiwgdGhpcy5zdG9yZS5uYW1lLCBcIjxhdXRvLWtleT5cIiwgdCksIFxuICAgICAgICBuID0gdGhpcy5zdG9yZS5wdXQodCkpLCBKcyhuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkcyBhIG5ldyB2YWx1ZSBpbnRvIGFuIE9iamVjdCBTdG9yZSBhbmQgcmV0dXJucyB0aGUgbmV3IGtleS4gU2ltaWxhciB0b1xuICAgICAqIEluZGV4ZWREYidzIGBhZGQoKWAsIHRoaXMgbWV0aG9kIHdpbGwgZmFpbCBvbiBwcmltYXJ5IGtleSBjb2xsaXNpb25zLlxuICAgICAqXG4gICAgICogQHBhcmFtIHZhbHVlIC0gVGhlIG9iamVjdCB0byB3cml0ZS5cbiAgICAgKiBAcmV0dXJucyBUaGUga2V5IG9mIHRoZSB2YWx1ZSB0byBhZGQuXG4gICAgICovICAgIGFkZCh0KSB7XG4gICAgICAgIGsoXCJTaW1wbGVEYlwiLCBcIkFERFwiLCB0aGlzLnN0b3JlLm5hbWUsIHQsIHQpO1xuICAgICAgICByZXR1cm4gSnModGhpcy5zdG9yZS5hZGQodCkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBvYmplY3Qgd2l0aCB0aGUgc3BlY2lmaWVkIGtleSBmcm9tIHRoZSBzcGVjaWZpZWQgc3RvcmUsIG9yIG51bGxcbiAgICAgKiBpZiBubyBvYmplY3QgZXhpc3RzIHdpdGggdGhlIHNwZWNpZmllZCBrZXkuXG4gICAgICpcbiAgICAgKiBAa2V5IFRoZSBrZXkgb2YgdGhlIG9iamVjdCB0byBnZXQuXG4gICAgICogQHJldHVybnMgVGhlIG9iamVjdCB3aXRoIHRoZSBzcGVjaWZpZWQga2V5IG9yIG51bGwgaWYgbm8gb2JqZWN0IGV4aXN0cy5cbiAgICAgKi8gICAgZ2V0KHQpIHtcbiAgICAgICAgLy8gV2UncmUgZG9pbmcgYW4gdW5zYWZlIGNhc3QgdG8gVmFsdWVUeXBlLlxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICByZXR1cm4gSnModGhpcy5zdG9yZS5nZXQodCkpLm5leHQoKGUgPT4gKFxuICAgICAgICAvLyBOb3JtYWxpemUgbm9uZXhpc3RlbmNlIHRvIG51bGwuXG4gICAgICAgIHZvaWQgMCA9PT0gZSAmJiAoZSA9IG51bGwpLCBrKFwiU2ltcGxlRGJcIiwgXCJHRVRcIiwgdGhpcy5zdG9yZS5uYW1lLCB0LCBlKSwgZSkpKTtcbiAgICB9XG4gICAgZGVsZXRlKHQpIHtcbiAgICAgICAgayhcIlNpbXBsZURiXCIsIFwiREVMRVRFXCIsIHRoaXMuc3RvcmUubmFtZSwgdCk7XG4gICAgICAgIHJldHVybiBKcyh0aGlzLnN0b3JlLmRlbGV0ZSh0KSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIElmIHdlIGV2ZXIgbmVlZCBtb3JlIG9mIHRoZSBjb3VudCB2YXJpYW50cywgd2UgY2FuIGFkZCBvdmVybG9hZHMuIEZvciBub3csXG4gICAgICogYWxsIHdlIG5lZWQgaXMgdG8gY291bnQgZXZlcnl0aGluZyBpbiBhIHN0b3JlLlxuICAgICAqXG4gICAgICogUmV0dXJucyB0aGUgbnVtYmVyIG9mIHJvd3MgaW4gdGhlIHN0b3JlLlxuICAgICAqLyAgICBjb3VudCgpIHtcbiAgICAgICAgayhcIlNpbXBsZURiXCIsIFwiQ09VTlRcIiwgdGhpcy5zdG9yZS5uYW1lKTtcbiAgICAgICAgcmV0dXJuIEpzKHRoaXMuc3RvcmUuY291bnQoKSk7XG4gICAgfVxuICAgIEx0KHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMuY3Vyc29yKHRoaXMub3B0aW9ucyh0LCBlKSksIHMgPSBbXTtcbiAgICAgICAgcmV0dXJuIHRoaXMuQnQobiwgKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICBzLnB1c2goZSk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBzKSk7XG4gICAgfVxuICAgIFV0KHQsIGUpIHtcbiAgICAgICAgayhcIlNpbXBsZURiXCIsIFwiREVMRVRFIEFMTFwiLCB0aGlzLnN0b3JlLm5hbWUpO1xuICAgICAgICBjb25zdCBuID0gdGhpcy5vcHRpb25zKHQsIGUpO1xuICAgICAgICBuLnF0ID0gITE7XG4gICAgICAgIGNvbnN0IHMgPSB0aGlzLmN1cnNvcihuKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuQnQocywgKCh0LCBlLCBuKSA9PiBuLmRlbGV0ZSgpKSk7XG4gICAgfVxuICAgIEt0KHQsIGUpIHtcbiAgICAgICAgbGV0IG47XG4gICAgICAgIGUgPyBuID0gdCA6IChuID0ge30sIGUgPSB0KTtcbiAgICAgICAgY29uc3QgcyA9IHRoaXMuY3Vyc29yKG4pO1xuICAgICAgICByZXR1cm4gdGhpcy5CdChzLCBlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSXRlcmF0ZXMgb3ZlciBhIHN0b3JlLCBidXQgd2FpdHMgZm9yIHRoZSBnaXZlbiBjYWxsYmFjayB0byBjb21wbGV0ZSBmb3JcbiAgICAgKiBlYWNoIGVudHJ5IGJlZm9yZSBpdGVyYXRpbmcgdGhlIG5leHQgZW50cnkuIFRoaXMgYWxsb3dzIHRoZSBjYWxsYmFjayB0byBkb1xuICAgICAqIGFzeW5jaHJvbm91cyB3b3JrIHRvIGRldGVybWluZSBpZiB0aGlzIGl0ZXJhdGlvbiBzaG91bGQgY29udGludWUuXG4gICAgICpcbiAgICAgKiBUaGUgcHJvdmlkZWQgY2FsbGJhY2sgc2hvdWxkIHJldHVybiBgdHJ1ZWAgdG8gY29udGludWUgaXRlcmF0aW9uLCBhbmRcbiAgICAgKiBgZmFsc2VgIG90aGVyd2lzZS5cbiAgICAgKi8gICAganQodCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5jdXJzb3Ioe30pO1xuICAgICAgICByZXR1cm4gbmV3IEtzKCgobiwgcykgPT4ge1xuICAgICAgICAgICAgZS5vbmVycm9yID0gdCA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IFhzKHQudGFyZ2V0LmVycm9yKTtcbiAgICAgICAgICAgICAgICBzKGUpO1xuICAgICAgICAgICAgfSwgZS5vbnN1Y2Nlc3MgPSBlID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gZS50YXJnZXQucmVzdWx0O1xuICAgICAgICAgICAgICAgIHMgPyB0KHMucHJpbWFyeUtleSwgcy52YWx1ZSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHQgPyBzLmNvbnRpbnVlKCkgOiBuKCk7XG4gICAgICAgICAgICAgICAgfSkpIDogbigpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBCdCh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBbXTtcbiAgICAgICAgcmV0dXJuIG5ldyBLcygoKHMsIGkpID0+IHtcbiAgICAgICAgICAgIHQub25lcnJvciA9IHQgPT4ge1xuICAgICAgICAgICAgICAgIGkodC50YXJnZXQuZXJyb3IpO1xuICAgICAgICAgICAgfSwgdC5vbnN1Y2Nlc3MgPSB0ID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdC50YXJnZXQucmVzdWx0O1xuICAgICAgICAgICAgICAgIGlmICghaSkgcmV0dXJuIHZvaWQgcygpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBuZXcgV3MoaSksIG8gPSBlKGkucHJpbWFyeUtleSwgaS52YWx1ZSwgcik7XG4gICAgICAgICAgICAgICAgaWYgKG8gaW5zdGFuY2VvZiBLcykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gby5jYXRjaCgodCA9PiAoci5kb25lKCksIEtzLnJlamVjdCh0KSkpKTtcbiAgICAgICAgICAgICAgICAgICAgbi5wdXNoKHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByLmlzRG9uZSA/IHMoKSA6IG51bGwgPT09IHIuRnQgPyBpLmNvbnRpbnVlKCkgOiBpLmNvbnRpbnVlKHIuRnQpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IEtzLndhaXRGb3IobikpKTtcbiAgICB9XG4gICAgb3B0aW9ucyh0LCBlKSB7XG4gICAgICAgIGxldCBuO1xuICAgICAgICByZXR1cm4gdm9pZCAwICE9PSB0ICYmIChcInN0cmluZ1wiID09IHR5cGVvZiB0ID8gbiA9IHQgOiBlID0gdCksIHtcbiAgICAgICAgICAgIGluZGV4OiBuLFxuICAgICAgICAgICAgcmFuZ2U6IGVcbiAgICAgICAgfTtcbiAgICB9XG4gICAgY3Vyc29yKHQpIHtcbiAgICAgICAgbGV0IGUgPSBcIm5leHRcIjtcbiAgICAgICAgaWYgKHQucmV2ZXJzZSAmJiAoZSA9IFwicHJldlwiKSwgdC5pbmRleCkge1xuICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuc3RvcmUuaW5kZXgodC5pbmRleCk7XG4gICAgICAgICAgICByZXR1cm4gdC5xdCA/IG4ub3BlbktleUN1cnNvcih0LnJhbmdlLCBlKSA6IG4ub3BlbkN1cnNvcih0LnJhbmdlLCBlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5zdG9yZS5vcGVuQ3Vyc29yKHQucmFuZ2UsIGUpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBXcmFwcyBhbiBJREJSZXF1ZXN0IGluIGEgUGVyc2lzdGVuY2VQcm9taXNlLCB1c2luZyB0aGUgb25zdWNjZXNzIC8gb25lcnJvclxuICogaGFuZGxlcnMgdG8gcmVzb2x2ZSAvIHJlamVjdCB0aGUgUGVyc2lzdGVuY2VQcm9taXNlIGFzIGFwcHJvcHJpYXRlLlxuICovIGZ1bmN0aW9uIEpzKHQpIHtcbiAgICByZXR1cm4gbmV3IEtzKCgoZSwgbikgPT4ge1xuICAgICAgICB0Lm9uc3VjY2VzcyA9IHQgPT4ge1xuICAgICAgICAgICAgY29uc3QgbiA9IHQudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgICAgIGUobik7XG4gICAgICAgIH0sIHQub25lcnJvciA9IHQgPT4ge1xuICAgICAgICAgICAgY29uc3QgZSA9IFhzKHQudGFyZ2V0LmVycm9yKTtcbiAgICAgICAgICAgIG4oZSk7XG4gICAgICAgIH07XG4gICAgfSkpO1xufVxuXG4vLyBHdWFyZCBzbyB3ZSBvbmx5IHJlcG9ydCB0aGUgZXJyb3Igb25jZS5cbmxldCBZcyA9ICExO1xuXG5mdW5jdGlvbiBYcyh0KSB7XG4gICAgY29uc3QgZSA9IFFzLlJ0KHUoKSk7XG4gICAgaWYgKGUgPj0gMTIuMiAmJiBlIDwgMTMpIHtcbiAgICAgICAgY29uc3QgZSA9IFwiQW4gaW50ZXJuYWwgZXJyb3Igd2FzIGVuY291bnRlcmVkIGluIHRoZSBJbmRleGVkIERhdGFiYXNlIHNlcnZlclwiO1xuICAgICAgICBpZiAodC5tZXNzYWdlLmluZGV4T2YoZSkgPj0gMCkge1xuICAgICAgICAgICAgLy8gV3JhcCBlcnJvciBpbiBhIG1vcmUgZGVzY3JpcHRpdmUgb25lLlxuICAgICAgICAgICAgY29uc3QgdCA9IG5ldyBLKFwiaW50ZXJuYWxcIiwgYElPU19JTkRFWEVEREJfQlVHMTogSW5kZXhlZERiIGhhcyB0aHJvd24gJyR7ZX0nLiBUaGlzIGlzIGxpa2VseSBkdWUgdG8gYW4gdW5hdm9pZGFibGUgYnVnIGluIGlPUy4gU2VlIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcS81NjQ5NjI5Ni8xMTA5MTUgZm9yIGRldGFpbHMgYW5kIGEgcG90ZW50aWFsIHdvcmthcm91bmQuYCk7XG4gICAgICAgICAgICByZXR1cm4gWXMgfHwgKFlzID0gITAsIFxuICAgICAgICAgICAgLy8gVGhyb3cgYSBnbG9iYWwgZXhjZXB0aW9uIG91dHNpZGUgb2YgdGhpcyBwcm9taXNlIGNoYWluLCBmb3IgdGhlIHVzZXIgdG9cbiAgICAgICAgICAgIC8vIHBvdGVudGlhbGx5IGNhdGNoLlxuICAgICAgICAgICAgc2V0VGltZW91dCgoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRocm93IHQ7XG4gICAgICAgICAgICB9KSwgMCkpLCB0O1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0O1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjbGFzcyBacyBleHRlbmRzIHFzIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMuUXQgPSB0LCB0aGlzLmN1cnJlbnRTZXF1ZW5jZU51bWJlciA9IGU7XG4gICAgfVxufVxuXG5mdW5jdGlvbiB0aSh0LCBlKSB7XG4gICAgY29uc3QgbiA9IFUodCk7XG4gICAgcmV0dXJuIFFzLlN0KG4uUXQsIGUpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBIGJhdGNoIG9mIG11dGF0aW9ucyB0aGF0IHdpbGwgYmUgc2VudCBhcyBvbmUgdW5pdCB0byB0aGUgYmFja2VuZC5cbiAqLyBjbGFzcyBlaSB7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIGJhdGNoSWQgLSBUaGUgdW5pcXVlIElEIG9mIHRoaXMgbXV0YXRpb24gYmF0Y2guXG4gICAgICogQHBhcmFtIGxvY2FsV3JpdGVUaW1lIC0gVGhlIG9yaWdpbmFsIHdyaXRlIHRpbWUgb2YgdGhpcyBtdXRhdGlvbi5cbiAgICAgKiBAcGFyYW0gYmFzZU11dGF0aW9ucyAtIE11dGF0aW9ucyB0aGF0IGFyZSB1c2VkIHRvIHBvcHVsYXRlIHRoZSBiYXNlXG4gICAgICogdmFsdWVzIHdoZW4gdGhpcyBtdXRhdGlvbiBpcyBhcHBsaWVkIGxvY2FsbHkuIFRoaXMgY2FuIGJlIHVzZWQgdG8gbG9jYWxseVxuICAgICAqIG92ZXJ3cml0ZSB2YWx1ZXMgdGhhdCBhcmUgcGVyc2lzdGVkIGluIHRoZSByZW1vdGUgZG9jdW1lbnQgY2FjaGUuIEJhc2VcbiAgICAgKiBtdXRhdGlvbnMgYXJlIG5ldmVyIHNlbnQgdG8gdGhlIGJhY2tlbmQuXG4gICAgICogQHBhcmFtIG11dGF0aW9ucyAtIFRoZSB1c2VyLXByb3ZpZGVkIG11dGF0aW9ucyBpbiB0aGlzIG11dGF0aW9uIGJhdGNoLlxuICAgICAqIFVzZXItcHJvdmlkZWQgbXV0YXRpb25zIGFyZSBhcHBsaWVkIGJvdGggbG9jYWxseSBhbmQgcmVtb3RlbHkgb24gdGhlXG4gICAgICogYmFja2VuZC5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzKSB7XG4gICAgICAgIHRoaXMuYmF0Y2hJZCA9IHQsIHRoaXMubG9jYWxXcml0ZVRpbWUgPSBlLCB0aGlzLmJhc2VNdXRhdGlvbnMgPSBuLCB0aGlzLm11dGF0aW9ucyA9IHM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFwcGxpZXMgYWxsIHRoZSBtdXRhdGlvbnMgaW4gdGhpcyBNdXRhdGlvbkJhdGNoIHRvIHRoZSBzcGVjaWZpZWQgZG9jdW1lbnRcbiAgICAgKiB0byBjb21wdXRlIHRoZSBzdGF0ZSBvZiB0aGUgcmVtb3RlIGRvY3VtZW50XG4gICAgICpcbiAgICAgKiBAcGFyYW0gZG9jdW1lbnQgLSBUaGUgZG9jdW1lbnQgdG8gYXBwbHkgbXV0YXRpb25zIHRvLlxuICAgICAqIEBwYXJhbSBiYXRjaFJlc3VsdCAtIFRoZSByZXN1bHQgb2YgYXBwbHlpbmcgdGhlIE11dGF0aW9uQmF0Y2ggdG8gdGhlXG4gICAgICogYmFja2VuZC5cbiAgICAgKi8gICAgYXBwbHlUb1JlbW90ZURvY3VtZW50KHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IGUubXV0YXRpb25SZXN1bHRzO1xuICAgICAgICBmb3IgKGxldCBlID0gMDsgZSA8IHRoaXMubXV0YXRpb25zLmxlbmd0aDsgZSsrKSB7XG4gICAgICAgICAgICBjb25zdCBzID0gdGhpcy5tdXRhdGlvbnNbZV07XG4gICAgICAgICAgICBpZiAocy5rZXkuaXNFcXVhbCh0LmtleSkpIHtcbiAgICAgICAgICAgICAgICBIZShzLCB0LCBuW2VdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb21wdXRlcyB0aGUgbG9jYWwgdmlldyBvZiBhIGRvY3VtZW50IGdpdmVuIGFsbCB0aGUgbXV0YXRpb25zIGluIHRoaXNcbiAgICAgKiBiYXRjaC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBkb2N1bWVudCAtIFRoZSBkb2N1bWVudCB0byBhcHBseSBtdXRhdGlvbnMgdG8uXG4gICAgICovICAgIGFwcGx5VG9Mb2NhbFZpZXcodCkge1xuICAgICAgICAvLyBGaXJzdCwgYXBwbHkgdGhlIGJhc2Ugc3RhdGUuIFRoaXMgYWxsb3dzIHVzIHRvIGFwcGx5IG5vbi1pZGVtcG90ZW50XG4gICAgICAgIC8vIHRyYW5zZm9ybSBhZ2FpbnN0IGEgY29uc2lzdGVudCBzZXQgb2YgdmFsdWVzLlxuICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdGhpcy5iYXNlTXV0YXRpb25zKSBlLmtleS5pc0VxdWFsKHQua2V5KSAmJiBKZShlLCB0LCB0aGlzLmxvY2FsV3JpdGVUaW1lKTtcbiAgICAgICAgLy8gU2Vjb25kLCBhcHBseSBhbGwgdXNlci1wcm92aWRlZCBtdXRhdGlvbnMuXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHRoaXMubXV0YXRpb25zKSBlLmtleS5pc0VxdWFsKHQua2V5KSAmJiBKZShlLCB0LCB0aGlzLmxvY2FsV3JpdGVUaW1lKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29tcHV0ZXMgdGhlIGxvY2FsIHZpZXcgZm9yIGFsbCBwcm92aWRlZCBkb2N1bWVudHMgZ2l2ZW4gdGhlIG11dGF0aW9ucyBpblxuICAgICAqIHRoaXMgYmF0Y2guXG4gICAgICovICAgIGFwcGx5VG9Mb2NhbERvY3VtZW50U2V0KHQpIHtcbiAgICAgICAgLy8gVE9ETyhtcnNjaG1pZHQpOiBUaGlzIGltcGxlbWVudGF0aW9uIGlzIE8obl4yKS4gSWYgd2UgYXBwbHkgdGhlIG11dGF0aW9uc1xuICAgICAgICAvLyBkaXJlY3RseSAoYXMgZG9uZSBpbiBgYXBwbHlUb0xvY2FsVmlldygpYCksIHdlIGNhbiByZWR1Y2UgdGhlIGNvbXBsZXhpdHlcbiAgICAgICAgLy8gdG8gTyhuKS5cbiAgICAgICAgdGhpcy5tdXRhdGlvbnMuZm9yRWFjaCgoZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuID0gdC5nZXQoZS5rZXkpLCBzID0gbjtcbiAgICAgICAgICAgIC8vIFRPRE8obXV0YWJsZWRvY3VtZW50cyk6IFRoaXMgbWV0aG9kIHNob3VsZCB0YWtlIGEgTXV0YWJsZURvY3VtZW50TWFwXG4gICAgICAgICAgICAvLyBhbmQgd2Ugc2hvdWxkIHJlbW92ZSB0aGlzIGNhc3QuXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcGx5VG9Mb2NhbFZpZXcocyksIG4uaXNWYWxpZERvY3VtZW50KCkgfHwgcy5jb252ZXJ0VG9Ob0RvY3VtZW50KGl0Lm1pbigpKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBrZXlzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tdXRhdGlvbnMucmVkdWNlKCgodCwgZSkgPT4gdC5hZGQoZS5rZXkpKSwgUG4oKSk7XG4gICAgfVxuICAgIGlzRXF1YWwodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5iYXRjaElkID09PSB0LmJhdGNoSWQgJiYgZXQodGhpcy5tdXRhdGlvbnMsIHQubXV0YXRpb25zLCAoKHQsIGUpID0+IFhlKHQsIGUpKSkgJiYgZXQodGhpcy5iYXNlTXV0YXRpb25zLCB0LmJhc2VNdXRhdGlvbnMsICgodCwgZSkgPT4gWGUodCwgZSkpKTtcbiAgICB9XG59XG5cbi8qKiBUaGUgcmVzdWx0IG9mIGFwcGx5aW5nIGEgbXV0YXRpb24gYmF0Y2ggdG8gdGhlIGJhY2tlbmQuICovIGNsYXNzIG5pIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBcbiAgICAvKipcbiAgICAgKiBBIHByZS1jb21wdXRlZCBtYXBwaW5nIGZyb20gZWFjaCBtdXRhdGVkIGRvY3VtZW50IHRvIHRoZSByZXN1bHRpbmdcbiAgICAgKiB2ZXJzaW9uLlxuICAgICAqL1xuICAgIHMpIHtcbiAgICAgICAgdGhpcy5iYXRjaCA9IHQsIHRoaXMuY29tbWl0VmVyc2lvbiA9IGUsIHRoaXMubXV0YXRpb25SZXN1bHRzID0gbiwgdGhpcy5kb2NWZXJzaW9ucyA9IHM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgTXV0YXRpb25CYXRjaFJlc3VsdCBmb3IgdGhlIGdpdmVuIGJhdGNoIGFuZCByZXN1bHRzLiBUaGVyZVxuICAgICAqIG11c3QgYmUgb25lIHJlc3VsdCBmb3IgZWFjaCBtdXRhdGlvbiBpbiB0aGUgYmF0Y2guIFRoaXMgc3RhdGljIGZhY3RvcnlcbiAgICAgKiBjYWNoZXMgYSBkb2N1bWVudD0mZ3Q7dmVyc2lvbiBtYXBwaW5nIChkb2NWZXJzaW9ucykuXG4gICAgICovICAgIHN0YXRpYyBmcm9tKHQsIGUsIG4pIHtcbiAgICAgICAgTCh0Lm11dGF0aW9ucy5sZW5ndGggPT09IG4ubGVuZ3RoKTtcbiAgICAgICAgbGV0IHMgPSBBbigpO1xuICAgICAgICBjb25zdCBpID0gdC5tdXRhdGlvbnM7XG4gICAgICAgIGZvciAobGV0IHQgPSAwOyB0IDwgaS5sZW5ndGg7IHQrKykgcyA9IHMuaW5zZXJ0KGlbdF0ua2V5LCBuW3RdLnZlcnNpb24pO1xuICAgICAgICByZXR1cm4gbmV3IG5pKHQsIGUsIG4sIHMpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQW4gaW1tdXRhYmxlIHNldCBvZiBtZXRhZGF0YSB0aGF0IHRoZSBsb2NhbCBzdG9yZSB0cmFja3MgZm9yIGVhY2ggdGFyZ2V0LlxuICovIGNsYXNzIHNpIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKiogVGhlIHRhcmdldCBiZWluZyBsaXN0ZW5lZCB0by4gKi9cbiAgICB0LCBcbiAgICAvKipcbiAgICAgKiBUaGUgdGFyZ2V0IElEIHRvIHdoaWNoIHRoZSB0YXJnZXQgY29ycmVzcG9uZHM7IEFzc2lnbmVkIGJ5IHRoZVxuICAgICAqIExvY2FsU3RvcmUgZm9yIHVzZXIgbGlzdGVucyBhbmQgYnkgdGhlIFN5bmNFbmdpbmUgZm9yIGxpbWJvIHdhdGNoZXMuXG4gICAgICovXG4gICAgZSwgXG4gICAgLyoqIFRoZSBwdXJwb3NlIG9mIHRoZSB0YXJnZXQuICovXG4gICAgbiwgXG4gICAgLyoqXG4gICAgICogVGhlIHNlcXVlbmNlIG51bWJlciBvZiB0aGUgbGFzdCB0cmFuc2FjdGlvbiBkdXJpbmcgd2hpY2ggdGhpcyB0YXJnZXQgZGF0YVxuICAgICAqIHdhcyBtb2RpZmllZC5cbiAgICAgKi9cbiAgICBzLCBcbiAgICAvKiogVGhlIGxhdGVzdCBzbmFwc2hvdCB2ZXJzaW9uIHNlZW4gZm9yIHRoaXMgdGFyZ2V0LiAqL1xuICAgIGkgPSBpdC5taW4oKVxuICAgIC8qKlxuICAgICAqIFRoZSBtYXhpbXVtIHNuYXBzaG90IHZlcnNpb24gYXQgd2hpY2ggdGhlIGFzc29jaWF0ZWQgdmlld1xuICAgICAqIGNvbnRhaW5lZCBubyBsaW1ibyBkb2N1bWVudHMuXG4gICAgICovICwgciA9IGl0Lm1pbigpXG4gICAgLyoqXG4gICAgICogQW4gb3BhcXVlLCBzZXJ2ZXItYXNzaWduZWQgdG9rZW4gdGhhdCBhbGxvd3Mgd2F0Y2hpbmcgYSB0YXJnZXQgdG8gYmVcbiAgICAgKiByZXN1bWVkIGFmdGVyIGRpc2Nvbm5lY3Rpbmcgd2l0aG91dCByZXRyYW5zbWl0dGluZyBhbGwgdGhlIGRhdGEgdGhhdFxuICAgICAqIG1hdGNoZXMgdGhlIHRhcmdldC4gVGhlIHJlc3VtZSB0b2tlbiBlc3NlbnRpYWxseSBpZGVudGlmaWVzIGEgcG9pbnQgaW5cbiAgICAgKiB0aW1lIGZyb20gd2hpY2ggdGhlIHNlcnZlciBzaG91bGQgcmVzdW1lIHNlbmRpbmcgcmVzdWx0cy5cbiAgICAgKi8gLCBvID0gd3QuRU1QVFlfQllURV9TVFJJTkcpIHtcbiAgICAgICAgdGhpcy50YXJnZXQgPSB0LCB0aGlzLnRhcmdldElkID0gZSwgdGhpcy5wdXJwb3NlID0gbiwgdGhpcy5zZXF1ZW5jZU51bWJlciA9IHMsIHRoaXMuc25hcHNob3RWZXJzaW9uID0gaSwgXG4gICAgICAgIHRoaXMubGFzdExpbWJvRnJlZVNuYXBzaG90VmVyc2lvbiA9IHIsIHRoaXMucmVzdW1lVG9rZW4gPSBvO1xuICAgIH1cbiAgICAvKiogQ3JlYXRlcyBhIG5ldyB0YXJnZXQgZGF0YSBpbnN0YW5jZSB3aXRoIGFuIHVwZGF0ZWQgc2VxdWVuY2UgbnVtYmVyLiAqLyAgICB3aXRoU2VxdWVuY2VOdW1iZXIodCkge1xuICAgICAgICByZXR1cm4gbmV3IHNpKHRoaXMudGFyZ2V0LCB0aGlzLnRhcmdldElkLCB0aGlzLnB1cnBvc2UsIHQsIHRoaXMuc25hcHNob3RWZXJzaW9uLCB0aGlzLmxhc3RMaW1ib0ZyZWVTbmFwc2hvdFZlcnNpb24sIHRoaXMucmVzdW1lVG9rZW4pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IHRhcmdldCBkYXRhIGluc3RhbmNlIHdpdGggYW4gdXBkYXRlZCByZXN1bWUgdG9rZW4gYW5kXG4gICAgICogc25hcHNob3QgdmVyc2lvbi5cbiAgICAgKi8gICAgd2l0aFJlc3VtZVRva2VuKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBzaSh0aGlzLnRhcmdldCwgdGhpcy50YXJnZXRJZCwgdGhpcy5wdXJwb3NlLCB0aGlzLnNlcXVlbmNlTnVtYmVyLCBlLCB0aGlzLmxhc3RMaW1ib0ZyZWVTbmFwc2hvdFZlcnNpb24sIHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IHRhcmdldCBkYXRhIGluc3RhbmNlIHdpdGggYW4gdXBkYXRlZCBsYXN0IGxpbWJvIGZyZWVcbiAgICAgKiBzbmFwc2hvdCB2ZXJzaW9uIG51bWJlci5cbiAgICAgKi8gICAgd2l0aExhc3RMaW1ib0ZyZWVTbmFwc2hvdFZlcnNpb24odCkge1xuICAgICAgICByZXR1cm4gbmV3IHNpKHRoaXMudGFyZ2V0LCB0aGlzLnRhcmdldElkLCB0aGlzLnB1cnBvc2UsIHRoaXMuc2VxdWVuY2VOdW1iZXIsIHRoaXMuc25hcHNob3RWZXJzaW9uLCB0LCB0aGlzLnJlc3VtZVRva2VuKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKiogU2VyaWFsaXplciBmb3IgdmFsdWVzIHN0b3JlZCBpbiB0aGUgTG9jYWxTdG9yZS4gKi8gY2xhc3MgaWkge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5XdCA9IHQ7XG4gICAgfVxufVxuXG4vKiogRGVjb2RlcyBhIHJlbW90ZSBkb2N1bWVudCBmcm9tIHN0b3JhZ2UgbG9jYWxseSB0byBhIERvY3VtZW50LiAqLyBmdW5jdGlvbiByaSh0LCBlKSB7XG4gICAgaWYgKGUuZG9jdW1lbnQpIHJldHVybiBabih0Lld0LCBlLmRvY3VtZW50LCAhIWUuaGFzQ29tbWl0dGVkTXV0YXRpb25zKTtcbiAgICBpZiAoZS5ub0RvY3VtZW50KSB7XG4gICAgICAgIGNvbnN0IHQgPSBQdC5mcm9tU2VnbWVudHMoZS5ub0RvY3VtZW50LnBhdGgpLCBuID0gaGkoZS5ub0RvY3VtZW50LnJlYWRUaW1lKSwgcyA9IHF0Lm5ld05vRG9jdW1lbnQodCwgbik7XG4gICAgICAgIHJldHVybiBlLmhhc0NvbW1pdHRlZE11dGF0aW9ucyA/IHMuc2V0SGFzQ29tbWl0dGVkTXV0YXRpb25zKCkgOiBzO1xuICAgIH1cbiAgICBpZiAoZS51bmtub3duRG9jdW1lbnQpIHtcbiAgICAgICAgY29uc3QgdCA9IFB0LmZyb21TZWdtZW50cyhlLnVua25vd25Eb2N1bWVudC5wYXRoKSwgbiA9IGhpKGUudW5rbm93bkRvY3VtZW50LnZlcnNpb24pO1xuICAgICAgICByZXR1cm4gcXQubmV3VW5rbm93bkRvY3VtZW50KHQsIG4pO1xuICAgIH1cbiAgICByZXR1cm4gTSgpO1xufVxuXG4vKiogRW5jb2RlcyBhIGRvY3VtZW50IGZvciBzdG9yYWdlIGxvY2FsbHkuICovIGZ1bmN0aW9uIG9pKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gYWkobiksIGkgPSBlLmtleS5wYXRoLnBvcExhc3QoKS50b0FycmF5KCk7XG4gICAgaWYgKGUuaXNGb3VuZERvY3VtZW50KCkpIHtcbiAgICAgICAgY29uc3QgbiA9IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgbmFtZTogV24odCwgZS5rZXkpLFxuICAgICAgICAgICAgICAgIGZpZWxkczogZS5kYXRhLnZhbHVlLm1hcFZhbHVlLmZpZWxkcyxcbiAgICAgICAgICAgICAgICB1cGRhdGVUaW1lOiBCbih0LCBlLnZlcnNpb24udG9UaW1lc3RhbXAoKSlcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0odC5XdCwgZSksIHIgPSBlLmhhc0NvbW1pdHRlZE11dGF0aW9ucztcbiAgICAgICAgcmV0dXJuIG5ldyBDcyhcbiAgICAgICAgLyogdW5rbm93bkRvY3VtZW50PSAqLyBudWxsLCBcbiAgICAgICAgLyogbm9Eb2N1bWVudD0gKi8gbnVsbCwgbiwgciwgcywgaSk7XG4gICAgfVxuICAgIGlmIChlLmlzTm9Eb2N1bWVudCgpKSB7XG4gICAgICAgIGNvbnN0IHQgPSBlLmtleS5wYXRoLnRvQXJyYXkoKSwgbiA9IHVpKGUudmVyc2lvbiksIHIgPSBlLmhhc0NvbW1pdHRlZE11dGF0aW9ucztcbiAgICAgICAgcmV0dXJuIG5ldyBDcyhcbiAgICAgICAgLyogdW5rbm93bkRvY3VtZW50PSAqLyBudWxsLCBuZXcgU3ModCwgbiksIFxuICAgICAgICAvKiBkb2N1bWVudD0gKi8gbnVsbCwgciwgcywgaSk7XG4gICAgfVxuICAgIGlmIChlLmlzVW5rbm93bkRvY3VtZW50KCkpIHtcbiAgICAgICAgY29uc3QgdCA9IGUua2V5LnBhdGgudG9BcnJheSgpLCBuID0gdWkoZS52ZXJzaW9uKTtcbiAgICAgICAgcmV0dXJuIG5ldyBDcyhuZXcgRHModCwgbiksIFxuICAgICAgICAvKiBub0RvY3VtZW50PSAqLyBudWxsLCBcbiAgICAgICAgLyogZG9jdW1lbnQ9ICovIG51bGwsIFxuICAgICAgICAvKiBoYXNDb21taXR0ZWRNdXRhdGlvbnM9ICovICEwLCBzLCBpKTtcbiAgICB9XG4gICAgcmV0dXJuIE0oKTtcbn1cblxuZnVuY3Rpb24gYWkodCkge1xuICAgIGNvbnN0IGUgPSB0LnRvVGltZXN0YW1wKCk7XG4gICAgcmV0dXJuIFsgZS5zZWNvbmRzLCBlLm5hbm9zZWNvbmRzIF07XG59XG5cbmZ1bmN0aW9uIGNpKHQpIHtcbiAgICBjb25zdCBlID0gbmV3IHN0KHRbMF0sIHRbMV0pO1xuICAgIHJldHVybiBpdC5mcm9tVGltZXN0YW1wKGUpO1xufVxuXG5mdW5jdGlvbiB1aSh0KSB7XG4gICAgY29uc3QgZSA9IHQudG9UaW1lc3RhbXAoKTtcbiAgICByZXR1cm4gbmV3IFJzKGUuc2Vjb25kcywgZS5uYW5vc2Vjb25kcyk7XG59XG5cbmZ1bmN0aW9uIGhpKHQpIHtcbiAgICBjb25zdCBlID0gbmV3IHN0KHQuc2Vjb25kcywgdC5uYW5vc2Vjb25kcyk7XG4gICAgcmV0dXJuIGl0LmZyb21UaW1lc3RhbXAoZSk7XG59XG5cbi8qKiBFbmNvZGVzIGEgYmF0Y2ggb2YgbXV0YXRpb25zIGludG8gYSBEYk11dGF0aW9uQmF0Y2ggZm9yIGxvY2FsIHN0b3JhZ2UuICovXG4vKiogRGVjb2RlcyBhIERiTXV0YXRpb25CYXRjaCBpbnRvIGEgTXV0YXRpb25CYXRjaCAqL1xuZnVuY3Rpb24gbGkodCwgZSkge1xuICAgIGNvbnN0IG4gPSAoZS5iYXNlTXV0YXRpb25zIHx8IFtdKS5tYXAoKGUgPT4gc3ModC5XdCwgZSkpKTtcbiAgICAvLyBTcXVhc2ggb2xkIHRyYW5zZm9ybSBtdXRhdGlvbnMgaW50byBleGlzdGluZyBwYXRjaCBvciBzZXQgbXV0YXRpb25zLlxuICAgIC8vIFRoZSByZXBsYWNlbWVudCBvZiByZXByZXNlbnRpbmcgYHRyYW5zZm9ybXNgIHdpdGggYHVwZGF0ZV90cmFuc2Zvcm1zYFxuICAgIC8vIG9uIHRoZSBTREsgbWVhbnMgdGhhdCBvbGQgYHRyYW5zZm9ybWAgbXV0YXRpb25zIHN0b3JlZCBpbiBJbmRleGVkREIgbmVlZFxuICAgIC8vIHRvIGJlIHVwZGF0ZWQgdG8gYHVwZGF0ZV90cmFuc2Zvcm1zYC5cbiAgICAvLyBUT0RPKGIvMTc0NjA4Mzc0KTogUmVtb3ZlIHRoaXMgY29kZSBvbmNlIHdlIHBlcmZvcm0gYSBzY2hlbWEgbWlncmF0aW9uLlxuICAgICAgICBmb3IgKGxldCB0ID0gMDsgdCA8IGUubXV0YXRpb25zLmxlbmd0aCAtIDE7ICsrdCkge1xuICAgICAgICBjb25zdCBuID0gZS5tdXRhdGlvbnNbdF07XG4gICAgICAgIGlmICh0ICsgMSA8IGUubXV0YXRpb25zLmxlbmd0aCAmJiB2b2lkIDAgIT09IGUubXV0YXRpb25zW3QgKyAxXS50cmFuc2Zvcm0pIHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBlLm11dGF0aW9uc1t0ICsgMV07XG4gICAgICAgICAgICBuLnVwZGF0ZVRyYW5zZm9ybXMgPSBzLnRyYW5zZm9ybS5maWVsZFRyYW5zZm9ybXMsIGUubXV0YXRpb25zLnNwbGljZSh0ICsgMSwgMSksIFxuICAgICAgICAgICAgKyt0O1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0IHMgPSBlLm11dGF0aW9ucy5tYXAoKGUgPT4gc3ModC5XdCwgZSkpKSwgaSA9IHN0LmZyb21NaWxsaXMoZS5sb2NhbFdyaXRlVGltZU1zKTtcbiAgICByZXR1cm4gbmV3IGVpKGUuYmF0Y2hJZCwgaSwgbiwgcyk7XG59XG5cbi8qKiBEZWNvZGVzIGEgRGJUYXJnZXQgaW50byBUYXJnZXREYXRhICovIGZ1bmN0aW9uIGZpKHQpIHtcbiAgICBjb25zdCBlID0gaGkodC5yZWFkVGltZSksIG4gPSB2b2lkIDAgIT09IHQubGFzdExpbWJvRnJlZVNuYXBzaG90VmVyc2lvbiA/IGhpKHQubGFzdExpbWJvRnJlZVNuYXBzaG90VmVyc2lvbikgOiBpdC5taW4oKTtcbiAgICBsZXQgcztcbiAgICB2YXIgaTtcbiAgICByZXR1cm4gdm9pZCAwICE9PSB0LnF1ZXJ5LmRvY3VtZW50cyA/IChMKDEgPT09IChpID0gdC5xdWVyeSkuZG9jdW1lbnRzLmxlbmd0aCksIFxuICAgIHMgPSBFZShkZShIbihpLmRvY3VtZW50c1swXSkpKSkgOiBzID0gZnVuY3Rpb24odCkge1xuICAgICAgICByZXR1cm4gRWUoYXModCkpO1xuICAgIH0odC5xdWVyeSksIG5ldyBzaShzLCB0LnRhcmdldElkLCAwIC8qIExpc3RlbiAqLyAsIHQubGFzdExpc3RlblNlcXVlbmNlTnVtYmVyLCBlLCBuLCB3dC5mcm9tQmFzZTY0U3RyaW5nKHQucmVzdW1lVG9rZW4pKTtcbn1cblxuLyoqIEVuY29kZXMgVGFyZ2V0RGF0YSBpbnRvIGEgRGJUYXJnZXQgZm9yIHN0b3JhZ2UgbG9jYWxseS4gKi8gZnVuY3Rpb24gZGkodCwgZSkge1xuICAgIGNvbnN0IG4gPSB1aShlLnNuYXBzaG90VmVyc2lvbiksIHMgPSB1aShlLmxhc3RMaW1ib0ZyZWVTbmFwc2hvdFZlcnNpb24pO1xuICAgIGxldCBpO1xuICAgIGkgPSB6dChlLnRhcmdldCkgPyBycyh0Lld0LCBlLnRhcmdldCkgOiBvcyh0Lld0LCBlLnRhcmdldCk7XG4gICAgLy8gV2UgY2FuJ3Qgc3RvcmUgdGhlIHJlc3VtZVRva2VuIGFzIGEgQnl0ZVN0cmluZyBpbiBJbmRleGVkRGIsIHNvIHdlXG4gICAgLy8gY29udmVydCBpdCB0byBhIGJhc2U2NCBzdHJpbmcgZm9yIHN0b3JhZ2UuXG4gICAgICAgIGNvbnN0IHIgPSBlLnJlc3VtZVRva2VuLnRvQmFzZTY0KCk7XG4gICAgLy8gbGFzdExpc3RlblNlcXVlbmNlTnVtYmVyIGlzIGFsd2F5cyAwIHVudGlsIHdlIGRvIHJlYWwgR0MuXG4gICAgICAgIHJldHVybiBuZXcgeHMoZS50YXJnZXRJZCwgUXQoZS50YXJnZXQpLCBuLCByLCBlLnNlcXVlbmNlTnVtYmVyLCBzLCBpKTtcbn1cblxuLyoqXG4gKiBBIGhlbHBlciBmdW5jdGlvbiBmb3IgZmlndXJpbmcgb3V0IHdoYXQga2luZCBvZiBxdWVyeSBoYXMgYmVlbiBzdG9yZWQuXG4gKi9cbi8qKlxuICogRW5jb2RlcyBhIGBCdW5kbGVkUXVlcnlgIGZyb20gYnVuZGxlIHByb3RvIHRvIGEgUXVlcnkgb2JqZWN0LlxuICpcbiAqIFRoaXMgcmVjb25zdHJ1Y3RzIHRoZSBvcmlnaW5hbCBxdWVyeSB1c2VkIHRvIGJ1aWxkIHRoZSBidW5kbGUgYmVpbmcgbG9hZGVkLFxuICogaW5jbHVkaW5nIGZlYXR1cmVzIGV4aXN0cyBvbmx5IGluIFNES3MgKGZvciBleGFtcGxlOiBsaW1pdC10by1sYXN0KS5cbiAqL1xuZnVuY3Rpb24gd2kodCkge1xuICAgIGNvbnN0IGUgPSBhcyh7XG4gICAgICAgIHBhcmVudDogdC5wYXJlbnQsXG4gICAgICAgIHN0cnVjdHVyZWRRdWVyeTogdC5zdHJ1Y3R1cmVkUXVlcnlcbiAgICB9KTtcbiAgICByZXR1cm4gXCJMQVNUXCIgPT09IHQubGltaXRUeXBlID8gVGUoZSwgZS5saW1pdCwgXCJMXCIgLyogTGFzdCAqLykgOiBlO1xufVxuXG4vKiogRW5jb2RlcyBhIE5hbWVkUXVlcnkgcHJvdG8gb2JqZWN0IHRvIGEgTmFtZWRRdWVyeSBtb2RlbCBvYmplY3QuICovXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY2xhc3MgX2kge1xuICAgIGdldEJ1bmRsZU1ldGFkYXRhKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIG1pKHQpLmdldChlKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgIGlmICh0KSByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGlkOiAoZSA9IHQpLmJ1bmRsZUlkLFxuICAgICAgICAgICAgICAgIGNyZWF0ZVRpbWU6IGhpKGUuY3JlYXRlVGltZSksXG4gICAgICAgICAgICAgICAgdmVyc2lvbjogZS52ZXJzaW9uXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgLyoqIEVuY29kZXMgYSBEYkJ1bmRsZSB0byBhIEJ1bmRsZU1ldGFkYXRhIG9iamVjdC4gKi9cbiAgICAgICAgICAgIHZhciBlO1xuICAgICAgICAgICAgLyoqIEVuY29kZXMgYSBCdW5kbGVNZXRhZGF0YSB0byBhIERiQnVuZGxlLiAqLyAgICAgICAgfSkpO1xuICAgIH1cbiAgICBzYXZlQnVuZGxlTWV0YWRhdGEodCwgZSkge1xuICAgICAgICByZXR1cm4gbWkodCkucHV0KHtcbiAgICAgICAgICAgIGJ1bmRsZUlkOiAobiA9IGUpLmlkLFxuICAgICAgICAgICAgY3JlYXRlVGltZTogdWkoS24obi5jcmVhdGVUaW1lKSksXG4gICAgICAgICAgICB2ZXJzaW9uOiBuLnZlcnNpb25cbiAgICAgICAgfSk7XG4gICAgICAgIHZhciBuO1xuICAgICAgICAvKiogRW5jb2RlcyBhIERiTmFtZWRRdWVyeSB0byBhIE5hbWVkUXVlcnkuICovICAgIH1cbiAgICBnZXROYW1lZFF1ZXJ5KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIGdpKHQpLmdldChlKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgIGlmICh0KSByZXR1cm4ge1xuICAgICAgICAgICAgICAgIG5hbWU6IChlID0gdCkubmFtZSxcbiAgICAgICAgICAgICAgICBxdWVyeTogd2koZS5idW5kbGVkUXVlcnkpLFxuICAgICAgICAgICAgICAgIHJlYWRUaW1lOiBoaShlLnJlYWRUaW1lKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBlO1xuICAgICAgICAgICAgLyoqIEVuY29kZXMgYSBOYW1lZFF1ZXJ5IGZyb20gYSBidW5kbGUgcHJvdG8gdG8gYSBEYk5hbWVkUXVlcnkuICovICAgICAgICB9KSk7XG4gICAgfVxuICAgIHNhdmVOYW1lZFF1ZXJ5KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIGdpKHQpLnB1dChmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIG5hbWU6IHQubmFtZSxcbiAgICAgICAgICAgICAgICByZWFkVGltZTogdWkoS24odC5yZWFkVGltZSkpLFxuICAgICAgICAgICAgICAgIGJ1bmRsZWRRdWVyeTogdC5idW5kbGVkUXVlcnlcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0oZSkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIGJ1bmRsZXMgb2JqZWN0IHN0b3JlLlxuICovIGZ1bmN0aW9uIG1pKHQpIHtcbiAgICByZXR1cm4gdGkodCwgTXMuc3RvcmUpO1xufVxuXG4vKipcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgbmFtZWRRdWVyaWVzIG9iamVjdCBzdG9yZS5cbiAqLyBmdW5jdGlvbiBnaSh0KSB7XG4gICAgcmV0dXJuIHRpKHQsIExzLnN0b3JlKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQW4gaW4tbWVtb3J5IGltcGxlbWVudGF0aW9uIG9mIEluZGV4TWFuYWdlci5cbiAqLyBjbGFzcyB5aSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuR3QgPSBuZXcgcGk7XG4gICAgfVxuICAgIGFkZFRvQ29sbGVjdGlvblBhcmVudEluZGV4KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuR3QuYWRkKGUpLCBLcy5yZXNvbHZlKCk7XG4gICAgfVxuICAgIGdldENvbGxlY3Rpb25QYXJlbnRzKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIEtzLnJlc29sdmUodGhpcy5HdC5nZXRFbnRyaWVzKGUpKTtcbiAgICB9XG59XG5cbi8qKlxuICogSW50ZXJuYWwgaW1wbGVtZW50YXRpb24gb2YgdGhlIGNvbGxlY3Rpb24tcGFyZW50IGluZGV4IGV4cG9zZWQgYnkgTWVtb3J5SW5kZXhNYW5hZ2VyLlxuICogQWxzbyB1c2VkIGZvciBpbi1tZW1vcnkgY2FjaGluZyBieSBJbmRleGVkRGJJbmRleE1hbmFnZXIgYW5kIGluaXRpYWwgaW5kZXggcG9wdWxhdGlvblxuICogaW4gaW5kZXhlZGRiX3NjaGVtYS50c1xuICovIGNsYXNzIHBpIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5pbmRleCA9IHt9O1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIGZhbHNlIGlmIHRoZSBlbnRyeSBhbHJlYWR5IGV4aXN0ZWQuXG4gICAgYWRkKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHQubGFzdFNlZ21lbnQoKSwgbiA9IHQucG9wTGFzdCgpLCBzID0gdGhpcy5pbmRleFtlXSB8fCBuZXcgbW4odXQuY29tcGFyYXRvciksIGkgPSAhcy5oYXMobik7XG4gICAgICAgIHJldHVybiB0aGlzLmluZGV4W2VdID0gcy5hZGQobiksIGk7XG4gICAgfVxuICAgIGhhcyh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0Lmxhc3RTZWdtZW50KCksIG4gPSB0LnBvcExhc3QoKSwgcyA9IHRoaXMuaW5kZXhbZV07XG4gICAgICAgIHJldHVybiBzICYmIHMuaGFzKG4pO1xuICAgIH1cbiAgICBnZXRFbnRyaWVzKHQpIHtcbiAgICAgICAgcmV0dXJuICh0aGlzLmluZGV4W3RdIHx8IG5ldyBtbih1dC5jb21wYXJhdG9yKSkudG9BcnJheSgpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSBwZXJzaXN0ZWQgaW1wbGVtZW50YXRpb24gb2YgSW5kZXhNYW5hZ2VyLlxuICovIGNsYXNzIEVpIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEFuIGluLW1lbW9yeSBjb3B5IG9mIHRoZSBpbmRleCBlbnRyaWVzIHdlJ3ZlIGFscmVhZHkgd3JpdHRlbiBzaW5jZSB0aGUgU0RLXG4gICAgICAgICAqIGxhdW5jaGVkLiBVc2VkIHRvIGF2b2lkIHJlLXdyaXRpbmcgdGhlIHNhbWUgZW50cnkgcmVwZWF0ZWRseS5cbiAgICAgICAgICpcbiAgICAgICAgICogVGhpcyBpcyAqTk9UKiBhIGNvbXBsZXRlIGNhY2hlIG9mIHdoYXQncyBpbiBwZXJzaXN0ZW5jZSBhbmQgc28gY2FuIG5ldmVyIGJlIHVzZWQgdG9cbiAgICAgICAgICogc2F0aXNmeSByZWFkcy5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuenQgPSBuZXcgcGk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZHMgYSBuZXcgZW50cnkgdG8gdGhlIGNvbGxlY3Rpb24gcGFyZW50IGluZGV4LlxuICAgICAqXG4gICAgICogUmVwZWF0ZWQgY2FsbHMgZm9yIHRoZSBzYW1lIGNvbGxlY3Rpb25QYXRoIHNob3VsZCBiZSBhdm9pZGVkIHdpdGhpbiBhXG4gICAgICogdHJhbnNhY3Rpb24gYXMgSW5kZXhlZERiSW5kZXhNYW5hZ2VyIG9ubHkgY2FjaGVzIHdyaXRlcyBvbmNlIGEgdHJhbnNhY3Rpb25cbiAgICAgKiBoYXMgYmVlbiBjb21taXR0ZWQuXG4gICAgICovICAgIGFkZFRvQ29sbGVjdGlvblBhcmVudEluZGV4KHQsIGUpIHtcbiAgICAgICAgaWYgKCF0aGlzLnp0LmhhcyhlKSkge1xuICAgICAgICAgICAgY29uc3QgbiA9IGUubGFzdFNlZ21lbnQoKSwgcyA9IGUucG9wTGFzdCgpO1xuICAgICAgICAgICAgdC5hZGRPbkNvbW1pdHRlZExpc3RlbmVyKCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gQWRkIHRoZSBjb2xsZWN0aW9uIHRvIHRoZSBpbiBtZW1vcnkgY2FjaGUgb25seSBpZiB0aGUgdHJhbnNhY3Rpb24gd2FzXG4gICAgICAgICAgICAgICAgLy8gc3VjY2Vzc2Z1bGx5IGNvbW1pdHRlZC5cbiAgICAgICAgICAgICAgICB0aGlzLnp0LmFkZChlKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIGNvbnN0IGkgPSB7XG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbklkOiBuLFxuICAgICAgICAgICAgICAgIHBhcmVudDogRXMocylcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gVGkodCkucHV0KGkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBLcy5yZXNvbHZlKCk7XG4gICAgfVxuICAgIGdldENvbGxlY3Rpb25QYXJlbnRzKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IFtdLCBzID0gSURCS2V5UmFuZ2UuYm91bmQoWyBlLCBcIlwiIF0sIFsgbnQoZSksIFwiXCIgXSwgXG4gICAgICAgIC8qbG93ZXJPcGVuPSovICExLCBcbiAgICAgICAgLyp1cHBlck9wZW49Ki8gITApO1xuICAgICAgICByZXR1cm4gVGkodCkuTHQocykubmV4dCgodCA9PiB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHMgb2YgdCkge1xuICAgICAgICAgICAgICAgIC8vIFRoaXMgY29sbGVjdGlvbklkIGd1YXJkIHNob3VsZG4ndCBiZSBuZWNlc3NhcnkgKGFuZCBpc24ndCBhcyBsb25nXG4gICAgICAgICAgICAgICAgLy8gYXMgd2UncmUgcnVubmluZyBpbiBhIHJlYWwgYnJvd3NlciksIGJ1dCB0aGVyZSdzIGEgYnVnIGluXG4gICAgICAgICAgICAgICAgLy8gaW5kZXhlZGRic2hpbSB0aGF0IGJyZWFrcyBvdXIgcmFuZ2UgaW4gb3VyIHRlc3RzIHJ1bm5pbmcgaW4gbm9kZTpcbiAgICAgICAgICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vYXhlbWNsaW9uL0luZGV4ZWREQlNoaW0vaXNzdWVzLzMzNFxuICAgICAgICAgICAgICAgIGlmIChzLmNvbGxlY3Rpb25JZCAhPT0gZSkgYnJlYWs7XG4gICAgICAgICAgICAgICAgbi5wdXNoKEFzKHMucGFyZW50KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbjtcbiAgICAgICAgfSkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIGNvbGxlY3Rpb25QYXJlbnRzXG4gKiBkb2N1bWVudCBzdG9yZS5cbiAqLyBmdW5jdGlvbiBUaSh0KSB7XG4gICAgcmV0dXJuIHRpKHQsIE9zLnN0b3JlKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTggR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY29uc3QgSWkgPSB7XG4gICAgZGlkUnVuOiAhMSxcbiAgICBzZXF1ZW5jZU51bWJlcnNDb2xsZWN0ZWQ6IDAsXG4gICAgdGFyZ2V0c1JlbW92ZWQ6IDAsXG4gICAgZG9jdW1lbnRzUmVtb3ZlZDogMFxufTtcblxuY2xhc3MgQWkge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8vIFdoZW4gd2UgYXR0ZW1wdCB0byBjb2xsZWN0LCB3ZSB3aWxsIG9ubHkgZG8gc28gaWYgdGhlIGNhY2hlIHNpemUgaXMgZ3JlYXRlciB0aGFuIHRoaXNcbiAgICAvLyB0aHJlc2hvbGQuIFBhc3NpbmcgYENPTExFQ1RJT05fRElTQUJMRURgIGhlcmUgd2lsbCBjYXVzZSBjb2xsZWN0aW9uIHRvIGFsd2F5cyBiZSBza2lwcGVkLlxuICAgIHQsIFxuICAgIC8vIFRoZSBwZXJjZW50YWdlIG9mIHNlcXVlbmNlIG51bWJlcnMgdGhhdCB3ZSB3aWxsIGF0dGVtcHQgdG8gY29sbGVjdFxuICAgIGUsIFxuICAgIC8vIEEgY2FwIG9uIHRoZSB0b3RhbCBudW1iZXIgb2Ygc2VxdWVuY2UgbnVtYmVycyB0aGF0IHdpbGwgYmUgY29sbGVjdGVkLiBUaGlzIHByZXZlbnRzXG4gICAgLy8gdXMgZnJvbSBjb2xsZWN0aW5nIGEgaHVnZSBudW1iZXIgb2Ygc2VxdWVuY2UgbnVtYmVycyBpZiB0aGUgY2FjaGUgaGFzIGdyb3duIHZlcnkgbGFyZ2UuXG4gICAgbikge1xuICAgICAgICB0aGlzLmNhY2hlU2l6ZUNvbGxlY3Rpb25UaHJlc2hvbGQgPSB0LCB0aGlzLnBlcmNlbnRpbGVUb0NvbGxlY3QgPSBlLCB0aGlzLm1heGltdW1TZXF1ZW5jZU51bWJlcnNUb0NvbGxlY3QgPSBuO1xuICAgIH1cbiAgICBzdGF0aWMgd2l0aENhY2hlU2l6ZSh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgQWkodCwgQWkuREVGQVVMVF9DT0xMRUNUSU9OX1BFUkNFTlRJTEUsIEFpLkRFRkFVTFRfTUFYX1NFUVVFTkNFX05VTUJFUlNfVE9fQ09MTEVDVCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBEZWxldGUgYSBtdXRhdGlvbiBiYXRjaCBhbmQgdGhlIGFzc29jaWF0ZWQgZG9jdW1lbnQgbXV0YXRpb25zLlxuICogQHJldHVybnMgQSBQZXJzaXN0ZW5jZVByb21pc2Ugb2YgdGhlIGRvY3VtZW50IG11dGF0aW9ucyB0aGF0IHdlcmUgcmVtb3ZlZC5cbiAqL1xuZnVuY3Rpb24gUmkodCwgZSwgbikge1xuICAgIGNvbnN0IHMgPSB0LnN0b3JlKHZzLnN0b3JlKSwgaSA9IHQuc3RvcmUoVnMuc3RvcmUpLCByID0gW10sIG8gPSBJREJLZXlSYW5nZS5vbmx5KG4uYmF0Y2hJZCk7XG4gICAgbGV0IGEgPSAwO1xuICAgIGNvbnN0IGMgPSBzLkt0KHtcbiAgICAgICAgcmFuZ2U6IG9cbiAgICB9LCAoKHQsIGUsIG4pID0+IChhKyssIG4uZGVsZXRlKCkpKSk7XG4gICAgci5wdXNoKGMubmV4dCgoKCkgPT4ge1xuICAgICAgICBMKDEgPT09IGEpO1xuICAgIH0pKSk7XG4gICAgY29uc3QgdSA9IFtdO1xuICAgIGZvciAoY29uc3QgdCBvZiBuLm11dGF0aW9ucykge1xuICAgICAgICBjb25zdCBzID0gVnMua2V5KGUsIHQua2V5LnBhdGgsIG4uYmF0Y2hJZCk7XG4gICAgICAgIHIucHVzaChpLmRlbGV0ZShzKSksIHUucHVzaCh0LmtleSk7XG4gICAgfVxuICAgIHJldHVybiBLcy53YWl0Rm9yKHIpLm5leHQoKCgpID0+IHUpKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGFuIGFwcHJveGltYXRlIHNpemUgZm9yIHRoZSBnaXZlbiBkb2N1bWVudC5cbiAqLyBmdW5jdGlvbiBQaSh0KSB7XG4gICAgaWYgKCF0KSByZXR1cm4gMDtcbiAgICBsZXQgZTtcbiAgICBpZiAodC5kb2N1bWVudCkgZSA9IHQuZG9jdW1lbnQ7IGVsc2UgaWYgKHQudW5rbm93bkRvY3VtZW50KSBlID0gdC51bmtub3duRG9jdW1lbnQ7IGVsc2Uge1xuICAgICAgICBpZiAoIXQubm9Eb2N1bWVudCkgdGhyb3cgTSgpO1xuICAgICAgICBlID0gdC5ub0RvY3VtZW50O1xuICAgIH1cbiAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoZSkubGVuZ3RoO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqIEEgbXV0YXRpb24gcXVldWUgZm9yIGEgc3BlY2lmaWMgdXNlciwgYmFja2VkIGJ5IEluZGV4ZWREQi4gKi8gQWkuREVGQVVMVF9DT0xMRUNUSU9OX1BFUkNFTlRJTEUgPSAxMCwgXG5BaS5ERUZBVUxUX01BWF9TRVFVRU5DRV9OVU1CRVJTX1RPX0NPTExFQ1QgPSAxZTMsIEFpLkRFRkFVTFQgPSBuZXcgQWkoNDE5NDMwNDAsIEFpLkRFRkFVTFRfQ09MTEVDVElPTl9QRVJDRU5USUxFLCBBaS5ERUZBVUxUX01BWF9TRVFVRU5DRV9OVU1CRVJTX1RPX0NPTExFQ1QpLCBcbkFpLkRJU0FCTEVEID0gbmV3IEFpKC0xLCAwLCAwKTtcblxuY2xhc3MgYmkge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIFRoZSBub3JtYWxpemVkIHVzZXJJZCAoZS5nLiBudWxsIFVJRCA9PiBcIlwiIHVzZXJJZCkgdXNlZCB0byBzdG9yZSAvXG4gICAgICogcmV0cmlldmUgbXV0YXRpb25zLlxuICAgICAqL1xuICAgIHQsIGUsIG4sIHMpIHtcbiAgICAgICAgdGhpcy51c2VySWQgPSB0LCB0aGlzLk4gPSBlLCB0aGlzLkh0ID0gbiwgdGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZSA9IHMsIFxuICAgICAgICAvKipcbiAgICAgICAgICogQ2FjaGVzIHRoZSBkb2N1bWVudCBrZXlzIGZvciBwZW5kaW5nIG11dGF0aW9uIGJhdGNoZXMuIElmIHRoZSBtdXRhdGlvblxuICAgICAgICAgKiBoYXMgYmVlbiByZW1vdmVkIGZyb20gSW5kZXhlZERiLCB0aGUgY2FjaGVkIHZhbHVlIG1heSBjb250aW51ZSB0b1xuICAgICAgICAgKiBiZSB1c2VkIHRvIHJldHJpZXZlIHRoZSBiYXRjaCdzIGRvY3VtZW50IGtleXMuIFRvIHJlbW92ZSBhIGNhY2hlZCB2YWx1ZVxuICAgICAgICAgKiBsb2NhbGx5LCBgcmVtb3ZlQ2FjaGVkTXV0YXRpb25LZXlzKClgIHNob3VsZCBiZSBpbnZva2VkIGVpdGhlciBkaXJlY3RseVxuICAgICAgICAgKiBvciB0aHJvdWdoIGByZW1vdmVNdXRhdGlvbkJhdGNoZXMoKWAuXG4gICAgICAgICAqXG4gICAgICAgICAqIFdpdGggbXVsdGktdGFiLCB3aGVuIHRoZSBwcmltYXJ5IGNsaWVudCBhY2tub3dsZWRnZXMgb3IgcmVqZWN0cyBhIG11dGF0aW9uLFxuICAgICAgICAgKiB0aGlzIGNhY2hlIGlzIHVzZWQgYnkgc2Vjb25kYXJ5IGNsaWVudHMgdG8gaW52YWxpZGF0ZSB0aGUgbG9jYWxcbiAgICAgICAgICogdmlldyBvZiB0aGUgZG9jdW1lbnRzIHRoYXQgd2VyZSBwcmV2aW91c2x5IGFmZmVjdGVkIGJ5IHRoZSBtdXRhdGlvbi5cbiAgICAgICAgICovXG4gICAgICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHkuXG4gICAgICAgIHRoaXMuSnQgPSB7fTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyBtdXRhdGlvbiBxdWV1ZSBmb3IgdGhlIGdpdmVuIHVzZXIuXG4gICAgICogQHBhcmFtIHVzZXIgLSBUaGUgdXNlciBmb3Igd2hpY2ggdG8gY3JlYXRlIGEgbXV0YXRpb24gcXVldWUuXG4gICAgICogQHBhcmFtIHNlcmlhbGl6ZXIgLSBUaGUgc2VyaWFsaXplciB0byB1c2Ugd2hlbiBwZXJzaXN0aW5nIHRvIEluZGV4ZWREYi5cbiAgICAgKi8gICAgc3RhdGljIFl0KHQsIGUsIG4sIHMpIHtcbiAgICAgICAgLy8gVE9ETyhtY2cpOiBGaWd1cmUgb3V0IHdoYXQgY29uc3RyYWludHMgdGhlcmUgYXJlIG9uIHVzZXJJRHNcbiAgICAgICAgLy8gSW4gcGFydGljdWxhciwgYXJlIHRoZXJlIGFueSByZXNlcnZlZCBjaGFyYWN0ZXJzPyBhcmUgZW1wdHkgaWRzIGFsbG93ZWQ/XG4gICAgICAgIC8vIEZvciB0aGUgbW9tZW50IHN0b3JlIHRoZXNlIHRvZ2V0aGVyIGluIHRoZSBzYW1lIG11dGF0aW9ucyB0YWJsZSBhc3N1bWluZ1xuICAgICAgICAvLyB0aGF0IGVtcHR5IHVzZXJJRHMgYXJlbid0IGFsbG93ZWQuXG4gICAgICAgIEwoXCJcIiAhPT0gdC51aWQpO1xuICAgICAgICBjb25zdCBpID0gdC5pc0F1dGhlbnRpY2F0ZWQoKSA/IHQudWlkIDogXCJcIjtcbiAgICAgICAgcmV0dXJuIG5ldyBiaShpLCBlLCBuLCBzKTtcbiAgICB9XG4gICAgY2hlY2tFbXB0eSh0KSB7XG4gICAgICAgIGxldCBlID0gITA7XG4gICAgICAgIGNvbnN0IG4gPSBJREJLZXlSYW5nZS5ib3VuZChbIHRoaXMudXNlcklkLCBOdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFkgXSwgWyB0aGlzLnVzZXJJZCwgTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZIF0pO1xuICAgICAgICByZXR1cm4gVmkodCkuS3Qoe1xuICAgICAgICAgICAgaW5kZXg6IHZzLnVzZXJNdXRhdGlvbnNJbmRleCxcbiAgICAgICAgICAgIHJhbmdlOiBuXG4gICAgICAgIH0sICgodCwgbiwgcykgPT4ge1xuICAgICAgICAgICAgZSA9ICExLCBzLmRvbmUoKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IGUpKTtcbiAgICB9XG4gICAgYWRkTXV0YXRpb25CYXRjaCh0LCBlLCBuLCBzKSB7XG4gICAgICAgIGNvbnN0IGkgPSBTaSh0KSwgciA9IFZpKHQpO1xuICAgICAgICAvLyBUaGUgSW5kZXhlZERiIGltcGxlbWVudGF0aW9uIGluIENocm9tZSAoYW5kIEZpcmVmb3gpIGRvZXMgbm90IGhhbmRsZVxuICAgICAgICAvLyBjb21wb3VuZCBpbmRpY2VzIHRoYXQgaW5jbHVkZSBhdXRvLWdlbmVyYXRlZCBrZXlzIGNvcnJlY3RseS4gVG8gZW5zdXJlXG4gICAgICAgIC8vIHRoYXQgdGhlIGluZGV4IGVudHJ5IGlzIGFkZGVkIGNvcnJlY3RseSBpbiBhbGwgYnJvd3NlcnMsIHdlIHBlcmZvcm0gdHdvXG4gICAgICAgIC8vIHdyaXRlczogVGhlIGZpcnN0IHdyaXRlIGlzIHVzZWQgdG8gcmV0cmlldmUgdGhlIG5leHQgYXV0by1nZW5lcmF0ZWQgQmF0Y2hcbiAgICAgICAgLy8gSUQsIGFuZCB0aGUgc2Vjb25kIHdyaXRlIHBvcHVsYXRlcyB0aGUgaW5kZXggYW5kIHN0b3JlcyB0aGUgYWN0dWFsXG4gICAgICAgIC8vIG11dGF0aW9uIGJhdGNoLlxuICAgICAgICAvLyBTZWU6IGh0dHBzOi8vYnVncy5jaHJvbWl1bS5vcmcvcC9jaHJvbWl1bS9pc3N1ZXMvZGV0YWlsP2lkPTcwMTk3MlxuICAgICAgICAvLyBXZSB3cml0ZSBhbiBlbXB0eSBvYmplY3QgdG8gb2J0YWluIGtleVxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICByZXR1cm4gci5hZGQoe30pLm5leHQoKG8gPT4ge1xuICAgICAgICAgICAgTChcIm51bWJlclwiID09IHR5cGVvZiBvKTtcbiAgICAgICAgICAgIGNvbnN0IGEgPSBuZXcgZWkobywgZSwgbiwgcyksIGMgPSBmdW5jdGlvbih0LCBlLCBuKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IG4uYmFzZU11dGF0aW9ucy5tYXAoKGUgPT4gbnModC5XdCwgZSkpKSwgaSA9IG4ubXV0YXRpb25zLm1hcCgoZSA9PiBucyh0Lld0LCBlKSkpO1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgdnMoZSwgbi5iYXRjaElkLCBuLmxvY2FsV3JpdGVUaW1lLnRvTWlsbGlzKCksIHMsIGkpO1xuICAgICAgICAgICAgfSh0aGlzLk4sIHRoaXMudXNlcklkLCBhKSwgdSA9IFtdO1xuICAgICAgICAgICAgbGV0IGggPSBuZXcgbW4oKCh0LCBlKSA9PiB0dCh0LmNhbm9uaWNhbFN0cmluZygpLCBlLmNhbm9uaWNhbFN0cmluZygpKSkpO1xuICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIHMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gVnMua2V5KHRoaXMudXNlcklkLCB0LmtleS5wYXRoLCBvKTtcbiAgICAgICAgICAgICAgICBoID0gaC5hZGQodC5rZXkucGF0aC5wb3BMYXN0KCkpLCB1LnB1c2goci5wdXQoYykpLCB1LnB1c2goaS5wdXQoZSwgVnMuUExBQ0VIT0xERVIpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBoLmZvckVhY2goKGUgPT4ge1xuICAgICAgICAgICAgICAgIHUucHVzaCh0aGlzLkh0LmFkZFRvQ29sbGVjdGlvblBhcmVudEluZGV4KHQsIGUpKTtcbiAgICAgICAgICAgIH0pKSwgdC5hZGRPbkNvbW1pdHRlZExpc3RlbmVyKCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5KdFtvXSA9IGEua2V5cygpO1xuICAgICAgICAgICAgfSkpLCBLcy53YWl0Rm9yKHUpLm5leHQoKCgpID0+IGEpKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBsb29rdXBNdXRhdGlvbkJhdGNoKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIFZpKHQpLmdldChlKS5uZXh0KCh0ID0+IHQgPyAoTCh0LnVzZXJJZCA9PT0gdGhpcy51c2VySWQpLCBsaSh0aGlzLk4sIHQpKSA6IG51bGwpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgZG9jdW1lbnQga2V5cyBmb3IgdGhlIG11dGF0aW9uIGJhdGNoIHdpdGggdGhlIGdpdmVuIGJhdGNoSWQuXG4gICAgICogRm9yIHByaW1hcnkgY2xpZW50cywgdGhpcyBtZXRob2QgcmV0dXJucyBgbnVsbGAgYWZ0ZXJcbiAgICAgKiBgcmVtb3ZlTXV0YXRpb25CYXRjaGVzKClgIGhhcyBiZWVuIGNhbGxlZC4gU2Vjb25kYXJ5IGNsaWVudHMgcmV0dXJuIGFcbiAgICAgKiBjYWNoZWQgcmVzdWx0IHVudGlsIGByZW1vdmVDYWNoZWRNdXRhdGlvbktleXMoKWAgaXMgaW52b2tlZC5cbiAgICAgKi9cbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5LlxuICAgIFh0KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuSnRbZV0gPyBLcy5yZXNvbHZlKHRoaXMuSnRbZV0pIDogdGhpcy5sb29rdXBNdXRhdGlvbkJhdGNoKHQsIGUpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgaWYgKHQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gdC5rZXlzKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuSnRbZV0gPSBuLCBuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZ2V0TmV4dE11dGF0aW9uQmF0Y2hBZnRlckJhdGNoSWQodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gZSArIDEsIHMgPSBJREJLZXlSYW5nZS5sb3dlckJvdW5kKFsgdGhpcy51c2VySWQsIG4gXSk7XG4gICAgICAgIGxldCBpID0gbnVsbDtcbiAgICAgICAgcmV0dXJuIFZpKHQpLkt0KHtcbiAgICAgICAgICAgIGluZGV4OiB2cy51c2VyTXV0YXRpb25zSW5kZXgsXG4gICAgICAgICAgICByYW5nZTogc1xuICAgICAgICB9LCAoKHQsIGUsIHMpID0+IHtcbiAgICAgICAgICAgIGUudXNlcklkID09PSB0aGlzLnVzZXJJZCAmJiAoTChlLmJhdGNoSWQgPj0gbiksIGkgPSBsaSh0aGlzLk4sIGUpKSwgcy5kb25lKCk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBpKSk7XG4gICAgfVxuICAgIGdldEhpZ2hlc3RVbmFja25vd2xlZGdlZEJhdGNoSWQodCkge1xuICAgICAgICBjb25zdCBlID0gSURCS2V5UmFuZ2UudXBwZXJCb3VuZChbIHRoaXMudXNlcklkLCBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkgXSk7XG4gICAgICAgIGxldCBuID0gLTE7XG4gICAgICAgIHJldHVybiBWaSh0KS5LdCh7XG4gICAgICAgICAgICBpbmRleDogdnMudXNlck11dGF0aW9uc0luZGV4LFxuICAgICAgICAgICAgcmFuZ2U6IGUsXG4gICAgICAgICAgICByZXZlcnNlOiAhMFxuICAgICAgICB9LCAoKHQsIGUsIHMpID0+IHtcbiAgICAgICAgICAgIG4gPSBlLmJhdGNoSWQsIHMuZG9uZSgpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gbikpO1xuICAgIH1cbiAgICBnZXRBbGxNdXRhdGlvbkJhdGNoZXModCkge1xuICAgICAgICBjb25zdCBlID0gSURCS2V5UmFuZ2UuYm91bmQoWyB0aGlzLnVzZXJJZCwgLTEgXSwgWyB0aGlzLnVzZXJJZCwgTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZIF0pO1xuICAgICAgICByZXR1cm4gVmkodCkuTHQodnMudXNlck11dGF0aW9uc0luZGV4LCBlKS5uZXh0KCh0ID0+IHQubWFwKCh0ID0+IGxpKHRoaXMuTiwgdCkpKSkpO1xuICAgIH1cbiAgICBnZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdEb2N1bWVudEtleSh0LCBlKSB7XG4gICAgICAgIC8vIFNjYW4gdGhlIGRvY3VtZW50LW11dGF0aW9uIGluZGV4IHN0YXJ0aW5nIHdpdGggYSBwcmVmaXggc3RhcnRpbmcgd2l0aFxuICAgICAgICAvLyB0aGUgZ2l2ZW4gZG9jdW1lbnRLZXkuXG4gICAgICAgIGNvbnN0IG4gPSBWcy5wcmVmaXhGb3JQYXRoKHRoaXMudXNlcklkLCBlLnBhdGgpLCBzID0gSURCS2V5UmFuZ2UubG93ZXJCb3VuZChuKSwgaSA9IFtdO1xuICAgICAgICByZXR1cm4gU2kodCkuS3Qoe1xuICAgICAgICAgICAgcmFuZ2U6IHNcbiAgICAgICAgfSwgKChuLCBzLCByKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBbbywgYSwgY10gPSBuLCB1ID0gQXMoYSk7XG4gICAgICAgICAgICAvLyBPbmx5IGNvbnNpZGVyIHJvd3MgbWF0Y2hpbmcgZXhhY3RseSB0aGUgc3BlY2lmaWMga2V5IG9mXG4gICAgICAgICAgICAvLyBpbnRlcmVzdC4gTm90ZSB0aGF0IGJlY2F1c2Ugd2Ugb3JkZXIgYnkgcGF0aCBmaXJzdCwgYW5kIHdlXG4gICAgICAgICAgICAvLyBvcmRlciB0ZXJtaW5hdG9ycyBiZWZvcmUgcGF0aCBzZXBhcmF0b3JzLCB3ZSdsbCBlbmNvdW50ZXIgYWxsXG4gICAgICAgICAgICAvLyB0aGUgaW5kZXggcm93cyBmb3IgZG9jdW1lbnRLZXkgY29udGlndW91c2x5LiBJbiBwYXJ0aWN1bGFyLCBhbGxcbiAgICAgICAgICAgIC8vIHRoZSByb3dzIGZvciBkb2N1bWVudEtleSB3aWxsIG9jY3VyIGJlZm9yZSBhbnkgcm93cyBmb3JcbiAgICAgICAgICAgIC8vIGRvY3VtZW50cyBuZXN0ZWQgaW4gYSBzdWJjb2xsZWN0aW9uIGJlbmVhdGggZG9jdW1lbnRLZXkgc28gd2VcbiAgICAgICAgICAgIC8vIGNhbiBzdG9wIGFzIHNvb24gYXMgd2UgaGl0IGFueSBzdWNoIHJvdy5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvID09PSB0aGlzLnVzZXJJZCAmJiBlLnBhdGguaXNFcXVhbCh1KSkgXG4gICAgICAgICAgICAvLyBMb29rIHVwIHRoZSBtdXRhdGlvbiBiYXRjaCBpbiB0aGUgc3RvcmUuXG4gICAgICAgICAgICByZXR1cm4gVmkodCkuZ2V0KGMpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghdCkgdGhyb3cgTSgpO1xuICAgICAgICAgICAgICAgIEwodC51c2VySWQgPT09IHRoaXMudXNlcklkKSwgaS5wdXNoKGxpKHRoaXMuTiwgdCkpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgci5kb25lKCk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBpKSk7XG4gICAgfVxuICAgIGdldEFsbE11dGF0aW9uQmF0Y2hlc0FmZmVjdGluZ0RvY3VtZW50S2V5cyh0LCBlKSB7XG4gICAgICAgIGxldCBuID0gbmV3IG1uKHR0KTtcbiAgICAgICAgY29uc3QgcyA9IFtdO1xuICAgICAgICByZXR1cm4gZS5mb3JFYWNoKChlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGkgPSBWcy5wcmVmaXhGb3JQYXRoKHRoaXMudXNlcklkLCBlLnBhdGgpLCByID0gSURCS2V5UmFuZ2UubG93ZXJCb3VuZChpKSwgbyA9IFNpKHQpLkt0KHtcbiAgICAgICAgICAgICAgICByYW5nZTogclxuICAgICAgICAgICAgfSwgKCh0LCBzLCBpKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgW3IsIG8sIGFdID0gdCwgYyA9IEFzKG8pO1xuICAgICAgICAgICAgICAgIC8vIE9ubHkgY29uc2lkZXIgcm93cyBtYXRjaGluZyBleGFjdGx5IHRoZSBzcGVjaWZpYyBrZXkgb2ZcbiAgICAgICAgICAgICAgICAvLyBpbnRlcmVzdC4gTm90ZSB0aGF0IGJlY2F1c2Ugd2Ugb3JkZXIgYnkgcGF0aCBmaXJzdCwgYW5kIHdlXG4gICAgICAgICAgICAgICAgLy8gb3JkZXIgdGVybWluYXRvcnMgYmVmb3JlIHBhdGggc2VwYXJhdG9ycywgd2UnbGwgZW5jb3VudGVyIGFsbFxuICAgICAgICAgICAgICAgIC8vIHRoZSBpbmRleCByb3dzIGZvciBkb2N1bWVudEtleSBjb250aWd1b3VzbHkuIEluIHBhcnRpY3VsYXIsIGFsbFxuICAgICAgICAgICAgICAgIC8vIHRoZSByb3dzIGZvciBkb2N1bWVudEtleSB3aWxsIG9jY3VyIGJlZm9yZSBhbnkgcm93cyBmb3JcbiAgICAgICAgICAgICAgICAvLyBkb2N1bWVudHMgbmVzdGVkIGluIGEgc3ViY29sbGVjdGlvbiBiZW5lYXRoIGRvY3VtZW50S2V5IHNvIHdlXG4gICAgICAgICAgICAgICAgLy8gY2FuIHN0b3AgYXMgc29vbiBhcyB3ZSBoaXQgYW55IHN1Y2ggcm93LlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByID09PSB0aGlzLnVzZXJJZCAmJiBlLnBhdGguaXNFcXVhbChjKSA/IG4gPSBuLmFkZChhKSA6IGkuZG9uZSgpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgcy5wdXNoKG8pO1xuICAgICAgICB9KSksIEtzLndhaXRGb3IocykubmV4dCgoKCkgPT4gdGhpcy5adCh0LCBuKSkpO1xuICAgIH1cbiAgICBnZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdRdWVyeSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBlLnBhdGgsIHMgPSBuLmxlbmd0aCArIDEsIGkgPSBWcy5wcmVmaXhGb3JQYXRoKHRoaXMudXNlcklkLCBuKSwgciA9IElEQktleVJhbmdlLmxvd2VyQm91bmQoaSk7XG4gICAgICAgIC8vIENvbGxlY3QgdXAgdW5pcXVlIGJhdGNoSURzIGVuY291bnRlcmVkIGR1cmluZyBhIHNjYW4gb2YgdGhlIGluZGV4LiBVc2UgYVxuICAgICAgICAvLyBTb3J0ZWRTZXQgdG8gYWNjdW11bGF0ZSBiYXRjaCBJRHMgc28gdGhleSBjYW4gYmUgdHJhdmVyc2VkIGluIG9yZGVyIGluIGFcbiAgICAgICAgLy8gc2NhbiBvZiB0aGUgbWFpbiB0YWJsZS5cbiAgICAgICAgbGV0IG8gPSBuZXcgbW4odHQpO1xuICAgICAgICByZXR1cm4gU2kodCkuS3Qoe1xuICAgICAgICAgICAgcmFuZ2U6IHJcbiAgICAgICAgfSwgKCh0LCBlLCBpKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBbciwgYSwgY10gPSB0LCB1ID0gQXMoYSk7XG4gICAgICAgICAgICByID09PSB0aGlzLnVzZXJJZCAmJiBuLmlzUHJlZml4T2YodSkgPyBcbiAgICAgICAgICAgIC8vIFJvd3Mgd2l0aCBkb2N1bWVudCBrZXlzIG1vcmUgdGhhbiBvbmUgc2VnbWVudCBsb25nZXIgdGhhbiB0aGVcbiAgICAgICAgICAgIC8vIHF1ZXJ5IHBhdGggY2FuJ3QgYmUgbWF0Y2hlcy4gRm9yIGV4YW1wbGUsIGEgcXVlcnkgb24gJ3Jvb21zJ1xuICAgICAgICAgICAgLy8gY2FuJ3QgbWF0Y2ggdGhlIGRvY3VtZW50IC9yb29tcy9hYmMvbWVzc2FnZXMveHl4LlxuICAgICAgICAgICAgLy8gVE9ETyhtY2cpOiB3ZSdsbCBuZWVkIGEgZGlmZmVyZW50IHNjYW5uZXIgd2hlbiB3ZSBpbXBsZW1lbnRcbiAgICAgICAgICAgIC8vIGFuY2VzdG9yIHF1ZXJpZXMuXG4gICAgICAgICAgICB1Lmxlbmd0aCA9PT0gcyAmJiAobyA9IG8uYWRkKGMpKSA6IGkuZG9uZSgpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gdGhpcy5adCh0LCBvKSkpO1xuICAgIH1cbiAgICBadCh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBbXSwgcyA9IFtdO1xuICAgICAgICAvLyBUT0RPKHJvY2t3b29kKTogSW1wbGVtZW50IHRoaXMgdXNpbmcgaXRlcmF0ZS5cbiAgICAgICAgcmV0dXJuIGUuZm9yRWFjaCgoZSA9PiB7XG4gICAgICAgICAgICBzLnB1c2goVmkodCkuZ2V0KGUpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChudWxsID09PSB0KSB0aHJvdyBNKCk7XG4gICAgICAgICAgICAgICAgTCh0LnVzZXJJZCA9PT0gdGhpcy51c2VySWQpLCBuLnB1c2gobGkodGhpcy5OLCB0KSk7XG4gICAgICAgICAgICB9KSkpO1xuICAgICAgICB9KSksIEtzLndhaXRGb3IocykubmV4dCgoKCkgPT4gbikpO1xuICAgIH1cbiAgICByZW1vdmVNdXRhdGlvbkJhdGNoKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIFJpKHQuUXQsIHRoaXMudXNlcklkLCBlKS5uZXh0KChuID0+ICh0LmFkZE9uQ29tbWl0dGVkTGlzdGVuZXIoKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMudGUoZS5iYXRjaElkKTtcbiAgICAgICAgfSkpLCBLcy5mb3JFYWNoKG4sIChlID0+IHRoaXMucmVmZXJlbmNlRGVsZWdhdGUubWFya1BvdGVudGlhbGx5T3JwaGFuZWQodCwgZSkpKSkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2xlYXJzIHRoZSBjYWNoZWQga2V5cyBmb3IgYSBtdXRhdGlvbiBiYXRjaC4gVGhpcyBtZXRob2Qgc2hvdWxkIGJlXG4gICAgICogY2FsbGVkIGJ5IHNlY29uZGFyeSBjbGllbnRzIGFmdGVyIHRoZXkgcHJvY2VzcyBtdXRhdGlvbiB1cGRhdGVzLlxuICAgICAqXG4gICAgICogTm90ZSB0aGF0IHRoaXMgbWV0aG9kIGRvZXMgbm90IGhhdmUgdG8gYmUgY2FsbGVkIGZyb20gcHJpbWFyeSBjbGllbnRzIGFzXG4gICAgICogdGhlIGNvcnJlc3BvbmRpbmcgY2FjaGUgZW50cmllcyBhcmUgY2xlYXJlZCB3aGVuIGFuIGFja25vd2xlZGdlZCBvclxuICAgICAqIHJlamVjdGVkIGJhdGNoIGlzIHJlbW92ZWQgZnJvbSB0aGUgbXV0YXRpb24gcXVldWUuXG4gICAgICovXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seVxuICAgIHRlKHQpIHtcbiAgICAgICAgZGVsZXRlIHRoaXMuSnRbdF07XG4gICAgfVxuICAgIHBlcmZvcm1Db25zaXN0ZW5jeUNoZWNrKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2hlY2tFbXB0eSh0KS5uZXh0KChlID0+IHtcbiAgICAgICAgICAgIGlmICghZSkgcmV0dXJuIEtzLnJlc29sdmUoKTtcbiAgICAgICAgICAgIC8vIFZlcmlmeSB0aGF0IHRoZXJlIGFyZSBubyBlbnRyaWVzIGluIHRoZSBkb2N1bWVudE11dGF0aW9ucyBpbmRleCBpZlxuICAgICAgICAgICAgLy8gdGhlIHF1ZXVlIGlzIGVtcHR5LlxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IElEQktleVJhbmdlLmxvd2VyQm91bmQoVnMucHJlZml4Rm9yVXNlcih0aGlzLnVzZXJJZCkpLCBzID0gW107XG4gICAgICAgICAgICByZXR1cm4gU2kodCkuS3Qoe1xuICAgICAgICAgICAgICAgIHJhbmdlOiBuXG4gICAgICAgICAgICB9LCAoKHQsIGUsIG4pID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodFswXSA9PT0gdGhpcy51c2VySWQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IEFzKHRbMV0pO1xuICAgICAgICAgICAgICAgICAgICBzLnB1c2goZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIG4uZG9uZSgpO1xuICAgICAgICAgICAgfSkpLm5leHQoKCgpID0+IHtcbiAgICAgICAgICAgICAgICBMKDAgPT09IHMubGVuZ3RoKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBjb250YWluc0tleSh0LCBlKSB7XG4gICAgICAgIHJldHVybiB2aSh0LCB0aGlzLnVzZXJJZCwgZSk7XG4gICAgfVxuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHkgKHN0YXRlIGlzIGhlbGQgaW4gbWVtb3J5IGluIG90aGVyIGNsaWVudHMpLlxuICAgIC8qKiBSZXR1cm5zIHRoZSBtdXRhdGlvbiBxdWV1ZSdzIG1ldGFkYXRhIGZyb20gSW5kZXhlZERiLiAqL1xuICAgIGVlKHQpIHtcbiAgICAgICAgcmV0dXJuIERpKHQpLmdldCh0aGlzLnVzZXJJZCkubmV4dCgodCA9PiB0IHx8IG5ldyBicyh0aGlzLnVzZXJJZCwgLTEsIFxuICAgICAgICAvKmxhc3RTdHJlYW1Ub2tlbj0qLyBcIlwiKSkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAcmV0dXJucyB0cnVlIGlmIHRoZSBtdXRhdGlvbiBxdWV1ZSBmb3IgdGhlIGdpdmVuIHVzZXIgY29udGFpbnMgYSBwZW5kaW5nXG4gKiAgICAgICAgIG11dGF0aW9uIGZvciB0aGUgZ2l2ZW4ga2V5LlxuICovIGZ1bmN0aW9uIHZpKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gVnMucHJlZml4Rm9yUGF0aChlLCBuLnBhdGgpLCBpID0gc1sxXSwgciA9IElEQktleVJhbmdlLmxvd2VyQm91bmQocyk7XG4gICAgbGV0IG8gPSAhMTtcbiAgICByZXR1cm4gU2kodCkuS3Qoe1xuICAgICAgICByYW5nZTogcixcbiAgICAgICAgcXQ6ICEwXG4gICAgfSwgKCh0LCBuLCBzKSA9PiB7XG4gICAgICAgIGNvbnN0IFtyLCBhLCAvKmJhdGNoSUQqLyBjXSA9IHQ7XG4gICAgICAgIHIgPT09IGUgJiYgYSA9PT0gaSAmJiAobyA9ICEwKSwgcy5kb25lKCk7XG4gICAgfSkpLm5leHQoKCgpID0+IG8pKTtcbn1cblxuLyoqIFJldHVybnMgdHJ1ZSBpZiBhbnkgbXV0YXRpb24gcXVldWUgY29udGFpbnMgdGhlIGdpdmVuIGRvY3VtZW50LiAqL1xuLyoqXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIG11dGF0aW9ucyBvYmplY3Qgc3RvcmUuXG4gKi9cbmZ1bmN0aW9uIFZpKHQpIHtcbiAgICByZXR1cm4gdGkodCwgdnMuc3RvcmUpO1xufVxuXG4vKipcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgbXV0YXRpb25RdWV1ZXMgb2JqZWN0IHN0b3JlLlxuICovIGZ1bmN0aW9uIFNpKHQpIHtcbiAgICByZXR1cm4gdGkodCwgVnMuc3RvcmUpO1xufVxuXG4vKipcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgbXV0YXRpb25RdWV1ZXMgb2JqZWN0IHN0b3JlLlxuICovIGZ1bmN0aW9uIERpKHQpIHtcbiAgICByZXR1cm4gdGkodCwgYnMuc3RvcmUpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqIE9mZnNldCB0byBlbnN1cmUgbm9uLW92ZXJsYXBwaW5nIHRhcmdldCBpZHMuICovXG4vKipcbiAqIEdlbmVyYXRlcyBtb25vdG9uaWNhbGx5IGluY3JlYXNpbmcgdGFyZ2V0IElEcyBmb3Igc2VuZGluZyB0YXJnZXRzIHRvIHRoZVxuICogd2F0Y2ggc3RyZWFtLlxuICpcbiAqIFRoZSBjbGllbnQgY29uc3RydWN0cyB0d28gZ2VuZXJhdG9ycywgb25lIGZvciB0aGUgdGFyZ2V0IGNhY2hlLCBhbmQgb25lIGZvclxuICogZm9yIHRoZSBzeW5jIGVuZ2luZSAodG8gZ2VuZXJhdGUgbGltYm8gZG9jdW1lbnRzIHRhcmdldHMpLiBUaGVzZVxuICogZ2VuZXJhdG9ycyBwcm9kdWNlIG5vbi1vdmVybGFwcGluZyBJRHMgKGJ5IHVzaW5nIGV2ZW4gYW5kIG9kZCBJRHNcbiAqIHJlc3BlY3RpdmVseSkuXG4gKlxuICogQnkgc2VwYXJhdGluZyB0aGUgdGFyZ2V0IElEIHNwYWNlLCB0aGUgcXVlcnkgY2FjaGUgY2FuIGdlbmVyYXRlIHRhcmdldCBJRHNcbiAqIHRoYXQgcGVyc2lzdCBhY3Jvc3MgY2xpZW50IHJlc3RhcnRzLCB3aGlsZSBzeW5jIGVuZ2luZSBjYW4gaW5kZXBlbmRlbnRseVxuICogZ2VuZXJhdGUgaW4tbWVtb3J5IHRhcmdldCBJRHMgdGhhdCBhcmUgdHJhbnNpZW50IGFuZCBjYW4gYmUgcmV1c2VkIGFmdGVyIGFcbiAqIHJlc3RhcnQuXG4gKi9cbmNsYXNzIENpIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMubmUgPSB0O1xuICAgIH1cbiAgICBuZXh0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5uZSArPSAyLCB0aGlzLm5lO1xuICAgIH1cbiAgICBzdGF0aWMgc2UoKSB7XG4gICAgICAgIC8vIFRoZSB0YXJnZXQgY2FjaGUgZ2VuZXJhdG9yIG11c3QgcmV0dXJuICcyJyBpbiBpdHMgZmlyc3QgY2FsbCB0byBgbmV4dCgpYFxuICAgICAgICAvLyBhcyB0aGVyZSBpcyBubyBkaWZmZXJlbnRpYXRpb24gaW4gdGhlIHByb3RvY29sIGxheWVyIGJldHdlZW4gYW4gdW5zZXRcbiAgICAgICAgLy8gbnVtYmVyIGFuZCB0aGUgbnVtYmVyICcwJy4gSWYgd2Ugd2VyZSB0byBzZW50IGEgdGFyZ2V0IHdpdGggdGFyZ2V0IElEXG4gICAgICAgIC8vICcwJywgdGhlIGJhY2tlbmQgd291bGQgY29uc2lkZXIgaXQgdW5zZXQgYW5kIHJlcGxhY2UgaXQgd2l0aCBpdHMgb3duIElELlxuICAgICAgICByZXR1cm4gbmV3IENpKDApO1xuICAgIH1cbiAgICBzdGF0aWMgaWUoKSB7XG4gICAgICAgIC8vIFN5bmMgZW5naW5lIGFzc2lnbnMgdGFyZ2V0IElEcyBmb3IgbGltYm8gZG9jdW1lbnQgZGV0ZWN0aW9uLlxuICAgICAgICByZXR1cm4gbmV3IENpKC0xKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNsYXNzIE5pIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMucmVmZXJlbmNlRGVsZWdhdGUgPSB0LCB0aGlzLk4gPSBlO1xuICAgIH1cbiAgICAvLyBQT1JUSU5HIE5PVEU6IFdlIGRvbid0IGNhY2hlIGdsb2JhbCBtZXRhZGF0YSBmb3IgdGhlIHRhcmdldCBjYWNoZSwgc2luY2VcbiAgICAvLyBzb21lIG9mIGl0IChpbiBwYXJ0aWN1bGFyIGBoaWdoZXN0VGFyZ2V0SWRgKSBjYW4gYmUgbW9kaWZpZWQgYnkgc2Vjb25kYXJ5XG4gICAgLy8gdGFicy4gV2UgY291bGQgcGVyaGFwcyBiZSBtb3JlIGdyYW51bGFyIChhbmQgZS5nLiBzdGlsbCBjYWNoZVxuICAgIC8vIGBsYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uYCBpbiBtZW1vcnkpIGJ1dCBmb3Igc2ltcGxpY2l0eSB3ZSBjdXJyZW50bHkgZ29cbiAgICAvLyB0byBJbmRleGVkRGIgd2hlbmV2ZXIgd2UgbmVlZCB0byByZWFkIG1ldGFkYXRhLiBXZSBjYW4gcmV2aXNpdCBpZiBpdCB0dXJuc1xuICAgIC8vIG91dCB0byBoYXZlIGEgbWVhbmluZ2Z1bCBwZXJmb3JtYW5jZSBpbXBhY3QuXG4gICAgYWxsb2NhdGVUYXJnZXRJZCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlKHQpLm5leHQoKGUgPT4ge1xuICAgICAgICAgICAgY29uc3QgbiA9IG5ldyBDaShlLmhpZ2hlc3RUYXJnZXRJZCk7XG4gICAgICAgICAgICByZXR1cm4gZS5oaWdoZXN0VGFyZ2V0SWQgPSBuLm5leHQoKSwgdGhpcy5vZSh0LCBlKS5uZXh0KCgoKSA9PiBlLmhpZ2hlc3RUYXJnZXRJZCkpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGdldExhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24odCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZSh0KS5uZXh0KCh0ID0+IGl0LmZyb21UaW1lc3RhbXAobmV3IHN0KHQubGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbi5zZWNvbmRzLCB0Lmxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24ubmFub3NlY29uZHMpKSkpO1xuICAgIH1cbiAgICBnZXRIaWdoZXN0U2VxdWVuY2VOdW1iZXIodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZSh0KS5uZXh0KCh0ID0+IHQuaGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyKSk7XG4gICAgfVxuICAgIHNldFRhcmdldHNNZXRhZGF0YSh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlKHQpLm5leHQoKHMgPT4gKHMuaGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyID0gZSwgbiAmJiAocy5sYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uID0gbi50b1RpbWVzdGFtcCgpKSwgXG4gICAgICAgIGUgPiBzLmhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlciAmJiAocy5oaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIgPSBlKSwgdGhpcy5vZSh0LCBzKSkpKTtcbiAgICB9XG4gICAgYWRkVGFyZ2V0RGF0YSh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFlKHQsIGUpLm5leHQoKCgpID0+IHRoaXMucmUodCkubmV4dCgobiA9PiAobi50YXJnZXRDb3VudCArPSAxLCB0aGlzLmNlKGUsIG4pLCBcbiAgICAgICAgdGhpcy5vZSh0LCBuKSkpKSkpO1xuICAgIH1cbiAgICB1cGRhdGVUYXJnZXREYXRhKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYWUodCwgZSk7XG4gICAgfVxuICAgIHJlbW92ZVRhcmdldERhdGEodCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZW1vdmVNYXRjaGluZ0tleXNGb3JUYXJnZXRJZCh0LCBlLnRhcmdldElkKS5uZXh0KCgoKSA9PiB4aSh0KS5kZWxldGUoZS50YXJnZXRJZCkpKS5uZXh0KCgoKSA9PiB0aGlzLnJlKHQpKSkubmV4dCgoZSA9PiAoTChlLnRhcmdldENvdW50ID4gMCksIFxuICAgICAgICBlLnRhcmdldENvdW50IC09IDEsIHRoaXMub2UodCwgZSkpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERyb3BzIGFueSB0YXJnZXRzIHdpdGggc2VxdWVuY2UgbnVtYmVyIGxlc3MgdGhhbiBvciBlcXVhbCB0byB0aGUgdXBwZXIgYm91bmQsIGV4Y2VwdGluZyB0aG9zZVxuICAgICAqIHByZXNlbnQgaW4gYGFjdGl2ZVRhcmdldElkc2AuIERvY3VtZW50IGFzc29jaWF0aW9ucyBmb3IgdGhlIHJlbW92ZWQgdGFyZ2V0cyBhcmUgYWxzbyByZW1vdmVkLlxuICAgICAqIFJldHVybnMgdGhlIG51bWJlciBvZiB0YXJnZXRzIHJlbW92ZWQuXG4gICAgICovICAgIHJlbW92ZVRhcmdldHModCwgZSwgbikge1xuICAgICAgICBsZXQgcyA9IDA7XG4gICAgICAgIGNvbnN0IGkgPSBbXTtcbiAgICAgICAgcmV0dXJuIHhpKHQpLkt0KCgociwgbykgPT4ge1xuICAgICAgICAgICAgY29uc3QgYSA9IGZpKG8pO1xuICAgICAgICAgICAgYS5zZXF1ZW5jZU51bWJlciA8PSBlICYmIG51bGwgPT09IG4uZ2V0KGEudGFyZ2V0SWQpICYmIChzKyssIGkucHVzaCh0aGlzLnJlbW92ZVRhcmdldERhdGEodCwgYSkpKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IEtzLndhaXRGb3IoaSkpKS5uZXh0KCgoKSA9PiBzKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGwgcHJvdmlkZWQgZnVuY3Rpb24gd2l0aCBlYWNoIGBUYXJnZXREYXRhYCB0aGF0IHdlIGhhdmUgY2FjaGVkLlxuICAgICAqLyAgICBmb3JFYWNoVGFyZ2V0KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHhpKHQpLkt0KCgodCwgbikgPT4ge1xuICAgICAgICAgICAgY29uc3QgcyA9IGZpKG4pO1xuICAgICAgICAgICAgZShzKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICByZSh0KSB7XG4gICAgICAgIHJldHVybiBraSh0KS5nZXQoJHMua2V5KS5uZXh0KCh0ID0+IChMKG51bGwgIT09IHQpLCB0KSkpO1xuICAgIH1cbiAgICBvZSh0LCBlKSB7XG4gICAgICAgIHJldHVybiBraSh0KS5wdXQoJHMua2V5LCBlKTtcbiAgICB9XG4gICAgYWUodCwgZSkge1xuICAgICAgICByZXR1cm4geGkodCkucHV0KGRpKHRoaXMuTiwgZSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJbi1wbGFjZSB1cGRhdGVzIHRoZSBwcm92aWRlZCBtZXRhZGF0YSB0byBhY2NvdW50IGZvciB2YWx1ZXMgaW4gdGhlIGdpdmVuXG4gICAgICogVGFyZ2V0RGF0YS4gU2F2aW5nIGlzIGRvbmUgc2VwYXJhdGVseS4gUmV0dXJucyB0cnVlIGlmIHRoZXJlIHdlcmUgYW55XG4gICAgICogY2hhbmdlcyB0byB0aGUgbWV0YWRhdGEuXG4gICAgICovICAgIGNlKHQsIGUpIHtcbiAgICAgICAgbGV0IG4gPSAhMTtcbiAgICAgICAgcmV0dXJuIHQudGFyZ2V0SWQgPiBlLmhpZ2hlc3RUYXJnZXRJZCAmJiAoZS5oaWdoZXN0VGFyZ2V0SWQgPSB0LnRhcmdldElkLCBuID0gITApLCBcbiAgICAgICAgdC5zZXF1ZW5jZU51bWJlciA+IGUuaGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyICYmIChlLmhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlciA9IHQuc2VxdWVuY2VOdW1iZXIsIFxuICAgICAgICBuID0gITApLCBuO1xuICAgIH1cbiAgICBnZXRUYXJnZXRDb3VudCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlKHQpLm5leHQoKHQgPT4gdC50YXJnZXRDb3VudCkpO1xuICAgIH1cbiAgICBnZXRUYXJnZXREYXRhKHQsIGUpIHtcbiAgICAgICAgLy8gSXRlcmF0aW5nIGJ5IHRoZSBjYW5vbmljYWxJZCBtYXkgeWllbGQgbW9yZSB0aGFuIG9uZSByZXN1bHQgYmVjYXVzZVxuICAgICAgICAvLyBjYW5vbmljYWxJZCB2YWx1ZXMgYXJlIG5vdCByZXF1aXJlZCB0byBiZSB1bmlxdWUgcGVyIHRhcmdldC4gVGhpcyBxdWVyeVxuICAgICAgICAvLyBkZXBlbmRzIG9uIHRoZSBxdWVyeVRhcmdldHMgaW5kZXggdG8gYmUgZWZmaWNpZW50LlxuICAgICAgICBjb25zdCBuID0gUXQoZSksIHMgPSBJREJLZXlSYW5nZS5ib3VuZChbIG4sIE51bWJlci5ORUdBVElWRV9JTkZJTklUWSBdLCBbIG4sIE51bWJlci5QT1NJVElWRV9JTkZJTklUWSBdKTtcbiAgICAgICAgbGV0IGkgPSBudWxsO1xuICAgICAgICByZXR1cm4geGkodCkuS3Qoe1xuICAgICAgICAgICAgcmFuZ2U6IHMsXG4gICAgICAgICAgICBpbmRleDogeHMucXVlcnlUYXJnZXRzSW5kZXhOYW1lXG4gICAgICAgIH0sICgodCwgbiwgcykgPT4ge1xuICAgICAgICAgICAgY29uc3QgciA9IGZpKG4pO1xuICAgICAgICAgICAgLy8gQWZ0ZXIgZmluZGluZyBhIHBvdGVudGlhbCBtYXRjaCwgY2hlY2sgdGhhdCB0aGUgdGFyZ2V0IGlzXG4gICAgICAgICAgICAvLyBhY3R1YWxseSBlcXVhbCB0byB0aGUgcmVxdWVzdGVkIHRhcmdldC5cbiAgICAgICAgICAgICAgICAgICAgICAgIEd0KGUsIHIudGFyZ2V0KSAmJiAoaSA9IHIsIHMuZG9uZSgpKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IGkpKTtcbiAgICB9XG4gICAgYWRkTWF0Y2hpbmdLZXlzKHQsIGUsIG4pIHtcbiAgICAgICAgLy8gUE9SVElORyBOT1RFOiBUaGUgcmV2ZXJzZSBpbmRleCAoZG9jdW1lbnRzVGFyZ2V0cykgaXMgbWFpbnRhaW5lZCBieVxuICAgICAgICAvLyBJbmRleGVkRGIuXG4gICAgICAgIGNvbnN0IHMgPSBbXSwgaSA9ICRpKHQpO1xuICAgICAgICByZXR1cm4gZS5mb3JFYWNoKChlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHIgPSBFcyhlLnBhdGgpO1xuICAgICAgICAgICAgcy5wdXNoKGkucHV0KG5ldyBrcyhuLCByKSkpLCBzLnB1c2godGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZS5hZGRSZWZlcmVuY2UodCwgbiwgZSkpO1xuICAgICAgICB9KSksIEtzLndhaXRGb3Iocyk7XG4gICAgfVxuICAgIHJlbW92ZU1hdGNoaW5nS2V5cyh0LCBlLCBuKSB7XG4gICAgICAgIC8vIFBPUlRJTkcgTk9URTogVGhlIHJldmVyc2UgaW5kZXggKGRvY3VtZW50c1RhcmdldHMpIGlzIG1haW50YWluZWQgYnlcbiAgICAgICAgLy8gSW5kZXhlZERiLlxuICAgICAgICBjb25zdCBzID0gJGkodCk7XG4gICAgICAgIHJldHVybiBLcy5mb3JFYWNoKGUsIChlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGkgPSBFcyhlLnBhdGgpO1xuICAgICAgICAgICAgcmV0dXJuIEtzLndhaXRGb3IoWyBzLmRlbGV0ZShbIG4sIGkgXSksIHRoaXMucmVmZXJlbmNlRGVsZWdhdGUucmVtb3ZlUmVmZXJlbmNlKHQsIG4sIGUpIF0pO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHJlbW92ZU1hdGNoaW5nS2V5c0ZvclRhcmdldElkKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9ICRpKHQpLCBzID0gSURCS2V5UmFuZ2UuYm91bmQoWyBlIF0sIFsgZSArIDEgXSwgXG4gICAgICAgIC8qbG93ZXJPcGVuPSovICExLCBcbiAgICAgICAgLyp1cHBlck9wZW49Ki8gITApO1xuICAgICAgICByZXR1cm4gbi5kZWxldGUocyk7XG4gICAgfVxuICAgIGdldE1hdGNoaW5nS2V5c0ZvclRhcmdldElkKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IElEQktleVJhbmdlLmJvdW5kKFsgZSBdLCBbIGUgKyAxIF0sIFxuICAgICAgICAvKmxvd2VyT3Blbj0qLyAhMSwgXG4gICAgICAgIC8qdXBwZXJPcGVuPSovICEwKSwgcyA9ICRpKHQpO1xuICAgICAgICBsZXQgaSA9IFBuKCk7XG4gICAgICAgIHJldHVybiBzLkt0KHtcbiAgICAgICAgICAgIHJhbmdlOiBuLFxuICAgICAgICAgICAgcXQ6ICEwXG4gICAgICAgIH0sICgodCwgZSwgbikgPT4ge1xuICAgICAgICAgICAgY29uc3QgcyA9IEFzKHRbMV0pLCByID0gbmV3IFB0KHMpO1xuICAgICAgICAgICAgaSA9IGkuYWRkKHIpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gaSkpO1xuICAgIH1cbiAgICBjb250YWluc0tleSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBFcyhlLnBhdGgpLCBzID0gSURCS2V5UmFuZ2UuYm91bmQoWyBuIF0sIFsgbnQobikgXSwgXG4gICAgICAgIC8qbG93ZXJPcGVuPSovICExLCBcbiAgICAgICAgLyp1cHBlck9wZW49Ki8gITApO1xuICAgICAgICBsZXQgaSA9IDA7XG4gICAgICAgIHJldHVybiAkaSh0KS5LdCh7XG4gICAgICAgICAgICBpbmRleDoga3MuZG9jdW1lbnRUYXJnZXRzSW5kZXgsXG4gICAgICAgICAgICBxdDogITAsXG4gICAgICAgICAgICByYW5nZTogc1xuICAgICAgICB9LCAoKFt0LCBlXSwgbiwgcykgPT4ge1xuICAgICAgICAgICAgLy8gSGF2aW5nIGEgc2VudGluZWwgcm93IGZvciBhIGRvY3VtZW50IGRvZXMgbm90IGNvdW50IGFzIGNvbnRhaW5pbmcgdGhhdCBkb2N1bWVudDtcbiAgICAgICAgICAgIC8vIEZvciB0aGUgdGFyZ2V0IGNhY2hlLCBjb250YWluaW5nIHRoZSBkb2N1bWVudCBtZWFucyB0aGUgZG9jdW1lbnQgaXMgcGFydCBvZiBzb21lXG4gICAgICAgICAgICAvLyB0YXJnZXQuXG4gICAgICAgICAgICAwICE9PSB0ICYmIChpKyssIHMuZG9uZSgpKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IGkgPiAwKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIExvb2tzIHVwIGEgVGFyZ2V0RGF0YSBlbnRyeSBieSB0YXJnZXQgSUQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdGFyZ2V0SWQgLSBUaGUgdGFyZ2V0IElEIG9mIHRoZSBUYXJnZXREYXRhIGVudHJ5IHRvIGxvb2sgdXAuXG4gICAgICogQHJldHVybnMgVGhlIGNhY2hlZCBUYXJnZXREYXRhIGVudHJ5LCBvciBudWxsIGlmIHRoZSBjYWNoZSBoYXMgbm8gZW50cnkgZm9yXG4gICAgICogdGhlIHRhcmdldC5cbiAgICAgKi9cbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5LlxuICAgIEV0KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHhpKHQpLmdldChlKS5uZXh0KCh0ID0+IHQgPyBmaSh0KSA6IG51bGwpKTtcbiAgICB9XG59XG5cbi8qKlxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSBxdWVyaWVzIG9iamVjdCBzdG9yZS5cbiAqLyBmdW5jdGlvbiB4aSh0KSB7XG4gICAgcmV0dXJuIHRpKHQsIHhzLnN0b3JlKTtcbn1cblxuLyoqXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIHRhcmdldCBnbG9iYWxzIG9iamVjdCBzdG9yZS5cbiAqLyBmdW5jdGlvbiBraSh0KSB7XG4gICAgcmV0dXJuIHRpKHQsICRzLnN0b3JlKTtcbn1cblxuLyoqXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIGRvY3VtZW50IHRhcmdldCBvYmplY3Qgc3RvcmUuXG4gKi8gZnVuY3Rpb24gJGkodCkge1xuICAgIHJldHVybiB0aSh0LCBrcy5zdG9yZSk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFZlcmlmaWVzIHRoZSBlcnJvciB0aHJvd24gYnkgYSBMb2NhbFN0b3JlIG9wZXJhdGlvbi4gSWYgYSBMb2NhbFN0b3JlXG4gKiBvcGVyYXRpb24gZmFpbHMgYmVjYXVzZSB0aGUgcHJpbWFyeSBsZWFzZSBoYXMgYmVlbiB0YWtlbiBieSBhbm90aGVyIGNsaWVudCxcbiAqIHdlIGlnbm9yZSB0aGUgZXJyb3IgKHRoZSBwZXJzaXN0ZW5jZSBsYXllciB3aWxsIGltbWVkaWF0ZWx5IGNhbGxcbiAqIGBhcHBseVByaW1hcnlMZWFzZWAgdG8gcHJvcGFnYXRlIHRoZSBwcmltYXJ5IHN0YXRlIGNoYW5nZSkuIEFsbCBvdGhlciBlcnJvcnNcbiAqIGFyZSByZS10aHJvd24uXG4gKlxuICogQHBhcmFtIGVyciAtIEFuIGVycm9yIHJldHVybmVkIGJ5IGEgTG9jYWxTdG9yZSBvcGVyYXRpb24uXG4gKiBAcmV0dXJucyBBIFByb21pc2UgdGhhdCByZXNvbHZlcyBhZnRlciB3ZSByZWNvdmVyZWQsIG9yIHRoZSBvcmlnaW5hbCBlcnJvci5cbiAqLyBhc3luYyBmdW5jdGlvbiBPaSh0KSB7XG4gICAgaWYgKHQuY29kZSAhPT0gcS5GQUlMRURfUFJFQ09ORElUSU9OIHx8IHQubWVzc2FnZSAhPT0gVXMpIHRocm93IHQ7XG4gICAgayhcIkxvY2FsU3RvcmVcIiwgXCJVbmV4cGVjdGVkbHkgbG9zdCBwcmltYXJ5IGxlYXNlXCIpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBmdW5jdGlvbiBGaShbdCwgZV0sIFtuLCBzXSkge1xuICAgIGNvbnN0IGkgPSB0dCh0LCBuKTtcbiAgICByZXR1cm4gMCA9PT0gaSA/IHR0KGUsIHMpIDogaTtcbn1cblxuLyoqXG4gKiBVc2VkIHRvIGNhbGN1bGF0ZSB0aGUgbnRoIHNlcXVlbmNlIG51bWJlci4gS2VlcHMgYSByb2xsaW5nIGJ1ZmZlciBvZiB0aGVcbiAqIGxvd2VzdCBuIHZhbHVlcyBwYXNzZWQgdG8gYGFkZEVsZW1lbnRgLCBhbmQgZmluYWxseSByZXBvcnRzIHRoZSBsYXJnZXN0IG9mXG4gKiB0aGVtIGluIGBtYXhWYWx1ZWAuXG4gKi8gY2xhc3MgTWkge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy51ZSA9IHQsIHRoaXMuYnVmZmVyID0gbmV3IG1uKEZpKSwgdGhpcy5oZSA9IDA7XG4gICAgfVxuICAgIGxlKCkge1xuICAgICAgICByZXR1cm4gKyt0aGlzLmhlO1xuICAgIH1cbiAgICBmZSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBbIHQsIHRoaXMubGUoKSBdO1xuICAgICAgICBpZiAodGhpcy5idWZmZXIuc2l6ZSA8IHRoaXMudWUpIHRoaXMuYnVmZmVyID0gdGhpcy5idWZmZXIuYWRkKGUpOyBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmJ1ZmZlci5sYXN0KCk7XG4gICAgICAgICAgICBGaShlLCB0KSA8IDAgJiYgKHRoaXMuYnVmZmVyID0gdGhpcy5idWZmZXIuZGVsZXRlKHQpLmFkZChlKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IG1heFZhbHVlKCkge1xuICAgICAgICAvLyBHdWFyYW50ZWVkIHRvIGJlIG5vbi1lbXB0eS4gSWYgd2UgZGVjaWRlIHdlIGFyZSBub3QgY29sbGVjdGluZyBhbnlcbiAgICAgICAgLy8gc2VxdWVuY2UgbnVtYmVycywgbnRoU2VxdWVuY2VOdW1iZXIgYmVsb3cgc2hvcnQtY2lyY3VpdHMuIElmIHdlIGhhdmVcbiAgICAgICAgLy8gZGVjaWRlZCB0aGF0IHdlIGFyZSBjb2xsZWN0aW5nIG4gc2VxdWVuY2UgbnVtYmVycywgaXQncyBiZWNhdXNlIG4gaXMgc29tZVxuICAgICAgICAvLyBwZXJjZW50YWdlIG9mIHRoZSBleGlzdGluZyBzZXF1ZW5jZSBudW1iZXJzLiBUaGF0IG1lYW5zIHdlIHNob3VsZCBuZXZlclxuICAgICAgICAvLyBiZSBpbiBhIHNpdHVhdGlvbiB3aGVyZSB3ZSBhcmUgY29sbGVjdGluZyBzZXF1ZW5jZSBudW1iZXJzIGJ1dCBkb24ndFxuICAgICAgICAvLyBhY3R1YWxseSBoYXZlIGFueS5cbiAgICAgICAgcmV0dXJuIHRoaXMuYnVmZmVyLmxhc3QoKVswXTtcbiAgICB9XG59XG5cbi8qKlxuICogVGhpcyBjbGFzcyBpcyByZXNwb25zaWJsZSBmb3IgdGhlIHNjaGVkdWxpbmcgb2YgTFJVIGdhcmJhZ2UgY29sbGVjdGlvbi4gSXQgaGFuZGxlcyBjaGVja2luZ1xuICogd2hldGhlciBvciBub3QgR0MgaXMgZW5hYmxlZCwgYXMgd2VsbCBhcyB3aGljaCBkZWxheSB0byB1c2UgYmVmb3JlIHRoZSBuZXh0IHJ1bi5cbiAqLyBjbGFzcyBMaSB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLmdhcmJhZ2VDb2xsZWN0b3IgPSB0LCB0aGlzLmFzeW5jUXVldWUgPSBlLCB0aGlzLmRlID0gITEsIHRoaXMud2UgPSBudWxsO1xuICAgIH1cbiAgICBzdGFydCh0KSB7XG4gICAgICAgIC0xICE9PSB0aGlzLmdhcmJhZ2VDb2xsZWN0b3IucGFyYW1zLmNhY2hlU2l6ZUNvbGxlY3Rpb25UaHJlc2hvbGQgJiYgdGhpcy5fZSh0KTtcbiAgICB9XG4gICAgc3RvcCgpIHtcbiAgICAgICAgdGhpcy53ZSAmJiAodGhpcy53ZS5jYW5jZWwoKSwgdGhpcy53ZSA9IG51bGwpO1xuICAgIH1cbiAgICBnZXQgc3RhcnRlZCgpIHtcbiAgICAgICAgcmV0dXJuIG51bGwgIT09IHRoaXMud2U7XG4gICAgfVxuICAgIF9lKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuZGUgPyAzZTUgOiA2ZTQ7XG4gICAgICAgIGsoXCJMcnVHYXJiYWdlQ29sbGVjdG9yXCIsIGBHYXJiYWdlIGNvbGxlY3Rpb24gc2NoZWR1bGVkIGluICR7ZX1tc2ApLCB0aGlzLndlID0gdGhpcy5hc3luY1F1ZXVlLmVucXVldWVBZnRlckRlbGF5KFwibHJ1X2dhcmJhZ2VfY29sbGVjdGlvblwiIC8qIExydUdhcmJhZ2VDb2xsZWN0aW9uICovICwgZSwgKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMud2UgPSBudWxsLCB0aGlzLmRlID0gITA7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGF3YWl0IHQuY29sbGVjdEdhcmJhZ2UodGhpcy5nYXJiYWdlQ29sbGVjdG9yKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgICAgICAgICB6cyh0KSA/IGsoXCJMcnVHYXJiYWdlQ29sbGVjdG9yXCIsIFwiSWdub3JpbmcgSW5kZXhlZERCIGVycm9yIGR1cmluZyBnYXJiYWdlIGNvbGxlY3Rpb246IFwiLCB0KSA6IGF3YWl0IE9pKHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYXdhaXQgdGhpcy5fZSh0KTtcbiAgICAgICAgfSkpO1xuICAgIH1cbn1cblxuLyoqIEltcGxlbWVudHMgdGhlIHN0ZXBzIGZvciBMUlUgZ2FyYmFnZSBjb2xsZWN0aW9uLiAqLyBjbGFzcyBCaSB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLm1lID0gdCwgdGhpcy5wYXJhbXMgPSBlO1xuICAgIH1cbiAgICBjYWxjdWxhdGVUYXJnZXRDb3VudCh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1lLmdlKHQpLm5leHQoKHQgPT4gTWF0aC5mbG9vcihlIC8gMTAwICogdCkpKTtcbiAgICB9XG4gICAgbnRoU2VxdWVuY2VOdW1iZXIodCwgZSkge1xuICAgICAgICBpZiAoMCA9PT0gZSkgcmV0dXJuIEtzLnJlc29sdmUoWS5UKTtcbiAgICAgICAgY29uc3QgbiA9IG5ldyBNaShlKTtcbiAgICAgICAgcmV0dXJuIHRoaXMubWUuZm9yRWFjaFRhcmdldCh0LCAodCA9PiBuLmZlKHQuc2VxdWVuY2VOdW1iZXIpKSkubmV4dCgoKCkgPT4gdGhpcy5tZS55ZSh0LCAodCA9PiBuLmZlKHQpKSkpKS5uZXh0KCgoKSA9PiBuLm1heFZhbHVlKSk7XG4gICAgfVxuICAgIHJlbW92ZVRhcmdldHModCwgZSwgbikge1xuICAgICAgICByZXR1cm4gdGhpcy5tZS5yZW1vdmVUYXJnZXRzKHQsIGUsIG4pO1xuICAgIH1cbiAgICByZW1vdmVPcnBoYW5lZERvY3VtZW50cyh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1lLnJlbW92ZU9ycGhhbmVkRG9jdW1lbnRzKHQsIGUpO1xuICAgIH1cbiAgICBjb2xsZWN0KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIC0xID09PSB0aGlzLnBhcmFtcy5jYWNoZVNpemVDb2xsZWN0aW9uVGhyZXNob2xkID8gKGsoXCJMcnVHYXJiYWdlQ29sbGVjdG9yXCIsIFwiR2FyYmFnZSBjb2xsZWN0aW9uIHNraXBwZWQ7IGRpc2FibGVkXCIpLCBcbiAgICAgICAgS3MucmVzb2x2ZShJaSkpIDogdGhpcy5nZXRDYWNoZVNpemUodCkubmV4dCgobiA9PiBuIDwgdGhpcy5wYXJhbXMuY2FjaGVTaXplQ29sbGVjdGlvblRocmVzaG9sZCA/IChrKFwiTHJ1R2FyYmFnZUNvbGxlY3RvclwiLCBgR2FyYmFnZSBjb2xsZWN0aW9uIHNraXBwZWQ7IENhY2hlIHNpemUgJHtufSBpcyBsb3dlciB0aGFuIHRocmVzaG9sZCAke3RoaXMucGFyYW1zLmNhY2hlU2l6ZUNvbGxlY3Rpb25UaHJlc2hvbGR9YCksIFxuICAgICAgICBJaSkgOiB0aGlzLnBlKHQsIGUpKSk7XG4gICAgfVxuICAgIGdldENhY2hlU2l6ZSh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1lLmdldENhY2hlU2l6ZSh0KTtcbiAgICB9XG4gICAgcGUodCwgZSkge1xuICAgICAgICBsZXQgbiwgcywgaSwgciwgbywgYSwgdTtcbiAgICAgICAgY29uc3QgaCA9IERhdGUubm93KCk7XG4gICAgICAgIHJldHVybiB0aGlzLmNhbGN1bGF0ZVRhcmdldENvdW50KHQsIHRoaXMucGFyYW1zLnBlcmNlbnRpbGVUb0NvbGxlY3QpLm5leHQoKGUgPT4gKFxuICAgICAgICAvLyBDYXAgYXQgdGhlIGNvbmZpZ3VyZWQgbWF4XG4gICAgICAgIGUgPiB0aGlzLnBhcmFtcy5tYXhpbXVtU2VxdWVuY2VOdW1iZXJzVG9Db2xsZWN0ID8gKGsoXCJMcnVHYXJiYWdlQ29sbGVjdG9yXCIsIGBDYXBwaW5nIHNlcXVlbmNlIG51bWJlcnMgdG8gY29sbGVjdCBkb3duIHRvIHRoZSBtYXhpbXVtIG9mICR7dGhpcy5wYXJhbXMubWF4aW11bVNlcXVlbmNlTnVtYmVyc1RvQ29sbGVjdH0gZnJvbSAke2V9YCksIFxuICAgICAgICBzID0gdGhpcy5wYXJhbXMubWF4aW11bVNlcXVlbmNlTnVtYmVyc1RvQ29sbGVjdCkgOiBzID0gZSwgciA9IERhdGUubm93KCksIHRoaXMubnRoU2VxdWVuY2VOdW1iZXIodCwgcykpKSkubmV4dCgocyA9PiAobiA9IHMsIFxuICAgICAgICBvID0gRGF0ZS5ub3coKSwgdGhpcy5yZW1vdmVUYXJnZXRzKHQsIG4sIGUpKSkpLm5leHQoKGUgPT4gKGkgPSBlLCBhID0gRGF0ZS5ub3coKSwgXG4gICAgICAgIHRoaXMucmVtb3ZlT3JwaGFuZWREb2N1bWVudHModCwgbikpKSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICBpZiAodSA9IERhdGUubm93KCksIE4oKSA8PSBjLkRFQlVHKSB7XG4gICAgICAgICAgICAgICAgayhcIkxydUdhcmJhZ2VDb2xsZWN0b3JcIiwgYExSVSBHYXJiYWdlIENvbGxlY3Rpb25cXG5cXHRDb3VudGVkIHRhcmdldHMgaW4gJHtyIC0gaH1tc1xcblxcdERldGVybWluZWQgbGVhc3QgcmVjZW50bHkgdXNlZCAke3N9IGluIGAgKyAobyAtIHIpICsgXCJtc1xcblwiICsgYFxcdFJlbW92ZWQgJHtpfSB0YXJnZXRzIGluIGAgKyAoYSAtIG8pICsgXCJtc1xcblwiICsgYFxcdFJlbW92ZWQgJHt0fSBkb2N1bWVudHMgaW4gYCArICh1IC0gYSkgKyBcIm1zXFxuXCIgKyBgVG90YWwgRHVyYXRpb246ICR7dSAtIGh9bXNgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBLcy5yZXNvbHZlKHtcbiAgICAgICAgICAgICAgICBkaWRSdW46ICEwLFxuICAgICAgICAgICAgICAgIHNlcXVlbmNlTnVtYmVyc0NvbGxlY3RlZDogcyxcbiAgICAgICAgICAgICAgICB0YXJnZXRzUmVtb3ZlZDogaSxcbiAgICAgICAgICAgICAgICBkb2N1bWVudHNSZW1vdmVkOiB0XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKiBQcm92aWRlcyBMUlUgZnVuY3Rpb25hbGl0eSBmb3IgSW5kZXhlZERCIHBlcnNpc3RlbmNlLiAqL1xuY2xhc3MgVWkge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5kYiA9IHQsIHRoaXMuZ2FyYmFnZUNvbGxlY3RvciA9IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgQmkodCwgZSk7XG4gICAgICAgIH0odGhpcywgZSk7XG4gICAgfVxuICAgIGdlKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuRWUodCk7XG4gICAgICAgIHJldHVybiB0aGlzLmRiLmdldFRhcmdldENhY2hlKCkuZ2V0VGFyZ2V0Q291bnQodCkubmV4dCgodCA9PiBlLm5leHQoKGUgPT4gdCArIGUpKSkpO1xuICAgIH1cbiAgICBFZSh0KSB7XG4gICAgICAgIGxldCBlID0gMDtcbiAgICAgICAgcmV0dXJuIHRoaXMueWUodCwgKHQgPT4ge1xuICAgICAgICAgICAgZSsrO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gZSkpO1xuICAgIH1cbiAgICBmb3JFYWNoVGFyZ2V0KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGIuZ2V0VGFyZ2V0Q2FjaGUoKS5mb3JFYWNoVGFyZ2V0KHQsIGUpO1xuICAgIH1cbiAgICB5ZSh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLlRlKHQsICgodCwgbikgPT4gZShuKSkpO1xuICAgIH1cbiAgICBhZGRSZWZlcmVuY2UodCwgZSwgbikge1xuICAgICAgICByZXR1cm4gcWkodCwgbik7XG4gICAgfVxuICAgIHJlbW92ZVJlZmVyZW5jZSh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiBxaSh0LCBuKTtcbiAgICB9XG4gICAgcmVtb3ZlVGFyZ2V0cyh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRiLmdldFRhcmdldENhY2hlKCkucmVtb3ZlVGFyZ2V0cyh0LCBlLCBuKTtcbiAgICB9XG4gICAgbWFya1BvdGVudGlhbGx5T3JwaGFuZWQodCwgZSkge1xuICAgICAgICByZXR1cm4gcWkodCwgZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiBhbnl0aGluZyB3b3VsZCBwcmV2ZW50IHRoaXMgZG9jdW1lbnQgZnJvbSBiZWluZyBnYXJiYWdlXG4gICAgICogY29sbGVjdGVkLCBnaXZlbiB0aGF0IHRoZSBkb2N1bWVudCBpbiBxdWVzdGlvbiBpcyBub3QgcHJlc2VudCBpbiBhbnlcbiAgICAgKiB0YXJnZXRzIGFuZCBoYXMgYSBzZXF1ZW5jZSBudW1iZXIgbGVzcyB0aGFuIG9yIGVxdWFsIHRvIHRoZSB1cHBlciBib3VuZCBmb3JcbiAgICAgKiB0aGUgY29sbGVjdGlvbiBydW4uXG4gICAgICovICAgIEllKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIGxldCBuID0gITE7XG4gICAgICAgICAgICByZXR1cm4gRGkodCkuanQoKHMgPT4gdmkodCwgcywgZSkubmV4dCgodCA9PiAodCAmJiAobiA9ICEwKSwgS3MucmVzb2x2ZSghdCkpKSkpKS5uZXh0KCgoKSA9PiBuKSk7XG4gICAgICAgIH0odCwgZSk7XG4gICAgfVxuICAgIHJlbW92ZU9ycGhhbmVkRG9jdW1lbnRzKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMuZGIuZ2V0UmVtb3RlRG9jdW1lbnRDYWNoZSgpLm5ld0NoYW5nZUJ1ZmZlcigpLCBzID0gW107XG4gICAgICAgIGxldCBpID0gMDtcbiAgICAgICAgcmV0dXJuIHRoaXMuVGUodCwgKChyLCBvKSA9PiB7XG4gICAgICAgICAgICBpZiAobyA8PSBlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuSWUodCwgcikubmV4dCgoZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghZSkgXG4gICAgICAgICAgICAgICAgICAgIC8vIE91ciBzaXplIGFjY291bnRpbmcgcmVxdWlyZXMgdXMgdG8gcmVhZCBhbGwgZG9jdW1lbnRzIGJlZm9yZVxuICAgICAgICAgICAgICAgICAgICAvLyByZW1vdmluZyB0aGVtLlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaSsrLCBuLmdldEVudHJ5KHQsIHIpLm5leHQoKCgpID0+IChuLnJlbW92ZUVudHJ5KHIpLCAkaSh0KS5kZWxldGUoWyAwLCBFcyhyLnBhdGgpIF0pKSkpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICBzLnB1c2goZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBLcy53YWl0Rm9yKHMpKSkubmV4dCgoKCkgPT4gbi5hcHBseSh0KSkpLm5leHQoKCgpID0+IGkpKTtcbiAgICB9XG4gICAgcmVtb3ZlVGFyZ2V0KHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IGUud2l0aFNlcXVlbmNlTnVtYmVyKHQuY3VycmVudFNlcXVlbmNlTnVtYmVyKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGIuZ2V0VGFyZ2V0Q2FjaGUoKS51cGRhdGVUYXJnZXREYXRhKHQsIG4pO1xuICAgIH1cbiAgICB1cGRhdGVMaW1ib0RvY3VtZW50KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHFpKHQsIGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsIHByb3ZpZGVkIGZ1bmN0aW9uIGZvciBlYWNoIGRvY3VtZW50IGluIHRoZSBjYWNoZSB0aGF0IGlzICdvcnBoYW5lZCcuIE9ycGhhbmVkXG4gICAgICogbWVhbnMgbm90IGEgcGFydCBvZiBhbnkgdGFyZ2V0LCBzbyB0aGUgb25seSBlbnRyeSBpbiB0aGUgdGFyZ2V0LWRvY3VtZW50IGluZGV4IGZvclxuICAgICAqIHRoYXQgZG9jdW1lbnQgd2lsbCBiZSB0aGUgc2VudGluZWwgcm93ICh0YXJnZXRJZCAwKSwgd2hpY2ggd2lsbCBhbHNvIGhhdmUgdGhlIHNlcXVlbmNlXG4gICAgICogbnVtYmVyIGZvciB0aGUgbGFzdCB0aW1lIHRoZSBkb2N1bWVudCB3YXMgYWNjZXNzZWQuXG4gICAgICovICAgIFRlKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9ICRpKHQpO1xuICAgICAgICBsZXQgcywgaSA9IFkuVDtcbiAgICAgICAgcmV0dXJuIG4uS3Qoe1xuICAgICAgICAgICAgaW5kZXg6IGtzLmRvY3VtZW50VGFyZ2V0c0luZGV4XG4gICAgICAgIH0sICgoW3QsIG5dLCB7cGF0aDogciwgc2VxdWVuY2VOdW1iZXI6IG99KSA9PiB7XG4gICAgICAgICAgICAwID09PSB0ID8gKFxuICAgICAgICAgICAgLy8gaWYgbmV4dFRvUmVwb3J0IGlzIHZhbGlkLCByZXBvcnQgaXQsIHRoaXMgaXMgYSBuZXcga2V5IHNvIHRoZVxuICAgICAgICAgICAgLy8gbGFzdCBvbmUgbXVzdCBub3QgYmUgYSBtZW1iZXIgb2YgYW55IHRhcmdldHMuXG4gICAgICAgICAgICBpICE9PSBZLlQgJiYgZShuZXcgUHQoQXMocykpLCBpKSwgXG4gICAgICAgICAgICAvLyBzZXQgbmV4dFRvUmVwb3J0IHRvIGJlIHRoaXMgc2VxdWVuY2UgbnVtYmVyLiBJdCdzIHRoZSBuZXh0IG9uZSB3ZVxuICAgICAgICAgICAgLy8gbWlnaHQgcmVwb3J0LCBpZiB3ZSBkb24ndCBmaW5kIGFueSB0YXJnZXRzIGZvciB0aGlzIGRvY3VtZW50LlxuICAgICAgICAgICAgLy8gTm90ZSB0aGF0IHRoZSBzZXF1ZW5jZSBudW1iZXIgbXVzdCBiZSBkZWZpbmVkIHdoZW4gdGhlIHRhcmdldElkXG4gICAgICAgICAgICAvLyBpcyAwLlxuICAgICAgICAgICAgaSA9IG8sIHMgPSByKSA6IFxuICAgICAgICAgICAgLy8gc2V0IG5leHRUb1JlcG9ydCB0byBiZSBpbnZhbGlkLCB3ZSBrbm93IHdlIGRvbid0IG5lZWQgdG8gcmVwb3J0XG4gICAgICAgICAgICAvLyB0aGlzIG9uZSBzaW5jZSB3ZSBmb3VuZCBhIHRhcmdldCBmb3IgaXQuXG4gICAgICAgICAgICBpID0gWS5UO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4ge1xuICAgICAgICAgICAgLy8gU2luY2Ugd2UgcmVwb3J0IHNlcXVlbmNlIG51bWJlcnMgYWZ0ZXIgZ2V0dGluZyB0byB0aGUgbmV4dCBrZXksIHdlXG4gICAgICAgICAgICAvLyBuZWVkIHRvIGNoZWNrIGlmIHRoZSBsYXN0IGtleSB3ZSBpdGVyYXRlZCBvdmVyIHdhcyBhbiBvcnBoYW5lZFxuICAgICAgICAgICAgLy8gZG9jdW1lbnQgYW5kIHJlcG9ydCBpdC5cbiAgICAgICAgICAgIGkgIT09IFkuVCAmJiBlKG5ldyBQdChBcyhzKSksIGkpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGdldENhY2hlU2l6ZSh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRiLmdldFJlbW90ZURvY3VtZW50Q2FjaGUoKS5nZXRTaXplKHQpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gcWkodCwgZSkge1xuICAgIHJldHVybiAkaSh0KS5wdXQoXG4gICAgLyoqXG4gKiBAcmV0dXJucyBBIHZhbHVlIHN1aXRhYmxlIGZvciB3cml0aW5nIGEgc2VudGluZWwgcm93IGluIHRoZSB0YXJnZXQtZG9jdW1lbnRcbiAqIHN0b3JlLlxuICovXG4gICAgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICByZXR1cm4gbmV3IGtzKDAsIEVzKHQucGF0aCksIGUpO1xuICAgIH0oZSwgdC5jdXJyZW50U2VxdWVuY2VOdW1iZXIpKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSBtYXAgaW1wbGVtZW50YXRpb24gdGhhdCB1c2VzIG9iamVjdHMgYXMga2V5cy4gT2JqZWN0cyBtdXN0IGhhdmUgYW5cbiAqIGFzc29jaWF0ZWQgZXF1YWxzIGZ1bmN0aW9uIGFuZCBtdXN0IGJlIGltbXV0YWJsZS4gRW50cmllcyBpbiB0aGUgbWFwIGFyZVxuICogc3RvcmVkIHRvZ2V0aGVyIHdpdGggdGhlIGtleSBiZWluZyBwcm9kdWNlZCBmcm9tIHRoZSBtYXBLZXlGbi4gVGhpcyBtYXBcbiAqIGF1dG9tYXRpY2FsbHkgaGFuZGxlcyBjb2xsaXNpb25zIG9mIGtleXMuXG4gKi8gY2xhc3MgS2kge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5tYXBLZXlGbiA9IHQsIHRoaXMuZXF1YWxzRm4gPSBlLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBpbm5lciBtYXAgZm9yIGEga2V5L3ZhbHVlIHBhaXIuIER1ZSB0byB0aGUgcG9zc2liaWxpdHkgb2YgY29sbGlzaW9ucyB3ZVxuICAgICAgICAgKiBrZWVwIGEgbGlzdCBvZiBlbnRyaWVzIHRoYXQgd2UgZG8gYSBsaW5lYXIgc2VhcmNoIHRocm91Z2ggdG8gZmluZCBhbiBhY3R1YWxcbiAgICAgICAgICogbWF0Y2guIE5vdGUgdGhhdCBjb2xsaXNpb25zIHNob3VsZCBiZSByYXJlLCBzbyB3ZSBzdGlsbCBleHBlY3QgbmVhclxuICAgICAgICAgKiBjb25zdGFudCB0aW1lIGxvb2t1cHMgaW4gcHJhY3RpY2UuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmlubmVyID0ge307XG4gICAgfVxuICAgIC8qKiBHZXQgYSB2YWx1ZSBmb3IgdGhpcyBrZXksIG9yIHVuZGVmaW5lZCBpZiBpdCBkb2VzIG5vdCBleGlzdC4gKi8gICAgZ2V0KHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMubWFwS2V5Rm4odCksIG4gPSB0aGlzLmlubmVyW2VdO1xuICAgICAgICBpZiAodm9pZCAwICE9PSBuKSBmb3IgKGNvbnN0IFtlLCBzXSBvZiBuKSBpZiAodGhpcy5lcXVhbHNGbihlLCB0KSkgcmV0dXJuIHM7XG4gICAgfVxuICAgIGhhcyh0KSB7XG4gICAgICAgIHJldHVybiB2b2lkIDAgIT09IHRoaXMuZ2V0KHQpO1xuICAgIH1cbiAgICAvKiogUHV0IHRoaXMga2V5IGFuZCB2YWx1ZSBpbiB0aGUgbWFwLiAqLyAgICBzZXQodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gdGhpcy5tYXBLZXlGbih0KSwgcyA9IHRoaXMuaW5uZXJbbl07XG4gICAgICAgIGlmICh2b2lkIDAgIT09IHMpIHtcbiAgICAgICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgcy5sZW5ndGg7IG4rKykgaWYgKHRoaXMuZXF1YWxzRm4oc1tuXVswXSwgdCkpIHJldHVybiB2b2lkIChzW25dID0gWyB0LCBlIF0pO1xuICAgICAgICAgICAgcy5wdXNoKFsgdCwgZSBdKTtcbiAgICAgICAgfSBlbHNlIHRoaXMuaW5uZXJbbl0gPSBbIFsgdCwgZSBdIF07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlbW92ZSB0aGlzIGtleSBmcm9tIHRoZSBtYXAuIFJldHVybnMgYSBib29sZWFuIGlmIGFueXRoaW5nIHdhcyBkZWxldGVkLlxuICAgICAqLyAgICBkZWxldGUodCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5tYXBLZXlGbih0KSwgbiA9IHRoaXMuaW5uZXJbZV07XG4gICAgICAgIGlmICh2b2lkIDAgPT09IG4pIHJldHVybiAhMTtcbiAgICAgICAgZm9yIChsZXQgcyA9IDA7IHMgPCBuLmxlbmd0aDsgcysrKSBpZiAodGhpcy5lcXVhbHNGbihuW3NdWzBdLCB0KSkgcmV0dXJuIDEgPT09IG4ubGVuZ3RoID8gZGVsZXRlIHRoaXMuaW5uZXJbZV0gOiBuLnNwbGljZShzLCAxKSwgXG4gICAgICAgICEwO1xuICAgICAgICByZXR1cm4gITE7XG4gICAgfVxuICAgIGZvckVhY2godCkge1xuICAgICAgICBvdCh0aGlzLmlubmVyLCAoKGUsIG4pID0+IHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgW2UsIHNdIG9mIG4pIHQoZSwgcyk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgaXNFbXB0eSgpIHtcbiAgICAgICAgcmV0dXJuIGF0KHRoaXMuaW5uZXIpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQW4gaW4tbWVtb3J5IGJ1ZmZlciBvZiBlbnRyaWVzIHRvIGJlIHdyaXR0ZW4gdG8gYSBSZW1vdGVEb2N1bWVudENhY2hlLlxuICogSXQgY2FuIGJlIHVzZWQgdG8gYmF0Y2ggdXAgYSBzZXQgb2YgY2hhbmdlcyB0byBiZSB3cml0dGVuIHRvIHRoZSBjYWNoZSwgYnV0XG4gKiBhZGRpdGlvbmFsbHkgc3VwcG9ydHMgcmVhZGluZyBlbnRyaWVzIGJhY2sgd2l0aCB0aGUgYGdldEVudHJ5KClgIG1ldGhvZCxcbiAqIGZhbGxpbmcgYmFjayB0byB0aGUgdW5kZXJseWluZyBSZW1vdGVEb2N1bWVudENhY2hlIGlmIG5vIGVudHJ5IGlzXG4gKiBidWZmZXJlZC5cbiAqXG4gKiBFbnRyaWVzIGFkZGVkIHRvIHRoZSBjYWNoZSAqbXVzdCogYmUgcmVhZCBmaXJzdC4gVGhpcyBpcyB0byBmYWNpbGl0YXRlXG4gKiBjYWxjdWxhdGluZyB0aGUgc2l6ZSBkZWx0YSBvZiB0aGUgcGVuZGluZyBjaGFuZ2VzLlxuICpcbiAqIFBPUlRJTkcgTk9URTogVGhpcyBjbGFzcyB3YXMgaW1wbGVtZW50ZWQgdGhlbiByZW1vdmVkIGZyb20gb3RoZXIgcGxhdGZvcm1zLlxuICogSWYgYnl0ZS1jb3VudGluZyBlbmRzIHVwIGJlaW5nIG5lZWRlZCBvbiB0aGUgb3RoZXIgcGxhdGZvcm1zLCBjb25zaWRlclxuICogcG9ydGluZyB0aGlzIGNsYXNzIGFzIHBhcnQgb2YgdGhhdCBpbXBsZW1lbnRhdGlvbiB3b3JrLlxuICovIGNsYXNzIGppIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgLy8gQSBtYXBwaW5nIG9mIGRvY3VtZW50IGtleSB0byB0aGUgbmV3IGNhY2hlIGVudHJ5IHRoYXQgc2hvdWxkIGJlIHdyaXR0ZW4gKG9yIG51bGwgaWYgYW55XG4gICAgICAgIC8vIGV4aXN0aW5nIGNhY2hlIGVudHJ5IHNob3VsZCBiZSByZW1vdmVkKS5cbiAgICAgICAgdGhpcy5jaGFuZ2VzID0gbmV3IEtpKCh0ID0+IHQudG9TdHJpbmcoKSksICgodCwgZSkgPT4gdC5pc0VxdWFsKGUpKSksIHRoaXMuY2hhbmdlc0FwcGxpZWQgPSAhMTtcbiAgICB9XG4gICAgZ2V0UmVhZFRpbWUodCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5jaGFuZ2VzLmdldCh0KTtcbiAgICAgICAgcmV0dXJuIGUgPyBlLnJlYWRUaW1lIDogaXQubWluKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEJ1ZmZlcnMgYSBgUmVtb3RlRG9jdW1lbnRDYWNoZS5hZGRFbnRyeSgpYCBjYWxsLlxuICAgICAqXG4gICAgICogWW91IGNhbiBvbmx5IG1vZGlmeSBkb2N1bWVudHMgdGhhdCBoYXZlIGFscmVhZHkgYmVlbiByZXRyaWV2ZWQgdmlhXG4gICAgICogYGdldEVudHJ5KCkvZ2V0RW50cmllcygpYCAoZW5mb3JjZWQgdmlhIEluZGV4ZWREYnMgYGFwcGx5KClgKS5cbiAgICAgKi8gICAgYWRkRW50cnkodCwgZSkge1xuICAgICAgICB0aGlzLmFzc2VydE5vdEFwcGxpZWQoKSwgdGhpcy5jaGFuZ2VzLnNldCh0LmtleSwge1xuICAgICAgICAgICAgZG9jdW1lbnQ6IHQsXG4gICAgICAgICAgICByZWFkVGltZTogZVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQnVmZmVycyBhIGBSZW1vdGVEb2N1bWVudENhY2hlLnJlbW92ZUVudHJ5KClgIGNhbGwuXG4gICAgICpcbiAgICAgKiBZb3UgY2FuIG9ubHkgcmVtb3ZlIGRvY3VtZW50cyB0aGF0IGhhdmUgYWxyZWFkeSBiZWVuIHJldHJpZXZlZCB2aWFcbiAgICAgKiBgZ2V0RW50cnkoKS9nZXRFbnRyaWVzKClgIChlbmZvcmNlZCB2aWEgSW5kZXhlZERicyBgYXBwbHkoKWApLlxuICAgICAqLyAgICByZW1vdmVFbnRyeSh0LCBlID0gbnVsbCkge1xuICAgICAgICB0aGlzLmFzc2VydE5vdEFwcGxpZWQoKSwgdGhpcy5jaGFuZ2VzLnNldCh0LCB7XG4gICAgICAgICAgICBkb2N1bWVudDogcXQubmV3SW52YWxpZERvY3VtZW50KHQpLFxuICAgICAgICAgICAgcmVhZFRpbWU6IGVcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIExvb2tzIHVwIGFuIGVudHJ5IGluIHRoZSBjYWNoZS4gVGhlIGJ1ZmZlcmVkIGNoYW5nZXMgd2lsbCBmaXJzdCBiZSBjaGVja2VkLFxuICAgICAqIGFuZCBpZiBubyBidWZmZXJlZCBjaGFuZ2UgYXBwbGllcywgdGhpcyB3aWxsIGZvcndhcmQgdG9cbiAgICAgKiBgUmVtb3RlRG9jdW1lbnRDYWNoZS5nZXRFbnRyeSgpYC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB0cmFuc2FjdGlvbiAtIFRoZSB0cmFuc2FjdGlvbiBpbiB3aGljaCB0byBwZXJmb3JtIGFueSBwZXJzaXN0ZW5jZVxuICAgICAqICAgICBvcGVyYXRpb25zLlxuICAgICAqIEBwYXJhbSBkb2N1bWVudEtleSAtIFRoZSBrZXkgb2YgdGhlIGVudHJ5IHRvIGxvb2sgdXAuXG4gICAgICogQHJldHVybnMgVGhlIGNhY2hlZCBkb2N1bWVudCBvciBhbiBpbnZhbGlkIGRvY3VtZW50IGlmIHdlIGhhdmUgbm90aGluZ1xuICAgICAqIGNhY2hlZC5cbiAgICAgKi8gICAgZ2V0RW50cnkodCwgZSkge1xuICAgICAgICB0aGlzLmFzc2VydE5vdEFwcGxpZWQoKTtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMuY2hhbmdlcy5nZXQoZSk7XG4gICAgICAgIHJldHVybiB2b2lkIDAgIT09IG4gPyBLcy5yZXNvbHZlKG4uZG9jdW1lbnQpIDogdGhpcy5nZXRGcm9tQ2FjaGUodCwgZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIExvb2tzIHVwIHNldmVyYWwgZW50cmllcyBpbiB0aGUgY2FjaGUsIGZvcndhcmRpbmcgdG9cbiAgICAgKiBgUmVtb3RlRG9jdW1lbnRDYWNoZS5nZXRFbnRyeSgpYC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB0cmFuc2FjdGlvbiAtIFRoZSB0cmFuc2FjdGlvbiBpbiB3aGljaCB0byBwZXJmb3JtIGFueSBwZXJzaXN0ZW5jZVxuICAgICAqICAgICBvcGVyYXRpb25zLlxuICAgICAqIEBwYXJhbSBkb2N1bWVudEtleXMgLSBUaGUga2V5cyBvZiB0aGUgZW50cmllcyB0byBsb29rIHVwLlxuICAgICAqIEByZXR1cm5zIEEgbWFwIG9mIGNhY2hlZCBkb2N1bWVudHMsIGluZGV4ZWQgYnkga2V5LiBJZiBhbiBlbnRyeSBjYW5ub3QgYmVcbiAgICAgKiAgICAgZm91bmQsIHRoZSBjb3JyZXNwb25kaW5nIGtleSB3aWxsIGJlIG1hcHBlZCB0byBhbiBpbnZhbGlkIGRvY3VtZW50LlxuICAgICAqLyAgICBnZXRFbnRyaWVzKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QWxsRnJvbUNhY2hlKHQsIGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBcHBsaWVzIGJ1ZmZlcmVkIGNoYW5nZXMgdG8gdGhlIHVuZGVybHlpbmcgUmVtb3RlRG9jdW1lbnRDYWNoZSwgdXNpbmdcbiAgICAgKiB0aGUgcHJvdmlkZWQgdHJhbnNhY3Rpb24uXG4gICAgICovICAgIGFwcGx5KHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXNzZXJ0Tm90QXBwbGllZCgpLCB0aGlzLmNoYW5nZXNBcHBsaWVkID0gITAsIHRoaXMuYXBwbHlDaGFuZ2VzKHQpO1xuICAgIH1cbiAgICAvKiogSGVscGVyIHRvIGFzc2VydCB0aGlzLmNoYW5nZXMgaXMgbm90IG51bGwgICovICAgIGFzc2VydE5vdEFwcGxpZWQoKSB7fVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBUaGUgUmVtb3RlRG9jdW1lbnRDYWNoZSBmb3IgSW5kZXhlZERiLiBUbyBjb25zdHJ1Y3QsIGludm9rZVxuICogYG5ld0luZGV4ZWREYlJlbW90ZURvY3VtZW50Q2FjaGUoKWAuXG4gKi8gY2xhc3MgUWkge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSBzZXJpYWxpemVyIC0gVGhlIGRvY3VtZW50IHNlcmlhbGl6ZXIuXG4gICAgICogQHBhcmFtIGluZGV4TWFuYWdlciAtIFRoZSBxdWVyeSBpbmRleGVzIHRoYXQgbmVlZCB0byBiZSBtYWludGFpbmVkLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5OID0gdCwgdGhpcy5IdCA9IGU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZHMgdGhlIHN1cHBsaWVkIGVudHJpZXMgdG8gdGhlIGNhY2hlLlxuICAgICAqXG4gICAgICogQWxsIGNhbGxzIG9mIGBhZGRFbnRyeWAgYXJlIHJlcXVpcmVkIHRvIGdvIHRocm91Z2ggdGhlIFJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyXG4gICAgICogcmV0dXJuZWQgYnkgYG5ld0NoYW5nZUJ1ZmZlcigpYCB0byBlbnN1cmUgcHJvcGVyIGFjY291bnRpbmcgb2YgbWV0YWRhdGEuXG4gICAgICovICAgIGFkZEVudHJ5KHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIHppKHQpLnB1dChIaShlKSwgbik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgYSBkb2N1bWVudCBmcm9tIHRoZSBjYWNoZS5cbiAgICAgKlxuICAgICAqIEFsbCBjYWxscyBvZiBgcmVtb3ZlRW50cnlgICBhcmUgcmVxdWlyZWQgdG8gZ28gdGhyb3VnaCB0aGUgUmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXJcbiAgICAgKiByZXR1cm5lZCBieSBgbmV3Q2hhbmdlQnVmZmVyKClgIHRvIGVuc3VyZSBwcm9wZXIgYWNjb3VudGluZyBvZiBtZXRhZGF0YS5cbiAgICAgKi8gICAgcmVtb3ZlRW50cnkodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gemkodCksIHMgPSBIaShlKTtcbiAgICAgICAgcmV0dXJuIG4uZGVsZXRlKHMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBVcGRhdGVzIHRoZSBjdXJyZW50IGNhY2hlIHNpemUuXG4gICAgICpcbiAgICAgKiBDYWxsZXJzIHRvIGBhZGRFbnRyeSgpYCBhbmQgYHJlbW92ZUVudHJ5KClgICptdXN0KiBjYWxsIHRoaXMgYWZ0ZXJ3YXJkcyB0byB1cGRhdGUgdGhlXG4gICAgICogY2FjaGUncyBtZXRhZGF0YS5cbiAgICAgKi8gICAgdXBkYXRlTWV0YWRhdGEodCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRNZXRhZGF0YSh0KS5uZXh0KChuID0+IChuLmJ5dGVTaXplICs9IGUsIHRoaXMuQWUodCwgbikpKSk7XG4gICAgfVxuICAgIGdldEVudHJ5KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHppKHQpLmdldChIaShlKSkubmV4dCgodCA9PiB0aGlzLlJlKGUsIHQpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIExvb2tzIHVwIGFuIGVudHJ5IGluIHRoZSBjYWNoZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBkb2N1bWVudEtleSAtIFRoZSBrZXkgb2YgdGhlIGVudHJ5IHRvIGxvb2sgdXAuXG4gICAgICogQHJldHVybnMgVGhlIGNhY2hlZCBkb2N1bWVudCBlbnRyeSBhbmQgaXRzIHNpemUuXG4gICAgICovICAgIFBlKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHppKHQpLmdldChIaShlKSkubmV4dCgodCA9PiAoe1xuICAgICAgICAgICAgZG9jdW1lbnQ6IHRoaXMuUmUoZSwgdCksXG4gICAgICAgICAgICBzaXplOiBQaSh0KVxuICAgICAgICB9KSkpO1xuICAgIH1cbiAgICBnZXRFbnRyaWVzKHQsIGUpIHtcbiAgICAgICAgbGV0IG4gPSBwbigpO1xuICAgICAgICByZXR1cm4gdGhpcy5iZSh0LCBlLCAoKHQsIGUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSB0aGlzLlJlKHQsIGUpO1xuICAgICAgICAgICAgbiA9IG4uaW5zZXJ0KHQsIHMpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gbikpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBMb29rcyB1cCBzZXZlcmFsIGVudHJpZXMgaW4gdGhlIGNhY2hlLlxuICAgICAqXG4gICAgICogQHBhcmFtIGRvY3VtZW50S2V5cyAtIFRoZSBzZXQgb2Yga2V5cyBlbnRyaWVzIHRvIGxvb2sgdXAuXG4gICAgICogQHJldHVybnMgQSBtYXAgb2YgZG9jdW1lbnRzIGluZGV4ZWQgYnkga2V5IGFuZCBhIG1hcCBvZiBzaXplcyBpbmRleGVkIGJ5XG4gICAgICogICAgIGtleSAoemVybyBpZiB0aGUgZG9jdW1lbnQgZG9lcyBub3QgZXhpc3QpLlxuICAgICAqLyAgICB2ZSh0LCBlKSB7XG4gICAgICAgIGxldCBuID0gcG4oKSwgcyA9IG5ldyBkbihQdC5jb21wYXJhdG9yKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuYmUodCwgZSwgKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBpID0gdGhpcy5SZSh0LCBlKTtcbiAgICAgICAgICAgIG4gPSBuLmluc2VydCh0LCBpKSwgcyA9IHMuaW5zZXJ0KHQsIFBpKGUpKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+ICh7XG4gICAgICAgICAgICBkb2N1bWVudHM6IG4sXG4gICAgICAgICAgICBWZTogc1xuICAgICAgICB9KSkpO1xuICAgIH1cbiAgICBiZSh0LCBlLCBuKSB7XG4gICAgICAgIGlmIChlLmlzRW1wdHkoKSkgcmV0dXJuIEtzLnJlc29sdmUoKTtcbiAgICAgICAgY29uc3QgcyA9IElEQktleVJhbmdlLmJvdW5kKGUuZmlyc3QoKS5wYXRoLnRvQXJyYXkoKSwgZS5sYXN0KCkucGF0aC50b0FycmF5KCkpLCBpID0gZS5nZXRJdGVyYXRvcigpO1xuICAgICAgICBsZXQgciA9IGkuZ2V0TmV4dCgpO1xuICAgICAgICByZXR1cm4gemkodCkuS3Qoe1xuICAgICAgICAgICAgcmFuZ2U6IHNcbiAgICAgICAgfSwgKCh0LCBlLCBzKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBvID0gUHQuZnJvbVNlZ21lbnRzKHQpO1xuICAgICAgICAgICAgLy8gR28gdGhyb3VnaCBrZXlzIG5vdCBmb3VuZCBpbiBjYWNoZS5cbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoO3IgJiYgUHQuY29tcGFyYXRvcihyLCBvKSA8IDA7ICkgbihyLCBudWxsKSwgciA9IGkuZ2V0TmV4dCgpO1xuICAgICAgICAgICAgciAmJiByLmlzRXF1YWwobykgJiYgKFxuICAgICAgICAgICAgLy8gS2V5IGZvdW5kIGluIGNhY2hlLlxuICAgICAgICAgICAgbihyLCBlKSwgciA9IGkuaGFzTmV4dCgpID8gaS5nZXROZXh0KCkgOiBudWxsKSwgXG4gICAgICAgICAgICAvLyBTa2lwIHRvIHRoZSBuZXh0IGtleSAoaWYgdGhlcmUgaXMgb25lKS5cbiAgICAgICAgICAgIHIgPyBzLk10KHIucGF0aC50b0FycmF5KCkpIDogcy5kb25lKCk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiB7XG4gICAgICAgICAgICAvLyBUaGUgcmVzdCBvZiB0aGUga2V5cyBhcmUgbm90IGluIHRoZSBjYWNoZS4gT25lIGNhc2Ugd2hlcmUgYGl0ZXJhdGVgXG4gICAgICAgICAgICAvLyBhYm92ZSB3b24ndCBnbyB0aHJvdWdoIHRoZW0gaXMgd2hlbiB0aGUgY2FjaGUgaXMgZW1wdHkuXG4gICAgICAgICAgICBmb3IgKDtyOyApIG4ociwgbnVsbCksIHIgPSBpLmhhc05leHQoKSA/IGkuZ2V0TmV4dCgpIDogbnVsbDtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBnZXREb2N1bWVudHNNYXRjaGluZ1F1ZXJ5KHQsIGUsIG4pIHtcbiAgICAgICAgbGV0IHMgPSBwbigpO1xuICAgICAgICBjb25zdCBpID0gZS5wYXRoLmxlbmd0aCArIDEsIHIgPSB7fTtcbiAgICAgICAgaWYgKG4uaXNFcXVhbChpdC5taW4oKSkpIHtcbiAgICAgICAgICAgIC8vIERvY3VtZW50cyBhcmUgb3JkZXJlZCBieSBrZXksIHNvIHdlIGNhbiB1c2UgYSBwcmVmaXggc2NhbiB0byBuYXJyb3dcbiAgICAgICAgICAgIC8vIGRvd24gdGhlIGRvY3VtZW50cyB3ZSBuZWVkIHRvIG1hdGNoIHRoZSBxdWVyeSBhZ2FpbnN0LlxuICAgICAgICAgICAgY29uc3QgdCA9IGUucGF0aC50b0FycmF5KCk7XG4gICAgICAgICAgICByLnJhbmdlID0gSURCS2V5UmFuZ2UubG93ZXJCb3VuZCh0KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIEV4ZWN1dGUgYW4gaW5kZXgtZnJlZSBxdWVyeSBhbmQgZmlsdGVyIGJ5IHJlYWQgdGltZS4gVGhpcyBpcyBzYWZlXG4gICAgICAgICAgICAvLyBzaW5jZSBhbGwgZG9jdW1lbnQgY2hhbmdlcyB0byBxdWVyaWVzIHRoYXQgaGF2ZSBhXG4gICAgICAgICAgICAvLyBsYXN0TGltYm9GcmVlU25hcHNob3RWZXJzaW9uIChgc2luY2VSZWFkVGltZWApIGhhdmUgYSByZWFkIHRpbWUgc2V0LlxuICAgICAgICAgICAgY29uc3QgdCA9IGUucGF0aC50b0FycmF5KCksIHMgPSBhaShuKTtcbiAgICAgICAgICAgIHIucmFuZ2UgPSBJREJLZXlSYW5nZS5sb3dlckJvdW5kKFsgdCwgcyBdLCBcbiAgICAgICAgICAgIC8qIG9wZW49ICovICEwKSwgci5pbmRleCA9IENzLmNvbGxlY3Rpb25SZWFkVGltZUluZGV4O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB6aSh0KS5LdChyLCAoKHQsIG4sIHIpID0+IHtcbiAgICAgICAgICAgIC8vIFRoZSBxdWVyeSBpcyBhY3R1YWxseSByZXR1cm5pbmcgYW55IHBhdGggdGhhdCBzdGFydHMgd2l0aCB0aGUgcXVlcnlcbiAgICAgICAgICAgIC8vIHBhdGggcHJlZml4IHdoaWNoIG1heSBpbmNsdWRlIGRvY3VtZW50cyBpbiBzdWJjb2xsZWN0aW9ucy4gRm9yXG4gICAgICAgICAgICAvLyBleGFtcGxlLCBhIHF1ZXJ5IG9uICdyb29tcycgd2lsbCByZXR1cm4gcm9vbXMvYWJjL21lc3NhZ2VzL3h5eCBidXQgd2VcbiAgICAgICAgICAgIC8vIHNob3VsZG4ndCBtYXRjaCBpdC4gRml4IHRoaXMgYnkgZGlzY2FyZGluZyByb3dzIHdpdGggZG9jdW1lbnQga2V5c1xuICAgICAgICAgICAgLy8gbW9yZSB0aGFuIG9uZSBzZWdtZW50IGxvbmdlciB0aGFuIHRoZSBxdWVyeSBwYXRoLlxuICAgICAgICAgICAgaWYgKHQubGVuZ3RoICE9PSBpKSByZXR1cm47XG4gICAgICAgICAgICBjb25zdCBvID0gcmkodGhpcy5OLCBuKTtcbiAgICAgICAgICAgIGUucGF0aC5pc1ByZWZpeE9mKG8ua2V5LnBhdGgpID8gUGUoZSwgbykgJiYgKHMgPSBzLmluc2VydChvLmtleSwgbykpIDogci5kb25lKCk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBzKSk7XG4gICAgfVxuICAgIG5ld0NoYW5nZUJ1ZmZlcih0KSB7XG4gICAgICAgIHJldHVybiBuZXcgV2kodGhpcywgISF0ICYmIHQudHJhY2tSZW1vdmFscyk7XG4gICAgfVxuICAgIGdldFNpemUodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRNZXRhZGF0YSh0KS5uZXh0KCh0ID0+IHQuYnl0ZVNpemUpKTtcbiAgICB9XG4gICAgZ2V0TWV0YWRhdGEodCkge1xuICAgICAgICByZXR1cm4gR2kodCkuZ2V0KE5zLmtleSkubmV4dCgodCA9PiAoTCghIXQpLCB0KSkpO1xuICAgIH1cbiAgICBBZSh0LCBlKSB7XG4gICAgICAgIHJldHVybiBHaSh0KS5wdXQoTnMua2V5LCBlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRGVjb2RlcyBgcmVtb3RlRG9jYCBhbmQgcmV0dXJucyB0aGUgZG9jdW1lbnQgKG9yIG51bGwsIGlmIHRoZSBkb2N1bWVudFxuICAgICAqIGNvcnJlc3BvbmRzIHRvIHRoZSBmb3JtYXQgdXNlZCBmb3Igc2VudGluZWwgZGVsZXRlcykuXG4gICAgICovICAgIFJlKHQsIGUpIHtcbiAgICAgICAgaWYgKGUpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSByaSh0aGlzLk4sIGUpO1xuICAgICAgICAgICAgLy8gV2hldGhlciB0aGUgZG9jdW1lbnQgaXMgYSBzZW50aW5lbCByZW1vdmFsIGFuZCBzaG91bGQgb25seSBiZSB1c2VkIGluIHRoZVxuICAgICAgICAgICAgLy8gYGdldE5ld0RvY3VtZW50Q2hhbmdlcygpYFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodC5pc05vRG9jdW1lbnQoKSAmJiB0LnZlcnNpb24uaXNFcXVhbChpdC5taW4oKSkpKSByZXR1cm4gdDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcXQubmV3SW52YWxpZERvY3VtZW50KHQpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IEluZGV4ZWREYlJlbW90ZURvY3VtZW50Q2FjaGUuXG4gKlxuICogQHBhcmFtIHNlcmlhbGl6ZXIgLSBUaGUgZG9jdW1lbnQgc2VyaWFsaXplci5cbiAqIEBwYXJhbSBpbmRleE1hbmFnZXIgLSBUaGUgcXVlcnkgaW5kZXhlcyB0aGF0IG5lZWQgdG8gYmUgbWFpbnRhaW5lZC5cbiAqL1xuLyoqXG4gKiBIYW5kbGVzIHRoZSBkZXRhaWxzIG9mIGFkZGluZyBhbmQgdXBkYXRpbmcgZG9jdW1lbnRzIGluIHRoZSBJbmRleGVkRGJSZW1vdGVEb2N1bWVudENhY2hlLlxuICpcbiAqIFVubGlrZSB0aGUgTWVtb3J5UmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXIsIHRoZSBJbmRleGVkRGIgaW1wbGVtZW50YXRpb24gY29tcHV0ZXMgdGhlIHNpemVcbiAqIGRlbHRhIGZvciBhbGwgc3VibWl0dGVkIGNoYW5nZXMuIFRoaXMgYXZvaWRzIGhhdmluZyB0byByZS1yZWFkIGFsbCBkb2N1bWVudHMgZnJvbSBJbmRleGVkRGJcbiAqIHdoZW4gd2UgYXBwbHkgdGhlIGNoYW5nZXMuXG4gKi9cbmNsYXNzIFdpIGV4dGVuZHMgamkge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSBkb2N1bWVudENhY2hlIC0gVGhlIEluZGV4ZWREYlJlbW90ZURvY3VtZW50Q2FjaGUgdG8gYXBwbHkgdGhlIGNoYW5nZXMgdG8uXG4gICAgICogQHBhcmFtIHRyYWNrUmVtb3ZhbHMgLSBXaGV0aGVyIHRvIGNyZWF0ZSBzZW50aW5lbCBkZWxldGVzIHRoYXQgY2FuIGJlIHRyYWNrZWQgYnlcbiAgICAgKiBgZ2V0TmV3RG9jdW1lbnRDaGFuZ2VzKClgLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5TZSA9IHQsIHRoaXMudHJhY2tSZW1vdmFscyA9IGUsIFxuICAgICAgICAvLyBBIG1hcCBvZiBkb2N1bWVudCBzaXplcyBwcmlvciB0byBhcHBseWluZyB0aGUgY2hhbmdlcyBpbiB0aGlzIGJ1ZmZlci5cbiAgICAgICAgdGhpcy5EZSA9IG5ldyBLaSgodCA9PiB0LnRvU3RyaW5nKCkpLCAoKHQsIGUpID0+IHQuaXNFcXVhbChlKSkpO1xuICAgIH1cbiAgICBhcHBseUNoYW5nZXModCkge1xuICAgICAgICBjb25zdCBlID0gW107XG4gICAgICAgIGxldCBuID0gMCwgcyA9IG5ldyBtbigoKHQsIGUpID0+IHR0KHQuY2Fub25pY2FsU3RyaW5nKCksIGUuY2Fub25pY2FsU3RyaW5nKCkpKSk7XG4gICAgICAgIHJldHVybiB0aGlzLmNoYW5nZXMuZm9yRWFjaCgoKGksIHIpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG8gPSB0aGlzLkRlLmdldChpKTtcbiAgICAgICAgICAgIGlmIChyLmRvY3VtZW50LmlzVmFsaWREb2N1bWVudCgpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgYSA9IG9pKHRoaXMuU2UuTiwgci5kb2N1bWVudCwgdGhpcy5nZXRSZWFkVGltZShpKSk7XG4gICAgICAgICAgICAgICAgcyA9IHMuYWRkKGkucGF0aC5wb3BMYXN0KCkpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGMgPSBQaShhKTtcbiAgICAgICAgICAgICAgICBuICs9IGMgLSBvLCBlLnB1c2godGhpcy5TZS5hZGRFbnRyeSh0LCBpLCBhKSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG4gLT0gbywgdGhpcy50cmFja1JlbW92YWxzKSB7XG4gICAgICAgICAgICAgICAgLy8gSW4gb3JkZXIgdG8gdHJhY2sgcmVtb3ZhbHMsIHdlIHN0b3JlIGEgXCJzZW50aW5lbCBkZWxldGVcIiBpbiB0aGVcbiAgICAgICAgICAgICAgICAvLyBSZW1vdGVEb2N1bWVudENhY2hlLiBUaGlzIGVudHJ5IGlzIHJlcHJlc2VudGVkIGJ5IGEgTm9Eb2N1bWVudFxuICAgICAgICAgICAgICAgIC8vIHdpdGggYSB2ZXJzaW9uIG9mIDAgYW5kIGlnbm9yZWQgYnkgYG1heWJlRGVjb2RlRG9jdW1lbnQoKWAgYnV0XG4gICAgICAgICAgICAgICAgLy8gcHJlc2VydmVkIGluIGBnZXROZXdEb2N1bWVudENoYW5nZXMoKWAuXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IG9pKHRoaXMuU2UuTiwgcXQubmV3Tm9Eb2N1bWVudChpLCBpdC5taW4oKSksIHRoaXMuZ2V0UmVhZFRpbWUoaSkpO1xuICAgICAgICAgICAgICAgIGUucHVzaCh0aGlzLlNlLmFkZEVudHJ5KHQsIGksIG4pKTtcbiAgICAgICAgICAgIH0gZWxzZSBlLnB1c2godGhpcy5TZS5yZW1vdmVFbnRyeSh0LCBpKSk7XG4gICAgICAgIH0pKSwgcy5mb3JFYWNoKChuID0+IHtcbiAgICAgICAgICAgIGUucHVzaCh0aGlzLlNlLkh0LmFkZFRvQ29sbGVjdGlvblBhcmVudEluZGV4KHQsIG4pKTtcbiAgICAgICAgfSkpLCBlLnB1c2godGhpcy5TZS51cGRhdGVNZXRhZGF0YSh0LCBuKSksIEtzLndhaXRGb3IoZSk7XG4gICAgfVxuICAgIGdldEZyb21DYWNoZSh0LCBlKSB7XG4gICAgICAgIC8vIFJlY29yZCB0aGUgc2l6ZSBvZiBldmVyeXRoaW5nIHdlIGxvYWQgZnJvbSB0aGUgY2FjaGUgc28gd2UgY2FuIGNvbXB1dGUgYSBkZWx0YSBsYXRlci5cbiAgICAgICAgcmV0dXJuIHRoaXMuU2UuUGUodCwgZSkubmV4dCgodCA9PiAodGhpcy5EZS5zZXQoZSwgdC5zaXplKSwgdC5kb2N1bWVudCkpKTtcbiAgICB9XG4gICAgZ2V0QWxsRnJvbUNhY2hlKHQsIGUpIHtcbiAgICAgICAgLy8gUmVjb3JkIHRoZSBzaXplIG9mIGV2ZXJ5dGhpbmcgd2UgbG9hZCBmcm9tIHRoZSBjYWNoZSBzbyB3ZSBjYW4gY29tcHV0ZVxuICAgICAgICAvLyBhIGRlbHRhIGxhdGVyLlxuICAgICAgICByZXR1cm4gdGhpcy5TZS52ZSh0LCBlKS5uZXh0KCgoe2RvY3VtZW50czogdCwgVmU6IGV9KSA9PiAoXG4gICAgICAgIC8vIE5vdGU6IGBnZXRBbGxGcm9tQ2FjaGVgIHJldHVybnMgdHdvIG1hcHMgaW5zdGVhZCBvZiBhIHNpbmdsZSBtYXAgZnJvbVxuICAgICAgICAvLyBrZXlzIHRvIGBEb2N1bWVudFNpemVFbnRyeWBzLiBUaGlzIGlzIHRvIGFsbG93IHJldHVybmluZyB0aGVcbiAgICAgICAgLy8gYE11dGFibGVEb2N1bWVudE1hcGAgZGlyZWN0bHksIHdpdGhvdXQgYSBjb252ZXJzaW9uLlxuICAgICAgICBlLmZvckVhY2goKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLkRlLnNldCh0LCBlKTtcbiAgICAgICAgfSkpLCB0KSkpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gR2kodCkge1xuICAgIHJldHVybiB0aSh0LCBOcy5zdG9yZSk7XG59XG5cbi8qKlxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSByZW1vdGVEb2N1bWVudHMgb2JqZWN0IHN0b3JlLlxuICovIGZ1bmN0aW9uIHppKHQpIHtcbiAgICByZXR1cm4gdGkodCwgQ3Muc3RvcmUpO1xufVxuXG5mdW5jdGlvbiBIaSh0KSB7XG4gICAgcmV0dXJuIHQucGF0aC50b0FycmF5KCk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKiogUGVyZm9ybXMgZGF0YWJhc2UgY3JlYXRpb24gYW5kIHNjaGVtYSB1cGdyYWRlcy4gKi8gY2xhc3MgSmkge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5OID0gdDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUGVyZm9ybXMgZGF0YWJhc2UgY3JlYXRpb24gYW5kIHNjaGVtYSB1cGdyYWRlcy5cbiAgICAgKlxuICAgICAqIE5vdGUgdGhhdCBpbiBwcm9kdWN0aW9uLCB0aGlzIG1ldGhvZCBpcyBvbmx5IGV2ZXIgdXNlZCB0byB1cGdyYWRlIHRoZSBzY2hlbWFcbiAgICAgKiB0byBTQ0hFTUFfVkVSU0lPTi4gRGlmZmVyZW50IHZhbHVlcyBvZiB0b1ZlcnNpb24gYXJlIG9ubHkgdXNlZCBmb3IgdGVzdGluZ1xuICAgICAqIGFuZCBsb2NhbCBmZWF0dXJlIGRldmVsb3BtZW50LlxuICAgICAqLyAgICBDdCh0LCBlLCBuLCBzKSB7XG4gICAgICAgIEwobiA8IHMgJiYgbiA+PSAwICYmIHMgPD0gMTEpO1xuICAgICAgICBjb25zdCBpID0gbmV3IGpzKFwiY3JlYXRlT3JVcGdyYWRlXCIsIGUpO1xuICAgICAgICBuIDwgMSAmJiBzID49IDEgJiYgKGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIHQuY3JlYXRlT2JqZWN0U3RvcmUoUHMuc3RvcmUpO1xuICAgICAgICB9KHQpLCBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICB0LmNyZWF0ZU9iamVjdFN0b3JlKGJzLnN0b3JlLCB7XG4gICAgICAgICAgICAgICAga2V5UGF0aDogYnMua2V5UGF0aFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0LmNyZWF0ZU9iamVjdFN0b3JlKHZzLnN0b3JlLCB7XG4gICAgICAgICAgICAgICAga2V5UGF0aDogdnMua2V5UGF0aCxcbiAgICAgICAgICAgICAgICBhdXRvSW5jcmVtZW50OiAhMFxuICAgICAgICAgICAgfSkuY3JlYXRlSW5kZXgodnMudXNlck11dGF0aW9uc0luZGV4LCB2cy51c2VyTXV0YXRpb25zS2V5UGF0aCwge1xuICAgICAgICAgICAgICAgIHVuaXF1ZTogITBcbiAgICAgICAgICAgIH0pLCB0LmNyZWF0ZU9iamVjdFN0b3JlKFZzLnN0b3JlKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAqIFVwZ3JhZGUgZnVuY3Rpb24gdG8gbWlncmF0ZSB0aGUgJ211dGF0aW9ucycgc3RvcmUgZnJvbSBWMSB0byBWMy4gTG9hZHNcbiAqIGFuZCByZXdyaXRlcyBhbGwgZGF0YS5cbiAqLyAodCksIFlpKHQpLCBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICB0LmNyZWF0ZU9iamVjdFN0b3JlKENzLnN0b3JlKTtcbiAgICAgICAgfSh0KSk7XG4gICAgICAgIC8vIE1pZ3JhdGlvbiAyIHRvIHBvcHVsYXRlIHRoZSB0YXJnZXRHbG9iYWwgb2JqZWN0IG5vIGxvbmdlciBuZWVkZWQgc2luY2VcbiAgICAgICAgLy8gbWlncmF0aW9uIDMgdW5jb25kaXRpb25hbGx5IGNsZWFycyBpdC5cbiAgICAgICAgICAgICAgICBsZXQgciA9IEtzLnJlc29sdmUoKTtcbiAgICAgICAgcmV0dXJuIG4gPCAzICYmIHMgPj0gMyAmJiAoXG4gICAgICAgIC8vIEJyYW5kIG5ldyBjbGllbnRzIGRvbid0IG5lZWQgdG8gZHJvcCBhbmQgcmVjcmVhdGUtLW9ubHkgY2xpZW50cyB0aGF0XG4gICAgICAgIC8vIHBvdGVudGlhbGx5IGhhdmUgY29ycnVwdCBkYXRhLlxuICAgICAgICAwICE9PSBuICYmICghZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgdC5kZWxldGVPYmplY3RTdG9yZShrcy5zdG9yZSksIHQuZGVsZXRlT2JqZWN0U3RvcmUoeHMuc3RvcmUpLCB0LmRlbGV0ZU9iamVjdFN0b3JlKCRzLnN0b3JlKTtcbiAgICAgICAgfSh0KSwgWWkodCkpLCByID0gci5uZXh0KCgoKSA9PiBcbiAgICAgICAgLyoqXG4gKiBDcmVhdGVzIHRoZSB0YXJnZXQgZ2xvYmFsIHNpbmdsZXRvbiByb3cuXG4gKlxuICogQHBhcmFtIHR4biAtIFRoZSB2ZXJzaW9uIHVwZ3JhZGUgdHJhbnNhY3Rpb24gZm9yIGluZGV4ZWRkYlxuICovXG4gICAgICAgIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0LnN0b3JlKCRzLnN0b3JlKSwgbiA9IG5ldyAkcyhcbiAgICAgICAgICAgIC8qaGlnaGVzdFRhcmdldElkPSovIDAsIFxuICAgICAgICAgICAgLypsYXN0TGlzdGVuU2VxdWVuY2VOdW1iZXI9Ki8gMCwgaXQubWluKCkudG9UaW1lc3RhbXAoKSwgXG4gICAgICAgICAgICAvKnRhcmdldENvdW50PSovIDApO1xuICAgICAgICAgICAgcmV0dXJuIGUucHV0KCRzLmtleSwgbik7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gKiBDcmVhdGVzIGluZGljZXMgb24gdGhlIFJlbW90ZURvY3VtZW50cyBzdG9yZSB1c2VkIGZvciBib3RoIG11bHRpLXRhYlxuICogYW5kIEluZGV4LUZyZWUgcXVlcmllcy5cbiAqLyAoaSkpKSksIG4gPCA0ICYmIHMgPj0gNCAmJiAoMCAhPT0gbiAmJiAoXG4gICAgICAgIC8vIFNjaGVtYSB2ZXJzaW9uIDMgdXNlcyBhdXRvLWdlbmVyYXRlZCBrZXlzIHRvIGdlbmVyYXRlIGdsb2JhbGx5IHVuaXF1ZVxuICAgICAgICAvLyBtdXRhdGlvbiBiYXRjaCBJRHMgKHRoaXMgd2FzIHByZXZpb3VzbHkgZW5zdXJlZCBpbnRlcm5hbGx5IGJ5IHRoZVxuICAgICAgICAvLyBjbGllbnQpLiBUbyBtaWdyYXRlIHRvIHRoZSBuZXcgc2NoZW1hLCB3ZSBoYXZlIHRvIHJlYWQgYWxsIG11dGF0aW9uc1xuICAgICAgICAvLyBhbmQgd3JpdGUgdGhlbSBiYWNrIG91dC4gV2UgcHJlc2VydmUgdGhlIGV4aXN0aW5nIGJhdGNoIElEcyB0byBndWFyYW50ZWVcbiAgICAgICAgLy8gY29uc2lzdGVuY3kgd2l0aCBvdGhlciBvYmplY3Qgc3RvcmVzLiBBbnkgZnVydGhlciBtdXRhdGlvbiBiYXRjaCBJRHMgd2lsbFxuICAgICAgICAvLyBiZSBhdXRvLWdlbmVyYXRlZC5cbiAgICAgICAgciA9IHIubmV4dCgoKCkgPT4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgcmV0dXJuIGUuc3RvcmUodnMuc3RvcmUpLkx0KCkubmV4dCgobiA9PiB7XG4gICAgICAgICAgICAgICAgdC5kZWxldGVPYmplY3RTdG9yZSh2cy5zdG9yZSk7XG4gICAgICAgICAgICAgICAgdC5jcmVhdGVPYmplY3RTdG9yZSh2cy5zdG9yZSwge1xuICAgICAgICAgICAgICAgICAgICBrZXlQYXRoOiB2cy5rZXlQYXRoLFxuICAgICAgICAgICAgICAgICAgICBhdXRvSW5jcmVtZW50OiAhMFxuICAgICAgICAgICAgICAgIH0pLmNyZWF0ZUluZGV4KHZzLnVzZXJNdXRhdGlvbnNJbmRleCwgdnMudXNlck11dGF0aW9uc0tleVBhdGgsIHtcbiAgICAgICAgICAgICAgICAgICAgdW5pcXVlOiAhMFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBlLnN0b3JlKHZzLnN0b3JlKSwgaSA9IG4ubWFwKCh0ID0+IHMucHV0KHQpKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEtzLndhaXRGb3IoaSk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH0odCwgaSkpKSksIHIgPSByLm5leHQoKCgpID0+IHtcbiAgICAgICAgICAgICFmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgdC5jcmVhdGVPYmplY3RTdG9yZShGcy5zdG9yZSwge1xuICAgICAgICAgICAgICAgICAgICBrZXlQYXRoOiBGcy5rZXlQYXRoXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KHQpO1xuICAgICAgICB9KSkpLCBuIDwgNSAmJiBzID49IDUgJiYgKHIgPSByLm5leHQoKCgpID0+IHRoaXMuQ2UoaSkpKSksIG4gPCA2ICYmIHMgPj0gNiAmJiAociA9IHIubmV4dCgoKCkgPT4gKGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIHQuY3JlYXRlT2JqZWN0U3RvcmUoTnMuc3RvcmUpO1xuICAgICAgICB9KHQpLCB0aGlzLk5lKGkpKSkpKSwgbiA8IDcgJiYgcyA+PSA3ICYmIChyID0gci5uZXh0KCgoKSA9PiB0aGlzLnhlKGkpKSkpLCBuIDwgOCAmJiBzID49IDggJiYgKHIgPSByLm5leHQoKCgpID0+IHRoaXMua2UodCwgaSkpKSksIFxuICAgICAgICBuIDwgOSAmJiBzID49IDkgJiYgKHIgPSByLm5leHQoKCgpID0+IHtcbiAgICAgICAgICAgIC8vIE11bHRpLVRhYiB1c2VkIHRvIG1hbmFnZSBpdHMgb3duIGNoYW5nZWxvZywgYnV0IHRoaXMgaGFzIGJlZW4gbW92ZWRcbiAgICAgICAgICAgIC8vIHRvIHRoZSBEYlJlbW90ZURvY3VtZW50IG9iamVjdCBzdG9yZSBpdHNlbGYuIFNpbmNlIHRoZSBwcmV2aW91cyBjaGFuZ2VcbiAgICAgICAgICAgIC8vIGxvZyBvbmx5IGNvbnRhaW5lZCB0cmFuc2llbnQgZGF0YSwgd2UgY2FuIGRyb3AgaXRzIG9iamVjdCBzdG9yZS5cbiAgICAgICAgICAgICFmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgdC5vYmplY3RTdG9yZU5hbWVzLmNvbnRhaW5zKFwicmVtb3RlRG9jdW1lbnRDaGFuZ2VzXCIpICYmIHQuZGVsZXRlT2JqZWN0U3RvcmUoXCJyZW1vdGVEb2N1bWVudENoYW5nZXNcIik7XG4gICAgICAgICAgICB9KHQpLCBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQub2JqZWN0U3RvcmUoQ3Muc3RvcmUpO1xuICAgICAgICAgICAgICAgIGUuY3JlYXRlSW5kZXgoQ3MucmVhZFRpbWVJbmRleCwgQ3MucmVhZFRpbWVJbmRleFBhdGgsIHtcbiAgICAgICAgICAgICAgICAgICAgdW5pcXVlOiAhMVxuICAgICAgICAgICAgICAgIH0pLCBlLmNyZWF0ZUluZGV4KENzLmNvbGxlY3Rpb25SZWFkVGltZUluZGV4LCBDcy5jb2xsZWN0aW9uUmVhZFRpbWVJbmRleFBhdGgsIHtcbiAgICAgICAgICAgICAgICAgICAgdW5pcXVlOiAhMVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfShlKTtcbiAgICAgICAgfSkpKSwgbiA8IDEwICYmIHMgPj0gMTAgJiYgKHIgPSByLm5leHQoKCgpID0+IHRoaXMuJGUoaSkpKSksIG4gPCAxMSAmJiBzID49IDExICYmIChyID0gci5uZXh0KCgoKSA9PiB7XG4gICAgICAgICAgICAhZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgICAgIHQuY3JlYXRlT2JqZWN0U3RvcmUoTXMuc3RvcmUsIHtcbiAgICAgICAgICAgICAgICAgICAga2V5UGF0aDogTXMua2V5UGF0aFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSh0KSwgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgICAgIHQuY3JlYXRlT2JqZWN0U3RvcmUoTHMuc3RvcmUsIHtcbiAgICAgICAgICAgICAgICAgICAga2V5UGF0aDogTHMua2V5UGF0aFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gKHQpO1xuICAgICAgICB9KSkpLCByO1xuICAgIH1cbiAgICBOZSh0KSB7XG4gICAgICAgIGxldCBlID0gMDtcbiAgICAgICAgcmV0dXJuIHQuc3RvcmUoQ3Muc3RvcmUpLkt0KCgodCwgbikgPT4ge1xuICAgICAgICAgICAgZSArPSBQaShuKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBuZXcgTnMoZSk7XG4gICAgICAgICAgICByZXR1cm4gdC5zdG9yZShOcy5zdG9yZSkucHV0KE5zLmtleSwgbik7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgQ2UodCkge1xuICAgICAgICBjb25zdCBlID0gdC5zdG9yZShicy5zdG9yZSksIG4gPSB0LnN0b3JlKHZzLnN0b3JlKTtcbiAgICAgICAgcmV0dXJuIGUuTHQoKS5uZXh0KChlID0+IEtzLmZvckVhY2goZSwgKGUgPT4ge1xuICAgICAgICAgICAgY29uc3QgcyA9IElEQktleVJhbmdlLmJvdW5kKFsgZS51c2VySWQsIC0xIF0sIFsgZS51c2VySWQsIGUubGFzdEFja25vd2xlZGdlZEJhdGNoSWQgXSk7XG4gICAgICAgICAgICByZXR1cm4gbi5MdCh2cy51c2VyTXV0YXRpb25zSW5kZXgsIHMpLm5leHQoKG4gPT4gS3MuZm9yRWFjaChuLCAobiA9PiB7XG4gICAgICAgICAgICAgICAgTChuLnVzZXJJZCA9PT0gZS51c2VySWQpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBsaSh0aGlzLk4sIG4pO1xuICAgICAgICAgICAgICAgIHJldHVybiBSaSh0LCBlLnVzZXJJZCwgcykubmV4dCgoKCkgPT4ge30pKTtcbiAgICAgICAgICAgIH0pKSkpO1xuICAgICAgICB9KSkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRW5zdXJlcyB0aGF0IGV2ZXJ5IGRvY3VtZW50IGluIHRoZSByZW1vdGUgZG9jdW1lbnQgY2FjaGUgaGFzIGEgY29ycmVzcG9uZGluZyBzZW50aW5lbCByb3dcbiAgICAgKiB3aXRoIGEgc2VxdWVuY2UgbnVtYmVyLiBNaXNzaW5nIHJvd3MgYXJlIGdpdmVuIHRoZSBtb3N0IHJlY2VudGx5IHVzZWQgc2VxdWVuY2UgbnVtYmVyLlxuICAgICAqLyAgICB4ZSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0LnN0b3JlKGtzLnN0b3JlKSwgbiA9IHQuc3RvcmUoQ3Muc3RvcmUpO1xuICAgICAgICByZXR1cm4gdC5zdG9yZSgkcy5zdG9yZSkuZ2V0KCRzLmtleSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICBjb25zdCBzID0gW107XG4gICAgICAgICAgICByZXR1cm4gbi5LdCgoKG4sIGkpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCByID0gbmV3IHV0KG4pLCBvID0gZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWyAwLCBFcyh0KSBdO1xuICAgICAgICAgICAgICAgIH0ocik7XG4gICAgICAgICAgICAgICAgcy5wdXNoKGUuZ2V0KG8pLm5leHQoKG4gPT4gbiA/IEtzLnJlc29sdmUoKSA6IChuID0+IGUucHV0KG5ldyBrcygwLCBFcyhuKSwgdC5oaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIpKSkocikpKSk7XG4gICAgICAgICAgICB9KSkubmV4dCgoKCkgPT4gS3Mud2FpdEZvcihzKSkpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGtlKHQsIGUpIHtcbiAgICAgICAgLy8gQ3JlYXRlIHRoZSBpbmRleC5cbiAgICAgICAgdC5jcmVhdGVPYmplY3RTdG9yZShPcy5zdG9yZSwge1xuICAgICAgICAgICAga2V5UGF0aDogT3Mua2V5UGF0aFxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgbiA9IGUuc3RvcmUoT3Muc3RvcmUpLCBzID0gbmV3IHBpLCBpID0gdCA9PiB7XG4gICAgICAgICAgICBpZiAocy5hZGQodCkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5sYXN0U2VnbWVudCgpLCBzID0gdC5wb3BMYXN0KCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG4ucHV0KHtcbiAgICAgICAgICAgICAgICAgICAgY29sbGVjdGlvbklkOiBlLFxuICAgICAgICAgICAgICAgICAgICBwYXJlbnQ6IEVzKHMpXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIC8vIEhlbHBlciB0byBhZGQgYW4gaW5kZXggZW50cnkgaWZmIHdlIGhhdmVuJ3QgYWxyZWFkeSB3cml0dGVuIGl0LlxuICAgICAgICAgICAgICAgIC8vIEluZGV4IGV4aXN0aW5nIHJlbW90ZSBkb2N1bWVudHMuXG4gICAgICAgIHJldHVybiBlLnN0b3JlKENzLnN0b3JlKS5LdCh7XG4gICAgICAgICAgICBxdDogITBcbiAgICAgICAgfSwgKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuID0gbmV3IHV0KHQpO1xuICAgICAgICAgICAgcmV0dXJuIGkobi5wb3BMYXN0KCkpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gZS5zdG9yZShWcy5zdG9yZSkuS3Qoe1xuICAgICAgICAgICAgcXQ6ICEwXG4gICAgICAgIH0sICgoW3QsIGUsIG5dLCBzKSA9PiB7XG4gICAgICAgICAgICBjb25zdCByID0gQXMoZSk7XG4gICAgICAgICAgICByZXR1cm4gaShyLnBvcExhc3QoKSk7XG4gICAgICAgIH0pKSkpO1xuICAgIH1cbiAgICAkZSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0LnN0b3JlKHhzLnN0b3JlKTtcbiAgICAgICAgcmV0dXJuIGUuS3QoKCh0LCBuKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzID0gZmkobiksIGkgPSBkaSh0aGlzLk4sIHMpO1xuICAgICAgICAgICAgcmV0dXJuIGUucHV0KGkpO1xuICAgICAgICB9KSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBZaSh0KSB7XG4gICAgdC5jcmVhdGVPYmplY3RTdG9yZShrcy5zdG9yZSwge1xuICAgICAgICBrZXlQYXRoOiBrcy5rZXlQYXRoXG4gICAgfSkuY3JlYXRlSW5kZXgoa3MuZG9jdW1lbnRUYXJnZXRzSW5kZXgsIGtzLmRvY3VtZW50VGFyZ2V0c0tleVBhdGgsIHtcbiAgICAgICAgdW5pcXVlOiAhMFxuICAgIH0pO1xuICAgIC8vIE5PVEU6IFRoaXMgaXMgdW5pcXVlIG9ubHkgYmVjYXVzZSB0aGUgVGFyZ2V0SWQgaXMgdGhlIHN1ZmZpeC5cbiAgICB0LmNyZWF0ZU9iamVjdFN0b3JlKHhzLnN0b3JlLCB7XG4gICAgICAgIGtleVBhdGg6IHhzLmtleVBhdGhcbiAgICB9KS5jcmVhdGVJbmRleCh4cy5xdWVyeVRhcmdldHNJbmRleE5hbWUsIHhzLnF1ZXJ5VGFyZ2V0c0tleVBhdGgsIHtcbiAgICAgICAgdW5pcXVlOiAhMFxuICAgIH0pLCB0LmNyZWF0ZU9iamVjdFN0b3JlKCRzLnN0b3JlKTtcbn1cblxuY29uc3QgWGkgPSBcIkZhaWxlZCB0byBvYnRhaW4gZXhjbHVzaXZlIGFjY2VzcyB0byB0aGUgcGVyc2lzdGVuY2UgbGF5ZXIuIFRvIGFsbG93IHNoYXJlZCBhY2Nlc3MsIG11bHRpLXRhYiBzeW5jaHJvbml6YXRpb24gaGFzIHRvIGJlIGVuYWJsZWQgaW4gYWxsIHRhYnMuIElmIHlvdSBhcmUgdXNpbmcgYGV4cGVyaW1lbnRhbEZvcmNlT3duaW5nVGFiOnRydWVgLCBtYWtlIHN1cmUgdGhhdCBvbmx5IG9uZSB0YWIgaGFzIHBlcnNpc3RlbmNlIGVuYWJsZWQgYXQgYW55IGdpdmVuIHRpbWUuXCI7XG5cbi8qKlxuICogT2xkZXN0IGFjY2VwdGFibGUgYWdlIGluIG1pbGxpc2Vjb25kcyBmb3IgY2xpZW50IG1ldGFkYXRhIGJlZm9yZSB0aGUgY2xpZW50XG4gKiBpcyBjb25zaWRlcmVkIGluYWN0aXZlIGFuZCBpdHMgYXNzb2NpYXRlZCBkYXRhIGlzIGdhcmJhZ2UgY29sbGVjdGVkLlxuICovXG4vKipcbiAqIEFuIEluZGV4ZWREQi1iYWNrZWQgaW5zdGFuY2Ugb2YgUGVyc2lzdGVuY2UuIERhdGEgaXMgc3RvcmVkIHBlcnNpc3RlbnRseVxuICogYWNyb3NzIHNlc3Npb25zLlxuICpcbiAqIE9uIFdlYiBvbmx5LCB0aGUgRmlyZXN0b3JlIFNES3Mgc3VwcG9ydCBzaGFyZWQgYWNjZXNzIHRvIGl0cyBwZXJzaXN0ZW5jZVxuICogbGF5ZXIuIFRoaXMgYWxsb3dzIG11bHRpcGxlIGJyb3dzZXIgdGFicyB0byByZWFkIGFuZCB3cml0ZSB0byBJbmRleGVkRGIgYW5kXG4gKiB0byBzeW5jaHJvbml6ZSBzdGF0ZSBldmVuIHdpdGhvdXQgbmV0d29yayBjb25uZWN0aXZpdHkuIFNoYXJlZCBhY2Nlc3MgaXNcbiAqIGN1cnJlbnRseSBvcHRpb25hbCBhbmQgbm90IGVuYWJsZWQgdW5sZXNzIGFsbCBjbGllbnRzIGludm9rZVxuICogYGVuYWJsZVBlcnNpc3RlbmNlKClgIHdpdGggYHtzeW5jaHJvbml6ZVRhYnM6dHJ1ZX1gLlxuICpcbiAqIEluIG11bHRpLXRhYiBtb2RlLCBpZiBtdWx0aXBsZSBjbGllbnRzIGFyZSBhY3RpdmUgYXQgdGhlIHNhbWUgdGltZSwgdGhlIFNES1xuICogd2lsbCBkZXNpZ25hdGUgb25lIGNsaWVudCBhcyB0aGUg4oCccHJpbWFyeSBjbGllbnTigJ0uIEFuIGVmZm9ydCBpcyBtYWRlIHRvIHBpY2tcbiAqIGEgdmlzaWJsZSwgbmV0d29yay1jb25uZWN0ZWQgYW5kIGFjdGl2ZSBjbGllbnQsIGFuZCB0aGlzIGNsaWVudCBpc1xuICogcmVzcG9uc2libGUgZm9yIGxldHRpbmcgb3RoZXIgY2xpZW50cyBrbm93IGFib3V0IGl0cyBwcmVzZW5jZS4gVGhlIHByaW1hcnlcbiAqIGNsaWVudCB3cml0ZXMgYSB1bmlxdWUgY2xpZW50LWdlbmVyYXRlZCBpZGVudGlmaWVyICh0aGUgY2xpZW50IElEKSB0b1xuICogSW5kZXhlZERi4oCZcyDigJxvd25lcuKAnSBzdG9yZSBldmVyeSA0IHNlY29uZHMuIElmIHRoZSBwcmltYXJ5IGNsaWVudCBmYWlscyB0b1xuICogdXBkYXRlIHRoaXMgZW50cnksIGFub3RoZXIgY2xpZW50IGNhbiBhY3F1aXJlIHRoZSBsZWFzZSBhbmQgdGFrZSBvdmVyIGFzXG4gKiBwcmltYXJ5LlxuICpcbiAqIFNvbWUgcGVyc2lzdGVuY2Ugb3BlcmF0aW9ucyBpbiB0aGUgU0RLIGFyZSBkZXNpZ25hdGVkIGFzIHByaW1hcnktY2xpZW50IG9ubHlcbiAqIG9wZXJhdGlvbnMuIFRoaXMgaW5jbHVkZXMgdGhlIGFja25vd2xlZGdtZW50IG9mIG11dGF0aW9ucyBhbmQgYWxsIHVwZGF0ZXMgb2ZcbiAqIHJlbW90ZSBkb2N1bWVudHMuIFRoZSBlZmZlY3RzIG9mIHRoZXNlIG9wZXJhdGlvbnMgYXJlIHdyaXR0ZW4gdG8gcGVyc2lzdGVuY2VcbiAqIGFuZCB0aGVuIGJyb2FkY2FzdCB0byBvdGhlciB0YWJzIHZpYSBMb2NhbFN0b3JhZ2UgKHNlZVxuICogYFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZWApLCB3aGljaCB0aGVuIHJlZnJlc2ggdGhlaXIgc3RhdGUgZnJvbVxuICogcGVyc2lzdGVuY2UuXG4gKlxuICogU2ltaWxhcmx5LCB0aGUgcHJpbWFyeSBjbGllbnQgbGlzdGVucyB0byBub3RpZmljYXRpb25zIHNlbnQgYnkgc2Vjb25kYXJ5XG4gKiBjbGllbnRzIHRvIGRpc2NvdmVyIHBlcnNpc3RlbmNlIGNoYW5nZXMgd3JpdHRlbiBieSBzZWNvbmRhcnkgY2xpZW50cywgc3VjaCBhc1xuICogdGhlIGFkZGl0aW9uIG9mIG5ldyBtdXRhdGlvbnMgYW5kIHF1ZXJ5IHRhcmdldHMuXG4gKlxuICogSWYgbXVsdGktdGFiIGlzIG5vdCBlbmFibGVkIGFuZCBhbm90aGVyIHRhYiBhbHJlYWR5IG9idGFpbmVkIHRoZSBwcmltYXJ5XG4gKiBsZWFzZSwgSW5kZXhlZERiUGVyc2lzdGVuY2UgZW50ZXJzIGEgZmFpbGVkIHN0YXRlIGFuZCBhbGwgc3Vic2VxdWVudFxuICogb3BlcmF0aW9ucyB3aWxsIGF1dG9tYXRpY2FsbHkgZmFpbC5cbiAqXG4gKiBBZGRpdGlvbmFsbHksIHRoZXJlIGlzIGFuIG9wdGltaXphdGlvbiBzbyB0aGF0IHdoZW4gYSB0YWIgaXMgY2xvc2VkLCB0aGVcbiAqIHByaW1hcnkgbGVhc2UgaXMgcmVsZWFzZWQgaW1tZWRpYXRlbHkgKHRoaXMgaXMgZXNwZWNpYWxseSBpbXBvcnRhbnQgdG8gbWFrZVxuICogc3VyZSB0aGF0IGEgcmVmcmVzaGVkIHRhYiBpcyBhYmxlIHRvIGltbWVkaWF0ZWx5IHJlLWFjcXVpcmUgdGhlIHByaW1hcnlcbiAqIGxlYXNlKS4gVW5mb3J0dW5hdGVseSwgSW5kZXhlZERCIGNhbm5vdCBiZSByZWxpYWJseSB1c2VkIGluIHdpbmRvdy51bmxvYWRcbiAqIHNpbmNlIGl0IGlzIGFuIGFzeW5jaHJvbm91cyBBUEkuIFNvIGluIGFkZGl0aW9uIHRvIGF0dGVtcHRpbmcgdG8gZ2l2ZSB1cCB0aGVcbiAqIGxlYXNlLCB0aGUgbGVhc2Vob2xkZXIgd3JpdGVzIGl0cyBjbGllbnQgSUQgdG8gYSBcInpvbWJpZWRDbGllbnRcIiBlbnRyeSBpblxuICogTG9jYWxTdG9yYWdlIHdoaWNoIGFjdHMgYXMgYW4gaW5kaWNhdG9yIHRoYXQgYW5vdGhlciB0YWIgc2hvdWxkIGdvIGFoZWFkIGFuZFxuICogdGFrZSB0aGUgcHJpbWFyeSBsZWFzZSBpbW1lZGlhdGVseSByZWdhcmRsZXNzIG9mIHRoZSBjdXJyZW50IGxlYXNlIHRpbWVzdGFtcC5cbiAqXG4gKiBUT0RPKGIvMTE0MjI2MjM0KTogUmVtb3ZlIGBzeW5jaHJvbml6ZVRhYnNgIHNlY3Rpb24gd2hlbiBtdWx0aS10YWIgaXMgbm9cbiAqIGxvbmdlciBvcHRpb25hbC5cbiAqL1xuY2xhc3MgWmkge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIFdoZXRoZXIgdG8gc3luY2hyb25pemUgdGhlIGluLW1lbW9yeSBzdGF0ZSBvZiBtdWx0aXBsZSB0YWJzIGFuZCBzaGFyZVxuICAgICAqIGFjY2VzcyB0byBsb2NhbCBwZXJzaXN0ZW5jZS5cbiAgICAgKi9cbiAgICB0LCBlLCBuLCBzLCBpLCByLCBvLCBhLCBjLCBcbiAgICAvKipcbiAgICAgKiBJZiBzZXQgdG8gdHJ1ZSwgZm9yY2VmdWxseSBvYnRhaW5zIGRhdGFiYXNlIGFjY2Vzcy4gRXhpc3RpbmcgdGFicyB3aWxsXG4gICAgICogbm8gbG9uZ2VyIGJlIGFibGUgdG8gYWNjZXNzIEluZGV4ZWREQi5cbiAgICAgKi9cbiAgICB1KSB7XG4gICAgICAgIGlmICh0aGlzLmFsbG93VGFiU3luY2hyb25pemF0aW9uID0gdCwgdGhpcy5wZXJzaXN0ZW5jZUtleSA9IGUsIHRoaXMuY2xpZW50SWQgPSBuLCBcbiAgICAgICAgdGhpcy5PZSA9IGksIHRoaXMud2luZG93ID0gciwgdGhpcy5kb2N1bWVudCA9IG8sIHRoaXMuRmUgPSBjLCB0aGlzLk1lID0gdSwgdGhpcy5MZSA9IG51bGwsIFxuICAgICAgICB0aGlzLkJlID0gITEsIHRoaXMuaXNQcmltYXJ5ID0gITEsIHRoaXMubmV0d29ya0VuYWJsZWQgPSAhMCwgXG4gICAgICAgIC8qKiBPdXIgd2luZG93LnVubG9hZCBoYW5kbGVyLCBpZiByZWdpc3RlcmVkLiAqL1xuICAgICAgICB0aGlzLlVlID0gbnVsbCwgdGhpcy5pbkZvcmVncm91bmQgPSAhMSwgXG4gICAgICAgIC8qKiBPdXIgJ3Zpc2liaWxpdHljaGFuZ2UnIGxpc3RlbmVyIGlmIHJlZ2lzdGVyZWQuICovXG4gICAgICAgIHRoaXMucWUgPSBudWxsLCBcbiAgICAgICAgLyoqIFRoZSBjbGllbnQgbWV0YWRhdGEgcmVmcmVzaCB0YXNrLiAqL1xuICAgICAgICB0aGlzLktlID0gbnVsbCwgXG4gICAgICAgIC8qKiBUaGUgbGFzdCB0aW1lIHdlIGdhcmJhZ2UgY29sbGVjdGVkIHRoZSBjbGllbnQgbWV0YWRhdGEgb2JqZWN0IHN0b3JlLiAqL1xuICAgICAgICB0aGlzLmplID0gTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZLCBcbiAgICAgICAgLyoqIEEgbGlzdGVuZXIgdG8gbm90aWZ5IG9uIHByaW1hcnkgc3RhdGUgY2hhbmdlcy4gKi9cbiAgICAgICAgdGhpcy5RZSA9IHQgPT4gUHJvbWlzZS5yZXNvbHZlKCksICFaaS5QdCgpKSB0aHJvdyBuZXcgSyhxLlVOSU1QTEVNRU5URUQsIFwiVGhpcyBwbGF0Zm9ybSBpcyBlaXRoZXIgbWlzc2luZyBJbmRleGVkREIgb3IgaXMga25vd24gdG8gaGF2ZSBhbiBpbmNvbXBsZXRlIGltcGxlbWVudGF0aW9uLiBPZmZsaW5lIHBlcnNpc3RlbmNlIGhhcyBiZWVuIGRpc2FibGVkLlwiKTtcbiAgICAgICAgdGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZSA9IG5ldyBVaSh0aGlzLCBzKSwgdGhpcy5XZSA9IGUgKyBcIm1haW5cIiwgdGhpcy5OID0gbmV3IGlpKGEpLCBcbiAgICAgICAgdGhpcy5HZSA9IG5ldyBRcyh0aGlzLldlLCAxMSwgbmV3IEppKHRoaXMuTikpLCB0aGlzLnplID0gbmV3IE5pKHRoaXMucmVmZXJlbmNlRGVsZWdhdGUsIHRoaXMuTiksIFxuICAgICAgICB0aGlzLkh0ID0gbmV3IEVpLCB0aGlzLkhlID0gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBRaSh0LCBlKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAqIFJldHVybnMgdGhlIHNldCBvZiBkb2N1bWVudHMgdGhhdCBoYXZlIGNoYW5nZWQgc2luY2UgdGhlIHNwZWNpZmllZCByZWFkXG4gKiB0aW1lLlxuICovXG4gICAgICAgIC8vIFBPUlRJTkcgTk9URTogVGhpcyBpcyBvbmx5IHVzZWQgZm9yIG11bHRpLXRhYiBzeW5jaHJvbml6YXRpb24uXG4gICAgICAgICh0aGlzLk4sIHRoaXMuSHQpLCB0aGlzLkplID0gbmV3IF9pLCB0aGlzLndpbmRvdyAmJiB0aGlzLndpbmRvdy5sb2NhbFN0b3JhZ2UgPyB0aGlzLlllID0gdGhpcy53aW5kb3cubG9jYWxTdG9yYWdlIDogKHRoaXMuWWUgPSBudWxsLCBcbiAgICAgICAgITEgPT09IHUgJiYgJChcIkluZGV4ZWREYlBlcnNpc3RlbmNlXCIsIFwiTG9jYWxTdG9yYWdlIGlzIHVuYXZhaWxhYmxlLiBBcyBhIHJlc3VsdCwgcGVyc2lzdGVuY2UgbWF5IG5vdCB3b3JrIHJlbGlhYmx5LiBJbiBwYXJ0aWN1bGFyIGVuYWJsZVBlcnNpc3RlbmNlKCkgY291bGQgZmFpbCBpbW1lZGlhdGVseSBhZnRlciByZWZyZXNoaW5nIHRoZSBwYWdlLlwiKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEF0dGVtcHQgdG8gc3RhcnQgSW5kZXhlZERiIHBlcnNpc3RlbmNlLlxuICAgICAqXG4gICAgICogQHJldHVybnMgV2hldGhlciBwZXJzaXN0ZW5jZSB3YXMgZW5hYmxlZC5cbiAgICAgKi8gICAgc3RhcnQoKSB7XG4gICAgICAgIC8vIE5PVEU6IFRoaXMgaXMgZXhwZWN0ZWQgdG8gZmFpbCBzb21ldGltZXMgKGluIHRoZSBjYXNlIG9mIGFub3RoZXIgdGFiXG4gICAgICAgIC8vIGFscmVhZHkgaGF2aW5nIHRoZSBwZXJzaXN0ZW5jZSBsb2NrKSwgc28gaXQncyB0aGUgZmlyc3QgdGhpbmcgd2Ugc2hvdWxkXG4gICAgICAgIC8vIGRvLlxuICAgICAgICByZXR1cm4gdGhpcy5YZSgpLnRoZW4oKCgpID0+IHtcbiAgICAgICAgICAgIGlmICghdGhpcy5pc1ByaW1hcnkgJiYgIXRoaXMuYWxsb3dUYWJTeW5jaHJvbml6YXRpb24pIFxuICAgICAgICAgICAgLy8gRmFpbCBgc3RhcnQoKWAgaWYgYHN5bmNocm9uaXplVGFic2AgaXMgZGlzYWJsZWQgYW5kIHdlIGNhbm5vdFxuICAgICAgICAgICAgLy8gb2J0YWluIHRoZSBwcmltYXJ5IGxlYXNlLlxuICAgICAgICAgICAgdGhyb3cgbmV3IEsocS5GQUlMRURfUFJFQ09ORElUSU9OLCBYaSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5aZSgpLCB0aGlzLnRuKCksIHRoaXMuZW4oKSwgdGhpcy5ydW5UcmFuc2FjdGlvbihcImdldEhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlclwiLCBcInJlYWRvbmx5XCIsICh0ID0+IHRoaXMuemUuZ2V0SGlnaGVzdFNlcXVlbmNlTnVtYmVyKHQpKSk7XG4gICAgICAgIH0pKS50aGVuKCh0ID0+IHtcbiAgICAgICAgICAgIHRoaXMuTGUgPSBuZXcgWSh0LCB0aGlzLkZlKTtcbiAgICAgICAgfSkpLnRoZW4oKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuQmUgPSAhMDtcbiAgICAgICAgfSkpLmNhdGNoKCh0ID0+ICh0aGlzLkdlICYmIHRoaXMuR2UuY2xvc2UoKSwgUHJvbWlzZS5yZWplY3QodCkpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlZ2lzdGVycyBhIGxpc3RlbmVyIHRoYXQgZ2V0cyBjYWxsZWQgd2hlbiB0aGUgcHJpbWFyeSBzdGF0ZSBvZiB0aGVcbiAgICAgKiBpbnN0YW5jZSBjaGFuZ2VzLiBVcG9uIHJlZ2lzdGVyaW5nLCB0aGlzIGxpc3RlbmVyIGlzIGludm9rZWQgaW1tZWRpYXRlbHlcbiAgICAgKiB3aXRoIHRoZSBjdXJyZW50IHByaW1hcnkgc3RhdGUuXG4gICAgICpcbiAgICAgKiBQT1JUSU5HIE5PVEU6IFRoaXMgaXMgb25seSB1c2VkIGZvciBXZWIgbXVsdGktdGFiLlxuICAgICAqLyAgICBubih0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLlFlID0gYXN5bmMgZSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5zdGFydGVkKSByZXR1cm4gdChlKTtcbiAgICAgICAgfSwgdCh0aGlzLmlzUHJpbWFyeSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlZ2lzdGVycyBhIGxpc3RlbmVyIHRoYXQgZ2V0cyBjYWxsZWQgd2hlbiB0aGUgZGF0YWJhc2UgcmVjZWl2ZXMgYVxuICAgICAqIHZlcnNpb24gY2hhbmdlIGV2ZW50IGluZGljYXRpbmcgdGhhdCBpdCBoYXMgZGVsZXRlZC5cbiAgICAgKlxuICAgICAqIFBPUlRJTkcgTk9URTogVGhpcyBpcyBvbmx5IHVzZWQgZm9yIFdlYiBtdWx0aS10YWIuXG4gICAgICovICAgIHNldERhdGFiYXNlRGVsZXRlZExpc3RlbmVyKHQpIHtcbiAgICAgICAgdGhpcy5HZS54dCgoYXN5bmMgZSA9PiB7XG4gICAgICAgICAgICAvLyBDaGVjayBpZiBhbiBhdHRlbXB0IGlzIG1hZGUgdG8gZGVsZXRlIEluZGV4ZWREQi5cbiAgICAgICAgICAgIG51bGwgPT09IGUubmV3VmVyc2lvbiAmJiBhd2FpdCB0KCk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRqdXN0cyB0aGUgY3VycmVudCBuZXR3b3JrIHN0YXRlIGluIHRoZSBjbGllbnQncyBtZXRhZGF0YSwgcG90ZW50aWFsbHlcbiAgICAgKiBhZmZlY3RpbmcgdGhlIHByaW1hcnkgbGVhc2UuXG4gICAgICpcbiAgICAgKiBQT1JUSU5HIE5PVEU6IFRoaXMgaXMgb25seSB1c2VkIGZvciBXZWIgbXVsdGktdGFiLlxuICAgICAqLyAgICBzZXROZXR3b3JrRW5hYmxlZCh0KSB7XG4gICAgICAgIHRoaXMubmV0d29ya0VuYWJsZWQgIT09IHQgJiYgKHRoaXMubmV0d29ya0VuYWJsZWQgPSB0LCBcbiAgICAgICAgLy8gU2NoZWR1bGUgYSBwcmltYXJ5IGxlYXNlIHJlZnJlc2ggZm9yIGltbWVkaWF0ZSBleGVjdXRpb24uIFRoZSBldmVudHVhbFxuICAgICAgICAvLyBsZWFzZSB1cGRhdGUgd2lsbCBiZSBwcm9wYWdhdGVkIHZpYSBgcHJpbWFyeVN0YXRlTGlzdGVuZXJgLlxuICAgICAgICB0aGlzLk9lLmVucXVldWVBbmRGb3JnZXQoKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc3RhcnRlZCAmJiBhd2FpdCB0aGlzLlhlKCk7XG4gICAgICAgIH0pKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVwZGF0ZXMgdGhlIGNsaWVudCBtZXRhZGF0YSBpbiBJbmRleGVkRGIgYW5kIGF0dGVtcHRzIHRvIGVpdGhlciBvYnRhaW4gb3JcbiAgICAgKiBleHRlbmQgdGhlIHByaW1hcnkgbGVhc2UgZm9yIHRoZSBsb2NhbCBjbGllbnQuIEFzeW5jaHJvbm91c2x5IG5vdGlmaWVzIHRoZVxuICAgICAqIHByaW1hcnkgc3RhdGUgbGlzdGVuZXIgaWYgdGhlIGNsaWVudCBlaXRoZXIgbmV3bHkgb2J0YWluZWQgb3IgcmVsZWFzZWQgaXRzXG4gICAgICogcHJpbWFyeSBsZWFzZS5cbiAgICAgKi8gICAgWGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJ1blRyYW5zYWN0aW9uKFwidXBkYXRlQ2xpZW50TWV0YWRhdGFBbmRUcnlCZWNvbWVQcmltYXJ5XCIsIFwicmVhZHdyaXRlXCIsICh0ID0+IGVyKHQpLnB1dChuZXcgRnModGhpcy5jbGllbnRJZCwgRGF0ZS5ub3coKSwgdGhpcy5uZXR3b3JrRW5hYmxlZCwgdGhpcy5pbkZvcmVncm91bmQpKS5uZXh0KCgoKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5pc1ByaW1hcnkpIHJldHVybiB0aGlzLnNuKHQpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgICAgIHQgfHwgKHRoaXMuaXNQcmltYXJ5ID0gITEsIHRoaXMuT2UuZW5xdWV1ZVJldHJ5YWJsZSgoKCkgPT4gdGhpcy5RZSghMSkpKSk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiB0aGlzLnJuKHQpKSkubmV4dCgoZSA9PiB0aGlzLmlzUHJpbWFyeSAmJiAhZSA/IHRoaXMub24odCkubmV4dCgoKCkgPT4gITEpKSA6ICEhZSAmJiB0aGlzLmFuKHQpLm5leHQoKCgpID0+ICEwKSkpKSkpLmNhdGNoKCh0ID0+IHtcbiAgICAgICAgICAgIGlmICh6cyh0KSkgXG4gICAgICAgICAgICAvLyBQcm9jZWVkIHdpdGggdGhlIGV4aXN0aW5nIHN0YXRlLiBBbnkgc3Vic2VxdWVudCBhY2Nlc3MgdG9cbiAgICAgICAgICAgIC8vIEluZGV4ZWREQiB3aWxsIHZlcmlmeSB0aGUgbGVhc2UuXG4gICAgICAgICAgICByZXR1cm4gayhcIkluZGV4ZWREYlBlcnNpc3RlbmNlXCIsIFwiRmFpbGVkIHRvIGV4dGVuZCBvd25lciBsZWFzZTogXCIsIHQpLCB0aGlzLmlzUHJpbWFyeTtcbiAgICAgICAgICAgIGlmICghdGhpcy5hbGxvd1RhYlN5bmNocm9uaXphdGlvbikgdGhyb3cgdDtcbiAgICAgICAgICAgIHJldHVybiBrKFwiSW5kZXhlZERiUGVyc2lzdGVuY2VcIiwgXCJSZWxlYXNpbmcgb3duZXIgbGVhc2UgYWZ0ZXIgZXJyb3IgZHVyaW5nIGxlYXNlIHJlZnJlc2hcIiwgdCksIFxuICAgICAgICAgICAgLyogaXNQcmltYXJ5PSAqLyAhMTtcbiAgICAgICAgfSkpLnRoZW4oKHQgPT4ge1xuICAgICAgICAgICAgdGhpcy5pc1ByaW1hcnkgIT09IHQgJiYgdGhpcy5PZS5lbnF1ZXVlUmV0cnlhYmxlKCgoKSA9PiB0aGlzLlFlKHQpKSksIHRoaXMuaXNQcmltYXJ5ID0gdDtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBzbih0KSB7XG4gICAgICAgIHJldHVybiB0cih0KS5nZXQoUHMua2V5KS5uZXh0KCh0ID0+IEtzLnJlc29sdmUodGhpcy5jbih0KSkpKTtcbiAgICB9XG4gICAgdW4odCkge1xuICAgICAgICByZXR1cm4gZXIodCkuZGVsZXRlKHRoaXMuY2xpZW50SWQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJZiB0aGUgZ2FyYmFnZSBjb2xsZWN0aW9uIHRocmVzaG9sZCBoYXMgcGFzc2VkLCBwcnVuZXMgdGhlXG4gICAgICogUmVtb3RlRG9jdW1lbnRDaGFuZ2VzIGFuZCB0aGUgQ2xpZW50TWV0YWRhdGEgc3RvcmUgYmFzZWQgb24gdGhlIGxhc3QgdXBkYXRlXG4gICAgICogdGltZSBvZiBhbGwgY2xpZW50cy5cbiAgICAgKi8gICAgYXN5bmMgaG4oKSB7XG4gICAgICAgIGlmICh0aGlzLmlzUHJpbWFyeSAmJiAhdGhpcy5sbih0aGlzLmplLCAxOGU1KSkge1xuICAgICAgICAgICAgdGhpcy5qZSA9IERhdGUubm93KCk7XG4gICAgICAgICAgICBjb25zdCB0ID0gYXdhaXQgdGhpcy5ydW5UcmFuc2FjdGlvbihcIm1heWJlR2FyYmFnZUNvbGxlY3RNdWx0aUNsaWVudFN0YXRlXCIsIFwicmVhZHdyaXRlLXByaW1hcnlcIiwgKHQgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aSh0LCBGcy5zdG9yZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGUuTHQoKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuZm4odCwgMThlNSksIHMgPSB0LmZpbHRlcigodCA9PiAtMSA9PT0gbi5pbmRleE9mKHQpKSk7XG4gICAgICAgICAgICAgICAgICAgIC8vIERlbGV0ZSBtZXRhZGF0YSBmb3IgY2xpZW50cyB0aGF0IGFyZSBubyBsb25nZXIgY29uc2lkZXJlZCBhY3RpdmUuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBLcy5mb3JFYWNoKHMsICh0ID0+IGUuZGVsZXRlKHQuY2xpZW50SWQpKSkubmV4dCgoKCkgPT4gcykpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH0pKS5jYXRjaCgoKCkgPT4gW10pKTtcbiAgICAgICAgICAgIC8vIERlbGV0ZSBwb3RlbnRpYWwgbGVmdG92ZXIgZW50cmllcyB0aGF0IG1heSBjb250aW51ZSB0byBtYXJrIHRoZVxuICAgICAgICAgICAgLy8gaW5hY3RpdmUgY2xpZW50cyBhcyB6b21iaWVkIGluIExvY2FsU3RvcmFnZS5cbiAgICAgICAgICAgIC8vIElkZWFsbHkgd2UnZCBkZWxldGUgdGhlIEluZGV4ZWREYiBhbmQgTG9jYWxTdG9yYWdlIHpvbWJpZSBlbnRyaWVzIGZvclxuICAgICAgICAgICAgLy8gdGhlIGNsaWVudCBhdG9taWNhbGx5LCBidXQgd2UgY2FuJ3QuIFNvIHdlIG9wdCB0byBkZWxldGUgdGhlIEluZGV4ZWREYlxuICAgICAgICAgICAgLy8gZW50cmllcyBmaXJzdCB0byBhdm9pZCBwb3RlbnRpYWxseSByZXZpdmluZyBhIHpvbWJpZWQgY2xpZW50LlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuWWUpIGZvciAoY29uc3QgZSBvZiB0KSB0aGlzLlllLnJlbW92ZUl0ZW0odGhpcy5kbihlLmNsaWVudElkKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogU2NoZWR1bGVzIGEgcmVjdXJyaW5nIHRpbWVyIHRvIHVwZGF0ZSB0aGUgY2xpZW50IG1ldGFkYXRhIGFuZCB0byBlaXRoZXJcbiAgICAgKiBleHRlbmQgb3IgYWNxdWlyZSB0aGUgcHJpbWFyeSBsZWFzZSBpZiB0aGUgY2xpZW50IGlzIGVsaWdpYmxlLlxuICAgICAqLyAgICBlbigpIHtcbiAgICAgICAgdGhpcy5LZSA9IHRoaXMuT2UuZW5xdWV1ZUFmdGVyRGVsYXkoXCJjbGllbnRfbWV0YWRhdGFfcmVmcmVzaFwiIC8qIENsaWVudE1ldGFkYXRhUmVmcmVzaCAqLyAsIDRlMywgKCgpID0+IHRoaXMuWGUoKS50aGVuKCgoKSA9PiB0aGlzLmhuKCkpKS50aGVuKCgoKSA9PiB0aGlzLmVuKCkpKSkpO1xuICAgIH1cbiAgICAvKiogQ2hlY2tzIHdoZXRoZXIgYGNsaWVudGAgaXMgdGhlIGxvY2FsIGNsaWVudC4gKi8gICAgY24odCkge1xuICAgICAgICByZXR1cm4gISF0ICYmIHQub3duZXJJZCA9PT0gdGhpcy5jbGllbnRJZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRXZhbHVhdGUgdGhlIHN0YXRlIG9mIGFsbCBhY3RpdmUgY2xpZW50cyBhbmQgZGV0ZXJtaW5lIHdoZXRoZXIgdGhlIGxvY2FsXG4gICAgICogY2xpZW50IGlzIG9yIGNhbiBhY3QgYXMgdGhlIGhvbGRlciBvZiB0aGUgcHJpbWFyeSBsZWFzZS4gUmV0dXJucyB3aGV0aGVyXG4gICAgICogdGhlIGNsaWVudCBpcyBlbGlnaWJsZSBmb3IgdGhlIGxlYXNlLCBidXQgZG9lcyBub3QgYWN0dWFsbHkgYWNxdWlyZSBpdC5cbiAgICAgKiBNYXkgcmV0dXJuICdmYWxzZScgZXZlbiBpZiB0aGVyZSBpcyBubyBhY3RpdmUgbGVhc2Vob2xkZXIgYW5kIGFub3RoZXJcbiAgICAgKiAoZm9yZWdyb3VuZCkgY2xpZW50IHNob3VsZCBiZWNvbWUgbGVhc2Vob2xkZXIgaW5zdGVhZC5cbiAgICAgKi8gICAgcm4odCkge1xuICAgICAgICBpZiAodGhpcy5NZSkgcmV0dXJuIEtzLnJlc29sdmUoITApO1xuICAgICAgICByZXR1cm4gdHIodCkuZ2V0KFBzLmtleSkubmV4dCgoZSA9PiB7XG4gICAgICAgICAgICAvLyBBIGNsaWVudCBpcyBlbGlnaWJsZSBmb3IgdGhlIHByaW1hcnkgbGVhc2UgaWY6XG4gICAgICAgICAgICAvLyAtIGl0cyBuZXR3b3JrIGlzIGVuYWJsZWQgYW5kIHRoZSBjbGllbnQncyB0YWIgaXMgaW4gdGhlIGZvcmVncm91bmQuXG4gICAgICAgICAgICAvLyAtIGl0cyBuZXR3b3JrIGlzIGVuYWJsZWQgYW5kIG5vIG90aGVyIGNsaWVudCdzIHRhYiBpcyBpbiB0aGVcbiAgICAgICAgICAgIC8vICAgZm9yZWdyb3VuZC5cbiAgICAgICAgICAgIC8vIC0gZXZlcnkgY2xpZW50cyBuZXR3b3JrIGlzIGRpc2FibGVkIGFuZCB0aGUgY2xpZW50J3MgdGFiIGlzIGluIHRoZVxuICAgICAgICAgICAgLy8gICBmb3JlZ3JvdW5kLlxuICAgICAgICAgICAgLy8gLSBldmVyeSBjbGllbnRzIG5ldHdvcmsgaXMgZGlzYWJsZWQgYW5kIG5vIG90aGVyIGNsaWVudCdzIHRhYiBpcyBpblxuICAgICAgICAgICAgLy8gICB0aGUgZm9yZWdyb3VuZC5cbiAgICAgICAgICAgIC8vIC0gdGhlIGBmb3JjZU93bmluZ1RhYmAgc2V0dGluZyB3YXMgcGFzc2VkIGluLlxuICAgICAgICAgICAgaWYgKG51bGwgIT09IGUgJiYgdGhpcy5sbihlLmxlYXNlVGltZXN0YW1wTXMsIDVlMykgJiYgIXRoaXMud24oZS5vd25lcklkKSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNuKGUpICYmIHRoaXMubmV0d29ya0VuYWJsZWQpIHJldHVybiAhMDtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuY24oZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFlLmFsbG93VGFiU3luY2hyb25pemF0aW9uKSBcbiAgICAgICAgICAgICAgICAgICAgLy8gRmFpbCB0aGUgYGNhbkFjdEFzUHJpbWFyeWAgY2hlY2sgaWYgdGhlIGN1cnJlbnQgbGVhc2Vob2xkZXIgaGFzXG4gICAgICAgICAgICAgICAgICAgIC8vIG5vdCBvcHRlZCBpbnRvIG11bHRpLXRhYiBzeW5jaHJvbml6YXRpb24uIElmIHRoaXMgaGFwcGVucyBhdFxuICAgICAgICAgICAgICAgICAgICAvLyBjbGllbnQgc3RhcnR1cCwgd2UgcmVqZWN0IHRoZSBQcm9taXNlIHJldHVybmVkIGJ5XG4gICAgICAgICAgICAgICAgICAgIC8vIGBlbmFibGVQZXJzaXN0ZW5jZSgpYCBhbmQgdGhlIHVzZXIgY2FuIGNvbnRpbnVlIHRvIHVzZSBGaXJlc3RvcmVcbiAgICAgICAgICAgICAgICAgICAgLy8gd2l0aCBpbi1tZW1vcnkgcGVyc2lzdGVuY2UuXG4gICAgICAgICAgICAgICAgICAgIC8vIElmIHRoaXMgZmFpbHMgZHVyaW5nIGEgbGVhc2UgcmVmcmVzaCwgd2Ugd2lsbCBpbnN0ZWFkIGJsb2NrIHRoZVxuICAgICAgICAgICAgICAgICAgICAvLyBBc3luY1F1ZXVlIGZyb20gZXhlY3V0aW5nIGZ1cnRoZXIgb3BlcmF0aW9ucy4gTm90ZSB0aGF0IHRoaXMgaXNcbiAgICAgICAgICAgICAgICAgICAgLy8gYWNjZXB0YWJsZSBzaW5jZSBtaXhpbmcgJiBtYXRjaGluZyBkaWZmZXJlbnQgYHN5bmNocm9uaXplVGFic2BcbiAgICAgICAgICAgICAgICAgICAgLy8gc2V0dGluZ3MgaXMgbm90IHN1cHBvcnRlZC5cbiAgICAgICAgICAgICAgICAgICAgLy8gVE9ETyhiLzExNDIyNjIzNCk6IFJlbW92ZSB0aGlzIGNoZWNrIHdoZW4gYHN5bmNocm9uaXplVGFic2AgY2FuXG4gICAgICAgICAgICAgICAgICAgIC8vIG5vIGxvbmdlciBiZSB0dXJuZWQgb2ZmLlxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSyhxLkZBSUxFRF9QUkVDT05ESVRJT04sIFhpKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICExO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAhKCF0aGlzLm5ldHdvcmtFbmFibGVkIHx8ICF0aGlzLmluRm9yZWdyb3VuZCkgfHwgZXIodCkuTHQoKS5uZXh0KCh0ID0+IHZvaWQgMCA9PT0gdGhpcy5mbih0LCA1ZTMpLmZpbmQoKHQgPT4ge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNsaWVudElkICE9PSB0LmNsaWVudElkKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSAhdGhpcy5uZXR3b3JrRW5hYmxlZCAmJiB0Lm5ldHdvcmtFbmFibGVkLCBuID0gIXRoaXMuaW5Gb3JlZ3JvdW5kICYmIHQuaW5Gb3JlZ3JvdW5kLCBzID0gdGhpcy5uZXR3b3JrRW5hYmxlZCA9PT0gdC5uZXR3b3JrRW5hYmxlZDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUgfHwgbiAmJiBzKSByZXR1cm4gITA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiAhMTtcbiAgICAgICAgICAgIH0pKSkpO1xuICAgICAgICB9KSkubmV4dCgodCA9PiAodGhpcy5pc1ByaW1hcnkgIT09IHQgJiYgayhcIkluZGV4ZWREYlBlcnNpc3RlbmNlXCIsIGBDbGllbnQgJHt0ID8gXCJpc1wiIDogXCJpcyBub3RcIn0gZWxpZ2libGUgZm9yIGEgcHJpbWFyeSBsZWFzZS5gKSwgXG4gICAgICAgIHQpKSk7XG4gICAgfVxuICAgIGFzeW5jIHNodXRkb3duKCkge1xuICAgICAgICAvLyBUaGUgc2h1dGRvd24oKSBvcGVyYXRpb25zIGFyZSBpZGVtcG90ZW50IGFuZCBjYW4gYmUgY2FsbGVkIGV2ZW4gd2hlblxuICAgICAgICAvLyBzdGFydCgpIGFib3J0ZWQgKGUuZy4gYmVjYXVzZSBpdCBjb3VsZG4ndCBhY3F1aXJlIHRoZSBwZXJzaXN0ZW5jZSBsZWFzZSkuXG4gICAgICAgIHRoaXMuQmUgPSAhMSwgdGhpcy5fbigpLCB0aGlzLktlICYmICh0aGlzLktlLmNhbmNlbCgpLCB0aGlzLktlID0gbnVsbCksIHRoaXMubW4oKSwgXG4gICAgICAgIHRoaXMuZ24oKSwgXG4gICAgICAgIC8vIFVzZSBgU2ltcGxlRGIucnVuVHJhbnNhY3Rpb25gIGRpcmVjdGx5IHRvIGF2b2lkIGZhaWxpbmcgaWYgYW5vdGhlciB0YWJcbiAgICAgICAgLy8gaGFzIG9idGFpbmVkIHRoZSBwcmltYXJ5IGxlYXNlLlxuICAgICAgICBhd2FpdCB0aGlzLkdlLnJ1blRyYW5zYWN0aW9uKFwic2h1dGRvd25cIiwgXCJyZWFkd3JpdGVcIiwgWyBQcy5zdG9yZSwgRnMuc3RvcmUgXSwgKHQgPT4ge1xuICAgICAgICAgICAgY29uc3QgZSA9IG5ldyBacyh0LCBZLlQpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMub24oZSkubmV4dCgoKCkgPT4gdGhpcy51bihlKSkpO1xuICAgICAgICB9KSksIHRoaXMuR2UuY2xvc2UoKSwgXG4gICAgICAgIC8vIFJlbW92ZSB0aGUgZW50cnkgbWFya2luZyB0aGUgY2xpZW50IGFzIHpvbWJpZWQgZnJvbSBMb2NhbFN0b3JhZ2Ugc2luY2VcbiAgICAgICAgLy8gd2Ugc3VjY2Vzc2Z1bGx5IGRlbGV0ZWQgaXRzIG1ldGFkYXRhIGZyb20gSW5kZXhlZERiLlxuICAgICAgICB0aGlzLnluKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgY2xpZW50cyB0aGF0IGFyZSBub3Qgem9tYmllZCBhbmQgaGF2ZSBhbiB1cGRhdGVUaW1lIHdpdGhpbiB0aGVcbiAgICAgKiBwcm92aWRlZCB0aHJlc2hvbGQuXG4gICAgICovICAgIGZuKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHQuZmlsdGVyKCh0ID0+IHRoaXMubG4odC51cGRhdGVUaW1lTXMsIGUpICYmICF0aGlzLnduKHQuY2xpZW50SWQpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIElEcyBvZiB0aGUgY2xpZW50cyB0aGF0IGFyZSBjdXJyZW50bHkgYWN0aXZlLiBJZiBtdWx0aS10YWJcbiAgICAgKiBpcyBub3Qgc3VwcG9ydGVkLCByZXR1cm5zIGFuIGFycmF5IHRoYXQgb25seSBjb250YWlucyB0aGUgbG9jYWwgY2xpZW50J3NcbiAgICAgKiBJRC5cbiAgICAgKlxuICAgICAqIFBPUlRJTkcgTk9URTogVGhpcyBpcyBvbmx5IHVzZWQgZm9yIFdlYiBtdWx0aS10YWIuXG4gICAgICovICAgIHBuKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5ydW5UcmFuc2FjdGlvbihcImdldEFjdGl2ZUNsaWVudHNcIiwgXCJyZWFkb25seVwiLCAodCA9PiBlcih0KS5MdCgpLm5leHQoKHQgPT4gdGhpcy5mbih0LCAxOGU1KS5tYXAoKHQgPT4gdC5jbGllbnRJZCkpKSkpKTtcbiAgICB9XG4gICAgZ2V0IHN0YXJ0ZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLkJlO1xuICAgIH1cbiAgICBnZXRNdXRhdGlvblF1ZXVlKHQpIHtcbiAgICAgICAgcmV0dXJuIGJpLll0KHQsIHRoaXMuTiwgdGhpcy5IdCwgdGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZSk7XG4gICAgfVxuICAgIGdldFRhcmdldENhY2hlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy56ZTtcbiAgICB9XG4gICAgZ2V0UmVtb3RlRG9jdW1lbnRDYWNoZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuSGU7XG4gICAgfVxuICAgIGdldEluZGV4TWFuYWdlcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuSHQ7XG4gICAgfVxuICAgIGdldEJ1bmRsZUNhY2hlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5KZTtcbiAgICB9XG4gICAgcnVuVHJhbnNhY3Rpb24odCwgZSwgbikge1xuICAgICAgICBrKFwiSW5kZXhlZERiUGVyc2lzdGVuY2VcIiwgXCJTdGFydGluZyB0cmFuc2FjdGlvbjpcIiwgdCk7XG4gICAgICAgIGNvbnN0IHMgPSBcInJlYWRvbmx5XCIgPT09IGUgPyBcInJlYWRvbmx5XCIgOiBcInJlYWR3cml0ZVwiO1xuICAgICAgICBsZXQgaTtcbiAgICAgICAgLy8gRG8gYWxsIHRyYW5zYWN0aW9ucyBhcyByZWFkd3JpdGUgYWdhaW5zdCBhbGwgb2JqZWN0IHN0b3Jlcywgc2luY2Ugd2VcbiAgICAgICAgLy8gYXJlIHRoZSBvbmx5IHJlYWRlci93cml0ZXIuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuR2UucnVuVHJhbnNhY3Rpb24odCwgcywgQnMsIChzID0+IChpID0gbmV3IFpzKHMsIHRoaXMuTGUgPyB0aGlzLkxlLm5leHQoKSA6IFkuVCksIFxuICAgICAgICBcInJlYWR3cml0ZS1wcmltYXJ5XCIgPT09IGUgPyB0aGlzLnNuKGkpLm5leHQoKHQgPT4gISF0IHx8IHRoaXMucm4oaSkpKS5uZXh0KChlID0+IHtcbiAgICAgICAgICAgIGlmICghZSkgdGhyb3cgJChgRmFpbGVkIHRvIG9idGFpbiBwcmltYXJ5IGxlYXNlIGZvciBhY3Rpb24gJyR7dH0nLmApLCB0aGlzLmlzUHJpbWFyeSA9ICExLCBcbiAgICAgICAgICAgIHRoaXMuT2UuZW5xdWV1ZVJldHJ5YWJsZSgoKCkgPT4gdGhpcy5RZSghMSkpKSwgbmV3IEsocS5GQUlMRURfUFJFQ09ORElUSU9OLCBVcyk7XG4gICAgICAgICAgICByZXR1cm4gbihpKTtcbiAgICAgICAgfSkpLm5leHQoKHQgPT4gdGhpcy5hbihpKS5uZXh0KCgoKSA9PiB0KSkpKSA6IHRoaXMuRW4oaSkubmV4dCgoKCkgPT4gbihpKSkpKSkpLnRoZW4oKHQgPT4gKGkucmFpc2VPbkNvbW1pdHRlZEV2ZW50KCksIFxuICAgICAgICB0KSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBWZXJpZmllcyB0aGF0IHRoZSBjdXJyZW50IHRhYiBpcyB0aGUgcHJpbWFyeSBsZWFzZWhvbGRlciBvciBhbHRlcm5hdGl2ZWx5XG4gICAgICogdGhhdCB0aGUgbGVhc2Vob2xkZXIgaGFzIG9wdGVkIGludG8gbXVsdGktdGFiIHN5bmNocm9uaXphdGlvbi5cbiAgICAgKi9cbiAgICAvLyBUT0RPKGIvMTE0MjI2MjM0KTogUmVtb3ZlIHRoaXMgY2hlY2sgd2hlbiBgc3luY2hyb25pemVUYWJzYCBjYW4gbm8gbG9uZ2VyXG4gICAgLy8gYmUgdHVybmVkIG9mZi5cbiAgICBFbih0KSB7XG4gICAgICAgIHJldHVybiB0cih0KS5nZXQoUHMua2V5KS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgIGlmIChudWxsICE9PSB0ICYmIHRoaXMubG4odC5sZWFzZVRpbWVzdGFtcE1zLCA1ZTMpICYmICF0aGlzLnduKHQub3duZXJJZCkgJiYgIXRoaXMuY24odCkgJiYgISh0aGlzLk1lIHx8IHRoaXMuYWxsb3dUYWJTeW5jaHJvbml6YXRpb24gJiYgdC5hbGxvd1RhYlN5bmNocm9uaXphdGlvbikpIHRocm93IG5ldyBLKHEuRkFJTEVEX1BSRUNPTkRJVElPTiwgWGkpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE9idGFpbnMgb3IgZXh0ZW5kcyB0aGUgbmV3IHByaW1hcnkgbGVhc2UgZm9yIHRoZSBsb2NhbCBjbGllbnQuIFRoaXNcbiAgICAgKiBtZXRob2QgZG9lcyBub3QgdmVyaWZ5IHRoYXQgdGhlIGNsaWVudCBpcyBlbGlnaWJsZSBmb3IgdGhpcyBsZWFzZS5cbiAgICAgKi8gICAgYW4odCkge1xuICAgICAgICBjb25zdCBlID0gbmV3IFBzKHRoaXMuY2xpZW50SWQsIHRoaXMuYWxsb3dUYWJTeW5jaHJvbml6YXRpb24sIERhdGUubm93KCkpO1xuICAgICAgICByZXR1cm4gdHIodCkucHV0KFBzLmtleSwgZSk7XG4gICAgfVxuICAgIHN0YXRpYyBQdCgpIHtcbiAgICAgICAgcmV0dXJuIFFzLlB0KCk7XG4gICAgfVxuICAgIC8qKiBDaGVja3MgdGhlIHByaW1hcnkgbGVhc2UgYW5kIHJlbW92ZXMgaXQgaWYgd2UgYXJlIHRoZSBjdXJyZW50IHByaW1hcnkuICovICAgIG9uKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRyKHQpO1xuICAgICAgICByZXR1cm4gZS5nZXQoUHMua2V5KS5uZXh0KCh0ID0+IHRoaXMuY24odCkgPyAoayhcIkluZGV4ZWREYlBlcnNpc3RlbmNlXCIsIFwiUmVsZWFzaW5nIHByaW1hcnkgbGVhc2UuXCIpLCBcbiAgICAgICAgZS5kZWxldGUoUHMua2V5KSkgOiBLcy5yZXNvbHZlKCkpKTtcbiAgICB9XG4gICAgLyoqIFZlcmlmaWVzIHRoYXQgYHVwZGF0ZVRpbWVNc2AgaXMgd2l0aGluIGBtYXhBZ2VNc2AuICovICAgIGxuKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IERhdGUubm93KCk7XG4gICAgICAgIHJldHVybiAhKHQgPCBuIC0gZSkgJiYgKCEodCA+IG4pIHx8ICgkKGBEZXRlY3RlZCBhbiB1cGRhdGUgdGltZSB0aGF0IGlzIGluIHRoZSBmdXR1cmU6ICR7dH0gPiAke259YCksIFxuICAgICAgICAhMSkpO1xuICAgIH1cbiAgICBaZSgpIHtcbiAgICAgICAgbnVsbCAhPT0gdGhpcy5kb2N1bWVudCAmJiBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIHRoaXMuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lciAmJiAodGhpcy5xZSA9ICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuT2UuZW5xdWV1ZUFuZEZvcmdldCgoKCkgPT4gKHRoaXMuaW5Gb3JlZ3JvdW5kID0gXCJ2aXNpYmxlXCIgPT09IHRoaXMuZG9jdW1lbnQudmlzaWJpbGl0eVN0YXRlLCBcbiAgICAgICAgICAgIHRoaXMuWGUoKSkpKTtcbiAgICAgICAgfSwgdGhpcy5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwidmlzaWJpbGl0eWNoYW5nZVwiLCB0aGlzLnFlKSwgdGhpcy5pbkZvcmVncm91bmQgPSBcInZpc2libGVcIiA9PT0gdGhpcy5kb2N1bWVudC52aXNpYmlsaXR5U3RhdGUpO1xuICAgIH1cbiAgICBtbigpIHtcbiAgICAgICAgdGhpcy5xZSAmJiAodGhpcy5kb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwidmlzaWJpbGl0eWNoYW5nZVwiLCB0aGlzLnFlKSwgdGhpcy5xZSA9IG51bGwpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBdHRhY2hlcyBhIHdpbmRvdy51bmxvYWQgaGFuZGxlciB0aGF0IHdpbGwgc3luY2hyb25vdXNseSB3cml0ZSBvdXJcbiAgICAgKiBjbGllbnRJZCB0byBhIFwiem9tYmllIGNsaWVudCBpZFwiIGxvY2F0aW9uIGluIExvY2FsU3RvcmFnZS4gVGhpcyBjYW4gYmUgdXNlZFxuICAgICAqIGJ5IHRhYnMgdHJ5aW5nIHRvIGFjcXVpcmUgdGhlIHByaW1hcnkgbGVhc2UgdG8gZGV0ZXJtaW5lIHRoYXQgdGhlIGxlYXNlXG4gICAgICogaXMgbm8gbG9uZ2VyIHZhbGlkIGV2ZW4gaWYgdGhlIHRpbWVzdGFtcCBpcyByZWNlbnQuIFRoaXMgaXMgcGFydGljdWxhcmx5XG4gICAgICogaW1wb3J0YW50IGZvciB0aGUgcmVmcmVzaCBjYXNlIChzbyB0aGUgdGFiIGNvcnJlY3RseSByZS1hY3F1aXJlcyB0aGVcbiAgICAgKiBwcmltYXJ5IGxlYXNlKS4gTG9jYWxTdG9yYWdlIGlzIHVzZWQgZm9yIHRoaXMgcmF0aGVyIHRoYW4gSW5kZXhlZERiIGJlY2F1c2VcbiAgICAgKiBpdCBpcyBhIHN5bmNocm9ub3VzIEFQSSBhbmQgc28gY2FuIGJlIHVzZWQgcmVsaWFibHkgZnJvbSAgYW4gdW5sb2FkXG4gICAgICogaGFuZGxlci5cbiAgICAgKi8gICAgdG4oKSB7XG4gICAgICAgIHZhciB0O1xuICAgICAgICBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIChudWxsID09PSAodCA9IHRoaXMud2luZG93KSB8fCB2b2lkIDAgPT09IHQgPyB2b2lkIDAgOiB0LmFkZEV2ZW50TGlzdGVuZXIpICYmICh0aGlzLlVlID0gKCkgPT4ge1xuICAgICAgICAgICAgLy8gTm90ZTogSW4gdGhlb3J5LCB0aGlzIHNob3VsZCBiZSBzY2hlZHVsZWQgb24gdGhlIEFzeW5jUXVldWUgc2luY2UgaXRcbiAgICAgICAgICAgIC8vIGFjY2Vzc2VzIGludGVybmFsIHN0YXRlLiBXZSBleGVjdXRlIHRoaXMgY29kZSBkaXJlY3RseSBkdXJpbmcgc2h1dGRvd25cbiAgICAgICAgICAgIC8vIHRvIG1ha2Ugc3VyZSBpdCBnZXRzIGEgY2hhbmNlIHRvIHJ1bi5cbiAgICAgICAgICAgIHRoaXMuX24oKSwgaCgpICYmIG5hdmlnYXRvci5hcHBWZXJzaW9uLm1hdGNoKFwiVmVyc2lvbi8xNFwiKSAmJiBcbiAgICAgICAgICAgIC8vIE9uIFNhZmFyaSAxNCwgd2UgZG8gbm90IHJ1biBhbnkgY2xlYW51cCBhY3Rpb25zIGFzIGl0IG1pZ2h0IHRyaWdnZXJcbiAgICAgICAgICAgIC8vIGEgYnVnIHRoYXQgcHJldmVudHMgU2FmYXJpIGZyb20gcmUtb3BlbmluZyBJbmRleGVkREIgZHVyaW5nIHRoZVxuICAgICAgICAgICAgLy8gbmV4dCBwYWdlIGxvYWQuXG4gICAgICAgICAgICAvLyBTZWUgaHR0cHM6Ly9idWdzLndlYmtpdC5vcmcvc2hvd19idWcuY2dpP2lkPTIyNjU0N1xuICAgICAgICAgICAgdGhpcy5PZS5lbnRlclJlc3RyaWN0ZWRNb2RlKC8qIHB1cmdlRXhpc3RpbmdUYXNrcz0gKi8gITApLCB0aGlzLk9lLmVucXVldWVBbmRGb3JnZXQoKCgpID0+IHRoaXMuc2h1dGRvd24oKSkpO1xuICAgICAgICB9LCB0aGlzLndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicGFnZWhpZGVcIiwgdGhpcy5VZSkpO1xuICAgIH1cbiAgICBnbigpIHtcbiAgICAgICAgdGhpcy5VZSAmJiAodGhpcy53aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInBhZ2VoaWRlXCIsIHRoaXMuVWUpLCB0aGlzLlVlID0gbnVsbCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgd2hldGhlciBhIGNsaWVudCBpcyBcInpvbWJpZWRcIiBiYXNlZCBvbiBpdHMgTG9jYWxTdG9yYWdlIGVudHJ5LlxuICAgICAqIENsaWVudHMgYmVjb21lIHpvbWJpZWQgd2hlbiB0aGVpciB0YWIgY2xvc2VzIHdpdGhvdXQgcnVubmluZyBhbGwgb2YgdGhlXG4gICAgICogY2xlYW51cCBsb2dpYyBpbiBgc2h1dGRvd24oKWAuXG4gICAgICovICAgIHduKHQpIHtcbiAgICAgICAgdmFyIGU7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBuID0gbnVsbCAhPT0gKG51bGwgPT09IChlID0gdGhpcy5ZZSkgfHwgdm9pZCAwID09PSBlID8gdm9pZCAwIDogZS5nZXRJdGVtKHRoaXMuZG4odCkpKTtcbiAgICAgICAgICAgIHJldHVybiBrKFwiSW5kZXhlZERiUGVyc2lzdGVuY2VcIiwgYENsaWVudCAnJHt0fScgJHtuID8gXCJpc1wiIDogXCJpcyBub3RcIn0gem9tYmllZCBpbiBMb2NhbFN0b3JhZ2VgKSwgXG4gICAgICAgICAgICBuO1xuICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICAvLyBHcmFjZWZ1bGx5IGhhbmRsZSBpZiBMb2NhbFN0b3JhZ2UgaXNuJ3Qgd29ya2luZy5cbiAgICAgICAgICAgIHJldHVybiAkKFwiSW5kZXhlZERiUGVyc2lzdGVuY2VcIiwgXCJGYWlsZWQgdG8gZ2V0IHpvbWJpZWQgY2xpZW50IGlkLlwiLCB0KSwgITE7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVjb3JkIGNsaWVudCBhcyB6b21iaWVkIChhIGNsaWVudCB0aGF0IGhhZCBpdHMgdGFiIGNsb3NlZCkuIFpvbWJpZWRcbiAgICAgKiBjbGllbnRzIGFyZSBpZ25vcmVkIGR1cmluZyBwcmltYXJ5IHRhYiBzZWxlY3Rpb24uXG4gICAgICovICAgIF9uKCkge1xuICAgICAgICBpZiAodGhpcy5ZZSkgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMuWWUuc2V0SXRlbSh0aGlzLmRuKHRoaXMuY2xpZW50SWQpLCBTdHJpbmcoRGF0ZS5ub3coKSkpO1xuICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICAvLyBHcmFjZWZ1bGx5IGhhbmRsZSBpZiBMb2NhbFN0b3JhZ2UgaXNuJ3QgYXZhaWxhYmxlIC8gd29ya2luZy5cbiAgICAgICAgICAgICQoXCJGYWlsZWQgdG8gc2V0IHpvbWJpZSBjbGllbnQgaWQuXCIsIHQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKiBSZW1vdmVzIHRoZSB6b21iaWVkIGNsaWVudCBlbnRyeSBpZiBpdCBleGlzdHMuICovICAgIHluKCkge1xuICAgICAgICBpZiAodGhpcy5ZZSkgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMuWWUucmVtb3ZlSXRlbSh0aGlzLmRuKHRoaXMuY2xpZW50SWQpKTtcbiAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgLy8gSWdub3JlXG4gICAgICAgIH1cbiAgICB9XG4gICAgZG4odCkge1xuICAgICAgICByZXR1cm4gYGZpcmVzdG9yZV96b21iaWVfJHt0aGlzLnBlcnNpc3RlbmNlS2V5fV8ke3R9YDtcbiAgICB9XG59XG5cbi8qKlxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSBwcmltYXJ5IGNsaWVudCBvYmplY3Qgc3RvcmUuXG4gKi8gZnVuY3Rpb24gdHIodCkge1xuICAgIHJldHVybiB0aSh0LCBQcy5zdG9yZSk7XG59XG5cbi8qKlxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSBjbGllbnQgbWV0YWRhdGEgb2JqZWN0IHN0b3JlLlxuICovIGZ1bmN0aW9uIGVyKHQpIHtcbiAgICByZXR1cm4gdGkodCwgRnMuc3RvcmUpO1xufVxuXG4vKipcbiAqIEdlbmVyYXRlcyBhIHN0cmluZyB1c2VkIGFzIGEgcHJlZml4IHdoZW4gc3RvcmluZyBkYXRhIGluIEluZGV4ZWREQiBhbmRcbiAqIExvY2FsU3RvcmFnZS5cbiAqLyBmdW5jdGlvbiBucih0LCBlKSB7XG4gICAgLy8gVXNlIHR3byBkaWZmZXJlbnQgcHJlZml4IGZvcm1hdHM6XG4gICAgLy8gICAqIGZpcmVzdG9yZSAvIHBlcnNpc3RlbmNlS2V5IC8gcHJvamVjdElEIC4gZGF0YWJhc2VJRCAvIC4uLlxuICAgIC8vICAgKiBmaXJlc3RvcmUgLyBwZXJzaXN0ZW5jZUtleSAvIHByb2plY3RJRCAvIC4uLlxuICAgIC8vIHByb2plY3RJRHMgYXJlIEROUy1jb21wYXRpYmxlIG5hbWVzIGFuZCBjYW5ub3QgY29udGFpbiBkb3RzXG4gICAgLy8gc28gdGhlcmUncyBubyBkYW5nZXIgb2YgY29sbGlzaW9ucy5cbiAgICBsZXQgbiA9IHQucHJvamVjdElkO1xuICAgIHJldHVybiB0LmlzRGVmYXVsdERhdGFiYXNlIHx8IChuICs9IFwiLlwiICsgdC5kYXRhYmFzZSksIFwiZmlyZXN0b3JlL1wiICsgZSArIFwiL1wiICsgbiArIFwiL1wiO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY2xhc3Mgc3Ige1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5wcm9ncmVzcyA9IHQsIHRoaXMuVG4gPSBlO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSByZWFkb25seSB2aWV3IG9mIHRoZSBsb2NhbCBzdGF0ZSBvZiBhbGwgZG9jdW1lbnRzIHdlJ3JlIHRyYWNraW5nIChpLmUuIHdlXG4gKiBoYXZlIGEgY2FjaGVkIHZlcnNpb24gaW4gcmVtb3RlRG9jdW1lbnRDYWNoZSBvciBsb2NhbCBtdXRhdGlvbnMgZm9yIHRoZVxuICogZG9jdW1lbnQpLiBUaGUgdmlldyBpcyBjb21wdXRlZCBieSBhcHBseWluZyB0aGUgbXV0YXRpb25zIGluIHRoZVxuICogTXV0YXRpb25RdWV1ZSB0byB0aGUgUmVtb3RlRG9jdW1lbnRDYWNoZS5cbiAqLyBjbGFzcyBpciB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbikge1xuICAgICAgICB0aGlzLkhlID0gdCwgdGhpcy5JbiA9IGUsIHRoaXMuSHQgPSBuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGxvY2FsIHZpZXcgb2YgdGhlIGRvY3VtZW50IGlkZW50aWZpZWQgYnkgYGtleWAuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBMb2NhbCB2aWV3IG9mIHRoZSBkb2N1bWVudCBvciBudWxsIGlmIHdlIGRvbid0IGhhdmUgYW55IGNhY2hlZFxuICAgICAqIHN0YXRlIGZvciBpdC5cbiAgICAgKi8gICAgQW4odCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5Jbi5nZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdEb2N1bWVudEtleSh0LCBlKS5uZXh0KChuID0+IHRoaXMuUm4odCwgZSwgbikpKTtcbiAgICB9XG4gICAgLyoqIEludGVybmFsIHZlcnNpb24gb2YgYGdldERvY3VtZW50YCB0aGF0IGFsbG93cyByZXVzaW5nIGJhdGNoZXMuICovICAgIFJuKHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuSGUuZ2V0RW50cnkodCwgZSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2YgbikgZS5hcHBseVRvTG9jYWxWaWV3KHQpO1xuICAgICAgICAgICAgcmV0dXJuIHQ7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgLy8gUmV0dXJucyB0aGUgdmlldyBvZiB0aGUgZ2l2ZW4gYGRvY3NgIGFzIHRoZXkgd291bGQgYXBwZWFyIGFmdGVyIGFwcGx5aW5nXG4gICAgLy8gYWxsIG11dGF0aW9ucyBpbiB0aGUgZ2l2ZW4gYGJhdGNoZXNgLlxuICAgIFBuKHQsIGUpIHtcbiAgICAgICAgdC5mb3JFYWNoKCgodCwgbikgPT4ge1xuICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIGUpIHQuYXBwbHlUb0xvY2FsVmlldyhuKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBsb2NhbCB2aWV3IG9mIHRoZSBkb2N1bWVudHMgaWRlbnRpZmllZCBieSBga2V5c2AuXG4gICAgICpcbiAgICAgKiBJZiB3ZSBkb24ndCBoYXZlIGNhY2hlZCBzdGF0ZSBmb3IgYSBkb2N1bWVudCBpbiBga2V5c2AsIGEgTm9Eb2N1bWVudCB3aWxsXG4gICAgICogYmUgc3RvcmVkIGZvciB0aGF0IGtleSBpbiB0aGUgcmVzdWx0aW5nIHNldC5cbiAgICAgKi8gICAgYm4odCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5IZS5nZXRFbnRyaWVzKHQsIGUpLm5leHQoKGUgPT4gdGhpcy52bih0LCBlKS5uZXh0KCgoKSA9PiBlKSkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQXBwbGllcyB0aGUgbG9jYWwgdmlldyB0aGUgZ2l2ZW4gYGJhc2VEb2NzYCB3aXRob3V0IHJldHJpZXZpbmcgZG9jdW1lbnRzXG4gICAgICogZnJvbSB0aGUgbG9jYWwgc3RvcmUuXG4gICAgICovICAgIHZuKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuSW4uZ2V0QWxsTXV0YXRpb25CYXRjaGVzQWZmZWN0aW5nRG9jdW1lbnRLZXlzKHQsIGUpLm5leHQoKHQgPT4gdGhpcy5QbihlLCB0KSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQZXJmb3JtcyBhIHF1ZXJ5IGFnYWluc3QgdGhlIGxvY2FsIHZpZXcgb2YgYWxsIGRvY3VtZW50cy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB0cmFuc2FjdGlvbiAtIFRoZSBwZXJzaXN0ZW5jZSB0cmFuc2FjdGlvbi5cbiAgICAgKiBAcGFyYW0gcXVlcnkgLSBUaGUgcXVlcnkgdG8gbWF0Y2ggZG9jdW1lbnRzIGFnYWluc3QuXG4gICAgICogQHBhcmFtIHNpbmNlUmVhZFRpbWUgLSBJZiBub3Qgc2V0IHRvIFNuYXBzaG90VmVyc2lvbi5taW4oKSwgcmV0dXJuIG9ubHlcbiAgICAgKiAgICAgZG9jdW1lbnRzIHRoYXQgaGF2ZSBiZWVuIHJlYWQgc2luY2UgdGhpcyBzbmFwc2hvdCB2ZXJzaW9uIChleGNsdXNpdmUpLlxuICAgICAqLyAgICBnZXREb2N1bWVudHNNYXRjaGluZ1F1ZXJ5KHQsIGUsIG4pIHtcbiAgICAgICAgLyoqXG4gKiBSZXR1cm5zIHdoZXRoZXIgdGhlIHF1ZXJ5IG1hdGNoZXMgYSBzaW5nbGUgZG9jdW1lbnQgYnkgcGF0aCAocmF0aGVyIHRoYW4gYVxuICogY29sbGVjdGlvbikuXG4gKi9cbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIHJldHVybiBQdC5pc0RvY3VtZW50S2V5KHQucGF0aCkgJiYgbnVsbCA9PT0gdC5jb2xsZWN0aW9uR3JvdXAgJiYgMCA9PT0gdC5maWx0ZXJzLmxlbmd0aDtcbiAgICAgICAgfShlKSA/IHRoaXMuVm4odCwgZS5wYXRoKSA6IHllKGUpID8gdGhpcy5Tbih0LCBlLCBuKSA6IHRoaXMuRG4odCwgZSwgbik7XG4gICAgfVxuICAgIFZuKHQsIGUpIHtcbiAgICAgICAgLy8gSnVzdCBkbyBhIHNpbXBsZSBkb2N1bWVudCBsb29rdXAuXG4gICAgICAgIHJldHVybiB0aGlzLkFuKHQsIG5ldyBQdChlKSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICBsZXQgZSA9IFRuKCk7XG4gICAgICAgICAgICByZXR1cm4gdC5pc0ZvdW5kRG9jdW1lbnQoKSAmJiAoZSA9IGUuaW5zZXJ0KHQua2V5LCB0KSksIGU7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgU24odCwgZSwgbikge1xuICAgICAgICBjb25zdCBzID0gZS5jb2xsZWN0aW9uR3JvdXA7XG4gICAgICAgIGxldCBpID0gVG4oKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuSHQuZ2V0Q29sbGVjdGlvblBhcmVudHModCwgcykubmV4dCgociA9PiBLcy5mb3JFYWNoKHIsIChyID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG8gPSBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBsZShlLCBcbiAgICAgICAgICAgICAgICAvKmNvbGxlY3Rpb25Hcm91cD0qLyBudWxsLCB0LmV4cGxpY2l0T3JkZXJCeS5zbGljZSgpLCB0LmZpbHRlcnMuc2xpY2UoKSwgdC5saW1pdCwgdC5saW1pdFR5cGUsIHQuc3RhcnRBdCwgdC5lbmRBdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvKipcbiAqIFJldHVybnMgdHJ1ZSBpZiB0aGlzIHF1ZXJ5IGRvZXMgbm90IHNwZWNpZnkgYW55IHF1ZXJ5IGNvbnN0cmFpbnRzIHRoYXRcbiAqIGNvdWxkIHJlbW92ZSByZXN1bHRzLlxuICovIChlLCByLmNoaWxkKHMpKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLkRuKHQsIG8sIG4pLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgICAgIHQuZm9yRWFjaCgoKHQsIGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaSA9IGkuaW5zZXJ0KHQsIGUpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IGkpKSkpO1xuICAgIH1cbiAgICBEbih0LCBlLCBuKSB7XG4gICAgICAgIC8vIFF1ZXJ5IHRoZSByZW1vdGUgZG9jdW1lbnRzIGFuZCBvdmVybGF5IG11dGF0aW9ucy5cbiAgICAgICAgbGV0IHMsIGk7XG4gICAgICAgIHJldHVybiB0aGlzLkhlLmdldERvY3VtZW50c01hdGNoaW5nUXVlcnkodCwgZSwgbikubmV4dCgobiA9PiAocyA9IG4sIHRoaXMuSW4uZ2V0QWxsTXV0YXRpb25CYXRjaGVzQWZmZWN0aW5nUXVlcnkodCwgZSkpKSkubmV4dCgoZSA9PiAoaSA9IGUsIFxuICAgICAgICB0aGlzLkNuKHQsIGksIHMpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgcyA9IHQ7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgaSkgZm9yIChjb25zdCBlIG9mIHQubXV0YXRpb25zKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IGUua2V5O1xuICAgICAgICAgICAgICAgIGxldCBpID0gcy5nZXQobik7XG4gICAgICAgICAgICAgICAgbnVsbCA9PSBpICYmIChcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgaW52YWxpZCBkb2N1bWVudCB0byBhcHBseSBtdXRhdGlvbnMgb24gdG9wIG9mXG4gICAgICAgICAgICAgICAgaSA9IHF0Lm5ld0ludmFsaWREb2N1bWVudChuKSwgcyA9IHMuaW5zZXJ0KG4sIGkpKSwgSmUoZSwgaSwgdC5sb2NhbFdyaXRlVGltZSksIGkuaXNGb3VuZERvY3VtZW50KCkgfHwgKHMgPSBzLnJlbW92ZShuKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKSkpKS5uZXh0KCgoKSA9PiAoXG4gICAgICAgIC8vIEZpbmFsbHksIGZpbHRlciBvdXQgYW55IGRvY3VtZW50cyB0aGF0IGRvbid0IGFjdHVhbGx5IG1hdGNoXG4gICAgICAgIC8vIHRoZSBxdWVyeS5cbiAgICAgICAgcy5mb3JFYWNoKCgodCwgbikgPT4ge1xuICAgICAgICAgICAgUGUoZSwgbikgfHwgKHMgPSBzLnJlbW92ZSh0KSk7XG4gICAgICAgIH0pKSwgcykpKTtcbiAgICB9XG4gICAgQ24odCwgZSwgbikge1xuICAgICAgICBsZXQgcyA9IFBuKCk7XG4gICAgICAgIGZvciAoY29uc3QgdCBvZiBlKSBmb3IgKGNvbnN0IGUgb2YgdC5tdXRhdGlvbnMpIGUgaW5zdGFuY2VvZiBlbiAmJiBudWxsID09PSBuLmdldChlLmtleSkgJiYgKHMgPSBzLmFkZChlLmtleSkpO1xuICAgICAgICBsZXQgaSA9IG47XG4gICAgICAgIHJldHVybiB0aGlzLkhlLmdldEVudHJpZXModCwgcykubmV4dCgodCA9PiAodC5mb3JFYWNoKCgodCwgZSkgPT4ge1xuICAgICAgICAgICAgZS5pc0ZvdW5kRG9jdW1lbnQoKSAmJiAoaSA9IGkuaW5zZXJ0KHQsIGUpKTtcbiAgICAgICAgfSkpLCBpKSkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSBzZXQgb2YgY2hhbmdlcyB0byB3aGF0IGRvY3VtZW50cyBhcmUgY3VycmVudGx5IGluIHZpZXcgYW5kIG91dCBvZiB2aWV3IGZvclxuICogYSBnaXZlbiBxdWVyeS4gVGhlc2UgY2hhbmdlcyBhcmUgc2VudCB0byB0aGUgTG9jYWxTdG9yZSBieSB0aGUgVmlldyAodmlhXG4gKiB0aGUgU3luY0VuZ2luZSkgYW5kIGFyZSB1c2VkIHRvIHBpbiAvIHVucGluIGRvY3VtZW50cyBhcyBhcHByb3ByaWF0ZS5cbiAqLyBjbGFzcyByciB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcykge1xuICAgICAgICB0aGlzLnRhcmdldElkID0gdCwgdGhpcy5mcm9tQ2FjaGUgPSBlLCB0aGlzLk5uID0gbiwgdGhpcy54biA9IHM7XG4gICAgfVxuICAgIHN0YXRpYyBrbih0LCBlKSB7XG4gICAgICAgIGxldCBuID0gUG4oKSwgcyA9IFBuKCk7XG4gICAgICAgIGZvciAoY29uc3QgdCBvZiBlLmRvY0NoYW5nZXMpIHN3aXRjaCAodC50eXBlKSB7XG4gICAgICAgICAgY2FzZSAwIC8qIEFkZGVkICovIDpcbiAgICAgICAgICAgIG4gPSBuLmFkZCh0LmRvYy5rZXkpO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBjYXNlIDEgLyogUmVtb3ZlZCAqLyA6XG4gICAgICAgICAgICBzID0gcy5hZGQodC5kb2Mua2V5KTtcbiAvLyBkbyBub3RoaW5nXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IHJyKHQsIGUuZnJvbUNhY2hlLCBuLCBzKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEEgcXVlcnkgZW5naW5lIHRoYXQgdGFrZXMgYWR2YW50YWdlIG9mIHRoZSB0YXJnZXQgZG9jdW1lbnQgbWFwcGluZyBpbiB0aGVcbiAqIFF1ZXJ5Q2FjaGUuIFF1ZXJ5IGV4ZWN1dGlvbiBpcyBvcHRpbWl6ZWQgYnkgb25seSByZWFkaW5nIHRoZSBkb2N1bWVudHMgdGhhdFxuICogcHJldmlvdXNseSBtYXRjaGVkIGEgcXVlcnkgcGx1cyBhbnkgZG9jdW1lbnRzIHRoYXQgd2VyZSBlZGl0ZWQgYWZ0ZXIgdGhlXG4gKiBxdWVyeSB3YXMgbGFzdCBsaXN0ZW5lZCB0by5cbiAqXG4gKiBUaGVyZSBhcmUgc29tZSBjYXNlcyB3aGVuIHRoaXMgb3B0aW1pemF0aW9uIGlzIG5vdCBndWFyYW50ZWVkIHRvIHByb2R1Y2VcbiAqIHRoZSBzYW1lIHJlc3VsdHMgYXMgZnVsbCBjb2xsZWN0aW9uIHNjYW5zLiBJbiB0aGVzZSBjYXNlcywgcXVlcnlcbiAqIHByb2Nlc3NpbmcgZmFsbHMgYmFjayB0byBmdWxsIHNjYW5zLiBUaGVzZSBjYXNlcyBhcmU6XG4gKlxuICogLSBMaW1pdCBxdWVyaWVzIHdoZXJlIGEgZG9jdW1lbnQgdGhhdCBtYXRjaGVkIHRoZSBxdWVyeSBwcmV2aW91c2x5IG5vIGxvbmdlclxuICogICBtYXRjaGVzIHRoZSBxdWVyeS5cbiAqXG4gKiAtIExpbWl0IHF1ZXJpZXMgd2hlcmUgYSBkb2N1bWVudCBlZGl0IG1heSBjYXVzZSB0aGUgZG9jdW1lbnQgdG8gc29ydCBiZWxvd1xuICogICBhbm90aGVyIGRvY3VtZW50IHRoYXQgaXMgaW4gdGhlIGxvY2FsIGNhY2hlLlxuICpcbiAqIC0gUXVlcmllcyB0aGF0IGhhdmUgbmV2ZXIgYmVlbiBDVVJSRU5UIG9yIGZyZWUgb2YgbGltYm8gZG9jdW1lbnRzLlxuICovIGNsYXNzIG9yIHtcbiAgICAvKiogU2V0cyB0aGUgZG9jdW1lbnQgdmlldyB0byBxdWVyeSBhZ2FpbnN0LiAqL1xuICAgICRuKHQpIHtcbiAgICAgICAgdGhpcy5PbiA9IHQ7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIGFsbCBsb2NhbCBkb2N1bWVudHMgbWF0Y2hpbmcgdGhlIHNwZWNpZmllZCBxdWVyeS4gKi8gICAgZ2V0RG9jdW1lbnRzTWF0Y2hpbmdRdWVyeSh0LCBlLCBuLCBzKSB7XG4gICAgICAgIC8vIFF1ZXJpZXMgdGhhdCBtYXRjaCBhbGwgZG9jdW1lbnRzIGRvbid0IGJlbmVmaXQgZnJvbSB1c2luZ1xuICAgICAgICAvLyBrZXktYmFzZWQgbG9va3Vwcy4gSXQgaXMgbW9yZSBlZmZpY2llbnQgdG8gc2NhbiBhbGwgZG9jdW1lbnRzIGluIGFcbiAgICAgICAgLy8gY29sbGVjdGlvbiwgcmF0aGVyIHRoYW4gdG8gcGVyZm9ybSBpbmRpdmlkdWFsIGxvb2t1cHMuXG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICByZXR1cm4gMCA9PT0gdC5maWx0ZXJzLmxlbmd0aCAmJiBudWxsID09PSB0LmxpbWl0ICYmIG51bGwgPT0gdC5zdGFydEF0ICYmIG51bGwgPT0gdC5lbmRBdCAmJiAoMCA9PT0gdC5leHBsaWNpdE9yZGVyQnkubGVuZ3RoIHx8IDEgPT09IHQuZXhwbGljaXRPcmRlckJ5Lmxlbmd0aCAmJiB0LmV4cGxpY2l0T3JkZXJCeVswXS5maWVsZC5pc0tleUZpZWxkKCkpO1xuICAgICAgICB9KGUpIHx8IG4uaXNFcXVhbChpdC5taW4oKSkgPyB0aGlzLkZuKHQsIGUpIDogdGhpcy5Pbi5ibih0LCBzKS5uZXh0KChpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLk1uKGUsIGkpO1xuICAgICAgICAgICAgcmV0dXJuICh3ZShlKSB8fCBfZShlKSkgJiYgdGhpcy5MbihlLmxpbWl0VHlwZSwgciwgcywgbikgPyB0aGlzLkZuKHQsIGUpIDogKE4oKSA8PSBjLkRFQlVHICYmIGsoXCJRdWVyeUVuZ2luZVwiLCBcIlJlLXVzaW5nIHByZXZpb3VzIHJlc3VsdCBmcm9tICVzIHRvIGV4ZWN1dGUgcXVlcnk6ICVzXCIsIG4udG9TdHJpbmcoKSwgUmUoZSkpLCBcbiAgICAgICAgICAgIHRoaXMuT24uZ2V0RG9jdW1lbnRzTWF0Y2hpbmdRdWVyeSh0LCBlLCBuKS5uZXh0KCh0ID0+IChcbiAgICAgICAgICAgIC8vIFdlIG1lcmdlIGBwcmV2aW91c1Jlc3VsdHNgIGludG8gYHVwZGF0ZVJlc3VsdHNgLCBzaW5jZVxuICAgICAgICAgICAgLy8gYHVwZGF0ZVJlc3VsdHNgIGlzIGFscmVhZHkgYSBEb2N1bWVudE1hcC4gSWYgYSBkb2N1bWVudCBpc1xuICAgICAgICAgICAgLy8gY29udGFpbmVkIGluIGJvdGggbGlzdHMsIHRoZW4gaXRzIGNvbnRlbnRzIGFyZSB0aGUgc2FtZS5cbiAgICAgICAgICAgIHIuZm9yRWFjaCgoZSA9PiB7XG4gICAgICAgICAgICAgICAgdCA9IHQuaW5zZXJ0KGUua2V5LCBlKTtcbiAgICAgICAgICAgIH0pKSwgdCkpKSk7XG4gICAgICAgIH0pKTtcbiAgICAgICAgLy8gUXVlcmllcyB0aGF0IGhhdmUgbmV2ZXIgc2VlbiBhIHNuYXBzaG90IHdpdGhvdXQgbGltYm8gZnJlZSBkb2N1bWVudHNcbiAgICAgICAgLy8gc2hvdWxkIGFsc28gYmUgcnVuIGFzIGEgZnVsbCBjb2xsZWN0aW9uIHNjYW4uXG4gICAgICAgIH1cbiAgICAvKiogQXBwbGllcyB0aGUgcXVlcnkgZmlsdGVyIGFuZCBzb3J0aW5nIHRvIHRoZSBwcm92aWRlZCBkb2N1bWVudHMuICAqLyAgICBNbih0LCBlKSB7XG4gICAgICAgIC8vIFNvcnQgdGhlIGRvY3VtZW50cyBhbmQgcmUtYXBwbHkgdGhlIHF1ZXJ5IGZpbHRlciBzaW5jZSBwcmV2aW91c2x5XG4gICAgICAgIC8vIG1hdGNoaW5nIGRvY3VtZW50cyBkbyBub3QgbmVjZXNzYXJpbHkgc3RpbGwgbWF0Y2ggdGhlIHF1ZXJ5LlxuICAgICAgICBsZXQgbiA9IG5ldyBtbihiZSh0KSk7XG4gICAgICAgIHJldHVybiBlLmZvckVhY2goKChlLCBzKSA9PiB7XG4gICAgICAgICAgICBQZSh0LCBzKSAmJiAobiA9IG4uYWRkKHMpKTtcbiAgICAgICAgfSkpLCBuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBEZXRlcm1pbmVzIGlmIGEgbGltaXQgcXVlcnkgbmVlZHMgdG8gYmUgcmVmaWxsZWQgZnJvbSBjYWNoZSwgbWFraW5nIGl0XG4gICAgICogaW5lbGlnaWJsZSBmb3IgaW5kZXgtZnJlZSBleGVjdXRpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gc29ydGVkUHJldmlvdXNSZXN1bHRzIC0gVGhlIGRvY3VtZW50cyB0aGF0IG1hdGNoZWQgdGhlIHF1ZXJ5IHdoZW4gaXRcbiAgICAgKiB3YXMgbGFzdCBzeW5jaHJvbml6ZWQsIHNvcnRlZCBieSB0aGUgcXVlcnkncyBjb21wYXJhdG9yLlxuICAgICAqIEBwYXJhbSByZW1vdGVLZXlzIC0gVGhlIGRvY3VtZW50IGtleXMgdGhhdCBtYXRjaGVkIHRoZSBxdWVyeSBhdCB0aGUgbGFzdFxuICAgICAqIHNuYXBzaG90LlxuICAgICAqIEBwYXJhbSBsaW1ib0ZyZWVTbmFwc2hvdFZlcnNpb24gLSBUaGUgdmVyc2lvbiBvZiB0aGUgc25hcHNob3Qgd2hlbiB0aGVcbiAgICAgKiBxdWVyeSB3YXMgbGFzdCBzeW5jaHJvbml6ZWQuXG4gICAgICovICAgIExuKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgLy8gVGhlIHF1ZXJ5IG5lZWRzIHRvIGJlIHJlZmlsbGVkIGlmIGEgcHJldmlvdXNseSBtYXRjaGluZyBkb2N1bWVudCBub1xuICAgICAgICAvLyBsb25nZXIgbWF0Y2hlcy5cbiAgICAgICAgaWYgKG4uc2l6ZSAhPT0gZS5zaXplKSByZXR1cm4gITA7XG4gICAgICAgIC8vIExpbWl0IHF1ZXJpZXMgYXJlIG5vdCBlbGlnaWJsZSBmb3IgaW5kZXgtZnJlZSBxdWVyeSBleGVjdXRpb24gaWYgdGhlcmUgaXNcbiAgICAgICAgLy8gYSBwb3RlbnRpYWwgdGhhdCBhbiBvbGRlciBkb2N1bWVudCBmcm9tIGNhY2hlIG5vdyBzb3J0cyBiZWZvcmUgYSBkb2N1bWVudFxuICAgICAgICAvLyB0aGF0IHdhcyBwcmV2aW91c2x5IHBhcnQgb2YgdGhlIGxpbWl0LiBUaGlzLCBob3dldmVyLCBjYW4gb25seSBoYXBwZW4gaWZcbiAgICAgICAgLy8gdGhlIGRvY3VtZW50IGF0IHRoZSBlZGdlIG9mIHRoZSBsaW1pdCBnb2VzIG91dCBvZiBsaW1pdC5cbiAgICAgICAgLy8gSWYgYSBkb2N1bWVudCB0aGF0IGlzIG5vdCB0aGUgbGltaXQgYm91bmRhcnkgc29ydHMgZGlmZmVyZW50bHksXG4gICAgICAgIC8vIHRoZSBib3VuZGFyeSBvZiB0aGUgbGltaXQgaXRzZWxmIGRpZCBub3QgY2hhbmdlIGFuZCBkb2N1bWVudHMgZnJvbSBjYWNoZVxuICAgICAgICAvLyB3aWxsIGNvbnRpbnVlIHRvIGJlIFwicmVqZWN0ZWRcIiBieSB0aGlzIGJvdW5kYXJ5LiBUaGVyZWZvcmUsIHdlIGNhbiBpZ25vcmVcbiAgICAgICAgLy8gYW55IG1vZGlmaWNhdGlvbnMgdGhhdCBkb24ndCBhZmZlY3QgdGhlIGxhc3QgZG9jdW1lbnQuXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IFwiRlwiIC8qIEZpcnN0ICovID09PSB0ID8gZS5sYXN0KCkgOiBlLmZpcnN0KCk7XG4gICAgICAgIHJldHVybiAhIWkgJiYgKGkuaGFzUGVuZGluZ1dyaXRlcyB8fCBpLnZlcnNpb24uY29tcGFyZVRvKHMpID4gMCk7XG4gICAgfVxuICAgIEZuKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIE4oKSA8PSBjLkRFQlVHICYmIGsoXCJRdWVyeUVuZ2luZVwiLCBcIlVzaW5nIGZ1bGwgY29sbGVjdGlvbiBzY2FuIHRvIGV4ZWN1dGUgcXVlcnk6XCIsIFJlKGUpKSwgXG4gICAgICAgIHRoaXMuT24uZ2V0RG9jdW1lbnRzTWF0Y2hpbmdRdWVyeSh0LCBlLCBpdC5taW4oKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBJbXBsZW1lbnRzIGBMb2NhbFN0b3JlYCBpbnRlcmZhY2UuXG4gKlxuICogTm90ZTogc29tZSBmaWVsZCBkZWZpbmVkIGluIHRoaXMgY2xhc3MgbWlnaHQgaGF2ZSBwdWJsaWMgYWNjZXNzIGxldmVsLCBidXRcbiAqIHRoZSBjbGFzcyBpcyBub3QgZXhwb3J0ZWQgc28gdGhleSBhcmUgb25seSBhY2Nlc3NpYmxlIGZyb20gdGhpcyBtb2R1bGUuXG4gKiBUaGlzIGlzIHVzZWZ1bCB0byBpbXBsZW1lbnQgb3B0aW9uYWwgZmVhdHVyZXMgKGxpa2UgYnVuZGxlcykgaW4gZnJlZVxuICogZnVuY3Rpb25zLCBzdWNoIHRoYXQgdGhleSBhcmUgdHJlZS1zaGFrZWFibGUuXG4gKi9cbmNsYXNzIGFyIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKiogTWFuYWdlcyBvdXIgaW4tbWVtb3J5IG9yIGR1cmFibGUgcGVyc2lzdGVuY2UuICovXG4gICAgdCwgZSwgbiwgcykge1xuICAgICAgICB0aGlzLnBlcnNpc3RlbmNlID0gdCwgdGhpcy5CbiA9IGUsIHRoaXMuTiA9IHMsIFxuICAgICAgICAvKipcbiAgICAgICAgICogTWFwcyBhIHRhcmdldElEIHRvIGRhdGEgYWJvdXQgaXRzIHRhcmdldC5cbiAgICAgICAgICpcbiAgICAgICAgICogUE9SVElORyBOT1RFOiBXZSBhcmUgdXNpbmcgYW4gaW1tdXRhYmxlIGRhdGEgc3RydWN0dXJlIG9uIFdlYiB0byBtYWtlIHJlLXJ1bnNcbiAgICAgICAgICogb2YgYGFwcGx5UmVtb3RlRXZlbnQoKWAgaWRlbXBvdGVudC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuVW4gPSBuZXcgZG4odHQpLCBcbiAgICAgICAgLyoqIE1hcHMgYSB0YXJnZXQgdG8gaXRzIHRhcmdldElELiAqL1xuICAgICAgICAvLyBUT0RPKHd1YW5keSk6IEV2YWx1YXRlIGlmIFRhcmdldElkIGNhbiBiZSBwYXJ0IG9mIFRhcmdldC5cbiAgICAgICAgdGhpcy5xbiA9IG5ldyBLaSgodCA9PiBRdCh0KSksIEd0KSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgcmVhZCB0aW1lIG9mIHRoZSBsYXN0IGVudHJ5IHByb2Nlc3NlZCBieSBgZ2V0TmV3RG9jdW1lbnRDaGFuZ2VzKClgLlxuICAgICAgICAgKlxuICAgICAgICAgKiBQT1JUSU5HIE5PVEU6IFRoaXMgaXMgb25seSB1c2VkIGZvciBtdWx0aS10YWIgc3luY2hyb25pemF0aW9uLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5LbiA9IGl0Lm1pbigpLCB0aGlzLkluID0gdC5nZXRNdXRhdGlvblF1ZXVlKG4pLCB0aGlzLmpuID0gdC5nZXRSZW1vdGVEb2N1bWVudENhY2hlKCksIFxuICAgICAgICB0aGlzLnplID0gdC5nZXRUYXJnZXRDYWNoZSgpLCB0aGlzLlFuID0gbmV3IGlyKHRoaXMuam4sIHRoaXMuSW4sIHRoaXMucGVyc2lzdGVuY2UuZ2V0SW5kZXhNYW5hZ2VyKCkpLCBcbiAgICAgICAgdGhpcy5KZSA9IHQuZ2V0QnVuZGxlQ2FjaGUoKSwgdGhpcy5Cbi4kbih0aGlzLlFuKTtcbiAgICB9XG4gICAgY29sbGVjdEdhcmJhZ2UodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIkNvbGxlY3QgZ2FyYmFnZVwiLCBcInJlYWR3cml0ZS1wcmltYXJ5XCIsIChlID0+IHQuY29sbGVjdChlLCB0aGlzLlVuKSkpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gY3IoXG4vKiogTWFuYWdlcyBvdXIgaW4tbWVtb3J5IG9yIGR1cmFibGUgcGVyc2lzdGVuY2UuICovXG50LCBlLCBuLCBzKSB7XG4gICAgcmV0dXJuIG5ldyBhcih0LCBlLCBuLCBzKTtcbn1cblxuLyoqXG4gKiBUZWxscyB0aGUgTG9jYWxTdG9yZSB0aGF0IHRoZSBjdXJyZW50bHkgYXV0aGVudGljYXRlZCB1c2VyIGhhcyBjaGFuZ2VkLlxuICpcbiAqIEluIHJlc3BvbnNlIHRoZSBsb2NhbCBzdG9yZSBzd2l0Y2hlcyB0aGUgbXV0YXRpb24gcXVldWUgdG8gdGhlIG5ldyB1c2VyIGFuZFxuICogcmV0dXJucyBhbnkgcmVzdWx0aW5nIGRvY3VtZW50IGNoYW5nZXMuXG4gKi9cbi8vIFBPUlRJTkcgTk9URTogQW5kcm9pZCBhbmQgaU9TIG9ubHkgcmV0dXJuIHRoZSBkb2N1bWVudHMgYWZmZWN0ZWQgYnkgdGhlXG4vLyBjaGFuZ2UuXG5hc3luYyBmdW5jdGlvbiB1cih0LCBlKSB7XG4gICAgY29uc3QgbiA9IFUodCk7XG4gICAgbGV0IHMgPSBuLkluLCBpID0gbi5RbjtcbiAgICBjb25zdCByID0gYXdhaXQgbi5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIkhhbmRsZSB1c2VyIGNoYW5nZVwiLCBcInJlYWRvbmx5XCIsICh0ID0+IHtcbiAgICAgICAgLy8gU3dhcCBvdXQgdGhlIG11dGF0aW9uIHF1ZXVlLCBncmFiYmluZyB0aGUgcGVuZGluZyBtdXRhdGlvbiBiYXRjaGVzXG4gICAgICAgIC8vIGJlZm9yZSBhbmQgYWZ0ZXIuXG4gICAgICAgIGxldCByO1xuICAgICAgICByZXR1cm4gbi5Jbi5nZXRBbGxNdXRhdGlvbkJhdGNoZXModCkubmV4dCgobyA9PiAociA9IG8sIHMgPSBuLnBlcnNpc3RlbmNlLmdldE11dGF0aW9uUXVldWUoZSksIFxuICAgICAgICAvLyBSZWNyZWF0ZSBvdXIgTG9jYWxEb2N1bWVudHNWaWV3IHVzaW5nIHRoZSBuZXdcbiAgICAgICAgLy8gTXV0YXRpb25RdWV1ZS5cbiAgICAgICAgaSA9IG5ldyBpcihuLmpuLCBzLCBuLnBlcnNpc3RlbmNlLmdldEluZGV4TWFuYWdlcigpKSwgcy5nZXRBbGxNdXRhdGlvbkJhdGNoZXModCkpKSkubmV4dCgoZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuID0gW10sIHMgPSBbXTtcbiAgICAgICAgICAgIC8vIFVuaW9uIHRoZSBvbGQvbmV3IGNoYW5nZWQga2V5cy5cbiAgICAgICAgICAgIGxldCBvID0gUG4oKTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiByKSB7XG4gICAgICAgICAgICAgICAgbi5wdXNoKHQuYmF0Y2hJZCk7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHQubXV0YXRpb25zKSBvID0gby5hZGQoZS5rZXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIGUpIHtcbiAgICAgICAgICAgICAgICBzLnB1c2godC5iYXRjaElkKTtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdC5tdXRhdGlvbnMpIG8gPSBvLmFkZChlLmtleSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBSZXR1cm4gdGhlIHNldCBvZiBhbGwgKHBvdGVudGlhbGx5KSBjaGFuZ2VkIGRvY3VtZW50cyBhbmQgdGhlIGxpc3RcbiAgICAgICAgICAgIC8vIG9mIG11dGF0aW9uIGJhdGNoIElEcyB0aGF0IHdlcmUgYWZmZWN0ZWQgYnkgY2hhbmdlLlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGkuYm4odCwgbykubmV4dCgodCA9PiAoe1xuICAgICAgICAgICAgICAgIFduOiB0LFxuICAgICAgICAgICAgICAgIHJlbW92ZWRCYXRjaElkczogbixcbiAgICAgICAgICAgICAgICBhZGRlZEJhdGNoSWRzOiBzXG4gICAgICAgICAgICB9KSkpO1xuICAgICAgICB9KSk7XG4gICAgfSkpO1xuICAgIHJldHVybiBuLkluID0gcywgbi5RbiA9IGksIG4uQm4uJG4obi5RbiksIHI7XG59XG5cbi8qIEFjY2VwdHMgbG9jYWxseSBnZW5lcmF0ZWQgTXV0YXRpb25zIGFuZCBjb21taXQgdGhlbSB0byBzdG9yYWdlLiAqL1xuLyoqXG4gKiBBY2tub3dsZWRnZXMgdGhlIGdpdmVuIGJhdGNoLlxuICpcbiAqIE9uIHRoZSBoYXBweSBwYXRoIHdoZW4gYSBiYXRjaCBpcyBhY2tub3dsZWRnZWQsIHRoZSBsb2NhbCBzdG9yZSB3aWxsXG4gKlxuICogICsgcmVtb3ZlIHRoZSBiYXRjaCBmcm9tIHRoZSBtdXRhdGlvbiBxdWV1ZTtcbiAqICArIGFwcGx5IHRoZSBjaGFuZ2VzIHRvIHRoZSByZW1vdGUgZG9jdW1lbnQgY2FjaGU7XG4gKiAgKyByZWNhbGN1bGF0ZSB0aGUgbGF0ZW5jeSBjb21wZW5zYXRlZCB2aWV3IGltcGxpZWQgYnkgdGhvc2UgY2hhbmdlcyAodGhlcmVcbiAqICAgIG1heSBiZSBtdXRhdGlvbnMgaW4gdGhlIHF1ZXVlIHRoYXQgYWZmZWN0IHRoZSBkb2N1bWVudHMgYnV0IGhhdmVuJ3QgYmVlblxuICogICAgYWNrbm93bGVkZ2VkIHlldCk7IGFuZFxuICogICsgZ2l2ZSB0aGUgY2hhbmdlZCBkb2N1bWVudHMgYmFjayB0aGUgc3luYyBlbmdpbmVcbiAqXG4gKiBAcmV0dXJucyBUaGUgcmVzdWx0aW5nIChtb2RpZmllZCkgZG9jdW1lbnRzLlxuICovXG5mdW5jdGlvbiBocih0LCBlKSB7XG4gICAgY29uc3QgbiA9IFUodCk7XG4gICAgcmV0dXJuIG4ucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJBY2tub3dsZWRnZSBiYXRjaFwiLCBcInJlYWR3cml0ZS1wcmltYXJ5XCIsICh0ID0+IHtcbiAgICAgICAgY29uc3QgcyA9IGUuYmF0Y2gua2V5cygpLCBpID0gbi5qbi5uZXdDaGFuZ2VCdWZmZXIoe1xuICAgICAgICAgICAgdHJhY2tSZW1vdmFsczogITBcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0LCBlLCBuLCBzKSB7XG4gICAgICAgICAgICBjb25zdCBpID0gbi5iYXRjaCwgciA9IGkua2V5cygpO1xuICAgICAgICAgICAgbGV0IG8gPSBLcy5yZXNvbHZlKCk7XG4gICAgICAgICAgICByZXR1cm4gci5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgICAgICBvID0gby5uZXh0KCgoKSA9PiBzLmdldEVudHJ5KGUsIHQpKSkubmV4dCgoZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBuLmRvY1ZlcnNpb25zLmdldCh0KTtcbiAgICAgICAgICAgICAgICAgICAgTChudWxsICE9PSByKSwgZS52ZXJzaW9uLmNvbXBhcmVUbyhyKSA8IDAgJiYgKGkuYXBwbHlUb1JlbW90ZURvY3VtZW50KGUsIG4pLCBlLmlzVmFsaWREb2N1bWVudCgpICYmIFxuICAgICAgICAgICAgICAgICAgICAvLyBXZSB1c2UgdGhlIGNvbW1pdFZlcnNpb24gYXMgdGhlIHJlYWRUaW1lIHJhdGhlciB0aGFuIHRoZVxuICAgICAgICAgICAgICAgICAgICAvLyBkb2N1bWVudCdzIHVwZGF0ZVRpbWUgc2luY2UgdGhlIHVwZGF0ZVRpbWUgaXMgbm90IGFkdmFuY2VkXG4gICAgICAgICAgICAgICAgICAgIC8vIGZvciB1cGRhdGVzIHRoYXQgZG8gbm90IG1vZGlmeSB0aGUgdW5kZXJseWluZyBkb2N1bWVudC5cbiAgICAgICAgICAgICAgICAgICAgcy5hZGRFbnRyeShlLCBuLmNvbW1pdFZlcnNpb24pKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9KSksIG8ubmV4dCgoKCkgPT4gdC5Jbi5yZW1vdmVNdXRhdGlvbkJhdGNoKGUsIGkpKSk7XG4gICAgICAgIH1cbiAgICAgICAgLyoqIFJldHVybnMgdGhlIGxvY2FsIHZpZXcgb2YgdGhlIGRvY3VtZW50cyBhZmZlY3RlZCBieSBhIG11dGF0aW9uIGJhdGNoLiAqL1xuICAgICAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLVRhYiBvbmx5LlxuICAgICAgICAobiwgdCwgZSwgaSkubmV4dCgoKCkgPT4gaS5hcHBseSh0KSkpLm5leHQoKCgpID0+IG4uSW4ucGVyZm9ybUNvbnNpc3RlbmN5Q2hlY2sodCkpKS5uZXh0KCgoKSA9PiBuLlFuLmJuKHQsIHMpKSk7XG4gICAgfSkpO1xufVxuXG4vKipcbiAqIFJlbW92ZXMgbXV0YXRpb25zIGZyb20gdGhlIE11dGF0aW9uUXVldWUgZm9yIHRoZSBzcGVjaWZpZWQgYmF0Y2g7XG4gKiBMb2NhbERvY3VtZW50cyB3aWxsIGJlIHJlY2FsY3VsYXRlZC5cbiAqXG4gKiBAcmV0dXJucyBUaGUgcmVzdWx0aW5nIG1vZGlmaWVkIGRvY3VtZW50cy5cbiAqL1xuLyoqXG4gKiBSZXR1cm5zIHRoZSBsYXN0IGNvbnNpc3RlbnQgc25hcHNob3QgcHJvY2Vzc2VkICh1c2VkIGJ5IHRoZSBSZW1vdGVTdG9yZSB0b1xuICogZGV0ZXJtaW5lIHdoZXRoZXIgdG8gYnVmZmVyIGluY29taW5nIHNuYXBzaG90cyBmcm9tIHRoZSBiYWNrZW5kKS5cbiAqL1xuZnVuY3Rpb24gbHIodCkge1xuICAgIGNvbnN0IGUgPSBVKHQpO1xuICAgIHJldHVybiBlLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiR2V0IGxhc3QgcmVtb3RlIHNuYXBzaG90IHZlcnNpb25cIiwgXCJyZWFkb25seVwiLCAodCA9PiBlLnplLmdldExhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24odCkpKTtcbn1cblxuLyoqXG4gKiBVcGRhdGVzIHRoZSBcImdyb3VuZC1zdGF0ZVwiIChyZW1vdGUpIGRvY3VtZW50cy4gV2UgYXNzdW1lIHRoYXQgdGhlIHJlbW90ZVxuICogZXZlbnQgcmVmbGVjdHMgYW55IHdyaXRlIGJhdGNoZXMgdGhhdCBoYXZlIGJlZW4gYWNrbm93bGVkZ2VkIG9yIHJlamVjdGVkXG4gKiAoaS5lLiB3ZSBkbyBub3QgcmUtYXBwbHkgbG9jYWwgbXV0YXRpb25zIHRvIHVwZGF0ZXMgZnJvbSB0aGlzIGV2ZW50KS5cbiAqXG4gKiBMb2NhbERvY3VtZW50cyBhcmUgcmUtY2FsY3VsYXRlZCBpZiB0aGVyZSBhcmUgcmVtYWluaW5nIG11dGF0aW9ucyBpbiB0aGVcbiAqIHF1ZXVlLlxuICovIGZ1bmN0aW9uIGZyKHQsIGUpIHtcbiAgICBjb25zdCBuID0gVSh0KSwgcyA9IGUuc25hcHNob3RWZXJzaW9uO1xuICAgIGxldCBpID0gbi5VbjtcbiAgICByZXR1cm4gbi5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIkFwcGx5IHJlbW90ZSBldmVudFwiLCBcInJlYWR3cml0ZS1wcmltYXJ5XCIsICh0ID0+IHtcbiAgICAgICAgY29uc3QgciA9IG4uam4ubmV3Q2hhbmdlQnVmZmVyKHtcbiAgICAgICAgICAgIHRyYWNrUmVtb3ZhbHM6ICEwXG4gICAgICAgIH0pO1xuICAgICAgICAvLyBSZXNldCBuZXdUYXJnZXREYXRhQnlUYXJnZXRNYXAgaW4gY2FzZSB0aGlzIHRyYW5zYWN0aW9uIGdldHMgcmUtcnVuLlxuICAgICAgICAgICAgICAgIGkgPSBuLlVuO1xuICAgICAgICBjb25zdCBvID0gW107XG4gICAgICAgIGUudGFyZ2V0Q2hhbmdlcy5mb3JFYWNoKCgoZSwgcikgPT4ge1xuICAgICAgICAgICAgY29uc3QgYSA9IGkuZ2V0KHIpO1xuICAgICAgICAgICAgaWYgKCFhKSByZXR1cm47XG4gICAgICAgICAgICAvLyBPbmx5IHVwZGF0ZSB0aGUgcmVtb3RlIGtleXMgaWYgdGhlIHRhcmdldCBpcyBzdGlsbCBhY3RpdmUuIFRoaXNcbiAgICAgICAgICAgIC8vIGVuc3VyZXMgdGhhdCB3ZSBjYW4gcGVyc2lzdCB0aGUgdXBkYXRlZCB0YXJnZXQgZGF0YSBhbG9uZyB3aXRoXG4gICAgICAgICAgICAvLyB0aGUgdXBkYXRlZCBhc3NpZ25tZW50LlxuICAgICAgICAgICAgICAgICAgICAgICAgby5wdXNoKG4uemUucmVtb3ZlTWF0Y2hpbmdLZXlzKHQsIGUucmVtb3ZlZERvY3VtZW50cywgcikubmV4dCgoKCkgPT4gbi56ZS5hZGRNYXRjaGluZ0tleXModCwgZS5hZGRlZERvY3VtZW50cywgcikpKSk7XG4gICAgICAgICAgICBjb25zdCBjID0gZS5yZXN1bWVUb2tlbjtcbiAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgcmVzdW1lIHRva2VuIGlmIHRoZSBjaGFuZ2UgaW5jbHVkZXMgb25lLlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGMuYXBwcm94aW1hdGVCeXRlU2l6ZSgpID4gMCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHUgPSBhLndpdGhSZXN1bWVUb2tlbihjLCBzKS53aXRoU2VxdWVuY2VOdW1iZXIodC5jdXJyZW50U2VxdWVuY2VOdW1iZXIpO1xuICAgICAgICAgICAgICAgIGkgPSBpLmluc2VydChyLCB1KSwgXG4gICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSB0YXJnZXQgZGF0YSBpZiB0aGVyZSBhcmUgdGFyZ2V0IGNoYW5nZXMgKG9yIGlmXG4gICAgICAgICAgICAgICAgLy8gc3VmZmljaWVudCB0aW1lIGhhcyBwYXNzZWQgc2luY2UgdGhlIGxhc3QgdXBkYXRlKS5cbiAgICAgICAgICAgICAgICAvKipcbiAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgbmV3VGFyZ2V0RGF0YSBzaG91bGQgYmUgcGVyc2lzdGVkIGR1cmluZyBhbiB1cGRhdGUgb2ZcbiAqIGFuIGFjdGl2ZSB0YXJnZXQuIFRhcmdldERhdGEgc2hvdWxkIGFsd2F5cyBiZSBwZXJzaXN0ZWQgd2hlbiBhIHRhcmdldCBpc1xuICogYmVpbmcgcmVsZWFzZWQgYW5kIHNob3VsZCBub3QgY2FsbCB0aGlzIGZ1bmN0aW9uLlxuICpcbiAqIFdoaWxlIHRoZSB0YXJnZXQgaXMgYWN0aXZlLCBUYXJnZXREYXRhIHVwZGF0ZXMgY2FuIGJlIG9taXR0ZWQgd2hlbiBub3RoaW5nXG4gKiBhYm91dCB0aGUgdGFyZ2V0IGhhcyBjaGFuZ2VkIGV4Y2VwdCBtZXRhZGF0YSBsaWtlIHRoZSByZXN1bWUgdG9rZW4gb3JcbiAqIHNuYXBzaG90IHZlcnNpb24uIE9jY2FzaW9uYWxseSBpdCdzIHdvcnRoIHRoZSBleHRyYSB3cml0ZSB0byBwcmV2ZW50IHRoZXNlXG4gKiB2YWx1ZXMgZnJvbSBnZXR0aW5nIHRvbyBzdGFsZSBhZnRlciBhIGNyYXNoLCBidXQgdGhpcyBkb2Vzbid0IGhhdmUgdG8gYmVcbiAqIHRvbyBmcmVxdWVudC5cbiAqL1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQWx3YXlzIHBlcnNpc3QgdGFyZ2V0IGRhdGEgaWYgd2UgZG9uJ3QgYWxyZWFkeSBoYXZlIGEgcmVzdW1lIHRva2VuLlxuICAgICAgICAgICAgICAgICAgICBpZiAoTChlLnJlc3VtZVRva2VuLmFwcHJveGltYXRlQnl0ZVNpemUoKSA+IDApLCAwID09PSB0LnJlc3VtZVRva2VuLmFwcHJveGltYXRlQnl0ZVNpemUoKSkgcmV0dXJuICEwO1xuICAgICAgICAgICAgICAgICAgICAvLyBEb24ndCBhbGxvdyByZXN1bWUgdG9rZW4gY2hhbmdlcyB0byBiZSBidWZmZXJlZCBpbmRlZmluaXRlbHkuIFRoaXNcbiAgICAgICAgICAgICAgICAgICAgLy8gYWxsb3dzIHVzIHRvIGJlIHJlYXNvbmFibHkgdXAtdG8tZGF0ZSBhZnRlciBhIGNyYXNoIGFuZCBhdm9pZHMgbmVlZGluZ1xuICAgICAgICAgICAgICAgICAgICAvLyB0byBsb29wIG92ZXIgYWxsIGFjdGl2ZSBxdWVyaWVzIG9uIHNodXRkb3duLiBFc3BlY2lhbGx5IGluIHRoZSBicm93c2VyXG4gICAgICAgICAgICAgICAgICAgIC8vIHdlIG1heSBub3QgZ2V0IHRpbWUgdG8gZG8gYW55dGhpbmcgaW50ZXJlc3Rpbmcgd2hpbGUgdGhlIGN1cnJlbnQgdGFiIGlzXG4gICAgICAgICAgICAgICAgICAgIC8vIGNsb3NpbmcuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUuc25hcHNob3RWZXJzaW9uLnRvTWljcm9zZWNvbmRzKCkgLSB0LnNuYXBzaG90VmVyc2lvbi50b01pY3Jvc2Vjb25kcygpID49IDNlOCkgcmV0dXJuICEwO1xuICAgICAgICAgICAgICAgICAgICAvLyBPdGhlcndpc2UgaWYgdGhlIG9ubHkgdGhpbmcgdGhhdCBoYXMgY2hhbmdlZCBhYm91dCBhIHRhcmdldCBpcyBpdHMgcmVzdW1lXG4gICAgICAgICAgICAgICAgICAgIC8vIHRva2VuIGl0J3Mgbm90IHdvcnRoIHBlcnNpc3RpbmcuIE5vdGUgdGhhdCB0aGUgUmVtb3RlU3RvcmUga2VlcHMgYW5cbiAgICAgICAgICAgICAgICAgICAgLy8gaW4tbWVtb3J5IHZpZXcgb2YgdGhlIGN1cnJlbnRseSBhY3RpdmUgdGFyZ2V0cyB3aGljaCBpbmNsdWRlcyB0aGUgY3VycmVudFxuICAgICAgICAgICAgICAgICAgICAvLyByZXN1bWUgdG9rZW4sIHNvIHN0cmVhbSBmYWlsdXJlIG9yIHVzZXIgY2hhbmdlcyB3aWxsIHN0aWxsIHVzZSBhblxuICAgICAgICAgICAgICAgICAgICAvLyB1cC10by1kYXRlIHJlc3VtZSB0b2tlbiByZWdhcmRsZXNzIG9mIHdoYXQgd2UgZG8gaGVyZS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbi5hZGRlZERvY3VtZW50cy5zaXplICsgbi5tb2RpZmllZERvY3VtZW50cy5zaXplICsgbi5yZW1vdmVkRG9jdW1lbnRzLnNpemUgPiAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvKipcbiAqIE5vdGlmaWVzIGxvY2FsIHN0b3JlIG9mIHRoZSBjaGFuZ2VkIHZpZXdzIHRvIGxvY2FsbHkgcGluIGRvY3VtZW50cy5cbiAqLyAoYSwgdSwgZSkgJiYgby5wdXNoKG4uemUudXBkYXRlVGFyZ2V0RGF0YSh0LCB1KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgbGV0IGEgPSBwbigpO1xuICAgICAgICAvLyBIQUNLOiBUaGUgb25seSByZWFzb24gd2UgYWxsb3cgYSBudWxsIHNuYXBzaG90IHZlcnNpb24gaXMgc28gdGhhdCB3ZVxuICAgICAgICAvLyBjYW4gc3ludGhlc2l6ZSByZW1vdGUgZXZlbnRzIHdoZW4gd2UgZ2V0IHBlcm1pc3Npb24gZGVuaWVkIGVycm9ycyB3aGlsZVxuICAgICAgICAvLyB0cnlpbmcgdG8gcmVzb2x2ZSB0aGUgc3RhdGUgb2YgYSBsb2NhbGx5IGNhY2hlZCBkb2N1bWVudCB0aGF0IGlzIGluXG4gICAgICAgIC8vIGxpbWJvLlxuICAgICAgICBpZiAoZS5kb2N1bWVudFVwZGF0ZXMuZm9yRWFjaCgoKHMsIGkpID0+IHtcbiAgICAgICAgICAgIGUucmVzb2x2ZWRMaW1ib0RvY3VtZW50cy5oYXMocykgJiYgby5wdXNoKG4ucGVyc2lzdGVuY2UucmVmZXJlbmNlRGVsZWdhdGUudXBkYXRlTGltYm9Eb2N1bWVudCh0LCBzKSk7XG4gICAgICAgIH0pKSwgXG4gICAgICAgIC8vIEVhY2ggbG9vcCBpdGVyYXRpb24gb25seSBhZmZlY3RzIGl0cyBcIm93blwiIGRvYywgc28gaXQncyBzYWZlIHRvIGdldCBhbGwgdGhlIHJlbW90ZVxuICAgICAgICAvLyBkb2N1bWVudHMgaW4gYWR2YW5jZSBpbiBhIHNpbmdsZSBjYWxsLlxuICAgICAgICBvLnB1c2goZHIodCwgciwgZS5kb2N1bWVudFVwZGF0ZXMsIHMsIHZvaWQgMCkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICBhID0gdDtcbiAgICAgICAgfSkpKSwgIXMuaXNFcXVhbChpdC5taW4oKSkpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSBuLnplLmdldExhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24odCkubmV4dCgoZSA9PiBuLnplLnNldFRhcmdldHNNZXRhZGF0YSh0LCB0LmN1cnJlbnRTZXF1ZW5jZU51bWJlciwgcykpKTtcbiAgICAgICAgICAgIG8ucHVzaChlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gS3Mud2FpdEZvcihvKS5uZXh0KCgoKSA9PiByLmFwcGx5KHQpKSkubmV4dCgoKCkgPT4gbi5Rbi52bih0LCBhKSkpLm5leHQoKCgpID0+IGEpKTtcbiAgICB9KSkudGhlbigodCA9PiAobi5VbiA9IGksIHQpKSk7XG59XG5cbi8qKlxuICogUG9wdWxhdGVzIGRvY3VtZW50IGNoYW5nZSBidWZmZXIgd2l0aCBkb2N1bWVudHMgZnJvbSBiYWNrZW5kIG9yIGEgYnVuZGxlLlxuICogUmV0dXJucyB0aGUgZG9jdW1lbnQgY2hhbmdlcyByZXN1bHRpbmcgZnJvbSBhcHBseWluZyB0aG9zZSBkb2N1bWVudHMuXG4gKlxuICogQHBhcmFtIHR4biAtIFRyYW5zYWN0aW9uIHRvIHVzZSB0byByZWFkIGV4aXN0aW5nIGRvY3VtZW50cyBmcm9tIHN0b3JhZ2UuXG4gKiBAcGFyYW0gZG9jdW1lbnRCdWZmZXIgLSBEb2N1bWVudCBidWZmZXIgdG8gY29sbGVjdCB0aGUgcmVzdWx0ZWQgY2hhbmdlcyB0byBiZVxuICogICAgICAgIGFwcGxpZWQgdG8gc3RvcmFnZS5cbiAqIEBwYXJhbSBkb2N1bWVudHMgLSBEb2N1bWVudHMgdG8gYmUgYXBwbGllZC5cbiAqIEBwYXJhbSBnbG9iYWxWZXJzaW9uIC0gQSBgU25hcHNob3RWZXJzaW9uYCByZXByZXNlbnRpbmcgdGhlIHJlYWQgdGltZSBpZiBhbGxcbiAqICAgICAgICBkb2N1bWVudHMgaGF2ZSB0aGUgc2FtZSByZWFkIHRpbWUuXG4gKiBAcGFyYW0gZG9jdW1lbnRWZXJzaW9ucyAtIEEgRG9jdW1lbnRLZXktdG8tU25hcHNob3RWZXJzaW9uIG1hcCBpZiBkb2N1bWVudHNcbiAqICAgICAgICBoYXZlIHRoZWlyIG93biByZWFkIHRpbWUuXG4gKlxuICogTm90ZTogdGhpcyBmdW5jdGlvbiB3aWxsIHVzZSBgZG9jdW1lbnRWZXJzaW9uc2AgaWYgaXQgaXMgZGVmaW5lZDtcbiAqIHdoZW4gaXQgaXMgbm90IGRlZmluZWQsIHJlc29ydHMgdG8gYGdsb2JhbFZlcnNpb25gLlxuICovIGZ1bmN0aW9uIGRyKHQsIGUsIG4sIHMsIFxuLy8gVE9ETyh3dWFuZHkpOiBXZSBjb3VsZCBhZGQgYHJlYWRUaW1lYCB0byBNYXliZURvY3VtZW50IGluc3RlYWQgdG8gcmVtb3ZlXG4vLyB0aGlzIHBhcmFtZXRlci5cbmkpIHtcbiAgICBsZXQgciA9IFBuKCk7XG4gICAgcmV0dXJuIG4uZm9yRWFjaCgodCA9PiByID0gci5hZGQodCkpKSwgZS5nZXRFbnRyaWVzKHQsIHIpLm5leHQoKHQgPT4ge1xuICAgICAgICBsZXQgciA9IHBuKCk7XG4gICAgICAgIHJldHVybiBuLmZvckVhY2goKChuLCBvKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBhID0gdC5nZXQobiksIGMgPSAobnVsbCA9PSBpID8gdm9pZCAwIDogaS5nZXQobikpIHx8IHM7XG4gICAgICAgICAgICAvLyBOb3RlOiBUaGUgb3JkZXIgb2YgdGhlIHN0ZXBzIGJlbG93IGlzIGltcG9ydGFudCwgc2luY2Ugd2Ugd2FudFxuICAgICAgICAgICAgLy8gdG8gZW5zdXJlIHRoYXQgcmVqZWN0ZWQgbGltYm8gcmVzb2x1dGlvbnMgKHdoaWNoIGZhYnJpY2F0ZVxuICAgICAgICAgICAgLy8gTm9Eb2N1bWVudHMgd2l0aCBTbmFwc2hvdFZlcnNpb24ubWluKCkpIG5ldmVyIGFkZCBkb2N1bWVudHMgdG9cbiAgICAgICAgICAgIC8vIGNhY2hlLlxuICAgICAgICAgICAgby5pc05vRG9jdW1lbnQoKSAmJiBvLnZlcnNpb24uaXNFcXVhbChpdC5taW4oKSkgPyAoXG4gICAgICAgICAgICAvLyBOb0RvY3VtZW50cyB3aXRoIFNuYXBzaG90VmVyc2lvbi5taW4oKSBhcmUgdXNlZCBpbiBtYW51ZmFjdHVyZWRcbiAgICAgICAgICAgIC8vIGV2ZW50cy4gV2UgcmVtb3ZlIHRoZXNlIGRvY3VtZW50cyBmcm9tIGNhY2hlIHNpbmNlIHdlIGxvc3RcbiAgICAgICAgICAgIC8vIGFjY2Vzcy5cbiAgICAgICAgICAgIGUucmVtb3ZlRW50cnkobiwgYyksIHIgPSByLmluc2VydChuLCBvKSkgOiAhYS5pc1ZhbGlkRG9jdW1lbnQoKSB8fCBvLnZlcnNpb24uY29tcGFyZVRvKGEudmVyc2lvbikgPiAwIHx8IDAgPT09IG8udmVyc2lvbi5jb21wYXJlVG8oYS52ZXJzaW9uKSAmJiBhLmhhc1BlbmRpbmdXcml0ZXMgPyAoZS5hZGRFbnRyeShvLCBjKSwgXG4gICAgICAgICAgICByID0gci5pbnNlcnQobiwgbykpIDogayhcIkxvY2FsU3RvcmVcIiwgXCJJZ25vcmluZyBvdXRkYXRlZCB3YXRjaCB1cGRhdGUgZm9yIFwiLCBuLCBcIi4gQ3VycmVudCB2ZXJzaW9uOlwiLCBhLnZlcnNpb24sIFwiIFdhdGNoIHZlcnNpb246XCIsIG8udmVyc2lvbik7XG4gICAgICAgIH0pKSwgcjtcbiAgICB9KSk7XG59XG5cbi8qKlxuICogR2V0cyB0aGUgbXV0YXRpb24gYmF0Y2ggYWZ0ZXIgdGhlIHBhc3NlZCBpbiBiYXRjaElkIGluIHRoZSBtdXRhdGlvbiBxdWV1ZVxuICogb3IgbnVsbCBpZiBlbXB0eS5cbiAqIEBwYXJhbSBhZnRlckJhdGNoSWQgLSBJZiBwcm92aWRlZCwgdGhlIGJhdGNoIHRvIHNlYXJjaCBhZnRlci5cbiAqIEByZXR1cm5zIFRoZSBuZXh0IG11dGF0aW9uIG9yIG51bGwgaWYgdGhlcmUgd2Fzbid0IG9uZS5cbiAqL1xuZnVuY3Rpb24gd3IodCwgZSkge1xuICAgIGNvbnN0IG4gPSBVKHQpO1xuICAgIHJldHVybiBuLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiR2V0IG5leHQgbXV0YXRpb24gYmF0Y2hcIiwgXCJyZWFkb25seVwiLCAodCA9PiAodm9pZCAwID09PSBlICYmIChlID0gLTEpLCBcbiAgICBuLkluLmdldE5leHRNdXRhdGlvbkJhdGNoQWZ0ZXJCYXRjaElkKHQsIGUpKSkpO1xufVxuXG4vKipcbiAqIFJlYWRzIHRoZSBjdXJyZW50IHZhbHVlIG9mIGEgRG9jdW1lbnQgd2l0aCBhIGdpdmVuIGtleSBvciBudWxsIGlmIG5vdFxuICogZm91bmQgLSB1c2VkIGZvciB0ZXN0aW5nLlxuICovXG4vKipcbiAqIEFzc2lnbnMgdGhlIGdpdmVuIHRhcmdldCBhbiBpbnRlcm5hbCBJRCBzbyB0aGF0IGl0cyByZXN1bHRzIGNhbiBiZSBwaW5uZWQgc29cbiAqIHRoZXkgZG9uJ3QgZ2V0IEdDJ2QuIEEgdGFyZ2V0IG11c3QgYmUgYWxsb2NhdGVkIGluIHRoZSBsb2NhbCBzdG9yZSBiZWZvcmVcbiAqIHRoZSBzdG9yZSBjYW4gYmUgdXNlZCB0byBtYW5hZ2UgaXRzIHZpZXcuXG4gKlxuICogQWxsb2NhdGluZyBhbiBhbHJlYWR5IGFsbG9jYXRlZCBgVGFyZ2V0YCB3aWxsIHJldHVybiB0aGUgZXhpc3RpbmcgYFRhcmdldERhdGFgXG4gKiBmb3IgdGhhdCBgVGFyZ2V0YC5cbiAqL1xuZnVuY3Rpb24gX3IodCwgZSkge1xuICAgIGNvbnN0IG4gPSBVKHQpO1xuICAgIHJldHVybiBuLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiQWxsb2NhdGUgdGFyZ2V0XCIsIFwicmVhZHdyaXRlXCIsICh0ID0+IHtcbiAgICAgICAgbGV0IHM7XG4gICAgICAgIHJldHVybiBuLnplLmdldFRhcmdldERhdGEodCwgZSkubmV4dCgoaSA9PiBpID8gKFxuICAgICAgICAvLyBUaGlzIHRhcmdldCBoYXMgYmVlbiBsaXN0ZW5lZCB0byBwcmV2aW91c2x5LCBzbyByZXVzZSB0aGVcbiAgICAgICAgLy8gcHJldmlvdXMgdGFyZ2V0SUQuXG4gICAgICAgIC8vIFRPRE8obWNnKTogZnJlc2hlbiBsYXN0IGFjY2Vzc2VkIGRhdGU/XG4gICAgICAgIHMgPSBpLCBLcy5yZXNvbHZlKHMpKSA6IG4uemUuYWxsb2NhdGVUYXJnZXRJZCh0KS5uZXh0KChpID0+IChzID0gbmV3IHNpKGUsIGksIDAgLyogTGlzdGVuICovICwgdC5jdXJyZW50U2VxdWVuY2VOdW1iZXIpLCBcbiAgICAgICAgbi56ZS5hZGRUYXJnZXREYXRhKHQsIHMpLm5leHQoKCgpID0+IHMpKSkpKSkpO1xuICAgIH0pKS50aGVuKCh0ID0+IHtcbiAgICAgICAgLy8gSWYgTXVsdGktVGFiIGlzIGVuYWJsZWQsIHRoZSBleGlzdGluZyB0YXJnZXQgZGF0YSBtYXkgYmUgbmV3ZXIgdGhhblxuICAgICAgICAvLyB0aGUgaW4tbWVtb3J5IGRhdGFcbiAgICAgICAgY29uc3QgcyA9IG4uVW4uZ2V0KHQudGFyZ2V0SWQpO1xuICAgICAgICByZXR1cm4gKG51bGwgPT09IHMgfHwgdC5zbmFwc2hvdFZlcnNpb24uY29tcGFyZVRvKHMuc25hcHNob3RWZXJzaW9uKSA+IDApICYmIChuLlVuID0gbi5Vbi5pbnNlcnQodC50YXJnZXRJZCwgdCksIFxuICAgICAgICBuLnFuLnNldChlLCB0LnRhcmdldElkKSksIHQ7XG4gICAgfSkpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIFRhcmdldERhdGEgYXMgc2VlbiBieSB0aGUgTG9jYWxTdG9yZSwgaW5jbHVkaW5nIHVwZGF0ZXMgdGhhdCBtYXlcbiAqIGhhdmUgbm90IHlldCBiZWVuIHBlcnNpc3RlZCB0byB0aGUgVGFyZ2V0Q2FjaGUuXG4gKi9cbi8vIFZpc2libGUgZm9yIHRlc3RpbmcuXG4vKipcbiAqIFVucGlucyBhbGwgdGhlIGRvY3VtZW50cyBhc3NvY2lhdGVkIHdpdGggdGhlIGdpdmVuIHRhcmdldC4gSWZcbiAqIGBrZWVwUGVyc2lzdGVkVGFyZ2V0RGF0YWAgaXMgc2V0IHRvIGZhbHNlIGFuZCBFYWdlciBHQyBlbmFibGVkLCB0aGUgbWV0aG9kXG4gKiBkaXJlY3RseSByZW1vdmVzIHRoZSBhc3NvY2lhdGVkIHRhcmdldCBkYXRhIGZyb20gdGhlIHRhcmdldCBjYWNoZS5cbiAqXG4gKiBSZWxlYXNpbmcgYSBub24tZXhpc3RpbmcgYFRhcmdldGAgaXMgYSBuby1vcC5cbiAqL1xuLy8gUE9SVElORyBOT1RFOiBga2VlcFBlcnNpc3RlZFRhcmdldERhdGFgIGlzIG11bHRpLXRhYiBvbmx5LlxuYXN5bmMgZnVuY3Rpb24gbXIodCwgZSwgbikge1xuICAgIGNvbnN0IHMgPSBVKHQpLCBpID0gcy5Vbi5nZXQoZSksIHIgPSBuID8gXCJyZWFkd3JpdGVcIiA6IFwicmVhZHdyaXRlLXByaW1hcnlcIjtcbiAgICB0cnkge1xuICAgICAgICBuIHx8IGF3YWl0IHMucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJSZWxlYXNlIHRhcmdldFwiLCByLCAodCA9PiBzLnBlcnNpc3RlbmNlLnJlZmVyZW5jZURlbGVnYXRlLnJlbW92ZVRhcmdldCh0LCBpKSkpO1xuICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgaWYgKCF6cyh0KSkgdGhyb3cgdDtcbiAgICAgICAgLy8gQWxsIGByZWxlYXNlVGFyZ2V0YCBkb2VzIGlzIHJlY29yZCB0aGUgZmluYWwgbWV0YWRhdGEgc3RhdGUgZm9yIHRoZVxuICAgICAgICAvLyB0YXJnZXQsIGJ1dCB3ZSd2ZSBiZWVuIHJlY29yZGluZyB0aGlzIHBlcmlvZGljYWxseSBkdXJpbmcgdGFyZ2V0XG4gICAgICAgIC8vIGFjdGl2aXR5LiBJZiB3ZSBsb3NlIHRoaXMgd3JpdGUgdGhpcyBjb3VsZCBjYXVzZSBhIHZlcnkgc2xpZ2h0XG4gICAgICAgIC8vIGRpZmZlcmVuY2UgaW4gdGhlIG9yZGVyIG9mIHRhcmdldCBkZWxldGlvbiBkdXJpbmcgR0MsIGJ1dCB3ZVxuICAgICAgICAvLyBkb24ndCBkZWZpbmUgZXhhY3QgTFJVIHNlbWFudGljcyBzbyB0aGlzIGlzIGFjY2VwdGFibGUuXG4gICAgICAgIGsoXCJMb2NhbFN0b3JlXCIsIGBGYWlsZWQgdG8gdXBkYXRlIHNlcXVlbmNlIG51bWJlcnMgZm9yIHRhcmdldCAke2V9OiAke3R9YCk7XG4gICAgfVxuICAgIHMuVW4gPSBzLlVuLnJlbW92ZShlKSwgcy5xbi5kZWxldGUoaS50YXJnZXQpO1xufVxuXG4vKipcbiAqIFJ1bnMgdGhlIHNwZWNpZmllZCBxdWVyeSBhZ2FpbnN0IHRoZSBsb2NhbCBzdG9yZSBhbmQgcmV0dXJucyB0aGUgcmVzdWx0cyxcbiAqIHBvdGVudGlhbGx5IHRha2luZyBhZHZhbnRhZ2Ugb2YgcXVlcnkgZGF0YSBmcm9tIHByZXZpb3VzIGV4ZWN1dGlvbnMgKHN1Y2hcbiAqIGFzIHRoZSBzZXQgb2YgcmVtb3RlIGtleXMpLlxuICpcbiAqIEBwYXJhbSB1c2VQcmV2aW91c1Jlc3VsdHMgLSBXaGV0aGVyIHJlc3VsdHMgZnJvbSBwcmV2aW91cyBleGVjdXRpb25zIGNhblxuICogYmUgdXNlZCB0byBvcHRpbWl6ZSB0aGlzIHF1ZXJ5IGV4ZWN1dGlvbi5cbiAqLyBmdW5jdGlvbiBncih0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9IFUodCk7XG4gICAgbGV0IGkgPSBpdC5taW4oKSwgciA9IFBuKCk7XG4gICAgcmV0dXJuIHMucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJFeGVjdXRlIHF1ZXJ5XCIsIFwicmVhZG9ubHlcIiwgKHQgPT4gZnVuY3Rpb24odCwgZSwgbikge1xuICAgICAgICBjb25zdCBzID0gVSh0KSwgaSA9IHMucW4uZ2V0KG4pO1xuICAgICAgICByZXR1cm4gdm9pZCAwICE9PSBpID8gS3MucmVzb2x2ZShzLlVuLmdldChpKSkgOiBzLnplLmdldFRhcmdldERhdGEoZSwgbik7XG4gICAgfShzLCB0LCBFZShlKSkubmV4dCgoZSA9PiB7XG4gICAgICAgIGlmIChlKSByZXR1cm4gaSA9IGUubGFzdExpbWJvRnJlZVNuYXBzaG90VmVyc2lvbiwgcy56ZS5nZXRNYXRjaGluZ0tleXNGb3JUYXJnZXRJZCh0LCBlLnRhcmdldElkKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgIHIgPSB0O1xuICAgICAgICB9KSk7XG4gICAgfSkpLm5leHQoKCgpID0+IHMuQm4uZ2V0RG9jdW1lbnRzTWF0Y2hpbmdRdWVyeSh0LCBlLCBuID8gaSA6IGl0Lm1pbigpLCBuID8gciA6IFBuKCkpKSkubmV4dCgodCA9PiAoe1xuICAgICAgICBkb2N1bWVudHM6IHQsXG4gICAgICAgIEduOiByXG4gICAgfSkpKSkpO1xufVxuXG4vLyBQT1JUSU5HIE5PVEU6IE11bHRpLVRhYiBvbmx5LlxuZnVuY3Rpb24geXIodCwgZSkge1xuICAgIGNvbnN0IG4gPSBVKHQpLCBzID0gVShuLnplKSwgaSA9IG4uVW4uZ2V0KGUpO1xuICAgIHJldHVybiBpID8gUHJvbWlzZS5yZXNvbHZlKGkudGFyZ2V0KSA6IG4ucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJHZXQgdGFyZ2V0IGRhdGFcIiwgXCJyZWFkb25seVwiLCAodCA9PiBzLkV0KHQsIGUpLm5leHQoKHQgPT4gdCA/IHQudGFyZ2V0IDogbnVsbCkpKSk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgc2V0IG9mIGRvY3VtZW50cyB0aGF0IGhhdmUgYmVlbiB1cGRhdGVkIHNpbmNlIHRoZSBsYXN0IGNhbGwuXG4gKiBJZiB0aGlzIGlzIHRoZSBmaXJzdCBjYWxsLCByZXR1cm5zIHRoZSBzZXQgb2YgY2hhbmdlcyBzaW5jZSBjbGllbnRcbiAqIGluaXRpYWxpemF0aW9uLiBGdXJ0aGVyIGludm9jYXRpb25zIHdpbGwgcmV0dXJuIGRvY3VtZW50IHRoYXQgaGF2ZSBjaGFuZ2VkXG4gKiBzaW5jZSB0aGUgcHJpb3IgY2FsbC5cbiAqL1xuLy8gUE9SVElORyBOT1RFOiBNdWx0aS1UYWIgb25seS5cbmZ1bmN0aW9uIHByKHQpIHtcbiAgICBjb25zdCBlID0gVSh0KTtcbiAgICByZXR1cm4gZS5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIkdldCBuZXcgZG9jdW1lbnQgY2hhbmdlc1wiLCBcInJlYWRvbmx5XCIsICh0ID0+IGZ1bmN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgY29uc3QgcyA9IFUodCk7XG4gICAgICAgIGxldCBpID0gcG4oKSwgciA9IGFpKG4pO1xuICAgICAgICBjb25zdCBvID0gemkoZSksIGEgPSBJREJLZXlSYW5nZS5sb3dlckJvdW5kKHIsICEwKTtcbiAgICAgICAgcmV0dXJuIG8uS3Qoe1xuICAgICAgICAgICAgaW5kZXg6IENzLnJlYWRUaW1lSW5kZXgsXG4gICAgICAgICAgICByYW5nZTogYVxuICAgICAgICB9LCAoKHQsIGUpID0+IHtcbiAgICAgICAgICAgIC8vIFVubGlrZSBgZ2V0RW50cnkoKWAgYW5kIG90aGVycywgYGdldE5ld0RvY3VtZW50Q2hhbmdlcygpYCBwYXJzZXNcbiAgICAgICAgICAgIC8vIHRoZSBkb2N1bWVudHMgZGlyZWN0bHkgc2luY2Ugd2Ugd2FudCB0byBrZWVwIHNlbnRpbmVsIGRlbGV0ZXMuXG4gICAgICAgICAgICBjb25zdCBuID0gcmkocy5OLCBlKTtcbiAgICAgICAgICAgIGkgPSBpLmluc2VydChuLmtleSwgbiksIHIgPSBlLnJlYWRUaW1lO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gKHtcbiAgICAgICAgICAgIFRuOiBpLFxuICAgICAgICAgICAgcmVhZFRpbWU6IGNpKHIpXG4gICAgICAgIH0pKSk7XG4gICAgfVxuICAgIC8qKlxuICogUmV0dXJucyB0aGUgcmVhZCB0aW1lIG9mIHRoZSBtb3N0IHJlY2VudGx5IHJlYWQgZG9jdW1lbnQgaW4gdGhlIGNhY2hlLCBvclxuICogU25hcHNob3RWZXJzaW9uLm1pbigpIGlmIG5vdCBhdmFpbGFibGUuXG4gKi9cbiAgICAvLyBQT1JUSU5HIE5PVEU6IFRoaXMgaXMgb25seSB1c2VkIGZvciBtdWx0aS10YWIgc3luY2hyb25pemF0aW9uLlxuICAgIChlLmpuLCB0LCBlLktuKSkpLnRoZW4oKCh7VG46IHQsIHJlYWRUaW1lOiBufSkgPT4gKGUuS24gPSBuLCB0KSkpO1xufVxuXG4vKipcbiAqIFJlYWRzIHRoZSBuZXdlc3QgZG9jdW1lbnQgY2hhbmdlIGZyb20gcGVyc2lzdGVuY2UgYW5kIG1vdmVzIHRoZSBpbnRlcm5hbFxuICogc3luY2hyb25pemF0aW9uIG1hcmtlciBmb3J3YXJkIHNvIHRoYXQgY2FsbHMgdG8gYGdldE5ld0RvY3VtZW50Q2hhbmdlcygpYFxuICogb25seSByZXR1cm4gY2hhbmdlcyB0aGF0IGhhcHBlbmVkIGFmdGVyIGNsaWVudCBpbml0aWFsaXphdGlvbi5cbiAqL1xuLy8gUE9SVElORyBOT1RFOiBNdWx0aS1UYWIgb25seS5cbmFzeW5jIGZ1bmN0aW9uIEVyKHQpIHtcbiAgICBjb25zdCBlID0gVSh0KTtcbiAgICByZXR1cm4gZS5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIlN5bmNocm9uaXplIGxhc3QgZG9jdW1lbnQgY2hhbmdlIHJlYWQgdGltZVwiLCBcInJlYWRvbmx5XCIsICh0ID0+IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHppKHQpO1xuICAgICAgICAvLyBJZiB0aGVyZSBhcmUgbm8gZXhpc3RpbmcgZW50cmllcywgd2UgcmV0dXJuIFNuYXBzaG90VmVyc2lvbi5taW4oKS5cbiAgICAgICAgICAgICAgICBsZXQgbiA9IGl0Lm1pbigpO1xuICAgICAgICByZXR1cm4gZS5LdCh7XG4gICAgICAgICAgICBpbmRleDogQ3MucmVhZFRpbWVJbmRleCxcbiAgICAgICAgICAgIHJldmVyc2U6ICEwXG4gICAgICAgIH0sICgodCwgZSwgcykgPT4ge1xuICAgICAgICAgICAgZS5yZWFkVGltZSAmJiAobiA9IGNpKGUucmVhZFRpbWUpKSwgcy5kb25lKCk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBuKSk7XG4gICAgfSh0KSkpLnRoZW4oKHQgPT4ge1xuICAgICAgICBlLktuID0gdDtcbiAgICB9KSk7XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyB0YXJnZXQgdXNpbmcgdGhlIGdpdmVuIGJ1bmRsZSBuYW1lLCB3aGljaCB3aWxsIGJlIHVzZWQgdG9cbiAqIGhvbGQgdGhlIGtleXMgb2YgYWxsIGRvY3VtZW50cyBmcm9tIHRoZSBidW5kbGUgaW4gcXVlcnktZG9jdW1lbnQgbWFwcGluZ3MuXG4gKiBUaGlzIGVuc3VyZXMgdGhhdCB0aGUgbG9hZGVkIGRvY3VtZW50cyBkbyBub3QgZ2V0IGdhcmJhZ2UgY29sbGVjdGVkXG4gKiByaWdodCBhd2F5LlxuICovXG4vKipcbiAqIEFwcGxpZXMgdGhlIGRvY3VtZW50cyBmcm9tIGEgYnVuZGxlIHRvIHRoZSBcImdyb3VuZC1zdGF0ZVwiIChyZW1vdGUpXG4gKiBkb2N1bWVudHMuXG4gKlxuICogTG9jYWxEb2N1bWVudHMgYXJlIHJlLWNhbGN1bGF0ZWQgaWYgdGhlcmUgYXJlIHJlbWFpbmluZyBtdXRhdGlvbnMgaW4gdGhlXG4gKiBxdWV1ZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gVHIodCwgZSwgbiwgcykge1xuICAgIGNvbnN0IGkgPSBVKHQpO1xuICAgIGxldCByID0gUG4oKSwgbyA9IHBuKCksIGEgPSBBbigpO1xuICAgIGZvciAoY29uc3QgdCBvZiBuKSB7XG4gICAgICAgIGNvbnN0IG4gPSBlLnpuKHQubWV0YWRhdGEubmFtZSk7XG4gICAgICAgIHQuZG9jdW1lbnQgJiYgKHIgPSByLmFkZChuKSksIG8gPSBvLmluc2VydChuLCBlLkhuKHQpKSwgYSA9IGEuaW5zZXJ0KG4sIGUuSm4odC5tZXRhZGF0YS5yZWFkVGltZSkpO1xuICAgIH1cbiAgICBjb25zdCBjID0gaS5qbi5uZXdDaGFuZ2VCdWZmZXIoe1xuICAgICAgICB0cmFja1JlbW92YWxzOiAhMFxuICAgIH0pLCB1ID0gYXdhaXQgX3IoaSwgZnVuY3Rpb24odCkge1xuICAgICAgICAvLyBJdCBpcyBPSyB0aGF0IHRoZSBwYXRoIHVzZWQgZm9yIHRoZSBxdWVyeSBpcyBub3QgdmFsaWQsIGJlY2F1c2UgdGhpcyB3aWxsXG4gICAgICAgIC8vIG5vdCBiZSByZWFkIGFuZCBxdWVyaWVkLlxuICAgICAgICByZXR1cm4gRWUoZGUodXQuZnJvbVN0cmluZyhgX19idW5kbGVfXy9kb2NzLyR7dH1gKSkpO1xuICAgIH0ocykpO1xuICAgIC8vIEFsbG9jYXRlcyBhIHRhcmdldCB0byBob2xkIGFsbCBkb2N1bWVudCBrZXlzIGZyb20gdGhlIGJ1bmRsZSwgc3VjaCB0aGF0XG4gICAgLy8gdGhleSB3aWxsIG5vdCBnZXQgZ2FyYmFnZSBjb2xsZWN0ZWQgcmlnaHQgYXdheS5cbiAgICAgICAgcmV0dXJuIGkucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJBcHBseSBidW5kbGUgZG9jdW1lbnRzXCIsIFwicmVhZHdyaXRlXCIsICh0ID0+IGRyKHQsIGMsIG8sIGl0Lm1pbigpLCBhKS5uZXh0KChlID0+IChjLmFwcGx5KHQpLCBcbiAgICBlKSkpLm5leHQoKGUgPT4gaS56ZS5yZW1vdmVNYXRjaGluZ0tleXNGb3JUYXJnZXRJZCh0LCB1LnRhcmdldElkKS5uZXh0KCgoKSA9PiBpLnplLmFkZE1hdGNoaW5nS2V5cyh0LCByLCB1LnRhcmdldElkKSkpLm5leHQoKCgpID0+IGkuUW4udm4odCwgZSkpKS5uZXh0KCgoKSA9PiBlKSkpKSkpO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBwcm9taXNlIG9mIGEgYm9vbGVhbiB0byBpbmRpY2F0ZSBpZiB0aGUgZ2l2ZW4gYnVuZGxlIGhhcyBhbHJlYWR5XG4gKiBiZWVuIGxvYWRlZCBhbmQgdGhlIGNyZWF0ZSB0aW1lIGlzIG5ld2VyIHRoYW4gdGhlIGN1cnJlbnQgbG9hZGluZyBidW5kbGUuXG4gKi9cbi8qKlxuICogU2F2ZXMgdGhlIGdpdmVuIGBOYW1lZFF1ZXJ5YCB0byBsb2NhbCBwZXJzaXN0ZW5jZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gSXIodCwgZSwgbiA9IFBuKCkpIHtcbiAgICAvLyBBbGxvY2F0ZSBhIHRhcmdldCBmb3IgdGhlIG5hbWVkIHF1ZXJ5IHN1Y2ggdGhhdCBpdCBjYW4gYmUgcmVzdW1lZFxuICAgIC8vIGZyb20gYXNzb2NpYXRlZCByZWFkIHRpbWUgaWYgdXNlcnMgdXNlIGl0IHRvIGxpc3Rlbi5cbiAgICAvLyBOT1RFOiB0aGlzIGFsc28gbWVhbnMgaWYgbm8gY29ycmVzcG9uZGluZyB0YXJnZXQgZXhpc3RzLCB0aGUgbmV3IHRhcmdldFxuICAgIC8vIHdpbGwgcmVtYWluIGFjdGl2ZSBhbmQgd2lsbCBub3QgZ2V0IGNvbGxlY3RlZCwgdW5sZXNzIHVzZXJzIGhhcHBlbiB0b1xuICAgIC8vIHVubGlzdGVuIHRoZSBxdWVyeSBzb21laG93LlxuICAgIGNvbnN0IHMgPSBhd2FpdCBfcih0LCBFZSh3aShlLmJ1bmRsZWRRdWVyeSkpKSwgaSA9IFUodCk7XG4gICAgcmV0dXJuIGkucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJTYXZlIG5hbWVkIHF1ZXJ5XCIsIFwicmVhZHdyaXRlXCIsICh0ID0+IHtcbiAgICAgICAgY29uc3QgciA9IEtuKGUucmVhZFRpbWUpO1xuICAgICAgICAvLyBTaW1wbHkgc2F2ZSB0aGUgcXVlcnkgaXRzZWxmIGlmIGl0IGlzIG9sZGVyIHRoYW4gd2hhdCB0aGUgU0RLIGFscmVhZHlcbiAgICAgICAgLy8gaGFzLlxuICAgICAgICAgICAgICAgIGlmIChzLnNuYXBzaG90VmVyc2lvbi5jb21wYXJlVG8ocikgPj0gMCkgcmV0dXJuIGkuSmUuc2F2ZU5hbWVkUXVlcnkodCwgZSk7XG4gICAgICAgIC8vIFVwZGF0ZSBleGlzdGluZyB0YXJnZXQgZGF0YSBiZWNhdXNlIHRoZSBxdWVyeSBmcm9tIHRoZSBidW5kbGUgaXMgbmV3ZXIuXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IHMud2l0aFJlc3VtZVRva2VuKHd0LkVNUFRZX0JZVEVfU1RSSU5HLCByKTtcbiAgICAgICAgcmV0dXJuIGkuVW4gPSBpLlVuLmluc2VydChvLnRhcmdldElkLCBvKSwgaS56ZS51cGRhdGVUYXJnZXREYXRhKHQsIG8pLm5leHQoKCgpID0+IGkuemUucmVtb3ZlTWF0Y2hpbmdLZXlzRm9yVGFyZ2V0SWQodCwgcy50YXJnZXRJZCkpKS5uZXh0KCgoKSA9PiBpLnplLmFkZE1hdGNoaW5nS2V5cyh0LCBuLCBzLnRhcmdldElkKSkpLm5leHQoKCgpID0+IGkuSmUuc2F2ZU5hbWVkUXVlcnkodCwgZSkpKTtcbiAgICB9KSk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNsYXNzIEFyIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMuTiA9IHQsIHRoaXMuWW4gPSBuZXcgTWFwLCB0aGlzLlhuID0gbmV3IE1hcDtcbiAgICB9XG4gICAgZ2V0QnVuZGxlTWV0YWRhdGEodCwgZSkge1xuICAgICAgICByZXR1cm4gS3MucmVzb2x2ZSh0aGlzLlluLmdldChlKSk7XG4gICAgfVxuICAgIHNhdmVCdW5kbGVNZXRhZGF0YSh0LCBlKSB7XG4gICAgICAgIC8qKiBEZWNvZGVzIGEgQnVuZGxlTWV0YWRhdGEgcHJvdG8gaW50byBhIEJ1bmRsZU1ldGFkYXRhIG9iamVjdC4gKi9cbiAgICAgICAgdmFyIG47XG4gICAgICAgIHJldHVybiB0aGlzLlluLnNldChlLmlkLCB7XG4gICAgICAgICAgICBpZDogKG4gPSBlKS5pZCxcbiAgICAgICAgICAgIHZlcnNpb246IG4udmVyc2lvbixcbiAgICAgICAgICAgIGNyZWF0ZVRpbWU6IEtuKG4uY3JlYXRlVGltZSlcbiAgICAgICAgfSksIEtzLnJlc29sdmUoKTtcbiAgICB9XG4gICAgZ2V0TmFtZWRRdWVyeSh0LCBlKSB7XG4gICAgICAgIHJldHVybiBLcy5yZXNvbHZlKHRoaXMuWG4uZ2V0KGUpKTtcbiAgICB9XG4gICAgc2F2ZU5hbWVkUXVlcnkodCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5Ybi5zZXQoZS5uYW1lLCBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIG5hbWU6IHQubmFtZSxcbiAgICAgICAgICAgICAgICBxdWVyeTogd2kodC5idW5kbGVkUXVlcnkpLFxuICAgICAgICAgICAgICAgIHJlYWRUaW1lOiBLbih0LnJlYWRUaW1lKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfShlKSksIEtzLnJlc29sdmUoKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEEgY29sbGVjdGlvbiBvZiByZWZlcmVuY2VzIHRvIGEgZG9jdW1lbnQgZnJvbSBzb21lIGtpbmQgb2YgbnVtYmVyZWQgZW50aXR5XG4gKiAoZWl0aGVyIGEgdGFyZ2V0IElEIG9yIGJhdGNoIElEKS4gQXMgcmVmZXJlbmNlcyBhcmUgYWRkZWQgdG8gb3IgcmVtb3ZlZCBmcm9tXG4gKiB0aGUgc2V0IGNvcnJlc3BvbmRpbmcgZXZlbnRzIGFyZSBlbWl0dGVkIHRvIGEgcmVnaXN0ZXJlZCBnYXJiYWdlIGNvbGxlY3Rvci5cbiAqXG4gKiBFYWNoIHJlZmVyZW5jZSBpcyByZXByZXNlbnRlZCBieSBhIERvY3VtZW50UmVmZXJlbmNlIG9iamVjdC4gRWFjaCBvZiB0aGVtXG4gKiBjb250YWlucyBlbm91Z2ggaW5mb3JtYXRpb24gdG8gdW5pcXVlbHkgaWRlbnRpZnkgdGhlIHJlZmVyZW5jZS4gVGhleSBhcmUgYWxsXG4gKiBzdG9yZWQgcHJpbWFyaWx5IGluIGEgc2V0IHNvcnRlZCBieSBrZXkuIEEgZG9jdW1lbnQgaXMgY29uc2lkZXJlZCBnYXJiYWdlIGlmXG4gKiB0aGVyZSdzIG5vIHJlZmVyZW5jZXMgaW4gdGhhdCBzZXQgKHRoaXMgY2FuIGJlIGVmZmljaWVudGx5IGNoZWNrZWQgdGhhbmtzIHRvXG4gKiBzb3J0aW5nIGJ5IGtleSkuXG4gKlxuICogUmVmZXJlbmNlU2V0IGFsc28ga2VlcHMgYSBzZWNvbmRhcnkgc2V0IHRoYXQgY29udGFpbnMgcmVmZXJlbmNlcyBzb3J0ZWQgYnlcbiAqIElEcy4gVGhpcyBvbmUgaXMgdXNlZCB0byBlZmZpY2llbnRseSBpbXBsZW1lbnQgcmVtb3ZhbCBvZiBhbGwgcmVmZXJlbmNlcyBieVxuICogc29tZSB0YXJnZXQgSUQuXG4gKi8gY2xhc3MgUnIge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAvLyBBIHNldCBvZiBvdXRzdGFuZGluZyByZWZlcmVuY2VzIHRvIGEgZG9jdW1lbnQgc29ydGVkIGJ5IGtleS5cbiAgICAgICAgdGhpcy5abiA9IG5ldyBtbihQci50cyksIFxuICAgICAgICAvLyBBIHNldCBvZiBvdXRzdGFuZGluZyByZWZlcmVuY2VzIHRvIGEgZG9jdW1lbnQgc29ydGVkIGJ5IHRhcmdldCBpZC5cbiAgICAgICAgdGhpcy5lcyA9IG5ldyBtbihQci5ucyk7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIHRydWUgaWYgdGhlIHJlZmVyZW5jZSBzZXQgY29udGFpbnMgbm8gcmVmZXJlbmNlcy4gKi8gICAgaXNFbXB0eSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuWm4uaXNFbXB0eSgpO1xuICAgIH1cbiAgICAvKiogQWRkcyBhIHJlZmVyZW5jZSB0byB0aGUgZ2l2ZW4gZG9jdW1lbnQga2V5IGZvciB0aGUgZ2l2ZW4gSUQuICovICAgIGFkZFJlZmVyZW5jZSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBuZXcgUHIodCwgZSk7XG4gICAgICAgIHRoaXMuWm4gPSB0aGlzLlpuLmFkZChuKSwgdGhpcy5lcyA9IHRoaXMuZXMuYWRkKG4pO1xuICAgIH1cbiAgICAvKiogQWRkIHJlZmVyZW5jZXMgdG8gdGhlIGdpdmVuIGRvY3VtZW50IGtleXMgZm9yIHRoZSBnaXZlbiBJRC4gKi8gICAgc3ModCwgZSkge1xuICAgICAgICB0LmZvckVhY2goKHQgPT4gdGhpcy5hZGRSZWZlcmVuY2UodCwgZSkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyBhIHJlZmVyZW5jZSB0byB0aGUgZ2l2ZW4gZG9jdW1lbnQga2V5IGZvciB0aGUgZ2l2ZW5cbiAgICAgKiBJRC5cbiAgICAgKi8gICAgcmVtb3ZlUmVmZXJlbmNlKHQsIGUpIHtcbiAgICAgICAgdGhpcy5ycyhuZXcgUHIodCwgZSkpO1xuICAgIH1cbiAgICBvcyh0LCBlKSB7XG4gICAgICAgIHQuZm9yRWFjaCgodCA9PiB0aGlzLnJlbW92ZVJlZmVyZW5jZSh0LCBlKSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDbGVhcnMgYWxsIHJlZmVyZW5jZXMgd2l0aCBhIGdpdmVuIElELiBDYWxscyByZW1vdmVSZWYoKSBmb3IgZWFjaCBrZXlcbiAgICAgKiByZW1vdmVkLlxuICAgICAqLyAgICBjcyh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBuZXcgUHQobmV3IHV0KFtdKSksIG4gPSBuZXcgUHIoZSwgdCksIHMgPSBuZXcgUHIoZSwgdCArIDEpLCBpID0gW107XG4gICAgICAgIHJldHVybiB0aGlzLmVzLmZvckVhY2hJblJhbmdlKFsgbiwgcyBdLCAodCA9PiB7XG4gICAgICAgICAgICB0aGlzLnJzKHQpLCBpLnB1c2godC5rZXkpO1xuICAgICAgICB9KSksIGk7XG4gICAgfVxuICAgIHVzKCkge1xuICAgICAgICB0aGlzLlpuLmZvckVhY2goKHQgPT4gdGhpcy5ycyh0KSkpO1xuICAgIH1cbiAgICBycyh0KSB7XG4gICAgICAgIHRoaXMuWm4gPSB0aGlzLlpuLmRlbGV0ZSh0KSwgdGhpcy5lcyA9IHRoaXMuZXMuZGVsZXRlKHQpO1xuICAgIH1cbiAgICBocyh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBuZXcgUHQobmV3IHV0KFtdKSksIG4gPSBuZXcgUHIoZSwgdCksIHMgPSBuZXcgUHIoZSwgdCArIDEpO1xuICAgICAgICBsZXQgaSA9IFBuKCk7XG4gICAgICAgIHJldHVybiB0aGlzLmVzLmZvckVhY2hJblJhbmdlKFsgbiwgcyBdLCAodCA9PiB7XG4gICAgICAgICAgICBpID0gaS5hZGQodC5rZXkpO1xuICAgICAgICB9KSksIGk7XG4gICAgfVxuICAgIGNvbnRhaW5zS2V5KHQpIHtcbiAgICAgICAgY29uc3QgZSA9IG5ldyBQcih0LCAwKSwgbiA9IHRoaXMuWm4uZmlyc3RBZnRlck9yRXF1YWwoZSk7XG4gICAgICAgIHJldHVybiBudWxsICE9PSBuICYmIHQuaXNFcXVhbChuLmtleSk7XG4gICAgfVxufVxuXG5jbGFzcyBQciB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLmtleSA9IHQsIHRoaXMubHMgPSBlO1xuICAgIH1cbiAgICAvKiogQ29tcGFyZSBieSBrZXkgdGhlbiBieSBJRCAqLyAgICBzdGF0aWMgdHModCwgZSkge1xuICAgICAgICByZXR1cm4gUHQuY29tcGFyYXRvcih0LmtleSwgZS5rZXkpIHx8IHR0KHQubHMsIGUubHMpO1xuICAgIH1cbiAgICAvKiogQ29tcGFyZSBieSBJRCB0aGVuIGJ5IGtleSAqLyAgICBzdGF0aWMgbnModCwgZSkge1xuICAgICAgICByZXR1cm4gdHQodC5scywgZS5scykgfHwgUHQuY29tcGFyYXRvcih0LmtleSwgZS5rZXkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY2xhc3MgYnIge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5IdCA9IHQsIHRoaXMucmVmZXJlbmNlRGVsZWdhdGUgPSBlLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBzZXQgb2YgYWxsIG11dGF0aW9ucyB0aGF0IGhhdmUgYmVlbiBzZW50IGJ1dCBub3QgeWV0IGJlZW4gYXBwbGllZCB0b1xuICAgICAgICAgKiB0aGUgYmFja2VuZC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuSW4gPSBbXSwgXG4gICAgICAgIC8qKiBOZXh0IHZhbHVlIHRvIHVzZSB3aGVuIGFzc2lnbmluZyBzZXF1ZW50aWFsIElEcyB0byBlYWNoIG11dGF0aW9uIGJhdGNoLiAqL1xuICAgICAgICB0aGlzLmZzID0gMSwgXG4gICAgICAgIC8qKiBBbiBvcmRlcmVkIG1hcHBpbmcgYmV0d2VlbiBkb2N1bWVudHMgYW5kIHRoZSBtdXRhdGlvbnMgYmF0Y2ggSURzLiAqL1xuICAgICAgICB0aGlzLmRzID0gbmV3IG1uKFByLnRzKTtcbiAgICB9XG4gICAgY2hlY2tFbXB0eSh0KSB7XG4gICAgICAgIHJldHVybiBLcy5yZXNvbHZlKDAgPT09IHRoaXMuSW4ubGVuZ3RoKTtcbiAgICB9XG4gICAgYWRkTXV0YXRpb25CYXRjaCh0LCBlLCBuLCBzKSB7XG4gICAgICAgIGNvbnN0IGkgPSB0aGlzLmZzO1xuICAgICAgICB0aGlzLmZzKyssIHRoaXMuSW4ubGVuZ3RoID4gMCAmJiB0aGlzLkluW3RoaXMuSW4ubGVuZ3RoIC0gMV07XG4gICAgICAgIGNvbnN0IHIgPSBuZXcgZWkoaSwgZSwgbiwgcyk7XG4gICAgICAgIHRoaXMuSW4ucHVzaChyKTtcbiAgICAgICAgLy8gVHJhY2sgcmVmZXJlbmNlcyBieSBkb2N1bWVudCBrZXkgYW5kIGluZGV4IGNvbGxlY3Rpb24gcGFyZW50cy5cbiAgICAgICAgZm9yIChjb25zdCBlIG9mIHMpIHRoaXMuZHMgPSB0aGlzLmRzLmFkZChuZXcgUHIoZS5rZXksIGkpKSwgdGhpcy5IdC5hZGRUb0NvbGxlY3Rpb25QYXJlbnRJbmRleCh0LCBlLmtleS5wYXRoLnBvcExhc3QoKSk7XG4gICAgICAgIHJldHVybiBLcy5yZXNvbHZlKHIpO1xuICAgIH1cbiAgICBsb29rdXBNdXRhdGlvbkJhdGNoKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIEtzLnJlc29sdmUodGhpcy53cyhlKSk7XG4gICAgfVxuICAgIGdldE5leHRNdXRhdGlvbkJhdGNoQWZ0ZXJCYXRjaElkKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IGUgKyAxLCBzID0gdGhpcy5fcyhuKSwgaSA9IHMgPCAwID8gMCA6IHM7XG4gICAgICAgIC8vIFRoZSByZXF1ZXN0ZWQgYmF0Y2hJZCBtYXkgc3RpbGwgYmUgb3V0IG9mIHJhbmdlIHNvIG5vcm1hbGl6ZSBpdCB0byB0aGVcbiAgICAgICAgLy8gc3RhcnQgb2YgdGhlIHF1ZXVlLlxuICAgICAgICAgICAgICAgIHJldHVybiBLcy5yZXNvbHZlKHRoaXMuSW4ubGVuZ3RoID4gaSA/IHRoaXMuSW5baV0gOiBudWxsKTtcbiAgICB9XG4gICAgZ2V0SGlnaGVzdFVuYWNrbm93bGVkZ2VkQmF0Y2hJZCgpIHtcbiAgICAgICAgcmV0dXJuIEtzLnJlc29sdmUoMCA9PT0gdGhpcy5Jbi5sZW5ndGggPyAtMSA6IHRoaXMuZnMgLSAxKTtcbiAgICB9XG4gICAgZ2V0QWxsTXV0YXRpb25CYXRjaGVzKHQpIHtcbiAgICAgICAgcmV0dXJuIEtzLnJlc29sdmUodGhpcy5Jbi5zbGljZSgpKTtcbiAgICB9XG4gICAgZ2V0QWxsTXV0YXRpb25CYXRjaGVzQWZmZWN0aW5nRG9jdW1lbnRLZXkodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gbmV3IFByKGUsIDApLCBzID0gbmV3IFByKGUsIE51bWJlci5QT1NJVElWRV9JTkZJTklUWSksIGkgPSBbXTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZHMuZm9yRWFjaEluUmFuZ2UoWyBuLCBzIF0sICh0ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLndzKHQubHMpO1xuICAgICAgICAgICAgaS5wdXNoKGUpO1xuICAgICAgICB9KSksIEtzLnJlc29sdmUoaSk7XG4gICAgfVxuICAgIGdldEFsbE11dGF0aW9uQmF0Y2hlc0FmZmVjdGluZ0RvY3VtZW50S2V5cyh0LCBlKSB7XG4gICAgICAgIGxldCBuID0gbmV3IG1uKHR0KTtcbiAgICAgICAgcmV0dXJuIGUuZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICBjb25zdCBlID0gbmV3IFByKHQsIDApLCBzID0gbmV3IFByKHQsIE51bWJlci5QT1NJVElWRV9JTkZJTklUWSk7XG4gICAgICAgICAgICB0aGlzLmRzLmZvckVhY2hJblJhbmdlKFsgZSwgcyBdLCAodCA9PiB7XG4gICAgICAgICAgICAgICAgbiA9IG4uYWRkKHQubHMpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9KSksIEtzLnJlc29sdmUodGhpcy5ncyhuKSk7XG4gICAgfVxuICAgIGdldEFsbE11dGF0aW9uQmF0Y2hlc0FmZmVjdGluZ1F1ZXJ5KHQsIGUpIHtcbiAgICAgICAgLy8gVXNlIHRoZSBxdWVyeSBwYXRoIGFzIGEgcHJlZml4IGZvciB0ZXN0aW5nIGlmIGEgZG9jdW1lbnQgbWF0Y2hlcyB0aGVcbiAgICAgICAgLy8gcXVlcnkuXG4gICAgICAgIGNvbnN0IG4gPSBlLnBhdGgsIHMgPSBuLmxlbmd0aCArIDE7XG4gICAgICAgIC8vIENvbnN0cnVjdCBhIGRvY3VtZW50IHJlZmVyZW5jZSBmb3IgYWN0dWFsbHkgc2Nhbm5pbmcgdGhlIGluZGV4LiBVbmxpa2VcbiAgICAgICAgLy8gdGhlIHByZWZpeCB0aGUgZG9jdW1lbnQga2V5IGluIHRoaXMgcmVmZXJlbmNlIG11c3QgaGF2ZSBhbiBldmVuIG51bWJlciBvZlxuICAgICAgICAvLyBzZWdtZW50cy4gVGhlIGVtcHR5IHNlZ21lbnQgY2FuIGJlIHVzZWQgYSBzdWZmaXggb2YgdGhlIHF1ZXJ5IHBhdGhcbiAgICAgICAgLy8gYmVjYXVzZSBpdCBwcmVjZWRlcyBhbGwgb3RoZXIgc2VnbWVudHMgaW4gYW4gb3JkZXJlZCB0cmF2ZXJzYWwuXG4gICAgICAgIGxldCBpID0gbjtcbiAgICAgICAgUHQuaXNEb2N1bWVudEtleShpKSB8fCAoaSA9IGkuY2hpbGQoXCJcIikpO1xuICAgICAgICBjb25zdCByID0gbmV3IFByKG5ldyBQdChpKSwgMCk7XG4gICAgICAgIC8vIEZpbmQgdW5pcXVlIGJhdGNoSURzIHJlZmVyZW5jZWQgYnkgYWxsIGRvY3VtZW50cyBwb3RlbnRpYWxseSBtYXRjaGluZyB0aGVcbiAgICAgICAgLy8gcXVlcnkuXG4gICAgICAgICAgICAgICAgbGV0IG8gPSBuZXcgbW4odHQpO1xuICAgICAgICByZXR1cm4gdGhpcy5kcy5mb3JFYWNoV2hpbGUoKHQgPT4ge1xuICAgICAgICAgICAgY29uc3QgZSA9IHQua2V5LnBhdGg7XG4gICAgICAgICAgICByZXR1cm4gISFuLmlzUHJlZml4T2YoZSkgJiYgKFxuICAgICAgICAgICAgLy8gUm93cyB3aXRoIGRvY3VtZW50IGtleXMgbW9yZSB0aGFuIG9uZSBzZWdtZW50IGxvbmdlciB0aGFuIHRoZSBxdWVyeVxuICAgICAgICAgICAgLy8gcGF0aCBjYW4ndCBiZSBtYXRjaGVzLiBGb3IgZXhhbXBsZSwgYSBxdWVyeSBvbiAncm9vbXMnIGNhbid0IG1hdGNoXG4gICAgICAgICAgICAvLyB0aGUgZG9jdW1lbnQgL3Jvb21zL2FiYy9tZXNzYWdlcy94eXguXG4gICAgICAgICAgICAvLyBUT0RPKG1jZyk6IHdlJ2xsIG5lZWQgYSBkaWZmZXJlbnQgc2Nhbm5lciB3aGVuIHdlIGltcGxlbWVudFxuICAgICAgICAgICAgLy8gYW5jZXN0b3IgcXVlcmllcy5cbiAgICAgICAgICAgIGUubGVuZ3RoID09PSBzICYmIChvID0gby5hZGQodC5scykpLCAhMCk7XG4gICAgICAgIH0pLCByKSwgS3MucmVzb2x2ZSh0aGlzLmdzKG8pKTtcbiAgICB9XG4gICAgZ3ModCkge1xuICAgICAgICAvLyBDb25zdHJ1Y3QgYW4gYXJyYXkgb2YgbWF0Y2hpbmcgYmF0Y2hlcywgc29ydGVkIGJ5IGJhdGNoSUQgdG8gZW5zdXJlIHRoYXRcbiAgICAgICAgLy8gbXVsdGlwbGUgbXV0YXRpb25zIGFmZmVjdGluZyB0aGUgc2FtZSBkb2N1bWVudCBrZXkgYXJlIGFwcGxpZWQgaW4gb3JkZXIuXG4gICAgICAgIGNvbnN0IGUgPSBbXTtcbiAgICAgICAgcmV0dXJuIHQuZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICBjb25zdCBuID0gdGhpcy53cyh0KTtcbiAgICAgICAgICAgIG51bGwgIT09IG4gJiYgZS5wdXNoKG4pO1xuICAgICAgICB9KSksIGU7XG4gICAgfVxuICAgIHJlbW92ZU11dGF0aW9uQmF0Y2godCwgZSkge1xuICAgICAgICBMKDAgPT09IHRoaXMueXMoZS5iYXRjaElkLCBcInJlbW92ZWRcIikpLCB0aGlzLkluLnNoaWZ0KCk7XG4gICAgICAgIGxldCBuID0gdGhpcy5kcztcbiAgICAgICAgcmV0dXJuIEtzLmZvckVhY2goZS5tdXRhdGlvbnMsIChzID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGkgPSBuZXcgUHIocy5rZXksIGUuYmF0Y2hJZCk7XG4gICAgICAgICAgICByZXR1cm4gbiA9IG4uZGVsZXRlKGkpLCB0aGlzLnJlZmVyZW5jZURlbGVnYXRlLm1hcmtQb3RlbnRpYWxseU9ycGhhbmVkKHQsIHMua2V5KTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZHMgPSBuO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRlKHQpIHtcbiAgICAgICAgLy8gTm8tb3Agc2luY2UgdGhlIG1lbW9yeSBtdXRhdGlvbiBxdWV1ZSBkb2VzIG5vdCBtYWludGFpbiBhIHNlcGFyYXRlIGNhY2hlLlxuICAgIH1cbiAgICBjb250YWluc0tleSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBuZXcgUHIoZSwgMCksIHMgPSB0aGlzLmRzLmZpcnN0QWZ0ZXJPckVxdWFsKG4pO1xuICAgICAgICByZXR1cm4gS3MucmVzb2x2ZShlLmlzRXF1YWwocyAmJiBzLmtleSkpO1xuICAgIH1cbiAgICBwZXJmb3JtQ29uc2lzdGVuY3lDaGVjayh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLkluLmxlbmd0aCwgS3MucmVzb2x2ZSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBGaW5kcyB0aGUgaW5kZXggb2YgdGhlIGdpdmVuIGJhdGNoSWQgaW4gdGhlIG11dGF0aW9uIHF1ZXVlIGFuZCBhc3NlcnRzIHRoYXRcbiAgICAgKiB0aGUgcmVzdWx0aW5nIGluZGV4IGlzIHdpdGhpbiB0aGUgYm91bmRzIG9mIHRoZSBxdWV1ZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBiYXRjaElkIC0gVGhlIGJhdGNoSWQgdG8gc2VhcmNoIGZvclxuICAgICAqIEBwYXJhbSBhY3Rpb24gLSBBIGRlc2NyaXB0aW9uIG9mIHdoYXQgdGhlIGNhbGxlciBpcyBkb2luZywgcGhyYXNlZCBpbiBwYXNzaXZlXG4gICAgICogZm9ybSAoZS5nLiBcImFja25vd2xlZGdlZFwiIGluIGEgcm91dGluZSB0aGF0IGFja25vd2xlZGdlcyBiYXRjaGVzKS5cbiAgICAgKi8gICAgeXModCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcyh0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRmluZHMgdGhlIGluZGV4IG9mIHRoZSBnaXZlbiBiYXRjaElkIGluIHRoZSBtdXRhdGlvbiBxdWV1ZS4gVGhpcyBvcGVyYXRpb25cbiAgICAgKiBpcyBPKDEpLlxuICAgICAqXG4gICAgICogQHJldHVybnMgVGhlIGNvbXB1dGVkIGluZGV4IG9mIHRoZSBiYXRjaCB3aXRoIHRoZSBnaXZlbiBiYXRjaElkLCBiYXNlZCBvblxuICAgICAqIHRoZSBzdGF0ZSBvZiB0aGUgcXVldWUuIE5vdGUgdGhpcyBpbmRleCBjYW4gYmUgbmVnYXRpdmUgaWYgdGhlIHJlcXVlc3RlZFxuICAgICAqIGJhdGNoSWQgaGFzIGFscmVhZHkgYmVlbiByZW12b2VkIGZyb20gdGhlIHF1ZXVlIG9yIHBhc3QgdGhlIGVuZCBvZiB0aGVcbiAgICAgKiBxdWV1ZSBpZiB0aGUgYmF0Y2hJZCBpcyBsYXJnZXIgdGhhbiB0aGUgbGFzdCBhZGRlZCBiYXRjaC5cbiAgICAgKi8gICAgX3ModCkge1xuICAgICAgICBpZiAoMCA9PT0gdGhpcy5Jbi5sZW5ndGgpIFxuICAgICAgICAvLyBBcyBhbiBpbmRleCB0aGlzIGlzIHBhc3QgdGhlIGVuZCBvZiB0aGUgcXVldWVcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIC8vIEV4YW1pbmUgdGhlIGZyb250IG9mIHRoZSBxdWV1ZSB0byBmaWd1cmUgb3V0IHRoZSBkaWZmZXJlbmNlIGJldHdlZW4gdGhlXG4gICAgICAgIC8vIGJhdGNoSWQgYW5kIGluZGV4ZXMgaW4gdGhlIGFycmF5LiBOb3RlIHRoYXQgc2luY2UgdGhlIHF1ZXVlIGlzIG9yZGVyZWRcbiAgICAgICAgLy8gYnkgYmF0Y2hJZCwgaWYgdGhlIGZpcnN0IGJhdGNoIGhhcyBhIGxhcmdlciBiYXRjaElkIHRoZW4gdGhlIHJlcXVlc3RlZFxuICAgICAgICAvLyBiYXRjaElkIGRvZXNuJ3QgZXhpc3QgaW4gdGhlIHF1ZXVlLlxuICAgICAgICAgICAgICAgIHJldHVybiB0IC0gdGhpcy5JblswXS5iYXRjaElkO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBIHZlcnNpb24gb2YgbG9va3VwTXV0YXRpb25CYXRjaCB0aGF0IGRvZXNuJ3QgcmV0dXJuIGEgcHJvbWlzZSwgdGhpcyBtYWtlc1xuICAgICAqIG90aGVyIGZ1bmN0aW9ucyB0aGF0IHVzZXMgdGhpcyBjb2RlIGVhc2llciB0byByZWFkIGFuZCBtb3JlIGVmZmljZW50LlxuICAgICAqLyAgICB3cyh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLl9zKHQpO1xuICAgICAgICBpZiAoZSA8IDAgfHwgZSA+PSB0aGlzLkluLmxlbmd0aCkgcmV0dXJuIG51bGw7XG4gICAgICAgIHJldHVybiB0aGlzLkluW2VdO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogVGhlIG1lbW9yeS1vbmx5IFJlbW90ZURvY3VtZW50Q2FjaGUgZm9yIEluZGV4ZWREYi4gVG8gY29uc3RydWN0LCBpbnZva2VcbiAqIGBuZXdNZW1vcnlSZW1vdGVEb2N1bWVudENhY2hlKClgLlxuICovXG5jbGFzcyB2ciB7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHNpemVyIC0gVXNlZCB0byBhc3Nlc3MgdGhlIHNpemUgb2YgYSBkb2N1bWVudC4gRm9yIGVhZ2VyIEdDLCB0aGlzIGlzXG4gICAgICogZXhwZWN0ZWQgdG8ganVzdCByZXR1cm4gMCB0byBhdm9pZCB1bm5lY2Vzc2FyaWx5IGRvaW5nIHRoZSB3b3JrIG9mXG4gICAgICogY2FsY3VsYXRpbmcgdGhlIHNpemUuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLkh0ID0gdCwgdGhpcy5wcyA9IGUsIFxuICAgICAgICAvKiogVW5kZXJseWluZyBjYWNoZSBvZiBkb2N1bWVudHMgYW5kIHRoZWlyIHJlYWQgdGltZXMuICovXG4gICAgICAgIHRoaXMuZG9jcyA9IG5ldyBkbihQdC5jb21wYXJhdG9yKSwgXG4gICAgICAgIC8qKiBTaXplIG9mIGFsbCBjYWNoZWQgZG9jdW1lbnRzLiAqL1xuICAgICAgICB0aGlzLnNpemUgPSAwO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGRzIHRoZSBzdXBwbGllZCBlbnRyeSB0byB0aGUgY2FjaGUgYW5kIHVwZGF0ZXMgdGhlIGNhY2hlIHNpemUgYXMgYXBwcm9wcmlhdGUuXG4gICAgICpcbiAgICAgKiBBbGwgY2FsbHMgb2YgYGFkZEVudHJ5YCAgYXJlIHJlcXVpcmVkIHRvIGdvIHRocm91Z2ggdGhlIFJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyXG4gICAgICogcmV0dXJuZWQgYnkgYG5ld0NoYW5nZUJ1ZmZlcigpYC5cbiAgICAgKi8gICAgYWRkRW50cnkodCwgZSwgbikge1xuICAgICAgICBjb25zdCBzID0gZS5rZXksIGkgPSB0aGlzLmRvY3MuZ2V0KHMpLCByID0gaSA/IGkuc2l6ZSA6IDAsIG8gPSB0aGlzLnBzKGUpO1xuICAgICAgICByZXR1cm4gdGhpcy5kb2NzID0gdGhpcy5kb2NzLmluc2VydChzLCB7XG4gICAgICAgICAgICBkb2N1bWVudDogZS5jbG9uZSgpLFxuICAgICAgICAgICAgc2l6ZTogbyxcbiAgICAgICAgICAgIHJlYWRUaW1lOiBuXG4gICAgICAgIH0pLCB0aGlzLnNpemUgKz0gbyAtIHIsIHRoaXMuSHQuYWRkVG9Db2xsZWN0aW9uUGFyZW50SW5kZXgodCwgcy5wYXRoLnBvcExhc3QoKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgdGhlIHNwZWNpZmllZCBlbnRyeSBmcm9tIHRoZSBjYWNoZSBhbmQgdXBkYXRlcyB0aGUgY2FjaGUgc2l6ZSBhcyBhcHByb3ByaWF0ZS5cbiAgICAgKlxuICAgICAqIEFsbCBjYWxscyBvZiBgcmVtb3ZlRW50cnlgIGFyZSByZXF1aXJlZCB0byBnbyB0aHJvdWdoIHRoZSBSZW1vdGVEb2N1bWVudENoYW5nZUJ1ZmZlclxuICAgICAqIHJldHVybmVkIGJ5IGBuZXdDaGFuZ2VCdWZmZXIoKWAuXG4gICAgICovICAgIHJlbW92ZUVudHJ5KHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuZG9jcy5nZXQodCk7XG4gICAgICAgIGUgJiYgKHRoaXMuZG9jcyA9IHRoaXMuZG9jcy5yZW1vdmUodCksIHRoaXMuc2l6ZSAtPSBlLnNpemUpO1xuICAgIH1cbiAgICBnZXRFbnRyeSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSB0aGlzLmRvY3MuZ2V0KGUpO1xuICAgICAgICByZXR1cm4gS3MucmVzb2x2ZShuID8gbi5kb2N1bWVudC5jbG9uZSgpIDogcXQubmV3SW52YWxpZERvY3VtZW50KGUpKTtcbiAgICB9XG4gICAgZ2V0RW50cmllcyh0LCBlKSB7XG4gICAgICAgIGxldCBuID0gcG4oKTtcbiAgICAgICAgcmV0dXJuIGUuZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICBjb25zdCBlID0gdGhpcy5kb2NzLmdldCh0KTtcbiAgICAgICAgICAgIG4gPSBuLmluc2VydCh0LCBlID8gZS5kb2N1bWVudC5jbG9uZSgpIDogcXQubmV3SW52YWxpZERvY3VtZW50KHQpKTtcbiAgICAgICAgfSkpLCBLcy5yZXNvbHZlKG4pO1xuICAgIH1cbiAgICBnZXREb2N1bWVudHNNYXRjaGluZ1F1ZXJ5KHQsIGUsIG4pIHtcbiAgICAgICAgbGV0IHMgPSBwbigpO1xuICAgICAgICAvLyBEb2N1bWVudHMgYXJlIG9yZGVyZWQgYnkga2V5LCBzbyB3ZSBjYW4gdXNlIGEgcHJlZml4IHNjYW4gdG8gbmFycm93IGRvd25cbiAgICAgICAgLy8gdGhlIGRvY3VtZW50cyB3ZSBuZWVkIHRvIG1hdGNoIHRoZSBxdWVyeSBhZ2FpbnN0LlxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBuZXcgUHQoZS5wYXRoLmNoaWxkKFwiXCIpKSwgciA9IHRoaXMuZG9jcy5nZXRJdGVyYXRvckZyb20oaSk7XG4gICAgICAgIGZvciAoO3IuaGFzTmV4dCgpOyApIHtcbiAgICAgICAgICAgIGNvbnN0IHtrZXk6IHQsIHZhbHVlOiB7ZG9jdW1lbnQ6IGksIHJlYWRUaW1lOiBvfX0gPSByLmdldE5leHQoKTtcbiAgICAgICAgICAgIGlmICghZS5wYXRoLmlzUHJlZml4T2YodC5wYXRoKSkgYnJlYWs7XG4gICAgICAgICAgICBvLmNvbXBhcmVUbyhuKSA8PSAwIHx8IFBlKGUsIGkpICYmIChzID0gcy5pbnNlcnQoaS5rZXksIGkuY2xvbmUoKSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBLcy5yZXNvbHZlKHMpO1xuICAgIH1cbiAgICBFcyh0LCBlKSB7XG4gICAgICAgIHJldHVybiBLcy5mb3JFYWNoKHRoaXMuZG9jcywgKHQgPT4gZSh0KSkpO1xuICAgIH1cbiAgICBuZXdDaGFuZ2VCdWZmZXIodCkge1xuICAgICAgICAvLyBgdHJhY2tSZW1vdmFsc2AgaXMgaWdub3JlcyBzaW5jZSB0aGUgTWVtb3J5UmVtb3RlRG9jdW1lbnRDYWNoZSBrZWVwc1xuICAgICAgICAvLyBhIHNlcGFyYXRlIGNoYW5nZWxvZyBhbmQgZG9lcyBub3QgbmVlZCBzcGVjaWFsIGhhbmRsaW5nIGZvciByZW1vdmFscy5cbiAgICAgICAgcmV0dXJuIG5ldyBWcih0aGlzKTtcbiAgICB9XG4gICAgZ2V0U2l6ZSh0KSB7XG4gICAgICAgIHJldHVybiBLcy5yZXNvbHZlKHRoaXMuc2l6ZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgbWVtb3J5LW9ubHkgUmVtb3RlRG9jdW1lbnRDYWNoZS5cbiAqXG4gKiBAcGFyYW0gaW5kZXhNYW5hZ2VyIC0gQSBjbGFzcyB0aGF0IG1hbmFnZXMgY29sbGVjdGlvbiBncm91cCBpbmRpY2VzLlxuICogQHBhcmFtIHNpemVyIC0gVXNlZCB0byBhc3Nlc3MgdGhlIHNpemUgb2YgYSBkb2N1bWVudC4gRm9yIGVhZ2VyIEdDLCB0aGlzIGlzXG4gKiBleHBlY3RlZCB0byBqdXN0IHJldHVybiAwIHRvIGF2b2lkIHVubmVjZXNzYXJpbHkgZG9pbmcgdGhlIHdvcmsgb2ZcbiAqIGNhbGN1bGF0aW5nIHRoZSBzaXplLlxuICovXG4vKipcbiAqIEhhbmRsZXMgdGhlIGRldGFpbHMgb2YgYWRkaW5nIGFuZCB1cGRhdGluZyBkb2N1bWVudHMgaW4gdGhlIE1lbW9yeVJlbW90ZURvY3VtZW50Q2FjaGUuXG4gKi9cbmNsYXNzIFZyIGV4dGVuZHMgamkge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5TZSA9IHQ7XG4gICAgfVxuICAgIGFwcGx5Q2hhbmdlcyh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBbXTtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2hhbmdlcy5mb3JFYWNoKCgobiwgcykgPT4ge1xuICAgICAgICAgICAgcy5kb2N1bWVudC5pc1ZhbGlkRG9jdW1lbnQoKSA/IGUucHVzaCh0aGlzLlNlLmFkZEVudHJ5KHQsIHMuZG9jdW1lbnQsIHRoaXMuZ2V0UmVhZFRpbWUobikpKSA6IHRoaXMuU2UucmVtb3ZlRW50cnkobik7XG4gICAgICAgIH0pKSwgS3Mud2FpdEZvcihlKTtcbiAgICB9XG4gICAgZ2V0RnJvbUNhY2hlKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuU2UuZ2V0RW50cnkodCwgZSk7XG4gICAgfVxuICAgIGdldEFsbEZyb21DYWNoZSh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLlNlLmdldEVudHJpZXModCwgZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjbGFzcyBTciB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLnBlcnNpc3RlbmNlID0gdCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBNYXBzIGEgdGFyZ2V0IHRvIHRoZSBkYXRhIGFib3V0IHRoYXQgdGFyZ2V0XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLlRzID0gbmV3IEtpKCh0ID0+IFF0KHQpKSwgR3QpLCBcbiAgICAgICAgLyoqIFRoZSBsYXN0IHJlY2VpdmVkIHNuYXBzaG90IHZlcnNpb24uICovXG4gICAgICAgIHRoaXMubGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbiA9IGl0Lm1pbigpLCBcbiAgICAgICAgLyoqIFRoZSBoaWdoZXN0IG51bWJlcmVkIHRhcmdldCBJRCBlbmNvdW50ZXJlZC4gKi9cbiAgICAgICAgdGhpcy5oaWdoZXN0VGFyZ2V0SWQgPSAwLCBcbiAgICAgICAgLyoqIFRoZSBoaWdoZXN0IHNlcXVlbmNlIG51bWJlciBlbmNvdW50ZXJlZC4gKi9cbiAgICAgICAgdGhpcy5JcyA9IDAsIFxuICAgICAgICAvKipcbiAgICAgICAgICogQSBvcmRlcmVkIGJpZGlyZWN0aW9uYWwgbWFwcGluZyBiZXR3ZWVuIGRvY3VtZW50cyBhbmQgdGhlIHJlbW90ZSB0YXJnZXRcbiAgICAgICAgICogSURzLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5BcyA9IG5ldyBSciwgdGhpcy50YXJnZXRDb3VudCA9IDAsIHRoaXMuUnMgPSBDaS5zZSgpO1xuICAgIH1cbiAgICBmb3JFYWNoVGFyZ2V0KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuVHMuZm9yRWFjaCgoKHQsIG4pID0+IGUobikpKSwgS3MucmVzb2x2ZSgpO1xuICAgIH1cbiAgICBnZXRMYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uKHQpIHtcbiAgICAgICAgcmV0dXJuIEtzLnJlc29sdmUodGhpcy5sYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uKTtcbiAgICB9XG4gICAgZ2V0SGlnaGVzdFNlcXVlbmNlTnVtYmVyKHQpIHtcbiAgICAgICAgcmV0dXJuIEtzLnJlc29sdmUodGhpcy5Jcyk7XG4gICAgfVxuICAgIGFsbG9jYXRlVGFyZ2V0SWQodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5oaWdoZXN0VGFyZ2V0SWQgPSB0aGlzLlJzLm5leHQoKSwgS3MucmVzb2x2ZSh0aGlzLmhpZ2hlc3RUYXJnZXRJZCk7XG4gICAgfVxuICAgIHNldFRhcmdldHNNZXRhZGF0YSh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiBuICYmICh0aGlzLmxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24gPSBuKSwgZSA+IHRoaXMuSXMgJiYgKHRoaXMuSXMgPSBlKSwgXG4gICAgICAgIEtzLnJlc29sdmUoKTtcbiAgICB9XG4gICAgYWUodCkge1xuICAgICAgICB0aGlzLlRzLnNldCh0LnRhcmdldCwgdCk7XG4gICAgICAgIGNvbnN0IGUgPSB0LnRhcmdldElkO1xuICAgICAgICBlID4gdGhpcy5oaWdoZXN0VGFyZ2V0SWQgJiYgKHRoaXMuUnMgPSBuZXcgQ2koZSksIHRoaXMuaGlnaGVzdFRhcmdldElkID0gZSksIHQuc2VxdWVuY2VOdW1iZXIgPiB0aGlzLklzICYmICh0aGlzLklzID0gdC5zZXF1ZW5jZU51bWJlcik7XG4gICAgfVxuICAgIGFkZFRhcmdldERhdGEodCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5hZShlKSwgdGhpcy50YXJnZXRDb3VudCArPSAxLCBLcy5yZXNvbHZlKCk7XG4gICAgfVxuICAgIHVwZGF0ZVRhcmdldERhdGEodCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5hZShlKSwgS3MucmVzb2x2ZSgpO1xuICAgIH1cbiAgICByZW1vdmVUYXJnZXREYXRhKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuVHMuZGVsZXRlKGUudGFyZ2V0KSwgdGhpcy5Bcy5jcyhlLnRhcmdldElkKSwgdGhpcy50YXJnZXRDb3VudCAtPSAxLCBcbiAgICAgICAgS3MucmVzb2x2ZSgpO1xuICAgIH1cbiAgICByZW1vdmVUYXJnZXRzKHQsIGUsIG4pIHtcbiAgICAgICAgbGV0IHMgPSAwO1xuICAgICAgICBjb25zdCBpID0gW107XG4gICAgICAgIHJldHVybiB0aGlzLlRzLmZvckVhY2goKChyLCBvKSA9PiB7XG4gICAgICAgICAgICBvLnNlcXVlbmNlTnVtYmVyIDw9IGUgJiYgbnVsbCA9PT0gbi5nZXQoby50YXJnZXRJZCkgJiYgKHRoaXMuVHMuZGVsZXRlKHIpLCBpLnB1c2godGhpcy5yZW1vdmVNYXRjaGluZ0tleXNGb3JUYXJnZXRJZCh0LCBvLnRhcmdldElkKSksIFxuICAgICAgICAgICAgcysrKTtcbiAgICAgICAgfSkpLCBLcy53YWl0Rm9yKGkpLm5leHQoKCgpID0+IHMpKTtcbiAgICB9XG4gICAgZ2V0VGFyZ2V0Q291bnQodCkge1xuICAgICAgICByZXR1cm4gS3MucmVzb2x2ZSh0aGlzLnRhcmdldENvdW50KTtcbiAgICB9XG4gICAgZ2V0VGFyZ2V0RGF0YSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSB0aGlzLlRzLmdldChlKSB8fCBudWxsO1xuICAgICAgICByZXR1cm4gS3MucmVzb2x2ZShuKTtcbiAgICB9XG4gICAgYWRkTWF0Y2hpbmdLZXlzKHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuQXMuc3MoZSwgbiksIEtzLnJlc29sdmUoKTtcbiAgICB9XG4gICAgcmVtb3ZlTWF0Y2hpbmdLZXlzKHQsIGUsIG4pIHtcbiAgICAgICAgdGhpcy5Bcy5vcyhlLCBuKTtcbiAgICAgICAgY29uc3QgcyA9IHRoaXMucGVyc2lzdGVuY2UucmVmZXJlbmNlRGVsZWdhdGUsIGkgPSBbXTtcbiAgICAgICAgcmV0dXJuIHMgJiYgZS5mb3JFYWNoKChlID0+IHtcbiAgICAgICAgICAgIGkucHVzaChzLm1hcmtQb3RlbnRpYWxseU9ycGhhbmVkKHQsIGUpKTtcbiAgICAgICAgfSkpLCBLcy53YWl0Rm9yKGkpO1xuICAgIH1cbiAgICByZW1vdmVNYXRjaGluZ0tleXNGb3JUYXJnZXRJZCh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLkFzLmNzKGUpLCBLcy5yZXNvbHZlKCk7XG4gICAgfVxuICAgIGdldE1hdGNoaW5nS2V5c0ZvclRhcmdldElkKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMuQXMuaHMoZSk7XG4gICAgICAgIHJldHVybiBLcy5yZXNvbHZlKG4pO1xuICAgIH1cbiAgICBjb250YWluc0tleSh0LCBlKSB7XG4gICAgICAgIHJldHVybiBLcy5yZXNvbHZlKHRoaXMuQXMuY29udGFpbnNLZXkoZSkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSBtZW1vcnktYmFja2VkIGluc3RhbmNlIG9mIFBlcnNpc3RlbmNlLiBEYXRhIGlzIHN0b3JlZCBvbmx5IGluIFJBTSBhbmRcbiAqIG5vdCBwZXJzaXN0ZWQgYWNyb3NzIHNlc3Npb25zLlxuICovXG5jbGFzcyBEciB7XG4gICAgLyoqXG4gICAgICogVGhlIGNvbnN0cnVjdG9yIGFjY2VwdHMgYSBmYWN0b3J5IGZvciBjcmVhdGluZyBhIHJlZmVyZW5jZSBkZWxlZ2F0ZS4gVGhpc1xuICAgICAqIGFsbG93cyBib3RoIHRoZSBkZWxlZ2F0ZSBhbmQgdGhpcyBpbnN0YW5jZSB0byBoYXZlIHN0cm9uZyByZWZlcmVuY2VzIHRvXG4gICAgICogZWFjaCBvdGhlciB3aXRob3V0IGhhdmluZyBudWxsYWJsZSBmaWVsZHMgdGhhdCB3b3VsZCB0aGVuIG5lZWQgdG8gYmVcbiAgICAgKiBjaGVja2VkIG9yIGFzc2VydGVkIG9uIGV2ZXJ5IGFjY2Vzcy5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMuUHMgPSB7fSwgdGhpcy5MZSA9IG5ldyBZKDApLCB0aGlzLkJlID0gITEsIHRoaXMuQmUgPSAhMCwgdGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZSA9IHQodGhpcyksIFxuICAgICAgICB0aGlzLnplID0gbmV3IFNyKHRoaXMpO1xuICAgICAgICB0aGlzLkh0ID0gbmV3IHlpLCB0aGlzLkhlID0gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyB2cih0LCBlKTtcbiAgICAgICAgfSh0aGlzLkh0LCAodCA9PiB0aGlzLnJlZmVyZW5jZURlbGVnYXRlLmJzKHQpKSksIHRoaXMuTiA9IG5ldyBpaShlKSwgdGhpcy5KZSA9IG5ldyBBcih0aGlzLk4pO1xuICAgIH1cbiAgICBzdGFydCgpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cbiAgICBzaHV0ZG93bigpIHtcbiAgICAgICAgLy8gTm8gZHVyYWJsZSBzdGF0ZSB0byBlbnN1cmUgaXMgY2xvc2VkIG9uIHNodXRkb3duLlxuICAgICAgICByZXR1cm4gdGhpcy5CZSA9ICExLCBQcm9taXNlLnJlc29sdmUoKTtcbiAgICB9XG4gICAgZ2V0IHN0YXJ0ZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLkJlO1xuICAgIH1cbiAgICBzZXREYXRhYmFzZURlbGV0ZWRMaXN0ZW5lcigpIHtcbiAgICAgICAgLy8gTm8gb3AuXG4gICAgfVxuICAgIHNldE5ldHdvcmtFbmFibGVkKCkge1xuICAgICAgICAvLyBObyBvcC5cbiAgICB9XG4gICAgZ2V0SW5kZXhNYW5hZ2VyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5IdDtcbiAgICB9XG4gICAgZ2V0TXV0YXRpb25RdWV1ZSh0KSB7XG4gICAgICAgIGxldCBlID0gdGhpcy5Qc1t0LnRvS2V5KCldO1xuICAgICAgICByZXR1cm4gZSB8fCAoZSA9IG5ldyBicih0aGlzLkh0LCB0aGlzLnJlZmVyZW5jZURlbGVnYXRlKSwgdGhpcy5Qc1t0LnRvS2V5KCldID0gZSksIFxuICAgICAgICBlO1xuICAgIH1cbiAgICBnZXRUYXJnZXRDYWNoZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuemU7XG4gICAgfVxuICAgIGdldFJlbW90ZURvY3VtZW50Q2FjaGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLkhlO1xuICAgIH1cbiAgICBnZXRCdW5kbGVDYWNoZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuSmU7XG4gICAgfVxuICAgIHJ1blRyYW5zYWN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgayhcIk1lbW9yeVBlcnNpc3RlbmNlXCIsIFwiU3RhcnRpbmcgdHJhbnNhY3Rpb246XCIsIHQpO1xuICAgICAgICBjb25zdCBzID0gbmV3IENyKHRoaXMuTGUubmV4dCgpKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVmZXJlbmNlRGVsZWdhdGUudnMoKSwgbihzKS5uZXh0KCh0ID0+IHRoaXMucmVmZXJlbmNlRGVsZWdhdGUuVnMocykubmV4dCgoKCkgPT4gdCkpKSkudG9Qcm9taXNlKCkudGhlbigodCA9PiAocy5yYWlzZU9uQ29tbWl0dGVkRXZlbnQoKSwgXG4gICAgICAgIHQpKSk7XG4gICAgfVxuICAgIFNzKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIEtzLm9yKE9iamVjdC52YWx1ZXModGhpcy5QcykubWFwKChuID0+ICgpID0+IG4uY29udGFpbnNLZXkodCwgZSkpKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIE1lbW9yeSBwZXJzaXN0ZW5jZSBpcyBub3QgYWN0dWFsbHkgdHJhbnNhY3Rpb25hbCwgYnV0IGZ1dHVyZSBpbXBsZW1lbnRhdGlvbnNcbiAqIG1heSBoYXZlIHRyYW5zYWN0aW9uLXNjb3BlZCBzdGF0ZS5cbiAqLyBjbGFzcyBDciBleHRlbmRzIHFzIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMuY3VycmVudFNlcXVlbmNlTnVtYmVyID0gdDtcbiAgICB9XG59XG5cbmNsYXNzIE5yIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMucGVyc2lzdGVuY2UgPSB0LCBcbiAgICAgICAgLyoqIFRyYWNrcyBhbGwgZG9jdW1lbnRzIHRoYXQgYXJlIGFjdGl2ZSBpbiBRdWVyeSB2aWV3cy4gKi9cbiAgICAgICAgdGhpcy5EcyA9IG5ldyBSciwgXG4gICAgICAgIC8qKiBUaGUgbGlzdCBvZiBkb2N1bWVudHMgdGhhdCBhcmUgcG90ZW50aWFsbHkgR0NlZCBhZnRlciBlYWNoIHRyYW5zYWN0aW9uLiAqL1xuICAgICAgICB0aGlzLkNzID0gbnVsbDtcbiAgICB9XG4gICAgc3RhdGljIE5zKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBOcih0KTtcbiAgICB9XG4gICAgZ2V0IHhzKCkge1xuICAgICAgICBpZiAodGhpcy5DcykgcmV0dXJuIHRoaXMuQ3M7XG4gICAgICAgIHRocm93IE0oKTtcbiAgICB9XG4gICAgYWRkUmVmZXJlbmNlKHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuRHMuYWRkUmVmZXJlbmNlKG4sIGUpLCB0aGlzLnhzLmRlbGV0ZShuLnRvU3RyaW5nKCkpLCBLcy5yZXNvbHZlKCk7XG4gICAgfVxuICAgIHJlbW92ZVJlZmVyZW5jZSh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiB0aGlzLkRzLnJlbW92ZVJlZmVyZW5jZShuLCBlKSwgdGhpcy54cy5hZGQobi50b1N0cmluZygpKSwgS3MucmVzb2x2ZSgpO1xuICAgIH1cbiAgICBtYXJrUG90ZW50aWFsbHlPcnBoYW5lZCh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnhzLmFkZChlLnRvU3RyaW5nKCkpLCBLcy5yZXNvbHZlKCk7XG4gICAgfVxuICAgIHJlbW92ZVRhcmdldCh0LCBlKSB7XG4gICAgICAgIHRoaXMuRHMuY3MoZS50YXJnZXRJZCkuZm9yRWFjaCgodCA9PiB0aGlzLnhzLmFkZCh0LnRvU3RyaW5nKCkpKSk7XG4gICAgICAgIGNvbnN0IG4gPSB0aGlzLnBlcnNpc3RlbmNlLmdldFRhcmdldENhY2hlKCk7XG4gICAgICAgIHJldHVybiBuLmdldE1hdGNoaW5nS2V5c0ZvclRhcmdldElkKHQsIGUudGFyZ2V0SWQpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgdC5mb3JFYWNoKCh0ID0+IHRoaXMueHMuYWRkKHQudG9TdHJpbmcoKSkpKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IG4ucmVtb3ZlVGFyZ2V0RGF0YSh0LCBlKSkpO1xuICAgIH1cbiAgICB2cygpIHtcbiAgICAgICAgdGhpcy5DcyA9IG5ldyBTZXQ7XG4gICAgfVxuICAgIFZzKHQpIHtcbiAgICAgICAgLy8gUmVtb3ZlIG5ld2x5IG9ycGhhbmVkIGRvY3VtZW50cy5cbiAgICAgICAgY29uc3QgZSA9IHRoaXMucGVyc2lzdGVuY2UuZ2V0UmVtb3RlRG9jdW1lbnRDYWNoZSgpLm5ld0NoYW5nZUJ1ZmZlcigpO1xuICAgICAgICByZXR1cm4gS3MuZm9yRWFjaCh0aGlzLnhzLCAobiA9PiB7XG4gICAgICAgICAgICBjb25zdCBzID0gUHQuZnJvbVBhdGgobik7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5rcyh0LCBzKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgICAgICB0IHx8IGUucmVtb3ZlRW50cnkocyk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiAodGhpcy5DcyA9IG51bGwsIGUuYXBwbHkodCkpKSk7XG4gICAgfVxuICAgIHVwZGF0ZUxpbWJvRG9jdW1lbnQodCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5rcyh0LCBlKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgIHQgPyB0aGlzLnhzLmRlbGV0ZShlLnRvU3RyaW5nKCkpIDogdGhpcy54cy5hZGQoZS50b1N0cmluZygpKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBicyh0KSB7XG4gICAgICAgIC8vIEZvciBlYWdlciBHQywgd2UgZG9uJ3QgY2FyZSBhYm91dCB0aGUgZG9jdW1lbnQgc2l6ZSwgdGhlcmUgYXJlIG5vIHNpemUgdGhyZXNob2xkcy5cbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIGtzKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIEtzLm9yKFsgKCkgPT4gS3MucmVzb2x2ZSh0aGlzLkRzLmNvbnRhaW5zS2V5KGUpKSwgKCkgPT4gdGhpcy5wZXJzaXN0ZW5jZS5nZXRUYXJnZXRDYWNoZSgpLmNvbnRhaW5zS2V5KHQsIGUpLCAoKSA9PiB0aGlzLnBlcnNpc3RlbmNlLlNzKHQsIGUpIF0pO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8vIFRoZSBmb3JtYXQgb2YgdGhlIExvY2FsU3RvcmFnZSBrZXkgdGhhdCBzdG9yZXMgdGhlIGNsaWVudCBzdGF0ZSBpczpcbi8vICAgICBmaXJlc3RvcmVfY2xpZW50c188cGVyc2lzdGVuY2VfcHJlZml4Pl88aW5zdGFuY2Vfa2V5PlxuLyoqIEFzc2VtYmxlcyB0aGUga2V5IGZvciBhIGNsaWVudCBzdGF0ZSBpbiBXZWJTdG9yYWdlICovXG5mdW5jdGlvbiB4cih0LCBlKSB7XG4gICAgcmV0dXJuIGBmaXJlc3RvcmVfY2xpZW50c18ke3R9XyR7ZX1gO1xufVxuXG4vLyBUaGUgZm9ybWF0IG9mIHRoZSBXZWJTdG9yYWdlIGtleSB0aGF0IHN0b3JlcyB0aGUgbXV0YXRpb24gc3RhdGUgaXM6XG4vLyAgICAgZmlyZXN0b3JlX211dGF0aW9uc188cGVyc2lzdGVuY2VfcHJlZml4Pl88YmF0Y2hfaWQ+XG4vLyAgICAgKGZvciB1bmF1dGhlbnRpY2F0ZWQgdXNlcnMpXG4vLyBvcjogZmlyZXN0b3JlX211dGF0aW9uc188cGVyc2lzdGVuY2VfcHJlZml4Pl88YmF0Y2hfaWQ+Xzx1c2VyX3VpZD5cblxuLy8gJ3VzZXJfdWlkJyBpcyBsYXN0IHRvIGF2b2lkIG5lZWRpbmcgdG8gZXNjYXBlICdfJyBjaGFyYWN0ZXJzIHRoYXQgaXQgbWlnaHRcbi8vIGNvbnRhaW4uXG4vKiogQXNzZW1ibGVzIHRoZSBrZXkgZm9yIGEgbXV0YXRpb24gYmF0Y2ggaW4gV2ViU3RvcmFnZSAqL1xuZnVuY3Rpb24ga3IodCwgZSwgbikge1xuICAgIGxldCBzID0gYGZpcmVzdG9yZV9tdXRhdGlvbnNfJHt0fV8ke259YDtcbiAgICByZXR1cm4gZS5pc0F1dGhlbnRpY2F0ZWQoKSAmJiAocyArPSBgXyR7ZS51aWR9YCksIHM7XG59XG5cbi8vIFRoZSBmb3JtYXQgb2YgdGhlIFdlYlN0b3JhZ2Uga2V5IHRoYXQgc3RvcmVzIGEgcXVlcnkgdGFyZ2V0J3MgbWV0YWRhdGEgaXM6XG4vLyAgICAgZmlyZXN0b3JlX3RhcmdldHNfPHBlcnNpc3RlbmNlX3ByZWZpeD5fPHRhcmdldF9pZD5cbi8qKiBBc3NlbWJsZXMgdGhlIGtleSBmb3IgYSBxdWVyeSBzdGF0ZSBpbiBXZWJTdG9yYWdlICovXG5mdW5jdGlvbiAkcih0LCBlKSB7XG4gICAgcmV0dXJuIGBmaXJlc3RvcmVfdGFyZ2V0c18ke3R9XyR7ZX1gO1xufVxuXG4vLyBUaGUgV2ViU3RvcmFnZSBwcmVmaXggdGhhdCBzdG9yZXMgdGhlIHByaW1hcnkgdGFiJ3Mgb25saW5lIHN0YXRlLiBUaGVcbi8vIGZvcm1hdCBvZiB0aGUga2V5IGlzOlxuLy8gICAgIGZpcmVzdG9yZV9vbmxpbmVfc3RhdGVfPHBlcnNpc3RlbmNlX3ByZWZpeD5cbi8qKlxuICogSG9sZHMgdGhlIHN0YXRlIG9mIGEgbXV0YXRpb24gYmF0Y2gsIGluY2x1ZGluZyBpdHMgdXNlciBJRCwgYmF0Y2ggSUQgYW5kXG4gKiB3aGV0aGVyIHRoZSBiYXRjaCBpcyAncGVuZGluZycsICdhY2tub3dsZWRnZWQnIG9yICdyZWplY3RlZCcuXG4gKi9cbi8vIFZpc2libGUgZm9yIHRlc3RpbmdcbmNsYXNzIE9yIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzKSB7XG4gICAgICAgIHRoaXMudXNlciA9IHQsIHRoaXMuYmF0Y2hJZCA9IGUsIHRoaXMuc3RhdGUgPSBuLCB0aGlzLmVycm9yID0gcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogUGFyc2VzIGEgTXV0YXRpb25NZXRhZGF0YSBmcm9tIGl0cyBKU09OIHJlcHJlc2VudGF0aW9uIGluIFdlYlN0b3JhZ2UuXG4gICAgICogTG9ncyBhIHdhcm5pbmcgYW5kIHJldHVybnMgbnVsbCBpZiB0aGUgZm9ybWF0IG9mIHRoZSBkYXRhIGlzIG5vdCB2YWxpZC5cbiAgICAgKi8gICAgc3RhdGljICRzKHQsIGUsIG4pIHtcbiAgICAgICAgY29uc3QgcyA9IEpTT04ucGFyc2Uobik7XG4gICAgICAgIGxldCBpLCByID0gXCJvYmplY3RcIiA9PSB0eXBlb2YgcyAmJiAtMSAhPT0gWyBcInBlbmRpbmdcIiwgXCJhY2tub3dsZWRnZWRcIiwgXCJyZWplY3RlZFwiIF0uaW5kZXhPZihzLnN0YXRlKSAmJiAodm9pZCAwID09PSBzLmVycm9yIHx8IFwib2JqZWN0XCIgPT0gdHlwZW9mIHMuZXJyb3IpO1xuICAgICAgICByZXR1cm4gciAmJiBzLmVycm9yICYmIChyID0gXCJzdHJpbmdcIiA9PSB0eXBlb2Ygcy5lcnJvci5tZXNzYWdlICYmIFwic3RyaW5nXCIgPT0gdHlwZW9mIHMuZXJyb3IuY29kZSwgXG4gICAgICAgIHIgJiYgKGkgPSBuZXcgSyhzLmVycm9yLmNvZGUsIHMuZXJyb3IubWVzc2FnZSkpKSwgciA/IG5ldyBPcih0LCBlLCBzLnN0YXRlLCBpKSA6ICgkKFwiU2hhcmVkQ2xpZW50U3RhdGVcIiwgYEZhaWxlZCB0byBwYXJzZSBtdXRhdGlvbiBzdGF0ZSBmb3IgSUQgJyR7ZX0nOiAke259YCksIFxuICAgICAgICBudWxsKTtcbiAgICB9XG4gICAgT3MoKSB7XG4gICAgICAgIGNvbnN0IHQgPSB7XG4gICAgICAgICAgICBzdGF0ZTogdGhpcy5zdGF0ZSxcbiAgICAgICAgICAgIHVwZGF0ZVRpbWVNczogRGF0ZS5ub3coKVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gdGhpcy5lcnJvciAmJiAodC5lcnJvciA9IHtcbiAgICAgICAgICAgIGNvZGU6IHRoaXMuZXJyb3IuY29kZSxcbiAgICAgICAgICAgIG1lc3NhZ2U6IHRoaXMuZXJyb3IubWVzc2FnZVxuICAgICAgICB9KSwgSlNPTi5zdHJpbmdpZnkodCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEhvbGRzIHRoZSBzdGF0ZSBvZiBhIHF1ZXJ5IHRhcmdldCwgaW5jbHVkaW5nIGl0cyB0YXJnZXQgSUQgYW5kIHdoZXRoZXIgdGhlXG4gKiB0YXJnZXQgaXMgJ25vdC1jdXJyZW50JywgJ2N1cnJlbnQnIG9yICdyZWplY3RlZCcuXG4gKi9cbi8vIFZpc2libGUgZm9yIHRlc3RpbmdcbmNsYXNzIEZyIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHRoaXMudGFyZ2V0SWQgPSB0LCB0aGlzLnN0YXRlID0gZSwgdGhpcy5lcnJvciA9IG47XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBhcnNlcyBhIFF1ZXJ5VGFyZ2V0TWV0YWRhdGEgZnJvbSBpdHMgSlNPTiByZXByZXNlbnRhdGlvbiBpbiBXZWJTdG9yYWdlLlxuICAgICAqIExvZ3MgYSB3YXJuaW5nIGFuZCByZXR1cm5zIG51bGwgaWYgdGhlIGZvcm1hdCBvZiB0aGUgZGF0YSBpcyBub3QgdmFsaWQuXG4gICAgICovICAgIHN0YXRpYyAkcyh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBKU09OLnBhcnNlKGUpO1xuICAgICAgICBsZXQgcywgaSA9IFwib2JqZWN0XCIgPT0gdHlwZW9mIG4gJiYgLTEgIT09IFsgXCJub3QtY3VycmVudFwiLCBcImN1cnJlbnRcIiwgXCJyZWplY3RlZFwiIF0uaW5kZXhPZihuLnN0YXRlKSAmJiAodm9pZCAwID09PSBuLmVycm9yIHx8IFwib2JqZWN0XCIgPT0gdHlwZW9mIG4uZXJyb3IpO1xuICAgICAgICByZXR1cm4gaSAmJiBuLmVycm9yICYmIChpID0gXCJzdHJpbmdcIiA9PSB0eXBlb2Ygbi5lcnJvci5tZXNzYWdlICYmIFwic3RyaW5nXCIgPT0gdHlwZW9mIG4uZXJyb3IuY29kZSwgXG4gICAgICAgIGkgJiYgKHMgPSBuZXcgSyhuLmVycm9yLmNvZGUsIG4uZXJyb3IubWVzc2FnZSkpKSwgaSA/IG5ldyBGcih0LCBuLnN0YXRlLCBzKSA6ICgkKFwiU2hhcmVkQ2xpZW50U3RhdGVcIiwgYEZhaWxlZCB0byBwYXJzZSB0YXJnZXQgc3RhdGUgZm9yIElEICcke3R9JzogJHtlfWApLCBcbiAgICAgICAgbnVsbCk7XG4gICAgfVxuICAgIE9zKCkge1xuICAgICAgICBjb25zdCB0ID0ge1xuICAgICAgICAgICAgc3RhdGU6IHRoaXMuc3RhdGUsXG4gICAgICAgICAgICB1cGRhdGVUaW1lTXM6IERhdGUubm93KClcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZXJyb3IgJiYgKHQuZXJyb3IgPSB7XG4gICAgICAgICAgICBjb2RlOiB0aGlzLmVycm9yLmNvZGUsXG4gICAgICAgICAgICBtZXNzYWdlOiB0aGlzLmVycm9yLm1lc3NhZ2VcbiAgICAgICAgfSksIEpTT04uc3RyaW5naWZ5KHQpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBUaGlzIGNsYXNzIHJlcHJlc2VudHMgdGhlIGltbXV0YWJsZSBDbGllbnRTdGF0ZSBmb3IgYSBjbGllbnQgcmVhZCBmcm9tXG4gKiBXZWJTdG9yYWdlLCBjb250YWluaW5nIHRoZSBsaXN0IG9mIGFjdGl2ZSBxdWVyeSB0YXJnZXRzLlxuICovIGNsYXNzIE1yIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMuY2xpZW50SWQgPSB0LCB0aGlzLmFjdGl2ZVRhcmdldElkcyA9IGU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBhcnNlcyBhIFJlbW90ZUNsaWVudFN0YXRlIGZyb20gdGhlIEpTT04gcmVwcmVzZW50YXRpb24gaW4gV2ViU3RvcmFnZS5cbiAgICAgKiBMb2dzIGEgd2FybmluZyBhbmQgcmV0dXJucyBudWxsIGlmIHRoZSBmb3JtYXQgb2YgdGhlIGRhdGEgaXMgbm90IHZhbGlkLlxuICAgICAqLyAgICBzdGF0aWMgJHModCwgZSkge1xuICAgICAgICBjb25zdCBuID0gSlNPTi5wYXJzZShlKTtcbiAgICAgICAgbGV0IHMgPSBcIm9iamVjdFwiID09IHR5cGVvZiBuICYmIG4uYWN0aXZlVGFyZ2V0SWRzIGluc3RhbmNlb2YgQXJyYXksIGkgPSB2bigpO1xuICAgICAgICBmb3IgKGxldCB0ID0gMDsgcyAmJiB0IDwgbi5hY3RpdmVUYXJnZXRJZHMubGVuZ3RoOyArK3QpIHMgPSBSdChuLmFjdGl2ZVRhcmdldElkc1t0XSksIFxuICAgICAgICBpID0gaS5hZGQobi5hY3RpdmVUYXJnZXRJZHNbdF0pO1xuICAgICAgICByZXR1cm4gcyA/IG5ldyBNcih0LCBpKSA6ICgkKFwiU2hhcmVkQ2xpZW50U3RhdGVcIiwgYEZhaWxlZCB0byBwYXJzZSBjbGllbnQgZGF0YSBmb3IgaW5zdGFuY2UgJyR7dH0nOiAke2V9YCksIFxuICAgICAgICBudWxsKTtcbiAgICB9XG59XG5cbi8qKlxuICogVGhpcyBjbGFzcyByZXByZXNlbnRzIHRoZSBvbmxpbmUgc3RhdGUgZm9yIGFsbCBjbGllbnRzIHBhcnRpY2lwYXRpbmcgaW5cbiAqIG11bHRpLXRhYi4gVGhlIG9ubGluZSBzdGF0ZSBpcyBvbmx5IHdyaXR0ZW4gdG8gYnkgdGhlIHByaW1hcnkgY2xpZW50LCBhbmRcbiAqIHVzZWQgaW4gc2Vjb25kYXJ5IGNsaWVudHMgdG8gdXBkYXRlIHRoZWlyIHF1ZXJ5IHZpZXdzLlxuICovIGNsYXNzIExyIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMuY2xpZW50SWQgPSB0LCB0aGlzLm9ubGluZVN0YXRlID0gZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUGFyc2VzIGEgU2hhcmVkT25saW5lU3RhdGUgZnJvbSBpdHMgSlNPTiByZXByZXNlbnRhdGlvbiBpbiBXZWJTdG9yYWdlLlxuICAgICAqIExvZ3MgYSB3YXJuaW5nIGFuZCByZXR1cm5zIG51bGwgaWYgdGhlIGZvcm1hdCBvZiB0aGUgZGF0YSBpcyBub3QgdmFsaWQuXG4gICAgICovICAgIHN0YXRpYyAkcyh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBKU09OLnBhcnNlKHQpO1xuICAgICAgICByZXR1cm4gXCJvYmplY3RcIiA9PSB0eXBlb2YgZSAmJiAtMSAhPT0gWyBcIlVua25vd25cIiwgXCJPbmxpbmVcIiwgXCJPZmZsaW5lXCIgXS5pbmRleE9mKGUub25saW5lU3RhdGUpICYmIFwic3RyaW5nXCIgPT0gdHlwZW9mIGUuY2xpZW50SWQgPyBuZXcgTHIoZS5jbGllbnRJZCwgZS5vbmxpbmVTdGF0ZSkgOiAoJChcIlNoYXJlZENsaWVudFN0YXRlXCIsIGBGYWlsZWQgdG8gcGFyc2Ugb25saW5lIHN0YXRlOiAke3R9YCksIFxuICAgICAgICBudWxsKTtcbiAgICB9XG59XG5cbi8qKlxuICogTWV0YWRhdGEgc3RhdGUgb2YgdGhlIGxvY2FsIGNsaWVudC4gVW5saWtlIGBSZW1vdGVDbGllbnRTdGF0ZWAsIHRoaXMgY2xhc3MgaXNcbiAqIG11dGFibGUgYW5kIGtlZXBzIHRyYWNrIG9mIGFsbCBwZW5kaW5nIG11dGF0aW9ucywgd2hpY2ggYWxsb3dzIHVzIHRvXG4gKiB1cGRhdGUgdGhlIHJhbmdlIG9mIHBlbmRpbmcgbXV0YXRpb24gYmF0Y2ggSURzIGFzIG5ldyBtdXRhdGlvbnMgYXJlIGFkZGVkIG9yXG4gKiByZW1vdmVkLlxuICpcbiAqIFRoZSBkYXRhIGluIGBMb2NhbENsaWVudFN0YXRlYCBpcyBub3QgcmVhZCBmcm9tIFdlYlN0b3JhZ2UgYW5kIGluc3RlYWRcbiAqIHVwZGF0ZWQgdmlhIGl0cyBpbnN0YW5jZSBtZXRob2RzLiBUaGUgdXBkYXRlZCBzdGF0ZSBjYW4gYmUgc2VyaWFsaXplZCB2aWFcbiAqIGB0b1dlYlN0b3JhZ2VKU09OKClgLlxuICovXG4vLyBWaXNpYmxlIGZvciB0ZXN0aW5nLlxuY2xhc3MgQnIge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLmFjdGl2ZVRhcmdldElkcyA9IHZuKCk7XG4gICAgfVxuICAgIEZzKHQpIHtcbiAgICAgICAgdGhpcy5hY3RpdmVUYXJnZXRJZHMgPSB0aGlzLmFjdGl2ZVRhcmdldElkcy5hZGQodCk7XG4gICAgfVxuICAgIE1zKHQpIHtcbiAgICAgICAgdGhpcy5hY3RpdmVUYXJnZXRJZHMgPSB0aGlzLmFjdGl2ZVRhcmdldElkcy5kZWxldGUodCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENvbnZlcnRzIHRoaXMgZW50cnkgaW50byBhIEpTT04tZW5jb2RlZCBmb3JtYXQgd2UgY2FuIHVzZSBmb3IgV2ViU3RvcmFnZS5cbiAgICAgKiBEb2VzIG5vdCBlbmNvZGUgYGNsaWVudElkYCBhcyBpdCBpcyBwYXJ0IG9mIHRoZSBrZXkgaW4gV2ViU3RvcmFnZS5cbiAgICAgKi8gICAgT3MoKSB7XG4gICAgICAgIGNvbnN0IHQgPSB7XG4gICAgICAgICAgICBhY3RpdmVUYXJnZXRJZHM6IHRoaXMuYWN0aXZlVGFyZ2V0SWRzLnRvQXJyYXkoKSxcbiAgICAgICAgICAgIHVwZGF0ZVRpbWVNczogRGF0ZS5ub3coKVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodCk7XG4gICAgfVxufVxuXG4vKipcbiAqIGBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGVgIHVzZXMgV2ViU3RvcmFnZSAod2luZG93LmxvY2FsU3RvcmFnZSkgYXMgdGhlXG4gKiBiYWNraW5nIHN0b3JlIGZvciB0aGUgU2hhcmVkQ2xpZW50U3RhdGUuIEl0IGtlZXBzIHRyYWNrIG9mIGFsbCBhY3RpdmVcbiAqIGNsaWVudHMgYW5kIHN1cHBvcnRzIG1vZGlmaWNhdGlvbnMgb2YgdGhlIGxvY2FsIGNsaWVudCdzIGRhdGEuXG4gKi8gY2xhc3MgVXIge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIHMsIGkpIHtcbiAgICAgICAgdGhpcy53aW5kb3cgPSB0LCB0aGlzLk9lID0gZSwgdGhpcy5wZXJzaXN0ZW5jZUtleSA9IG4sIHRoaXMuTHMgPSBzLCB0aGlzLnN5bmNFbmdpbmUgPSBudWxsLCBcbiAgICAgICAgdGhpcy5vbmxpbmVTdGF0ZUhhbmRsZXIgPSBudWxsLCB0aGlzLnNlcXVlbmNlTnVtYmVySGFuZGxlciA9IG51bGwsIHRoaXMuQnMgPSB0aGlzLlVzLmJpbmQodGhpcyksIFxuICAgICAgICB0aGlzLnFzID0gbmV3IGRuKHR0KSwgdGhpcy5zdGFydGVkID0gITEsIFxuICAgICAgICAvKipcbiAgICAgICAgICogQ2FwdHVyZXMgV2ViU3RvcmFnZSBldmVudHMgdGhhdCBvY2N1ciBiZWZvcmUgYHN0YXJ0KClgIGlzIGNhbGxlZC4gVGhlc2VcbiAgICAgICAgICogZXZlbnRzIGFyZSByZXBsYXllZCBvbmNlIGBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGVgIGlzIHN0YXJ0ZWQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLktzID0gW107XG4gICAgICAgIC8vIEVzY2FwZSB0aGUgc3BlY2lhbCBjaGFyYWN0ZXJzIG1lbnRpb25lZCBoZXJlOlxuICAgICAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L0d1aWRlL1JlZ3VsYXJfRXhwcmVzc2lvbnNcbiAgICAgICAgY29uc3QgciA9IG4ucmVwbGFjZSgvWy4qKz9eJHt9KCl8W1xcXVxcXFxdL2csIFwiXFxcXCQmXCIpO1xuICAgICAgICB0aGlzLnN0b3JhZ2UgPSB0aGlzLndpbmRvdy5sb2NhbFN0b3JhZ2UsIHRoaXMuY3VycmVudFVzZXIgPSBpLCB0aGlzLmpzID0geHIodGhpcy5wZXJzaXN0ZW5jZUtleSwgdGhpcy5McyksIFxuICAgICAgICB0aGlzLlFzID0gXG4gICAgICAgIC8qKiBBc3NlbWJsZXMgdGhlIGtleSBmb3IgdGhlIGN1cnJlbnQgc2VxdWVuY2UgbnVtYmVyLiAqL1xuICAgICAgICBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICByZXR1cm4gYGZpcmVzdG9yZV9zZXF1ZW5jZV9udW1iZXJfJHt0fWA7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTggR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gKHRoaXMucGVyc2lzdGVuY2VLZXkpLCB0aGlzLnFzID0gdGhpcy5xcy5pbnNlcnQodGhpcy5McywgbmV3IEJyKSwgdGhpcy5XcyA9IG5ldyBSZWdFeHAoYF5maXJlc3RvcmVfY2xpZW50c18ke3J9XyhbXl9dKikkYCksIFxuICAgICAgICB0aGlzLkdzID0gbmV3IFJlZ0V4cChgXmZpcmVzdG9yZV9tdXRhdGlvbnNfJHtyfV8oXFxcXGQrKSg/Ol8oLiopKT8kYCksIHRoaXMuenMgPSBuZXcgUmVnRXhwKGBeZmlyZXN0b3JlX3RhcmdldHNfJHtyfV8oXFxcXGQrKSRgKSwgXG4gICAgICAgIHRoaXMuSHMgPSBcbiAgICAgICAgLyoqIEFzc2VtYmxlcyB0aGUga2V5IGZvciB0aGUgb25saW5lIHN0YXRlIG9mIHRoZSBwcmltYXJ5IHRhYi4gKi9cbiAgICAgICAgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgcmV0dXJuIGBmaXJlc3RvcmVfb25saW5lX3N0YXRlXyR7dH1gO1xuICAgICAgICB9XG4gICAgICAgIC8vIFRoZSBXZWJTdG9yYWdlIHByZWZpeCB0aGF0IHBsYXlzIGFzIGEgZXZlbnQgdG8gaW5kaWNhdGUgdGhlIHJlbW90ZSBkb2N1bWVudHNcbiAgICAgICAgLy8gbWlnaHQgaGF2ZSBjaGFuZ2VkIGR1ZSB0byBzb21lIHNlY29uZGFyeSB0YWJzIGxvYWRpbmcgYSBidW5kbGUuXG4gICAgICAgIC8vIGZvcm1hdCBvZiB0aGUga2V5IGlzOlxuICAgICAgICAvLyAgICAgZmlyZXN0b3JlX2J1bmRsZV9sb2FkZWRfPHBlcnNpc3RlbmNlS2V5PlxuICAgICAgICAodGhpcy5wZXJzaXN0ZW5jZUtleSksIHRoaXMuSnMgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICByZXR1cm4gYGZpcmVzdG9yZV9idW5kbGVfbG9hZGVkXyR7dH1gO1xuICAgICAgICB9XG4gICAgICAgIC8vIFRoZSBXZWJTdG9yYWdlIGtleSBwcmVmaXggZm9yIHRoZSBrZXkgdGhhdCBzdG9yZXMgdGhlIGxhc3Qgc2VxdWVuY2UgbnVtYmVyIGFsbG9jYXRlZC4gVGhlIGtleVxuICAgICAgICAvLyBsb29rcyBsaWtlICdmaXJlc3RvcmVfc2VxdWVuY2VfbnVtYmVyXzxwZXJzaXN0ZW5jZV9wcmVmaXg+Jy5cbiAgICAgICAgKHRoaXMucGVyc2lzdGVuY2VLZXkpLCBcbiAgICAgICAgLy8gUmF0aGVyIHRoYW4gYWRkaW5nIHRoZSBzdG9yYWdlIG9ic2VydmVyIGR1cmluZyBzdGFydCgpLCB3ZSBhZGQgdGhlXG4gICAgICAgIC8vIHN0b3JhZ2Ugb2JzZXJ2ZXIgZHVyaW5nIGluaXRpYWxpemF0aW9uLiBUaGlzIGVuc3VyZXMgdGhhdCB3ZSBjb2xsZWN0XG4gICAgICAgIC8vIGV2ZW50cyBiZWZvcmUgb3RoZXIgY29tcG9uZW50cyBwb3B1bGF0ZSB0aGVpciBpbml0aWFsIHN0YXRlIChkdXJpbmcgdGhlaXJcbiAgICAgICAgLy8gcmVzcGVjdGl2ZSBzdGFydCgpIGNhbGxzKS4gT3RoZXJ3aXNlLCB3ZSBtaWdodCBmb3IgZXhhbXBsZSBtaXNzIGFcbiAgICAgICAgLy8gbXV0YXRpb24gdGhhdCBpcyBhZGRlZCBhZnRlciBMb2NhbFN0b3JlJ3Mgc3RhcnQoKSBwcm9jZXNzZWQgdGhlIGV4aXN0aW5nXG4gICAgICAgIC8vIG11dGF0aW9ucyBidXQgYmVmb3JlIHdlIG9ic2VydmUgV2ViU3RvcmFnZSBldmVudHMuXG4gICAgICAgIHRoaXMud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJzdG9yYWdlXCIsIHRoaXMuQnMpO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyAndHJ1ZScgaWYgV2ViU3RvcmFnZSBpcyBhdmFpbGFibGUgaW4gdGhlIGN1cnJlbnQgZW52aXJvbm1lbnQuICovICAgIHN0YXRpYyBQdCh0KSB7XG4gICAgICAgIHJldHVybiAhKCF0IHx8ICF0LmxvY2FsU3RvcmFnZSk7XG4gICAgfVxuICAgIGFzeW5jIHN0YXJ0KCkge1xuICAgICAgICAvLyBSZXRyaWV2ZSB0aGUgbGlzdCBvZiBleGlzdGluZyBjbGllbnRzIHRvIGJhY2tmaWxsIHRoZSBkYXRhIGluXG4gICAgICAgIC8vIFNoYXJlZENsaWVudFN0YXRlLlxuICAgICAgICBjb25zdCB0ID0gYXdhaXQgdGhpcy5zeW5jRW5naW5lLnBuKCk7XG4gICAgICAgIGZvciAoY29uc3QgZSBvZiB0KSB7XG4gICAgICAgICAgICBpZiAoZSA9PT0gdGhpcy5McykgY29udGludWU7XG4gICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5nZXRJdGVtKHhyKHRoaXMucGVyc2lzdGVuY2VLZXksIGUpKTtcbiAgICAgICAgICAgIGlmICh0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IE1yLiRzKGUsIHQpO1xuICAgICAgICAgICAgICAgIG4gJiYgKHRoaXMucXMgPSB0aGlzLnFzLmluc2VydChuLmNsaWVudElkLCBuKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5ZcygpO1xuICAgICAgICAvLyBDaGVjayBpZiB0aGVyZSBpcyBhbiBleGlzdGluZyBvbmxpbmUgc3RhdGUgYW5kIGNhbGwgdGhlIGNhbGxiYWNrIGhhbmRsZXJcbiAgICAgICAgLy8gaWYgYXBwbGljYWJsZS5cbiAgICAgICAgY29uc3QgZSA9IHRoaXMuc3RvcmFnZS5nZXRJdGVtKHRoaXMuSHMpO1xuICAgICAgICBpZiAoZSkge1xuICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuWHMoZSk7XG4gICAgICAgICAgICB0ICYmIHRoaXMuWnModCk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChjb25zdCB0IG9mIHRoaXMuS3MpIHRoaXMuVXModCk7XG4gICAgICAgIHRoaXMuS3MgPSBbXSwgXG4gICAgICAgIC8vIFJlZ2lzdGVyIGEgd2luZG93IHVubG9hZCBob29rIHRvIHJlbW92ZSB0aGUgY2xpZW50IG1ldGFkYXRhIGVudHJ5IGZyb21cbiAgICAgICAgLy8gV2ViU3RvcmFnZSBldmVuIGlmIGBzaHV0ZG93bigpYCB3YXMgbm90IGNhbGxlZC5cbiAgICAgICAgdGhpcy53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInBhZ2VoaWRlXCIsICgoKSA9PiB0aGlzLnNodXRkb3duKCkpKSwgdGhpcy5zdGFydGVkID0gITA7XG4gICAgfVxuICAgIHdyaXRlU2VxdWVuY2VOdW1iZXIodCkge1xuICAgICAgICB0aGlzLnNldEl0ZW0odGhpcy5RcywgSlNPTi5zdHJpbmdpZnkodCkpO1xuICAgIH1cbiAgICBnZXRBbGxBY3RpdmVRdWVyeVRhcmdldHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRpKHRoaXMucXMpO1xuICAgIH1cbiAgICBpc0FjdGl2ZVF1ZXJ5VGFyZ2V0KHQpIHtcbiAgICAgICAgbGV0IGUgPSAhMTtcbiAgICAgICAgcmV0dXJuIHRoaXMucXMuZm9yRWFjaCgoKG4sIHMpID0+IHtcbiAgICAgICAgICAgIHMuYWN0aXZlVGFyZ2V0SWRzLmhhcyh0KSAmJiAoZSA9ICEwKTtcbiAgICAgICAgfSkpLCBlO1xuICAgIH1cbiAgICBhZGRQZW5kaW5nTXV0YXRpb24odCkge1xuICAgICAgICB0aGlzLmVpKHQsIFwicGVuZGluZ1wiKTtcbiAgICB9XG4gICAgdXBkYXRlTXV0YXRpb25TdGF0ZSh0LCBlLCBuKSB7XG4gICAgICAgIHRoaXMuZWkodCwgZSwgbiksIFxuICAgICAgICAvLyBPbmNlIGEgZmluYWwgbXV0YXRpb24gcmVzdWx0IGlzIG9ic2VydmVkIGJ5IG90aGVyIGNsaWVudHMsIHRoZXkgbm8gbG9uZ2VyXG4gICAgICAgIC8vIGFjY2VzcyB0aGUgbXV0YXRpb24ncyBtZXRhZGF0YSBlbnRyeS4gU2luY2UgV2ViU3RvcmFnZSByZXBsYXlzIGV2ZW50c1xuICAgICAgICAvLyBpbiBvcmRlciwgaXQgaXMgc2FmZSB0byBkZWxldGUgdGhlIGVudHJ5IHJpZ2h0IGFmdGVyIHVwZGF0aW5nIGl0LlxuICAgICAgICB0aGlzLm5pKHQpO1xuICAgIH1cbiAgICBhZGRMb2NhbFF1ZXJ5VGFyZ2V0KHQpIHtcbiAgICAgICAgbGV0IGUgPSBcIm5vdC1jdXJyZW50XCI7XG4gICAgICAgIC8vIExvb2t1cCBhbiBleGlzdGluZyBxdWVyeSBzdGF0ZSBpZiB0aGUgdGFyZ2V0IElEIHdhcyBhbHJlYWR5IHJlZ2lzdGVyZWRcbiAgICAgICAgLy8gYnkgYW5vdGhlciB0YWJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc0FjdGl2ZVF1ZXJ5VGFyZ2V0KHQpKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gdGhpcy5zdG9yYWdlLmdldEl0ZW0oJHIodGhpcy5wZXJzaXN0ZW5jZUtleSwgdCkpO1xuICAgICAgICAgICAgaWYgKG4pIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gRnIuJHModCwgbik7XG4gICAgICAgICAgICAgICAgcyAmJiAoZSA9IHMuc3RhdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnNpLkZzKHQpLCB0aGlzLllzKCksIGU7XG4gICAgfVxuICAgIHJlbW92ZUxvY2FsUXVlcnlUYXJnZXQodCkge1xuICAgICAgICB0aGlzLnNpLk1zKHQpLCB0aGlzLllzKCk7XG4gICAgfVxuICAgIGlzTG9jYWxRdWVyeVRhcmdldCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNpLmFjdGl2ZVRhcmdldElkcy5oYXModCk7XG4gICAgfVxuICAgIGNsZWFyUXVlcnlTdGF0ZSh0KSB7XG4gICAgICAgIHRoaXMucmVtb3ZlSXRlbSgkcih0aGlzLnBlcnNpc3RlbmNlS2V5LCB0KSk7XG4gICAgfVxuICAgIHVwZGF0ZVF1ZXJ5U3RhdGUodCwgZSwgbikge1xuICAgICAgICB0aGlzLmlpKHQsIGUsIG4pO1xuICAgIH1cbiAgICBoYW5kbGVVc2VyQ2hhbmdlKHQsIGUsIG4pIHtcbiAgICAgICAgZS5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgIHRoaXMubmkodCk7XG4gICAgICAgIH0pKSwgdGhpcy5jdXJyZW50VXNlciA9IHQsIG4uZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICB0aGlzLmFkZFBlbmRpbmdNdXRhdGlvbih0KTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBzZXRPbmxpbmVTdGF0ZSh0KSB7XG4gICAgICAgIHRoaXMucmkodCk7XG4gICAgfVxuICAgIG5vdGlmeUJ1bmRsZUxvYWRlZCgpIHtcbiAgICAgICAgdGhpcy5vaSgpO1xuICAgIH1cbiAgICBzaHV0ZG93bigpIHtcbiAgICAgICAgdGhpcy5zdGFydGVkICYmICh0aGlzLndpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwic3RvcmFnZVwiLCB0aGlzLkJzKSwgdGhpcy5yZW1vdmVJdGVtKHRoaXMuanMpLCBcbiAgICAgICAgdGhpcy5zdGFydGVkID0gITEpO1xuICAgIH1cbiAgICBnZXRJdGVtKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuc3RvcmFnZS5nZXRJdGVtKHQpO1xuICAgICAgICByZXR1cm4gayhcIlNoYXJlZENsaWVudFN0YXRlXCIsIFwiUkVBRFwiLCB0LCBlKSwgZTtcbiAgICB9XG4gICAgc2V0SXRlbSh0LCBlKSB7XG4gICAgICAgIGsoXCJTaGFyZWRDbGllbnRTdGF0ZVwiLCBcIlNFVFwiLCB0LCBlKSwgdGhpcy5zdG9yYWdlLnNldEl0ZW0odCwgZSk7XG4gICAgfVxuICAgIHJlbW92ZUl0ZW0odCkge1xuICAgICAgICBrKFwiU2hhcmVkQ2xpZW50U3RhdGVcIiwgXCJSRU1PVkVcIiwgdCksIHRoaXMuc3RvcmFnZS5yZW1vdmVJdGVtKHQpO1xuICAgIH1cbiAgICBVcyh0KSB7XG4gICAgICAgIC8vIE5vdGU6IFRoZSBmdW5jdGlvbiBpcyB0eXBlZCB0byB0YWtlIEV2ZW50IHRvIGJlIGludGVyZmFjZS1jb21wYXRpYmxlIHdpdGhcbiAgICAgICAgLy8gYFdpbmRvdy5hZGRFdmVudExpc3RlbmVyYC5cbiAgICAgICAgY29uc3QgZSA9IHQ7XG4gICAgICAgIGlmIChlLnN0b3JhZ2VBcmVhID09PSB0aGlzLnN0b3JhZ2UpIHtcbiAgICAgICAgICAgIGlmIChrKFwiU2hhcmVkQ2xpZW50U3RhdGVcIiwgXCJFVkVOVFwiLCBlLmtleSwgZS5uZXdWYWx1ZSksIGUua2V5ID09PSB0aGlzLmpzKSByZXR1cm4gdm9pZCAkKFwiUmVjZWl2ZWQgV2ViU3RvcmFnZSBub3RpZmljYXRpb24gZm9yIGxvY2FsIGNoYW5nZS4gQW5vdGhlciBjbGllbnQgbWlnaHQgaGF2ZSBnYXJiYWdlLWNvbGxlY3RlZCBvdXIgc3RhdGVcIik7XG4gICAgICAgICAgICB0aGlzLk9lLmVucXVldWVSZXRyeWFibGUoKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zdGFydGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChudWxsICE9PSBlLmtleSkgaWYgKHRoaXMuV3MudGVzdChlLmtleSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChudWxsID09IGUubmV3VmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5haShlLmtleSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2kodCwgbnVsbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMudWkoZS5rZXksIGUubmV3VmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0KSByZXR1cm4gdGhpcy5jaSh0LmNsaWVudElkLCB0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLkdzLnRlc3QoZS5rZXkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobnVsbCAhPT0gZS5uZXdWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmhpKGUua2V5LCBlLm5ld1ZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodCkgcmV0dXJuIHRoaXMubGkodCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy56cy50ZXN0KGUua2V5KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG51bGwgIT09IGUubmV3VmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5maShlLmtleSwgZS5uZXdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQpIHJldHVybiB0aGlzLmRpKHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGUua2V5ID09PSB0aGlzLkhzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobnVsbCAhPT0gZS5uZXdWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLlhzKGUubmV3VmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0KSByZXR1cm4gdGhpcy5acyh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlLmtleSA9PT0gdGhpcy5Rcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZSA9IFkuVDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobnVsbCAhPSB0KSB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gSlNPTi5wYXJzZSh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTChcIm51bWJlclwiID09IHR5cGVvZiBuKSwgZSA9IG47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKFwiU2hhcmVkQ2xpZW50U3RhdGVcIiwgXCJGYWlsZWQgdG8gcmVhZCBzZXF1ZW5jZSBudW1iZXIgZnJvbSBXZWJTdG9yYWdlXCIsIHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8qKlxuICogYE1lbW9yeVNoYXJlZENsaWVudFN0YXRlYCBpcyBhIHNpbXBsZSBpbXBsZW1lbnRhdGlvbiBvZiBTaGFyZWRDbGllbnRTdGF0ZSBmb3JcbiAqIGNsaWVudHMgdXNpbmcgbWVtb3J5IHBlcnNpc3RlbmNlLiBUaGUgc3RhdGUgaW4gdGhpcyBjbGFzcyByZW1haW5zIGZ1bGx5XG4gKiBpc29sYXRlZCBhbmQgbm8gc3luY2hyb25pemF0aW9uIGlzIHBlcmZvcm1lZC5cbiAqLyAoZS5uZXdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ICE9PSBZLlQgJiYgdGhpcy5zZXF1ZW5jZU51bWJlckhhbmRsZXIodCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZS5rZXkgPT09IHRoaXMuSnMpIHJldHVybiB0aGlzLnN5bmNFbmdpbmUud2koKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgdGhpcy5Lcy5wdXNoKGUpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldCBzaSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucXMuZ2V0KHRoaXMuTHMpO1xuICAgIH1cbiAgICBZcygpIHtcbiAgICAgICAgdGhpcy5zZXRJdGVtKHRoaXMuanMsIHRoaXMuc2kuT3MoKSk7XG4gICAgfVxuICAgIGVpKHQsIGUsIG4pIHtcbiAgICAgICAgY29uc3QgcyA9IG5ldyBPcih0aGlzLmN1cnJlbnRVc2VyLCB0LCBlLCBuKSwgaSA9IGtyKHRoaXMucGVyc2lzdGVuY2VLZXksIHRoaXMuY3VycmVudFVzZXIsIHQpO1xuICAgICAgICB0aGlzLnNldEl0ZW0oaSwgcy5PcygpKTtcbiAgICB9XG4gICAgbmkodCkge1xuICAgICAgICBjb25zdCBlID0ga3IodGhpcy5wZXJzaXN0ZW5jZUtleSwgdGhpcy5jdXJyZW50VXNlciwgdCk7XG4gICAgICAgIHRoaXMucmVtb3ZlSXRlbShlKTtcbiAgICB9XG4gICAgcmkodCkge1xuICAgICAgICBjb25zdCBlID0ge1xuICAgICAgICAgICAgY2xpZW50SWQ6IHRoaXMuTHMsXG4gICAgICAgICAgICBvbmxpbmVTdGF0ZTogdFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLnN0b3JhZ2Uuc2V0SXRlbSh0aGlzLkhzLCBKU09OLnN0cmluZ2lmeShlKSk7XG4gICAgfVxuICAgIGlpKHQsIGUsIG4pIHtcbiAgICAgICAgY29uc3QgcyA9ICRyKHRoaXMucGVyc2lzdGVuY2VLZXksIHQpLCBpID0gbmV3IEZyKHQsIGUsIG4pO1xuICAgICAgICB0aGlzLnNldEl0ZW0ocywgaS5PcygpKTtcbiAgICB9XG4gICAgb2koKSB7XG4gICAgICAgIHRoaXMuc2V0SXRlbSh0aGlzLkpzLCBcInZhbHVlLW5vdC11c2VkXCIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQYXJzZXMgYSBjbGllbnQgc3RhdGUga2V5IGluIFdlYlN0b3JhZ2UuIFJldHVybnMgbnVsbCBpZiB0aGUga2V5IGRvZXMgbm90XG4gICAgICogbWF0Y2ggdGhlIGV4cGVjdGVkIGtleSBmb3JtYXQuXG4gICAgICovICAgIGFpKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuV3MuZXhlYyh0KTtcbiAgICAgICAgcmV0dXJuIGUgPyBlWzFdIDogbnVsbDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUGFyc2VzIGEgY2xpZW50IHN0YXRlIGluIFdlYlN0b3JhZ2UuIFJldHVybnMgJ251bGwnIGlmIHRoZSB2YWx1ZSBjb3VsZCBub3RcbiAgICAgKiBiZSBwYXJzZWQuXG4gICAgICovICAgIHVpKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMuYWkodCk7XG4gICAgICAgIHJldHVybiBNci4kcyhuLCBlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUGFyc2VzIGEgbXV0YXRpb24gYmF0Y2ggc3RhdGUgaW4gV2ViU3RvcmFnZS4gUmV0dXJucyAnbnVsbCcgaWYgdGhlIHZhbHVlXG4gICAgICogY291bGQgbm90IGJlIHBhcnNlZC5cbiAgICAgKi8gICAgaGkodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gdGhpcy5Hcy5leGVjKHQpLCBzID0gTnVtYmVyKG5bMV0pLCBpID0gdm9pZCAwICE9PSBuWzJdID8gblsyXSA6IG51bGw7XG4gICAgICAgIHJldHVybiBPci4kcyhuZXcgUyhpKSwgcywgZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBhcnNlcyBhIHF1ZXJ5IHRhcmdldCBzdGF0ZSBmcm9tIFdlYlN0b3JhZ2UuIFJldHVybnMgJ251bGwnIGlmIHRoZSB2YWx1ZVxuICAgICAqIGNvdWxkIG5vdCBiZSBwYXJzZWQuXG4gICAgICovICAgIGZpKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMuenMuZXhlYyh0KSwgcyA9IE51bWJlcihuWzFdKTtcbiAgICAgICAgcmV0dXJuIEZyLiRzKHMsIGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQYXJzZXMgYW4gb25saW5lIHN0YXRlIGZyb20gV2ViU3RvcmFnZS4gUmV0dXJucyAnbnVsbCcgaWYgdGhlIHZhbHVlXG4gICAgICogY291bGQgbm90IGJlIHBhcnNlZC5cbiAgICAgKi8gICAgWHModCkge1xuICAgICAgICByZXR1cm4gTHIuJHModCk7XG4gICAgfVxuICAgIGFzeW5jIGxpKHQpIHtcbiAgICAgICAgaWYgKHQudXNlci51aWQgPT09IHRoaXMuY3VycmVudFVzZXIudWlkKSByZXR1cm4gdGhpcy5zeW5jRW5naW5lLl9pKHQuYmF0Y2hJZCwgdC5zdGF0ZSwgdC5lcnJvcik7XG4gICAgICAgIGsoXCJTaGFyZWRDbGllbnRTdGF0ZVwiLCBgSWdub3JpbmcgbXV0YXRpb24gZm9yIG5vbi1hY3RpdmUgdXNlciAke3QudXNlci51aWR9YCk7XG4gICAgfVxuICAgIGRpKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3luY0VuZ2luZS5taSh0LnRhcmdldElkLCB0LnN0YXRlLCB0LmVycm9yKTtcbiAgICB9XG4gICAgY2kodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gZSA/IHRoaXMucXMuaW5zZXJ0KHQsIGUpIDogdGhpcy5xcy5yZW1vdmUodCksIHMgPSB0aGlzLnRpKHRoaXMucXMpLCBpID0gdGhpcy50aShuKSwgciA9IFtdLCBvID0gW107XG4gICAgICAgIHJldHVybiBpLmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgcy5oYXModCkgfHwgci5wdXNoKHQpO1xuICAgICAgICB9KSksIHMuZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICBpLmhhcyh0KSB8fCBvLnB1c2godCk7XG4gICAgICAgIH0pKSwgdGhpcy5zeW5jRW5naW5lLmdpKHIsIG8pLnRoZW4oKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMucXMgPSBuO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIFpzKHQpIHtcbiAgICAgICAgLy8gV2UgY2hlY2sgd2hldGhlciB0aGUgY2xpZW50IHRoYXQgd3JvdGUgdGhpcyBvbmxpbmUgc3RhdGUgaXMgc3RpbGwgYWN0aXZlXG4gICAgICAgIC8vIGJ5IGNvbXBhcmluZyBpdHMgY2xpZW50IElEIHRvIHRoZSBsaXN0IG9mIGNsaWVudHMga2VwdCBhY3RpdmUgaW5cbiAgICAgICAgLy8gSW5kZXhlZERiLiBJZiBhIGNsaWVudCBkb2VzIG5vdCB1cGRhdGUgdGhlaXIgSW5kZXhlZERiIGNsaWVudCBzdGF0ZVxuICAgICAgICAvLyB3aXRoaW4gNSBzZWNvbmRzLCBpdCBpcyBjb25zaWRlcmVkIGluYWN0aXZlIGFuZCB3ZSBkb24ndCBlbWl0IGFuIG9ubGluZVxuICAgICAgICAvLyBzdGF0ZSBldmVudC5cbiAgICAgICAgdGhpcy5xcy5nZXQodC5jbGllbnRJZCkgJiYgdGhpcy5vbmxpbmVTdGF0ZUhhbmRsZXIodC5vbmxpbmVTdGF0ZSk7XG4gICAgfVxuICAgIHRpKHQpIHtcbiAgICAgICAgbGV0IGUgPSB2bigpO1xuICAgICAgICByZXR1cm4gdC5mb3JFYWNoKCgodCwgbikgPT4ge1xuICAgICAgICAgICAgZSA9IGUudW5pb25XaXRoKG4uYWN0aXZlVGFyZ2V0SWRzKTtcbiAgICAgICAgfSkpLCBlO1xuICAgIH1cbn1cblxuY2xhc3MgcXIge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnlpID0gbmV3IEJyLCB0aGlzLnBpID0ge30sIHRoaXMub25saW5lU3RhdGVIYW5kbGVyID0gbnVsbCwgdGhpcy5zZXF1ZW5jZU51bWJlckhhbmRsZXIgPSBudWxsO1xuICAgIH1cbiAgICBhZGRQZW5kaW5nTXV0YXRpb24odCkge1xuICAgICAgICAvLyBObyBvcC5cbiAgICB9XG4gICAgdXBkYXRlTXV0YXRpb25TdGF0ZSh0LCBlLCBuKSB7XG4gICAgICAgIC8vIE5vIG9wLlxuICAgIH1cbiAgICBhZGRMb2NhbFF1ZXJ5VGFyZ2V0KHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMueWkuRnModCksIHRoaXMucGlbdF0gfHwgXCJub3QtY3VycmVudFwiO1xuICAgIH1cbiAgICB1cGRhdGVRdWVyeVN0YXRlKHQsIGUsIG4pIHtcbiAgICAgICAgdGhpcy5waVt0XSA9IGU7XG4gICAgfVxuICAgIHJlbW92ZUxvY2FsUXVlcnlUYXJnZXQodCkge1xuICAgICAgICB0aGlzLnlpLk1zKHQpO1xuICAgIH1cbiAgICBpc0xvY2FsUXVlcnlUYXJnZXQodCkge1xuICAgICAgICByZXR1cm4gdGhpcy55aS5hY3RpdmVUYXJnZXRJZHMuaGFzKHQpO1xuICAgIH1cbiAgICBjbGVhclF1ZXJ5U3RhdGUodCkge1xuICAgICAgICBkZWxldGUgdGhpcy5waVt0XTtcbiAgICB9XG4gICAgZ2V0QWxsQWN0aXZlUXVlcnlUYXJnZXRzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy55aS5hY3RpdmVUYXJnZXRJZHM7XG4gICAgfVxuICAgIGlzQWN0aXZlUXVlcnlUYXJnZXQodCkge1xuICAgICAgICByZXR1cm4gdGhpcy55aS5hY3RpdmVUYXJnZXRJZHMuaGFzKHQpO1xuICAgIH1cbiAgICBzdGFydCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMueWkgPSBuZXcgQnIsIFByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cbiAgICBoYW5kbGVVc2VyQ2hhbmdlKHQsIGUsIG4pIHtcbiAgICAgICAgLy8gTm8gb3AuXG4gICAgfVxuICAgIHNldE9ubGluZVN0YXRlKHQpIHtcbiAgICAgICAgLy8gTm8gb3AuXG4gICAgfVxuICAgIHNodXRkb3duKCkge31cbiAgICB3cml0ZVNlcXVlbmNlTnVtYmVyKHQpIHt9XG4gICAgbm90aWZ5QnVuZGxlTG9hZGVkKCkge1xuICAgICAgICAvLyBObyBvcC5cbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNsYXNzIEtyIHtcbiAgICBFaSh0KSB7XG4gICAgICAgIC8vIE5vLW9wLlxuICAgIH1cbiAgICBzaHV0ZG93bigpIHtcbiAgICAgICAgLy8gTm8tb3AuXG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLy8gUmVmZXJlbmNlcyB0byBgd2luZG93YCBhcmUgZ3VhcmRlZCBieSBCcm93c2VyQ29ubmVjdGl2aXR5TW9uaXRvci5pc0F2YWlsYWJsZSgpXG4vKiBlc2xpbnQtZGlzYWJsZSBuby1yZXN0cmljdGVkLWdsb2JhbHMgKi9cbi8qKlxuICogQnJvd3NlciBpbXBsZW1lbnRhdGlvbiBvZiBDb25uZWN0aXZpdHlNb25pdG9yLlxuICovXG5jbGFzcyBqciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuVGkgPSAoKSA9PiB0aGlzLklpKCksIHRoaXMuQWkgPSAoKSA9PiB0aGlzLlJpKCksIHRoaXMuUGkgPSBbXSwgdGhpcy5iaSgpO1xuICAgIH1cbiAgICBFaSh0KSB7XG4gICAgICAgIHRoaXMuUGkucHVzaCh0KTtcbiAgICB9XG4gICAgc2h1dGRvd24oKSB7XG4gICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwib25saW5lXCIsIHRoaXMuVGkpLCB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm9mZmxpbmVcIiwgdGhpcy5BaSk7XG4gICAgfVxuICAgIGJpKCkge1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm9ubGluZVwiLCB0aGlzLlRpKSwgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJvZmZsaW5lXCIsIHRoaXMuQWkpO1xuICAgIH1cbiAgICBJaSgpIHtcbiAgICAgICAgayhcIkNvbm5lY3Rpdml0eU1vbml0b3JcIiwgXCJOZXR3b3JrIGNvbm5lY3Rpdml0eSBjaGFuZ2VkOiBBVkFJTEFCTEVcIik7XG4gICAgICAgIGZvciAoY29uc3QgdCBvZiB0aGlzLlBpKSB0KDAgLyogQVZBSUxBQkxFICovKTtcbiAgICB9XG4gICAgUmkoKSB7XG4gICAgICAgIGsoXCJDb25uZWN0aXZpdHlNb25pdG9yXCIsIFwiTmV0d29yayBjb25uZWN0aXZpdHkgY2hhbmdlZDogVU5BVkFJTEFCTEVcIik7XG4gICAgICAgIGZvciAoY29uc3QgdCBvZiB0aGlzLlBpKSB0KDEgLyogVU5BVkFJTEFCTEUgKi8pO1xuICAgIH1cbiAgICAvLyBUT0RPKGNoZW5icmlhbik6IENvbnNpZGVyIHBhc3NpbmcgaW4gd2luZG93IGVpdGhlciBpbnRvIHRoaXMgY29tcG9uZW50IG9yXG4gICAgLy8gaGVyZSBmb3IgdGVzdGluZyB2aWEgRmFrZVdpbmRvdy5cbiAgICAvKiogQ2hlY2tzIHRoYXQgYWxsIHVzZWQgYXR0cmlidXRlcyBvZiB3aW5kb3cgYXJlIGF2YWlsYWJsZS4gKi9cbiAgICBzdGF0aWMgUHQoKSB7XG4gICAgICAgIHJldHVybiBcInVuZGVmaW5lZFwiICE9IHR5cGVvZiB3aW5kb3cgJiYgdm9pZCAwICE9PSB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciAmJiB2b2lkIDAgIT09IHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY29uc3QgUXIgPSB7XG4gICAgQmF0Y2hHZXREb2N1bWVudHM6IFwiYmF0Y2hHZXRcIixcbiAgICBDb21taXQ6IFwiY29tbWl0XCIsXG4gICAgUnVuUXVlcnk6IFwicnVuUXVlcnlcIlxufTtcblxuLyoqXG4gKiBNYXBzIFJQQyBuYW1lcyB0byB0aGUgY29ycmVzcG9uZGluZyBSRVNUIGVuZHBvaW50IG5hbWUuXG4gKlxuICogV2UgdXNlIGFycmF5IG5vdGF0aW9uIHRvIGF2b2lkIG1hbmdsaW5nLlxuICovXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBQcm92aWRlcyBhIHNpbXBsZSBoZWxwZXIgY2xhc3MgdGhhdCBpbXBsZW1lbnRzIHRoZSBTdHJlYW0gaW50ZXJmYWNlIHRvXG4gKiBicmlkZ2UgdG8gb3RoZXIgaW1wbGVtZW50YXRpb25zIHRoYXQgYXJlIHN0cmVhbXMgYnV0IGRvIG5vdCBpbXBsZW1lbnQgdGhlXG4gKiBpbnRlcmZhY2UuIFRoZSBzdHJlYW0gY2FsbGJhY2tzIGFyZSBpbnZva2VkIHdpdGggdGhlIGNhbGxPbi4uLiBtZXRob2RzLlxuICovXG5jbGFzcyBXciB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLnZpID0gdC52aSwgdGhpcy5WaSA9IHQuVmk7XG4gICAgfVxuICAgIFNpKHQpIHtcbiAgICAgICAgdGhpcy5EaSA9IHQ7XG4gICAgfVxuICAgIENpKHQpIHtcbiAgICAgICAgdGhpcy5OaSA9IHQ7XG4gICAgfVxuICAgIG9uTWVzc2FnZSh0KSB7XG4gICAgICAgIHRoaXMueGkgPSB0O1xuICAgIH1cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgdGhpcy5WaSgpO1xuICAgIH1cbiAgICBzZW5kKHQpIHtcbiAgICAgICAgdGhpcy52aSh0KTtcbiAgICB9XG4gICAga2koKSB7XG4gICAgICAgIHRoaXMuRGkoKTtcbiAgICB9XG4gICAgJGkodCkge1xuICAgICAgICB0aGlzLk5pKHQpO1xuICAgIH1cbiAgICBPaSh0KSB7XG4gICAgICAgIHRoaXMueGkodCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjbGFzcyBHciBleHRlbmRzIFxuLyoqXG4gKiBCYXNlIGNsYXNzIGZvciBhbGwgUmVzdC1iYXNlZCBjb25uZWN0aW9ucyB0byB0aGUgYmFja2VuZCAoV2ViQ2hhbm5lbCBhbmRcbiAqIEhUVFApLlxuICovXG5jbGFzcyB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLmRhdGFiYXNlSW5mbyA9IHQsIHRoaXMuZGF0YWJhc2VJZCA9IHQuZGF0YWJhc2VJZDtcbiAgICAgICAgY29uc3QgZSA9IHQuc3NsID8gXCJodHRwc1wiIDogXCJodHRwXCI7XG4gICAgICAgIHRoaXMuRmkgPSBlICsgXCI6Ly9cIiArIHQuaG9zdCwgdGhpcy5NaSA9IFwicHJvamVjdHMvXCIgKyB0aGlzLmRhdGFiYXNlSWQucHJvamVjdElkICsgXCIvZGF0YWJhc2VzL1wiICsgdGhpcy5kYXRhYmFzZUlkLmRhdGFiYXNlICsgXCIvZG9jdW1lbnRzXCI7XG4gICAgfVxuICAgIExpKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgY29uc3QgaSA9IHRoaXMuQmkodCwgZSk7XG4gICAgICAgIGsoXCJSZXN0Q29ubmVjdGlvblwiLCBcIlNlbmRpbmc6IFwiLCBpLCBuKTtcbiAgICAgICAgY29uc3QgciA9IHt9O1xuICAgICAgICByZXR1cm4gdGhpcy5VaShyLCBzKSwgdGhpcy5xaSh0LCBpLCByLCBuKS50aGVuKCh0ID0+IChrKFwiUmVzdENvbm5lY3Rpb25cIiwgXCJSZWNlaXZlZDogXCIsIHQpLCBcbiAgICAgICAgdCkpLCAoZSA9PiB7XG4gICAgICAgICAgICB0aHJvdyBPKFwiUmVzdENvbm5lY3Rpb25cIiwgYCR7dH0gZmFpbGVkIHdpdGggZXJyb3I6IGAsIGUsIFwidXJsOiBcIiwgaSwgXCJyZXF1ZXN0OlwiLCBuKSwgXG4gICAgICAgICAgICBlO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIEtpKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgLy8gVGhlIFJFU1QgQVBJIGF1dG9tYXRpY2FsbHkgYWdncmVnYXRlcyBhbGwgb2YgdGhlIHN0cmVhbWVkIHJlc3VsdHMsIHNvIHdlXG4gICAgICAgIC8vIGNhbiBqdXN0IHVzZSB0aGUgbm9ybWFsIGludm9rZSgpIG1ldGhvZC5cbiAgICAgICAgcmV0dXJuIHRoaXMuTGkodCwgZSwgbiwgcyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE1vZGlmaWVzIHRoZSBoZWFkZXJzIGZvciBhIHJlcXVlc3QsIGFkZGluZyBhbnkgYXV0aG9yaXphdGlvbiB0b2tlbiBpZlxuICAgICAqIHByZXNlbnQgYW5kIGFueSBhZGRpdGlvbmFsIGhlYWRlcnMgZm9yIHRoZSByZXF1ZXN0LlxuICAgICAqLyAgICBVaSh0LCBlKSB7XG4gICAgICAgIGlmICh0W1wiWC1Hb29nLUFwaS1DbGllbnRcIl0gPSBcImdsLWpzLyBmaXJlL1wiICsgRCwgXG4gICAgICAgIC8vIENvbnRlbnQtVHlwZTogdGV4dC9wbGFpbiB3aWxsIGF2b2lkIHByZWZsaWdodCByZXF1ZXN0cyB3aGljaCBtaWdodFxuICAgICAgICAvLyBtZXNzIHdpdGggQ09SUyBhbmQgcmVkaXJlY3RzIGJ5IHByb3hpZXMuIElmIHdlIGFkZCBjdXN0b20gaGVhZGVyc1xuICAgICAgICAvLyB3ZSB3aWxsIG5lZWQgdG8gY2hhbmdlIHRoaXMgY29kZSB0byBwb3RlbnRpYWxseSB1c2UgdGhlICRodHRwT3ZlcndyaXRlXG4gICAgICAgIC8vIHBhcmFtZXRlciBzdXBwb3J0ZWQgYnkgRVNGIHRvIGF2b2lkIHRyaWdnZXJpbmcgcHJlZmxpZ2h0IHJlcXVlc3RzLlxuICAgICAgICB0W1wiQ29udGVudC1UeXBlXCJdID0gXCJ0ZXh0L3BsYWluXCIsIHRoaXMuZGF0YWJhc2VJbmZvLmFwcElkICYmICh0W1wiWC1GaXJlYmFzZS1HTVBJRFwiXSA9IHRoaXMuZGF0YWJhc2VJbmZvLmFwcElkKSwgXG4gICAgICAgIGUpIGZvciAoY29uc3QgbiBpbiBlLmF1dGhIZWFkZXJzKSBlLmF1dGhIZWFkZXJzLmhhc093blByb3BlcnR5KG4pICYmICh0W25dID0gZS5hdXRoSGVhZGVyc1tuXSk7XG4gICAgfVxuICAgIEJpKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IFFyW3RdO1xuICAgICAgICByZXR1cm4gYCR7dGhpcy5GaX0vdjEvJHtlfToke259YDtcbiAgICB9XG59IHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHN1cGVyKHQpLCB0aGlzLmZvcmNlTG9uZ1BvbGxpbmcgPSB0LmZvcmNlTG9uZ1BvbGxpbmcsIHRoaXMuYXV0b0RldGVjdExvbmdQb2xsaW5nID0gdC5hdXRvRGV0ZWN0TG9uZ1BvbGxpbmcsIFxuICAgICAgICB0aGlzLnVzZUZldGNoU3RyZWFtcyA9IHQudXNlRmV0Y2hTdHJlYW1zO1xuICAgIH1cbiAgICBxaSh0LCBlLCBuLCBzKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgoKGksIHIpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG8gPSBuZXcgRTtcbiAgICAgICAgICAgIG8ubGlzdGVuT25jZShULkNPTVBMRVRFLCAoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoby5nZXRMYXN0RXJyb3JDb2RlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICBjYXNlIEkuTk9fRVJST1I6XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gby5nZXRSZXNwb25zZUpzb24oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGsoXCJDb25uZWN0aW9uXCIsIFwiWEhSIHJlY2VpdmVkOlwiLCBKU09OLnN0cmluZ2lmeShlKSksIGkoZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICAgIGNhc2UgSS5USU1FT1VUOlxuICAgICAgICAgICAgICAgICAgICAgICAgayhcIkNvbm5lY3Rpb25cIiwgJ1JQQyBcIicgKyB0ICsgJ1wiIHRpbWVkIG91dCcpLCByKG5ldyBLKHEuREVBRExJTkVfRVhDRUVERUQsIFwiUmVxdWVzdCB0aW1lIG91dFwiKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICAgIGNhc2UgSS5IVFRQX0VSUk9SOlxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IG8uZ2V0U3RhdHVzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoayhcIkNvbm5lY3Rpb25cIiwgJ1JQQyBcIicgKyB0ICsgJ1wiIGZhaWxlZCB3aXRoIHN0YXR1czonLCBuLCBcInJlc3BvbnNlIHRleHQ6XCIsIG8uZ2V0UmVzcG9uc2VUZXh0KCkpLCBcbiAgICAgICAgICAgICAgICAgICAgICAgIG4gPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IG8uZ2V0UmVzcG9uc2VKc29uKCkuZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgdC5zdGF0dXMgJiYgdC5tZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gdC50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL18vZywgXCItXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC52YWx1ZXMocSkuaW5kZXhPZihlKSA+PSAwID8gZSA6IHEuVU5LTk9XTjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSh0LnN0YXR1cyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHIobmV3IEsoZSwgdC5tZXNzYWdlKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHIobmV3IEsocS5VTktOT1dOLCBcIlNlcnZlciByZXNwb25kZWQgd2l0aCBzdGF0dXMgXCIgKyBvLmdldFN0YXR1cygpKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB3ZSByZWNlaXZlZCBhbiBIVFRQX0VSUk9SIGJ1dCB0aGVyZSdzIG5vIHN0YXR1cyBjb2RlLFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaXQncyBtb3N0IHByb2JhYmx5IGEgY29ubmVjdGlvbiBpc3N1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgcihuZXcgSyhxLlVOQVZBSUxBQkxFLCBcIkNvbm5lY3Rpb24gZmFpbGVkLlwiKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBNKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgICAgICAgICBrKFwiQ29ubmVjdGlvblwiLCAnUlBDIFwiJyArIHQgKyAnXCIgY29tcGxldGVkLicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIGNvbnN0IGEgPSBKU09OLnN0cmluZ2lmeShzKTtcbiAgICAgICAgICAgIG8uc2VuZChlLCBcIlBPU1RcIiwgYSwgbiwgMTUpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGppKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IFsgdGhpcy5GaSwgXCIvXCIsIFwiZ29vZ2xlLmZpcmVzdG9yZS52MS5GaXJlc3RvcmVcIiwgXCIvXCIsIHQsIFwiL2NoYW5uZWxcIiBdLCBzID0gQSgpLCBpID0gUigpLCByID0ge1xuICAgICAgICAgICAgLy8gUmVxdWlyZWQgZm9yIGJhY2tlbmQgc3RpY2tpbmVzcywgcm91dGluZyBiZWhhdmlvciBpcyBiYXNlZCBvbiB0aGlzXG4gICAgICAgICAgICAvLyBwYXJhbWV0ZXIuXG4gICAgICAgICAgICBodHRwU2Vzc2lvbklkUGFyYW06IFwiZ3Nlc3Npb25pZFwiLFxuICAgICAgICAgICAgaW5pdE1lc3NhZ2VIZWFkZXJzOiB7fSxcbiAgICAgICAgICAgIG1lc3NhZ2VVcmxQYXJhbXM6IHtcbiAgICAgICAgICAgICAgICAvLyBUaGlzIHBhcmFtIGlzIHVzZWQgdG8gaW1wcm92ZSByb3V0aW5nIGFuZCBwcm9qZWN0IGlzb2xhdGlvbiBieSB0aGVcbiAgICAgICAgICAgICAgICAvLyBiYWNrZW5kIGFuZCBtdXN0IGJlIGluY2x1ZGVkIGluIGV2ZXJ5IHJlcXVlc3QuXG4gICAgICAgICAgICAgICAgZGF0YWJhc2U6IGBwcm9qZWN0cy8ke3RoaXMuZGF0YWJhc2VJZC5wcm9qZWN0SWR9L2RhdGFiYXNlcy8ke3RoaXMuZGF0YWJhc2VJZC5kYXRhYmFzZX1gXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2VuZFJhd0pzb246ICEwLFxuICAgICAgICAgICAgc3VwcG9ydHNDcm9zc0RvbWFpblhocjogITAsXG4gICAgICAgICAgICBpbnRlcm5hbENoYW5uZWxQYXJhbXM6IHtcbiAgICAgICAgICAgICAgICAvLyBPdmVycmlkZSB0aGUgZGVmYXVsdCB0aW1lb3V0IChyYW5kb21pemVkIGJldHdlZW4gMTAtMjAgc2Vjb25kcykgc2luY2VcbiAgICAgICAgICAgICAgICAvLyBhIGxhcmdlIHdyaXRlIGJhdGNoIG9uIGEgc2xvdyBpbnRlcm5ldCBjb25uZWN0aW9uIG1heSB0YWtlIGEgbG9uZ1xuICAgICAgICAgICAgICAgIC8vIHRpbWUgdG8gc2VuZCB0byB0aGUgYmFja2VuZC4gUmF0aGVyIHRoYW4gaGF2ZSBXZWJDaGFubmVsIGltcG9zZSBhXG4gICAgICAgICAgICAgICAgLy8gdGlnaHQgdGltZW91dCB3aGljaCBjb3VsZCBsZWFkIHRvIGluZmluaXRlIHRpbWVvdXRzIGFuZCByZXRyaWVzLCB3ZVxuICAgICAgICAgICAgICAgIC8vIHNldCBpdCB2ZXJ5IGxhcmdlICg1LTEwIG1pbnV0ZXMpIGFuZCByZWx5IG9uIHRoZSBicm93c2VyJ3MgYnVpbHRpblxuICAgICAgICAgICAgICAgIC8vIHRpbWVvdXRzIHRvIGtpY2sgaW4gaWYgdGhlIHJlcXVlc3QgaXNuJ3Qgd29ya2luZy5cbiAgICAgICAgICAgICAgICBmb3J3YXJkQ2hhbm5lbFJlcXVlc3RUaW1lb3V0TXM6IDZlNVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGZvcmNlTG9uZ1BvbGxpbmc6IHRoaXMuZm9yY2VMb25nUG9sbGluZyxcbiAgICAgICAgICAgIGRldGVjdEJ1ZmZlcmluZ1Byb3h5OiB0aGlzLmF1dG9EZXRlY3RMb25nUG9sbGluZ1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLnVzZUZldGNoU3RyZWFtcyAmJiAoci54bWxIdHRwRmFjdG9yeSA9IG5ldyBQKHt9KSksIHRoaXMuVWkoci5pbml0TWVzc2FnZUhlYWRlcnMsIGUpLCBcbiAgICAgICAgLy8gU2VuZGluZyB0aGUgY3VzdG9tIGhlYWRlcnMgd2UganVzdCBhZGRlZCB0byByZXF1ZXN0LmluaXRNZXNzYWdlSGVhZGVyc1xuICAgICAgICAvLyAoQXV0aG9yaXphdGlvbiwgZXRjLikgd2lsbCB0cmlnZ2VyIHRoZSBicm93c2VyIHRvIG1ha2UgYSBDT1JTIHByZWZsaWdodFxuICAgICAgICAvLyByZXF1ZXN0IGJlY2F1c2UgdGhlIFhIUiB3aWxsIG5vIGxvbmdlciBtZWV0IHRoZSBjcml0ZXJpYSBmb3IgYSBcInNpbXBsZVwiXG4gICAgICAgIC8vIENPUlMgcmVxdWVzdDpcbiAgICAgICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSFRUUC9DT1JTI1NpbXBsZV9yZXF1ZXN0c1xuICAgICAgICAvLyBUaGVyZWZvcmUgdG8gYXZvaWQgdGhlIENPUlMgcHJlZmxpZ2h0IHJlcXVlc3QgKGFuIGV4dHJhIG5ldHdvcmtcbiAgICAgICAgLy8gcm91bmR0cmlwKSwgd2UgdXNlIHRoZSBodHRwSGVhZGVyc092ZXJ3cml0ZVBhcmFtIG9wdGlvbiB0byBzcGVjaWZ5IHRoYXRcbiAgICAgICAgLy8gdGhlIGhlYWRlcnMgc2hvdWxkIGluc3RlYWQgYmUgZW5jb2RlZCBpbnRvIGEgc3BlY2lhbCBcIiRodHRwSGVhZGVyc1wiIHF1ZXJ5XG4gICAgICAgIC8vIHBhcmFtZXRlciwgd2hpY2ggaXMgcmVjb2duaXplZCBieSB0aGUgd2ViY2hhbm5lbCBiYWNrZW5kLiBUaGlzIGlzXG4gICAgICAgIC8vIGZvcm1hbGx5IGRlZmluZWQgaGVyZTpcbiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2dvb2dsZS9jbG9zdXJlLWxpYnJhcnkvYmxvYi9iMGUxODE1YjEzZmI5MmE0NmQ3YzliM2MzMGRlNWQ2YTM5NmEzMjQ1L2Nsb3N1cmUvZ29vZy9uZXQvcnBjL2h0dHBjb3JzLmpzI0wzMlxuICAgICAgICAvLyBUT0RPKGIvMTQ1NjI0NzU2KTogVGhlcmUgaXMgYSBiYWNrZW5kIGJ1ZyB3aGVyZSAkaHR0cEhlYWRlcnMgaXNuJ3QgcmVzcGVjdGVkIGlmIHRoZSByZXF1ZXN0XG4gICAgICAgIC8vIGRvZXNuJ3QgaGF2ZSBhbiBPcmlnaW4gaGVhZGVyLiBTbyB3ZSBoYXZlIHRvIGV4Y2x1ZGUgYSBmZXcgYnJvd3NlciBlbnZpcm9ubWVudHMgdGhhdCBhcmVcbiAgICAgICAgLy8ga25vd24gdG8gKHNvbWV0aW1lcykgbm90IGluY2x1ZGUgYW4gT3JpZ2luLiBTZWVcbiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2ZpcmViYXNlL2ZpcmViYXNlLWpzLXNkay9pc3N1ZXMvMTQ5MS5cbiAgICAgICAgbCgpIHx8IGYoKSB8fCBkKCkgfHwgdygpIHx8IF8oKSB8fCBtKCkgfHwgKHIuaHR0cEhlYWRlcnNPdmVyd3JpdGVQYXJhbSA9IFwiJGh0dHBIZWFkZXJzXCIpO1xuICAgICAgICBjb25zdCBvID0gbi5qb2luKFwiXCIpO1xuICAgICAgICBrKFwiQ29ubmVjdGlvblwiLCBcIkNyZWF0aW5nIFdlYkNoYW5uZWw6IFwiICsgbywgcik7XG4gICAgICAgIGNvbnN0IGEgPSBzLmNyZWF0ZVdlYkNoYW5uZWwobywgcik7XG4gICAgICAgIC8vIFdlYkNoYW5uZWwgc3VwcG9ydHMgc2VuZGluZyB0aGUgZmlyc3QgbWVzc2FnZSB3aXRoIHRoZSBoYW5kc2hha2UgLSBzYXZpbmdcbiAgICAgICAgLy8gYSBuZXR3b3JrIHJvdW5kIHRyaXAuIEhvd2V2ZXIsIGl0IHdpbGwgaGF2ZSB0byBjYWxsIHNlbmQgaW4gdGhlIHNhbWVcbiAgICAgICAgLy8gSlMgZXZlbnQgbG9vcCBhcyBvcGVuLiBJbiBvcmRlciB0byBlbmZvcmNlIHRoaXMsIHdlIGRlbGF5IGFjdHVhbGx5XG4gICAgICAgIC8vIG9wZW5pbmcgdGhlIFdlYkNoYW5uZWwgdW50aWwgc2VuZCBpcyBjYWxsZWQuIFdoZXRoZXIgd2UgaGF2ZSBjYWxsZWRcbiAgICAgICAgLy8gb3BlbiBpcyB0cmFja2VkIHdpdGggdGhpcyB2YXJpYWJsZS5cbiAgICAgICAgICAgICAgICBsZXQgYyA9ICExLCB1ID0gITE7XG4gICAgICAgIC8vIEEgZmxhZyB0byBkZXRlcm1pbmUgd2hldGhlciB0aGUgc3RyZWFtIHdhcyBjbG9zZWQgKGJ5IHVzIG9yIHRocm91Z2ggYW5cbiAgICAgICAgLy8gZXJyb3IvY2xvc2UgZXZlbnQpIHRvIGF2b2lkIGRlbGl2ZXJpbmcgbXVsdGlwbGUgY2xvc2UgZXZlbnRzIG9yIHNlbmRpbmdcbiAgICAgICAgLy8gb24gYSBjbG9zZWQgc3RyZWFtXG4gICAgICAgICAgICAgICAgY29uc3QgaCA9IG5ldyBXcih7XG4gICAgICAgICAgICB2aTogdCA9PiB7XG4gICAgICAgICAgICAgICAgdSA/IGsoXCJDb25uZWN0aW9uXCIsIFwiTm90IHNlbmRpbmcgYmVjYXVzZSBXZWJDaGFubmVsIGlzIGNsb3NlZDpcIiwgdCkgOiAoYyB8fCAoayhcIkNvbm5lY3Rpb25cIiwgXCJPcGVuaW5nIFdlYkNoYW5uZWwgdHJhbnNwb3J0LlwiKSwgXG4gICAgICAgICAgICAgICAgYS5vcGVuKCksIGMgPSAhMCksIGsoXCJDb25uZWN0aW9uXCIsIFwiV2ViQ2hhbm5lbCBzZW5kaW5nOlwiLCB0KSwgYS5zZW5kKHQpKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBWaTogKCkgPT4gYS5jbG9zZSgpXG4gICAgICAgIH0pLCBnID0gKHQsIGUsIG4pID0+IHtcbiAgICAgICAgICAgIC8vIFRPRE8oZGltb25kKTogY2xvc3VyZSB0eXBpbmcgc2VlbXMgYnJva2VuIGJlY2F1c2UgV2ViQ2hhbm5lbCBkb2VzXG4gICAgICAgICAgICAvLyBub3QgaW1wbGVtZW50IGdvb2cuZXZlbnRzLkxpc3RlbmFibGVcbiAgICAgICAgICAgIHQubGlzdGVuKGUsICh0ID0+IHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBuKHQpO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgdDtcbiAgICAgICAgICAgICAgICAgICAgfSksIDApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfTtcbiAgICAgICAgLy8gQ2xvc3VyZSBldmVudHMgYXJlIGd1YXJkZWQgYW5kIGV4Y2VwdGlvbnMgYXJlIHN3YWxsb3dlZCwgc28gY2F0Y2ggYW55XG4gICAgICAgIC8vIGV4Y2VwdGlvbiBhbmQgcmV0aHJvdyB1c2luZyBhIHNldFRpbWVvdXQgc28gdGhleSBiZWNvbWUgdmlzaWJsZSBhZ2Fpbi5cbiAgICAgICAgLy8gTm90ZSB0aGF0IGV2ZW50dWFsbHkgdGhpcyBmdW5jdGlvbiBjb3VsZCBnbyBhd2F5IGlmIHdlIGFyZSBjb25maWRlbnRcbiAgICAgICAgLy8gZW5vdWdoIHRoZSBjb2RlIGlzIGV4Y2VwdGlvbiBmcmVlLlxuICAgICAgICAgICAgICAgIHJldHVybiBnKGEsIGIuRXZlbnRUeXBlLk9QRU4sICgoKSA9PiB7XG4gICAgICAgICAgICB1IHx8IGsoXCJDb25uZWN0aW9uXCIsIFwiV2ViQ2hhbm5lbCB0cmFuc3BvcnQgb3BlbmVkLlwiKTtcbiAgICAgICAgfSkpLCBnKGEsIGIuRXZlbnRUeXBlLkNMT1NFLCAoKCkgPT4ge1xuICAgICAgICAgICAgdSB8fCAodSA9ICEwLCBrKFwiQ29ubmVjdGlvblwiLCBcIldlYkNoYW5uZWwgdHJhbnNwb3J0IGNsb3NlZFwiKSwgaC4kaSgpKTtcbiAgICAgICAgfSkpLCBnKGEsIGIuRXZlbnRUeXBlLkVSUk9SLCAodCA9PiB7XG4gICAgICAgICAgICB1IHx8ICh1ID0gITAsIE8oXCJDb25uZWN0aW9uXCIsIFwiV2ViQ2hhbm5lbCB0cmFuc3BvcnQgZXJyb3JlZDpcIiwgdCksIGguJGkobmV3IEsocS5VTkFWQUlMQUJMRSwgXCJUaGUgb3BlcmF0aW9uIGNvdWxkIG5vdCBiZSBjb21wbGV0ZWRcIikpKTtcbiAgICAgICAgfSkpLCBnKGEsIGIuRXZlbnRUeXBlLk1FU1NBR0UsICh0ID0+IHtcbiAgICAgICAgICAgIHZhciBlO1xuICAgICAgICAgICAgaWYgKCF1KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHQuZGF0YVswXTtcbiAgICAgICAgICAgICAgICBMKCEhbik7XG4gICAgICAgICAgICAgICAgLy8gVE9ETyhiLzM1MTQzODkxKTogVGhlcmUgaXMgYSBidWcgaW4gT25lIFBsYXRmb3JtIHRoYXQgY2F1c2VkIGVycm9yc1xuICAgICAgICAgICAgICAgIC8vIChhbmQgb25seSBlcnJvcnMpIHRvIGJlIHdyYXBwZWQgaW4gYW4gZXh0cmEgYXJyYXkuIFRvIGJlIGZvcndhcmRcbiAgICAgICAgICAgICAgICAvLyBjb21wYXRpYmxlIHdpdGggdGhlIGJ1ZyB3ZSBuZWVkIHRvIGNoZWNrIGVpdGhlciBjb25kaXRpb24uIFRoZSBsYXR0ZXJcbiAgICAgICAgICAgICAgICAvLyBjYW4gYmUgcmVtb3ZlZCBvbmNlIHRoZSBmaXggaGFzIGJlZW4gcm9sbGVkIG91dC5cbiAgICAgICAgICAgICAgICAvLyBVc2UgYW55IGJlY2F1c2UgbXNnRGF0YS5lcnJvciBpcyBub3QgdHlwZWQuXG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IG4sIGkgPSBzLmVycm9yIHx8IChudWxsID09PSAoZSA9IHNbMF0pIHx8IHZvaWQgMCA9PT0gZSA/IHZvaWQgMCA6IGUuZXJyb3IpO1xuICAgICAgICAgICAgICAgIGlmIChpKSB7XG4gICAgICAgICAgICAgICAgICAgIGsoXCJDb25uZWN0aW9uXCIsIFwiV2ViQ2hhbm5lbCByZWNlaXZlZCBlcnJvcjpcIiwgaSk7XG4gICAgICAgICAgICAgICAgICAgIC8vIGVycm9yLnN0YXR1cyB3aWxsIGJlIGEgc3RyaW5nIGxpa2UgJ09LJyBvciAnTk9UX0ZPVU5EJy5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGkuc3RhdHVzO1xuICAgICAgICAgICAgICAgICAgICBsZXQgZSA9IFxuICAgICAgICAgICAgICAgICAgICAvKipcbiAqIE1hcHMgYW4gZXJyb3IgQ29kZSBmcm9tIGEgR1JQQyBzdGF0dXMgaWRlbnRpZmllciBsaWtlICdOT1RfRk9VTkQnLlxuICpcbiAqIEByZXR1cm5zIFRoZSBDb2RlIGVxdWl2YWxlbnQgdG8gdGhlIGdpdmVuIHN0YXR1cyBzdHJpbmcgb3IgdW5kZWZpbmVkIGlmXG4gKiAgICAgdGhlcmUgaXMgbm8gbWF0Y2guXG4gKi9cbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbG9va3VwIGJ5IHN0cmluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB1blt0XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2b2lkIDAgIT09IGUpIHJldHVybiBmbihlKTtcbiAgICAgICAgICAgICAgICAgICAgfSh0KSwgbiA9IGkubWVzc2FnZTtcbiAgICAgICAgICAgICAgICAgICAgdm9pZCAwID09PSBlICYmIChlID0gcS5JTlRFUk5BTCwgbiA9IFwiVW5rbm93biBlcnJvciBzdGF0dXM6IFwiICsgdCArIFwiIHdpdGggbWVzc2FnZSBcIiArIGkubWVzc2FnZSksIFxuICAgICAgICAgICAgICAgICAgICAvLyBNYXJrIGNsb3NlZCBzbyBubyBmdXJ0aGVyIGV2ZW50cyBhcmUgcHJvcGFnYXRlZFxuICAgICAgICAgICAgICAgICAgICB1ID0gITAsIGguJGkobmV3IEsoZSwgbikpLCBhLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGsoXCJDb25uZWN0aW9uXCIsIFwiV2ViQ2hhbm5lbCByZWNlaXZlZDpcIiwgbiksIGguT2kobik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKSwgZyhpLCB2LlNUQVRfRVZFTlQsICh0ID0+IHtcbiAgICAgICAgICAgIHQuc3RhdCA9PT0gVi5QUk9YWSA/IGsoXCJDb25uZWN0aW9uXCIsIFwiRGV0ZWN0ZWQgYnVmZmVyaW5nIHByb3h5XCIpIDogdC5zdGF0ID09PSBWLk5PUFJPWFkgJiYgayhcIkNvbm5lY3Rpb25cIiwgXCJEZXRlY3RlZCBubyBidWZmZXJpbmcgcHJveHlcIik7XG4gICAgICAgIH0pKSwgc2V0VGltZW91dCgoKCkgPT4ge1xuICAgICAgICAgICAgLy8gVGVjaG5pY2FsbHkgd2UgY291bGQvc2hvdWxkIHdhaXQgZm9yIHRoZSBXZWJDaGFubmVsIG9wZW5lZCBldmVudCxcbiAgICAgICAgICAgIC8vIGJ1dCBiZWNhdXNlIHdlIHdhbnQgdG8gc2VuZCB0aGUgZmlyc3QgbWVzc2FnZSB3aXRoIHRoZSBXZWJDaGFubmVsXG4gICAgICAgICAgICAvLyBoYW5kc2hha2Ugd2UgcHJldGVuZCB0aGUgY2hhbm5lbCBvcGVuZWQgaGVyZSAoYXN5bmNocm9ub3VzbHkpLCBhbmRcbiAgICAgICAgICAgIC8vIHRoZW4gZGVsYXkgdGhlIGFjdHVhbCBvcGVuIHVudGlsIHRoZSBmaXJzdCBtZXNzYWdlIGlzIHNlbnQuXG4gICAgICAgICAgICBoLmtpKCk7XG4gICAgICAgIH0pLCAwKSwgaDtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKiogSW5pdGlhbGl6ZXMgdGhlIFdlYkNoYW5uZWxDb25uZWN0aW9uIGZvciB0aGUgYnJvd3Nlci4gKi9cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKiogVGhlIFBsYXRmb3JtJ3MgJ3dpbmRvdycgaW1wbGVtZW50YXRpb24gb3IgbnVsbCBpZiBub3QgYXZhaWxhYmxlLiAqL1xuZnVuY3Rpb24genIoKSB7XG4gICAgLy8gYHdpbmRvd2AgaXMgbm90IGFsd2F5cyBhdmFpbGFibGUsIGUuZy4gaW4gUmVhY3ROYXRpdmUgYW5kIFdlYldvcmtlcnMuXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXJlc3RyaWN0ZWQtZ2xvYmFsc1xuICAgIHJldHVybiBcInVuZGVmaW5lZFwiICE9IHR5cGVvZiB3aW5kb3cgPyB3aW5kb3cgOiBudWxsO1xufVxuXG4vKiogVGhlIFBsYXRmb3JtJ3MgJ2RvY3VtZW50JyBpbXBsZW1lbnRhdGlvbiBvciBudWxsIGlmIG5vdCBhdmFpbGFibGUuICovIGZ1bmN0aW9uIEhyKCkge1xuICAgIC8vIGBkb2N1bWVudGAgaXMgbm90IGFsd2F5cyBhdmFpbGFibGUsIGUuZy4gaW4gUmVhY3ROYXRpdmUgYW5kIFdlYldvcmtlcnMuXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXJlc3RyaWN0ZWQtZ2xvYmFsc1xuICAgIHJldHVybiBcInVuZGVmaW5lZFwiICE9IHR5cGVvZiBkb2N1bWVudCA/IGRvY3VtZW50IDogbnVsbDtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gZnVuY3Rpb24gSnIodCkge1xuICAgIHJldHVybiBuZXcgTG4odCwgLyogdXNlUHJvdG8zSnNvbj0gKi8gITApO1xufVxuXG4vKipcbiAqIEFuIGluc3RhbmNlIG9mIHRoZSBQbGF0Zm9ybSdzICdUZXh0RW5jb2RlcicgaW1wbGVtZW50YXRpb24uXG4gKi9cbi8qKlxuICogQSBoZWxwZXIgZm9yIHJ1bm5pbmcgZGVsYXllZCB0YXNrcyBmb2xsb3dpbmcgYW4gZXhwb25lbnRpYWwgYmFja29mZiBjdXJ2ZVxuICogYmV0d2VlbiBhdHRlbXB0cy5cbiAqXG4gKiBFYWNoIGRlbGF5IGlzIG1hZGUgdXAgb2YgYSBcImJhc2VcIiBkZWxheSB3aGljaCBmb2xsb3dzIHRoZSBleHBvbmVudGlhbFxuICogYmFja29mZiBjdXJ2ZSwgYW5kIGEgKy8tIDUwJSBcImppdHRlclwiIHRoYXQgaXMgY2FsY3VsYXRlZCBhbmQgYWRkZWQgdG8gdGhlXG4gKiBiYXNlIGRlbGF5LiBUaGlzIHByZXZlbnRzIGNsaWVudHMgZnJvbSBhY2NpZGVudGFsbHkgc3luY2hyb25pemluZyB0aGVpclxuICogZGVsYXlzIGNhdXNpbmcgc3Bpa2VzIG9mIGxvYWQgdG8gdGhlIGJhY2tlbmQuXG4gKi9cbmNsYXNzIFlyIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKipcbiAgICAgKiBUaGUgQXN5bmNRdWV1ZSB0byBydW4gYmFja29mZiBvcGVyYXRpb25zIG9uLlxuICAgICAqL1xuICAgIHQsIFxuICAgIC8qKlxuICAgICAqIFRoZSBJRCB0byB1c2Ugd2hlbiBzY2hlZHVsaW5nIGJhY2tvZmYgb3BlcmF0aW9ucyBvbiB0aGUgQXN5bmNRdWV1ZS5cbiAgICAgKi9cbiAgICBlLCBcbiAgICAvKipcbiAgICAgKiBUaGUgaW5pdGlhbCBkZWxheSAodXNlZCBhcyB0aGUgYmFzZSBkZWxheSBvbiB0aGUgZmlyc3QgcmV0cnkgYXR0ZW1wdCkuXG4gICAgICogTm90ZSB0aGF0IGppdHRlciB3aWxsIHN0aWxsIGJlIGFwcGxpZWQsIHNvIHRoZSBhY3R1YWwgZGVsYXkgY291bGQgYmUgYXNcbiAgICAgKiBsaXR0bGUgYXMgMC41KmluaXRpYWxEZWxheU1zLlxuICAgICAqL1xuICAgIG4gPSAxZTNcbiAgICAvKipcbiAgICAgKiBUaGUgbXVsdGlwbGllciB0byB1c2UgdG8gZGV0ZXJtaW5lIHRoZSBleHRlbmRlZCBiYXNlIGRlbGF5IGFmdGVyIGVhY2hcbiAgICAgKiBhdHRlbXB0LlxuICAgICAqLyAsIHMgPSAxLjVcbiAgICAvKipcbiAgICAgKiBUaGUgbWF4aW11bSBiYXNlIGRlbGF5IGFmdGVyIHdoaWNoIG5vIGZ1cnRoZXIgYmFja29mZiBpcyBwZXJmb3JtZWQuXG4gICAgICogTm90ZSB0aGF0IGppdHRlciB3aWxsIHN0aWxsIGJlIGFwcGxpZWQsIHNvIHRoZSBhY3R1YWwgZGVsYXkgY291bGQgYmUgYXNcbiAgICAgKiBtdWNoIGFzIDEuNSptYXhEZWxheU1zLlxuICAgICAqLyAsIGkgPSA2ZTQpIHtcbiAgICAgICAgdGhpcy5PZSA9IHQsIHRoaXMudGltZXJJZCA9IGUsIHRoaXMuUWkgPSBuLCB0aGlzLldpID0gcywgdGhpcy5HaSA9IGksIHRoaXMuemkgPSAwLCBcbiAgICAgICAgdGhpcy5IaSA9IG51bGwsIFxuICAgICAgICAvKiogVGhlIGxhc3QgYmFja29mZiBhdHRlbXB0LCBhcyBlcG9jaCBtaWxsaXNlY29uZHMuICovXG4gICAgICAgIHRoaXMuSmkgPSBEYXRlLm5vdygpLCB0aGlzLnJlc2V0KCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlc2V0cyB0aGUgYmFja29mZiBkZWxheS5cbiAgICAgKlxuICAgICAqIFRoZSB2ZXJ5IG5leHQgYmFja29mZkFuZFdhaXQoKSB3aWxsIGhhdmUgbm8gZGVsYXkuIElmIGl0IGlzIGNhbGxlZCBhZ2FpblxuICAgICAqIChpLmUuIGR1ZSB0byBhbiBlcnJvciksIGluaXRpYWxEZWxheU1zIChwbHVzIGppdHRlcikgd2lsbCBiZSB1c2VkLCBhbmRcbiAgICAgKiBzdWJzZXF1ZW50IG9uZXMgd2lsbCBpbmNyZWFzZSBhY2NvcmRpbmcgdG8gdGhlIGJhY2tvZmZGYWN0b3IuXG4gICAgICovICAgIHJlc2V0KCkge1xuICAgICAgICB0aGlzLnppID0gMDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVzZXRzIHRoZSBiYWNrb2ZmIGRlbGF5IHRvIHRoZSBtYXhpbXVtIGRlbGF5IChlLmcuIGZvciB1c2UgYWZ0ZXIgYVxuICAgICAqIFJFU09VUkNFX0VYSEFVU1RFRCBlcnJvcikuXG4gICAgICovICAgIFlpKCkge1xuICAgICAgICB0aGlzLnppID0gdGhpcy5HaTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIHByb21pc2UgdGhhdCByZXNvbHZlcyBhZnRlciBjdXJyZW50RGVsYXlNcywgYW5kIGluY3JlYXNlcyB0aGVcbiAgICAgKiBkZWxheSBmb3IgYW55IHN1YnNlcXVlbnQgYXR0ZW1wdHMuIElmIHRoZXJlIHdhcyBhIHBlbmRpbmcgYmFja29mZiBvcGVyYXRpb25cbiAgICAgKiBhbHJlYWR5LCBpdCB3aWxsIGJlIGNhbmNlbGVkLlxuICAgICAqLyAgICBYaSh0KSB7XG4gICAgICAgIC8vIENhbmNlbCBhbnkgcGVuZGluZyBiYWNrb2ZmIG9wZXJhdGlvbi5cbiAgICAgICAgdGhpcy5jYW5jZWwoKTtcbiAgICAgICAgLy8gRmlyc3Qgc2NoZWR1bGUgdXNpbmcgdGhlIGN1cnJlbnQgYmFzZSAod2hpY2ggbWF5IGJlIDAgYW5kIHNob3VsZCBiZVxuICAgICAgICAvLyBob25vcmVkIGFzIHN1Y2gpLlxuICAgICAgICBjb25zdCBlID0gTWF0aC5mbG9vcih0aGlzLnppICsgdGhpcy5aaSgpKSwgbiA9IE1hdGgubWF4KDAsIERhdGUubm93KCkgLSB0aGlzLkppKSwgcyA9IE1hdGgubWF4KDAsIGUgLSBuKTtcbiAgICAgICAgLy8gR3VhcmQgYWdhaW5zdCBsYXN0QXR0ZW1wdFRpbWUgYmVpbmcgaW4gdGhlIGZ1dHVyZSBkdWUgdG8gYSBjbG9jayBjaGFuZ2UuXG4gICAgICAgICAgICAgICAgcyA+IDAgJiYgayhcIkV4cG9uZW50aWFsQmFja29mZlwiLCBgQmFja2luZyBvZmYgZm9yICR7c30gbXMgKGJhc2UgZGVsYXk6ICR7dGhpcy56aX0gbXMsIGRlbGF5IHdpdGggaml0dGVyOiAke2V9IG1zLCBsYXN0IGF0dGVtcHQ6ICR7bn0gbXMgYWdvKWApLCBcbiAgICAgICAgdGhpcy5IaSA9IHRoaXMuT2UuZW5xdWV1ZUFmdGVyRGVsYXkodGhpcy50aW1lcklkLCBzLCAoKCkgPT4gKHRoaXMuSmkgPSBEYXRlLm5vdygpLCBcbiAgICAgICAgdCgpKSkpLCBcbiAgICAgICAgLy8gQXBwbHkgYmFja29mZiBmYWN0b3IgdG8gZGV0ZXJtaW5lIG5leHQgZGVsYXkgYW5kIGVuc3VyZSBpdCBpcyB3aXRoaW5cbiAgICAgICAgLy8gYm91bmRzLlxuICAgICAgICB0aGlzLnppICo9IHRoaXMuV2ksIHRoaXMuemkgPCB0aGlzLlFpICYmICh0aGlzLnppID0gdGhpcy5RaSksIHRoaXMuemkgPiB0aGlzLkdpICYmICh0aGlzLnppID0gdGhpcy5HaSk7XG4gICAgfVxuICAgIHRyKCkge1xuICAgICAgICBudWxsICE9PSB0aGlzLkhpICYmICh0aGlzLkhpLnNraXBEZWxheSgpLCB0aGlzLkhpID0gbnVsbCk7XG4gICAgfVxuICAgIGNhbmNlbCgpIHtcbiAgICAgICAgbnVsbCAhPT0gdGhpcy5IaSAmJiAodGhpcy5IaS5jYW5jZWwoKSwgdGhpcy5IaSA9IG51bGwpO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyBhIHJhbmRvbSB2YWx1ZSBpbiB0aGUgcmFuZ2UgWy1jdXJyZW50QmFzZU1zLzIsIGN1cnJlbnRCYXNlTXMvMl0gKi8gICAgWmkoKSB7XG4gICAgICAgIHJldHVybiAoTWF0aC5yYW5kb20oKSAtIC41KSAqIHRoaXMuemk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBIFBlcnNpc3RlbnRTdHJlYW0gaXMgYW4gYWJzdHJhY3QgYmFzZSBjbGFzcyB0aGF0IHJlcHJlc2VudHMgYSBzdHJlYW1pbmcgUlBDXG4gKiB0byB0aGUgRmlyZXN0b3JlIGJhY2tlbmQuIEl0J3MgYnVpbHQgb24gdG9wIG9mIHRoZSBjb25uZWN0aW9ucyBvd24gc3VwcG9ydFxuICogZm9yIHN0cmVhbWluZyBSUENzLCBhbmQgYWRkcyBzZXZlcmFsIGNyaXRpY2FsIGZlYXR1cmVzIGZvciBvdXIgY2xpZW50czpcbiAqXG4gKiAgIC0gRXhwb25lbnRpYWwgYmFja29mZiBvbiBmYWlsdXJlXG4gKiAgIC0gQXV0aGVudGljYXRpb24gdmlhIENyZWRlbnRpYWxzUHJvdmlkZXJcbiAqICAgLSBEaXNwYXRjaGluZyBhbGwgY2FsbGJhY2tzIGludG8gdGhlIHNoYXJlZCB3b3JrZXIgcXVldWVcbiAqICAgLSBDbG9zaW5nIGlkbGUgc3RyZWFtcyBhZnRlciA2MCBzZWNvbmRzIG9mIGluYWN0aXZpdHlcbiAqXG4gKiBTdWJjbGFzc2VzIG9mIFBlcnNpc3RlbnRTdHJlYW0gaW1wbGVtZW50IHNlcmlhbGl6YXRpb24gb2YgbW9kZWxzIHRvIGFuZFxuICogZnJvbSB0aGUgSlNPTiByZXByZXNlbnRhdGlvbiBvZiB0aGUgcHJvdG9jb2wgYnVmZmVycyBmb3IgYSBzcGVjaWZpY1xuICogc3RyZWFtaW5nIFJQQy5cbiAqXG4gKiAjIyBTdGFydGluZyBhbmQgU3RvcHBpbmdcbiAqXG4gKiBTdHJlYW1pbmcgUlBDcyBhcmUgc3RhdGVmdWwgYW5kIG5lZWQgdG8gYmUgc3RhcnQoKWVkIGJlZm9yZSBtZXNzYWdlcyBjYW5cbiAqIGJlIHNlbnQgYW5kIHJlY2VpdmVkLiBUaGUgUGVyc2lzdGVudFN0cmVhbSB3aWxsIGNhbGwgdGhlIG9uT3BlbigpIGZ1bmN0aW9uXG4gKiBvZiB0aGUgbGlzdGVuZXIgb25jZSB0aGUgc3RyZWFtIGlzIHJlYWR5IHRvIGFjY2VwdCByZXF1ZXN0cy5cbiAqXG4gKiBTaG91bGQgYSBzdGFydCgpIGZhaWwsIFBlcnNpc3RlbnRTdHJlYW0gd2lsbCBjYWxsIHRoZSByZWdpc3RlcmVkIG9uQ2xvc2UoKVxuICogbGlzdGVuZXIgd2l0aCBhIEZpcmVzdG9yZUVycm9yIGluZGljYXRpbmcgd2hhdCB3ZW50IHdyb25nLlxuICpcbiAqIEEgUGVyc2lzdGVudFN0cmVhbSBjYW4gYmUgc3RhcnRlZCBhbmQgc3RvcHBlZCByZXBlYXRlZGx5LlxuICpcbiAqIEdlbmVyaWMgdHlwZXM6XG4gKiAgU2VuZFR5cGU6IFRoZSB0eXBlIG9mIHRoZSBvdXRnb2luZyBtZXNzYWdlIG9mIHRoZSB1bmRlcmx5aW5nXG4gKiAgICBjb25uZWN0aW9uIHN0cmVhbVxuICogIFJlY2VpdmVUeXBlOiBUaGUgdHlwZSBvZiB0aGUgaW5jb21pbmcgbWVzc2FnZSBvZiB0aGUgdW5kZXJseWluZ1xuICogICAgY29ubmVjdGlvbiBzdHJlYW1cbiAqICBMaXN0ZW5lclR5cGU6IFRoZSB0eXBlIG9mIHRoZSBsaXN0ZW5lciB0aGF0IHdpbGwgYmUgdXNlZCBmb3IgY2FsbGJhY2tzXG4gKi9cbmNsYXNzIFhyIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzLCBpLCByKSB7XG4gICAgICAgIHRoaXMuT2UgPSB0LCB0aGlzLmVyID0gbiwgdGhpcy5uciA9IHMsIHRoaXMuY3JlZGVudGlhbHNQcm92aWRlciA9IGksIHRoaXMubGlzdGVuZXIgPSByLCBcbiAgICAgICAgdGhpcy5zdGF0ZSA9IDAgLyogSW5pdGlhbCAqLyAsIFxuICAgICAgICAvKipcbiAgICAgICAgICogQSBjbG9zZSBjb3VudCB0aGF0J3MgaW5jcmVtZW50ZWQgZXZlcnkgdGltZSB0aGUgc3RyZWFtIGlzIGNsb3NlZDsgdXNlZCBieVxuICAgICAgICAgKiBnZXRDbG9zZUd1YXJkZWREaXNwYXRjaGVyKCkgdG8gaW52YWxpZGF0ZSBjYWxsYmFja3MgdGhhdCBoYXBwZW4gYWZ0ZXJcbiAgICAgICAgICogY2xvc2UuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnNyID0gMCwgdGhpcy5pciA9IG51bGwsIHRoaXMuc3RyZWFtID0gbnVsbCwgdGhpcy5yciA9IG5ldyBZcih0LCBlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHN0YXJ0KCkgaGFzIGJlZW4gY2FsbGVkIGFuZCBubyBlcnJvciBoYXMgb2NjdXJyZWQuIFRydWVcbiAgICAgKiBpbmRpY2F0ZXMgdGhlIHN0cmVhbSBpcyBvcGVuIG9yIGluIHRoZSBwcm9jZXNzIG9mIG9wZW5pbmcgKHdoaWNoXG4gICAgICogZW5jb21wYXNzZXMgcmVzcGVjdGluZyBiYWNrb2ZmLCBnZXR0aW5nIGF1dGggdG9rZW5zLCBhbmQgc3RhcnRpbmcgdGhlXG4gICAgICogYWN0dWFsIFJQQykuIFVzZSBpc09wZW4oKSB0byBkZXRlcm1pbmUgaWYgdGhlIHN0cmVhbSBpcyBvcGVuIGFuZCByZWFkeSBmb3JcbiAgICAgKiBvdXRib3VuZCByZXF1ZXN0cy5cbiAgICAgKi8gICAgYXIoKSB7XG4gICAgICAgIHJldHVybiAxIC8qIFN0YXJ0aW5nICovID09PSB0aGlzLnN0YXRlIHx8IDIgLyogT3BlbiAqLyA9PT0gdGhpcy5zdGF0ZSB8fCA0IC8qIEJhY2tvZmYgKi8gPT09IHRoaXMuc3RhdGU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgdW5kZXJseWluZyBSUEMgaXMgb3BlbiAodGhlIG9uT3BlbigpIGxpc3RlbmVyIGhhcyBiZWVuXG4gICAgICogY2FsbGVkKSBhbmQgdGhlIHN0cmVhbSBpcyByZWFkeSBmb3Igb3V0Ym91bmQgcmVxdWVzdHMuXG4gICAgICovICAgIGNyKCkge1xuICAgICAgICByZXR1cm4gMiAvKiBPcGVuICovID09PSB0aGlzLnN0YXRlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdGFydHMgdGhlIFJQQy4gT25seSBhbGxvd2VkIGlmIGlzU3RhcnRlZCgpIHJldHVybnMgZmFsc2UuIFRoZSBzdHJlYW0gaXNcbiAgICAgKiBub3QgaW1tZWRpYXRlbHkgcmVhZHkgZm9yIHVzZTogb25PcGVuKCkgd2lsbCBiZSBpbnZva2VkIHdoZW4gdGhlIFJQQyBpc1xuICAgICAqIHJlYWR5IGZvciBvdXRib3VuZCByZXF1ZXN0cywgYXQgd2hpY2ggcG9pbnQgaXNPcGVuKCkgd2lsbCByZXR1cm4gdHJ1ZS5cbiAgICAgKlxuICAgICAqIFdoZW4gc3RhcnQgcmV0dXJucywgaXNTdGFydGVkKCkgd2lsbCByZXR1cm4gdHJ1ZS5cbiAgICAgKi8gICAgc3RhcnQoKSB7XG4gICAgICAgIDMgLyogRXJyb3IgKi8gIT09IHRoaXMuc3RhdGUgPyB0aGlzLmF1dGgoKSA6IHRoaXMudXIoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3RvcHMgdGhlIFJQQy4gVGhpcyBjYWxsIGlzIGlkZW1wb3RlbnQgYW5kIGFsbG93ZWQgcmVnYXJkbGVzcyBvZiB0aGVcbiAgICAgKiBjdXJyZW50IGlzU3RhcnRlZCgpIHN0YXRlLlxuICAgICAqXG4gICAgICogV2hlbiBzdG9wIHJldHVybnMsIGlzU3RhcnRlZCgpIGFuZCBpc09wZW4oKSB3aWxsIGJvdGggcmV0dXJuIGZhbHNlLlxuICAgICAqLyAgICBhc3luYyBzdG9wKCkge1xuICAgICAgICB0aGlzLmFyKCkgJiYgYXdhaXQgdGhpcy5jbG9zZSgwIC8qIEluaXRpYWwgKi8pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZnRlciBhbiBlcnJvciB0aGUgc3RyZWFtIHdpbGwgdXN1YWxseSBiYWNrIG9mZiBvbiB0aGUgbmV4dCBhdHRlbXB0IHRvXG4gICAgICogc3RhcnQgaXQuIElmIHRoZSBlcnJvciB3YXJyYW50cyBhbiBpbW1lZGlhdGUgcmVzdGFydCBvZiB0aGUgc3RyZWFtLCB0aGVcbiAgICAgKiBzZW5kZXIgY2FuIHVzZSB0aGlzIHRvIGluZGljYXRlIHRoYXQgdGhlIHJlY2VpdmVyIHNob3VsZCBub3QgYmFjayBvZmYuXG4gICAgICpcbiAgICAgKiBFYWNoIGVycm9yIHdpbGwgY2FsbCB0aGUgb25DbG9zZSgpIGxpc3RlbmVyLiBUaGF0IGZ1bmN0aW9uIGNhbiBkZWNpZGUgdG9cbiAgICAgKiBpbmhpYml0IGJhY2tvZmYgaWYgcmVxdWlyZWQuXG4gICAgICovICAgIGhyKCkge1xuICAgICAgICB0aGlzLnN0YXRlID0gMCAvKiBJbml0aWFsICovICwgdGhpcy5yci5yZXNldCgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBNYXJrcyB0aGlzIHN0cmVhbSBhcyBpZGxlLiBJZiBubyBmdXJ0aGVyIGFjdGlvbnMgYXJlIHBlcmZvcm1lZCBvbiB0aGVcbiAgICAgKiBzdHJlYW0gZm9yIG9uZSBtaW51dGUsIHRoZSBzdHJlYW0gd2lsbCBhdXRvbWF0aWNhbGx5IGNsb3NlIGl0c2VsZiBhbmRcbiAgICAgKiBub3RpZnkgdGhlIHN0cmVhbSdzIG9uQ2xvc2UoKSBoYW5kbGVyIHdpdGggU3RhdHVzLk9LLiBUaGUgc3RyZWFtIHdpbGwgdGhlblxuICAgICAqIGJlIGluIGEgIWlzU3RhcnRlZCgpIHN0YXRlLCByZXF1aXJpbmcgdGhlIGNhbGxlciB0byBzdGFydCB0aGUgc3RyZWFtIGFnYWluXG4gICAgICogYmVmb3JlIGZ1cnRoZXIgdXNlLlxuICAgICAqXG4gICAgICogT25seSBzdHJlYW1zIHRoYXQgYXJlIGluIHN0YXRlICdPcGVuJyBjYW4gYmUgbWFya2VkIGlkbGUsIGFzIGFsbCBvdGhlclxuICAgICAqIHN0YXRlcyBpbXBseSBwZW5kaW5nIG5ldHdvcmsgb3BlcmF0aW9ucy5cbiAgICAgKi8gICAgbHIoKSB7XG4gICAgICAgIC8vIFN0YXJ0cyB0aGUgaWRsZSB0aW1lIGlmIHdlIGFyZSBpbiBzdGF0ZSAnT3BlbicgYW5kIGFyZSBub3QgeWV0IGFscmVhZHlcbiAgICAgICAgLy8gcnVubmluZyBhIHRpbWVyIChpbiB3aGljaCBjYXNlIHRoZSBwcmV2aW91cyBpZGxlIHRpbWVvdXQgc3RpbGwgYXBwbGllcykuXG4gICAgICAgIHRoaXMuY3IoKSAmJiBudWxsID09PSB0aGlzLmlyICYmICh0aGlzLmlyID0gdGhpcy5PZS5lbnF1ZXVlQWZ0ZXJEZWxheSh0aGlzLmVyLCA2ZTQsICgoKSA9PiB0aGlzLmRyKCkpKSk7XG4gICAgfVxuICAgIC8qKiBTZW5kcyBhIG1lc3NhZ2UgdG8gdGhlIHVuZGVybHlpbmcgc3RyZWFtLiAqLyAgICB3cih0KSB7XG4gICAgICAgIHRoaXMuX3IoKSwgdGhpcy5zdHJlYW0uc2VuZCh0KTtcbiAgICB9XG4gICAgLyoqIENhbGxlZCBieSB0aGUgaWRsZSB0aW1lciB3aGVuIHRoZSBzdHJlYW0gc2hvdWxkIGNsb3NlIGR1ZSB0byBpbmFjdGl2aXR5LiAqLyAgICBhc3luYyBkcigpIHtcbiAgICAgICAgaWYgKHRoaXMuY3IoKSkgXG4gICAgICAgIC8vIFdoZW4gdGltaW5nIG91dCBhbiBpZGxlIHN0cmVhbSB0aGVyZSdzIG5vIHJlYXNvbiB0byBmb3JjZSB0aGUgc3RyZWFtIGludG8gYmFja29mZiB3aGVuXG4gICAgICAgIC8vIGl0IHJlc3RhcnRzIHNvIHNldCB0aGUgc3RyZWFtIHN0YXRlIHRvIEluaXRpYWwgaW5zdGVhZCBvZiBFcnJvci5cbiAgICAgICAgcmV0dXJuIHRoaXMuY2xvc2UoMCAvKiBJbml0aWFsICovKTtcbiAgICB9XG4gICAgLyoqIE1hcmtzIHRoZSBzdHJlYW0gYXMgYWN0aXZlIGFnYWluLiAqLyAgICBfcigpIHtcbiAgICAgICAgdGhpcy5pciAmJiAodGhpcy5pci5jYW5jZWwoKSwgdGhpcy5pciA9IG51bGwpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDbG9zZXMgdGhlIHN0cmVhbSBhbmQgY2xlYW5zIHVwIGFzIG5lY2Vzc2FyeTpcbiAgICAgKlxuICAgICAqICogY2xvc2VzIHRoZSB1bmRlcmx5aW5nIEdSUEMgc3RyZWFtO1xuICAgICAqICogY2FsbHMgdGhlIG9uQ2xvc2UgaGFuZGxlciB3aXRoIHRoZSBnaXZlbiAnZXJyb3InO1xuICAgICAqICogc2V0cyBpbnRlcm5hbCBzdHJlYW0gc3RhdGUgdG8gJ2ZpbmFsU3RhdGUnO1xuICAgICAqICogYWRqdXN0cyB0aGUgYmFja29mZiB0aW1lciBiYXNlZCBvbiB0aGUgZXJyb3JcbiAgICAgKlxuICAgICAqIEEgbmV3IHN0cmVhbSBjYW4gYmUgb3BlbmVkIGJ5IGNhbGxpbmcgc3RhcnQoKS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBmaW5hbFN0YXRlIC0gdGhlIGludGVuZGVkIHN0YXRlIG9mIHRoZSBzdHJlYW0gYWZ0ZXIgY2xvc2luZy5cbiAgICAgKiBAcGFyYW0gZXJyb3IgLSB0aGUgZXJyb3IgdGhlIGNvbm5lY3Rpb24gd2FzIGNsb3NlZCB3aXRoLlxuICAgICAqLyAgICBhc3luYyBjbG9zZSh0LCBlKSB7XG4gICAgICAgIC8vIENhbmNlbCBhbnkgb3V0c3RhbmRpbmcgdGltZXJzICh0aGV5J3JlIGd1YXJhbnRlZWQgbm90IHRvIGV4ZWN1dGUpLlxuICAgICAgICB0aGlzLl9yKCksIHRoaXMucnIuY2FuY2VsKCksIFxuICAgICAgICAvLyBJbnZhbGlkYXRlcyBhbnkgc3RyZWFtLXJlbGF0ZWQgY2FsbGJhY2tzIChlLmcuIGZyb20gYXV0aCBvciB0aGVcbiAgICAgICAgLy8gdW5kZXJseWluZyBzdHJlYW0pLCBndWFyYW50ZWVpbmcgdGhleSB3b24ndCBleGVjdXRlLlxuICAgICAgICB0aGlzLnNyKyssIDMgLyogRXJyb3IgKi8gIT09IHQgPyBcbiAgICAgICAgLy8gSWYgdGhpcyBpcyBhbiBpbnRlbnRpb25hbCBjbG9zZSBlbnN1cmUgd2UgZG9uJ3QgZGVsYXkgb3VyIG5leHQgY29ubmVjdGlvbiBhdHRlbXB0LlxuICAgICAgICB0aGlzLnJyLnJlc2V0KCkgOiBlICYmIGUuY29kZSA9PT0gcS5SRVNPVVJDRV9FWEhBVVNURUQgPyAoXG4gICAgICAgIC8vIExvZyB0aGUgZXJyb3IuIChQcm9iYWJseSBlaXRoZXIgJ3F1b3RhIGV4Y2VlZGVkJyBvciAnbWF4IHF1ZXVlIGxlbmd0aCByZWFjaGVkJy4pXG4gICAgICAgICQoZS50b1N0cmluZygpKSwgJChcIlVzaW5nIG1heGltdW0gYmFja29mZiBkZWxheSB0byBwcmV2ZW50IG92ZXJsb2FkaW5nIHRoZSBiYWNrZW5kLlwiKSwgXG4gICAgICAgIHRoaXMucnIuWWkoKSkgOiBlICYmIGUuY29kZSA9PT0gcS5VTkFVVEhFTlRJQ0FURUQgJiYgXG4gICAgICAgIC8vIFwidW5hdXRoZW50aWNhdGVkXCIgZXJyb3IgbWVhbnMgdGhlIHRva2VuIHdhcyByZWplY3RlZC4gVHJ5IGZvcmNlIHJlZnJlc2hpbmcgaXQgaW4gY2FzZSBpdFxuICAgICAgICAvLyBqdXN0IGV4cGlyZWQuXG4gICAgICAgIHRoaXMuY3JlZGVudGlhbHNQcm92aWRlci5pbnZhbGlkYXRlVG9rZW4oKSwgXG4gICAgICAgIC8vIENsZWFuIHVwIHRoZSB1bmRlcmx5aW5nIHN0cmVhbSBiZWNhdXNlIHdlIGFyZSBubyBsb25nZXIgaW50ZXJlc3RlZCBpbiBldmVudHMuXG4gICAgICAgIG51bGwgIT09IHRoaXMuc3RyZWFtICYmICh0aGlzLm1yKCksIHRoaXMuc3RyZWFtLmNsb3NlKCksIHRoaXMuc3RyZWFtID0gbnVsbCksIFxuICAgICAgICAvLyBUaGlzIHN0YXRlIG11c3QgYmUgYXNzaWduZWQgYmVmb3JlIGNhbGxpbmcgb25DbG9zZSgpIHRvIGFsbG93IHRoZSBjYWxsYmFjayB0b1xuICAgICAgICAvLyBpbmhpYml0IGJhY2tvZmYgb3Igb3RoZXJ3aXNlIG1hbmlwdWxhdGUgdGhlIHN0YXRlIGluIGl0cyBub24tc3RhcnRlZCBzdGF0ZS5cbiAgICAgICAgdGhpcy5zdGF0ZSA9IHQsIFxuICAgICAgICAvLyBOb3RpZnkgdGhlIGxpc3RlbmVyIHRoYXQgdGhlIHN0cmVhbSBjbG9zZWQuXG4gICAgICAgIGF3YWl0IHRoaXMubGlzdGVuZXIuQ2koZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbiBiZSBvdmVycmlkZGVuIHRvIHBlcmZvcm0gYWRkaXRpb25hbCBjbGVhbnVwIGJlZm9yZSB0aGUgc3RyZWFtIGlzIGNsb3NlZC5cbiAgICAgKiBDYWxsaW5nIHN1cGVyLnRlYXJEb3duKCkgaXMgbm90IHJlcXVpcmVkLlxuICAgICAqLyAgICBtcigpIHt9XG4gICAgYXV0aCgpIHtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IDEgLyogU3RhcnRpbmcgKi87XG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLmdyKHRoaXMuc3IpLCBlID0gdGhpcy5zcjtcbiAgICAgICAgLy8gVE9ETyhtaWtlbGVoZW4pOiBKdXN0IHVzZSBkaXNwYXRjaElmTm90Q2xvc2VkLCBidXQgc2VlIFRPRE8gYmVsb3cuXG4gICAgICAgICAgICAgICAgdGhpcy5jcmVkZW50aWFsc1Byb3ZpZGVyLmdldFRva2VuKCkudGhlbigodCA9PiB7XG4gICAgICAgICAgICAvLyBTdHJlYW0gY2FuIGJlIHN0b3BwZWQgd2hpbGUgd2FpdGluZyBmb3IgYXV0aGVudGljYXRpb24uXG4gICAgICAgICAgICAvLyBUT0RPKG1pa2VsZWhlbik6IFdlIHJlYWxseSBzaG91bGQganVzdCB1c2UgZGlzcGF0Y2hJZk5vdENsb3NlZFxuICAgICAgICAgICAgLy8gYW5kIGxldCB0aGlzIGRpc3BhdGNoIG9udG8gdGhlIHF1ZXVlLCBidXQgdGhhdCBvcGVuZWQgYSBzcGVjIHRlc3QgY2FuXG4gICAgICAgICAgICAvLyBvZiB3b3JtcyB0aGF0IEkgZG9uJ3Qgd2FudCB0byBkZWFsIHdpdGggaW4gdGhpcyBQUi5cbiAgICAgICAgICAgIHRoaXMuc3IgPT09IGUgJiYgXG4gICAgICAgICAgICAvLyBOb3JtYWxseSB3ZSdkIGhhdmUgdG8gc2NoZWR1bGUgdGhlIGNhbGxiYWNrIG9uIHRoZSBBc3luY1F1ZXVlLlxuICAgICAgICAgICAgLy8gSG93ZXZlciwgdGhlIGZvbGxvd2luZyBjYWxscyBhcmUgc2FmZSB0byBiZSBjYWxsZWQgb3V0c2lkZSB0aGVcbiAgICAgICAgICAgIC8vIEFzeW5jUXVldWUgc2luY2UgdGhleSBkb24ndCBjaGFpbiBhc3luY2hyb25vdXMgY2FsbHNcbiAgICAgICAgICAgIHRoaXMueXIodCk7XG4gICAgICAgIH0pLCAoZSA9PiB7XG4gICAgICAgICAgICB0KCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IG5ldyBLKHEuVU5LTk9XTiwgXCJGZXRjaGluZyBhdXRoIHRva2VuIGZhaWxlZDogXCIgKyBlLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnByKHQpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHlyKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuZ3IodGhpcy5zcik7XG4gICAgICAgIHRoaXMuc3RyZWFtID0gdGhpcy5Fcih0KSwgdGhpcy5zdHJlYW0uU2koKCgpID0+IHtcbiAgICAgICAgICAgIGUoKCgpID0+ICh0aGlzLnN0YXRlID0gMiAvKiBPcGVuICovICwgdGhpcy5saXN0ZW5lci5TaSgpKSkpO1xuICAgICAgICB9KSksIHRoaXMuc3RyZWFtLkNpKCh0ID0+IHtcbiAgICAgICAgICAgIGUoKCgpID0+IHRoaXMucHIodCkpKTtcbiAgICAgICAgfSkpLCB0aGlzLnN0cmVhbS5vbk1lc3NhZ2UoKHQgPT4ge1xuICAgICAgICAgICAgZSgoKCkgPT4gdGhpcy5vbk1lc3NhZ2UodCkpKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB1cigpIHtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IDQgLyogQmFja29mZiAqLyAsIHRoaXMucnIuWGkoKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc3RhdGUgPSAwIC8qIEluaXRpYWwgKi8gLCB0aGlzLnN0YXJ0KCk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgLy8gVmlzaWJsZSBmb3IgdGVzdHNcbiAgICBwcih0KSB7XG4gICAgICAgIC8vIEluIHRoZW9yeSB0aGUgc3RyZWFtIGNvdWxkIGNsb3NlIGNsZWFubHksIGhvd2V2ZXIsIGluIG91ciBjdXJyZW50IG1vZGVsXG4gICAgICAgIC8vIHdlIG5ldmVyIGV4cGVjdCB0aGlzIHRvIGhhcHBlbiBiZWNhdXNlIGlmIHdlIHN0b3AgYSBzdHJlYW0gb3Vyc2VsdmVzLFxuICAgICAgICAvLyB0aGlzIGNhbGxiYWNrIHdpbGwgbmV2ZXIgYmUgY2FsbGVkLiBUbyBwcmV2ZW50IGNhc2VzIHdoZXJlIHdlIHJldHJ5XG4gICAgICAgIC8vIHdpdGhvdXQgYSBiYWNrb2ZmIGFjY2lkZW50YWxseSwgd2Ugc2V0IHRoZSBzdHJlYW0gdG8gZXJyb3IgaW4gYWxsIGNhc2VzLlxuICAgICAgICByZXR1cm4gayhcIlBlcnNpc3RlbnRTdHJlYW1cIiwgYGNsb3NlIHdpdGggZXJyb3I6ICR7dH1gKSwgdGhpcy5zdHJlYW0gPSBudWxsLCB0aGlzLmNsb3NlKDMgLyogRXJyb3IgKi8gLCB0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIFwiZGlzcGF0Y2hlclwiIGZ1bmN0aW9uIHRoYXQgZGlzcGF0Y2hlcyBvcGVyYXRpb25zIG9udG8gdGhlXG4gICAgICogQXN5bmNRdWV1ZSBidXQgb25seSBydW5zIHRoZW0gaWYgY2xvc2VDb3VudCByZW1haW5zIHVuY2hhbmdlZC4gVGhpcyBhbGxvd3NcbiAgICAgKiB1cyB0byB0dXJuIGF1dGggLyBzdHJlYW0gY2FsbGJhY2tzIGludG8gbm8tb3BzIGlmIHRoZSBzdHJlYW0gaXMgY2xvc2VkIC9cbiAgICAgKiByZS1vcGVuZWQsIGV0Yy5cbiAgICAgKi8gICAgZ3IodCkge1xuICAgICAgICByZXR1cm4gZSA9PiB7XG4gICAgICAgICAgICB0aGlzLk9lLmVucXVldWVBbmRGb3JnZXQoKCgpID0+IHRoaXMuc3IgPT09IHQgPyBlKCkgOiAoayhcIlBlcnNpc3RlbnRTdHJlYW1cIiwgXCJzdHJlYW0gY2FsbGJhY2sgc2tpcHBlZCBieSBnZXRDbG9zZUd1YXJkZWREaXNwYXRjaGVyLlwiKSwgXG4gICAgICAgICAgICBQcm9taXNlLnJlc29sdmUoKSkpKTtcbiAgICAgICAgfTtcbiAgICB9XG59XG5cbi8qKlxuICogQSBQZXJzaXN0ZW50U3RyZWFtIHRoYXQgaW1wbGVtZW50cyB0aGUgTGlzdGVuIFJQQy5cbiAqXG4gKiBPbmNlIHRoZSBMaXN0ZW4gc3RyZWFtIGhhcyBjYWxsZWQgdGhlIG9uT3BlbigpIGxpc3RlbmVyLCBhbnkgbnVtYmVyIG9mXG4gKiBsaXN0ZW4oKSBhbmQgdW5saXN0ZW4oKSBjYWxscyBjYW4gYmUgbWFkZSB0byBjb250cm9sIHdoYXQgY2hhbmdlcyB3aWxsIGJlXG4gKiBzZW50IGZyb20gdGhlIHNlcnZlciBmb3IgTGlzdGVuUmVzcG9uc2VzLlxuICovIGNsYXNzIFpyIGV4dGVuZHMgWHIge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIHMsIGkpIHtcbiAgICAgICAgc3VwZXIodCwgXCJsaXN0ZW5fc3RyZWFtX2Nvbm5lY3Rpb25fYmFja29mZlwiIC8qIExpc3RlblN0cmVhbUNvbm5lY3Rpb25CYWNrb2ZmICovICwgXCJsaXN0ZW5fc3RyZWFtX2lkbGVcIiAvKiBMaXN0ZW5TdHJlYW1JZGxlICovICwgZSwgbiwgaSksIFxuICAgICAgICB0aGlzLk4gPSBzO1xuICAgIH1cbiAgICBFcih0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5yLmppKFwiTGlzdGVuXCIsIHQpO1xuICAgIH1cbiAgICBvbk1lc3NhZ2UodCkge1xuICAgICAgICAvLyBBIHN1Y2Nlc3NmdWwgcmVzcG9uc2UgbWVhbnMgdGhlIHN0cmVhbSBpcyBoZWFsdGh5XG4gICAgICAgIHRoaXMucnIucmVzZXQoKTtcbiAgICAgICAgY29uc3QgZSA9IGVzKHRoaXMuTiwgdCksIG4gPSBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAvLyBXZSBoYXZlIG9ubHkgcmVhY2hlZCBhIGNvbnNpc3RlbnQgc25hcHNob3QgZm9yIHRoZSBlbnRpcmUgc3RyZWFtIGlmIHRoZXJlXG4gICAgICAgICAgICAvLyBpcyBhIHJlYWRfdGltZSBzZXQgYW5kIGl0IGFwcGxpZXMgdG8gYWxsIHRhcmdldHMgKGkuZS4gdGhlIGxpc3Qgb2ZcbiAgICAgICAgICAgIC8vIHRhcmdldHMgaXMgZW1wdHkpLiBUaGUgYmFja2VuZCBpcyBndWFyYW50ZWVkIHRvIHNlbmQgc3VjaCByZXNwb25zZXMuXG4gICAgICAgICAgICBpZiAoIShcInRhcmdldENoYW5nZVwiIGluIHQpKSByZXR1cm4gaXQubWluKCk7XG4gICAgICAgICAgICBjb25zdCBlID0gdC50YXJnZXRDaGFuZ2U7XG4gICAgICAgICAgICByZXR1cm4gZS50YXJnZXRJZHMgJiYgZS50YXJnZXRJZHMubGVuZ3RoID8gaXQubWluKCkgOiBlLnJlYWRUaW1lID8gS24oZS5yZWFkVGltZSkgOiBpdC5taW4oKTtcbiAgICAgICAgfSh0KTtcbiAgICAgICAgcmV0dXJuIHRoaXMubGlzdGVuZXIuVHIoZSwgbik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlZ2lzdGVycyBpbnRlcmVzdCBpbiB0aGUgcmVzdWx0cyBvZiB0aGUgZ2l2ZW4gdGFyZ2V0LiBJZiB0aGUgdGFyZ2V0XG4gICAgICogaW5jbHVkZXMgYSByZXN1bWVUb2tlbiBpdCB3aWxsIGJlIGluY2x1ZGVkIGluIHRoZSByZXF1ZXN0LiBSZXN1bHRzIHRoYXRcbiAgICAgKiBhZmZlY3QgdGhlIHRhcmdldCB3aWxsIGJlIHN0cmVhbWVkIGJhY2sgYXMgV2F0Y2hDaGFuZ2UgbWVzc2FnZXMgdGhhdFxuICAgICAqIHJlZmVyZW5jZSB0aGUgdGFyZ2V0SWQuXG4gICAgICovICAgIElyKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHt9O1xuICAgICAgICBlLmRhdGFiYXNlID0gSm4odGhpcy5OKSwgZS5hZGRUYXJnZXQgPSBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBsZXQgbjtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBlLnRhcmdldDtcbiAgICAgICAgICAgIHJldHVybiBuID0genQocykgPyB7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnRzOiBycyh0LCBzKVxuICAgICAgICAgICAgfSA6IHtcbiAgICAgICAgICAgICAgICBxdWVyeTogb3ModCwgcylcbiAgICAgICAgICAgIH0sIG4udGFyZ2V0SWQgPSBlLnRhcmdldElkLCBlLnJlc3VtZVRva2VuLmFwcHJveGltYXRlQnl0ZVNpemUoKSA+IDAgPyBuLnJlc3VtZVRva2VuID0gVW4odCwgZS5yZXN1bWVUb2tlbikgOiBlLnNuYXBzaG90VmVyc2lvbi5jb21wYXJlVG8oaXQubWluKCkpID4gMCAmJiAoXG4gICAgICAgICAgICAvLyBUT0RPKHd1YW5keSk6IENvbnNpZGVyIHJlbW92aW5nIGFib3ZlIGNoZWNrIGJlY2F1c2UgaXQgaXMgbW9zdCBsaWtlbHkgdHJ1ZS5cbiAgICAgICAgICAgIC8vIFJpZ2h0IG5vdywgbWFueSB0ZXN0cyBkZXBlbmQgb24gdGhpcyBiZWhhdmlvdXIgdGhvdWdoIChsZWF2aW5nIG1pbigpIG91dFxuICAgICAgICAgICAgLy8gb2Ygc2VyaWFsaXphdGlvbikuXG4gICAgICAgICAgICBuLnJlYWRUaW1lID0gQm4odCwgZS5zbmFwc2hvdFZlcnNpb24udG9UaW1lc3RhbXAoKSkpLCBuO1xuICAgICAgICB9KHRoaXMuTiwgdCk7XG4gICAgICAgIGNvbnN0IG4gPSBjcyh0aGlzLk4sIHQpO1xuICAgICAgICBuICYmIChlLmxhYmVscyA9IG4pLCB0aGlzLndyKGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBVbnJlZ2lzdGVycyBpbnRlcmVzdCBpbiB0aGUgcmVzdWx0cyBvZiB0aGUgdGFyZ2V0IGFzc29jaWF0ZWQgd2l0aCB0aGVcbiAgICAgKiBnaXZlbiB0YXJnZXRJZC5cbiAgICAgKi8gICAgQXIodCkge1xuICAgICAgICBjb25zdCBlID0ge307XG4gICAgICAgIGUuZGF0YWJhc2UgPSBKbih0aGlzLk4pLCBlLnJlbW92ZVRhcmdldCA9IHQsIHRoaXMud3IoZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEEgU3RyZWFtIHRoYXQgaW1wbGVtZW50cyB0aGUgV3JpdGUgUlBDLlxuICpcbiAqIFRoZSBXcml0ZSBSUEMgcmVxdWlyZXMgdGhlIGNhbGxlciB0byBtYWludGFpbiBzcGVjaWFsIHN0cmVhbVRva2VuXG4gKiBzdGF0ZSBpbiBiZXR3ZWVuIGNhbGxzLCB0byBoZWxwIHRoZSBzZXJ2ZXIgdW5kZXJzdGFuZCB3aGljaCByZXNwb25zZXMgdGhlXG4gKiBjbGllbnQgaGFzIHByb2Nlc3NlZCBieSB0aGUgdGltZSB0aGUgbmV4dCByZXF1ZXN0IGlzIG1hZGUuIEV2ZXJ5IHJlc3BvbnNlXG4gKiB3aWxsIGNvbnRhaW4gYSBzdHJlYW1Ub2tlbjsgdGhpcyB2YWx1ZSBtdXN0IGJlIHBhc3NlZCB0byB0aGUgbmV4dFxuICogcmVxdWVzdC5cbiAqXG4gKiBBZnRlciBjYWxsaW5nIHN0YXJ0KCkgb24gdGhpcyBzdHJlYW0sIHRoZSBuZXh0IHJlcXVlc3QgbXVzdCBiZSBhIGhhbmRzaGFrZSxcbiAqIGNvbnRhaW5pbmcgd2hhdGV2ZXIgc3RyZWFtVG9rZW4gaXMgb24gaGFuZC4gT25jZSBhIHJlc3BvbnNlIHRvIHRoaXNcbiAqIHJlcXVlc3QgaXMgcmVjZWl2ZWQsIGFsbCBwZW5kaW5nIG11dGF0aW9ucyBtYXkgYmUgc3VibWl0dGVkLiBXaGVuXG4gKiBzdWJtaXR0aW5nIG11bHRpcGxlIGJhdGNoZXMgb2YgbXV0YXRpb25zIGF0IHRoZSBzYW1lIHRpbWUsIGl0J3NcbiAqIG9rYXkgdG8gdXNlIHRoZSBzYW1lIHN0cmVhbVRva2VuIGZvciB0aGUgY2FsbHMgdG8gd3JpdGVNdXRhdGlvbnMuXG4gKlxuICogVE9ETyhiLzMzMjcxMjM1KTogVXNlIHByb3RvIHR5cGVzXG4gKi8gY2xhc3MgdG8gZXh0ZW5kcyBYciB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcywgaSkge1xuICAgICAgICBzdXBlcih0LCBcIndyaXRlX3N0cmVhbV9jb25uZWN0aW9uX2JhY2tvZmZcIiAvKiBXcml0ZVN0cmVhbUNvbm5lY3Rpb25CYWNrb2ZmICovICwgXCJ3cml0ZV9zdHJlYW1faWRsZVwiIC8qIFdyaXRlU3RyZWFtSWRsZSAqLyAsIGUsIG4sIGkpLCBcbiAgICAgICAgdGhpcy5OID0gcywgdGhpcy5SciA9ICExO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUcmFja3Mgd2hldGhlciBvciBub3QgYSBoYW5kc2hha2UgaGFzIGJlZW4gc3VjY2Vzc2Z1bGx5IGV4Y2hhbmdlZCBhbmRcbiAgICAgKiB0aGUgc3RyZWFtIGlzIHJlYWR5IHRvIGFjY2VwdCBtdXRhdGlvbnMuXG4gICAgICovICAgIGdldCBQcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuUnI7XG4gICAgfVxuICAgIC8vIE92ZXJyaWRlIG9mIFBlcnNpc3RlbnRTdHJlYW0uc3RhcnRcbiAgICBzdGFydCgpIHtcbiAgICAgICAgdGhpcy5SciA9ICExLCB0aGlzLmxhc3RTdHJlYW1Ub2tlbiA9IHZvaWQgMCwgc3VwZXIuc3RhcnQoKTtcbiAgICB9XG4gICAgbXIoKSB7XG4gICAgICAgIHRoaXMuUnIgJiYgdGhpcy5icihbXSk7XG4gICAgfVxuICAgIEVyKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubnIuamkoXCJXcml0ZVwiLCB0KTtcbiAgICB9XG4gICAgb25NZXNzYWdlKHQpIHtcbiAgICAgICAgaWYgKFxuICAgICAgICAvLyBBbHdheXMgY2FwdHVyZSB0aGUgbGFzdCBzdHJlYW0gdG9rZW4uXG4gICAgICAgIEwoISF0LnN0cmVhbVRva2VuKSwgdGhpcy5sYXN0U3RyZWFtVG9rZW4gPSB0LnN0cmVhbVRva2VuLCB0aGlzLlJyKSB7XG4gICAgICAgICAgICAvLyBBIHN1Y2Nlc3NmdWwgZmlyc3Qgd3JpdGUgcmVzcG9uc2UgbWVhbnMgdGhlIHN0cmVhbSBpcyBoZWFsdGh5LFxuICAgICAgICAgICAgLy8gTm90ZSwgdGhhdCB3ZSBjb3VsZCBjb25zaWRlciBhIHN1Y2Nlc3NmdWwgaGFuZHNoYWtlIGhlYWx0aHksIGhvd2V2ZXIsXG4gICAgICAgICAgICAvLyB0aGUgd3JpdGUgaXRzZWxmIG1pZ2h0IGJlIGNhdXNpbmcgYW4gZXJyb3Igd2Ugd2FudCB0byBiYWNrIG9mZiBmcm9tLlxuICAgICAgICAgICAgdGhpcy5yci5yZXNldCgpO1xuICAgICAgICAgICAgY29uc3QgZSA9IGlzKHQud3JpdGVSZXN1bHRzLCB0LmNvbW1pdFRpbWUpLCBuID0gS24odC5jb21taXRUaW1lKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmxpc3RlbmVyLnZyKG4sIGUpO1xuICAgICAgICB9XG4gICAgICAgIC8vIFRoZSBmaXJzdCByZXNwb25zZSBpcyBhbHdheXMgdGhlIGhhbmRzaGFrZSByZXNwb25zZVxuICAgICAgICByZXR1cm4gTCghdC53cml0ZVJlc3VsdHMgfHwgMCA9PT0gdC53cml0ZVJlc3VsdHMubGVuZ3RoKSwgdGhpcy5SciA9ICEwLCB0aGlzLmxpc3RlbmVyLlZyKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlbmRzIGFuIGluaXRpYWwgc3RyZWFtVG9rZW4gdG8gdGhlIHNlcnZlciwgcGVyZm9ybWluZyB0aGUgaGFuZHNoYWtlXG4gICAgICogcmVxdWlyZWQgdG8gbWFrZSB0aGUgU3RyZWFtaW5nV3JpdGUgUlBDIHdvcmsuIFN1YnNlcXVlbnRcbiAgICAgKiBjYWxscyBzaG91bGQgd2FpdCB1bnRpbCBvbkhhbmRzaGFrZUNvbXBsZXRlIHdhcyBjYWxsZWQuXG4gICAgICovICAgIFNyKCkge1xuICAgICAgICAvLyBUT0RPKGRpbW9uZCk6IFN1cHBvcnQgc3RyZWFtIHJlc3VtcHRpb24uIFdlIGludGVudGlvbmFsbHkgZG8gbm90IHNldCB0aGVcbiAgICAgICAgLy8gc3RyZWFtIHRva2VuIG9uIHRoZSBoYW5kc2hha2UsIGlnbm9yaW5nIGFueSBzdHJlYW0gdG9rZW4gd2UgbWlnaHQgaGF2ZS5cbiAgICAgICAgY29uc3QgdCA9IHt9O1xuICAgICAgICB0LmRhdGFiYXNlID0gSm4odGhpcy5OKSwgdGhpcy53cih0KTtcbiAgICB9XG4gICAgLyoqIFNlbmRzIGEgZ3JvdXAgb2YgbXV0YXRpb25zIHRvIHRoZSBGaXJlc3RvcmUgYmFja2VuZCB0byBhcHBseS4gKi8gICAgYnIodCkge1xuICAgICAgICBjb25zdCBlID0ge1xuICAgICAgICAgICAgc3RyZWFtVG9rZW46IHRoaXMubGFzdFN0cmVhbVRva2VuLFxuICAgICAgICAgICAgd3JpdGVzOiB0Lm1hcCgodCA9PiBucyh0aGlzLk4sIHQpKSlcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy53cihlKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIERhdGFzdG9yZSBhbmQgaXRzIHJlbGF0ZWQgbWV0aG9kcyBhcmUgYSB3cmFwcGVyIGFyb3VuZCB0aGUgZXh0ZXJuYWwgR29vZ2xlXG4gKiBDbG91ZCBEYXRhc3RvcmUgZ3JwYyBBUEksIHdoaWNoIHByb3ZpZGVzIGFuIGludGVyZmFjZSB0aGF0IGlzIG1vcmUgY29udmVuaWVudFxuICogZm9yIHRoZSByZXN0IG9mIHRoZSBjbGllbnQgU0RLIGFyY2hpdGVjdHVyZSB0byBjb25zdW1lLlxuICovXG4vKipcbiAqIEFuIGltcGxlbWVudGF0aW9uIG9mIERhdGFzdG9yZSB0aGF0IGV4cG9zZXMgYWRkaXRpb25hbCBzdGF0ZSBmb3IgaW50ZXJuYWxcbiAqIGNvbnN1bXB0aW9uLlxuICovXG5jbGFzcyBlbyBleHRlbmRzIGNsYXNzIHt9IHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMuY3JlZGVudGlhbHMgPSB0LCB0aGlzLm5yID0gZSwgdGhpcy5OID0gbiwgdGhpcy5EciA9ICExO1xuICAgIH1cbiAgICBDcigpIHtcbiAgICAgICAgaWYgKHRoaXMuRHIpIHRocm93IG5ldyBLKHEuRkFJTEVEX1BSRUNPTkRJVElPTiwgXCJUaGUgY2xpZW50IGhhcyBhbHJlYWR5IGJlZW4gdGVybWluYXRlZC5cIik7XG4gICAgfVxuICAgIC8qKiBHZXRzIGFuIGF1dGggdG9rZW4gYW5kIGludm9rZXMgdGhlIHByb3ZpZGVkIFJQQy4gKi8gICAgTGkodCwgZSwgbikge1xuICAgICAgICByZXR1cm4gdGhpcy5DcigpLCB0aGlzLmNyZWRlbnRpYWxzLmdldFRva2VuKCkudGhlbigocyA9PiB0aGlzLm5yLkxpKHQsIGUsIG4sIHMpKSkuY2F0Y2goKHQgPT4ge1xuICAgICAgICAgICAgdGhyb3cgXCJGaXJlYmFzZUVycm9yXCIgPT09IHQubmFtZSA/ICh0LmNvZGUgPT09IHEuVU5BVVRIRU5USUNBVEVEICYmIHRoaXMuY3JlZGVudGlhbHMuaW52YWxpZGF0ZVRva2VuKCksIFxuICAgICAgICAgICAgdCkgOiBuZXcgSyhxLlVOS05PV04sIHQudG9TdHJpbmcoKSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgLyoqIEdldHMgYW4gYXV0aCB0b2tlbiBhbmQgaW52b2tlcyB0aGUgcHJvdmlkZWQgUlBDIHdpdGggc3RyZWFtZWQgcmVzdWx0cy4gKi8gICAgS2kodCwgZSwgbikge1xuICAgICAgICByZXR1cm4gdGhpcy5DcigpLCB0aGlzLmNyZWRlbnRpYWxzLmdldFRva2VuKCkudGhlbigocyA9PiB0aGlzLm5yLktpKHQsIGUsIG4sIHMpKSkuY2F0Y2goKHQgPT4ge1xuICAgICAgICAgICAgdGhyb3cgXCJGaXJlYmFzZUVycm9yXCIgPT09IHQubmFtZSA/ICh0LmNvZGUgPT09IHEuVU5BVVRIRU5USUNBVEVEICYmIHRoaXMuY3JlZGVudGlhbHMuaW52YWxpZGF0ZVRva2VuKCksIFxuICAgICAgICAgICAgdCkgOiBuZXcgSyhxLlVOS05PV04sIHQudG9TdHJpbmcoKSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdGVybWluYXRlKCkge1xuICAgICAgICB0aGlzLkRyID0gITA7XG4gICAgfVxufVxuXG4vLyBUT0RPKGZpcmVzdG9yZXhwKTogTWFrZSBzdXJlIHRoZXJlIGlzIG9ubHkgb25lIERhdGFzdG9yZSBpbnN0YW5jZSBwZXJcbi8vIGZpcmVzdG9yZS1leHAgY2xpZW50LlxuLyoqXG4gKiBBIGNvbXBvbmVudCB1c2VkIGJ5IHRoZSBSZW1vdGVTdG9yZSB0byB0cmFjayB0aGUgT25saW5lU3RhdGUgKHRoYXQgaXMsXG4gKiB3aGV0aGVyIG9yIG5vdCB0aGUgY2xpZW50IGFzIGEgd2hvbGUgc2hvdWxkIGJlIGNvbnNpZGVyZWQgdG8gYmUgb25saW5lIG9yXG4gKiBvZmZsaW5lKSwgaW1wbGVtZW50aW5nIHRoZSBhcHByb3ByaWF0ZSBoZXVyaXN0aWNzLlxuICpcbiAqIEluIHBhcnRpY3VsYXIsIHdoZW4gdGhlIGNsaWVudCBpcyB0cnlpbmcgdG8gY29ubmVjdCB0byB0aGUgYmFja2VuZCwgd2VcbiAqIGFsbG93IHVwIHRvIE1BWF9XQVRDSF9TVFJFQU1fRkFJTFVSRVMgd2l0aGluIE9OTElORV9TVEFURV9USU1FT1VUX01TIGZvclxuICogYSBjb25uZWN0aW9uIHRvIHN1Y2NlZWQuIElmIHdlIGhhdmUgdG9vIG1hbnkgZmFpbHVyZXMgb3IgdGhlIHRpbWVvdXQgZWxhcHNlcyxcbiAqIHRoZW4gd2Ugc2V0IHRoZSBPbmxpbmVTdGF0ZSB0byBPZmZsaW5lLCBhbmQgdGhlIGNsaWVudCB3aWxsIGJlaGF2ZSBhcyBpZlxuICogaXQgaXMgb2ZmbGluZSAoZ2V0KClzIHdpbGwgcmV0dXJuIGNhY2hlZCBkYXRhLCBldGMuKS5cbiAqL1xuY2xhc3Mgbm8ge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5hc3luY1F1ZXVlID0gdCwgdGhpcy5vbmxpbmVTdGF0ZUhhbmRsZXIgPSBlLCBcbiAgICAgICAgLyoqIFRoZSBjdXJyZW50IE9ubGluZVN0YXRlLiAqL1xuICAgICAgICB0aGlzLnN0YXRlID0gXCJVbmtub3duXCIgLyogVW5rbm93biAqLyAsIFxuICAgICAgICAvKipcbiAgICAgICAgICogQSBjb3VudCBvZiBjb25zZWN1dGl2ZSBmYWlsdXJlcyB0byBvcGVuIHRoZSBzdHJlYW0uIElmIGl0IHJlYWNoZXMgdGhlXG4gICAgICAgICAqIG1heGltdW0gZGVmaW5lZCBieSBNQVhfV0FUQ0hfU1RSRUFNX0ZBSUxVUkVTLCB3ZSdsbCBzZXQgdGhlIE9ubGluZVN0YXRlIHRvXG4gICAgICAgICAqIE9mZmxpbmUuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLk5yID0gMCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIHRpbWVyIHRoYXQgZWxhcHNlcyBhZnRlciBPTkxJTkVfU1RBVEVfVElNRU9VVF9NUywgYXQgd2hpY2ggcG9pbnQgd2VcbiAgICAgICAgICogdHJhbnNpdGlvbiBmcm9tIE9ubGluZVN0YXRlLlVua25vd24gdG8gT25saW5lU3RhdGUuT2ZmbGluZSB3aXRob3V0IHdhaXRpbmdcbiAgICAgICAgICogZm9yIHRoZSBzdHJlYW0gdG8gYWN0dWFsbHkgZmFpbCAoTUFYX1dBVENIX1NUUkVBTV9GQUlMVVJFUyB0aW1lcykuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmtyID0gbnVsbCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBXaGV0aGVyIHRoZSBjbGllbnQgc2hvdWxkIGxvZyBhIHdhcm5pbmcgbWVzc2FnZSBpZiBpdCBmYWlscyB0byBjb25uZWN0IHRvXG4gICAgICAgICAqIHRoZSBiYWNrZW5kIChpbml0aWFsbHkgdHJ1ZSwgY2xlYXJlZCBhZnRlciBhIHN1Y2Nlc3NmdWwgc3RyZWFtLCBvciBpZiB3ZSd2ZVxuICAgICAgICAgKiBsb2dnZWQgdGhlIG1lc3NhZ2UgYWxyZWFkeSkuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLiRyID0gITA7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENhbGxlZCBieSBSZW1vdGVTdG9yZSB3aGVuIGEgd2F0Y2ggc3RyZWFtIGlzIHN0YXJ0ZWQgKGluY2x1ZGluZyBvbiBlYWNoXG4gICAgICogYmFja29mZiBhdHRlbXB0KS5cbiAgICAgKlxuICAgICAqIElmIHRoaXMgaXMgdGhlIGZpcnN0IGF0dGVtcHQsIGl0IHNldHMgdGhlIE9ubGluZVN0YXRlIHRvIFVua25vd24gYW5kIHN0YXJ0c1xuICAgICAqIHRoZSBvbmxpbmVTdGF0ZVRpbWVyLlxuICAgICAqLyAgICBPcigpIHtcbiAgICAgICAgMCA9PT0gdGhpcy5OciAmJiAodGhpcy5GcihcIlVua25vd25cIiAvKiBVbmtub3duICovKSwgdGhpcy5rciA9IHRoaXMuYXN5bmNRdWV1ZS5lbnF1ZXVlQWZ0ZXJEZWxheShcIm9ubGluZV9zdGF0ZV90aW1lb3V0XCIgLyogT25saW5lU3RhdGVUaW1lb3V0ICovICwgMWU0LCAoKCkgPT4gKHRoaXMua3IgPSBudWxsLCBcbiAgICAgICAgdGhpcy5NcihcIkJhY2tlbmQgZGlkbid0IHJlc3BvbmQgd2l0aGluIDEwIHNlY29uZHMuXCIpLCB0aGlzLkZyKFwiT2ZmbGluZVwiIC8qIE9mZmxpbmUgKi8pLCBcbiAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkpKSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBVcGRhdGVzIG91ciBPbmxpbmVTdGF0ZSBhcyBhcHByb3ByaWF0ZSBhZnRlciB0aGUgd2F0Y2ggc3RyZWFtIHJlcG9ydHMgYVxuICAgICAqIGZhaWx1cmUuIFRoZSBmaXJzdCBmYWlsdXJlIG1vdmVzIHVzIHRvIHRoZSAnVW5rbm93bicgc3RhdGUuIFdlIHRoZW4gbWF5XG4gICAgICogYWxsb3cgbXVsdGlwbGUgZmFpbHVyZXMgKGJhc2VkIG9uIE1BWF9XQVRDSF9TVFJFQU1fRkFJTFVSRVMpIGJlZm9yZSB3ZVxuICAgICAqIGFjdHVhbGx5IHRyYW5zaXRpb24gdG8gdGhlICdPZmZsaW5lJyBzdGF0ZS5cbiAgICAgKi8gICAgTHIodCkge1xuICAgICAgICBcIk9ubGluZVwiIC8qIE9ubGluZSAqLyA9PT0gdGhpcy5zdGF0ZSA/IHRoaXMuRnIoXCJVbmtub3duXCIgLyogVW5rbm93biAqLykgOiAodGhpcy5OcisrLCBcbiAgICAgICAgdGhpcy5OciA+PSAxICYmICh0aGlzLkJyKCksIHRoaXMuTXIoYENvbm5lY3Rpb24gZmFpbGVkIDEgdGltZXMuIE1vc3QgcmVjZW50IGVycm9yOiAke3QudG9TdHJpbmcoKX1gKSwgXG4gICAgICAgIHRoaXMuRnIoXCJPZmZsaW5lXCIgLyogT2ZmbGluZSAqLykpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRXhwbGljaXRseSBzZXRzIHRoZSBPbmxpbmVTdGF0ZSB0byB0aGUgc3BlY2lmaWVkIHN0YXRlLlxuICAgICAqXG4gICAgICogTm90ZSB0aGF0IHRoaXMgcmVzZXRzIG91ciB0aW1lcnMgLyBmYWlsdXJlIGNvdW50ZXJzLCBldGMuIHVzZWQgYnkgb3VyXG4gICAgICogT2ZmbGluZSBoZXVyaXN0aWNzLCBzbyBtdXN0IG5vdCBiZSB1c2VkIGluIHBsYWNlIG9mXG4gICAgICogaGFuZGxlV2F0Y2hTdHJlYW1TdGFydCgpIGFuZCBoYW5kbGVXYXRjaFN0cmVhbUZhaWx1cmUoKS5cbiAgICAgKi8gICAgc2V0KHQpIHtcbiAgICAgICAgdGhpcy5CcigpLCB0aGlzLk5yID0gMCwgXCJPbmxpbmVcIiAvKiBPbmxpbmUgKi8gPT09IHQgJiYgKFxuICAgICAgICAvLyBXZSd2ZSBjb25uZWN0ZWQgdG8gd2F0Y2ggYXQgbGVhc3Qgb25jZS4gRG9uJ3Qgd2FybiB0aGUgZGV2ZWxvcGVyXG4gICAgICAgIC8vIGFib3V0IGJlaW5nIG9mZmxpbmUgZ29pbmcgZm9yd2FyZC5cbiAgICAgICAgdGhpcy4kciA9ICExKSwgdGhpcy5Gcih0KTtcbiAgICB9XG4gICAgRnIodCkge1xuICAgICAgICB0ICE9PSB0aGlzLnN0YXRlICYmICh0aGlzLnN0YXRlID0gdCwgdGhpcy5vbmxpbmVTdGF0ZUhhbmRsZXIodCkpO1xuICAgIH1cbiAgICBNcih0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBgQ291bGQgbm90IHJlYWNoIENsb3VkIEZpcmVzdG9yZSBiYWNrZW5kLiAke3R9XFxuVGhpcyB0eXBpY2FsbHkgaW5kaWNhdGVzIHRoYXQgeW91ciBkZXZpY2UgZG9lcyBub3QgaGF2ZSBhIGhlYWx0aHkgSW50ZXJuZXQgY29ubmVjdGlvbiBhdCB0aGUgbW9tZW50LiBUaGUgY2xpZW50IHdpbGwgb3BlcmF0ZSBpbiBvZmZsaW5lIG1vZGUgdW50aWwgaXQgaXMgYWJsZSB0byBzdWNjZXNzZnVsbHkgY29ubmVjdCB0byB0aGUgYmFja2VuZC5gO1xuICAgICAgICB0aGlzLiRyID8gKCQoZSksIHRoaXMuJHIgPSAhMSkgOiBrKFwiT25saW5lU3RhdGVUcmFja2VyXCIsIGUpO1xuICAgIH1cbiAgICBCcigpIHtcbiAgICAgICAgbnVsbCAhPT0gdGhpcy5rciAmJiAodGhpcy5rci5jYW5jZWwoKSwgdGhpcy5rciA9IG51bGwpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY2xhc3Mgc28ge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIFRoZSBsb2NhbCBzdG9yZSwgdXNlZCB0byBmaWxsIHRoZSB3cml0ZSBwaXBlbGluZSB3aXRoIG91dGJvdW5kIG11dGF0aW9ucy5cbiAgICAgKi9cbiAgICB0LCBcbiAgICAvKiogVGhlIGNsaWVudC1zaWRlIHByb3h5IGZvciBpbnRlcmFjdGluZyB3aXRoIHRoZSBiYWNrZW5kLiAqL1xuICAgIGUsIG4sIHMsIGkpIHtcbiAgICAgICAgdGhpcy5sb2NhbFN0b3JlID0gdCwgdGhpcy5kYXRhc3RvcmUgPSBlLCB0aGlzLmFzeW5jUXVldWUgPSBuLCB0aGlzLnJlbW90ZVN5bmNlciA9IHt9LCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgbGlzdCBvZiB1cCB0byBNQVhfUEVORElOR19XUklURVMgd3JpdGVzIHRoYXQgd2UgaGF2ZSBmZXRjaGVkIGZyb20gdGhlXG4gICAgICAgICAqIExvY2FsU3RvcmUgdmlhIGZpbGxXcml0ZVBpcGVsaW5lKCkgYW5kIGhhdmUgb3Igd2lsbCBzZW5kIHRvIHRoZSB3cml0ZVxuICAgICAgICAgKiBzdHJlYW0uXG4gICAgICAgICAqXG4gICAgICAgICAqIFdoZW5ldmVyIHdyaXRlUGlwZWxpbmUubGVuZ3RoID4gMCB0aGUgUmVtb3RlU3RvcmUgd2lsbCBhdHRlbXB0IHRvIHN0YXJ0IG9yXG4gICAgICAgICAqIHJlc3RhcnQgdGhlIHdyaXRlIHN0cmVhbS4gV2hlbiB0aGUgc3RyZWFtIGlzIGVzdGFibGlzaGVkIHRoZSB3cml0ZXMgaW4gdGhlXG4gICAgICAgICAqIHBpcGVsaW5lIHdpbGwgYmUgc2VudCBpbiBvcmRlci5cbiAgICAgICAgICpcbiAgICAgICAgICogV3JpdGVzIHJlbWFpbiBpbiB3cml0ZVBpcGVsaW5lIHVudGlsIHRoZXkgYXJlIGFja25vd2xlZGdlZCBieSB0aGUgYmFja2VuZFxuICAgICAgICAgKiBhbmQgdGh1cyB3aWxsIGF1dG9tYXRpY2FsbHkgYmUgcmUtc2VudCBpZiB0aGUgc3RyZWFtIGlzIGludGVycnVwdGVkIC9cbiAgICAgICAgICogcmVzdGFydGVkIGJlZm9yZSB0aGV5J3JlIGFja25vd2xlZGdlZC5cbiAgICAgICAgICpcbiAgICAgICAgICogV3JpdGUgcmVzcG9uc2VzIGZyb20gdGhlIGJhY2tlbmQgYXJlIGxpbmtlZCB0byB0aGVpciBvcmlnaW5hdGluZyByZXF1ZXN0XG4gICAgICAgICAqIHB1cmVseSBiYXNlZCBvbiBvcmRlciwgYW5kIHNvIHdlIGNhbiBqdXN0IHNoaWZ0KCkgd3JpdGVzIGZyb20gdGhlIGZyb250IG9mXG4gICAgICAgICAqIHRoZSB3cml0ZVBpcGVsaW5lIGFzIHdlIHJlY2VpdmUgcmVzcG9uc2VzLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5VciA9IFtdLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgbWFwcGluZyBvZiB3YXRjaGVkIHRhcmdldHMgdGhhdCB0aGUgY2xpZW50IGNhcmVzIGFib3V0IHRyYWNraW5nIGFuZCB0aGVcbiAgICAgICAgICogdXNlciBoYXMgZXhwbGljaXRseSBjYWxsZWQgYSAnbGlzdGVuJyBmb3IgdGhpcyB0YXJnZXQuXG4gICAgICAgICAqXG4gICAgICAgICAqIFRoZXNlIHRhcmdldHMgbWF5IG9yIG1heSBub3QgaGF2ZSBiZWVuIHNlbnQgdG8gb3IgYWNrbm93bGVkZ2VkIGJ5IHRoZVxuICAgICAgICAgKiBzZXJ2ZXIuIE9uIHJlLWVzdGFibGlzaGluZyB0aGUgbGlzdGVuIHN0cmVhbSwgdGhlc2UgdGFyZ2V0cyBzaG91bGQgYmUgc2VudFxuICAgICAgICAgKiB0byB0aGUgc2VydmVyLiBUaGUgdGFyZ2V0cyByZW1vdmVkIHdpdGggdW5saXN0ZW5zIGFyZSByZW1vdmVkIGVhZ2VybHlcbiAgICAgICAgICogd2l0aG91dCB3YWl0aW5nIGZvciBjb25maXJtYXRpb24gZnJvbSB0aGUgbGlzdGVuIHN0cmVhbS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucXIgPSBuZXcgTWFwLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgc2V0IG9mIHJlYXNvbnMgZm9yIHdoeSB0aGUgUmVtb3RlU3RvcmUgbWF5IGJlIG9mZmxpbmUuIElmIGVtcHR5LCB0aGVcbiAgICAgICAgICogUmVtb3RlU3RvcmUgbWF5IHN0YXJ0IGl0cyBuZXR3b3JrIGNvbm5lY3Rpb25zLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5LciA9IG5ldyBTZXQsIFxuICAgICAgICAvKipcbiAgICAgICAgICogRXZlbnQgaGFuZGxlcnMgdGhhdCBnZXQgY2FsbGVkIHdoZW4gdGhlIG5ldHdvcmsgaXMgZGlzYWJsZWQgb3IgZW5hYmxlZC5cbiAgICAgICAgICpcbiAgICAgICAgICogUE9SVElORyBOT1RFOiBUaGVzZSBmdW5jdGlvbnMgYXJlIHVzZWQgb24gdGhlIFdlYiBjbGllbnQgdG8gY3JlYXRlIHRoZVxuICAgICAgICAgKiB1bmRlcmx5aW5nIHN0cmVhbXMgKHRvIHN1cHBvcnQgdHJlZS1zaGFrZWFibGUgc3RyZWFtcykuIE9uIEFuZHJvaWQgYW5kIGlPUyxcbiAgICAgICAgICogdGhlIHN0cmVhbXMgYXJlIGNyZWF0ZWQgZHVyaW5nIGNvbnN0cnVjdGlvbiBvZiBSZW1vdGVTdG9yZS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuanIgPSBbXSwgdGhpcy5RciA9IGksIHRoaXMuUXIuRWkoKHQgPT4ge1xuICAgICAgICAgICAgbi5lbnF1ZXVlQW5kRm9yZ2V0KChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gUG9ydGluZyBOb3RlOiBVbmxpa2UgaU9TLCBgcmVzdGFydE5ldHdvcmsoKWAgaXMgY2FsbGVkIGV2ZW4gd2hlbiB0aGVcbiAgICAgICAgICAgICAgICAvLyBuZXR3b3JrIGJlY29tZXMgdW5yZWFjaGFibGUgYXMgd2UgZG9uJ3QgaGF2ZSBhbnkgb3RoZXIgd2F5IHRvIHRlYXJcbiAgICAgICAgICAgICAgICAvLyBkb3duIG91ciBzdHJlYW1zLlxuICAgICAgICAgICAgICAgIGZvKHRoaXMpICYmIChrKFwiUmVtb3RlU3RvcmVcIiwgXCJSZXN0YXJ0aW5nIHN0cmVhbXMgZm9yIG5ldHdvcmsgcmVhY2hhYmlsaXR5IGNoYW5nZS5cIiksIFxuICAgICAgICAgICAgICAgIGF3YWl0IGFzeW5jIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IFUodCk7XG4gICAgICAgICAgICAgICAgICAgIGUuS3IuYWRkKDQgLyogQ29ubmVjdGl2aXR5Q2hhbmdlICovKSwgYXdhaXQgcm8oZSksIGUuV3Iuc2V0KFwiVW5rbm93blwiIC8qIFVua25vd24gKi8pLCBcbiAgICAgICAgICAgICAgICAgICAgZS5Lci5kZWxldGUoNCAvKiBDb25uZWN0aXZpdHlDaGFuZ2UgKi8pLCBhd2FpdCBpbyhlKTtcbiAgICAgICAgICAgICAgICB9KHRoaXMpKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSkpLCB0aGlzLldyID0gbmV3IG5vKG4sIHMpO1xuICAgIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gaW8odCkge1xuICAgIGlmIChmbyh0KSkgZm9yIChjb25zdCBlIG9mIHQuanIpIGF3YWl0IGUoLyogZW5hYmxlZD0gKi8gITApO1xufVxuXG4vKipcbiAqIFRlbXBvcmFyaWx5IGRpc2FibGVzIHRoZSBuZXR3b3JrLiBUaGUgbmV0d29yayBjYW4gYmUgcmUtZW5hYmxlZCB1c2luZ1xuICogZW5hYmxlTmV0d29yaygpLlxuICovIGFzeW5jIGZ1bmN0aW9uIHJvKHQpIHtcbiAgICBmb3IgKGNvbnN0IGUgb2YgdC5qcikgYXdhaXQgZSgvKiBlbmFibGVkPSAqLyAhMSk7XG59XG5cbi8qKlxuICogU3RhcnRzIG5ldyBsaXN0ZW4gZm9yIHRoZSBnaXZlbiB0YXJnZXQuIFVzZXMgcmVzdW1lIHRva2VuIGlmIHByb3ZpZGVkLiBJdFxuICogaXMgYSBuby1vcCBpZiB0aGUgdGFyZ2V0IG9mIGdpdmVuIGBUYXJnZXREYXRhYCBpcyBhbHJlYWR5IGJlaW5nIGxpc3RlbmVkIHRvLlxuICovXG5mdW5jdGlvbiBvbyh0LCBlKSB7XG4gICAgY29uc3QgbiA9IFUodCk7XG4gICAgbi5xci5oYXMoZS50YXJnZXRJZCkgfHwgKFxuICAgIC8vIE1hcmsgdGhpcyBhcyBzb21ldGhpbmcgdGhlIGNsaWVudCBpcyBjdXJyZW50bHkgbGlzdGVuaW5nIGZvci5cbiAgICBuLnFyLnNldChlLnRhcmdldElkLCBlKSwgbG8obikgPyBcbiAgICAvLyBUaGUgbGlzdGVuIHdpbGwgYmUgc2VudCBpbiBvbldhdGNoU3RyZWFtT3BlblxuICAgIGhvKG4pIDogRG8obikuY3IoKSAmJiBjbyhuLCBlKSk7XG59XG5cbi8qKlxuICogUmVtb3ZlcyB0aGUgbGlzdGVuIGZyb20gc2VydmVyLiBJdCBpcyBhIG5vLW9wIGlmIHRoZSBnaXZlbiB0YXJnZXQgaWQgaXNcbiAqIG5vdCBiZWluZyBsaXN0ZW5lZCB0by5cbiAqLyBmdW5jdGlvbiBhbyh0LCBlKSB7XG4gICAgY29uc3QgbiA9IFUodCksIHMgPSBEbyhuKTtcbiAgICBuLnFyLmRlbGV0ZShlKSwgcy5jcigpICYmIHVvKG4sIGUpLCAwID09PSBuLnFyLnNpemUgJiYgKHMuY3IoKSA/IHMubHIoKSA6IGZvKG4pICYmIFxuICAgIC8vIFJldmVydCB0byBPbmxpbmVTdGF0ZS5Vbmtub3duIGlmIHRoZSB3YXRjaCBzdHJlYW0gaXMgbm90IG9wZW4gYW5kIHdlXG4gICAgLy8gaGF2ZSBubyBsaXN0ZW5lcnMsIHNpbmNlIHdpdGhvdXQgYW55IGxpc3RlbnMgdG8gc2VuZCB3ZSBjYW5ub3RcbiAgICAvLyBjb25maXJtIGlmIHRoZSBzdHJlYW0gaXMgaGVhbHRoeSBhbmQgdXBncmFkZSB0byBPbmxpbmVTdGF0ZS5PbmxpbmUuXG4gICAgbi5Xci5zZXQoXCJVbmtub3duXCIgLyogVW5rbm93biAqLykpO1xufVxuXG4vKipcbiAqIFdlIG5lZWQgdG8gaW5jcmVtZW50IHRoZSB0aGUgZXhwZWN0ZWQgbnVtYmVyIG9mIHBlbmRpbmcgcmVzcG9uc2VzIHdlJ3JlIGR1ZVxuICogZnJvbSB3YXRjaCBzbyB3ZSB3YWl0IGZvciB0aGUgYWNrIHRvIHByb2Nlc3MgYW55IG1lc3NhZ2VzIGZyb20gdGhpcyB0YXJnZXQuXG4gKi8gZnVuY3Rpb24gY28odCwgZSkge1xuICAgIHQuR3IuWShlLnRhcmdldElkKSwgRG8odCkuSXIoZSk7XG59XG5cbi8qKlxuICogV2UgbmVlZCB0byBpbmNyZW1lbnQgdGhlIGV4cGVjdGVkIG51bWJlciBvZiBwZW5kaW5nIHJlc3BvbnNlcyB3ZSdyZSBkdWVcbiAqIGZyb20gd2F0Y2ggc28gd2Ugd2FpdCBmb3IgdGhlIHJlbW92YWwgb24gdGhlIHNlcnZlciBiZWZvcmUgd2UgcHJvY2VzcyBhbnlcbiAqIG1lc3NhZ2VzIGZyb20gdGhpcyB0YXJnZXQuXG4gKi8gZnVuY3Rpb24gdW8odCwgZSkge1xuICAgIHQuR3IuWShlKSwgRG8odCkuQXIoZSk7XG59XG5cbmZ1bmN0aW9uIGhvKHQpIHtcbiAgICB0LkdyID0gbmV3IGtuKHtcbiAgICAgICAgZ2V0UmVtb3RlS2V5c0ZvclRhcmdldDogZSA9PiB0LnJlbW90ZVN5bmNlci5nZXRSZW1vdGVLZXlzRm9yVGFyZ2V0KGUpLFxuICAgICAgICBFdDogZSA9PiB0LnFyLmdldChlKSB8fCBudWxsXG4gICAgfSksIERvKHQpLnN0YXJ0KCksIHQuV3IuT3IoKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHdoZXRoZXIgdGhlIHdhdGNoIHN0cmVhbSBzaG91bGQgYmUgc3RhcnRlZCBiZWNhdXNlIGl0J3MgbmVjZXNzYXJ5XG4gKiBhbmQgaGFzIG5vdCB5ZXQgYmVlbiBzdGFydGVkLlxuICovIGZ1bmN0aW9uIGxvKHQpIHtcbiAgICByZXR1cm4gZm8odCkgJiYgIURvKHQpLmFyKCkgJiYgdC5xci5zaXplID4gMDtcbn1cblxuZnVuY3Rpb24gZm8odCkge1xuICAgIHJldHVybiAwID09PSBVKHQpLktyLnNpemU7XG59XG5cbmZ1bmN0aW9uIHdvKHQpIHtcbiAgICB0LkdyID0gdm9pZCAwO1xufVxuXG5hc3luYyBmdW5jdGlvbiBfbyh0KSB7XG4gICAgdC5xci5mb3JFYWNoKCgoZSwgbikgPT4ge1xuICAgICAgICBjbyh0LCBlKTtcbiAgICB9KSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIG1vKHQsIGUpIHtcbiAgICB3byh0KSwgXG4gICAgLy8gSWYgd2Ugc3RpbGwgbmVlZCB0aGUgd2F0Y2ggc3RyZWFtLCByZXRyeSB0aGUgY29ubmVjdGlvbi5cbiAgICBsbyh0KSA/ICh0LldyLkxyKGUpLCBobyh0KSkgOiBcbiAgICAvLyBObyBuZWVkIHRvIHJlc3RhcnQgd2F0Y2ggc3RyZWFtIGJlY2F1c2UgdGhlcmUgYXJlIG5vIGFjdGl2ZSB0YXJnZXRzLlxuICAgIC8vIFRoZSBvbmxpbmUgc3RhdGUgaXMgc2V0IHRvIHVua25vd24gYmVjYXVzZSB0aGVyZSBpcyBubyBhY3RpdmUgYXR0ZW1wdFxuICAgIC8vIGF0IGVzdGFibGlzaGluZyBhIGNvbm5lY3Rpb25cbiAgICB0LldyLnNldChcIlVua25vd25cIiAvKiBVbmtub3duICovKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gZ28odCwgZSwgbikge1xuICAgIGlmIChcbiAgICAvLyBNYXJrIHRoZSBjbGllbnQgYXMgb25saW5lIHNpbmNlIHdlIGdvdCBhIG1lc3NhZ2UgZnJvbSB0aGUgc2VydmVyXG4gICAgdC5Xci5zZXQoXCJPbmxpbmVcIiAvKiBPbmxpbmUgKi8pLCBlIGluc3RhbmNlb2YgTm4gJiYgMiAvKiBSZW1vdmVkICovID09PSBlLnN0YXRlICYmIGUuY2F1c2UpIFxuICAgIC8vIFRoZXJlIHdhcyBhbiBlcnJvciBvbiBhIHRhcmdldCwgZG9uJ3Qgd2FpdCBmb3IgYSBjb25zaXN0ZW50IHNuYXBzaG90XG4gICAgLy8gdG8gcmFpc2UgZXZlbnRzXG4gICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgXG4gICAgICAgIC8qKiBIYW5kbGVzIGFuIGVycm9yIG9uIGEgdGFyZ2V0ICovXG4gICAgICAgIGFzeW5jIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBlLmNhdXNlO1xuICAgICAgICAgICAgZm9yIChjb25zdCBzIG9mIGUudGFyZ2V0SWRzKSBcbiAgICAgICAgICAgIC8vIEEgd2F0Y2hlZCB0YXJnZXQgbWlnaHQgaGF2ZSBiZWVuIHJlbW92ZWQgYWxyZWFkeS5cbiAgICAgICAgICAgIHQucXIuaGFzKHMpICYmIChhd2FpdCB0LnJlbW90ZVN5bmNlci5yZWplY3RMaXN0ZW4ocywgbiksIHQucXIuZGVsZXRlKHMpLCB0LkdyLnJlbW92ZVRhcmdldChzKSk7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gKiBBdHRlbXB0cyB0byBmaWxsIG91ciB3cml0ZSBwaXBlbGluZSB3aXRoIHdyaXRlcyBmcm9tIHRoZSBMb2NhbFN0b3JlLlxuICpcbiAqIENhbGxlZCBpbnRlcm5hbGx5IHRvIGJvb3RzdHJhcCBvciByZWZpbGwgdGhlIHdyaXRlIHBpcGVsaW5lIGFuZCBieVxuICogU3luY0VuZ2luZSB3aGVuZXZlciB0aGVyZSBhcmUgbmV3IG11dGF0aW9ucyB0byBwcm9jZXNzLlxuICpcbiAqIFN0YXJ0cyB0aGUgd3JpdGUgc3RyZWFtIGlmIG5lY2Vzc2FyeS5cbiAqLyAodCwgZSk7XG4gICAgfSBjYXRjaCAobikge1xuICAgICAgICBrKFwiUmVtb3RlU3RvcmVcIiwgXCJGYWlsZWQgdG8gcmVtb3ZlIHRhcmdldHMgJXM6ICVzIFwiLCBlLnRhcmdldElkcy5qb2luKFwiLFwiKSwgbiksIFxuICAgICAgICBhd2FpdCB5byh0LCBuKTtcbiAgICB9IGVsc2UgaWYgKGUgaW5zdGFuY2VvZiBEbiA/IHQuR3IucnQoZSkgOiBlIGluc3RhbmNlb2YgQ24gPyB0LkdyLmZ0KGUpIDogdC5Hci5jdChlKSwgXG4gICAgIW4uaXNFcXVhbChpdC5taW4oKSkpIHRyeSB7XG4gICAgICAgIGNvbnN0IGUgPSBhd2FpdCBscih0LmxvY2FsU3RvcmUpO1xuICAgICAgICBuLmNvbXBhcmVUbyhlKSA+PSAwICYmIFxuICAgICAgICAvLyBXZSBoYXZlIHJlY2VpdmVkIGEgdGFyZ2V0IGNoYW5nZSB3aXRoIGEgZ2xvYmFsIHNuYXBzaG90IGlmIHRoZSBzbmFwc2hvdFxuICAgICAgICAvLyB2ZXJzaW9uIGlzIG5vdCBlcXVhbCB0byBTbmFwc2hvdFZlcnNpb24ubWluKCkuXG4gICAgICAgIGF3YWl0IFxuICAgICAgICAvKipcbiAqIFRha2VzIGEgYmF0Y2ggb2YgY2hhbmdlcyBmcm9tIHRoZSBEYXRhc3RvcmUsIHJlcGFja2FnZXMgdGhlbSBhcyBhXG4gKiBSZW1vdGVFdmVudCwgYW5kIHBhc3NlcyB0aGF0IG9uIHRvIHRoZSBsaXN0ZW5lciwgd2hpY2ggaXMgdHlwaWNhbGx5IHRoZVxuICogU3luY0VuZ2luZS5cbiAqL1xuICAgICAgICBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gdC5Hci5fdChlKTtcbiAgICAgICAgICAgIC8vIFVwZGF0ZSBpbi1tZW1vcnkgcmVzdW1lIHRva2Vucy4gTG9jYWxTdG9yZSB3aWxsIHVwZGF0ZSB0aGVcbiAgICAgICAgICAgIC8vIHBlcnNpc3RlbnQgdmlldyBvZiB0aGVzZSB3aGVuIGFwcGx5aW5nIHRoZSBjb21wbGV0ZWQgUmVtb3RlRXZlbnQuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbi50YXJnZXRDaGFuZ2VzLmZvckVhY2goKChuLCBzKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKG4ucmVzdW1lVG9rZW4uYXBwcm94aW1hdGVCeXRlU2l6ZSgpID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gdC5xci5nZXQocyk7XG4gICAgICAgICAgICAgICAgICAgIC8vIEEgd2F0Y2hlZCB0YXJnZXQgbWlnaHQgaGF2ZSBiZWVuIHJlbW92ZWQgYWxyZWFkeS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpICYmIHQucXIuc2V0KHMsIGkud2l0aFJlc3VtZVRva2VuKG4ucmVzdW1lVG9rZW4sIGUpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSksIFxuICAgICAgICAgICAgLy8gUmUtZXN0YWJsaXNoIGxpc3RlbnMgZm9yIHRoZSB0YXJnZXRzIHRoYXQgaGF2ZSBiZWVuIGludmFsaWRhdGVkIGJ5XG4gICAgICAgICAgICAvLyBleGlzdGVuY2UgZmlsdGVyIG1pc21hdGNoZXMuXG4gICAgICAgICAgICBuLnRhcmdldE1pc21hdGNoZXMuZm9yRWFjaCgoZSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHQucXIuZ2V0KGUpO1xuICAgICAgICAgICAgICAgIGlmICghbikgXG4gICAgICAgICAgICAgICAgLy8gQSB3YXRjaGVkIHRhcmdldCBtaWdodCBoYXZlIGJlZW4gcmVtb3ZlZCBhbHJlYWR5LlxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAvLyBDbGVhciB0aGUgcmVzdW1lIHRva2VuIGZvciB0aGUgdGFyZ2V0LCBzaW5jZSB3ZSdyZSBpbiBhIGtub3duIG1pc21hdGNoXG4gICAgICAgICAgICAgICAgLy8gc3RhdGUuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQucXIuc2V0KGUsIG4ud2l0aFJlc3VtZVRva2VuKHd0LkVNUFRZX0JZVEVfU1RSSU5HLCBuLnNuYXBzaG90VmVyc2lvbikpLCBcbiAgICAgICAgICAgICAgICAvLyBDYXVzZSBhIGhhcmQgcmVzZXQgYnkgdW53YXRjaGluZyBhbmQgcmV3YXRjaGluZyBpbW1lZGlhdGVseSwgYnV0XG4gICAgICAgICAgICAgICAgLy8gZGVsaWJlcmF0ZWx5IGRvbid0IHNlbmQgYSByZXN1bWUgdG9rZW4gc28gdGhhdCB3ZSBnZXQgYSBmdWxsIHVwZGF0ZS5cbiAgICAgICAgICAgICAgICB1byh0LCBlKTtcbiAgICAgICAgICAgICAgICAvLyBNYXJrIHRoZSB0YXJnZXQgd2Ugc2VuZCBhcyBiZWluZyBvbiBiZWhhbGYgb2YgYW4gZXhpc3RlbmNlIGZpbHRlclxuICAgICAgICAgICAgICAgIC8vIG1pc21hdGNoLCBidXQgZG9uJ3QgYWN0dWFsbHkgcmV0YWluIHRoYXQgaW4gbGlzdGVuVGFyZ2V0cy4gVGhpcyBlbnN1cmVzXG4gICAgICAgICAgICAgICAgLy8gdGhhdCB3ZSBmbGFnIHRoZSBmaXJzdCByZS1saXN0ZW4gdGhpcyB3YXkgd2l0aG91dCBpbXBhY3RpbmcgZnV0dXJlXG4gICAgICAgICAgICAgICAgLy8gbGlzdGVucyBvZiB0aGlzIHRhcmdldCAodGhhdCBtaWdodCBoYXBwZW4gZS5nLiBvbiByZWNvbm5lY3QpLlxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBuZXcgc2kobi50YXJnZXQsIGUsIDEgLyogRXhpc3RlbmNlRmlsdGVyTWlzbWF0Y2ggKi8gLCBuLnNlcXVlbmNlTnVtYmVyKTtcbiAgICAgICAgICAgICAgICBjbyh0LCBzKTtcbiAgICAgICAgICAgIH0pKSwgdC5yZW1vdGVTeW5jZXIuYXBwbHlSZW1vdGVFdmVudChuKTtcbiAgICAgICAgfSh0LCBuKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGsoXCJSZW1vdGVTdG9yZVwiLCBcIkZhaWxlZCB0byByYWlzZSBzbmFwc2hvdDpcIiwgZSksIGF3YWl0IHlvKHQsIGUpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBSZWNvdmVyeSBsb2dpYyBmb3IgSW5kZXhlZERCIGVycm9ycyB0aGF0IHRha2VzIHRoZSBuZXR3b3JrIG9mZmxpbmUgdW50aWxcbiAqIGBvcGAgc3VjY2VlZHMuIFJldHJpZXMgYXJlIHNjaGVkdWxlZCB3aXRoIGJhY2tvZmYgdXNpbmdcbiAqIGBlbnF1ZXVlUmV0cnlhYmxlKClgLiBJZiBgb3AoKWAgaXMgbm90IHByb3ZpZGVkLCBJbmRleGVkREIgYWNjZXNzIGlzXG4gKiB2YWxpZGF0ZWQgdmlhIGEgZ2VuZXJpYyBvcGVyYXRpb24uXG4gKlxuICogVGhlIHJldHVybmVkIFByb21pc2UgaXMgcmVzb2x2ZWQgb25jZSB0aGUgbmV0d29yayBpcyBkaXNhYmxlZCBhbmQgYmVmb3JlXG4gKiBhbnkgcmV0cnkgYXR0ZW1wdC5cbiAqLyBhc3luYyBmdW5jdGlvbiB5byh0LCBlLCBuKSB7XG4gICAgaWYgKCF6cyhlKSkgdGhyb3cgZTtcbiAgICB0LktyLmFkZCgxIC8qIEluZGV4ZWREYkZhaWxlZCAqLyksIFxuICAgIC8vIERpc2FibGUgbmV0d29yayBhbmQgcmFpc2Ugb2ZmbGluZSBzbmFwc2hvdHNcbiAgICBhd2FpdCBybyh0KSwgdC5Xci5zZXQoXCJPZmZsaW5lXCIgLyogT2ZmbGluZSAqLyksIG4gfHwgKFxuICAgIC8vIFVzZSBhIHNpbXBsZSByZWFkIG9wZXJhdGlvbiB0byBkZXRlcm1pbmUgaWYgSW5kZXhlZERCIHJlY292ZXJlZC5cbiAgICAvLyBJZGVhbGx5LCB3ZSB3b3VsZCBleHBvc2UgYSBoZWFsdGggY2hlY2sgZGlyZWN0bHkgb24gU2ltcGxlRGIsIGJ1dFxuICAgIC8vIFJlbW90ZVN0b3JlIG9ubHkgaGFzIGFjY2VzcyB0byBwZXJzaXN0ZW5jZSB0aHJvdWdoIExvY2FsU3RvcmUuXG4gICAgbiA9ICgpID0+IGxyKHQubG9jYWxTdG9yZSkpLCBcbiAgICAvLyBQcm9iZSBJbmRleGVkREIgcGVyaW9kaWNhbGx5IGFuZCByZS1lbmFibGUgbmV0d29ya1xuICAgIHQuYXN5bmNRdWV1ZS5lbnF1ZXVlUmV0cnlhYmxlKChhc3luYyAoKSA9PiB7XG4gICAgICAgIGsoXCJSZW1vdGVTdG9yZVwiLCBcIlJldHJ5aW5nIEluZGV4ZWREQiBhY2Nlc3NcIiksIGF3YWl0IG4oKSwgdC5Lci5kZWxldGUoMSAvKiBJbmRleGVkRGJGYWlsZWQgKi8pLCBcbiAgICAgICAgYXdhaXQgaW8odCk7XG4gICAgfSkpO1xufVxuXG4vKipcbiAqIEV4ZWN1dGVzIGBvcGAuIElmIGBvcGAgZmFpbHMsIHRha2VzIHRoZSBuZXR3b3JrIG9mZmxpbmUgdW50aWwgYG9wYFxuICogc3VjY2VlZHMuIFJldHVybnMgYWZ0ZXIgdGhlIGZpcnN0IGF0dGVtcHQuXG4gKi8gZnVuY3Rpb24gcG8odCwgZSkge1xuICAgIHJldHVybiBlKCkuY2F0Y2goKG4gPT4geW8odCwgbiwgZSkpKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gRW8odCkge1xuICAgIGNvbnN0IGUgPSBVKHQpLCBuID0gQ28oZSk7XG4gICAgbGV0IHMgPSBlLlVyLmxlbmd0aCA+IDAgPyBlLlVyW2UuVXIubGVuZ3RoIC0gMV0uYmF0Y2hJZCA6IC0xO1xuICAgIGZvciAoO1RvKGUpOyApIHRyeSB7XG4gICAgICAgIGNvbnN0IHQgPSBhd2FpdCB3cihlLmxvY2FsU3RvcmUsIHMpO1xuICAgICAgICBpZiAobnVsbCA9PT0gdCkge1xuICAgICAgICAgICAgMCA9PT0gZS5Vci5sZW5ndGggJiYgbi5scigpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgcyA9IHQuYmF0Y2hJZCwgSW8oZSwgdCk7XG4gICAgfSBjYXRjaCAodCkge1xuICAgICAgICBhd2FpdCB5byhlLCB0KTtcbiAgICB9XG4gICAgQW8oZSkgJiYgUm8oZSk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIHdlIGNhbiBhZGQgdG8gdGhlIHdyaXRlIHBpcGVsaW5lIChpLmUuIHRoZSBuZXR3b3JrIGlzXG4gKiBlbmFibGVkIGFuZCB0aGUgd3JpdGUgcGlwZWxpbmUgaXMgbm90IGZ1bGwpLlxuICovIGZ1bmN0aW9uIFRvKHQpIHtcbiAgICByZXR1cm4gZm8odCkgJiYgdC5Vci5sZW5ndGggPCAxMDtcbn1cblxuLyoqXG4gKiBRdWV1ZXMgYWRkaXRpb25hbCB3cml0ZXMgdG8gYmUgc2VudCB0byB0aGUgd3JpdGUgc3RyZWFtLCBzZW5kaW5nIHRoZW1cbiAqIGltbWVkaWF0ZWx5IGlmIHRoZSB3cml0ZSBzdHJlYW0gaXMgZXN0YWJsaXNoZWQuXG4gKi8gZnVuY3Rpb24gSW8odCwgZSkge1xuICAgIHQuVXIucHVzaChlKTtcbiAgICBjb25zdCBuID0gQ28odCk7XG4gICAgbi5jcigpICYmIG4uUHIgJiYgbi5icihlLm11dGF0aW9ucyk7XG59XG5cbmZ1bmN0aW9uIEFvKHQpIHtcbiAgICByZXR1cm4gZm8odCkgJiYgIUNvKHQpLmFyKCkgJiYgdC5Vci5sZW5ndGggPiAwO1xufVxuXG5mdW5jdGlvbiBSbyh0KSB7XG4gICAgQ28odCkuc3RhcnQoKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gUG8odCkge1xuICAgIENvKHQpLlNyKCk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGJvKHQpIHtcbiAgICBjb25zdCBlID0gQ28odCk7XG4gICAgLy8gU2VuZCB0aGUgd3JpdGUgcGlwZWxpbmUgbm93IHRoYXQgdGhlIHN0cmVhbSBpcyBlc3RhYmxpc2hlZC5cbiAgICAgICAgZm9yIChjb25zdCBuIG9mIHQuVXIpIGUuYnIobi5tdXRhdGlvbnMpO1xufVxuXG5hc3luYyBmdW5jdGlvbiB2byh0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9IHQuVXIuc2hpZnQoKSwgaSA9IG5pLmZyb20ocywgZSwgbik7XG4gICAgYXdhaXQgcG8odCwgKCgpID0+IHQucmVtb3RlU3luY2VyLmFwcGx5U3VjY2Vzc2Z1bFdyaXRlKGkpKSksIFxuICAgIC8vIEl0J3MgcG9zc2libGUgdGhhdCB3aXRoIHRoZSBjb21wbGV0aW9uIG9mIHRoaXMgbXV0YXRpb24gYW5vdGhlclxuICAgIC8vIHNsb3QgaGFzIGZyZWVkIHVwLlxuICAgIGF3YWl0IEVvKHQpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBWbyh0LCBlKSB7XG4gICAgLy8gSWYgdGhlIHdyaXRlIHN0cmVhbSBjbG9zZWQgYWZ0ZXIgdGhlIHdyaXRlIGhhbmRzaGFrZSBjb21wbGV0ZXMsIGEgd3JpdGVcbiAgICAvLyBvcGVyYXRpb24gZmFpbGVkIGFuZCB3ZSBmYWlsIHRoZSBwZW5kaW5nIG9wZXJhdGlvbi5cbiAgICBlICYmIENvKHQpLlByICYmIFxuICAgIC8vIFRoaXMgZXJyb3IgYWZmZWN0cyB0aGUgYWN0dWFsIHdyaXRlLlxuICAgIGF3YWl0IGFzeW5jIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgLy8gT25seSBoYW5kbGUgcGVybWFuZW50IGVycm9ycyBoZXJlLiBJZiBpdCdzIHRyYW5zaWVudCwganVzdCBsZXQgdGhlIHJldHJ5XG4gICAgICAgIC8vIGxvZ2ljIGtpY2sgaW4uXG4gICAgICAgIGlmIChuID0gZS5jb2RlLCBsbihuKSAmJiBuICE9PSBxLkFCT1JURUQpIHtcbiAgICAgICAgICAgIC8vIFRoaXMgd2FzIGEgcGVybWFuZW50IGVycm9yLCB0aGUgcmVxdWVzdCBpdHNlbGYgd2FzIHRoZSBwcm9ibGVtXG4gICAgICAgICAgICAvLyBzbyBpdCdzIG5vdCBnb2luZyB0byBzdWNjZWVkIGlmIHdlIHJlc2VuZCBpdC5cbiAgICAgICAgICAgIGNvbnN0IG4gPSB0LlVyLnNoaWZ0KCk7XG4gICAgICAgICAgICAvLyBJbiB0aGlzIGNhc2UgaXQncyBhbHNvIHVubGlrZWx5IHRoYXQgdGhlIHNlcnZlciBpdHNlbGYgaXMgbWVsdGluZ1xuICAgICAgICAgICAgLy8gZG93biAtLSB0aGlzIHdhcyBqdXN0IGEgYmFkIHJlcXVlc3Qgc28gaW5oaWJpdCBiYWNrb2ZmIG9uIHRoZSBuZXh0XG4gICAgICAgICAgICAvLyByZXN0YXJ0LlxuICAgICAgICAgICAgICAgICAgICAgICAgQ28odCkuaHIoKSwgYXdhaXQgcG8odCwgKCgpID0+IHQucmVtb3RlU3luY2VyLnJlamVjdEZhaWxlZFdyaXRlKG4uYmF0Y2hJZCwgZSkpKSwgXG4gICAgICAgICAgICAvLyBJdCdzIHBvc3NpYmxlIHRoYXQgd2l0aCB0aGUgY29tcGxldGlvbiBvZiB0aGlzIG11dGF0aW9uXG4gICAgICAgICAgICAvLyBhbm90aGVyIHNsb3QgaGFzIGZyZWVkIHVwLlxuICAgICAgICAgICAgYXdhaXQgRW8odCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG47XG4gICAgfSh0LCBlKSwgXG4gICAgLy8gVGhlIHdyaXRlIHN0cmVhbSBtaWdodCBoYXZlIGJlZW4gc3RhcnRlZCBieSByZWZpbGxpbmcgdGhlIHdyaXRlXG4gICAgLy8gcGlwZWxpbmUgZm9yIGZhaWxlZCB3cml0ZXNcbiAgICBBbyh0KSAmJiBSbyh0KTtcbn1cblxuLyoqXG4gKiBUb2dnbGVzIHRoZSBuZXR3b3JrIHN0YXRlIHdoZW4gdGhlIGNsaWVudCBnYWlucyBvciBsb3NlcyBpdHMgcHJpbWFyeSBsZWFzZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gU28odCwgZSkge1xuICAgIGNvbnN0IG4gPSBVKHQpO1xuICAgIGUgPyAobi5Lci5kZWxldGUoMiAvKiBJc1NlY29uZGFyeSAqLyksIGF3YWl0IGlvKG4pKSA6IGUgfHwgKG4uS3IuYWRkKDIgLyogSXNTZWNvbmRhcnkgKi8pLCBcbiAgICBhd2FpdCBybyhuKSwgbi5Xci5zZXQoXCJVbmtub3duXCIgLyogVW5rbm93biAqLykpO1xufVxuXG4vKipcbiAqIElmIG5vdCB5ZXQgaW5pdGlhbGl6ZWQsIHJlZ2lzdGVycyB0aGUgV2F0Y2hTdHJlYW0gYW5kIGl0cyBuZXR3b3JrIHN0YXRlXG4gKiBjYWxsYmFjayB3aXRoIGByZW1vdGVTdG9yZUltcGxgLiBSZXR1cm5zIHRoZSBleGlzdGluZyBzdHJlYW0gaWYgb25lIGlzXG4gKiBhbHJlYWR5IGF2YWlsYWJsZS5cbiAqXG4gKiBQT1JUSU5HIE5PVEU6IE9uIGlPUyBhbmQgQW5kcm9pZCwgdGhlIFdhdGNoU3RyZWFtIGdldHMgcmVnaXN0ZXJlZCBvbiBzdGFydHVwLlxuICogVGhpcyBpcyBub3QgZG9uZSBvbiBXZWIgdG8gYWxsb3cgaXQgdG8gYmUgdHJlZS1zaGFrZW4uXG4gKi8gZnVuY3Rpb24gRG8odCkge1xuICAgIHJldHVybiB0LnpyIHx8IChcbiAgICAvLyBDcmVhdGUgc3RyZWFtIChidXQgbm90ZSB0aGF0IGl0IGlzIG5vdCBzdGFydGVkIHlldCkuXG4gICAgdC56ciA9IGZ1bmN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgY29uc3QgcyA9IFUodCk7XG4gICAgICAgIHJldHVybiBzLkNyKCksIG5ldyBacihlLCBzLm5yLCBzLmNyZWRlbnRpYWxzLCBzLk4sIG4pO1xuICAgIH1cbiAgICAvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyAodC5kYXRhc3RvcmUsIHQuYXN5bmNRdWV1ZSwge1xuICAgICAgICBTaTogX28uYmluZChudWxsLCB0KSxcbiAgICAgICAgQ2k6IG1vLmJpbmQobnVsbCwgdCksXG4gICAgICAgIFRyOiBnby5iaW5kKG51bGwsIHQpXG4gICAgfSksIHQuanIucHVzaCgoYXN5bmMgZSA9PiB7XG4gICAgICAgIGUgPyAodC56ci5ocigpLCBsbyh0KSA/IGhvKHQpIDogdC5Xci5zZXQoXCJVbmtub3duXCIgLyogVW5rbm93biAqLykpIDogKGF3YWl0IHQuenIuc3RvcCgpLCBcbiAgICAgICAgd28odCkpO1xuICAgIH0pKSksIHQuenI7XG59XG5cbi8qKlxuICogSWYgbm90IHlldCBpbml0aWFsaXplZCwgcmVnaXN0ZXJzIHRoZSBXcml0ZVN0cmVhbSBhbmQgaXRzIG5ldHdvcmsgc3RhdGVcbiAqIGNhbGxiYWNrIHdpdGggYHJlbW90ZVN0b3JlSW1wbGAuIFJldHVybnMgdGhlIGV4aXN0aW5nIHN0cmVhbSBpZiBvbmUgaXNcbiAqIGFscmVhZHkgYXZhaWxhYmxlLlxuICpcbiAqIFBPUlRJTkcgTk9URTogT24gaU9TIGFuZCBBbmRyb2lkLCB0aGUgV3JpdGVTdHJlYW0gZ2V0cyByZWdpc3RlcmVkIG9uIHN0YXJ0dXAuXG4gKiBUaGlzIGlzIG5vdCBkb25lIG9uIFdlYiB0byBhbGxvdyBpdCB0byBiZSB0cmVlLXNoYWtlbi5cbiAqLyBmdW5jdGlvbiBDbyh0KSB7XG4gICAgcmV0dXJuIHQuSHIgfHwgKFxuICAgIC8vIENyZWF0ZSBzdHJlYW0gKGJ1dCBub3RlIHRoYXQgaXQgaXMgbm90IHN0YXJ0ZWQgeWV0KS5cbiAgICB0LkhyID0gZnVuY3Rpb24odCwgZSwgbikge1xuICAgICAgICBjb25zdCBzID0gVSh0KTtcbiAgICAgICAgcmV0dXJuIHMuQ3IoKSwgbmV3IHRvKGUsIHMubnIsIHMuY3JlZGVudGlhbHMsIHMuTiwgbik7XG4gICAgfSh0LmRhdGFzdG9yZSwgdC5hc3luY1F1ZXVlLCB7XG4gICAgICAgIFNpOiBQby5iaW5kKG51bGwsIHQpLFxuICAgICAgICBDaTogVm8uYmluZChudWxsLCB0KSxcbiAgICAgICAgVnI6IGJvLmJpbmQobnVsbCwgdCksXG4gICAgICAgIHZyOiB2by5iaW5kKG51bGwsIHQpXG4gICAgfSksIHQuanIucHVzaCgoYXN5bmMgZSA9PiB7XG4gICAgICAgIGUgPyAodC5Ici5ocigpLCBcbiAgICAgICAgLy8gVGhpcyB3aWxsIHN0YXJ0IHRoZSB3cml0ZSBzdHJlYW0gaWYgbmVjZXNzYXJ5LlxuICAgICAgICBhd2FpdCBFbyh0KSkgOiAoYXdhaXQgdC5Ici5zdG9wKCksIHQuVXIubGVuZ3RoID4gMCAmJiAoayhcIlJlbW90ZVN0b3JlXCIsIGBTdG9wcGluZyB3cml0ZSBzdHJlYW0gd2l0aCAke3QuVXIubGVuZ3RofSBwZW5kaW5nIHdyaXRlc2ApLCBcbiAgICAgICAgdC5VciA9IFtdKSk7XG4gICAgfSkpKSwgdC5Icjtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUmVwcmVzZW50cyBhbiBvcGVyYXRpb24gc2NoZWR1bGVkIHRvIGJlIHJ1biBpbiB0aGUgZnV0dXJlIG9uIGFuIEFzeW5jUXVldWUuXG4gKlxuICogSXQgaXMgY3JlYXRlZCB2aWEgRGVsYXllZE9wZXJhdGlvbi5jcmVhdGVBbmRTY2hlZHVsZSgpLlxuICpcbiAqIFN1cHBvcnRzIGNhbmNlbGxhdGlvbiAodmlhIGNhbmNlbCgpKSBhbmQgZWFybHkgZXhlY3V0aW9uICh2aWEgc2tpcERlbGF5KCkpLlxuICpcbiAqIE5vdGU6IFdlIGltcGxlbWVudCBgUHJvbWlzZUxpa2VgIGluc3RlYWQgb2YgYFByb21pc2VgLCBhcyB0aGUgYFByb21pc2VgIHR5cGVcbiAqIGluIG5ld2VyIHZlcnNpb25zIG9mIFR5cGVTY3JpcHQgZGVmaW5lcyBgZmluYWxseWAsIHdoaWNoIGlzIG5vdCBhdmFpbGFibGUgaW5cbiAqIElFLlxuICovXG5jbGFzcyBObyB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcywgaSkge1xuICAgICAgICB0aGlzLmFzeW5jUXVldWUgPSB0LCB0aGlzLnRpbWVySWQgPSBlLCB0aGlzLnRhcmdldFRpbWVNcyA9IG4sIHRoaXMub3AgPSBzLCB0aGlzLnJlbW92YWxDYWxsYmFjayA9IGksIFxuICAgICAgICB0aGlzLmRlZmVycmVkID0gbmV3IGosIHRoaXMudGhlbiA9IHRoaXMuZGVmZXJyZWQucHJvbWlzZS50aGVuLmJpbmQodGhpcy5kZWZlcnJlZC5wcm9taXNlKSwgXG4gICAgICAgIC8vIEl0J3Mgbm9ybWFsIGZvciB0aGUgZGVmZXJyZWQgcHJvbWlzZSB0byBiZSBjYW5jZWxlZCAoZHVlIHRvIGNhbmNlbGxhdGlvbilcbiAgICAgICAgLy8gYW5kIHNvIHdlIGF0dGFjaCBhIGR1bW15IGNhdGNoIGNhbGxiYWNrIHRvIGF2b2lkXG4gICAgICAgIC8vICdVbmhhbmRsZWRQcm9taXNlUmVqZWN0aW9uV2FybmluZycgbG9nIHNwYW0uXG4gICAgICAgIHRoaXMuZGVmZXJyZWQucHJvbWlzZS5jYXRjaCgodCA9PiB7fSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCByZXR1cm5zIGEgRGVsYXllZE9wZXJhdGlvbiB0aGF0IGhhcyBiZWVuIHNjaGVkdWxlZCB0byBiZVxuICAgICAqIGV4ZWN1dGVkIG9uIHRoZSBwcm92aWRlZCBhc3luY1F1ZXVlIGFmdGVyIHRoZSBwcm92aWRlZCBkZWxheU1zLlxuICAgICAqXG4gICAgICogQHBhcmFtIGFzeW5jUXVldWUgLSBUaGUgcXVldWUgdG8gc2NoZWR1bGUgdGhlIG9wZXJhdGlvbiBvbi5cbiAgICAgKiBAcGFyYW0gaWQgLSBBIFRpbWVyIElEIGlkZW50aWZ5aW5nIHRoZSB0eXBlIG9mIG9wZXJhdGlvbiB0aGlzIGlzLlxuICAgICAqIEBwYXJhbSBkZWxheU1zIC0gVGhlIGRlbGF5IChtcykgYmVmb3JlIHRoZSBvcGVyYXRpb24gc2hvdWxkIGJlIHNjaGVkdWxlZC5cbiAgICAgKiBAcGFyYW0gb3AgLSBUaGUgb3BlcmF0aW9uIHRvIHJ1bi5cbiAgICAgKiBAcGFyYW0gcmVtb3ZhbENhbGxiYWNrIC0gQSBjYWxsYmFjayB0byBiZSBjYWxsZWQgc3luY2hyb25vdXNseSBvbmNlIHRoZVxuICAgICAqICAgb3BlcmF0aW9uIGlzIGV4ZWN1dGVkIG9yIGNhbmNlbGVkLCBub3RpZnlpbmcgdGhlIEFzeW5jUXVldWUgdG8gcmVtb3ZlIGl0XG4gICAgICogICBmcm9tIGl0cyBkZWxheWVkT3BlcmF0aW9ucyBsaXN0LlxuICAgICAqICAgUE9SVElORyBOT1RFOiBUaGlzIGV4aXN0cyB0byBwcmV2ZW50IG1ha2luZyByZW1vdmVEZWxheWVkT3BlcmF0aW9uKCkgYW5kXG4gICAgICogICB0aGUgRGVsYXllZE9wZXJhdGlvbiBjbGFzcyBwdWJsaWMuXG4gICAgICovICAgIHN0YXRpYyBjcmVhdGVBbmRTY2hlZHVsZSh0LCBlLCBuLCBzLCBpKSB7XG4gICAgICAgIGNvbnN0IHIgPSBEYXRlLm5vdygpICsgbiwgbyA9IG5ldyBObyh0LCBlLCByLCBzLCBpKTtcbiAgICAgICAgcmV0dXJuIG8uc3RhcnQobiksIG87XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN0YXJ0cyB0aGUgdGltZXIuIFRoaXMgaXMgY2FsbGVkIGltbWVkaWF0ZWx5IGFmdGVyIGNvbnN0cnVjdGlvbiBieVxuICAgICAqIGNyZWF0ZUFuZFNjaGVkdWxlKCkuXG4gICAgICovICAgIHN0YXJ0KHQpIHtcbiAgICAgICAgdGhpcy50aW1lckhhbmRsZSA9IHNldFRpbWVvdXQoKCgpID0+IHRoaXMuaGFuZGxlRGVsYXlFbGFwc2VkKCkpLCB0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUXVldWVzIHRoZSBvcGVyYXRpb24gdG8gcnVuIGltbWVkaWF0ZWx5IChpZiBpdCBoYXNuJ3QgYWxyZWFkeSBiZWVuIHJ1biBvclxuICAgICAqIGNhbmNlbGVkKS5cbiAgICAgKi8gICAgc2tpcERlbGF5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5oYW5kbGVEZWxheUVsYXBzZWQoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FuY2VscyB0aGUgb3BlcmF0aW9uIGlmIGl0IGhhc24ndCBhbHJlYWR5IGJlZW4gZXhlY3V0ZWQgb3IgY2FuY2VsZWQuIFRoZVxuICAgICAqIHByb21pc2Ugd2lsbCBiZSByZWplY3RlZC5cbiAgICAgKlxuICAgICAqIEFzIGxvbmcgYXMgdGhlIG9wZXJhdGlvbiBoYXMgbm90IHlldCBiZWVuIHJ1biwgY2FsbGluZyBjYW5jZWwoKSBwcm92aWRlcyBhXG4gICAgICogZ3VhcmFudGVlIHRoYXQgdGhlIG9wZXJhdGlvbiB3aWxsIG5vdCBiZSBydW4uXG4gICAgICovICAgIGNhbmNlbCh0KSB7XG4gICAgICAgIG51bGwgIT09IHRoaXMudGltZXJIYW5kbGUgJiYgKHRoaXMuY2xlYXJUaW1lb3V0KCksIHRoaXMuZGVmZXJyZWQucmVqZWN0KG5ldyBLKHEuQ0FOQ0VMTEVELCBcIk9wZXJhdGlvbiBjYW5jZWxsZWRcIiArICh0ID8gXCI6IFwiICsgdCA6IFwiXCIpKSkpO1xuICAgIH1cbiAgICBoYW5kbGVEZWxheUVsYXBzZWQoKSB7XG4gICAgICAgIHRoaXMuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KCgoKSA9PiBudWxsICE9PSB0aGlzLnRpbWVySGFuZGxlID8gKHRoaXMuY2xlYXJUaW1lb3V0KCksIFxuICAgICAgICB0aGlzLm9wKCkudGhlbigodCA9PiB0aGlzLmRlZmVycmVkLnJlc29sdmUodCkpKSkgOiBQcm9taXNlLnJlc29sdmUoKSkpO1xuICAgIH1cbiAgICBjbGVhclRpbWVvdXQoKSB7XG4gICAgICAgIG51bGwgIT09IHRoaXMudGltZXJIYW5kbGUgJiYgKHRoaXMucmVtb3ZhbENhbGxiYWNrKHRoaXMpLCBjbGVhclRpbWVvdXQodGhpcy50aW1lckhhbmRsZSksIFxuICAgICAgICB0aGlzLnRpbWVySGFuZGxlID0gbnVsbCk7XG4gICAgfVxufVxuXG4vKipcbiAqIFJldHVybnMgYSBGaXJlc3RvcmVFcnJvciB0aGF0IGNhbiBiZSBzdXJmYWNlZCB0byB0aGUgdXNlciBpZiB0aGUgcHJvdmlkZWRcbiAqIGVycm9yIGlzIGFuIEluZGV4ZWREYlRyYW5zYWN0aW9uRXJyb3IuIFJlLXRocm93cyB0aGUgZXJyb3Igb3RoZXJ3aXNlLlxuICovIGZ1bmN0aW9uIHhvKHQsIGUpIHtcbiAgICBpZiAoJChcIkFzeW5jUXVldWVcIiwgYCR7ZX06ICR7dH1gKSwgenModCkpIHJldHVybiBuZXcgSyhxLlVOQVZBSUxBQkxFLCBgJHtlfTogJHt0fWApO1xuICAgIHRocm93IHQ7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIERvY3VtZW50U2V0IGlzIGFuIGltbXV0YWJsZSAoY29weS1vbi13cml0ZSkgY29sbGVjdGlvbiB0aGF0IGhvbGRzIGRvY3VtZW50c1xuICogaW4gb3JkZXIgc3BlY2lmaWVkIGJ5IHRoZSBwcm92aWRlZCBjb21wYXJhdG9yLiBXZSBhbHdheXMgYWRkIGEgZG9jdW1lbnQga2V5XG4gKiBjb21wYXJhdG9yIG9uIHRvcCBvZiB3aGF0IGlzIHByb3ZpZGVkIHRvIGd1YXJhbnRlZSBkb2N1bWVudCBlcXVhbGl0eSBiYXNlZCBvblxuICogdGhlIGtleS5cbiAqLyBjbGFzcyBrbyB7XG4gICAgLyoqIFRoZSBkZWZhdWx0IG9yZGVyaW5nIGlzIGJ5IGtleSBpZiB0aGUgY29tcGFyYXRvciBpcyBvbWl0dGVkICovXG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICAvLyBXZSBhcmUgYWRkaW5nIGRvY3VtZW50IGtleSBjb21wYXJhdG9yIHRvIHRoZSBlbmQgYXMgaXQncyB0aGUgb25seVxuICAgICAgICAvLyBndWFyYW50ZWVkIHVuaXF1ZSBwcm9wZXJ0eSBvZiBhIGRvY3VtZW50LlxuICAgICAgICB0aGlzLmNvbXBhcmF0b3IgPSB0ID8gKGUsIG4pID0+IHQoZSwgbikgfHwgUHQuY29tcGFyYXRvcihlLmtleSwgbi5rZXkpIDogKHQsIGUpID0+IFB0LmNvbXBhcmF0b3IodC5rZXksIGUua2V5KSwgXG4gICAgICAgIHRoaXMua2V5ZWRNYXAgPSBUbigpLCB0aGlzLnNvcnRlZFNldCA9IG5ldyBkbih0aGlzLmNvbXBhcmF0b3IpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGFuIGVtcHR5IGNvcHkgb2YgdGhlIGV4aXN0aW5nIERvY3VtZW50U2V0LCB1c2luZyB0aGUgc2FtZVxuICAgICAqIGNvbXBhcmF0b3IuXG4gICAgICovICAgIHN0YXRpYyBlbXB0eVNldCh0KSB7XG4gICAgICAgIHJldHVybiBuZXcga28odC5jb21wYXJhdG9yKTtcbiAgICB9XG4gICAgaGFzKHQpIHtcbiAgICAgICAgcmV0dXJuIG51bGwgIT0gdGhpcy5rZXllZE1hcC5nZXQodCk7XG4gICAgfVxuICAgIGdldCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmtleWVkTWFwLmdldCh0KTtcbiAgICB9XG4gICAgZmlyc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNvcnRlZFNldC5taW5LZXkoKTtcbiAgICB9XG4gICAgbGFzdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc29ydGVkU2V0Lm1heEtleSgpO1xuICAgIH1cbiAgICBpc0VtcHR5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zb3J0ZWRTZXQuaXNFbXB0eSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBpbmRleCBvZiB0aGUgcHJvdmlkZWQga2V5IGluIHRoZSBkb2N1bWVudCBzZXQsIG9yIC0xIGlmIHRoZVxuICAgICAqIGRvY3VtZW50IGtleSBpcyBub3QgcHJlc2VudCBpbiB0aGUgc2V0O1xuICAgICAqLyAgICBpbmRleE9mKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMua2V5ZWRNYXAuZ2V0KHQpO1xuICAgICAgICByZXR1cm4gZSA/IHRoaXMuc29ydGVkU2V0LmluZGV4T2YoZSkgOiAtMTtcbiAgICB9XG4gICAgZ2V0IHNpemUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNvcnRlZFNldC5zaXplO1xuICAgIH1cbiAgICAvKiogSXRlcmF0ZXMgZG9jdW1lbnRzIGluIG9yZGVyIGRlZmluZWQgYnkgXCJjb21wYXJhdG9yXCIgKi8gICAgZm9yRWFjaCh0KSB7XG4gICAgICAgIHRoaXMuc29ydGVkU2V0Lmlub3JkZXJUcmF2ZXJzYWwoKChlLCBuKSA9PiAodChlKSwgITEpKSk7XG4gICAgfVxuICAgIC8qKiBJbnNlcnRzIG9yIHVwZGF0ZXMgYSBkb2N1bWVudCB3aXRoIHRoZSBzYW1lIGtleSAqLyAgICBhZGQodCkge1xuICAgICAgICAvLyBGaXJzdCByZW1vdmUgdGhlIGVsZW1lbnQgaWYgd2UgaGF2ZSBpdC5cbiAgICAgICAgY29uc3QgZSA9IHRoaXMuZGVsZXRlKHQua2V5KTtcbiAgICAgICAgcmV0dXJuIGUuY29weShlLmtleWVkTWFwLmluc2VydCh0LmtleSwgdCksIGUuc29ydGVkU2V0Lmluc2VydCh0LCBudWxsKSk7XG4gICAgfVxuICAgIC8qKiBEZWxldGVzIGEgZG9jdW1lbnQgd2l0aCBhIGdpdmVuIGtleSAqLyAgICBkZWxldGUodCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5nZXQodCk7XG4gICAgICAgIHJldHVybiBlID8gdGhpcy5jb3B5KHRoaXMua2V5ZWRNYXAucmVtb3ZlKHQpLCB0aGlzLnNvcnRlZFNldC5yZW1vdmUoZSkpIDogdGhpcztcbiAgICB9XG4gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIGlmICghKHQgaW5zdGFuY2VvZiBrbykpIHJldHVybiAhMTtcbiAgICAgICAgaWYgKHRoaXMuc2l6ZSAhPT0gdC5zaXplKSByZXR1cm4gITE7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLnNvcnRlZFNldC5nZXRJdGVyYXRvcigpLCBuID0gdC5zb3J0ZWRTZXQuZ2V0SXRlcmF0b3IoKTtcbiAgICAgICAgZm9yICg7ZS5oYXNOZXh0KCk7ICkge1xuICAgICAgICAgICAgY29uc3QgdCA9IGUuZ2V0TmV4dCgpLmtleSwgcyA9IG4uZ2V0TmV4dCgpLmtleTtcbiAgICAgICAgICAgIGlmICghdC5pc0VxdWFsKHMpKSByZXR1cm4gITE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICEwO1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgY29uc3QgdCA9IFtdO1xuICAgICAgICByZXR1cm4gdGhpcy5mb3JFYWNoKChlID0+IHtcbiAgICAgICAgICAgIHQucHVzaChlLnRvU3RyaW5nKCkpO1xuICAgICAgICB9KSksIDAgPT09IHQubGVuZ3RoID8gXCJEb2N1bWVudFNldCAoKVwiIDogXCJEb2N1bWVudFNldCAoXFxuICBcIiArIHQuam9pbihcIiAgXFxuXCIpICsgXCJcXG4pXCI7XG4gICAgfVxuICAgIGNvcHkodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gbmV3IGtvO1xuICAgICAgICByZXR1cm4gbi5jb21wYXJhdG9yID0gdGhpcy5jb21wYXJhdG9yLCBuLmtleWVkTWFwID0gdCwgbi5zb3J0ZWRTZXQgPSBlLCBuO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogRG9jdW1lbnRDaGFuZ2VTZXQga2VlcHMgdHJhY2sgb2YgYSBzZXQgb2YgY2hhbmdlcyB0byBkb2NzIGluIGEgcXVlcnksIG1lcmdpbmdcbiAqIGR1cGxpY2F0ZSBldmVudHMgZm9yIHRoZSBzYW1lIGRvYy5cbiAqLyBjbGFzcyAkbyB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuSnIgPSBuZXcgZG4oUHQuY29tcGFyYXRvcik7XG4gICAgfVxuICAgIHRyYWNrKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHQuZG9jLmtleSwgbiA9IHRoaXMuSnIuZ2V0KGUpO1xuICAgICAgICBuID8gXG4gICAgICAgIC8vIE1lcmdlIHRoZSBuZXcgY2hhbmdlIHdpdGggdGhlIGV4aXN0aW5nIGNoYW5nZS5cbiAgICAgICAgMCAvKiBBZGRlZCAqLyAhPT0gdC50eXBlICYmIDMgLyogTWV0YWRhdGEgKi8gPT09IG4udHlwZSA/IHRoaXMuSnIgPSB0aGlzLkpyLmluc2VydChlLCB0KSA6IDMgLyogTWV0YWRhdGEgKi8gPT09IHQudHlwZSAmJiAxIC8qIFJlbW92ZWQgKi8gIT09IG4udHlwZSA/IHRoaXMuSnIgPSB0aGlzLkpyLmluc2VydChlLCB7XG4gICAgICAgICAgICB0eXBlOiBuLnR5cGUsXG4gICAgICAgICAgICBkb2M6IHQuZG9jXG4gICAgICAgIH0pIDogMiAvKiBNb2RpZmllZCAqLyA9PT0gdC50eXBlICYmIDIgLyogTW9kaWZpZWQgKi8gPT09IG4udHlwZSA/IHRoaXMuSnIgPSB0aGlzLkpyLmluc2VydChlLCB7XG4gICAgICAgICAgICB0eXBlOiAyIC8qIE1vZGlmaWVkICovICxcbiAgICAgICAgICAgIGRvYzogdC5kb2NcbiAgICAgICAgfSkgOiAyIC8qIE1vZGlmaWVkICovID09PSB0LnR5cGUgJiYgMCAvKiBBZGRlZCAqLyA9PT0gbi50eXBlID8gdGhpcy5KciA9IHRoaXMuSnIuaW5zZXJ0KGUsIHtcbiAgICAgICAgICAgIHR5cGU6IDAgLyogQWRkZWQgKi8gLFxuICAgICAgICAgICAgZG9jOiB0LmRvY1xuICAgICAgICB9KSA6IDEgLyogUmVtb3ZlZCAqLyA9PT0gdC50eXBlICYmIDAgLyogQWRkZWQgKi8gPT09IG4udHlwZSA/IHRoaXMuSnIgPSB0aGlzLkpyLnJlbW92ZShlKSA6IDEgLyogUmVtb3ZlZCAqLyA9PT0gdC50eXBlICYmIDIgLyogTW9kaWZpZWQgKi8gPT09IG4udHlwZSA/IHRoaXMuSnIgPSB0aGlzLkpyLmluc2VydChlLCB7XG4gICAgICAgICAgICB0eXBlOiAxIC8qIFJlbW92ZWQgKi8gLFxuICAgICAgICAgICAgZG9jOiBuLmRvY1xuICAgICAgICB9KSA6IDAgLyogQWRkZWQgKi8gPT09IHQudHlwZSAmJiAxIC8qIFJlbW92ZWQgKi8gPT09IG4udHlwZSA/IHRoaXMuSnIgPSB0aGlzLkpyLmluc2VydChlLCB7XG4gICAgICAgICAgICB0eXBlOiAyIC8qIE1vZGlmaWVkICovICxcbiAgICAgICAgICAgIGRvYzogdC5kb2NcbiAgICAgICAgfSkgOiBcbiAgICAgICAgLy8gVGhpcyBpbmNsdWRlcyB0aGVzZSBjYXNlcywgd2hpY2ggZG9uJ3QgbWFrZSBzZW5zZTpcbiAgICAgICAgLy8gQWRkZWQtPkFkZGVkXG4gICAgICAgIC8vIFJlbW92ZWQtPlJlbW92ZWRcbiAgICAgICAgLy8gTW9kaWZpZWQtPkFkZGVkXG4gICAgICAgIC8vIFJlbW92ZWQtPk1vZGlmaWVkXG4gICAgICAgIC8vIE1ldGFkYXRhLT5BZGRlZFxuICAgICAgICAvLyBSZW1vdmVkLT5NZXRhZGF0YVxuICAgICAgICBNKCkgOiB0aGlzLkpyID0gdGhpcy5Kci5pbnNlcnQoZSwgdCk7XG4gICAgfVxuICAgIFlyKCkge1xuICAgICAgICBjb25zdCB0ID0gW107XG4gICAgICAgIHJldHVybiB0aGlzLkpyLmlub3JkZXJUcmF2ZXJzYWwoKChlLCBuKSA9PiB7XG4gICAgICAgICAgICB0LnB1c2gobik7XG4gICAgICAgIH0pKSwgdDtcbiAgICB9XG59XG5cbmNsYXNzIE9vIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzLCBpLCByLCBvLCBhKSB7XG4gICAgICAgIHRoaXMucXVlcnkgPSB0LCB0aGlzLmRvY3MgPSBlLCB0aGlzLm9sZERvY3MgPSBuLCB0aGlzLmRvY0NoYW5nZXMgPSBzLCB0aGlzLm11dGF0ZWRLZXlzID0gaSwgXG4gICAgICAgIHRoaXMuZnJvbUNhY2hlID0gciwgdGhpcy5zeW5jU3RhdGVDaGFuZ2VkID0gbywgdGhpcy5leGNsdWRlc01ldGFkYXRhQ2hhbmdlcyA9IGE7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIGEgdmlldyBzbmFwc2hvdCBhcyBpZiBhbGwgZG9jdW1lbnRzIGluIHRoZSBzbmFwc2hvdCB3ZXJlIGFkZGVkLiAqLyAgICBzdGF0aWMgZnJvbUluaXRpYWxEb2N1bWVudHModCwgZSwgbiwgcykge1xuICAgICAgICBjb25zdCBpID0gW107XG4gICAgICAgIHJldHVybiBlLmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgaS5wdXNoKHtcbiAgICAgICAgICAgICAgICB0eXBlOiAwIC8qIEFkZGVkICovICxcbiAgICAgICAgICAgICAgICBkb2M6IHRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KSksIG5ldyBPbyh0LCBlLCBrby5lbXB0eVNldChlKSwgaSwgbiwgcywgXG4gICAgICAgIC8qIHN5bmNTdGF0ZUNoYW5nZWQ9ICovICEwLCBcbiAgICAgICAgLyogZXhjbHVkZXNNZXRhZGF0YUNoYW5nZXM9ICovICExKTtcbiAgICB9XG4gICAgZ2V0IGhhc1BlbmRpbmdXcml0ZXMoKSB7XG4gICAgICAgIHJldHVybiAhdGhpcy5tdXRhdGVkS2V5cy5pc0VtcHR5KCk7XG4gICAgfVxuICAgIGlzRXF1YWwodCkge1xuICAgICAgICBpZiAoISh0aGlzLmZyb21DYWNoZSA9PT0gdC5mcm9tQ2FjaGUgJiYgdGhpcy5zeW5jU3RhdGVDaGFuZ2VkID09PSB0LnN5bmNTdGF0ZUNoYW5nZWQgJiYgdGhpcy5tdXRhdGVkS2V5cy5pc0VxdWFsKHQubXV0YXRlZEtleXMpICYmIEllKHRoaXMucXVlcnksIHQucXVlcnkpICYmIHRoaXMuZG9jcy5pc0VxdWFsKHQuZG9jcykgJiYgdGhpcy5vbGREb2NzLmlzRXF1YWwodC5vbGREb2NzKSkpIHJldHVybiAhMTtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuZG9jQ2hhbmdlcywgbiA9IHQuZG9jQ2hhbmdlcztcbiAgICAgICAgaWYgKGUubGVuZ3RoICE9PSBuLmxlbmd0aCkgcmV0dXJuICExO1xuICAgICAgICBmb3IgKGxldCB0ID0gMDsgdCA8IGUubGVuZ3RoOyB0KyspIGlmIChlW3RdLnR5cGUgIT09IG5bdF0udHlwZSB8fCAhZVt0XS5kb2MuaXNFcXVhbChuW3RdLmRvYykpIHJldHVybiAhMTtcbiAgICAgICAgcmV0dXJuICEwO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogSG9sZHMgdGhlIGxpc3RlbmVycyBhbmQgdGhlIGxhc3QgcmVjZWl2ZWQgVmlld1NuYXBzaG90IGZvciBhIHF1ZXJ5IGJlaW5nXG4gKiB0cmFja2VkIGJ5IEV2ZW50TWFuYWdlci5cbiAqLyBjbGFzcyBGbyB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuWHIgPSB2b2lkIDAsIHRoaXMubGlzdGVuZXJzID0gW107XG4gICAgfVxufVxuXG5jbGFzcyBNbyB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMucXVlcmllcyA9IG5ldyBLaSgodCA9PiBBZSh0KSksIEllKSwgdGhpcy5vbmxpbmVTdGF0ZSA9IFwiVW5rbm93blwiIC8qIFVua25vd24gKi8gLCBcbiAgICAgICAgdGhpcy5aciA9IG5ldyBTZXQ7XG4gICAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBMbyh0LCBlKSB7XG4gICAgY29uc3QgbiA9IFUodCksIHMgPSBlLnF1ZXJ5O1xuICAgIGxldCBpID0gITEsIHIgPSBuLnF1ZXJpZXMuZ2V0KHMpO1xuICAgIGlmIChyIHx8IChpID0gITAsIHIgPSBuZXcgRm8pLCBpKSB0cnkge1xuICAgICAgICByLlhyID0gYXdhaXQgbi5vbkxpc3RlbihzKTtcbiAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgIGNvbnN0IG4gPSB4byh0LCBgSW5pdGlhbGl6YXRpb24gb2YgcXVlcnkgJyR7UmUoZS5xdWVyeSl9JyBmYWlsZWRgKTtcbiAgICAgICAgcmV0dXJuIHZvaWQgZS5vbkVycm9yKG4pO1xuICAgIH1cbiAgICBpZiAobi5xdWVyaWVzLnNldChzLCByKSwgci5saXN0ZW5lcnMucHVzaChlKSwgXG4gICAgLy8gUnVuIGdsb2JhbCBzbmFwc2hvdCBsaXN0ZW5lcnMgaWYgYSBjb25zaXN0ZW50IHNuYXBzaG90IGhhcyBiZWVuIGVtaXR0ZWQuXG4gICAgZS5lbyhuLm9ubGluZVN0YXRlKSwgci5Ycikge1xuICAgICAgICBlLm5vKHIuWHIpICYmIEtvKG4pO1xuICAgIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gQm8odCwgZSkge1xuICAgIGNvbnN0IG4gPSBVKHQpLCBzID0gZS5xdWVyeTtcbiAgICBsZXQgaSA9ICExO1xuICAgIGNvbnN0IHIgPSBuLnF1ZXJpZXMuZ2V0KHMpO1xuICAgIGlmIChyKSB7XG4gICAgICAgIGNvbnN0IHQgPSByLmxpc3RlbmVycy5pbmRleE9mKGUpO1xuICAgICAgICB0ID49IDAgJiYgKHIubGlzdGVuZXJzLnNwbGljZSh0LCAxKSwgaSA9IDAgPT09IHIubGlzdGVuZXJzLmxlbmd0aCk7XG4gICAgfVxuICAgIGlmIChpKSByZXR1cm4gbi5xdWVyaWVzLmRlbGV0ZShzKSwgbi5vblVubGlzdGVuKHMpO1xufVxuXG5mdW5jdGlvbiBVbyh0LCBlKSB7XG4gICAgY29uc3QgbiA9IFUodCk7XG4gICAgbGV0IHMgPSAhMTtcbiAgICBmb3IgKGNvbnN0IHQgb2YgZSkge1xuICAgICAgICBjb25zdCBlID0gdC5xdWVyeSwgaSA9IG4ucXVlcmllcy5nZXQoZSk7XG4gICAgICAgIGlmIChpKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2YgaS5saXN0ZW5lcnMpIGUubm8odCkgJiYgKHMgPSAhMCk7XG4gICAgICAgICAgICBpLlhyID0gdDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzICYmIEtvKG4pO1xufVxuXG5mdW5jdGlvbiBxbyh0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9IFUodCksIGkgPSBzLnF1ZXJpZXMuZ2V0KGUpO1xuICAgIGlmIChpKSBmb3IgKGNvbnN0IHQgb2YgaS5saXN0ZW5lcnMpIHQub25FcnJvcihuKTtcbiAgICAvLyBSZW1vdmUgYWxsIGxpc3RlbmVycy4gTk9URTogV2UgZG9uJ3QgbmVlZCB0byBjYWxsIHN5bmNFbmdpbmUudW5saXN0ZW4oKVxuICAgIC8vIGFmdGVyIGFuIGVycm9yLlxuICAgICAgICBzLnF1ZXJpZXMuZGVsZXRlKGUpO1xufVxuXG4vLyBDYWxsIGFsbCBnbG9iYWwgc25hcHNob3QgbGlzdGVuZXJzIHRoYXQgaGF2ZSBiZWVuIHNldC5cbmZ1bmN0aW9uIEtvKHQpIHtcbiAgICB0LlpyLmZvckVhY2goKHQgPT4ge1xuICAgICAgICB0Lm5leHQoKTtcbiAgICB9KSk7XG59XG5cbi8qKlxuICogUXVlcnlMaXN0ZW5lciB0YWtlcyBhIHNlcmllcyBvZiBpbnRlcm5hbCB2aWV3IHNuYXBzaG90cyBhbmQgZGV0ZXJtaW5lc1xuICogd2hlbiB0byByYWlzZSB0aGUgZXZlbnQuXG4gKlxuICogSXQgdXNlcyBhbiBPYnNlcnZlciB0byBkaXNwYXRjaCBldmVudHMuXG4gKi8gY2xhc3Mgam8ge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4pIHtcbiAgICAgICAgdGhpcy5xdWVyeSA9IHQsIHRoaXMuc28gPSBlLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEluaXRpYWwgc25hcHNob3RzIChlLmcuIGZyb20gY2FjaGUpIG1heSBub3QgYmUgcHJvcGFnYXRlZCB0byB0aGUgd3JhcHBlZFxuICAgICAgICAgKiBvYnNlcnZlci4gVGhpcyBmbGFnIGlzIHNldCB0byB0cnVlIG9uY2Ugd2UndmUgYWN0dWFsbHkgcmFpc2VkIGFuIGV2ZW50LlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5pbyA9ICExLCB0aGlzLnJvID0gbnVsbCwgdGhpcy5vbmxpbmVTdGF0ZSA9IFwiVW5rbm93blwiIC8qIFVua25vd24gKi8gLCB0aGlzLm9wdGlvbnMgPSBuIHx8IHt9O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBcHBsaWVzIHRoZSBuZXcgVmlld1NuYXBzaG90IHRvIHRoaXMgbGlzdGVuZXIsIHJhaXNpbmcgYSB1c2VyLWZhY2luZyBldmVudFxuICAgICAqIGlmIGFwcGxpY2FibGUgKGRlcGVuZGluZyBvbiB3aGF0IGNoYW5nZWQsIHdoZXRoZXIgdGhlIHVzZXIgaGFzIG9wdGVkIGludG9cbiAgICAgKiBtZXRhZGF0YS1vbmx5IGNoYW5nZXMsIGV0Yy4pLiBSZXR1cm5zIHRydWUgaWYgYSB1c2VyLWZhY2luZyBldmVudCB3YXNcbiAgICAgKiBpbmRlZWQgcmFpc2VkLlxuICAgICAqLyAgICBubyh0KSB7XG4gICAgICAgIGlmICghdGhpcy5vcHRpb25zLmluY2x1ZGVNZXRhZGF0YUNoYW5nZXMpIHtcbiAgICAgICAgICAgIC8vIFJlbW92ZSB0aGUgbWV0YWRhdGEgb25seSBjaGFuZ2VzLlxuICAgICAgICAgICAgY29uc3QgZSA9IFtdO1xuICAgICAgICAgICAgZm9yIChjb25zdCBuIG9mIHQuZG9jQ2hhbmdlcykgMyAvKiBNZXRhZGF0YSAqLyAhPT0gbi50eXBlICYmIGUucHVzaChuKTtcbiAgICAgICAgICAgIHQgPSBuZXcgT28odC5xdWVyeSwgdC5kb2NzLCB0Lm9sZERvY3MsIGUsIHQubXV0YXRlZEtleXMsIHQuZnJvbUNhY2hlLCB0LnN5bmNTdGF0ZUNoYW5nZWQsIFxuICAgICAgICAgICAgLyogZXhjbHVkZXNNZXRhZGF0YUNoYW5nZXM9ICovICEwKTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgZSA9ICExO1xuICAgICAgICByZXR1cm4gdGhpcy5pbyA/IHRoaXMub28odCkgJiYgKHRoaXMuc28ubmV4dCh0KSwgZSA9ICEwKSA6IHRoaXMuYW8odCwgdGhpcy5vbmxpbmVTdGF0ZSkgJiYgKHRoaXMuY28odCksIFxuICAgICAgICBlID0gITApLCB0aGlzLnJvID0gdCwgZTtcbiAgICB9XG4gICAgb25FcnJvcih0KSB7XG4gICAgICAgIHRoaXMuc28uZXJyb3IodCk7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIHdoZXRoZXIgYSBzbmFwc2hvdCB3YXMgcmFpc2VkLiAqLyAgICBlbyh0KSB7XG4gICAgICAgIHRoaXMub25saW5lU3RhdGUgPSB0O1xuICAgICAgICBsZXQgZSA9ICExO1xuICAgICAgICByZXR1cm4gdGhpcy5ybyAmJiAhdGhpcy5pbyAmJiB0aGlzLmFvKHRoaXMucm8sIHQpICYmICh0aGlzLmNvKHRoaXMucm8pLCBlID0gITApLCBcbiAgICAgICAgZTtcbiAgICB9XG4gICAgYW8odCwgZSkge1xuICAgICAgICAvLyBBbHdheXMgcmFpc2UgdGhlIGZpcnN0IGV2ZW50IHdoZW4gd2UncmUgc3luY2VkXG4gICAgICAgIGlmICghdC5mcm9tQ2FjaGUpIHJldHVybiAhMDtcbiAgICAgICAgLy8gTk9URTogV2UgY29uc2lkZXIgT25saW5lU3RhdGUuVW5rbm93biBhcyBvbmxpbmUgKGl0IHNob3VsZCBiZWNvbWUgT2ZmbGluZVxuICAgICAgICAvLyBvciBPbmxpbmUgaWYgd2Ugd2FpdCBsb25nIGVub3VnaCkuXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IFwiT2ZmbGluZVwiIC8qIE9mZmxpbmUgKi8gIT09IGU7XG4gICAgICAgIC8vIERvbid0IHJhaXNlIHRoZSBldmVudCBpZiB3ZSdyZSBvbmxpbmUsIGFyZW4ndCBzeW5jZWQgeWV0IChjaGVja2VkXG4gICAgICAgIC8vIGFib3ZlKSBhbmQgYXJlIHdhaXRpbmcgZm9yIGEgc3luYy5cbiAgICAgICAgICAgICAgICByZXR1cm4gKCF0aGlzLm9wdGlvbnMudW8gfHwgIW4pICYmICghdC5kb2NzLmlzRW1wdHkoKSB8fCBcIk9mZmxpbmVcIiAvKiBPZmZsaW5lICovID09PSBlKTtcbiAgICAgICAgLy8gUmFpc2UgZGF0YSBmcm9tIGNhY2hlIGlmIHdlIGhhdmUgYW55IGRvY3VtZW50cyBvciB3ZSBhcmUgb2ZmbGluZVxuICAgICAgICB9XG4gICAgb28odCkge1xuICAgICAgICAvLyBXZSBkb24ndCBuZWVkIHRvIGhhbmRsZSBpbmNsdWRlRG9jdW1lbnRNZXRhZGF0YUNoYW5nZXMgaGVyZSBiZWNhdXNlXG4gICAgICAgIC8vIHRoZSBNZXRhZGF0YSBvbmx5IGNoYW5nZXMgaGF2ZSBhbHJlYWR5IGJlZW4gc3RyaXBwZWQgb3V0IGlmIG5lZWRlZC5cbiAgICAgICAgLy8gQXQgdGhpcyBwb2ludCB0aGUgb25seSBjaGFuZ2VzIHdlIHdpbGwgc2VlIGFyZSB0aGUgb25lcyB3ZSBzaG91bGRcbiAgICAgICAgLy8gcHJvcGFnYXRlLlxuICAgICAgICBpZiAodC5kb2NDaGFuZ2VzLmxlbmd0aCA+IDApIHJldHVybiAhMDtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMucm8gJiYgdGhpcy5yby5oYXNQZW5kaW5nV3JpdGVzICE9PSB0Lmhhc1BlbmRpbmdXcml0ZXM7XG4gICAgICAgIHJldHVybiAhKCF0LnN5bmNTdGF0ZUNoYW5nZWQgJiYgIWUpICYmICEwID09PSB0aGlzLm9wdGlvbnMuaW5jbHVkZU1ldGFkYXRhQ2hhbmdlcztcbiAgICAgICAgLy8gR2VuZXJhbGx5IHdlIHNob3VsZCBoYXZlIGhpdCBvbmUgb2YgdGhlIGNhc2VzIGFib3ZlLCBidXQgaXQncyBwb3NzaWJsZVxuICAgICAgICAvLyB0byBnZXQgaGVyZSBpZiB0aGVyZSB3ZXJlIG9ubHkgbWV0YWRhdGEgZG9jQ2hhbmdlcyBhbmQgdGhleSBnb3RcbiAgICAgICAgLy8gc3RyaXBwZWQgb3V0LlxuICAgICAgICB9XG4gICAgY28odCkge1xuICAgICAgICB0ID0gT28uZnJvbUluaXRpYWxEb2N1bWVudHModC5xdWVyeSwgdC5kb2NzLCB0Lm11dGF0ZWRLZXlzLCB0LmZyb21DYWNoZSksIHRoaXMuaW8gPSAhMCwgXG4gICAgICAgIHRoaXMuc28ubmV4dCh0KTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEEgY29tcGxldGUgZWxlbWVudCBpbiB0aGUgYnVuZGxlIHN0cmVhbSwgdG9nZXRoZXIgd2l0aCB0aGUgYnl0ZSBsZW5ndGggaXRcbiAqIG9jY3VwaWVzIGluIHRoZSBzdHJlYW0uXG4gKi8gY2xhc3MgUW8ge1xuICAgIGNvbnN0cnVjdG9yKHQsIFxuICAgIC8vIEhvdyBtYW55IGJ5dGVzIHRoaXMgZWxlbWVudCB0YWtlcyB0byBzdG9yZSBpbiB0aGUgYnVuZGxlLlxuICAgIGUpIHtcbiAgICAgICAgdGhpcy5wYXlsb2FkID0gdCwgdGhpcy5ieXRlTGVuZ3RoID0gZTtcbiAgICB9XG4gICAgaG8oKSB7XG4gICAgICAgIHJldHVybiBcIm1ldGFkYXRhXCIgaW4gdGhpcy5wYXlsb2FkO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogSGVscGVyIHRvIGNvbnZlcnQgb2JqZWN0cyBmcm9tIGJ1bmRsZXMgdG8gbW9kZWwgb2JqZWN0cyBpbiB0aGUgU0RLLlxuICovIGNsYXNzIFdvIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMuTiA9IHQ7XG4gICAgfVxuICAgIHpuKHQpIHtcbiAgICAgICAgcmV0dXJuIEduKHRoaXMuTiwgdCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENvbnZlcnRzIGEgQnVuZGxlRG9jdW1lbnQgdG8gYSBNdXRhYmxlRG9jdW1lbnQuXG4gICAgICovICAgIEhuKHQpIHtcbiAgICAgICAgcmV0dXJuIHQubWV0YWRhdGEuZXhpc3RzID8gWm4odGhpcy5OLCB0LmRvY3VtZW50LCAhMSkgOiBxdC5uZXdOb0RvY3VtZW50KHRoaXMuem4odC5tZXRhZGF0YS5uYW1lKSwgdGhpcy5Kbih0Lm1ldGFkYXRhLnJlYWRUaW1lKSk7XG4gICAgfVxuICAgIEpuKHQpIHtcbiAgICAgICAgcmV0dXJuIEtuKHQpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBBIGNsYXNzIHRvIHByb2Nlc3MgdGhlIGVsZW1lbnRzIGZyb20gYSBidW5kbGUsIGxvYWQgdGhlbSBpbnRvIGxvY2FsXG4gKiBzdG9yYWdlIGFuZCBwcm92aWRlIHByb2dyZXNzIHVwZGF0ZSB3aGlsZSBsb2FkaW5nLlxuICovIGNsYXNzIEdvIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHRoaXMubG8gPSB0LCB0aGlzLmxvY2FsU3RvcmUgPSBlLCB0aGlzLk4gPSBuLCBcbiAgICAgICAgLyoqIEJhdGNoZWQgcXVlcmllcyB0byBiZSBzYXZlZCBpbnRvIHN0b3JhZ2UgKi9cbiAgICAgICAgdGhpcy5xdWVyaWVzID0gW10sIFxuICAgICAgICAvKiogQmF0Y2hlZCBkb2N1bWVudHMgdG8gYmUgc2F2ZWQgaW50byBzdG9yYWdlICovXG4gICAgICAgIHRoaXMuZG9jdW1lbnRzID0gW10sIHRoaXMucHJvZ3Jlc3MgPSB6byh0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkcyBhbiBlbGVtZW50IGZyb20gdGhlIGJ1bmRsZSB0byB0aGUgbG9hZGVyLlxuICAgICAqXG4gICAgICogUmV0dXJucyBhIG5ldyBwcm9ncmVzcyBpZiBhZGRpbmcgdGhlIGVsZW1lbnQgbGVhZHMgdG8gYSBuZXcgcHJvZ3Jlc3MsXG4gICAgICogb3RoZXJ3aXNlIHJldHVybnMgbnVsbC5cbiAgICAgKi8gICAgZm8odCkge1xuICAgICAgICB0aGlzLnByb2dyZXNzLmJ5dGVzTG9hZGVkICs9IHQuYnl0ZUxlbmd0aDtcbiAgICAgICAgbGV0IGUgPSB0aGlzLnByb2dyZXNzLmRvY3VtZW50c0xvYWRlZDtcbiAgICAgICAgcmV0dXJuIHQucGF5bG9hZC5uYW1lZFF1ZXJ5ID8gdGhpcy5xdWVyaWVzLnB1c2godC5wYXlsb2FkLm5hbWVkUXVlcnkpIDogdC5wYXlsb2FkLmRvY3VtZW50TWV0YWRhdGEgPyAodGhpcy5kb2N1bWVudHMucHVzaCh7XG4gICAgICAgICAgICBtZXRhZGF0YTogdC5wYXlsb2FkLmRvY3VtZW50TWV0YWRhdGFcbiAgICAgICAgfSksIHQucGF5bG9hZC5kb2N1bWVudE1ldGFkYXRhLmV4aXN0cyB8fCArK2UpIDogdC5wYXlsb2FkLmRvY3VtZW50ICYmICh0aGlzLmRvY3VtZW50c1t0aGlzLmRvY3VtZW50cy5sZW5ndGggLSAxXS5kb2N1bWVudCA9IHQucGF5bG9hZC5kb2N1bWVudCwgXG4gICAgICAgICsrZSksIGUgIT09IHRoaXMucHJvZ3Jlc3MuZG9jdW1lbnRzTG9hZGVkID8gKHRoaXMucHJvZ3Jlc3MuZG9jdW1lbnRzTG9hZGVkID0gZSwgXG4gICAgICAgIE9iamVjdC5hc3NpZ24oe30sIHRoaXMucHJvZ3Jlc3MpKSA6IG51bGw7XG4gICAgfVxuICAgIHdvKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IG5ldyBNYXAsIG4gPSBuZXcgV28odGhpcy5OKTtcbiAgICAgICAgZm9yIChjb25zdCBzIG9mIHQpIGlmIChzLm1ldGFkYXRhLnF1ZXJpZXMpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBuLnpuKHMubWV0YWRhdGEubmFtZSk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2Ygcy5tZXRhZGF0YS5xdWVyaWVzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IChlLmdldChuKSB8fCBQbigpKS5hZGQodCk7XG4gICAgICAgICAgICAgICAgZS5zZXQobiwgcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSB0aGUgcHJvZ3Jlc3MgdG8gJ1N1Y2Nlc3MnIGFuZCByZXR1cm4gdGhlIHVwZGF0ZWQgcHJvZ3Jlc3MuXG4gICAgICovICAgIGFzeW5jIGNvbXBsZXRlKCkge1xuICAgICAgICBjb25zdCB0ID0gYXdhaXQgVHIodGhpcy5sb2NhbFN0b3JlLCBuZXcgV28odGhpcy5OKSwgdGhpcy5kb2N1bWVudHMsIHRoaXMubG8uaWQpLCBlID0gdGhpcy53byh0aGlzLmRvY3VtZW50cyk7XG4gICAgICAgIGZvciAoY29uc3QgdCBvZiB0aGlzLnF1ZXJpZXMpIGF3YWl0IElyKHRoaXMubG9jYWxTdG9yZSwgdCwgZS5nZXQodC5uYW1lKSk7XG4gICAgICAgIHJldHVybiB0aGlzLnByb2dyZXNzLnRhc2tTdGF0ZSA9IFwiU3VjY2Vzc1wiLCBuZXcgc3IoT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5wcm9ncmVzcyksIHQpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgYExvYWRCdW5kbGVUYXNrUHJvZ3Jlc3NgIHJlcHJlc2VudGluZyB0aGUgaW5pdGlhbCBwcm9ncmVzcyBvZlxuICogbG9hZGluZyBhIGJ1bmRsZS5cbiAqLyBmdW5jdGlvbiB6byh0KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgdGFza1N0YXRlOiBcIlJ1bm5pbmdcIixcbiAgICAgICAgZG9jdW1lbnRzTG9hZGVkOiAwLFxuICAgICAgICBieXRlc0xvYWRlZDogMCxcbiAgICAgICAgdG90YWxEb2N1bWVudHM6IHQudG90YWxEb2N1bWVudHMsXG4gICAgICAgIHRvdGFsQnl0ZXM6IHQudG90YWxCeXRlc1xuICAgIH07XG59XG5cbi8qKlxuICogUmV0dXJucyBhIGBMb2FkQnVuZGxlVGFza1Byb2dyZXNzYCByZXByZXNlbnRpbmcgdGhlIHByb2dyZXNzIHRoYXQgdGhlIGxvYWRpbmdcbiAqIGhhcyBzdWNjZWVkZWQuXG4gKi9cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5jbGFzcyBIbyB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLmtleSA9IHQ7XG4gICAgfVxufVxuXG5jbGFzcyBKbyB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLmtleSA9IHQ7XG4gICAgfVxufVxuXG4vKipcbiAqIFZpZXcgaXMgcmVzcG9uc2libGUgZm9yIGNvbXB1dGluZyB0aGUgZmluYWwgbWVyZ2VkIHRydXRoIG9mIHdoYXQgZG9jcyBhcmUgaW5cbiAqIGEgcXVlcnkuIEl0IGdldHMgbm90aWZpZWQgb2YgbG9jYWwgYW5kIHJlbW90ZSBjaGFuZ2VzIHRvIGRvY3MsIGFuZCBhcHBsaWVzXG4gKiB0aGUgcXVlcnkgZmlsdGVycyBhbmQgbGltaXRzIHRvIGRldGVybWluZSB0aGUgbW9zdCBjb3JyZWN0IHBvc3NpYmxlIHJlc3VsdHMuXG4gKi8gY2xhc3MgWW8ge1xuICAgIGNvbnN0cnVjdG9yKHQsIFxuICAgIC8qKiBEb2N1bWVudHMgaW5jbHVkZWQgaW4gdGhlIHJlbW90ZSB0YXJnZXQgKi9cbiAgICBlKSB7XG4gICAgICAgIHRoaXMucXVlcnkgPSB0LCB0aGlzLl9vID0gZSwgdGhpcy5tbyA9IG51bGwsIFxuICAgICAgICAvKipcbiAgICAgICAgICogQSBmbGFnIHdoZXRoZXIgdGhlIHZpZXcgaXMgY3VycmVudCB3aXRoIHRoZSBiYWNrZW5kLiBBIHZpZXcgaXMgY29uc2lkZXJlZFxuICAgICAgICAgKiBjdXJyZW50IGFmdGVyIGl0IGhhcyBzZWVuIHRoZSBjdXJyZW50IGZsYWcgZnJvbSB0aGUgYmFja2VuZCBhbmQgZGlkIG5vdFxuICAgICAgICAgKiBsb3NlIGNvbnNpc3RlbmN5IHdpdGhpbiB0aGUgd2F0Y2ggc3RyZWFtIChlLmcuIGJlY2F1c2Ugb2YgYW4gZXhpc3RlbmNlXG4gICAgICAgICAqIGZpbHRlciBtaXNtYXRjaCkuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmN1cnJlbnQgPSAhMSwgXG4gICAgICAgIC8qKiBEb2N1bWVudHMgaW4gdGhlIHZpZXcgYnV0IG5vdCBpbiB0aGUgcmVtb3RlIHRhcmdldCAqL1xuICAgICAgICB0aGlzLnlvID0gUG4oKSwgXG4gICAgICAgIC8qKiBEb2N1bWVudCBLZXlzIHRoYXQgaGF2ZSBsb2NhbCBjaGFuZ2VzICovXG4gICAgICAgIHRoaXMubXV0YXRlZEtleXMgPSBQbigpLCB0aGlzLnBvID0gYmUodCksIHRoaXMuRW8gPSBuZXcga28odGhpcy5wbyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSBzZXQgb2YgcmVtb3RlIGRvY3VtZW50cyB0aGF0IHRoZSBzZXJ2ZXIgaGFzIHRvbGQgdXMgYmVsb25ncyB0byB0aGUgdGFyZ2V0IGFzc29jaWF0ZWQgd2l0aFxuICAgICAqIHRoaXMgdmlldy5cbiAgICAgKi8gICAgZ2V0IFRvKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbztcbiAgICB9XG4gICAgLyoqXG4gICAgICogSXRlcmF0ZXMgb3ZlciBhIHNldCBvZiBkb2MgY2hhbmdlcywgYXBwbGllcyB0aGUgcXVlcnkgbGltaXQsIGFuZCBjb21wdXRlc1xuICAgICAqIHdoYXQgdGhlIG5ldyByZXN1bHRzIHNob3VsZCBiZSwgd2hhdCB0aGUgY2hhbmdlcyB3ZXJlLCBhbmQgd2hldGhlciB3ZSBtYXlcbiAgICAgKiBuZWVkIHRvIGdvIGJhY2sgdG8gdGhlIGxvY2FsIGNhY2hlIGZvciBtb3JlIHJlc3VsdHMuIERvZXMgbm90IG1ha2UgYW55XG4gICAgICogY2hhbmdlcyB0byB0aGUgdmlldy5cbiAgICAgKiBAcGFyYW0gZG9jQ2hhbmdlcyAtIFRoZSBkb2MgY2hhbmdlcyB0byBhcHBseSB0byB0aGlzIHZpZXcuXG4gICAgICogQHBhcmFtIHByZXZpb3VzQ2hhbmdlcyAtIElmIHRoaXMgaXMgYmVpbmcgY2FsbGVkIHdpdGggYSByZWZpbGwsIHRoZW4gc3RhcnRcbiAgICAgKiAgICAgICAgd2l0aCB0aGlzIHNldCBvZiBkb2NzIGFuZCBjaGFuZ2VzIGluc3RlYWQgb2YgdGhlIGN1cnJlbnQgdmlldy5cbiAgICAgKiBAcmV0dXJucyBhIG5ldyBzZXQgb2YgZG9jcywgY2hhbmdlcywgYW5kIHJlZmlsbCBmbGFnLlxuICAgICAqLyAgICBJbyh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBlID8gZS5BbyA6IG5ldyAkbywgcyA9IGUgPyBlLkVvIDogdGhpcy5FbztcbiAgICAgICAgbGV0IGkgPSBlID8gZS5tdXRhdGVkS2V5cyA6IHRoaXMubXV0YXRlZEtleXMsIHIgPSBzLCBvID0gITE7XG4gICAgICAgIC8vIFRyYWNrIHRoZSBsYXN0IGRvYyBpbiBhIChmdWxsKSBsaW1pdC4gVGhpcyBpcyBuZWNlc3NhcnksIGJlY2F1c2Ugc29tZVxuICAgICAgICAvLyB1cGRhdGUgKGEgZGVsZXRlLCBvciBhbiB1cGRhdGUgbW92aW5nIGEgZG9jIHBhc3QgdGhlIG9sZCBsaW1pdCkgbWlnaHRcbiAgICAgICAgLy8gbWVhbiB0aGVyZSBpcyBzb21lIG90aGVyIGRvY3VtZW50IGluIHRoZSBsb2NhbCBjYWNoZSB0aGF0IGVpdGhlciBzaG91bGRcbiAgICAgICAgLy8gY29tZSAoMSkgYmV0d2VlbiB0aGUgb2xkIGxhc3QgbGltaXQgZG9jIGFuZCB0aGUgbmV3IGxhc3QgZG9jdW1lbnQsIGluIHRoZVxuICAgICAgICAvLyBjYXNlIG9mIHVwZGF0ZXMsIG9yICgyKSBhZnRlciB0aGUgbmV3IGxhc3QgZG9jdW1lbnQsIGluIHRoZSBjYXNlIG9mXG4gICAgICAgIC8vIGRlbGV0ZXMuIFNvIHdlIGtlZXAgdGhpcyBkb2MgYXQgdGhlIG9sZCBsaW1pdCB0byBjb21wYXJlIHRoZSB1cGRhdGVzIHRvLlxuICAgICAgICAvLyBOb3RlIHRoYXQgdGhpcyBzaG91bGQgbmV2ZXIgZ2V0IHVzZWQgaW4gYSByZWZpbGwgKHdoZW4gcHJldmlvdXNDaGFuZ2VzIGlzXG4gICAgICAgIC8vIHNldCksIGJlY2F1c2UgdGhlcmUgd2lsbCBvbmx5IGJlIGFkZHMgLS0gbm8gZGVsZXRlcyBvciB1cGRhdGVzLlxuICAgICAgICBjb25zdCBhID0gd2UodGhpcy5xdWVyeSkgJiYgcy5zaXplID09PSB0aGlzLnF1ZXJ5LmxpbWl0ID8gcy5sYXN0KCkgOiBudWxsLCBjID0gX2UodGhpcy5xdWVyeSkgJiYgcy5zaXplID09PSB0aGlzLnF1ZXJ5LmxpbWl0ID8gcy5maXJzdCgpIDogbnVsbDtcbiAgICAgICAgLy8gRHJvcCBkb2N1bWVudHMgb3V0IHRvIG1lZXQgbGltaXQvbGltaXRUb0xhc3QgcmVxdWlyZW1lbnQuXG4gICAgICAgIGlmICh0Lmlub3JkZXJUcmF2ZXJzYWwoKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB1ID0gcy5nZXQodCksIGggPSBQZSh0aGlzLnF1ZXJ5LCBlKSA/IGUgOiBudWxsLCBsID0gISF1ICYmIHRoaXMubXV0YXRlZEtleXMuaGFzKHUua2V5KSwgZiA9ICEhaCAmJiAoaC5oYXNMb2NhbE11dGF0aW9ucyB8fCBcbiAgICAgICAgICAgIC8vIFdlIG9ubHkgY29uc2lkZXIgY29tbWl0dGVkIG11dGF0aW9ucyBmb3IgZG9jdW1lbnRzIHRoYXQgd2VyZVxuICAgICAgICAgICAgLy8gbXV0YXRlZCBkdXJpbmcgdGhlIGxpZmV0aW1lIG9mIHRoZSB2aWV3LlxuICAgICAgICAgICAgdGhpcy5tdXRhdGVkS2V5cy5oYXMoaC5rZXkpICYmIGguaGFzQ29tbWl0dGVkTXV0YXRpb25zKTtcbiAgICAgICAgICAgIGxldCBkID0gITE7XG4gICAgICAgICAgICAvLyBDYWxjdWxhdGUgY2hhbmdlXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodSAmJiBoKSB7XG4gICAgICAgICAgICAgICAgdS5kYXRhLmlzRXF1YWwoaC5kYXRhKSA/IGwgIT09IGYgJiYgKG4udHJhY2soe1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAzIC8qIE1ldGFkYXRhICovICxcbiAgICAgICAgICAgICAgICAgICAgZG9jOiBoXG4gICAgICAgICAgICAgICAgfSksIGQgPSAhMCkgOiB0aGlzLlJvKHUsIGgpIHx8IChuLnRyYWNrKHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogMiAvKiBNb2RpZmllZCAqLyAsXG4gICAgICAgICAgICAgICAgICAgIGRvYzogaFxuICAgICAgICAgICAgICAgIH0pLCBkID0gITAsIChhICYmIHRoaXMucG8oaCwgYSkgPiAwIHx8IGMgJiYgdGhpcy5wbyhoLCBjKSA8IDApICYmIChcbiAgICAgICAgICAgICAgICAvLyBUaGlzIGRvYyBtb3ZlZCBmcm9tIGluc2lkZSB0aGUgbGltaXQgdG8gb3V0c2lkZSB0aGUgbGltaXQuXG4gICAgICAgICAgICAgICAgLy8gVGhhdCBtZWFucyB0aGVyZSBtYXkgYmUgc29tZSBvdGhlciBkb2MgaW4gdGhlIGxvY2FsIGNhY2hlXG4gICAgICAgICAgICAgICAgLy8gdGhhdCBzaG91bGQgYmUgaW5jbHVkZWQgaW5zdGVhZC5cbiAgICAgICAgICAgICAgICBvID0gITApKTtcbiAgICAgICAgICAgIH0gZWxzZSAhdSAmJiBoID8gKG4udHJhY2soe1xuICAgICAgICAgICAgICAgIHR5cGU6IDAgLyogQWRkZWQgKi8gLFxuICAgICAgICAgICAgICAgIGRvYzogaFxuICAgICAgICAgICAgfSksIGQgPSAhMCkgOiB1ICYmICFoICYmIChuLnRyYWNrKHtcbiAgICAgICAgICAgICAgICB0eXBlOiAxIC8qIFJlbW92ZWQgKi8gLFxuICAgICAgICAgICAgICAgIGRvYzogdVxuICAgICAgICAgICAgfSksIGQgPSAhMCwgKGEgfHwgYykgJiYgKFxuICAgICAgICAgICAgLy8gQSBkb2Mgd2FzIHJlbW92ZWQgZnJvbSBhIGZ1bGwgbGltaXQgcXVlcnkuIFdlJ2xsIG5lZWQgdG9cbiAgICAgICAgICAgIC8vIHJlcXVlcnkgZnJvbSB0aGUgbG9jYWwgY2FjaGUgdG8gc2VlIGlmIHdlIGtub3cgYWJvdXQgc29tZSBvdGhlclxuICAgICAgICAgICAgLy8gZG9jIHRoYXQgc2hvdWxkIGJlIGluIHRoZSByZXN1bHRzLlxuICAgICAgICAgICAgbyA9ICEwKSk7XG4gICAgICAgICAgICBkICYmIChoID8gKHIgPSByLmFkZChoKSwgaSA9IGYgPyBpLmFkZCh0KSA6IGkuZGVsZXRlKHQpKSA6IChyID0gci5kZWxldGUodCksIGkgPSBpLmRlbGV0ZSh0KSkpO1xuICAgICAgICB9KSksIHdlKHRoaXMucXVlcnkpIHx8IF9lKHRoaXMucXVlcnkpKSBmb3IgKDtyLnNpemUgPiB0aGlzLnF1ZXJ5LmxpbWl0OyApIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSB3ZSh0aGlzLnF1ZXJ5KSA/IHIubGFzdCgpIDogci5maXJzdCgpO1xuICAgICAgICAgICAgciA9IHIuZGVsZXRlKHQua2V5KSwgaSA9IGkuZGVsZXRlKHQua2V5KSwgbi50cmFjayh7XG4gICAgICAgICAgICAgICAgdHlwZTogMSAvKiBSZW1vdmVkICovICxcbiAgICAgICAgICAgICAgICBkb2M6IHRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBFbzogcixcbiAgICAgICAgICAgIEFvOiBuLFxuICAgICAgICAgICAgTG46IG8sXG4gICAgICAgICAgICBtdXRhdGVkS2V5czogaVxuICAgICAgICB9O1xuICAgIH1cbiAgICBSbyh0LCBlKSB7XG4gICAgICAgIC8vIFdlIHN1cHByZXNzIHRoZSBpbml0aWFsIGNoYW5nZSBldmVudCBmb3IgZG9jdW1lbnRzIHRoYXQgd2VyZSBtb2RpZmllZCBhc1xuICAgICAgICAvLyBwYXJ0IG9mIGEgd3JpdGUgYWNrbm93bGVkZ21lbnQgKGUuZy4gd2hlbiB0aGUgdmFsdWUgb2YgYSBzZXJ2ZXIgdHJhbnNmb3JtXG4gICAgICAgIC8vIGlzIGFwcGxpZWQpIGFzIFdhdGNoIHdpbGwgc2VuZCB1cyB0aGUgc2FtZSBkb2N1bWVudCBhZ2Fpbi5cbiAgICAgICAgLy8gQnkgc3VwcHJlc3NpbmcgdGhlIGV2ZW50LCB3ZSBvbmx5IHJhaXNlIHR3byB1c2VyIHZpc2libGUgZXZlbnRzIChvbmUgd2l0aFxuICAgICAgICAvLyBgaGFzUGVuZGluZ1dyaXRlc2AgYW5kIHRoZSBmaW5hbCBzdGF0ZSBvZiB0aGUgZG9jdW1lbnQpIGluc3RlYWQgb2YgdGhyZWVcbiAgICAgICAgLy8gKG9uZSB3aXRoIGBoYXNQZW5kaW5nV3JpdGVzYCwgdGhlIG1vZGlmaWVkIGRvY3VtZW50IHdpdGhcbiAgICAgICAgLy8gYGhhc1BlbmRpbmdXcml0ZXNgIGFuZCB0aGUgZmluYWwgc3RhdGUgb2YgdGhlIGRvY3VtZW50KS5cbiAgICAgICAgcmV0dXJuIHQuaGFzTG9jYWxNdXRhdGlvbnMgJiYgZS5oYXNDb21taXR0ZWRNdXRhdGlvbnMgJiYgIWUuaGFzTG9jYWxNdXRhdGlvbnM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVwZGF0ZXMgdGhlIHZpZXcgd2l0aCB0aGUgZ2l2ZW4gVmlld0RvY3VtZW50Q2hhbmdlcyBhbmQgb3B0aW9uYWxseSB1cGRhdGVzXG4gICAgICogbGltYm8gZG9jcyBhbmQgc3luYyBzdGF0ZSBmcm9tIHRoZSBwcm92aWRlZCB0YXJnZXQgY2hhbmdlLlxuICAgICAqIEBwYXJhbSBkb2NDaGFuZ2VzIC0gVGhlIHNldCBvZiBjaGFuZ2VzIHRvIG1ha2UgdG8gdGhlIHZpZXcncyBkb2NzLlxuICAgICAqIEBwYXJhbSB1cGRhdGVMaW1ib0RvY3VtZW50cyAtIFdoZXRoZXIgdG8gdXBkYXRlIGxpbWJvIGRvY3VtZW50cyBiYXNlZCBvblxuICAgICAqICAgICAgICB0aGlzIGNoYW5nZS5cbiAgICAgKiBAcGFyYW0gdGFyZ2V0Q2hhbmdlIC0gQSB0YXJnZXQgY2hhbmdlIHRvIGFwcGx5IGZvciBjb21wdXRpbmcgbGltYm8gZG9jcyBhbmRcbiAgICAgKiAgICAgICAgc3luYyBzdGF0ZS5cbiAgICAgKiBAcmV0dXJucyBBIG5ldyBWaWV3Q2hhbmdlIHdpdGggdGhlIGdpdmVuIGRvY3MsIGNoYW5nZXMsIGFuZCBzeW5jIHN0YXRlLlxuICAgICAqL1xuICAgIC8vIFBPUlRJTkcgTk9URTogVGhlIGlPUy9BbmRyb2lkIGNsaWVudHMgYWx3YXlzIGNvbXB1dGUgbGltYm8gZG9jdW1lbnQgY2hhbmdlcy5cbiAgICBhcHBseUNoYW5nZXModCwgZSwgbikge1xuICAgICAgICBjb25zdCBzID0gdGhpcy5FbztcbiAgICAgICAgdGhpcy5FbyA9IHQuRW8sIHRoaXMubXV0YXRlZEtleXMgPSB0Lm11dGF0ZWRLZXlzO1xuICAgICAgICAvLyBTb3J0IGNoYW5nZXMgYmFzZWQgb24gdHlwZSBhbmQgcXVlcnkgY29tcGFyYXRvclxuICAgICAgICBjb25zdCBpID0gdC5Bby5ZcigpO1xuICAgICAgICBpLnNvcnQoKCh0LCBlKSA9PiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gdCA9PiB7XG4gICAgICAgICAgICAgICAgc3dpdGNoICh0KSB7XG4gICAgICAgICAgICAgICAgICBjYXNlIDAgLyogQWRkZWQgKi8gOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTtcblxuICAgICAgICAgICAgICAgICAgY2FzZSAyIC8qIE1vZGlmaWVkICovIDpcbiAgICAgICAgICAgICAgICAgIGNhc2UgMyAvKiBNZXRhZGF0YSAqLyA6XG4gICAgICAgICAgICAgICAgICAgIC8vIEEgbWV0YWRhdGEgY2hhbmdlIGlzIGNvbnZlcnRlZCB0byBhIG1vZGlmaWVkIGNoYW5nZSBhdCB0aGUgcHVibGljXG4gICAgICAgICAgICAgICAgICAgIC8vIGFwaSBsYXllci4gIFNpbmNlIHdlIHNvcnQgYnkgZG9jdW1lbnQga2V5IGFuZCB0aGVuIGNoYW5nZSB0eXBlLFxuICAgICAgICAgICAgICAgICAgICAvLyBtZXRhZGF0YSBhbmQgbW9kaWZpZWQgY2hhbmdlcyBtdXN0IGJlIHNvcnRlZCBlcXVpdmFsZW50bHkuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAyO1xuXG4gICAgICAgICAgICAgICAgICBjYXNlIDEgLyogUmVtb3ZlZCAqLyA6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAwO1xuXG4gICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gTSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gbih0KSAtIG4oZSk7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gKHQudHlwZSwgZS50eXBlKSB8fCB0aGlzLnBvKHQuZG9jLCBlLmRvYykpKSwgdGhpcy5QbyhuKTtcbiAgICAgICAgY29uc3QgciA9IGUgPyB0aGlzLmJvKCkgOiBbXSwgbyA9IDAgPT09IHRoaXMueW8uc2l6ZSAmJiB0aGlzLmN1cnJlbnQgPyAxIC8qIFN5bmNlZCAqLyA6IDAgLyogTG9jYWwgKi8gLCBhID0gbyAhPT0gdGhpcy5tbztcbiAgICAgICAgaWYgKHRoaXMubW8gPSBvLCAwICE9PSBpLmxlbmd0aCB8fCBhKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHNuYXBzaG90OiBuZXcgT28odGhpcy5xdWVyeSwgdC5FbywgcywgaSwgdC5tdXRhdGVkS2V5cywgMCAvKiBMb2NhbCAqLyA9PT0gbywgYSwgXG4gICAgICAgICAgICAgICAgLyogZXhjbHVkZXNNZXRhZGF0YUNoYW5nZXM9ICovICExKSxcbiAgICAgICAgICAgICAgICB2bzogclxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICAvLyBubyBjaGFuZ2VzXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB2bzogclxuICAgICAgICB9O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBcHBsaWVzIGFuIE9ubGluZVN0YXRlIGNoYW5nZSB0byB0aGUgdmlldywgcG90ZW50aWFsbHkgZ2VuZXJhdGluZyBhXG4gICAgICogVmlld0NoYW5nZSBpZiB0aGUgdmlldydzIHN5bmNTdGF0ZSBjaGFuZ2VzIGFzIGEgcmVzdWx0LlxuICAgICAqLyAgICBlbyh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmN1cnJlbnQgJiYgXCJPZmZsaW5lXCIgLyogT2ZmbGluZSAqLyA9PT0gdCA/IChcbiAgICAgICAgLy8gSWYgd2UncmUgb2ZmbGluZSwgc2V0IGBjdXJyZW50YCB0byBmYWxzZSBhbmQgdGhlbiBjYWxsIGFwcGx5Q2hhbmdlcygpXG4gICAgICAgIC8vIHRvIHJlZnJlc2ggb3VyIHN5bmNTdGF0ZSBhbmQgZ2VuZXJhdGUgYSBWaWV3Q2hhbmdlIGFzIGFwcHJvcHJpYXRlLiBXZVxuICAgICAgICAvLyBhcmUgZ3VhcmFudGVlZCB0byBnZXQgYSBuZXcgVGFyZ2V0Q2hhbmdlIHRoYXQgc2V0cyBgY3VycmVudGAgYmFjayB0b1xuICAgICAgICAvLyB0cnVlIG9uY2UgdGhlIGNsaWVudCBpcyBiYWNrIG9ubGluZS5cbiAgICAgICAgdGhpcy5jdXJyZW50ID0gITEsIHRoaXMuYXBwbHlDaGFuZ2VzKHtcbiAgICAgICAgICAgIEVvOiB0aGlzLkVvLFxuICAgICAgICAgICAgQW86IG5ldyAkbyxcbiAgICAgICAgICAgIG11dGF0ZWRLZXlzOiB0aGlzLm11dGF0ZWRLZXlzLFxuICAgICAgICAgICAgTG46ICExXG4gICAgICAgIH0sIFxuICAgICAgICAvKiB1cGRhdGVMaW1ib0RvY3VtZW50cz0gKi8gITEpKSA6IHtcbiAgICAgICAgICAgIHZvOiBbXVxuICAgICAgICB9O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHdoZXRoZXIgdGhlIGRvYyBmb3IgdGhlIGdpdmVuIGtleSBzaG91bGQgYmUgaW4gbGltYm8uXG4gICAgICovICAgIFZvKHQpIHtcbiAgICAgICAgLy8gSWYgdGhlIHJlbW90ZSBlbmQgc2F5cyBpdCdzIHBhcnQgb2YgdGhpcyBxdWVyeSwgaXQncyBub3QgaW4gbGltYm8uXG4gICAgICAgIHJldHVybiAhdGhpcy5fby5oYXModCkgJiYgKFxuICAgICAgICAvLyBUaGUgbG9jYWwgc3RvcmUgZG9lc24ndCB0aGluayBpdCdzIGEgcmVzdWx0LCBzbyBpdCBzaG91bGRuJ3QgYmUgaW4gbGltYm8uXG4gICAgICAgICEhdGhpcy5Fby5oYXModCkgJiYgIXRoaXMuRW8uZ2V0KHQpLmhhc0xvY2FsTXV0YXRpb25zKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVXBkYXRlcyBzeW5jZWREb2N1bWVudHMsIGN1cnJlbnQsIGFuZCBsaW1ibyBkb2NzIGJhc2VkIG9uIHRoZSBnaXZlbiBjaGFuZ2UuXG4gICAgICogUmV0dXJucyB0aGUgbGlzdCBvZiBjaGFuZ2VzIHRvIHdoaWNoIGRvY3MgYXJlIGluIGxpbWJvLlxuICAgICAqLyAgICBQbyh0KSB7XG4gICAgICAgIHQgJiYgKHQuYWRkZWREb2N1bWVudHMuZm9yRWFjaCgodCA9PiB0aGlzLl9vID0gdGhpcy5fby5hZGQodCkpKSwgdC5tb2RpZmllZERvY3VtZW50cy5mb3JFYWNoKCh0ID0+IHt9KSksIFxuICAgICAgICB0LnJlbW92ZWREb2N1bWVudHMuZm9yRWFjaCgodCA9PiB0aGlzLl9vID0gdGhpcy5fby5kZWxldGUodCkpKSwgdGhpcy5jdXJyZW50ID0gdC5jdXJyZW50KTtcbiAgICB9XG4gICAgYm8oKSB7XG4gICAgICAgIC8vIFdlIGNhbiBvbmx5IGRldGVybWluZSBsaW1ibyBkb2N1bWVudHMgd2hlbiB3ZSdyZSBpbi1zeW5jIHdpdGggdGhlIHNlcnZlci5cbiAgICAgICAgaWYgKCF0aGlzLmN1cnJlbnQpIHJldHVybiBbXTtcbiAgICAgICAgLy8gVE9ETyhrbGltdCk6IERvIHRoaXMgaW5jcmVtZW50YWxseSBzbyB0aGF0IGl0J3Mgbm90IHF1YWRyYXRpYyB3aGVuXG4gICAgICAgIC8vIHVwZGF0aW5nIG1hbnkgZG9jdW1lbnRzLlxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLnlvO1xuICAgICAgICB0aGlzLnlvID0gUG4oKSwgdGhpcy5Fby5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgIHRoaXMuVm8odC5rZXkpICYmICh0aGlzLnlvID0gdGhpcy55by5hZGQodC5rZXkpKTtcbiAgICAgICAgfSkpO1xuICAgICAgICAvLyBEaWZmIHRoZSBuZXcgbGltYm8gZG9jcyB3aXRoIHRoZSBvbGQgbGltYm8gZG9jcy5cbiAgICAgICAgY29uc3QgZSA9IFtdO1xuICAgICAgICByZXR1cm4gdC5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgIHRoaXMueW8uaGFzKHQpIHx8IGUucHVzaChuZXcgSm8odCkpO1xuICAgICAgICB9KSksIHRoaXMueW8uZm9yRWFjaCgobiA9PiB7XG4gICAgICAgICAgICB0LmhhcyhuKSB8fCBlLnB1c2gobmV3IEhvKG4pKTtcbiAgICAgICAgfSkpLCBlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgdGhlIGluLW1lbW9yeSBzdGF0ZSBvZiB0aGUgY3VycmVudCB2aWV3IHdpdGggdGhlIHN0YXRlIHJlYWQgZnJvbVxuICAgICAqIHBlcnNpc3RlbmNlLlxuICAgICAqXG4gICAgICogV2UgdXBkYXRlIHRoZSBxdWVyeSB2aWV3IHdoZW5ldmVyIGEgY2xpZW50J3MgcHJpbWFyeSBzdGF0dXMgY2hhbmdlczpcbiAgICAgKiAtIFdoZW4gYSBjbGllbnQgdHJhbnNpdGlvbnMgZnJvbSBwcmltYXJ5IHRvIHNlY29uZGFyeSwgaXQgY2FuIG1pc3NcbiAgICAgKiAgIExvY2FsU3RvcmFnZSB1cGRhdGVzIGFuZCBpdHMgcXVlcnkgdmlld3MgbWF5IHRlbXBvcmFyaWx5IG5vdCBiZVxuICAgICAqICAgc3luY2hyb25pemVkIHdpdGggdGhlIHN0YXRlIG9uIGRpc2suXG4gICAgICogLSBGb3Igc2Vjb25kYXJ5IHRvIHByaW1hcnkgdHJhbnNpdGlvbnMsIHRoZSBjbGllbnQgbmVlZHMgdG8gdXBkYXRlIHRoZSBsaXN0XG4gICAgICogICBvZiBgc3luY2VkRG9jdW1lbnRzYCBzaW5jZSBzZWNvbmRhcnkgY2xpZW50cyB1cGRhdGUgdGhlaXIgcXVlcnkgdmlld3NcbiAgICAgKiAgIGJhc2VkIHB1cmVseSBvbiBzeW50aGVzaXplZCBSZW1vdGVFdmVudHMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcXVlcnlSZXN1bHQuZG9jdW1lbnRzIC0gVGhlIGRvY3VtZW50cyB0aGF0IG1hdGNoIHRoZSBxdWVyeSBhY2NvcmRpbmdcbiAgICAgKiB0byB0aGUgTG9jYWxTdG9yZS5cbiAgICAgKiBAcGFyYW0gcXVlcnlSZXN1bHQucmVtb3RlS2V5cyAtIFRoZSBrZXlzIG9mIHRoZSBkb2N1bWVudHMgdGhhdCBtYXRjaCB0aGVcbiAgICAgKiBxdWVyeSBhY2NvcmRpbmcgdG8gdGhlIGJhY2tlbmQuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBUaGUgVmlld0NoYW5nZSB0aGF0IHJlc3VsdGVkIGZyb20gdGhpcyBzeW5jaHJvbml6YXRpb24uXG4gICAgICovXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seS5cbiAgICBTbyh0KSB7XG4gICAgICAgIHRoaXMuX28gPSB0LkduLCB0aGlzLnlvID0gUG4oKTtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuSW8odC5kb2N1bWVudHMpO1xuICAgICAgICByZXR1cm4gdGhpcy5hcHBseUNoYW5nZXMoZSwgLyp1cGRhdGVMaW1ib0RvY3VtZW50cz0qLyAhMCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSB2aWV3IHNuYXBzaG90IGFzIGlmIHRoaXMgcXVlcnkgd2FzIGp1c3QgbGlzdGVuZWQgdG8uIENvbnRhaW5zXG4gICAgICogYSBkb2N1bWVudCBhZGQgZm9yIGV2ZXJ5IGV4aXN0aW5nIGRvY3VtZW50IGFuZCB0aGUgYGZyb21DYWNoZWAgYW5kXG4gICAgICogYGhhc1BlbmRpbmdXcml0ZXNgIHN0YXR1cyBvZiB0aGUgYWxyZWFkeSBlc3RhYmxpc2hlZCB2aWV3LlxuICAgICAqL1xuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHkuXG4gICAgRG8oKSB7XG4gICAgICAgIHJldHVybiBPby5mcm9tSW5pdGlhbERvY3VtZW50cyh0aGlzLnF1ZXJ5LCB0aGlzLkVvLCB0aGlzLm11dGF0ZWRLZXlzLCAwIC8qIExvY2FsICovID09PSB0aGlzLm1vKTtcbiAgICB9XG59XG5cbi8qKlxuICogUXVlcnlWaWV3IGNvbnRhaW5zIGFsbCBvZiB0aGUgZGF0YSB0aGF0IFN5bmNFbmdpbmUgbmVlZHMgdG8ga2VlcCB0cmFjayBvZiBmb3JcbiAqIGEgcGFydGljdWxhciBxdWVyeS5cbiAqL1xuY2xhc3MgWG8ge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIFRoZSBxdWVyeSBpdHNlbGYuXG4gICAgICovXG4gICAgdCwgXG4gICAgLyoqXG4gICAgICogVGhlIHRhcmdldCBudW1iZXIgY3JlYXRlZCBieSB0aGUgY2xpZW50IHRoYXQgaXMgdXNlZCBpbiB0aGUgd2F0Y2hcbiAgICAgKiBzdHJlYW0gdG8gaWRlbnRpZnkgdGhpcyBxdWVyeS5cbiAgICAgKi9cbiAgICBlLCBcbiAgICAvKipcbiAgICAgKiBUaGUgdmlldyBpcyByZXNwb25zaWJsZSBmb3IgY29tcHV0aW5nIHRoZSBmaW5hbCBtZXJnZWQgdHJ1dGggb2Ygd2hhdFxuICAgICAqIGRvY3MgYXJlIGluIHRoZSBxdWVyeS4gSXQgZ2V0cyBub3RpZmllZCBvZiBsb2NhbCBhbmQgcmVtb3RlIGNoYW5nZXMsXG4gICAgICogYW5kIGFwcGxpZXMgdGhlIHF1ZXJ5IGZpbHRlcnMgYW5kIGxpbWl0cyB0byBkZXRlcm1pbmUgdGhlIG1vc3QgY29ycmVjdFxuICAgICAqIHBvc3NpYmxlIHJlc3VsdHMuXG4gICAgICovXG4gICAgbikge1xuICAgICAgICB0aGlzLnF1ZXJ5ID0gdCwgdGhpcy50YXJnZXRJZCA9IGUsIHRoaXMudmlldyA9IG47XG4gICAgfVxufVxuXG4vKiogVHJhY2tzIGEgbGltYm8gcmVzb2x1dGlvbi4gKi8gY2xhc3MgWm8ge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5rZXkgPSB0LCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNldCB0byB0cnVlIG9uY2Ugd2UndmUgcmVjZWl2ZWQgYSBkb2N1bWVudC4gVGhpcyBpcyB1c2VkIGluXG4gICAgICAgICAqIGdldFJlbW90ZUtleXNGb3JUYXJnZXQoKSBhbmQgdWx0aW1hdGVseSB1c2VkIGJ5IFdhdGNoQ2hhbmdlQWdncmVnYXRvciB0b1xuICAgICAgICAgKiBkZWNpZGUgd2hldGhlciBpdCBuZWVkcyB0byBtYW51ZmFjdHVyZSBhIGRlbGV0ZSBldmVudCBmb3IgdGhlIHRhcmdldCBvbmNlXG4gICAgICAgICAqIHRoZSB0YXJnZXQgaXMgQ1VSUkVOVC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuQ28gPSAhMTtcbiAgICB9XG59XG5cbi8qKlxuICogQW4gaW1wbGVtZW50YXRpb24gb2YgYFN5bmNFbmdpbmVgIGNvb3JkaW5hdGluZyB3aXRoIG90aGVyIHBhcnRzIG9mIFNESy5cbiAqXG4gKiBUaGUgcGFydHMgb2YgU3luY0VuZ2luZSB0aGF0IGFjdCBhcyBhIGNhbGxiYWNrIHRvIFJlbW90ZVN0b3JlIG5lZWQgdG8gYmVcbiAqIHJlZ2lzdGVyZWQgaW5kaXZpZHVhbGx5LiBUaGlzIGlzIGRvbmUgaW4gYHN5bmNFbmdpbmVXcml0ZSgpYCBhbmRcbiAqIGBzeW5jRW5naW5lTGlzdGVuKClgIChhcyB3ZWxsIGFzIGBhcHBseVByaW1hcnlTdGF0ZSgpYCkgYXMgdGhlc2UgbWV0aG9kc1xuICogc2VydmUgYXMgZW50cnkgcG9pbnRzIHRvIFJlbW90ZVN0b3JlJ3MgZnVuY3Rpb25hbGl0eS5cbiAqXG4gKiBOb3RlOiBzb21lIGZpZWxkIGRlZmluZWQgaW4gdGhpcyBjbGFzcyBtaWdodCBoYXZlIHB1YmxpYyBhY2Nlc3MgbGV2ZWwsIGJ1dFxuICogdGhlIGNsYXNzIGlzIG5vdCBleHBvcnRlZCBzbyB0aGV5IGFyZSBvbmx5IGFjY2Vzc2libGUgZnJvbSB0aGlzIG1vZHVsZS5cbiAqIFRoaXMgaXMgdXNlZnVsIHRvIGltcGxlbWVudCBvcHRpb25hbCBmZWF0dXJlcyAobGlrZSBidW5kbGVzKSBpbiBmcmVlXG4gKiBmdW5jdGlvbnMsIHN1Y2ggdGhhdCB0aGV5IGFyZSB0cmVlLXNoYWtlYWJsZS5cbiAqLyBjbGFzcyB0YSB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgXG4gICAgLy8gUE9SVElORyBOT1RFOiBNYW5hZ2VzIHN0YXRlIHN5bmNocm9uaXphdGlvbiBpbiBtdWx0aS10YWIgZW52aXJvbm1lbnRzLlxuICAgIHMsIGksIHIpIHtcbiAgICAgICAgdGhpcy5sb2NhbFN0b3JlID0gdCwgdGhpcy5yZW1vdGVTdG9yZSA9IGUsIHRoaXMuZXZlbnRNYW5hZ2VyID0gbiwgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZSA9IHMsIFxuICAgICAgICB0aGlzLmN1cnJlbnRVc2VyID0gaSwgdGhpcy5tYXhDb25jdXJyZW50TGltYm9SZXNvbHV0aW9ucyA9IHIsIHRoaXMuTm8gPSB7fSwgdGhpcy54byA9IG5ldyBLaSgodCA9PiBBZSh0KSksIEllKSwgXG4gICAgICAgIHRoaXMua28gPSBuZXcgTWFwLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBrZXlzIG9mIGRvY3VtZW50cyB0aGF0IGFyZSBpbiBsaW1ibyBmb3Igd2hpY2ggd2UgaGF2ZW4ndCB5ZXQgc3RhcnRlZCBhXG4gICAgICAgICAqIGxpbWJvIHJlc29sdXRpb24gcXVlcnkuIFRoZSBzdHJpbmdzIGluIHRoaXMgc2V0IGFyZSB0aGUgcmVzdWx0IG9mIGNhbGxpbmdcbiAgICAgICAgICogYGtleS5wYXRoLmNhbm9uaWNhbFN0cmluZygpYCB3aGVyZSBga2V5YCBpcyBhIGBEb2N1bWVudEtleWAgb2JqZWN0LlxuICAgICAgICAgKlxuICAgICAgICAgKiBUaGUgYFNldGAgdHlwZSB3YXMgY2hvc2VuIGJlY2F1c2UgaXQgcHJvdmlkZXMgZWZmaWNpZW50IGxvb2t1cCBhbmQgcmVtb3ZhbFxuICAgICAgICAgKiBvZiBhcmJpdHJhcnkgZWxlbWVudHMgYW5kIGl0IGFsc28gbWFpbnRhaW5zIGluc2VydGlvbiBvcmRlciwgcHJvdmlkaW5nIHRoZVxuICAgICAgICAgKiBkZXNpcmVkIHF1ZXVlLWxpa2UgRklGTyBzZW1hbnRpY3MuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLiRvID0gbmV3IFNldCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBLZWVwcyB0cmFjayBvZiB0aGUgdGFyZ2V0IElEIGZvciBlYWNoIGRvY3VtZW50IHRoYXQgaXMgaW4gbGltYm8gd2l0aCBhblxuICAgICAgICAgKiBhY3RpdmUgdGFyZ2V0LlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5PbyA9IG5ldyBkbihQdC5jb21wYXJhdG9yKSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBLZWVwcyB0cmFjayBvZiB0aGUgaW5mb3JtYXRpb24gYWJvdXQgYW4gYWN0aXZlIGxpbWJvIHJlc29sdXRpb24gZm9yIGVhY2hcbiAgICAgICAgICogYWN0aXZlIHRhcmdldCBJRCB0aGF0IHdhcyBzdGFydGVkIGZvciB0aGUgcHVycG9zZSBvZiBsaW1ibyByZXNvbHV0aW9uLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5GbyA9IG5ldyBNYXAsIHRoaXMuTW8gPSBuZXcgUnIsIFxuICAgICAgICAvKiogU3RvcmVzIHVzZXIgY29tcGxldGlvbiBoYW5kbGVycywgaW5kZXhlZCBieSBVc2VyIGFuZCBCYXRjaElkLiAqL1xuICAgICAgICB0aGlzLkxvID0ge30sIFxuICAgICAgICAvKiogU3RvcmVzIHVzZXIgY2FsbGJhY2tzIHdhaXRpbmcgZm9yIGFsbCBwZW5kaW5nIHdyaXRlcyB0byBiZSBhY2tub3dsZWRnZWQuICovXG4gICAgICAgIHRoaXMuQm8gPSBuZXcgTWFwLCB0aGlzLlVvID0gQ2kuaWUoKSwgdGhpcy5vbmxpbmVTdGF0ZSA9IFwiVW5rbm93blwiIC8qIFVua25vd24gKi8gLCBcbiAgICAgICAgLy8gVGhlIHByaW1hcnkgc3RhdGUgaXMgc2V0IHRvIGB0cnVlYCBvciBgZmFsc2VgIGltbWVkaWF0ZWx5IGFmdGVyIEZpcmVzdG9yZVxuICAgICAgICAvLyBzdGFydHVwLiBJbiB0aGUgaW50ZXJpbSwgYSBjbGllbnQgc2hvdWxkIG9ubHkgYmUgY29uc2lkZXJlZCBwcmltYXJ5IGlmXG4gICAgICAgIC8vIGBpc1ByaW1hcnlgIGlzIHRydWUuXG4gICAgICAgIHRoaXMucW8gPSB2b2lkIDA7XG4gICAgfVxuICAgIGdldCBpc1ByaW1hcnlDbGllbnQoKSB7XG4gICAgICAgIHJldHVybiAhMCA9PT0gdGhpcy5xbztcbiAgICB9XG59XG5cbi8qKlxuICogSW5pdGlhdGVzIHRoZSBuZXcgbGlzdGVuLCByZXNvbHZlcyBwcm9taXNlIHdoZW4gbGlzdGVuIGVucXVldWVkIHRvIHRoZVxuICogc2VydmVyLiBBbGwgdGhlIHN1YnNlcXVlbnQgdmlldyBzbmFwc2hvdHMgb3IgZXJyb3JzIGFyZSBzZW50IHRvIHRoZVxuICogc3Vic2NyaWJlZCBoYW5kbGVycy4gUmV0dXJucyB0aGUgaW5pdGlhbCBzbmFwc2hvdC5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gZWEodCwgZSkge1xuICAgIGNvbnN0IG4gPSBEYSh0KTtcbiAgICBsZXQgcywgaTtcbiAgICBjb25zdCByID0gbi54by5nZXQoZSk7XG4gICAgaWYgKHIpIFxuICAgIC8vIFBPUlRJTkcgTk9URTogV2l0aCBNdWx0aS1UYWIgV2ViLCBpdCBpcyBwb3NzaWJsZSB0aGF0IGEgcXVlcnkgdmlld1xuICAgIC8vIGFscmVhZHkgZXhpc3RzIHdoZW4gRXZlbnRNYW5hZ2VyIGNhbGxzIHVzIGZvciB0aGUgZmlyc3QgdGltZS4gVGhpc1xuICAgIC8vIGhhcHBlbnMgd2hlbiB0aGUgcHJpbWFyeSB0YWIgaXMgYWxyZWFkeSBsaXN0ZW5pbmcgdG8gdGhpcyBxdWVyeSBvblxuICAgIC8vIGJlaGFsZiBvZiBhbm90aGVyIHRhYiBhbmQgdGhlIHVzZXIgb2YgdGhlIHByaW1hcnkgYWxzbyBzdGFydHMgbGlzdGVuaW5nXG4gICAgLy8gdG8gdGhlIHF1ZXJ5LiBFdmVudE1hbmFnZXIgd2lsbCBub3QgaGF2ZSBhbiBhc3NpZ25lZCB0YXJnZXQgSUQgaW4gdGhpc1xuICAgIC8vIGNhc2UgYW5kIGNhbGxzIGBsaXN0ZW5gIHRvIG9idGFpbiB0aGlzIElELlxuICAgIHMgPSByLnRhcmdldElkLCBuLnNoYXJlZENsaWVudFN0YXRlLmFkZExvY2FsUXVlcnlUYXJnZXQocyksIGkgPSByLnZpZXcuRG8oKTsgZWxzZSB7XG4gICAgICAgIGNvbnN0IHQgPSBhd2FpdCBfcihuLmxvY2FsU3RvcmUsIEVlKGUpKSwgciA9IG4uc2hhcmVkQ2xpZW50U3RhdGUuYWRkTG9jYWxRdWVyeVRhcmdldCh0LnRhcmdldElkKTtcbiAgICAgICAgcyA9IHQudGFyZ2V0SWQsIGkgPSBhd2FpdCBuYShuLCBlLCBzLCBcImN1cnJlbnRcIiA9PT0gciksIG4uaXNQcmltYXJ5Q2xpZW50ICYmIG9vKG4ucmVtb3RlU3RvcmUsIHQpO1xuICAgIH1cbiAgICByZXR1cm4gaTtcbn1cblxuLyoqXG4gKiBSZWdpc3RlcnMgYSB2aWV3IGZvciBhIHByZXZpb3VzbHkgdW5rbm93biBxdWVyeSBhbmQgY29tcHV0ZXMgaXRzIGluaXRpYWxcbiAqIHNuYXBzaG90LlxuICovIGFzeW5jIGZ1bmN0aW9uIG5hKHQsIGUsIG4sIHMpIHtcbiAgICAvLyBQT1JUSU5HIE5PVEU6IE9uIFdlYiBvbmx5LCB3ZSBpbmplY3QgdGhlIGNvZGUgdGhhdCByZWdpc3RlcnMgbmV3IExpbWJvXG4gICAgLy8gdGFyZ2V0cyBiYXNlZCBvbiB2aWV3IGNoYW5nZXMuIFRoaXMgYWxsb3dzIHVzIHRvIG9ubHkgZGVwZW5kIG9uIExpbWJvXG4gICAgLy8gY2hhbmdlcyB3aGVuIHVzZXIgY29kZSBpbmNsdWRlcyBxdWVyaWVzLlxuICAgIHQuS28gPSAoZSwgbiwgcykgPT4gYXN5bmMgZnVuY3Rpb24odCwgZSwgbiwgcykge1xuICAgICAgICBsZXQgaSA9IGUudmlldy5JbyhuKTtcbiAgICAgICAgaS5MbiAmJiAoXG4gICAgICAgIC8vIFRoZSBxdWVyeSBoYXMgYSBsaW1pdCBhbmQgc29tZSBkb2NzIHdlcmUgcmVtb3ZlZCwgc28gd2UgbmVlZFxuICAgICAgICAvLyB0byByZS1ydW4gdGhlIHF1ZXJ5IGFnYWluc3QgdGhlIGxvY2FsIHN0b3JlIHRvIG1ha2Ugc3VyZSB3ZVxuICAgICAgICAvLyBkaWRuJ3QgbG9zZSBhbnkgZ29vZCBkb2NzIHRoYXQgaGFkIGJlZW4gcGFzdCB0aGUgbGltaXQuXG4gICAgICAgIGkgPSBhd2FpdCBncih0LmxvY2FsU3RvcmUsIGUucXVlcnksIFxuICAgICAgICAvKiB1c2VQcmV2aW91c1Jlc3VsdHM9ICovICExKS50aGVuKCgoe2RvY3VtZW50czogdH0pID0+IGUudmlldy5Jbyh0LCBpKSkpKTtcbiAgICAgICAgY29uc3QgciA9IHMgJiYgcy50YXJnZXRDaGFuZ2VzLmdldChlLnRhcmdldElkKSwgbyA9IGUudmlldy5hcHBseUNoYW5nZXMoaSwgXG4gICAgICAgIC8qIHVwZGF0ZUxpbWJvRG9jdW1lbnRzPSAqLyB0LmlzUHJpbWFyeUNsaWVudCwgcik7XG4gICAgICAgIHJldHVybiBfYSh0LCBlLnRhcmdldElkLCBvLnZvKSwgby5zbmFwc2hvdDtcbiAgICB9KHQsIGUsIG4sIHMpO1xuICAgIGNvbnN0IGkgPSBhd2FpdCBncih0LmxvY2FsU3RvcmUsIGUsIFxuICAgIC8qIHVzZVByZXZpb3VzUmVzdWx0cz0gKi8gITApLCByID0gbmV3IFlvKGUsIGkuR24pLCBvID0gci5JbyhpLmRvY3VtZW50cyksIGEgPSBTbi5jcmVhdGVTeW50aGVzaXplZFRhcmdldENoYW5nZUZvckN1cnJlbnRDaGFuZ2UobiwgcyAmJiBcIk9mZmxpbmVcIiAvKiBPZmZsaW5lICovICE9PSB0Lm9ubGluZVN0YXRlKSwgYyA9IHIuYXBwbHlDaGFuZ2VzKG8sIFxuICAgIC8qIHVwZGF0ZUxpbWJvRG9jdW1lbnRzPSAqLyB0LmlzUHJpbWFyeUNsaWVudCwgYSk7XG4gICAgX2EodCwgbiwgYy52byk7XG4gICAgY29uc3QgdSA9IG5ldyBYbyhlLCBuLCByKTtcbiAgICByZXR1cm4gdC54by5zZXQoZSwgdSksIHQua28uaGFzKG4pID8gdC5rby5nZXQobikucHVzaChlKSA6IHQua28uc2V0KG4sIFsgZSBdKSwgYy5zbmFwc2hvdDtcbn1cblxuLyoqIFN0b3BzIGxpc3RlbmluZyB0byB0aGUgcXVlcnkuICovIGFzeW5jIGZ1bmN0aW9uIHNhKHQsIGUpIHtcbiAgICBjb25zdCBuID0gVSh0KSwgcyA9IG4ueG8uZ2V0KGUpLCBpID0gbi5rby5nZXQocy50YXJnZXRJZCk7XG4gICAgaWYgKGkubGVuZ3RoID4gMSkgcmV0dXJuIG4ua28uc2V0KHMudGFyZ2V0SWQsIGkuZmlsdGVyKCh0ID0+ICFJZSh0LCBlKSkpKSwgdm9pZCBuLnhvLmRlbGV0ZShlKTtcbiAgICAvLyBObyBvdGhlciBxdWVyaWVzIGFyZSBtYXBwZWQgdG8gdGhlIHRhcmdldCwgY2xlYW4gdXAgdGhlIHF1ZXJ5IGFuZCB0aGUgdGFyZ2V0LlxuICAgICAgICBpZiAobi5pc1ByaW1hcnlDbGllbnQpIHtcbiAgICAgICAgLy8gV2UgbmVlZCB0byByZW1vdmUgdGhlIGxvY2FsIHF1ZXJ5IHRhcmdldCBmaXJzdCB0byBhbGxvdyB1cyB0byB2ZXJpZnlcbiAgICAgICAgLy8gd2hldGhlciBhbnkgb3RoZXIgY2xpZW50IGlzIHN0aWxsIGludGVyZXN0ZWQgaW4gdGhpcyB0YXJnZXQuXG4gICAgICAgIG4uc2hhcmVkQ2xpZW50U3RhdGUucmVtb3ZlTG9jYWxRdWVyeVRhcmdldChzLnRhcmdldElkKTtcbiAgICAgICAgbi5zaGFyZWRDbGllbnRTdGF0ZS5pc0FjdGl2ZVF1ZXJ5VGFyZ2V0KHMudGFyZ2V0SWQpIHx8IGF3YWl0IG1yKG4ubG9jYWxTdG9yZSwgcy50YXJnZXRJZCwgXG4gICAgICAgIC8qa2VlcFBlcnNpc3RlZFRhcmdldERhdGE9Ki8gITEpLnRoZW4oKCgpID0+IHtcbiAgICAgICAgICAgIG4uc2hhcmVkQ2xpZW50U3RhdGUuY2xlYXJRdWVyeVN0YXRlKHMudGFyZ2V0SWQpLCBhbyhuLnJlbW90ZVN0b3JlLCBzLnRhcmdldElkKSwgXG4gICAgICAgICAgICBkYShuLCBzLnRhcmdldElkKTtcbiAgICAgICAgfSkpLmNhdGNoKE9pKTtcbiAgICB9IGVsc2UgZGEobiwgcy50YXJnZXRJZCksIGF3YWl0IG1yKG4ubG9jYWxTdG9yZSwgcy50YXJnZXRJZCwgXG4gICAgLyprZWVwUGVyc2lzdGVkVGFyZ2V0RGF0YT0qLyAhMCk7XG59XG5cbi8qKlxuICogSW5pdGlhdGVzIHRoZSB3cml0ZSBvZiBsb2NhbCBtdXRhdGlvbiBiYXRjaCB3aGljaCBpbnZvbHZlcyBhZGRpbmcgdGhlXG4gKiB3cml0ZXMgdG8gdGhlIG11dGF0aW9uIHF1ZXVlLCBub3RpZnlpbmcgdGhlIHJlbW90ZSBzdG9yZSBhYm91dCBuZXdcbiAqIG11dGF0aW9ucyBhbmQgcmFpc2luZyBldmVudHMgZm9yIGFueSBjaGFuZ2VzIHRoaXMgd3JpdGUgY2F1c2VkLlxuICpcbiAqIFRoZSBwcm9taXNlIHJldHVybmVkIGJ5IHRoaXMgY2FsbCBpcyByZXNvbHZlZCB3aGVuIHRoZSBhYm92ZSBzdGVwc1xuICogaGF2ZSBjb21wbGV0ZWQsICpub3QqIHdoZW4gdGhlIHdyaXRlIHdhcyBhY2tlZCBieSB0aGUgYmFja2VuZC4gVGhlXG4gKiB1c2VyQ2FsbGJhY2sgaXMgcmVzb2x2ZWQgb25jZSB0aGUgd3JpdGUgd2FzIGFja2VkL3JlamVjdGVkIGJ5IHRoZVxuICogYmFja2VuZCAob3IgZmFpbGVkIGxvY2FsbHkgZm9yIGFueSBvdGhlciByZWFzb24pLlxuICovIGFzeW5jIGZ1bmN0aW9uIGlhKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gQ2EodCk7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgdCA9IGF3YWl0IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBVKHQpLCBzID0gc3Qubm93KCksIGkgPSBlLnJlZHVjZSgoKHQsIGUpID0+IHQuYWRkKGUua2V5KSksIFBuKCkpO1xuICAgICAgICAgICAgbGV0IHI7XG4gICAgICAgICAgICByZXR1cm4gbi5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIkxvY2FsbHkgd3JpdGUgbXV0YXRpb25zXCIsIFwicmVhZHdyaXRlXCIsICh0ID0+IG4uUW4uYm4odCwgaSkubmV4dCgoaSA9PiB7XG4gICAgICAgICAgICAgICAgciA9IGk7XG4gICAgICAgICAgICAgICAgLy8gRm9yIG5vbi1pZGVtcG90ZW50IG11dGF0aW9ucyAoc3VjaCBhcyBgRmllbGRWYWx1ZS5pbmNyZW1lbnQoKWApLFxuICAgICAgICAgICAgICAgIC8vIHdlIHJlY29yZCB0aGUgYmFzZSBzdGF0ZSBpbiBhIHNlcGFyYXRlIHBhdGNoIG11dGF0aW9uLiBUaGlzIGlzXG4gICAgICAgICAgICAgICAgLy8gbGF0ZXIgdXNlZCB0byBndWFyYW50ZWUgY29uc2lzdGVudCB2YWx1ZXMgYW5kIHByZXZlbnRzIGZsaWNrZXJcbiAgICAgICAgICAgICAgICAvLyBldmVuIGlmIHRoZSBiYWNrZW5kIHNlbmRzIHVzIGFuIHVwZGF0ZSB0aGF0IGFscmVhZHkgaW5jbHVkZXMgb3VyXG4gICAgICAgICAgICAgICAgLy8gdHJhbnNmb3JtLlxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gWWUodCwgci5nZXQodC5rZXkpKTtcbiAgICAgICAgICAgICAgICAgICAgbnVsbCAhPSBlICYmIFxuICAgICAgICAgICAgICAgICAgICAvLyBOT1RFOiBUaGUgYmFzZSBzdGF0ZSBzaG91bGQgb25seSBiZSBhcHBsaWVkIGlmIHRoZXJlJ3Mgc29tZVxuICAgICAgICAgICAgICAgICAgICAvLyBleGlzdGluZyBkb2N1bWVudCB0byBvdmVycmlkZSwgc28gdXNlIGEgUHJlY29uZGl0aW9uIG9mXG4gICAgICAgICAgICAgICAgICAgIC8vIGV4aXN0cz10cnVlXG4gICAgICAgICAgICAgICAgICAgIG8ucHVzaChuZXcgZW4odC5rZXksIGUsIFV0KGUudmFsdWUubWFwVmFsdWUpLCBXZS5leGlzdHMoITApKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBuLkluLmFkZE11dGF0aW9uQmF0Y2godCwgcywgbywgZSk7XG4gICAgICAgICAgICB9KSkpKS50aGVuKCh0ID0+ICh0LmFwcGx5VG9Mb2NhbERvY3VtZW50U2V0KHIpLCB7XG4gICAgICAgICAgICAgICAgYmF0Y2hJZDogdC5iYXRjaElkLFxuICAgICAgICAgICAgICAgIGNoYW5nZXM6IHJcbiAgICAgICAgICAgIH0pKSk7XG4gICAgICAgIH0ocy5sb2NhbFN0b3JlLCBlKTtcbiAgICAgICAgcy5zaGFyZWRDbGllbnRTdGF0ZS5hZGRQZW5kaW5nTXV0YXRpb24odC5iYXRjaElkKSwgZnVuY3Rpb24odCwgZSwgbikge1xuICAgICAgICAgICAgbGV0IHMgPSB0LkxvW3QuY3VycmVudFVzZXIudG9LZXkoKV07XG4gICAgICAgICAgICBzIHx8IChzID0gbmV3IGRuKHR0KSk7XG4gICAgICAgICAgICBzID0gcy5pbnNlcnQoZSwgbiksIHQuTG9bdC5jdXJyZW50VXNlci50b0tleSgpXSA9IHM7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gKiBSZXNvbHZlcyBvciByZWplY3RzIHRoZSB1c2VyIGNhbGxiYWNrIGZvciB0aGUgZ2l2ZW4gYmF0Y2ggYW5kIHRoZW4gZGlzY2FyZHNcbiAqIGl0LlxuICovIChzLCB0LmJhdGNoSWQsIG4pLCBhd2FpdCB5YShzLCB0LmNoYW5nZXMpLCBhd2FpdCBFbyhzLnJlbW90ZVN0b3JlKTtcbiAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgIC8vIElmIHdlIGNhbid0IHBlcnNpc3QgdGhlIG11dGF0aW9uLCB3ZSByZWplY3QgdGhlIHVzZXIgY2FsbGJhY2sgYW5kXG4gICAgICAgIC8vIGRvbid0IHNlbmQgdGhlIG11dGF0aW9uLiBUaGUgdXNlciBjYW4gdGhlbiByZXRyeSB0aGUgd3JpdGUuXG4gICAgICAgIGNvbnN0IGUgPSB4byh0LCBcIkZhaWxlZCB0byBwZXJzaXN0IHdyaXRlXCIpO1xuICAgICAgICBuLnJlamVjdChlKTtcbiAgICB9XG59XG5cbi8qKlxuICogQXBwbGllcyBvbmUgcmVtb3RlIGV2ZW50IHRvIHRoZSBzeW5jIGVuZ2luZSwgbm90aWZ5aW5nIGFueSB2aWV3cyBvZiB0aGVcbiAqIGNoYW5nZXMsIGFuZCByZWxlYXNpbmcgYW55IHBlbmRpbmcgbXV0YXRpb24gYmF0Y2hlcyB0aGF0IHdvdWxkIGJlY29tZVxuICogdmlzaWJsZSBiZWNhdXNlIG9mIHRoZSBzbmFwc2hvdCB2ZXJzaW9uIHRoZSByZW1vdGUgZXZlbnQgY29udGFpbnMuXG4gKi8gYXN5bmMgZnVuY3Rpb24gcmEodCwgZSkge1xuICAgIGNvbnN0IG4gPSBVKHQpO1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHQgPSBhd2FpdCBmcihuLmxvY2FsU3RvcmUsIGUpO1xuICAgICAgICAvLyBVcGRhdGUgYHJlY2VpdmVkRG9jdW1lbnRgIGFzIGFwcHJvcHJpYXRlIGZvciBhbnkgbGltYm8gdGFyZ2V0cy5cbiAgICAgICAgICAgICAgICBlLnRhcmdldENoYW5nZXMuZm9yRWFjaCgoKHQsIGUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBuLkZvLmdldChlKTtcbiAgICAgICAgICAgIHMgJiYgKFxuICAgICAgICAgICAgLy8gU2luY2UgdGhpcyBpcyBhIGxpbWJvIHJlc29sdXRpb24gbG9va3VwLCBpdCdzIGZvciBhIHNpbmdsZSBkb2N1bWVudFxuICAgICAgICAgICAgLy8gYW5kIGl0IGNvdWxkIGJlIGFkZGVkLCBtb2RpZmllZCwgb3IgcmVtb3ZlZCwgYnV0IG5vdCBhIGNvbWJpbmF0aW9uLlxuICAgICAgICAgICAgTCh0LmFkZGVkRG9jdW1lbnRzLnNpemUgKyB0Lm1vZGlmaWVkRG9jdW1lbnRzLnNpemUgKyB0LnJlbW92ZWREb2N1bWVudHMuc2l6ZSA8PSAxKSwgXG4gICAgICAgICAgICB0LmFkZGVkRG9jdW1lbnRzLnNpemUgPiAwID8gcy5DbyA9ICEwIDogdC5tb2RpZmllZERvY3VtZW50cy5zaXplID4gMCA/IEwocy5DbykgOiB0LnJlbW92ZWREb2N1bWVudHMuc2l6ZSA+IDAgJiYgKEwocy5DbyksIFxuICAgICAgICAgICAgcy5DbyA9ICExKSk7XG4gICAgICAgIH0pKSwgYXdhaXQgeWEobiwgdCwgZSk7XG4gICAgfSBjYXRjaCAodCkge1xuICAgICAgICBhd2FpdCBPaSh0KTtcbiAgICB9XG59XG5cbi8qKlxuICogQXBwbGllcyBhbiBPbmxpbmVTdGF0ZSBjaGFuZ2UgdG8gdGhlIHN5bmMgZW5naW5lIGFuZCBub3RpZmllcyBhbnkgdmlld3Mgb2ZcbiAqIHRoZSBjaGFuZ2UuXG4gKi8gZnVuY3Rpb24gb2EodCwgZSwgbikge1xuICAgIGNvbnN0IHMgPSBVKHQpO1xuICAgIC8vIElmIHdlIGFyZSB0aGUgc2Vjb25kYXJ5IGNsaWVudCwgd2UgZXhwbGljaXRseSBpZ25vcmUgdGhlIHJlbW90ZSBzdG9yZSdzXG4gICAgLy8gb25saW5lIHN0YXRlICh0aGUgbG9jYWwgY2xpZW50IG1heSBnbyBvZmZsaW5lLCBldmVuIHRob3VnaCB0aGUgcHJpbWFyeVxuICAgIC8vIHRhYiByZW1haW5zIG9ubGluZSkgYW5kIG9ubHkgYXBwbHkgdGhlIHByaW1hcnkgdGFiJ3Mgb25saW5lIHN0YXRlIGZyb21cbiAgICAvLyBTaGFyZWRDbGllbnRTdGF0ZS5cbiAgICAgICAgaWYgKHMuaXNQcmltYXJ5Q2xpZW50ICYmIDAgLyogUmVtb3RlU3RvcmUgKi8gPT09IG4gfHwgIXMuaXNQcmltYXJ5Q2xpZW50ICYmIDEgLyogU2hhcmVkQ2xpZW50U3RhdGUgKi8gPT09IG4pIHtcbiAgICAgICAgY29uc3QgdCA9IFtdO1xuICAgICAgICBzLnhvLmZvckVhY2goKChuLCBzKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBpID0gcy52aWV3LmVvKGUpO1xuICAgICAgICAgICAgaS5zbmFwc2hvdCAmJiB0LnB1c2goaS5zbmFwc2hvdCk7XG4gICAgICAgIH0pKSwgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgY29uc3QgbiA9IFUodCk7XG4gICAgICAgICAgICBuLm9ubGluZVN0YXRlID0gZTtcbiAgICAgICAgICAgIGxldCBzID0gITE7XG4gICAgICAgICAgICBuLnF1ZXJpZXMuZm9yRWFjaCgoKHQsIG4pID0+IHtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2Ygbi5saXN0ZW5lcnMpIFxuICAgICAgICAgICAgICAgIC8vIFJ1biBnbG9iYWwgc25hcHNob3QgbGlzdGVuZXJzIGlmIGEgY29uc2lzdGVudCBzbmFwc2hvdCBoYXMgYmVlbiBlbWl0dGVkLlxuICAgICAgICAgICAgICAgIHQuZW8oZSkgJiYgKHMgPSAhMCk7XG4gICAgICAgICAgICB9KSksIHMgJiYgS28obik7XG4gICAgICAgIH0ocy5ldmVudE1hbmFnZXIsIGUpLCB0Lmxlbmd0aCAmJiBzLk5vLlRyKHQpLCBzLm9ubGluZVN0YXRlID0gZSwgcy5pc1ByaW1hcnlDbGllbnQgJiYgcy5zaGFyZWRDbGllbnRTdGF0ZS5zZXRPbmxpbmVTdGF0ZShlKTtcbiAgICB9XG59XG5cbi8qKlxuICogUmVqZWN0cyB0aGUgbGlzdGVuIGZvciB0aGUgZ2l2ZW4gdGFyZ2V0SUQuIFRoaXMgY2FuIGJlIHRyaWdnZXJlZCBieSB0aGVcbiAqIGJhY2tlbmQgZm9yIGFueSBhY3RpdmUgdGFyZ2V0LlxuICpcbiAqIEBwYXJhbSBzeW5jRW5naW5lIC0gVGhlIHN5bmMgZW5naW5lIGltcGxlbWVudGF0aW9uLlxuICogQHBhcmFtIHRhcmdldElkIC0gVGhlIHRhcmdldElEIGNvcnJlc3BvbmRzIHRvIG9uZSBwcmV2aW91c2x5IGluaXRpYXRlZCBieSB0aGVcbiAqIHVzZXIgYXMgcGFydCBvZiBUYXJnZXREYXRhIHBhc3NlZCB0byBsaXN0ZW4oKSBvbiBSZW1vdGVTdG9yZS5cbiAqIEBwYXJhbSBlcnIgLSBBIGRlc2NyaXB0aW9uIG9mIHRoZSBjb25kaXRpb24gdGhhdCBoYXMgZm9yY2VkIHRoZSByZWplY3Rpb24uXG4gKiBOZWFybHkgYWx3YXlzIHRoaXMgd2lsbCBiZSBhbiBpbmRpY2F0aW9uIHRoYXQgdGhlIHVzZXIgaXMgbm8gbG9uZ2VyXG4gKiBhdXRob3JpemVkIHRvIHNlZSB0aGUgZGF0YSBtYXRjaGluZyB0aGUgdGFyZ2V0LlxuICovIGFzeW5jIGZ1bmN0aW9uIGFhKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gVSh0KTtcbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5LlxuICAgICAgICBzLnNoYXJlZENsaWVudFN0YXRlLnVwZGF0ZVF1ZXJ5U3RhdGUoZSwgXCJyZWplY3RlZFwiLCBuKTtcbiAgICBjb25zdCBpID0gcy5Gby5nZXQoZSksIHIgPSBpICYmIGkua2V5O1xuICAgIGlmIChyKSB7XG4gICAgICAgIC8vIFRPRE8oa2xpbXQpOiBXZSByZWFsbHkgb25seSBzaG91bGQgZG8gdGhlIGZvbGxvd2luZyBvbiBwZXJtaXNzaW9uXG4gICAgICAgIC8vIGRlbmllZCBlcnJvcnMsIGJ1dCB3ZSBkb24ndCBoYXZlIHRoZSBjYXVzZSBjb2RlIGhlcmUuXG4gICAgICAgIC8vIEl0J3MgYSBsaW1ibyBkb2MuIENyZWF0ZSBhIHN5bnRoZXRpYyBldmVudCBzYXlpbmcgaXQgd2FzIGRlbGV0ZWQuXG4gICAgICAgIC8vIFRoaXMgaXMga2luZCBvZiBhIGhhY2suIElkZWFsbHksIHdlIHdvdWxkIGhhdmUgYSBtZXRob2QgaW4gdGhlIGxvY2FsXG4gICAgICAgIC8vIHN0b3JlIHRvIHB1cmdlIGEgZG9jdW1lbnQuIEhvd2V2ZXIsIGl0IHdvdWxkIGJlIHRyaWNreSB0byBrZWVwIGFsbCBvZlxuICAgICAgICAvLyB0aGUgbG9jYWwgc3RvcmUncyBpbnZhcmlhbnRzIHdpdGggYW5vdGhlciBtZXRob2QuXG4gICAgICAgIGxldCB0ID0gbmV3IGRuKFB0LmNvbXBhcmF0b3IpO1xuICAgICAgICB0ID0gdC5pbnNlcnQociwgcXQubmV3Tm9Eb2N1bWVudChyLCBpdC5taW4oKSkpO1xuICAgICAgICBjb25zdCBuID0gUG4oKS5hZGQociksIGkgPSBuZXcgVm4oaXQubWluKCksIFxuICAgICAgICAvKiB0YXJnZXRDaGFuZ2VzPSAqLyBuZXcgTWFwLCBcbiAgICAgICAgLyogdGFyZ2V0TWlzbWF0Y2hlcz0gKi8gbmV3IG1uKHR0KSwgdCwgbik7XG4gICAgICAgIGF3YWl0IHJhKHMsIGkpLCBcbiAgICAgICAgLy8gU2luY2UgdGhpcyBxdWVyeSBmYWlsZWQsIHdlIHdvbid0IHdhbnQgdG8gbWFudWFsbHkgdW5saXN0ZW4gdG8gaXQuXG4gICAgICAgIC8vIFdlIG9ubHkgcmVtb3ZlIGl0IGZyb20gYm9va2tlZXBpbmcgYWZ0ZXIgd2Ugc3VjY2Vzc2Z1bGx5IGFwcGxpZWQgdGhlXG4gICAgICAgIC8vIFJlbW90ZUV2ZW50LiBJZiBgYXBwbHlSZW1vdGVFdmVudCgpYCB0aHJvd3MsIHdlIHdhbnQgdG8gcmUtbGlzdGVuIHRvXG4gICAgICAgIC8vIHRoaXMgcXVlcnkgd2hlbiB0aGUgUmVtb3RlU3RvcmUgcmVzdGFydHMgdGhlIFdhdGNoIHN0cmVhbSwgd2hpY2ggc2hvdWxkXG4gICAgICAgIC8vIHJlLXRyaWdnZXIgdGhlIHRhcmdldCBmYWlsdXJlLlxuICAgICAgICBzLk9vID0gcy5Pby5yZW1vdmUociksIHMuRm8uZGVsZXRlKGUpLCBnYShzKTtcbiAgICB9IGVsc2UgYXdhaXQgbXIocy5sb2NhbFN0b3JlLCBlLCBcbiAgICAvKiBrZWVwUGVyc2lzdGVkVGFyZ2V0RGF0YSAqLyAhMSkudGhlbigoKCkgPT4gZGEocywgZSwgbikpKS5jYXRjaChPaSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGNhKHQsIGUpIHtcbiAgICBjb25zdCBuID0gVSh0KSwgcyA9IGUuYmF0Y2guYmF0Y2hJZDtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCB0ID0gYXdhaXQgaHIobi5sb2NhbFN0b3JlLCBlKTtcbiAgICAgICAgLy8gVGhlIGxvY2FsIHN0b3JlIG1heSBvciBtYXkgbm90IGJlIGFibGUgdG8gYXBwbHkgdGhlIHdyaXRlIHJlc3VsdCBhbmRcbiAgICAgICAgLy8gcmFpc2UgZXZlbnRzIGltbWVkaWF0ZWx5IChkZXBlbmRpbmcgb24gd2hldGhlciB0aGUgd2F0Y2hlciBpcyBjYXVnaHRcbiAgICAgICAgLy8gdXApLCBzbyB3ZSByYWlzZSB1c2VyIGNhbGxiYWNrcyBmaXJzdCBzbyB0aGF0IHRoZXkgY29uc2lzdGVudGx5IGhhcHBlblxuICAgICAgICAvLyBiZWZvcmUgbGlzdGVuIGV2ZW50cy5cbiAgICAgICAgICAgICAgICBmYShuLCBzLCAvKmVycm9yPSovIG51bGwpLCBsYShuLCBzKSwgbi5zaGFyZWRDbGllbnRTdGF0ZS51cGRhdGVNdXRhdGlvblN0YXRlKHMsIFwiYWNrbm93bGVkZ2VkXCIpLCBcbiAgICAgICAgYXdhaXQgeWEobiwgdCk7XG4gICAgfSBjYXRjaCAodCkge1xuICAgICAgICBhd2FpdCBPaSh0KTtcbiAgICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHVhKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gVSh0KTtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCB0ID0gYXdhaXQgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgY29uc3QgbiA9IFUodCk7XG4gICAgICAgICAgICByZXR1cm4gbi5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIlJlamVjdCBiYXRjaFwiLCBcInJlYWR3cml0ZS1wcmltYXJ5XCIsICh0ID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgcztcbiAgICAgICAgICAgICAgICByZXR1cm4gbi5Jbi5sb29rdXBNdXRhdGlvbkJhdGNoKHQsIGUpLm5leHQoKGUgPT4gKEwobnVsbCAhPT0gZSksIHMgPSBlLmtleXMoKSwgbi5Jbi5yZW1vdmVNdXRhdGlvbkJhdGNoKHQsIGUpKSkpLm5leHQoKCgpID0+IG4uSW4ucGVyZm9ybUNvbnNpc3RlbmN5Q2hlY2sodCkpKS5uZXh0KCgoKSA9PiBuLlFuLmJuKHQsIHMpKSk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gKiBSZXR1cm5zIHRoZSBsYXJnZXN0IChsYXRlc3QpIGJhdGNoIGlkIGluIG11dGF0aW9uIHF1ZXVlIHRoYXQgaXMgcGVuZGluZ1xuICogc2VydmVyIHJlc3BvbnNlLlxuICpcbiAqIFJldHVybnMgYEJBVENISURfVU5LTk9XTmAgaWYgdGhlIHF1ZXVlIGlzIGVtcHR5LlxuICovIChzLmxvY2FsU3RvcmUsIGUpO1xuICAgICAgICAvLyBUaGUgbG9jYWwgc3RvcmUgbWF5IG9yIG1heSBub3QgYmUgYWJsZSB0byBhcHBseSB0aGUgd3JpdGUgcmVzdWx0IGFuZFxuICAgICAgICAvLyByYWlzZSBldmVudHMgaW1tZWRpYXRlbHkgKGRlcGVuZGluZyBvbiB3aGV0aGVyIHRoZSB3YXRjaGVyIGlzIGNhdWdodCB1cCksXG4gICAgICAgIC8vIHNvIHdlIHJhaXNlIHVzZXIgY2FsbGJhY2tzIGZpcnN0IHNvIHRoYXQgdGhleSBjb25zaXN0ZW50bHkgaGFwcGVuIGJlZm9yZVxuICAgICAgICAvLyBsaXN0ZW4gZXZlbnRzLlxuICAgICAgICAgICAgICAgIGZhKHMsIGUsIG4pLCBsYShzLCBlKSwgcy5zaGFyZWRDbGllbnRTdGF0ZS51cGRhdGVNdXRhdGlvblN0YXRlKGUsIFwicmVqZWN0ZWRcIiwgbiksIFxuICAgICAgICBhd2FpdCB5YShzLCB0KTtcbiAgICB9IGNhdGNoIChuKSB7XG4gICAgICAgIGF3YWl0IE9pKG4pO1xuICAgIH1cbn1cblxuLyoqXG4gKiBSZWdpc3RlcnMgYSB1c2VyIGNhbGxiYWNrIHRoYXQgcmVzb2x2ZXMgd2hlbiBhbGwgcGVuZGluZyBtdXRhdGlvbnMgYXQgdGhlIG1vbWVudCBvZiBjYWxsaW5nXG4gKiBhcmUgYWNrbm93bGVkZ2VkIC5cbiAqLyBhc3luYyBmdW5jdGlvbiBoYSh0LCBlKSB7XG4gICAgY29uc3QgbiA9IFUodCk7XG4gICAgZm8obi5yZW1vdGVTdG9yZSkgfHwgayhcIlN5bmNFbmdpbmVcIiwgXCJUaGUgbmV0d29yayBpcyBkaXNhYmxlZC4gVGhlIHRhc2sgcmV0dXJuZWQgYnkgJ2F3YWl0UGVuZGluZ1dyaXRlcygpJyB3aWxsIG5vdCBjb21wbGV0ZSB1bnRpbCB0aGUgbmV0d29yayBpcyBlbmFibGVkLlwiKTtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCB0ID0gYXdhaXQgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgY29uc3QgZSA9IFUodCk7XG4gICAgICAgICAgICByZXR1cm4gZS5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIkdldCBoaWdoZXN0IHVuYWNrbm93bGVkZ2VkIGJhdGNoIGlkXCIsIFwicmVhZG9ubHlcIiwgKHQgPT4gZS5Jbi5nZXRIaWdoZXN0VW5hY2tub3dsZWRnZWRCYXRjaElkKHQpKSk7XG4gICAgICAgIH0obi5sb2NhbFN0b3JlKTtcbiAgICAgICAgaWYgKC0xID09PSB0KSBcbiAgICAgICAgLy8gVHJpZ2dlciB0aGUgY2FsbGJhY2sgcmlnaHQgYXdheSBpZiB0aGVyZSBpcyBubyBwZW5kaW5nIHdyaXRlcyBhdCB0aGUgbW9tZW50LlxuICAgICAgICByZXR1cm4gdm9pZCBlLnJlc29sdmUoKTtcbiAgICAgICAgY29uc3QgcyA9IG4uQm8uZ2V0KHQpIHx8IFtdO1xuICAgICAgICBzLnB1c2goZSksIG4uQm8uc2V0KHQsIHMpO1xuICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgY29uc3QgbiA9IHhvKHQsIFwiSW5pdGlhbGl6YXRpb24gb2Ygd2FpdEZvclBlbmRpbmdXcml0ZXMoKSBvcGVyYXRpb24gZmFpbGVkXCIpO1xuICAgICAgICBlLnJlamVjdChuKTtcbiAgICB9XG59XG5cbi8qKlxuICogVHJpZ2dlcnMgdGhlIGNhbGxiYWNrcyB0aGF0IGFyZSB3YWl0aW5nIGZvciB0aGlzIGJhdGNoIGlkIHRvIGdldCBhY2tub3dsZWRnZWQgYnkgc2VydmVyLFxuICogaWYgdGhlcmUgYXJlIGFueS5cbiAqLyBmdW5jdGlvbiBsYSh0LCBlKSB7XG4gICAgKHQuQm8uZ2V0KGUpIHx8IFtdKS5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgdC5yZXNvbHZlKCk7XG4gICAgfSkpLCB0LkJvLmRlbGV0ZShlKTtcbn1cblxuLyoqIFJlamVjdCBhbGwgb3V0c3RhbmRpbmcgY2FsbGJhY2tzIHdhaXRpbmcgZm9yIHBlbmRpbmcgd3JpdGVzIHRvIGNvbXBsZXRlLiAqLyBmdW5jdGlvbiBmYSh0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9IFUodCk7XG4gICAgbGV0IGkgPSBzLkxvW3MuY3VycmVudFVzZXIudG9LZXkoKV07XG4gICAgLy8gTk9URTogTXV0YXRpb25zIHJlc3RvcmVkIGZyb20gcGVyc2lzdGVuY2Ugd29uJ3QgaGF2ZSBjYWxsYmFja3MsIHNvIGl0J3NcbiAgICAvLyBva2F5IGZvciB0aGVyZSB0byBiZSBubyBjYWxsYmFjayBmb3IgdGhpcyBJRC5cbiAgICAgICAgaWYgKGkpIHtcbiAgICAgICAgY29uc3QgdCA9IGkuZ2V0KGUpO1xuICAgICAgICB0ICYmIChuID8gdC5yZWplY3QobikgOiB0LnJlc29sdmUoKSwgaSA9IGkucmVtb3ZlKGUpKSwgcy5Mb1tzLmN1cnJlbnRVc2VyLnRvS2V5KCldID0gaTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGRhKHQsIGUsIG4gPSBudWxsKSB7XG4gICAgdC5zaGFyZWRDbGllbnRTdGF0ZS5yZW1vdmVMb2NhbFF1ZXJ5VGFyZ2V0KGUpO1xuICAgIGZvciAoY29uc3QgcyBvZiB0LmtvLmdldChlKSkgdC54by5kZWxldGUocyksIG4gJiYgdC5Oby5qbyhzLCBuKTtcbiAgICBpZiAodC5rby5kZWxldGUoZSksIHQuaXNQcmltYXJ5Q2xpZW50KSB7XG4gICAgICAgIHQuTW8uY3MoZSkuZm9yRWFjaCgoZSA9PiB7XG4gICAgICAgICAgICB0Lk1vLmNvbnRhaW5zS2V5KGUpIHx8IFxuICAgICAgICAgICAgLy8gV2UgcmVtb3ZlZCB0aGUgbGFzdCByZWZlcmVuY2UgZm9yIHRoaXMga2V5XG4gICAgICAgICAgICB3YSh0LCBlKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gd2EodCwgZSkge1xuICAgIHQuJG8uZGVsZXRlKGUucGF0aC5jYW5vbmljYWxTdHJpbmcoKSk7XG4gICAgLy8gSXQncyBwb3NzaWJsZSB0aGF0IHRoZSB0YXJnZXQgYWxyZWFkeSBnb3QgcmVtb3ZlZCBiZWNhdXNlIHRoZSBxdWVyeSBmYWlsZWQuIEluIHRoYXQgY2FzZSxcbiAgICAvLyB0aGUga2V5IHdvbid0IGV4aXN0IGluIGBsaW1ib1RhcmdldHNCeUtleWAuIE9ubHkgZG8gdGhlIGNsZWFudXAgaWYgd2Ugc3RpbGwgaGF2ZSB0aGUgdGFyZ2V0LlxuICAgIGNvbnN0IG4gPSB0Lk9vLmdldChlKTtcbiAgICBudWxsICE9PSBuICYmIChhbyh0LnJlbW90ZVN0b3JlLCBuKSwgdC5PbyA9IHQuT28ucmVtb3ZlKGUpLCB0LkZvLmRlbGV0ZShuKSwgZ2EodCkpO1xufVxuXG5mdW5jdGlvbiBfYSh0LCBlLCBuKSB7XG4gICAgZm9yIChjb25zdCBzIG9mIG4pIGlmIChzIGluc3RhbmNlb2YgSG8pIHQuTW8uYWRkUmVmZXJlbmNlKHMua2V5LCBlKSwgbWEodCwgcyk7IGVsc2UgaWYgKHMgaW5zdGFuY2VvZiBKbykge1xuICAgICAgICBrKFwiU3luY0VuZ2luZVwiLCBcIkRvY3VtZW50IG5vIGxvbmdlciBpbiBsaW1ibzogXCIgKyBzLmtleSksIHQuTW8ucmVtb3ZlUmVmZXJlbmNlKHMua2V5LCBlKTtcbiAgICAgICAgdC5Nby5jb250YWluc0tleShzLmtleSkgfHwgXG4gICAgICAgIC8vIFdlIHJlbW92ZWQgdGhlIGxhc3QgcmVmZXJlbmNlIGZvciB0aGlzIGtleVxuICAgICAgICB3YSh0LCBzLmtleSk7XG4gICAgfSBlbHNlIE0oKTtcbn1cblxuZnVuY3Rpb24gbWEodCwgZSkge1xuICAgIGNvbnN0IG4gPSBlLmtleSwgcyA9IG4ucGF0aC5jYW5vbmljYWxTdHJpbmcoKTtcbiAgICB0Lk9vLmdldChuKSB8fCB0LiRvLmhhcyhzKSB8fCAoayhcIlN5bmNFbmdpbmVcIiwgXCJOZXcgZG9jdW1lbnQgaW4gbGltYm86IFwiICsgbiksIHQuJG8uYWRkKHMpLCBcbiAgICBnYSh0KSk7XG59XG5cbi8qKlxuICogU3RhcnRzIGxpc3RlbnMgZm9yIGRvY3VtZW50cyBpbiBsaW1ibyB0aGF0IGFyZSBlbnF1ZXVlZCBmb3IgcmVzb2x1dGlvbixcbiAqIHN1YmplY3QgdG8gYSBtYXhpbXVtIG51bWJlciBvZiBjb25jdXJyZW50IHJlc29sdXRpb25zLlxuICpcbiAqIFdpdGhvdXQgYm91bmRpbmcgdGhlIG51bWJlciBvZiBjb25jdXJyZW50IHJlc29sdXRpb25zLCB0aGUgc2VydmVyIGNhbiBmYWlsXG4gKiB3aXRoIFwicmVzb3VyY2UgZXhoYXVzdGVkXCIgZXJyb3JzIHdoaWNoIGNhbiBsZWFkIHRvIHBhdGhvbG9naWNhbCBjbGllbnRcbiAqIGJlaGF2aW9yIGFzIHNlZW4gaW4gaHR0cHM6Ly9naXRodWIuY29tL2ZpcmViYXNlL2ZpcmViYXNlLWpzLXNkay9pc3N1ZXMvMjY4My5cbiAqLyBmdW5jdGlvbiBnYSh0KSB7XG4gICAgZm9yICg7dC4kby5zaXplID4gMCAmJiB0Lk9vLnNpemUgPCB0Lm1heENvbmN1cnJlbnRMaW1ib1Jlc29sdXRpb25zOyApIHtcbiAgICAgICAgY29uc3QgZSA9IHQuJG8udmFsdWVzKCkubmV4dCgpLnZhbHVlO1xuICAgICAgICB0LiRvLmRlbGV0ZShlKTtcbiAgICAgICAgY29uc3QgbiA9IG5ldyBQdCh1dC5mcm9tU3RyaW5nKGUpKSwgcyA9IHQuVW8ubmV4dCgpO1xuICAgICAgICB0LkZvLnNldChzLCBuZXcgWm8obikpLCB0Lk9vID0gdC5Pby5pbnNlcnQobiwgcyksIG9vKHQucmVtb3RlU3RvcmUsIG5ldyBzaShFZShkZShuLnBhdGgpKSwgcywgMiAvKiBMaW1ib1Jlc29sdXRpb24gKi8gLCBZLlQpKTtcbiAgICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHlhKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gVSh0KSwgaSA9IFtdLCByID0gW10sIG8gPSBbXTtcbiAgICBzLnhvLmlzRW1wdHkoKSB8fCAocy54by5mb3JFYWNoKCgodCwgYSkgPT4ge1xuICAgICAgICBvLnB1c2gocy5LbyhhLCBlLCBuKS50aGVuKCh0ID0+IHtcbiAgICAgICAgICAgIGlmICh0KSB7XG4gICAgICAgICAgICAgICAgcy5pc1ByaW1hcnlDbGllbnQgJiYgcy5zaGFyZWRDbGllbnRTdGF0ZS51cGRhdGVRdWVyeVN0YXRlKGEudGFyZ2V0SWQsIHQuZnJvbUNhY2hlID8gXCJub3QtY3VycmVudFwiIDogXCJjdXJyZW50XCIpLCBcbiAgICAgICAgICAgICAgICBpLnB1c2godCk7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHJyLmtuKGEudGFyZ2V0SWQsIHQpO1xuICAgICAgICAgICAgICAgIHIucHVzaChlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpKTtcbiAgICB9KSksIGF3YWl0IFByb21pc2UuYWxsKG8pLCBzLk5vLlRyKGkpLCBhd2FpdCBhc3luYyBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBVKHQpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgbi5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIm5vdGlmeUxvY2FsVmlld0NoYW5nZXNcIiwgXCJyZWFkd3JpdGVcIiwgKHQgPT4gS3MuZm9yRWFjaChlLCAoZSA9PiBLcy5mb3JFYWNoKGUuTm4sIChzID0+IG4ucGVyc2lzdGVuY2UucmVmZXJlbmNlRGVsZWdhdGUuYWRkUmVmZXJlbmNlKHQsIGUudGFyZ2V0SWQsIHMpKSkubmV4dCgoKCkgPT4gS3MuZm9yRWFjaChlLnhuLCAocyA9PiBuLnBlcnNpc3RlbmNlLnJlZmVyZW5jZURlbGVnYXRlLnJlbW92ZVJlZmVyZW5jZSh0LCBlLnRhcmdldElkLCBzKSkpKSkpKSkpO1xuICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICBpZiAoIXpzKHQpKSB0aHJvdyB0O1xuICAgICAgICAgICAgLy8gSWYgYG5vdGlmeUxvY2FsVmlld0NoYW5nZXNgIGZhaWxzLCB3ZSBkaWQgbm90IGFkdmFuY2UgdGhlIHNlcXVlbmNlXG4gICAgICAgICAgICAvLyBudW1iZXIgZm9yIHRoZSBkb2N1bWVudHMgdGhhdCB3ZXJlIGluY2x1ZGVkIGluIHRoaXMgdHJhbnNhY3Rpb24uXG4gICAgICAgICAgICAvLyBUaGlzIG1pZ2h0IHRyaWdnZXIgdGhlbSB0byBiZSBkZWxldGVkIGVhcmxpZXIgdGhhbiB0aGV5IG90aGVyd2lzZVxuICAgICAgICAgICAgLy8gd291bGQgaGF2ZSwgYnV0IGl0IHNob3VsZCBub3QgaW52YWxpZGF0ZSB0aGUgaW50ZWdyaXR5IG9mIHRoZSBkYXRhLlxuICAgICAgICAgICAgayhcIkxvY2FsU3RvcmVcIiwgXCJGYWlsZWQgdG8gdXBkYXRlIHNlcXVlbmNlIG51bWJlcnM6IFwiICsgdCk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChjb25zdCB0IG9mIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0LnRhcmdldElkO1xuICAgICAgICAgICAgaWYgKCF0LmZyb21DYWNoZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBuLlVuLmdldChlKSwgcyA9IHQuc25hcHNob3RWZXJzaW9uLCBpID0gdC53aXRoTGFzdExpbWJvRnJlZVNuYXBzaG90VmVyc2lvbihzKTtcbiAgICAgICAgICAgICAgICAvLyBBZHZhbmNlIHRoZSBsYXN0IGxpbWJvIGZyZWUgc25hcHNob3QgdmVyc2lvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuLlVuID0gbi5Vbi5pbnNlcnQoZSwgaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KHMubG9jYWxTdG9yZSwgcikpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBwYSh0LCBlKSB7XG4gICAgY29uc3QgbiA9IFUodCk7XG4gICAgaWYgKCFuLmN1cnJlbnRVc2VyLmlzRXF1YWwoZSkpIHtcbiAgICAgICAgayhcIlN5bmNFbmdpbmVcIiwgXCJVc2VyIGNoYW5nZS4gTmV3IHVzZXI6XCIsIGUudG9LZXkoKSk7XG4gICAgICAgIGNvbnN0IHQgPSBhd2FpdCB1cihuLmxvY2FsU3RvcmUsIGUpO1xuICAgICAgICBuLmN1cnJlbnRVc2VyID0gZSwgXG4gICAgICAgIC8vIEZhaWxzIHRhc2tzIHdhaXRpbmcgZm9yIHBlbmRpbmcgd3JpdGVzIHJlcXVlc3RlZCBieSBwcmV2aW91cyB1c2VyLlxuICAgICAgICBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICB0LkJvLmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgICAgIHQuZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHQucmVqZWN0KG5ldyBLKHEuQ0FOQ0VMTEVELCBlKSk7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfSkpLCB0LkJvLmNsZWFyKCk7XG4gICAgICAgIH0obiwgXCInd2FpdEZvclBlbmRpbmdXcml0ZXMnIHByb21pc2UgaXMgcmVqZWN0ZWQgZHVlIHRvIGEgdXNlciBjaGFuZ2UuXCIpLCBcbiAgICAgICAgLy8gVE9ETyhiLzExNDIyNjQxNyk6IENvbnNpZGVyIGNhbGxpbmcgdGhpcyBvbmx5IGluIHRoZSBwcmltYXJ5IHRhYi5cbiAgICAgICAgbi5zaGFyZWRDbGllbnRTdGF0ZS5oYW5kbGVVc2VyQ2hhbmdlKGUsIHQucmVtb3ZlZEJhdGNoSWRzLCB0LmFkZGVkQmF0Y2hJZHMpLCBhd2FpdCB5YShuLCB0LlduKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIEVhKHQsIGUpIHtcbiAgICBjb25zdCBuID0gVSh0KSwgcyA9IG4uRm8uZ2V0KGUpO1xuICAgIGlmIChzICYmIHMuQ28pIHJldHVybiBQbigpLmFkZChzLmtleSk7XG4gICAge1xuICAgICAgICBsZXQgdCA9IFBuKCk7XG4gICAgICAgIGNvbnN0IHMgPSBuLmtvLmdldChlKTtcbiAgICAgICAgaWYgKCFzKSByZXR1cm4gdDtcbiAgICAgICAgZm9yIChjb25zdCBlIG9mIHMpIHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBuLnhvLmdldChlKTtcbiAgICAgICAgICAgIHQgPSB0LnVuaW9uV2l0aChzLnZpZXcuVG8pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0O1xuICAgIH1cbn1cblxuLyoqXG4gKiBSZWNvbmNpbGUgdGhlIGxpc3Qgb2Ygc3luY2VkIGRvY3VtZW50cyBpbiBhbiBleGlzdGluZyB2aWV3IHdpdGggdGhvc2VcbiAqIGZyb20gcGVyc2lzdGVuY2UuXG4gKi8gYXN5bmMgZnVuY3Rpb24gVGEodCwgZSkge1xuICAgIGNvbnN0IG4gPSBVKHQpLCBzID0gYXdhaXQgZ3Iobi5sb2NhbFN0b3JlLCBlLnF1ZXJ5LCBcbiAgICAvKiB1c2VQcmV2aW91c1Jlc3VsdHM9ICovICEwKSwgaSA9IGUudmlldy5TbyhzKTtcbiAgICByZXR1cm4gbi5pc1ByaW1hcnlDbGllbnQgJiYgX2EobiwgZS50YXJnZXRJZCwgaS52byksIGk7XG59XG5cbi8qKlxuICogUmV0cmlldmVzIG5ld2x5IGNoYW5nZWQgZG9jdW1lbnRzIGZyb20gcmVtb3RlIGRvY3VtZW50IGNhY2hlIGFuZCByYWlzZXNcbiAqIHNuYXBzaG90cyBpZiBuZWVkZWQuXG4gKi9cbi8vIFBPUlRJTkcgTk9URTogTXVsdGktVGFiIG9ubHkuXG5hc3luYyBmdW5jdGlvbiBJYSh0KSB7XG4gICAgY29uc3QgZSA9IFUodCk7XG4gICAgcmV0dXJuIHByKGUubG9jYWxTdG9yZSkudGhlbigodCA9PiB5YShlLCB0KSkpO1xufVxuXG4vKiogQXBwbGllcyBhIG11dGF0aW9uIHN0YXRlIHRvIGFuIGV4aXN0aW5nIGJhdGNoLiAgKi9cbi8vIFBPUlRJTkcgTk9URTogTXVsdGktVGFiIG9ubHkuXG5hc3luYyBmdW5jdGlvbiBBYSh0LCBlLCBuLCBzKSB7XG4gICAgY29uc3QgaSA9IFUodCksIHIgPSBhd2FpdCBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBVKHQpLCBzID0gVShuLkluKTtcbiAgICAgICAgcmV0dXJuIG4ucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJMb29rdXAgbXV0YXRpb24gZG9jdW1lbnRzXCIsIFwicmVhZG9ubHlcIiwgKHQgPT4gcy5YdCh0LCBlKS5uZXh0KChlID0+IGUgPyBuLlFuLmJuKHQsIGUpIDogS3MucmVzb2x2ZShudWxsKSkpKSk7XG4gICAgfVxuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktVGFiIG9ubHkuXG4gICAgKGkubG9jYWxTdG9yZSwgZSk7XG4gICAgbnVsbCAhPT0gciA/IChcInBlbmRpbmdcIiA9PT0gbiA/IFxuICAgIC8vIElmIHdlIGFyZSB0aGUgcHJpbWFyeSBjbGllbnQsIHdlIG5lZWQgdG8gc2VuZCB0aGlzIHdyaXRlIHRvIHRoZVxuICAgIC8vIGJhY2tlbmQuIFNlY29uZGFyeSBjbGllbnRzIHdpbGwgaWdub3JlIHRoZXNlIHdyaXRlcyBzaW5jZSB0aGVpciByZW1vdGVcbiAgICAvLyBjb25uZWN0aW9uIGlzIGRpc2FibGVkLlxuICAgIGF3YWl0IEVvKGkucmVtb3RlU3RvcmUpIDogXCJhY2tub3dsZWRnZWRcIiA9PT0gbiB8fCBcInJlamVjdGVkXCIgPT09IG4gPyAoXG4gICAgLy8gTk9URTogQm90aCB0aGVzZSBtZXRob2RzIGFyZSBuby1vcHMgZm9yIGJhdGNoZXMgdGhhdCBvcmlnaW5hdGVkIGZyb21cbiAgICAvLyBvdGhlciBjbGllbnRzLlxuICAgIGZhKGksIGUsIHMgfHwgbnVsbCksIGxhKGksIGUpLCBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIFUoVSh0KS5JbikudGUoZSk7XG4gICAgfVxuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktVGFiIG9ubHkuXG4gICAgKGkubG9jYWxTdG9yZSwgZSkpIDogTSgpLCBhd2FpdCB5YShpLCByKSkgOiBcbiAgICAvLyBBIHRocm90dGxlZCB0YWIgbWF5IG5vdCBoYXZlIHNlZW4gdGhlIG11dGF0aW9uIGJlZm9yZSBpdCB3YXMgY29tcGxldGVkXG4gICAgLy8gYW5kIHJlbW92ZWQgZnJvbSB0aGUgbXV0YXRpb24gcXVldWUsIGluIHdoaWNoIGNhc2Ugd2Ugd29uJ3QgaGF2ZSBjYWNoZWRcbiAgICAvLyB0aGUgYWZmZWN0ZWQgZG9jdW1lbnRzLiBJbiB0aGlzIGNhc2Ugd2UgY2FuIHNhZmVseSBpZ25vcmUgdGhlIHVwZGF0ZVxuICAgIC8vIHNpbmNlIHRoYXQgbWVhbnMgd2UgZGlkbid0IGFwcGx5IHRoZSBtdXRhdGlvbiBsb2NhbGx5IGF0IGFsbCAoaWYgd2VcbiAgICAvLyBoYWQsIHdlIHdvdWxkIGhhdmUgY2FjaGVkIHRoZSBhZmZlY3RlZCBkb2N1bWVudHMpLCBhbmQgc28gd2Ugd2lsbCBqdXN0XG4gICAgLy8gc2VlIGFueSByZXN1bHRpbmcgZG9jdW1lbnQgY2hhbmdlcyB2aWEgbm9ybWFsIHJlbW90ZSBkb2N1bWVudCB1cGRhdGVzXG4gICAgLy8gYXMgYXBwbGljYWJsZS5cbiAgICBrKFwiU3luY0VuZ2luZVwiLCBcIkNhbm5vdCBhcHBseSBtdXRhdGlvbiBiYXRjaCB3aXRoIGlkOiBcIiArIGUpO1xufVxuXG4vKiogQXBwbGllcyBhIHF1ZXJ5IHRhcmdldCBjaGFuZ2UgZnJvbSBhIGRpZmZlcmVudCB0YWIuICovXG4vLyBQT1JUSU5HIE5PVEU6IE11bHRpLVRhYiBvbmx5LlxuYXN5bmMgZnVuY3Rpb24gUmEodCwgZSkge1xuICAgIGNvbnN0IG4gPSBVKHQpO1xuICAgIGlmIChEYShuKSwgQ2EobiksICEwID09PSBlICYmICEwICE9PSBuLnFvKSB7XG4gICAgICAgIC8vIFNlY29uZGFyeSB0YWJzIG9ubHkgbWFpbnRhaW4gVmlld3MgZm9yIHRoZWlyIGxvY2FsIGxpc3RlbmVycyBhbmQgdGhlXG4gICAgICAgIC8vIFZpZXdzIGludGVybmFsIHN0YXRlIG1heSBub3QgYmUgMTAwJSBwb3B1bGF0ZWQgKGluIHBhcnRpY3VsYXJcbiAgICAgICAgLy8gc2Vjb25kYXJ5IHRhYnMgZG9uJ3QgdHJhY2sgc3luY2VkRG9jdW1lbnRzLCB0aGUgc2V0IG9mIGRvY3VtZW50cyB0aGVcbiAgICAgICAgLy8gc2VydmVyIGNvbnNpZGVycyB0byBiZSBpbiB0aGUgdGFyZ2V0KS4gU28gd2hlbiBhIHNlY29uZGFyeSBiZWNvbWVzXG4gICAgICAgIC8vIHByaW1hcnksIHdlIG5lZWQgdG8gbmVlZCB0byBtYWtlIHN1cmUgdGhhdCBhbGwgdmlld3MgZm9yIGFsbCB0YXJnZXRzXG4gICAgICAgIC8vIG1hdGNoIHRoZSBzdGF0ZSBvbiBkaXNrLlxuICAgICAgICBjb25zdCB0ID0gbi5zaGFyZWRDbGllbnRTdGF0ZS5nZXRBbGxBY3RpdmVRdWVyeVRhcmdldHMoKSwgZSA9IGF3YWl0IFBhKG4sIHQudG9BcnJheSgpKTtcbiAgICAgICAgbi5xbyA9ICEwLCBhd2FpdCBTbyhuLnJlbW90ZVN0b3JlLCAhMCk7XG4gICAgICAgIGZvciAoY29uc3QgdCBvZiBlKSBvbyhuLnJlbW90ZVN0b3JlLCB0KTtcbiAgICB9IGVsc2UgaWYgKCExID09PSBlICYmICExICE9PSBuLnFvKSB7XG4gICAgICAgIGNvbnN0IHQgPSBbXTtcbiAgICAgICAgbGV0IGUgPSBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgbi5rby5mb3JFYWNoKCgocywgaSkgPT4ge1xuICAgICAgICAgICAgbi5zaGFyZWRDbGllbnRTdGF0ZS5pc0xvY2FsUXVlcnlUYXJnZXQoaSkgPyB0LnB1c2goaSkgOiBlID0gZS50aGVuKCgoKSA9PiAoZGEobiwgaSksIFxuICAgICAgICAgICAgbXIobi5sb2NhbFN0b3JlLCBpLCBcbiAgICAgICAgICAgIC8qa2VlcFBlcnNpc3RlZFRhcmdldERhdGE9Ki8gITApKSkpLCBhbyhuLnJlbW90ZVN0b3JlLCBpKTtcbiAgICAgICAgfSkpLCBhd2FpdCBlLCBhd2FpdCBQYShuLCB0KSwgXG4gICAgICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktVGFiIG9ubHkuXG4gICAgICAgIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSBVKHQpO1xuICAgICAgICAgICAgZS5Gby5mb3JFYWNoKCgodCwgbikgPT4ge1xuICAgICAgICAgICAgICAgIGFvKGUucmVtb3RlU3RvcmUsIG4pO1xuICAgICAgICAgICAgfSkpLCBlLk1vLnVzKCksIGUuRm8gPSBuZXcgTWFwLCBlLk9vID0gbmV3IGRuKFB0LmNvbXBhcmF0b3IpO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICogUmVjb25jaWxlIHRoZSBxdWVyeSB2aWV3cyBvZiB0aGUgcHJvdmlkZWQgcXVlcnkgdGFyZ2V0cyB3aXRoIHRoZSBzdGF0ZSBmcm9tXG4gKiBwZXJzaXN0ZW5jZS4gUmFpc2VzIHNuYXBzaG90cyBmb3IgYW55IGNoYW5nZXMgdGhhdCBhZmZlY3QgdGhlIGxvY2FsXG4gKiBjbGllbnQgYW5kIHJldHVybnMgdGhlIHVwZGF0ZWQgc3RhdGUgb2YgYWxsIHRhcmdldCdzIHF1ZXJ5IGRhdGEuXG4gKlxuICogQHBhcmFtIHN5bmNFbmdpbmUgLSBUaGUgc3luYyBlbmdpbmUgaW1wbGVtZW50YXRpb25cbiAqIEBwYXJhbSB0YXJnZXRzIC0gdGhlIGxpc3Qgb2YgdGFyZ2V0cyB3aXRoIHZpZXdzIHRoYXQgbmVlZCB0byBiZSByZWNvbXB1dGVkXG4gKiBAcGFyYW0gdHJhbnNpdGlvblRvUHJpbWFyeSAtIGB0cnVlYCBpZmYgdGhlIHRhYiB0cmFuc2l0aW9ucyBmcm9tIGEgc2Vjb25kYXJ5XG4gKiB0YWIgdG8gYSBwcmltYXJ5IHRhYlxuICovXG4gICAgICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktVGFiIG9ubHkuXG4gICAgICAgIChuKSwgbi5xbyA9ICExLCBhd2FpdCBTbyhuLnJlbW90ZVN0b3JlLCAhMSk7XG4gICAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBQYSh0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9IFUodCksIGkgPSBbXSwgciA9IFtdO1xuICAgIGZvciAoY29uc3QgdCBvZiBlKSB7XG4gICAgICAgIGxldCBlO1xuICAgICAgICBjb25zdCBuID0gcy5rby5nZXQodCk7XG4gICAgICAgIGlmIChuICYmIDAgIT09IG4ubGVuZ3RoKSB7XG4gICAgICAgICAgICAvLyBGb3IgcXVlcmllcyB0aGF0IGhhdmUgYSBsb2NhbCBWaWV3LCB3ZSBmZXRjaCB0aGVpciBjdXJyZW50IHN0YXRlXG4gICAgICAgICAgICAvLyBmcm9tIExvY2FsU3RvcmUgKGFzIHRoZSByZXN1bWUgdG9rZW4gYW5kIHRoZSBzbmFwc2hvdCB2ZXJzaW9uXG4gICAgICAgICAgICAvLyBtaWdodCBoYXZlIGNoYW5nZWQpIGFuZCByZWNvbmNpbGUgdGhlaXIgdmlld3Mgd2l0aCB0aGUgcGVyc2lzdGVkXG4gICAgICAgICAgICAvLyBzdGF0ZSAodGhlIGxpc3Qgb2Ygc3luY2VkRG9jdW1lbnRzIG1heSBoYXZlIGdvdHRlbiBvdXQgb2Ygc3luYykuXG4gICAgICAgICAgICBlID0gYXdhaXQgX3Iocy5sb2NhbFN0b3JlLCBFZShuWzBdKSk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2Ygbikge1xuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBzLnhvLmdldCh0KSwgbiA9IGF3YWl0IFRhKHMsIGUpO1xuICAgICAgICAgICAgICAgIG4uc25hcHNob3QgJiYgci5wdXNoKG4uc25hcHNob3QpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gRm9yIHF1ZXJpZXMgdGhhdCBuZXZlciBleGVjdXRlZCBvbiB0aGlzIGNsaWVudCwgd2UgbmVlZCB0b1xuICAgICAgICAgICAgLy8gYWxsb2NhdGUgdGhlIHRhcmdldCBpbiBMb2NhbFN0b3JlIGFuZCBpbml0aWFsaXplIGEgbmV3IFZpZXcuXG4gICAgICAgICAgICBjb25zdCBuID0gYXdhaXQgeXIocy5sb2NhbFN0b3JlLCB0KTtcbiAgICAgICAgICAgIGUgPSBhd2FpdCBfcihzLmxvY2FsU3RvcmUsIG4pLCBhd2FpdCBuYShzLCBiYShuKSwgdCwgXG4gICAgICAgICAgICAvKmN1cnJlbnQ9Ki8gITEpO1xuICAgICAgICB9XG4gICAgICAgIGkucHVzaChlKTtcbiAgICB9XG4gICAgcmV0dXJuIHMuTm8uVHIociksIGk7XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIGBRdWVyeWAgb2JqZWN0IGZyb20gdGhlIHNwZWNpZmllZCBgVGFyZ2V0YC4gVGhlcmUgaXMgbm8gd2F5IHRvXG4gKiBvYnRhaW4gdGhlIG9yaWdpbmFsIGBRdWVyeWAsIHNvIHdlIHN5bnRoZXNpemUgYSBgUXVlcnlgIGZyb20gdGhlIGBUYXJnZXRgXG4gKiBvYmplY3QuXG4gKlxuICogVGhlIHN5bnRoZXNpemVkIHJlc3VsdCBtaWdodCBiZSBkaWZmZXJlbnQgZnJvbSB0aGUgb3JpZ2luYWwgYFF1ZXJ5YCwgYnV0XG4gKiBzaW5jZSB0aGUgc3ludGhlc2l6ZWQgYFF1ZXJ5YCBzaG91bGQgcmV0dXJuIHRoZSBzYW1lIHJlc3VsdHMgYXMgdGhlXG4gKiBvcmlnaW5hbCBvbmUgKG9ubHkgdGhlIHByZXNlbnRhdGlvbiBvZiByZXN1bHRzIG1pZ2h0IGRpZmZlciksIHRoZSBwb3RlbnRpYWxcbiAqIGRpZmZlcmVuY2Ugd2lsbCBub3QgY2F1c2UgaXNzdWVzLlxuICovXG4vLyBQT1JUSU5HIE5PVEU6IE11bHRpLVRhYiBvbmx5LlxuZnVuY3Rpb24gYmEodCkge1xuICAgIHJldHVybiBmZSh0LnBhdGgsIHQuY29sbGVjdGlvbkdyb3VwLCB0Lm9yZGVyQnksIHQuZmlsdGVycywgdC5saW1pdCwgXCJGXCIgLyogRmlyc3QgKi8gLCB0LnN0YXJ0QXQsIHQuZW5kQXQpO1xufVxuXG4vKiogUmV0dXJucyB0aGUgSURzIG9mIHRoZSBjbGllbnRzIHRoYXQgYXJlIGN1cnJlbnRseSBhY3RpdmUuICovXG4vLyBQT1JUSU5HIE5PVEU6IE11bHRpLVRhYiBvbmx5LlxuZnVuY3Rpb24gdmEodCkge1xuICAgIGNvbnN0IGUgPSBVKHQpO1xuICAgIHJldHVybiBVKFUoZS5sb2NhbFN0b3JlKS5wZXJzaXN0ZW5jZSkucG4oKTtcbn1cblxuLyoqIEFwcGxpZXMgYSBxdWVyeSB0YXJnZXQgY2hhbmdlIGZyb20gYSBkaWZmZXJlbnQgdGFiLiAqL1xuLy8gUE9SVElORyBOT1RFOiBNdWx0aS1UYWIgb25seS5cbmFzeW5jIGZ1bmN0aW9uIFZhKHQsIGUsIG4sIHMpIHtcbiAgICBjb25zdCBpID0gVSh0KTtcbiAgICBpZiAoaS5xbykgXG4gICAgLy8gSWYgd2UgcmVjZWl2ZSBhIHRhcmdldCBzdGF0ZSBub3RpZmljYXRpb24gdmlhIFdlYlN0b3JhZ2UsIHdlIGFyZVxuICAgIC8vIGVpdGhlciBhbHJlYWR5IHNlY29uZGFyeSBvciBhbm90aGVyIHRhYiBoYXMgdGFrZW4gdGhlIHByaW1hcnkgbGVhc2UuXG4gICAgayhcIlN5bmNFbmdpbmVcIiwgXCJJZ25vcmluZyB1bmV4cGVjdGVkIHF1ZXJ5IHN0YXRlIG5vdGlmaWNhdGlvbi5cIik7IGVsc2UgaWYgKGkua28uaGFzKGUpKSBzd2l0Y2ggKG4pIHtcbiAgICAgIGNhc2UgXCJjdXJyZW50XCI6XG4gICAgICBjYXNlIFwibm90LWN1cnJlbnRcIjpcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgdCA9IGF3YWl0IHByKGkubG9jYWxTdG9yZSksIHMgPSBWbi5jcmVhdGVTeW50aGVzaXplZFJlbW90ZUV2ZW50Rm9yQ3VycmVudENoYW5nZShlLCBcImN1cnJlbnRcIiA9PT0gbik7XG4gICAgICAgICAgICBhd2FpdCB5YShpLCB0LCBzKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgIGNhc2UgXCJyZWplY3RlZFwiOlxuICAgICAgICBhd2FpdCBtcihpLmxvY2FsU3RvcmUsIGUsIFxuICAgICAgICAvKiBrZWVwUGVyc2lzdGVkVGFyZ2V0RGF0YSAqLyAhMCksIGRhKGksIGUsIHMpO1xuICAgICAgICBicmVhaztcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgTSgpO1xuICAgIH1cbn1cblxuLyoqIEFkZHMgb3IgcmVtb3ZlcyBXYXRjaCB0YXJnZXRzIGZvciBxdWVyaWVzIGZyb20gZGlmZmVyZW50IHRhYnMuICovIGFzeW5jIGZ1bmN0aW9uIFNhKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gRGEodCk7XG4gICAgaWYgKHMucW8pIHtcbiAgICAgICAgZm9yIChjb25zdCB0IG9mIGUpIHtcbiAgICAgICAgICAgIGlmIChzLmtvLmhhcyh0KSkge1xuICAgICAgICAgICAgICAgIC8vIEEgdGFyZ2V0IG1pZ2h0IGhhdmUgYmVlbiBhZGRlZCBpbiBhIHByZXZpb3VzIGF0dGVtcHRcbiAgICAgICAgICAgICAgICBrKFwiU3luY0VuZ2luZVwiLCBcIkFkZGluZyBhbiBhbHJlYWR5IGFjdGl2ZSB0YXJnZXQgXCIgKyB0KTtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGUgPSBhd2FpdCB5cihzLmxvY2FsU3RvcmUsIHQpLCBuID0gYXdhaXQgX3Iocy5sb2NhbFN0b3JlLCBlKTtcbiAgICAgICAgICAgIGF3YWl0IG5hKHMsIGJhKGUpLCBuLnRhcmdldElkLCBcbiAgICAgICAgICAgIC8qY3VycmVudD0qLyAhMSksIG9vKHMucmVtb3RlU3RvcmUsIG4pO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgdCBvZiBuKSBcbiAgICAgICAgLy8gQ2hlY2sgdGhhdCB0aGUgdGFyZ2V0IGlzIHN0aWxsIGFjdGl2ZSBzaW5jZSB0aGUgdGFyZ2V0IG1pZ2h0IGhhdmUgYmVlblxuICAgICAgICAvLyByZW1vdmVkIGlmIGl0IGhhcyBiZWVuIHJlamVjdGVkIGJ5IHRoZSBiYWNrZW5kLlxuICAgICAgICBzLmtvLmhhcyh0KSAmJiBcbiAgICAgICAgLy8gUmVsZWFzZSBxdWVyaWVzIHRoYXQgYXJlIHN0aWxsIGFjdGl2ZS5cbiAgICAgICAgYXdhaXQgbXIocy5sb2NhbFN0b3JlLCB0LCBcbiAgICAgICAgLyoga2VlcFBlcnNpc3RlZFRhcmdldERhdGEgKi8gITEpLnRoZW4oKCgpID0+IHtcbiAgICAgICAgICAgIGFvKHMucmVtb3RlU3RvcmUsIHQpLCBkYShzLCB0KTtcbiAgICAgICAgfSkpLmNhdGNoKE9pKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIERhKHQpIHtcbiAgICBjb25zdCBlID0gVSh0KTtcbiAgICByZXR1cm4gZS5yZW1vdGVTdG9yZS5yZW1vdGVTeW5jZXIuYXBwbHlSZW1vdGVFdmVudCA9IHJhLmJpbmQobnVsbCwgZSksIGUucmVtb3RlU3RvcmUucmVtb3RlU3luY2VyLmdldFJlbW90ZUtleXNGb3JUYXJnZXQgPSBFYS5iaW5kKG51bGwsIGUpLCBcbiAgICBlLnJlbW90ZVN0b3JlLnJlbW90ZVN5bmNlci5yZWplY3RMaXN0ZW4gPSBhYS5iaW5kKG51bGwsIGUpLCBlLk5vLlRyID0gVW8uYmluZChudWxsLCBlLmV2ZW50TWFuYWdlciksIFxuICAgIGUuTm8uam8gPSBxby5iaW5kKG51bGwsIGUuZXZlbnRNYW5hZ2VyKSwgZTtcbn1cblxuZnVuY3Rpb24gQ2EodCkge1xuICAgIGNvbnN0IGUgPSBVKHQpO1xuICAgIHJldHVybiBlLnJlbW90ZVN0b3JlLnJlbW90ZVN5bmNlci5hcHBseVN1Y2Nlc3NmdWxXcml0ZSA9IGNhLmJpbmQobnVsbCwgZSksIGUucmVtb3RlU3RvcmUucmVtb3RlU3luY2VyLnJlamVjdEZhaWxlZFdyaXRlID0gdWEuYmluZChudWxsLCBlKSwgXG4gICAgZTtcbn1cblxuLyoqXG4gKiBMb2FkcyBhIEZpcmVzdG9yZSBidW5kbGUgaW50byB0aGUgU0RLLiBUaGUgcmV0dXJuZWQgcHJvbWlzZSByZXNvbHZlcyB3aGVuXG4gKiB0aGUgYnVuZGxlIGZpbmlzaGVkIGxvYWRpbmcuXG4gKlxuICogQHBhcmFtIHN5bmNFbmdpbmUgLSBTeW5jRW5naW5lIHRvIHVzZS5cbiAqIEBwYXJhbSBidW5kbGVSZWFkZXIgLSBCdW5kbGUgdG8gbG9hZCBpbnRvIHRoZSBTREsuXG4gKiBAcGFyYW0gdGFzayAtIExvYWRCdW5kbGVUYXNrIHVzZWQgdG8gdXBkYXRlIHRoZSBsb2FkaW5nIHByb2dyZXNzIHRvIHB1YmxpYyBBUEkuXG4gKi8gZnVuY3Rpb24gTmEodCwgZSwgbikge1xuICAgIGNvbnN0IHMgPSBVKHQpO1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZmxvYXRpbmctcHJvbWlzZXNcbiAgICAgICAgKGFzeW5jIGZ1bmN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBhd2FpdCBlLmdldE1ldGFkYXRhKCk7XG4gICAgICAgICAgICBpZiAoYXdhaXQgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBVKHQpLCBzID0gS24oZS5jcmVhdGVUaW1lKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbi5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcImhhc05ld2VyQnVuZGxlXCIsIFwicmVhZG9ubHlcIiwgKHQgPT4gbi5KZS5nZXRCdW5kbGVNZXRhZGF0YSh0LCBlLmlkKSkpLnRoZW4oKHQgPT4gISF0ICYmIHQuY3JlYXRlVGltZS5jb21wYXJlVG8ocykgPj0gMCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyoqXG4gKiBTYXZlcyB0aGUgZ2l2ZW4gYEJ1bmRsZU1ldGFkYXRhYCB0byBsb2NhbCBwZXJzaXN0ZW5jZS5cbiAqLyAodC5sb2NhbFN0b3JlLCBzKSkgcmV0dXJuIGF3YWl0IGUuY2xvc2UoKSwgdm9pZCBuLl9jb21wbGV0ZVdpdGgoZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHRhc2tTdGF0ZTogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50c0xvYWRlZDogdC50b3RhbERvY3VtZW50cyxcbiAgICAgICAgICAgICAgICAgICAgYnl0ZXNMb2FkZWQ6IHQudG90YWxCeXRlcyxcbiAgICAgICAgICAgICAgICAgICAgdG90YWxEb2N1bWVudHM6IHQudG90YWxEb2N1bWVudHMsXG4gICAgICAgICAgICAgICAgICAgIHRvdGFsQnl0ZXM6IHQudG90YWxCeXRlc1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KHMpKTtcbiAgICAgICAgICAgIG4uX3VwZGF0ZVByb2dyZXNzKHpvKHMpKTtcbiAgICAgICAgICAgIGNvbnN0IGkgPSBuZXcgR28ocywgdC5sb2NhbFN0b3JlLCBlLk4pO1xuICAgICAgICAgICAgbGV0IHIgPSBhd2FpdCBlLlFvKCk7XG4gICAgICAgICAgICBmb3IgKDtyOyApIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gYXdhaXQgaS5mbyhyKTtcbiAgICAgICAgICAgICAgICB0ICYmIG4uX3VwZGF0ZVByb2dyZXNzKHQpLCByID0gYXdhaXQgZS5RbygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgbyA9IGF3YWl0IGkuY29tcGxldGUoKTtcbiAgICAgICAgICAgIC8vIFRPRE8oYi8xNjA4NzY0NDMpOiBUaGlzIGN1cnJlbnRseSByYWlzZXMgc25hcHNob3RzIHdpdGhcbiAgICAgICAgICAgIC8vIGBmcm9tQ2FjaGU9ZmFsc2VgIGlmIHVzZXJzIGFscmVhZHkgbGlzdGVuIHRvIHNvbWUgcXVlcmllcyBhbmQgYnVuZGxlc1xuICAgICAgICAgICAgLy8gaGFzIG5ld2VyIHZlcnNpb24uXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB5YSh0LCBvLlRuLCBcbiAgICAgICAgICAgIC8qIHJlbW90ZUV2ZW50ICovIHZvaWQgMCksIFxuICAgICAgICAgICAgLy8gU2F2ZSBtZXRhZGF0YSwgc28gbG9hZGluZyB0aGUgc2FtZSBidW5kbGUgd2lsbCBza2lwLlxuICAgICAgICAgICAgYXdhaXQgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBVKHQpO1xuICAgICAgICAgICAgICAgIHJldHVybiBuLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiU2F2ZSBidW5kbGVcIiwgXCJyZWFkd3JpdGVcIiwgKHQgPT4gbi5KZS5zYXZlQnVuZGxlTWV0YWRhdGEodCwgZSkpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qKlxuICogUmV0dXJucyBhIHByb21pc2Ugb2YgYSBgTmFtZWRRdWVyeWAgYXNzb2NpYXRlZCB3aXRoIGdpdmVuIHF1ZXJ5IG5hbWUuIFByb21pc2VcbiAqIHJlc29sdmVzIHRvIHVuZGVmaW5lZCBpZiBubyBwZXJzaXN0ZWQgZGF0YSBjYW4gYmUgZm91bmQuXG4gKi8gKHQubG9jYWxTdG9yZSwgcyksIG4uX2NvbXBsZXRlV2l0aChvLnByb2dyZXNzKTtcbiAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgTyhcIlN5bmNFbmdpbmVcIiwgYExvYWRpbmcgYnVuZGxlIGZhaWxlZCB3aXRoICR7dH1gKSwgbi5fZmFpbFdpdGgodCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbiAgICAvKipcbiAqIFByb3ZpZGVzIGFsbCBjb21wb25lbnRzIG5lZWRlZCBmb3IgRmlyZXN0b3JlIHdpdGggaW4tbWVtb3J5IHBlcnNpc3RlbmNlLlxuICogVXNlcyBFYWdlckdDIGdhcmJhZ2UgY29sbGVjdGlvbi5cbiAqLykocywgZSwgbikudGhlbigoKCkgPT4ge1xuICAgICAgICBzLnNoYXJlZENsaWVudFN0YXRlLm5vdGlmeUJ1bmRsZUxvYWRlZCgpO1xuICAgIH0pKTtcbn1cblxuY2xhc3MgeGEge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnN5bmNocm9uaXplVGFicyA9ICExO1xuICAgIH1cbiAgICBhc3luYyBpbml0aWFsaXplKHQpIHtcbiAgICAgICAgdGhpcy5OID0gSnIodC5kYXRhYmFzZUluZm8uZGF0YWJhc2VJZCksIHRoaXMuc2hhcmVkQ2xpZW50U3RhdGUgPSB0aGlzLldvKHQpLCB0aGlzLnBlcnNpc3RlbmNlID0gdGhpcy5Hbyh0KSwgXG4gICAgICAgIGF3YWl0IHRoaXMucGVyc2lzdGVuY2Uuc3RhcnQoKSwgdGhpcy5nY1NjaGVkdWxlciA9IHRoaXMuem8odCksIHRoaXMubG9jYWxTdG9yZSA9IHRoaXMuSG8odCk7XG4gICAgfVxuICAgIHpvKHQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIEhvKHQpIHtcbiAgICAgICAgcmV0dXJuIGNyKHRoaXMucGVyc2lzdGVuY2UsIG5ldyBvciwgdC5pbml0aWFsVXNlciwgdGhpcy5OKTtcbiAgICB9XG4gICAgR28odCkge1xuICAgICAgICByZXR1cm4gbmV3IERyKE5yLk5zLCB0aGlzLk4pO1xuICAgIH1cbiAgICBXbyh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgcXI7XG4gICAgfVxuICAgIGFzeW5jIHRlcm1pbmF0ZSgpIHtcbiAgICAgICAgdGhpcy5nY1NjaGVkdWxlciAmJiB0aGlzLmdjU2NoZWR1bGVyLnN0b3AoKSwgYXdhaXQgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZS5zaHV0ZG93bigpLCBcbiAgICAgICAgYXdhaXQgdGhpcy5wZXJzaXN0ZW5jZS5zaHV0ZG93bigpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBQcm92aWRlcyBhbGwgY29tcG9uZW50cyBuZWVkZWQgZm9yIEZpcmVzdG9yZSB3aXRoIEluZGV4ZWREQiBwZXJzaXN0ZW5jZS5cbiAqLyBjbGFzcyBrYSBleHRlbmRzIHhhIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMuSm8gPSB0LCB0aGlzLmNhY2hlU2l6ZUJ5dGVzID0gZSwgdGhpcy5mb3JjZU93bmVyc2hpcCA9IG4sIHRoaXMuc3luY2hyb25pemVUYWJzID0gITE7XG4gICAgfVxuICAgIGFzeW5jIGluaXRpYWxpemUodCkge1xuICAgICAgICBhd2FpdCBzdXBlci5pbml0aWFsaXplKHQpLCBhd2FpdCBFcih0aGlzLmxvY2FsU3RvcmUpLCBhd2FpdCB0aGlzLkpvLmluaXRpYWxpemUodGhpcywgdCksIFxuICAgICAgICAvLyBFbnF1ZXVlIHdyaXRlcyBmcm9tIGEgcHJldmlvdXMgc2Vzc2lvblxuICAgICAgICBhd2FpdCBDYSh0aGlzLkpvLnN5bmNFbmdpbmUpLCBhd2FpdCBFbyh0aGlzLkpvLnJlbW90ZVN0b3JlKSwgXG4gICAgICAgIC8vIE5PVEU6IFRoaXMgd2lsbCBpbW1lZGlhdGVseSBjYWxsIHRoZSBsaXN0ZW5lciwgc28gd2UgbWFrZSBzdXJlIHRvXG4gICAgICAgIC8vIHNldCBpdCBhZnRlciBsb2NhbFN0b3JlIC8gcmVtb3RlU3RvcmUgYXJlIHN0YXJ0ZWQuXG4gICAgICAgIGF3YWl0IHRoaXMucGVyc2lzdGVuY2Uubm4oKCgpID0+ICh0aGlzLmdjU2NoZWR1bGVyICYmICF0aGlzLmdjU2NoZWR1bGVyLnN0YXJ0ZWQgJiYgdGhpcy5nY1NjaGVkdWxlci5zdGFydCh0aGlzLmxvY2FsU3RvcmUpLCBcbiAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkpKSk7XG4gICAgfVxuICAgIEhvKHQpIHtcbiAgICAgICAgcmV0dXJuIGNyKHRoaXMucGVyc2lzdGVuY2UsIG5ldyBvciwgdC5pbml0aWFsVXNlciwgdGhpcy5OKTtcbiAgICB9XG4gICAgem8odCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5wZXJzaXN0ZW5jZS5yZWZlcmVuY2VEZWxlZ2F0ZS5nYXJiYWdlQ29sbGVjdG9yO1xuICAgICAgICByZXR1cm4gbmV3IExpKGUsIHQuYXN5bmNRdWV1ZSk7XG4gICAgfVxuICAgIEdvKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IG5yKHQuZGF0YWJhc2VJbmZvLmRhdGFiYXNlSWQsIHQuZGF0YWJhc2VJbmZvLnBlcnNpc3RlbmNlS2V5KSwgbiA9IHZvaWQgMCAhPT0gdGhpcy5jYWNoZVNpemVCeXRlcyA/IEFpLndpdGhDYWNoZVNpemUodGhpcy5jYWNoZVNpemVCeXRlcykgOiBBaS5ERUZBVUxUO1xuICAgICAgICByZXR1cm4gbmV3IFppKHRoaXMuc3luY2hyb25pemVUYWJzLCBlLCB0LmNsaWVudElkLCBuLCB0LmFzeW5jUXVldWUsIHpyKCksIEhyKCksIHRoaXMuTiwgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZSwgISF0aGlzLmZvcmNlT3duZXJzaGlwKTtcbiAgICB9XG4gICAgV28odCkge1xuICAgICAgICByZXR1cm4gbmV3IHFyO1xuICAgIH1cbn1cblxuLyoqXG4gKiBQcm92aWRlcyBhbGwgY29tcG9uZW50cyBuZWVkZWQgZm9yIEZpcmVzdG9yZSB3aXRoIG11bHRpLXRhYiBJbmRleGVkREJcbiAqIHBlcnNpc3RlbmNlLlxuICpcbiAqIEluIHRoZSBsZWdhY3kgY2xpZW50LCB0aGlzIHByb3ZpZGVyIGlzIHVzZWQgdG8gcHJvdmlkZSBib3RoIG11bHRpLXRhYiBhbmRcbiAqIG5vbi1tdWx0aS10YWIgcGVyc2lzdGVuY2Ugc2luY2Ugd2UgY2Fubm90IHRlbGwgYXQgYnVpbGQgdGltZSB3aGV0aGVyXG4gKiBgc3luY2hyb25pemVUYWJzYCB3aWxsIGJlIGVuYWJsZWQuXG4gKi8gY2xhc3MgJGEgZXh0ZW5kcyBrYSB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICBzdXBlcih0LCBlLCAvKiBmb3JjZU93bmVyc2hpcD0gKi8gITEpLCB0aGlzLkpvID0gdCwgdGhpcy5jYWNoZVNpemVCeXRlcyA9IGUsIHRoaXMuc3luY2hyb25pemVUYWJzID0gITA7XG4gICAgfVxuICAgIGFzeW5jIGluaXRpYWxpemUodCkge1xuICAgICAgICBhd2FpdCBzdXBlci5pbml0aWFsaXplKHQpO1xuICAgICAgICBjb25zdCBlID0gdGhpcy5Kby5zeW5jRW5naW5lO1xuICAgICAgICB0aGlzLnNoYXJlZENsaWVudFN0YXRlIGluc3RhbmNlb2YgVXIgJiYgKHRoaXMuc2hhcmVkQ2xpZW50U3RhdGUuc3luY0VuZ2luZSA9IHtcbiAgICAgICAgICAgIF9pOiBBYS5iaW5kKG51bGwsIGUpLFxuICAgICAgICAgICAgbWk6IFZhLmJpbmQobnVsbCwgZSksXG4gICAgICAgICAgICBnaTogU2EuYmluZChudWxsLCBlKSxcbiAgICAgICAgICAgIHBuOiB2YS5iaW5kKG51bGwsIGUpLFxuICAgICAgICAgICAgd2k6IElhLmJpbmQobnVsbCwgZSlcbiAgICAgICAgfSwgYXdhaXQgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZS5zdGFydCgpKSwgXG4gICAgICAgIC8vIE5PVEU6IFRoaXMgd2lsbCBpbW1lZGlhdGVseSBjYWxsIHRoZSBsaXN0ZW5lciwgc28gd2UgbWFrZSBzdXJlIHRvXG4gICAgICAgIC8vIHNldCBpdCBhZnRlciBsb2NhbFN0b3JlIC8gcmVtb3RlU3RvcmUgYXJlIHN0YXJ0ZWQuXG4gICAgICAgIGF3YWl0IHRoaXMucGVyc2lzdGVuY2Uubm4oKGFzeW5jIHQgPT4ge1xuICAgICAgICAgICAgYXdhaXQgUmEodGhpcy5Kby5zeW5jRW5naW5lLCB0KSwgdGhpcy5nY1NjaGVkdWxlciAmJiAodCAmJiAhdGhpcy5nY1NjaGVkdWxlci5zdGFydGVkID8gdGhpcy5nY1NjaGVkdWxlci5zdGFydCh0aGlzLmxvY2FsU3RvcmUpIDogdCB8fCB0aGlzLmdjU2NoZWR1bGVyLnN0b3AoKSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgV28odCkge1xuICAgICAgICBjb25zdCBlID0genIoKTtcbiAgICAgICAgaWYgKCFVci5QdChlKSkgdGhyb3cgbmV3IEsocS5VTklNUExFTUVOVEVELCBcIkluZGV4ZWREQiBwZXJzaXN0ZW5jZSBpcyBvbmx5IGF2YWlsYWJsZSBvbiBwbGF0Zm9ybXMgdGhhdCBzdXBwb3J0IExvY2FsU3RvcmFnZS5cIik7XG4gICAgICAgIGNvbnN0IG4gPSBucih0LmRhdGFiYXNlSW5mby5kYXRhYmFzZUlkLCB0LmRhdGFiYXNlSW5mby5wZXJzaXN0ZW5jZUtleSk7XG4gICAgICAgIHJldHVybiBuZXcgVXIoZSwgdC5hc3luY1F1ZXVlLCBuLCB0LmNsaWVudElkLCB0LmluaXRpYWxVc2VyKTtcbiAgICB9XG59XG5cbi8qKlxuICogSW5pdGlhbGl6ZXMgYW5kIHdpcmVzIHRoZSBjb21wb25lbnRzIHRoYXQgYXJlIG5lZWRlZCB0byBpbnRlcmZhY2Ugd2l0aCB0aGVcbiAqIG5ldHdvcmsuXG4gKi8gY2xhc3MgT2Ege1xuICAgIGFzeW5jIGluaXRpYWxpemUodCwgZSkge1xuICAgICAgICB0aGlzLmxvY2FsU3RvcmUgfHwgKHRoaXMubG9jYWxTdG9yZSA9IHQubG9jYWxTdG9yZSwgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZSA9IHQuc2hhcmVkQ2xpZW50U3RhdGUsIFxuICAgICAgICB0aGlzLmRhdGFzdG9yZSA9IHRoaXMuY3JlYXRlRGF0YXN0b3JlKGUpLCB0aGlzLnJlbW90ZVN0b3JlID0gdGhpcy5jcmVhdGVSZW1vdGVTdG9yZShlKSwgXG4gICAgICAgIHRoaXMuZXZlbnRNYW5hZ2VyID0gdGhpcy5jcmVhdGVFdmVudE1hbmFnZXIoZSksIHRoaXMuc3luY0VuZ2luZSA9IHRoaXMuY3JlYXRlU3luY0VuZ2luZShlLCBcbiAgICAgICAgLyogc3RhcnRBc1ByaW1hcnk9Ki8gIXQuc3luY2hyb25pemVUYWJzKSwgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZS5vbmxpbmVTdGF0ZUhhbmRsZXIgPSB0ID0+IG9hKHRoaXMuc3luY0VuZ2luZSwgdCwgMSAvKiBTaGFyZWRDbGllbnRTdGF0ZSAqLyksIFxuICAgICAgICB0aGlzLnJlbW90ZVN0b3JlLnJlbW90ZVN5bmNlci5oYW5kbGVDcmVkZW50aWFsQ2hhbmdlID0gcGEuYmluZChudWxsLCB0aGlzLnN5bmNFbmdpbmUpLCBcbiAgICAgICAgYXdhaXQgU28odGhpcy5yZW1vdGVTdG9yZSwgdGhpcy5zeW5jRW5naW5lLmlzUHJpbWFyeUNsaWVudCkpO1xuICAgIH1cbiAgICBjcmVhdGVFdmVudE1hbmFnZXIodCkge1xuICAgICAgICByZXR1cm4gbmV3IE1vO1xuICAgIH1cbiAgICBjcmVhdGVEYXRhc3RvcmUodCkge1xuICAgICAgICBjb25zdCBlID0gSnIodC5kYXRhYmFzZUluZm8uZGF0YWJhc2VJZCksIG4gPSAocyA9IHQuZGF0YWJhc2VJbmZvLCBuZXcgR3IocykpO1xuICAgICAgICB2YXIgcztcbiAgICAgICAgLyoqIFJldHVybiB0aGUgUGxhdGZvcm0tc3BlY2lmaWMgY29ubmVjdGl2aXR5IG1vbml0b3IuICovICAgICAgICByZXR1cm4gZnVuY3Rpb24odCwgZSwgbikge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBlbyh0LCBlLCBuKTtcbiAgICAgICAgfSh0LmNyZWRlbnRpYWxzLCBuLCBlKTtcbiAgICB9XG4gICAgY3JlYXRlUmVtb3RlU3RvcmUodCkge1xuICAgICAgICByZXR1cm4gZSA9IHRoaXMubG9jYWxTdG9yZSwgbiA9IHRoaXMuZGF0YXN0b3JlLCBzID0gdC5hc3luY1F1ZXVlLCBpID0gdCA9PiBvYSh0aGlzLnN5bmNFbmdpbmUsIHQsIDAgLyogUmVtb3RlU3RvcmUgKi8pLCBcbiAgICAgICAgciA9IGpyLlB0KCkgPyBuZXcganIgOiBuZXcgS3IsIG5ldyBzbyhlLCBuLCBzLCBpLCByKTtcbiAgICAgICAgdmFyIGUsIG4sIHMsIGksIHI7XG4gICAgICAgIC8qKiBSZS1lbmFibGVzIHRoZSBuZXR3b3JrLiBJZGVtcG90ZW50LiAqLyAgICB9XG4gICAgY3JlYXRlU3luY0VuZ2luZSh0LCBlKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0LCBlLCBuLCBcbiAgICAgICAgLy8gUE9SVElORyBOT1RFOiBNYW5hZ2VzIHN0YXRlIHN5bmNocm9uaXphdGlvbiBpbiBtdWx0aS10YWIgZW52aXJvbm1lbnRzLlxuICAgICAgICBzLCBpLCByLCBvKSB7XG4gICAgICAgICAgICBjb25zdCBhID0gbmV3IHRhKHQsIGUsIG4sIHMsIGksIHIpO1xuICAgICAgICAgICAgcmV0dXJuIG8gJiYgKGEucW8gPSAhMCksIGE7XG4gICAgICAgIH0odGhpcy5sb2NhbFN0b3JlLCB0aGlzLnJlbW90ZVN0b3JlLCB0aGlzLmV2ZW50TWFuYWdlciwgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZSwgdC5pbml0aWFsVXNlciwgdC5tYXhDb25jdXJyZW50TGltYm9SZXNvbHV0aW9ucywgZSk7XG4gICAgfVxuICAgIHRlcm1pbmF0ZSgpIHtcbiAgICAgICAgcmV0dXJuIGFzeW5jIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSBVKHQpO1xuICAgICAgICAgICAgayhcIlJlbW90ZVN0b3JlXCIsIFwiUmVtb3RlU3RvcmUgc2h1dHRpbmcgZG93bi5cIiksIGUuS3IuYWRkKDUgLyogU2h1dGRvd24gKi8pLCBhd2FpdCBybyhlKSwgXG4gICAgICAgICAgICBlLlFyLnNodXRkb3duKCksIFxuICAgICAgICAgICAgLy8gU2V0IHRoZSBPbmxpbmVTdGF0ZSB0byBVbmtub3duIChyYXRoZXIgdGhhbiBPZmZsaW5lKSB0byBhdm9pZCBwb3RlbnRpYWxseVxuICAgICAgICAgICAgLy8gdHJpZ2dlcmluZyBzcHVyaW91cyBsaXN0ZW5lciBldmVudHMgd2l0aCBjYWNoZWQgZGF0YSwgZXRjLlxuICAgICAgICAgICAgZS5Xci5zZXQoXCJVbmtub3duXCIgLyogVW5rbm93biAqLyk7XG4gICAgICAgIH0odGhpcy5yZW1vdGVTdG9yZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBIb3cgbWFueSBieXRlcyB0byByZWFkIGVhY2ggdGltZSB3aGVuIGBSZWFkYWJsZVN0cmVhbVJlYWRlci5yZWFkKClgIGlzXG4gKiBjYWxsZWQuIE9ubHkgYXBwbGljYWJsZSBmb3IgYnl0ZSBzdHJlYW1zIHRoYXQgd2UgY29udHJvbCAoZS5nLiB0aG9zZSBiYWNrZWRcbiAqIGJ5IGFuIFVJbnQ4QXJyYXkpLlxuICovXG4vKipcbiAqIEJ1aWxkcyBhIGBCeXRlU3RyZWFtUmVhZGVyYCBmcm9tIGEgVUludDhBcnJheS5cbiAqIEBwYXJhbSBzb3VyY2UgLSBUaGUgZGF0YSBzb3VyY2UgdG8gdXNlLlxuICogQHBhcmFtIGJ5dGVzUGVyUmVhZCAtIEhvdyBtYW55IGJ5dGVzIGVhY2ggYHJlYWQoKWAgZnJvbSB0aGUgcmV0dXJuZWQgcmVhZGVyXG4gKiAgICAgICAgd2lsbCByZWFkLlxuICovXG5mdW5jdGlvbiBGYSh0LCBlID0gMTAyNDApIHtcbiAgICBsZXQgbiA9IDA7XG4gICAgLy8gVGhlIFR5cGVTY3JpcHQgZGVmaW5pdGlvbiBmb3IgUmVhZGFibGVTdHJlYW1SZWFkZXIgY2hhbmdlZC4gV2UgdXNlXG4gICAgLy8gYGFueWAgaGVyZSB0byBhbGxvdyB0aGlzIGNvZGUgdG8gY29tcGlsZSB3aXRoIGRpZmZlcmVudCB2ZXJzaW9ucy5cbiAgICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL21pY3Jvc29mdC9UeXBlU2NyaXB0L2lzc3Vlcy80Mjk3MFxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgIGFzeW5jIHJlYWQoKSB7XG4gICAgICAgICAgICBpZiAobiA8IHQuYnl0ZUxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiB0LnNsaWNlKG4sIG4gKyBlKSxcbiAgICAgICAgICAgICAgICAgICAgZG9uZTogITFcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHJldHVybiBuICs9IGUsIHM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGRvbmU6ICEwXG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuICAgICAgICBhc3luYyBjYW5jZWwoKSB7fSxcbiAgICAgICAgcmVsZWFzZUxvY2soKSB7fSxcbiAgICAgICAgY2xvc2VkOiBQcm9taXNlLnJlamVjdChcInVuaW1wbGVtZW50ZWRcIilcbiAgICB9O1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBPbiB3ZWIsIGEgYFJlYWRhYmxlU3RyZWFtYCBpcyB3cmFwcGVkIGFyb3VuZCBieSBhIGBCeXRlU3RyZWFtUmVhZGVyYC5cbiAqL1xuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qXG4gKiBBIHdyYXBwZXIgaW1wbGVtZW50YXRpb24gb2YgT2JzZXJ2ZXI8VD4gdGhhdCB3aWxsIGRpc3BhdGNoIGV2ZW50c1xuICogYXN5bmNocm9ub3VzbHkuIFRvIGFsbG93IGltbWVkaWF0ZSBzaWxlbmNpbmcsIGEgbXV0ZSBjYWxsIGlzIGFkZGVkIHdoaWNoXG4gKiBjYXVzZXMgZXZlbnRzIHNjaGVkdWxlZCB0byBubyBsb25nZXIgYmUgcmFpc2VkLlxuICovXG5jbGFzcyBNYSB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLm9ic2VydmVyID0gdCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBXaGVuIHNldCB0byB0cnVlLCB3aWxsIG5vdCByYWlzZSBmdXR1cmUgZXZlbnRzLiBOZWNlc3NhcnkgdG8gZGVhbCB3aXRoXG4gICAgICAgICAqIGFzeW5jIGRldGFjaG1lbnQgb2YgbGlzdGVuZXIuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm11dGVkID0gITE7XG4gICAgfVxuICAgIG5leHQodCkge1xuICAgICAgICB0aGlzLm9ic2VydmVyLm5leHQgJiYgdGhpcy5Zbyh0aGlzLm9ic2VydmVyLm5leHQsIHQpO1xuICAgIH1cbiAgICBlcnJvcih0KSB7XG4gICAgICAgIHRoaXMub2JzZXJ2ZXIuZXJyb3IgPyB0aGlzLllvKHRoaXMub2JzZXJ2ZXIuZXJyb3IsIHQpIDogY29uc29sZS5lcnJvcihcIlVuY2F1Z2h0IEVycm9yIGluIHNuYXBzaG90IGxpc3RlbmVyOlwiLCB0KTtcbiAgICB9XG4gICAgWG8oKSB7XG4gICAgICAgIHRoaXMubXV0ZWQgPSAhMDtcbiAgICB9XG4gICAgWW8odCwgZSkge1xuICAgICAgICB0aGlzLm11dGVkIHx8IHNldFRpbWVvdXQoKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMubXV0ZWQgfHwgdChlKTtcbiAgICAgICAgfSksIDApO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSBjbGFzcyByZXByZXNlbnRpbmcgYSBidW5kbGUuXG4gKlxuICogVGFrZXMgYSBidW5kbGUgc3RyZWFtIG9yIGJ1ZmZlciwgYW5kIHByZXNlbnRzIGFic3RyYWN0aW9ucyB0byByZWFkIGJ1bmRsZWRcbiAqIGVsZW1lbnRzIG91dCBvZiB0aGUgdW5kZXJseWluZyBjb250ZW50LlxuICovIGNsYXNzIExhIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKiogVGhlIHJlYWRlciB0byByZWFkIGZyb20gdW5kZXJseWluZyBiaW5hcnkgYnVuZGxlIGRhdGEgc291cmNlLiAqL1xuICAgIHQsIGUpIHtcbiAgICAgICAgdGhpcy5abyA9IHQsIHRoaXMuTiA9IGUsIFxuICAgICAgICAvKiogQ2FjaGVkIGJ1bmRsZSBtZXRhZGF0YS4gKi9cbiAgICAgICAgdGhpcy5tZXRhZGF0YSA9IG5ldyBqLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEludGVybmFsIGJ1ZmZlciB0byBob2xkIGJ1bmRsZSBjb250ZW50LCBhY2N1bXVsYXRpbmcgaW5jb21wbGV0ZSBlbGVtZW50XG4gICAgICAgICAqIGNvbnRlbnQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmJ1ZmZlciA9IG5ldyBVaW50OEFycmF5LCB0aGlzLnRhID0gbmV3IFRleHREZWNvZGVyKFwidXRmLThcIiksIFxuICAgICAgICAvLyBSZWFkIHRoZSBtZXRhZGF0YSAod2hpY2ggaXMgdGhlIGZpcnN0IGVsZW1lbnQpLlxuICAgICAgICB0aGlzLmVhKCkudGhlbigodCA9PiB7XG4gICAgICAgICAgICB0ICYmIHQuaG8oKSA/IHRoaXMubWV0YWRhdGEucmVzb2x2ZSh0LnBheWxvYWQubWV0YWRhdGEpIDogdGhpcy5tZXRhZGF0YS5yZWplY3QobmV3IEVycm9yKGBUaGUgZmlyc3QgZWxlbWVudCBvZiB0aGUgYnVuZGxlIGlzIG5vdCBhIG1ldGFkYXRhLCBpdCBpc1xcbiAgICAgICAgICAgICAke0pTT04uc3RyaW5naWZ5KG51bGwgPT0gdCA/IHZvaWQgMCA6IHQucGF5bG9hZCl9YCkpO1xuICAgICAgICB9KSwgKHQgPT4gdGhpcy5tZXRhZGF0YS5yZWplY3QodCkpKTtcbiAgICB9XG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLlpvLmNhbmNlbCgpO1xuICAgIH1cbiAgICBhc3luYyBnZXRNZXRhZGF0YSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubWV0YWRhdGEucHJvbWlzZTtcbiAgICB9XG4gICAgYXN5bmMgUW8oKSB7XG4gICAgICAgIC8vIE1ha2VzIHN1cmUgbWV0YWRhdGEgaXMgcmVhZCBiZWZvcmUgcHJvY2VlZGluZy5cbiAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZ2V0TWV0YWRhdGEoKSwgdGhpcy5lYSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZWFkcyBmcm9tIHRoZSBoZWFkIG9mIGludGVybmFsIGJ1ZmZlciwgYW5kIHB1bGxpbmcgbW9yZSBkYXRhIGZyb21cbiAgICAgKiB1bmRlcmx5aW5nIHN0cmVhbSBpZiBhIGNvbXBsZXRlIGVsZW1lbnQgY2Fubm90IGJlIGZvdW5kLCB1bnRpbCBhblxuICAgICAqIGVsZW1lbnQoaW5jbHVkaW5nIHRoZSBwcmVmaXhlZCBsZW5ndGggYW5kIHRoZSBKU09OIHN0cmluZykgaXMgZm91bmQuXG4gICAgICpcbiAgICAgKiBPbmNlIGEgY29tcGxldGUgZWxlbWVudCBpcyByZWFkLCBpdCBpcyBkcm9wcGVkIGZyb20gaW50ZXJuYWwgYnVmZmVyLlxuICAgICAqXG4gICAgICogUmV0dXJucyBlaXRoZXIgdGhlIGJ1bmRsZWQgZWxlbWVudCwgb3IgbnVsbCBpZiB3ZSBoYXZlIHJlYWNoZWQgdGhlIGVuZCBvZlxuICAgICAqIHRoZSBzdHJlYW0uXG4gICAgICovICAgIGFzeW5jIGVhKCkge1xuICAgICAgICBjb25zdCB0ID0gYXdhaXQgdGhpcy5uYSgpO1xuICAgICAgICBpZiAobnVsbCA9PT0gdCkgcmV0dXJuIG51bGw7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLnRhLmRlY29kZSh0KSwgbiA9IE51bWJlcihlKTtcbiAgICAgICAgaXNOYU4obikgJiYgdGhpcy5zYShgbGVuZ3RoIHN0cmluZyAoJHtlfSkgaXMgbm90IHZhbGlkIG51bWJlcmApO1xuICAgICAgICBjb25zdCBzID0gYXdhaXQgdGhpcy5pYShuKTtcbiAgICAgICAgcmV0dXJuIG5ldyBRbyhKU09OLnBhcnNlKHMpLCB0Lmxlbmd0aCArIG4pO1xuICAgIH1cbiAgICAvKiogRmlyc3QgaW5kZXggb2YgJ3snIGZyb20gdGhlIHVuZGVybHlpbmcgYnVmZmVyLiAqLyAgICByYSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYnVmZmVyLmZpbmRJbmRleCgodCA9PiB0ID09PSBcIntcIi5jaGFyQ29kZUF0KDApKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlYWRzIGZyb20gdGhlIGJlZ2lubmluZyBvZiB0aGUgaW50ZXJuYWwgYnVmZmVyLCB1bnRpbCB0aGUgZmlyc3QgJ3snLCBhbmRcbiAgICAgKiByZXR1cm4gdGhlIGNvbnRlbnQuXG4gICAgICpcbiAgICAgKiBJZiByZWFjaGVkIGVuZCBvZiB0aGUgc3RyZWFtLCByZXR1cm5zIGEgbnVsbC5cbiAgICAgKi8gICAgYXN5bmMgbmEoKSB7XG4gICAgICAgIGZvciAoO3RoaXMucmEoKSA8IDA7ICkge1xuICAgICAgICAgICAgaWYgKGF3YWl0IHRoaXMub2EoKSkgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQnJva2Ugb3V0IG9mIHRoZSBsb29wIGJlY2F1c2UgdW5kZXJseWluZyBzdHJlYW0gaXMgY2xvc2VkLCBhbmQgdGhlcmVcbiAgICAgICAgLy8gaGFwcGVucyB0byBiZSBubyBtb3JlIGRhdGEgdG8gcHJvY2Vzcy5cbiAgICAgICAgICAgICAgICBpZiAoMCA9PT0gdGhpcy5idWZmZXIubGVuZ3RoKSByZXR1cm4gbnVsbDtcbiAgICAgICAgY29uc3QgdCA9IHRoaXMucmEoKTtcbiAgICAgICAgLy8gQnJva2Ugb3V0IG9mIHRoZSBsb29wIGJlY2F1c2UgdW5kZXJseWluZyBzdHJlYW0gaXMgY2xvc2VkLCBidXQgc3RpbGxcbiAgICAgICAgLy8gY2Fubm90IGZpbmQgYW4gb3BlbiBicmFja2V0LlxuICAgICAgICAgICAgICAgIHQgPCAwICYmIHRoaXMuc2EoXCJSZWFjaGVkIHRoZSBlbmQgb2YgYnVuZGxlIHdoZW4gYSBsZW5ndGggc3RyaW5nIGlzIGV4cGVjdGVkLlwiKTtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuYnVmZmVyLnNsaWNlKDAsIHQpO1xuICAgICAgICAvLyBVcGRhdGUgdGhlIGludGVybmFsIGJ1ZmZlciB0byBkcm9wIHRoZSByZWFkIGxlbmd0aC5cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5idWZmZXIgPSB0aGlzLmJ1ZmZlci5zbGljZSh0KSwgZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVhZHMgZnJvbSBhIHNwZWNpZmllZCBwb3NpdGlvbiBmcm9tIHRoZSBpbnRlcm5hbCBidWZmZXIsIGZvciBhIHNwZWNpZmllZFxuICAgICAqIG51bWJlciBvZiBieXRlcywgcHVsbGluZyBtb3JlIGRhdGEgZnJvbSB0aGUgdW5kZXJseWluZyBzdHJlYW0gaWYgbmVlZGVkLlxuICAgICAqXG4gICAgICogUmV0dXJucyBhIHN0cmluZyBkZWNvZGVkIGZyb20gdGhlIHJlYWQgYnl0ZXMuXG4gICAgICovICAgIGFzeW5jIGlhKHQpIHtcbiAgICAgICAgZm9yICg7dGhpcy5idWZmZXIubGVuZ3RoIDwgdDsgKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLm9hKCkgJiYgdGhpcy5zYShcIlJlYWNoZWQgdGhlIGVuZCBvZiBidW5kbGUgd2hlbiBtb3JlIGlzIGV4cGVjdGVkLlwiKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBlID0gdGhpcy50YS5kZWNvZGUodGhpcy5idWZmZXIuc2xpY2UoMCwgdCkpO1xuICAgICAgICAvLyBVcGRhdGUgdGhlIGludGVybmFsIGJ1ZmZlciB0byBkcm9wIHRoZSByZWFkIGpzb24gc3RyaW5nLlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmJ1ZmZlciA9IHRoaXMuYnVmZmVyLnNsaWNlKHQpLCBlO1xuICAgIH1cbiAgICBzYSh0KSB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZmxvYXRpbmctcHJvbWlzZXNcbiAgICAgICAgdGhyb3cgdGhpcy5aby5jYW5jZWwoKSwgbmV3IEVycm9yKGBJbnZhbGlkIGJ1bmRsZSBmb3JtYXQ6ICR7dH1gKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUHVsbHMgbW9yZSBkYXRhIGZyb20gdW5kZXJseWluZyBzdHJlYW0gdG8gaW50ZXJuYWwgYnVmZmVyLlxuICAgICAqIFJldHVybnMgYSBib29sZWFuIGluZGljYXRpbmcgd2hldGhlciB0aGUgc3RyZWFtIGlzIGZpbmlzaGVkLlxuICAgICAqLyAgICBhc3luYyBvYSgpIHtcbiAgICAgICAgY29uc3QgdCA9IGF3YWl0IHRoaXMuWm8ucmVhZCgpO1xuICAgICAgICBpZiAoIXQuZG9uZSkge1xuICAgICAgICAgICAgY29uc3QgZSA9IG5ldyBVaW50OEFycmF5KHRoaXMuYnVmZmVyLmxlbmd0aCArIHQudmFsdWUubGVuZ3RoKTtcbiAgICAgICAgICAgIGUuc2V0KHRoaXMuYnVmZmVyKSwgZS5zZXQodC52YWx1ZSwgdGhpcy5idWZmZXIubGVuZ3RoKSwgdGhpcy5idWZmZXIgPSBlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0LmRvbmU7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBJbnRlcm5hbCB0cmFuc2FjdGlvbiBvYmplY3QgcmVzcG9uc2libGUgZm9yIGFjY3VtdWxhdGluZyB0aGUgbXV0YXRpb25zIHRvXG4gKiBwZXJmb3JtIGFuZCB0aGUgYmFzZSB2ZXJzaW9ucyBmb3IgYW55IGRvY3VtZW50cyByZWFkLlxuICovXG5jbGFzcyBCYSB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLmRhdGFzdG9yZSA9IHQsIFxuICAgICAgICAvLyBUaGUgdmVyc2lvbiBvZiBlYWNoIGRvY3VtZW50IHRoYXQgd2FzIHJlYWQgZHVyaW5nIHRoaXMgdHJhbnNhY3Rpb24uXG4gICAgICAgIHRoaXMucmVhZFZlcnNpb25zID0gbmV3IE1hcCwgdGhpcy5tdXRhdGlvbnMgPSBbXSwgdGhpcy5jb21taXR0ZWQgPSAhMSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIGRlZmVycmVkIHVzYWdlIGVycm9yIHRoYXQgb2NjdXJyZWQgcHJldmlvdXNseSBpbiB0aGlzIHRyYW5zYWN0aW9uIHRoYXRcbiAgICAgICAgICogd2lsbCBjYXVzZSB0aGUgdHJhbnNhY3Rpb24gdG8gZmFpbCBvbmNlIGl0IGFjdHVhbGx5IGNvbW1pdHMuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmxhc3RXcml0ZUVycm9yID0gbnVsbCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTZXQgb2YgZG9jdW1lbnRzIHRoYXQgaGF2ZSBiZWVuIHdyaXR0ZW4gaW4gdGhlIHRyYW5zYWN0aW9uLlxuICAgICAgICAgKlxuICAgICAgICAgKiBXaGVuIHRoZXJlJ3MgbW9yZSB0aGFuIG9uZSB3cml0ZSB0byB0aGUgc2FtZSBrZXkgaW4gYSB0cmFuc2FjdGlvbiwgYW55XG4gICAgICAgICAqIHdyaXRlcyBhZnRlciB0aGUgZmlyc3QgYXJlIGhhbmRsZWQgZGlmZmVyZW50bHkuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLndyaXR0ZW5Eb2NzID0gbmV3IFNldDtcbiAgICB9XG4gICAgYXN5bmMgbG9va3VwKHQpIHtcbiAgICAgICAgaWYgKHRoaXMuZW5zdXJlQ29tbWl0Tm90Q2FsbGVkKCksIHRoaXMubXV0YXRpb25zLmxlbmd0aCA+IDApIHRocm93IG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgXCJGaXJlc3RvcmUgdHJhbnNhY3Rpb25zIHJlcXVpcmUgYWxsIHJlYWRzIHRvIGJlIGV4ZWN1dGVkIGJlZm9yZSBhbGwgd3JpdGVzLlwiKTtcbiAgICAgICAgY29uc3QgZSA9IGF3YWl0IGFzeW5jIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBVKHQpLCBzID0gSm4obi5OKSArIFwiL2RvY3VtZW50c1wiLCBpID0ge1xuICAgICAgICAgICAgICAgIGRvY3VtZW50czogZS5tYXAoKHQgPT4gV24obi5OLCB0KSkpXG4gICAgICAgICAgICB9LCByID0gYXdhaXQgbi5LaShcIkJhdGNoR2V0RG9jdW1lbnRzXCIsIHMsIGkpLCBvID0gbmV3IE1hcDtcbiAgICAgICAgICAgIHIuZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRzKG4uTiwgdCk7XG4gICAgICAgICAgICAgICAgby5zZXQoZS5rZXkudG9TdHJpbmcoKSwgZSk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICBjb25zdCBhID0gW107XG4gICAgICAgICAgICByZXR1cm4gZS5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gby5nZXQodC50b1N0cmluZygpKTtcbiAgICAgICAgICAgICAgICBMKCEhZSksIGEucHVzaChlKTtcbiAgICAgICAgICAgIH0pKSwgYTtcbiAgICAgICAgfSh0aGlzLmRhdGFzdG9yZSwgdCk7XG4gICAgICAgIHJldHVybiBlLmZvckVhY2goKHQgPT4gdGhpcy5yZWNvcmRWZXJzaW9uKHQpKSksIGU7XG4gICAgfVxuICAgIHNldCh0LCBlKSB7XG4gICAgICAgIHRoaXMud3JpdGUoZS50b011dGF0aW9uKHQsIHRoaXMucHJlY29uZGl0aW9uKHQpKSksIHRoaXMud3JpdHRlbkRvY3MuYWRkKHQudG9TdHJpbmcoKSk7XG4gICAgfVxuICAgIHVwZGF0ZSh0LCBlKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aGlzLndyaXRlKGUudG9NdXRhdGlvbih0LCB0aGlzLnByZWNvbmRpdGlvbkZvclVwZGF0ZSh0KSkpO1xuICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICB0aGlzLmxhc3RXcml0ZUVycm9yID0gdDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLndyaXR0ZW5Eb2NzLmFkZCh0LnRvU3RyaW5nKCkpO1xuICAgIH1cbiAgICBkZWxldGUodCkge1xuICAgICAgICB0aGlzLndyaXRlKG5ldyBvbih0LCB0aGlzLnByZWNvbmRpdGlvbih0KSkpLCB0aGlzLndyaXR0ZW5Eb2NzLmFkZCh0LnRvU3RyaW5nKCkpO1xuICAgIH1cbiAgICBhc3luYyBjb21taXQoKSB7XG4gICAgICAgIGlmICh0aGlzLmVuc3VyZUNvbW1pdE5vdENhbGxlZCgpLCB0aGlzLmxhc3RXcml0ZUVycm9yKSB0aHJvdyB0aGlzLmxhc3RXcml0ZUVycm9yO1xuICAgICAgICBjb25zdCB0ID0gdGhpcy5yZWFkVmVyc2lvbnM7XG4gICAgICAgIC8vIEZvciBlYWNoIG11dGF0aW9uLCBub3RlIHRoYXQgdGhlIGRvYyB3YXMgd3JpdHRlbi5cbiAgICAgICAgICAgICAgICB0aGlzLm11dGF0aW9ucy5mb3JFYWNoKChlID0+IHtcbiAgICAgICAgICAgIHQuZGVsZXRlKGUua2V5LnRvU3RyaW5nKCkpO1xuICAgICAgICB9KSksIFxuICAgICAgICAvLyBGb3IgZWFjaCBkb2N1bWVudCB0aGF0IHdhcyByZWFkIGJ1dCBub3Qgd3JpdHRlbiB0bywgd2Ugd2FudCB0byBwZXJmb3JtXG4gICAgICAgIC8vIGEgYHZlcmlmeWAgb3BlcmF0aW9uLlxuICAgICAgICB0LmZvckVhY2goKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuID0gUHQuZnJvbVBhdGgoZSk7XG4gICAgICAgICAgICB0aGlzLm11dGF0aW9ucy5wdXNoKG5ldyBhbihuLCB0aGlzLnByZWNvbmRpdGlvbihuKSkpO1xuICAgICAgICB9KSksIGF3YWl0IGFzeW5jIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBVKHQpLCBzID0gSm4obi5OKSArIFwiL2RvY3VtZW50c1wiLCBpID0ge1xuICAgICAgICAgICAgICAgIHdyaXRlczogZS5tYXAoKHQgPT4gbnMobi5OLCB0KSkpXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgYXdhaXQgbi5MaShcIkNvbW1pdFwiLCBzLCBpKTtcbiAgICAgICAgfSh0aGlzLmRhdGFzdG9yZSwgdGhpcy5tdXRhdGlvbnMpLCB0aGlzLmNvbW1pdHRlZCA9ICEwO1xuICAgIH1cbiAgICByZWNvcmRWZXJzaW9uKHQpIHtcbiAgICAgICAgbGV0IGU7XG4gICAgICAgIGlmICh0LmlzRm91bmREb2N1bWVudCgpKSBlID0gdC52ZXJzaW9uOyBlbHNlIHtcbiAgICAgICAgICAgIGlmICghdC5pc05vRG9jdW1lbnQoKSkgdGhyb3cgTSgpO1xuICAgICAgICAgICAgLy8gRm9yIGRlbGV0ZWQgZG9jcywgd2UgbXVzdCB1c2UgYmFzZVZlcnNpb24gMCB3aGVuIHdlIG92ZXJ3cml0ZSB0aGVtLlxuICAgICAgICAgICAgZSA9IGl0Lm1pbigpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG4gPSB0aGlzLnJlYWRWZXJzaW9ucy5nZXQodC5rZXkudG9TdHJpbmcoKSk7XG4gICAgICAgIGlmIChuKSB7XG4gICAgICAgICAgICBpZiAoIWUuaXNFcXVhbChuKSkgXG4gICAgICAgICAgICAvLyBUaGlzIHRyYW5zYWN0aW9uIHdpbGwgZmFpbCBubyBtYXR0ZXIgd2hhdC5cbiAgICAgICAgICAgIHRocm93IG5ldyBLKHEuQUJPUlRFRCwgXCJEb2N1bWVudCB2ZXJzaW9uIGNoYW5nZWQgYmV0d2VlbiB0d28gcmVhZHMuXCIpO1xuICAgICAgICB9IGVsc2UgdGhpcy5yZWFkVmVyc2lvbnMuc2V0KHQua2V5LnRvU3RyaW5nKCksIGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSB2ZXJzaW9uIG9mIHRoaXMgZG9jdW1lbnQgd2hlbiBpdCB3YXMgcmVhZCBpbiB0aGlzIHRyYW5zYWN0aW9uLFxuICAgICAqIGFzIGEgcHJlY29uZGl0aW9uLCBvciBubyBwcmVjb25kaXRpb24gaWYgaXQgd2FzIG5vdCByZWFkLlxuICAgICAqLyAgICBwcmVjb25kaXRpb24odCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5yZWFkVmVyc2lvbnMuZ2V0KHQudG9TdHJpbmcoKSk7XG4gICAgICAgIHJldHVybiAhdGhpcy53cml0dGVuRG9jcy5oYXModC50b1N0cmluZygpKSAmJiBlID8gV2UudXBkYXRlVGltZShlKSA6IFdlLm5vbmUoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgcHJlY29uZGl0aW9uIGZvciBhIGRvY3VtZW50IGlmIHRoZSBvcGVyYXRpb24gaXMgYW4gdXBkYXRlLlxuICAgICAqLyAgICBwcmVjb25kaXRpb25Gb3JVcGRhdGUodCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5yZWFkVmVyc2lvbnMuZ2V0KHQudG9TdHJpbmcoKSk7XG4gICAgICAgIC8vIFRoZSBmaXJzdCB0aW1lIGEgZG9jdW1lbnQgaXMgd3JpdHRlbiwgd2Ugd2FudCB0byB0YWtlIGludG8gYWNjb3VudCB0aGVcbiAgICAgICAgLy8gcmVhZCB0aW1lIGFuZCBleGlzdGVuY2VcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMud3JpdHRlbkRvY3MuaGFzKHQudG9TdHJpbmcoKSkgJiYgZSkge1xuICAgICAgICAgICAgaWYgKGUuaXNFcXVhbChpdC5taW4oKSkpIFxuICAgICAgICAgICAgLy8gVGhlIGRvY3VtZW50IGRvZXNuJ3QgZXhpc3QsIHNvIGZhaWwgdGhlIHRyYW5zYWN0aW9uLlxuICAgICAgICAgICAgLy8gVGhpcyBoYXMgdG8gYmUgdmFsaWRhdGVkIGxvY2FsbHkgYmVjYXVzZSB5b3UgY2FuJ3Qgc2VuZCBhXG4gICAgICAgICAgICAvLyBwcmVjb25kaXRpb24gdGhhdCBhIGRvY3VtZW50IGRvZXMgbm90IGV4aXN0IHdpdGhvdXQgY2hhbmdpbmcgdGhlXG4gICAgICAgICAgICAvLyBzZW1hbnRpY3Mgb2YgdGhlIGJhY2tlbmQgd3JpdGUgdG8gYmUgYW4gaW5zZXJ0LiBUaGlzIGlzIHRoZSByZXZlcnNlXG4gICAgICAgICAgICAvLyBvZiB3aGF0IHdlIHdhbnQsIHNpbmNlIHdlIHdhbnQgdG8gYXNzZXJ0IHRoYXQgdGhlIGRvY3VtZW50IGRvZXNuJ3RcbiAgICAgICAgICAgIC8vIGV4aXN0IGJ1dCB0aGVuIHNlbmQgdGhlIHVwZGF0ZSBhbmQgaGF2ZSBpdCBmYWlsLiBTaW5jZSB3ZSBjYW4ndFxuICAgICAgICAgICAgLy8gZXhwcmVzcyB0aGF0IHRvIHRoZSBiYWNrZW5kLCB3ZSBoYXZlIHRvIHZhbGlkYXRlIGxvY2FsbHkuXG4gICAgICAgICAgICAvLyBOb3RlOiB0aGlzIGNhbiBjaGFuZ2Ugb25jZSB3ZSBjYW4gc2VuZCBzZXBhcmF0ZSB2ZXJpZnkgd3JpdGVzIGluIHRoZVxuICAgICAgICAgICAgLy8gdHJhbnNhY3Rpb24uXG4gICAgICAgICAgICB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIFwiQ2FuJ3QgdXBkYXRlIGEgZG9jdW1lbnQgdGhhdCBkb2Vzbid0IGV4aXN0LlwiKTtcbiAgICAgICAgICAgIC8vIERvY3VtZW50IGV4aXN0cywgYmFzZSBwcmVjb25kaXRpb24gb24gZG9jdW1lbnQgdXBkYXRlIHRpbWUuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gV2UudXBkYXRlVGltZShlKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBEb2N1bWVudCB3YXMgbm90IHJlYWQsIHNvIHdlIGp1c3QgdXNlIHRoZSBwcmVjb25kaXRpb25zIGZvciBhIGJsaW5kXG4gICAgICAgIC8vIHVwZGF0ZS5cbiAgICAgICAgcmV0dXJuIFdlLmV4aXN0cyghMCk7XG4gICAgfVxuICAgIHdyaXRlKHQpIHtcbiAgICAgICAgdGhpcy5lbnN1cmVDb21taXROb3RDYWxsZWQoKSwgdGhpcy5tdXRhdGlvbnMucHVzaCh0KTtcbiAgICB9XG4gICAgZW5zdXJlQ29tbWl0Tm90Q2FsbGVkKCkge31cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogVHJhbnNhY3Rpb25SdW5uZXIgZW5jYXBzdWxhdGVzIHRoZSBsb2dpYyBuZWVkZWQgdG8gcnVuIGFuZCByZXRyeSB0cmFuc2FjdGlvbnNcbiAqIHdpdGggYmFja29mZi5cbiAqL1xuY2xhc3MgVWEge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgdGhpcy5hc3luY1F1ZXVlID0gdCwgdGhpcy5kYXRhc3RvcmUgPSBlLCB0aGlzLnVwZGF0ZUZ1bmN0aW9uID0gbiwgdGhpcy5kZWZlcnJlZCA9IHMsIFxuICAgICAgICB0aGlzLmFhID0gNSwgdGhpcy5yciA9IG5ldyBZcih0aGlzLmFzeW5jUXVldWUsIFwidHJhbnNhY3Rpb25fcmV0cnlcIiAvKiBUcmFuc2FjdGlvblJldHJ5ICovKTtcbiAgICB9XG4gICAgLyoqIFJ1bnMgdGhlIHRyYW5zYWN0aW9uIGFuZCBzZXRzIHRoZSByZXN1bHQgb24gZGVmZXJyZWQuICovICAgIHJ1bigpIHtcbiAgICAgICAgdGhpcy5hYSAtPSAxLCB0aGlzLmNhKCk7XG4gICAgfVxuICAgIGNhKCkge1xuICAgICAgICB0aGlzLnJyLlhpKChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB0ID0gbmV3IEJhKHRoaXMuZGF0YXN0b3JlKSwgZSA9IHRoaXMudWEodCk7XG4gICAgICAgICAgICBlICYmIGUudGhlbigoZSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoKCgpID0+IHQuY29tbWl0KCkudGhlbigoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRlZmVycmVkLnJlc29sdmUoZSk7XG4gICAgICAgICAgICAgICAgfSkpLmNhdGNoKCh0ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYSh0KTtcbiAgICAgICAgICAgICAgICB9KSkpKTtcbiAgICAgICAgICAgIH0pKS5jYXRjaCgodCA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5oYSh0KTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB1YSh0KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBlID0gdGhpcy51cGRhdGVGdW5jdGlvbih0KTtcbiAgICAgICAgICAgIHJldHVybiAhSXQoZSkgJiYgZS5jYXRjaCAmJiBlLnRoZW4gPyBlIDogKHRoaXMuZGVmZXJyZWQucmVqZWN0KEVycm9yKFwiVHJhbnNhY3Rpb24gY2FsbGJhY2sgbXVzdCByZXR1cm4gYSBQcm9taXNlXCIpKSwgXG4gICAgICAgICAgICBudWxsKTtcbiAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgLy8gRG8gbm90IHJldHJ5IGVycm9ycyB0aHJvd24gYnkgdXNlciBwcm92aWRlZCB1cGRhdGVGdW5jdGlvbi5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLmRlZmVycmVkLnJlamVjdCh0KSwgbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBoYSh0KSB7XG4gICAgICAgIHRoaXMuYWEgPiAwICYmIHRoaXMubGEodCkgPyAodGhpcy5hYSAtPSAxLCB0aGlzLmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldCgoKCkgPT4gKHRoaXMuY2EoKSwgXG4gICAgICAgIFByb21pc2UucmVzb2x2ZSgpKSkpKSA6IHRoaXMuZGVmZXJyZWQucmVqZWN0KHQpO1xuICAgIH1cbiAgICBsYSh0KSB7XG4gICAgICAgIGlmIChcIkZpcmViYXNlRXJyb3JcIiA9PT0gdC5uYW1lKSB7XG4gICAgICAgICAgICAvLyBJbiB0cmFuc2FjdGlvbnMsIHRoZSBiYWNrZW5kIHdpbGwgZmFpbCBvdXRkYXRlZCByZWFkcyB3aXRoIEZBSUxFRF9QUkVDT05ESVRJT04gYW5kXG4gICAgICAgICAgICAvLyBub24tbWF0Y2hpbmcgZG9jdW1lbnQgdmVyc2lvbnMgd2l0aCBBQk9SVEVELiBUaGVzZSBlcnJvcnMgc2hvdWxkIGJlIHJldHJpZWQuXG4gICAgICAgICAgICBjb25zdCBlID0gdC5jb2RlO1xuICAgICAgICAgICAgcmV0dXJuIFwiYWJvcnRlZFwiID09PSBlIHx8IFwiZmFpbGVkLXByZWNvbmRpdGlvblwiID09PSBlIHx8ICFsbihlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gITE7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBGaXJlc3RvcmVDbGllbnQgaXMgYSB0b3AtbGV2ZWwgY2xhc3MgdGhhdCBjb25zdHJ1Y3RzIGFuZCBvd25zIGFsbCBvZiB0aGVcbiAqIHBpZWNlcyBvZiB0aGUgY2xpZW50IFNESyBhcmNoaXRlY3R1cmUuIEl0IGlzIHJlc3BvbnNpYmxlIGZvciBjcmVhdGluZyB0aGVcbiAqIGFzeW5jIHF1ZXVlIHRoYXQgaXMgc2hhcmVkIGJ5IGFsbCBvZiB0aGUgb3RoZXIgY29tcG9uZW50cyBpbiB0aGUgc3lzdGVtLlxuICovXG5jbGFzcyBxYSB7XG4gICAgY29uc3RydWN0b3IodCwgXG4gICAgLyoqXG4gICAgICogQXN5bmNocm9ub3VzIHF1ZXVlIHJlc3BvbnNpYmxlIGZvciBhbGwgb2Ygb3VyIGludGVybmFsIHByb2Nlc3NpbmcuIFdoZW5cbiAgICAgKiB3ZSBnZXQgaW5jb21pbmcgd29yayBmcm9tIHRoZSB1c2VyICh2aWEgcHVibGljIEFQSSkgb3IgdGhlIG5ldHdvcmtcbiAgICAgKiAoaW5jb21pbmcgR1JQQyBtZXNzYWdlcyksIHdlIHNob3VsZCBhbHdheXMgc2NoZWR1bGUgb250byB0aGlzIHF1ZXVlLlxuICAgICAqIFRoaXMgZW5zdXJlcyBhbGwgb2Ygb3VyIHdvcmsgaXMgcHJvcGVybHkgc2VyaWFsaXplZCAoZS5nLiB3ZSBkb24ndFxuICAgICAqIHN0YXJ0IHByb2Nlc3NpbmcgYSBuZXcgb3BlcmF0aW9uIHdoaWxlIHRoZSBwcmV2aW91cyBvbmUgaXMgd2FpdGluZyBmb3JcbiAgICAgKiBhbiBhc3luYyBJL08gdG8gY29tcGxldGUpLlxuICAgICAqL1xuICAgIGUsIG4pIHtcbiAgICAgICAgdGhpcy5jcmVkZW50aWFscyA9IHQsIHRoaXMuYXN5bmNRdWV1ZSA9IGUsIHRoaXMuZGF0YWJhc2VJbmZvID0gbiwgdGhpcy51c2VyID0gUy5VTkFVVEhFTlRJQ0FURUQsIFxuICAgICAgICB0aGlzLmNsaWVudElkID0gWi5JKCksIHRoaXMuY3JlZGVudGlhbExpc3RlbmVyID0gKCkgPT4gUHJvbWlzZS5yZXNvbHZlKCksIHRoaXMuY3JlZGVudGlhbHMuc3RhcnQoZSwgKGFzeW5jIHQgPT4ge1xuICAgICAgICAgICAgayhcIkZpcmVzdG9yZUNsaWVudFwiLCBcIlJlY2VpdmVkIHVzZXI9XCIsIHQudWlkKSwgYXdhaXQgdGhpcy5jcmVkZW50aWFsTGlzdGVuZXIodCksIFxuICAgICAgICAgICAgdGhpcy51c2VyID0gdDtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBhc3luYyBnZXRDb25maWd1cmF0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYXN5bmNRdWV1ZTogdGhpcy5hc3luY1F1ZXVlLFxuICAgICAgICAgICAgZGF0YWJhc2VJbmZvOiB0aGlzLmRhdGFiYXNlSW5mbyxcbiAgICAgICAgICAgIGNsaWVudElkOiB0aGlzLmNsaWVudElkLFxuICAgICAgICAgICAgY3JlZGVudGlhbHM6IHRoaXMuY3JlZGVudGlhbHMsXG4gICAgICAgICAgICBpbml0aWFsVXNlcjogdGhpcy51c2VyLFxuICAgICAgICAgICAgbWF4Q29uY3VycmVudExpbWJvUmVzb2x1dGlvbnM6IDEwMFxuICAgICAgICB9O1xuICAgIH1cbiAgICBzZXRDcmVkZW50aWFsQ2hhbmdlTGlzdGVuZXIodCkge1xuICAgICAgICB0aGlzLmNyZWRlbnRpYWxMaXN0ZW5lciA9IHQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENoZWNrcyB0aGF0IHRoZSBjbGllbnQgaGFzIG5vdCBiZWVuIHRlcm1pbmF0ZWQuIEVuc3VyZXMgdGhhdCBvdGhlciBtZXRob2RzIG9uXG4gICAgICogdGhpcyBjbGFzcyBjYW5ub3QgYmUgY2FsbGVkIGFmdGVyIHRoZSBjbGllbnQgaXMgdGVybWluYXRlZC5cbiAgICAgKi8gICAgdmVyaWZ5Tm90VGVybWluYXRlZCgpIHtcbiAgICAgICAgaWYgKHRoaXMuYXN5bmNRdWV1ZS5pc1NodXR0aW5nRG93bikgdGhyb3cgbmV3IEsocS5GQUlMRURfUFJFQ09ORElUSU9OLCBcIlRoZSBjbGllbnQgaGFzIGFscmVhZHkgYmVlbiB0ZXJtaW5hdGVkLlwiKTtcbiAgICB9XG4gICAgdGVybWluYXRlKCkge1xuICAgICAgICB0aGlzLmFzeW5jUXVldWUuZW50ZXJSZXN0cmljdGVkTW9kZSgpO1xuICAgICAgICBjb25zdCB0ID0gbmV3IGo7XG4gICAgICAgIHJldHVybiB0aGlzLmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldEV2ZW5XaGlsZVJlc3RyaWN0ZWQoKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vbmxpbmVDb21wb25lbnRzICYmIGF3YWl0IHRoaXMub25saW5lQ29tcG9uZW50cy50ZXJtaW5hdGUoKSwgdGhpcy5vZmZsaW5lQ29tcG9uZW50cyAmJiBhd2FpdCB0aGlzLm9mZmxpbmVDb21wb25lbnRzLnRlcm1pbmF0ZSgpLCBcbiAgICAgICAgICAgICAgICAvLyBUaGUgY3JlZGVudGlhbHMgcHJvdmlkZXIgbXVzdCBiZSB0ZXJtaW5hdGVkIGFmdGVyIHNodXR0aW5nIGRvd24gdGhlXG4gICAgICAgICAgICAgICAgLy8gUmVtb3RlU3RvcmUgYXMgaXQgd2lsbCBwcmV2ZW50IHRoZSBSZW1vdGVTdG9yZSBmcm9tIHJldHJpZXZpbmcgYXV0aFxuICAgICAgICAgICAgICAgIC8vIHRva2Vucy5cbiAgICAgICAgICAgICAgICB0aGlzLmNyZWRlbnRpYWxzLnNodXRkb3duKCksIHQucmVzb2x2ZSgpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB4byhlLCBcIkZhaWxlZCB0byBzaHV0ZG93biBwZXJzaXN0ZW5jZVwiKTtcbiAgICAgICAgICAgICAgICB0LnJlamVjdChuKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpLCB0LnByb21pc2U7XG4gICAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBLYSh0LCBlKSB7XG4gICAgdC5hc3luY1F1ZXVlLnZlcmlmeU9wZXJhdGlvbkluUHJvZ3Jlc3MoKSwgayhcIkZpcmVzdG9yZUNsaWVudFwiLCBcIkluaXRpYWxpemluZyBPZmZsaW5lQ29tcG9uZW50UHJvdmlkZXJcIik7XG4gICAgY29uc3QgbiA9IGF3YWl0IHQuZ2V0Q29uZmlndXJhdGlvbigpO1xuICAgIGF3YWl0IGUuaW5pdGlhbGl6ZShuKTtcbiAgICBsZXQgcyA9IG4uaW5pdGlhbFVzZXI7XG4gICAgdC5zZXRDcmVkZW50aWFsQ2hhbmdlTGlzdGVuZXIoKGFzeW5jIHQgPT4ge1xuICAgICAgICBzLmlzRXF1YWwodCkgfHwgKGF3YWl0IHVyKGUubG9jYWxTdG9yZSwgdCksIHMgPSB0KTtcbiAgICB9KSksIFxuICAgIC8vIFdoZW4gYSB1c2VyIGNhbGxzIGNsZWFyUGVyc2lzdGVuY2UoKSBpbiBvbmUgY2xpZW50LCBhbGwgb3RoZXIgY2xpZW50c1xuICAgIC8vIG5lZWQgdG8gYmUgdGVybWluYXRlZCB0byBhbGxvdyB0aGUgZGVsZXRlIHRvIHN1Y2NlZWQuXG4gICAgZS5wZXJzaXN0ZW5jZS5zZXREYXRhYmFzZURlbGV0ZWRMaXN0ZW5lcigoKCkgPT4gdC50ZXJtaW5hdGUoKSkpLCB0Lm9mZmxpbmVDb21wb25lbnRzID0gZTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gamEodCwgZSkge1xuICAgIHQuYXN5bmNRdWV1ZS52ZXJpZnlPcGVyYXRpb25JblByb2dyZXNzKCk7XG4gICAgY29uc3QgbiA9IGF3YWl0IFFhKHQpO1xuICAgIGsoXCJGaXJlc3RvcmVDbGllbnRcIiwgXCJJbml0aWFsaXppbmcgT25saW5lQ29tcG9uZW50UHJvdmlkZXJcIik7XG4gICAgY29uc3QgcyA9IGF3YWl0IHQuZ2V0Q29uZmlndXJhdGlvbigpO1xuICAgIGF3YWl0IGUuaW5pdGlhbGl6ZShuLCBzKSwgXG4gICAgLy8gVGhlIENyZWRlbnRpYWxDaGFuZ2VMaXN0ZW5lciBvZiB0aGUgb25saW5lIGNvbXBvbmVudCBwcm92aWRlciB0YWtlc1xuICAgIC8vIHByZWNlZGVuY2Ugb3ZlciB0aGUgb2ZmbGluZSBjb21wb25lbnQgcHJvdmlkZXIuXG4gICAgdC5zZXRDcmVkZW50aWFsQ2hhbmdlTGlzdGVuZXIoKHQgPT4gYXN5bmMgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBjb25zdCBuID0gVSh0KTtcbiAgICAgICAgbi5hc3luY1F1ZXVlLnZlcmlmeU9wZXJhdGlvbkluUHJvZ3Jlc3MoKSwgayhcIlJlbW90ZVN0b3JlXCIsIFwiUmVtb3RlU3RvcmUgcmVjZWl2ZWQgbmV3IGNyZWRlbnRpYWxzXCIpO1xuICAgICAgICBjb25zdCBzID0gZm8obik7XG4gICAgICAgIC8vIFRlYXIgZG93biBhbmQgcmUtY3JlYXRlIG91ciBuZXR3b3JrIHN0cmVhbXMuIFRoaXMgd2lsbCBlbnN1cmUgd2UgZ2V0IGFcbiAgICAgICAgLy8gZnJlc2ggYXV0aCB0b2tlbiBmb3IgdGhlIG5ldyB1c2VyIGFuZCByZS1maWxsIHRoZSB3cml0ZSBwaXBlbGluZSB3aXRoXG4gICAgICAgIC8vIG5ldyBtdXRhdGlvbnMgZnJvbSB0aGUgTG9jYWxTdG9yZSAoc2luY2UgbXV0YXRpb25zIGFyZSBwZXItdXNlcikuXG4gICAgICAgICAgICAgICAgbi5Lci5hZGQoMyAvKiBDcmVkZW50aWFsQ2hhbmdlICovKSwgYXdhaXQgcm8obiksIHMgJiYgXG4gICAgICAgIC8vIERvbid0IHNldCB0aGUgbmV0d29yayBzdGF0dXMgdG8gVW5rbm93biBpZiB3ZSBhcmUgb2ZmbGluZS5cbiAgICAgICAgbi5Xci5zZXQoXCJVbmtub3duXCIgLyogVW5rbm93biAqLyksIGF3YWl0IG4ucmVtb3RlU3luY2VyLmhhbmRsZUNyZWRlbnRpYWxDaGFuZ2UoZSksIFxuICAgICAgICBuLktyLmRlbGV0ZSgzIC8qIENyZWRlbnRpYWxDaGFuZ2UgKi8pLCBhd2FpdCBpbyhuKTtcbiAgICB9KGUucmVtb3RlU3RvcmUsIHQpKSksIHQub25saW5lQ29tcG9uZW50cyA9IGU7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIFFhKHQpIHtcbiAgICByZXR1cm4gdC5vZmZsaW5lQ29tcG9uZW50cyB8fCAoayhcIkZpcmVzdG9yZUNsaWVudFwiLCBcIlVzaW5nIGRlZmF1bHQgT2ZmbGluZUNvbXBvbmVudFByb3ZpZGVyXCIpLCBcbiAgICBhd2FpdCBLYSh0LCBuZXcgeGEpKSwgdC5vZmZsaW5lQ29tcG9uZW50cztcbn1cblxuYXN5bmMgZnVuY3Rpb24gV2EodCkge1xuICAgIHJldHVybiB0Lm9ubGluZUNvbXBvbmVudHMgfHwgKGsoXCJGaXJlc3RvcmVDbGllbnRcIiwgXCJVc2luZyBkZWZhdWx0IE9ubGluZUNvbXBvbmVudFByb3ZpZGVyXCIpLCBcbiAgICBhd2FpdCBqYSh0LCBuZXcgT2EpKSwgdC5vbmxpbmVDb21wb25lbnRzO1xufVxuXG5mdW5jdGlvbiBHYSh0KSB7XG4gICAgcmV0dXJuIFFhKHQpLnRoZW4oKHQgPT4gdC5wZXJzaXN0ZW5jZSkpO1xufVxuXG5mdW5jdGlvbiB6YSh0KSB7XG4gICAgcmV0dXJuIFFhKHQpLnRoZW4oKHQgPT4gdC5sb2NhbFN0b3JlKSk7XG59XG5cbmZ1bmN0aW9uIEhhKHQpIHtcbiAgICByZXR1cm4gV2EodCkudGhlbigodCA9PiB0LnJlbW90ZVN0b3JlKSk7XG59XG5cbmZ1bmN0aW9uIEphKHQpIHtcbiAgICByZXR1cm4gV2EodCkudGhlbigodCA9PiB0LnN5bmNFbmdpbmUpKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gWWEodCkge1xuICAgIGNvbnN0IGUgPSBhd2FpdCBXYSh0KSwgbiA9IGUuZXZlbnRNYW5hZ2VyO1xuICAgIHJldHVybiBuLm9uTGlzdGVuID0gZWEuYmluZChudWxsLCBlLnN5bmNFbmdpbmUpLCBuLm9uVW5saXN0ZW4gPSBzYS5iaW5kKG51bGwsIGUuc3luY0VuZ2luZSksIFxuICAgIG47XG59XG5cbi8qKiBFbmFibGVzIHRoZSBuZXR3b3JrIGNvbm5lY3Rpb24gYW5kIHJlLWVucXVldWVzIGFsbCBwZW5kaW5nIG9wZXJhdGlvbnMuICovIGZ1bmN0aW9uIFhhKHQpIHtcbiAgICByZXR1cm4gdC5hc3luY1F1ZXVlLmVucXVldWUoKGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgZSA9IGF3YWl0IEdhKHQpLCBuID0gYXdhaXQgSGEodCk7XG4gICAgICAgIHJldHVybiBlLnNldE5ldHdvcmtFbmFibGVkKCEwKSwgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgY29uc3QgZSA9IFUodCk7XG4gICAgICAgICAgICByZXR1cm4gZS5Lci5kZWxldGUoMCAvKiBVc2VyRGlzYWJsZWQgKi8pLCBpbyhlKTtcbiAgICAgICAgfShuKTtcbiAgICB9KSk7XG59XG5cbi8qKiBEaXNhYmxlcyB0aGUgbmV0d29yayBjb25uZWN0aW9uLiBQZW5kaW5nIG9wZXJhdGlvbnMgd2lsbCBub3QgY29tcGxldGUuICovIGZ1bmN0aW9uIFphKHQpIHtcbiAgICByZXR1cm4gdC5hc3luY1F1ZXVlLmVucXVldWUoKGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgZSA9IGF3YWl0IEdhKHQpLCBuID0gYXdhaXQgSGEodCk7XG4gICAgICAgIHJldHVybiBlLnNldE5ldHdvcmtFbmFibGVkKCExKSwgYXN5bmMgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgY29uc3QgZSA9IFUodCk7XG4gICAgICAgICAgICBlLktyLmFkZCgwIC8qIFVzZXJEaXNhYmxlZCAqLyksIGF3YWl0IHJvKGUpLCBcbiAgICAgICAgICAgIC8vIFNldCB0aGUgT25saW5lU3RhdGUgdG8gT2ZmbGluZSBzbyBnZXQoKXMgcmV0dXJuIGZyb20gY2FjaGUsIGV0Yy5cbiAgICAgICAgICAgIGUuV3Iuc2V0KFwiT2ZmbGluZVwiIC8qIE9mZmxpbmUgKi8pO1xuICAgICAgICB9KG4pO1xuICAgIH0pKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHdoZW4gYWxsIHdyaXRlcyB0aGF0IHdlcmUgcGVuZGluZyBhdCB0aGUgdGltZVxuICogdGhpcyBtZXRob2Qgd2FzIGNhbGxlZCByZWNlaXZlZCBzZXJ2ZXIgYWNrbm93bGVkZ2VtZW50LiBBbiBhY2tub3dsZWRnZW1lbnRcbiAqIGNhbiBiZSBlaXRoZXIgYWNjZXB0YW5jZSBvciByZWplY3Rpb24uXG4gKi8gZnVuY3Rpb24gdGModCwgZSkge1xuICAgIGNvbnN0IG4gPSBuZXcgajtcbiAgICByZXR1cm4gdC5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoKGFzeW5jICgpID0+IGFzeW5jIGZ1bmN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBhd2FpdCBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IFUodCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG4ucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJyZWFkIGRvY3VtZW50XCIsIFwicmVhZG9ubHlcIiwgKHQgPT4gbi5Rbi5Bbih0LCBlKSkpO1xuICAgICAgICAgICAgfSh0LCBlKTtcbiAgICAgICAgICAgIHMuaXNGb3VuZERvY3VtZW50KCkgPyBuLnJlc29sdmUocykgOiBzLmlzTm9Eb2N1bWVudCgpID8gbi5yZXNvbHZlKG51bGwpIDogbi5yZWplY3QobmV3IEsocS5VTkFWQUlMQUJMRSwgXCJGYWlsZWQgdG8gZ2V0IGRvY3VtZW50IGZyb20gY2FjaGUuIChIb3dldmVyLCB0aGlzIGRvY3VtZW50IG1heSBleGlzdCBvbiB0aGUgc2VydmVyLiBSdW4gYWdhaW4gd2l0aG91dCBzZXR0aW5nICdzb3VyY2UnIGluIHRoZSBHZXRPcHRpb25zIHRvIGF0dGVtcHQgdG8gcmV0cmlldmUgdGhlIGRvY3VtZW50IGZyb20gdGhlIHNlcnZlci4pXCIpKTtcbiAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgY29uc3QgcyA9IHhvKHQsIGBGYWlsZWQgdG8gZ2V0IGRvY3VtZW50ICcke2V9IGZyb20gY2FjaGVgKTtcbiAgICAgICAgICAgIG4ucmVqZWN0KHMpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICogUmV0cmlldmVzIGEgbGF0ZW5jeS1jb21wZW5zYXRlZCBkb2N1bWVudCBmcm9tIHRoZSBiYWNrZW5kIHZpYSBhXG4gKiBTbmFwc2hvdExpc3RlbmVyLlxuICovIChhd2FpdCB6YSh0KSwgZSwgbikpKSwgbi5wcm9taXNlO1xufVxuXG5mdW5jdGlvbiBlYyh0LCBlLCBuID0ge30pIHtcbiAgICBjb25zdCBzID0gbmV3IGo7XG4gICAgcmV0dXJuIHQuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KChhc3luYyAoKSA9PiBmdW5jdGlvbih0LCBlLCBuLCBzLCBpKSB7XG4gICAgICAgIGNvbnN0IHIgPSBuZXcgTWEoe1xuICAgICAgICAgICAgbmV4dDogciA9PiB7XG4gICAgICAgICAgICAgICAgLy8gUmVtb3ZlIHF1ZXJ5IGZpcnN0IGJlZm9yZSBwYXNzaW5nIGV2ZW50IHRvIHVzZXIgdG8gYXZvaWRcbiAgICAgICAgICAgICAgICAvLyB1c2VyIGFjdGlvbnMgYWZmZWN0aW5nIHRoZSBub3cgc3RhbGUgcXVlcnkuXG4gICAgICAgICAgICAgICAgZS5lbnF1ZXVlQW5kRm9yZ2V0KCgoKSA9PiBCbyh0LCBvKSkpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGEgPSByLmRvY3MuaGFzKG4pO1xuICAgICAgICAgICAgICAgICFhICYmIHIuZnJvbUNhY2hlID8gXG4gICAgICAgICAgICAgICAgLy8gVE9ETyhkaW1vbmQpOiBJZiB3ZSdyZSBvbmxpbmUgYW5kIHRoZSBkb2N1bWVudCBkb2Vzbid0XG4gICAgICAgICAgICAgICAgLy8gZXhpc3QgdGhlbiB3ZSByZXNvbHZlIHdpdGggYSBkb2MuZXhpc3RzIHNldCB0byBmYWxzZS4gSWZcbiAgICAgICAgICAgICAgICAvLyB3ZSdyZSBvZmZsaW5lIGhvd2V2ZXIsIHdlIHJlamVjdCB0aGUgUHJvbWlzZSBpbiB0aGlzXG4gICAgICAgICAgICAgICAgLy8gY2FzZS4gVHdvIG9wdGlvbnM6IDEpIENhY2hlIHRoZSBuZWdhdGl2ZSByZXNwb25zZSBmcm9tXG4gICAgICAgICAgICAgICAgLy8gdGhlIHNlcnZlciBzbyB3ZSBjYW4gZGVsaXZlciB0aGF0IGV2ZW4gd2hlbiB5b3UncmVcbiAgICAgICAgICAgICAgICAvLyBvZmZsaW5lIDIpIEFjdHVhbGx5IHJlamVjdCB0aGUgUHJvbWlzZSBpbiB0aGUgb25saW5lIGNhc2VcbiAgICAgICAgICAgICAgICAvLyBpZiB0aGUgZG9jdW1lbnQgZG9lc24ndCBleGlzdC5cbiAgICAgICAgICAgICAgICBpLnJlamVjdChuZXcgSyhxLlVOQVZBSUxBQkxFLCBcIkZhaWxlZCB0byBnZXQgZG9jdW1lbnQgYmVjYXVzZSB0aGUgY2xpZW50IGlzIG9mZmxpbmUuXCIpKSA6IGEgJiYgci5mcm9tQ2FjaGUgJiYgcyAmJiBcInNlcnZlclwiID09PSBzLnNvdXJjZSA/IGkucmVqZWN0KG5ldyBLKHEuVU5BVkFJTEFCTEUsICdGYWlsZWQgdG8gZ2V0IGRvY3VtZW50IGZyb20gc2VydmVyLiAoSG93ZXZlciwgdGhpcyBkb2N1bWVudCBkb2VzIGV4aXN0IGluIHRoZSBsb2NhbCBjYWNoZS4gUnVuIGFnYWluIHdpdGhvdXQgc2V0dGluZyBzb3VyY2UgdG8gXCJzZXJ2ZXJcIiB0byByZXRyaWV2ZSB0aGUgY2FjaGVkIGRvY3VtZW50LiknKSkgOiBpLnJlc29sdmUocik7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZXJyb3I6IHQgPT4gaS5yZWplY3QodClcbiAgICAgICAgfSksIG8gPSBuZXcgam8oZGUobi5wYXRoKSwgciwge1xuICAgICAgICAgICAgaW5jbHVkZU1ldGFkYXRhQ2hhbmdlczogITAsXG4gICAgICAgICAgICB1bzogITBcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBMbyh0LCBvKTtcbiAgICB9KGF3YWl0IFlhKHQpLCB0LmFzeW5jUXVldWUsIGUsIG4sIHMpKSksIHMucHJvbWlzZTtcbn1cblxuZnVuY3Rpb24gbmModCwgZSkge1xuICAgIGNvbnN0IG4gPSBuZXcgajtcbiAgICByZXR1cm4gdC5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoKGFzeW5jICgpID0+IGFzeW5jIGZ1bmN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBhd2FpdCBncih0LCBlLCBcbiAgICAgICAgICAgIC8qIHVzZVByZXZpb3VzUmVzdWx0cz0gKi8gITApLCBpID0gbmV3IFlvKGUsIHMuR24pLCByID0gaS5JbyhzLmRvY3VtZW50cyksIG8gPSBpLmFwcGx5Q2hhbmdlcyhyLCBcbiAgICAgICAgICAgIC8qIHVwZGF0ZUxpbWJvRG9jdW1lbnRzPSAqLyAhMSk7XG4gICAgICAgICAgICBuLnJlc29sdmUoby5zbmFwc2hvdCk7XG4gICAgICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSB4byh0LCBgRmFpbGVkIHRvIGV4ZWN1dGUgcXVlcnkgJyR7ZX0gYWdhaW5zdCBjYWNoZWApO1xuICAgICAgICAgICAgbi5yZWplY3Qocyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gKiBSZXRyaWV2ZXMgYSBsYXRlbmN5LWNvbXBlbnNhdGVkIHF1ZXJ5IHNuYXBzaG90IGZyb20gdGhlIGJhY2tlbmQgdmlhIGFcbiAqIFNuYXBzaG90TGlzdGVuZXIuXG4gKi8gKGF3YWl0IHphKHQpLCBlLCBuKSkpLCBuLnByb21pc2U7XG59XG5cbmZ1bmN0aW9uIHNjKHQsIGUsIG4gPSB7fSkge1xuICAgIGNvbnN0IHMgPSBuZXcgajtcbiAgICByZXR1cm4gdC5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoKGFzeW5jICgpID0+IGZ1bmN0aW9uKHQsIGUsIG4sIHMsIGkpIHtcbiAgICAgICAgY29uc3QgciA9IG5ldyBNYSh7XG4gICAgICAgICAgICBuZXh0OiBuID0+IHtcbiAgICAgICAgICAgICAgICAvLyBSZW1vdmUgcXVlcnkgZmlyc3QgYmVmb3JlIHBhc3NpbmcgZXZlbnQgdG8gdXNlciB0byBhdm9pZFxuICAgICAgICAgICAgICAgIC8vIHVzZXIgYWN0aW9ucyBhZmZlY3RpbmcgdGhlIG5vdyBzdGFsZSBxdWVyeS5cbiAgICAgICAgICAgICAgICBlLmVucXVldWVBbmRGb3JnZXQoKCgpID0+IEJvKHQsIG8pKSksIG4uZnJvbUNhY2hlICYmIFwic2VydmVyXCIgPT09IHMuc291cmNlID8gaS5yZWplY3QobmV3IEsocS5VTkFWQUlMQUJMRSwgJ0ZhaWxlZCB0byBnZXQgZG9jdW1lbnRzIGZyb20gc2VydmVyLiAoSG93ZXZlciwgdGhlc2UgZG9jdW1lbnRzIG1heSBleGlzdCBpbiB0aGUgbG9jYWwgY2FjaGUuIFJ1biBhZ2FpbiB3aXRob3V0IHNldHRpbmcgc291cmNlIHRvIFwic2VydmVyXCIgdG8gcmV0cmlldmUgdGhlIGNhY2hlZCBkb2N1bWVudHMuKScpKSA6IGkucmVzb2x2ZShuKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlcnJvcjogdCA9PiBpLnJlamVjdCh0KVxuICAgICAgICB9KSwgbyA9IG5ldyBqbyhuLCByLCB7XG4gICAgICAgICAgICBpbmNsdWRlTWV0YWRhdGFDaGFuZ2VzOiAhMCxcbiAgICAgICAgICAgIHVvOiAhMFxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIExvKHQsIG8pO1xuICAgIH0oYXdhaXQgWWEodCksIHQuYXN5bmNRdWV1ZSwgZSwgbiwgcykpKSwgcy5wcm9taXNlO1xufVxuXG5mdW5jdGlvbiBpYyh0LCBlKSB7XG4gICAgY29uc3QgbiA9IG5ldyBNYShlKTtcbiAgICByZXR1cm4gdC5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoKGFzeW5jICgpID0+IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgVSh0KS5aci5hZGQoZSksIFxuICAgICAgICAvLyBJbW1lZGlhdGVseSBmaXJlIGFuIGluaXRpYWwgZXZlbnQsIGluZGljYXRpbmcgYWxsIGV4aXN0aW5nIGxpc3RlbmVyc1xuICAgICAgICAvLyBhcmUgaW4tc3luYy5cbiAgICAgICAgZS5uZXh0KCk7XG4gICAgfShhd2FpdCBZYSh0KSwgbikpKSwgKCkgPT4ge1xuICAgICAgICBuLlhvKCksIHQuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KChhc3luYyAoKSA9PiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBVKHQpLlpyLmRlbGV0ZShlKTtcbiAgICAgICAgfShhd2FpdCBZYSh0KSwgbikpKTtcbiAgICB9O1xufVxuXG4vKipcbiAqIFRha2VzIGFuIHVwZGF0ZUZ1bmN0aW9uIGluIHdoaWNoIGEgc2V0IG9mIHJlYWRzIGFuZCB3cml0ZXMgY2FuIGJlIHBlcmZvcm1lZFxuICogYXRvbWljYWxseS4gSW4gdGhlIHVwZGF0ZUZ1bmN0aW9uLCB0aGUgY2xpZW50IGNhbiByZWFkIGFuZCB3cml0ZSB2YWx1ZXNcbiAqIHVzaW5nIHRoZSBzdXBwbGllZCB0cmFuc2FjdGlvbiBvYmplY3QuIEFmdGVyIHRoZSB1cGRhdGVGdW5jdGlvbiwgYWxsXG4gKiBjaGFuZ2VzIHdpbGwgYmUgY29tbWl0dGVkLiBJZiBhIHJldHJ5YWJsZSBlcnJvciBvY2N1cnMgKGV4OiBzb21lIG90aGVyXG4gKiBjbGllbnQgaGFzIGNoYW5nZWQgYW55IG9mIHRoZSBkYXRhIHJlZmVyZW5jZWQpLCB0aGVuIHRoZSB1cGRhdGVGdW5jdGlvblxuICogd2lsbCBiZSBjYWxsZWQgYWdhaW4gYWZ0ZXIgYSBiYWNrb2ZmLiBJZiB0aGUgdXBkYXRlRnVuY3Rpb24gc3RpbGwgZmFpbHNcbiAqIGFmdGVyIGFsbCByZXRyaWVzLCB0aGVuIHRoZSB0cmFuc2FjdGlvbiB3aWxsIGJlIHJlamVjdGVkLlxuICpcbiAqIFRoZSB0cmFuc2FjdGlvbiBvYmplY3QgcGFzc2VkIHRvIHRoZSB1cGRhdGVGdW5jdGlvbiBjb250YWlucyBtZXRob2RzIGZvclxuICogYWNjZXNzaW5nIGRvY3VtZW50cyBhbmQgY29sbGVjdGlvbnMuIFVubGlrZSBvdGhlciBkYXRhc3RvcmUgYWNjZXNzLCBkYXRhXG4gKiBhY2Nlc3NlZCB3aXRoIHRoZSB0cmFuc2FjdGlvbiB3aWxsIG5vdCByZWZsZWN0IGxvY2FsIGNoYW5nZXMgdGhhdCBoYXZlIG5vdFxuICogYmVlbiBjb21taXR0ZWQuIEZvciB0aGlzIHJlYXNvbiwgaXQgaXMgcmVxdWlyZWQgdGhhdCBhbGwgcmVhZHMgYXJlXG4gKiBwZXJmb3JtZWQgYmVmb3JlIGFueSB3cml0ZXMuIFRyYW5zYWN0aW9ucyBtdXN0IGJlIHBlcmZvcm1lZCB3aGlsZSBvbmxpbmUuXG4gKi8gZnVuY3Rpb24gcmModCwgZSkge1xuICAgIGNvbnN0IG4gPSBuZXcgajtcbiAgICByZXR1cm4gdC5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoKGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgcyA9IGF3YWl0IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIHJldHVybiBXYSh0KS50aGVuKCh0ID0+IHQuZGF0YXN0b3JlKSk7XG4gICAgICAgIH0odCk7XG4gICAgICAgIG5ldyBVYSh0LmFzeW5jUXVldWUsIHMsIGUsIG4pLnJ1bigpO1xuICAgIH0pKSwgbi5wcm9taXNlO1xufVxuXG5mdW5jdGlvbiBvYyh0LCBlLCBuLCBzKSB7XG4gICAgY29uc3QgaSA9IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgbGV0IG47XG4gICAgICAgIG4gPSBcInN0cmluZ1wiID09IHR5cGVvZiB0ID8gKG5ldyBUZXh0RW5jb2RlcikuZW5jb2RlKHQpIDogdDtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgTGEodCwgZSk7XG4gICAgICAgIH0oZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBVaW50OEFycmF5KSByZXR1cm4gRmEodCwgZSk7XG4gICAgICAgICAgICBpZiAodCBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSByZXR1cm4gRmEobmV3IFVpbnQ4QXJyYXkodCksIGUpO1xuICAgICAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBSZWFkYWJsZVN0cmVhbSkgcmV0dXJuIHQuZ2V0UmVhZGVyKCk7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJTb3VyY2Ugb2YgYHRvQnl0ZVN0cmVhbVJlYWRlcmAgaGFzIHRvIGJlIGEgQXJyYXlCdWZmZXIgb3IgUmVhZGFibGVTdHJlYW1cIik7XG4gICAgICAgIH0obiksIGUpO1xuICAgIH1cbiAgICAvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyAobiwgSnIoZSkpO1xuICAgIHQuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KChhc3luYyAoKSA9PiB7XG4gICAgICAgIE5hKGF3YWl0IEphKHQpLCBpLCBzKTtcbiAgICB9KSk7XG59XG5cbmZ1bmN0aW9uIGFjKHQsIGUpIHtcbiAgICByZXR1cm4gdC5hc3luY1F1ZXVlLmVucXVldWUoKGFzeW5jICgpID0+IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IFUodCk7XG4gICAgICAgIHJldHVybiBuLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiR2V0IG5hbWVkIHF1ZXJ5XCIsIFwicmVhZG9ubHlcIiwgKHQgPT4gbi5KZS5nZXROYW1lZFF1ZXJ5KHQsIGUpKSk7XG4gICAgfShhd2FpdCB6YSh0KSwgZSkpKTtcbn1cblxuY2xhc3MgY2Mge1xuICAgIC8qKlxuICAgICAqIENvbnN0cnVjdHMgYSBEYXRhYmFzZUluZm8gdXNpbmcgdGhlIHByb3ZpZGVkIGhvc3QsIGRhdGFiYXNlSWQgYW5kXG4gICAgICogcGVyc2lzdGVuY2VLZXkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZGF0YWJhc2VJZCAtIFRoZSBkYXRhYmFzZSB0byB1c2UuXG4gICAgICogQHBhcmFtIGFwcElkIC0gVGhlIEZpcmViYXNlIEFwcCBJZC5cbiAgICAgKiBAcGFyYW0gcGVyc2lzdGVuY2VLZXkgLSBBIHVuaXF1ZSBpZGVudGlmaWVyIGZvciB0aGlzIEZpcmVzdG9yZSdzIGxvY2FsXG4gICAgICogc3RvcmFnZSAodXNlZCBpbiBjb25qdW5jdGlvbiB3aXRoIHRoZSBkYXRhYmFzZUlkKS5cbiAgICAgKiBAcGFyYW0gaG9zdCAtIFRoZSBGaXJlc3RvcmUgYmFja2VuZCBob3N0IHRvIGNvbm5lY3QgdG8uXG4gICAgICogQHBhcmFtIHNzbCAtIFdoZXRoZXIgdG8gdXNlIFNTTCB3aGVuIGNvbm5lY3RpbmcuXG4gICAgICogQHBhcmFtIGZvcmNlTG9uZ1BvbGxpbmcgLSBXaGV0aGVyIHRvIHVzZSB0aGUgZm9yY2VMb25nUG9sbGluZyBvcHRpb25cbiAgICAgKiB3aGVuIHVzaW5nIFdlYkNoYW5uZWwgYXMgdGhlIG5ldHdvcmsgdHJhbnNwb3J0LlxuICAgICAqIEBwYXJhbSBhdXRvRGV0ZWN0TG9uZ1BvbGxpbmcgLSBXaGV0aGVyIHRvIHVzZSB0aGUgZGV0ZWN0QnVmZmVyaW5nUHJveHlcbiAgICAgKiBvcHRpb24gd2hlbiB1c2luZyBXZWJDaGFubmVsIGFzIHRoZSBuZXR3b3JrIHRyYW5zcG9ydC5cbiAgICAgKiBAcGFyYW0gdXNlRmV0Y2hTdHJlYW1zIFdoZXRoZXIgdG8gdXNlIHRoZSBGZXRjaCBBUEkgaW5zdGVhZCBvZlxuICAgICAqIFhNTEhUVFBSZXF1ZXN0XG4gICAgICovXG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcywgaSwgciwgbywgYSkge1xuICAgICAgICB0aGlzLmRhdGFiYXNlSWQgPSB0LCB0aGlzLmFwcElkID0gZSwgdGhpcy5wZXJzaXN0ZW5jZUtleSA9IG4sIHRoaXMuaG9zdCA9IHMsIHRoaXMuc3NsID0gaSwgXG4gICAgICAgIHRoaXMuZm9yY2VMb25nUG9sbGluZyA9IHIsIHRoaXMuYXV0b0RldGVjdExvbmdQb2xsaW5nID0gbywgdGhpcy51c2VGZXRjaFN0cmVhbXMgPSBhO1xuICAgIH1cbn1cblxuLyoqIFRoZSBkZWZhdWx0IGRhdGFiYXNlIG5hbWUgZm9yIGEgcHJvamVjdC4gKi9cbi8qKlxuICogUmVwcmVzZW50cyB0aGUgZGF0YWJhc2UgSUQgYSBGaXJlc3RvcmUgY2xpZW50IGlzIGFzc29jaWF0ZWQgd2l0aC5cbiAqIEBpbnRlcm5hbFxuICovXG5jbGFzcyB1YyB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLnByb2plY3RJZCA9IHQsIHRoaXMuZGF0YWJhc2UgPSBlIHx8IFwiKGRlZmF1bHQpXCI7XG4gICAgfVxuICAgIGdldCBpc0RlZmF1bHREYXRhYmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIFwiKGRlZmF1bHQpXCIgPT09IHRoaXMuZGF0YWJhc2U7XG4gICAgfVxuICAgIGlzRXF1YWwodCkge1xuICAgICAgICByZXR1cm4gdCBpbnN0YW5jZW9mIHVjICYmIHQucHJvamVjdElkID09PSB0aGlzLnByb2plY3RJZCAmJiB0LmRhdGFiYXNlID09PSB0aGlzLmRhdGFiYXNlO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY29uc3QgaGMgPSBuZXcgTWFwO1xuXG4vKipcbiAqIEFuIGluc3RhbmNlIG1hcCB0aGF0IGVuc3VyZXMgb25seSBvbmUgRGF0YXN0b3JlIGV4aXN0cyBwZXIgRmlyZXN0b3JlXG4gKiBpbnN0YW5jZS5cbiAqL1xuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmZ1bmN0aW9uIGxjKHQsIGUsIG4pIHtcbiAgICBpZiAoIW4pIHRocm93IG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgYEZ1bmN0aW9uICR7dH0oKSBjYW5ub3QgYmUgY2FsbGVkIHdpdGggYW4gZW1wdHkgJHtlfS5gKTtcbn1cblxuLyoqXG4gKiBWYWxpZGF0ZXMgdGhhdCB0d28gYm9vbGVhbiBvcHRpb25zIGFyZSBub3Qgc2V0IGF0IHRoZSBzYW1lIHRpbWUuXG4gKiBAaW50ZXJuYWxcbiAqLyBmdW5jdGlvbiBmYyh0LCBlLCBuLCBzKSB7XG4gICAgaWYgKCEwID09PSBlICYmICEwID09PSBzKSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIGAke3R9IGFuZCAke259IGNhbm5vdCBiZSB1c2VkIHRvZ2V0aGVyLmApO1xufVxuXG4vKipcbiAqIFZhbGlkYXRlcyB0aGF0IGBwYXRoYCByZWZlcnMgdG8gYSBkb2N1bWVudCAoaW5kaWNhdGVkIGJ5IHRoZSBmYWN0IGl0IGNvbnRhaW5zXG4gKiBhbiBldmVuIG51bWJlcnMgb2Ygc2VnbWVudHMpLlxuICovIGZ1bmN0aW9uIGRjKHQpIHtcbiAgICBpZiAoIVB0LmlzRG9jdW1lbnRLZXkodCkpIHRocm93IG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgYEludmFsaWQgZG9jdW1lbnQgcmVmZXJlbmNlLiBEb2N1bWVudCByZWZlcmVuY2VzIG11c3QgaGF2ZSBhbiBldmVuIG51bWJlciBvZiBzZWdtZW50cywgYnV0ICR7dH0gaGFzICR7dC5sZW5ndGh9LmApO1xufVxuXG4vKipcbiAqIFZhbGlkYXRlcyB0aGF0IGBwYXRoYCByZWZlcnMgdG8gYSBjb2xsZWN0aW9uIChpbmRpY2F0ZWQgYnkgdGhlIGZhY3QgaXRcbiAqIGNvbnRhaW5zIGFuIG9kZCBudW1iZXJzIG9mIHNlZ21lbnRzKS5cbiAqLyBmdW5jdGlvbiB3Yyh0KSB7XG4gICAgaWYgKFB0LmlzRG9jdW1lbnRLZXkodCkpIHRocm93IG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgYEludmFsaWQgY29sbGVjdGlvbiByZWZlcmVuY2UuIENvbGxlY3Rpb24gcmVmZXJlbmNlcyBtdXN0IGhhdmUgYW4gb2RkIG51bWJlciBvZiBzZWdtZW50cywgYnV0ICR7dH0gaGFzICR7dC5sZW5ndGh9LmApO1xufVxuXG4vKipcbiAqIFJldHVybnMgdHJ1ZSBpZiBpdCdzIGEgbm9uLW51bGwgb2JqZWN0IHdpdGhvdXQgYSBjdXN0b20gcHJvdG90eXBlXG4gKiAoaS5lLiBleGNsdWRlcyBBcnJheSwgRGF0ZSwgZXRjLikuXG4gKi9cbi8qKiBSZXR1cm5zIGEgc3RyaW5nIGRlc2NyaWJpbmcgdGhlIHR5cGUgLyB2YWx1ZSBvZiB0aGUgcHJvdmlkZWQgaW5wdXQuICovXG5mdW5jdGlvbiBfYyh0KSB7XG4gICAgaWYgKHZvaWQgMCA9PT0gdCkgcmV0dXJuIFwidW5kZWZpbmVkXCI7XG4gICAgaWYgKG51bGwgPT09IHQpIHJldHVybiBcIm51bGxcIjtcbiAgICBpZiAoXCJzdHJpbmdcIiA9PSB0eXBlb2YgdCkgcmV0dXJuIHQubGVuZ3RoID4gMjAgJiYgKHQgPSBgJHt0LnN1YnN0cmluZygwLCAyMCl9Li4uYCksIFxuICAgIEpTT04uc3RyaW5naWZ5KHQpO1xuICAgIGlmIChcIm51bWJlclwiID09IHR5cGVvZiB0IHx8IFwiYm9vbGVhblwiID09IHR5cGVvZiB0KSByZXR1cm4gXCJcIiArIHQ7XG4gICAgaWYgKFwib2JqZWN0XCIgPT0gdHlwZW9mIHQpIHtcbiAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBBcnJheSkgcmV0dXJuIFwiYW4gYXJyYXlcIjtcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgZSA9IFxuICAgICAgICAgICAgLyoqIEhhY2t5IG1ldGhvZCB0byB0cnkgdG8gZ2V0IHRoZSBjb25zdHJ1Y3RvciBuYW1lIGZvciBhbiBvYmplY3QuICovXG4gICAgICAgICAgICBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgaWYgKHQuY29uc3RydWN0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IC9mdW5jdGlvblxccysoW15cXHMoXSspXFxzKlxcKC8uZXhlYyh0LmNvbnN0cnVjdG9yLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZSAmJiBlLmxlbmd0aCA+IDEpIHJldHVybiBlWzFdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qKlxuICogQ2FzdHMgYG9iamAgdG8gYFRgLCBvcHRpb25hbGx5IHVud3JhcHBpbmcgQ29tcGF0IHR5cGVzIHRvIGV4cG9zZSB0aGVcbiAqIHVuZGVybHlpbmcgaW5zdGFuY2UuIFRocm93cyBpZiAgYG9iamAgaXMgbm90IGFuIGluc3RhbmNlIG9mIGBUYC5cbiAqXG4gKiBUaGlzIGNhc3QgaXMgdXNlZCBpbiB0aGUgTGl0ZSBhbmQgRnVsbCBTREsgdG8gdmVyaWZ5IGluc3RhbmNlIHR5cGVzIGZvclxuICogYXJndW1lbnRzIHBhc3NlZCB0byB0aGUgcHVibGljIEFQSS5cbiAqIEBpbnRlcm5hbFxuICovICh0KTtcbiAgICAgICAgICAgIHJldHVybiBlID8gYGEgY3VzdG9tICR7ZX0gb2JqZWN0YCA6IFwiYW4gb2JqZWN0XCI7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgdCA/IFwiYSBmdW5jdGlvblwiIDogTSgpO1xufVxuXG5mdW5jdGlvbiBtYyh0LCBcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG5lKSB7XG4gICAgaWYgKFwiX2RlbGVnYXRlXCIgaW4gdCAmJiAoXG4gICAgLy8gVW53cmFwIENvbXBhdCB0eXBlc1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgdCA9IHQuX2RlbGVnYXRlKSwgISh0IGluc3RhbmNlb2YgZSkpIHtcbiAgICAgICAgaWYgKGUubmFtZSA9PT0gdC5jb25zdHJ1Y3Rvci5uYW1lKSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIFwiVHlwZSBkb2VzIG5vdCBtYXRjaCB0aGUgZXhwZWN0ZWQgaW5zdGFuY2UuIERpZCB5b3UgcGFzcyBhIHJlZmVyZW5jZSBmcm9tIGEgZGlmZmVyZW50IEZpcmVzdG9yZSBTREs/XCIpO1xuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBuID0gX2ModCk7XG4gICAgICAgICAgICB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIGBFeHBlY3RlZCB0eXBlICcke2UubmFtZX0nLCBidXQgaXQgd2FzOiAke259YCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHQ7XG59XG5cbmZ1bmN0aW9uIGdjKHQsIGUpIHtcbiAgICBpZiAoZSA8PSAwKSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIGBGdW5jdGlvbiAke3R9KCkgcmVxdWlyZXMgYSBwb3NpdGl2ZSBudW1iZXIsIGJ1dCBpdCB3YXM6ICR7ZX0uYCk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vLyBzZXR0aW5ncygpIGRlZmF1bHRzOlxuLyoqXG4gKiBBIGNvbmNyZXRlIHR5cGUgZGVzY3JpYmluZyBhbGwgdGhlIHZhbHVlcyB0aGF0IGNhbiBiZSBhcHBsaWVkIHZpYSBhXG4gKiB1c2VyLXN1cHBsaWVkIGBGaXJlc3RvcmVTZXR0aW5nc2Agb2JqZWN0LiBUaGlzIGlzIGEgc2VwYXJhdGUgdHlwZSBzbyB0aGF0XG4gKiBkZWZhdWx0cyBjYW4gYmUgc3VwcGxpZWQgYW5kIHRoZSB2YWx1ZSBjYW4gYmUgY2hlY2tlZCBmb3IgZXF1YWxpdHkuXG4gKi9cbmNsYXNzIHljIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHZhciBlO1xuICAgICAgICBpZiAodm9pZCAwID09PSB0Lmhvc3QpIHtcbiAgICAgICAgICAgIGlmICh2b2lkIDAgIT09IHQuc3NsKSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIFwiQ2FuJ3QgcHJvdmlkZSBzc2wgb3B0aW9uIGlmIGhvc3Qgb3B0aW9uIGlzIG5vdCBzZXRcIik7XG4gICAgICAgICAgICB0aGlzLmhvc3QgPSBcImZpcmVzdG9yZS5nb29nbGVhcGlzLmNvbVwiLCB0aGlzLnNzbCA9IHRydWU7XG4gICAgICAgIH0gZWxzZSB0aGlzLmhvc3QgPSB0Lmhvc3QsIHRoaXMuc3NsID0gbnVsbCA9PT0gKGUgPSB0LnNzbCkgfHwgdm9pZCAwID09PSBlIHx8IGU7XG4gICAgICAgIGlmICh0aGlzLmNyZWRlbnRpYWxzID0gdC5jcmVkZW50aWFscywgdGhpcy5pZ25vcmVVbmRlZmluZWRQcm9wZXJ0aWVzID0gISF0Lmlnbm9yZVVuZGVmaW5lZFByb3BlcnRpZXMsIFxuICAgICAgICB2b2lkIDAgPT09IHQuY2FjaGVTaXplQnl0ZXMpIHRoaXMuY2FjaGVTaXplQnl0ZXMgPSA0MTk0MzA0MDsgZWxzZSB7XG4gICAgICAgICAgICBpZiAoLTEgIT09IHQuY2FjaGVTaXplQnl0ZXMgJiYgdC5jYWNoZVNpemVCeXRlcyA8IDEwNDg1NzYpIHRocm93IG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgXCJjYWNoZVNpemVCeXRlcyBtdXN0IGJlIGF0IGxlYXN0IDEwNDg1NzZcIik7XG4gICAgICAgICAgICB0aGlzLmNhY2hlU2l6ZUJ5dGVzID0gdC5jYWNoZVNpemVCeXRlcztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmV4cGVyaW1lbnRhbEZvcmNlTG9uZ1BvbGxpbmcgPSAhIXQuZXhwZXJpbWVudGFsRm9yY2VMb25nUG9sbGluZywgdGhpcy5leHBlcmltZW50YWxBdXRvRGV0ZWN0TG9uZ1BvbGxpbmcgPSAhIXQuZXhwZXJpbWVudGFsQXV0b0RldGVjdExvbmdQb2xsaW5nLCBcbiAgICAgICAgdGhpcy51c2VGZXRjaFN0cmVhbXMgPSAhIXQudXNlRmV0Y2hTdHJlYW1zLCBmYyhcImV4cGVyaW1lbnRhbEZvcmNlTG9uZ1BvbGxpbmdcIiwgdC5leHBlcmltZW50YWxGb3JjZUxvbmdQb2xsaW5nLCBcImV4cGVyaW1lbnRhbEF1dG9EZXRlY3RMb25nUG9sbGluZ1wiLCB0LmV4cGVyaW1lbnRhbEF1dG9EZXRlY3RMb25nUG9sbGluZyk7XG4gICAgfVxuICAgIGlzRXF1YWwodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5ob3N0ID09PSB0Lmhvc3QgJiYgdGhpcy5zc2wgPT09IHQuc3NsICYmIHRoaXMuY3JlZGVudGlhbHMgPT09IHQuY3JlZGVudGlhbHMgJiYgdGhpcy5jYWNoZVNpemVCeXRlcyA9PT0gdC5jYWNoZVNpemVCeXRlcyAmJiB0aGlzLmV4cGVyaW1lbnRhbEZvcmNlTG9uZ1BvbGxpbmcgPT09IHQuZXhwZXJpbWVudGFsRm9yY2VMb25nUG9sbGluZyAmJiB0aGlzLmV4cGVyaW1lbnRhbEF1dG9EZXRlY3RMb25nUG9sbGluZyA9PT0gdC5leHBlcmltZW50YWxBdXRvRGV0ZWN0TG9uZ1BvbGxpbmcgJiYgdGhpcy5pZ25vcmVVbmRlZmluZWRQcm9wZXJ0aWVzID09PSB0Lmlnbm9yZVVuZGVmaW5lZFByb3BlcnRpZXMgJiYgdGhpcy51c2VGZXRjaFN0cmVhbXMgPT09IHQudXNlRmV0Y2hTdHJlYW1zO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogVGhlIENsb3VkIEZpcmVzdG9yZSBzZXJ2aWNlIGludGVyZmFjZS5cbiAqXG4gKiBEbyBub3QgY2FsbCB0aGlzIGNvbnN0cnVjdG9yIGRpcmVjdGx5LiBJbnN0ZWFkLCB1c2Uge0BsaW5rIGdldEZpcmVzdG9yZX0uXG4gKi8gY2xhc3MgcGMge1xuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yICovXG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLl9jcmVkZW50aWFscyA9IGUsIFxuICAgICAgICAvKipcbiAgICAgICAgICogV2hldGhlciBpdCdzIGEgRmlyZXN0b3JlIG9yIEZpcmVzdG9yZSBMaXRlIGluc3RhbmNlLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy50eXBlID0gXCJmaXJlc3RvcmUtbGl0ZVwiLCB0aGlzLl9wZXJzaXN0ZW5jZUtleSA9IFwiKGxpdGUpXCIsIHRoaXMuX3NldHRpbmdzID0gbmV3IHljKHt9KSwgXG4gICAgICAgIHRoaXMuX3NldHRpbmdzRnJvemVuID0gITEsIHQgaW5zdGFuY2VvZiB1YyA/IHRoaXMuX2RhdGFiYXNlSWQgPSB0IDogKHRoaXMuX2FwcCA9IHQsIFxuICAgICAgICB0aGlzLl9kYXRhYmFzZUlkID0gZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgaWYgKCFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmFwcGx5KHQub3B0aW9ucywgWyBcInByb2plY3RJZFwiIF0pKSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsICdcInByb2plY3RJZFwiIG5vdCBwcm92aWRlZCBpbiBmaXJlYmFzZS5pbml0aWFsaXplQXBwLicpO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyB1Yyh0Lm9wdGlvbnMucHJvamVjdElkKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAqIE1vZGlmeSB0aGlzIGluc3RhbmNlIHRvIGNvbW11bmljYXRlIHdpdGggdGhlIENsb3VkIEZpcmVzdG9yZSBlbXVsYXRvci5cbiAqXG4gKiBOb3RlOiBUaGlzIG11c3QgYmUgY2FsbGVkIGJlZm9yZSB0aGlzIGluc3RhbmNlIGhhcyBiZWVuIHVzZWQgdG8gZG8gYW55XG4gKiBvcGVyYXRpb25zLlxuICpcbiAqIEBwYXJhbSBmaXJlc3RvcmUgLSBUaGUgYEZpcmVzdG9yZWAgaW5zdGFuY2UgdG8gY29uZmlndXJlIHRvIGNvbm5lY3QgdG8gdGhlXG4gKiBlbXVsYXRvci5cbiAqIEBwYXJhbSBob3N0IC0gdGhlIGVtdWxhdG9yIGhvc3QgKGV4OiBsb2NhbGhvc3QpLlxuICogQHBhcmFtIHBvcnQgLSB0aGUgZW11bGF0b3IgcG9ydCAoZXg6IDkwMDApLlxuICogQHBhcmFtIG9wdGlvbnMubW9ja1VzZXJUb2tlbiAtIHRoZSBtb2NrIGF1dGggdG9rZW4gdG8gdXNlIGZvciB1bml0IHRlc3RpbmdcbiAqIFNlY3VyaXR5IFJ1bGVzLlxuICovICh0KSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSB7QGxpbmsgQGZpcmViYXNlL2FwcCNGaXJlYmFzZUFwcH0gYXNzb2NpYXRlZCB3aXRoIHRoaXMgYEZpcmVzdG9yZWAgc2VydmljZVxuICAgICAqIGluc3RhbmNlLlxuICAgICAqLyAgICBnZXQgYXBwKCkge1xuICAgICAgICBpZiAoIXRoaXMuX2FwcCkgdGhyb3cgbmV3IEsocS5GQUlMRURfUFJFQ09ORElUSU9OLCBcIkZpcmVzdG9yZSB3YXMgbm90IGluaXRpYWxpemVkIHVzaW5nIHRoZSBGaXJlYmFzZSBTREsuICdhcHAnIGlzIG5vdCBhdmFpbGFibGVcIik7XG4gICAgICAgIHJldHVybiB0aGlzLl9hcHA7XG4gICAgfVxuICAgIGdldCBfaW5pdGlhbGl6ZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zZXR0aW5nc0Zyb3plbjtcbiAgICB9XG4gICAgZ2V0IF90ZXJtaW5hdGVkKCkge1xuICAgICAgICByZXR1cm4gdm9pZCAwICE9PSB0aGlzLl90ZXJtaW5hdGVUYXNrO1xuICAgIH1cbiAgICBfc2V0U2V0dGluZ3ModCkge1xuICAgICAgICBpZiAodGhpcy5fc2V0dGluZ3NGcm96ZW4pIHRocm93IG5ldyBLKHEuRkFJTEVEX1BSRUNPTkRJVElPTiwgXCJGaXJlc3RvcmUgaGFzIGFscmVhZHkgYmVlbiBzdGFydGVkIGFuZCBpdHMgc2V0dGluZ3MgY2FuIG5vIGxvbmdlciBiZSBjaGFuZ2VkLiBZb3UgY2FuIG9ubHkgbW9kaWZ5IHNldHRpbmdzIGJlZm9yZSBjYWxsaW5nIGFueSBvdGhlciBtZXRob2RzIG9uIGEgRmlyZXN0b3JlIG9iamVjdC5cIik7XG4gICAgICAgIHRoaXMuX3NldHRpbmdzID0gbmV3IHljKHQpLCB2b2lkIDAgIT09IHQuY3JlZGVudGlhbHMgJiYgKHRoaXMuX2NyZWRlbnRpYWxzID0gZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgaWYgKCF0KSByZXR1cm4gbmV3IFc7XG4gICAgICAgICAgICBzd2l0Y2ggKHQudHlwZSkge1xuICAgICAgICAgICAgICBjYXNlIFwiZ2FwaVwiOlxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LmNsaWVudDtcbiAgICAgICAgICAgICAgICAvLyBNYWtlIHN1cmUgdGhpcyByZWFsbHkgaXMgYSBHYXBpIGNsaWVudC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEwoIShcIm9iamVjdFwiICE9IHR5cGVvZiBlIHx8IG51bGwgPT09IGUgfHwgIWUuYXV0aCB8fCAhZS5hdXRoLmdldEF1dGhIZWFkZXJWYWx1ZUZvckZpcnN0UGFydHkpKSwgXG4gICAgICAgICAgICAgICAgbmV3IEooZSwgdC5zZXNzaW9uSW5kZXggfHwgXCIwXCIsIHQuaWFtVG9rZW4gfHwgbnVsbCk7XG5cbiAgICAgICAgICAgICAgY2FzZSBcInByb3ZpZGVyXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHQuY2xpZW50O1xuXG4gICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEsocS5JTlZBTElEX0FSR1VNRU5ULCBcIm1ha2VDcmVkZW50aWFsc1Byb3ZpZGVyIGZhaWxlZCBkdWUgdG8gaW52YWxpZCBjcmVkZW50aWFsIHR5cGVcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0odC5jcmVkZW50aWFscykpO1xuICAgIH1cbiAgICBfZ2V0U2V0dGluZ3MoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zZXR0aW5ncztcbiAgICB9XG4gICAgX2ZyZWV6ZVNldHRpbmdzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc2V0dGluZ3NGcm96ZW4gPSAhMCwgdGhpcy5fc2V0dGluZ3M7XG4gICAgfVxuICAgIF9kZWxldGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl90ZXJtaW5hdGVUYXNrIHx8ICh0aGlzLl90ZXJtaW5hdGVUYXNrID0gdGhpcy5fdGVybWluYXRlKCkpLCB0aGlzLl90ZXJtaW5hdGVUYXNrO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyBhIEpTT04tc2VyaWFsaXphYmxlIHJlcHJlc2VudGF0aW9uIG9mIHRoaXMgYEZpcmVzdG9yZWAgaW5zdGFuY2UuICovICAgIHRvSlNPTigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGFwcDogdGhpcy5fYXBwLFxuICAgICAgICAgICAgZGF0YWJhc2VJZDogdGhpcy5fZGF0YWJhc2VJZCxcbiAgICAgICAgICAgIHNldHRpbmdzOiB0aGlzLl9zZXR0aW5nc1xuICAgICAgICB9O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUZXJtaW5hdGVzIGFsbCBjb21wb25lbnRzIHVzZWQgYnkgdGhpcyBjbGllbnQuIFN1YmNsYXNzZXMgY2FuIG92ZXJyaWRlXG4gICAgICogdGhpcyBtZXRob2QgdG8gY2xlYW4gdXAgdGhlaXIgb3duIGRlcGVuZGVuY2llcywgYnV0IG11c3QgYWxzbyBjYWxsIHRoaXNcbiAgICAgKiBtZXRob2QuXG4gICAgICpcbiAgICAgKiBPbmx5IGV2ZXIgY2FsbGVkIG9uY2UuXG4gICAgICovICAgIF90ZXJtaW5hdGUoKSB7XG4gICAgICAgIC8qKlxuICogUmVtb3ZlcyBhbGwgY29tcG9uZW50cyBhc3NvY2lhdGVkIHdpdGggdGhlIHByb3ZpZGVkIGluc3RhbmNlLiBNdXN0IGJlIGNhbGxlZFxuICogd2hlbiB0aGUgYEZpcmVzdG9yZWAgaW5zdGFuY2UgaXMgdGVybWluYXRlZC5cbiAqL1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgY29uc3QgZSA9IGhjLmdldCh0KTtcbiAgICAgICAgICAgIGUgJiYgKGsoXCJDb21wb25lbnRQcm92aWRlclwiLCBcIlJlbW92aW5nIERhdGFzdG9yZVwiKSwgaGMuZGVsZXRlKHQpLCBlLnRlcm1pbmF0ZSgpKTtcbiAgICAgICAgfSh0aGlzKSwgUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBFYyh0LCBlLCBuLCBzID0ge30pIHtcbiAgICB2YXIgaTtcbiAgICBjb25zdCByID0gKHQgPSBtYyh0LCBwYykpLl9nZXRTZXR0aW5ncygpO1xuICAgIGlmIChcImZpcmVzdG9yZS5nb29nbGVhcGlzLmNvbVwiICE9PSByLmhvc3QgJiYgci5ob3N0ICE9PSBlICYmIE8oXCJIb3N0IGhhcyBiZWVuIHNldCBpbiBib3RoIHNldHRpbmdzKCkgYW5kIHVzZUVtdWxhdG9yKCksIGVtdWxhdG9yIGhvc3Qgd2lsbCBiZSB1c2VkXCIpLCBcbiAgICB0Ll9zZXRTZXR0aW5ncyhPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIHIpLCB7XG4gICAgICAgIGhvc3Q6IGAke2V9OiR7bn1gLFxuICAgICAgICBzc2w6ICExXG4gICAgfSkpLCBzLm1vY2tVc2VyVG9rZW4pIHtcbiAgICAgICAgbGV0IGUsIG47XG4gICAgICAgIGlmIChcInN0cmluZ1wiID09IHR5cGVvZiBzLm1vY2tVc2VyVG9rZW4pIGUgPSBzLm1vY2tVc2VyVG9rZW4sIG4gPSBTLk1PQ0tfVVNFUjsgZWxzZSB7XG4gICAgICAgICAgICAvLyBMZXQgY3JlYXRlTW9ja1VzZXJUb2tlbiB2YWxpZGF0ZSBmaXJzdCAoY2F0Y2hlcyBjb21tb24gbWlzdGFrZXMgbGlrZVxuICAgICAgICAgICAgLy8gaW52YWxpZCBmaWVsZCBcInVpZFwiIGFuZCBtaXNzaW5nIGZpZWxkIFwic3ViXCIgLyBcInVzZXJfaWRcIi4pXG4gICAgICAgICAgICBlID0gZyhzLm1vY2tVc2VyVG9rZW4sIG51bGwgPT09IChpID0gdC5fYXBwKSB8fCB2b2lkIDAgPT09IGkgPyB2b2lkIDAgOiBpLm9wdGlvbnMucHJvamVjdElkKTtcbiAgICAgICAgICAgIGNvbnN0IHIgPSBzLm1vY2tVc2VyVG9rZW4uc3ViIHx8IHMubW9ja1VzZXJUb2tlbi51c2VyX2lkO1xuICAgICAgICAgICAgaWYgKCFyKSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIFwibW9ja1VzZXJUb2tlbiBtdXN0IGNvbnRhaW4gJ3N1Yicgb3IgJ3VzZXJfaWQnIGZpZWxkIVwiKTtcbiAgICAgICAgICAgIG4gPSBuZXcgUyhyKTtcbiAgICAgICAgfVxuICAgICAgICB0Ll9jcmVkZW50aWFscyA9IG5ldyBHKG5ldyBRKGUsIG4pKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEEgYERvY3VtZW50UmVmZXJlbmNlYCByZWZlcnMgdG8gYSBkb2N1bWVudCBsb2NhdGlvbiBpbiBhIEZpcmVzdG9yZSBkYXRhYmFzZVxuICogYW5kIGNhbiBiZSB1c2VkIHRvIHdyaXRlLCByZWFkLCBvciBsaXN0ZW4gdG8gdGhlIGxvY2F0aW9uLiBUaGUgZG9jdW1lbnQgYXRcbiAqIHRoZSByZWZlcmVuY2VkIGxvY2F0aW9uIG1heSBvciBtYXkgbm90IGV4aXN0LlxuICovIGNsYXNzIFRjIHtcbiAgICAvKiogQGhpZGVjb25zdHJ1Y3RvciAqL1xuICAgIGNvbnN0cnVjdG9yKHQsIFxuICAgIC8qKlxuICAgICAqIElmIHByb3ZpZGVkLCB0aGUgYEZpcmVzdG9yZURhdGFDb252ZXJ0ZXJgIGFzc29jaWF0ZWQgd2l0aCB0aGlzIGluc3RhbmNlLlxuICAgICAqL1xuICAgIGUsIG4pIHtcbiAgICAgICAgdGhpcy5jb252ZXJ0ZXIgPSBlLCB0aGlzLl9rZXkgPSBuLCBcbiAgICAgICAgLyoqIFRoZSB0eXBlIG9mIHRoaXMgRmlyZXN0b3JlIHJlZmVyZW5jZS4gKi9cbiAgICAgICAgdGhpcy50eXBlID0gXCJkb2N1bWVudFwiLCB0aGlzLmZpcmVzdG9yZSA9IHQ7XG4gICAgfVxuICAgIGdldCBfcGF0aCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2tleS5wYXRoO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgZG9jdW1lbnQncyBpZGVudGlmaWVyIHdpdGhpbiBpdHMgY29sbGVjdGlvbi5cbiAgICAgKi8gICAgZ2V0IGlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fa2V5LnBhdGgubGFzdFNlZ21lbnQoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQSBzdHJpbmcgcmVwcmVzZW50aW5nIHRoZSBwYXRoIG9mIHRoZSByZWZlcmVuY2VkIGRvY3VtZW50IChyZWxhdGl2ZVxuICAgICAqIHRvIHRoZSByb290IG9mIHRoZSBkYXRhYmFzZSkuXG4gICAgICovICAgIGdldCBwYXRoKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fa2V5LnBhdGguY2Fub25pY2FsU3RyaW5nKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSBjb2xsZWN0aW9uIHRoaXMgYERvY3VtZW50UmVmZXJlbmNlYCBiZWxvbmdzIHRvLlxuICAgICAqLyAgICBnZXQgcGFyZW50KCkge1xuICAgICAgICByZXR1cm4gbmV3IEFjKHRoaXMuZmlyZXN0b3JlLCB0aGlzLmNvbnZlcnRlciwgdGhpcy5fa2V5LnBhdGgucG9wTGFzdCgpKTtcbiAgICB9XG4gICAgd2l0aENvbnZlcnRlcih0KSB7XG4gICAgICAgIHJldHVybiBuZXcgVGModGhpcy5maXJlc3RvcmUsIHQsIHRoaXMuX2tleSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEEgYFF1ZXJ5YCByZWZlcnMgdG8gYSBxdWVyeSB3aGljaCB5b3UgY2FuIHJlYWQgb3IgbGlzdGVuIHRvLiBZb3UgY2FuIGFsc29cbiAqIGNvbnN0cnVjdCByZWZpbmVkIGBRdWVyeWAgb2JqZWN0cyBieSBhZGRpbmcgZmlsdGVycyBhbmQgb3JkZXJpbmcuXG4gKi8gY2xhc3MgSWMge1xuICAgIC8vIFRoaXMgaXMgdGhlIGxpdGUgdmVyc2lvbiBvZiB0aGUgUXVlcnkgY2xhc3MgaW4gdGhlIG1haW4gU0RLLlxuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yIHByb3RlY3RlZCAqL1xuICAgIGNvbnN0cnVjdG9yKHQsIFxuICAgIC8qKlxuICAgICAqIElmIHByb3ZpZGVkLCB0aGUgYEZpcmVzdG9yZURhdGFDb252ZXJ0ZXJgIGFzc29jaWF0ZWQgd2l0aCB0aGlzIGluc3RhbmNlLlxuICAgICAqL1xuICAgIGUsIG4pIHtcbiAgICAgICAgdGhpcy5jb252ZXJ0ZXIgPSBlLCB0aGlzLl9xdWVyeSA9IG4sIFxuICAgICAgICAvKiogVGhlIHR5cGUgb2YgdGhpcyBGaXJlc3RvcmUgcmVmZXJlbmNlLiAqL1xuICAgICAgICB0aGlzLnR5cGUgPSBcInF1ZXJ5XCIsIHRoaXMuZmlyZXN0b3JlID0gdDtcbiAgICB9XG4gICAgd2l0aENvbnZlcnRlcih0KSB7XG4gICAgICAgIHJldHVybiBuZXcgSWModGhpcy5maXJlc3RvcmUsIHQsIHRoaXMuX3F1ZXJ5KTtcbiAgICB9XG59XG5cbi8qKlxuICogQSBgQ29sbGVjdGlvblJlZmVyZW5jZWAgb2JqZWN0IGNhbiBiZSB1c2VkIGZvciBhZGRpbmcgZG9jdW1lbnRzLCBnZXR0aW5nXG4gKiBkb2N1bWVudCByZWZlcmVuY2VzLCBhbmQgcXVlcnlpbmcgZm9yIGRvY3VtZW50cyAodXNpbmcge0BsaW5rIHF1ZXJ5fSkuXG4gKi8gY2xhc3MgQWMgZXh0ZW5kcyBJYyB7XG4gICAgLyoqIEBoaWRlY29uc3RydWN0b3IgKi9cbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHN1cGVyKHQsIGUsIGRlKG4pKSwgdGhpcy5fcGF0aCA9IG4sIFxuICAgICAgICAvKiogVGhlIHR5cGUgb2YgdGhpcyBGaXJlc3RvcmUgcmVmZXJlbmNlLiAqL1xuICAgICAgICB0aGlzLnR5cGUgPSBcImNvbGxlY3Rpb25cIjtcbiAgICB9XG4gICAgLyoqIFRoZSBjb2xsZWN0aW9uJ3MgaWRlbnRpZmllci4gKi8gICAgZ2V0IGlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcXVlcnkucGF0aC5sYXN0U2VnbWVudCgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBIHN0cmluZyByZXByZXNlbnRpbmcgdGhlIHBhdGggb2YgdGhlIHJlZmVyZW5jZWQgY29sbGVjdGlvbiAocmVsYXRpdmVcbiAgICAgKiB0byB0aGUgcm9vdCBvZiB0aGUgZGF0YWJhc2UpLlxuICAgICAqLyAgICBnZXQgcGF0aCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3F1ZXJ5LnBhdGguY2Fub25pY2FsU3RyaW5nKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEEgcmVmZXJlbmNlIHRvIHRoZSBjb250YWluaW5nIGBEb2N1bWVudFJlZmVyZW5jZWAgaWYgdGhpcyBpcyBhXG4gICAgICogc3ViY29sbGVjdGlvbi4gSWYgdGhpcyBpc24ndCBhIHN1YmNvbGxlY3Rpb24sIHRoZSByZWZlcmVuY2UgaXMgbnVsbC5cbiAgICAgKi8gICAgZ2V0IHBhcmVudCgpIHtcbiAgICAgICAgY29uc3QgdCA9IHRoaXMuX3BhdGgucG9wTGFzdCgpO1xuICAgICAgICByZXR1cm4gdC5pc0VtcHR5KCkgPyBudWxsIDogbmV3IFRjKHRoaXMuZmlyZXN0b3JlLCBcbiAgICAgICAgLyogY29udmVydGVyPSAqLyBudWxsLCBuZXcgUHQodCkpO1xuICAgIH1cbiAgICB3aXRoQ29udmVydGVyKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBBYyh0aGlzLmZpcmVzdG9yZSwgdCwgdGhpcy5fcGF0aCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBSYyh0LCBlLCAuLi5uKSB7XG4gICAgaWYgKHQgPSB5KHQpLCBsYyhcImNvbGxlY3Rpb25cIiwgXCJwYXRoXCIsIGUpLCB0IGluc3RhbmNlb2YgcGMpIHtcbiAgICAgICAgY29uc3QgcyA9IHV0LmZyb21TdHJpbmcoZSwgLi4ubik7XG4gICAgICAgIHJldHVybiB3YyhzKSwgbmV3IEFjKHQsIC8qIGNvbnZlcnRlcj0gKi8gbnVsbCwgcyk7XG4gICAgfVxuICAgIHtcbiAgICAgICAgaWYgKCEodCBpbnN0YW5jZW9mIFRjIHx8IHQgaW5zdGFuY2VvZiBBYykpIHRocm93IG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgXCJFeHBlY3RlZCBmaXJzdCBhcmd1bWVudCB0byBjb2xsZWN0aW9uKCkgdG8gYmUgYSBDb2xsZWN0aW9uUmVmZXJlbmNlLCBhIERvY3VtZW50UmVmZXJlbmNlIG9yIEZpcmViYXNlRmlyZXN0b3JlXCIpO1xuICAgICAgICBjb25zdCBzID0gdXQuZnJvbVN0cmluZyh0LnBhdGgsIC4uLm4pLmNoaWxkKHV0LmZyb21TdHJpbmcoZSkpO1xuICAgICAgICByZXR1cm4gd2MocyksIG5ldyBBYyh0LmZpcmVzdG9yZSwgXG4gICAgICAgIC8qIGNvbnZlcnRlcj0gKi8gbnVsbCwgcyk7XG4gICAgfVxufVxuXG4vLyBUT0RPKGZpcmVzdG9yZWxpdGUpOiBDb25zaWRlciB1c2luZyBFcnJvckZhY3RvcnkgLVxuLy8gaHR0cHM6Ly9naXRodWIuY29tL2ZpcmViYXNlL2ZpcmViYXNlLWpzLXNkay9ibG9iLzAxMzFlMWYvcGFja2FnZXMvdXRpbC9zcmMvZXJyb3JzLnRzI0wxMDZcbi8qKlxuICogQ3JlYXRlcyBhbmQgcmV0dXJucyBhIG5ldyBgUXVlcnlgIGluc3RhbmNlIHRoYXQgaW5jbHVkZXMgYWxsIGRvY3VtZW50cyBpbiB0aGVcbiAqIGRhdGFiYXNlIHRoYXQgYXJlIGNvbnRhaW5lZCBpbiBhIGNvbGxlY3Rpb24gb3Igc3ViY29sbGVjdGlvbiB3aXRoIHRoZVxuICogZ2l2ZW4gYGNvbGxlY3Rpb25JZGAuXG4gKlxuICogQHBhcmFtIGZpcmVzdG9yZSAtIEEgcmVmZXJlbmNlIHRvIHRoZSByb290IGBGaXJlc3RvcmVgIGluc3RhbmNlLlxuICogQHBhcmFtIGNvbGxlY3Rpb25JZCAtIElkZW50aWZpZXMgdGhlIGNvbGxlY3Rpb25zIHRvIHF1ZXJ5IG92ZXIuIEV2ZXJ5XG4gKiBjb2xsZWN0aW9uIG9yIHN1YmNvbGxlY3Rpb24gd2l0aCB0aGlzIElEIGFzIHRoZSBsYXN0IHNlZ21lbnQgb2YgaXRzIHBhdGhcbiAqIHdpbGwgYmUgaW5jbHVkZWQuIENhbm5vdCBjb250YWluIGEgc2xhc2guXG4gKiBAcmV0dXJucyBUaGUgY3JlYXRlZCBgUXVlcnlgLlxuICovIGZ1bmN0aW9uIFBjKHQsIGUpIHtcbiAgICBpZiAodCA9IG1jKHQsIHBjKSwgbGMoXCJjb2xsZWN0aW9uR3JvdXBcIiwgXCJjb2xsZWN0aW9uIGlkXCIsIGUpLCBlLmluZGV4T2YoXCIvXCIpID49IDApIHRocm93IG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgYEludmFsaWQgY29sbGVjdGlvbiBJRCAnJHtlfScgcGFzc2VkIHRvIGZ1bmN0aW9uIGNvbGxlY3Rpb25Hcm91cCgpLiBDb2xsZWN0aW9uIElEcyBtdXN0IG5vdCBjb250YWluICcvJy5gKTtcbiAgICByZXR1cm4gbmV3IEljKHQsIFxuICAgIC8qIGNvbnZlcnRlcj0gKi8gbnVsbCwgXG4gICAgLyoqXG4gKiBDcmVhdGVzIGEgbmV3IFF1ZXJ5IGZvciBhIGNvbGxlY3Rpb24gZ3JvdXAgcXVlcnkgdGhhdCBtYXRjaGVzIGFsbCBkb2N1bWVudHNcbiAqIHdpdGhpbiB0aGUgcHJvdmlkZWQgY29sbGVjdGlvbiBncm91cC5cbiAqL1xuICAgIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBsZSh1dC5lbXB0eVBhdGgoKSwgdCk7XG4gICAgfShlKSk7XG59XG5cbmZ1bmN0aW9uIGJjKHQsIGUsIC4uLm4pIHtcbiAgICBpZiAodCA9IHkodCksIFxuICAgIC8vIFdlIGFsbG93IG9taXNzaW9uIG9mICdwYXRoU3RyaW5nJyBidXQgZXhwbGljaXRseSBwcm9oaWJpdCBwYXNzaW5nIGluIGJvdGhcbiAgICAvLyAndW5kZWZpbmVkJyBhbmQgJ251bGwnLlxuICAgIDEgPT09IGFyZ3VtZW50cy5sZW5ndGggJiYgKGUgPSBaLkkoKSksIGxjKFwiZG9jXCIsIFwicGF0aFwiLCBlKSwgdCBpbnN0YW5jZW9mIHBjKSB7XG4gICAgICAgIGNvbnN0IHMgPSB1dC5mcm9tU3RyaW5nKGUsIC4uLm4pO1xuICAgICAgICByZXR1cm4gZGMocyksIG5ldyBUYyh0LCBcbiAgICAgICAgLyogY29udmVydGVyPSAqLyBudWxsLCBuZXcgUHQocykpO1xuICAgIH1cbiAgICB7XG4gICAgICAgIGlmICghKHQgaW5zdGFuY2VvZiBUYyB8fCB0IGluc3RhbmNlb2YgQWMpKSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIFwiRXhwZWN0ZWQgZmlyc3QgYXJndW1lbnQgdG8gY29sbGVjdGlvbigpIHRvIGJlIGEgQ29sbGVjdGlvblJlZmVyZW5jZSwgYSBEb2N1bWVudFJlZmVyZW5jZSBvciBGaXJlYmFzZUZpcmVzdG9yZVwiKTtcbiAgICAgICAgY29uc3QgcyA9IHQuX3BhdGguY2hpbGQodXQuZnJvbVN0cmluZyhlLCAuLi5uKSk7XG4gICAgICAgIHJldHVybiBkYyhzKSwgbmV3IFRjKHQuZmlyZXN0b3JlLCB0IGluc3RhbmNlb2YgQWMgPyB0LmNvbnZlcnRlciA6IG51bGwsIG5ldyBQdChzKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgcHJvdmlkZWQgcmVmZXJlbmNlcyBhcmUgZXF1YWwuXG4gKlxuICogQHBhcmFtIGxlZnQgLSBBIHJlZmVyZW5jZSB0byBjb21wYXJlLlxuICogQHBhcmFtIHJpZ2h0IC0gQSByZWZlcmVuY2UgdG8gY29tcGFyZS5cbiAqIEByZXR1cm5zIHRydWUgaWYgdGhlIHJlZmVyZW5jZXMgcG9pbnQgdG8gdGhlIHNhbWUgbG9jYXRpb24gaW4gdGhlIHNhbWVcbiAqIEZpcmVzdG9yZSBkYXRhYmFzZS5cbiAqLyBmdW5jdGlvbiB2Yyh0LCBlKSB7XG4gICAgcmV0dXJuIHQgPSB5KHQpLCBlID0geShlKSwgKHQgaW5zdGFuY2VvZiBUYyB8fCB0IGluc3RhbmNlb2YgQWMpICYmIChlIGluc3RhbmNlb2YgVGMgfHwgZSBpbnN0YW5jZW9mIEFjKSAmJiAodC5maXJlc3RvcmUgPT09IGUuZmlyZXN0b3JlICYmIHQucGF0aCA9PT0gZS5wYXRoICYmIHQuY29udmVydGVyID09PSBlLmNvbnZlcnRlcik7XG59XG5cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIHRoZSBwcm92aWRlZCBxdWVyaWVzIHBvaW50IHRvIHRoZSBzYW1lIGNvbGxlY3Rpb24gYW5kIGFwcGx5XG4gKiB0aGUgc2FtZSBjb25zdHJhaW50cy5cbiAqXG4gKiBAcGFyYW0gbGVmdCAtIEEgYFF1ZXJ5YCB0byBjb21wYXJlLlxuICogQHBhcmFtIHJpZ2h0IC0gQSBgUXVlcnlgIHRvIGNvbXBhcmUuXG4gKiBAcmV0dXJucyB0cnVlIGlmIHRoZSByZWZlcmVuY2VzIHBvaW50IHRvIHRoZSBzYW1lIGxvY2F0aW9uIGluIHRoZSBzYW1lXG4gKiBGaXJlc3RvcmUgZGF0YWJhc2UuXG4gKi8gZnVuY3Rpb24gVmModCwgZSkge1xuICAgIHJldHVybiB0ID0geSh0KSwgZSA9IHkoZSksIHQgaW5zdGFuY2VvZiBJYyAmJiBlIGluc3RhbmNlb2YgSWMgJiYgKHQuZmlyZXN0b3JlID09PSBlLmZpcmVzdG9yZSAmJiBJZSh0Ll9xdWVyeSwgZS5fcXVlcnkpICYmIHQuY29udmVydGVyID09PSBlLmNvbnZlcnRlcik7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNsYXNzIFNjIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgLy8gVGhlIGxhc3QgcHJvbWlzZSBpbiB0aGUgcXVldWUuXG4gICAgICAgIHRoaXMuZmEgPSBQcm9taXNlLnJlc29sdmUoKSwgXG4gICAgICAgIC8vIEEgbGlzdCBvZiByZXRyeWFibGUgb3BlcmF0aW9ucy4gUmV0cnlhYmxlIG9wZXJhdGlvbnMgYXJlIHJ1biBpbiBvcmRlciBhbmRcbiAgICAgICAgLy8gcmV0cmllZCB3aXRoIGJhY2tvZmYuXG4gICAgICAgIHRoaXMuZGEgPSBbXSwgXG4gICAgICAgIC8vIElzIHRoaXMgQXN5bmNRdWV1ZSBiZWluZyBzaHV0IGRvd24/IE9uY2UgaXQgaXMgc2V0IHRvIHRydWUsIGl0IHdpbGwgbm90XG4gICAgICAgIC8vIGJlIGNoYW5nZWQgYWdhaW4uXG4gICAgICAgIHRoaXMud2EgPSAhMSwgXG4gICAgICAgIC8vIE9wZXJhdGlvbnMgc2NoZWR1bGVkIHRvIGJlIHF1ZXVlZCBpbiB0aGUgZnV0dXJlLiBPcGVyYXRpb25zIGFyZVxuICAgICAgICAvLyBhdXRvbWF0aWNhbGx5IHJlbW92ZWQgYWZ0ZXIgdGhleSBhcmUgcnVuIG9yIGNhbmNlbGVkLlxuICAgICAgICB0aGlzLl9hID0gW10sIFxuICAgICAgICAvLyB2aXNpYmxlIGZvciB0ZXN0aW5nXG4gICAgICAgIHRoaXMubWEgPSBudWxsLCBcbiAgICAgICAgLy8gRmxhZyBzZXQgd2hpbGUgdGhlcmUncyBhbiBvdXRzdGFuZGluZyBBc3luY1F1ZXVlIG9wZXJhdGlvbiwgdXNlZCBmb3JcbiAgICAgICAgLy8gYXNzZXJ0aW9uIHNhbml0eS1jaGVja3MuXG4gICAgICAgIHRoaXMuZ2EgPSAhMSwgXG4gICAgICAgIC8vIEVuYWJsZWQgZHVyaW5nIHNodXRkb3duIG9uIFNhZmFyaSB0byBwcmV2ZW50IGZ1dHVyZSBhY2Nlc3MgdG8gSW5kZXhlZERCLlxuICAgICAgICB0aGlzLnlhID0gITEsIFxuICAgICAgICAvLyBMaXN0IG9mIFRpbWVySWRzIHRvIGZhc3QtZm9yd2FyZCBkZWxheXMgZm9yLlxuICAgICAgICB0aGlzLnBhID0gW10sIFxuICAgICAgICAvLyBCYWNrb2ZmIHRpbWVyIHVzZWQgdG8gc2NoZWR1bGUgcmV0cmllcyBmb3IgcmV0cnlhYmxlIG9wZXJhdGlvbnNcbiAgICAgICAgdGhpcy5yciA9IG5ldyBZcih0aGlzLCBcImFzeW5jX3F1ZXVlX3JldHJ5XCIgLyogQXN5bmNRdWV1ZVJldHJ5ICovKSwgXG4gICAgICAgIC8vIFZpc2liaWxpdHkgaGFuZGxlciB0aGF0IHRyaWdnZXJzIGFuIGltbWVkaWF0ZSByZXRyeSBvZiBhbGwgcmV0cnlhYmxlXG4gICAgICAgIC8vIG9wZXJhdGlvbnMuIE1lYW50IHRvIHNwZWVkIHVwIHJlY292ZXJ5IHdoZW4gd2UgcmVnYWluIGZpbGUgc3lzdGVtIGFjY2Vzc1xuICAgICAgICAvLyBhZnRlciBwYWdlIGNvbWVzIGludG8gZm9yZWdyb3VuZC5cbiAgICAgICAgdGhpcy5FYSA9ICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBIcigpO1xuICAgICAgICAgICAgdCAmJiBrKFwiQXN5bmNRdWV1ZVwiLCBcIlZpc2liaWxpdHkgc3RhdGUgY2hhbmdlZCB0byBcIiArIHQudmlzaWJpbGl0eVN0YXRlKSwgdGhpcy5yci50cigpO1xuICAgICAgICB9O1xuICAgICAgICBjb25zdCB0ID0gSHIoKTtcbiAgICAgICAgdCAmJiBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIHQuYWRkRXZlbnRMaXN0ZW5lciAmJiB0LmFkZEV2ZW50TGlzdGVuZXIoXCJ2aXNpYmlsaXR5Y2hhbmdlXCIsIHRoaXMuRWEpO1xuICAgIH1cbiAgICBnZXQgaXNTaHV0dGluZ0Rvd24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLndhO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGRzIGEgbmV3IG9wZXJhdGlvbiB0byB0aGUgcXVldWUgd2l0aG91dCB3YWl0aW5nIGZvciBpdCB0byBjb21wbGV0ZSAoaS5lLlxuICAgICAqIHdlIGlnbm9yZSB0aGUgUHJvbWlzZSByZXN1bHQpLlxuICAgICAqLyAgICBlbnF1ZXVlQW5kRm9yZ2V0KHQpIHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1mbG9hdGluZy1wcm9taXNlc1xuICAgICAgICB0aGlzLmVucXVldWUodCk7XG4gICAgfVxuICAgIGVucXVldWVBbmRGb3JnZXRFdmVuV2hpbGVSZXN0cmljdGVkKHQpIHtcbiAgICAgICAgdGhpcy5UYSgpLCBcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1mbG9hdGluZy1wcm9taXNlc1xuICAgICAgICB0aGlzLklhKHQpO1xuICAgIH1cbiAgICBlbnRlclJlc3RyaWN0ZWRNb2RlKHQpIHtcbiAgICAgICAgaWYgKCF0aGlzLndhKSB7XG4gICAgICAgICAgICB0aGlzLndhID0gITAsIHRoaXMueWEgPSB0IHx8ICExO1xuICAgICAgICAgICAgY29uc3QgZSA9IEhyKCk7XG4gICAgICAgICAgICBlICYmIFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgZS5yZW1vdmVFdmVudExpc3RlbmVyICYmIGUucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInZpc2liaWxpdHljaGFuZ2VcIiwgdGhpcy5FYSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZW5xdWV1ZSh0KSB7XG4gICAgICAgIGlmICh0aGlzLlRhKCksIHRoaXMud2EpIFxuICAgICAgICAvLyBSZXR1cm4gYSBQcm9taXNlIHdoaWNoIG5ldmVyIHJlc29sdmVzLlxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKCgpID0+IHt9KSk7XG4gICAgICAgIC8vIENyZWF0ZSBhIGRlZmVycmVkIFByb21pc2UgdGhhdCB3ZSBjYW4gcmV0dXJuIHRvIHRoZSBjYWxsZWUuIFRoaXNcbiAgICAgICAgLy8gYWxsb3dzIHVzIHRvIHJldHVybiBhIFwiaGFuZ2luZyBQcm9taXNlXCIgb25seSB0byB0aGUgY2FsbGVlIGFuZCBzdGlsbFxuICAgICAgICAvLyBhZHZhbmNlIHRoZSBxdWV1ZSBldmVuIHdoZW4gdGhlIG9wZXJhdGlvbiBpcyBub3QgcnVuLlxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBuZXcgajtcbiAgICAgICAgcmV0dXJuIHRoaXMuSWEoKCgpID0+IHRoaXMud2EgJiYgdGhpcy55YSA/IFByb21pc2UucmVzb2x2ZSgpIDogKHQoKS50aGVuKGUucmVzb2x2ZSwgZS5yZWplY3QpLCBcbiAgICAgICAgZS5wcm9taXNlKSkpLnRoZW4oKCgpID0+IGUucHJvbWlzZSkpO1xuICAgIH1cbiAgICBlbnF1ZXVlUmV0cnlhYmxlKHQpIHtcbiAgICAgICAgdGhpcy5lbnF1ZXVlQW5kRm9yZ2V0KCgoKSA9PiAodGhpcy5kYS5wdXNoKHQpLCB0aGlzLkFhKCkpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJ1bnMgdGhlIG5leHQgb3BlcmF0aW9uIGZyb20gdGhlIHJldHJ5YWJsZSBxdWV1ZS4gSWYgdGhlIG9wZXJhdGlvbiBmYWlscyxcbiAgICAgKiByZXNjaGVkdWxlcyB3aXRoIGJhY2tvZmYuXG4gICAgICovICAgIGFzeW5jIEFhKCkge1xuICAgICAgICBpZiAoMCAhPT0gdGhpcy5kYS5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kYVswXSgpLCB0aGlzLmRhLnNoaWZ0KCksIHRoaXMucnIucmVzZXQoKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXpzKHQpKSB0aHJvdyB0O1xuIC8vIEZhaWx1cmUgd2lsbCBiZSBoYW5kbGVkIGJ5IEFzeW5jUXVldWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgayhcIkFzeW5jUXVldWVcIiwgXCJPcGVyYXRpb24gZmFpbGVkIHdpdGggcmV0cnlhYmxlIGVycm9yOiBcIiArIHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5kYS5sZW5ndGggPiAwICYmIFxuICAgICAgICAgICAgLy8gSWYgdGhlcmUgYXJlIGFkZGl0aW9uYWwgb3BlcmF0aW9ucywgd2UgcmUtc2NoZWR1bGUgYHJldHJ5TmV4dE9wKClgLlxuICAgICAgICAgICAgLy8gVGhpcyBpcyBuZWNlc3NhcnkgdG8gcnVuIHJldHJ5YWJsZSBvcGVyYXRpb25zIHRoYXQgZmFpbGVkIGR1cmluZ1xuICAgICAgICAgICAgLy8gdGhlaXIgaW5pdGlhbCBhdHRlbXB0IHNpbmNlIHdlIGRvbid0IGtub3cgd2hldGhlciB0aGV5IGFyZSBhbHJlYWR5XG4gICAgICAgICAgICAvLyBlbnF1ZXVlZC4gSWYsIGZvciBleGFtcGxlLCBgb3AxYCwgYG9wMmAsIGBvcDNgIGFyZSBlbnF1ZXVlZCBhbmQgYG9wMWBcbiAgICAgICAgICAgIC8vIG5lZWRzIHRvICBiZSByZS1ydW4sIHdlIHdpbGwgcnVuIGBvcDFgLCBgb3AxYCwgYG9wMmAgdXNpbmcgdGhlXG4gICAgICAgICAgICAvLyBhbHJlYWR5IGVucXVldWVkIGNhbGxzIHRvIGByZXRyeU5leHRPcCgpYC4gYG9wMygpYCB3aWxsIHRoZW4gcnVuIGluIHRoZVxuICAgICAgICAgICAgLy8gY2FsbCBzY2hlZHVsZWQgaGVyZS5cbiAgICAgICAgICAgIC8vIFNpbmNlIGBiYWNrb2ZmQW5kUnVuKClgIGNhbmNlbHMgYW4gZXhpc3RpbmcgYmFja29mZiBhbmQgc2NoZWR1bGVzIGFcbiAgICAgICAgICAgIC8vIG5ldyBiYWNrb2ZmIG9uIGV2ZXJ5IGNhbGwsIHRoZXJlIGlzIG9ubHkgZXZlciBhIHNpbmdsZSBhZGRpdGlvbmFsXG4gICAgICAgICAgICAvLyBvcGVyYXRpb24gaW4gdGhlIHF1ZXVlLlxuICAgICAgICAgICAgdGhpcy5yci5YaSgoKCkgPT4gdGhpcy5BYSgpKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgSWEodCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5mYS50aGVuKCgoKSA9PiAodGhpcy5nYSA9ICEwLCB0KCkuY2F0Y2goKHQgPT4ge1xuICAgICAgICAgICAgdGhpcy5tYSA9IHQsIHRoaXMuZ2EgPSAhMTtcbiAgICAgICAgICAgIC8vIFJlLXRocm93IHRoZSBlcnJvciBzbyB0aGF0IHRoaXMudGFpbCBiZWNvbWVzIGEgcmVqZWN0ZWQgUHJvbWlzZSBhbmRcbiAgICAgICAgICAgIC8vIGFsbCBmdXJ0aGVyIGF0dGVtcHRzIHRvIGNoYWluICh2aWEgLnRoZW4pIHdpbGwganVzdCBzaG9ydC1jaXJjdWl0XG4gICAgICAgICAgICAvLyBhbmQgcmV0dXJuIHRoZSByZWplY3RlZCBQcm9taXNlLlxuICAgICAgICAgICAgdGhyb3cgJChcIklOVEVSTkFMIFVOSEFORExFRCBFUlJPUjogXCIsIFxuICAgICAgICAgICAgLyoqXG4gKiBDaHJvbWUgaW5jbHVkZXMgRXJyb3IubWVzc2FnZSBpbiBFcnJvci5zdGFjay4gT3RoZXIgYnJvd3NlcnMgZG8gbm90LlxuICogVGhpcyByZXR1cm5zIGV4cGVjdGVkIG91dHB1dCBvZiBtZXNzYWdlICsgc3RhY2sgd2hlbiBhdmFpbGFibGUuXG4gKiBAcGFyYW0gZXJyb3IgLSBFcnJvciBvciBGaXJlc3RvcmVFcnJvclxuICovXG4gICAgICAgICAgICBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgbGV0IGUgPSB0Lm1lc3NhZ2UgfHwgXCJcIjtcbiAgICAgICAgICAgICAgICB0LnN0YWNrICYmIChlID0gdC5zdGFjay5pbmNsdWRlcyh0Lm1lc3NhZ2UpID8gdC5zdGFjayA6IHQubWVzc2FnZSArIFwiXFxuXCIgKyB0LnN0YWNrKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovICh0KSksIHQ7XG4gICAgICAgIH0pKS50aGVuKCh0ID0+ICh0aGlzLmdhID0gITEsIHQpKSkpKSk7XG4gICAgICAgIHJldHVybiB0aGlzLmZhID0gZSwgZTtcbiAgICB9XG4gICAgZW5xdWV1ZUFmdGVyRGVsYXkodCwgZSwgbikge1xuICAgICAgICB0aGlzLlRhKCksIFxuICAgICAgICAvLyBGYXN0LWZvcndhcmQgZGVsYXlzIGZvciB0aW1lcklkcyB0aGF0IGhhdmUgYmVlbiBvdmVycmlkZW4uXG4gICAgICAgIHRoaXMucGEuaW5kZXhPZih0KSA+IC0xICYmIChlID0gMCk7XG4gICAgICAgIGNvbnN0IHMgPSBOby5jcmVhdGVBbmRTY2hlZHVsZSh0aGlzLCB0LCBlLCBuLCAodCA9PiB0aGlzLlJhKHQpKSk7XG4gICAgICAgIHJldHVybiB0aGlzLl9hLnB1c2gocyksIHM7XG4gICAgfVxuICAgIFRhKCkge1xuICAgICAgICB0aGlzLm1hICYmIE0oKTtcbiAgICB9XG4gICAgdmVyaWZ5T3BlcmF0aW9uSW5Qcm9ncmVzcygpIHt9XG4gICAgLyoqXG4gICAgICogV2FpdHMgdW50aWwgYWxsIGN1cnJlbnRseSBxdWV1ZWQgdGFza3MgYXJlIGZpbmlzaGVkIGV4ZWN1dGluZy4gRGVsYXllZFxuICAgICAqIG9wZXJhdGlvbnMgYXJlIG5vdCBydW4uXG4gICAgICovICAgIGFzeW5jIFBhKCkge1xuICAgICAgICAvLyBPcGVyYXRpb25zIGluIHRoZSBxdWV1ZSBwcmlvciB0byBkcmFpbmluZyBtYXkgaGF2ZSBlbnF1ZXVlZCBhZGRpdGlvbmFsXG4gICAgICAgIC8vIG9wZXJhdGlvbnMuIEtlZXAgZHJhaW5pbmcgdGhlIHF1ZXVlIHVudGlsIHRoZSB0YWlsIGlzIG5vIGxvbmdlciBhZHZhbmNlZCxcbiAgICAgICAgLy8gd2hpY2ggaW5kaWNhdGVzIHRoYXQgbm8gbW9yZSBuZXcgb3BlcmF0aW9ucyB3ZXJlIGVucXVldWVkIGFuZCB0aGF0IGFsbFxuICAgICAgICAvLyBvcGVyYXRpb25zIHdlcmUgZXhlY3V0ZWQuXG4gICAgICAgIGxldCB0O1xuICAgICAgICBkbyB7XG4gICAgICAgICAgICB0ID0gdGhpcy5mYSwgYXdhaXQgdDtcbiAgICAgICAgfSB3aGlsZSAodCAhPT0gdGhpcy5mYSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZvciBUZXN0czogRGV0ZXJtaW5lIGlmIGEgZGVsYXllZCBvcGVyYXRpb24gd2l0aCBhIHBhcnRpY3VsYXIgVGltZXJJZFxuICAgICAqIGV4aXN0cy5cbiAgICAgKi8gICAgYmEodCkge1xuICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdGhpcy5fYSkgaWYgKGUudGltZXJJZCA9PT0gdCkgcmV0dXJuICEwO1xuICAgICAgICByZXR1cm4gITE7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZvciBUZXN0czogUnVucyBzb21lIG9yIGFsbCBkZWxheWVkIG9wZXJhdGlvbnMgZWFybHkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbGFzdFRpbWVySWQgLSBEZWxheWVkIG9wZXJhdGlvbnMgdXAgdG8gYW5kIGluY2x1ZGluZyB0aGlzIFRpbWVySWRcbiAgICAgKiB3aWxsIGJlIGRyYWluZWQuIFBhc3MgVGltZXJJZC5BbGwgdG8gcnVuIGFsbCBkZWxheWVkIG9wZXJhdGlvbnMuXG4gICAgICogQHJldHVybnMgYSBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgb25jZSBhbGwgb3BlcmF0aW9ucyBoYXZlIGJlZW4gcnVuLlxuICAgICAqLyAgICB2YSh0KSB7XG4gICAgICAgIC8vIE5vdGUgdGhhdCBkcmFpbmluZyBtYXkgZ2VuZXJhdGUgbW9yZSBkZWxheWVkIG9wcywgc28gd2UgZG8gdGhhdCBmaXJzdC5cbiAgICAgICAgcmV0dXJuIHRoaXMuUGEoKS50aGVuKCgoKSA9PiB7XG4gICAgICAgICAgICAvLyBSdW4gb3BzIGluIHRoZSBzYW1lIG9yZGVyIHRoZXknZCBydW4gaWYgdGhleSByYW4gbmF0dXJhbGx5LlxuICAgICAgICAgICAgdGhpcy5fYS5zb3J0KCgodCwgZSkgPT4gdC50YXJnZXRUaW1lTXMgLSBlLnRhcmdldFRpbWVNcykpO1xuICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHRoaXMuX2EpIGlmIChlLnNraXBEZWxheSgpLCBcImFsbFwiIC8qIEFsbCAqLyAhPT0gdCAmJiBlLnRpbWVySWQgPT09IHQpIGJyZWFrO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuUGEoKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBGb3IgVGVzdHM6IFNraXAgYWxsIHN1YnNlcXVlbnQgZGVsYXlzIGZvciBhIHRpbWVyIGlkLlxuICAgICAqLyAgICBWYSh0KSB7XG4gICAgICAgIHRoaXMucGEucHVzaCh0KTtcbiAgICB9XG4gICAgLyoqIENhbGxlZCBvbmNlIGEgRGVsYXllZE9wZXJhdGlvbiBpcyBydW4gb3IgY2FuY2VsZWQuICovICAgIFJhKHQpIHtcbiAgICAgICAgLy8gTk9URTogaW5kZXhPZiAvIHNsaWNlIGFyZSBPKG4pLCBidXQgZGVsYXllZE9wZXJhdGlvbnMgaXMgZXhwZWN0ZWQgdG8gYmUgc21hbGwuXG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLl9hLmluZGV4T2YodCk7XG4gICAgICAgIHRoaXMuX2Euc3BsaWNlKGUsIDEpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gRGModCkge1xuICAgIC8qKlxuICogUmV0dXJucyB0cnVlIGlmIG9iaiBpcyBhbiBvYmplY3QgYW5kIGNvbnRhaW5zIGF0IGxlYXN0IG9uZSBvZiB0aGUgc3BlY2lmaWVkXG4gKiBtZXRob2RzLlxuICovXG4gICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgaWYgKFwib2JqZWN0XCIgIT0gdHlwZW9mIHQgfHwgbnVsbCA9PT0gdCkgcmV0dXJuICExO1xuICAgICAgICBjb25zdCBuID0gdDtcbiAgICAgICAgZm9yIChjb25zdCB0IG9mIGUpIGlmICh0IGluIG4gJiYgXCJmdW5jdGlvblwiID09IHR5cGVvZiBuW3RdKSByZXR1cm4gITA7XG4gICAgICAgIHJldHVybiAhMTtcbiAgICB9XG4gICAgLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbiAgICAvKipcbiAqIFJlcHJlc2VudHMgdGhlIHRhc2sgb2YgbG9hZGluZyBhIEZpcmVzdG9yZSBidW5kbGUuIEl0IHByb3ZpZGVzIHByb2dyZXNzIG9mIGJ1bmRsZVxuICogbG9hZGluZywgYXMgd2VsbCBhcyB0YXNrIGNvbXBsZXRpb24gYW5kIGVycm9yIGV2ZW50cy5cbiAqXG4gKiBUaGUgQVBJIGlzIGNvbXBhdGlibGUgd2l0aCBgUHJvbWlzZTxMb2FkQnVuZGxlVGFza1Byb2dyZXNzPmAuXG4gKi8gKHQsIFsgXCJuZXh0XCIsIFwiZXJyb3JcIiwgXCJjb21wbGV0ZVwiIF0pO1xufVxuXG5jbGFzcyBDYyB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuX3Byb2dyZXNzT2JzZXJ2ZXIgPSB7fSwgdGhpcy5fdGFza0NvbXBsZXRpb25SZXNvbHZlciA9IG5ldyBqLCB0aGlzLl9sYXN0UHJvZ3Jlc3MgPSB7XG4gICAgICAgICAgICB0YXNrU3RhdGU6IFwiUnVubmluZ1wiLFxuICAgICAgICAgICAgdG90YWxCeXRlczogMCxcbiAgICAgICAgICAgIHRvdGFsRG9jdW1lbnRzOiAwLFxuICAgICAgICAgICAgYnl0ZXNMb2FkZWQ6IDAsXG4gICAgICAgICAgICBkb2N1bWVudHNMb2FkZWQ6IDBcbiAgICAgICAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVnaXN0ZXJzIGZ1bmN0aW9ucyB0byBsaXN0ZW4gdG8gYnVuZGxlIGxvYWRpbmcgcHJvZ3Jlc3MgZXZlbnRzLlxuICAgICAqIEBwYXJhbSBuZXh0IC0gQ2FsbGVkIHdoZW4gdGhlcmUgaXMgYSBwcm9ncmVzcyB1cGRhdGUgZnJvbSBidW5kbGUgbG9hZGluZy4gVHlwaWNhbGx5IGBuZXh0YCBjYWxscyBvY2N1clxuICAgICAqICAgZWFjaCB0aW1lIGEgRmlyZXN0b3JlIGRvY3VtZW50IGlzIGxvYWRlZCBmcm9tIHRoZSBidW5kbGUuXG4gICAgICogQHBhcmFtIGVycm9yIC0gQ2FsbGVkIHdoZW4gYW4gZXJyb3Igb2NjdXJzIGR1cmluZyBidW5kbGUgbG9hZGluZy4gVGhlIHRhc2sgYWJvcnRzIGFmdGVyIHJlcG9ydGluZyB0aGVcbiAgICAgKiAgIGVycm9yLCBhbmQgdGhlcmUgc2hvdWxkIGJlIG5vIG1vcmUgdXBkYXRlcyBhZnRlciB0aGlzLlxuICAgICAqIEBwYXJhbSBjb21wbGV0ZSAtIENhbGxlZCB3aGVuIHRoZSBsb2FkaW5nIHRhc2sgaXMgY29tcGxldGUuXG4gICAgICovICAgIG9uUHJvZ3Jlc3ModCwgZSwgbikge1xuICAgICAgICB0aGlzLl9wcm9ncmVzc09ic2VydmVyID0ge1xuICAgICAgICAgICAgbmV4dDogdCxcbiAgICAgICAgICAgIGVycm9yOiBlLFxuICAgICAgICAgICAgY29tcGxldGU6IG5cbiAgICAgICAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSW1wbGVtZW50cyB0aGUgYFByb21pc2U8TG9hZEJ1bmRsZVRhc2tQcm9ncmVzcz4uY2F0Y2hgIGludGVyZmFjZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBvblJlamVjdGVkIC0gQ2FsbGVkIHdoZW4gYW4gZXJyb3Igb2NjdXJzIGR1cmluZyBidW5kbGUgbG9hZGluZy5cbiAgICAgKi8gICAgY2F0Y2godCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdGFza0NvbXBsZXRpb25SZXNvbHZlci5wcm9taXNlLmNhdGNoKHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJbXBsZW1lbnRzIHRoZSBgUHJvbWlzZTxMb2FkQnVuZGxlVGFza1Byb2dyZXNzPi50aGVuYCBpbnRlcmZhY2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gb25GdWxmaWxsZWQgLSBDYWxsZWQgb24gdGhlIGNvbXBsZXRpb24gb2YgdGhlIGxvYWRpbmcgdGFzayB3aXRoIGEgZmluYWwgYExvYWRCdW5kbGVUYXNrUHJvZ3Jlc3NgIHVwZGF0ZS5cbiAgICAgKiAgIFRoZSB1cGRhdGUgd2lsbCBhbHdheXMgaGF2ZSBpdHMgYHRhc2tTdGF0ZWAgc2V0IHRvIGBcIlN1Y2Nlc3NcImAuXG4gICAgICogQHBhcmFtIG9uUmVqZWN0ZWQgLSBDYWxsZWQgd2hlbiBhbiBlcnJvciBvY2N1cnMgZHVyaW5nIGJ1bmRsZSBsb2FkaW5nLlxuICAgICAqLyAgICB0aGVuKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Rhc2tDb21wbGV0aW9uUmVzb2x2ZXIucHJvbWlzZS50aGVuKHQsIGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBOb3RpZmllcyBhbGwgb2JzZXJ2ZXJzIHRoYXQgYnVuZGxlIGxvYWRpbmcgaGFzIGNvbXBsZXRlZCwgd2l0aCBhIHByb3ZpZGVkXG4gICAgICogYExvYWRCdW5kbGVUYXNrUHJvZ3Jlc3NgIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovICAgIF9jb21wbGV0ZVdpdGgodCkge1xuICAgICAgICB0aGlzLl91cGRhdGVQcm9ncmVzcyh0KSwgdGhpcy5fcHJvZ3Jlc3NPYnNlcnZlci5jb21wbGV0ZSAmJiB0aGlzLl9wcm9ncmVzc09ic2VydmVyLmNvbXBsZXRlKCksIFxuICAgICAgICB0aGlzLl90YXNrQ29tcGxldGlvblJlc29sdmVyLnJlc29sdmUodCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE5vdGlmaWVzIGFsbCBvYnNlcnZlcnMgdGhhdCBidW5kbGUgbG9hZGluZyBoYXMgZmFpbGVkLCB3aXRoIGEgcHJvdmlkZWRcbiAgICAgKiBgRXJyb3JgIGFzIHRoZSByZWFzb24uXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqLyAgICBfZmFpbFdpdGgodCkge1xuICAgICAgICB0aGlzLl9sYXN0UHJvZ3Jlc3MudGFza1N0YXRlID0gXCJFcnJvclwiLCB0aGlzLl9wcm9ncmVzc09ic2VydmVyLm5leHQgJiYgdGhpcy5fcHJvZ3Jlc3NPYnNlcnZlci5uZXh0KHRoaXMuX2xhc3RQcm9ncmVzcyksIFxuICAgICAgICB0aGlzLl9wcm9ncmVzc09ic2VydmVyLmVycm9yICYmIHRoaXMuX3Byb2dyZXNzT2JzZXJ2ZXIuZXJyb3IodCksIHRoaXMuX3Rhc2tDb21wbGV0aW9uUmVzb2x2ZXIucmVqZWN0KHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBOb3RpZmllcyBhIHByb2dyZXNzIHVwZGF0ZSBvZiBsb2FkaW5nIGEgYnVuZGxlLlxuICAgICAqIEBwYXJhbSBwcm9ncmVzcyAtIFRoZSBuZXcgcHJvZ3Jlc3MuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqLyAgICBfdXBkYXRlUHJvZ3Jlc3ModCkge1xuICAgICAgICB0aGlzLl9sYXN0UHJvZ3Jlc3MgPSB0LCB0aGlzLl9wcm9ncmVzc09ic2VydmVyLm5leHQgJiYgdGhpcy5fcHJvZ3Jlc3NPYnNlcnZlci5uZXh0KHQpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKiBET01FeGNlcHRpb24gZXJyb3IgY29kZSBjb25zdGFudHMuICovIGNvbnN0IE5jID0gLTE7XG5cbi8qKlxuICogVGhlIENsb3VkIEZpcmVzdG9yZSBzZXJ2aWNlIGludGVyZmFjZS5cbiAqXG4gKiBEbyBub3QgY2FsbCB0aGlzIGNvbnN0cnVjdG9yIGRpcmVjdGx5LiBJbnN0ZWFkLCB1c2Uge0BsaW5rIGdldEZpcmVzdG9yZX0uXG4gKi9cbmNsYXNzIHhjIGV4dGVuZHMgcGMge1xuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yICovXG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICBzdXBlcih0LCBlKSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBXaGV0aGVyIGl0J3MgYSB7QGxpbmsgRmlyZXN0b3JlfSBvciBGaXJlc3RvcmUgTGl0ZSBpbnN0YW5jZS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudHlwZSA9IFwiZmlyZXN0b3JlXCIsIHRoaXMuX3F1ZXVlID0gbmV3IFNjLCB0aGlzLl9wZXJzaXN0ZW5jZUtleSA9IFwibmFtZVwiIGluIHQgPyB0Lm5hbWUgOiBcIltERUZBVUxUXVwiO1xuICAgIH1cbiAgICBfdGVybWluYXRlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZmlyZXN0b3JlQ2xpZW50IHx8IFxuICAgICAgICAvLyBUaGUgY2xpZW50IG11c3QgYmUgaW5pdGlhbGl6ZWQgdG8gZW5zdXJlIHRoYXQgYWxsIHN1YnNlcXVlbnQgQVBJXG4gICAgICAgIC8vIHVzYWdlIHRocm93cyBhbiBleGNlcHRpb24uXG4gICAgICAgIEZjKHRoaXMpLCB0aGlzLl9maXJlc3RvcmVDbGllbnQudGVybWluYXRlKCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEluaXRpYWxpemVzIGEgbmV3IGluc3RhbmNlIG9mIHtAbGluayBGaXJlc3RvcmV9IHdpdGggdGhlIHByb3ZpZGVkIHNldHRpbmdzLlxuICogQ2FuIG9ubHkgYmUgY2FsbGVkIGJlZm9yZSBhbnkgb3RoZXIgZnVuY3Rpb24sIGluY2x1ZGluZ1xuICoge0BsaW5rIGdldEZpcmVzdG9yZX0uIElmIHRoZSBjdXN0b20gc2V0dGluZ3MgYXJlIGVtcHR5LCB0aGlzIGZ1bmN0aW9uIGlzXG4gKiBlcXVpdmFsZW50IHRvIGNhbGxpbmcge0BsaW5rIGdldEZpcmVzdG9yZX0uXG4gKlxuICogQHBhcmFtIGFwcCAtIFRoZSB7QGxpbmsgQGZpcmViYXNlL2FwcCNGaXJlYmFzZUFwcH0gd2l0aCB3aGljaCB0aGUge0BsaW5rIEZpcmVzdG9yZX0gaW5zdGFuY2Ugd2lsbFxuICogYmUgYXNzb2NpYXRlZC5cbiAqIEBwYXJhbSBzZXR0aW5ncyAtIEEgc2V0dGluZ3Mgb2JqZWN0IHRvIGNvbmZpZ3VyZSB0aGUge0BsaW5rIEZpcmVzdG9yZX0gaW5zdGFuY2UuXG4gKiBAcmV0dXJucyBBIG5ld2x5IGluaXRpYWxpemVkIHtAbGluayBGaXJlc3RvcmV9IGluc3RhbmNlLlxuICovIGZ1bmN0aW9uIGtjKGUsIG4pIHtcbiAgICBjb25zdCBzID0gdChlLCBcImZpcmVzdG9yZVwiKTtcbiAgICBpZiAocy5pc0luaXRpYWxpemVkKCkpIHtcbiAgICAgICAgY29uc3QgdCA9IHMuZ2V0SW1tZWRpYXRlKCksIGUgPSBzLmdldE9wdGlvbnMoKTtcbiAgICAgICAgaWYgKHAoZSwgbikpIHJldHVybiB0O1xuICAgICAgICB0aHJvdyBuZXcgSyhxLkZBSUxFRF9QUkVDT05ESVRJT04sIFwiaW5pdGlhbGl6ZUZpcmVzdG9yZSgpIGhhcyBhbHJlYWR5IGJlZW4gY2FsbGVkIHdpdGggZGlmZmVyZW50IG9wdGlvbnMuIFRvIGF2b2lkIHRoaXMgZXJyb3IsIGNhbGwgaW5pdGlhbGl6ZUZpcmVzdG9yZSgpIHdpdGggdGhlIHNhbWUgb3B0aW9ucyBhcyB3aGVuIGl0IHdhcyBvcmlnaW5hbGx5IGNhbGxlZCwgb3IgY2FsbCBnZXRGaXJlc3RvcmUoKSB0byByZXR1cm4gdGhlIGFscmVhZHkgaW5pdGlhbGl6ZWQgaW5zdGFuY2UuXCIpO1xuICAgIH1cbiAgICBpZiAodm9pZCAwICE9PSBuLmNhY2hlU2l6ZUJ5dGVzICYmIC0xICE9PSBuLmNhY2hlU2l6ZUJ5dGVzICYmIG4uY2FjaGVTaXplQnl0ZXMgPCAxMDQ4NTc2KSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIFwiY2FjaGVTaXplQnl0ZXMgbXVzdCBiZSBhdCBsZWFzdCAxMDQ4NTc2XCIpO1xuICAgIHJldHVybiBzLmluaXRpYWxpemUoe1xuICAgICAgICBvcHRpb25zOiBuXG4gICAgfSk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgZXhpc3Rpbmcge0BsaW5rIEZpcmVzdG9yZX0gaW5zdGFuY2UgdGhhdCBpcyBhc3NvY2lhdGVkIHdpdGggdGhlXG4gKiBwcm92aWRlZCB7QGxpbmsgQGZpcmViYXNlL2FwcCNGaXJlYmFzZUFwcH0uIElmIG5vIGluc3RhbmNlIGV4aXN0cywgaW5pdGlhbGl6ZXMgYSBuZXdcbiAqIGluc3RhbmNlIHdpdGggZGVmYXVsdCBzZXR0aW5ncy5cbiAqXG4gKiBAcGFyYW0gYXBwIC0gVGhlIHtAbGluayBAZmlyZWJhc2UvYXBwI0ZpcmViYXNlQXBwfSBpbnN0YW5jZSB0aGF0IHRoZSByZXR1cm5lZCB7QGxpbmsgRmlyZXN0b3JlfVxuICogaW5zdGFuY2UgaXMgYXNzb2NpYXRlZCB3aXRoLlxuICogQHJldHVybnMgVGhlIHtAbGluayBGaXJlc3RvcmV9IGluc3RhbmNlIG9mIHRoZSBwcm92aWRlZCBhcHAuXG4gKi8gZnVuY3Rpb24gJGMobiA9IGUoKSkge1xuICAgIHJldHVybiB0KG4sIFwiZmlyZXN0b3JlXCIpLmdldEltbWVkaWF0ZSgpO1xufVxuXG4vKipcbiAqIEBpbnRlcm5hbFxuICovIGZ1bmN0aW9uIE9jKHQpIHtcbiAgICByZXR1cm4gdC5fZmlyZXN0b3JlQ2xpZW50IHx8IEZjKHQpLCB0Ll9maXJlc3RvcmVDbGllbnQudmVyaWZ5Tm90VGVybWluYXRlZCgpLCB0Ll9maXJlc3RvcmVDbGllbnQ7XG59XG5cbmZ1bmN0aW9uIEZjKHQpIHtcbiAgICB2YXIgZTtcbiAgICBjb25zdCBuID0gdC5fZnJlZXplU2V0dGluZ3MoKSwgcyA9IGZ1bmN0aW9uKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBjYyh0LCBlLCBuLCBzLmhvc3QsIHMuc3NsLCBzLmV4cGVyaW1lbnRhbEZvcmNlTG9uZ1BvbGxpbmcsIHMuZXhwZXJpbWVudGFsQXV0b0RldGVjdExvbmdQb2xsaW5nLCBzLnVzZUZldGNoU3RyZWFtcyk7XG4gICAgfSh0Ll9kYXRhYmFzZUlkLCAobnVsbCA9PT0gKGUgPSB0Ll9hcHApIHx8IHZvaWQgMCA9PT0gZSA/IHZvaWQgMCA6IGUub3B0aW9ucy5hcHBJZCkgfHwgXCJcIiwgdC5fcGVyc2lzdGVuY2VLZXksIG4pO1xuICAgIHQuX2ZpcmVzdG9yZUNsaWVudCA9IG5ldyBxYSh0Ll9jcmVkZW50aWFscywgdC5fcXVldWUsIHMpO1xufVxuXG4vKipcbiAqIEF0dGVtcHRzIHRvIGVuYWJsZSBwZXJzaXN0ZW50IHN0b3JhZ2UsIGlmIHBvc3NpYmxlLlxuICpcbiAqIE11c3QgYmUgY2FsbGVkIGJlZm9yZSBhbnkgb3RoZXIgZnVuY3Rpb25zIChvdGhlciB0aGFuXG4gKiB7QGxpbmsgaW5pdGlhbGl6ZUZpcmVzdG9yZX0sIHtAbGluayBnZXRGaXJlc3RvcmV9IG9yXG4gKiB7QGxpbmsgY2xlYXJJbmRleGVkRGJQZXJzaXN0ZW5jZX0uXG4gKlxuICogSWYgdGhpcyBmYWlscywgYGVuYWJsZUluZGV4ZWREYlBlcnNpc3RlbmNlKClgIHdpbGwgcmVqZWN0IHRoZSBwcm9taXNlIGl0XG4gKiByZXR1cm5zLiBOb3RlIHRoYXQgZXZlbiBhZnRlciB0aGlzIGZhaWx1cmUsIHRoZSB7QGxpbmsgRmlyZXN0b3JlfSBpbnN0YW5jZSB3aWxsXG4gKiByZW1haW4gdXNhYmxlLCBob3dldmVyIG9mZmxpbmUgcGVyc2lzdGVuY2Ugd2lsbCBiZSBkaXNhYmxlZC5cbiAqXG4gKiBUaGVyZSBhcmUgc2V2ZXJhbCByZWFzb25zIHdoeSB0aGlzIGNhbiBmYWlsLCB3aGljaCBjYW4gYmUgaWRlbnRpZmllZCBieVxuICogdGhlIGBjb2RlYCBvbiB0aGUgZXJyb3IuXG4gKlxuICogICAqIGZhaWxlZC1wcmVjb25kaXRpb246IFRoZSBhcHAgaXMgYWxyZWFkeSBvcGVuIGluIGFub3RoZXIgYnJvd3NlciB0YWIuXG4gKiAgICogdW5pbXBsZW1lbnRlZDogVGhlIGJyb3dzZXIgaXMgaW5jb21wYXRpYmxlIHdpdGggdGhlIG9mZmxpbmVcbiAqICAgICBwZXJzaXN0ZW5jZSBpbXBsZW1lbnRhdGlvbi5cbiAqXG4gKiBAcGFyYW0gZmlyZXN0b3JlIC0gVGhlIHtAbGluayBGaXJlc3RvcmV9IGluc3RhbmNlIHRvIGVuYWJsZSBwZXJzaXN0ZW5jZSBmb3IuXG4gKiBAcGFyYW0gcGVyc2lzdGVuY2VTZXR0aW5ncyAtIE9wdGlvbmFsIHNldHRpbmdzIG9iamVjdCB0byBjb25maWd1cmVcbiAqIHBlcnNpc3RlbmNlLlxuICogQHJldHVybnMgQSBgUHJvbWlzZWAgdGhhdCByZXByZXNlbnRzIHN1Y2Nlc3NmdWxseSBlbmFibGluZyBwZXJzaXN0ZW50IHN0b3JhZ2UuXG4gKi8gZnVuY3Rpb24gTWModCwgZSkge1xuICAgIHpjKHQgPSBtYyh0LCB4YykpO1xuICAgIGNvbnN0IG4gPSBPYyh0KSwgcyA9IHQuX2ZyZWV6ZVNldHRpbmdzKCksIGkgPSBuZXcgT2E7XG4gICAgcmV0dXJuIEJjKG4sIGksIG5ldyBrYShpLCBzLmNhY2hlU2l6ZUJ5dGVzLCBudWxsID09IGUgPyB2b2lkIDAgOiBlLmZvcmNlT3duZXJzaGlwKSk7XG59XG5cbi8qKlxuICogQXR0ZW1wdHMgdG8gZW5hYmxlIG11bHRpLXRhYiBwZXJzaXN0ZW50IHN0b3JhZ2UsIGlmIHBvc3NpYmxlLiBJZiBlbmFibGVkXG4gKiBhY3Jvc3MgYWxsIHRhYnMsIGFsbCBvcGVyYXRpb25zIHNoYXJlIGFjY2VzcyB0byBsb2NhbCBwZXJzaXN0ZW5jZSwgaW5jbHVkaW5nXG4gKiBzaGFyZWQgZXhlY3V0aW9uIG9mIHF1ZXJpZXMgYW5kIGxhdGVuY3ktY29tcGVuc2F0ZWQgbG9jYWwgZG9jdW1lbnQgdXBkYXRlc1xuICogYWNyb3NzIGFsbCBjb25uZWN0ZWQgaW5zdGFuY2VzLlxuICpcbiAqIElmIHRoaXMgZmFpbHMsIGBlbmFibGVNdWx0aVRhYkluZGV4ZWREYlBlcnNpc3RlbmNlKClgIHdpbGwgcmVqZWN0IHRoZSBwcm9taXNlXG4gKiBpdCByZXR1cm5zLiBOb3RlIHRoYXQgZXZlbiBhZnRlciB0aGlzIGZhaWx1cmUsIHRoZSB7QGxpbmsgRmlyZXN0b3JlfSBpbnN0YW5jZSB3aWxsXG4gKiByZW1haW4gdXNhYmxlLCBob3dldmVyIG9mZmxpbmUgcGVyc2lzdGVuY2Ugd2lsbCBiZSBkaXNhYmxlZC5cbiAqXG4gKiBUaGVyZSBhcmUgc2V2ZXJhbCByZWFzb25zIHdoeSB0aGlzIGNhbiBmYWlsLCB3aGljaCBjYW4gYmUgaWRlbnRpZmllZCBieVxuICogdGhlIGBjb2RlYCBvbiB0aGUgZXJyb3IuXG4gKlxuICogICAqIGZhaWxlZC1wcmVjb25kaXRpb246IFRoZSBhcHAgaXMgYWxyZWFkeSBvcGVuIGluIGFub3RoZXIgYnJvd3NlciB0YWIgYW5kXG4gKiAgICAgbXVsdGktdGFiIGlzIG5vdCBlbmFibGVkLlxuICogICAqIHVuaW1wbGVtZW50ZWQ6IFRoZSBicm93c2VyIGlzIGluY29tcGF0aWJsZSB3aXRoIHRoZSBvZmZsaW5lXG4gKiAgICAgcGVyc2lzdGVuY2UgaW1wbGVtZW50YXRpb24uXG4gKlxuICogQHBhcmFtIGZpcmVzdG9yZSAtIFRoZSB7QGxpbmsgRmlyZXN0b3JlfSBpbnN0YW5jZSB0byBlbmFibGUgcGVyc2lzdGVuY2UgZm9yLlxuICogQHJldHVybnMgQSBgUHJvbWlzZWAgdGhhdCByZXByZXNlbnRzIHN1Y2Nlc3NmdWxseSBlbmFibGluZyBwZXJzaXN0ZW50XG4gKiBzdG9yYWdlLlxuICovIGZ1bmN0aW9uIExjKHQpIHtcbiAgICB6Yyh0ID0gbWModCwgeGMpKTtcbiAgICBjb25zdCBlID0gT2ModCksIG4gPSB0Ll9mcmVlemVTZXR0aW5ncygpLCBzID0gbmV3IE9hO1xuICAgIHJldHVybiBCYyhlLCBzLCBuZXcgJGEocywgbi5jYWNoZVNpemVCeXRlcykpO1xufVxuXG4vKipcbiAqIFJlZ2lzdGVycyBib3RoIHRoZSBgT2ZmbGluZUNvbXBvbmVudFByb3ZpZGVyYCBhbmQgYE9ubGluZUNvbXBvbmVudFByb3ZpZGVyYC5cbiAqIElmIHRoZSBvcGVyYXRpb24gZmFpbHMgd2l0aCBhIHJlY292ZXJhYmxlIGVycm9yIChzZWVcbiAqIGBjYW5SZWNvdmVyRnJvbUluZGV4ZWREYkVycm9yKClgIGJlbG93KSwgdGhlIHJldHVybmVkIFByb21pc2UgaXMgcmVqZWN0ZWRcbiAqIGJ1dCB0aGUgY2xpZW50IHJlbWFpbnMgdXNhYmxlLlxuICovIGZ1bmN0aW9uIEJjKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gbmV3IGo7XG4gICAgcmV0dXJuIHQuYXN5bmNRdWV1ZS5lbnF1ZXVlKChhc3luYyAoKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCBLYSh0LCBuKSwgYXdhaXQgamEodCwgZSksIHMucmVzb2x2ZSgpO1xuICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICBpZiAoIVxuICAgICAgICAgICAgLyoqXG4gKiBEZWNpZGVzIHdoZXRoZXIgdGhlIHByb3ZpZGVkIGVycm9yIGFsbG93cyB1cyB0byBncmFjZWZ1bGx5IGRpc2FibGVcbiAqIHBlcnNpc3RlbmNlIChhcyBvcHBvc2VkIHRvIGNyYXNoaW5nIHRoZSBjbGllbnQpLlxuICovXG4gICAgICAgICAgICBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgaWYgKFwiRmlyZWJhc2VFcnJvclwiID09PSB0Lm5hbWUpIHJldHVybiB0LmNvZGUgPT09IHEuRkFJTEVEX1BSRUNPTkRJVElPTiB8fCB0LmNvZGUgPT09IHEuVU5JTVBMRU1FTlRFRDtcbiAgICAgICAgICAgICAgICBpZiAoXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgRE9NRXhjZXB0aW9uICYmIHQgaW5zdGFuY2VvZiBET01FeGNlcHRpb24pIFxuICAgICAgICAgICAgICAgIC8vIFRoZXJlIGFyZSBhIGZldyBrbm93biBjaXJjdW1zdGFuY2VzIHdoZXJlIHdlIGNhbiBvcGVuIEluZGV4ZWREYiBidXRcbiAgICAgICAgICAgICAgICAvLyB0cnlpbmcgdG8gcmVhZC93cml0ZSB3aWxsIGZhaWwgKGUuZy4gcXVvdGEgZXhjZWVkZWQpLiBGb3JcbiAgICAgICAgICAgICAgICAvLyB3ZWxsLXVuZGVyc3Rvb2QgY2FzZXMsIHdlIGF0dGVtcHQgdG8gZGV0ZWN0IHRoZXNlIGFuZCB0aGVuIGdyYWNlZnVsbHlcbiAgICAgICAgICAgICAgICAvLyBmYWxsIGJhY2sgdG8gbWVtb3J5IHBlcnNpc3RlbmNlLlxuICAgICAgICAgICAgICAgIC8vIE5PVEU6IFJhdGhlciB0aGFuIGNvbnRpbnVlIHRvIGFkZCB0byB0aGlzIGxpc3QsIHdlIGNvdWxkIGRlY2lkZSB0b1xuICAgICAgICAgICAgICAgIC8vIGFsd2F5cyBmYWxsIGJhY2ssIHdpdGggdGhlIHJpc2sgdGhhdCB3ZSBtaWdodCBhY2NpZGVudGFsbHkgaGlkZSBlcnJvcnNcbiAgICAgICAgICAgICAgICAvLyByZXByZXNlbnRpbmcgYWN0dWFsIFNESyBidWdzLlxuICAgICAgICAgICAgICAgIC8vIFdoZW4gdGhlIGJyb3dzZXIgaXMgb3V0IG9mIHF1b3RhIHdlIGNvdWxkIGdldCBlaXRoZXIgcXVvdGEgZXhjZWVkZWRcbiAgICAgICAgICAgICAgICAvLyBvciBhbiBhYm9ydGVkIGVycm9yIGRlcGVuZGluZyBvbiB3aGV0aGVyIHRoZSBlcnJvciBoYXBwZW5lZCBkdXJpbmdcbiAgICAgICAgICAgICAgICAvLyBzY2hlbWEgbWlncmF0aW9uLlxuICAgICAgICAgICAgICAgIHJldHVybiAyMiA9PT0gdC5jb2RlIHx8IDIwID09PSB0LmNvZGUgfHwgXG4gICAgICAgICAgICAgICAgLy8gRmlyZWZveCBQcml2YXRlIEJyb3dzaW5nIG1vZGUgZGlzYWJsZXMgSW5kZXhlZERiIGFuZCByZXR1cm5zXG4gICAgICAgICAgICAgICAgLy8gSU5WQUxJRF9TVEFURSBmb3IgYW55IHVzYWdlLlxuICAgICAgICAgICAgICAgIDExID09PSB0LmNvZGU7XG4gICAgICAgICAgICAgICAgcmV0dXJuICEwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyoqXG4gKiBDbGVhcnMgdGhlIHBlcnNpc3RlbnQgc3RvcmFnZS4gVGhpcyBpbmNsdWRlcyBwZW5kaW5nIHdyaXRlcyBhbmQgY2FjaGVkXG4gKiBkb2N1bWVudHMuXG4gKlxuICogTXVzdCBiZSBjYWxsZWQgd2hpbGUgdGhlIHtAbGluayBGaXJlc3RvcmV9IGluc3RhbmNlIGlzIG5vdCBzdGFydGVkIChhZnRlciB0aGUgYXBwIGlzXG4gKiB0ZXJtaW5hdGVkIG9yIHdoZW4gdGhlIGFwcCBpcyBmaXJzdCBpbml0aWFsaXplZCkuIE9uIHN0YXJ0dXAsIHRoaXMgZnVuY3Rpb25cbiAqIG11c3QgYmUgY2FsbGVkIGJlZm9yZSBvdGhlciBmdW5jdGlvbnMgKG90aGVyIHRoYW4ge0BsaW5rXG4gKiBpbml0aWFsaXplRmlyZXN0b3JlfSBvciB7QGxpbmsgZ2V0RmlyZXN0b3JlfSkpLiBJZiB0aGUge0BsaW5rIEZpcmVzdG9yZX1cbiAqIGluc3RhbmNlIGlzIHN0aWxsIHJ1bm5pbmcsIHRoZSBwcm9taXNlIHdpbGwgYmUgcmVqZWN0ZWQgd2l0aCB0aGUgZXJyb3IgY29kZVxuICogb2YgYGZhaWxlZC1wcmVjb25kaXRpb25gLlxuICpcbiAqIE5vdGU6IGBjbGVhckluZGV4ZWREYlBlcnNpc3RlbmNlKClgIGlzIHByaW1hcmlseSBpbnRlbmRlZCB0byBoZWxwIHdyaXRlXG4gKiByZWxpYWJsZSB0ZXN0cyB0aGF0IHVzZSBDbG91ZCBGaXJlc3RvcmUuIEl0IHVzZXMgYW4gZWZmaWNpZW50IG1lY2hhbmlzbSBmb3JcbiAqIGRyb3BwaW5nIGV4aXN0aW5nIGRhdGEgYnV0IGRvZXMgbm90IGF0dGVtcHQgdG8gc2VjdXJlbHkgb3ZlcndyaXRlIG9yXG4gKiBvdGhlcndpc2UgbWFrZSBjYWNoZWQgZGF0YSB1bnJlY292ZXJhYmxlLiBGb3IgYXBwbGljYXRpb25zIHRoYXQgYXJlIHNlbnNpdGl2ZVxuICogdG8gdGhlIGRpc2Nsb3N1cmUgb2YgY2FjaGVkIGRhdGEgaW4gYmV0d2VlbiB1c2VyIHNlc3Npb25zLCB3ZSBzdHJvbmdseVxuICogcmVjb21tZW5kIG5vdCBlbmFibGluZyBwZXJzaXN0ZW5jZSBhdCBhbGwuXG4gKlxuICogQHBhcmFtIGZpcmVzdG9yZSAtIFRoZSB7QGxpbmsgRmlyZXN0b3JlfSBpbnN0YW5jZSB0byBjbGVhciBwZXJzaXN0ZW5jZSBmb3IuXG4gKiBAcmV0dXJucyBBIGBQcm9taXNlYCB0aGF0IGlzIHJlc29sdmVkIHdoZW4gdGhlIHBlcnNpc3RlbnQgc3RvcmFnZSBpc1xuICogY2xlYXJlZC4gT3RoZXJ3aXNlLCB0aGUgcHJvbWlzZSBpcyByZWplY3RlZCB3aXRoIGFuIGVycm9yLlxuICovICh0KSkgdGhyb3cgdDtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihcIkVycm9yIGVuYWJsaW5nIG9mZmxpbmUgcGVyc2lzdGVuY2UuIEZhbGxpbmcgYmFjayB0byBwZXJzaXN0ZW5jZSBkaXNhYmxlZDogXCIgKyB0KSwgXG4gICAgICAgICAgICBzLnJlamVjdCh0KTtcbiAgICAgICAgfVxuICAgIH0pKS50aGVuKCgoKSA9PiBzLnByb21pc2UpKTtcbn1cblxuZnVuY3Rpb24gVWModCkge1xuICAgIGlmICh0Ll9pbml0aWFsaXplZCAmJiAhdC5fdGVybWluYXRlZCkgdGhyb3cgbmV3IEsocS5GQUlMRURfUFJFQ09ORElUSU9OLCBcIlBlcnNpc3RlbmNlIGNhbiBvbmx5IGJlIGNsZWFyZWQgYmVmb3JlIGEgRmlyZXN0b3JlIGluc3RhbmNlIGlzIGluaXRpYWxpemVkIG9yIGFmdGVyIGl0IGlzIHRlcm1pbmF0ZWQuXCIpO1xuICAgIGNvbnN0IGUgPSBuZXcgajtcbiAgICByZXR1cm4gdC5fcXVldWUuZW5xdWV1ZUFuZEZvcmdldEV2ZW5XaGlsZVJlc3RyaWN0ZWQoKGFzeW5jICgpID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IGFzeW5jIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgICAgICBpZiAoIVFzLlB0KCkpIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdCArIFwibWFpblwiO1xuICAgICAgICAgICAgICAgIGF3YWl0IFFzLmRlbGV0ZShlKTtcbiAgICAgICAgICAgIH0obnIodC5fZGF0YWJhc2VJZCwgdC5fcGVyc2lzdGVuY2VLZXkpKSwgZS5yZXNvbHZlKCk7XG4gICAgICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgICAgIGUucmVqZWN0KHQpO1xuICAgICAgICB9XG4gICAgfSkpLCBlLnByb21pc2U7XG59XG5cbi8qKlxuICogV2FpdHMgdW50aWwgYWxsIGN1cnJlbnRseSBwZW5kaW5nIHdyaXRlcyBmb3IgdGhlIGFjdGl2ZSB1c2VyIGhhdmUgYmVlblxuICogYWNrbm93bGVkZ2VkIGJ5IHRoZSBiYWNrZW5kLlxuICpcbiAqIFRoZSByZXR1cm5lZCBwcm9taXNlIHJlc29sdmVzIGltbWVkaWF0ZWx5IGlmIHRoZXJlIGFyZSBubyBvdXRzdGFuZGluZyB3cml0ZXMuXG4gKiBPdGhlcndpc2UsIHRoZSBwcm9taXNlIHdhaXRzIGZvciBhbGwgcHJldmlvdXNseSBpc3N1ZWQgd3JpdGVzIChpbmNsdWRpbmdcbiAqIHRob3NlIHdyaXR0ZW4gaW4gYSBwcmV2aW91cyBhcHAgc2Vzc2lvbiksIGJ1dCBpdCBkb2VzIG5vdCB3YWl0IGZvciB3cml0ZXNcbiAqIHRoYXQgd2VyZSBhZGRlZCBhZnRlciB0aGUgZnVuY3Rpb24gaXMgY2FsbGVkLiBJZiB5b3Ugd2FudCB0byB3YWl0IGZvclxuICogYWRkaXRpb25hbCB3cml0ZXMsIGNhbGwgYHdhaXRGb3JQZW5kaW5nV3JpdGVzKClgIGFnYWluLlxuICpcbiAqIEFueSBvdXRzdGFuZGluZyBgd2FpdEZvclBlbmRpbmdXcml0ZXMoKWAgcHJvbWlzZXMgYXJlIHJlamVjdGVkIGR1cmluZyB1c2VyXG4gKiBjaGFuZ2VzLlxuICpcbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHdoaWNoIHJlc29sdmVzIHdoZW4gYWxsIGN1cnJlbnRseSBwZW5kaW5nIHdyaXRlcyBoYXZlIGJlZW5cbiAqIGFja25vd2xlZGdlZCBieSB0aGUgYmFja2VuZC5cbiAqLyBmdW5jdGlvbiBxYyh0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IG5ldyBqO1xuICAgICAgICByZXR1cm4gdC5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoKGFzeW5jICgpID0+IGhhKGF3YWl0IEphKHQpLCBlKSkpLCBlLnByb21pc2U7XG4gICAgfShPYyh0ID0gbWModCwgeGMpKSk7XG59XG5cbi8qKlxuICogUmUtZW5hYmxlcyB1c2Ugb2YgdGhlIG5ldHdvcmsgZm9yIHRoaXMge0BsaW5rIEZpcmVzdG9yZX0gaW5zdGFuY2UgYWZ0ZXIgYSBwcmlvclxuICogY2FsbCB0byB7QGxpbmsgZGlzYWJsZU5ldHdvcmt9LlxuICpcbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHRoYXQgaXMgcmVzb2x2ZWQgb25jZSB0aGUgbmV0d29yayBoYXMgYmVlbiBlbmFibGVkLlxuICovIGZ1bmN0aW9uIEtjKHQpIHtcbiAgICByZXR1cm4gWGEoT2ModCA9IG1jKHQsIHhjKSkpO1xufVxuXG4vKipcbiAqIERpc2FibGVzIG5ldHdvcmsgdXNhZ2UgZm9yIHRoaXMgaW5zdGFuY2UuIEl0IGNhbiBiZSByZS1lbmFibGVkIHZpYSB7QGxpbmtcbiAqIGVuYWJsZU5ldHdvcmt9LiBXaGlsZSB0aGUgbmV0d29yayBpcyBkaXNhYmxlZCwgYW55IHNuYXBzaG90IGxpc3RlbmVycyxcbiAqIGBnZXREb2MoKWAgb3IgYGdldERvY3MoKWAgY2FsbHMgd2lsbCByZXR1cm4gcmVzdWx0cyBmcm9tIGNhY2hlLCBhbmQgYW55IHdyaXRlXG4gKiBvcGVyYXRpb25zIHdpbGwgYmUgcXVldWVkIHVudGlsIHRoZSBuZXR3b3JrIGlzIHJlc3RvcmVkLlxuICpcbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHRoYXQgaXMgcmVzb2x2ZWQgb25jZSB0aGUgbmV0d29yayBoYXMgYmVlbiBkaXNhYmxlZC5cbiAqLyBmdW5jdGlvbiBqYyh0KSB7XG4gICAgcmV0dXJuIFphKE9jKHQgPSBtYyh0LCB4YykpKTtcbn1cblxuLyoqXG4gKiBUZXJtaW5hdGVzIHRoZSBwcm92aWRlZCB7QGxpbmsgRmlyZXN0b3JlfSBpbnN0YW5jZS5cbiAqXG4gKiBBZnRlciBjYWxsaW5nIGB0ZXJtaW5hdGUoKWAgb25seSB0aGUgYGNsZWFySW5kZXhlZERiUGVyc2lzdGVuY2UoKWAgZnVuY3Rpb25cbiAqIG1heSBiZSB1c2VkLiBBbnkgb3RoZXIgZnVuY3Rpb24gd2lsbCB0aHJvdyBhIGBGaXJlc3RvcmVFcnJvcmAuXG4gKlxuICogVG8gcmVzdGFydCBhZnRlciB0ZXJtaW5hdGlvbiwgY3JlYXRlIGEgbmV3IGluc3RhbmNlIG9mIEZpcmViYXNlRmlyZXN0b3JlIHdpdGhcbiAqIHtAbGluayBnZXRGaXJlc3RvcmV9LlxuICpcbiAqIFRlcm1pbmF0aW9uIGRvZXMgbm90IGNhbmNlbCBhbnkgcGVuZGluZyB3cml0ZXMsIGFuZCBhbnkgcHJvbWlzZXMgdGhhdCBhcmVcbiAqIGF3YWl0aW5nIGEgcmVzcG9uc2UgZnJvbSB0aGUgc2VydmVyIHdpbGwgbm90IGJlIHJlc29sdmVkLiBJZiB5b3UgaGF2ZVxuICogcGVyc2lzdGVuY2UgZW5hYmxlZCwgdGhlIG5leHQgdGltZSB5b3Ugc3RhcnQgdGhpcyBpbnN0YW5jZSwgaXQgd2lsbCByZXN1bWVcbiAqIHNlbmRpbmcgdGhlc2Ugd3JpdGVzIHRvIHRoZSBzZXJ2ZXIuXG4gKlxuICogTm90ZTogVW5kZXIgbm9ybWFsIGNpcmN1bXN0YW5jZXMsIGNhbGxpbmcgYHRlcm1pbmF0ZSgpYCBpcyBub3QgcmVxdWlyZWQuIFRoaXNcbiAqIGZ1bmN0aW9uIGlzIHVzZWZ1bCBvbmx5IHdoZW4geW91IHdhbnQgdG8gZm9yY2UgdGhpcyBpbnN0YW5jZSB0byByZWxlYXNlIGFsbFxuICogb2YgaXRzIHJlc291cmNlcyBvciBpbiBjb21iaW5hdGlvbiB3aXRoIGBjbGVhckluZGV4ZWREYlBlcnNpc3RlbmNlKClgIHRvXG4gKiBlbnN1cmUgdGhhdCBhbGwgbG9jYWwgc3RhdGUgaXMgZGVzdHJveWVkIGJldHdlZW4gdGVzdCBydW5zLlxuICpcbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHRoYXQgaXMgcmVzb2x2ZWQgd2hlbiB0aGUgaW5zdGFuY2UgaGFzIGJlZW4gc3VjY2Vzc2Z1bGx5XG4gKiB0ZXJtaW5hdGVkLlxuICovIGZ1bmN0aW9uIFFjKHQpIHtcbiAgICByZXR1cm4gbih0LmFwcCwgXCJmaXJlc3RvcmVcIiksIHQuX2RlbGV0ZSgpO1xufVxuXG4vKipcbiAqIExvYWRzIGEgRmlyZXN0b3JlIGJ1bmRsZSBpbnRvIHRoZSBsb2NhbCBjYWNoZS5cbiAqXG4gKiBAcGFyYW0gZmlyZXN0b3JlIC0gVGhlIHtAbGluayBGaXJlc3RvcmV9IGluc3RhbmNlIHRvIGxvYWQgYnVuZGxlcyBmb3IgZm9yLlxuICogQHBhcmFtIGJ1bmRsZURhdGEgLSBBbiBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSBidW5kbGUgdG8gYmUgbG9hZGVkLiBWYWxpZCBvYmplY3RzIGFyZVxuICogICBgQXJyYXlCdWZmZXJgLCBgUmVhZGFibGVTdHJlYW08VWludDhBcnJheT5gIG9yIGBzdHJpbmdgLlxuICpcbiAqIEByZXR1cm5zXG4gKiAgIEEgYExvYWRCdW5kbGVUYXNrYCBvYmplY3QsIHdoaWNoIG5vdGlmaWVzIGNhbGxlcnMgd2l0aCBwcm9ncmVzcyB1cGRhdGVzLCBhbmQgY29tcGxldGlvblxuICogICBvciBlcnJvciBldmVudHMuIEl0IGNhbiBiZSB1c2VkIGFzIGEgYFByb21pc2U8TG9hZEJ1bmRsZVRhc2tQcm9ncmVzcz5gLlxuICovIGZ1bmN0aW9uIFdjKHQsIGUpIHtcbiAgICBjb25zdCBuID0gT2ModCA9IG1jKHQsIHhjKSksIHMgPSBuZXcgQ2M7XG4gICAgcmV0dXJuIG9jKG4sIHQuX2RhdGFiYXNlSWQsIGUsIHMpLCBzO1xufVxuXG4vKipcbiAqIFJlYWRzIGEgRmlyZXN0b3JlIHtAbGluayBRdWVyeX0gZnJvbSBsb2NhbCBjYWNoZSwgaWRlbnRpZmllZCBieSB0aGUgZ2l2ZW4gbmFtZS5cbiAqXG4gKiBUaGUgbmFtZWQgcXVlcmllcyBhcmUgcGFja2FnZWQgIGludG8gYnVuZGxlcyBvbiB0aGUgc2VydmVyIHNpZGUgKGFsb25nXG4gKiB3aXRoIHJlc3VsdGluZyBkb2N1bWVudHMpLCBhbmQgbG9hZGVkIHRvIGxvY2FsIGNhY2hlIHVzaW5nIGBsb2FkQnVuZGxlYC4gT25jZSBpbiBsb2NhbFxuICogY2FjaGUsIHVzZSB0aGlzIG1ldGhvZCB0byBleHRyYWN0IGEge0BsaW5rIFF1ZXJ5fSBieSBuYW1lLlxuICovIGZ1bmN0aW9uIEdjKHQsIGUpIHtcbiAgICByZXR1cm4gYWMoT2ModCA9IG1jKHQsIHhjKSksIGUpLnRoZW4oKGUgPT4gZSA/IG5ldyBJYyh0LCBudWxsLCBlLnF1ZXJ5KSA6IG51bGwpKTtcbn1cblxuZnVuY3Rpb24gemModCkge1xuICAgIGlmICh0Ll9pbml0aWFsaXplZCB8fCB0Ll90ZXJtaW5hdGVkKSB0aHJvdyBuZXcgSyhxLkZBSUxFRF9QUkVDT05ESVRJT04sIFwiRmlyZXN0b3JlIGhhcyBhbHJlYWR5IGJlZW4gc3RhcnRlZCBhbmQgcGVyc2lzdGVuY2UgY2FuIG5vIGxvbmdlciBiZSBlbmFibGVkLiBZb3UgY2FuIG9ubHkgZW5hYmxlIHBlcnNpc3RlbmNlIGJlZm9yZSBjYWxsaW5nIGFueSBvdGhlciBtZXRob2RzIG9uIGEgRmlyZXN0b3JlIG9iamVjdC5cIik7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBIGBGaWVsZFBhdGhgIHJlZmVycyB0byBhIGZpZWxkIGluIGEgZG9jdW1lbnQuIFRoZSBwYXRoIG1heSBjb25zaXN0IG9mIGFcbiAqIHNpbmdsZSBmaWVsZCBuYW1lIChyZWZlcnJpbmcgdG8gYSB0b3AtbGV2ZWwgZmllbGQgaW4gdGhlIGRvY3VtZW50KSwgb3IgYVxuICogbGlzdCBvZiBmaWVsZCBuYW1lcyAocmVmZXJyaW5nIHRvIGEgbmVzdGVkIGZpZWxkIGluIHRoZSBkb2N1bWVudCkuXG4gKlxuICogQ3JlYXRlIGEgYEZpZWxkUGF0aGAgYnkgcHJvdmlkaW5nIGZpZWxkIG5hbWVzLiBJZiBtb3JlIHRoYW4gb25lIGZpZWxkXG4gKiBuYW1lIGlzIHByb3ZpZGVkLCB0aGUgcGF0aCB3aWxsIHBvaW50IHRvIGEgbmVzdGVkIGZpZWxkIGluIGEgZG9jdW1lbnQuXG4gKi9cbmNsYXNzIEhjIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgYEZpZWxkUGF0aGAgZnJvbSB0aGUgcHJvdmlkZWQgZmllbGQgbmFtZXMuIElmIG1vcmUgdGhhbiBvbmUgZmllbGRcbiAgICAgKiBuYW1lIGlzIHByb3ZpZGVkLCB0aGUgcGF0aCB3aWxsIHBvaW50IHRvIGEgbmVzdGVkIGZpZWxkIGluIGEgZG9jdW1lbnQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZmllbGROYW1lcyAtIEEgbGlzdCBvZiBmaWVsZCBuYW1lcy5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvciguLi50KSB7XG4gICAgICAgIGZvciAobGV0IGUgPSAwOyBlIDwgdC5sZW5ndGg7ICsrZSkgaWYgKDAgPT09IHRbZV0ubGVuZ3RoKSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIFwiSW52YWxpZCBmaWVsZCBuYW1lIGF0IGFyZ3VtZW50ICQoaSArIDEpLiBGaWVsZCBuYW1lcyBtdXN0IG5vdCBiZSBlbXB0eS5cIik7XG4gICAgICAgIHRoaXMuX2ludGVybmFsUGF0aCA9IG5ldyBsdCh0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHRoaXMgYEZpZWxkUGF0aGAgaXMgZXF1YWwgdG8gdGhlIHByb3ZpZGVkIG9uZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBvdGhlciAtIFRoZSBgRmllbGRQYXRoYCB0byBjb21wYXJlIGFnYWluc3QuXG4gICAgICogQHJldHVybnMgdHJ1ZSBpZiB0aGlzIGBGaWVsZFBhdGhgIGlzIGVxdWFsIHRvIHRoZSBwcm92aWRlZCBvbmUuXG4gICAgICovICAgIGlzRXF1YWwodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5faW50ZXJuYWxQYXRoLmlzRXF1YWwodC5faW50ZXJuYWxQYXRoKTtcbiAgICB9XG59XG5cbi8qKlxuICogUmV0dXJucyBhIHNwZWNpYWwgc2VudGluZWwgYEZpZWxkUGF0aGAgdG8gcmVmZXIgdG8gdGhlIElEIG9mIGEgZG9jdW1lbnQuXG4gKiBJdCBjYW4gYmUgdXNlZCBpbiBxdWVyaWVzIHRvIHNvcnQgb3IgZmlsdGVyIGJ5IHRoZSBkb2N1bWVudCBJRC5cbiAqLyBmdW5jdGlvbiBKYygpIHtcbiAgICByZXR1cm4gbmV3IEhjKFwiX19uYW1lX19cIik7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEFuIGltbXV0YWJsZSBvYmplY3QgcmVwcmVzZW50aW5nIGFuIGFycmF5IG9mIGJ5dGVzLlxuICovIGNsYXNzIFljIHtcbiAgICAvKiogQGhpZGVjb25zdHJ1Y3RvciAqL1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5fYnl0ZVN0cmluZyA9IHQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgYEJ5dGVzYCBvYmplY3QgZnJvbSB0aGUgZ2l2ZW4gQmFzZTY0IHN0cmluZywgY29udmVydGluZyBpdCB0b1xuICAgICAqIGJ5dGVzLlxuICAgICAqXG4gICAgICogQHBhcmFtIGJhc2U2NCAtIFRoZSBCYXNlNjQgc3RyaW5nIHVzZWQgdG8gY3JlYXRlIHRoZSBgQnl0ZXNgIG9iamVjdC5cbiAgICAgKi8gICAgc3RhdGljIGZyb21CYXNlNjRTdHJpbmcodCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBZYyh3dC5mcm9tQmFzZTY0U3RyaW5nKHQpKTtcbiAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEsocS5JTlZBTElEX0FSR1VNRU5ULCBcIkZhaWxlZCB0byBjb25zdHJ1Y3QgZGF0YSBmcm9tIEJhc2U2NCBzdHJpbmc6IFwiICsgdCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyBgQnl0ZXNgIG9iamVjdCBmcm9tIHRoZSBnaXZlbiBVaW50OEFycmF5LlxuICAgICAqXG4gICAgICogQHBhcmFtIGFycmF5IC0gVGhlIFVpbnQ4QXJyYXkgdXNlZCB0byBjcmVhdGUgdGhlIGBCeXRlc2Agb2JqZWN0LlxuICAgICAqLyAgICBzdGF0aWMgZnJvbVVpbnQ4QXJyYXkodCkge1xuICAgICAgICByZXR1cm4gbmV3IFljKHd0LmZyb21VaW50OEFycmF5KHQpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgdW5kZXJseWluZyBieXRlcyBhcyBhIEJhc2U2NC1lbmNvZGVkIHN0cmluZy5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIFRoZSBCYXNlNjQtZW5jb2RlZCBzdHJpbmcgY3JlYXRlZCBmcm9tIHRoZSBgQnl0ZXNgIG9iamVjdC5cbiAgICAgKi8gICAgdG9CYXNlNjQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9ieXRlU3RyaW5nLnRvQmFzZTY0KCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIHVuZGVybHlpbmcgYnl0ZXMgaW4gYSBuZXcgYFVpbnQ4QXJyYXlgLlxuICAgICAqXG4gICAgICogQHJldHVybnMgVGhlIFVpbnQ4QXJyYXkgY3JlYXRlZCBmcm9tIHRoZSBgQnl0ZXNgIG9iamVjdC5cbiAgICAgKi8gICAgdG9VaW50OEFycmF5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fYnl0ZVN0cmluZy50b1VpbnQ4QXJyYXkoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgYEJ5dGVzYCBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBBIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgYEJ5dGVzYCBvYmplY3QuXG4gICAgICovICAgIHRvU3RyaW5nKCkge1xuICAgICAgICByZXR1cm4gXCJCeXRlcyhiYXNlNjQ6IFwiICsgdGhpcy50b0Jhc2U2NCgpICsgXCIpXCI7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGlzIGBCeXRlc2Agb2JqZWN0IGlzIGVxdWFsIHRvIHRoZSBwcm92aWRlZCBvbmUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gb3RoZXIgLSBUaGUgYEJ5dGVzYCBvYmplY3QgdG8gY29tcGFyZSBhZ2FpbnN0LlxuICAgICAqIEByZXR1cm5zIHRydWUgaWYgdGhpcyBgQnl0ZXNgIG9iamVjdCBpcyBlcXVhbCB0byB0aGUgcHJvdmlkZWQgb25lLlxuICAgICAqLyAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2J5dGVTdHJpbmcuaXNFcXVhbCh0Ll9ieXRlU3RyaW5nKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFNlbnRpbmVsIHZhbHVlcyB0aGF0IGNhbiBiZSB1c2VkIHdoZW4gd3JpdGluZyBkb2N1bWVudCBmaWVsZHMgd2l0aCBgc2V0KClgXG4gKiBvciBgdXBkYXRlKClgLlxuICovIGNsYXNzIFhjIHtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0gX21ldGhvZE5hbWUgLSBUaGUgcHVibGljIEFQSSBlbmRwb2ludCB0aGF0IHJldHVybnMgdGhpcyBjbGFzcy5cbiAgICAgKiBAaGlkZWNvbnN0cnVjdG9yXG4gICAgICovXG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLl9tZXRob2ROYW1lID0gdDtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEFuIGltbXV0YWJsZSBvYmplY3QgcmVwcmVzZW50aW5nIGEgZ2VvZ3JhcGhpYyBsb2NhdGlvbiBpbiBGaXJlc3RvcmUuIFRoZVxuICogbG9jYXRpb24gaXMgcmVwcmVzZW50ZWQgYXMgbGF0aXR1ZGUvbG9uZ2l0dWRlIHBhaXIuXG4gKlxuICogTGF0aXR1ZGUgdmFsdWVzIGFyZSBpbiB0aGUgcmFuZ2Ugb2YgWy05MCwgOTBdLlxuICogTG9uZ2l0dWRlIHZhbHVlcyBhcmUgaW4gdGhlIHJhbmdlIG9mIFstMTgwLCAxODBdLlxuICovIGNsYXNzIFpjIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IGltbXV0YWJsZSBgR2VvUG9pbnRgIG9iamVjdCB3aXRoIHRoZSBwcm92aWRlZCBsYXRpdHVkZSBhbmRcbiAgICAgKiBsb25naXR1ZGUgdmFsdWVzLlxuICAgICAqIEBwYXJhbSBsYXRpdHVkZSAtIFRoZSBsYXRpdHVkZSBhcyBudW1iZXIgYmV0d2VlbiAtOTAgYW5kIDkwLlxuICAgICAqIEBwYXJhbSBsb25naXR1ZGUgLSBUaGUgbG9uZ2l0dWRlIGFzIG51bWJlciBiZXR3ZWVuIC0xODAgYW5kIDE4MC5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIGlmICghaXNGaW5pdGUodCkgfHwgdCA8IC05MCB8fCB0ID4gOTApIHRocm93IG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgXCJMYXRpdHVkZSBtdXN0IGJlIGEgbnVtYmVyIGJldHdlZW4gLTkwIGFuZCA5MCwgYnV0IHdhczogXCIgKyB0KTtcbiAgICAgICAgaWYgKCFpc0Zpbml0ZShlKSB8fCBlIDwgLTE4MCB8fCBlID4gMTgwKSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIFwiTG9uZ2l0dWRlIG11c3QgYmUgYSBudW1iZXIgYmV0d2VlbiAtMTgwIGFuZCAxODAsIGJ1dCB3YXM6IFwiICsgZSk7XG4gICAgICAgIHRoaXMuX2xhdCA9IHQsIHRoaXMuX2xvbmcgPSBlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgbGF0aXR1ZGUgb2YgdGhpcyBgR2VvUG9pbnRgIGluc3RhbmNlLlxuICAgICAqLyAgICBnZXQgbGF0aXR1ZGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9sYXQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSBsb25naXR1ZGUgb2YgdGhpcyBgR2VvUG9pbnRgIGluc3RhbmNlLlxuICAgICAqLyAgICBnZXQgbG9uZ2l0dWRlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbG9uZztcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHRoaXMgYEdlb1BvaW50YCBpcyBlcXVhbCB0byB0aGUgcHJvdmlkZWQgb25lLlxuICAgICAqXG4gICAgICogQHBhcmFtIG90aGVyIC0gVGhlIGBHZW9Qb2ludGAgdG8gY29tcGFyZSBhZ2FpbnN0LlxuICAgICAqIEByZXR1cm5zIHRydWUgaWYgdGhpcyBgR2VvUG9pbnRgIGlzIGVxdWFsIHRvIHRoZSBwcm92aWRlZCBvbmUuXG4gICAgICovICAgIGlzRXF1YWwodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbGF0ID09PSB0Ll9sYXQgJiYgdGhpcy5fbG9uZyA9PT0gdC5fbG9uZztcbiAgICB9XG4gICAgLyoqIFJldHVybnMgYSBKU09OLXNlcmlhbGl6YWJsZSByZXByZXNlbnRhdGlvbiBvZiB0aGlzIEdlb1BvaW50LiAqLyAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBsYXRpdHVkZTogdGhpcy5fbGF0LFxuICAgICAgICAgICAgbG9uZ2l0dWRlOiB0aGlzLl9sb25nXG4gICAgICAgIH07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFjdHVhbGx5IHByaXZhdGUgdG8gSlMgY29uc3VtZXJzIG9mIG91ciBBUEksIHNvIHRoaXMgZnVuY3Rpb24gaXMgcHJlZml4ZWRcbiAgICAgKiB3aXRoIGFuIHVuZGVyc2NvcmUuXG4gICAgICovICAgIF9jb21wYXJlVG8odCkge1xuICAgICAgICByZXR1cm4gdHQodGhpcy5fbGF0LCB0Ll9sYXQpIHx8IHR0KHRoaXMuX2xvbmcsIHQuX2xvbmcpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY29uc3QgdHUgPSAvXl9fLipfXyQvO1xuXG4vKiogVGhlIHJlc3VsdCBvZiBwYXJzaW5nIGRvY3VtZW50IGRhdGEgKGUuZy4gZm9yIGEgc2V0RGF0YSBjYWxsKS4gKi8gY2xhc3MgZXUge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4pIHtcbiAgICAgICAgdGhpcy5kYXRhID0gdCwgdGhpcy5maWVsZE1hc2sgPSBlLCB0aGlzLmZpZWxkVHJhbnNmb3JtcyA9IG47XG4gICAgfVxuICAgIHRvTXV0YXRpb24odCwgZSkge1xuICAgICAgICByZXR1cm4gbnVsbCAhPT0gdGhpcy5maWVsZE1hc2sgPyBuZXcgZW4odCwgdGhpcy5kYXRhLCB0aGlzLmZpZWxkTWFzaywgZSwgdGhpcy5maWVsZFRyYW5zZm9ybXMpIDogbmV3IHRuKHQsIHRoaXMuZGF0YSwgZSwgdGhpcy5maWVsZFRyYW5zZm9ybXMpO1xuICAgIH1cbn1cblxuLyoqIFRoZSByZXN1bHQgb2YgcGFyc2luZyBcInVwZGF0ZVwiIGRhdGEgKGkuZS4gZm9yIGFuIHVwZGF0ZURhdGEgY2FsbCkuICovIGNsYXNzIG51IHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBcbiAgICAvLyBUaGUgZmllbGRNYXNrIGRvZXMgbm90IGluY2x1ZGUgZG9jdW1lbnQgdHJhbnNmb3Jtcy5cbiAgICBlLCBuKSB7XG4gICAgICAgIHRoaXMuZGF0YSA9IHQsIHRoaXMuZmllbGRNYXNrID0gZSwgdGhpcy5maWVsZFRyYW5zZm9ybXMgPSBuO1xuICAgIH1cbiAgICB0b011dGF0aW9uKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBlbih0LCB0aGlzLmRhdGEsIHRoaXMuZmllbGRNYXNrLCBlLCB0aGlzLmZpZWxkVHJhbnNmb3Jtcyk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBzdSh0KSB7XG4gICAgc3dpdGNoICh0KSB7XG4gICAgICBjYXNlIDAgLyogU2V0ICovIDpcbiAvLyBmYWxsIHRocm91Z2hcbiAgICAgICAgICAgICAgY2FzZSAyIC8qIE1lcmdlU2V0ICovIDpcbiAvLyBmYWxsIHRocm91Z2hcbiAgICAgICAgICAgICAgY2FzZSAxIC8qIFVwZGF0ZSAqLyA6XG4gICAgICAgIHJldHVybiAhMDtcblxuICAgICAgY2FzZSAzIC8qIEFyZ3VtZW50ICovIDpcbiAgICAgIGNhc2UgNCAvKiBBcnJheUFyZ3VtZW50ICovIDpcbiAgICAgICAgcmV0dXJuICExO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICB0aHJvdyBNKCk7XG4gICAgfVxufVxuXG4vKiogQSBcImNvbnRleHRcIiBvYmplY3QgcGFzc2VkIGFyb3VuZCB3aGlsZSBwYXJzaW5nIHVzZXIgZGF0YS4gKi8gY2xhc3MgaXUge1xuICAgIC8qKlxuICAgICAqIEluaXRpYWxpemVzIGEgUGFyc2VDb250ZXh0IHdpdGggdGhlIGdpdmVuIHNvdXJjZSBhbmQgcGF0aC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBzZXR0aW5ncyAtIFRoZSBzZXR0aW5ncyBmb3IgdGhlIHBhcnNlci5cbiAgICAgKiBAcGFyYW0gZGF0YWJhc2VJZCAtIFRoZSBkYXRhYmFzZSBJRCBvZiB0aGUgRmlyZXN0b3JlIGluc3RhbmNlLlxuICAgICAqIEBwYXJhbSBzZXJpYWxpemVyIC0gVGhlIHNlcmlhbGl6ZXIgdG8gdXNlIHRvIGdlbmVyYXRlIHRoZSBWYWx1ZSBwcm90by5cbiAgICAgKiBAcGFyYW0gaWdub3JlVW5kZWZpbmVkUHJvcGVydGllcyAtIFdoZXRoZXIgdG8gaWdub3JlIHVuZGVmaW5lZCBwcm9wZXJ0aWVzXG4gICAgICogcmF0aGVyIHRoYW4gdGhyb3cuXG4gICAgICogQHBhcmFtIGZpZWxkVHJhbnNmb3JtcyAtIEEgbXV0YWJsZSBsaXN0IG9mIGZpZWxkIHRyYW5zZm9ybXMgZW5jb3VudGVyZWRcbiAgICAgKiB3aGlsZSBwYXJzaW5nIHRoZSBkYXRhLlxuICAgICAqIEBwYXJhbSBmaWVsZE1hc2sgLSBBIG11dGFibGUgbGlzdCBvZiBmaWVsZCBwYXRocyBlbmNvdW50ZXJlZCB3aGlsZSBwYXJzaW5nXG4gICAgICogdGhlIGRhdGEuXG4gICAgICpcbiAgICAgKiBUT0RPKGIvMzQ4NzExMzEpOiBXZSBkb24ndCBzdXBwb3J0IGFycmF5IHBhdGhzIHJpZ2h0IG5vdywgc28gcGF0aCBjYW4gYmVcbiAgICAgKiBudWxsIHRvIGluZGljYXRlIHRoZSBjb250ZXh0IHJlcHJlc2VudHMgYW55IGxvY2F0aW9uIHdpdGhpbiBhbiBhcnJheSAoaW5cbiAgICAgKiB3aGljaCBjYXNlIGNlcnRhaW4gZmVhdHVyZXMgd2lsbCBub3Qgd29yayBhbmQgZXJyb3JzIHdpbGwgYmUgc29tZXdoYXRcbiAgICAgKiBjb21wcm9taXNlZCkuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcywgaSwgcikge1xuICAgICAgICB0aGlzLnNldHRpbmdzID0gdCwgdGhpcy5kYXRhYmFzZUlkID0gZSwgdGhpcy5OID0gbiwgdGhpcy5pZ25vcmVVbmRlZmluZWRQcm9wZXJ0aWVzID0gcywgXG4gICAgICAgIC8vIE1pbm9yIGhhY2s6IElmIGZpZWxkVHJhbnNmb3JtcyBpcyB1bmRlZmluZWQsIHdlIGFzc3VtZSB0aGlzIGlzIGFuXG4gICAgICAgIC8vIGV4dGVybmFsIGNhbGwgYW5kIHdlIG5lZWQgdG8gdmFsaWRhdGUgdGhlIGVudGlyZSBwYXRoLlxuICAgICAgICB2b2lkIDAgPT09IGkgJiYgdGhpcy5TYSgpLCB0aGlzLmZpZWxkVHJhbnNmb3JtcyA9IGkgfHwgW10sIHRoaXMuZmllbGRNYXNrID0gciB8fCBbXTtcbiAgICB9XG4gICAgZ2V0IHBhdGgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNldHRpbmdzLnBhdGg7XG4gICAgfVxuICAgIGdldCBEYSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2V0dGluZ3MuRGE7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIGEgbmV3IGNvbnRleHQgd2l0aCB0aGUgc3BlY2lmaWVkIHNldHRpbmdzIG92ZXJ3cml0dGVuLiAqLyAgICBDYSh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgaXUoT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCB0aGlzLnNldHRpbmdzKSwgdCksIHRoaXMuZGF0YWJhc2VJZCwgdGhpcy5OLCB0aGlzLmlnbm9yZVVuZGVmaW5lZFByb3BlcnRpZXMsIHRoaXMuZmllbGRUcmFuc2Zvcm1zLCB0aGlzLmZpZWxkTWFzayk7XG4gICAgfVxuICAgIE5hKHQpIHtcbiAgICAgICAgdmFyIGU7XG4gICAgICAgIGNvbnN0IG4gPSBudWxsID09PSAoZSA9IHRoaXMucGF0aCkgfHwgdm9pZCAwID09PSBlID8gdm9pZCAwIDogZS5jaGlsZCh0KSwgcyA9IHRoaXMuQ2Eoe1xuICAgICAgICAgICAgcGF0aDogbixcbiAgICAgICAgICAgIHhhOiAhMVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHMua2EodCksIHM7XG4gICAgfVxuICAgICRhKHQpIHtcbiAgICAgICAgdmFyIGU7XG4gICAgICAgIGNvbnN0IG4gPSBudWxsID09PSAoZSA9IHRoaXMucGF0aCkgfHwgdm9pZCAwID09PSBlID8gdm9pZCAwIDogZS5jaGlsZCh0KSwgcyA9IHRoaXMuQ2Eoe1xuICAgICAgICAgICAgcGF0aDogbixcbiAgICAgICAgICAgIHhhOiAhMVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHMuU2EoKSwgcztcbiAgICB9XG4gICAgT2EodCkge1xuICAgICAgICAvLyBUT0RPKGIvMzQ4NzExMzEpOiBXZSBkb24ndCBzdXBwb3J0IGFycmF5IHBhdGhzIHJpZ2h0IG5vdzsgc28gbWFrZSBwYXRoXG4gICAgICAgIC8vIHVuZGVmaW5lZC5cbiAgICAgICAgcmV0dXJuIHRoaXMuQ2Eoe1xuICAgICAgICAgICAgcGF0aDogdm9pZCAwLFxuICAgICAgICAgICAgeGE6ICEwXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBGYSh0KSB7XG4gICAgICAgIHJldHVybiBSdSh0LCB0aGlzLnNldHRpbmdzLm1ldGhvZE5hbWUsIHRoaXMuc2V0dGluZ3MuTWEgfHwgITEsIHRoaXMucGF0aCwgdGhpcy5zZXR0aW5ncy5MYSk7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zICd0cnVlJyBpZiAnZmllbGRQYXRoJyB3YXMgdHJhdmVyc2VkIHdoZW4gY3JlYXRpbmcgdGhpcyBjb250ZXh0LiAqLyAgICBjb250YWlucyh0KSB7XG4gICAgICAgIHJldHVybiB2b2lkIDAgIT09IHRoaXMuZmllbGRNYXNrLmZpbmQoKGUgPT4gdC5pc1ByZWZpeE9mKGUpKSkgfHwgdm9pZCAwICE9PSB0aGlzLmZpZWxkVHJhbnNmb3Jtcy5maW5kKChlID0+IHQuaXNQcmVmaXhPZihlLmZpZWxkKSkpO1xuICAgIH1cbiAgICBTYSgpIHtcbiAgICAgICAgLy8gVE9ETyhiLzM0ODcxMTMxKTogUmVtb3ZlIG51bGwgY2hlY2sgb25jZSB3ZSBoYXZlIHByb3BlciBwYXRocyBmb3IgZmllbGRzXG4gICAgICAgIC8vIHdpdGhpbiBhcnJheXMuXG4gICAgICAgIGlmICh0aGlzLnBhdGgpIGZvciAobGV0IHQgPSAwOyB0IDwgdGhpcy5wYXRoLmxlbmd0aDsgdCsrKSB0aGlzLmthKHRoaXMucGF0aC5nZXQodCkpO1xuICAgIH1cbiAgICBrYSh0KSB7XG4gICAgICAgIGlmICgwID09PSB0Lmxlbmd0aCkgdGhyb3cgdGhpcy5GYShcIkRvY3VtZW50IGZpZWxkcyBtdXN0IG5vdCBiZSBlbXB0eVwiKTtcbiAgICAgICAgaWYgKHN1KHRoaXMuRGEpICYmIHR1LnRlc3QodCkpIHRocm93IHRoaXMuRmEoJ0RvY3VtZW50IGZpZWxkcyBjYW5ub3QgYmVnaW4gYW5kIGVuZCB3aXRoIFwiX19cIicpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBIZWxwZXIgZm9yIHBhcnNpbmcgcmF3IHVzZXIgaW5wdXQgKHByb3ZpZGVkIHZpYSB0aGUgQVBJKSBpbnRvIGludGVybmFsIG1vZGVsXG4gKiBjbGFzc2VzLlxuICovIGNsYXNzIHJ1IHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHRoaXMuZGF0YWJhc2VJZCA9IHQsIHRoaXMuaWdub3JlVW5kZWZpbmVkUHJvcGVydGllcyA9IGUsIHRoaXMuTiA9IG4gfHwgSnIodCk7XG4gICAgfVxuICAgIC8qKiBDcmVhdGVzIGEgbmV3IHRvcC1sZXZlbCBwYXJzZSBjb250ZXh0LiAqLyAgICBCYSh0LCBlLCBuLCBzID0gITEpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBpdSh7XG4gICAgICAgICAgICBEYTogdCxcbiAgICAgICAgICAgIG1ldGhvZE5hbWU6IGUsXG4gICAgICAgICAgICBMYTogbixcbiAgICAgICAgICAgIHBhdGg6IGx0LmVtcHR5UGF0aCgpLFxuICAgICAgICAgICAgeGE6ICExLFxuICAgICAgICAgICAgTWE6IHNcbiAgICAgICAgfSwgdGhpcy5kYXRhYmFzZUlkLCB0aGlzLk4sIHRoaXMuaWdub3JlVW5kZWZpbmVkUHJvcGVydGllcyk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBvdSh0KSB7XG4gICAgY29uc3QgZSA9IHQuX2ZyZWV6ZVNldHRpbmdzKCksIG4gPSBKcih0Ll9kYXRhYmFzZUlkKTtcbiAgICByZXR1cm4gbmV3IHJ1KHQuX2RhdGFiYXNlSWQsICEhZS5pZ25vcmVVbmRlZmluZWRQcm9wZXJ0aWVzLCBuKTtcbn1cblxuLyoqIFBhcnNlIGRvY3VtZW50IGRhdGEgZnJvbSBhIHNldCgpIGNhbGwuICovIGZ1bmN0aW9uIGF1KHQsIGUsIG4sIHMsIGksIHIgPSB7fSkge1xuICAgIGNvbnN0IG8gPSB0LkJhKHIubWVyZ2UgfHwgci5tZXJnZUZpZWxkcyA/IDIgLyogTWVyZ2VTZXQgKi8gOiAwIC8qIFNldCAqLyAsIGUsIG4sIGkpO1xuICAgIEV1KFwiRGF0YSBtdXN0IGJlIGFuIG9iamVjdCwgYnV0IGl0IHdhczpcIiwgbywgcyk7XG4gICAgY29uc3QgYSA9IHl1KHMsIG8pO1xuICAgIGxldCBjLCB1O1xuICAgIGlmIChyLm1lcmdlKSBjID0gbmV3IGZ0KG8uZmllbGRNYXNrKSwgdSA9IG8uZmllbGRUcmFuc2Zvcm1zOyBlbHNlIGlmIChyLm1lcmdlRmllbGRzKSB7XG4gICAgICAgIGNvbnN0IHQgPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCBzIG9mIHIubWVyZ2VGaWVsZHMpIHtcbiAgICAgICAgICAgIGNvbnN0IGkgPSBUdShlLCBzLCBuKTtcbiAgICAgICAgICAgIGlmICghby5jb250YWlucyhpKSkgdGhyb3cgbmV3IEsocS5JTlZBTElEX0FSR1VNRU5ULCBgRmllbGQgJyR7aX0nIGlzIHNwZWNpZmllZCBpbiB5b3VyIGZpZWxkIG1hc2sgYnV0IG1pc3NpbmcgZnJvbSB5b3VyIGlucHV0IGRhdGEuYCk7XG4gICAgICAgICAgICBQdSh0LCBpKSB8fCB0LnB1c2goaSk7XG4gICAgICAgIH1cbiAgICAgICAgYyA9IG5ldyBmdCh0KSwgdSA9IG8uZmllbGRUcmFuc2Zvcm1zLmZpbHRlcigodCA9PiBjLmNvdmVycyh0LmZpZWxkKSkpO1xuICAgIH0gZWxzZSBjID0gbnVsbCwgdSA9IG8uZmllbGRUcmFuc2Zvcm1zO1xuICAgIHJldHVybiBuZXcgZXUobmV3IEJ0KGEpLCBjLCB1KTtcbn1cblxuY2xhc3MgY3UgZXh0ZW5kcyBYYyB7XG4gICAgX3RvRmllbGRUcmFuc2Zvcm0odCkge1xuICAgICAgICBpZiAoMiAvKiBNZXJnZVNldCAqLyAhPT0gdC5EYSkgdGhyb3cgMSAvKiBVcGRhdGUgKi8gPT09IHQuRGEgPyB0LkZhKGAke3RoaXMuX21ldGhvZE5hbWV9KCkgY2FuIG9ubHkgYXBwZWFyIGF0IHRoZSB0b3AgbGV2ZWwgb2YgeW91ciB1cGRhdGUgZGF0YWApIDogdC5GYShgJHt0aGlzLl9tZXRob2ROYW1lfSgpIGNhbm5vdCBiZSB1c2VkIHdpdGggc2V0KCkgdW5sZXNzIHlvdSBwYXNzIHttZXJnZTp0cnVlfWApO1xuICAgICAgICAvLyBObyB0cmFuc2Zvcm0gdG8gYWRkIGZvciBhIGRlbGV0ZSwgYnV0IHdlIG5lZWQgdG8gYWRkIGl0IHRvIG91clxuICAgICAgICAvLyBmaWVsZE1hc2sgc28gaXQgZ2V0cyBkZWxldGVkLlxuICAgICAgICByZXR1cm4gdC5maWVsZE1hc2sucHVzaCh0LnBhdGgpLCBudWxsO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgcmV0dXJuIHQgaW5zdGFuY2VvZiBjdTtcbiAgICB9XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIGNoaWxkIGNvbnRleHQgZm9yIHBhcnNpbmcgU2VyaWFsaXphYmxlRmllbGRWYWx1ZXMuXG4gKlxuICogVGhpcyBpcyBkaWZmZXJlbnQgdGhhbiBjYWxsaW5nIGBQYXJzZUNvbnRleHQuY29udGV4dFdpdGhgIGJlY2F1c2UgaXQga2VlcHNcbiAqIHRoZSBmaWVsZFRyYW5zZm9ybXMgYW5kIGZpZWxkTWFzayBzZXBhcmF0ZS5cbiAqXG4gKiBUaGUgY3JlYXRlZCBjb250ZXh0IGhhcyBpdHMgYGRhdGFTb3VyY2VgIHNldCB0byBgVXNlckRhdGFTb3VyY2UuQXJndW1lbnRgLlxuICogQWx0aG91Z2ggdGhlc2UgdmFsdWVzIGFyZSB1c2VkIHdpdGggd3JpdGVzLCBhbnkgZWxlbWVudHMgaW4gdGhlc2UgRmllbGRWYWx1ZXNcbiAqIGFyZSBub3QgY29uc2lkZXJlZCB3cml0ZXMgc2luY2UgdGhleSBjYW5ub3QgY29udGFpbiBhbnkgRmllbGRWYWx1ZSBzZW50aW5lbHMsXG4gKiBldGMuXG4gKlxuICogQHBhcmFtIGZpZWxkVmFsdWUgLSBUaGUgc2VudGluZWwgRmllbGRWYWx1ZSBmb3Igd2hpY2ggdG8gY3JlYXRlIGEgY2hpbGRcbiAqICAgICBjb250ZXh0LlxuICogQHBhcmFtIGNvbnRleHQgLSBUaGUgcGFyZW50IGNvbnRleHQuXG4gKiBAcGFyYW0gYXJyYXlFbGVtZW50IC0gV2hldGhlciBvciBub3QgdGhlIEZpZWxkVmFsdWUgaGFzIGFuIGFycmF5LlxuICovIGZ1bmN0aW9uIHV1KHQsIGUsIG4pIHtcbiAgICByZXR1cm4gbmV3IGl1KHtcbiAgICAgICAgRGE6IDMgLyogQXJndW1lbnQgKi8gLFxuICAgICAgICBMYTogZS5zZXR0aW5ncy5MYSxcbiAgICAgICAgbWV0aG9kTmFtZTogdC5fbWV0aG9kTmFtZSxcbiAgICAgICAgeGE6IG5cbiAgICB9LCBlLmRhdGFiYXNlSWQsIGUuTiwgZS5pZ25vcmVVbmRlZmluZWRQcm9wZXJ0aWVzKTtcbn1cblxuY2xhc3MgaHUgZXh0ZW5kcyBYYyB7XG4gICAgX3RvRmllbGRUcmFuc2Zvcm0odCkge1xuICAgICAgICByZXR1cm4gbmV3IEtlKHQucGF0aCwgbmV3ICRlKTtcbiAgICB9XG4gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIHJldHVybiB0IGluc3RhbmNlb2YgaHU7XG4gICAgfVxufVxuXG5jbGFzcyBsdSBleHRlbmRzIFhjIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHN1cGVyKHQpLCB0aGlzLlVhID0gZTtcbiAgICB9XG4gICAgX3RvRmllbGRUcmFuc2Zvcm0odCkge1xuICAgICAgICBjb25zdCBlID0gdXUodGhpcywgdCwgXG4gICAgICAgIC8qYXJyYXk9Ki8gITApLCBuID0gdGhpcy5VYS5tYXAoKHQgPT4gZ3UodCwgZSkpKSwgcyA9IG5ldyBPZShuKTtcbiAgICAgICAgcmV0dXJuIG5ldyBLZSh0LnBhdGgsIHMpO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgLy8gVE9ETyhtcnNjaG1pZHQpOiBJbXBsZW1lbnQgaXNFcXVhbHNcbiAgICAgICAgcmV0dXJuIHRoaXMgPT09IHQ7XG4gICAgfVxufVxuXG5jbGFzcyBmdSBleHRlbmRzIFhjIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHN1cGVyKHQpLCB0aGlzLlVhID0gZTtcbiAgICB9XG4gICAgX3RvRmllbGRUcmFuc2Zvcm0odCkge1xuICAgICAgICBjb25zdCBlID0gdXUodGhpcywgdCwgXG4gICAgICAgIC8qYXJyYXk9Ki8gITApLCBuID0gdGhpcy5VYS5tYXAoKHQgPT4gZ3UodCwgZSkpKSwgcyA9IG5ldyBNZShuKTtcbiAgICAgICAgcmV0dXJuIG5ldyBLZSh0LnBhdGgsIHMpO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgLy8gVE9ETyhtcnNjaG1pZHQpOiBJbXBsZW1lbnQgaXNFcXVhbHNcbiAgICAgICAgcmV0dXJuIHRoaXMgPT09IHQ7XG4gICAgfVxufVxuXG5jbGFzcyBkdSBleHRlbmRzIFhjIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHN1cGVyKHQpLCB0aGlzLnFhID0gZTtcbiAgICB9XG4gICAgX3RvRmllbGRUcmFuc2Zvcm0odCkge1xuICAgICAgICBjb25zdCBlID0gbmV3IEJlKHQuTiwgRGUodC5OLCB0aGlzLnFhKSk7XG4gICAgICAgIHJldHVybiBuZXcgS2UodC5wYXRoLCBlKTtcbiAgICB9XG4gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIC8vIFRPRE8obXJzY2htaWR0KTogSW1wbGVtZW50IGlzRXF1YWxzXG4gICAgICAgIHJldHVybiB0aGlzID09PSB0O1xuICAgIH1cbn1cblxuLyoqIFBhcnNlIHVwZGF0ZSBkYXRhIGZyb20gYW4gdXBkYXRlKCkgY2FsbC4gKi8gZnVuY3Rpb24gd3UodCwgZSwgbiwgcykge1xuICAgIGNvbnN0IGkgPSB0LkJhKDEgLyogVXBkYXRlICovICwgZSwgbik7XG4gICAgRXUoXCJEYXRhIG11c3QgYmUgYW4gb2JqZWN0LCBidXQgaXQgd2FzOlwiLCBpLCBzKTtcbiAgICBjb25zdCByID0gW10sIG8gPSBCdC5lbXB0eSgpO1xuICAgIG90KHMsICgodCwgcykgPT4ge1xuICAgICAgICBjb25zdCBhID0gQXUoZSwgdCwgbik7XG4gICAgICAgIC8vIEZvciBDb21wYXQgdHlwZXMsIHdlIGhhdmUgdG8gXCJleHRyYWN0XCIgdGhlIHVuZGVybHlpbmcgdHlwZXMgYmVmb3JlXG4gICAgICAgIC8vIHBlcmZvcm1pbmcgdmFsaWRhdGlvbi5cbiAgICAgICAgICAgICAgICBzID0geShzKTtcbiAgICAgICAgY29uc3QgYyA9IGkuJGEoYSk7XG4gICAgICAgIGlmIChzIGluc3RhbmNlb2YgY3UpIFxuICAgICAgICAvLyBBZGQgaXQgdG8gdGhlIGZpZWxkIG1hc2ssIGJ1dCBkb24ndCBhZGQgYW55dGhpbmcgdG8gdXBkYXRlRGF0YS5cbiAgICAgICAgci5wdXNoKGEpOyBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBndShzLCBjKTtcbiAgICAgICAgICAgIG51bGwgIT0gdCAmJiAoci5wdXNoKGEpLCBvLnNldChhLCB0KSk7XG4gICAgICAgIH1cbiAgICB9KSk7XG4gICAgY29uc3QgYSA9IG5ldyBmdChyKTtcbiAgICByZXR1cm4gbmV3IG51KG8sIGEsIGkuZmllbGRUcmFuc2Zvcm1zKTtcbn1cblxuLyoqIFBhcnNlIHVwZGF0ZSBkYXRhIGZyb20gYSBsaXN0IG9mIGZpZWxkL3ZhbHVlIGFyZ3VtZW50cy4gKi8gZnVuY3Rpb24gX3UodCwgZSwgbiwgcywgaSwgcikge1xuICAgIGNvbnN0IG8gPSB0LkJhKDEgLyogVXBkYXRlICovICwgZSwgbiksIGEgPSBbIFR1KGUsIHMsIG4pIF0sIGMgPSBbIGkgXTtcbiAgICBpZiAoci5sZW5ndGggJSAyICE9IDApIHRocm93IG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgYEZ1bmN0aW9uICR7ZX0oKSBuZWVkcyB0byBiZSBjYWxsZWQgd2l0aCBhbiBldmVuIG51bWJlciBvZiBhcmd1bWVudHMgdGhhdCBhbHRlcm5hdGUgYmV0d2VlbiBmaWVsZCBuYW1lcyBhbmQgdmFsdWVzLmApO1xuICAgIGZvciAobGV0IHQgPSAwOyB0IDwgci5sZW5ndGg7IHQgKz0gMikgYS5wdXNoKFR1KGUsIHJbdF0pKSwgYy5wdXNoKHJbdCArIDFdKTtcbiAgICBjb25zdCB1ID0gW10sIGggPSBCdC5lbXB0eSgpO1xuICAgIC8vIFdlIGl0ZXJhdGUgaW4gcmV2ZXJzZSBvcmRlciB0byBwaWNrIHRoZSBsYXN0IHZhbHVlIGZvciBhIGZpZWxkIGlmIHRoZVxuICAgIC8vIHVzZXIgc3BlY2lmaWVkIHRoZSBmaWVsZCBtdWx0aXBsZSB0aW1lcy5cbiAgICBmb3IgKGxldCB0ID0gYS5sZW5ndGggLSAxOyB0ID49IDA7IC0tdCkgaWYgKCFQdSh1LCBhW3RdKSkge1xuICAgICAgICBjb25zdCBlID0gYVt0XTtcbiAgICAgICAgbGV0IG4gPSBjW3RdO1xuICAgICAgICAvLyBGb3IgQ29tcGF0IHR5cGVzLCB3ZSBoYXZlIHRvIFwiZXh0cmFjdFwiIHRoZSB1bmRlcmx5aW5nIHR5cGVzIGJlZm9yZVxuICAgICAgICAvLyBwZXJmb3JtaW5nIHZhbGlkYXRpb24uXG4gICAgICAgICAgICAgICAgbiA9IHkobik7XG4gICAgICAgIGNvbnN0IHMgPSBvLiRhKGUpO1xuICAgICAgICBpZiAobiBpbnN0YW5jZW9mIGN1KSBcbiAgICAgICAgLy8gQWRkIGl0IHRvIHRoZSBmaWVsZCBtYXNrLCBidXQgZG9uJ3QgYWRkIGFueXRoaW5nIHRvIHVwZGF0ZURhdGEuXG4gICAgICAgIHUucHVzaChlKTsgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gZ3Uobiwgcyk7XG4gICAgICAgICAgICBudWxsICE9IHQgJiYgKHUucHVzaChlKSwgaC5zZXQoZSwgdCkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0IGwgPSBuZXcgZnQodSk7XG4gICAgcmV0dXJuIG5ldyBudShoLCBsLCBvLmZpZWxkVHJhbnNmb3Jtcyk7XG59XG5cbi8qKlxuICogUGFyc2UgYSBcInF1ZXJ5IHZhbHVlXCIgKGUuZy4gdmFsdWUgaW4gYSB3aGVyZSBmaWx0ZXIgb3IgYSB2YWx1ZSBpbiBhIGN1cnNvclxuICogYm91bmQpLlxuICpcbiAqIEBwYXJhbSBhbGxvd0FycmF5cyAtIFdoZXRoZXIgdGhlIHF1ZXJ5IHZhbHVlIGlzIGFuIGFycmF5IHRoYXQgbWF5IGRpcmVjdGx5XG4gKiBjb250YWluIGFkZGl0aW9uYWwgYXJyYXlzIChlLmcuIHRoZSBvcGVyYW5kIG9mIGFuIGBpbmAgcXVlcnkpLlxuICovIGZ1bmN0aW9uIG11KHQsIGUsIG4sIHMgPSAhMSkge1xuICAgIHJldHVybiBndShuLCB0LkJhKHMgPyA0IC8qIEFycmF5QXJndW1lbnQgKi8gOiAzIC8qIEFyZ3VtZW50ICovICwgZSkpO1xufVxuXG4vKipcbiAqIFBhcnNlcyB1c2VyIGRhdGEgdG8gUHJvdG9idWYgVmFsdWVzLlxuICpcbiAqIEBwYXJhbSBpbnB1dCAtIERhdGEgdG8gYmUgcGFyc2VkLlxuICogQHBhcmFtIGNvbnRleHQgLSBBIGNvbnRleHQgb2JqZWN0IHJlcHJlc2VudGluZyB0aGUgY3VycmVudCBwYXRoIGJlaW5nIHBhcnNlZCxcbiAqIHRoZSBzb3VyY2Ugb2YgdGhlIGRhdGEgYmVpbmcgcGFyc2VkLCBldGMuXG4gKiBAcmV0dXJucyBUaGUgcGFyc2VkIHZhbHVlLCBvciBudWxsIGlmIHRoZSB2YWx1ZSB3YXMgYSBGaWVsZFZhbHVlIHNlbnRpbmVsXG4gKiB0aGF0IHNob3VsZCBub3QgYmUgaW5jbHVkZWQgaW4gdGhlIHJlc3VsdGluZyBwYXJzZWQgZGF0YS5cbiAqLyBmdW5jdGlvbiBndSh0LCBlKSB7XG4gICAgaWYgKHB1KFxuICAgIC8vIFVud3JhcCB0aGUgQVBJIHR5cGUgZnJvbSB0aGUgQ29tcGF0IFNESy4gVGhpcyB3aWxsIHJldHVybiB0aGUgQVBJIHR5cGVcbiAgICAvLyBmcm9tIGZpcmVzdG9yZS1leHAuXG4gICAgdCA9IHkodCkpKSByZXR1cm4gRXUoXCJVbnN1cHBvcnRlZCBmaWVsZCB2YWx1ZTpcIiwgZSwgdCksIHl1KHQsIGUpO1xuICAgIGlmICh0IGluc3RhbmNlb2YgWGMpIFxuICAgIC8vIEZpZWxkVmFsdWVzIHVzdWFsbHkgcGFyc2UgaW50byB0cmFuc2Zvcm1zIChleGNlcHQgRmllbGRWYWx1ZS5kZWxldGUoKSlcbiAgICAvLyBpbiB3aGljaCBjYXNlIHdlIGRvIG5vdCB3YW50IHRvIGluY2x1ZGUgdGhpcyBmaWVsZCBpbiBvdXIgcGFyc2VkIGRhdGFcbiAgICAvLyAoYXMgZG9pbmcgc28gd2lsbCBvdmVyd3JpdGUgdGhlIGZpZWxkIGRpcmVjdGx5IHByaW9yIHRvIHRoZSB0cmFuc2Zvcm1cbiAgICAvLyB0cnlpbmcgdG8gdHJhbnNmb3JtIGl0KS4gU28gd2UgZG9uJ3QgYWRkIHRoaXMgbG9jYXRpb24gdG9cbiAgICAvLyBjb250ZXh0LmZpZWxkTWFzayBhbmQgd2UgcmV0dXJuIG51bGwgYXMgb3VyIHBhcnNpbmcgcmVzdWx0LlxuICAgIC8qKlxuICogXCJQYXJzZXNcIiB0aGUgcHJvdmlkZWQgRmllbGRWYWx1ZUltcGwsIGFkZGluZyBhbnkgbmVjZXNzYXJ5IHRyYW5zZm9ybXMgdG9cbiAqIGNvbnRleHQuZmllbGRUcmFuc2Zvcm1zLlxuICovXG4gICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgLy8gU2VudGluZWxzIGFyZSBvbmx5IHN1cHBvcnRlZCB3aXRoIHdyaXRlcywgYW5kIG5vdCB3aXRoaW4gYXJyYXlzLlxuICAgICAgICBpZiAoIXN1KGUuRGEpKSB0aHJvdyBlLkZhKGAke3QuX21ldGhvZE5hbWV9KCkgY2FuIG9ubHkgYmUgdXNlZCB3aXRoIHVwZGF0ZSgpIGFuZCBzZXQoKWApO1xuICAgICAgICBpZiAoIWUucGF0aCkgdGhyb3cgZS5GYShgJHt0Ll9tZXRob2ROYW1lfSgpIGlzIG5vdCBjdXJyZW50bHkgc3VwcG9ydGVkIGluc2lkZSBhcnJheXNgKTtcbiAgICAgICAgY29uc3QgbiA9IHQuX3RvRmllbGRUcmFuc2Zvcm0oZSk7XG4gICAgICAgIG4gJiYgZS5maWVsZFRyYW5zZm9ybXMucHVzaChuKTtcbiAgICB9XG4gICAgLyoqXG4gKiBIZWxwZXIgdG8gcGFyc2UgYSBzY2FsYXIgdmFsdWUgKGkuZS4gbm90IGFuIE9iamVjdCwgQXJyYXksIG9yIEZpZWxkVmFsdWUpXG4gKlxuICogQHJldHVybnMgVGhlIHBhcnNlZCB2YWx1ZVxuICovICh0LCBlKSwgbnVsbDtcbiAgICBpZiAodm9pZCAwID09PSB0ICYmIGUuaWdub3JlVW5kZWZpbmVkUHJvcGVydGllcykgXG4gICAgLy8gSWYgdGhlIGlucHV0IGlzIHVuZGVmaW5lZCBpdCBjYW4gbmV2ZXIgcGFydGljaXBhdGUgaW4gdGhlIGZpZWxkTWFzaywgc29cbiAgICAvLyBkb24ndCBoYW5kbGUgdGhpcyBiZWxvdy4gSWYgYGlnbm9yZVVuZGVmaW5lZFByb3BlcnRpZXNgIGlzIGZhbHNlLFxuICAgIC8vIGBwYXJzZVNjYWxhclZhbHVlYCB3aWxsIHJlamVjdCBhbiB1bmRlZmluZWQgdmFsdWUuXG4gICAgcmV0dXJuIG51bGw7XG4gICAgaWYgKFxuICAgIC8vIElmIGNvbnRleHQucGF0aCBpcyBudWxsIHdlIGFyZSBpbnNpZGUgYW4gYXJyYXkgYW5kIHdlIGRvbid0IHN1cHBvcnRcbiAgICAvLyBmaWVsZCBtYXNrIHBhdGhzIG1vcmUgZ3JhbnVsYXIgdGhhbiB0aGUgdG9wLWxldmVsIGFycmF5LlxuICAgIGUucGF0aCAmJiBlLmZpZWxkTWFzay5wdXNoKGUucGF0aCksIHQgaW5zdGFuY2VvZiBBcnJheSkge1xuICAgICAgICAvLyBUT0RPKGIvMzQ4NzExMzEpOiBJbmNsdWRlIHRoZSBwYXRoIGNvbnRhaW5pbmcgdGhlIGFycmF5IGluIHRoZSBlcnJvclxuICAgICAgICAvLyBtZXNzYWdlLlxuICAgICAgICAvLyBJbiB0aGUgY2FzZSBvZiBJTiBxdWVyaWVzLCB0aGUgcGFyc2VkIGRhdGEgaXMgYW4gYXJyYXkgKHJlcHJlc2VudGluZ1xuICAgICAgICAvLyB0aGUgc2V0IG9mIHZhbHVlcyB0byBiZSBpbmNsdWRlZCBmb3IgdGhlIElOIHF1ZXJ5KSB0aGF0IG1heSBkaXJlY3RseVxuICAgICAgICAvLyBjb250YWluIGFkZGl0aW9uYWwgYXJyYXlzIChlYWNoIHJlcHJlc2VudGluZyBhbiBpbmRpdmlkdWFsIGZpZWxkXG4gICAgICAgIC8vIHZhbHVlKSwgc28gd2UgZGlzYWJsZSB0aGlzIHZhbGlkYXRpb24uXG4gICAgICAgIGlmIChlLnNldHRpbmdzLnhhICYmIDQgLyogQXJyYXlBcmd1bWVudCAqLyAhPT0gZS5EYSkgdGhyb3cgZS5GYShcIk5lc3RlZCBhcnJheXMgYXJlIG5vdCBzdXBwb3J0ZWRcIik7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gW107XG4gICAgICAgICAgICBsZXQgcyA9IDA7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGkgb2YgdCkge1xuICAgICAgICAgICAgICAgIGxldCB0ID0gZ3UoaSwgZS5PYShzKSk7XG4gICAgICAgICAgICAgICAgbnVsbCA9PSB0ICYmIChcbiAgICAgICAgICAgICAgICAvLyBKdXN0IGluY2x1ZGUgbnVsbHMgaW4gdGhlIGFycmF5IGZvciBmaWVsZHMgYmVpbmcgcmVwbGFjZWQgd2l0aCBhXG4gICAgICAgICAgICAgICAgLy8gc2VudGluZWwuXG4gICAgICAgICAgICAgICAgdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgbnVsbFZhbHVlOiBcIk5VTExfVkFMVUVcIlxuICAgICAgICAgICAgICAgIH0pLCBuLnB1c2godCksIHMrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgYXJyYXlWYWx1ZToge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZXM6IG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KHQsIGUpO1xuICAgIH1cbiAgICByZXR1cm4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBpZiAobnVsbCA9PT0gKHQgPSB5KHQpKSkgcmV0dXJuIHtcbiAgICAgICAgICAgIG51bGxWYWx1ZTogXCJOVUxMX1ZBTFVFXCJcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKFwibnVtYmVyXCIgPT0gdHlwZW9mIHQpIHJldHVybiBEZShlLk4sIHQpO1xuICAgICAgICBpZiAoXCJib29sZWFuXCIgPT0gdHlwZW9mIHQpIHJldHVybiB7XG4gICAgICAgICAgICBib29sZWFuVmFsdWU6IHRcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKFwic3RyaW5nXCIgPT0gdHlwZW9mIHQpIHJldHVybiB7XG4gICAgICAgICAgICBzdHJpbmdWYWx1ZTogdFxuICAgICAgICB9O1xuICAgICAgICBpZiAodCBpbnN0YW5jZW9mIERhdGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBzdC5mcm9tRGF0ZSh0KTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdGltZXN0YW1wVmFsdWU6IEJuKGUuTiwgbilcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBzdCkge1xuICAgICAgICAgICAgLy8gRmlyZXN0b3JlIGJhY2tlbmQgdHJ1bmNhdGVzIHByZWNpc2lvbiBkb3duIHRvIG1pY3Jvc2Vjb25kcy4gVG8gZW5zdXJlXG4gICAgICAgICAgICAvLyBvZmZsaW5lIG1vZGUgd29ya3MgdGhlIHNhbWUgd2l0aCByZWdhcmRzIHRvIHRydW5jYXRpb24sIHBlcmZvcm0gdGhlXG4gICAgICAgICAgICAvLyB0cnVuY2F0aW9uIGltbWVkaWF0ZWx5IHdpdGhvdXQgd2FpdGluZyBmb3IgdGhlIGJhY2tlbmQgdG8gZG8gdGhhdC5cbiAgICAgICAgICAgIGNvbnN0IG4gPSBuZXcgc3QodC5zZWNvbmRzLCAxZTMgKiBNYXRoLmZsb29yKHQubmFub3NlY29uZHMgLyAxZTMpKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdGltZXN0YW1wVmFsdWU6IEJuKGUuTiwgbilcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBaYykgcmV0dXJuIHtcbiAgICAgICAgICAgIGdlb1BvaW50VmFsdWU6IHtcbiAgICAgICAgICAgICAgICBsYXRpdHVkZTogdC5sYXRpdHVkZSxcbiAgICAgICAgICAgICAgICBsb25naXR1ZGU6IHQubG9uZ2l0dWRlXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGlmICh0IGluc3RhbmNlb2YgWWMpIHJldHVybiB7XG4gICAgICAgICAgICBieXRlc1ZhbHVlOiBVbihlLk4sIHQuX2J5dGVTdHJpbmcpXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0IGluc3RhbmNlb2YgVGMpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBlLmRhdGFiYXNlSWQsIHMgPSB0LmZpcmVzdG9yZS5fZGF0YWJhc2VJZDtcbiAgICAgICAgICAgIGlmICghcy5pc0VxdWFsKG4pKSB0aHJvdyBlLkZhKGBEb2N1bWVudCByZWZlcmVuY2UgaXMgZm9yIGRhdGFiYXNlICR7cy5wcm9qZWN0SWR9LyR7cy5kYXRhYmFzZX0gYnV0IHNob3VsZCBiZSBmb3IgZGF0YWJhc2UgJHtuLnByb2plY3RJZH0vJHtuLmRhdGFiYXNlfWApO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICByZWZlcmVuY2VWYWx1ZTogam4odC5maXJlc3RvcmUuX2RhdGFiYXNlSWQgfHwgZS5kYXRhYmFzZUlkLCB0Ll9rZXkucGF0aClcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgZS5GYShgVW5zdXBwb3J0ZWQgZmllbGQgdmFsdWU6ICR7X2ModCl9YCk7XG4gICAgfVxuICAgIC8qKlxuICogQ2hlY2tzIHdoZXRoZXIgYW4gb2JqZWN0IGxvb2tzIGxpa2UgYSBKU09OIG9iamVjdCB0aGF0IHNob3VsZCBiZSBjb252ZXJ0ZWRcbiAqIGludG8gYSBzdHJ1Y3QuIE5vcm1hbCBjbGFzcy9wcm90b3R5cGUgaW5zdGFuY2VzIGFyZSBjb25zaWRlcmVkIHRvIGxvb2sgbGlrZVxuICogSlNPTiBvYmplY3RzIHNpbmNlIHRoZXkgc2hvdWxkIGJlIGNvbnZlcnRlZCB0byBhIHN0cnVjdCB2YWx1ZS4gQXJyYXlzLCBEYXRlcyxcbiAqIEdlb1BvaW50cywgZXRjLiBhcmUgbm90IGNvbnNpZGVyZWQgdG8gbG9vayBsaWtlIEpTT04gb2JqZWN0cyBzaW5jZSB0aGV5IG1hcFxuICogdG8gc3BlY2lmaWMgRmllbGRWYWx1ZSB0eXBlcyBvdGhlciB0aGFuIE9iamVjdFZhbHVlLlxuICovICh0LCBlKTtcbn1cblxuZnVuY3Rpb24geXUodCwgZSkge1xuICAgIGNvbnN0IG4gPSB7fTtcbiAgICByZXR1cm4gYXQodCkgPyBcbiAgICAvLyBJZiB3ZSBlbmNvdW50ZXIgYW4gZW1wdHkgb2JqZWN0LCB3ZSBleHBsaWNpdGx5IGFkZCBpdCB0byB0aGUgdXBkYXRlXG4gICAgLy8gbWFzayB0byBlbnN1cmUgdGhhdCB0aGUgc2VydmVyIGNyZWF0ZXMgYSBtYXAgZW50cnkuXG4gICAgZS5wYXRoICYmIGUucGF0aC5sZW5ndGggPiAwICYmIGUuZmllbGRNYXNrLnB1c2goZS5wYXRoKSA6IG90KHQsICgodCwgcykgPT4ge1xuICAgICAgICBjb25zdCBpID0gZ3UocywgZS5OYSh0KSk7XG4gICAgICAgIG51bGwgIT0gaSAmJiAoblt0XSA9IGkpO1xuICAgIH0pKSwge1xuICAgICAgICBtYXBWYWx1ZToge1xuICAgICAgICAgICAgZmllbGRzOiBuXG4gICAgICAgIH1cbiAgICB9O1xufVxuXG5mdW5jdGlvbiBwdSh0KSB7XG4gICAgcmV0dXJuICEoXCJvYmplY3RcIiAhPSB0eXBlb2YgdCB8fCBudWxsID09PSB0IHx8IHQgaW5zdGFuY2VvZiBBcnJheSB8fCB0IGluc3RhbmNlb2YgRGF0ZSB8fCB0IGluc3RhbmNlb2Ygc3QgfHwgdCBpbnN0YW5jZW9mIFpjIHx8IHQgaW5zdGFuY2VvZiBZYyB8fCB0IGluc3RhbmNlb2YgVGMgfHwgdCBpbnN0YW5jZW9mIFhjKTtcbn1cblxuZnVuY3Rpb24gRXUodCwgZSwgbikge1xuICAgIGlmICghcHUobikgfHwgIWZ1bmN0aW9uKHQpIHtcbiAgICAgICAgcmV0dXJuIFwib2JqZWN0XCIgPT0gdHlwZW9mIHQgJiYgbnVsbCAhPT0gdCAmJiAoT2JqZWN0LmdldFByb3RvdHlwZU9mKHQpID09PSBPYmplY3QucHJvdG90eXBlIHx8IG51bGwgPT09IE9iamVjdC5nZXRQcm90b3R5cGVPZih0KSk7XG4gICAgfShuKSkge1xuICAgICAgICBjb25zdCBzID0gX2Mobik7XG4gICAgICAgIHRocm93IFwiYW4gb2JqZWN0XCIgPT09IHMgPyBlLkZhKHQgKyBcIiBhIGN1c3RvbSBvYmplY3RcIikgOiBlLkZhKHQgKyBcIiBcIiArIHMpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBIZWxwZXIgdGhhdCBjYWxscyBmcm9tRG90U2VwYXJhdGVkU3RyaW5nKCkgYnV0IHdyYXBzIGFueSBlcnJvciB0aHJvd24uXG4gKi8gZnVuY3Rpb24gVHUodCwgZSwgbikge1xuICAgIGlmICgoXG4gICAgLy8gSWYgcmVxdWlyZWQsIHJlcGxhY2UgdGhlIEZpZWxkUGF0aCBDb21wYXQgY2xhc3Mgd2l0aCB3aXRoIHRoZSBmaXJlc3RvcmUtZXhwXG4gICAgLy8gRmllbGRQYXRoLlxuICAgIGUgPSB5KGUpKSBpbnN0YW5jZW9mIEhjKSByZXR1cm4gZS5faW50ZXJuYWxQYXRoO1xuICAgIGlmIChcInN0cmluZ1wiID09IHR5cGVvZiBlKSByZXR1cm4gQXUodCwgZSk7XG4gICAgdGhyb3cgUnUoXCJGaWVsZCBwYXRoIGFyZ3VtZW50cyBtdXN0IGJlIG9mIHR5cGUgc3RyaW5nIG9yIEZpZWxkUGF0aC5cIiwgdCwgXG4gICAgLyogaGFzQ29udmVydGVyPSAqLyAhMSwgXG4gICAgLyogcGF0aD0gKi8gdm9pZCAwLCBuKTtcbn1cblxuLyoqXG4gKiBNYXRjaGVzIGFueSBjaGFyYWN0ZXJzIGluIGEgZmllbGQgcGF0aCBzdHJpbmcgdGhhdCBhcmUgcmVzZXJ2ZWQuXG4gKi8gY29uc3QgSXUgPSBuZXcgUmVnRXhwKFwiW35cXFxcKi9cXFxcW1xcXFxdXVwiKTtcblxuLyoqXG4gKiBXcmFwcyBmcm9tRG90U2VwYXJhdGVkU3RyaW5nIHdpdGggYW4gZXJyb3IgbWVzc2FnZSBhYm91dCB0aGUgbWV0aG9kIHRoYXRcbiAqIHdhcyB0aHJvd24uXG4gKiBAcGFyYW0gbWV0aG9kTmFtZSAtIFRoZSBwdWJsaWNseSB2aXNpYmxlIG1ldGhvZCBuYW1lXG4gKiBAcGFyYW0gcGF0aCAtIFRoZSBkb3Qtc2VwYXJhdGVkIHN0cmluZyBmb3JtIG9mIGEgZmllbGQgcGF0aCB3aGljaCB3aWxsIGJlXG4gKiBzcGxpdCBvbiBkb3RzLlxuICogQHBhcmFtIHRhcmdldERvYyAtIFRoZSBkb2N1bWVudCBhZ2FpbnN0IHdoaWNoIHRoZSBmaWVsZCBwYXRoIHdpbGwgYmVcbiAqIGV2YWx1YXRlZC5cbiAqLyBmdW5jdGlvbiBBdSh0LCBlLCBuKSB7XG4gICAgaWYgKGUuc2VhcmNoKEl1KSA+PSAwKSB0aHJvdyBSdShgSW52YWxpZCBmaWVsZCBwYXRoICgke2V9KS4gUGF0aHMgbXVzdCBub3QgY29udGFpbiAnficsICcqJywgJy8nLCAnWycsIG9yICddJ2AsIHQsIFxuICAgIC8qIGhhc0NvbnZlcnRlcj0gKi8gITEsIFxuICAgIC8qIHBhdGg9ICovIHZvaWQgMCwgbik7XG4gICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIG5ldyBIYyguLi5lLnNwbGl0KFwiLlwiKSkuX2ludGVybmFsUGF0aDtcbiAgICB9IGNhdGNoIChzKSB7XG4gICAgICAgIHRocm93IFJ1KGBJbnZhbGlkIGZpZWxkIHBhdGggKCR7ZX0pLiBQYXRocyBtdXN0IG5vdCBiZSBlbXB0eSwgYmVnaW4gd2l0aCAnLicsIGVuZCB3aXRoICcuJywgb3IgY29udGFpbiAnLi4nYCwgdCwgXG4gICAgICAgIC8qIGhhc0NvbnZlcnRlcj0gKi8gITEsIFxuICAgICAgICAvKiBwYXRoPSAqLyB2b2lkIDAsIG4pO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gUnUodCwgZSwgbiwgcywgaSkge1xuICAgIGNvbnN0IHIgPSBzICYmICFzLmlzRW1wdHkoKSwgbyA9IHZvaWQgMCAhPT0gaTtcbiAgICBsZXQgYSA9IGBGdW5jdGlvbiAke2V9KCkgY2FsbGVkIHdpdGggaW52YWxpZCBkYXRhYDtcbiAgICBuICYmIChhICs9IFwiICh2aWEgYHRvRmlyZXN0b3JlKClgKVwiKSwgYSArPSBcIi4gXCI7XG4gICAgbGV0IGMgPSBcIlwiO1xuICAgIHJldHVybiAociB8fCBvKSAmJiAoYyArPSBcIiAoZm91bmRcIiwgciAmJiAoYyArPSBgIGluIGZpZWxkICR7c31gKSwgbyAmJiAoYyArPSBgIGluIGRvY3VtZW50ICR7aX1gKSwgXG4gICAgYyArPSBcIilcIiksIG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgYSArIHQgKyBjKTtcbn1cblxuLyoqIENoZWNrcyBgaGF5c3RhY2tgIGlmIEZpZWxkUGF0aCBgbmVlZGxlYCBpcyBwcmVzZW50LiBSdW5zIGluIE8obikuICovIGZ1bmN0aW9uIFB1KHQsIGUpIHtcbiAgICByZXR1cm4gdC5zb21lKCh0ID0+IHQuaXNFcXVhbChlKSkpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBIGBEb2N1bWVudFNuYXBzaG90YCBjb250YWlucyBkYXRhIHJlYWQgZnJvbSBhIGRvY3VtZW50IGluIHlvdXIgRmlyZXN0b3JlXG4gKiBkYXRhYmFzZS4gVGhlIGRhdGEgY2FuIGJlIGV4dHJhY3RlZCB3aXRoIGAuZGF0YSgpYCBvciBgLmdldCg8ZmllbGQ+KWAgdG9cbiAqIGdldCBhIHNwZWNpZmljIGZpZWxkLlxuICpcbiAqIEZvciBhIGBEb2N1bWVudFNuYXBzaG90YCB0aGF0IHBvaW50cyB0byBhIG5vbi1leGlzdGluZyBkb2N1bWVudCwgYW55IGRhdGFcbiAqIGFjY2VzcyB3aWxsIHJldHVybiAndW5kZWZpbmVkJy4gWW91IGNhbiB1c2UgdGhlIGBleGlzdHMoKWAgbWV0aG9kIHRvXG4gKiBleHBsaWNpdGx5IHZlcmlmeSBhIGRvY3VtZW50J3MgZXhpc3RlbmNlLlxuICovIGNsYXNzIGJ1IHtcbiAgICAvLyBOb3RlOiBUaGlzIGNsYXNzIGlzIHN0cmlwcGVkIGRvd24gdmVyc2lvbiBvZiB0aGUgRG9jdW1lbnRTbmFwc2hvdCBpblxuICAgIC8vIHRoZSBsZWdhY3kgU0RLLiBUaGUgY2hhbmdlcyBhcmU6XG4gICAgLy8gLSBObyBzdXBwb3J0IGZvciBTbmFwc2hvdE1ldGFkYXRhLlxuICAgIC8vIC0gTm8gc3VwcG9ydCBmb3IgU25hcHNob3RPcHRpb25zLlxuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yIHByb3RlY3RlZCAqL1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIHMsIGkpIHtcbiAgICAgICAgdGhpcy5fZmlyZXN0b3JlID0gdCwgdGhpcy5fdXNlckRhdGFXcml0ZXIgPSBlLCB0aGlzLl9rZXkgPSBuLCB0aGlzLl9kb2N1bWVudCA9IHMsIFxuICAgICAgICB0aGlzLl9jb252ZXJ0ZXIgPSBpO1xuICAgIH1cbiAgICAvKiogUHJvcGVydHkgb2YgdGhlIGBEb2N1bWVudFNuYXBzaG90YCB0aGF0IHByb3ZpZGVzIHRoZSBkb2N1bWVudCdzIElELiAqLyAgICBnZXQgaWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9rZXkucGF0aC5sYXN0U2VnbWVudCgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgYERvY3VtZW50UmVmZXJlbmNlYCBmb3IgdGhlIGRvY3VtZW50IGluY2x1ZGVkIGluIHRoZSBgRG9jdW1lbnRTbmFwc2hvdGAuXG4gICAgICovICAgIGdldCByZWYoKSB7XG4gICAgICAgIHJldHVybiBuZXcgVGModGhpcy5fZmlyZXN0b3JlLCB0aGlzLl9jb252ZXJ0ZXIsIHRoaXMuX2tleSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNpZ25hbHMgd2hldGhlciBvciBub3QgdGhlIGRvY3VtZW50IGF0IHRoZSBzbmFwc2hvdCdzIGxvY2F0aW9uIGV4aXN0cy5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHRydWUgaWYgdGhlIGRvY3VtZW50IGV4aXN0cy5cbiAgICAgKi8gICAgZXhpc3RzKCkge1xuICAgICAgICByZXR1cm4gbnVsbCAhPT0gdGhpcy5fZG9jdW1lbnQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHJpZXZlcyBhbGwgZmllbGRzIGluIHRoZSBkb2N1bWVudCBhcyBhbiBgT2JqZWN0YC4gUmV0dXJucyBgdW5kZWZpbmVkYCBpZlxuICAgICAqIHRoZSBkb2N1bWVudCBkb2Vzbid0IGV4aXN0LlxuICAgICAqXG4gICAgICogQHJldHVybnMgQW4gYE9iamVjdGAgY29udGFpbmluZyBhbGwgZmllbGRzIGluIHRoZSBkb2N1bWVudCBvciBgdW5kZWZpbmVkYFxuICAgICAqIGlmIHRoZSBkb2N1bWVudCBkb2Vzbid0IGV4aXN0LlxuICAgICAqLyAgICBkYXRhKCkge1xuICAgICAgICBpZiAodGhpcy5fZG9jdW1lbnQpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9jb252ZXJ0ZXIpIHtcbiAgICAgICAgICAgICAgICAvLyBXZSBvbmx5IHdhbnQgdG8gdXNlIHRoZSBjb252ZXJ0ZXIgYW5kIGNyZWF0ZSBhIG5ldyBEb2N1bWVudFNuYXBzaG90XG4gICAgICAgICAgICAgICAgLy8gaWYgYSBjb252ZXJ0ZXIgaGFzIGJlZW4gcHJvdmlkZWQuXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IG5ldyB2dSh0aGlzLl9maXJlc3RvcmUsIHRoaXMuX3VzZXJEYXRhV3JpdGVyLCB0aGlzLl9rZXksIHRoaXMuX2RvY3VtZW50LCBcbiAgICAgICAgICAgICAgICAvKiBjb252ZXJ0ZXI9ICovIG51bGwpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jb252ZXJ0ZXIuZnJvbUZpcmVzdG9yZSh0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl91c2VyRGF0YVdyaXRlci5jb252ZXJ0VmFsdWUodGhpcy5fZG9jdW1lbnQuZGF0YS52YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0cmlldmVzIHRoZSBmaWVsZCBzcGVjaWZpZWQgYnkgYGZpZWxkUGF0aGAuIFJldHVybnMgYHVuZGVmaW5lZGAgaWYgdGhlXG4gICAgICogZG9jdW1lbnQgb3IgZmllbGQgZG9lc24ndCBleGlzdC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBmaWVsZFBhdGggLSBUaGUgcGF0aCAoZm9yIGV4YW1wbGUgJ2Zvbycgb3IgJ2Zvby5iYXInKSB0byBhIHNwZWNpZmljXG4gICAgICogZmllbGQuXG4gICAgICogQHJldHVybnMgVGhlIGRhdGEgYXQgdGhlIHNwZWNpZmllZCBmaWVsZCBsb2NhdGlvbiBvciB1bmRlZmluZWQgaWYgbm8gc3VjaFxuICAgICAqIGZpZWxkIGV4aXN0cyBpbiB0aGUgZG9jdW1lbnQuXG4gICAgICovXG4gICAgLy8gV2UgYXJlIHVzaW5nIGBhbnlgIGhlcmUgdG8gYXZvaWQgYW4gZXhwbGljaXQgY2FzdCBieSBvdXIgdXNlcnMuXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICBnZXQodCkge1xuICAgICAgICBpZiAodGhpcy5fZG9jdW1lbnQpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLl9kb2N1bWVudC5kYXRhLmZpZWxkKFZ1KFwiRG9jdW1lbnRTbmFwc2hvdC5nZXRcIiwgdCkpO1xuICAgICAgICAgICAgaWYgKG51bGwgIT09IGUpIHJldHVybiB0aGlzLl91c2VyRGF0YVdyaXRlci5jb252ZXJ0VmFsdWUoZSk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbi8qKlxuICogQSBgUXVlcnlEb2N1bWVudFNuYXBzaG90YCBjb250YWlucyBkYXRhIHJlYWQgZnJvbSBhIGRvY3VtZW50IGluIHlvdXJcbiAqIEZpcmVzdG9yZSBkYXRhYmFzZSBhcyBwYXJ0IG9mIGEgcXVlcnkuIFRoZSBkb2N1bWVudCBpcyBndWFyYW50ZWVkIHRvIGV4aXN0XG4gKiBhbmQgaXRzIGRhdGEgY2FuIGJlIGV4dHJhY3RlZCB3aXRoIGAuZGF0YSgpYCBvciBgLmdldCg8ZmllbGQ+KWAgdG8gZ2V0IGFcbiAqIHNwZWNpZmljIGZpZWxkLlxuICpcbiAqIEEgYFF1ZXJ5RG9jdW1lbnRTbmFwc2hvdGAgb2ZmZXJzIHRoZSBzYW1lIEFQSSBzdXJmYWNlIGFzIGFcbiAqIGBEb2N1bWVudFNuYXBzaG90YC4gU2luY2UgcXVlcnkgcmVzdWx0cyBjb250YWluIG9ubHkgZXhpc3RpbmcgZG9jdW1lbnRzLCB0aGVcbiAqIGBleGlzdHNgIHByb3BlcnR5IHdpbGwgYWx3YXlzIGJlIHRydWUgYW5kIGBkYXRhKClgIHdpbGwgbmV2ZXIgcmV0dXJuXG4gKiAndW5kZWZpbmVkJy5cbiAqLyBjbGFzcyB2dSBleHRlbmRzIGJ1IHtcbiAgICAvKipcbiAgICAgKiBSZXRyaWV2ZXMgYWxsIGZpZWxkcyBpbiB0aGUgZG9jdW1lbnQgYXMgYW4gYE9iamVjdGAuXG4gICAgICpcbiAgICAgKiBAb3ZlcnJpZGVcbiAgICAgKiBAcmV0dXJucyBBbiBgT2JqZWN0YCBjb250YWluaW5nIGFsbCBmaWVsZHMgaW4gdGhlIGRvY3VtZW50LlxuICAgICAqL1xuICAgIGRhdGEoKSB7XG4gICAgICAgIHJldHVybiBzdXBlci5kYXRhKCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEhlbHBlciB0aGF0IGNhbGxzIGBmcm9tRG90U2VwYXJhdGVkU3RyaW5nKClgIGJ1dCB3cmFwcyBhbnkgZXJyb3IgdGhyb3duLlxuICovIGZ1bmN0aW9uIFZ1KHQsIGUpIHtcbiAgICByZXR1cm4gXCJzdHJpbmdcIiA9PSB0eXBlb2YgZSA/IEF1KHQsIGUpIDogZSBpbnN0YW5jZW9mIEhjID8gZS5faW50ZXJuYWxQYXRoIDogZS5fZGVsZWdhdGUuX2ludGVybmFsUGF0aDtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogTWV0YWRhdGEgYWJvdXQgYSBzbmFwc2hvdCwgZGVzY3JpYmluZyB0aGUgc3RhdGUgb2YgdGhlIHNuYXBzaG90LlxuICovIGNsYXNzIFN1IHtcbiAgICAvKiogQGhpZGVjb25zdHJ1Y3RvciAqL1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5oYXNQZW5kaW5nV3JpdGVzID0gdCwgdGhpcy5mcm9tQ2FjaGUgPSBlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhpcyBgU25hcHNob3RNZXRhZGF0YWAgaXMgZXF1YWwgdG8gdGhlIHByb3ZpZGVkIG9uZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBvdGhlciAtIFRoZSBgU25hcHNob3RNZXRhZGF0YWAgdG8gY29tcGFyZSBhZ2FpbnN0LlxuICAgICAqIEByZXR1cm5zIHRydWUgaWYgdGhpcyBgU25hcHNob3RNZXRhZGF0YWAgaXMgZXF1YWwgdG8gdGhlIHByb3ZpZGVkIG9uZS5cbiAgICAgKi8gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmhhc1BlbmRpbmdXcml0ZXMgPT09IHQuaGFzUGVuZGluZ1dyaXRlcyAmJiB0aGlzLmZyb21DYWNoZSA9PT0gdC5mcm9tQ2FjaGU7XG4gICAgfVxufVxuXG4vKipcbiAqIEEgYERvY3VtZW50U25hcHNob3RgIGNvbnRhaW5zIGRhdGEgcmVhZCBmcm9tIGEgZG9jdW1lbnQgaW4geW91ciBGaXJlc3RvcmVcbiAqIGRhdGFiYXNlLiBUaGUgZGF0YSBjYW4gYmUgZXh0cmFjdGVkIHdpdGggYC5kYXRhKClgIG9yIGAuZ2V0KDxmaWVsZD4pYCB0b1xuICogZ2V0IGEgc3BlY2lmaWMgZmllbGQuXG4gKlxuICogRm9yIGEgYERvY3VtZW50U25hcHNob3RgIHRoYXQgcG9pbnRzIHRvIGEgbm9uLWV4aXN0aW5nIGRvY3VtZW50LCBhbnkgZGF0YVxuICogYWNjZXNzIHdpbGwgcmV0dXJuICd1bmRlZmluZWQnLiBZb3UgY2FuIHVzZSB0aGUgYGV4aXN0cygpYCBtZXRob2QgdG9cbiAqIGV4cGxpY2l0bHkgdmVyaWZ5IGEgZG9jdW1lbnQncyBleGlzdGVuY2UuXG4gKi8gY2xhc3MgRHUgZXh0ZW5kcyBidSB7XG4gICAgLyoqIEBoaWRlY29uc3RydWN0b3IgcHJvdGVjdGVkICovXG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcywgaSwgcikge1xuICAgICAgICBzdXBlcih0LCBlLCBuLCBzLCByKSwgdGhpcy5fZmlyZXN0b3JlID0gdCwgdGhpcy5fZmlyZXN0b3JlSW1wbCA9IHQsIHRoaXMubWV0YWRhdGEgPSBpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQcm9wZXJ0eSBvZiB0aGUgYERvY3VtZW50U25hcHNob3RgIHRoYXQgc2lnbmFscyB3aGV0aGVyIG9yIG5vdCB0aGUgZGF0YVxuICAgICAqIGV4aXN0cy4gVHJ1ZSBpZiB0aGUgZG9jdW1lbnQgZXhpc3RzLlxuICAgICAqLyAgICBleGlzdHMoKSB7XG4gICAgICAgIHJldHVybiBzdXBlci5leGlzdHMoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0cmlldmVzIGFsbCBmaWVsZHMgaW4gdGhlIGRvY3VtZW50IGFzIGFuIGBPYmplY3RgLiBSZXR1cm5zIGB1bmRlZmluZWRgIGlmXG4gICAgICogdGhlIGRvY3VtZW50IGRvZXNuJ3QgZXhpc3QuXG4gICAgICpcbiAgICAgKiBCeSBkZWZhdWx0LCBgRmllbGRWYWx1ZS5zZXJ2ZXJUaW1lc3RhbXAoKWAgdmFsdWVzIHRoYXQgaGF2ZSBub3QgeWV0IGJlZW5cbiAgICAgKiBzZXQgdG8gdGhlaXIgZmluYWwgdmFsdWUgd2lsbCBiZSByZXR1cm5lZCBhcyBgbnVsbGAuIFlvdSBjYW4gb3ZlcnJpZGVcbiAgICAgKiB0aGlzIGJ5IHBhc3NpbmcgYW4gb3B0aW9ucyBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gb3B0aW9ucyAtIEFuIG9wdGlvbnMgb2JqZWN0IHRvIGNvbmZpZ3VyZSBob3cgZGF0YSBpcyByZXRyaWV2ZWQgZnJvbVxuICAgICAqIHRoZSBzbmFwc2hvdCAoZm9yIGV4YW1wbGUgdGhlIGRlc2lyZWQgYmVoYXZpb3IgZm9yIHNlcnZlciB0aW1lc3RhbXBzIHRoYXRcbiAgICAgKiBoYXZlIG5vdCB5ZXQgYmVlbiBzZXQgdG8gdGhlaXIgZmluYWwgdmFsdWUpLlxuICAgICAqIEByZXR1cm5zIEFuIGBPYmplY3RgIGNvbnRhaW5pbmcgYWxsIGZpZWxkcyBpbiB0aGUgZG9jdW1lbnQgb3IgYHVuZGVmaW5lZGAgaWZcbiAgICAgKiB0aGUgZG9jdW1lbnQgZG9lc24ndCBleGlzdC5cbiAgICAgKi8gICAgZGF0YSh0ID0ge30pIHtcbiAgICAgICAgaWYgKHRoaXMuX2RvY3VtZW50KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fY29udmVydGVyKSB7XG4gICAgICAgICAgICAgICAgLy8gV2Ugb25seSB3YW50IHRvIHVzZSB0aGUgY29udmVydGVyIGFuZCBjcmVhdGUgYSBuZXcgRG9jdW1lbnRTbmFwc2hvdFxuICAgICAgICAgICAgICAgIC8vIGlmIGEgY29udmVydGVyIGhhcyBiZWVuIHByb3ZpZGVkLlxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBuZXcgQ3UodGhpcy5fZmlyZXN0b3JlLCB0aGlzLl91c2VyRGF0YVdyaXRlciwgdGhpcy5fa2V5LCB0aGlzLl9kb2N1bWVudCwgdGhpcy5tZXRhZGF0YSwgXG4gICAgICAgICAgICAgICAgLyogY29udmVydGVyPSAqLyBudWxsKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY29udmVydGVyLmZyb21GaXJlc3RvcmUoZSwgdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdXNlckRhdGFXcml0ZXIuY29udmVydFZhbHVlKHRoaXMuX2RvY3VtZW50LmRhdGEudmFsdWUsIHQuc2VydmVyVGltZXN0YW1wcyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0cmlldmVzIHRoZSBmaWVsZCBzcGVjaWZpZWQgYnkgYGZpZWxkUGF0aGAuIFJldHVybnMgYHVuZGVmaW5lZGAgaWYgdGhlXG4gICAgICogZG9jdW1lbnQgb3IgZmllbGQgZG9lc24ndCBleGlzdC5cbiAgICAgKlxuICAgICAqIEJ5IGRlZmF1bHQsIGEgYEZpZWxkVmFsdWUuc2VydmVyVGltZXN0YW1wKClgIHRoYXQgaGFzIG5vdCB5ZXQgYmVlbiBzZXQgdG9cbiAgICAgKiBpdHMgZmluYWwgdmFsdWUgd2lsbCBiZSByZXR1cm5lZCBhcyBgbnVsbGAuIFlvdSBjYW4gb3ZlcnJpZGUgdGhpcyBieVxuICAgICAqIHBhc3NpbmcgYW4gb3B0aW9ucyBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZmllbGRQYXRoIC0gVGhlIHBhdGggKGZvciBleGFtcGxlICdmb28nIG9yICdmb28uYmFyJykgdG8gYSBzcGVjaWZpY1xuICAgICAqIGZpZWxkLlxuICAgICAqIEBwYXJhbSBvcHRpb25zIC0gQW4gb3B0aW9ucyBvYmplY3QgdG8gY29uZmlndXJlIGhvdyB0aGUgZmllbGQgaXMgcmV0cmlldmVkXG4gICAgICogZnJvbSB0aGUgc25hcHNob3QgKGZvciBleGFtcGxlIHRoZSBkZXNpcmVkIGJlaGF2aW9yIGZvciBzZXJ2ZXIgdGltZXN0YW1wc1xuICAgICAqIHRoYXQgaGF2ZSBub3QgeWV0IGJlZW4gc2V0IHRvIHRoZWlyIGZpbmFsIHZhbHVlKS5cbiAgICAgKiBAcmV0dXJucyBUaGUgZGF0YSBhdCB0aGUgc3BlY2lmaWVkIGZpZWxkIGxvY2F0aW9uIG9yIHVuZGVmaW5lZCBpZiBubyBzdWNoXG4gICAgICogZmllbGQgZXhpc3RzIGluIHRoZSBkb2N1bWVudC5cbiAgICAgKi9cbiAgICAvLyBXZSBhcmUgdXNpbmcgYGFueWAgaGVyZSB0byBhdm9pZCBhbiBleHBsaWNpdCBjYXN0IGJ5IG91ciB1c2Vycy5cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgIGdldCh0LCBlID0ge30pIHtcbiAgICAgICAgaWYgKHRoaXMuX2RvY3VtZW50KSB7XG4gICAgICAgICAgICBjb25zdCBuID0gdGhpcy5fZG9jdW1lbnQuZGF0YS5maWVsZChWdShcIkRvY3VtZW50U25hcHNob3QuZ2V0XCIsIHQpKTtcbiAgICAgICAgICAgIGlmIChudWxsICE9PSBuKSByZXR1cm4gdGhpcy5fdXNlckRhdGFXcml0ZXIuY29udmVydFZhbHVlKG4sIGUuc2VydmVyVGltZXN0YW1wcyk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbi8qKlxuICogQSBgUXVlcnlEb2N1bWVudFNuYXBzaG90YCBjb250YWlucyBkYXRhIHJlYWQgZnJvbSBhIGRvY3VtZW50IGluIHlvdXJcbiAqIEZpcmVzdG9yZSBkYXRhYmFzZSBhcyBwYXJ0IG9mIGEgcXVlcnkuIFRoZSBkb2N1bWVudCBpcyBndWFyYW50ZWVkIHRvIGV4aXN0XG4gKiBhbmQgaXRzIGRhdGEgY2FuIGJlIGV4dHJhY3RlZCB3aXRoIGAuZGF0YSgpYCBvciBgLmdldCg8ZmllbGQ+KWAgdG8gZ2V0IGFcbiAqIHNwZWNpZmljIGZpZWxkLlxuICpcbiAqIEEgYFF1ZXJ5RG9jdW1lbnRTbmFwc2hvdGAgb2ZmZXJzIHRoZSBzYW1lIEFQSSBzdXJmYWNlIGFzIGFcbiAqIGBEb2N1bWVudFNuYXBzaG90YC4gU2luY2UgcXVlcnkgcmVzdWx0cyBjb250YWluIG9ubHkgZXhpc3RpbmcgZG9jdW1lbnRzLCB0aGVcbiAqIGBleGlzdHNgIHByb3BlcnR5IHdpbGwgYWx3YXlzIGJlIHRydWUgYW5kIGBkYXRhKClgIHdpbGwgbmV2ZXIgcmV0dXJuXG4gKiAndW5kZWZpbmVkJy5cbiAqLyBjbGFzcyBDdSBleHRlbmRzIER1IHtcbiAgICAvKipcbiAgICAgKiBSZXRyaWV2ZXMgYWxsIGZpZWxkcyBpbiB0aGUgZG9jdW1lbnQgYXMgYW4gYE9iamVjdGAuXG4gICAgICpcbiAgICAgKiBCeSBkZWZhdWx0LCBgRmllbGRWYWx1ZS5zZXJ2ZXJUaW1lc3RhbXAoKWAgdmFsdWVzIHRoYXQgaGF2ZSBub3QgeWV0IGJlZW5cbiAgICAgKiBzZXQgdG8gdGhlaXIgZmluYWwgdmFsdWUgd2lsbCBiZSByZXR1cm5lZCBhcyBgbnVsbGAuIFlvdSBjYW4gb3ZlcnJpZGVcbiAgICAgKiB0aGlzIGJ5IHBhc3NpbmcgYW4gb3B0aW9ucyBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAb3ZlcnJpZGVcbiAgICAgKiBAcGFyYW0gb3B0aW9ucyAtIEFuIG9wdGlvbnMgb2JqZWN0IHRvIGNvbmZpZ3VyZSBob3cgZGF0YSBpcyByZXRyaWV2ZWQgZnJvbVxuICAgICAqIHRoZSBzbmFwc2hvdCAoZm9yIGV4YW1wbGUgdGhlIGRlc2lyZWQgYmVoYXZpb3IgZm9yIHNlcnZlciB0aW1lc3RhbXBzIHRoYXRcbiAgICAgKiBoYXZlIG5vdCB5ZXQgYmVlbiBzZXQgdG8gdGhlaXIgZmluYWwgdmFsdWUpLlxuICAgICAqIEByZXR1cm5zIEFuIGBPYmplY3RgIGNvbnRhaW5pbmcgYWxsIGZpZWxkcyBpbiB0aGUgZG9jdW1lbnQuXG4gICAgICovXG4gICAgZGF0YSh0ID0ge30pIHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmRhdGEodCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEEgYFF1ZXJ5U25hcHNob3RgIGNvbnRhaW5zIHplcm8gb3IgbW9yZSBgRG9jdW1lbnRTbmFwc2hvdGAgb2JqZWN0c1xuICogcmVwcmVzZW50aW5nIHRoZSByZXN1bHRzIG9mIGEgcXVlcnkuIFRoZSBkb2N1bWVudHMgY2FuIGJlIGFjY2Vzc2VkIGFzIGFuXG4gKiBhcnJheSB2aWEgdGhlIGBkb2NzYCBwcm9wZXJ0eSBvciBlbnVtZXJhdGVkIHVzaW5nIHRoZSBgZm9yRWFjaGAgbWV0aG9kLiBUaGVcbiAqIG51bWJlciBvZiBkb2N1bWVudHMgY2FuIGJlIGRldGVybWluZWQgdmlhIHRoZSBgZW1wdHlgIGFuZCBgc2l6ZWBcbiAqIHByb3BlcnRpZXMuXG4gKi8gY2xhc3MgTnUge1xuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yICovXG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcykge1xuICAgICAgICB0aGlzLl9maXJlc3RvcmUgPSB0LCB0aGlzLl91c2VyRGF0YVdyaXRlciA9IGUsIHRoaXMuX3NuYXBzaG90ID0gcywgdGhpcy5tZXRhZGF0YSA9IG5ldyBTdShzLmhhc1BlbmRpbmdXcml0ZXMsIHMuZnJvbUNhY2hlKSwgXG4gICAgICAgIHRoaXMucXVlcnkgPSBuO1xuICAgIH1cbiAgICAvKiogQW4gYXJyYXkgb2YgYWxsIHRoZSBkb2N1bWVudHMgaW4gdGhlIGBRdWVyeVNuYXBzaG90YC4gKi8gICAgZ2V0IGRvY3MoKSB7XG4gICAgICAgIGNvbnN0IHQgPSBbXTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZm9yRWFjaCgoZSA9PiB0LnB1c2goZSkpKSwgdDtcbiAgICB9XG4gICAgLyoqIFRoZSBudW1iZXIgb2YgZG9jdW1lbnRzIGluIHRoZSBgUXVlcnlTbmFwc2hvdGAuICovICAgIGdldCBzaXplKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc25hcHNob3QuZG9jcy5zaXplO1xuICAgIH1cbiAgICAvKiogVHJ1ZSBpZiB0aGVyZSBhcmUgbm8gZG9jdW1lbnRzIGluIHRoZSBgUXVlcnlTbmFwc2hvdGAuICovICAgIGdldCBlbXB0eSgpIHtcbiAgICAgICAgcmV0dXJuIDAgPT09IHRoaXMuc2l6ZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRW51bWVyYXRlcyBhbGwgb2YgdGhlIGRvY3VtZW50cyBpbiB0aGUgYFF1ZXJ5U25hcHNob3RgLlxuICAgICAqXG4gICAgICogQHBhcmFtIGNhbGxiYWNrIC0gQSBjYWxsYmFjayB0byBiZSBjYWxsZWQgd2l0aCBhIGBRdWVyeURvY3VtZW50U25hcHNob3RgIGZvclxuICAgICAqIGVhY2ggZG9jdW1lbnQgaW4gdGhlIHNuYXBzaG90LlxuICAgICAqIEBwYXJhbSB0aGlzQXJnIC0gVGhlIGB0aGlzYCBiaW5kaW5nIGZvciB0aGUgY2FsbGJhY2suXG4gICAgICovICAgIGZvckVhY2godCwgZSkge1xuICAgICAgICB0aGlzLl9zbmFwc2hvdC5kb2NzLmZvckVhY2goKG4gPT4ge1xuICAgICAgICAgICAgdC5jYWxsKGUsIG5ldyBDdSh0aGlzLl9maXJlc3RvcmUsIHRoaXMuX3VzZXJEYXRhV3JpdGVyLCBuLmtleSwgbiwgbmV3IFN1KHRoaXMuX3NuYXBzaG90Lm11dGF0ZWRLZXlzLmhhcyhuLmtleSksIHRoaXMuX3NuYXBzaG90LmZyb21DYWNoZSksIHRoaXMucXVlcnkuY29udmVydGVyKSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhbiBhcnJheSBvZiB0aGUgZG9jdW1lbnRzIGNoYW5nZXMgc2luY2UgdGhlIGxhc3Qgc25hcHNob3QuIElmIHRoaXNcbiAgICAgKiBpcyB0aGUgZmlyc3Qgc25hcHNob3QsIGFsbCBkb2N1bWVudHMgd2lsbCBiZSBpbiB0aGUgbGlzdCBhcyAnYWRkZWQnXG4gICAgICogY2hhbmdlcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBvcHRpb25zIC0gYFNuYXBzaG90TGlzdGVuT3B0aW9uc2AgdGhhdCBjb250cm9sIHdoZXRoZXIgbWV0YWRhdGEtb25seVxuICAgICAqIGNoYW5nZXMgKGkuZS4gb25seSBgRG9jdW1lbnRTbmFwc2hvdC5tZXRhZGF0YWAgY2hhbmdlZCkgc2hvdWxkIHRyaWdnZXJcbiAgICAgKiBzbmFwc2hvdCBldmVudHMuXG4gICAgICovICAgIGRvY0NoYW5nZXModCA9IHt9KSB7XG4gICAgICAgIGNvbnN0IGUgPSAhIXQuaW5jbHVkZU1ldGFkYXRhQ2hhbmdlcztcbiAgICAgICAgaWYgKGUgJiYgdGhpcy5fc25hcHNob3QuZXhjbHVkZXNNZXRhZGF0YUNoYW5nZXMpIHRocm93IG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgXCJUbyBpbmNsdWRlIG1ldGFkYXRhIGNoYW5nZXMgd2l0aCB5b3VyIGRvY3VtZW50IGNoYW5nZXMsIHlvdSBtdXN0IGFsc28gcGFzcyB7IGluY2x1ZGVNZXRhZGF0YUNoYW5nZXM6dHJ1ZSB9IHRvIG9uU25hcHNob3QoKS5cIik7XG4gICAgICAgIHJldHVybiB0aGlzLl9jYWNoZWRDaGFuZ2VzICYmIHRoaXMuX2NhY2hlZENoYW5nZXNJbmNsdWRlTWV0YWRhdGFDaGFuZ2VzID09PSBlIHx8ICh0aGlzLl9jYWNoZWRDaGFuZ2VzID0gXG4gICAgICAgIC8qKiBDYWxjdWxhdGVzIHRoZSBhcnJheSBvZiBgRG9jdW1lbnRDaGFuZ2VgcyBmb3IgYSBnaXZlbiBgVmlld1NuYXBzaG90YC4gKi9cbiAgICAgICAgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgaWYgKHQuX3NuYXBzaG90Lm9sZERvY3MuaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICAgICAgbGV0IGUgPSAwO1xuICAgICAgICAgICAgICAgIHJldHVybiB0Ll9zbmFwc2hvdC5kb2NDaGFuZ2VzLm1hcCgobiA9PiAoe1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImFkZGVkXCIsXG4gICAgICAgICAgICAgICAgICAgIGRvYzogbmV3IEN1KHQuX2ZpcmVzdG9yZSwgdC5fdXNlckRhdGFXcml0ZXIsIG4uZG9jLmtleSwgbi5kb2MsIG5ldyBTdSh0Ll9zbmFwc2hvdC5tdXRhdGVkS2V5cy5oYXMobi5kb2Mua2V5KSwgdC5fc25hcHNob3QuZnJvbUNhY2hlKSwgdC5xdWVyeS5jb252ZXJ0ZXIpLFxuICAgICAgICAgICAgICAgICAgICBvbGRJbmRleDogLTEsXG4gICAgICAgICAgICAgICAgICAgIG5ld0luZGV4OiBlKytcbiAgICAgICAgICAgICAgICB9KSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIC8vIEEgYERvY3VtZW50U2V0YCB0aGF0IGlzIHVwZGF0ZWQgaW5jcmVtZW50YWxseSBhcyBjaGFuZ2VzIGFyZSBhcHBsaWVkIHRvIHVzZVxuICAgICAgICAgICAgICAgIC8vIHRvIGxvb2t1cCB0aGUgaW5kZXggb2YgYSBkb2N1bWVudC5cbiAgICAgICAgICAgICAgICBsZXQgbiA9IHQuX3NuYXBzaG90Lm9sZERvY3M7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHQuX3NuYXBzaG90LmRvY0NoYW5nZXMuZmlsdGVyKCh0ID0+IGUgfHwgMyAvKiBNZXRhZGF0YSAqLyAhPT0gdC50eXBlKSkubWFwKChlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcyA9IG5ldyBDdSh0Ll9maXJlc3RvcmUsIHQuX3VzZXJEYXRhV3JpdGVyLCBlLmRvYy5rZXksIGUuZG9jLCBuZXcgU3UodC5fc25hcHNob3QubXV0YXRlZEtleXMuaGFzKGUuZG9jLmtleSksIHQuX3NuYXBzaG90LmZyb21DYWNoZSksIHQucXVlcnkuY29udmVydGVyKTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGkgPSAtMSwgciA9IC0xO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMCAvKiBBZGRlZCAqLyAhPT0gZS50eXBlICYmIChpID0gbi5pbmRleE9mKGUuZG9jLmtleSksIG4gPSBuLmRlbGV0ZShlLmRvYy5rZXkpKSwgXG4gICAgICAgICAgICAgICAgICAgIDEgLyogUmVtb3ZlZCAqLyAhPT0gZS50eXBlICYmIChuID0gbi5hZGQoZS5kb2MpLCByID0gbi5pbmRleE9mKGUuZG9jLmtleSkpLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiB4dShlLnR5cGUpLFxuICAgICAgICAgICAgICAgICAgICAgICAgZG9jOiBzLFxuICAgICAgICAgICAgICAgICAgICAgICAgb2xkSW5kZXg6IGksXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdJbmRleDogclxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSh0aGlzLCBlKSwgdGhpcy5fY2FjaGVkQ2hhbmdlc0luY2x1ZGVNZXRhZGF0YUNoYW5nZXMgPSBlKSwgdGhpcy5fY2FjaGVkQ2hhbmdlcztcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHh1KHQpIHtcbiAgICBzd2l0Y2ggKHQpIHtcbiAgICAgIGNhc2UgMCAvKiBBZGRlZCAqLyA6XG4gICAgICAgIHJldHVybiBcImFkZGVkXCI7XG5cbiAgICAgIGNhc2UgMiAvKiBNb2RpZmllZCAqLyA6XG4gICAgICBjYXNlIDMgLyogTWV0YWRhdGEgKi8gOlxuICAgICAgICByZXR1cm4gXCJtb2RpZmllZFwiO1xuXG4gICAgICBjYXNlIDEgLyogUmVtb3ZlZCAqLyA6XG4gICAgICAgIHJldHVybiBcInJlbW92ZWRcIjtcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIE0oKTtcbiAgICB9XG59XG5cbi8vIFRPRE8oZmlyZXN0b3JlZXhwKTogQWRkIHRlc3RzIGZvciBzbmFwc2hvdEVxdWFsIHdpdGggZGlmZmVyZW50IHNuYXBzaG90XG4vLyBtZXRhZGF0YVxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgdGhlIHByb3ZpZGVkIHNuYXBzaG90cyBhcmUgZXF1YWwuXG4gKlxuICogQHBhcmFtIGxlZnQgLSBBIHNuYXBzaG90IHRvIGNvbXBhcmUuXG4gKiBAcGFyYW0gcmlnaHQgLSBBIHNuYXBzaG90IHRvIGNvbXBhcmUuXG4gKiBAcmV0dXJucyB0cnVlIGlmIHRoZSBzbmFwc2hvdHMgYXJlIGVxdWFsLlxuICovIGZ1bmN0aW9uIGt1KHQsIGUpIHtcbiAgICByZXR1cm4gdCBpbnN0YW5jZW9mIER1ICYmIGUgaW5zdGFuY2VvZiBEdSA/IHQuX2ZpcmVzdG9yZSA9PT0gZS5fZmlyZXN0b3JlICYmIHQuX2tleS5pc0VxdWFsKGUuX2tleSkgJiYgKG51bGwgPT09IHQuX2RvY3VtZW50ID8gbnVsbCA9PT0gZS5fZG9jdW1lbnQgOiB0Ll9kb2N1bWVudC5pc0VxdWFsKGUuX2RvY3VtZW50KSkgJiYgdC5fY29udmVydGVyID09PSBlLl9jb252ZXJ0ZXIgOiB0IGluc3RhbmNlb2YgTnUgJiYgZSBpbnN0YW5jZW9mIE51ICYmICh0Ll9maXJlc3RvcmUgPT09IGUuX2ZpcmVzdG9yZSAmJiBWYyh0LnF1ZXJ5LCBlLnF1ZXJ5KSAmJiB0Lm1ldGFkYXRhLmlzRXF1YWwoZS5tZXRhZGF0YSkgJiYgdC5fc25hcHNob3QuaXNFcXVhbChlLl9zbmFwc2hvdCkpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBmdW5jdGlvbiAkdSh0KSB7XG4gICAgaWYgKF9lKHQpICYmIDAgPT09IHQuZXhwbGljaXRPcmRlckJ5Lmxlbmd0aCkgdGhyb3cgbmV3IEsocS5VTklNUExFTUVOVEVELCBcImxpbWl0VG9MYXN0KCkgcXVlcmllcyByZXF1aXJlIHNwZWNpZnlpbmcgYXQgbGVhc3Qgb25lIG9yZGVyQnkoKSBjbGF1c2VcIik7XG59XG5cbi8qKlxuICogQSBgUXVlcnlDb25zdHJhaW50YCBpcyB1c2VkIHRvIG5hcnJvdyB0aGUgc2V0IG9mIGRvY3VtZW50cyByZXR1cm5lZCBieSBhXG4gKiBGaXJlc3RvcmUgcXVlcnkuIGBRdWVyeUNvbnN0cmFpbnRgcyBhcmUgY3JlYXRlZCBieSBpbnZva2luZyB7QGxpbmsgd2hlcmV9LFxuICoge0BsaW5rIG9yZGVyQnl9LCB7QGxpbmsgKHN0YXJ0QXQ6MSl9LCB7QGxpbmsgKHN0YXJ0QWZ0ZXI6MSl9LCB7QGxpbmtcbiAqIGVuZEJlZm9yZToxfSwge0BsaW5rIChlbmRBdDoxKX0sIHtAbGluayBsaW1pdH0gb3Ige0BsaW5rIGxpbWl0VG9MYXN0fSBhbmRcbiAqIGNhbiB0aGVuIGJlIHBhc3NlZCB0byB7QGxpbmsgcXVlcnl9IHRvIGNyZWF0ZSBhIG5ldyBxdWVyeSBpbnN0YW5jZSB0aGF0XG4gKiBhbHNvIGNvbnRhaW5zIHRoaXMgYFF1ZXJ5Q29uc3RyYWludGAuXG4gKi8gY2xhc3MgT3Uge31cblxuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IGltbXV0YWJsZSBpbnN0YW5jZSBvZiB7QGxpbmsgUXVlcnl9IHRoYXQgaXMgZXh0ZW5kZWQgdG8gYWxzbyBpbmNsdWRlXG4gKiBhZGRpdGlvbmFsIHF1ZXJ5IGNvbnN0cmFpbnRzLlxuICpcbiAqIEBwYXJhbSBxdWVyeSAtIFRoZSB7QGxpbmsgUXVlcnl9IGluc3RhbmNlIHRvIHVzZSBhcyBhIGJhc2UgZm9yIHRoZSBuZXcgY29uc3RyYWludHMuXG4gKiBAcGFyYW0gcXVlcnlDb25zdHJhaW50cyAtIFRoZSBsaXN0IG9mIHtAbGluayBRdWVyeUNvbnN0cmFpbnR9cyB0byBhcHBseS5cbiAqIEB0aHJvd3MgaWYgYW55IG9mIHRoZSBwcm92aWRlZCBxdWVyeSBjb25zdHJhaW50cyBjYW5ub3QgYmUgY29tYmluZWQgd2l0aCB0aGVcbiAqIGV4aXN0aW5nIG9yIG5ldyBjb25zdHJhaW50cy5cbiAqLyBmdW5jdGlvbiBGdSh0LCAuLi5lKSB7XG4gICAgZm9yIChjb25zdCBuIG9mIGUpIHQgPSBuLl9hcHBseSh0KTtcbiAgICByZXR1cm4gdDtcbn1cblxuY2xhc3MgTXUgZXh0ZW5kcyBPdSB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbikge1xuICAgICAgICBzdXBlcigpLCB0aGlzLkthID0gdCwgdGhpcy5qYSA9IGUsIHRoaXMuUWEgPSBuLCB0aGlzLnR5cGUgPSBcIndoZXJlXCI7XG4gICAgfVxuICAgIF9hcHBseSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBvdSh0LmZpcmVzdG9yZSksIG4gPSBmdW5jdGlvbih0LCBlLCBuLCBzLCBpLCByLCBvKSB7XG4gICAgICAgICAgICBsZXQgYTtcbiAgICAgICAgICAgIGlmIChpLmlzS2V5RmllbGQoKSkge1xuICAgICAgICAgICAgICAgIGlmIChcImFycmF5LWNvbnRhaW5zXCIgLyogQVJSQVlfQ09OVEFJTlMgKi8gPT09IHIgfHwgXCJhcnJheS1jb250YWlucy1hbnlcIiAvKiBBUlJBWV9DT05UQUlOU19BTlkgKi8gPT09IHIpIHRocm93IG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgYEludmFsaWQgUXVlcnkuIFlvdSBjYW4ndCBwZXJmb3JtICcke3J9JyBxdWVyaWVzIG9uIEZpZWxkUGF0aC5kb2N1bWVudElkKCkuYCk7XG4gICAgICAgICAgICAgICAgaWYgKFwiaW5cIiAvKiBJTiAqLyA9PT0gciB8fCBcIm5vdC1pblwiIC8qIE5PVF9JTiAqLyA9PT0gcikge1xuICAgICAgICAgICAgICAgICAgICBadShvLCByKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgbykgZS5wdXNoKFh1KHMsIHQsIG4pKTtcbiAgICAgICAgICAgICAgICAgICAgYSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFycmF5VmFsdWU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXM6IGVcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgYSA9IFh1KHMsIHQsIG8pO1xuICAgICAgICAgICAgfSBlbHNlIFwiaW5cIiAvKiBJTiAqLyAhPT0gciAmJiBcIm5vdC1pblwiIC8qIE5PVF9JTiAqLyAhPT0gciAmJiBcImFycmF5LWNvbnRhaW5zLWFueVwiIC8qIEFSUkFZX0NPTlRBSU5TX0FOWSAqLyAhPT0gciB8fCBadShvLCByKSwgXG4gICAgICAgICAgICBhID0gbXUobiwgZSwgbywgXG4gICAgICAgICAgICAvKiBhbGxvd0FycmF5cz0gKi8gXCJpblwiIC8qIElOICovID09PSByIHx8IFwibm90LWluXCIgLyogTk9UX0lOICovID09PSByKTtcbiAgICAgICAgICAgIGNvbnN0IGMgPSBIdC5jcmVhdGUoaSwgciwgYSk7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgICAgIGlmIChlLnYoKSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gZ2UodCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChudWxsICE9PSBuICYmICFuLmlzRXF1YWwoZS5maWVsZCkpIHRocm93IG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgYEludmFsaWQgcXVlcnkuIEFsbCB3aGVyZSBmaWx0ZXJzIHdpdGggYW4gaW5lcXVhbGl0eSAoPCwgPD0sICE9LCBub3QtaW4sID4sIG9yID49KSBtdXN0IGJlIG9uIHRoZSBzYW1lIGZpZWxkLiBCdXQgeW91IGhhdmUgaW5lcXVhbGl0eSBmaWx0ZXJzIG9uICcke24udG9TdHJpbmcoKX0nIGFuZCAnJHtlLmZpZWxkLnRvU3RyaW5nKCl9J2ApO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzID0gbWUodCk7XG4gICAgICAgICAgICAgICAgICAgIG51bGwgIT09IHMgJiYgdGgodCwgZS5maWVsZCwgcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbiBvZiB0LmZpbHRlcnMpIGlmIChlLmluZGV4T2Yobi5vcCkgPj0gMCkgcmV0dXJuIG4ub3A7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgIH0odCwgXG4gICAgICAgICAgICAgICAgLyoqXG4gKiBHaXZlbiBhbiBvcGVyYXRvciwgcmV0dXJucyB0aGUgc2V0IG9mIG9wZXJhdG9ycyB0aGF0IGNhbm5vdCBiZSB1c2VkIHdpdGggaXQuXG4gKlxuICogT3BlcmF0b3JzIGluIGEgcXVlcnkgbXVzdCBhZGhlcmUgdG8gdGhlIGZvbGxvd2luZyBzZXQgb2YgcnVsZXM6XG4gKiAxLiBPbmx5IG9uZSBhcnJheSBvcGVyYXRvciBpcyBhbGxvd2VkLlxuICogMi4gT25seSBvbmUgZGlzanVuY3RpdmUgb3BlcmF0b3IgaXMgYWxsb3dlZC5cbiAqIDMuIGBOT1RfRVFVQUxgIGNhbm5vdCBiZSB1c2VkIHdpdGggYW5vdGhlciBgTk9UX0VRVUFMYCBvcGVyYXRvci5cbiAqIDQuIGBOT1RfSU5gIGNhbm5vdCBiZSB1c2VkIHdpdGggYXJyYXksIGRpc2p1bmN0aXZlLCBvciBgTk9UX0VRVUFMYCBvcGVyYXRvcnMuXG4gKlxuICogQXJyYXkgb3BlcmF0b3JzOiBgQVJSQVlfQ09OVEFJTlNgLCBgQVJSQVlfQ09OVEFJTlNfQU5ZYFxuICogRGlzanVuY3RpdmUgb3BlcmF0b3JzOiBgSU5gLCBgQVJSQVlfQ09OVEFJTlNfQU5ZYCwgYE5PVF9JTmBcbiAqL1xuICAgICAgICAgICAgICAgIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoICh0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIiE9XCIgLyogTk9UX0VRVUFMICovIDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbIFwiIT1cIiAvKiBOT1RfRVFVQUwgKi8gLCBcIm5vdC1pblwiIC8qIE5PVF9JTiAqLyBdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImFycmF5LWNvbnRhaW5zXCIgLyogQVJSQVlfQ09OVEFJTlMgKi8gOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsgXCJhcnJheS1jb250YWluc1wiIC8qIEFSUkFZX0NPTlRBSU5TICovICwgXCJhcnJheS1jb250YWlucy1hbnlcIiAvKiBBUlJBWV9DT05UQUlOU19BTlkgKi8gLCBcIm5vdC1pblwiIC8qIE5PVF9JTiAqLyBdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImluXCIgLyogSU4gKi8gOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsgXCJhcnJheS1jb250YWlucy1hbnlcIiAvKiBBUlJBWV9DT05UQUlOU19BTlkgKi8gLCBcImluXCIgLyogSU4gKi8gLCBcIm5vdC1pblwiIC8qIE5PVF9JTiAqLyBdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImFycmF5LWNvbnRhaW5zLWFueVwiIC8qIEFSUkFZX0NPTlRBSU5TX0FOWSAqLyA6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWyBcImFycmF5LWNvbnRhaW5zXCIgLyogQVJSQVlfQ09OVEFJTlMgKi8gLCBcImFycmF5LWNvbnRhaW5zLWFueVwiIC8qIEFSUkFZX0NPTlRBSU5TX0FOWSAqLyAsIFwiaW5cIiAvKiBJTiAqLyAsIFwibm90LWluXCIgLyogTk9UX0lOICovIF07XG5cbiAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwibm90LWluXCIgLyogTk9UX0lOICovIDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbIFwiYXJyYXktY29udGFpbnNcIiAvKiBBUlJBWV9DT05UQUlOUyAqLyAsIFwiYXJyYXktY29udGFpbnMtYW55XCIgLyogQVJSQVlfQ09OVEFJTlNfQU5ZICovICwgXCJpblwiIC8qIElOICovICwgXCJub3QtaW5cIiAvKiBOT1RfSU4gKi8gLCBcIiE9XCIgLyogTk9UX0VRVUFMICovIF07XG5cbiAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfShlLm9wKSk7XG4gICAgICAgICAgICAgICAgaWYgKG51bGwgIT09IG4pIFxuICAgICAgICAgICAgICAgIC8vIFNwZWNpYWwgY2FzZSB3aGVuIGl0J3MgYSBkdXBsaWNhdGUgb3AgdG8gZ2l2ZSBhIHNsaWdodGx5IGNsZWFyZXIgZXJyb3IgbWVzc2FnZS5cbiAgICAgICAgICAgICAgICB0aHJvdyBuID09PSBlLm9wID8gbmV3IEsocS5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBxdWVyeS4gWW91IGNhbm5vdCB1c2UgbW9yZSB0aGFuIG9uZSAnJHtlLm9wLnRvU3RyaW5nKCl9JyBmaWx0ZXIuYCkgOiBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIHF1ZXJ5LiBZb3UgY2Fubm90IHVzZSAnJHtlLm9wLnRvU3RyaW5nKCl9JyBmaWx0ZXJzIHdpdGggJyR7bi50b1N0cmluZygpfScgZmlsdGVycy5gKTtcbiAgICAgICAgICAgIH0odCwgYyksIGM7XG4gICAgICAgIH0odC5fcXVlcnksIFwid2hlcmVcIiwgZSwgdC5maXJlc3RvcmUuX2RhdGFiYXNlSWQsIHRoaXMuS2EsIHRoaXMuamEsIHRoaXMuUWEpO1xuICAgICAgICByZXR1cm4gbmV3IEljKHQuZmlyZXN0b3JlLCB0LmNvbnZlcnRlciwgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgY29uc3QgbiA9IHQuZmlsdGVycy5jb25jYXQoWyBlIF0pO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBsZSh0LnBhdGgsIHQuY29sbGVjdGlvbkdyb3VwLCB0LmV4cGxpY2l0T3JkZXJCeS5zbGljZSgpLCBuLCB0LmxpbWl0LCB0LmxpbWl0VHlwZSwgdC5zdGFydEF0LCB0LmVuZEF0KTtcbiAgICAgICAgfSh0Ll9xdWVyeSwgbikpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEge0BsaW5rIFF1ZXJ5Q29uc3RyYWludH0gdGhhdCBlbmZvcmNlcyB0aGF0IGRvY3VtZW50cyBtdXN0IGNvbnRhaW4gdGhlXG4gKiBzcGVjaWZpZWQgZmllbGQgYW5kIHRoYXQgdGhlIHZhbHVlIHNob3VsZCBzYXRpc2Z5IHRoZSByZWxhdGlvbiBjb25zdHJhaW50XG4gKiBwcm92aWRlZC5cbiAqXG4gKiBAcGFyYW0gZmllbGRQYXRoIC0gVGhlIHBhdGggdG8gY29tcGFyZVxuICogQHBhcmFtIG9wU3RyIC0gVGhlIG9wZXJhdGlvbiBzdHJpbmcgKGUuZyBcIiZsdDtcIiwgXCImbHQ7PVwiLCBcIj09XCIsIFwiJmx0O1wiLFxuICogICBcIiZsdDs9XCIsIFwiIT1cIikuXG4gKiBAcGFyYW0gdmFsdWUgLSBUaGUgdmFsdWUgZm9yIGNvbXBhcmlzb25cbiAqIEByZXR1cm5zIFRoZSBjcmVhdGVkIHtAbGluayBRdWVyeX0uXG4gKi8gZnVuY3Rpb24gTHUodCwgZSwgbikge1xuICAgIGNvbnN0IHMgPSBlLCBpID0gVnUoXCJ3aGVyZVwiLCB0KTtcbiAgICByZXR1cm4gbmV3IE11KGksIHMsIG4pO1xufVxuXG5jbGFzcyBCdSBleHRlbmRzIE91IHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMuS2EgPSB0LCB0aGlzLldhID0gZSwgdGhpcy50eXBlID0gXCJvcmRlckJ5XCI7XG4gICAgfVxuICAgIF9hcHBseSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBmdW5jdGlvbih0LCBlLCBuKSB7XG4gICAgICAgICAgICBpZiAobnVsbCAhPT0gdC5zdGFydEF0KSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIFwiSW52YWxpZCBxdWVyeS4gWW91IG11c3Qgbm90IGNhbGwgc3RhcnRBdCgpIG9yIHN0YXJ0QWZ0ZXIoKSBiZWZvcmUgY2FsbGluZyBvcmRlckJ5KCkuXCIpO1xuICAgICAgICAgICAgaWYgKG51bGwgIT09IHQuZW5kQXQpIHRocm93IG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgXCJJbnZhbGlkIHF1ZXJ5LiBZb3UgbXVzdCBub3QgY2FsbCBlbmRBdCgpIG9yIGVuZEJlZm9yZSgpIGJlZm9yZSBjYWxsaW5nIG9yZGVyQnkoKS5cIik7XG4gICAgICAgICAgICBjb25zdCBzID0gbmV3IGFlKGUsIG4pO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgICAgICBpZiAobnVsbCA9PT0gbWUodCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyBpcyB0aGUgZmlyc3Qgb3JkZXIgYnkuIEl0IG11c3QgbWF0Y2ggYW55IGluZXF1YWxpdHkuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBnZSh0KTtcbiAgICAgICAgICAgICAgICAgICAgbnVsbCAhPT0gbiAmJiB0aCh0LCBuLCBlLmZpZWxkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KHQsIHMpLCBzO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICogQ3JlYXRlIGEgYEJvdW5kYCBmcm9tIGEgcXVlcnkgYW5kIGEgZG9jdW1lbnQuXG4gKlxuICogTm90ZSB0aGF0IHRoZSBgQm91bmRgIHdpbGwgYWx3YXlzIGluY2x1ZGUgdGhlIGtleSBvZiB0aGUgZG9jdW1lbnRcbiAqIGFuZCBzbyBvbmx5IHRoZSBwcm92aWRlZCBkb2N1bWVudCB3aWxsIGNvbXBhcmUgZXF1YWwgdG8gdGhlIHJldHVybmVkXG4gKiBwb3NpdGlvbi5cbiAqXG4gKiBXaWxsIHRocm93IGlmIHRoZSBkb2N1bWVudCBkb2VzIG5vdCBjb250YWluIGFsbCBmaWVsZHMgb2YgdGhlIG9yZGVyIGJ5XG4gKiBvZiB0aGUgcXVlcnkgb3IgaWYgYW55IG9mIHRoZSBmaWVsZHMgaW4gdGhlIG9yZGVyIGJ5IGFyZSBhbiB1bmNvbW1pdHRlZFxuICogc2VydmVyIHRpbWVzdGFtcC5cbiAqLyAodC5fcXVlcnksIHRoaXMuS2EsIHRoaXMuV2EpO1xuICAgICAgICByZXR1cm4gbmV3IEljKHQuZmlyZXN0b3JlLCB0LmNvbnZlcnRlciwgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgLy8gVE9ETyhkaW1vbmQpOiB2YWxpZGF0ZSB0aGF0IG9yZGVyQnkgZG9lcyBub3QgbGlzdCB0aGUgc2FtZSBrZXkgdHdpY2UuXG4gICAgICAgICAgICBjb25zdCBuID0gdC5leHBsaWNpdE9yZGVyQnkuY29uY2F0KFsgZSBdKTtcbiAgICAgICAgICAgIHJldHVybiBuZXcgbGUodC5wYXRoLCB0LmNvbGxlY3Rpb25Hcm91cCwgbiwgdC5maWx0ZXJzLnNsaWNlKCksIHQubGltaXQsIHQubGltaXRUeXBlLCB0LnN0YXJ0QXQsIHQuZW5kQXQpO1xuICAgICAgICB9KHQuX3F1ZXJ5LCBlKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYSB7QGxpbmsgUXVlcnlDb25zdHJhaW50fSB0aGF0IHNvcnRzIHRoZSBxdWVyeSByZXN1bHQgYnkgdGhlXG4gKiBzcGVjaWZpZWQgZmllbGQsIG9wdGlvbmFsbHkgaW4gZGVzY2VuZGluZyBvcmRlciBpbnN0ZWFkIG9mIGFzY2VuZGluZy5cbiAqXG4gKiBAcGFyYW0gZmllbGRQYXRoIC0gVGhlIGZpZWxkIHRvIHNvcnQgYnkuXG4gKiBAcGFyYW0gZGlyZWN0aW9uU3RyIC0gT3B0aW9uYWwgZGlyZWN0aW9uIHRvIHNvcnQgYnkgKCdhc2MnIG9yICdkZXNjJykuIElmXG4gKiBub3Qgc3BlY2lmaWVkLCBvcmRlciB3aWxsIGJlIGFzY2VuZGluZy5cbiAqIEByZXR1cm5zIFRoZSBjcmVhdGVkIHtAbGluayBRdWVyeX0uXG4gKi8gZnVuY3Rpb24gVXUodCwgZSA9IFwiYXNjXCIpIHtcbiAgICBjb25zdCBuID0gZSwgcyA9IFZ1KFwib3JkZXJCeVwiLCB0KTtcbiAgICByZXR1cm4gbmV3IEJ1KHMsIG4pO1xufVxuXG5jbGFzcyBxdSBleHRlbmRzIE91IHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMudHlwZSA9IHQsIHRoaXMuR2EgPSBlLCB0aGlzLnphID0gbjtcbiAgICB9XG4gICAgX2FwcGx5KHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBJYyh0LmZpcmVzdG9yZSwgdC5jb252ZXJ0ZXIsIFRlKHQuX3F1ZXJ5LCB0aGlzLkdhLCB0aGlzLnphKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYSB7QGxpbmsgUXVlcnlDb25zdHJhaW50fSB0aGF0IG9ubHkgcmV0dXJucyB0aGUgZmlyc3QgbWF0Y2hpbmcgZG9jdW1lbnRzLlxuICpcbiAqIEBwYXJhbSBsaW1pdCAtIFRoZSBtYXhpbXVtIG51bWJlciBvZiBpdGVtcyB0byByZXR1cm4uXG4gKiBAcmV0dXJucyBUaGUgY3JlYXRlZCB7QGxpbmsgUXVlcnl9LlxuICovIGZ1bmN0aW9uIEt1KHQpIHtcbiAgICByZXR1cm4gZ2MoXCJsaW1pdFwiLCB0KSwgbmV3IHF1KFwibGltaXRcIiwgdCwgXCJGXCIgLyogRmlyc3QgKi8pO1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSB7QGxpbmsgUXVlcnlDb25zdHJhaW50fSB0aGF0IG9ubHkgcmV0dXJucyB0aGUgbGFzdCBtYXRjaGluZyBkb2N1bWVudHMuXG4gKlxuICogWW91IG11c3Qgc3BlY2lmeSBhdCBsZWFzdCBvbmUgYG9yZGVyQnlgIGNsYXVzZSBmb3IgYGxpbWl0VG9MYXN0YCBxdWVyaWVzLFxuICogb3RoZXJ3aXNlIGFuIGV4Y2VwdGlvbiB3aWxsIGJlIHRocm93biBkdXJpbmcgZXhlY3V0aW9uLlxuICpcbiAqIEBwYXJhbSBsaW1pdCAtIFRoZSBtYXhpbXVtIG51bWJlciBvZiBpdGVtcyB0byByZXR1cm4uXG4gKiBAcmV0dXJucyBUaGUgY3JlYXRlZCB7QGxpbmsgUXVlcnl9LlxuICovIGZ1bmN0aW9uIGp1KHQpIHtcbiAgICByZXR1cm4gZ2MoXCJsaW1pdFRvTGFzdFwiLCB0KSwgbmV3IHF1KFwibGltaXRUb0xhc3RcIiwgdCwgXCJMXCIgLyogTGFzdCAqLyk7XG59XG5cbmNsYXNzIFF1IGV4dGVuZHMgT3Uge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4pIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy50eXBlID0gdCwgdGhpcy5IYSA9IGUsIHRoaXMuSmEgPSBuO1xuICAgIH1cbiAgICBfYXBwbHkodCkge1xuICAgICAgICBjb25zdCBlID0gWXUodCwgdGhpcy50eXBlLCB0aGlzLkhhLCB0aGlzLkphKTtcbiAgICAgICAgcmV0dXJuIG5ldyBJYyh0LmZpcmVzdG9yZSwgdC5jb252ZXJ0ZXIsIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgbGUodC5wYXRoLCB0LmNvbGxlY3Rpb25Hcm91cCwgdC5leHBsaWNpdE9yZGVyQnkuc2xpY2UoKSwgdC5maWx0ZXJzLnNsaWNlKCksIHQubGltaXQsIHQubGltaXRUeXBlLCBlLCB0LmVuZEF0KTtcbiAgICAgICAgfSh0Ll9xdWVyeSwgZSkpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gV3UoLi4udCkge1xuICAgIHJldHVybiBuZXcgUXUoXCJzdGFydEF0XCIsIHQsIC8qYmVmb3JlPSovICEwKTtcbn1cblxuZnVuY3Rpb24gR3UoLi4udCkge1xuICAgIHJldHVybiBuZXcgUXUoXCJzdGFydEFmdGVyXCIsIHQsIFxuICAgIC8qYmVmb3JlPSovICExKTtcbn1cblxuY2xhc3MgenUgZXh0ZW5kcyBPdSB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbikge1xuICAgICAgICBzdXBlcigpLCB0aGlzLnR5cGUgPSB0LCB0aGlzLkhhID0gZSwgdGhpcy5KYSA9IG47XG4gICAgfVxuICAgIF9hcHBseSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBZdSh0LCB0aGlzLnR5cGUsIHRoaXMuSGEsIHRoaXMuSmEpO1xuICAgICAgICByZXR1cm4gbmV3IEljKHQuZmlyZXN0b3JlLCB0LmNvbnZlcnRlciwgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBsZSh0LnBhdGgsIHQuY29sbGVjdGlvbkdyb3VwLCB0LmV4cGxpY2l0T3JkZXJCeS5zbGljZSgpLCB0LmZpbHRlcnMuc2xpY2UoKSwgdC5saW1pdCwgdC5saW1pdFR5cGUsIHQuc3RhcnRBdCwgZSk7XG4gICAgICAgIH0odC5fcXVlcnksIGUpKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIEh1KC4uLnQpIHtcbiAgICByZXR1cm4gbmV3IHp1KFwiZW5kQmVmb3JlXCIsIHQsIC8qYmVmb3JlPSovICEwKTtcbn1cblxuZnVuY3Rpb24gSnUoLi4udCkge1xuICAgIHJldHVybiBuZXcgenUoXCJlbmRBdFwiLCB0LCAvKmJlZm9yZT0qLyAhMSk7XG59XG5cbi8qKiBIZWxwZXIgZnVuY3Rpb24gdG8gY3JlYXRlIGEgYm91bmQgZnJvbSBhIGRvY3VtZW50IG9yIGZpZWxkcyAqLyBmdW5jdGlvbiBZdSh0LCBlLCBuLCBzKSB7XG4gICAgaWYgKG5bMF0gPSB5KG5bMF0pLCBuWzBdIGluc3RhbmNlb2YgYnUpIHJldHVybiBmdW5jdGlvbih0LCBlLCBuLCBzLCBpKSB7XG4gICAgICAgIGlmICghcykgdGhyb3cgbmV3IEsocS5OT1RfRk9VTkQsIGBDYW4ndCB1c2UgYSBEb2N1bWVudFNuYXBzaG90IHRoYXQgZG9lc24ndCBleGlzdCBmb3IgJHtufSgpLmApO1xuICAgICAgICBjb25zdCByID0gW107XG4gICAgICAgIC8vIEJlY2F1c2UgcGVvcGxlIGV4cGVjdCB0byBjb250aW51ZS9lbmQgYSBxdWVyeSBhdCB0aGUgZXhhY3QgZG9jdW1lbnRcbiAgICAgICAgLy8gcHJvdmlkZWQsIHdlIG5lZWQgdG8gdXNlIHRoZSBpbXBsaWNpdCBzb3J0IG9yZGVyIHJhdGhlciB0aGFuIHRoZSBleHBsaWNpdFxuICAgICAgICAvLyBzb3J0IG9yZGVyLCBiZWNhdXNlIGl0J3MgZ3VhcmFudGVlZCB0byBjb250YWluIHRoZSBkb2N1bWVudCBrZXkuIFRoYXQgd2F5XG4gICAgICAgIC8vIHRoZSBwb3NpdGlvbiBiZWNvbWVzIHVuYW1iaWd1b3VzIGFuZCB0aGUgcXVlcnkgY29udGludWVzL2VuZHMgZXhhY3RseSBhdFxuICAgICAgICAvLyB0aGUgcHJvdmlkZWQgZG9jdW1lbnQuIFdpdGhvdXQgdGhlIGtleSAoYnkgdXNpbmcgdGhlIGV4cGxpY2l0IHNvcnRcbiAgICAgICAgLy8gb3JkZXJzKSwgbXVsdGlwbGUgZG9jdW1lbnRzIGNvdWxkIG1hdGNoIHRoZSBwb3NpdGlvbiwgeWllbGRpbmcgZHVwbGljYXRlXG4gICAgICAgIC8vIHJlc3VsdHMuXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBuIG9mIHBlKHQpKSBpZiAobi5maWVsZC5pc0tleUZpZWxkKCkpIHIucHVzaCh4dChlLCBzLmtleSkpOyBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBzLmRhdGEuZmllbGQobi5maWVsZCk7XG4gICAgICAgICAgICBpZiAocHQodCkpIHRocm93IG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgJ0ludmFsaWQgcXVlcnkuIFlvdSBhcmUgdHJ5aW5nIHRvIHN0YXJ0IG9yIGVuZCBhIHF1ZXJ5IHVzaW5nIGEgZG9jdW1lbnQgZm9yIHdoaWNoIHRoZSBmaWVsZCBcIicgKyBuLmZpZWxkICsgJ1wiIGlzIGFuIHVuY29tbWl0dGVkIHNlcnZlciB0aW1lc3RhbXAuIChTaW5jZSB0aGUgdmFsdWUgb2YgdGhpcyBmaWVsZCBpcyB1bmtub3duLCB5b3UgY2Fubm90IHN0YXJ0L2VuZCBhIHF1ZXJ5IHdpdGggaXQuKScpO1xuICAgICAgICAgICAgaWYgKG51bGwgPT09IHQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gbi5maWVsZC5jYW5vbmljYWxTdHJpbmcoKTtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIHF1ZXJ5LiBZb3UgYXJlIHRyeWluZyB0byBzdGFydCBvciBlbmQgYSBxdWVyeSB1c2luZyBhIGRvY3VtZW50IGZvciB3aGljaCB0aGUgZmllbGQgJyR7dH0nICh1c2VkIGFzIHRoZSBvcmRlckJ5KSBkb2VzIG5vdCBleGlzdC5gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHIucHVzaCh0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IHJlKHIsIGkpO1xuICAgIH1cbiAgICAvKipcbiAqIENvbnZlcnRzIGEgbGlzdCBvZiBmaWVsZCB2YWx1ZXMgdG8gYSBgQm91bmRgIGZvciB0aGUgZ2l2ZW4gcXVlcnkuXG4gKi8gKHQuX3F1ZXJ5LCB0LmZpcmVzdG9yZS5fZGF0YWJhc2VJZCwgZSwgblswXS5fZG9jdW1lbnQsIHMpO1xuICAgIHtcbiAgICAgICAgY29uc3QgaSA9IG91KHQuZmlyZXN0b3JlKTtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUsIG4sIHMsIGksIHIpIHtcbiAgICAgICAgICAgIC8vIFVzZSBleHBsaWNpdCBvcmRlciBieSdzIGJlY2F1c2UgaXQgaGFzIHRvIG1hdGNoIHRoZSBxdWVyeSB0aGUgdXNlciBtYWRlXG4gICAgICAgICAgICBjb25zdCBvID0gdC5leHBsaWNpdE9yZGVyQnk7XG4gICAgICAgICAgICBpZiAoaS5sZW5ndGggPiBvLmxlbmd0aCkgdGhyb3cgbmV3IEsocS5JTlZBTElEX0FSR1VNRU5ULCBgVG9vIG1hbnkgYXJndW1lbnRzIHByb3ZpZGVkIHRvICR7c30oKS4gVGhlIG51bWJlciBvZiBhcmd1bWVudHMgbXVzdCBiZSBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gdGhlIG51bWJlciBvZiBvcmRlckJ5KCkgY2xhdXNlc2ApO1xuICAgICAgICAgICAgY29uc3QgYSA9IFtdO1xuICAgICAgICAgICAgZm9yIChsZXQgciA9IDA7IHIgPCBpLmxlbmd0aDsgcisrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgYyA9IGlbcl07XG4gICAgICAgICAgICAgICAgaWYgKG9bcl0uZmllbGQuaXNLZXlGaWVsZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChcInN0cmluZ1wiICE9IHR5cGVvZiBjKSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIHF1ZXJ5LiBFeHBlY3RlZCBhIHN0cmluZyBmb3IgZG9jdW1lbnQgSUQgaW4gJHtzfSgpLCBidXQgZ290IGEgJHt0eXBlb2YgY31gKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF5ZSh0KSAmJiAtMSAhPT0gYy5pbmRleE9mKFwiL1wiKSkgdGhyb3cgbmV3IEsocS5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBxdWVyeS4gV2hlbiBxdWVyeWluZyBhIGNvbGxlY3Rpb24gYW5kIG9yZGVyaW5nIGJ5IEZpZWxkUGF0aC5kb2N1bWVudElkKCksIHRoZSB2YWx1ZSBwYXNzZWQgdG8gJHtzfSgpIG11c3QgYmUgYSBwbGFpbiBkb2N1bWVudCBJRCwgYnV0ICcke2N9JyBjb250YWlucyBhIHNsYXNoLmApO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gdC5wYXRoLmNoaWxkKHV0LmZyb21TdHJpbmcoYykpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIVB0LmlzRG9jdW1lbnRLZXkobikpIHRocm93IG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgYEludmFsaWQgcXVlcnkuIFdoZW4gcXVlcnlpbmcgYSBjb2xsZWN0aW9uIGdyb3VwIGFuZCBvcmRlcmluZyBieSBGaWVsZFBhdGguZG9jdW1lbnRJZCgpLCB0aGUgdmFsdWUgcGFzc2VkIHRvICR7c30oKSBtdXN0IHJlc3VsdCBpbiBhIHZhbGlkIGRvY3VtZW50IHBhdGgsIGJ1dCAnJHtufScgaXMgbm90IGJlY2F1c2UgaXQgY29udGFpbnMgYW4gb2RkIG51bWJlciBvZiBzZWdtZW50cy5gKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IG5ldyBQdChuKTtcbiAgICAgICAgICAgICAgICAgICAgYS5wdXNoKHh0KGUsIGkpKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gbXUobiwgcywgYyk7XG4gICAgICAgICAgICAgICAgICAgIGEucHVzaCh0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmV3IHJlKGEsIHIpO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICogUGFyc2VzIHRoZSBnaXZlbiBgZG9jdW1lbnRJZFZhbHVlYCBpbnRvIGEgYFJlZmVyZW5jZVZhbHVlYCwgdGhyb3dpbmdcbiAqIGFwcHJvcHJpYXRlIGVycm9ycyBpZiB0aGUgdmFsdWUgaXMgYW55dGhpbmcgb3RoZXIgdGhhbiBhIGBEb2N1bWVudFJlZmVyZW5jZWBcbiAqIG9yIGBzdHJpbmdgLCBvciBpZiB0aGUgc3RyaW5nIGlzIG1hbGZvcm1lZC5cbiAqLyAodC5fcXVlcnksIHQuZmlyZXN0b3JlLl9kYXRhYmFzZUlkLCBpLCBlLCBuLCBzKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIFh1KHQsIGUsIG4pIHtcbiAgICBpZiAoXCJzdHJpbmdcIiA9PSB0eXBlb2YgKG4gPSB5KG4pKSkge1xuICAgICAgICBpZiAoXCJcIiA9PT0gbikgdGhyb3cgbmV3IEsocS5JTlZBTElEX0FSR1VNRU5ULCBcIkludmFsaWQgcXVlcnkuIFdoZW4gcXVlcnlpbmcgd2l0aCBGaWVsZFBhdGguZG9jdW1lbnRJZCgpLCB5b3UgbXVzdCBwcm92aWRlIGEgdmFsaWQgZG9jdW1lbnQgSUQsIGJ1dCBpdCB3YXMgYW4gZW1wdHkgc3RyaW5nLlwiKTtcbiAgICAgICAgaWYgKCF5ZShlKSAmJiAtMSAhPT0gbi5pbmRleE9mKFwiL1wiKSkgdGhyb3cgbmV3IEsocS5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBxdWVyeS4gV2hlbiBxdWVyeWluZyBhIGNvbGxlY3Rpb24gYnkgRmllbGRQYXRoLmRvY3VtZW50SWQoKSwgeW91IG11c3QgcHJvdmlkZSBhIHBsYWluIGRvY3VtZW50IElELCBidXQgJyR7bn0nIGNvbnRhaW5zIGEgJy8nIGNoYXJhY3Rlci5gKTtcbiAgICAgICAgY29uc3QgcyA9IGUucGF0aC5jaGlsZCh1dC5mcm9tU3RyaW5nKG4pKTtcbiAgICAgICAgaWYgKCFQdC5pc0RvY3VtZW50S2V5KHMpKSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIHF1ZXJ5LiBXaGVuIHF1ZXJ5aW5nIGEgY29sbGVjdGlvbiBncm91cCBieSBGaWVsZFBhdGguZG9jdW1lbnRJZCgpLCB0aGUgdmFsdWUgcHJvdmlkZWQgbXVzdCByZXN1bHQgaW4gYSB2YWxpZCBkb2N1bWVudCBwYXRoLCBidXQgJyR7c30nIGlzIG5vdCBiZWNhdXNlIGl0IGhhcyBhbiBvZGQgbnVtYmVyIG9mIHNlZ21lbnRzICgke3MubGVuZ3RofSkuYCk7XG4gICAgICAgIHJldHVybiB4dCh0LCBuZXcgUHQocykpO1xuICAgIH1cbiAgICBpZiAobiBpbnN0YW5jZW9mIFRjKSByZXR1cm4geHQodCwgbi5fa2V5KTtcbiAgICB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIHF1ZXJ5LiBXaGVuIHF1ZXJ5aW5nIHdpdGggRmllbGRQYXRoLmRvY3VtZW50SWQoKSwgeW91IG11c3QgcHJvdmlkZSBhIHZhbGlkIHN0cmluZyBvciBhIERvY3VtZW50UmVmZXJlbmNlLCBidXQgaXQgd2FzOiAke19jKG4pfS5gKTtcbn1cblxuLyoqXG4gKiBWYWxpZGF0ZXMgdGhhdCB0aGUgdmFsdWUgcGFzc2VkIGludG8gYSBkaXNqdW5jdGl2ZSBmaWx0ZXIgc2F0aXNmaWVzIGFsbFxuICogYXJyYXkgcmVxdWlyZW1lbnRzLlxuICovIGZ1bmN0aW9uIFp1KHQsIGUpIHtcbiAgICBpZiAoIUFycmF5LmlzQXJyYXkodCkgfHwgMCA9PT0gdC5sZW5ndGgpIHRocm93IG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgYEludmFsaWQgUXVlcnkuIEEgbm9uLWVtcHR5IGFycmF5IGlzIHJlcXVpcmVkIGZvciAnJHtlLnRvU3RyaW5nKCl9JyBmaWx0ZXJzLmApO1xuICAgIGlmICh0Lmxlbmd0aCA+IDEwKSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIFF1ZXJ5LiAnJHtlLnRvU3RyaW5nKCl9JyBmaWx0ZXJzIHN1cHBvcnQgYSBtYXhpbXVtIG9mIDEwIGVsZW1lbnRzIGluIHRoZSB2YWx1ZSBhcnJheS5gKTtcbn1cblxuZnVuY3Rpb24gdGgodCwgZSwgbikge1xuICAgIGlmICghbi5pc0VxdWFsKGUpKSB0aHJvdyBuZXcgSyhxLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIHF1ZXJ5LiBZb3UgaGF2ZSBhIHdoZXJlIGZpbHRlciB3aXRoIGFuIGluZXF1YWxpdHkgKDwsIDw9LCAhPSwgbm90LWluLCA+LCBvciA+PSkgb24gZmllbGQgJyR7ZS50b1N0cmluZygpfScgYW5kIHNvIHlvdSBtdXN0IGFsc28gdXNlICcke2UudG9TdHJpbmcoKX0nIGFzIHlvdXIgZmlyc3QgYXJndW1lbnQgdG8gb3JkZXJCeSgpLCBidXQgeW91ciBmaXJzdCBvcmRlckJ5KCkgaXMgb24gZmllbGQgJyR7bi50b1N0cmluZygpfScgaW5zdGVhZC5gKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQ29udmVydHMgRmlyZXN0b3JlJ3MgaW50ZXJuYWwgdHlwZXMgdG8gdGhlIEphdmFTY3JpcHQgdHlwZXMgdGhhdCB3ZSBleHBvc2VcbiAqIHRvIHRoZSB1c2VyLlxuICpcbiAqIEBpbnRlcm5hbFxuICovIGNsYXNzIGVoIHtcbiAgICBjb252ZXJ0VmFsdWUodCwgZSA9IFwibm9uZVwiKSB7XG4gICAgICAgIHN3aXRjaCAoYnQodCkpIHtcbiAgICAgICAgICBjYXNlIDAgLyogTnVsbFZhbHVlICovIDpcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuXG4gICAgICAgICAgY2FzZSAxIC8qIEJvb2xlYW5WYWx1ZSAqLyA6XG4gICAgICAgICAgICByZXR1cm4gdC5ib29sZWFuVmFsdWU7XG5cbiAgICAgICAgICBjYXNlIDIgLyogTnVtYmVyVmFsdWUgKi8gOlxuICAgICAgICAgICAgcmV0dXJuIGd0KHQuaW50ZWdlclZhbHVlIHx8IHQuZG91YmxlVmFsdWUpO1xuXG4gICAgICAgICAgY2FzZSAzIC8qIFRpbWVzdGFtcFZhbHVlICovIDpcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnRUaW1lc3RhbXAodC50aW1lc3RhbXBWYWx1ZSk7XG5cbiAgICAgICAgICBjYXNlIDQgLyogU2VydmVyVGltZXN0YW1wVmFsdWUgKi8gOlxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29udmVydFNlcnZlclRpbWVzdGFtcCh0LCBlKTtcblxuICAgICAgICAgIGNhc2UgNSAvKiBTdHJpbmdWYWx1ZSAqLyA6XG4gICAgICAgICAgICByZXR1cm4gdC5zdHJpbmdWYWx1ZTtcblxuICAgICAgICAgIGNhc2UgNiAvKiBCbG9iVmFsdWUgKi8gOlxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29udmVydEJ5dGVzKHl0KHQuYnl0ZXNWYWx1ZSkpO1xuXG4gICAgICAgICAgY2FzZSA3IC8qIFJlZlZhbHVlICovIDpcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnRSZWZlcmVuY2UodC5yZWZlcmVuY2VWYWx1ZSk7XG5cbiAgICAgICAgICBjYXNlIDggLyogR2VvUG9pbnRWYWx1ZSAqLyA6XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJ0R2VvUG9pbnQodC5nZW9Qb2ludFZhbHVlKTtcblxuICAgICAgICAgIGNhc2UgOSAvKiBBcnJheVZhbHVlICovIDpcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnRBcnJheSh0LmFycmF5VmFsdWUsIGUpO1xuXG4gICAgICAgICAgY2FzZSAxMCAvKiBPYmplY3RWYWx1ZSAqLyA6XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJ0T2JqZWN0KHQubWFwVmFsdWUsIGUpO1xuXG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHRocm93IE0oKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb252ZXJ0T2JqZWN0KHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHt9O1xuICAgICAgICByZXR1cm4gb3QodC5maWVsZHMsICgodCwgcykgPT4ge1xuICAgICAgICAgICAgblt0XSA9IHRoaXMuY29udmVydFZhbHVlKHMsIGUpO1xuICAgICAgICB9KSksIG47XG4gICAgfVxuICAgIGNvbnZlcnRHZW9Qb2ludCh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgWmMoZ3QodC5sYXRpdHVkZSksIGd0KHQubG9uZ2l0dWRlKSk7XG4gICAgfVxuICAgIGNvbnZlcnRBcnJheSh0LCBlKSB7XG4gICAgICAgIHJldHVybiAodC52YWx1ZXMgfHwgW10pLm1hcCgodCA9PiB0aGlzLmNvbnZlcnRWYWx1ZSh0LCBlKSkpO1xuICAgIH1cbiAgICBjb252ZXJ0U2VydmVyVGltZXN0YW1wKHQsIGUpIHtcbiAgICAgICAgc3dpdGNoIChlKSB7XG4gICAgICAgICAgY2FzZSBcInByZXZpb3VzXCI6XG4gICAgICAgICAgICBjb25zdCBuID0gRXQodCk7XG4gICAgICAgICAgICByZXR1cm4gbnVsbCA9PSBuID8gbnVsbCA6IHRoaXMuY29udmVydFZhbHVlKG4sIGUpO1xuXG4gICAgICAgICAgY2FzZSBcImVzdGltYXRlXCI6XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJ0VGltZXN0YW1wKFR0KHQpKTtcblxuICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb252ZXJ0VGltZXN0YW1wKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IG10KHQpO1xuICAgICAgICByZXR1cm4gbmV3IHN0KGUuc2Vjb25kcywgZS5uYW5vcyk7XG4gICAgfVxuICAgIGNvbnZlcnREb2N1bWVudEtleSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSB1dC5mcm9tU3RyaW5nKHQpO1xuICAgICAgICBMKHBzKG4pKTtcbiAgICAgICAgY29uc3QgcyA9IG5ldyB1YyhuLmdldCgxKSwgbi5nZXQoMykpLCBpID0gbmV3IFB0KG4ucG9wRmlyc3QoNSkpO1xuICAgICAgICByZXR1cm4gcy5pc0VxdWFsKGUpIHx8IFxuICAgICAgICAvLyBUT0RPKGIvNjQxMzAyMDIpOiBTb21laG93IHN1cHBvcnQgZm9yZWlnbiByZWZlcmVuY2VzLlxuICAgICAgICAkKGBEb2N1bWVudCAke2l9IGNvbnRhaW5zIGEgZG9jdW1lbnQgcmVmZXJlbmNlIHdpdGhpbiBhIGRpZmZlcmVudCBkYXRhYmFzZSAoJHtzLnByb2plY3RJZH0vJHtzLmRhdGFiYXNlfSkgd2hpY2ggaXMgbm90IHN1cHBvcnRlZC4gSXQgd2lsbCBiZSB0cmVhdGVkIGFzIGEgcmVmZXJlbmNlIGluIHRoZSBjdXJyZW50IGRhdGFiYXNlICgke2UucHJvamVjdElkfS8ke2UuZGF0YWJhc2V9KSBpbnN0ZWFkLmApLCBcbiAgICAgICAgaTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIENvbnZlcnRzIGN1c3RvbSBtb2RlbCBvYmplY3Qgb2YgdHlwZSBUIGludG8gYERvY3VtZW50RGF0YWAgYnkgYXBwbHlpbmcgdGhlXG4gKiBjb252ZXJ0ZXIgaWYgaXQgZXhpc3RzLlxuICpcbiAqIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCB3aGVuIGNvbnZlcnRpbmcgdXNlciBvYmplY3RzIHRvIGBEb2N1bWVudERhdGFgXG4gKiBiZWNhdXNlIHdlIHdhbnQgdG8gcHJvdmlkZSB0aGUgdXNlciB3aXRoIGEgbW9yZSBzcGVjaWZpYyBlcnJvciBtZXNzYWdlIGlmXG4gKiB0aGVpciBgc2V0KClgIG9yIGZhaWxzIGR1ZSB0byBpbnZhbGlkIGRhdGEgb3JpZ2luYXRpbmcgZnJvbSBhIGB0b0ZpcmVzdG9yZSgpYFxuICogY2FsbC5cbiAqLyBmdW5jdGlvbiBuaCh0LCBlLCBuKSB7XG4gICAgbGV0IHM7XG4gICAgLy8gQ2FzdCB0byBgYW55YCBpbiBvcmRlciB0byBzYXRpc2Z5IHRoZSB1bmlvbiB0eXBlIGNvbnN0cmFpbnQgb25cbiAgICAvLyB0b0ZpcmVzdG9yZSgpLlxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgcmV0dXJuIHMgPSB0ID8gbiAmJiAobi5tZXJnZSB8fCBuLm1lcmdlRmllbGRzKSA/IHQudG9GaXJlc3RvcmUoZSwgbikgOiB0LnRvRmlyZXN0b3JlKGUpIDogZSwgXG4gICAgcztcbn1cblxuY2xhc3Mgc2ggZXh0ZW5kcyBlaCB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICBzdXBlcigpLCB0aGlzLmZpcmVzdG9yZSA9IHQ7XG4gICAgfVxuICAgIGNvbnZlcnRCeXRlcyh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgWWModCk7XG4gICAgfVxuICAgIGNvbnZlcnRSZWZlcmVuY2UodCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5jb252ZXJ0RG9jdW1lbnRLZXkodCwgdGhpcy5maXJlc3RvcmUuX2RhdGFiYXNlSWQpO1xuICAgICAgICByZXR1cm4gbmV3IFRjKHRoaXMuZmlyZXN0b3JlLCAvKiBjb252ZXJ0ZXI9ICovIG51bGwsIGUpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSB3cml0ZSBiYXRjaCwgdXNlZCB0byBwZXJmb3JtIG11bHRpcGxlIHdyaXRlcyBhcyBhIHNpbmdsZSBhdG9taWMgdW5pdC5cbiAqXG4gKiBBIGBXcml0ZUJhdGNoYCBvYmplY3QgY2FuIGJlIGFjcXVpcmVkIGJ5IGNhbGxpbmcge0BsaW5rIHdyaXRlQmF0Y2h9LiBJdFxuICogcHJvdmlkZXMgbWV0aG9kcyBmb3IgYWRkaW5nIHdyaXRlcyB0byB0aGUgd3JpdGUgYmF0Y2guIE5vbmUgb2YgdGhlIHdyaXRlc1xuICogd2lsbCBiZSBjb21taXR0ZWQgKG9yIHZpc2libGUgbG9jYWxseSkgdW50aWwge0BsaW5rIFdyaXRlQmF0Y2guY29tbWl0fSBpc1xuICogY2FsbGVkLlxuICovIGNsYXNzIGloIHtcbiAgICAvKiogQGhpZGVjb25zdHJ1Y3RvciAqL1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5fZmlyZXN0b3JlID0gdCwgdGhpcy5fY29tbWl0SGFuZGxlciA9IGUsIHRoaXMuX211dGF0aW9ucyA9IFtdLCB0aGlzLl9jb21taXR0ZWQgPSAhMSwgXG4gICAgICAgIHRoaXMuX2RhdGFSZWFkZXIgPSBvdSh0KTtcbiAgICB9XG4gICAgc2V0KHQsIGUsIG4pIHtcbiAgICAgICAgdGhpcy5fdmVyaWZ5Tm90Q29tbWl0dGVkKCk7XG4gICAgICAgIGNvbnN0IHMgPSByaCh0LCB0aGlzLl9maXJlc3RvcmUpLCBpID0gbmgocy5jb252ZXJ0ZXIsIGUsIG4pLCByID0gYXUodGhpcy5fZGF0YVJlYWRlciwgXCJXcml0ZUJhdGNoLnNldFwiLCBzLl9rZXksIGksIG51bGwgIT09IHMuY29udmVydGVyLCBuKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX211dGF0aW9ucy5wdXNoKHIudG9NdXRhdGlvbihzLl9rZXksIFdlLm5vbmUoKSkpLCB0aGlzO1xuICAgIH1cbiAgICB1cGRhdGUodCwgZSwgbiwgLi4ucykge1xuICAgICAgICB0aGlzLl92ZXJpZnlOb3RDb21taXR0ZWQoKTtcbiAgICAgICAgY29uc3QgaSA9IHJoKHQsIHRoaXMuX2ZpcmVzdG9yZSk7XG4gICAgICAgIC8vIEZvciBDb21wYXQgdHlwZXMsIHdlIGhhdmUgdG8gXCJleHRyYWN0XCIgdGhlIHVuZGVybHlpbmcgdHlwZXMgYmVmb3JlXG4gICAgICAgIC8vIHBlcmZvcm1pbmcgdmFsaWRhdGlvbi5cbiAgICAgICAgICAgICAgICBsZXQgcjtcbiAgICAgICAgcmV0dXJuIHIgPSBcInN0cmluZ1wiID09IHR5cGVvZiAoZSA9IHkoZSkpIHx8IGUgaW5zdGFuY2VvZiBIYyA/IF91KHRoaXMuX2RhdGFSZWFkZXIsIFwiV3JpdGVCYXRjaC51cGRhdGVcIiwgaS5fa2V5LCBlLCBuLCBzKSA6IHd1KHRoaXMuX2RhdGFSZWFkZXIsIFwiV3JpdGVCYXRjaC51cGRhdGVcIiwgaS5fa2V5LCBlKSwgXG4gICAgICAgIHRoaXMuX211dGF0aW9ucy5wdXNoKHIudG9NdXRhdGlvbihpLl9rZXksIFdlLmV4aXN0cyghMCkpKSwgdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogRGVsZXRlcyB0aGUgZG9jdW1lbnQgcmVmZXJyZWQgdG8gYnkgdGhlIHByb3ZpZGVkIHtAbGluayBEb2N1bWVudFJlZmVyZW5jZX0uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZG9jdW1lbnRSZWYgLSBBIHJlZmVyZW5jZSB0byB0aGUgZG9jdW1lbnQgdG8gYmUgZGVsZXRlZC5cbiAgICAgKiBAcmV0dXJucyBUaGlzIGBXcml0ZUJhdGNoYCBpbnN0YW5jZS4gVXNlZCBmb3IgY2hhaW5pbmcgbWV0aG9kIGNhbGxzLlxuICAgICAqLyAgICBkZWxldGUodCkge1xuICAgICAgICB0aGlzLl92ZXJpZnlOb3RDb21taXR0ZWQoKTtcbiAgICAgICAgY29uc3QgZSA9IHJoKHQsIHRoaXMuX2ZpcmVzdG9yZSk7XG4gICAgICAgIHJldHVybiB0aGlzLl9tdXRhdGlvbnMgPSB0aGlzLl9tdXRhdGlvbnMuY29uY2F0KG5ldyBvbihlLl9rZXksIFdlLm5vbmUoKSkpLCB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb21taXRzIGFsbCBvZiB0aGUgd3JpdGVzIGluIHRoaXMgd3JpdGUgYmF0Y2ggYXMgYSBzaW5nbGUgYXRvbWljIHVuaXQuXG4gICAgICpcbiAgICAgKiBUaGUgcmVzdWx0IG9mIHRoZXNlIHdyaXRlcyB3aWxsIG9ubHkgYmUgcmVmbGVjdGVkIGluIGRvY3VtZW50IHJlYWRzIHRoYXRcbiAgICAgKiBvY2N1ciBhZnRlciB0aGUgcmV0dXJuZWQgcHJvbWlzZSByZXNvbHZlcy4gSWYgdGhlIGNsaWVudCBpcyBvZmZsaW5lLCB0aGVcbiAgICAgKiB3cml0ZSBmYWlscy4gSWYgeW91IHdvdWxkIGxpa2UgdG8gc2VlIGxvY2FsIG1vZGlmaWNhdGlvbnMgb3IgYnVmZmVyIHdyaXRlc1xuICAgICAqIHVudGlsIHRoZSBjbGllbnQgaXMgb25saW5lLCB1c2UgdGhlIGZ1bGwgRmlyZXN0b3JlIFNESy5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIEEgYFByb21pc2VgIHJlc29sdmVkIG9uY2UgYWxsIG9mIHRoZSB3cml0ZXMgaW4gdGhlIGJhdGNoIGhhdmUgYmVlblxuICAgICAqIHN1Y2Nlc3NmdWxseSB3cml0dGVuIHRvIHRoZSBiYWNrZW5kIGFzIGFuIGF0b21pYyB1bml0IChub3RlIHRoYXQgaXQgd29uJ3RcbiAgICAgKiByZXNvbHZlIHdoaWxlIHlvdSdyZSBvZmZsaW5lKS5cbiAgICAgKi8gICAgY29tbWl0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdmVyaWZ5Tm90Q29tbWl0dGVkKCksIHRoaXMuX2NvbW1pdHRlZCA9ICEwLCB0aGlzLl9tdXRhdGlvbnMubGVuZ3RoID4gMCA/IHRoaXMuX2NvbW1pdEhhbmRsZXIodGhpcy5fbXV0YXRpb25zKSA6IFByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cbiAgICBfdmVyaWZ5Tm90Q29tbWl0dGVkKCkge1xuICAgICAgICBpZiAodGhpcy5fY29tbWl0dGVkKSB0aHJvdyBuZXcgSyhxLkZBSUxFRF9QUkVDT05ESVRJT04sIFwiQSB3cml0ZSBiYXRjaCBjYW4gbm8gbG9uZ2VyIGJlIHVzZWQgYWZ0ZXIgY29tbWl0KCkgaGFzIGJlZW4gY2FsbGVkLlwiKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHJoKHQsIGUpIHtcbiAgICBpZiAoKHQgPSB5KHQpKS5maXJlc3RvcmUgIT09IGUpIHRocm93IG5ldyBLKHEuSU5WQUxJRF9BUkdVTUVOVCwgXCJQcm92aWRlZCBkb2N1bWVudCByZWZlcmVuY2UgaXMgZnJvbSBhIGRpZmZlcmVudCBGaXJlc3RvcmUgaW5zdGFuY2UuXCIpO1xuICAgIHJldHVybiB0O1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLy8gVE9ETyhtcnNjaG1pZHQpIENvbnNpZGVyIHVzaW5nIGBCYXNlVHJhbnNhY3Rpb25gIGFzIHRoZSBiYXNlIGNsYXNzIGluIHRoZVxuLy8gbGVnYWN5IFNESy5cbi8qKlxuICogQSByZWZlcmVuY2UgdG8gYSB0cmFuc2FjdGlvbi5cbiAqXG4gKiBUaGUgYFRyYW5zYWN0aW9uYCBvYmplY3QgcGFzc2VkIHRvIGEgdHJhbnNhY3Rpb24ncyBgdXBkYXRlRnVuY3Rpb25gIHByb3ZpZGVzXG4gKiB0aGUgbWV0aG9kcyB0byByZWFkIGFuZCB3cml0ZSBkYXRhIHdpdGhpbiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dC4gU2VlXG4gKiB7QGxpbmsgcnVuVHJhbnNhY3Rpb259LlxuICovXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBSZWFkcyB0aGUgZG9jdW1lbnQgcmVmZXJyZWQgdG8gYnkgdGhpcyBgRG9jdW1lbnRSZWZlcmVuY2VgLlxuICpcbiAqIE5vdGU6IGBnZXREb2MoKWAgYXR0ZW1wdHMgdG8gcHJvdmlkZSB1cC10by1kYXRlIGRhdGEgd2hlbiBwb3NzaWJsZSBieSB3YWl0aW5nXG4gKiBmb3IgZGF0YSBmcm9tIHRoZSBzZXJ2ZXIsIGJ1dCBpdCBtYXkgcmV0dXJuIGNhY2hlZCBkYXRhIG9yIGZhaWwgaWYgeW91IGFyZVxuICogb2ZmbGluZSBhbmQgdGhlIHNlcnZlciBjYW5ub3QgYmUgcmVhY2hlZC4gVG8gc3BlY2lmeSB0aGlzIGJlaGF2aW9yLCBpbnZva2VcbiAqIHtAbGluayBnZXREb2NGcm9tQ2FjaGV9IG9yIHtAbGluayBnZXREb2NGcm9tU2VydmVyfS5cbiAqXG4gKiBAcGFyYW0gcmVmZXJlbmNlIC0gVGhlIHJlZmVyZW5jZSBvZiB0aGUgZG9jdW1lbnQgdG8gZmV0Y2guXG4gKiBAcmV0dXJucyBBIFByb21pc2UgcmVzb2x2ZWQgd2l0aCBhIGBEb2N1bWVudFNuYXBzaG90YCBjb250YWluaW5nIHRoZVxuICogY3VycmVudCBkb2N1bWVudCBjb250ZW50cy5cbiAqL1xuZnVuY3Rpb24gb2godCkge1xuICAgIHQgPSBtYyh0LCBUYyk7XG4gICAgY29uc3QgZSA9IG1jKHQuZmlyZXN0b3JlLCB4Yyk7XG4gICAgcmV0dXJuIGVjKE9jKGUpLCB0Ll9rZXkpLnRoZW4oKG4gPT4gRWgoZSwgdCwgbikpKTtcbn1cblxuY2xhc3MgYWggZXh0ZW5kcyBlaCB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICBzdXBlcigpLCB0aGlzLmZpcmVzdG9yZSA9IHQ7XG4gICAgfVxuICAgIGNvbnZlcnRCeXRlcyh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgWWModCk7XG4gICAgfVxuICAgIGNvbnZlcnRSZWZlcmVuY2UodCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5jb252ZXJ0RG9jdW1lbnRLZXkodCwgdGhpcy5maXJlc3RvcmUuX2RhdGFiYXNlSWQpO1xuICAgICAgICByZXR1cm4gbmV3IFRjKHRoaXMuZmlyZXN0b3JlLCAvKiBjb252ZXJ0ZXI9ICovIG51bGwsIGUpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBSZWFkcyB0aGUgZG9jdW1lbnQgcmVmZXJyZWQgdG8gYnkgdGhpcyBgRG9jdW1lbnRSZWZlcmVuY2VgIGZyb20gY2FjaGUuXG4gKiBSZXR1cm5zIGFuIGVycm9yIGlmIHRoZSBkb2N1bWVudCBpcyBub3QgY3VycmVudGx5IGNhY2hlZC5cbiAqXG4gKiBAcmV0dXJucyBBIGBQcm9taXNlYCByZXNvbHZlZCB3aXRoIGEgYERvY3VtZW50U25hcHNob3RgIGNvbnRhaW5pbmcgdGhlXG4gKiBjdXJyZW50IGRvY3VtZW50IGNvbnRlbnRzLlxuICovIGZ1bmN0aW9uIGNoKHQpIHtcbiAgICB0ID0gbWModCwgVGMpO1xuICAgIGNvbnN0IGUgPSBtYyh0LmZpcmVzdG9yZSwgeGMpLCBuID0gT2MoZSksIHMgPSBuZXcgYWgoZSk7XG4gICAgcmV0dXJuIHRjKG4sIHQuX2tleSkudGhlbigobiA9PiBuZXcgRHUoZSwgcywgdC5fa2V5LCBuLCBuZXcgU3UobnVsbCAhPT0gbiAmJiBuLmhhc0xvY2FsTXV0YXRpb25zLCBcbiAgICAvKiBmcm9tQ2FjaGU9ICovICEwKSwgdC5jb252ZXJ0ZXIpKSk7XG59XG5cbi8qKlxuICogUmVhZHMgdGhlIGRvY3VtZW50IHJlZmVycmVkIHRvIGJ5IHRoaXMgYERvY3VtZW50UmVmZXJlbmNlYCBmcm9tIHRoZSBzZXJ2ZXIuXG4gKiBSZXR1cm5zIGFuIGVycm9yIGlmIHRoZSBuZXR3b3JrIGlzIG5vdCBhdmFpbGFibGUuXG4gKlxuICogQHJldHVybnMgQSBgUHJvbWlzZWAgcmVzb2x2ZWQgd2l0aCBhIGBEb2N1bWVudFNuYXBzaG90YCBjb250YWluaW5nIHRoZVxuICogY3VycmVudCBkb2N1bWVudCBjb250ZW50cy5cbiAqLyBmdW5jdGlvbiB1aCh0KSB7XG4gICAgdCA9IG1jKHQsIFRjKTtcbiAgICBjb25zdCBlID0gbWModC5maXJlc3RvcmUsIHhjKTtcbiAgICByZXR1cm4gZWMoT2MoZSksIHQuX2tleSwge1xuICAgICAgICBzb3VyY2U6IFwic2VydmVyXCJcbiAgICB9KS50aGVuKChuID0+IEVoKGUsIHQsIG4pKSk7XG59XG5cbi8qKlxuICogRXhlY3V0ZXMgdGhlIHF1ZXJ5IGFuZCByZXR1cm5zIHRoZSByZXN1bHRzIGFzIGEgYFF1ZXJ5U25hcHNob3RgLlxuICpcbiAqIE5vdGU6IGBnZXREb2NzKClgIGF0dGVtcHRzIHRvIHByb3ZpZGUgdXAtdG8tZGF0ZSBkYXRhIHdoZW4gcG9zc2libGUgYnlcbiAqIHdhaXRpbmcgZm9yIGRhdGEgZnJvbSB0aGUgc2VydmVyLCBidXQgaXQgbWF5IHJldHVybiBjYWNoZWQgZGF0YSBvciBmYWlsIGlmXG4gKiB5b3UgYXJlIG9mZmxpbmUgYW5kIHRoZSBzZXJ2ZXIgY2Fubm90IGJlIHJlYWNoZWQuIFRvIHNwZWNpZnkgdGhpcyBiZWhhdmlvcixcbiAqIGludm9rZSB7QGxpbmsgZ2V0RG9jc0Zyb21DYWNoZX0gb3Ige0BsaW5rIGdldERvY3NGcm9tU2VydmVyfS5cbiAqXG4gKiBAcmV0dXJucyBBIGBQcm9taXNlYCB0aGF0IHdpbGwgYmUgcmVzb2x2ZWQgd2l0aCB0aGUgcmVzdWx0cyBvZiB0aGUgcXVlcnkuXG4gKi8gZnVuY3Rpb24gaGgodCkge1xuICAgIHQgPSBtYyh0LCBJYyk7XG4gICAgY29uc3QgZSA9IG1jKHQuZmlyZXN0b3JlLCB4YyksIG4gPSBPYyhlKSwgcyA9IG5ldyBhaChlKTtcbiAgICByZXR1cm4gJHUodC5fcXVlcnkpLCBzYyhuLCB0Ll9xdWVyeSkudGhlbigobiA9PiBuZXcgTnUoZSwgcywgdCwgbikpKTtcbn1cblxuLyoqXG4gKiBFeGVjdXRlcyB0aGUgcXVlcnkgYW5kIHJldHVybnMgdGhlIHJlc3VsdHMgYXMgYSBgUXVlcnlTbmFwc2hvdGAgZnJvbSBjYWNoZS5cbiAqIFJldHVybnMgYW4gZXJyb3IgaWYgdGhlIGRvY3VtZW50IGlzIG5vdCBjdXJyZW50bHkgY2FjaGVkLlxuICpcbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHRoYXQgd2lsbCBiZSByZXNvbHZlZCB3aXRoIHRoZSByZXN1bHRzIG9mIHRoZSBxdWVyeS5cbiAqLyBmdW5jdGlvbiBsaCh0KSB7XG4gICAgdCA9IG1jKHQsIEljKTtcbiAgICBjb25zdCBlID0gbWModC5maXJlc3RvcmUsIHhjKSwgbiA9IE9jKGUpLCBzID0gbmV3IGFoKGUpO1xuICAgIHJldHVybiBuYyhuLCB0Ll9xdWVyeSkudGhlbigobiA9PiBuZXcgTnUoZSwgcywgdCwgbikpKTtcbn1cblxuLyoqXG4gKiBFeGVjdXRlcyB0aGUgcXVlcnkgYW5kIHJldHVybnMgdGhlIHJlc3VsdHMgYXMgYSBgUXVlcnlTbmFwc2hvdGAgZnJvbSB0aGVcbiAqIHNlcnZlci4gUmV0dXJucyBhbiBlcnJvciBpZiB0aGUgbmV0d29yayBpcyBub3QgYXZhaWxhYmxlLlxuICpcbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHRoYXQgd2lsbCBiZSByZXNvbHZlZCB3aXRoIHRoZSByZXN1bHRzIG9mIHRoZSBxdWVyeS5cbiAqLyBmdW5jdGlvbiBmaCh0KSB7XG4gICAgdCA9IG1jKHQsIEljKTtcbiAgICBjb25zdCBlID0gbWModC5maXJlc3RvcmUsIHhjKSwgbiA9IE9jKGUpLCBzID0gbmV3IGFoKGUpO1xuICAgIHJldHVybiBzYyhuLCB0Ll9xdWVyeSwge1xuICAgICAgICBzb3VyY2U6IFwic2VydmVyXCJcbiAgICB9KS50aGVuKChuID0+IG5ldyBOdShlLCBzLCB0LCBuKSkpO1xufVxuXG5mdW5jdGlvbiBkaCh0LCBlLCBuKSB7XG4gICAgdCA9IG1jKHQsIFRjKTtcbiAgICBjb25zdCBzID0gbWModC5maXJlc3RvcmUsIHhjKSwgaSA9IG5oKHQuY29udmVydGVyLCBlLCBuKTtcbiAgICByZXR1cm4gcGgocywgWyBhdShvdShzKSwgXCJzZXREb2NcIiwgdC5fa2V5LCBpLCBudWxsICE9PSB0LmNvbnZlcnRlciwgbikudG9NdXRhdGlvbih0Ll9rZXksIFdlLm5vbmUoKSkgXSk7XG59XG5cbmZ1bmN0aW9uIHdoKHQsIGUsIG4sIC4uLnMpIHtcbiAgICB0ID0gbWModCwgVGMpO1xuICAgIGNvbnN0IGkgPSBtYyh0LmZpcmVzdG9yZSwgeGMpLCByID0gb3UoaSk7XG4gICAgbGV0IG87XG4gICAgbyA9IFwic3RyaW5nXCIgPT0gdHlwZW9mIChcbiAgICAvLyBGb3IgQ29tcGF0IHR5cGVzLCB3ZSBoYXZlIHRvIFwiZXh0cmFjdFwiIHRoZSB1bmRlcmx5aW5nIHR5cGVzIGJlZm9yZVxuICAgIC8vIHBlcmZvcm1pbmcgdmFsaWRhdGlvbi5cbiAgICBlID0geShlKSkgfHwgZSBpbnN0YW5jZW9mIEhjID8gX3UociwgXCJ1cGRhdGVEb2NcIiwgdC5fa2V5LCBlLCBuLCBzKSA6IHd1KHIsIFwidXBkYXRlRG9jXCIsIHQuX2tleSwgZSk7XG4gICAgcmV0dXJuIHBoKGksIFsgby50b011dGF0aW9uKHQuX2tleSwgV2UuZXhpc3RzKCEwKSkgXSk7XG59XG5cbi8qKlxuICogRGVsZXRlcyB0aGUgZG9jdW1lbnQgcmVmZXJyZWQgdG8gYnkgdGhlIHNwZWNpZmllZCBgRG9jdW1lbnRSZWZlcmVuY2VgLlxuICpcbiAqIEBwYXJhbSByZWZlcmVuY2UgLSBBIHJlZmVyZW5jZSB0byB0aGUgZG9jdW1lbnQgdG8gZGVsZXRlLlxuICogQHJldHVybnMgQSBQcm9taXNlIHJlc29sdmVkIG9uY2UgdGhlIGRvY3VtZW50IGhhcyBiZWVuIHN1Y2Nlc3NmdWxseVxuICogZGVsZXRlZCBmcm9tIHRoZSBiYWNrZW5kIChub3RlIHRoYXQgaXQgd29uJ3QgcmVzb2x2ZSB3aGlsZSB5b3UncmUgb2ZmbGluZSkuXG4gKi8gZnVuY3Rpb24gX2godCkge1xuICAgIHJldHVybiBwaChtYyh0LmZpcmVzdG9yZSwgeGMpLCBbIG5ldyBvbih0Ll9rZXksIFdlLm5vbmUoKSkgXSk7XG59XG5cbi8qKlxuICogQWRkIGEgbmV3IGRvY3VtZW50IHRvIHNwZWNpZmllZCBgQ29sbGVjdGlvblJlZmVyZW5jZWAgd2l0aCB0aGUgZ2l2ZW4gZGF0YSxcbiAqIGFzc2lnbmluZyBpdCBhIGRvY3VtZW50IElEIGF1dG9tYXRpY2FsbHkuXG4gKlxuICogQHBhcmFtIHJlZmVyZW5jZSAtIEEgcmVmZXJlbmNlIHRvIHRoZSBjb2xsZWN0aW9uIHRvIGFkZCB0aGlzIGRvY3VtZW50IHRvLlxuICogQHBhcmFtIGRhdGEgLSBBbiBPYmplY3QgY29udGFpbmluZyB0aGUgZGF0YSBmb3IgdGhlIG5ldyBkb2N1bWVudC5cbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHJlc29sdmVkIHdpdGggYSBgRG9jdW1lbnRSZWZlcmVuY2VgIHBvaW50aW5nIHRvIHRoZVxuICogbmV3bHkgY3JlYXRlZCBkb2N1bWVudCBhZnRlciBpdCBoYXMgYmVlbiB3cml0dGVuIHRvIHRoZSBiYWNrZW5kIChOb3RlIHRoYXQgaXRcbiAqIHdvbid0IHJlc29sdmUgd2hpbGUgeW91J3JlIG9mZmxpbmUpLlxuICovIGZ1bmN0aW9uIG1oKHQsIGUpIHtcbiAgICBjb25zdCBuID0gbWModC5maXJlc3RvcmUsIHhjKSwgcyA9IGJjKHQpLCBpID0gbmgodC5jb252ZXJ0ZXIsIGUpO1xuICAgIHJldHVybiBwaChuLCBbIGF1KG91KHQuZmlyZXN0b3JlKSwgXCJhZGREb2NcIiwgcy5fa2V5LCBpLCBudWxsICE9PSB0LmNvbnZlcnRlciwge30pLnRvTXV0YXRpb24ocy5fa2V5LCBXZS5leGlzdHMoITEpKSBdKS50aGVuKCgoKSA9PiBzKSk7XG59XG5cbmZ1bmN0aW9uIGdoKHQsIC4uLmUpIHtcbiAgICB2YXIgbiwgcywgaTtcbiAgICB0ID0geSh0KTtcbiAgICBsZXQgciA9IHtcbiAgICAgICAgaW5jbHVkZU1ldGFkYXRhQ2hhbmdlczogITFcbiAgICB9LCBvID0gMDtcbiAgICBcIm9iamVjdFwiICE9IHR5cGVvZiBlW29dIHx8IERjKGVbb10pIHx8IChyID0gZVtvXSwgbysrKTtcbiAgICBjb25zdCBhID0ge1xuICAgICAgICBpbmNsdWRlTWV0YWRhdGFDaGFuZ2VzOiByLmluY2x1ZGVNZXRhZGF0YUNoYW5nZXNcbiAgICB9O1xuICAgIGlmIChEYyhlW29dKSkge1xuICAgICAgICBjb25zdCB0ID0gZVtvXTtcbiAgICAgICAgZVtvXSA9IG51bGwgPT09IChuID0gdC5uZXh0KSB8fCB2b2lkIDAgPT09IG4gPyB2b2lkIDAgOiBuLmJpbmQodCksIGVbbyArIDFdID0gbnVsbCA9PT0gKHMgPSB0LmVycm9yKSB8fCB2b2lkIDAgPT09IHMgPyB2b2lkIDAgOiBzLmJpbmQodCksIFxuICAgICAgICBlW28gKyAyXSA9IG51bGwgPT09IChpID0gdC5jb21wbGV0ZSkgfHwgdm9pZCAwID09PSBpID8gdm9pZCAwIDogaS5iaW5kKHQpO1xuICAgIH1cbiAgICBsZXQgYywgdSwgaDtcbiAgICBpZiAodCBpbnN0YW5jZW9mIFRjKSB1ID0gbWModC5maXJlc3RvcmUsIHhjKSwgaCA9IGRlKHQuX2tleS5wYXRoKSwgYyA9IHtcbiAgICAgICAgbmV4dDogbiA9PiB7XG4gICAgICAgICAgICBlW29dICYmIGVbb10oRWgodSwgdCwgbikpO1xuICAgICAgICB9LFxuICAgICAgICBlcnJvcjogZVtvICsgMV0sXG4gICAgICAgIGNvbXBsZXRlOiBlW28gKyAyXVxuICAgIH07IGVsc2Uge1xuICAgICAgICBjb25zdCBuID0gbWModCwgSWMpO1xuICAgICAgICB1ID0gbWMobi5maXJlc3RvcmUsIHhjKSwgaCA9IG4uX3F1ZXJ5O1xuICAgICAgICBjb25zdCBzID0gbmV3IGFoKHUpO1xuICAgICAgICBjID0ge1xuICAgICAgICAgICAgbmV4dDogdCA9PiB7XG4gICAgICAgICAgICAgICAgZVtvXSAmJiBlW29dKG5ldyBOdSh1LCBzLCBuLCB0KSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZXJyb3I6IGVbbyArIDFdLFxuICAgICAgICAgICAgY29tcGxldGU6IGVbbyArIDJdXG4gICAgICAgIH0sICR1KHQuX3F1ZXJ5KTtcbiAgICB9XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgY29uc3QgaSA9IG5ldyBNYShzKSwgciA9IG5ldyBqbyhlLCBpLCBuKTtcbiAgICAgICAgcmV0dXJuIHQuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KChhc3luYyAoKSA9PiBMbyhhd2FpdCBZYSh0KSwgcikpKSwgKCkgPT4ge1xuICAgICAgICAgICAgaS5YbygpLCB0LmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldCgoYXN5bmMgKCkgPT4gQm8oYXdhaXQgWWEodCksIHIpKSk7XG4gICAgICAgIH07XG4gICAgfShPYyh1KSwgaCwgYSwgYyk7XG59XG5cbmZ1bmN0aW9uIHloKHQsIGUpIHtcbiAgICByZXR1cm4gaWMoT2ModCA9IG1jKHQsIHhjKSksIERjKGUpID8gZSA6IHtcbiAgICAgICAgbmV4dDogZVxuICAgIH0pO1xufVxuXG4vKipcbiAqIExvY2FsbHkgd3JpdGVzIGBtdXRhdGlvbnNgIG9uIHRoZSBhc3luYyBxdWV1ZS5cbiAqIEBpbnRlcm5hbFxuICovIGZ1bmN0aW9uIHBoKHQsIGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBjb25zdCBuID0gbmV3IGo7XG4gICAgICAgIHJldHVybiB0LmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldCgoYXN5bmMgKCkgPT4gaWEoYXdhaXQgSmEodCksIGUsIG4pKSksIG4ucHJvbWlzZTtcbiAgICB9KE9jKHQpLCBlKTtcbn1cblxuLyoqXG4gKiBDb252ZXJ0cyBhIHtAbGluayBWaWV3U25hcHNob3R9IHRoYXQgY29udGFpbnMgdGhlIHNpbmdsZSBkb2N1bWVudCBzcGVjaWZpZWQgYnkgYHJlZmBcbiAqIHRvIGEge0BsaW5rIERvY3VtZW50U25hcHNob3R9LlxuICovIGZ1bmN0aW9uIEVoKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gbi5kb2NzLmdldChlLl9rZXkpLCBpID0gbmV3IGFoKHQpO1xuICAgIHJldHVybiBuZXcgRHUodCwgaSwgZS5fa2V5LCBzLCBuZXcgU3Uobi5oYXNQZW5kaW5nV3JpdGVzLCBuLmZyb21DYWNoZSksIGUuY29udmVydGVyKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSByZWZlcmVuY2UgdG8gYSB0cmFuc2FjdGlvbi5cbiAqXG4gKiBUaGUgYFRyYW5zYWN0aW9uYCBvYmplY3QgcGFzc2VkIHRvIGEgdHJhbnNhY3Rpb24ncyBgdXBkYXRlRnVuY3Rpb25gIHByb3ZpZGVzXG4gKiB0aGUgbWV0aG9kcyB0byByZWFkIGFuZCB3cml0ZSBkYXRhIHdpdGhpbiB0aGUgdHJhbnNhY3Rpb24gY29udGV4dC4gU2VlXG4gKiB7QGxpbmsgcnVuVHJhbnNhY3Rpb259LlxuICovIGNsYXNzIFRoIGV4dGVuZHMgY2xhc3Mge1xuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yICovXG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLl9maXJlc3RvcmUgPSB0LCB0aGlzLl90cmFuc2FjdGlvbiA9IGUsIHRoaXMuX2RhdGFSZWFkZXIgPSBvdSh0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVhZHMgdGhlIGRvY3VtZW50IHJlZmVyZW5jZWQgYnkgdGhlIHByb3ZpZGVkIHtAbGluayBEb2N1bWVudFJlZmVyZW5jZX0uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZG9jdW1lbnRSZWYgLSBBIHJlZmVyZW5jZSB0byB0aGUgZG9jdW1lbnQgdG8gYmUgcmVhZC5cbiAgICAgKiBAcmV0dXJucyBBIGBEb2N1bWVudFNuYXBzaG90YCB3aXRoIHRoZSByZWFkIGRhdGEuXG4gICAgICovICAgIGdldCh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSByaCh0LCB0aGlzLl9maXJlc3RvcmUpLCBuID0gbmV3IHNoKHRoaXMuX2ZpcmVzdG9yZSk7XG4gICAgICAgIHJldHVybiB0aGlzLl90cmFuc2FjdGlvbi5sb29rdXAoWyBlLl9rZXkgXSkudGhlbigodCA9PiB7XG4gICAgICAgICAgICBpZiAoIXQgfHwgMSAhPT0gdC5sZW5ndGgpIHJldHVybiBNKCk7XG4gICAgICAgICAgICBjb25zdCBzID0gdFswXTtcbiAgICAgICAgICAgIGlmIChzLmlzRm91bmREb2N1bWVudCgpKSByZXR1cm4gbmV3IGJ1KHRoaXMuX2ZpcmVzdG9yZSwgbiwgcy5rZXksIHMsIGUuY29udmVydGVyKTtcbiAgICAgICAgICAgIGlmIChzLmlzTm9Eb2N1bWVudCgpKSByZXR1cm4gbmV3IGJ1KHRoaXMuX2ZpcmVzdG9yZSwgbiwgZS5fa2V5LCBudWxsLCBlLmNvbnZlcnRlcik7XG4gICAgICAgICAgICB0aHJvdyBNKCk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgc2V0KHQsIGUsIG4pIHtcbiAgICAgICAgY29uc3QgcyA9IHJoKHQsIHRoaXMuX2ZpcmVzdG9yZSksIGkgPSBuaChzLmNvbnZlcnRlciwgZSwgbiksIHIgPSBhdSh0aGlzLl9kYXRhUmVhZGVyLCBcIlRyYW5zYWN0aW9uLnNldFwiLCBzLl9rZXksIGksIG51bGwgIT09IHMuY29udmVydGVyLCBuKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RyYW5zYWN0aW9uLnNldChzLl9rZXksIHIpLCB0aGlzO1xuICAgIH1cbiAgICB1cGRhdGUodCwgZSwgbiwgLi4ucykge1xuICAgICAgICBjb25zdCBpID0gcmgodCwgdGhpcy5fZmlyZXN0b3JlKTtcbiAgICAgICAgLy8gRm9yIENvbXBhdCB0eXBlcywgd2UgaGF2ZSB0byBcImV4dHJhY3RcIiB0aGUgdW5kZXJseWluZyB0eXBlcyBiZWZvcmVcbiAgICAgICAgLy8gcGVyZm9ybWluZyB2YWxpZGF0aW9uLlxuICAgICAgICAgICAgICAgIGxldCByO1xuICAgICAgICByZXR1cm4gciA9IFwic3RyaW5nXCIgPT0gdHlwZW9mIChlID0geShlKSkgfHwgZSBpbnN0YW5jZW9mIEhjID8gX3UodGhpcy5fZGF0YVJlYWRlciwgXCJUcmFuc2FjdGlvbi51cGRhdGVcIiwgaS5fa2V5LCBlLCBuLCBzKSA6IHd1KHRoaXMuX2RhdGFSZWFkZXIsIFwiVHJhbnNhY3Rpb24udXBkYXRlXCIsIGkuX2tleSwgZSksIFxuICAgICAgICB0aGlzLl90cmFuc2FjdGlvbi51cGRhdGUoaS5fa2V5LCByKSwgdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogRGVsZXRlcyB0aGUgZG9jdW1lbnQgcmVmZXJyZWQgdG8gYnkgdGhlIHByb3ZpZGVkIHtAbGluayBEb2N1bWVudFJlZmVyZW5jZX0uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZG9jdW1lbnRSZWYgLSBBIHJlZmVyZW5jZSB0byB0aGUgZG9jdW1lbnQgdG8gYmUgZGVsZXRlZC5cbiAgICAgKiBAcmV0dXJucyBUaGlzIGBUcmFuc2FjdGlvbmAgaW5zdGFuY2UuIFVzZWQgZm9yIGNoYWluaW5nIG1ldGhvZCBjYWxscy5cbiAgICAgKi8gICAgZGVsZXRlKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHJoKHQsIHRoaXMuX2ZpcmVzdG9yZSk7XG4gICAgICAgIHJldHVybiB0aGlzLl90cmFuc2FjdGlvbi5kZWxldGUoZS5fa2V5KSwgdGhpcztcbiAgICB9XG59IHtcbiAgICAvLyBUaGlzIGNsYXNzIGltcGxlbWVudHMgdGhlIHNhbWUgbG9naWMgYXMgdGhlIFRyYW5zYWN0aW9uIEFQSSBpbiB0aGUgTGl0ZSBTREtcbiAgICAvLyBidXQgaXMgc3ViY2xhc3NlZCBpbiBvcmRlciB0byByZXR1cm4gaXRzIG93biBEb2N1bWVudFNuYXBzaG90IHR5cGVzLlxuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yICovXG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICBzdXBlcih0LCBlKSwgdGhpcy5fZmlyZXN0b3JlID0gdDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVhZHMgdGhlIGRvY3VtZW50IHJlZmVyZW5jZWQgYnkgdGhlIHByb3ZpZGVkIHtAbGluayBEb2N1bWVudFJlZmVyZW5jZX0uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZG9jdW1lbnRSZWYgLSBBIHJlZmVyZW5jZSB0byB0aGUgZG9jdW1lbnQgdG8gYmUgcmVhZC5cbiAgICAgKiBAcmV0dXJucyBBIGBEb2N1bWVudFNuYXBzaG90YCB3aXRoIHRoZSByZWFkIGRhdGEuXG4gICAgICovICAgIGdldCh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSByaCh0LCB0aGlzLl9maXJlc3RvcmUpLCBuID0gbmV3IGFoKHRoaXMuX2ZpcmVzdG9yZSk7XG4gICAgICAgIHJldHVybiBzdXBlci5nZXQodCkudGhlbigodCA9PiBuZXcgRHUodGhpcy5fZmlyZXN0b3JlLCBuLCBlLl9rZXksIHQuX2RvY3VtZW50LCBuZXcgU3UoXG4gICAgICAgIC8qIGhhc1BlbmRpbmdXcml0ZXM9ICovICExLCBcbiAgICAgICAgLyogZnJvbUNhY2hlPSAqLyAhMSksIGUuY29udmVydGVyKSkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBFeGVjdXRlcyB0aGUgZ2l2ZW4gYHVwZGF0ZUZ1bmN0aW9uYCBhbmQgdGhlbiBhdHRlbXB0cyB0byBjb21taXQgdGhlIGNoYW5nZXNcbiAqIGFwcGxpZWQgd2l0aGluIHRoZSB0cmFuc2FjdGlvbi4gSWYgYW55IGRvY3VtZW50IHJlYWQgd2l0aGluIHRoZSB0cmFuc2FjdGlvblxuICogaGFzIGNoYW5nZWQsIENsb3VkIEZpcmVzdG9yZSByZXRyaWVzIHRoZSBgdXBkYXRlRnVuY3Rpb25gLiBJZiBpdCBmYWlscyB0b1xuICogY29tbWl0IGFmdGVyIDUgYXR0ZW1wdHMsIHRoZSB0cmFuc2FjdGlvbiBmYWlscy5cbiAqXG4gKiBUaGUgbWF4aW11bSBudW1iZXIgb2Ygd3JpdGVzIGFsbG93ZWQgaW4gYSBzaW5nbGUgdHJhbnNhY3Rpb24gaXMgNTAwLlxuICpcbiAqIEBwYXJhbSBmaXJlc3RvcmUgLSBBIHJlZmVyZW5jZSB0byB0aGUgRmlyZXN0b3JlIGRhdGFiYXNlIHRvIHJ1biB0aGlzXG4gKiB0cmFuc2FjdGlvbiBhZ2FpbnN0LlxuICogQHBhcmFtIHVwZGF0ZUZ1bmN0aW9uIC0gVGhlIGZ1bmN0aW9uIHRvIGV4ZWN1dGUgd2l0aGluIHRoZSB0cmFuc2FjdGlvblxuICogY29udGV4dC5cbiAqIEByZXR1cm5zIElmIHRoZSB0cmFuc2FjdGlvbiBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5IG9yIHdhcyBleHBsaWNpdGx5IGFib3J0ZWRcbiAqICh0aGUgYHVwZGF0ZUZ1bmN0aW9uYCByZXR1cm5lZCBhIGZhaWxlZCBwcm9taXNlKSwgdGhlIHByb21pc2UgcmV0dXJuZWQgYnkgdGhlXG4gKiBgdXBkYXRlRnVuY3Rpb24gYGlzIHJldHVybmVkIGhlcmUuIE90aGVyd2lzZSwgaWYgdGhlIHRyYW5zYWN0aW9uIGZhaWxlZCwgYVxuICogcmVqZWN0ZWQgcHJvbWlzZSB3aXRoIHRoZSBjb3JyZXNwb25kaW5nIGZhaWx1cmUgZXJyb3IgaXMgcmV0dXJuZWQuXG4gKi8gZnVuY3Rpb24gSWgodCwgZSkge1xuICAgIHJldHVybiByYyhPYyh0KSwgKG4gPT4gZShuZXcgVGgodCwgbikpKSk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFJldHVybnMgYSBzZW50aW5lbCBmb3IgdXNlIHdpdGgge0BsaW5rIEBmaXJlYmFzZS9maXJlc3RvcmUvbGl0ZSModXBkYXRlRG9jOjEpfSBvclxuICoge0BsaW5rIEBmaXJlYmFzZS9maXJlc3RvcmUvbGl0ZSMoc2V0RG9jOjEpfSB3aXRoIGB7bWVyZ2U6IHRydWV9YCB0byBtYXJrIGEgZmllbGQgZm9yIGRlbGV0aW9uLlxuICovIGZ1bmN0aW9uIEFoKCkge1xuICAgIHJldHVybiBuZXcgY3UoXCJkZWxldGVGaWVsZFwiKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgc2VudGluZWwgdXNlZCB3aXRoIHtAbGluayBAZmlyZWJhc2UvZmlyZXN0b3JlL2xpdGUjKHNldERvYzoxKX0gb3Ige0BsaW5rIEBmaXJlYmFzZS9maXJlc3RvcmUvbGl0ZSModXBkYXRlRG9jOjEpfSB0b1xuICogaW5jbHVkZSBhIHNlcnZlci1nZW5lcmF0ZWQgdGltZXN0YW1wIGluIHRoZSB3cml0dGVuIGRhdGEuXG4gKi8gZnVuY3Rpb24gUmgoKSB7XG4gICAgcmV0dXJuIG5ldyBodShcInNlcnZlclRpbWVzdGFtcFwiKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgc3BlY2lhbCB2YWx1ZSB0aGF0IGNhbiBiZSB1c2VkIHdpdGgge0BsaW5rIEBmaXJlYmFzZS9maXJlc3RvcmUvbGl0ZSMoc2V0RG9jOjEpfSBvciB7QGxpbmtcbiAqIEBmaXJlYmFzZS9maXJlc3RvcmUvbGl0ZSModXBkYXRlRG9jOjEpfSB0aGF0IHRlbGxzIHRoZSBzZXJ2ZXIgdG8gdW5pb24gdGhlIGdpdmVuIGVsZW1lbnRzIHdpdGggYW55IGFycmF5XG4gKiB2YWx1ZSB0aGF0IGFscmVhZHkgZXhpc3RzIG9uIHRoZSBzZXJ2ZXIuIEVhY2ggc3BlY2lmaWVkIGVsZW1lbnQgdGhhdCBkb2Vzbid0XG4gKiBhbHJlYWR5IGV4aXN0IGluIHRoZSBhcnJheSB3aWxsIGJlIGFkZGVkIHRvIHRoZSBlbmQuIElmIHRoZSBmaWVsZCBiZWluZ1xuICogbW9kaWZpZWQgaXMgbm90IGFscmVhZHkgYW4gYXJyYXkgaXQgd2lsbCBiZSBvdmVyd3JpdHRlbiB3aXRoIGFuIGFycmF5XG4gKiBjb250YWluaW5nIGV4YWN0bHkgdGhlIHNwZWNpZmllZCBlbGVtZW50cy5cbiAqXG4gKiBAcGFyYW0gZWxlbWVudHMgLSBUaGUgZWxlbWVudHMgdG8gdW5pb24gaW50byB0aGUgYXJyYXkuXG4gKiBAcmV0dXJucyBUaGUgYEZpZWxkVmFsdWVgIHNlbnRpbmVsIGZvciB1c2UgaW4gYSBjYWxsIHRvIGBzZXREb2MoKWAgb3JcbiAqIGB1cGRhdGVEb2MoKWAuXG4gKi8gZnVuY3Rpb24gUGgoLi4udCkge1xuICAgIC8vIE5PVEU6IFdlIGRvbid0IGFjdHVhbGx5IHBhcnNlIHRoZSBkYXRhIHVudGlsIGl0J3MgdXNlZCBpbiBzZXQoKSBvclxuICAgIC8vIHVwZGF0ZSgpIHNpbmNlIHdlJ2QgbmVlZCB0aGUgRmlyZXN0b3JlIGluc3RhbmNlIHRvIGRvIHRoaXMuXG4gICAgcmV0dXJuIG5ldyBsdShcImFycmF5VW5pb25cIiwgdCk7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIHNwZWNpYWwgdmFsdWUgdGhhdCBjYW4gYmUgdXNlZCB3aXRoIHtAbGluayAoc2V0RG9jOjEpfSBvciB7QGxpbmtcbiAqIHVwZGF0ZURvYzoxfSB0aGF0IHRlbGxzIHRoZSBzZXJ2ZXIgdG8gcmVtb3ZlIHRoZSBnaXZlbiBlbGVtZW50cyBmcm9tIGFueVxuICogYXJyYXkgdmFsdWUgdGhhdCBhbHJlYWR5IGV4aXN0cyBvbiB0aGUgc2VydmVyLiBBbGwgaW5zdGFuY2VzIG9mIGVhY2ggZWxlbWVudFxuICogc3BlY2lmaWVkIHdpbGwgYmUgcmVtb3ZlZCBmcm9tIHRoZSBhcnJheS4gSWYgdGhlIGZpZWxkIGJlaW5nIG1vZGlmaWVkIGlzIG5vdFxuICogYWxyZWFkeSBhbiBhcnJheSBpdCB3aWxsIGJlIG92ZXJ3cml0dGVuIHdpdGggYW4gZW1wdHkgYXJyYXkuXG4gKlxuICogQHBhcmFtIGVsZW1lbnRzIC0gVGhlIGVsZW1lbnRzIHRvIHJlbW92ZSBmcm9tIHRoZSBhcnJheS5cbiAqIEByZXR1cm5zIFRoZSBgRmllbGRWYWx1ZWAgc2VudGluZWwgZm9yIHVzZSBpbiBhIGNhbGwgdG8gYHNldERvYygpYCBvclxuICogYHVwZGF0ZURvYygpYFxuICovIGZ1bmN0aW9uIGJoKC4uLnQpIHtcbiAgICAvLyBOT1RFOiBXZSBkb24ndCBhY3R1YWxseSBwYXJzZSB0aGUgZGF0YSB1bnRpbCBpdCdzIHVzZWQgaW4gc2V0KCkgb3JcbiAgICAvLyB1cGRhdGUoKSBzaW5jZSB3ZSdkIG5lZWQgdGhlIEZpcmVzdG9yZSBpbnN0YW5jZSB0byBkbyB0aGlzLlxuICAgIHJldHVybiBuZXcgZnUoXCJhcnJheVJlbW92ZVwiLCB0KTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgc3BlY2lhbCB2YWx1ZSB0aGF0IGNhbiBiZSB1c2VkIHdpdGgge0BsaW5rIEBmaXJlYmFzZS9maXJlc3RvcmUvbGl0ZSMoc2V0RG9jOjEpfSBvciB7QGxpbmtcbiAqIEBmaXJlYmFzZS9maXJlc3RvcmUvbGl0ZSModXBkYXRlRG9jOjEpfSB0aGF0IHRlbGxzIHRoZSBzZXJ2ZXIgdG8gaW5jcmVtZW50IHRoZSBmaWVsZCdzIGN1cnJlbnQgdmFsdWUgYnlcbiAqIHRoZSBnaXZlbiB2YWx1ZS5cbiAqXG4gKiBJZiBlaXRoZXIgdGhlIG9wZXJhbmQgb3IgdGhlIGN1cnJlbnQgZmllbGQgdmFsdWUgdXNlcyBmbG9hdGluZyBwb2ludFxuICogcHJlY2lzaW9uLCBhbGwgYXJpdGhtZXRpYyBmb2xsb3dzIElFRUUgNzU0IHNlbWFudGljcy4gSWYgYm90aCB2YWx1ZXMgYXJlXG4gKiBpbnRlZ2VycywgdmFsdWVzIG91dHNpZGUgb2YgSmF2YVNjcmlwdCdzIHNhZmUgbnVtYmVyIHJhbmdlXG4gKiAoYE51bWJlci5NSU5fU0FGRV9JTlRFR0VSYCB0byBgTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVJgKSBhcmUgYWxzbyBzdWJqZWN0IHRvXG4gKiBwcmVjaXNpb24gbG9zcy4gRnVydGhlcm1vcmUsIG9uY2UgcHJvY2Vzc2VkIGJ5IHRoZSBGaXJlc3RvcmUgYmFja2VuZCwgYWxsXG4gKiBpbnRlZ2VyIG9wZXJhdGlvbnMgYXJlIGNhcHBlZCBiZXR3ZWVuIC0yXjYzIGFuZCAyXjYzLTEuXG4gKlxuICogSWYgdGhlIGN1cnJlbnQgZmllbGQgdmFsdWUgaXMgbm90IG9mIHR5cGUgYG51bWJlcmAsIG9yIGlmIHRoZSBmaWVsZCBkb2VzIG5vdFxuICogeWV0IGV4aXN0LCB0aGUgdHJhbnNmb3JtYXRpb24gc2V0cyB0aGUgZmllbGQgdG8gdGhlIGdpdmVuIHZhbHVlLlxuICpcbiAqIEBwYXJhbSBuIC0gVGhlIHZhbHVlIHRvIGluY3JlbWVudCBieS5cbiAqIEByZXR1cm5zIFRoZSBgRmllbGRWYWx1ZWAgc2VudGluZWwgZm9yIHVzZSBpbiBhIGNhbGwgdG8gYHNldERvYygpYCBvclxuICogYHVwZGF0ZURvYygpYFxuICovIGZ1bmN0aW9uIHZoKHQpIHtcbiAgICByZXR1cm4gbmV3IGR1KFwiaW5jcmVtZW50XCIsIHQpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBDcmVhdGVzIGEgd3JpdGUgYmF0Y2gsIHVzZWQgZm9yIHBlcmZvcm1pbmcgbXVsdGlwbGUgd3JpdGVzIGFzIGEgc2luZ2xlXG4gKiBhdG9taWMgb3BlcmF0aW9uLiBUaGUgbWF4aW11bSBudW1iZXIgb2Ygd3JpdGVzIGFsbG93ZWQgaW4gYSBzaW5nbGUge0BsaW5rIFdyaXRlQmF0Y2h9XG4gKiBpcyA1MDAuXG4gKlxuICogVW5saWtlIHRyYW5zYWN0aW9ucywgd3JpdGUgYmF0Y2hlcyBhcmUgcGVyc2lzdGVkIG9mZmxpbmUgYW5kIHRoZXJlZm9yZSBhcmVcbiAqIHByZWZlcmFibGUgd2hlbiB5b3UgZG9uJ3QgbmVlZCB0byBjb25kaXRpb24geW91ciB3cml0ZXMgb24gcmVhZCBkYXRhLlxuICpcbiAqIEByZXR1cm5zIEEge0BsaW5rIFdyaXRlQmF0Y2h9IHRoYXQgY2FuIGJlIHVzZWQgdG8gYXRvbWljYWxseSBleGVjdXRlIG11bHRpcGxlXG4gKiB3cml0ZXMuXG4gKi8gZnVuY3Rpb24gVmgodCkge1xuICAgIHJldHVybiBPYyh0ID0gbWModCwgeGMpKSwgbmV3IGloKHQsIChlID0+IHBoKHQsIGUpKSk7XG59XG5cbi8qKlxuICogQ2xvdWQgRmlyZXN0b3JlXG4gKlxuICogQHBhY2thZ2VEb2N1bWVudGF0aW9uXG4gKi8gdmFyIFNoO1xuXG4hZnVuY3Rpb24odCkge1xuICAgIEQgPSB0O1xufShyKSwgcyhuZXcgbyhcImZpcmVzdG9yZVwiLCAoKHQsIHtvcHRpb25zOiBlfSkgPT4ge1xuICAgIGNvbnN0IG4gPSB0LmdldFByb3ZpZGVyKFwiYXBwXCIpLmdldEltbWVkaWF0ZSgpLCBzID0gbmV3IHhjKG4sIG5ldyB6KHQuZ2V0UHJvdmlkZXIoXCJhdXRoLWludGVybmFsXCIpKSk7XG4gICAgcmV0dXJuIGUgPSBPYmplY3QuYXNzaWduKHtcbiAgICAgICAgdXNlRmV0Y2hTdHJlYW1zOiAhMFxuICAgIH0sIGUpLCBzLl9zZXRTZXR0aW5ncyhlKSwgcztcbn0pLCBcIlBVQkxJQ1wiIC8qIFBVQkxJQyAqLykpLCBpKFwiQGZpcmViYXNlL2ZpcmVzdG9yZVwiLCBcIjMuMC4xXCIsIFNoKTtcblxuZXhwb3J0IHsgZWggYXMgQWJzdHJhY3RVc2VyRGF0YVdyaXRlciwgWWMgYXMgQnl0ZXMsIE5jIGFzIENBQ0hFX1NJWkVfVU5MSU1JVEVELCBBYyBhcyBDb2xsZWN0aW9uUmVmZXJlbmNlLCBUYyBhcyBEb2N1bWVudFJlZmVyZW5jZSwgRHUgYXMgRG9jdW1lbnRTbmFwc2hvdCwgSGMgYXMgRmllbGRQYXRoLCBYYyBhcyBGaWVsZFZhbHVlLCB4YyBhcyBGaXJlc3RvcmUsIEsgYXMgRmlyZXN0b3JlRXJyb3IsIFpjIGFzIEdlb1BvaW50LCBDYyBhcyBMb2FkQnVuZGxlVGFzaywgSWMgYXMgUXVlcnksIE91IGFzIFF1ZXJ5Q29uc3RyYWludCwgQ3UgYXMgUXVlcnlEb2N1bWVudFNuYXBzaG90LCBOdSBhcyBRdWVyeVNuYXBzaG90LCBTdSBhcyBTbmFwc2hvdE1ldGFkYXRhLCBzdCBhcyBUaW1lc3RhbXAsIFRoIGFzIFRyYW5zYWN0aW9uLCBpaCBhcyBXcml0ZUJhdGNoLCB1YyBhcyBfRGF0YWJhc2VJZCwgUHQgYXMgX0RvY3VtZW50S2V5LCBsdCBhcyBfRmllbGRQYXRoLCBtYyBhcyBfY2FzdCwgQiBhcyBfZGVidWdBc3NlcnQsIGR0IGFzIF9pc0Jhc2U2NEF2YWlsYWJsZSwgTyBhcyBfbG9nV2FybiwgZmMgYXMgX3ZhbGlkYXRlSXNOb3RVc2VkVG9nZXRoZXIsIG1oIGFzIGFkZERvYywgYmggYXMgYXJyYXlSZW1vdmUsIFBoIGFzIGFycmF5VW5pb24sIFVjIGFzIGNsZWFySW5kZXhlZERiUGVyc2lzdGVuY2UsIFJjIGFzIGNvbGxlY3Rpb24sIFBjIGFzIGNvbGxlY3Rpb25Hcm91cCwgRWMgYXMgY29ubmVjdEZpcmVzdG9yZUVtdWxhdG9yLCBfaCBhcyBkZWxldGVEb2MsIEFoIGFzIGRlbGV0ZUZpZWxkLCBqYyBhcyBkaXNhYmxlTmV0d29yaywgYmMgYXMgZG9jLCBKYyBhcyBkb2N1bWVudElkLCBNYyBhcyBlbmFibGVJbmRleGVkRGJQZXJzaXN0ZW5jZSwgTGMgYXMgZW5hYmxlTXVsdGlUYWJJbmRleGVkRGJQZXJzaXN0ZW5jZSwgS2MgYXMgZW5hYmxlTmV0d29yaywgSnUgYXMgZW5kQXQsIEh1IGFzIGVuZEJlZm9yZSwgT2MgYXMgZW5zdXJlRmlyZXN0b3JlQ29uZmlndXJlZCwgcGggYXMgZXhlY3V0ZVdyaXRlLCBvaCBhcyBnZXREb2MsIGNoIGFzIGdldERvY0Zyb21DYWNoZSwgdWggYXMgZ2V0RG9jRnJvbVNlcnZlciwgaGggYXMgZ2V0RG9jcywgbGggYXMgZ2V0RG9jc0Zyb21DYWNoZSwgZmggYXMgZ2V0RG9jc0Zyb21TZXJ2ZXIsICRjIGFzIGdldEZpcmVzdG9yZSwgdmggYXMgaW5jcmVtZW50LCBrYyBhcyBpbml0aWFsaXplRmlyZXN0b3JlLCBLdSBhcyBsaW1pdCwganUgYXMgbGltaXRUb0xhc3QsIFdjIGFzIGxvYWRCdW5kbGUsIEdjIGFzIG5hbWVkUXVlcnksIGdoIGFzIG9uU25hcHNob3QsIHloIGFzIG9uU25hcHNob3RzSW5TeW5jLCBVdSBhcyBvcmRlckJ5LCBGdSBhcyBxdWVyeSwgVmMgYXMgcXVlcnlFcXVhbCwgdmMgYXMgcmVmRXF1YWwsIEloIGFzIHJ1blRyYW5zYWN0aW9uLCBSaCBhcyBzZXJ2ZXJUaW1lc3RhbXAsIGRoIGFzIHNldERvYywgeCBhcyBzZXRMb2dMZXZlbCwga3UgYXMgc25hcHNob3RFcXVhbCwgR3UgYXMgc3RhcnRBZnRlciwgV3UgYXMgc3RhcnRBdCwgUWMgYXMgdGVybWluYXRlLCB3aCBhcyB1cGRhdGVEb2MsIHFjIGFzIHdhaXRGb3JQZW5kaW5nV3JpdGVzLCBMdSBhcyB3aGVyZSwgVmggYXMgd3JpdGVCYXRjaCB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguZXNtMjAxNy5qcy5tYXBcbiIsImltcG9ydCB7IHJlZ2lzdGVyVmVyc2lvbiB9IGZyb20gJ0BmaXJlYmFzZS9hcHAnO1xuZXhwb3J0ICogZnJvbSAnQGZpcmViYXNlL2FwcCc7XG5cbnZhciBuYW1lID0gXCJmaXJlYmFzZVwiO1xudmFyIHZlcnNpb24gPSBcIjkuMC4xXCI7XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbnJlZ2lzdGVyVmVyc2lvbihuYW1lLCB2ZXJzaW9uLCAnYXBwJyk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5lc20uanMubWFwXG4iLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5nID0gKGZ1bmN0aW9uKCkge1xuXHRpZiAodHlwZW9mIGdsb2JhbFRoaXMgPT09ICdvYmplY3QnKSByZXR1cm4gZ2xvYmFsVGhpcztcblx0dHJ5IHtcblx0XHRyZXR1cm4gdGhpcyB8fCBuZXcgRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTtcblx0fSBjYXRjaCAoZSkge1xuXHRcdGlmICh0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0JykgcmV0dXJuIHdpbmRvdztcblx0fVxufSkoKTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiaW1wb3J0IHsgZGIsIHN0b3JhZ2UgfSBmcm9tICcuL3NldHVwLmpzJztcbmltcG9ydCB7IHJlZiBhcyBzdG9yYWdlUmVmLCB1cGxvYWRCeXRlcywgZ2V0RG93bmxvYWRVUkwgfSBmcm9tIFwiZmlyZWJhc2Uvc3RvcmFnZVwiO1xuaW1wb3J0IHsgZG9jIGFzIGZpcmVzdG9yZURvYywgdXBkYXRlRG9jLCBzZXJ2ZXJUaW1lc3RhbXAgfSBmcm9tIFwiZmlyZWJhc2UvZmlyZXN0b3JlXCI7XG5pbXBvcnQgeyBoaWdobGlnaHRBY3RpdmVOYXYgfSBmcm9tICcuL25hdmJhci5qcyc7XG5cbndpbmRvdy5vbmxvYWQgPSBmdW5jdGlvbigpIHtcbiAgICBjb25zdCB1c2VyRGF0YSA9IEpTT04ucGFyc2Uoc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgndXNlckRhdGEnKSk7XG4gICAgaWYgKCF1c2VyRGF0YSB8fCAhdXNlckRhdGEucGhvbmUpIHtcbiAgICAgICAgYWxlcnQoXCJVc2VyIHNlc3Npb24gZXhwaXJlZC4gUGxlYXNlIGxvZyBpbiBhZ2Fpbi5cIik7XG4gICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCJpbmRleC5odG1sXCI7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgZG9jU3RyaW5nID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2RvY3VtZW50VG9CZUVkaXRlZCcpO1xuICAgIGlmIChkb2NTdHJpbmcpIHtcbiAgICAgICAgY29uc3QgZG9jID0gSlNPTi5wYXJzZShkb2NTdHJpbmcpO1xuICAgICAgICBlZGl0RG9jdW1lbnQoZG9jKTsgXG4gICAgfSBlbHNlIHtcbiAgICAgICAgYWxlcnQoXCJObyBkb2N1bWVudCBmb3VuZCB0byBlZGl0IVwiKTtcbiAgICB9XG59XG5cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoKSA9PiB7XG4gICAgaGlnaGxpZ2h0QWN0aXZlTmF2KCk7XG59KTtcblxuZnVuY3Rpb24gZWRpdERvY3VtZW50KGRvYyl7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2VkaXQtZG9jdW1lbnQtcGFnZS1jb250YWluZXInKS5pbm5lckhUTUwgPSBcbiAgICBgIFxuICAgIDxkaXYgY2xhc3M9XCJjb250YWluZXJcIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cInJvdyBtLTNcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjb2wtMTIgcm93IG1iLTUgYWxpZ24taXRlbXMtY2VudGVyIGp1c3RpZnktY29udGVudC1jZW50ZXJcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGlkPVwiZWRpdC1kb2N1bWVudC1mb3JtLXdyYXBwZXJcIiBjbGFzcz1cImNvbC1sZy03IGNvbC1tZC0xMCBjb2wtMTIgbXktMyBwLW1kLTUgcC0zIGJvcmRlciBib3JkZXItMiByb3VuZGVkIHNoYWRvd1wiPlxuICAgICAgICAgICAgICAgICAgICA8aDIgY2xhc3M9XCJ0ZXh0LWNlbnRlciBtYi00XCI+RWRpdCBEb2N1bWVudDwvaDI+XG4gICAgICAgICAgICAgICAgICAgIDxmb3JtIGFjdGlvbj1cIlwiIGlkPVwiZWRpdC1kb2N1bWVudC1wYWdlLWZvcm1cIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwhLS0gRG9jdW1lbnQgTmFtZSAtLT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtYi00XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGZvcj1cImVkaXQtZG9jdW1lbnQtcGFnZS1kb2N1bWVudC1uYW1lXCIgY2xhc3M9XCJmb3JtLWxhYmVsXCI+RW50ZXIgbmFtZSBvZiB0aGUgZG9jdW1lbnQ8L2xhYmVsPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIGNsYXNzPVwiZm9ybS1jb250cm9sXCIgaWQ9XCJlZGl0LWRvY3VtZW50LXBhZ2UtZG9jdW1lbnQtbmFtZVwiIHZhbHVlPVwiJHtkb2MuZG9jdW1lbnROYW1lfVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwhLS0gRG9jdW1lbnQgVHlwZSAtLT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtYi00XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGZvcj1cImVkaXQtZG9jdW1lbnQtcGFnZS10eXBlLW9mLWRvY3VtZW50XCIgY2xhc3M9XCJmb3JtLWxhYmVsXCI+U2VsZWN0IHRoZSB0eXBlIG9mIHRoZSBkb2N1bWVudDwvbGFiZWw+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNlbGVjdCBjbGFzcz1cImZvcm0tc2VsZWN0XCIgaWQ9XCJlZGl0LWRvY3VtZW50LXBhZ2UtdHlwZS1vZi1kb2N1bWVudFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHNlbGVjdGVkPlNlbGVjdCB0aGUgdHlwZSBvZiBkb2N1bWVudDwvb3B0aW9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiMVwiPkFhZGhhYXIgY2FyZDwvb3B0aW9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiMlwiPkFybXMgbGljZW5zZTwvb3B0aW9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiM1wiPkJhbmsgcGFzc2Jvb2s8L29wdGlvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIjRcIj5CYW5rIHN0YXRlbWVudHM8L29wdGlvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIjVcIj5CaXJ0aCBjZXJ0aWZpY2F0ZTwvb3B0aW9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiNlwiPkRvbWljaWxlIGNlcnRpZmljYXRlIGlzc3VlZCBieSBnb3Zlcm5tZW50PC9vcHRpb24+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCI3XCI+RHJpdmluZyBMaWNlbnNlPC9vcHRpb24+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCI4XCI+RWR1Y2F0aW9uYWwgY2VydGlmaWNhdGU8L29wdGlvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIjlcIj5FbGVjdG9ycyBwaG90byBpZGVudGl0eSBjYXJkPC9vcHRpb24+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCIxMFwiPkVsZWN0cmljaXR5IGJpbGw8L29wdGlvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIjExXCI+R2F6ZXR0ZWQgb2ZmaWNlciBpc3N1ZWQgZG9jdW1lbnRzPC9vcHRpb24+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCIxMlwiPkdhcyBjb25uZWN0aW9uIGRldGFpbHM8L29wdGlvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIjEzXCI+TGV0dGVyIGZyb20gZW1wbG95ZXI8L29wdGlvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIjE0XCI+TWFycmlhZ2UgY2VydGlmaWNhdGU8L29wdGlvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIjE1XCI+TU5SRUdBIEpvYiBjYXJkPC9vcHRpb24+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCIxNlwiPlBBTiBjYXJkPC9vcHRpb24+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCIxN1wiPlBhc3Nwb3J0PC9vcHRpb24+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCIxOFwiPlBlbnNpb24gY2FyZDwvb3B0aW9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiMTlcIj5QaG90byBjcmVkaXQgY2FyZDwvb3B0aW9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiMjBcIj5SZW50IGFncmVlbWVudDwvb3B0aW9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiMjFcIj5SYXRpb24gY2FyZDwvb3B0aW9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiMjJcIj5UYXggY2FyZDwvb3B0aW9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiMjNcIj5UZWxlcGhvbmUgYmlsbDwvb3B0aW9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiMjRcIj5Wb3RlciBJRDwvb3B0aW9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc2VsZWN0PlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwhLS0gRmlsZSBVcGxvYWQgLS0+XG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibWItNFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICR7ZG9jLmZpbGVVcmwgPyBgPHA+QWxyZWFkeSB1cGxvYWRlZDogPGEgaHJlZj1cIiR7ZG9jLmZpbGVVcmx9XCIgdGFyZ2V0PVwiX2JsYW5rXCI+JHtkb2MuZG9jdW1lbnROYW1lfTwvYT48L3A+YCA6ICcnfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9XCJlZGl0LWRvY3VtZW50LXBhZ2UtZG9jdW1lbnQtdXBsb2FkXCIgY2xhc3M9XCJmb3JtLWxhYmVsXCI+VXBsb2FkIHlvdXIgbmV3IGRvY3VtZW50PC9sYWJlbD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cImZpbGVcIiBjbGFzcz1cImZvcm0tY29udHJvbFwiIGlkPVwiZWRpdC1kb2N1bWVudC1wYWdlLWRvY3VtZW50LXVwbG9hZFwiIG5hbWU9XCJkb2N1bWVudFwiIGFjY2VwdD1cImFwcGxpY2F0aW9uL3BkZiwgaW1hZ2UvKlwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwhLS0gU3VibWl0IEJ1dHRvbiAtLT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJkLWdyaWRcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPVwiZWRpdC1kb2N1bWVudC1wYWdlLXN1Ym1pdC1idXR0b25cIiB0eXBlPVwic3VibWl0XCIgY2xhc3M9XCJidG4gYnRuLXByaW1hcnkgYnRuLWxnXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFN1Ym1pdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDwvZm9ybT5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5gO1xuICAgIC8vIE5vdyBzZWxlY3QgdGhlIG9wdGlvbiBiYXNlZCBvbiBURVhUXG4gICAgY29uc3Qgc2VsZWN0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlZGl0LWRvY3VtZW50LXBhZ2UtdHlwZS1vZi1kb2N1bWVudCcpO1xuICAgIGNvbnN0IG9wdGlvbnMgPSBzZWxlY3RFbGVtZW50Lm9wdGlvbnM7XG5cbiAgICBjb25zdCBlZGl0RG9jdW1lbnRQYWdlRm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlZGl0LWRvY3VtZW50LXBhZ2UtZm9ybScpO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvcHRpb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChvcHRpb25zW2ldLnRleHQgPT09IGRvYy5kb2N1bWVudFR5cGUpIHtcbiAgICAgICAgICAgIHNlbGVjdEVsZW1lbnQuc2VsZWN0ZWRJbmRleCA9IGk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGVkaXREb2N1bWVudFBhZ2VGb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGFzeW5jIGZ1bmN0aW9uIChlKXtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgIGNvbnN0IGRvY1N0cmluZyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdlZGl0RG9jJyk7XG4gICAgICAgIGlmICghZG9jU3RyaW5nKSB7XG4gICAgICAgICAgICBhbGVydCgnTm8gZG9jdW1lbnQgdG8gZWRpdC4nKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgIFxuICAgICAgICBjb25zdCBlZGl0RG9jdW1lbnRQYWdlTmFtZU9mRG9jdW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImVkaXQtZG9jdW1lbnQtcGFnZS1kb2N1bWVudC1uYW1lXCIpLnZhbHVlO1xuICAgICAgICBjb25zdCBlZGl0RG9jdW1lbnRQYWdlVHlwZU9mRG9jdW1lbnRPcHRpb25zID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJlZGl0LWRvY3VtZW50LXBhZ2UtdHlwZS1vZi1kb2N1bWVudFwiKTtcbiAgICAgICAgY29uc3QgZWRpdERvY3VtZW50UGFnZVR5cGVPZkRvY3VtZW50U2VsZWN0ZWQgPSBlZGl0RG9jdW1lbnRQYWdlVHlwZU9mRG9jdW1lbnRPcHRpb25zLm9wdGlvbnNbZWRpdERvY3VtZW50UGFnZVR5cGVPZkRvY3VtZW50T3B0aW9ucy5zZWxlY3RlZEluZGV4XS50ZXh0O1xuXG4gICAgICAgIGNvbnN0IG9sZERvYyA9IEpTT04ucGFyc2UoZG9jU3RyaW5nKTtcbiAgICAgICAgbGV0IG5ld0ZpbGVVUkwgPSBvbGREb2MuZmlsZVVybDtcblxuICAgICAgICBjb25zdCBlZGl0RG9jdW1lbnRQYWdlRmlsZUlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2VkaXQtZG9jdW1lbnQtcGFnZS1kb2N1bWVudC11cGxvYWQnKTtcbiAgICAgICAgdmFyIGVkaXREb2N1bWVudFBhZ2VGaWxlVXBsb2FkZWQ7XG4gICAgICAgIHZhciBlZGl0RG9jdW1lbnRQYWdlRG93bmxvYWRVUkw7XG5cbiAgICAgICAgaWYoZWRpdERvY3VtZW50UGFnZUZpbGVJbnB1dC5maWxlcy5sZW5ndGgpe1xuICAgICAgICAgICAgZWRpdERvY3VtZW50UGFnZUZpbGVVcGxvYWRlZCA9IGVkaXREb2N1bWVudFBhZ2VGaWxlSW5wdXQuZmlsZXNbMF07XG5cbiAgICAgICAgICAgIGlmIChlZGl0RG9jdW1lbnRQYWdlRmlsZVVwbG9hZGVkLnNpemUgPiAyICogMTAyNCAqIDEwMjQpIHtcbiAgICAgICAgICAgICAgICBhbGVydChcIkZpbGUgc2l6ZSBtdXN0IGJlIGxlc3MgdGhhbiAyTUIuXCIpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgICAgIFxuICAgICAgICAgICAgLy8gUHJvY2VlZCB3aXRoIHVwbG9hZCB0byBGaXJlYmFzZSBTdG9yYWdlXG4gICAgICAgICAgICBjb25zdCBuZXdTdG9yYWdlUmVmID0gc3RvcmFnZVJlZihzdG9yYWdlLCBgZG9jdW1lbnRzLyR7ZWRpdERvY3VtZW50UGFnZUZpbGVVcGxvYWRlZC5uYW1lfV8ke0RhdGUubm93KCl9YCk7XG4gICAgICAgICAgICBhd2FpdCB1cGxvYWRCeXRlcyhuZXdTdG9yYWdlUmVmLCBlZGl0RG9jdW1lbnRQYWdlRmlsZVVwbG9hZGVkKTtcbiAgICAgICAgICAgIGVkaXREb2N1bWVudFBhZ2VEb3dubG9hZFVSTCA9IGF3YWl0IGdldERvd25sb2FkVVJMKG5ld1N0b3JhZ2VSZWYpO1xuICAgICAgICAgICAgbmV3RmlsZVVSTCA9IGVkaXREb2N1bWVudFBhZ2VEb3dubG9hZFVSTDtcbiAgICAgICAgfVxuICAgICAgIFxuICAgICAgICBjb25zdCBkb2NSZWYgPSBmaXJlc3RvcmVEb2MoZGIsIFwiZG9jdW1lbnRzXCIsIG9sZERvYy5pZCk7XG4gICAgICAgXG4gICAgICAgIC8vIFRoZW4gc2F2ZSBtZXRhZGF0YSB0byBGaXJlc3RvcmVcbiAgICAgICAgYXdhaXQgdXBkYXRlRG9jKGRvY1JlZiwge1xuICAgICAgICAgICAgZG9jdW1lbnROYW1lOiBlZGl0RG9jdW1lbnRQYWdlTmFtZU9mRG9jdW1lbnQsXG4gICAgICAgICAgICBkb2N1bWVudFR5cGU6IGVkaXREb2N1bWVudFBhZ2VUeXBlT2ZEb2N1bWVudFNlbGVjdGVkLFxuICAgICAgICAgICAgZmlsZU5hbWU6IGVkaXREb2N1bWVudFBhZ2VGaWxlVXBsb2FkZWQgPyBlZGl0RG9jdW1lbnRQYWdlRmlsZVVwbG9hZGVkLm5hbWUgOiBvbGREb2MuZmlsZU5hbWUsXG4gICAgICAgICAgICBmaWxlVHlwZTogZWRpdERvY3VtZW50UGFnZUZpbGVVcGxvYWRlZCA/IGVkaXREb2N1bWVudFBhZ2VGaWxlVXBsb2FkZWQudHlwZSA6IG9sZERvYy5maWxlVHlwZSxcbiAgICAgICAgICAgIGZpbGVTaXplOiBlZGl0RG9jdW1lbnRQYWdlRmlsZVVwbG9hZGVkID8gZWRpdERvY3VtZW50UGFnZUZpbGVVcGxvYWRlZC5zaXplIDogb2xkRG9jLmZpbGVTaXplLFxuICAgICAgICAgICAgZmlsZVVybDogbmV3RmlsZVVSTCxcbiAgICAgICAgICAgIHVwZGF0ZWRBdDogc2VydmVyVGltZXN0YW1wKClcbiAgICAgICAgfSk7XG4gICAgXG4gICAgICAgIGFsZXJ0KFwiRG9jdW1lbnQgdXBkYXRlZCBzdWNjZXNzZnVsbHkhXCIpO1xuICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICd2aWV3X2RvY3VtZW50c19wYWdlLmh0bWwnOyAgLy8gUmVkaXJlY3QgYmFja1xuICAgIH0pXG5cbn1cbiJdLCJuYW1lcyI6WyJleHRlbmRTdGF0aWNzIiwiZCIsImIiLCJPYmplY3QiLCJzZXRQcm90b3R5cGVPZiIsIl9fcHJvdG9fXyIsIkFycmF5IiwicCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsIl9fdmFsdWVzIiwibyIsInMiLCJTeW1ib2wiLCJpdGVyYXRvciIsIm0iLCJpIiwibGVuZ3RoIiwibmV4dCIsInZhbHVlIiwiZG9uZSIsIlR5cGVFcnJvciIsImsiLCJjb21tb25qc0dsb2JhbCIsImdsb2JhbFRoaXMiLCJ3aW5kb3ciLCJnIiwic2VsZiIsImdvb2ciLCJsIiwiYWEiLCJiYSIsImEiLCJpc0FycmF5IiwiZWEiLCJNYXRoIiwicmFuZG9tIiwiZmEiLCJoYSIsImMiLCJhcHBseSIsImJpbmQiLCJhcmd1bWVudHMiLCJpYSIsIkVycm9yIiwic2xpY2UiLCJlIiwidW5zaGlmdCIsInEiLCJGdW5jdGlvbiIsInRvU3RyaW5nIiwiaW5kZXhPZiIsImphIiwicHVzaCIsInRoaXMiLCJ0IiwiWiIsImNvbnN0cnVjdG9yIiwiVmIiLCJmIiwiaCIsIm4iLCJ2IiwibGEiLCJuYSIsIk0iLCJkYSIsInNoaWZ0IiwibWEiLCJmb3JFYWNoIiwic3BsaXQiLCJxYSIsImNvbmNhdCIsInJhIiwic2EiLCJ0ZXN0IiwieCIsInRhIiwiU3RyaW5nIiwidHJpbSIsImV4ZWMiLCJ3IiwidWEiLCJ2YSIsIm5hdmlnYXRvciIsIndhIiwidXNlckFnZW50IiwieGEiLCJ5YSIsInphIiwiQWEiLCJDYSIsIk5hIiwiSGEiLCJ5IiwiSWEiLCJKYSIsIkthIiwidG9Mb3dlckNhc2UiLCJMYSIsIk1hIiwiZG9jdW1lbnQiLCJkb2N1bWVudE1vZGUiLCJPYSIsIlBhIiwiUWEiLCJwYXJzZUZsb2F0IiwiU2EiLCJHYSIsIlJhIiwibWF4IiwicGFyc2VJbnQiLCJVYSIsIlZhIiwiYWRkRXZlbnRMaXN0ZW5lciIsImRlZmluZVByb3BlcnR5IiwiZ2V0IiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInoiLCJ0eXBlIiwidGFyZ2V0IiwiZGVmYXVsdFByZXZlbnRlZCIsIkEiLCJyZWxhdGVkVGFyZ2V0IiwiYnV0dG9uIiwic2NyZWVuWSIsInNjcmVlblgiLCJjbGllbnRZIiwiY2xpZW50WCIsImtleSIsIm1ldGFLZXkiLCJzaGlmdEtleSIsImFsdEtleSIsImN0cmxLZXkiLCJzdGF0ZSIsInBvaW50ZXJJZCIsInBvaW50ZXJUeXBlIiwiY2hhbmdlZFRvdWNoZXMiLCJzcmNFbGVtZW50Iiwibm9kZU5hbWUiLCJmcm9tRWxlbWVudCIsInRvRWxlbWVudCIsInBhZ2VYIiwicGFnZVkiLCJXYSIsInByZXZlbnREZWZhdWx0IiwicmV0dXJuVmFsdWUiLCJCIiwiWGEiLCJZYSIsImxpc3RlbmVyIiwicHJveHkiLCJzcmMiLCJjYXB0dXJlIiwiY2EiLCJaYSIsIiRhIiwiYmIiLCJzcGxpY2UiLCJhYiIsImFkZCIsImNiIiwiZGIiLCJmYiIsIm9uY2UiLCJnYiIsImhiIiwiTiIsImliIiwiamIiLCJtYiIsImtiIiwiYXR0YWNoRXZlbnQiLCJsYiIsImFkZExpc3RlbmVyIiwicmVtb3ZlTGlzdGVuZXIiLCJPIiwibmIiLCJvYiIsImRldGFjaEV2ZW50IiwicGIiLCJoYW5kbGVFdmVudCIsIkMiLCJQIiwiSSIsIkQiLCJxYiIsInUiLCJyYiIsIkpTT04iLCJzdHJpbmdpZnkiLCJzYiIsInRiIiwiQWIiLCJ1YiIsInZiIiwic2V0IiwiY2xhc3NfMiIsImoiLCJ3YiIsInJlc2V0IiwieWIiLCJzZXRUaW1lb3V0IiwiemIiLCJQcm9taXNlIiwicmVzb2x2ZSIsInRoZW4iLCJEYiIsIkJiIiwiQ2IiLCJFYiIsIkRhdGUiLCJub3ciLCJGYiIsIlMiLCJjbGVhclRpbWVvdXQiLCJHYiIsIk51bWJlciIsIkhiIiwic3RhcnQiLCJJYiIsIl9zdXBlciIsIl90aGlzIiwiX18iLCJjcmVhdGUiLCJfX2V4dGVuZHMiLCJFIiwiSmIiLCJLYiIsIkxiIiwiTWIiLCJGIiwiaW5mbyIsInBhcnNlIiwiUGIiLCJIIiwiUmIiLCJTYiIsIlRiIiwiVWIiLCJTVEFUX0VWRU5UIiwic3RhdCIsIkoiLCJzaXplIiwiSyIsIldiIiwiTk9fRVJST1IiLCJ4YiIsIlRJTUVPVVQiLCJYYiIsIlliIiwiWmIiLCIkYiIsImNjIiwiTCIsIk9QRU4iLCJhYyIsImJjIiwiZGMiLCJYIiwiViIsImVjIiwiVyIsIlkiLCIkIiwiVSIsImZjIiwiWE1MSHR0cFJlcXVlc3QiLCJnYyIsImhjIiwiaWMiLCJqYyIsImtjIiwibGMiLCJtYyIsIm5jIiwiciIsIkciLCJOYiIsInFjIiwiQmEiLCJ0YyIsInZjIiwic2MiLCJ3YyIsInJjIiwic3Vic3RyaW5nIiwiaXNOYU4iLCJzdWJzdHIiLCJ4YyIsImViIiwicGMiLCJ1YyIsImFib3J0IiwieWMiLCJ6YyIsIkFjIiwiQmMiLCJDYyIsImthIiwiUSIsIkRhIiwiRWEiLCJnZXRSZXNwb25zZUhlYWRlciIsIlNldCIsIkRjIiwiUiIsIm9hIiwiRWMiLCJGYyIsIkdjIiwiSGMiLCJJYyIsIktjIiwiVCIsIkpjIiwiTGMiLCJnYSIsIm9jIiwiVGV4dERlY29kZXIiLCJkZWNvZGUiLCJzdHJlYW0iLCJPYiIsImNhbmNlbCIsIlFiIiwiTWMiLCJPYyIsIlBjIiwiUWMiLCJSYyIsIlNjIiwibWF0Y2giLCJUYyIsInJlcGxhY2UiLCJkZCIsIlpjIiwiVWMiLCIkYyIsImZsb29yIiwiYWJzIiwiZGVjb2RlVVJJIiwiZGVjb2RlVVJJQ29tcG9uZW50IiwiZW5jb2RlVVJJIiwiY2QiLCJjaGFyQ29kZUF0IiwiVmMiLCJlbmNvZGVVUklDb21wb25lbnQiLCJjaGFyQXQiLCJXYyIsIlhjIiwiWWMiLCJqb2luIiwiTmMiLCJlZCIsImZkIiwiZ2QiLCJoZCIsIlBlcmZvcm1hbmNlTmF2aWdhdGlvblRpbWluZyIsInBlcmZvcm1hbmNlIiwiZ2V0RW50cmllc0J5VHlwZSIsIm5leHRIb3BQcm90b2NvbCIsImlkIiwiaGFzIiwiZGVsZXRlIiwiamQiLCJlXzIiLCJfYSIsIl9iIiwidmFsdWVzIiwiX2MiLCJlXzJfMSIsImVycm9yIiwicmV0dXJuIiwia2QiLCJsZCIsIm1kIiwib2QiLCJvbmxvYWQiLCJvbmVycm9yIiwib25hYm9ydCIsIm9udGltZW91dCIsInBkIiwicWQiLCJyZWFkeVN0YXRlIiwicmQiLCJzdGF0dXMiLCJyZXNwb25zZVR5cGUiLCJyZXNwb25zZVRleHQiLCJyZXNwb25zZSIsInN0YXR1c1RleHQiLCJvbnJlYWR5c3RhdGVjaGFuZ2UiLCJIZWFkZXJzIiwiZV8xIiwiZV8xXzEiLCJjbGVhciIsInVkIiwicmVhZCIsImNhdGNoIiwidGQiLCJzZCIsIm9wZW4iLCJzZW5kIiwiaGVhZGVycyIsIm1ldGhvZCIsImNyZWRlbnRpYWxzIiwiY2FjaGUiLCJib2R5IiwiZmV0Y2giLCJSZXF1ZXN0IiwiYXJyYXlCdWZmZXIiLCJUYSIsIlJlYWRhYmxlU3RyZWFtIiwiZ2V0UmVhZGVyIiwidGV4dCIsIlVpbnQ4QXJyYXkiLCJzZXRSZXF1ZXN0SGVhZGVyIiwiYXBwZW5kIiwiZ2V0QWxsUmVzcG9uc2VIZWFkZXJzIiwiZW50cmllcyIsInZkIiwid2QiLCJ4ZCIsInlkIiwicGEiLCJ6ZCIsIkNkIiwiRGQiLCJFZCIsIkZhIiwibG9jYXRpb24iLCJwcm90b2NvbCIsIkFkIiwibW96UmVzcG9uc2VBcnJheUJ1ZmZlciIsIkdkIiwiRmQiLCJIZCIsImludGVybmFsQ2hhbm5lbFBhcmFtcyIsIklkIiwieG1sSHR0cEZhY3RvcnkiLCJzdXBwb3J0c0Nyb3NzRG9tYWluWGhyIiwiY29uY3VycmVudFJlcXVlc3RMaW1pdCIsImZhc3RIYW5kc2hha2UiLCJmb3JjZUxvbmdQb2xsaW5nIiwiZGV0ZWN0QnVmZmVyaW5nUHJveHkiLCJKZCIsIktkIiwic2VuZEJlYWNvbiIsIkltYWdlIiwiTGQiLCJNZCIsIlFkIiwiUGQiLCJyb3VuZCIsIm1pbiIsIk9kIiwiUmQiLCJOZCIsImRfMSIsIm5kIiwiYWQiLCJiZCIsImhvc3RuYW1lIiwicG9ydCIsIlNkIiwiVGQiLCJtZXNzYWdlVXJsUGFyYW1zIiwibWVzc2FnZUhlYWRlcnMiLCJjbGllbnRQcm90b2NvbEhlYWRlclJlcXVpcmVkIiwiaW5pdE1lc3NhZ2VIZWFkZXJzIiwibWVzc2FnZUNvbnRlbnRUeXBlIiwiaHR0cEhlYWRlcnNPdmVyd3JpdGVQYXJhbSIsInNlbmRSYXdKc29uIiwiaHR0cFNlc3Npb25JZFBhcmFtIiwiVWQiLCJfX3NtX18iLCJkYXRhIiwiVmQiLCJ0b1VwcGVyQ2FzZSIsIkZvcm1EYXRhIiwid2l0aENyZWRlbnRpYWxzIiwidGltZW91dCIsIkJkIiwiX19kYXRhX18iLCJjbG9zZSIsImNyZWF0ZVdlYkNoYW5uZWwiLCJIVFRQX0VSUk9SIiwiQ09NUExFVEUiLCJFdmVudFR5cGUiLCJDTE9TRSIsIkVSUk9SIiwiTUVTU0FHRSIsImxpc3RlbiIsImxpc3Rlbk9uY2UiLCJnZXRMYXN0RXJyb3IiLCJnZXRMYXN0RXJyb3JDb2RlIiwiZ2V0U3RhdHVzIiwiZ2V0UmVzcG9uc2VKc29uIiwiZ2V0UmVzcG9uc2VUZXh0IiwiY3JlYXRlV2ViQ2hhbm5lbFRyYW5zcG9ydCIsImdldFN0YXRFdmVudFRhcmdldCIsIkVycm9yQ29kZSIsIkV2ZW50IiwiU3RhdCIsIlBST1hZIiwiTk9QUk9YWSIsIkZldGNoWG1sSHR0cEZhY3RvcnkiLCJXZWJDaGFubmVsIiwiWGhySW8iLCJDb21wb25lbnQiLCJuYW1lIiwiaW5zdGFuY2VGYWN0b3J5IiwibXVsdGlwbGVJbnN0YW5jZXMiLCJzZXJ2aWNlUHJvcHMiLCJpbnN0YW50aWF0aW9uTW9kZSIsIm9uSW5zdGFuY2VDcmVhdGVkIiwic2V0SW5zdGFudGlhdGlvbk1vZGUiLCJtb2RlIiwic2V0TXVsdGlwbGVJbnN0YW5jZXMiLCJzZXRTZXJ2aWNlUHJvcHMiLCJwcm9wcyIsInNldEluc3RhbmNlQ3JlYXRlZENhbGxiYWNrIiwiY2FsbGJhY2siLCJERUZBVUxUX0VOVFJZX05BTUUiLCJQcm92aWRlciIsImNvbnRhaW5lciIsImNvbXBvbmVudCIsImluc3RhbmNlcyIsIk1hcCIsImluc3RhbmNlc0RlZmVycmVkIiwiaW5zdGFuY2VzT3B0aW9ucyIsIm9uSW5pdENhbGxiYWNrcyIsImlkZW50aWZpZXIiLCJub3JtYWxpemVkSWRlbnRpZmllciIsIm5vcm1hbGl6ZUluc3RhbmNlSWRlbnRpZmllciIsImRlZmVycmVkIiwiaXNJbml0aWFsaXplZCIsInNob3VsZEF1dG9Jbml0aWFsaXplIiwiaW5zdGFuY2UiLCJnZXRPckluaXRpYWxpemVTZXJ2aWNlIiwiaW5zdGFuY2VJZGVudGlmaWVyIiwicHJvbWlzZSIsImdldEltbWVkaWF0ZSIsIm9wdGlvbnMiLCJvcHRpb25hbCIsImdldENvbXBvbmVudCIsInNldENvbXBvbmVudCIsImlzQ29tcG9uZW50RWFnZXIiLCJfZCIsImluc3RhbmNlRGVmZXJyZWQiLCJjbGVhckluc3RhbmNlIiwic2VydmljZXMiLCJsYWJlbCIsImZyb20iLCJhbGwiLCJmaWx0ZXIiLCJzZXJ2aWNlIiwibWFwIiwiSU5URVJOQUwiLCJfZGVsZXRlIiwic2VudCIsImlzQ29tcG9uZW50U2V0IiwiZ2V0T3B0aW9ucyIsImluaXRpYWxpemUiLCJvcHRzIiwiX2UiLCJvbkluaXQiLCJleGlzdGluZ0NhbGxiYWNrcyIsImV4aXN0aW5nSW5zdGFuY2UiLCJpbnZva2VPbkluaXRDYWxsYmFja3MiLCJlXzMiLCJjYWxsYmFja3MiLCJjYWxsYmFja3NfMSIsImNhbGxiYWNrc18xXzEiLCJlXzNfMSIsInVuZGVmaW5lZCIsIkNvbXBvbmVudENvbnRhaW5lciIsInByb3ZpZGVycyIsImFkZENvbXBvbmVudCIsInByb3ZpZGVyIiwiZ2V0UHJvdmlkZXIiLCJhZGRPck92ZXJ3cml0ZUNvbXBvbmVudCIsImdldFByb3ZpZGVycyIsIl9ERUZBVUxUX0FVVEhfRVJST1JfRkFDVE9SWSIsImxvZ0NsaWVudCIsIl9sb2dFcnJvciIsIm1zZyIsImFyZ3MiLCJsb2dMZXZlbCIsIl9mYWlsIiwiYXV0aE9yQ29kZSIsInJlc3QiLCJjcmVhdGVFcnJvckludGVybmFsIiwiX2NyZWF0ZUVycm9yIiwiY29kZSIsImZ1bGxQYXJhbXMiLCJhcHBOYW1lIiwiX2Vycm9yRmFjdG9yeSIsIl9hc3NlcnQiLCJhc3NlcnRpb24iLCJkZWJ1Z0ZhaWwiLCJmYWlsdXJlIiwibWVzc2FnZSIsImRlYnVnQXNzZXJ0IiwiaW5zdGFuY2VDYWNoZSIsIl9nZXRJbnN0YW5jZSIsImNscyIsIl9nZXRDdXJyZW50VXJsIiwiaHJlZiIsIl9nZXRDdXJyZW50U2NoZW1lIiwiRGVsYXkiLCJzaG9ydERlbGF5IiwibG9uZ0RlbGF5IiwiaXNNb2JpbGUiLCJvbkxpbmUiLCJfZW11bGF0b3JVcmwiLCJjb25maWciLCJwYXRoIiwiZW11bGF0b3IiLCJ1cmwiLCJzdGFydHNXaXRoIiwiRmV0Y2hQcm92aWRlciIsImZldGNoSW1wbCIsImhlYWRlcnNJbXBsIiwicmVzcG9uc2VJbXBsIiwiUmVzcG9uc2UiLCJTRVJWRVJfRVJST1JfTUFQIiwiREVGQVVMVF9BUElfVElNRU9VVF9NUyIsIl9hZGRUaWRJZk5lY2Vzc2FyeSIsImF1dGgiLCJyZXF1ZXN0IiwidGVuYW50SWQiLCJhc3NpZ24iLCJhc3luYyIsIl9wZXJmb3JtQXBpUmVxdWVzdCIsImN1c3RvbUVycm9yTWFwIiwiX3BlcmZvcm1GZXRjaFdpdGhFcnJvckhhbmRsaW5nIiwicGFyYW1zIiwicXVlcnkiLCJhcGlLZXkiLCJfZ2V0U2RrQ2xpZW50VmVyc2lvbiIsImxhbmd1YWdlQ29kZSIsIl9nZXRGaW5hbFRhcmdldCIsImFwaUhvc3QiLCJyZWZlcnJlclBvbGljeSIsImZldGNoRm4iLCJfY2FuSW5pdEVtdWxhdG9yIiwiZXJyb3JNYXAiLCJuZXR3b3JrVGltZW91dCIsIk5ldHdvcmtUaW1lb3V0IiwicmFjZSIsImNsZWFyTmV0d29ya1RpbWVvdXQiLCJqc29uIiwiX21ha2VUYWdnZWRFcnJvciIsIm9rIiwic2VydmVyRXJyb3JDb2RlIiwiZXJyb3JNZXNzYWdlIiwiX3BlcmZvcm1TaWduSW5SZXF1ZXN0Iiwic2VydmVyUmVzcG9uc2UiLCJob3N0IiwiYmFzZSIsImFwaVNjaGVtZSIsInRpbWVyIiwiXyIsInJlamVjdCIsImVycm9yUGFyYW1zIiwiZW1haWwiLCJwaG9uZU51bWJlciIsImN1c3RvbURhdGEiLCJfdG9rZW5SZXNwb25zZSIsInV0Y1RpbWVzdGFtcFRvRGF0ZVN0cmluZyIsInV0Y1RpbWVzdGFtcCIsImRhdGUiLCJnZXRUaW1lIiwidG9VVENTdHJpbmciLCJzZWNvbmRzU3RyaW5nVG9NaWxsaXNlY29uZHMiLCJzZWNvbmRzIiwiX3BhcnNlVG9rZW4iLCJ0b2tlbiIsImFsZ29yaXRobSIsInBheWxvYWQiLCJzaWduYXR1cmUiLCJkZWNvZGVkIiwiX2xvZ291dElmSW52YWxpZGF0ZWQiLCJ1c2VyIiwiYnlwYXNzQXV0aFN0YXRlIiwiaXNVc2VySW52YWxpZGF0ZWQiLCJjdXJyZW50VXNlciIsInNpZ25PdXQiLCJQcm9hY3RpdmVSZWZyZXNoIiwiaXNSdW5uaW5nIiwidGltZXJJZCIsImVycm9yQmFja29mZiIsIl9zdGFydCIsInNjaGVkdWxlIiwiX3N0b3AiLCJnZXRJbnRlcnZhbCIsIndhc0Vycm9yIiwiaW50ZXJ2YWwiLCJzdHNUb2tlbk1hbmFnZXIiLCJleHBpcmF0aW9uVGltZSIsIml0ZXJhdGlvbiIsImdldElkVG9rZW4iLCJVc2VyTWV0YWRhdGEiLCJjcmVhdGVkQXQiLCJsYXN0TG9naW5BdCIsIl9pbml0aWFsaXplVGltZSIsImxhc3RTaWduSW5UaW1lIiwiY3JlYXRpb25UaW1lIiwiX2NvcHkiLCJtZXRhZGF0YSIsInRvSlNPTiIsIl9yZWxvYWRXaXRob3V0U2F2aW5nIiwiaWRUb2tlbiIsImdldEFjY291bnRJbmZvIiwidXNlcnMiLCJjb3JlQWNjb3VudCIsIl9ub3RpZnlSZWxvYWRMaXN0ZW5lciIsIm5ld1Byb3ZpZGVyRGF0YSIsInByb3ZpZGVyVXNlckluZm8iLCJwcm92aWRlcklkIiwidWlkIiwicmF3SWQiLCJkaXNwbGF5TmFtZSIsInBob3RvVVJMIiwicGhvdG9VcmwiLCJwcm92aWRlckRhdGEiLCJvcmlnaW5hbCIsIm5ld0RhdGEiLCJzb21lIiwib2xkSXNBbm9ueW1vdXMiLCJpc0Fub255bW91cyIsIm5ld0lzQW5vbnltb3VzIiwicGFzc3dvcmRIYXNoIiwidXBkYXRlcyIsImxvY2FsSWQiLCJlbWFpbFZlcmlmaWVkIiwiU3RzVG9rZW5NYW5hZ2VyIiwicmVmcmVzaFRva2VuIiwiYWNjZXNzVG9rZW4iLCJpc0V4cGlyZWQiLCJ1cGRhdGVGcm9tU2VydmVyUmVzcG9uc2UiLCJleHBpcmVzSW4iLCJwYXJzZWRUb2tlbiIsImV4cCIsImlhdCIsIl90b2tlbkV4cGlyZXNJbiIsInVwZGF0ZVRva2Vuc0FuZEV4cGlyYXRpb24iLCJnZXRUb2tlbiIsImZvcmNlUmVmcmVzaCIsInJlZnJlc2giLCJjbGVhclJlZnJlc2hUb2tlbiIsIm9sZFRva2VuIiwidG9rZW5BcGlIb3N0IiwiYWNjZXNzX3Rva2VuIiwiZXhwaXJlc19pbiIsInJlZnJlc2hfdG9rZW4iLCJyZXF1ZXN0U3RzVG9rZW4iLCJleHBpcmVzSW5TZWMiLCJmcm9tSlNPTiIsIm9iamVjdCIsIm1hbmFnZXIiLCJfYXNzaWduIiwiX2Nsb25lIiwiX3BlcmZvcm1SZWZyZXNoIiwiYXNzZXJ0U3RyaW5nT3JVbmRlZmluZWQiLCJVc2VySW1wbCIsIm9wdCIsInByb2FjdGl2ZVJlZnJlc2giLCJyZWxvYWRVc2VySW5mbyIsInJlbG9hZExpc3RlbmVyIiwiX3BlcnNpc3RVc2VySWZDdXJyZW50IiwiX25vdGlmeUxpc3RlbmVyc0lmQ3VycmVudCIsImdldElkVG9rZW5SZXN1bHQiLCJ1c2VySW50ZXJuYWwiLCJjbGFpbXMiLCJhdXRoX3RpbWUiLCJmaXJlYmFzZSIsInNpZ25JblByb3ZpZGVyIiwiYXV0aFRpbWUiLCJpc3N1ZWRBdFRpbWUiLCJzaWduSW5TZWNvbmRGYWN0b3IiLCJyZWxvYWQiLCJ1c2VySW5mbyIsIl9vblJlbG9hZCIsIl9zdGFydFByb2FjdGl2ZVJlZnJlc2giLCJfc3RvcFByb2FjdGl2ZVJlZnJlc2giLCJfdXBkYXRlVG9rZW5zSWZOZWNlc3NhcnkiLCJ0b2tlbnNSZWZyZXNoZWQiLCJkZWxldGVBY2NvdW50IiwiX3JlZGlyZWN0RXZlbnRJZCIsIl9mcm9tSlNPTiIsIl9mIiwiX2ciLCJfaCIsInBsYWluT2JqZWN0VG9rZW5NYW5hZ2VyIiwiX2Zyb21JZFRva2VuUmVzcG9uc2UiLCJpZFRva2VuUmVzcG9uc2UiLCJJbk1lbW9yeVBlcnNpc3RlbmNlIiwic3RvcmFnZSIsIl9pc0F2YWlsYWJsZSIsIl9zZXQiLCJfZ2V0IiwiX3JlbW92ZSIsIl9hZGRMaXN0ZW5lciIsIl9rZXkiLCJfbGlzdGVuZXIiLCJfcmVtb3ZlTGlzdGVuZXIiLCJpbk1lbW9yeVBlcnNpc3RlbmNlIiwiX3BlcnNpc3RlbmNlS2V5TmFtZSIsIlBlcnNpc3RlbmNlVXNlck1hbmFnZXIiLCJwZXJzaXN0ZW5jZSIsInVzZXJLZXkiLCJmdWxsVXNlcktleSIsImZ1bGxQZXJzaXN0ZW5jZUtleSIsImJvdW5kRXZlbnRIYW5kbGVyIiwiX29uU3RvcmFnZUV2ZW50Iiwic2V0Q3VycmVudFVzZXIiLCJnZXRDdXJyZW50VXNlciIsImJsb2IiLCJyZW1vdmVDdXJyZW50VXNlciIsInNhdmVQZXJzaXN0ZW5jZUZvclJlZGlyZWN0Iiwic2V0UGVyc2lzdGVuY2UiLCJuZXdQZXJzaXN0ZW5jZSIsInBlcnNpc3RlbmNlSGllcmFyY2h5IiwiYXZhaWxhYmxlUGVyc2lzdGVuY2VzIiwic2VsZWN0ZWRQZXJzaXN0ZW5jZSIsInVzZXJUb01pZ3JhdGUiLCJtaWdyYXRpb25IaWVyYXJjaHkiLCJfc2hvdWxkQWxsb3dNaWdyYXRpb24iLCJfZ2V0QnJvd3Nlck5hbWUiLCJpbmNsdWRlcyIsIl9pc0lFTW9iaWxlIiwiX2lzRmlyZWZveCIsIl9pc0JsYWNrQmVycnkiLCJfaXNXZWJPUyIsIl9pc1NhZmFyaSIsIl9pc0Nocm9tZUlPUyIsIl9pc0FuZHJvaWQiLCJyZSIsIm1hdGNoZXMiLCJfaXNJT1MiLCJfaXNNb2JpbGVCcm93c2VyIiwiX2dldENsaWVudFZlcnNpb24iLCJjbGllbnRQbGF0Zm9ybSIsImZyYW1ld29ya3MiLCJyZXBvcnRlZFBsYXRmb3JtIiwicmVwb3J0ZWRGcmFtZXdvcmtzIiwiQXV0aEltcGwiLCJhcHAiLCJlbXVsYXRvckNvbmZpZyIsIm9wZXJhdGlvbnMiLCJhdXRoU3RhdGVTdWJzY3JpcHRpb24iLCJTdWJzY3JpcHRpb24iLCJpZFRva2VuU3Vic2NyaXB0aW9uIiwicmVkaXJlY3RVc2VyIiwiaXNQcm9hY3RpdmVSZWZyZXNoRW5hYmxlZCIsIl9pc0luaXRpYWxpemVkIiwiX2RlbGV0ZWQiLCJfaW5pdGlhbGl6YXRpb25Qcm9taXNlIiwiX3BvcHVwUmVkaXJlY3RSZXNvbHZlciIsImxhc3ROb3RpZmllZFVpZCIsInNldHRpbmdzIiwiYXBwVmVyaWZpY2F0aW9uRGlzYWJsZWRGb3JUZXN0aW5nIiwiY2xpZW50VmVyc2lvbiIsInNka0NsaWVudFZlcnNpb24iLCJfaW5pdGlhbGl6ZVdpdGhQZXJzaXN0ZW5jZSIsInBvcHVwUmVkaXJlY3RSZXNvbHZlciIsInF1ZXVlIiwicGVyc2lzdGVuY2VNYW5hZ2VyIiwiX3Nob3VsZEluaXRQcm9hY3RpdmVseSIsIl9pbml0aWFsaXplIiwiaW5pdGlhbGl6ZUN1cnJlbnRVc2VyIiwiYXNzZXJ0ZWRQZXJzaXN0ZW5jZSIsIl9jdXJyZW50VXNlciIsIl91cGRhdGVDdXJyZW50VXNlciIsInN0b3JlZFVzZXIiLCJhdXRoRG9tYWluIiwiZ2V0T3JJbml0UmVkaXJlY3RQZXJzaXN0ZW5jZU1hbmFnZXIiLCJyZWRpcmVjdFVzZXJFdmVudElkIiwic3RvcmVkVXNlckV2ZW50SWQiLCJyZXN1bHQiLCJ0cnlSZWRpcmVjdFNpZ25JbiIsImRpcmVjdGx5U2V0Q3VycmVudFVzZXIiLCJyZWxvYWRBbmRTZXRDdXJyZW50VXNlck9yQ2xlYXIiLCJyZWRpcmVjdFJlc29sdmVyIiwiX2NvbXBsZXRlUmVkaXJlY3RGbiIsIl9zZXRSZWRpcmVjdFVzZXIiLCJ1c2VEZXZpY2VMYW5ndWFnZSIsIm5hdmlnYXRvckxhbmd1YWdlIiwibGFuZ3VhZ2VzIiwibGFuZ3VhZ2UiLCJfZ2V0VXNlckxhbmd1YWdlIiwidXBkYXRlQ3VycmVudFVzZXIiLCJ1c2VyRXh0ZXJuIiwibm90aWZ5QXV0aExpc3RlbmVycyIsInJlZGlyZWN0UGVyc2lzdGVuY2VNYW5hZ2VyIiwiX2dldFBlcnNpc3RlbmNlIiwiX3VwZGF0ZUVycm9yTWFwIiwib25BdXRoU3RhdGVDaGFuZ2VkIiwibmV4dE9yT2JzZXJ2ZXIiLCJjb21wbGV0ZWQiLCJyZWdpc3RlclN0YXRlTGlzdGVuZXIiLCJvbklkVG9rZW5DaGFuZ2VkIiwicmVkaXJlY3RNYW5hZ2VyIiwicmVzb2x2ZXIiLCJfcmVkaXJlY3RQZXJzaXN0ZW5jZSIsIl9yZWRpcmVjdFVzZXJGb3JJZCIsImN1cnJlbnRVaWQiLCJzdWJzY3JpcHRpb24iLCJhZGRPYnNlcnZlciIsImFjdGlvbiIsIl9sb2dGcmFtZXdvcmsiLCJmcmFtZXdvcmsiLCJzb3J0IiwiX2dldEZyYW1ld29ya3MiLCJfY2FzdEF1dGgiLCJvYnNlcnZlciIsIkF1dGhDcmVkZW50aWFsIiwic2lnbkluTWV0aG9kIiwiX2dldElkVG9rZW5SZXNwb25zZSIsIl9hdXRoIiwiX2xpbmtUb0lkVG9rZW4iLCJfaWRUb2tlbiIsIl9nZXRSZWF1dGhlbnRpY2F0aW9uUmVzb2x2ZXIiLCJFbWFpbEF1dGhDcmVkZW50aWFsIiwiX2VtYWlsIiwiX3Bhc3N3b3JkIiwiX3RlbmFudElkIiwic3VwZXIiLCJfZnJvbUVtYWlsQW5kUGFzc3dvcmQiLCJwYXNzd29yZCIsIl9mcm9tRW1haWxBbmRDb2RlIiwib29iQ29kZSIsIm9iaiIsInNpZ25JbldpdGhQYXNzd29yZCIsInJldHVyblNlY3VyZVRva2VuIiwic2lnbkluV2l0aEVtYWlsTGluayQxIiwidXBkYXRlRW1haWxQYXNzd29yZCIsInNpZ25JbldpdGhFbWFpbExpbmtGb3JMaW5raW5nIiwic2lnbkluV2l0aElkcCIsIk9BdXRoQ3JlZGVudGlhbCIsInBlbmRpbmdUb2tlbiIsIl9mcm9tUGFyYW1zIiwiY3JlZCIsIm5vbmNlIiwib2F1dGhUb2tlbiIsIm9hdXRoVG9rZW5TZWNyZXQiLCJzZWNyZXQiLCJidWlsZFJlcXVlc3QiLCJhdXRvQ3JlYXRlIiwicmVxdWVzdFVyaSIsInBvc3RCb2R5IiwiVkVSSUZZX1BIT05FX05VTUJFUl9GT1JfRVhJU1RJTkdfRVJST1JfTUFQXyIsIlBob25lQXV0aENyZWRlbnRpYWwiLCJfZnJvbVZlcmlmaWNhdGlvbiIsInZlcmlmaWNhdGlvbklkIiwidmVyaWZpY2F0aW9uQ29kZSIsIl9mcm9tVG9rZW5SZXNwb25zZSIsInRlbXBvcmFyeVByb29mIiwic2lnbkluV2l0aFBob25lTnVtYmVyJDEiLCJfbWFrZVZlcmlmaWNhdGlvblJlcXVlc3QiLCJsaW5rV2l0aFBob25lTnVtYmVyJDEiLCJvcGVyYXRpb24iLCJ2ZXJpZnlQaG9uZU51bWJlckZvckV4aXN0aW5nIiwic2Vzc2lvbkluZm8iLCJBY3Rpb25Db2RlVVJMIiwiYWN0aW9uTGluayIsInNlYXJjaFBhcmFtcyIsInBhcnNlTW9kZSIsImNvbnRpbnVlVXJsIiwicGFyc2VMaW5rIiwibGluayIsImRvdWJsZURlZXBMaW5rIiwiaU9TRGVlcExpbmsiLCJwYXJzZURlZXBMaW5rIiwiRW1haWxBdXRoUHJvdmlkZXIiLCJQUk9WSURFUl9JRCIsImNyZWRlbnRpYWwiLCJjcmVkZW50aWFsV2l0aExpbmsiLCJlbWFpbExpbmsiLCJhY3Rpb25Db2RlVXJsIiwiRU1BSUxfUEFTU1dPUkRfU0lHTl9JTl9NRVRIT0QiLCJFTUFJTF9MSU5LX1NJR05fSU5fTUVUSE9EIiwiRmVkZXJhdGVkQXV0aFByb3ZpZGVyIiwiZGVmYXVsdExhbmd1YWdlQ29kZSIsImN1c3RvbVBhcmFtZXRlcnMiLCJzZXREZWZhdWx0TGFuZ3VhZ2UiLCJzZXRDdXN0b21QYXJhbWV0ZXJzIiwiY3VzdG9tT0F1dGhQYXJhbWV0ZXJzIiwiZ2V0Q3VzdG9tUGFyYW1ldGVycyIsIkJhc2VPQXV0aFByb3ZpZGVyIiwic2NvcGVzIiwiYWRkU2NvcGUiLCJzY29wZSIsImdldFNjb3BlcyIsIkZhY2Vib29rQXV0aFByb3ZpZGVyIiwiRkFDRUJPT0tfU0lHTl9JTl9NRVRIT0QiLCJjcmVkZW50aWFsRnJvbVJlc3VsdCIsInVzZXJDcmVkZW50aWFsIiwiY3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3QiLCJjcmVkZW50aWFsRnJvbUVycm9yIiwidG9rZW5SZXNwb25zZSIsIm9hdXRoQWNjZXNzVG9rZW4iLCJHb29nbGVBdXRoUHJvdmlkZXIiLCJHT09HTEVfU0lHTl9JTl9NRVRIT0QiLCJvYXV0aElkVG9rZW4iLCJHaXRodWJBdXRoUHJvdmlkZXIiLCJHSVRIVUJfU0lHTl9JTl9NRVRIT0QiLCJUd2l0dGVyQXV0aFByb3ZpZGVyIiwiVFdJVFRFUl9TSUdOX0lOX01FVEhPRCIsIlVzZXJDcmVkZW50aWFsSW1wbCIsIm9wZXJhdGlvblR5cGUiLCJwcm92aWRlcklkRm9yUmVzcG9uc2UiLCJfZm9yT3BlcmF0aW9uIiwiTXVsdGlGYWN0b3JFcnJvciIsIl9mcm9tRXJyb3JBbmRPcGVyYXRpb24iLCJfcHJvY2Vzc0NyZWRlbnRpYWxTYXZpbmdNZmFDb250ZXh0SWZOZWNlc3NhcnkiLCJXZWFrTWFwIiwiU1RPUkFHRV9BVkFJTEFCTEVfS0VZIiwiQnJvd3NlclBlcnNpc3RlbmNlQ2xhc3MiLCJzZXRJdGVtIiwicmVtb3ZlSXRlbSIsImdldEl0ZW0iLCJCcm93c2VyTG9jYWxQZXJzaXN0ZW5jZSIsImxvY2FsU3RvcmFnZSIsImxpc3RlbmVycyIsImxvY2FsQ2FjaGUiLCJwb2xsVGltZXIiLCJzYWZhcmlMb2NhbFN0b3JhZ2VOb3RTeW5jZWQiLCJfaWZyYW1lQ2Fubm90U3luY1dlYlN0b3JhZ2UiLCJ0b3AiLCJfaXNJZnJhbWUiLCJmYWxsYmFja1RvUG9sbGluZyIsIm9uU3RvcmFnZUV2ZW50IiwiZm9yQWxsQ2hhbmdlZEtleXMiLCJrZXlzIiwibmV3VmFsdWUiLCJvbGRWYWx1ZSIsImV2ZW50IiwicG9sbCIsIl9vbGRWYWx1ZSIsIm5vdGlmeUxpc3RlbmVycyIsImRldGFjaExpc3RlbmVyIiwic3RvcFBvbGxpbmciLCJzdG9yZWRWYWx1ZSIsInRyaWdnZXJMaXN0ZW5lcnMiLCJzdGFydFBvbGxpbmciLCJzZXRJbnRlcnZhbCIsIlN0b3JhZ2VFdmVudCIsImNsZWFySW50ZXJ2YWwiLCJhdHRhY2hMaXN0ZW5lciIsImJyb3dzZXJMb2NhbFBlcnNpc3RlbmNlIiwiQnJvd3NlclNlc3Npb25QZXJzaXN0ZW5jZSIsInNlc3Npb25TdG9yYWdlIiwiYnJvd3NlclNlc3Npb25QZXJzaXN0ZW5jZSIsIlJlY2VpdmVyIiwiZXZlbnRUYXJnZXQiLCJoYW5kbGVyc01hcCIsInJlY2VpdmVycyIsImZpbmQiLCJyZWNlaXZlciIsImlzTGlzdGVuaW5ndG8iLCJuZXdJbnN0YW5jZSIsIm1lc3NhZ2VFdmVudCIsImV2ZW50SWQiLCJldmVudFR5cGUiLCJoYW5kbGVycyIsInBvcnRzIiwicG9zdE1lc3NhZ2UiLCJwcm9taXNlcyIsImhhbmRsZXIiLCJvcmlnaW4iLCJmdWxmaWxsZWQiLCJyZWFzb24iLCJfYWxsU2V0dGxlZCIsIl9zdWJzY3JpYmUiLCJldmVudEhhbmRsZXIiLCJfdW5zdWJzY3JpYmUiLCJfZ2VuZXJhdGVFdmVudElkIiwicHJlZml4IiwiZGlnaXRzIiwiU2VuZGVyIiwicmVtb3ZlTWVzc2FnZUhhbmRsZXIiLCJtZXNzYWdlQ2hhbm5lbCIsInBvcnQxIiwib25NZXNzYWdlIiwiX3NlbmQiLCJNZXNzYWdlQ2hhbm5lbCIsImNvbXBsZXRpb25UaW1lciIsImFja1RpbWVyIiwicG9ydDIiLCJmaW5hbGx5IiwiX3dpbmRvdyIsIl9pc1dvcmtlciIsIkRCX05BTUUiLCJEQl9PQkpFQ1RTVE9SRV9OQU1FIiwiREJfREFUQV9LRVlQQVRIIiwiREJQcm9taXNlIiwidG9Qcm9taXNlIiwiZ2V0T2JqZWN0U3RvcmUiLCJpc1JlYWRXcml0ZSIsInRyYW5zYWN0aW9uIiwib2JqZWN0U3RvcmUiLCJfb3BlbkRhdGFiYXNlIiwiaW5kZXhlZERCIiwiY3JlYXRlT2JqZWN0U3RvcmUiLCJrZXlQYXRoIiwib2JqZWN0U3RvcmVOYW1lcyIsImNvbnRhaW5zIiwiZGVsZXRlRGF0YWJhc2UiLCJfZGVsZXRlRGF0YWJhc2UiLCJfcHV0T2JqZWN0IiwicHV0IiwiX2RlbGV0ZU9iamVjdCIsIkluZGV4ZWREQkxvY2FsUGVyc2lzdGVuY2UiLCJwZW5kaW5nV3JpdGVzIiwic2VuZGVyIiwic2VydmljZVdvcmtlclJlY2VpdmVyQXZhaWxhYmxlIiwiYWN0aXZlU2VydmljZVdvcmtlciIsIl93b3JrZXJJbml0aWFsaXphdGlvblByb21pc2UiLCJpbml0aWFsaXplU2VydmljZVdvcmtlck1lc3NhZ2luZyIsIl9vcGVuRGIiLCJfd2l0aFJldHJpZXMiLCJvcCIsIm51bUF0dGVtcHRzIiwiaW5pdGlhbGl6ZVJlY2VpdmVyIiwiaW5pdGlhbGl6ZVNlbmRlciIsIl9vcmlnaW4iLCJrZXlQcm9jZXNzZWQiLCJfcG9sbCIsIl9kYXRhIiwic2VydmljZVdvcmtlciIsInJlYWR5IiwiYWN0aXZlIiwiX2dldEFjdGl2ZVNlcnZpY2VXb3JrZXIiLCJyZXN1bHRzIiwibm90aWZ5U2VydmljZVdvcmtlciIsImNvbnRyb2xsZXIiLCJfd2l0aFBlbmRpbmdXcml0ZSIsIndyaXRlIiwiZ2V0T2JqZWN0IiwiZ2V0QWxsUmVxdWVzdCIsImdldEFsbCIsImtleXNJblJlc3VsdCIsImZiYXNlX2tleSIsImxvY2FsS2V5IiwiaW5kZXhlZERCTG9jYWxQZXJzaXN0ZW5jZSIsIl9nZW5lcmF0ZUNhbGxiYWNrTmFtZSIsIlBob25lQXV0aFByb3ZpZGVyIiwidmVyaWZ5UGhvbmVOdW1iZXIiLCJwaG9uZU9wdGlvbnMiLCJhcHBsaWNhdGlvblZlcmlmaWVyIiwidmVyaWZpZXIiLCJyZWNhcHRjaGFUb2tlbiIsInZlcmlmeSIsInBob25lSW5mb09wdGlvbnMiLCJzZXNzaW9uIiwic3RhcnRFbnJvbGxQaG9uZU1mYSIsInBob25lRW5yb2xsbWVudEluZm8iLCJwaG9uZVNlc3Npb25JbmZvIiwibWZhRW5yb2xsbWVudElkIiwibXVsdGlGYWN0b3JIaW50IiwibXVsdGlGYWN0b3JVaWQiLCJzdGFydFNpZ25JblBob25lTWZhIiwibWZhUGVuZGluZ0NyZWRlbnRpYWwiLCJwaG9uZVNpZ25JbkluZm8iLCJwaG9uZVJlc3BvbnNlSW5mbyIsInNlbmRQaG9uZVZlcmlmaWNhdGlvbkNvZGUiLCJfcmVzZXQiLCJfdmVyaWZ5UGhvbmVOdW1iZXIiLCJQSE9ORV9TSUdOX0lOX01FVEhPRCIsIklkcENyZWRlbnRpYWwiLCJfYnVpbGRJZHBSZXF1ZXN0Iiwic2Vzc2lvbklkIiwicmV0dXJuSWRwQ3JlZGVudGlhbCIsIl9zaWduSW4iLCJfc2lnbkluV2l0aENyZWRlbnRpYWwiLCJfcmVhdXRoIiwicGFyc2VkIiwic3ViIiwiX3JlYXV0aGVudGljYXRlIiwiX2xpbmsiLCJfbGluayQxIiwiQWJzdHJhY3RQb3B1cFJlZGlyZWN0T3BlcmF0aW9uIiwicGVuZGluZ1Byb21pc2UiLCJldmVudE1hbmFnZXIiLCJleGVjdXRlIiwib25FeGVjdXRpb24iLCJyZWdpc3RlckNvbnN1bWVyIiwib25BdXRoRXZlbnQiLCJ1cmxSZXNwb25zZSIsImdldElkcFRhc2siLCJvbkVycm9yIiwidW5yZWdpc3RlckFuZENsZWFuVXAiLCJ1bnJlZ2lzdGVyQ29uc3VtZXIiLCJjbGVhblVwIiwiX1BPTExfV0lORE9XX0NMT1NFX1RJTUVPVVQiLCJQb3B1cE9wZXJhdGlvbiIsImF1dGhXaW5kb3ciLCJwb2xsSWQiLCJjdXJyZW50UG9wdXBBY3Rpb24iLCJleGVjdXRlTm90TnVsbCIsIl9vcGVuUG9wdXAiLCJhc3NvY2lhdGVkRXZlbnQiLCJfb3JpZ2luVmFsaWRhdGlvbiIsIl9pc0lmcmFtZVdlYlN0b3JhZ2VTdXBwb3J0ZWQiLCJpc1N1cHBvcnRlZCIsInBvbGxVc2VyQ2FuY2VsbGF0aW9uIiwiY2xvc2VkIiwicmVkaXJlY3RPdXRjb21lTWFwIiwiUmVkaXJlY3RBY3Rpb24iLCJyZWFkeU91dGNvbWUiLCJwZW5kaW5nUmVkaXJlY3RLZXkiLCJoYXNQZW5kaW5nUmVkaXJlY3QiLCJyZXNvbHZlclBlcnNpc3RlbmNlIiwiX2dldEFuZENsZWFyUGVuZGluZ1JlZGlyZWN0U3RhdHVzIiwiX2dldFJlZGlyZWN0UmVzdWx0IiwicmVzb2x2ZXJFeHRlcm4iLCJhdXRoSW50ZXJuYWwiLCJyZXNvbHZlck92ZXJyaWRlIiwiX3dpdGhEZWZhdWx0UmVzb2x2ZXIiLCJBdXRoRXZlbnRNYW5hZ2VyIiwiY2FjaGVkRXZlbnRVaWRzIiwiY29uc3VtZXJzIiwicXVldWVkUmVkaXJlY3RFdmVudCIsImhhc0hhbmRsZWRQb3RlbnRpYWxSZWRpcmVjdCIsImxhc3RQcm9jZXNzZWRFdmVudFRpbWUiLCJhdXRoRXZlbnRDb25zdW1lciIsImlzRXZlbnRGb3JDb25zdW1lciIsInNlbmRUb0NvbnN1bWVyIiwic2F2ZUV2ZW50VG9DYWNoZSIsIm9uRXZlbnQiLCJoYXNFdmVudEJlZW5IYW5kbGVkIiwiaGFuZGxlZCIsImNvbnN1bWVyIiwiaXNOdWxsUmVkaXJlY3RFdmVudCIsImlzUmVkaXJlY3RFdmVudCIsImV2ZW50SWRNYXRjaGVzIiwiZXZlbnRVaWQiLCJJUF9BRERSRVNTX1JFR0VYIiwiSFRUUF9SRUdFWCIsIm1hdGNoRG9tYWluIiwiZXhwZWN0ZWQiLCJjdXJyZW50VXJsIiwiVVJMIiwiY2VVcmwiLCJlc2NhcGVkRG9tYWluUGF0dGVybiIsIlJlZ0V4cCIsIk5FVFdPUktfVElNRU9VVCIsInJlc2V0VW5sb2FkZWRHYXBpTW9kdWxlcyIsImJlYWNvbiIsIl9fX2pzbCIsImhpbnQiLCJDUCIsImNhY2hlZEdBcGlMb2FkZXIiLCJfbG9hZEdhcGkiLCJsb2FkR2FwaUlmcmFtZSIsImdhcGkiLCJsb2FkIiwiaWZyYW1lcyIsImdldENvbnRleHQiLCJJZnJhbWUiLCJjYk5hbWUiLCJlbCIsImNyZWF0ZUVsZW1lbnQiLCJzZXRBdHRyaWJ1dGUiLCJjaGFyc2V0IiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJhcHBlbmRDaGlsZCIsImxvYWRHYXBpIiwiUElOR19USU1FT1VUIiwiSUZSQU1FX0FUVFJJQlVURVMiLCJzdHlsZSIsInBvc2l0aW9uIiwid2lkdGgiLCJoZWlnaHQiLCJFSURfRlJPTV9BUElIT1NUIiwiZ2V0SWZyYW1lVXJsIiwiZWlkIiwiZnciLCJCQVNFX1BPUFVQX09QVElPTlMiLCJyZXNpemFibGUiLCJzdGF0dXNiYXIiLCJ0b29sYmFyIiwiQXV0aFBvcHVwIiwiX2dldFJlZGlyZWN0VXJsIiwiYXV0aFR5cGUiLCJyZWRpcmVjdFVybCIsImFkZGl0aW9uYWxQYXJhbXMiLCJ0aWQiLCJwYXJhbXNEaWN0IiwiZ2V0SGFuZGxlckJhc2UiLCJXRUJfU1RPUkFHRV9TVVBQT1JUX0tFWSIsImJyb3dzZXJQb3B1cFJlZGlyZWN0UmVzb2x2ZXIiLCJldmVudE1hbmFnZXJzIiwib3JpZ2luVmFsaWRhdGlvblByb21pc2VzIiwic2NyZWVuIiwiYXZhaWxIZWlnaHQiLCJsZWZ0IiwiYXZhaWxXaWR0aCIsInNjcm9sbGJhcnMiLCJvcHRpb25zU3RyaW5nIiwicmVkdWNlIiwiYWNjdW0iLCJzdGFuZGFsb25lIiwiX2lzSU9TU3RhbmRhbG9uZSIsImNsaWNrIiwiY3JlYXRlRXZlbnQiLCJpbml0TW91c2VFdmVudCIsImRpc3BhdGNoRXZlbnQiLCJvcGVuQXNOZXdXaW5kb3dJT1MiLCJuZXdXaW4iLCJmb2N1cyIsIl9vcGVuIiwiX29wZW5SZWRpcmVjdCIsImluaXRBbmRHZXRNYW5hZ2VyIiwiaWZyYW1lIiwiY29udGV4dCIsIndoZXJlIiwibWVzc2FnZUhhbmRsZXJzRmlsdGVyIiwiQ1JPU1NfT1JJR0lOX0lGUkFNRVNfRklMVEVSIiwiYXR0cmlidXRlcyIsImRvbnRjbGVhciIsInJlc3R5bGUiLCJzZXRIaWRlT25MZWF2ZSIsIm5ldHdvcmtFcnJvciIsIm5ldHdvcmtFcnJvclRpbWVyIiwiY2xlYXJUaW1lckFuZFJlc29sdmUiLCJwaW5nIiwiX29wZW5JZnJhbWUiLCJyZWdpc3RlciIsImlmcmFtZUV2ZW50IiwiYXV0aEV2ZW50IiwiYXV0aG9yaXplZERvbWFpbnMiLCJfZ2V0UHJvamVjdENvbmZpZyIsImRvbWFpbiIsIl92YWxpZGF0ZU9yaWdpbiIsIkF1dGhJbnRlcm9wIiwiaW50ZXJuYWxMaXN0ZW5lcnMiLCJnZXRVaWQiLCJhc3NlcnRBdXRoQ29uZmlndXJlZCIsImFkZEF1dGhUb2tlbkxpc3RlbmVyIiwidW5zdWJzY3JpYmUiLCJ1cGRhdGVQcm9hY3RpdmVSZWZyZXNoIiwicmVtb3ZlQXV0aFRva2VuTGlzdGVuZXIiLCJnZXRBdXRoIiwiZGVwcyIsImluaXRpYWxPcHRpb25zIiwiaW5pdGlhbGl6ZUF1dGgiLCJhdXRoSW5zdGFuY2UiLCJoaWVyYXJjaHkiLCJfaW5pdGlhbGl6ZUF1dGhJbnN0YW5jZSIsIl9pbnN0YW5jZUlkZW50aWZpZXIiLCJfaW5zdGFuY2UiLCJnZXRWZXJzaW9uRm9yUGxhdGZvcm0iLCJwcm9qZWN0SWQiLCJzdG9yYWdlQnVja2V0IiwibWVzc2FnaW5nU2VuZGVySWQiLCJhcHBJZCIsIm1lYXN1cmVtZW50SWQiLCJERUZBVUxUX0hPU1QiLCJDT05GSUdfU1RPUkFHRV9CVUNLRVRfS0VZIiwiU3RvcmFnZUVycm9yIiwicHJlcGVuZENvZGUiLCJfYmFzZU1lc3NhZ2UiLCJfY29kZUVxdWFscyIsInVua25vd24iLCJpbnZhbGlkQXJndW1lbnQiLCJhcHBEZWxldGVkIiwiaW52YWxpZEZvcm1hdCIsImZvcm1hdCIsImludGVybmFsRXJyb3IiLCJYaHJDb25uZWN0aW9uIiwic2VudF8iLCJ4aHJfIiwiZXJyb3JDb2RlXyIsInNlbmRQcm9taXNlXyIsIkFCT1JUIiwiTkVUV09SS19FUlJPUiIsImdldEVycm9yQ29kZSIsImhlYWRlciIsImFkZFVwbG9hZFByb2dyZXNzTGlzdGVuZXIiLCJ1cGxvYWQiLCJyZW1vdmVVcGxvYWRQcm9ncmVzc0xpc3RlbmVyIiwiQ29ubmVjdGlvblBvb2wiLCJjcmVhdGVDb25uZWN0aW9uIiwiTG9jYXRpb24iLCJidWNrZXQiLCJwYXRoXyIsImlzUm9vdCIsImZ1bGxTZXJ2ZXJVcmwiLCJlbmNvZGUiLCJidWNrZXRPbmx5U2VydmVyVXJsIiwibWFrZUZyb21CdWNrZXRTcGVjIiwiYnVja2V0U3RyaW5nIiwiYnVja2V0TG9jYXRpb24iLCJtYWtlRnJvbVVybCIsImJ1Y2tldERvbWFpbiIsImdzUmVnZXgiLCJodHRwTW9kaWZ5IiwibG9jIiwiZmlyZWJhc2VTdG9yYWdlSG9zdCIsImdyb3VwcyIsInJlZ2V4IiwiaW5kaWNlcyIsInBvc3RNb2RpZnkiLCJncm91cCIsImNhcHR1cmVzIiwiYnVja2V0VmFsdWUiLCJwYXRoVmFsdWUiLCJpbnZhbGlkVXJsIiwiRmFpbFJlcXVlc3QiLCJwcm9taXNlXyIsImdldFByb21pc2UiLCJfYXBwRGVsZXRlIiwiaXNTdHJpbmciLCJpc05hdGl2ZUJsb2IiLCJpc05hdGl2ZUJsb2JEZWZpbmVkIiwiQmxvYiIsInZhbGlkYXRlTnVtYmVyIiwiYXJndW1lbnQiLCJtaW5WYWx1ZSIsIm1heFZhbHVlIiwibWFrZVVybCIsInVybFBhcnQiLCJwcm90b2NvbE1hdGNoIiwibWFrZVF1ZXJ5U3RyaW5nIiwicXVlcnlQYXJ0IiwiTmV0d29ya1JlcXVlc3QiLCJzdWNjZXNzQ29kZXMiLCJhZGRpdGlvbmFsUmV0cnlDb2RlcyIsImVycm9yQ2FsbGJhY2siLCJwcm9ncmVzc0NhbGxiYWNrIiwicG9vbCIsInBlbmRpbmdDb25uZWN0aW9uXyIsImJhY2tvZmZJZF8iLCJjYW5jZWxlZF8iLCJhcHBEZWxldGVfIiwidXJsXyIsIm1ldGhvZF8iLCJoZWFkZXJzXyIsImJvZHlfIiwic3VjY2Vzc0NvZGVzXyIsImFkZGl0aW9uYWxSZXRyeUNvZGVzXyIsImNhbGxiYWNrXyIsImVycm9yQ2FsbGJhY2tfIiwicHJvZ3Jlc3NDYWxsYmFja18iLCJ0aW1lb3V0XyIsInBvb2xfIiwicmVzb2x2ZV8iLCJyZWplY3RfIiwic3RhcnRfIiwiYmFja29mZkRvbmUiLCJyZXF1ZXN0V2VudFRocm91Z2giLCJjb25uZWN0aW9uIiwid2FzU3VjY2Vzc0NvZGUiLCJlcnIiLCJjYW5jZWxlZCIsIlJlcXVlc3RFbmRTdGF0dXMiLCJ3YWl0U2Vjb25kcyIsInRpbWVvdXRJZCIsImhpdFRpbWVvdXQiLCJjYW5jZWxTdGF0ZSIsInRyaWdnZXJlZENhbGxiYWNrIiwidHJpZ2dlckNhbGxiYWNrIiwiY2FsbFdpdGhEZWxheSIsIm1pbGxpcyIsImJhY2tvZmZDYWxsYmFjayIsInByb2dyZXNzTGlzdGVuZXIiLCJwcm9ncmVzc0V2ZW50IiwibG9hZGVkIiwidG90YWwiLCJsZW5ndGhDb21wdXRhYmxlIiwiaGl0U2VydmVyIiwiaXNSZXRyeVN0YXR1c0NvZGVfIiwid2FzQ2FuY2VsZWQiLCJzdWNjZXNzQ29kZSIsInN1Y2Nlc3MiLCJ3YWl0TWlsbGlzIiwic3RvcHBlZCIsInN0b3AiLCJ3YXNUaW1lb3V0IiwiYXBwRGVsZXRlIiwiaXNGaXZlSHVuZHJlZENvZGUiLCJpc0V4dHJhUmV0cnlDb2RlIiwiaXNSZXF1ZXN0U3BlY2lmaWNSZXRyeUNvZGUiLCJnZXRCbG9iQnVpbGRlciIsIkJsb2JCdWlsZGVyIiwiV2ViS2l0QmxvYkJ1aWxkZXIiLCJnZXRCbG9iIiwiU3RyaW5nRm9ybWF0IiwiU3RyaW5nRGF0YSIsImNvbnRlbnRUeXBlIiwidXRmOEJ5dGVzXyIsImJhc2U2NEJ5dGVzXyIsImhhc01pbnVzIiwiaGFzVW5kZXIiLCJoYXNQbHVzIiwiaGFzU2xhc2giLCJieXRlcyIsImF0b2IiLCJhcnJheSIsIkRhdGFVUkxQYXJ0cyIsImRhdGFVUkwiLCJiYXNlNjQiLCJtaWRkbGUiLCJlbmQiLCJGYnNCbG9iIiwiZWxpZGVDb3B5IiwiYmxvYlR5cGUiLCJkYXRhXyIsIkFycmF5QnVmZmVyIiwiYnl0ZUxlbmd0aCIsInNpemVfIiwidHlwZV8iLCJzdGFydEJ5dGUiLCJlbmRCeXRlIiwic2xpY2VkIiwid2Via2l0U2xpY2UiLCJtb3pTbGljZSIsImJ1ZmZlciIsImJsb2JieSIsInZhbCIsInVpbnQ4QXJyYXlzIiwic3RyaW5nRGF0YSIsImRhdGFVcmwiLCJwYXJ0cyIsInBlcmNlbnRFbmNvZGVkQnl0ZXNfIiwiZGF0YVVSTEJ5dGVzXyIsImRhdGFGcm9tU3RyaW5nIiwiZmluYWxMZW5ndGgiLCJtZXJnZWQiLCJpbmRleCIsInVwbG9hZERhdGEiLCJqc29uT2JqZWN0T3JOdWxsIiwibGFzdENvbXBvbmVudCIsImxhc3RJbmRleE9mIiwibm9YZm9ybV8iLCJNYXBwaW5nIiwic2VydmVyIiwibG9jYWwiLCJ3cml0YWJsZSIsInhmb3JtIiwibWFwcGluZ3NfIiwiZ2V0TWFwcGluZ3MiLCJtYXBwaW5ncyIsIm5hbWVNYXBwaW5nIiwiX21ldGFkYXRhIiwiZnVsbFBhdGgiLCJ4Zm9ybVBhdGgiLCJzaXplTWFwcGluZyIsImZyb21SZXNvdXJjZVN0cmluZyIsInJlc291cmNlU3RyaW5nIiwicmVzb3VyY2UiLCJsZW4iLCJtYXBwaW5nIiwiX21ha2VTdG9yYWdlUmVmZXJlbmNlIiwiYWRkUmVmIiwiZnJvbVJlc291cmNlIiwiUmVxdWVzdEluZm8iLCJ1cmxQYXJhbXMiLCJlcnJvckhhbmRsZXIiLCJoYW5kbGVyQ2hlY2siLCJjbmRuIiwic2hhcmVkRXJyb3JIYW5kbGVyIiwieGhyIiwibmV3RXJyIiwibXVsdGlwYXJ0VXBsb2FkIiwiYm91bmRhcnkiLCJzdHIiLCJnZW5Cb3VuZGFyeSIsIm1ldGFkYXRhXyIsIm1ldGFkYXRhQ2xvbmUiLCJkZXRlcm1pbmVDb250ZW50VHlwZV8iLCJtZXRhZGF0YUZvclVwbG9hZF8iLCJwcmVCbG9iUGFydCIsInRvUmVzb3VyY2VTdHJpbmciLCJwb3N0QmxvYlBhcnQiLCJtYXhVcGxvYWRSZXRyeVRpbWUiLCJyZXF1ZXN0SW5mbyIsIm1ldGFkYXRhSGFuZGxlciIsIlJlZmVyZW5jZSIsIl9zZXJ2aWNlIiwiX2xvY2F0aW9uIiwiX25ld1JlZiIsInJvb3QiLCJwYXJlbnQiLCJuZXdQYXRoIiwiX3Rocm93SWZSb290IiwiaW52YWxpZFJvb3RPcGVyYXRpb24iLCJnZXREb3dubG9hZFVSTCQxIiwicmVmIiwibWF4T3BlcmF0aW9uUmV0cnlUaW1lIiwidG9rZW5zIiwiYWx0IiwiZG93bmxvYWRVcmxGcm9tUmVzb3VyY2VTdHJpbmciLCJkb3dubG9hZFVybEhhbmRsZXIiLCJzaGFyZWQiLCJvYmplY3RFcnJvckhhbmRsZXIiLCJnZXREb3dubG9hZFVybCIsIm1ha2VSZXF1ZXN0V2l0aFRva2VucyIsInJlZkZyb21QYXRoIiwiRmlyZWJhc2VTdG9yYWdlSW1wbCIsIl9idWNrZXQiLCJyZWZlcmVuY2UiLCJjaGlsZFBhdGgiLCJjYW5vbmljYWxDaGlsZFBhdGgiLCJjaGlsZCIsIl9nZXRDaGlsZCQxIiwiZXh0cmFjdEJ1Y2tldCIsIl9hdXRoUHJvdmlkZXIiLCJfYXBwQ2hlY2tQcm92aWRlciIsIl9wb29sIiwiX3VybCIsIl9maXJlYmFzZVZlcnNpb24iLCJfaG9zdCIsIl9hcHBJZCIsIl9tYXhPcGVyYXRpb25SZXRyeVRpbWUiLCJfbWF4VXBsb2FkUmV0cnlUaW1lIiwiX3JlcXVlc3RzIiwidGltZSIsIlBPU0lUSVZFX0lORklOSVRZIiwiX2dldEF1dGhUb2tlbiIsIl9vdmVycmlkZUF1dGhUb2tlbiIsInRva2VuRGF0YSIsIl9nZXRBcHBDaGVja1Rva2VuIiwiYXBwQ2hlY2siLCJfbWFrZVJlcXVlc3QiLCJhdXRoVG9rZW4iLCJhcHBDaGVja1Rva2VuIiwiZmlyZWJhc2VWZXJzaW9uIiwiYWRkR21waWRIZWFkZXJfIiwiYWRkQXV0aEhlYWRlcl8iLCJhZGRWZXJzaW9uSGVhZGVyXyIsImFkZEFwcENoZWNrSGVhZGVyXyIsIm1ha2VSZXF1ZXN0IiwiU1RPUkFHRV9UWVBFIiwidXBsb2FkQnl0ZXMiLCJmaW5hbE1ldGFkYXRhIiwidXBsb2FkQnl0ZXMkMSIsImdldERvd25sb2FkVVJMIiwic2VydmljZU9yUmVmIiwicGF0aE9yVXJsIiwicmVmJDEiLCJnZXRTdG9yYWdlIiwiYnVja2V0VXJsIiwiYXV0aFByb3ZpZGVyIiwiYXBwQ2hlY2tQcm92aWRlciIsIlBsYXRmb3JtTG9nZ2VyU2VydmljZUltcGwiLCJnZXRQbGF0Zm9ybUluZm9TdHJpbmciLCJpc1ZlcnNpb25TZXJ2aWNlUHJvdmlkZXIiLCJsaWJyYXJ5IiwidmVyc2lvbiIsImxvZ1N0cmluZyIsIm5hbWUkbyIsImxvZ2dlciIsIm5hbWUkbiIsIm5hbWUkbSIsIm5hbWUkbCIsIm5hbWUkayIsIm5hbWUkaiIsIm5hbWUkaSIsIm5hbWUkaCIsIm5hbWUkZyIsIm5hbWUkZiIsIm5hbWUkZSIsIm5hbWUkZCIsIm5hbWUkYyIsIm5hbWUkYiIsIm5hbWUkYSIsIm5hbWUkOSIsIm5hbWUkOCIsIm5hbWUkNyIsIm5hbWUkNiIsIm5hbWUkNSIsIm5hbWUkNCIsIm5hbWUkMyIsIm5hbWUkMiIsIm5hbWUkMSIsIlBMQVRGT1JNX0xPR19TVFJJTkciLCJfYXBwcyIsIl9jb21wb25lbnRzIiwiX2FkZENvbXBvbmVudCIsImRlYnVnIiwiX3JlZ2lzdGVyQ29tcG9uZW50IiwiY29tcG9uZW50TmFtZSIsIl9nZXRQcm92aWRlciIsIkVSUk9SX0ZBQ1RPUlkiLCJGaXJlYmFzZUFwcEltcGwiLCJfaXNEZWxldGVkIiwiX29wdGlvbnMiLCJfY29uZmlnIiwiX25hbWUiLCJfYXV0b21hdGljRGF0YUNvbGxlY3Rpb25FbmFibGVkIiwiYXV0b21hdGljRGF0YUNvbGxlY3Rpb25FbmFibGVkIiwiX2NvbnRhaW5lciIsImNoZWNrRGVzdHJveWVkIiwiaXNEZWxldGVkIiwiU0RLX1ZFUlNJT04iLCJpbml0aWFsaXplQXBwIiwicmF3Q29uZmlnIiwiZXhpc3RpbmdBcHAiLCJuZXdBcHAiLCJnZXRBcHAiLCJyZWdpc3RlclZlcnNpb24iLCJsaWJyYXJ5S2V5T3JOYW1lIiwidmFyaWFudCIsImxpYnJhcnlNaXNtYXRjaCIsInZlcnNpb25NaXNtYXRjaCIsIndhcm5pbmciLCJ3YXJuIiwiX19zcHJlYWRBcnJheXMiLCJpbCIsImpsIiwiTG9nTGV2ZWwiLCJsZXZlbFN0cmluZ1RvRW51bSIsIkRFQlVHIiwiVkVSQk9TRSIsIklORk8iLCJXQVJOIiwiU0lMRU5UIiwiZGVmYXVsdExvZ0xldmVsIiwiQ29uc29sZU1ldGhvZCIsImRlZmF1bHRMb2dIYW5kbGVyIiwibG9nVHlwZSIsIl9pIiwidG9JU09TdHJpbmciLCJjb25zb2xlIiwiTG9nZ2VyIiwiX2xvZ0xldmVsIiwiX2xvZ0hhbmRsZXIiLCJfdXNlckxvZ0hhbmRsZXIiLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwic2V0TG9nTGV2ZWwiLCJsb2ciLCJieXRlVG9DaGFyTWFwXyIsImNoYXJUb0J5dGVNYXBfIiwiYnl0ZVRvQ2hhck1hcFdlYlNhZmVfIiwiY2hhclRvQnl0ZU1hcFdlYlNhZmVfIiwiRU5DT0RFRF9WQUxTX0JBU0UiLCJFTkNPREVEX1ZBTFMiLCJFTkNPREVEX1ZBTFNfV0VCU0FGRSIsIkhBU19OQVRJVkVfU1VQUE9SVCIsImVuY29kZUJ5dGVBcnJheSIsImlucHV0Iiwid2ViU2FmZSIsImluaXRfIiwiYnl0ZVRvQ2hhck1hcCIsIm91dHB1dCIsImJ5dGUxIiwiaGF2ZUJ5dGUyIiwiYnl0ZTIiLCJoYXZlQnl0ZTMiLCJieXRlMyIsIm91dEJ5dGUxIiwib3V0Qnl0ZTIiLCJvdXRCeXRlMyIsIm91dEJ5dGU0IiwiZW5jb2RlU3RyaW5nIiwiYnRvYSIsIm91dCIsInN0cmluZ1RvQnl0ZUFycmF5JDEiLCJkZWNvZGVTdHJpbmciLCJwb3MiLCJjMSIsImZyb21DaGFyQ29kZSIsImMyIiwiYzMiLCJieXRlQXJyYXlUb1N0cmluZyIsImRlY29kZVN0cmluZ1RvQnl0ZUFycmF5IiwiY2hhclRvQnl0ZU1hcCIsImJ5dGU0IiwiYmFzZTY0RGVjb2RlIiwiRGVmZXJyZWQiLCJ3cmFwQ2FsbGJhY2siLCJnZXRVQSIsImlzTW9iaWxlQ29yZG92YSIsImlzQnJvd3NlckV4dGVuc2lvbiIsInJ1bnRpbWUiLCJjaHJvbWUiLCJicm93c2VyIiwiaXNSZWFjdE5hdGl2ZSIsImlzRWxlY3Ryb24iLCJpc0lFIiwiaXNVV1AiLCJpc1NhZmFyaSIsInByb2Nlc3MiLCJpc05vZGUiLCJGaXJlYmFzZUVycm9yIiwiY2FwdHVyZVN0YWNrVHJhY2UiLCJFcnJvckZhY3RvcnkiLCJzZXJ2aWNlTmFtZSIsImVycm9ycyIsImZ1bGxDb2RlIiwidGVtcGxhdGUiLCJQQVRURVJOIiwicmVwbGFjZVRlbXBsYXRlIiwiZnVsbE1lc3NhZ2UiLCJpc0VtcHR5IiwiZGVlcEVxdWFsIiwiYUtleXMiLCJiS2V5cyIsImFLZXlzXzEiLCJhUHJvcCIsImJQcm9wIiwiaXNPYmplY3QiLCJiS2V5c18xIiwidGhpbmciLCJxdWVyeXN0cmluZyIsInF1ZXJ5c3RyaW5nUGFyYW1zIiwiX2xvb3BfMSIsImFycmF5VmFsIiwicXVlcnlzdHJpbmdEZWNvZGUiLCJleHRyYWN0UXVlcnlzdHJpbmciLCJxdWVyeVN0YXJ0IiwiZnJhZ21lbnRTdGFydCIsImNyZWF0ZVN1YnNjcmliZSIsImV4ZWN1dG9yIiwib25Ob09ic2VydmVycyIsIk9ic2VydmVyUHJveHkiLCJzdWJzY3JpYmUiLCJTaGExIiwiY2hhaW5fIiwiYnVmXyIsIldfIiwicGFkXyIsImluYnVmXyIsInRvdGFsXyIsImJsb2NrU2l6ZSIsImNvbXByZXNzXyIsImJ1ZiIsIm9mZnNldCIsInVwZGF0ZSIsImxlbmd0aE1pbnVzQmxvY2siLCJpbmJ1ZiIsImRpZ2VzdCIsInRvdGFsQml0cyIsIm9ic2VydmVycyIsInVuc3Vic2NyaWJlcyIsIm9ic2VydmVyQ291bnQiLCJ0YXNrIiwiZmluYWxpemVkIiwiZm9yRWFjaE9ic2VydmVyIiwiY29tcGxldGUiLCJtZXRob2RzXzEiLCJpbXBsZW1lbnRzQW55TWV0aG9kcyIsIm5vb3AiLCJ1bnN1YiIsInVuc3Vic2NyaWJlT25lIiwiZmluYWxFcnJvciIsImZuIiwic2VuZE9uZSIsImdldE1vZHVsYXJJbnN0YW5jZSIsIl9kZWxlZ2F0ZSIsIl9fcmVzdCIsImdldE93blByb3BlcnR5U3ltYm9scyIsInByb3BlcnR5SXNFbnVtZXJhYmxlIiwiX19hd2FpdGVyIiwidGhpc0FyZyIsIl9hcmd1bWVudHMiLCJnZW5lcmF0b3IiLCJzdGVwIiwicmVqZWN0ZWQiLCJfX2dlbmVyYXRvciIsInRyeXMiLCJvcHMiLCJJdGVyYXRvciIsInZlcmIiLCJwb3AiLCJfX3JlYWQiLCJhciIsIl9fc3ByZWFkQXJyYXkiLCJ0byIsInBhY2siLCJTdXBwcmVzc2VkRXJyb3IiLCJoaWdobGlnaHRBY3RpdmVOYXYiLCJuYXZMaW5rcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJjdXJyZW50UGF0aCIsInBhdGhuYW1lIiwibGlua1BhdGgiLCJnZXRBdHRyaWJ1dGUiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJpc0F1dGhlbnRpY2F0ZWQiLCJ0b0tleSIsImlzRXF1YWwiLCJVTkFVVEhFTlRJQ0FURUQiLCJHT09HTEVfQ1JFREVOVElBTFMiLCJGSVJTVF9QQVJUWSIsIk1PQ0tfVVNFUiIsIk9LIiwiQ0FOQ0VMTEVEIiwiVU5LTk9XTiIsIklOVkFMSURfQVJHVU1FTlQiLCJERUFETElORV9FWENFRURFRCIsIk5PVF9GT1VORCIsIkFMUkVBRFlfRVhJU1RTIiwiUEVSTUlTU0lPTl9ERU5JRUQiLCJSRVNPVVJDRV9FWEhBVVNURUQiLCJGQUlMRURfUFJFQ09ORElUSU9OIiwiQUJPUlRFRCIsIk9VVF9PRl9SQU5HRSIsIlVOSU1QTEVNRU5URUQiLCJVTkFWQUlMQUJMRSIsIkRBVEFfTE9TUyIsImF1dGhIZWFkZXJzIiwiQXV0aG9yaXphdGlvbiIsImludmFsaWRhdGVUb2tlbiIsImVucXVldWVSZXRyeWFibGUiLCJzaHV0ZG93biIsImdldEF1dGhIZWFkZXJWYWx1ZUZvckZpcnN0UGFydHkiLCJwcmV2aW91c1ZhbHVlIiwic2VxdWVuY2VOdW1iZXJIYW5kbGVyIiwid3JpdGVTZXF1ZW5jZU51bWJlciIsImNyeXB0byIsIm1zQ3J5cHRvIiwiZ2V0UmFuZG9tVmFsdWVzIiwidHQiLCJldCIsImV2ZXJ5Iiwic3QiLCJuYW5vc2Vjb25kcyIsImZyb21NaWxsaXMiLCJmcm9tRGF0ZSIsInRvRGF0ZSIsInRvTWlsbGlzIiwiX2NvbXBhcmVUbyIsInZhbHVlT2YiLCJwYWRTdGFydCIsIml0IiwidGltZXN0YW1wIiwiZnJvbVRpbWVzdGFtcCIsImNvbXBhcmVUbyIsInRvTWljcm9zZWNvbmRzIiwidG9UaW1lc3RhbXAiLCJydCIsIm90IiwiYXQiLCJjdCIsInNlZ21lbnRzIiwiY29tcGFyYXRvciIsImxpbWl0IiwiY29uc3RydWN0IiwicG9wRmlyc3QiLCJwb3BMYXN0IiwiZmlyc3RTZWdtZW50IiwibGFzdFNlZ21lbnQiLCJpc1ByZWZpeE9mIiwiaXNJbW1lZGlhdGVQYXJlbnRPZiIsInRvQXJyYXkiLCJ1dCIsImNhbm9uaWNhbFN0cmluZyIsImZyb21TdHJpbmciLCJlbXB0eVBhdGgiLCJodCIsImx0IiwiaXNWYWxpZElkZW50aWZpZXIiLCJpc0tleUZpZWxkIiwia2V5RmllbGQiLCJmcm9tU2VydmVyRm9ybWF0IiwiZnQiLCJmaWVsZHMiLCJjb3ZlcnMiLCJ3dCIsImJpbmFyeVN0cmluZyIsImZyb21CYXNlNjRTdHJpbmciLCJmcm9tVWludDhBcnJheSIsInRvQmFzZTY0IiwidG9VaW50OEFycmF5IiwiYXBwcm94aW1hdGVCeXRlU2l6ZSIsIkVNUFRZX0JZVEVfU1RSSU5HIiwiX3QiLCJtdCIsIm5hbm9zIiwiZ3QiLCJ5dCIsIlR0IiwibWFwVmFsdWUiLCJfX2xvY2FsX3dyaXRlX3RpbWVfXyIsInRpbWVzdGFtcFZhbHVlIiwiSXQiLCJBdCIsIlB0IiwiZnJvbVBhdGgiLCJmcm9tTmFtZSIsImhhc0NvbGxlY3Rpb25JZCIsImlzRG9jdW1lbnRLZXkiLCJmcm9tU2VnbWVudHMiLCJidCIsIl9fdHlwZV9fIiwic3RyaW5nVmFsdWUiLCJwdCIsInZ0IiwiYm9vbGVhblZhbHVlIiwiYnl0ZXNWYWx1ZSIsInJlZmVyZW5jZVZhbHVlIiwiZ2VvUG9pbnRWYWx1ZSIsImxhdGl0dWRlIiwibG9uZ2l0dWRlIiwiaW50ZWdlclZhbHVlIiwiZG91YmxlVmFsdWUiLCJhcnJheVZhbHVlIiwiVnQiLCJTdCIsIkR0IiwiQ3QiLCJOdCIsImt0IiwiJHQiLCJNdCIsIkx0IiwiQnQiLCJlbXB0eSIsImZpZWxkIiwiZ2V0RmllbGRzTWFwIiwic2V0QWxsIiwiYXBwbHlDaGFuZ2VzIiwiY2xvbmUiLCJVdCIsInF0IiwiZG9jdW1lbnRUeXBlIiwiZG9jdW1lbnRTdGF0ZSIsIm5ld0ludmFsaWREb2N1bWVudCIsIm5ld0ZvdW5kRG9jdW1lbnQiLCJuZXdOb0RvY3VtZW50IiwibmV3VW5rbm93bkRvY3VtZW50IiwiY29udmVydFRvRm91bmREb2N1bWVudCIsImNvbnZlcnRUb05vRG9jdW1lbnQiLCJjb252ZXJ0VG9Vbmtub3duRG9jdW1lbnQiLCJzZXRIYXNDb21taXR0ZWRNdXRhdGlvbnMiLCJzZXRIYXNMb2NhbE11dGF0aW9ucyIsImhhc0xvY2FsTXV0YXRpb25zIiwiaGFzQ29tbWl0dGVkTXV0YXRpb25zIiwiaGFzUGVuZGluZ1dyaXRlcyIsImlzVmFsaWREb2N1bWVudCIsImlzRm91bmREb2N1bWVudCIsImlzTm9Eb2N1bWVudCIsImlzVW5rbm93bkRvY3VtZW50IiwiS3QiLCJjb2xsZWN0aW9uR3JvdXAiLCJvcmRlckJ5IiwiZmlsdGVycyIsInN0YXJ0QXQiLCJlbmRBdCIsImp0IiwiUXQiLCJKdCIsImRpciIsIm9lIiwiR3QiLCJjZSIsImhlIiwiSHQiLCJZdCIsImVlIiwibmUiLCJzZSIsImllIiwiWHQiLCJadCIsInRlIiwibnVsbFZhbHVlIiwiYmVmb3JlIiwiYWUiLCJ1ZSIsImxlIiwiZXhwbGljaXRPcmRlckJ5IiwibGltaXRUeXBlIiwicGUiLCJnZSIsIm1lIiwiRWUiLCJJZSIsIkFlIiwiUmUiLCJXdCIsIlBlIiwidmUiLCJWZSIsIlNlIiwiRGUiLCJpc0ludGVnZXIiLCJNQVhfU0FGRV9JTlRFR0VSIiwiTUlOX1NBRkVfSU5URUdFUiIsIlJ0IiwiQ2UiLCJOZSIsIiRlIiwiX19wcmV2aW91c192YWx1ZV9fIiwiT2UiLCJGZSIsIk1lIiwiTGUiLCJrZSIsIlVlIiwieGUiLCJCZSIsImVsZW1lbnRzIiwicWUiLCJLZSIsInRyYW5zZm9ybSIsIlFlIiwidHJhbnNmb3JtUmVzdWx0cyIsIldlIiwidXBkYXRlVGltZSIsImV4aXN0cyIsIm5vbmUiLCJpc05vbmUiLCJHZSIsInplIiwiSGUiLCJ0biIsInNuIiwiZmllbGRUcmFuc2Zvcm1zIiwiZW4iLCJwcmVjb25kaXRpb24iLCJubiIsIkplIiwicm4iLCJaZSIsIlllIiwiWGUiLCJqZSIsImZpZWxkTWFzayIsIm9uIiwiYW4iLCJ1biIsImhuIiwiZG4iLCJfbiIsIkVNUFRZIiwiaW5zZXJ0IiwiY29weSIsIkJMQUNLIiwicmlnaHQiLCJtaW5LZXkiLCJtYXhLZXkiLCJpbm9yZGVyVHJhdmVyc2FsIiwicmV2ZXJzZVRyYXZlcnNhbCIsImdldEl0ZXJhdG9yIiwid24iLCJnZXRJdGVyYXRvckZyb20iLCJnZXRSZXZlcnNlSXRlcmF0b3IiLCJnZXRSZXZlcnNlSXRlcmF0b3JGcm9tIiwiaXNSZXZlcnNlIiwibm9kZVN0YWNrIiwiZ2V0TmV4dCIsImhhc05leHQiLCJwZWVrIiwiY29sb3IiLCJSRUQiLCJmaXhVcCIsInJlbW92ZU1pbiIsImlzUmVkIiwibW92ZVJlZExlZnQiLCJyb3RhdGVSaWdodCIsIm1vdmVSZWRSaWdodCIsInJvdGF0ZUxlZnQiLCJjb2xvckZsaXAiLCJjaGVja01heERlcHRoIiwiY2hlY2siLCJwb3ciLCJtbiIsImZpcnN0IiwibGFzdCIsImZvckVhY2hJblJhbmdlIiwiZm9yRWFjaFdoaWxlIiwiZmlyc3RBZnRlck9yRXF1YWwiLCJnbiIsInVuaW9uV2l0aCIsIml0ZXIiLCJ5biIsInBuIiwiRW4iLCJUbiIsIkluIiwiUm4iLCJQbiIsImJuIiwiTG4iLCJkYXRhYmFzZUlkIiwiQm4iLCJVbiIsInFuIiwiS24iLCJqbiIsImRhdGFiYXNlIiwiV24iLCJIbiIsInBzIiwiUW4iLCJZbiIsIlhuIiwiYXMiLCJzdHJ1Y3R1cmVkUXVlcnkiLCJhbGxEZXNjZW5kYW50cyIsImNvbGxlY3Rpb25JZCIsInVzIiwiX3MiLCJkaXJlY3Rpb24iLCJscyIsImZlIiwidW5hcnlGaWx0ZXIiLCJncyIsImZpZWxkRmlsdGVyIiwibXMiLCJjb21wb3NpdGVGaWx0ZXIiLCJmaWVsZFBhdGgiLCJOYU4iLCJ5cyIsImZpZWxkUGF0aHMiLCJFcyIsIklzIiwiVHMiLCJQcyIsIm93bmVySWQiLCJhbGxvd1RhYlN5bmNocm9uaXphdGlvbiIsImxlYXNlVGltZXN0YW1wTXMiLCJzdG9yZSIsImJzIiwidXNlcklkIiwibGFzdEFja25vd2xlZGdlZEJhdGNoSWQiLCJsYXN0U3RyZWFtVG9rZW4iLCJ2cyIsImJhdGNoSWQiLCJsb2NhbFdyaXRlVGltZU1zIiwiYmFzZU11dGF0aW9ucyIsIm11dGF0aW9ucyIsInVzZXJNdXRhdGlvbnNJbmRleCIsInVzZXJNdXRhdGlvbnNLZXlQYXRoIiwiVnMiLCJwcmVmaXhGb3JVc2VyIiwicHJlZml4Rm9yUGF0aCIsIlBMQUNFSE9MREVSIiwiQ3MiLCJ1bmtub3duRG9jdW1lbnQiLCJub0RvY3VtZW50IiwicmVhZFRpbWUiLCJwYXJlbnRQYXRoIiwicmVhZFRpbWVJbmRleCIsInJlYWRUaW1lSW5kZXhQYXRoIiwiY29sbGVjdGlvblJlYWRUaW1lSW5kZXgiLCJjb2xsZWN0aW9uUmVhZFRpbWVJbmRleFBhdGgiLCJOcyIsImJ5dGVTaXplIiwieHMiLCJ0YXJnZXRJZCIsImNhbm9uaWNhbElkIiwicmVzdW1lVG9rZW4iLCJsYXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIiLCJsYXN0TGltYm9GcmVlU25hcHNob3RWZXJzaW9uIiwicXVlcnlUYXJnZXRzSW5kZXhOYW1lIiwicXVlcnlUYXJnZXRzS2V5UGF0aCIsImtzIiwic2VxdWVuY2VOdW1iZXIiLCJkb2N1bWVudFRhcmdldHNJbmRleCIsImRvY3VtZW50VGFyZ2V0c0tleVBhdGgiLCIkcyIsImhpZ2hlc3RUYXJnZXRJZCIsImhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlciIsImxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24iLCJ0YXJnZXRDb3VudCIsIk9zIiwiRnMiLCJjbGllbnRJZCIsInVwZGF0ZVRpbWVNcyIsIm5ldHdvcmtFbmFibGVkIiwiaW5Gb3JlZ3JvdW5kIiwiTXMiLCJidW5kbGVJZCIsImNyZWF0ZVRpbWUiLCJMcyIsImJ1bmRsZWRRdWVyeSIsIlVzIiwicXMiLCJvbkNvbW1pdHRlZExpc3RlbmVycyIsImFkZE9uQ29tbWl0dGVkTGlzdGVuZXIiLCJyYWlzZU9uQ29tbWl0dGVkRXZlbnQiLCJLcyIsIm5leHRDYWxsYmFjayIsImNhdGNoQ2FsbGJhY2siLCJpc0RvbmUiLCJjYWxsYmFja0F0dGFjaGVkIiwid3JhcEZhaWx1cmUiLCJ3cmFwU3VjY2VzcyIsIndyYXBVc2VyRnVuY3Rpb24iLCJ3YWl0Rm9yIiwib3IiLCJ6cyIsImVpIiwibG9jYWxXcml0ZVRpbWUiLCJhcHBseVRvUmVtb3RlRG9jdW1lbnQiLCJtdXRhdGlvblJlc3VsdHMiLCJhcHBseVRvTG9jYWxWaWV3IiwiYXBwbHlUb0xvY2FsRG9jdW1lbnRTZXQiLCJuaSIsImJhdGNoIiwiY29tbWl0VmVyc2lvbiIsImRvY1ZlcnNpb25zIiwiaWkiLCJ3aSIsIlRlIiwieWkiLCJwaSIsImFkZFRvQ29sbGVjdGlvblBhcmVudEluZGV4IiwiZ2V0Q29sbGVjdGlvblBhcmVudHMiLCJnZXRFbnRyaWVzIiwiQWkiLCJjYWNoZVNpemVDb2xsZWN0aW9uVGhyZXNob2xkIiwicGVyY2VudGlsZVRvQ29sbGVjdCIsIm1heGltdW1TZXF1ZW5jZU51bWJlcnNUb0NvbGxlY3QiLCJ3aXRoQ2FjaGVTaXplIiwiREVGQVVMVF9DT0xMRUNUSU9OX1BFUkNFTlRJTEUiLCJERUZBVUxUX01BWF9TRVFVRU5DRV9OVU1CRVJTX1RPX0NPTExFQ1QiLCJERUZBVUxUIiwiRElTQUJMRUQiLCJDaSIsIk9pIiwiS2kiLCJtYXBLZXlGbiIsImVxdWFsc0ZuIiwiaW5uZXIiLCJqaSIsImNoYW5nZXMiLCJjaGFuZ2VzQXBwbGllZCIsImdldFJlYWRUaW1lIiwiYWRkRW50cnkiLCJhc3NlcnROb3RBcHBsaWVkIiwicmVtb3ZlRW50cnkiLCJnZXRFbnRyeSIsImdldEZyb21DYWNoZSIsImdldEFsbEZyb21DYWNoZSIsImlyIiwiQW4iLCJnZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdEb2N1bWVudEtleSIsInZuIiwiZ2V0QWxsTXV0YXRpb25CYXRjaGVzQWZmZWN0aW5nRG9jdW1lbnRLZXlzIiwiZ2V0RG9jdW1lbnRzTWF0Y2hpbmdRdWVyeSIsIlZuIiwieWUiLCJTbiIsIkRuIiwiZ2V0QWxsTXV0YXRpb25CYXRjaGVzQWZmZWN0aW5nUXVlcnkiLCJDbiIsInJyIiwiZnJvbUNhY2hlIiwiTm4iLCJ4biIsImtuIiwiZG9jQ2hhbmdlcyIsImRvYyIsIiRuIiwiT24iLCJGbiIsIk1uIiwid2UiLCJiZSIsImdldE11dGF0aW9uUXVldWUiLCJnZXRSZW1vdGVEb2N1bWVudENhY2hlIiwiZ2V0VGFyZ2V0Q2FjaGUiLCJnZXRJbmRleE1hbmFnZXIiLCJnZXRCdW5kbGVDYWNoZSIsImNvbGxlY3RHYXJiYWdlIiwicnVuVHJhbnNhY3Rpb24iLCJjb2xsZWN0IiwidXIiLCJnZXRBbGxNdXRhdGlvbkJhdGNoZXMiLCJyZW1vdmVkQmF0Y2hJZHMiLCJhZGRlZEJhdGNoSWRzIiwid3IiLCJnZXROZXh0TXV0YXRpb25CYXRjaEFmdGVyQmF0Y2hJZCIsIkFyIiwiZ2V0QnVuZGxlTWV0YWRhdGEiLCJzYXZlQnVuZGxlTWV0YWRhdGEiLCJnZXROYW1lZFF1ZXJ5Iiwic2F2ZU5hbWVkUXVlcnkiLCJSciIsIlpuIiwiUHIiLCJ0cyIsImVzIiwibnMiLCJhZGRSZWZlcmVuY2UiLCJzcyIsInJlbW92ZVJlZmVyZW5jZSIsInJzIiwib3MiLCJjcyIsImhzIiwiY29udGFpbnNLZXkiLCJiciIsInJlZmVyZW5jZURlbGVnYXRlIiwiZnMiLCJkcyIsImNoZWNrRW1wdHkiLCJhZGRNdXRhdGlvbkJhdGNoIiwibG9va3VwTXV0YXRpb25CYXRjaCIsIndzIiwiZ2V0SGlnaGVzdFVuYWNrbm93bGVkZ2VkQmF0Y2hJZCIsInJlbW92ZU11dGF0aW9uQmF0Y2giLCJtYXJrUG90ZW50aWFsbHlPcnBoYW5lZCIsInBlcmZvcm1Db25zaXN0ZW5jeUNoZWNrIiwidnIiLCJkb2NzIiwibmV3Q2hhbmdlQnVmZmVyIiwiVnIiLCJnZXRTaXplIiwiU3IiLCJBcyIsIlJzIiwiZm9yRWFjaFRhcmdldCIsImdldExhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24iLCJnZXRIaWdoZXN0U2VxdWVuY2VOdW1iZXIiLCJhbGxvY2F0ZVRhcmdldElkIiwic2V0VGFyZ2V0c01ldGFkYXRhIiwiYWRkVGFyZ2V0RGF0YSIsInVwZGF0ZVRhcmdldERhdGEiLCJyZW1vdmVUYXJnZXREYXRhIiwicmVtb3ZlVGFyZ2V0cyIsInJlbW92ZU1hdGNoaW5nS2V5c0ZvclRhcmdldElkIiwiZ2V0VGFyZ2V0Q291bnQiLCJnZXRUYXJnZXREYXRhIiwiYWRkTWF0Y2hpbmdLZXlzIiwicmVtb3ZlTWF0Y2hpbmdLZXlzIiwiZ2V0TWF0Y2hpbmdLZXlzRm9yVGFyZ2V0SWQiLCJEciIsInN0YXJ0ZWQiLCJzZXREYXRhYmFzZURlbGV0ZWRMaXN0ZW5lciIsInNldE5ldHdvcmtFbmFibGVkIiwiQ3IiLCJTcyIsImN1cnJlbnRTZXF1ZW5jZU51bWJlciIsIk5yIiwiRHMiLCJyZW1vdmVUYXJnZXQiLCJ1cGRhdGVMaW1ib0RvY3VtZW50IiwiQnIiLCJhY3RpdmVUYXJnZXRJZHMiLCJxciIsIm9ubGluZVN0YXRlSGFuZGxlciIsImFkZFBlbmRpbmdNdXRhdGlvbiIsInVwZGF0ZU11dGF0aW9uU3RhdGUiLCJhZGRMb2NhbFF1ZXJ5VGFyZ2V0IiwidXBkYXRlUXVlcnlTdGF0ZSIsInJlbW92ZUxvY2FsUXVlcnlUYXJnZXQiLCJpc0xvY2FsUXVlcnlUYXJnZXQiLCJjbGVhclF1ZXJ5U3RhdGUiLCJnZXRBbGxBY3RpdmVRdWVyeVRhcmdldHMiLCJpc0FjdGl2ZVF1ZXJ5VGFyZ2V0IiwiaGFuZGxlVXNlckNoYW5nZSIsInNldE9ubGluZVN0YXRlIiwibm90aWZ5QnVuZGxlTG9hZGVkIiwiS3IiLCJFaSIsImpyIiwiVGkiLCJJaSIsIlJpIiwiUGkiLCJiaSIsIlFyIiwiQmF0Y2hHZXREb2N1bWVudHMiLCJDb21taXQiLCJSdW5RdWVyeSIsIldyIiwidmkiLCJWaSIsIlNpIiwiRGkiLCJOaSIsInhpIiwia2kiLCIkaSIsIkdyIiwiZGF0YWJhc2VJbmZvIiwic3NsIiwiRmkiLCJNaSIsIkxpIiwiQmkiLCJVaSIsInFpIiwiYXV0b0RldGVjdExvbmdQb2xsaW5nIiwidXNlRmV0Y2hTdHJlYW1zIiwiZm9yd2FyZENoYW5uZWxSZXF1ZXN0VGltZW91dE1zIiwiSHIiLCJKciIsIllyIiwiUWkiLCJXaSIsIkdpIiwiemkiLCJIaSIsIkppIiwiWWkiLCJYaSIsIlppIiwiZW5xdWV1ZUFmdGVyRGVsYXkiLCJ0ciIsInNraXBEZWxheSIsIlhyIiwiZXIiLCJuciIsImNyZWRlbnRpYWxzUHJvdmlkZXIiLCJzciIsImNyIiwiaHIiLCJsciIsImRyIiwiX3IiLCJtciIsImdyIiwieXIiLCJwciIsIkVyIiwiZW5xdWV1ZUFuZEZvcmdldCIsInN0cmVhbVRva2VuIiwiaXMiLCJ3cml0ZVJlc3VsdHMiLCJjb21taXRUaW1lIiwiSm4iLCJ3cml0ZXMiLCJ1cGRhdGVNYXNrIiwidXBkYXRlVHJhbnNmb3JtcyIsInNldFRvU2VydmVyVmFsdWUiLCJhcHBlbmRNaXNzaW5nRWxlbWVudHMiLCJyZW1vdmVBbGxGcm9tQXJyYXkiLCJpbmNyZW1lbnQiLCJjdXJyZW50RG9jdW1lbnQiLCJlbyIsInRlcm1pbmF0ZSIsIm5vIiwiYXN5bmNRdWV1ZSIsImtyIiwiJHIiLCJPciIsIkZyIiwiTXIiLCJMciIsInNvIiwibG9jYWxTdG9yZSIsImRhdGFzdG9yZSIsInJlbW90ZVN5bmNlciIsIlVyIiwiZm8iLCJybyIsImlvIiwieW8iLCJwbyIsIkVvIiwiQ28iLCJUbyIsIklvIiwiQW8iLCJSbyIsIlBvIiwiYm8iLCJ2byIsImFwcGx5U3VjY2Vzc2Z1bFdyaXRlIiwiVm8iLCJsbiIsInJlamVjdEZhaWxlZFdyaXRlIiwiTm8iLCJ0YXJnZXRUaW1lTXMiLCJyZW1vdmFsQ2FsbGJhY2siLCJjcmVhdGVBbmRTY2hlZHVsZSIsInRpbWVySGFuZGxlIiwiaGFuZGxlRGVsYXlFbGFwc2VkIiwieG8iLCJNbyIsInF1ZXJpZXMiLCJvbmxpbmVTdGF0ZSIsIlpyIiwicmVtb3RlU3RvcmUiLCJzaGFyZWRDbGllbnRTdGF0ZSIsIm1heENvbmN1cnJlbnRMaW1ib1Jlc29sdXRpb25zIiwia28iLCIkbyIsIk9vIiwiRm8iLCJMbyIsIkJvIiwiVW8iLCJxbyIsImlzUHJpbWFyeUNsaWVudCIsInZpZXciLCJzbmFwc2hvdCIsIktvIiwiVHIiLCJ0cmFja1JlbW92YWxzIiwic25hcHNob3RWZXJzaW9uIiwid2l0aExhc3RMaW1ib0ZyZWVTbmFwc2hvdFZlcnNpb24iLCJzeW5jaHJvbml6ZVRhYnMiLCJXbyIsIkdvIiwiZ2NTY2hlZHVsZXIiLCJ6byIsIkhvIiwiaW5pdGlhbFVzZXIiLCJjcmVhdGVEYXRhc3RvcmUiLCJjcmVhdGVSZW1vdGVTdG9yZSIsImNyZWF0ZUV2ZW50TWFuYWdlciIsInN5bmNFbmdpbmUiLCJjcmVhdGVTeW5jRW5naW5lIiwiaGFuZGxlQ3JlZGVudGlhbENoYW5nZSIsIlNvIiwiY3JlZGVudGlhbExpc3RlbmVyIiwiZ2V0Q29uZmlndXJhdGlvbiIsInNldENyZWRlbnRpYWxDaGFuZ2VMaXN0ZW5lciIsInZlcmlmeU5vdFRlcm1pbmF0ZWQiLCJpc1NodXR0aW5nRG93biIsImVudGVyUmVzdHJpY3RlZE1vZGUiLCJlbnF1ZXVlQW5kRm9yZ2V0RXZlbldoaWxlUmVzdHJpY3RlZCIsIm9ubGluZUNvbXBvbmVudHMiLCJvZmZsaW5lQ29tcG9uZW50cyIsInZlcmlmeU9wZXJhdGlvbkluUHJvZ3Jlc3MiLCJwZXJzaXN0ZW5jZUtleSIsImlzRGVmYXVsdERhdGFiYXNlIiwiaWdub3JlVW5kZWZpbmVkUHJvcGVydGllcyIsImNhY2hlU2l6ZUJ5dGVzIiwiZXhwZXJpbWVudGFsRm9yY2VMb25nUG9sbGluZyIsImV4cGVyaW1lbnRhbEF1dG9EZXRlY3RMb25nUG9sbGluZyIsIl9jcmVkZW50aWFscyIsIl9wZXJzaXN0ZW5jZUtleSIsIl9zZXR0aW5ncyIsIl9zZXR0aW5nc0Zyb3plbiIsIl9kYXRhYmFzZUlkIiwiX2FwcCIsIl9pbml0aWFsaXplZCIsIl90ZXJtaW5hdGVkIiwiX3Rlcm1pbmF0ZVRhc2siLCJfc2V0U2V0dGluZ3MiLCJjbGllbnQiLCJzZXNzaW9uSW5kZXgiLCJpYW1Ub2tlbiIsIl9nZXRTZXR0aW5ncyIsIl9mcmVlemVTZXR0aW5ncyIsIl90ZXJtaW5hdGUiLCJjb252ZXJ0ZXIiLCJmaXJlc3RvcmUiLCJfcGF0aCIsIndpdGhDb252ZXJ0ZXIiLCJfcXVlcnkiLCJkZSIsInZpc2liaWxpdHlTdGF0ZSIsImVucXVldWUiLCJzdGFjayIsIl9xdWV1ZSIsIl9maXJlc3RvcmVDbGllbnQiLCJfaW50ZXJuYWxQYXRoIiwiX2J5dGVTdHJpbmciLCJfbWV0aG9kTmFtZSIsImlzRmluaXRlIiwiX2xhdCIsIl9sb25nIiwidHUiLCJudSIsInRvTXV0YXRpb24iLCJzdSIsIml1IiwiUnUiLCJtZXRob2ROYW1lIiwicnUiLCJjdSIsIl90b0ZpZWxkVHJhbnNmb3JtIiwiaHUiLCJndSIsInB1IiwiRXUiLCJ5dSIsImdldFByb3RvdHlwZU9mIiwiVHUiLCJBdSIsIkl1Iiwic2VhcmNoIiwiUHUiLCJ3aCIsIm91IiwiX3UiLCJ3dSIsInBoIiwiUmgiLCJTaCIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImNhY2hlZE1vZHVsZSIsImV4cG9ydHMiLCJtb2R1bGUiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwiZGVmaW5pdGlvbiIsInByb3AiLCJ1c2VyRGF0YSIsInBob25lIiwiYWxlcnQiLCJkb2NTdHJpbmciLCJnZXRFbGVtZW50QnlJZCIsImlubmVySFRNTCIsImRvY3VtZW50TmFtZSIsImZpbGVVcmwiLCJzZWxlY3RFbGVtZW50IiwiZWRpdERvY3VtZW50UGFnZUZvcm0iLCJzZWxlY3RlZEluZGV4IiwiZWRpdERvY3VtZW50UGFnZU5hbWVPZkRvY3VtZW50IiwiZWRpdERvY3VtZW50UGFnZVR5cGVPZkRvY3VtZW50T3B0aW9ucyIsImVkaXREb2N1bWVudFBhZ2VUeXBlT2ZEb2N1bWVudFNlbGVjdGVkIiwib2xkRG9jIiwibmV3RmlsZVVSTCIsImVkaXREb2N1bWVudFBhZ2VGaWxlSW5wdXQiLCJlZGl0RG9jdW1lbnRQYWdlRmlsZVVwbG9hZGVkIiwiZmlsZXMiLCJuZXdTdG9yYWdlUmVmIiwiZG9jUmVmIiwiZmlsZU5hbWUiLCJmaWxlVHlwZSIsImZpbGVTaXplIiwidXBkYXRlZEF0IiwiZWRpdERvY3VtZW50Il0sInNvdXJjZVJvb3QiOiIifQ==